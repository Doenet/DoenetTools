import{am as W,bj as q,r as v,bm as m}from"./index-66847aab.js";import{BoardContext as H,BASE_LAYER_OFFSET as N}from"./graph-8b0adce9.js";import"./css-14ccef8c.js";const ne=W.memo(function U(D){var A;let{name:I,id:K,SVs:u,actions:Q,sourceOfUpdate:Z,callAction:$}=q(D);U.ignoreActionsWithoutCore=()=>!0;const l=v.useContext(H);let f=v.useRef(null),F=v.useRef(null),x=v.useRef(null),h=v.useRef(null),p=v.useRef(null),y=v.useRef(null);x.current=u.dx,h.current=u.dy,p.current=u.xoffset,y.current=u.yoffset;let B=v.useRef({visible:!u.hidden,fixed:!0,withlabel:!1,layer:10*u.layer+N,fillColor:"darkgray",strokeColor:"darkgray",size:.1,face:"circle",highlight:!1,showinfobox:!1});B.current.visible=!u.hidden,B.current.layer=10*u.layer+N,v.useEffect(()=>()=>{P()},[]);function O(){let[o,b,g,M]=l.getBoundingBox(),R=(o-p.current)/x.current,C=(g-p.current)/x.current,j=(M-y.current)/h.current,w=(b-y.current)/h.current,s=m.math.round(Math.min(R,C)+1),d=m.math.round(Math.max(R,C)-1),i=m.math.round(Math.min(j,w)+1),a=m.math.round(Math.max(j,w)-1);if(F.current=[s,d,i,a],Number.isFinite(s)&&Number.isFinite(d)&&Number.isFinite(i)&&Number.isFinite(a)){let t=[];for(let r=i;r<=a;r++){let c=r*u.dy+u.yoffset,e=[];for(let n=s;n<=d;n++)e.push(l.create("point",[n*u.dx+u.xoffset,c],B.current));t.push(e)}f.current=t}l.on("boundingbox",()=>{let[t,r,c,e]=l.getBoundingBox(),n=(t-p.current)/x.current,E=(c-p.current)/x.current,Y=(e-y.current)/h.current,S=(r-y.current)/h.current,G=m.math.round(Math.min(n,E)+1),J=m.math.round(Math.max(n,E)-1),_=m.math.round(Math.min(Y,S)+1),k=m.math.round(Math.max(Y,S)-1),[z,L,T,V]=F.current;(G!==z||J!==L||_!==T||k!==V)&&X(G,J,_,k)})}function P(){if(f.current!==null)for(let o of f.current)for(let b of o)l.removeObject(b);f.current=null}function X(o,b,g,M){if(f.current===null)return O();if(!Number.isFinite(o)||!Number.isFinite(b)||!Number.isFinite(g)||!Number.isFinite(M))return P();let[R,C,j,w]=F.current,s=M-g+1,d=w-j+1,i=b-o+1,a=C-R+1;for(let t=0;t<Math.min(s,d);t++){let r=f.current[t],c=(t+g)*h.current+y.current;for(let e=0;e<Math.min(i,a);e++){let n=(e+o)*x.current+p.current;r[e].coords.setCoordinates(JXG.COORDS_BY_USER,[n,c]),r[e].needsUpdate=!0,r[e].update()}if(a>i)for(let e=i;e<a;e++){let n=r.pop();l.removeObject(n)}else if(a<i)for(let e=a;e<i;e++){let n=(e+o)*x.current+p.current;r.push(l.create("point",[n,c],B.current))}}if(d>s)for(let t=s;t<d;t++){let r=f.current.pop();for(let c=0;c<a;c++){let e=r.pop();l.removeObject(e)}}else if(d<s)for(let t=d;t<s;t++){let r=[],c=(t+g)*h.current+y.current;for(let e=0;e<i;e++){let n=(e+o)*x.current+p.current;r.push(l.create("point",[n,c],B.current))}f.current.push(r)}F.current=[o,b,g,M],l.updateRenderer()}if(l)if(f.current===null)O();else{let[o,b,g,M]=l.getBoundingBox(),R=(o-p.current)/x.current,C=(g-p.current)/x.current,j=(M-y.current)/h.current,w=(b-y.current)/h.current,s=m.math.round(Math.min(R,C)+1),d=m.math.round(Math.max(R,C)-1),i=m.math.round(Math.min(j,w)+1),a=m.math.round(Math.max(j,w)-1);X(s,d,i,a);let t=(A=f.current[0])==null?void 0:A[0];if(t){let r=10*u.layer+N;if(t.visProp.layer!==r)for(let e of f.current)for(let n of e)n.setAttribute({layer:r})}}return null});export{ne as default};
