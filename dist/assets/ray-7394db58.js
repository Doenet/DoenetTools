import{aw as G,bn as L,r as n,j as P,F as T}from"./index-04f8bff6.js";import{BoardContext as D,LINE_LAYER_OFFSET as k}from"./graph-5b7a9f5c.js";import"./css-14ccef8c.js";import"./visibility-sensor-4b2d5ed8.js";const Y=G.memo(function a(w){let{name:X,id:x,SVs:e,actions:h,sourceOfUpdate:_,callAction:p}=L(w);a.ignoreActionsWithoutCore=!0;const s=n.useContext(D);let r=n.useRef(null),u=n.useRef(!1),g=n.useRef(!1),b=n.useRef(!1),C=n.useRef(!1),d=n.useRef(null),v=n.useRef(null),m=n.useRef(null);v.current=e.numericalEndpoint,m.current=e.numericalThroughpoint,n.useEffect(()=>()=>{Object.keys(r.current).length!==0&&R()},[]);function E(){if(e.numericalEndpoint.length!==2||e.numericalThroughpoint.length!==2){r.current=null;return}let i=!e.draggable||e.fixed;var l={name:e.labelForGraph,visible:!e.hidden,withLabel:e.showLabel&&e.labelForGraph!=="",layer:10*e.layer+k,fixed:i,strokeColor:e.selectedStyle.lineColor,strokeOpacity:e.selectedStyle.lineOpacity,highlightStrokeColor:e.selectedStyle.lineColor,highlightStrokeOpacity:e.selectedStyle.lineOpacity*.5,strokeWidth:e.selectedStyle.lineWidth,highlightStrokeWidth:e.selectedStyle.lineWidth,dash:O(e.selectedStyle.lineStyle),highlight:!i,straightFirst:!1};l.label={highlight:!1},e.labelHasLatex&&(l.label.useMathJax=!0),e.applyStyleToLabel?l.label.strokeColor=e.selectedStyle.lineColor:l.label.strokeColor="#000000";let c=[[...e.numericalEndpoint],[...e.numericalThroughpoint]],t=s.create("line",c,l);t.on("drag",function(o){(Math.abs(o.x-u.current[0])>.1||Math.abs(o.y-u.current[1])>.1)&&(b.current=!0,d.current=F(o),p({action:h.moveRay,args:{endpointcoords:d.current[0],throughcoords:d.current[1],transient:!0,skippable:!0}})),r.current.point1.coords.setCoordinates(JXG.COORDS_BY_USER,v.current),r.current.point2.coords.setCoordinates(JXG.COORDS_BY_USER,m.current)}),t.on("up",function(o){b.current?p({action:h.moveRay,args:{endpointcoords:d.current[0],throughcoords:d.current[1]}}):p({action:h.rayClicked})}),t.on("down",function(o){b.current=!1,u.current=[o.x,o.y],g.current=[[...t.point1.coords.scrCoords],[...t.point2.coords.scrCoords]],p({action:h.mouseDownOnRay})}),C.current=e.showLabel&&e.labelForGraph!=="",r.current=t}function R(){r.current.off("drag"),r.current.off("down"),r.current.off("up"),s.removeObject(r.current),r.current=null}function F(i){var l=s.origin.scrCoords;let c=[];for(let t=0;t<2;t++){let o=(g.current[t][1]+i.x-u.current[0]-l[1])/s.unitX,f=(l[2]-(g.current[t][2]+i.y-u.current[1]))/s.unitY;c.push([o,f])}return c}if(s)if(r.current===null)E();else if(e.numericalEndpoint.length!==2||e.numericalThroughpoint.length!==2)R();else{let i=!0;for(let y of[e.numericalEndpoint,e.numericalThroughpoint])Number.isFinite(y[0])||(i=!1),Number.isFinite(y[1])||(i=!1);r.current.point1.coords.setCoordinates(JXG.COORDS_BY_USER,e.numericalEndpoint),r.current.point2.coords.setCoordinates(JXG.COORDS_BY_USER,e.numericalThroughpoint);let l=!e.hidden;if(i){let y=r.current.visProp.visible!==l;r.current.visProp.visible=l,r.current.visPropCalc.visible=l,y&&r.current.setAttribute({visible:l})}else r.current.visProp.visible=!1,r.current.visPropCalc.visible=!1;let c=!e.draggable||e.fixed;r.current.visProp.fixed=c,r.current.visProp.highlight=!c;let t=10*e.layer+k;r.current.visProp.layer!==t&&r.current.setAttribute({layer:t}),r.current.visProp.strokecolor!==e.selectedStyle.lineColor&&(r.current.visProp.strokecolor=e.selectedStyle.lineColor,r.current.visProp.highlightstrokecolor=e.selectedStyle.lineColor),r.current.visProp.strokewidth!==e.selectedStyle.lineWidth&&(r.current.visProp.strokewidth=e.selectedStyle.lineWidth,r.current.visProp.highlightstrokewidth=e.selectedStyle.lineWidth),r.current.visProp.strokeopacity!==e.selectedStyle.lineOpacity&&(r.current.visProp.strokeopacity=e.selectedStyle.lineOpacity,r.current.visProp.highlightstrokeopacity=e.selectedStyle.lineOpacity*.5);let f=O(e.selectedStyle.lineStyle);r.current.visProp.dash!==f&&(r.current.visProp.dash=f),r.current.name=e.labelForGraph;let S=e.showLabel&&e.labelForGraph!=="";S!=C.current&&(r.current.setAttribute({withlabel:S}),C.current=S),r.current.needsUpdate=!0,r.current.update(),r.current.hasLabel&&(e.applyStyleToLabel?r.current.label.visProp.strokecolor=e.selectedStyle.lineColor:r.current.label.visProp.strokecolor="#000000",r.current.label.needsUpdate=!0,r.current.label.update()),s.updateRenderer()}return e.hidden?null:P(T,{children:P("a",{name:x})})});function O(a){return a==="solid"?0:a==="dashed"?2:a==="dotted"?1:0}export{Y as default};
