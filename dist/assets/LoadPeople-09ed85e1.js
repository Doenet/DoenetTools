import{y as P,R as c,l as k,m as C,a6 as T,r as d,v as S,k as L,n as _,b1 as D,a as n,j as e,B as w,A as F,ag as l,z as N}from"./index-9d63439d.js";import{p as j}from"./index-0a95af27.js";import{B}from"./ButtonGroup-ec02b3e9.js";import{C as z}from"./CollapseSection-3723ca05.js";const J=l({key:"peopleTableDataAtom",default:[]}),V=l({key:"processAtom",default:"Idle"}),K=Object.freeze({Email:"Email",FirstName:"FirstName",LastName:"LastName",Section:"Section",ExternalId:"ExternalId"}),O=l({key:"headersAtom",default:[]}),H=l({key:"entriesAtom",default:[]}),M=l({key:"enrolllearnerAtom",default:""}),W=Object.freeze({IDLE:"idle",SELECT:"select",PREVIEW:"preview"});function Q({style:A}){const x=P(),u=c(V),m=c(O),p=c(H),h=k(C("courseId"));let{canAutoEnroll:r}=T(h);const[i,f]=d.useState(r);d.useEffect(()=>{let s=!1;r=="1"&&(s=!0),f(s)},[r]);const v=S(s=>async(t,a)=>{let o=0;a&&(o=1),await L.post("/api/modifyCourse.php",{courseId:t,canAutoEnroll:o}),s(_,R=>{let E={...R};return E.canAutoEnroll=o,E})}),y=d.useCallback(s=>{const t=new FileReader;t.onabort=()=>{},t.onerror=()=>{},t.onload=()=>{j(t.result,{comment:"#"},function(a,o){a!=null&&a.message?x(`${a.message}. Please reformat and try again`,N.ERROR):(m(o[0]),o.shift(),p(o),u(W.PREVIEW))})},t.readAsText(s[0])},[p,m,u]),{getRootProps:I,getInputProps:b,isDragActive:g}=D({onDrop:y});return n("div",{style:A,children:[n("div",{...I(),children:[e("input",{...b(),"data-test":"Import CSV file"}),g?e("p",{children:"Drop the files here"}):e(B,{vertical:!0,children:e(w,{width:"menu",value:"Import CSV file"})})]},"drop"),e("div",{style:{height:"4px"}}),n(z,{title:"Formatting Instructions",collapsed:!0,style:{marginTop:"12px"},children:[e("p",{children:"Your file needs to contain an email address. The parser will ignore columns which are not listed."}),e("div",{children:e("b",{children:"Email (required)"})}),e("div",{children:e("b",{children:"ExternalId"})}),e("div",{children:e("b",{children:"FirstName"})}),e("div",{children:e("b",{children:"LastName"})}),e("div",{children:e("b",{children:"Section"})})]}),n("p",{style:{display:"flex"},children:[e(F,{dataTest:"Auto Enroll",checked:i,onClick:()=>{f(!i),v(h,!i)}})," ",e("span",{style:{marginLeft:"10px"},children:"Auto Enrollment"})," "]})]})}export{W as csvPeopleProcess,Q as default,M as enrolllearnerAtom,H as entriesAtom,O as headersAtom,J as peopleTableDataAtom,V as processAtom,K as validHeaders};
