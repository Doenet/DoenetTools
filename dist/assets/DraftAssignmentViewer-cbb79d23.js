import{l as i,m as v,w as $,R as B,O as G,r as e,Q,S as T,G as J,v as K,k as U,j as n,F as W}from"./index-9d63439d.js";import{A as X}from"./ActivityViewer-90c65d6d.js";import{r as Y}from"./activityUtils-5d3d0ed0.js";import"./visibility-sensor-aefdbbd5.js";import"./ActionButton-056b08c3.js";import"./ButtonGroup-ec02b3e9.js";function de(){const t=i(v("doenetId")),m=i($),o=i(v("requestedVariant")),S=o&&Number.isFinite(Number(o))?Number(o):1,y=B(G);let[f,r]=e.useState("Initializing"),[I,p]=e.useState("");const[{showCorrectness:V,paginate:A,showFeedback:C,showHints:D,autoSubmit:_,cid:F,doenetId:b,solutionDisplayMode:x},k]=e.useState({});let P=e.useRef([]);Q(t),T(m);let l=i(J(t)),u=l.label;e.useEffect(()=>{const a=document.title;return u&&(document.title=`${u} - Doenet`),()=>{document.title=a}},[u]),e.useEffect(()=>{O(t,l)},[l,t]);function M(a,g){y({index:a,numberOfVariants:g})}const O=K(({snapshot:a,set:g})=>async(w,{type:R,timeLimit:Z,assignedDate:ee,dueDate:te,showCorrectness:E,showCreditAchievedMenu:ae,paginate:L,showFeedback:N,showHints:j,autoSubmit:q,showSolution:z,proctorMakesAvailable:se})=>{if(R===void 0)return;let h="button";z||(h="none");let d=null,s=await U.get("/api/getCidForAssignment.php",{params:{doenetId:w,latestAttemptOverrides:!1,getDraft:!0}});if(!s.data.success||!s.data.cid){r("Problem"),p(`Error loading assignment: ${s.data.message}`);return}else d=s.data.cid;let c=await Y(d);if(!c.success){r("Problem"),p(c.message);return}P.current=[...Array(c.numberOfVariants).keys()].map(H=>H+1),k({showCorrectness:E,paginate:L,showFeedback:N,showHints:j,autoSubmit:q,cid:d,doenetId:w,solutionDisplayMode:h}),r("Ready")},[]);return t===""?null:m==="__not_found__"?n("h1",{children:"Content not found or no permission to view content"}):f==="Initializing"?null:f==="Problem"?n("h1",{children:I}):n(W,{children:n(X,{cid:F,doenetId:b,flags:{showCorrectness:V,readOnly:!1,solutionDisplayMode:x,showFeedback:C,showHints:D,autoSubmit:_,allowLoadState:!1,allowSaveState:!1,allowLocalState:!1,allowSaveSubmissions:!1,allowSaveEvents:!1},requestedVariantIndex:S,generatedVariantCallback:M,paginate:A},`activityViewer${b}`)})}export{de as default};
