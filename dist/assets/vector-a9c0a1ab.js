import{aw as K,bn as Q,r as l,j as E,F as W,a as Z,b9 as $}from"./index-0510454e.js";import{BoardContext as ee,LINE_LAYER_OFFSET as B,VERTEX_LAYER_OFFSET as T}from"./graph-de5d5149.js";import"./css-14ccef8c.js";import"./visibility-sensor-42a61489.js";const oe=K.memo(function P(N){let{name:L,id:G,SVs:e,actions:u,sourceOfUpdate:X,callAction:d}=Q(N);P.ignoreActionsWithoutCore=!0;const n=l.useContext(ee);let t=l.useRef({}),o=l.useRef({}),i=l.useRef({}),m=l.useRef(!1),j=l.useRef(!1),c=l.useRef(!1),a=l.useRef(!1),O=l.useRef(null),D=l.useRef(null),k=l.useRef(null),_=l.useRef(!1),A=l.useRef(null);A.current=e.numericalEndpoints,l.useEffect(()=>()=>{Object.keys(t.current).length!==0&&U()},[]);function z(){if(e.numericalEndpoints.length!==2||e.numericalEndpoints.some(r=>r.length!==2)){t.current={},o.current={},i.current={};return}let f=10*e.layer+B,p=10*e.layer+T,v=!e.draggable||e.fixed;var h={name:e.labelForGraph,visible:!e.hidden,withLabel:e.showLabel&&e.labelForGraph!=="",fixed:v,layer:f,strokeColor:e.selectedStyle.lineColor,strokeOpacity:e.selectedStyle.lineOpacity,highlightStrokeColor:e.selectedStyle.lineColor,highlightStrokeOpacity:e.selectedStyle.lineOpacity*.5,strokeWidth:e.selectedStyle.lineWidth,highlightStrokeWidth:e.selectedStyle.lineWidth,dash:M(e.selectedStyle.lineStyle),highlight:!v,lastArrow:{type:1,size:3,highlightSize:3}};let C=[[...e.numericalEndpoints[0]],[...e.numericalEndpoints[1]]],w=Object.assign({},h);Object.assign(w,{withLabel:!1,fixed:!1,highlight:!0,fillColor:"none",strokeColor:"none",highlightStrokeColor:"none",highlightFillColor:getComputedStyle(document.documentElement).getPropertyValue("--mainGray"),layer:p});let R=Object.assign({},w),I=e.tailDraggable&&!e.fixed&&!e.hidden;R.visible=I;let g=n.create("point",C[0],R),S=Object.assign({},w),q=e.headDraggable&&!e.fixed&&!e.hidden;S.visible=q;let x=n.create("point",C[1],S);h.label={highlight:!1},e.labelHasLatex&&(h.label.useMathJax=!0),e.applyStyleToLabel?h.label.strokeColor=e.selectedStyle.lineColor:h.label.strokeColor="#000000";let s=n.create("arrow",[g,x],h);g.on("drag",r=>F(r,0)),x.on("drag",r=>F(r,1)),s.on("drag",r=>F(r,-1)),g.on("up",r=>{!c.current&&a.current?d({action:u.moveVector,args:{tailcoords:k.current}}):!c.current&&!a.current&&d({action:u.vectorClicked}),O.current=null}),x.on("up",r=>{c.current&&!a.current?d({action:u.moveVector,args:{headcoords:D.current}}):!c.current&&!a.current&&d({action:u.vectorClicked}),O.current=null}),s.on("up",r=>{c.current&&a.current?d({action:u.moveVector,args:{headcoords:D.current,tailcoords:k.current}}):!c.current&&!a.current&&O.current===null&&d({action:u.vectorClicked})}),g.on("down",function(r){c.current=!1,a.current=!1,m.current=[r.x,r.y],O.current=1,d({action:u.mouseDownOnVector})}),x.on("down",function(r){c.current=!1,a.current=!1,m.current=[r.x,r.y],O.current=2,d({action:u.mouseDownOnVector})}),s.on("down",function(r){c.current=!1,a.current=!1,m.current=[r.x,r.y],j.current=[[...s.point1.coords.scrCoords],[...s.point2.coords.scrCoords]],d({action:u.mouseDownOnVector})});function F(r,y){if(Math.abs(r.x-m.current[0])>.1||Math.abs(r.y-m.current[1])>.1){y===0?a.current=!0:y===1?c.current=!0:(c.current=!0,a.current=!0);let V={transient:!0,skippable:!0};c.current&&(y===-1?D.current=Y(r,1):D.current=[s.point2.X(),s.point2.Y()],V.headcoords=D.current),a.current&&(y===-1?k.current=Y(r,0):k.current=[s.point1.X(),s.point1.Y()],V.tailcoords=k.current),(y===0||y===1)&&(V.sourceDetails={vertex:y}),d({action:u.moveVector,args:V}),s.point1.coords.setCoordinates(JXG.COORDS_BY_USER,A.current[0]),s.point2.coords.setCoordinates(JXG.COORDS_BY_USER,A.current[1]),y===0?n.updateInfobox(g):y===1&&n.updateInfobox(x)}}t.current=s,o.current=g,i.current=x}function U(){t.current.off("drag"),t.current.off("down"),t.current.off("up"),n.removeObject(t.current),t.current={},o.current.off("drag"),o.current.off("down"),o.current.off("up"),n.removeObject(o.current),o.current={},i.current.off("drag"),i.current.off("down"),i.current.off("up"),n.removeObject(i.current),i.current={}}function Y(f,p){var v=n.origin.scrCoords;let h=(j.current[p][1]+f.x-m.current[0]-v[1])/n.unitX,C=(v[2]-(j.current[p][2]+f.y-m.current[1]))/n.unitY;return[h,C]}if(n){if(Object.keys(t.current).length===0)z();else if(e.numericalEndpoints.length!==2||e.numericalEndpoints.some(f=>f.length!==2))U();else{let f=!0;for(let b of[e.numericalEndpoints[0],e.numericalEndpoints[1]])Number.isFinite(b[0])||(f=!1),Number.isFinite(b[1])||(f=!1);t.current.point1.coords.setCoordinates(JXG.COORDS_BY_USER,e.numericalEndpoints[0]),t.current.point2.coords.setCoordinates(JXG.COORDS_BY_USER,e.numericalEndpoints[1]);let p=!e.hidden&&f,v=!e.draggable||e.fixed,C=e.tailDraggable&&!e.fixed&&p,R=e.headDraggable&&!e.fixed&&p;if(t.current.visProp.fixed=v,t.current.visProp.highlight=!v,t.current.visProp.visible=p,t.current.visPropCalc.visible=p,o.current.visProp.visible=C,o.current.visPropCalc.visible=C,i.current.visProp.visible=R,i.current.visPropCalc.visible=R,X.sourceInformation&&L in X.sourceInformation){let b=X.sourceInformation[L];b.vertex===0?n.updateInfobox(o.current):b.vertex===1&&n.updateInfobox(i.current)}let J=10*e.layer+B;if(t.current.visProp.layer!==J){let b=10*e.layer+T;t.current.setAttribute({layer:J}),o.current.setAttribute({layer:b}),i.current.setAttribute({layer:b})}t.current.visProp.strokecolor!==e.selectedStyle.lineColor&&(t.current.visProp.strokecolor=e.selectedStyle.lineColor,t.current.visProp.highlightstrokecolor=e.selectedStyle.lineColor),t.current.visProp.strokewidth!==e.selectedStyle.lineWidth&&(t.current.visProp.strokewidth=e.selectedStyle.lineWidth,t.current.visProp.highlightstrokewidth=e.selectedStyle.lineWidth),t.current.visProp.strokeopacity!==e.selectedStyle.lineOpacity&&(t.current.visProp.strokeopacity=e.selectedStyle.lineOpacity,t.current.visProp.highlightstrokeopacity=e.selectedStyle.lineOpacity*.5);let g=M(e.selectedStyle.lineStyle);t.current.visProp.dash!==g&&(t.current.visProp.dash=g),t.current.name=e.labelForGraph;let S=e.showLabel&&e.labelForGraph!=="";S!=_.current&&(t.current.setAttribute({withlabel:S}),_.current=S),t.current.needsUpdate=!0,t.current.update(),t.current.hasLabel&&(e.applyStyleToLabel?t.current.label.visProp.strokecolor=e.selectedStyle.lineColor:t.current.label.visProp.strokecolor="#000000",t.current.label.needsUpdate=!0,t.current.label.update()),o.current.needsUpdate=!0,o.current.update(),i.current.needsUpdate=!0,i.current.update(),n.updateRenderer()}return E(W,{children:E("a",{name:G})})}if(e.hidden)return null;let H="\\("+e.latex+"\\)";return Z(W,{children:[E("a",{name:G}),E("span",{id:G,children:E($.MathJax,{hideUntilTypeset:"first",inline:!0,dynamic:!0,children:H})})]})});function M(P){return P==="solid"?0:P==="dashed"?2:P==="dotted"?1:0}export{oe as default};
