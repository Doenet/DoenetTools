import{e as g,s as j,o as w,g as f,a as c,F as y,j as a,B as C,H as D,bk as _,aP as k}from"./index-e270c841.js";import{c as m}from"./Next7Days-aec6d3d9.js";import{D as B}from"./DropdownMenu-54976458.js";import{D as v}from"./DateTime-7404cc4e.js";import"./CourseToolHandler-e9750324.js";import"./index-47ca4f11.js";import"./index.esm-cb7dab05.js";/* empty css             */import"./RoleDropdown-f01dbe41.js";import"./moment-a73a67ec.js";function N(){const A=g(m),u=g(j("courseId")),P=w(({set:t,snapshot:e})=>async n=>{let l=[...await e.getPromise(m)];l.push({dotwIndex:1,startTime:"09:00",endTime:"10:00"}),t(m,l);let d=[],s=[],i=[];for(let r of l)d.push(r.dotwIndex),s.push(r.startTime),i.push(r.endTime);await f.post("/api/updateClassTimes.php",{courseId:n,dotwIndexes:d,startTimes:s,endTimes:i})}),T=w(({set:t,snapshot:e})=>async({index:n,nextClassTime:o,courseId:l})=>{let s=[...await e.getPromise(m)];s[n]={...o},t(m,s);let i=[],r=[],p=[];for(let x of s)i.push(x.dotwIndex),r.push(x.startTime),p.push(x.endTime);await f.post("/api/updateClassTimes.php",{courseId:l,dotwIndexes:i,startTimes:r,endTimes:p})}),S=w(({set:t,snapshot:e})=>async({index:n,courseId:o})=>{let d=[...await e.getPromise(m)];d.splice(n,1),t(m,d);let s=[],i=[],r=[];for(let p of d)s.push(p.dotwIndex),i.push(p.startTime),r.push(p.endTime);await f.post("/api/updateClassTimes.php",{courseId:o,dotwIndexes:s,startTimes:i,endTimes:r})}),b=[[1,"Monday"],[2,"Tuesday"],[3,"Wednesday"],[4,"Thursday"],[5,"Friday"],[6,"Saturday"],[0,"Sunday"]];let h=[];for(let[t,e]of Object.entries(A)){const n=new Date;n.setHours(e.startTime.split(":")[0]),n.setMinutes(e.startTime.split(":")[1]);const o=new Date;o.setHours(e.endTime.split(":")[0]),o.setMinutes(e.endTime.split(":")[1]);let l=e.dotwIndex;e.dotwIndex==0&&(l=7),h.push(c(y,{children:[c("tr",{children:[a("td",{style:{width:"190px"},children:a(B,{dataTest:`DOTW Dropdown ${t}`,width:"180px",items:b,valueIndex:l,onChange:({value:d})=>{let s={...e};s.dotwIndex=d,T({courseId:u,index:t,nextClassTime:s})}})}),a(C,{dataTest:`Classtime Delete Button ${t}`,icon:a(D,{icon:k}),alert:!0,onClick:()=>{S({index:t,courseId:u})}})]}),c("tr",{style:{width:"190px",display:"flex",alignItems:"center"},children:[a("td",{children:a(v,{dataTest:`Classtime start time ${t}`,datePicker:!1,width:"74px",value:n,onBlur:(d,s)=>{let i={...e};i.startTime=new Date(d.value._d).toLocaleString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),T({courseId:u,index:t,nextClassTime:i})}})}),a("td",{style:{marginLeft:"6px",marginRight:"6px"},children:"-"}),a("td",{style:{["--menuPanelMargin"]:"-62px"},children:a(v,{dataTest:`Classtime end time ${t}`,datePicker:!1,width:"74px",value:o,onBlur:(d,s)=>{let i={...e};i.endTime=new Date(d.value._d).toLocaleString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),T({courseId:u,index:t,nextClassTime:i})}})})]}),a("div",{style:{margin:"10px"}})]}))}let I=a("div",{children:"No times set."});return h.length>0&&(I=a("table",{style:{width:"230px",margins:"5px"},children:h})),c(y,{children:[I,a(C,{dataTest:"Add Classtime",icon:a(D,{icon:_}),style:{margin:"auto"},onClick:()=>P(u)})]})}export{N as default};
