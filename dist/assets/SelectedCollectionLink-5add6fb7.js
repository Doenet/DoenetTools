import{l as r,V as L,H as C,m as k,r as I,a6 as x,z as M,a as m,j as t,i as S,a0 as O,F as f,D as B,B as h,bj as j}from"./index-1922ac75.js";import"./ActionButton-dfcbbba6.js";import{T as w}from"./Textfield-38f593f0.js";import{R as y}from"./RelatedItems-cf1e4171.js";import{e as A}from"./RoleDropdown-6fa5bb93.js";import"./DropdownMenu-98de19a9.js";import"./setPrototypeOf-51e8cf87.js";function T({courseId:n,selectedDoenetId:e}){let o=r(j(n)),i=[];for(let[s,a]of o.entries())e==a.doenetId?i.push(t("option",{selected:!0,value:a.doenetId,children:a.label},`CollectionOptions${s}`)):i.push(t("option",{value:a.doenetId,children:a.label},`CollectionOptions${s}`));return t(f,{children:i})}function R({selected:n,i:e,pageId:o}){let i=r(C(o));return n?t("option",{selected:!0,value:o,children:i.label},`PagesInACollection${e}`):t("option",{value:o,children:i.label},`PagesInACollection${e}`)}function H(){const n=r(L)[0],e=r(C(n)),o=r(k("courseId")),{canEditContent:i}=r(A(o)),[s,a]=I.useState(e.label);let{deleteItem:F,updateCollectionLink:c,updateContentLinksToSources:v}=x(o);I.useEffect(()=>{s!==e.label&&a(e.label)},[n]);const b=()=>{let l=s;s===""&&(l=e.label,e.label===""&&(l="Untitled Collection Link"),a(l)),e.label!==l&&(console.log("Rename",n,l),c({courseId:o,doenetId:n,label:l,collectionDoenetId:e.collectionDoenetId,isManuallyFiltered:e.isManuallyFiltered,manuallyFilteredPages:e.manuallyFilteredPages}))};M();let D=m("h2",{"data-test":"infoPanelItemLabel",style:{margin:"16px 5px"},children:[t(S,{icon:O})," ",e.label]});if(i!=="1")return null;let P=t(T,{courseId:o,selectedDoenetId:e.collectionDoenetId}),g=null;if(e.collectionDoenetId){let l=[];for(let[p,d]of Object.entries(e.pagesByCollectionSource[e.collectionDoenetId])){let u=!1;e!=null&&e.manuallyFilteredPages&&e.manuallyFilteredPages.includes(d)&&(u=!0),l.push(t(R,{selected:u,i:p,pageId:d}))}g=m(f,{children:[m("div",{style:{display:"flex"},children:[t(B,{style:{marginRight:"5px"},checked:e.isManuallyFiltered,onClick:()=>{c({courseId:o,doenetId:n,collectionDoenetId:e.collectionDoenetId,isManuallyFiltered:!e.isManuallyFiltered,manuallyFilteredPages:e.manuallyFilteredPages})}}),"Filter Page Links"]}),t(y,{width:"menu",options:l,disabled:!e.isManuallyFiltered,onChange:p=>{let d=Array.from(p.target.selectedOptions,u=>u.value);c({courseId:o,doenetId:n,collectionDoenetId:e.collectionDoenetId,isManuallyFiltered:e.isManuallyFiltered,manuallyFilteredPages:d})},multiple:!0}),t("br",{})]})}return m(f,{children:[D,t(w,{label:"Label",vertical:!0,width:"menu",dataTest:"Label Collection",value:s,onChange:l=>a(l.target.value),onKeyDown:l=>{l.keyCode===13&&b()},onBlur:b}),t("br",{}),t("br",{}),t("div",{children:"collection"}),t(y,{width:"menu",options:P,onChange:l=>{c({courseId:o,doenetId:n,collectionDoenetId:l.target.value,isManuallyFiltered:!1,manuallyFilteredPages:[]})}}),t("br",{}),g,t("br",{}),t(h,{width:"menu",value:"Update Content to Sources",onClick:l=>{l.preventDefault(),l.stopPropagation(),v({collectionLinkObj:e,pages:e.pages})}}),t("br",{}),t(h,{width:"menu",value:"Delete Collection Link",alert:!0,onClick:l=>{l.preventDefault(),l.stopPropagation(),F({doenetId:n})}})]})}export{H as default};
