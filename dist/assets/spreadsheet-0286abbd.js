import{aa as Vp,av as Et,bB as mM,bn as Nj,r as Lj,j as Od,a as jj,bC as Bj}from"./index-ab5ab855.js";import{h as Xe,c as bu,r as Fj}from"./moment-ab7a1b12.js";import{s as DO}from"./css-14ccef8c.js";import{V as Vj}from"./visibility-sensor-7b80a154.js";var wu=function(e){return e&&e.Math==Math&&e},et=wu(typeof globalThis=="object"&&globalThis)||wu(typeof window=="object"&&window)||wu(typeof self=="object"&&self)||wu(typeof Vp=="object"&&Vp)||function(){return this}()||Function("return this")(),nn={},Le=function(e){try{return!!e()}catch{return!0}},Wj=Le,St=!Wj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Uj=Le,Ds=!Uj(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),zj=Ds,Su=Function.prototype.call,kt=zj?Su.bind(Su):function(){return Su.apply(Su,arguments)},Hs={},bM={}.propertyIsEnumerable,wM=Object.getOwnPropertyDescriptor,Gj=wM&&!bM.call({1:2},1);Hs.f=Gj?function(t){var r=wM(this,t);return!!r&&r.enumerable}:bM;var Ns=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},SM=Ds,CM=Function.prototype,Wp=CM.call,Yj=SM&&CM.bind.bind(Wp,Wp),_M=SM?Yj:function(e){return function(){return Wp.apply(e,arguments)}},OM=_M,Kj=OM({}.toString),Xj=OM("".slice),Un=function(e){return Xj(Kj(e),8,-1)},qj=Un,Qj=_M,He=function(e){if(qj(e)==="Function")return Qj(e)},Zj=He,Jj=Le,eB=Un,Rd=Object,tB=Zj("".split),Ls=Jj(function(){return!Rd("z").propertyIsEnumerable(0)})?function(e){return eB(e)=="String"?tB(e,""):Rd(e)}:Rd,Nr=function(e){return e==null},rB=Nr,nB=TypeError,rr=function(e){if(rB(e))throw nB("Can't call method on "+e);return e},oB=Ls,iB=rr,dr=function(e){return oB(iB(e))},Up=typeof document=="object"&&document.all,aB=typeof Up>"u"&&Up!==void 0,RM={all:Up,IS_HTMLDDA:aB},EM=RM,lB=EM.all,ut=EM.IS_HTMLDDA?function(e){return typeof e=="function"||e===lB}:function(e){return typeof e=="function"},HO=ut,TM=RM,sB=TM.all,mt=TM.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:HO(e)||e===sB}:function(e){return typeof e=="object"?e!==null:HO(e)},Ed=et,uB=ut,cB=function(e){return uB(e)?e:void 0},on=function(e,t){return arguments.length<2?cB(Ed[e]):Ed[e]&&Ed[e][t]},fB=He,Ro=fB({}.isPrototypeOf),hB=on,Li=hB("navigator","userAgent")||"",kM=et,Td=Li,NO=kM.process,LO=kM.Deno,jO=NO&&NO.versions||LO&&LO.version,BO=jO&&jO.v8,$r,lf;BO&&($r=BO.split("."),lf=$r[0]>0&&$r[0]<4?1:+($r[0]+$r[1]));!lf&&Td&&($r=Td.match(/Edge\/(\d+)/),(!$r||$r[1]>=74)&&($r=Td.match(/Chrome\/(\d+)/),$r&&(lf=+$r[1])));var js=lf,FO=js,dB=Le,sl=!!Object.getOwnPropertySymbols&&!dB(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&FO&&FO<41}),vB=sl,PM=vB&&!Symbol.sham&&typeof Symbol.iterator=="symbol",pB=on,gB=ut,yB=Ro,mB=PM,bB=Object,Bs=mB?function(e){return typeof e=="symbol"}:function(e){var t=pB("Symbol");return gB(t)&&yB(t.prototype,bB(e))},wB=String,ul=function(e){try{return wB(e)}catch{return"Object"}},SB=ut,CB=ul,_B=TypeError,cl=function(e){if(SB(e))return e;throw _B(CB(e)+" is not a function")},OB=cl,RB=Nr,ji=function(e,t){var r=e[t];return RB(r)?void 0:OB(r)},kd=kt,Pd=ut,Ad=mt,EB=TypeError,TB=function(e,t){var r,n;if(t==="string"&&Pd(r=e.toString)&&!Ad(n=kd(r,e))||Pd(r=e.valueOf)&&!Ad(n=kd(r,e))||t!=="string"&&Pd(r=e.toString)&&!Ad(n=kd(r,e)))return n;throw EB("Can't convert object to primitive value")},_o={},kB={get exports(){return _o},set exports(e){_o=e}},VO=et,PB=Object.defineProperty,gS=function(e,t){try{PB(VO,e,{value:t,configurable:!0,writable:!0})}catch{VO[e]=t}return t},AB=et,IB=gS,WO="__core-js_shared__",$B=AB[WO]||IB(WO,{}),yS=$B,UO=yS;(kB.exports=function(e,t){return UO[e]||(UO[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.26.0",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"});var MB=rr,xB=Object,nr=function(e){return xB(MB(e))},DB=He,HB=nr,NB=DB({}.hasOwnProperty),bt=Object.hasOwn||function(t,r){return NB(HB(t),r)},LB=He,jB=0,BB=Math.random(),FB=LB(1 .toString),Sh=function(e){return"Symbol("+(e===void 0?"":e)+")_"+FB(++jB+BB,36)},VB=et,WB=_o,zO=bt,UB=Sh,GO=sl,AM=PM,Qi=WB("wks"),wi=VB.Symbol,YO=wi&&wi.for,zB=AM?wi:wi&&wi.withoutSetter||UB,lt=function(e){if(!zO(Qi,e)||!(GO||typeof Qi[e]=="string")){var t="Symbol."+e;GO&&zO(wi,e)?Qi[e]=wi[e]:AM&&YO?Qi[e]=YO(t):Qi[e]=zB(t)}return Qi[e]},GB=kt,KO=mt,XO=Bs,YB=ji,KB=TB,XB=lt,qB=TypeError,QB=XB("toPrimitive"),IM=function(e,t){if(!KO(e)||XO(e))return e;var r=YB(e,QB),n;if(r){if(t===void 0&&(t="default"),n=GB(r,e,t),!KO(n)||XO(n))return n;throw qB("Can't convert object to primitive value")}return t===void 0&&(t="number"),KB(e,t)},ZB=IM,JB=Bs,Ch=function(e){var t=ZB(e,"string");return JB(t)?t:t+""},eF=et,qO=mt,zp=eF.document,tF=qO(zp)&&qO(zp.createElement),_h=function(e){return tF?zp.createElement(e):{}},rF=St,nF=Le,oF=_h,$M=!rF&&!nF(function(){return Object.defineProperty(oF("div"),"a",{get:function(){return 7}}).a!=7}),iF=St,aF=kt,lF=Hs,sF=Ns,uF=dr,cF=Ch,fF=bt,hF=$M,QO=Object.getOwnPropertyDescriptor;nn.f=iF?QO:function(t,r){if(t=uF(t),r=cF(r),hF)try{return QO(t,r)}catch{}if(fF(t,r))return sF(!aF(lF.f,t,r),t[r])};var Nt={},dF=St,vF=Le,MM=dF&&vF(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),pF=mt,gF=String,yF=TypeError,Ct=function(e){if(pF(e))return e;throw yF(gF(e)+" is not an object")},mF=St,bF=$M,wF=MM,Cu=Ct,ZO=Ch,SF=TypeError,Id=Object.defineProperty,CF=Object.getOwnPropertyDescriptor,$d="enumerable",Md="configurable",xd="writable";Nt.f=mF?wF?function(t,r,n){if(Cu(t),r=ZO(r),Cu(n),typeof t=="function"&&r==="prototype"&&"value"in n&&xd in n&&!n[xd]){var o=CF(t,r);o&&o[xd]&&(t[r]=n.value,n={configurable:Md in n?n[Md]:o[Md],enumerable:$d in n?n[$d]:o[$d],writable:!1})}return Id(t,r,n)}:Id:function(t,r,n){if(Cu(t),r=ZO(r),Cu(n),bF)try{return Id(t,r,n)}catch{}if("get"in n||"set"in n)throw SF("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var _F=St,OF=Nt,RF=Ns,Bi=_F?function(e,t,r){return OF.f(e,t,RF(1,r))}:function(e,t,r){return e[t]=r,e},Gp={},EF={get exports(){return Gp},set exports(e){Gp=e}},Yp=St,TF=bt,xM=Function.prototype,kF=Yp&&Object.getOwnPropertyDescriptor,mS=TF(xM,"name"),PF=mS&&function(){}.name==="something",AF=mS&&(!Yp||Yp&&kF(xM,"name").configurable),Fs={EXISTS:mS,PROPER:PF,CONFIGURABLE:AF},IF=He,$F=ut,Kp=yS,MF=IF(Function.toString);$F(Kp.inspectSource)||(Kp.inspectSource=function(e){return MF(e)});var DM=Kp.inspectSource,xF=et,DF=ut,JO=xF.WeakMap,HM=DF(JO)&&/native code/.test(String(JO)),HF=_o,NF=Sh,eR=HF("keys"),Oh=function(e){return eR[e]||(eR[e]=NF(e))},Vs={},LF=HM,NM=et,jF=mt,BF=Bi,Dd=bt,Hd=yS,FF=Oh,VF=Vs,tR="Object already initialized",Xp=NM.TypeError,WF=NM.WeakMap,sf,vs,uf,UF=function(e){return uf(e)?vs(e):sf(e,{})},zF=function(e){return function(t){var r;if(!jF(t)||(r=vs(t)).type!==e)throw Xp("Incompatible receiver, "+e+" required");return r}};if(LF||Hd.state){var jr=Hd.state||(Hd.state=new WF);jr.get=jr.get,jr.has=jr.has,jr.set=jr.set,sf=function(e,t){if(jr.has(e))throw Xp(tR);return t.facade=e,jr.set(e,t),t},vs=function(e){return jr.get(e)||{}},uf=function(e){return jr.has(e)}}else{var Zi=FF("state");VF[Zi]=!0,sf=function(e,t){if(Dd(e,Zi))throw Xp(tR);return t.facade=e,BF(e,Zi,t),t},vs=function(e){return Dd(e,Zi)?e[Zi]:{}},uf=function(e){return Dd(e,Zi)}}var zn={set:sf,get:vs,has:uf,enforce:UF,getterFor:zF},GF=Le,YF=ut,_u=bt,qp=St,KF=Fs.CONFIGURABLE,XF=DM,LM=zn,qF=LM.enforce,QF=LM.get,Cc=Object.defineProperty,ZF=qp&&!GF(function(){return Cc(function(){},"length",{value:8}).length!==8}),JF=String(String).split("String"),eV=EF.exports=function(e,t,r){String(t).slice(0,7)==="Symbol("&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!_u(e,"name")||KF&&e.name!==t)&&(qp?Cc(e,"name",{value:t,configurable:!0}):e.name=t),ZF&&r&&_u(r,"arity")&&e.length!==r.arity&&Cc(e,"length",{value:r.arity});try{r&&_u(r,"constructor")&&r.constructor?qp&&Cc(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=qF(e);return _u(n,"source")||(n.source=JF.join(typeof t=="string"?t:"")),e};Function.prototype.toString=eV(function(){return YF(this)&&QF(this).source||XF(this)},"toString");var tV=ut,rV=Nt,nV=Gp,oV=gS,_r=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(tV(r)&&nV(r,i,n),n.global)o?e[t]=r:oV(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:rV.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Fi={},iV=Math.ceil,aV=Math.floor,lV=Math.trunc||function(t){var r=+t;return(r>0?aV:iV)(r)},sV=lV,Eo=function(e){var t=+e;return t!==t||t===0?0:sV(t)},uV=Eo,cV=Math.max,fV=Math.min,Ws=function(e,t){var r=uV(e);return r<0?cV(r+t,0):fV(r,t)},hV=Eo,dV=Math.min,Vi=function(e){return e>0?dV(hV(e),9007199254740991):0},vV=Vi,Or=function(e){return vV(e.length)},pV=dr,gV=Ws,yV=Or,rR=function(e){return function(t,r,n){var o=pV(t),i=yV(o),a=gV(n,i),l;if(e&&r!=r){for(;i>a;)if(l=o[a++],l!=l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},bS={includes:rR(!0),indexOf:rR(!1)},mV=He,Nd=bt,bV=dr,wV=bS.indexOf,SV=Vs,nR=mV([].push),jM=function(e,t){var r=bV(e),n=0,o=[],i;for(i in r)!Nd(SV,i)&&Nd(r,i)&&nR(o,i);for(;t.length>n;)Nd(r,i=t[n++])&&(~wV(o,i)||nR(o,i));return o},wS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],CV=jM,_V=wS,OV=_V.concat("length","prototype");Fi.f=Object.getOwnPropertyNames||function(t){return CV(t,OV)};var Us={};Us.f=Object.getOwnPropertySymbols;var RV=on,EV=He,TV=Fi,kV=Us,PV=Ct,AV=EV([].concat),BM=RV("Reflect","ownKeys")||function(t){var r=TV.f(PV(t)),n=kV.f;return n?AV(r,n(t)):r},oR=bt,IV=BM,$V=nn,MV=Nt,FM=function(e,t,r){for(var n=IV(t),o=MV.f,i=$V.f,a=0;a<n.length;a++){var l=n[a];!oR(e,l)&&!(r&&oR(r,l))&&o(e,l,i(t,l))}},xV=Le,DV=ut,HV=/#|\.prototype\./,zs=function(e,t){var r=LV[NV(e)];return r==BV?!0:r==jV?!1:DV(t)?xV(t):!!t},NV=zs.normalize=function(e){return String(e).replace(HV,".").toLowerCase()},LV=zs.data={},jV=zs.NATIVE="N",BV=zs.POLYFILL="P",Rh=zs,Ld=et,FV=nn.f,VV=Bi,WV=_r,UV=gS,zV=FM,GV=Rh,Ae=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,c;if(n?a=Ld:o?a=Ld[r]||UV(r,{}):a=(Ld[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(c=FV(a,l),s=c&&c.value):s=a[l],i=GV(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;zV(u,s)}(e.sham||s&&s.sham)&&VV(u,"sham",!0),WV(a,l,u,e)}},YV=Le,VM=!YV(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),KV=bt,XV=ut,qV=nr,QV=Oh,ZV=VM,iR=QV("IE_PROTO"),Qp=Object,JV=Qp.prototype,Eh=ZV?Qp.getPrototypeOf:function(e){var t=qV(e);if(KV(t,iR))return t[iR];var r=t.constructor;return XV(r)&&t instanceof r?r.prototype:t instanceof Qp?JV:null},eW=Ae,tW=Le,rW=nr,WM=Eh,nW=VM,oW=tW(function(){WM(1)});eW({target:"Object",stat:!0,forced:oW,sham:!nW},{getPrototypeOf:function(t){return WM(rW(t))}});var SS={},iW=jM,aW=wS,Gs=Object.keys||function(t){return iW(t,aW)},lW=St,sW=MM,uW=Nt,cW=Ct,fW=dr,hW=Gs;SS.f=lW&&!sW?Object.defineProperties:function(t,r){cW(t);for(var n=fW(r),o=hW(r),i=o.length,a=0,l;i>a;)uW.f(t,l=o[a++],n[l]);return t};var dW=on,UM=dW("document","documentElement"),vW=Ct,pW=SS,aR=wS,gW=Vs,yW=UM,mW=_h,bW=Oh,lR=">",sR="<",Zp="prototype",Jp="script",zM=bW("IE_PROTO"),jd=function(){},GM=function(e){return sR+Jp+lR+e+sR+"/"+Jp+lR},uR=function(e){e.write(GM("")),e.close();var t=e.parentWindow.Object;return e=null,t},wW=function(){var e=mW("iframe"),t="java"+Jp+":",r;return e.style.display="none",yW.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(GM("document.F=Object")),r.close(),r.F},Ou,_c=function(){try{Ou=new ActiveXObject("htmlfile")}catch{}_c=typeof document<"u"?document.domain&&Ou?uR(Ou):wW():uR(Ou);for(var e=aR.length;e--;)delete _c[Zp][aR[e]];return _c()};gW[zM]=!0;var fl=Object.create||function(t,r){var n;return t!==null?(jd[Zp]=vW(t),n=new jd,jd[Zp]=null,n[zM]=t):n=_c(),r===void 0?n:pW.f(n,r)},SW=lt,CW=fl,_W=Nt.f,eg=SW("unscopables"),tg=Array.prototype;tg[eg]==null&&_W(tg,eg,{configurable:!0,value:CW(null)});var Ys=function(e){tg[eg][e]=!0},OW=Ae,RW=bS.includes,EW=Le,TW=Ys,kW=EW(function(){return!Array(1).includes()});OW({target:"Array",proto:!0,forced:kW},{includes:function(t){return RW(this,t,arguments.length>1?arguments[1]:void 0)}});TW("includes");var PW=mt,AW=Un,IW=lt,$W=IW("match"),CS=function(e){var t;return PW(e)&&((t=e[$W])!==void 0?!!t:AW(e)=="RegExp")},MW=CS,xW=TypeError,_S=function(e){if(MW(e))throw xW("The method doesn't accept regular expressions");return e},DW=lt,HW=DW("toStringTag"),YM={};YM[HW]="z";var OS=String(YM)==="[object z]",NW=OS,LW=ut,Oc=Un,jW=lt,BW=jW("toStringTag"),FW=Object,VW=Oc(function(){return arguments}())=="Arguments",WW=function(e,t){try{return e[t]}catch{}},Th=NW?Oc:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=WW(t=FW(e),BW))=="string"?r:VW?Oc(t):(n=Oc(t))=="Object"&&LW(t.callee)?"Arguments":n},UW=Th,zW=String,Pt=function(e){if(UW(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return zW(e)},GW=lt,YW=GW("match"),RS=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[YW]=!1,"/./"[e](t)}catch{}}return!1},KW=Ae,XW=He,qW=_S,QW=rr,cR=Pt,ZW=RS,JW=XW("".indexOf);KW({target:"String",proto:!0,forced:!ZW("includes")},{includes:function(t){return!!~JW(cR(QW(this)),cR(qW(t)),arguments.length>1?arguments[1]:void 0)}});var eU=Un,hl=Array.isArray||function(t){return eU(t)=="Array"},tU=He,rU=Le,KM=ut,nU=Th,oU=on,iU=DM,XM=function(){},aU=[],qM=oU("Reflect","construct"),ES=/^\s*(?:class|function)\b/,lU=tU(ES.exec),sU=!ES.exec(XM),Sl=function(t){if(!KM(t))return!1;try{return qM(XM,aU,t),!0}catch{return!1}},QM=function(t){if(!KM(t))return!1;switch(nU(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return sU||!!lU(ES,iU(t))}catch{return!0}};QM.sham=!0;var kh=!qM||rU(function(){var e;return Sl(Sl.call)||!Sl(Object)||!Sl(function(){e=!0})||e})?QM:Sl,uU=Ch,cU=Nt,fU=Ns,dl=function(e,t,r){var n=uU(t);n in e?cU.f(e,n,fU(0,r)):e[n]=r},hU=Le,dU=lt,vU=js,pU=dU("species"),Ks=function(e){return vU>=51||!hU(function(){var t=[],r=t.constructor={};return r[pU]=function(){return{foo:1}},t[e](Boolean).foo!==1})},gU=He,Xs=gU([].slice),yU=Ae,fR=hl,mU=kh,bU=mt,hR=Ws,wU=Or,SU=dr,CU=dl,_U=lt,OU=Ks,RU=Xs,EU=OU("slice"),TU=_U("species"),Bd=Array,kU=Math.max;yU({target:"Array",proto:!0,forced:!EU},{slice:function(t,r){var n=SU(this),o=wU(n),i=hR(t,o),a=hR(r===void 0?o:r,o),l,s,u;if(fR(n)&&(l=n.constructor,mU(l)&&(l===Bd||fR(l.prototype))?l=void 0:bU(l)&&(l=l[TU],l===null&&(l=void 0)),l===Bd||l===void 0))return RU(n,i,a);for(s=new(l===void 0?Bd:l)(kU(a-i,0)),u=0;i<a;i++,u++)i in n&&CU(s,u,n[i]);return s.length=u,s}});var PU=Le,vl=function(e,t){var r=[][e];return!!r&&PU(function(){r.call(null,t||function(){return 1},1)})},AU=Ae,IU=He,$U=bS.indexOf,MU=vl,rg=IU([].indexOf),dR=!!rg&&1/rg([1],1,-0)<0,xU=MU("indexOf");AU({target:"Array",proto:!0,forced:dR||!xU},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return dR?rg(this,t,r)||0:$U(this,t,r)}});var vR=He,DU=cl,HU=Ds,NU=vR(vR.bind),qs=function(e,t){return DU(e),t===void 0?e:HU?NU(e,t):function(){return e.apply(t,arguments)}},pR=hl,LU=kh,jU=mt,BU=lt,FU=BU("species"),gR=Array,VU=function(e){var t;return pR(e)&&(t=e.constructor,LU(t)&&(t===gR||pR(t.prototype))?t=void 0:jU(t)&&(t=t[FU],t===null&&(t=void 0))),t===void 0?gR:t},WU=VU,TS=function(e,t){return new(WU(e))(t===0?0:t)},UU=qs,zU=He,GU=Ls,YU=nr,KU=Or,XU=TS,yR=zU([].push),Yn=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,l=e==5||i;return function(s,u,c,f){for(var h=YU(s),d=GU(h),v=UU(u,c),g=KU(d),y=0,w=f||XU,C=t?w(s,g):r||a?w(s,0):void 0,_,I;g>y;y++)if((l||y in d)&&(_=d[y],I=v(_,y,h),e))if(t)C[y]=I;else if(I)switch(e){case 3:return!0;case 5:return _;case 6:return y;case 2:yR(C,_)}else switch(e){case 4:return!1;case 7:yR(C,_)}return i?-1:n||o?o:C}},Wi={forEach:Yn(0),map:Yn(1),filter:Yn(2),some:Yn(3),every:Yn(4),find:Yn(5),findIndex:Yn(6),filterReject:Yn(7)},qU=Ae,QU=Wi.filter,ZU=Ks,JU=ZU("filter");qU({target:"Array",proto:!0,forced:!JU},{filter:function(t){return QU(this,t,arguments.length>1?arguments[1]:void 0)}});var e2=OS,t2=Th,r2=e2?{}.toString:function(){return"[object "+t2(this)+"]"},n2=OS,o2=_r,i2=r2;n2||o2(Object.prototype,"toString",i2,{unsafe:!0});var a2=ut,l2=String,s2=TypeError,u2=function(e){if(typeof e=="object"||a2(e))return e;throw s2("Can't set "+l2(e)+" as a prototype")},c2=He,f2=Ct,h2=u2,kS=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=c2(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return f2(o),h2(i),e?r(o,i):o.__proto__=i,o}}():void 0),d2=ut,v2=mt,mR=kS,PS=function(e,t,r){var n,o;return mR&&d2(n=t.constructor)&&n!==r&&v2(o=n.prototype)&&o!==r.prototype&&mR(e,o),e},p2=Ct,ZM=function(){var e=p2(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},g2=kt,y2=bt,m2=Ro,b2=ZM,bR=RegExp.prototype,JM=function(e){var t=e.flags;return t===void 0&&!("flags"in bR)&&!y2(e,"flags")&&m2(bR,e)?g2(b2,e):t},AS=Le,w2=et,IS=w2.RegExp,$S=AS(function(){var e=IS("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),S2=$S||AS(function(){return!IS("a","y").sticky}),C2=$S||AS(function(){var e=IS("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),MS={BROKEN_CARET:C2,MISSED_STICKY:S2,UNSUPPORTED_Y:$S},_2=Nt.f,O2=function(e,t,r){r in e||_2(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},R2=on,E2=Nt,T2=lt,k2=St,wR=T2("species"),ex=function(e){var t=R2(e),r=E2.f;k2&&t&&!t[wR]&&r(t,wR,{configurable:!0,get:function(){return this}})},P2=Le,A2=et,I2=A2.RegExp,tx=P2(function(){var e=I2(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),$2=Le,M2=et,x2=M2.RegExp,rx=$2(function(){var e=x2("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),D2=St,xS=et,Qs=He,H2=Rh,N2=PS,L2=Bi,j2=Fi.f,SR=Ro,B2=CS,CR=Pt,F2=JM,nx=MS,V2=O2,W2=_r,U2=Le,z2=bt,G2=zn.enforce,Y2=ex,K2=lt,ox=tx,ix=rx,X2=K2("match"),uo=xS.RegExp,Sa=uo.prototype,q2=xS.SyntaxError,Q2=Qs(Sa.exec),cf=Qs("".charAt),_R=Qs("".replace),OR=Qs("".indexOf),Z2=Qs("".slice),J2=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Si=/a/g,Fd=/a/g,ez=new uo(Si)!==Si,ax=nx.MISSED_STICKY,tz=nx.UNSUPPORTED_Y,rz=D2&&(!ez||ax||ox||ix||U2(function(){return Fd[X2]=!1,uo(Si)!=Si||uo(Fd)==Fd||uo(Si,"i")!="/a/i"})),nz=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=cf(e,r),i==="\\"){n+=i+cf(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},oz=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,l=!1,s=0,u="",c;r<=t;r++){if(c=cf(e,r),c==="\\")c=c+cf(e,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":Q2(J2,Z2(e,r+1))&&(r+=2,l=!0),n+=c,s++;continue;case(c===">"&&l):if(u===""||z2(i,u))throw new q2("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=c:n+=c}return[n,o]};if(H2("RegExp",rz)){for(var Ao=function(t,r){var n=SR(Sa,this),o=B2(t),i=r===void 0,a=[],l=t,s,u,c,f,h,d;if(!n&&o&&i&&t.constructor===Ao)return t;if((o||SR(Sa,t))&&(t=t.source,i&&(r=F2(l))),t=t===void 0?"":CR(t),r=r===void 0?"":CR(r),l=t,ox&&"dotAll"in Si&&(u=!!r&&OR(r,"s")>-1,u&&(r=_R(r,/s/g,""))),s=r,ax&&"sticky"in Si&&(c=!!r&&OR(r,"y")>-1,c&&tz&&(r=_R(r,/y/g,""))),ix&&(f=oz(t),t=f[0],a=f[1]),h=N2(uo(t,r),n?this:Sa,Ao),(u||c||a.length)&&(d=G2(h),u&&(d.dotAll=!0,d.raw=Ao(nz(t),s)),c&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{L2(h,"source",l===""?"(?:)":l)}catch{}return h},RR=j2(uo),ER=0;RR.length>ER;)V2(Ao,uo,RR[ER++]);Sa.constructor=Ao,Ao.prototype=Sa,W2(xS,"RegExp",Ao,{constructor:!0})}Y2("RegExp");var Oa=kt,Ph=He,iz=Pt,az=ZM,lz=MS,sz=_o,uz=fl,cz=zn.get,fz=tx,hz=rx,dz=sz("native-string-replace",String.prototype.replace),ff=RegExp.prototype.exec,ng=ff,vz=Ph("".charAt),pz=Ph("".indexOf),gz=Ph("".replace),Vd=Ph("".slice),og=function(){var e=/a/,t=/b*/g;return Oa(ff,e,"a"),Oa(ff,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),lx=lz.BROKEN_CARET,ig=/()??/.exec("")[1]!==void 0,yz=og||ig||lx||fz||hz;yz&&(ng=function(t){var r=this,n=cz(r),o=iz(t),i=n.raw,a,l,s,u,c,f,h;if(i)return i.lastIndex=r.lastIndex,a=Oa(ng,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=lx&&r.sticky,g=Oa(az,r),y=r.source,w=0,C=o;if(v&&(g=gz(g,"y",""),pz(g,"g")===-1&&(g+="g"),C=Vd(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&vz(o,r.lastIndex-1)!==`
`)&&(y="(?: "+y+")",C=" "+C,w++),l=new RegExp("^(?:"+y+")",g)),ig&&(l=new RegExp("^"+y+"$(?!\\s)",g)),og&&(s=r.lastIndex),u=Oa(ff,v?l:r,C),v?u?(u.input=Vd(u.input,w),u[0]=Vd(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:og&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),ig&&u&&u.length>1&&Oa(dz,u[0],l,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&d)for(u.groups=f=uz(null),c=0;c<d.length;c++)h=d[c],f[h[0]]=u[h[1]];return u});var Ah=ng,mz=Ae,TR=Ah;mz({target:"RegExp",proto:!0,forced:/./.exec!==TR},{exec:TR});var bz=Fs.PROPER,wz=_r,Sz=Ct,kR=Pt,Cz=Le,_z=JM,DS="toString",Oz=RegExp.prototype,sx=Oz[DS],Rz=Cz(function(){return sx.call({source:"a",flags:"b"})!="/a/b"}),Ez=bz&&sx.name!=DS;(Rz||Ez)&&wz(RegExp.prototype,DS,function(){var t=Sz(this),r=kR(t.source),n=kR(_z(t));return"/"+r+"/"+n},{unsafe:!0});var Tz=Ae,kz=He,Pz=Ls,Az=dr,Iz=vl,$z=kz([].join),Mz=Pz!=Object,xz=Iz("join",",");Tz({target:"Array",proto:!0,forced:Mz||!xz},{join:function(t){return $z(Az(this),t===void 0?",":t)}});var ux=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,Dz=He,Hz=rr,Nz=Pt,Lz=ux,PR=Dz("".replace),hf="["+Lz+"]",jz=RegExp("^"+hf+hf+"*"),Bz=RegExp(hf+hf+"*$"),Wd=function(e){return function(t){var r=Nz(Hz(t));return e&1&&(r=PR(r,jz,"")),e&2&&(r=PR(r,Bz,"")),r}},cx={start:Wd(1),end:Wd(2),trim:Wd(3)},Fz=Fs.PROPER,Vz=Le,AR=ux,IR="âÂá ",Wz=function(e){return Vz(function(){return!!AR[e]()||IR[e]()!==IR||Fz&&AR[e].name!==e})},Uz=Ae,zz=cx.trim,Gz=Wz;Uz({target:"String",proto:!0,forced:Gz("trim")},{trim:function(){return zz(this)}});var Yz=Ds,fx=Function.prototype,$R=fx.apply,MR=fx.call,Ui=typeof Reflect=="object"&&Reflect.apply||(Yz?MR.bind($R):function(){return MR.apply($R,arguments)}),xR=He,DR=_r,Kz=Ah,HR=Le,hx=lt,Xz=Bi,qz=hx("species"),Ud=RegExp.prototype,Ih=function(e,t,r,n){var o=hx(e),i=!HR(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!HR(function(){var u=!1,c=/a/;return e==="split"&&(c={},c.constructor={},c.constructor[qz]=function(){return c},c.flags="",c[o]=/./[o]),c.exec=function(){return u=!0,null},c[o](""),!u});if(!i||!a||r){var l=xR(/./[o]),s=t(o,""[e],function(u,c,f,h,d){var v=xR(u),g=c.exec;return g===Kz||g===Ud.exec?i&&!d?{done:!0,value:l(c,f,h)}:{done:!0,value:v(f,c,h)}:{done:!1}});DR(String.prototype,e,s[0]),DR(Ud,o,s[1])}n&&Xz(Ud[o],"sham",!0)},HS=He,Qz=Eo,Zz=Pt,Jz=rr,eG=HS("".charAt),NR=HS("".charCodeAt),tG=HS("".slice),LR=function(e){return function(t,r){var n=Zz(Jz(t)),o=Qz(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=NR(n,o),a<55296||a>56319||o+1===i||(l=NR(n,o+1))<56320||l>57343?e?eG(n,o):a:e?tG(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},NS={codeAt:LR(!1),charAt:LR(!0)},rG=NS.charAt,LS=function(e,t,r){return t+(r?rG(e,t).length:1)},jS=He,nG=nr,oG=Math.floor,zd=jS("".charAt),iG=jS("".replace),Gd=jS("".slice),aG=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,lG=/\$([$&'`]|\d{1,2})/g,sG=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=lG;return o!==void 0&&(o=nG(o),s=aG),iG(i,s,function(u,c){var f;switch(zd(c,0)){case"$":return"$";case"&":return e;case"`":return Gd(t,0,r);case"'":return Gd(t,a);case"<":f=o[Gd(c,1,-1)];break;default:var h=+c;if(h===0)return u;if(h>l){var d=oG(h/10);return d===0?u:d<=l?n[d-1]===void 0?zd(c,1):n[d-1]+zd(c,1):u}f=n[h-1]}return f===void 0?"":f})},jR=kt,uG=Ct,cG=ut,fG=Un,hG=Ah,dG=TypeError,$h=function(e,t){var r=e.exec;if(cG(r)){var n=jR(r,e,t);return n!==null&&uG(n),n}if(fG(e)==="RegExp")return jR(hG,e,t);throw dG("RegExp#exec called on incompatible receiver")},vG=Ui,BR=kt,Mh=He,pG=Ih,gG=Le,yG=Ct,mG=ut,bG=Nr,wG=Eo,SG=Vi,Ji=Pt,CG=rr,_G=LS,OG=ji,RG=sG,EG=$h,TG=lt,ag=TG("replace"),kG=Math.max,PG=Math.min,AG=Mh([].concat),Yd=Mh([].push),FR=Mh("".indexOf),VR=Mh("".slice),IG=function(e){return e===void 0?e:String(e)},$G=function(){return"a".replace(/./,"$0")==="$0"}(),WR=function(){return/./[ag]?/./[ag]("a","$0")==="":!1}(),MG=!gG(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});pG("replace",function(e,t,r){var n=WR?"$":"$0";return[function(i,a){var l=CG(this),s=bG(i)?void 0:OG(i,ag);return s?BR(s,i,l,a):BR(t,Ji(l),i,a)},function(o,i){var a=yG(this),l=Ji(o);if(typeof i=="string"&&FR(i,n)===-1&&FR(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=mG(i);u||(i=Ji(i));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var h=[];;){var d=EG(a,l);if(d===null||(Yd(h,d),!c))break;var v=Ji(d[0]);v===""&&(a.lastIndex=_G(l,SG(a.lastIndex),f))}for(var g="",y=0,w=0;w<h.length;w++){d=h[w];for(var C=Ji(d[0]),_=kG(PG(wG(d.index),l.length),0),I=[],E=1;E<d.length;E++)Yd(I,IG(d[E]));var U=d.groups;if(u){var G=AG([C],I,_,l);U!==void 0&&Yd(G,U);var Q=Ji(vG(i,void 0,G))}else Q=RG(C,l,_,I,U,i);_>=y&&(g+=VR(l,y,_)+Q,y=_+C.length)}return g+VR(l,y)}]},!MG||!$G||WR);var xG=TypeError,DG=9007199254740991,dx=function(e){if(e>DG)throw xG("Maximum allowed index exceeded");return e},HG=Ae,NG=Le,LG=hl,jG=mt,BG=nr,FG=Or,UR=dx,zR=dl,VG=TS,WG=Ks,UG=lt,zG=js,vx=UG("isConcatSpreadable"),GG=zG>=51||!NG(function(){var e=[];return e[vx]=!1,e.concat()[0]!==e}),YG=WG("concat"),KG=function(e){if(!jG(e))return!1;var t=e[vx];return t!==void 0?!!t:LG(e)},XG=!GG||!YG;HG({target:"Array",proto:!0,arity:1,forced:XG},{concat:function(t){var r=BG(this),n=VG(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],KG(u))for(s=FG(u),UR(o+s),a=0;a<s;a++,o++)a in u&&zR(n,o,u[a]);else UR(o+1),zR(n,o++,u);return n.length=o,n}});var BS={},GR=Ws,qG=Or,QG=dl,ZG=Array,JG=Math.max,FS=function(e,t,r){for(var n=qG(e),o=GR(t,n),i=GR(r===void 0?n:r,n),a=ZG(JG(i-o,0)),l=0;o<i;o++,l++)QG(a,l,e[o]);return a.length=l,a},e3=Un,t3=dr,px=Fi.f,r3=FS,gx=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],n3=function(e){try{return px(e)}catch{return r3(gx)}};BS.f=function(t){return gx&&e3(t)=="Window"?n3(t):px(t3(t))};var VS={},o3=lt;VS.f=o3;var i3=et,a3=i3,YR=a3,l3=bt,s3=VS,u3=Nt.f,yx=function(e){var t=YR.Symbol||(YR.Symbol={});l3(t,e)||u3(t,e,{value:s3.f(e)})},c3=kt,f3=on,h3=lt,d3=_r,v3=function(){var e=f3("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=h3("toPrimitive");t&&!t[n]&&d3(t,n,function(o){return c3(r,this)},{arity:1})},p3=Nt.f,g3=bt,y3=lt,KR=y3("toStringTag"),xh=function(e,t,r){e&&!r&&(e=e.prototype),e&&!g3(e,KR)&&p3(e,KR,{configurable:!0,value:t})},Dh=Ae,WS=et,US=kt,m3=He,Ha=St,Na=sl,b3=Le,Dt=bt,w3=Ro,lg=Ct,Hh=dr,zS=Ch,S3=Pt,sg=Ns,ps=fl,mx=Gs,C3=Fi,bx=BS,_3=Us,wx=nn,Sx=Nt,O3=SS,Cx=Hs,Kd=_r,GS=_o,R3=Oh,_x=Vs,XR=Sh,E3=lt,T3=VS,k3=yx,P3=v3,A3=xh,Ox=zn,Nh=Wi.forEach,er=R3("hidden"),Lh="Symbol",gs="prototype",I3=Ox.set,qR=Ox.getterFor(Lh),wr=Object[gs],Ci=WS.Symbol,Kl=Ci&&Ci[gs],$3=WS.TypeError,Xd=WS.QObject,Rx=wx.f,oo=Sx.f,Ex=bx.f,M3=Cx.f,Tx=m3([].push),Fn=GS("symbols"),Zs=GS("op-symbols"),x3=GS("wks"),ug=!Xd||!Xd[gs]||!Xd[gs].findChild,cg=Ha&&b3(function(){return ps(oo({},"a",{get:function(){return oo(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=Rx(wr,t);n&&delete wr[t],oo(e,t,r),n&&e!==wr&&oo(wr,t,n)}:oo,qd=function(e,t){var r=Fn[e]=ps(Kl);return I3(r,{type:Lh,tag:e,description:t}),Ha||(r.description=t),r},jh=function(t,r,n){t===wr&&jh(Zs,r,n),lg(t);var o=zS(r);return lg(n),Dt(Fn,o)?(n.enumerable?(Dt(t,er)&&t[er][o]&&(t[er][o]=!1),n=ps(n,{enumerable:sg(0,!1)})):(Dt(t,er)||oo(t,er,sg(1,{})),t[er][o]=!0),cg(t,o,n)):oo(t,o,n)},YS=function(t,r){lg(t);var n=Hh(r),o=mx(n).concat(Ax(n));return Nh(o,function(i){(!Ha||US(fg,n,i))&&jh(t,i,n[i])}),t},D3=function(t,r){return r===void 0?ps(t):YS(ps(t),r)},fg=function(t){var r=zS(t),n=US(M3,this,r);return this===wr&&Dt(Fn,r)&&!Dt(Zs,r)?!1:n||!Dt(this,r)||!Dt(Fn,r)||Dt(this,er)&&this[er][r]?n:!0},kx=function(t,r){var n=Hh(t),o=zS(r);if(!(n===wr&&Dt(Fn,o)&&!Dt(Zs,o))){var i=Rx(n,o);return i&&Dt(Fn,o)&&!(Dt(n,er)&&n[er][o])&&(i.enumerable=!0),i}},Px=function(t){var r=Ex(Hh(t)),n=[];return Nh(r,function(o){!Dt(Fn,o)&&!Dt(_x,o)&&Tx(n,o)}),n},Ax=function(e){var t=e===wr,r=Ex(t?Zs:Hh(e)),n=[];return Nh(r,function(o){Dt(Fn,o)&&(!t||Dt(wr,o))&&Tx(n,Fn[o])}),n};Na||(Ci=function(){if(w3(Kl,this))throw $3("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:S3(arguments[0]),r=XR(t),n=function(o){this===wr&&US(n,Zs,o),Dt(this,er)&&Dt(this[er],r)&&(this[er][r]=!1),cg(this,r,sg(1,o))};return Ha&&ug&&cg(wr,r,{configurable:!0,set:n}),qd(r,t)},Kl=Ci[gs],Kd(Kl,"toString",function(){return qR(this).tag}),Kd(Ci,"withoutSetter",function(e){return qd(XR(e),e)}),Cx.f=fg,Sx.f=jh,O3.f=YS,wx.f=kx,C3.f=bx.f=Px,_3.f=Ax,T3.f=function(e){return qd(E3(e),e)},Ha&&(oo(Kl,"description",{configurable:!0,get:function(){return qR(this).description}}),Kd(wr,"propertyIsEnumerable",fg,{unsafe:!0})));Dh({global:!0,constructor:!0,wrap:!0,forced:!Na,sham:!Na},{Symbol:Ci});Nh(mx(x3),function(e){k3(e)});Dh({target:Lh,stat:!0,forced:!Na},{useSetter:function(){ug=!0},useSimple:function(){ug=!1}});Dh({target:"Object",stat:!0,forced:!Na,sham:!Ha},{create:D3,defineProperty:jh,defineProperties:YS,getOwnPropertyDescriptor:kx});Dh({target:"Object",stat:!0,forced:!Na},{getOwnPropertyNames:Px});P3();A3(Ci,Lh);_x[er]=!0;var H3=sl,Ix=H3&&!!Symbol.for&&!!Symbol.keyFor,N3=Ae,L3=on,j3=bt,B3=Pt,$x=_o,F3=Ix,Qd=$x("string-to-symbol-registry"),V3=$x("symbol-to-string-registry");N3({target:"Symbol",stat:!0,forced:!F3},{for:function(e){var t=B3(e);if(j3(Qd,t))return Qd[t];var r=L3("Symbol")(t);return Qd[t]=r,V3[r]=t,r}});var W3=Ae,U3=bt,z3=Bs,G3=ul,Y3=_o,K3=Ix,QR=Y3("symbol-to-string-registry");W3({target:"Symbol",stat:!0,forced:!K3},{keyFor:function(t){if(!z3(t))throw TypeError(G3(t)+" is not a symbol");if(U3(QR,t))return QR[t]}});var X3=Ae,Mx=on,xx=Ui,q3=kt,Js=He,Dx=Le,Q3=hl,Z3=ut,J3=mt,ZR=Bs,Hx=Xs,eY=sl,co=Mx("JSON","stringify"),Ru=Js(/./.exec),JR=Js("".charAt),tY=Js("".charCodeAt),rY=Js("".replace),nY=Js(1 .toString),oY=/[\uD800-\uDFFF]/g,eE=/^[\uD800-\uDBFF]$/,tE=/^[\uDC00-\uDFFF]$/,rE=!eY||Dx(function(){var e=Mx("Symbol")();return co([e])!="[null]"||co({a:e})!="{}"||co(Object(e))!="{}"}),nE=Dx(function(){return co("\uDF06\uD834")!=='"\\udf06\\ud834"'||co("\uDEAD")!=='"\\udead"'}),iY=function(e,t){var r=Hx(arguments),n=t;if(!(!J3(t)&&e===void 0||ZR(e)))return Q3(t)||(t=function(o,i){if(Z3(n)&&(i=q3(n,this,o,i)),!ZR(i))return i}),r[1]=t,xx(co,null,r)},aY=function(e,t,r){var n=JR(r,t-1),o=JR(r,t+1);return Ru(eE,e)&&!Ru(tE,o)||Ru(tE,e)&&!Ru(eE,n)?"\\u"+nY(tY(e,0),16):e};co&&X3({target:"JSON",stat:!0,arity:3,forced:rE||nE},{stringify:function(t,r,n){var o=Hx(arguments),i=xx(rE?iY:co,null,o);return nE&&typeof i=="string"?rY(i,oY,aY):i}});var lY=Ae,sY=sl,uY=Le,Nx=Us,cY=nr,fY=!sY||uY(function(){Nx.f(1)});lY({target:"Object",stat:!0,forced:fY},{getOwnPropertySymbols:function(t){var r=Nx.f;return r?r(cY(t)):[]}});var hY=Ae,dY=St,vY=et,Eu=He,pY=bt,gY=ut,yY=Ro,mY=Pt,bY=Nt.f,wY=FM,hn=vY.Symbol,Io=hn&&hn.prototype;if(dY&&gY(hn)&&(!("description"in Io)||hn().description!==void 0)){var oE={},Tu=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:mY(arguments[0]),r=yY(Io,this)?new hn(t):t===void 0?hn():hn(t);return t===""&&(oE[r]=!0),r};wY(Tu,hn),Tu.prototype=Io,Io.constructor=Tu;var SY=String(hn("test"))=="Symbol(test)",CY=Eu(Io.valueOf),_Y=Eu(Io.toString),OY=/^Symbol\((.*)\)[^)]+$/,RY=Eu("".replace),EY=Eu("".slice);bY(Io,"description",{configurable:!0,get:function(){var t=CY(this);if(pY(oE,t))return"";var r=_Y(t),n=SY?EY(r,7,-1):RY(r,OY,"$1");return n===""?void 0:n}}),hY({global:!0,constructor:!0,forced:!0},{Symbol:Tu})}var TY=yx;TY("iterator");var eu={},kY=Le,PY=ut,AY=mt,iE=Eh,IY=_r,$Y=lt,hg=$Y("iterator"),Lx=!1,Ri,Zd,Jd;[].keys&&(Jd=[].keys(),"next"in Jd?(Zd=iE(iE(Jd)),Zd!==Object.prototype&&(Ri=Zd)):Lx=!0);var MY=!AY(Ri)||kY(function(){var e={};return Ri[hg].call(e)!==e});MY&&(Ri={});PY(Ri[hg])||IY(Ri,hg,function(){return this});var jx={IteratorPrototype:Ri,BUGGY_SAFARI_ITERATORS:Lx},xY=jx.IteratorPrototype,DY=fl,HY=Ns,NY=xh,LY=eu,jY=function(){return this},BY=function(e,t,r,n){var o=t+" Iterator";return e.prototype=DY(xY,{next:HY(+!n,r)}),NY(e,o,!1),LY[o]=jY,e},FY=Ae,VY=kt,Bx=Fs,WY=ut,UY=BY,aE=Eh,lE=kS,zY=xh,GY=Bi,ev=_r,YY=lt,KY=eu,Fx=jx,XY=Bx.PROPER,qY=Bx.CONFIGURABLE,sE=Fx.IteratorPrototype,ku=Fx.BUGGY_SAFARI_ITERATORS,Cl=YY("iterator"),uE="keys",_l="values",cE="entries",QY=function(){return this},KS=function(e,t,r,n,o,i,a){UY(r,t,n);var l=function(w){if(w===o&&h)return h;if(!ku&&w in c)return c[w];switch(w){case uE:return function(){return new r(this,w)};case _l:return function(){return new r(this,w)};case cE:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,c=e.prototype,f=c[Cl]||c["@@iterator"]||o&&c[o],h=!ku&&f||l(o),d=t=="Array"&&c.entries||f,v,g,y;if(d&&(v=aE(d.call(new e)),v!==Object.prototype&&v.next&&(aE(v)!==sE&&(lE?lE(v,sE):WY(v[Cl])||ev(v,Cl,QY)),zY(v,s,!0))),XY&&o==_l&&f&&f.name!==_l&&(qY?GY(c,"name",_l):(u=!0,h=function(){return VY(f,this)})),o)if(g={values:l(_l),keys:i?h:l(uE),entries:l(cE)},a)for(y in g)(ku||u||!(y in c))&&ev(c,y,g[y]);else FY({target:t,proto:!0,forced:ku||u},g);return c[Cl]!==h&&ev(c,Cl,h,{name:o}),KY[t]=h,g},XS=function(e,t){return{value:e,done:t}},ZY=dr,qS=Ys,fE=eu,Vx=zn,JY=Nt.f,eK=KS,Pu=XS,tK=St,Wx="Array Iterator",rK=Vx.set,nK=Vx.getterFor(Wx),oK=eK(Array,"Array",function(e,t){rK(this,{type:Wx,target:ZY(e),index:0,kind:t})},function(){var e=nK(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Pu(void 0,!0)):r=="keys"?Pu(n,!1):r=="values"?Pu(t[n],!1):Pu([n,t[n]],!1)},"values"),hE=fE.Arguments=fE.Array;qS("keys");qS("values");qS("entries");if(tK&&hE.name!=="values")try{JY(hE,"name",{value:"values"})}catch{}var iK=NS.charAt,aK=Pt,Ux=zn,lK=KS,dE=XS,zx="String Iterator",sK=Ux.set,uK=Ux.getterFor(zx);lK(String,"String",function(e){sK(this,{type:zx,string:aK(e),index:0})},function(){var t=uK(this),r=t.string,n=t.index,o;return n>=r.length?dE(void 0,!0):(o=iK(r,n),t.index+=o.length,dE(o,!1))});var Gx={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},cK=_h,tv=cK("span").classList,vE=tv&&tv.constructor&&tv.constructor.prototype,Yx=vE===Object.prototype?void 0:vE,pE=et,Kx=Gx,fK=Yx,Xl=oK,rv=Bi,Xx=lt,nv=Xx("iterator"),gE=Xx("toStringTag"),ov=Xl.values,qx=function(e,t){if(e){if(e[nv]!==ov)try{rv(e,nv,ov)}catch{e[nv]=ov}if(e[gE]||rv(e,gE,t),Kx[t]){for(var r in Xl)if(e[r]!==Xl[r])try{rv(e,r,Xl[r])}catch{e[r]=Xl[r]}}}};for(var iv in Kx)qx(pE[iv]&&pE[iv].prototype,iv);qx(fK,"DOMTokenList");var hK=kt,yE=Ct,dK=ji,Qx=function(e,t,r){var n,o;yE(e);try{if(n=dK(e,"return"),!n){if(t==="throw")throw r;return r}n=hK(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return yE(n),r},vK=Ct,pK=Qx,gK=function(e,t,r,n){try{return n?t(vK(r)[0],r[1]):t(r)}catch(o){pK(e,"throw",o)}},yK=lt,mK=eu,bK=yK("iterator"),wK=Array.prototype,Zx=function(e){return e!==void 0&&(mK.Array===e||wK[bK]===e)},SK=Th,mE=ji,CK=Nr,_K=eu,OK=lt,RK=OK("iterator"),QS=function(e){if(!CK(e))return mE(e,RK)||mE(e,"@@iterator")||_K[SK(e)]},EK=kt,TK=cl,kK=Ct,PK=ul,AK=QS,IK=TypeError,Jx=function(e,t){var r=arguments.length<2?AK(e):t;if(TK(r))return kK(EK(r,e));throw IK(PK(e)+" is not iterable")},$K=qs,MK=kt,xK=nr,DK=gK,HK=Zx,NK=kh,LK=Or,bE=dl,jK=Jx,BK=QS,wE=Array,FK=function(t){var r=xK(t),n=NK(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=$K(i,o>2?arguments[2]:void 0));var l=BK(r),s=0,u,c,f,h,d,v;if(l&&!(this===wE&&HK(l)))for(h=jK(r,l),d=h.next,c=n?new this:[];!(f=MK(d,h)).done;s++)v=a?DK(h,i,[f.value,s],!0):f.value,bE(c,s,v);else for(u=LK(r),c=n?new this(u):wE(u);u>s;s++)v=a?i(r[s],s):r[s],bE(c,s,v);return c.length=s,c},VK=lt,eD=VK("iterator"),tD=!1;try{var WK=0,SE={next:function(){return{done:!!WK++}},return:function(){tD=!0}};SE[eD]=function(){return this},Array.from(SE,function(){throw 2})}catch{}var rD=function(e,t){if(!t&&!tD)return!1;var r=!1;try{var n={};n[eD]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},UK=Ae,zK=FK,GK=rD,YK=!GK(function(e){Array.from(e)});UK({target:"Array",stat:!0,forced:YK},{from:zK});var KK=St,XK=Fs.EXISTS,nD=He,qK=Nt.f,oD=Function.prototype,QK=nD(oD.toString),iD=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,ZK=nD(iD.exec),JK="name";KK&&!XK&&qK(oD,JK,{configurable:!0,get:function(){try{return ZK(iD,QK(this))[1]}catch{return""}}});var e8=TypeError,aD=function(e,t){if(e<t)throw e8("Not enough arguments");return e},dg=et,t8=Ui,r8=ut,n8=Li,o8=Xs,i8=aD,a8=/MSIE .\./.test(n8),l8=dg.Function,CE=function(e){return a8?function(t,r){var n=i8(arguments.length,1)>2,o=r8(t)?t:l8(t),i=n?o8(arguments,2):void 0;return e(n?function(){t8(o,this,i)}:o,r)}:e},lD={setTimeout:CE(dg.setTimeout),setInterval:CE(dg.setInterval)},s8=Ae,u8=et,_E=lD.setInterval;s8({global:!0,bind:!0,forced:u8.setInterval!==_E},{setInterval:_E});var c8=Ae,f8=et,OE=lD.setTimeout;c8({global:!0,bind:!0,forced:f8.setTimeout!==OE},{setTimeout:OE});function vg(e){return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vg(e)}var RE=0,Au=["ms","moz","webkit","o"],ys=window.requestAnimationFrame,df=window.cancelAnimationFrame;for(var Ol=0;Ol<Au.length&&!ys;++Ol)ys=window["".concat(Au[Ol],"RequestAnimationFrame")],df=window["".concat(Au[Ol],"CancelAnimationFrame")]||window["".concat(Au[Ol],"CancelRequestAnimationFrame")];ys||(ys=function(t){var r=new Date().getTime(),n=Math.max(0,16-(r-RE)),o=window.setTimeout(function(){t(r+n)},n);return RE=r+n,o});df||(df=function(t){clearTimeout(t)});function sD(e){return ys.call(window,e)}function h8(){return!!document.documentElement.classList}function d8(){return!!document.createTextNode("test").textContent}function v8(){return!!window.getComputedStyle}function vf(e){df.call(window,e)}function uD(){return"ontouchstart"in window}var pg;function p8(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),pg=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function cD(){return pg===void 0&&p8(),pg}var ea;function g8(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ea||((typeof Intl>"u"?"undefined":vg(Intl))==="object"?ea=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?ea=function(n,o){return"".concat(n).localeCompare(o)}:ea=function(n,o){return n===o?0:n>o?-1:1},ea)}var Rl;function y8(){if(Rl!==void 0)return Rl;try{var e={get passive(){Rl=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Rl=!1}return Rl}var m8=Wi.forEach,b8=vl,w8=b8("forEach"),S8=w8?[].forEach:function(t){return m8(this,t,arguments.length>1?arguments[1]:void 0)},EE=et,TE=Gx,C8=Yx,av=S8,_8=Bi,fD=function(e){if(e&&e.forEach!==av)try{_8(e,"forEach",av)}catch{e.forEach=av}};for(var lv in TE)TE[lv]&&fD(EE[lv]&&EE[lv].prototype);fD(C8);var Ei={},O8={get exports(){return Ei},set exports(e){Ei=e}},R8=Le,E8=R8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),T8=Le,k8=mt,P8=Un,kE=E8,Rc=Object.isExtensible,A8=T8(function(){Rc(1)}),hD=A8||kE?function(t){return!k8(t)||kE&&P8(t)=="ArrayBuffer"?!1:Rc?Rc(t):!0}:Rc,I8=Le,dD=!I8(function(){return Object.isExtensible(Object.preventExtensions({}))}),$8=Ae,M8=He,x8=Vs,D8=mt,ZS=bt,H8=Nt.f,PE=Fi,N8=BS,JS=hD,L8=Sh,j8=dD,vD=!1,Vn=L8("meta"),B8=0,eC=function(e){H8(e,Vn,{value:{objectID:"O"+B8++,weakData:{}}})},F8=function(e,t){if(!D8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!ZS(e,Vn)){if(!JS(e))return"F";if(!t)return"E";eC(e)}return e[Vn].objectID},V8=function(e,t){if(!ZS(e,Vn)){if(!JS(e))return!0;if(!t)return!1;eC(e)}return e[Vn].weakData},W8=function(e){return j8&&vD&&JS(e)&&!ZS(e,Vn)&&eC(e),e},U8=function(){z8.enable=function(){},vD=!0;var e=PE.f,t=M8([].splice),r={};r[Vn]=1,e(r).length&&(PE.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===Vn){t(o,i,1);break}return o},$8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:N8.f}))},z8=O8.exports={enable:U8,fastKey:F8,getWeakData:V8,onFreeze:W8};x8[Vn]=!0;var G8=qs,Y8=kt,K8=Ct,X8=ul,q8=Zx,Q8=Or,AE=Ro,Z8=Jx,J8=QS,IE=Qx,e4=TypeError,Ec=function(e,t){this.stopped=e,this.result=t},$E=Ec.prototype,tC=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=G8(t,n),u,c,f,h,d,v,g,y=function(C){return u&&IE(u,"normal",C),new Ec(!0,C)},w=function(C){return o?(K8(C),l?s(C[0],C[1],y):s(C[0],C[1])):l?s(C,y):s(C)};if(i)u=e.iterator;else if(a)u=e;else{if(c=J8(e),!c)throw e4(X8(e)+" is not iterable");if(q8(c)){for(f=0,h=Q8(e);h>f;f++)if(d=w(e[f]),d&&AE($E,d))return d;return new Ec(!1)}u=Z8(e,c)}for(v=i?e.next:u.next;!(g=Y8(v,u)).done;){try{d=w(g.value)}catch(C){IE(u,"throw",C)}if(typeof d=="object"&&d&&AE($E,d))return d}return new Ec(!1)},t4=Ro,r4=TypeError,rC=function(e,t){if(t4(t,e))return e;throw r4("Incorrect invocation")},n4=Ae,o4=et,i4=He,ME=Rh,a4=_r,l4=Ei,s4=tC,u4=rC,c4=ut,f4=Nr,sv=mt,uv=Le,h4=rD,d4=xh,v4=PS,Bh=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=o4[e],l=a&&a.prototype,s=a,u={},c=function(w){var C=i4(l[w]);a4(l,w,w=="add"?function(I){return C(this,I===0?0:I),this}:w=="delete"?function(_){return o&&!sv(_)?!1:C(this,_===0?0:_)}:w=="get"?function(I){return o&&!sv(I)?void 0:C(this,I===0?0:I)}:w=="has"?function(I){return o&&!sv(I)?!1:C(this,I===0?0:I)}:function(I,E){return C(this,I===0?0:I,E),this})},f=ME(e,!c4(a)||!(o||l.forEach&&!uv(function(){new a().entries().next()})));if(f)s=r.getConstructor(t,e,n,i),l4.enable();else if(ME(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!=h,v=uv(function(){h.has(1)}),g=h4(function(w){new a(w)}),y=!o&&uv(function(){for(var w=new a,C=5;C--;)w[i](C,C);return!w.has(-0)});g||(s=t(function(w,C){u4(w,l);var _=v4(new a,w,s);return f4(C)||s4(C,_[i],{that:_,AS_ENTRIES:n}),_}),s.prototype=l,l.constructor=s),(v||y)&&(c("delete"),c("has"),n&&c("get")),(y||d)&&c(i),o&&l.clear&&delete l.clear}return u[e]=s,n4({global:!0,constructor:!0,forced:s!=a},u),d4(s,e),o||r.setStrong(s,e,n),s},p4=_r,nC=function(e,t,r){for(var n in t)p4(e,n,t[n],r);return e},g4=Nt.f,y4=fl,xE=nC,m4=qs,b4=rC,w4=Nr,S4=tC,C4=KS,Iu=XS,_4=ex,El=St,DE=Ei.fastKey,pD=zn,HE=pD.set,cv=pD.getterFor,gD={getConstructor:function(e,t,r,n){var o=e(function(u,c){b4(u,i),HE(u,{type:t,index:y4(null),first:void 0,last:void 0,size:0}),El||(u.size=0),w4(c)||S4(c,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=cv(t),l=function(u,c,f){var h=a(u),d=s(u,c),v,g;return d?d.value=f:(h.last=d={index:g=DE(c,!0),key:c,value:f,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),El?h.size++:u.size++,g!=="F"&&(h.index[g]=d)),u},s=function(u,c){var f=a(u),h=DE(c),d;if(h!=="F")return f.index[h];for(d=f.first;d;d=d.next)if(d.key==c)return d};return xE(i,{clear:function(){for(var c=this,f=a(c),h=f.index,d=f.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;f.first=f.last=void 0,El?f.size=0:c.size=0},delete:function(u){var c=this,f=a(c),h=s(c,u);if(h){var d=h.next,v=h.previous;delete f.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),f.first==h&&(f.first=d),f.last==h&&(f.last=v),El?f.size--:c.size--}return!!h},forEach:function(c){for(var f=a(this),h=m4(c,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:f.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(c){return!!s(this,c)}}),xE(i,r?{get:function(c){var f=s(this,c);return f&&f.value},set:function(c,f){return l(this,c===0?0:c,f)}}:{add:function(c){return l(this,c=c===0?0:c,c)}}),El&&g4(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=cv(t),i=cv(n);C4(e,t,function(a,l){HE(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,Iu(void 0,!0)):l=="keys"?Iu(s.key,!1):l=="values"?Iu(s.value,!1):Iu([s.key,s.value],!1)},r?"entries":"values",!r,!0),_4(t)}},O4=Bh,R4=gD;O4("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},R4);var E4=kh,T4=ul,k4=TypeError,yD=function(e){if(E4(e))return e;throw k4(T4(e)+" is not a constructor")},NE=Ct,P4=yD,A4=Nr,I4=lt,$4=I4("species"),M4=function(e,t){var r=NE(e).constructor,n;return r===void 0||A4(n=NE(r)[$4])?t:P4(n)},x4=Ui,Tl=kt,oC=He,D4=Ih,H4=Ct,N4=Nr,L4=CS,LE=rr,j4=M4,B4=LS,F4=Vi,fv=Pt,V4=ji,jE=FS,BE=$h,W4=Ah,U4=MS,z4=Le,ta=U4.UNSUPPORTED_Y,FE=4294967295,G4=Math.min,mD=[].push,Y4=oC(/./.exec),ra=oC(mD),kl=oC("".slice),K4=!z4(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});D4("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=fv(LE(this)),l=i===void 0?FE:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!L4(o))return Tl(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),c=0,f=new RegExp(o.source,u+"g"),h,d,v;(h=Tl(W4,f,a))&&(d=f.lastIndex,!(d>c&&(ra(s,kl(a,c,h.index)),h.length>1&&h.index<a.length&&x4(mD,s,jE(h,1)),v=h[0].length,c=d,s.length>=l)));)f.lastIndex===h.index&&f.lastIndex++;return c===a.length?(v||!Y4(f,""))&&ra(s,""):ra(s,kl(a,c)),s.length>l?jE(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Tl(t,this,o,i)}:n=t,[function(i,a){var l=LE(this),s=N4(i)?void 0:V4(i,e);return s?Tl(s,i,l,a):Tl(n,fv(l),i,a)},function(o,i){var a=H4(this),l=fv(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=j4(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ta?"g":"y"),h=new u(ta?"^(?:"+a.source+")":a,f),d=i===void 0?FE:i>>>0;if(d===0)return[];if(l.length===0)return BE(h,l)===null?[l]:[];for(var v=0,g=0,y=[];g<l.length;){h.lastIndex=ta?0:g;var w=BE(h,ta?kl(l,g):l),C;if(w===null||(C=G4(F4(h.lastIndex+(ta?g:0)),l.length))===v)g=B4(l,g,c);else{if(ra(y,kl(l,v,g)),y.length===d)return y;for(var _=1;_<=w.length-1;_++)if(ra(y,w[_]),y.length===d)return y;g=v=C}}return ra(y,kl(l,v)),y}]},!K4,ta);function X4(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function VE(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Tc(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function Vt(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Cr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function Fe(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function $(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function bD(e){var t=[];return $(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function WE(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return $(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function UE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function zE(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function La(e){return La=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},La(e)}function ms(e){var t;return Array.isArray(e)?t=[]:(t={},Ve(e,function(r,n){n!=="__children"&&(r&&La(r)==="object"&&!Array.isArray(r)?t[n]=ms(r):Array.isArray(r)?r.length&&La(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[ms(r[0])]:t[n]=[]:t[n]=null)})),t}function To(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function ht(e,t,r){var n=Array.isArray(r);return Ve(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function Fh(e,t){Ve(t,function(r,n){t[n]&&La(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Fh(e[n],t[n])):e[n]=t[n]})}function Kt(e){return La(e)==="object"?JSON.parse(JSON.stringify(e)):e}function tr(e){var t={};return Ve(e,function(r,n){t[n]=r}),t}function rt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return $(r,function(o){e.MIXINS.push(o.MIXIN_NAME),Ve(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(c,f){var h="_".concat(c),d=function(g){var y=g;return(Array.isArray(y)||Ne(y))&&(y=Kt(y)),y};return function(){return this[h]===void 0&&(this[h]=d(f)),this[h]}},s=function(c){var f="_".concat(c);return function(h){this[f]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function wD(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ne(e){return Object.prototype.toString.call(e)==="[object Object]"}function Gn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function Ve(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function q4(e,t){var r=t.split("."),n=e;return Ve(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function hv(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(it(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function iC(e){if(!Ne(e))return 0;var t=function r(n){var o=0;return Ne(n)?Ve(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function ja(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},zE(t,n,e),zE(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Jt=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},an={chrome:Jt(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Jt(function(e){return/CriOS/.test(e)}),edge:Jt(function(e){return/Edge/.test(e)}),edgeWebKit:Jt(function(e){return/EdgiOS/.test(e)}),firefox:Jt(function(e){return/Firefox/.test(e)}),firefoxWebKit:Jt(function(e){return/FxiOS/.test(e)}),ie:Jt(function(e){return/Trident/.test(e)}),ie9:Jt(function(){return!!document.documentMode}),mobile:Jt(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Jt(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},tu={mac:Jt(function(e){return/^Mac/.test(e)}),win:Jt(function(e){return/^Win/.test(e)}),linux:Jt(function(e){return/^Linux/.test(e)}),ios:Jt(function(e){return/iPhone|iPad|iPod/i.test(e)})};function Q4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;Ve(an,function(i){var a=i.test;return void a(r,o)})}function Z4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;Ve(tu,function(n){var o=n.test;return void o(r)})}Q4();Z4();function J4(){return an.chrome.value}function e6(){return an.chromeWebKit.value}function dv(){return an.firefox.value}function t6(){return an.firefoxWebKit.value}function r6(){return an.safari.value}function n6(){return an.edge.value}function o6(){return an.ie.value}function i6(){return an.ie9.value}function Jr(){return an.mobile.value}function SD(){return tu.ios.value}function CD(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&tu.mac.value}function GE(){return tu.win.value}function YE(){return tu.mac.value}/*! @license DOMPurify 2.4.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.0/LICENSE */function io(e){return io=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},io(e)}function gg(e,t){return gg=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},gg(e,t)}function a6(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kc(e,t,r){return a6()?kc=Reflect.construct:kc=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&gg(u,a.prototype),u},kc.apply(null,arguments)}function Ar(e){return l6(e)||s6(e)||u6(e)||c6()}function l6(e){if(Array.isArray(e))return yg(e)}function s6(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function u6(e,t){if(e){if(typeof e=="string")return yg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yg(e,t)}}function yg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f6=Object.hasOwnProperty,KE=Object.setPrototypeOf,h6=Object.isFrozen,d6=Object.getPrototypeOf,v6=Object.getOwnPropertyDescriptor,Xt=Object.freeze,tn=Object.seal,p6=Object.create,_D=typeof Reflect<"u"&&Reflect,pf=_D.apply,mg=_D.construct;pf||(pf=function(t,r,n){return t.apply(r,n)});Xt||(Xt=function(t){return t});tn||(tn=function(t){return t});mg||(mg=function(t,r){return kc(t,Ar(r))});var g6=Dr(Array.prototype.forEach),XE=Dr(Array.prototype.pop),Pl=Dr(Array.prototype.push),Pc=Dr(String.prototype.toLowerCase),y6=Dr(String.prototype.match),Kn=Dr(String.prototype.replace),m6=Dr(String.prototype.indexOf),b6=Dr(String.prototype.trim),Wt=Dr(RegExp.prototype.test),vv=w6(TypeError);function Dr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return pf(e,t,n)}}function w6(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return mg(e,r)}}function We(e,t,r){r=r||Pc,KE&&KE(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(h6(t)||(t[n]=i),o=i)}e[o]=!0}return e}function $o(e){var t=p6(null),r;for(r in e)pf(f6,e,[r])&&(t[r]=e[r]);return t}function $u(e,t){for(;e!==null;){var r=v6(e,t);if(r){if(r.get)return Dr(r.get);if(typeof r.value=="function")return Dr(r.value)}e=d6(e)}function n(o){return console.warn("fallback value for",o),null}return n}var qE=Xt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),pv=Xt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),gv=Xt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),S6=Xt(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),yv=Xt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),C6=Xt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),QE=Xt(["#text"]),ZE=Xt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),mv=Xt(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),JE=Xt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Mu=Xt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),_6=tn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),O6=tn(/<%[\w\W]*|[\w\W]*%>/gm),R6=tn(/^data-[\-\w.\u00B7-\uFFFF]/),E6=tn(/^aria-[\-\w]+$/),T6=tn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),k6=tn(/^(?:\w+script|data):/i),P6=tn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),A6=tn(/^html$/i),I6=function(){return typeof window>"u"?null:window},$6=function(t,r){if(io(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function OD(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I6(),t=function(N){return OD(N)};if(t.version="2.4.0",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,c=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,f=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,g=$u(v,"cloneNode"),y=$u(v,"nextSibling"),w=$u(v,"childNodes"),C=$u(v,"parentNode");if(typeof i=="function"){var _=n.createElement("template");_.content&&_.content.ownerDocument&&(n=_.content.ownerDocument)}var I=$6(d,r),E=I?I.createHTML(""):"",U=n,G=U.implementation,Q=U.createNodeIterator,K=U.createDocumentFragment,X=U.getElementsByTagName,J=r.importNode,le={};try{le=$o(n).documentMode?n.documentMode:{}}catch{}var ee={};t.isSupported=typeof C=="function"&&G&&typeof G.createHTMLDocument<"u"&&le!==9;var he=_6,Ce=O6,_e=R6,be=E6,P=k6,T=P6,Y=T6,p=null,m=We({},[].concat(Ar(qE),Ar(pv),Ar(gv),Ar(yv),Ar(QE))),b=null,R=We({},[].concat(Ar(ZE),Ar(mv),Ar(JE),Ar(Mu))),k=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),j=null,W=null,q=!0,Z=!0,ne=!1,te=!1,ue=!1,we=!1,F=!1,Se=!1,Ie=!1,Re=!1,Pe=!0,ke=!1,S="user-content-",O=!0,A=!1,L={},M=null,V=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),H=null,x=We({},["audio","video","img","source","image","track"]),B=null,D=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),z="http://www.w3.org/1998/Math/MathML",oe="http://www.w3.org/2000/svg",ae="http://www.w3.org/1999/xhtml",se=ae,Ee=!1,$e,ze=["application/xhtml+xml","text/html"],Me="text/html",Oe,qe=null,ir=n.createElement("form"),Er=function(N){return N instanceof RegExp||N instanceof Function},Ot=function(N){qe&&qe===N||((!N||io(N)!=="object")&&(N={}),N=$o(N),$e=ze.indexOf(N.PARSER_MEDIA_TYPE)===-1?$e=Me:$e=N.PARSER_MEDIA_TYPE,Oe=$e==="application/xhtml+xml"?function(ie){return ie}:Pc,p="ALLOWED_TAGS"in N?We({},N.ALLOWED_TAGS,Oe):m,b="ALLOWED_ATTR"in N?We({},N.ALLOWED_ATTR,Oe):R,B="ADD_URI_SAFE_ATTR"in N?We($o(D),N.ADD_URI_SAFE_ATTR,Oe):D,H="ADD_DATA_URI_TAGS"in N?We($o(x),N.ADD_DATA_URI_TAGS,Oe):x,M="FORBID_CONTENTS"in N?We({},N.FORBID_CONTENTS,Oe):V,j="FORBID_TAGS"in N?We({},N.FORBID_TAGS,Oe):{},W="FORBID_ATTR"in N?We({},N.FORBID_ATTR,Oe):{},L="USE_PROFILES"in N?N.USE_PROFILES:!1,q=N.ALLOW_ARIA_ATTR!==!1,Z=N.ALLOW_DATA_ATTR!==!1,ne=N.ALLOW_UNKNOWN_PROTOCOLS||!1,te=N.SAFE_FOR_TEMPLATES||!1,ue=N.WHOLE_DOCUMENT||!1,Se=N.RETURN_DOM||!1,Ie=N.RETURN_DOM_FRAGMENT||!1,Re=N.RETURN_TRUSTED_TYPE||!1,F=N.FORCE_BODY||!1,Pe=N.SANITIZE_DOM!==!1,ke=N.SANITIZE_NAMED_PROPS||!1,O=N.KEEP_CONTENT!==!1,A=N.IN_PLACE||!1,Y=N.ALLOWED_URI_REGEXP||Y,se=N.NAMESPACE||ae,N.CUSTOM_ELEMENT_HANDLING&&Er(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(k.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&Er(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(k.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(k.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),te&&(Z=!1),Ie&&(Se=!0),L&&(p=We({},Ar(QE)),b=[],L.html===!0&&(We(p,qE),We(b,ZE)),L.svg===!0&&(We(p,pv),We(b,mv),We(b,Mu)),L.svgFilters===!0&&(We(p,gv),We(b,mv),We(b,Mu)),L.mathMl===!0&&(We(p,yv),We(b,JE),We(b,Mu))),N.ADD_TAGS&&(p===m&&(p=$o(p)),We(p,N.ADD_TAGS,Oe)),N.ADD_ATTR&&(b===R&&(b=$o(b)),We(b,N.ADD_ATTR,Oe)),N.ADD_URI_SAFE_ATTR&&We(B,N.ADD_URI_SAFE_ATTR,Oe),N.FORBID_CONTENTS&&(M===V&&(M=$o(M)),We(M,N.FORBID_CONTENTS,Oe)),O&&(p["#text"]=!0),ue&&We(p,["html","head","body"]),p.table&&(We(p,["tbody"]),delete j.tbody),Xt&&Xt(N),qe=N)},st=We({},["mi","mo","mn","ms","mtext"]),Lr=We({},["foreignobject","desc","title","annotation-xml"]),It=We({},["title","style","font","a","script"]),gt=We({},pv);We(gt,gv),We(gt,S6);var Qe=We({},yv);We(Qe,C6);var yu=function(N){var ie=C(N);(!ie||!ie.tagName)&&(ie={namespaceURI:ae,tagName:"template"});var pe=Pc(N.tagName),Ye=Pc(ie.tagName);return N.namespaceURI===oe?ie.namespaceURI===ae?pe==="svg":ie.namespaceURI===z?pe==="svg"&&(Ye==="annotation-xml"||st[Ye]):!!gt[pe]:N.namespaceURI===z?ie.namespaceURI===ae?pe==="math":ie.namespaceURI===oe?pe==="math"&&Lr[Ye]:!!Qe[pe]:N.namespaceURI===ae?ie.namespaceURI===oe&&!Lr[Ye]||ie.namespaceURI===z&&!st[Ye]?!1:!Qe[pe]&&(It[pe]||!gt[pe]):!1},Tr=function(N){Pl(t.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=E}catch{N.remove()}}},Xi=function(N,ie){try{Pl(t.removed,{attribute:ie.getAttributeNode(N),from:ie})}catch{Pl(t.removed,{attribute:null,from:ie})}if(ie.removeAttribute(N),N==="is"&&!b[N])if(Se||Ie)try{Tr(ie)}catch{}else try{ie.setAttribute(N,"")}catch{}},qi=function(N){var ie,pe;if(F)N="<remove></remove>"+N;else{var Ye=y6(N,/^[\r\n\t ]+/);pe=Ye&&Ye[0]}$e==="application/xhtml+xml"&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var Qt=I?I.createHTML(N):N;if(se===ae)try{ie=new h().parseFromString(Qt,$e)}catch{}if(!ie||!ie.documentElement){ie=G.createDocument(se,"template",null);try{ie.documentElement.innerHTML=Ee?"":Qt}catch{}}var Bt=ie.body||ie.documentElement;return N&&pe&&Bt.insertBefore(n.createTextNode(pe),Bt.childNodes[0]||null),se===ae?X.call(ie,ue?"html":"body")[0]:ue?ie.documentElement:Bt},PO=function(N){return Q.call(N.ownerDocument||N,N,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},Dj=function(N){return N instanceof f&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function")},wl=function(N){return io(a)==="object"?N instanceof a:N&&io(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},ln=function(N,ie,pe){ee[N]&&g6(ee[N],function(Ye){Ye.call(t,ie,pe,qe)})},AO=function(N){var ie;if(ln("beforeSanitizeElements",N,null),Dj(N)||Wt(/[\u0080-\uFFFF]/,N.nodeName))return Tr(N),!0;var pe=Oe(N.nodeName);if(ln("uponSanitizeElement",N,{tagName:pe,allowedTags:p}),N.hasChildNodes()&&!wl(N.firstElementChild)&&(!wl(N.content)||!wl(N.content.firstElementChild))&&Wt(/<[/\w]/g,N.innerHTML)&&Wt(/<[/\w]/g,N.textContent)||pe==="select"&&Wt(/<template/i,N.innerHTML))return Tr(N),!0;if(!p[pe]||j[pe]){if(!j[pe]&&$O(pe)&&(k.tagNameCheck instanceof RegExp&&Wt(k.tagNameCheck,pe)||k.tagNameCheck instanceof Function&&k.tagNameCheck(pe)))return!1;if(O&&!M[pe]){var Ye=C(N)||N.parentNode,Qt=w(N)||N.childNodes;if(Qt&&Ye)for(var Bt=Qt.length,jt=Bt-1;jt>=0;--jt)Ye.insertBefore(g(Qt[jt],!0),y(N))}return Tr(N),!0}return N instanceof l&&!yu(N)||(pe==="noscript"||pe==="noembed")&&Wt(/<\/no(script|embed)/i,N.innerHTML)?(Tr(N),!0):(te&&N.nodeType===3&&(ie=N.textContent,ie=Kn(ie,he," "),ie=Kn(ie,Ce," "),N.textContent!==ie&&(Pl(t.removed,{element:N.cloneNode()}),N.textContent=ie)),ln("afterSanitizeElements",N,null),!1)},IO=function(N,ie,pe){if(Pe&&(ie==="id"||ie==="name")&&(pe in n||pe in ir))return!1;if(!(Z&&!W[ie]&&Wt(_e,ie))){if(!(q&&Wt(be,ie))){if(!b[ie]||W[ie]){if(!($O(N)&&(k.tagNameCheck instanceof RegExp&&Wt(k.tagNameCheck,N)||k.tagNameCheck instanceof Function&&k.tagNameCheck(N))&&(k.attributeNameCheck instanceof RegExp&&Wt(k.attributeNameCheck,ie)||k.attributeNameCheck instanceof Function&&k.attributeNameCheck(ie))||ie==="is"&&k.allowCustomizedBuiltInElements&&(k.tagNameCheck instanceof RegExp&&Wt(k.tagNameCheck,pe)||k.tagNameCheck instanceof Function&&k.tagNameCheck(pe))))return!1}else if(!B[ie]){if(!Wt(Y,Kn(pe,T,""))){if(!((ie==="src"||ie==="xlink:href"||ie==="href")&&N!=="script"&&m6(pe,"data:")===0&&H[N])){if(!(ne&&!Wt(P,Kn(pe,T,"")))){if(pe)return!1}}}}}}return!0},$O=function(N){return N.indexOf("-")>0},MO=function(N){var ie,pe,Ye,Qt;ln("beforeSanitizeAttributes",N,null);var Bt=N.attributes;if(Bt){var jt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:b};for(Qt=Bt.length;Qt--;){ie=Bt[Qt];var mu=ie,Ft=mu.name,_d=mu.namespaceURI;if(pe=Ft==="value"?ie.value:b6(ie.value),Ye=Oe(Ft),jt.attrName=Ye,jt.attrValue=pe,jt.keepAttr=!0,jt.forceKeepAttr=void 0,ln("uponSanitizeAttribute",N,jt),pe=jt.attrValue,!jt.forceKeepAttr&&(Xi(Ft,N),!!jt.keepAttr)){if(Wt(/\/>/i,pe)){Xi(Ft,N);continue}te&&(pe=Kn(pe,he," "),pe=Kn(pe,Ce," "));var xO=Oe(N.nodeName);if(IO(xO,Ye,pe)){if(ke&&(Ye==="id"||Ye==="name")&&(Xi(Ft,N),pe=S+pe),I&&io(d)==="object"&&typeof d.getAttributeType=="function"&&!_d)switch(d.getAttributeType(xO,Ye)){case"TrustedHTML":pe=I.createHTML(pe);break;case"TrustedScriptURL":pe=I.createScriptURL(pe);break}try{_d?N.setAttributeNS(_d,Ft,pe):N.setAttribute(Ft,pe),XE(t.removed)}catch{}}}}ln("afterSanitizeAttributes",N,null)}},Hj=function Te(N){var ie,pe=PO(N);for(ln("beforeSanitizeShadowDOM",N,null);ie=pe.nextNode();)ln("uponSanitizeShadowNode",ie,null),!AO(ie)&&(ie.content instanceof o&&Te(ie.content),MO(ie));ln("afterSanitizeShadowDOM",N,null)};return t.sanitize=function(Te){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie,pe,Ye,Qt,Bt;if(Ee=!Te,Ee&&(Te="<!-->"),typeof Te!="string"&&!wl(Te)){if(typeof Te.toString!="function")throw vv("toString is not a function");if(Te=Te.toString(),typeof Te!="string")throw vv("dirty is not a string, aborting")}if(!t.isSupported){if(io(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Te=="string")return e.toStaticHTML(Te);if(wl(Te))return e.toStaticHTML(Te.outerHTML)}return Te}if(we||Ot(N),t.removed=[],typeof Te=="string"&&(A=!1),A){if(Te.nodeName){var jt=Oe(Te.nodeName);if(!p[jt]||j[jt])throw vv("root node is forbidden and cannot be sanitized in-place")}}else if(Te instanceof a)ie=qi("<!---->"),pe=ie.ownerDocument.importNode(Te,!0),pe.nodeType===1&&pe.nodeName==="BODY"||pe.nodeName==="HTML"?ie=pe:ie.appendChild(pe);else{if(!Se&&!te&&!ue&&Te.indexOf("<")===-1)return I&&Re?I.createHTML(Te):Te;if(ie=qi(Te),!ie)return Se?null:Re?E:""}ie&&F&&Tr(ie.firstChild);for(var mu=PO(A?Te:ie);Ye=mu.nextNode();)Ye.nodeType===3&&Ye===Qt||AO(Ye)||(Ye.content instanceof o&&Hj(Ye.content),MO(Ye),Qt=Ye);if(Qt=null,A)return Te;if(Se){if(Ie)for(Bt=K.call(ie.ownerDocument);ie.firstChild;)Bt.appendChild(ie.firstChild);else Bt=ie;return b.shadowroot&&(Bt=J.call(r,Bt,!0)),Bt}var Ft=ue?ie.outerHTML:ie.innerHTML;return ue&&p["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&Wt(A6,ie.ownerDocument.doctype.name)&&(Ft="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+Ft),te&&(Ft=Kn(Ft,he," "),Ft=Kn(Ft,Ce," ")),I&&Re?I.createHTML(Ft):Ft},t.setConfig=function(Te){Ot(Te),we=!0},t.clearConfig=function(){qe=null,we=!1},t.isValidAttribute=function(Te,N,ie){qe||Ot({});var pe=Oe(Te),Ye=Oe(N);return IO(pe,Ye,ie)},t.addHook=function(Te,N){typeof N=="function"&&(ee[Te]=ee[Te]||[],Pl(ee[Te],N))},t.removeHook=function(Te){if(ee[Te])return XE(ee[Te])},t.removeHooks=function(Te){ee[Te]&&(ee[Te]=[])},t.removeAllHooks=function(){ee={}},t}var M6=OD(),x6=Ae,D6=dD,H6=Le,N6=mt,L6=Ei.onFreeze,bg=Object.freeze,j6=H6(function(){bg(1)});x6({target:"Object",stat:!0,forced:j6,sham:!D6},{freeze:function(t){return bg&&N6(t)?bg(L6(t)):t}});var B6=Ae,F6=NS.codeAt;B6({target:"String",proto:!0},{codePointAt:function(t){return F6(this,t)}});var V6=Eo,W6=Pt,U6=rr,z6=RangeError,RD=function(t){var r=W6(U6(this)),n="",o=V6(t);if(o<0||o==1/0)throw z6("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},ED=He,G6=Vi,eT=Pt,Y6=RD,K6=rr,X6=ED(Y6),q6=ED("".slice),Q6=Math.ceil,tT=function(e){return function(t,r,n){var o=eT(K6(t)),i=G6(r),a=o.length,l=n===void 0?" ":eT(n),s,u;return i<=a||l==""?o:(s=i-a,u=X6(l,Q6(s/l.length)),u.length>s&&(u=q6(u,0,s)),e?o+u:u+o)}},Z6={start:tT(!1),end:tT(!0)},J6=Li,e5=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(J6),t5=Ae,r5=Z6.start,n5=e5;t5({target:"String",proto:!0,forced:n5},{padStart:function(t){return r5(this,t,arguments.length>1?arguments[1]:void 0)}});function Je(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=Vt(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var rT,nT,oT,iT,aT,lT;function Ea(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function wg(e){return wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wg(e)}function wt(e){var t;switch(wg(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function fe(e){return typeof e<"u"}function at(e){return typeof e>"u"}function At(e){return e===null||e===""||at(e)}function o5(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var ql="length",ts=function(t){return parseInt(t,16)},sT=function(t){return parseInt(t,10)},gf=function(t,r,n){return t.substr(r,n)},rs=function(t){return t.codePointAt(0)-65},Sg=function(t){return"".concat(t).replace(/\-/g,"")},i5=function(t){return ts(gf(Sg(t),ts("12"),rs("F")))/(ts(gf(Sg(t),rs("B"),~~![][ql]))||9)},a5=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},uT=!1,cT={invalid:function(){return Je(rT||(rT=Ea([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Je(nT||(nT=Ea([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Je(oT||(oT=Ea([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},fT={invalid:function(){return Je(iT||(iT=Ea([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Je(aT||(aT=Ea([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Je(lT||(lT=Ea([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function l5(e,t){var r=!At(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="12.1.3",i,a="invalid",l="invalid";e=Sg(e||"");var s=s5(e);if(r||n||s)if(s){var u=Xe("22/09/2022","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=i5(e);if(i=Xe((f+1)*864e5,"x").format("MMMM DD, YYYY"),c>f){var h=Xe().diff(u,"days");a=h<=1?"valid":"expired",l=h<=15?"valid":"expired"}else a="valid",l="valid"}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(a5()&&(a="valid",l="valid"),!uT&&a!=="valid"){var d=cT[a]({keyValidityDate:i,hotVersion:o});d&&console[a==="non_commercial"?"info":"warn"](cT[a]({keyValidityDate:i,hotVersion:o})),uT=!0}if(l!=="valid"&&t.parentNode){var v=fT[l]({keyValidityDate:i,hotVersion:o});if(v){var g=document.createElement("div");g.id="hot-display-license-info",g.innerHTML=fT[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(g,t.nextSibling)}}}function s5(e){var t=[][ql],r=t;if(e[ql]!==rs("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=rs(o.shift());i;i=rs(o.shift()||"A"))--i<""[ql]?r=r|(sT("".concat(sT(ts(n)+(ts(gf(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=gf(e,i,i?o[ql]===1?9:8:6);return r===t}function Bn(e){return e[0].toUpperCase()+e.substr(1)}function TD(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function kD(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function PD(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function hT(e){return aC("".concat(e),{ALLOWED_TAGS:[]})}function aC(e,t){return M6.sanitize(e,t)}function dT(e){return h5(e)||f5(e)||c5(e)||u5()}function u5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c5(e,t){if(e){if(typeof e=="string")return Cg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cg(e,t)}}function f5(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function h5(e){if(Array.isArray(e))return Cg(e)}function Cg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d5(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function v5(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function yf(e){return v5(e)&&e.parent}function _i(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var c=a,f=c.host;f&&s===i?a=f:a=a.parentNode}return null}function xu(e,t,r){for(var n=[],o=e;o&&(o=_i(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function Oi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function p5(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function Mo(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var _g,Og,Rg;function Du(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(h8()){var vT=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};_g=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},Og=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Du(o),o.length>0)if(vT(n)){var i;(i=t.classList).add.apply(i,dT(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},Rg=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Du(o),o.length>0)if(vT(n)){var i;(i=t.classList).remove.apply(i,dT(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var bv=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};_g=function(t,r){return t.className!==void 0&&bv(r).test(t.className)},Og=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Du(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!bv(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},Rg=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=Du(i);i[n];)o=o.replace(bv(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return _g(e,t)}function re(e,t){Og(e,t)}function De(e,t){Rg(e,t)}function AD(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)AD(t[r])}function Hr(e){for(var t;t=e.lastChild;)e.removeChild(t)}var g5=/(<(.*)>|&(.*);)/;function zi(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g5.test(t)?e.innerHTML=r?aC(t):t:Ti(e,t)}function Ti(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?d8?r.textContent=t:r.data=t:(Hr(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function bs(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return bs(r.host.impl);if(r.host)return bs(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Tt(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(cD()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function ws(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Ba(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function mf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?ws(t):e.scrollTop}function Eg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Ba(t):e.scrollLeft}function bf(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=v8(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var c=r.getComputedStyle(i);if(l=c.overflow,s=c.overflowX,u=c.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function Ss(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=ki(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function Tg(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=ki(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function ki(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function Ze(e){return e.offsetWidth}function dt(e){return cD()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function lo(e){return e.clientHeight||e.innerHeight}function Ac(e){return e.clientWidth||e.innerWidth}function ID(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function y5(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function m5(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function pT(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Vh(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var wv;function b5(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Ht(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return wv===void 0&&(wv=b5(e)),wv}function w5(e){return e.offsetWidth!==e.clientWidth}function S5(e){return e.offsetHeight!==e.clientHeight}function lC(e,t,r){i6()?(e.style.top=r,e.style.left=t):r6()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function Wh(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function wf(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function $D(e){return wf(e)&&e.hasAttribute("data-hot-input")===!1}function C5(e){var t=e.ownerDocument.activeElement;$D(t)||e.select()}function MD(e){return!e.parentNode}var _5="base";function ru(e,t,r,n,o,i,a){var l=[],s=[];a.className&&re(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),De(t,s),re(t,l)}ru.RENDERER_TYPE=_5;var O5="html";function sC(e,t,r,n,o,i,a){ru.apply(this,[e,t,r,n,o,i,a]),zi(t,i??"",!1)}sC.RENDERER_TYPE=O5;var R5="text";function ko(e,t,r,n,o,i,a){ru.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=wt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Hr(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Ti(t,l)}ko.RENDERER_TYPE=R5;var E5=St,T5=hl,k5=TypeError,P5=Object.getOwnPropertyDescriptor,A5=E5&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),I5=A5?function(e,t){if(T5(e)&&!P5(e,"length").writable)throw k5("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},gT=ul,$5=TypeError,xD=function(e,t){if(!delete e[t])throw $5("Cannot delete property "+gT(t)+" of "+gT(e))},M5=Ae,x5=nr,D5=Ws,H5=Eo,N5=Or,L5=I5,j5=dx,B5=TS,F5=dl,Sv=xD,V5=Ks,W5=V5("splice"),U5=Math.max,z5=Math.min;M5({target:"Array",proto:!0,forced:!W5},{splice:function(t,r){var n=x5(this),o=N5(n),i=D5(t,o),a=arguments.length,l,s,u,c,f,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=z5(U5(H5(r),0),o-i)),j5(o+l-s),u=B5(n,s),c=0;c<s;c++)f=i+c,f in n&&F5(u,c,n[f]);if(u.length=s,l<s){for(c=i;c<o-s;c++)f=c+s,h=c+l,f in n?n[h]=n[f]:Sv(n,h);for(c=o;c>o-s+l;c--)Sv(n,c-1)}else if(l>s)for(c=o-s;c>i;c--)f=c+s-1,h=c+l-1,f in n?n[h]=n[f]:Sv(n,h);for(c=0;c<l;c++)n[c+i]=arguments[c+2];return L5(n,o-s+l),u}});function rn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Ca(e){return e.isImmediatePropagationEnabled===!1}function Pi(e){return e.button===2}function uC(e){return e.button===0}function G5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Y5(e,t,r){return t&&yT(e.prototype,t),r&&yT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var K5=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;G5(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return Y5(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,X5(s))}return typeof a!="boolean"&&!y8()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function X5(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),rn(this)},e}const vt=K5;var q5="autocomplete";function pl(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?sC:ko,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),re(t,"htAutocomplete"),!e.acArrowListener){var c=new vt(e);e.acArrowListener=function(f){xe(f.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},c.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){c.destroy()})}}pl.RENDERER_TYPE=q5;var Q5=He,mT=nC,Hu=Ei.getWeakData,Z5=rC,J5=Ct,eX=Nr,Cv=mt,tX=tC,DD=Wi,bT=bt,HD=zn,rX=HD.set,nX=HD.getterFor,oX=DD.find,iX=DD.findIndex,aX=Q5([].splice),lX=0,Nu=function(e){return e.frozen||(e.frozen=new ND)},ND=function(){this.entries=[]},_v=function(e,t){return oX(e.entries,function(r){return r[0]===t})};ND.prototype={get:function(e){var t=_v(this,e);if(t)return t[1]},has:function(e){return!!_v(this,e)},set:function(e,t){var r=_v(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=iX(this.entries,function(r){return r[0]===e});return~t&&aX(this.entries,t,1),!!~t}};var LD={getConstructor:function(e,t,r,n){var o=e(function(s,u){Z5(s,i),rX(s,{type:t,id:lX++,frozen:void 0}),eX(u)||tX(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=nX(t),l=function(s,u,c){var f=a(s),h=Hu(J5(u),!0);return h===!0?Nu(f).set(u,c):h[f.id]=c,s};return mT(i,{delete:function(s){var u=a(this);if(!Cv(s))return!1;var c=Hu(s);return c===!0?Nu(u).delete(s):c&&bT(c,u.id)&&delete c[u.id]},has:function(u){var c=a(this);if(!Cv(u))return!1;var f=Hu(u);return f===!0?Nu(c).has(u):f&&bT(f,c.id)}}),mT(i,r?{get:function(u){var c=a(this);if(Cv(u)){var f=Hu(u);return f===!0?Nu(c).get(u):f?f[c.id]:void 0}},set:function(u,c){return l(this,u,c)}}:{add:function(u){return l(this,u,!0)}}),o}},wT=et,Lu=He,sX=nC,uX=Ei,cX=Bh,jD=LD,ju=mt,Bu=hD,Fu=zn.enforce,fX=HM,hX=!wT.ActiveXObject&&"ActiveXObject"in wT,Al,BD=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},dX=cX("WeakMap",BD,jD);if(fX&&hX){Al=jD.getConstructor(BD,"WeakMap",!0),uX.enable();var Il=dX.prototype,ST=Lu(Il.delete),Vu=Lu(Il.has),CT=Lu(Il.get),_T=Lu(Il.set);sX(Il,{delete:function(e){if(ju(e)&&!Bu(e)){var t=Fu(this);return t.frozen||(t.frozen=new Al),ST(this,e)||t.frozen.delete(e)}return ST(this,e)},has:function(t){if(ju(t)&&!Bu(t)){var r=Fu(this);return r.frozen||(r.frozen=new Al),Vu(this,t)||r.frozen.has(t)}return Vu(this,t)},get:function(t){if(ju(t)&&!Bu(t)){var r=Fu(this);return r.frozen||(r.frozen=new Al),Vu(this,t)?CT(this,t):r.frozen.get(t)}return CT(this,t)},set:function(t,r){if(ju(t)&&!Bu(t)){var n=Fu(this);n.frozen||(n.frozen=new Al),Vu(this,t)?_T(this,t,r):n.frozen.set(t,r)}else _T(this,t,r);return this}})}var ye={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:dv()?182:174,AUDIO_MUTE:dv()?181:173,AUDIO_UP:dv()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},vX=[ye.ALT,ye.ARROW_DOWN,ye.ARROW_LEFT,ye.ARROW_RIGHT,ye.ARROW_UP,ye.AUDIO_DOWN,ye.AUDIO_MUTE,ye.AUDIO_UP,ye.BACKSPACE,ye.CAPS_LOCK,ye.DELETE,ye.END,ye.ENTER,ye.ESCAPE,ye.F1,ye.F2,ye.F3,ye.F4,ye.F5,ye.F6,ye.F7,ye.F8,ye.F9,ye.F10,ye.F11,ye.F12,ye.F13,ye.F14,ye.F15,ye.F16,ye.F17,ye.F18,ye.F19,ye.HOME,ye.INSERT,ye.MEDIA_NEXT,ye.MEDIA_PLAY_PAUSE,ye.MEDIA_PREV,ye.MEDIA_STOP,ye.NULL,ye.NUM_LOCK,ye.PAGE_DOWN,ye.PAGE_UP,ye.PAUSE,ye.SCROLL_LOCK,ye.SHIFT,ye.TAB];function pX(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function FD(e){return vX.includes(e)}function gX(e){return[ye.CONTROL,ye.COMMAND_LEFT,ye.COMMAND_RIGHT,ye.COMMAND_FIREFOX].includes(e)}function Cs(e,t){var r=t.split("|"),n=!1;return $(r,function(o){if(e===ye[o])return n=!0,!1}),n}var yX=Bh,mX=gD;yX("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},mX);function ot(){if(fe(console)){var e;(e=console).warn.apply(e,arguments)}}function cC(){if(fe(console)){var e;(e=console).error.apply(e,arguments)}}var bX=Ae,wX=He,SX=hl,CX=wX([].reverse),OT=[1,2];bX({target:"Array",proto:!0,forced:String(OT)===String(OT.reverse())},{reverse:function(){return SX(this)&&(this.length=this.length),CX(this)}});function nt(e){return typeof e=="function"}function VD(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function WD(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function _X(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function kg(e,t,r,n,o,i,a,l){return fe(l)?e.call(t,r,n,o,i,a,l):fe(a)?e.call(t,r,n,o,i,a):fe(i)?e.call(t,r,n,o,i):fe(o)?e.call(t,r,n,o):fe(n)?e.call(t,r,n):fe(r)?e.call(t,r):e.call(t)}var RT;function OX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ET(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function RX(e,t,r){return t&&ET(e.prototype,t),r&&ET(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EX(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var na=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],TX=Je(RT||(RT=EX([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Ov=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Rv=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),UD=function(){function e(){OX(this,e),this.globalBucket=this.createEmptyBucket()}return RX(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return $(na,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))$(n,function(s){return o.add(r,s,i)});else{Ov.has(r)&&ot(PD(TX,{hookName:r,removedInVersion:Ov.get(r)})),Rv.has(r)&&ot(Rv.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&$(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?$(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var c=this.globalBucket[n],f=c?c.length:0,h=0;if(f)for(;h<f;){if(!c[h]||c[h].skip){h+=1;continue}var d=kg(c[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),c[h]&&c[h].runOnce&&this.remove(n,c[h]),h+=1}}{var v=this.getBucket(r)[n],g=v?v.length:0,y=0;if(g)for(;y<g;){if(!v[y]||v[y].skip){y+=1;continue}var w=kg(v[y],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[y]&&v[y].runOnce&&this.remove(n,v[y],r),y+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ve(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||na.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&na.splice(na.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Rv.has(r)||Ov.has(r)}},{key:"isRegistered",value:function(r){return na.indexOf(r)>=0}},{key:"getRegistered",value:function(){return na}}],[{key:"getSingleton",value:function(){return PX()}}]),e}(),kX=new UD;function PX(){return kX}const ge=UD;function TT(e){return MX(e)||$X(e)||IX(e)||AX()}function AX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IX(e,t){if(e){if(typeof e=="string")return Pg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pg(e,t)}}function $X(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MX(e){if(Array.isArray(e))return Pg(e)}function Pg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ev=new Map;function Rr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Ev.has(e)||Ev.set(e,new Map);var t=Ev.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return TT(t.keys())}function a(){return TT(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var Ag=new WeakMap,nu=Rr("editors"),xX=nu.register,DX=nu.getItem,HX=nu.hasItem;nu.getNames;nu.getValues;function NX(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},ge.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function zD(e,t){var r;if(typeof e=="function")Ag.get(e)||ur(null,e),r=Ag.get(e);else if(typeof e=="string")r=DX(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function ur(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new NX(t);typeof e=="string"&&xX(e,r),Ag.set(t,r)}function LX(e,t){return VX(e)||FX(e,t)||BX(e,t)||jX()}function jX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BX(e,t){if(e){if(typeof e=="string")return kT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kT(e,t)}}function kT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function VX(e){if(Array.isArray(e))return e}function WX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function UX(e,t,r){return t&&PT(e.prototype,t),r&&PT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Uh="editorManager.navigation",ns="editorManager.handlingEditor",Ig=function(){function e(t,r,n){var o=this;WX(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new vt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return UX(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:ns};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),rn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(g){g&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=LX(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var c=this.instance.rootDocument.activeElement;if(c&&c.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var f=this.instance.getCell(o,i,!0);if(f){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=zD(h,this.instance),this.activeEditor.prepare(o,i,d,f,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!FD(o)&&!gX(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return fe(n.instance.getSelected())},group:Uh};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),AT=new WeakMap;Ig.getInstance=function(e,t,r){var n=AT.get(e);return n||(n=new Ig(e,t,r),AT.set(e,n)),n};const zX=Ig;var IT=new WeakMap,$T=new WeakMap,GX="htBadValue",Fa="data-row",Va="data-col",YX="checkboxRenderer",GD="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===GD){if(n){var s=n.value,u=n.property,c=r;if(s)c=typeof s=="function"?s(i,a,l,r):s;else if(u){var f=this.getDataAtRowProp(i,u);c=f!==null?f:r}e=c}return e}});function fC(e,t,r,n,o,i,a){var l=e.rootDocument;ru.apply(this,[e,t,r,n,o,i,a]),KX(e);var s=XX(l),u=a.label,c=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Hr(t),i===a.checkedTemplate||wt(i).toLocaleLowerCase(a.locale)===wt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||wt(i).toLocaleLowerCase(a.locale)===wt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:At(i)?re(s,"noValue"):(s.style.display="none",re(s,GX),c=!0),s.setAttribute(Fa,r),s.setAttribute(Va,n),!c&&u){var f="";if(u.value)f=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);f=h!==null?h:""}var d=qX(l,f,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),c&&t.appendChild(l.createTextNode("#bad-value#")),IT.has(e)||(IT.set(e,!0),v());function v(){var w=e.getShortcutManager(),C=w.getContext("grid"),_={group:YX};C.addShortcuts([{keys:[["space"]],callback:function(){return g(),!y()}},{keys:[["enter"]],callback:function(){return g(),!y()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return g(!0),!y()},relativeToGroup:ns,position:"before"}],_)}function g(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=e.getSelectedRange();if(C)for(var _=0;_<C.length;_++){for(var I=C[_].getTopStartCorner(),E=I.row,U=I.col,G=C[_].getBottomEndCorner(),Q=G.row,K=G.col,X=[],J=E;J<=Q;J+=1)for(var le=U;le<=K;le+=1){var ee=e.getCellMeta(J,le);if(ee.type!=="checkbox")return;if(ee.readOnly!==!0){typeof ee.checkedTemplate>"u"&&(ee.checkedTemplate=!0),typeof ee.uncheckedTemplate>"u"&&(ee.uncheckedTemplate=!1);var he=e.getDataAtCell(J,le);w===!1?[ee.checkedTemplate,ee.checkedTemplate.toString()].includes(he)?X.push([J,le,ee.uncheckedTemplate]):[ee.uncheckedTemplate,ee.uncheckedTemplate.toString(),null,void 0].includes(he)&&X.push([J,le,ee.checkedTemplate]):X.push([J,le,ee.uncheckedTemplate])}}X.length>0&&e.setDataAtCell(X)}}function y(){var w=e.getSelectedRange();if(w){for(var C=0;C<w.length;C++)for(var _=w[C].getTopStartCorner(),I=w[C].getBottomEndCorner(),E=_.row;E<=I.row;E++)for(var U=_.col;U<=I.col;U++){var G=e.getCellMeta(E,U);if(G.type!=="checkbox")return!1;var Q=e.getCell(E,U);if(Q==null)return!0;var K=Q.querySelectorAll("input[type=checkbox]");if(K.length>0&&!G.readOnly)return!0}return!1}}}fC.RENDERER_TYPE=GD;function KX(e){var t=$T.get(e);if(!t){var r=e.rootElement;t=new vt(e),t.addEventListener(r,"click",function(n){return ZX(n,e)}),t.addEventListener(r,"mouseup",function(n){return QX(n,e)}),t.addEventListener(r,"change",function(n){return JX(n,e)}),$T.set(e,t)}return t}function XX(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function qX(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function QX(e,t){var r=e.target;hC(r)&&(!r.hasAttribute(Fa)||!r.hasAttribute(Va)||setTimeout(t.listen,10))}function ZX(e,t){var r=e.target;if(hC(r)&&!(!r.hasAttribute(Fa)||!r.hasAttribute(Va))){var n=parseInt(r.getAttribute(Fa),10),o=parseInt(r.getAttribute(Va),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function JX(e,t){var r=e.target;if(hC(r)&&!(!r.hasAttribute(Fa)||!r.hasAttribute(Va))){var n=parseInt(r.getAttribute(Fa),10),o=parseInt(r.getAttribute(Va),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function hC(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var $g={},eq={get exports(){return $g},set exports(e){$g=e}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,c){if(!o[u]){if(!n[u]){var f=typeof bu=="function"&&bu;if(!c&&f)return f(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof bu=="function"&&bu,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,w=1e9;function C(K){var X=0|K;return 0<K||K===X?X:X-1}function _(K){for(var X,J,le=1,ee=K.length,he=K[0]+"";le<ee;){for(X=K[le++]+"",J=d-X.length;J--;X="0"+X);he+=X}for(ee=he.length;he.charCodeAt(--ee)===48;);return he.slice(0,ee+1||1)}function I(K,X){var J,le,ee=K.c,he=X.c,Ce=K.s,_e=X.s,be=K.e,P=X.e;if(!Ce||!_e)return null;if(J=ee&&!ee[0],le=he&&!he[0],J||le)return J?le?0:-_e:Ce;if(Ce!=_e)return Ce;if(J=Ce<0,le=be==P,!ee||!he)return le?0:!ee^J?1:-1;if(!le)return P<be^J?1:-1;for(_e=(be=ee.length)<(P=he.length)?be:P,Ce=0;Ce<_e;Ce++)if(ee[Ce]!=he[Ce])return ee[Ce]>he[Ce]^J?1:-1;return be==P?0:P<be^J?1:-1}function E(K,X,J,le){if(K<X||J<K||K!==(K<0?s(K):u(K)))throw Error(c+(le||"Argument")+(typeof K=="number"?K<X||J<K?" out of range: ":" not an integer: ":" not a primitive number: ")+String(K))}function U(K){var X=K.c.length-1;return C(K.e/d)==X&&K.c[X]%2!=0}function G(K,X){return(1<K.length?K.charAt(0)+"."+K.slice(1):K)+(X<0?"e":"e+")+X}function Q(K,X,J){var le,ee;if(X<0){for(ee=J+".";++X;ee+=J);K=ee+K}else if(++X>(le=K.length)){for(ee=J,X-=le;--X;ee+=J);K+=ee}else X<le&&(K=K.slice(0,X)+"."+K.slice(X));return K}(a=function K(X){var J,le,ee,he,Ce,_e,be,P,T,Y,p=F.prototype={constructor:F,toString:null,valueOf:null},m=new F(1),b=20,R=4,k=-7,j=21,W=-1e7,q=1e7,Z=!1,ne=1,te=0,ue={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},we="0123456789abcdefghijklmnopqrstuvwxyz";function F(S,O){var A,L,M,V,H,x,B,D,z=this;if(!(z instanceof F))return new F(S,O);if(O==null){if(S instanceof F)return z.s=S.s,z.e=S.e,void(z.c=(S=S.c)?S.slice():S);if((x=typeof S=="number")&&0*S==0){if(z.s=1/S<0?(S=-S,-1):1,S===~~S){for(V=0,H=S;10<=H;H/=10,V++);return z.e=V,void(z.c=[S])}D=String(S)}else{if(D=String(S),!l.test(D))return ee(z,D,x);z.s=D.charCodeAt(0)==45?(D=D.slice(1),-1):1}-1<(V=D.indexOf("."))&&(D=D.replace(".","")),0<(H=D.search(/e/i))?(V<0&&(V=H),V+=+D.slice(H+1),D=D.substring(0,H)):V<0&&(V=D.length)}else{if(E(O,2,we.length,"Base"),D=String(S),O==10)return Pe(z=new F(S instanceof F?S:D),b+z.e+1,R);if(x=typeof S=="number"){if(0*S!=0)return ee(z,D,x,O);if(z.s=1/S<0?(D=D.slice(1),-1):1,F.DEBUG&&15<D.replace(/^0\.0*|\./,"").length)throw Error(f+S);x=!1}else z.s=D.charCodeAt(0)===45?(D=D.slice(1),-1):1;for(A=we.slice(0,O),V=H=0,B=D.length;H<B;H++)if(A.indexOf(L=D.charAt(H))<0){if(L=="."){if(V<H){V=B;continue}}else if(!M&&(D==D.toUpperCase()&&(D=D.toLowerCase())||D==D.toLowerCase()&&(D=D.toUpperCase()))){M=!0,H=-1,V=0;continue}return ee(z,String(S),x,O)}-1<(V=(D=le(D,O,10,z.s)).indexOf("."))?D=D.replace(".",""):V=D.length}for(H=0;D.charCodeAt(H)===48;H++);for(B=D.length;D.charCodeAt(--B)===48;);if(D=D.slice(H,++B)){if(B-=H,x&&F.DEBUG&&15<B&&(v<S||S!==u(S)))throw Error(f+z.s*S);if(q<(V=V-H-1))z.c=z.e=null;else if(V<W)z.c=[z.e=0];else{if(z.e=V,z.c=[],H=(V+1)%d,V<0&&(H+=d),H<B){for(H&&z.c.push(+D.slice(0,H)),B-=d;H<B;)z.c.push(+D.slice(H,H+=d));D=D.slice(H),H=d-D.length}else H-=B;for(;H--;D+="0");z.c.push(+D)}}else z.c=[z.e=0]}function Se(S,O,A,L){var M,V,H,x,B;if(A==null?A=R:E(A,0,8),!S.c)return S.toString();if(M=S.c[0],H=S.e,O==null)B=_(S.c),B=L==1||L==2&&(H<=k||j<=H)?G(B,H):Q(B,H,"0");else if(V=(S=Pe(new F(S),O,A)).e,x=(B=_(S.c)).length,L==1||L==2&&(O<=V||V<=k)){for(;x<O;B+="0",x++);B=G(B,V)}else if(O-=H,B=Q(B,V,"0"),x<V+1){if(0<--O)for(B+=".";O--;B+="0");}else if(0<(O+=V-x))for(V+1==x&&(B+=".");O--;B+="0");return S.s<0&&M?"-"+B:B}function Ie(S,O){for(var A,L=1,M=new F(S[0]);L<S.length;L++){if(!(A=new F(S[L])).s){M=A;break}O.call(M,A)&&(M=A)}return M}function Re(S,O,A){for(var L=1,M=O.length;!O[--M];O.pop());for(M=O[0];10<=M;M/=10,L++);return(A=L+A*d-1)>q?S.c=S.e=null:S.c=A<W?[S.e=0]:(S.e=A,O),S}function Pe(S,O,A,L){var M,V,H,x,B,D,z,oe=S.c,ae=g;if(oe){e:{for(M=1,x=oe[0];10<=x;x/=10,M++);if((V=O-M)<0)V+=d,H=O,z=(B=oe[D=0])/ae[M-H-1]%10|0;else if((D=s((V+1)/d))>=oe.length){if(!L)break e;for(;oe.length<=D;oe.push(0));B=z=0,H=(V%=d)-d+(M=1)}else{for(B=x=oe[D],M=1;10<=x;x/=10,M++);z=(H=(V%=d)-d+M)<0?0:B/ae[M-H-1]%10|0}if(L=L||O<0||oe[D+1]!=null||(H<0?B:B%ae[M-H-1]),L=A<4?(z||L)&&(A==0||A==(S.s<0?3:2)):5<z||z==5&&(A==4||L||A==6&&(0<V?0<H?B/ae[M-H]:0:oe[D-1])%10&1||A==(S.s<0?8:7)),O<1||!oe[0])return oe.length=0,L?(O-=S.e+1,oe[0]=ae[(d-O%d)%d],S.e=-O||0):oe[0]=S.e=0,S;if(V==0?(oe.length=D,x=1,D--):(oe.length=D+1,x=ae[d-V],oe[D]=0<H?u(B/ae[M-H]%ae[H])*x:0),L)for(;;){if(D==0){for(V=1,H=oe[0];10<=H;H/=10,V++);for(H=oe[0]+=x,x=1;10<=H;H/=10,x++);V!=x&&(S.e++,oe[0]==h&&(oe[0]=1));break}if(oe[D]+=x,oe[D]!=h)break;oe[D--]=0,x=1}for(V=oe.length;oe[--V]===0;oe.pop());}S.e>q?S.c=S.e=null:S.e<W&&(S.c=[S.e=0])}return S}function ke(S){var O,A=S.e;return A===null?S.toString():(O=_(S.c),O=A<=k||j<=A?G(O,A):Q(O,A,"0"),S.s<0?"-"+O:O)}return F.clone=K,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(S){var O,A;if(S!=null){if(typeof S!="object")throw Error(c+"Object expected: "+S);if(S.hasOwnProperty(O="DECIMAL_PLACES")&&(E(A=S[O],0,w,O),b=A),S.hasOwnProperty(O="ROUNDING_MODE")&&(E(A=S[O],0,8,O),R=A),S.hasOwnProperty(O="EXPONENTIAL_AT")&&((A=S[O])&&A.pop?(E(A[0],-w,0,O),E(A[1],0,w,O),k=A[0],j=A[1]):(E(A,-w,w,O),k=-(j=A<0?-A:A))),S.hasOwnProperty(O="RANGE"))if((A=S[O])&&A.pop)E(A[0],-w,-1,O),E(A[1],1,w,O),W=A[0],q=A[1];else{if(E(A,-w,w,O),!A)throw Error(c+O+" cannot be zero: "+A);W=-(q=A<0?-A:A)}if(S.hasOwnProperty(O="CRYPTO")){if((A=S[O])!==!!A)throw Error(c+O+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Z=!A,Error(c+"crypto unavailable");Z=A}else Z=A}if(S.hasOwnProperty(O="MODULO_MODE")&&(E(A=S[O],0,9,O),ne=A),S.hasOwnProperty(O="POW_PRECISION")&&(E(A=S[O],0,w,O),te=A),S.hasOwnProperty(O="FORMAT")){if(typeof(A=S[O])!="object")throw Error(c+O+" not an object: "+A);ue=A}if(S.hasOwnProperty(O="ALPHABET")){if(typeof(A=S[O])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(c+O+" invalid: "+A);we=A}}return{DECIMAL_PLACES:b,ROUNDING_MODE:R,EXPONENTIAL_AT:[k,j],RANGE:[W,q],CRYPTO:Z,MODULO_MODE:ne,POW_PRECISION:te,FORMAT:ue,ALPHABET:we}},F.isBigNumber=function(S){return S instanceof F||S&&S._isBigNumber===!0||!1},F.maximum=F.max=function(){return Ie(arguments,p.lt)},F.minimum=F.min=function(){return Ie(arguments,p.gt)},F.random=(he=9007199254740992,Ce=Math.random()*he&2097151?function(){return u(Math.random()*he)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(S){var O,A,L,M,V,H=0,x=[],B=new F(m);if(S==null?S=b:E(S,0,w),M=s(S/d),Z)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(M*=2));H<M;)9e15<=(V=131072*O[H]+(O[H+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),O[H]=A[0],O[H+1]=A[1]):(x.push(V%1e14),H+=2);H=M/2}else{if(!crypto.randomBytes)throw Z=!1,Error(c+"crypto unavailable");for(O=crypto.randomBytes(M*=7);H<M;)9e15<=(V=281474976710656*(31&O[H])+1099511627776*O[H+1]+4294967296*O[H+2]+16777216*O[H+3]+(O[H+4]<<16)+(O[H+5]<<8)+O[H+6])?crypto.randomBytes(7).copy(O,H):(x.push(V%1e14),H+=7);H=M/7}if(!Z)for(;H<M;)(V=Ce())<9e15&&(x[H++]=V%1e14);for(M=x[--H],S%=d,M&&S&&(V=g[d-S],x[H]=u(M/V)*V);x[H]===0;x.pop(),H--);if(H<0)x=[L=0];else{for(L=-1;x[0]===0;x.splice(0,1),L-=d);for(H=1,V=x[0];10<=V;V/=10,H++);H<d&&(L-=d-H)}return B.e=L,B.c=x,B}),F.sum=function(){for(var S=1,O=arguments,A=new F(O[0]);S<O.length;)A=A.plus(O[S++]);return A},le=function(){var S="0123456789";function O(A,L,M,V){for(var H,x,B=[0],D=0,z=A.length;D<z;){for(x=B.length;x--;B[x]*=L);for(B[0]+=V.indexOf(A.charAt(D++)),H=0;H<B.length;H++)B[H]>M-1&&(B[H+1]==null&&(B[H+1]=0),B[H+1]+=B[H]/M|0,B[H]%=M)}return B.reverse()}return function(A,L,M,V,H){var x,B,D,z,oe,ae,se,Ee,$e=A.indexOf("."),ze=b,Me=R;for(0<=$e&&(z=te,te=0,A=A.replace(".",""),ae=(Ee=new F(L)).pow(A.length-$e),te=z,Ee.c=O(Q(_(ae.c),ae.e,"0"),10,M,S),Ee.e=Ee.c.length),D=z=(se=O(A,L,M,H?(x=we,S):(x=S,we))).length;se[--z]==0;se.pop());if(!se[0])return x.charAt(0);if($e<0?--D:(ae.c=se,ae.e=D,ae.s=V,se=(ae=J(ae,Ee,ze,Me,M)).c,oe=ae.r,D=ae.e),$e=se[B=D+ze+1],z=M/2,oe=oe||B<0||se[B+1]!=null,oe=Me<4?($e!=null||oe)&&(Me==0||Me==(ae.s<0?3:2)):z<$e||$e==z&&(Me==4||oe||Me==6&&1&se[B-1]||Me==(ae.s<0?8:7)),B<1||!se[0])A=oe?Q(x.charAt(1),-ze,x.charAt(0)):x.charAt(0);else{if(se.length=B,oe)for(--M;++se[--B]>M;)se[B]=0,B||(++D,se=[1].concat(se));for(z=se.length;!se[--z];);for($e=0,A="";$e<=z;A+=x.charAt(se[$e++]));A=Q(A,D,x.charAt(0))}return A}}(),J=function(){function S(L,M,V){var H,x,B,D,z=0,oe=L.length,ae=M%y,se=M/y|0;for(L=L.slice();oe--;)z=((x=ae*(B=L[oe]%y)+(H=se*B+(D=L[oe]/y|0)*ae)%y*y+z)/V|0)+(H/y|0)+se*D,L[oe]=x%V;return z&&(L=[z].concat(L)),L}function O(L,M,V,H){var x,B;if(V!=H)B=H<V?1:-1;else for(x=B=0;x<V;x++)if(L[x]!=M[x]){B=L[x]>M[x]?1:-1;break}return B}function A(L,M,V,H){for(var x=0;V--;)L[V]-=x,x=L[V]<M[V]?1:0,L[V]=x*H+L[V]-M[V];for(;!L[0]&&1<L.length;L.splice(0,1));}return function(L,M,V,H,x){var B,D,z,oe,ae,se,Ee,$e,ze,Me,Oe,qe,ir,Er,Ot,st,Lr,It=L.s==M.s?1:-1,gt=L.c,Qe=M.c;if(!(gt&&gt[0]&&Qe&&Qe[0]))return new F(L.s&&M.s&&(gt?!Qe||gt[0]!=Qe[0]:Qe)?gt&&gt[0]==0||!Qe?0*It:It/0:NaN);for(ze=($e=new F(It)).c=[],It=V+(D=L.e-M.e)+1,x||(x=h,D=C(L.e/d)-C(M.e/d),It=It/d|0),z=0;Qe[z]==(gt[z]||0);z++);if(Qe[z]>(gt[z]||0)&&D--,It<0)ze.push(1),oe=!0;else{for(Er=gt.length,st=Qe.length,It+=2,1<(ae=u(x/(Qe[z=0]+1)))&&(Qe=S(Qe,ae,x),gt=S(gt,ae,x),st=Qe.length,Er=gt.length),ir=st,Oe=(Me=gt.slice(0,st)).length;Oe<st;Me[Oe++]=0);Lr=Qe.slice(),Lr=[0].concat(Lr),Ot=Qe[0],Qe[1]>=x/2&&Ot++;do{if(ae=0,(B=O(Qe,Me,st,Oe))<0){if(qe=Me[0],st!=Oe&&(qe=qe*x+(Me[1]||0)),1<(ae=u(qe/Ot)))for(x<=ae&&(ae=x-1),Ee=(se=S(Qe,ae,x)).length,Oe=Me.length;O(se,Me,Ee,Oe)==1;)ae--,A(se,st<Ee?Lr:Qe,Ee,x),Ee=se.length,B=1;else ae==0&&(B=ae=1),Ee=(se=Qe.slice()).length;if(Ee<Oe&&(se=[0].concat(se)),A(Me,se,Oe,x),Oe=Me.length,B==-1)for(;O(Qe,Me,st,Oe)<1;)ae++,A(Me,st<Oe?Lr:Qe,Oe,x),Oe=Me.length}else B===0&&(ae++,Me=[0]);ze[z++]=ae,Me[0]?Me[Oe++]=gt[ir]||0:(Me=[gt[ir]],Oe=1)}while((ir++<Er||Me[0]!=null)&&It--);oe=Me[0]!=null,ze[0]||ze.splice(0,1)}if(x==h){for(z=1,It=ze[0];10<=It;It/=10,z++);Pe($e,V+($e.e=z+D*d-1)+1,H,oe)}else $e.e=D,$e.r=+oe;return $e}}(),_e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,be=/^([^.]+)\.$/,P=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,Y=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ee=function(S,O,A,L){var M,V=A?O:O.replace(Y,"");if(T.test(V))S.s=isNaN(V)?null:V<0?-1:1,S.c=S.e=null;else{if(!A&&(V=V.replace(_e,function(H,x,B){return M=(B=B.toLowerCase())=="x"?16:B=="b"?2:8,L&&L!=M?H:x}),L&&(M=L,V=V.replace(be,"$1").replace(P,"0.$1")),O!=V))return new F(V,M);if(F.DEBUG)throw Error(c+"Not a"+(L?" base "+L:"")+" number: "+O);S.c=S.e=S.s=null}},p.absoluteValue=p.abs=function(){var S=new F(this);return S.s<0&&(S.s=1),S},p.comparedTo=function(S,O){return I(this,new F(S,O))},p.decimalPlaces=p.dp=function(S,O){var A,L,M;if(S!=null)return E(S,0,w),O==null?O=R:E(O,0,8),Pe(new F(this),S+this.e+1,O);if(!(A=this.c))return null;if(L=((M=A.length-1)-C(this.e/d))*d,M=A[M])for(;M%10==0;M/=10,L--);return L<0&&(L=0),L},p.dividedBy=p.div=function(S,O){return J(this,new F(S,O),b,R)},p.dividedToIntegerBy=p.idiv=function(S,O){return J(this,new F(S,O),0,1)},p.exponentiatedBy=p.pow=function(S,O){var A,L,M,V,H,x,B,D,z=this;if((S=new F(S)).c&&!S.isInteger())throw Error(c+"Exponent not an integer: "+ke(S));if(O!=null&&(O=new F(O)),H=14<S.e,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!S.c||!S.c[0])return D=new F(Math.pow(+ke(z),H?2-U(S):+ke(S))),O?D.mod(O):D;if(x=S.s<0,O){if(O.c?!O.c[0]:!O.s)return new F(NaN);(L=!x&&z.isInteger()&&O.isInteger())&&(z=z.mod(O))}else{if(9<S.e&&(0<z.e||z.e<-1||(z.e==0?1<z.c[0]||H&&24e7<=z.c[1]:z.c[0]<8e13||H&&z.c[0]<=9999975e7)))return V=z.s<0&&U(S)?-0:0,-1<z.e&&(V=1/V),new F(x?1/V:V);te&&(V=s(te/d+2))}for(B=H?(A=new F(.5),x&&(S.s=1),U(S)):(M=Math.abs(+ke(S)))%2,D=new F(m);;){if(B){if(!(D=D.times(z)).c)break;V?D.c.length>V&&(D.c.length=V):L&&(D=D.mod(O))}if(M){if((M=u(M/2))===0)break;B=M%2}else if(Pe(S=S.times(A),S.e+1,1),14<S.e)B=U(S);else{if((M=+ke(S))==0)break;B=M%2}z=z.times(z),V?z.c&&z.c.length>V&&(z.c.length=V):L&&(z=z.mod(O))}return L?D:(x&&(D=m.div(D)),O?D.mod(O):V?Pe(D,te,R,void 0):D)},p.integerValue=function(S){var O=new F(this);return S==null?S=R:E(S,0,8),Pe(O,O.e+1,S)},p.isEqualTo=p.eq=function(S,O){return I(this,new F(S,O))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(S,O){return 0<I(this,new F(S,O))},p.isGreaterThanOrEqualTo=p.gte=function(S,O){return(O=I(this,new F(S,O)))===1||O===0},p.isInteger=function(){return!!this.c&&C(this.e/d)>this.c.length-2},p.isLessThan=p.lt=function(S,O){return I(this,new F(S,O))<0},p.isLessThanOrEqualTo=p.lte=function(S,O){return(O=I(this,new F(S,O)))===-1||O===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(S,O){var A,L,M,V,H=this,x=H.s;if(O=(S=new F(S,O)).s,!x||!O)return new F(NaN);if(x!=O)return S.s=-O,H.plus(S);var B=H.e/d,D=S.e/d,z=H.c,oe=S.c;if(!B||!D){if(!z||!oe)return z?(S.s=-O,S):new F(oe?H:NaN);if(!z[0]||!oe[0])return oe[0]?(S.s=-O,S):new F(z[0]?H:R==3?-0:0)}if(B=C(B),D=C(D),z=z.slice(),x=B-D){for((M=(V=x<0)?(x=-x,z):(D=B,oe)).reverse(),O=x;O--;M.push(0));M.reverse()}else for(L=(V=(x=z.length)<(O=oe.length))?x:O,x=O=0;O<L;O++)if(z[O]!=oe[O]){V=z[O]<oe[O];break}if(V&&(M=z,z=oe,oe=M,S.s=-S.s),0<(O=(L=oe.length)-(A=z.length)))for(;O--;z[A++]=0);for(O=h-1;x<L;){if(z[--L]<oe[L]){for(A=L;A&&!z[--A];z[A]=O);--z[A],z[L]+=h}z[L]-=oe[L]}for(;z[0]==0;z.splice(0,1),--D);return z[0]?Re(S,z,D):(S.s=R==3?-1:1,S.c=[S.e=0],S)},p.modulo=p.mod=function(S,O){var A,L,M=this;return S=new F(S,O),!M.c||!S.s||S.c&&!S.c[0]?new F(NaN):!S.c||M.c&&!M.c[0]?new F(M):(ne==9?(L=S.s,S.s=1,A=J(M,S,0,3),S.s=L,A.s*=L):A=J(M,S,0,ne),(S=M.minus(A.times(S))).c[0]||ne!=1||(S.s=M.s),S)},p.multipliedBy=p.times=function(S,O){var A,L,M,V,H,x,B,D,z,oe,ae,se,Ee,$e,ze,Me=this,Oe=Me.c,qe=(S=new F(S,O)).c;if(!(Oe&&qe&&Oe[0]&&qe[0]))return!Me.s||!S.s||Oe&&!Oe[0]&&!qe||qe&&!qe[0]&&!Oe?S.c=S.e=S.s=null:(S.s*=Me.s,Oe&&qe?(S.c=[0],S.e=0):S.c=S.e=null),S;for(L=C(Me.e/d)+C(S.e/d),S.s*=Me.s,(B=Oe.length)<(oe=qe.length)&&(Ee=Oe,Oe=qe,qe=Ee,M=B,B=oe,oe=M),M=B+oe,Ee=[];M--;Ee.push(0));for($e=h,ze=y,M=oe;0<=--M;){for(A=0,ae=qe[M]%ze,se=qe[M]/ze|0,V=M+(H=B);M<V;)A=((D=ae*(D=Oe[--H]%ze)+(x=se*D+(z=Oe[H]/ze|0)*ae)%ze*ze+Ee[V]+A)/$e|0)+(x/ze|0)+se*z,Ee[V--]=D%$e;Ee[V]=A}return A?++L:Ee.splice(0,1),Re(S,Ee,L)},p.negated=function(){var S=new F(this);return S.s=-S.s||null,S},p.plus=function(S,O){var A,L=this,M=L.s;if(O=(S=new F(S,O)).s,!M||!O)return new F(NaN);if(M!=O)return S.s=-O,L.minus(S);var V=L.e/d,H=S.e/d,x=L.c,B=S.c;if(!V||!H){if(!x||!B)return new F(M/0);if(!x[0]||!B[0])return B[0]?S:new F(x[0]?L:0*M)}if(V=C(V),H=C(H),x=x.slice(),M=V-H){for((A=0<M?(H=V,B):(M=-M,x)).reverse();M--;A.push(0));A.reverse()}for((M=x.length)-(O=B.length)<0&&(A=B,B=x,x=A,O=M),M=0;O;)M=(x[--O]=x[O]+B[O]+M)/h|0,x[O]=h===x[O]?0:x[O]%h;return M&&(x=[M].concat(x),++H),Re(S,x,H)},p.precision=p.sd=function(S,O){var A,L,M;if(S!=null&&S!==!!S)return E(S,1,w),O==null?O=R:E(O,0,8),Pe(new F(this),S,O);if(!(A=this.c))return null;if(L=(M=A.length-1)*d+1,M=A[M]){for(;M%10==0;M/=10,L--);for(M=A[0];10<=M;M/=10,L++);}return S&&this.e+1>L&&(L=this.e+1),L},p.shiftedBy=function(S){return E(S,-v,v),this.times("1e"+S)},p.squareRoot=p.sqrt=function(){var S,O,A,L,M,V=this,H=V.c,x=V.s,B=V.e,D=b+4,z=new F("0.5");if(x!==1||!H||!H[0])return new F(!x||x<0&&(!H||H[0])?NaN:H?V:1/0);if((A=(x=Math.sqrt(+ke(V)))==0||x==1/0?(((O=_(H)).length+B)%2==0&&(O+="0"),x=Math.sqrt(+O),B=C((B+1)/2)-(B<0||B%2),new F(O=x==1/0?"1e"+B:(O=x.toExponential()).slice(0,O.indexOf("e")+1)+B)):new F(x+"")).c[0]){for((x=(B=A.e)+D)<3&&(x=0);;)if(M=A,A=z.times(M.plus(J(V,M,D,1))),_(M.c).slice(0,x)===(O=_(A.c)).slice(0,x)){if(A.e<B&&--x,(O=O.slice(x-3,x+1))!="9999"&&(L||O!="4999")){+O&&(+O.slice(1)||O.charAt(0)!="5")||(Pe(A,A.e+b+2,1),S=!A.times(A).eq(V));break}if(!L&&(Pe(M,M.e+b+2,0),M.times(M).eq(V))){A=M;break}D+=4,x+=4,L=1}}return Pe(A,A.e+b+1,R,S)},p.toExponential=function(S,O){return S!=null&&(E(S,0,w),S++),Se(this,S,O,1)},p.toFixed=function(S,O){return S!=null&&(E(S,0,w),S=S+this.e+1),Se(this,S,O)},p.toFormat=function(S,O,A){var L;if(A==null)S!=null&&O&&typeof O=="object"?(A=O,O=null):S&&typeof S=="object"?(A=S,S=O=null):A=ue;else if(typeof A!="object")throw Error(c+"Argument not an object: "+A);if(L=this.toFixed(S,O),this.c){var M,V=L.split("."),H=+A.groupSize,x=+A.secondaryGroupSize,B=A.groupSeparator||"",D=V[0],z=V[1],oe=this.s<0,ae=oe?D.slice(1):D,se=ae.length;if(x&&(M=H,H=x,se-=x=M),0<H&&0<se){for(M=se%H||H,D=ae.substr(0,M);M<se;M+=H)D+=B+ae.substr(M,H);0<x&&(D+=B+ae.slice(M)),oe&&(D="-"+D)}L=z?D+(A.decimalSeparator||"")+((x=+A.fractionGroupSize)?z.replace(new RegExp("\\d{"+x+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):z):D}return(A.prefix||"")+L+(A.suffix||"")},p.toFraction=function(S){var O,A,L,M,V,H,x,B,D,z,oe,ae,se=this,Ee=se.c;if(S!=null&&(!(x=new F(S)).isInteger()&&(x.c||x.s!==1)||x.lt(m)))throw Error(c+"Argument "+(x.isInteger()?"out of range: ":"not an integer: ")+ke(x));if(!Ee)return new F(se);for(O=new F(m),D=A=new F(m),L=B=new F(m),ae=_(Ee),V=O.e=ae.length-se.e-1,O.c[0]=g[(H=V%d)<0?d+H:H],S=!S||0<x.comparedTo(O)?0<V?O:D:x,H=q,q=1/0,x=new F(ae),B.c[0]=0;z=J(x,O,0,1),(M=A.plus(z.times(L))).comparedTo(S)!=1;)A=L,L=M,D=B.plus(z.times(M=D)),B=M,O=x.minus(z.times(M=O)),x=M;return M=J(S.minus(A),L,0,1),B=B.plus(M.times(D)),A=A.plus(M.times(L)),B.s=D.s=se.s,oe=J(D,L,V*=2,R).minus(se).abs().comparedTo(J(B,A,V,R).minus(se).abs())<1?[D,L]:[B,A],q=H,oe},p.toNumber=function(){return+ke(this)},p.toPrecision=function(S,O){return S!=null&&E(S,1,w),Se(this,S,O,2)},p.toString=function(S){var O,A=this,L=A.s,M=A.e;return M===null?L?(O="Infinity",L<0&&(O="-"+O)):O="NaN":(O=S==null?M<=k||j<=M?G(_(A.c),M):Q(_(A.c),M,"0"):S===10?Q(_((A=Pe(new F(A),b+M+1,R)).c),A.e,"0"):(E(S,2,we.length,"Base"),le(Q(_(A.c),M,"0"),10,S,L,!0)),L<0&&A.c[0]&&(O="-"+O)),O},p.valueOf=p.toJSON=function(){return ke(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),X!=null&&F.set(X),F}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(C,_){return function(I){if(Array.isArray(I))return I}(C)||function(I,E){var U=[],G=!0,Q=!1,K=void 0;try{for(var X,J=I[Symbol.iterator]();!(G=(X=J.next()).done)&&(U.push(X.value),!E||U.length!==E);G=!0);}catch(le){Q=!0,K=le}finally{try{G||J.return==null||J.return()}finally{if(Q)throw K}}return U}(C,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(C){var _=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},I=2<arguments.length?arguments[2]:void 0;if(typeof _=="string"&&(_=s.parseFormat(_)),!l.validateFormat(_))return"ERROR: invalid format";var E=_.prefix||"",U=_.postfix||"",G=function(Q,K,X){switch(K.output){case"currency":return K=w(K,a.currentCurrencyDefaultFormat()),function(we,F,Se){var Ie=Se.currentCurrency(),Re=Object.assign({},f,F),Pe=void 0,ke="",S=!!Re.totalLength||!!Re.forceAverage||Re.average,O=F.currencyPosition||Ie.position,A=F.currencySymbol||Ie.symbol;Re.spaceSeparated&&(ke=" "),O==="infix"&&(Pe=ke+A+ke);var L=y({instance:we,providedFormat:F,state:Se,decimalSeparator:Pe});return O==="prefix"&&(L=we._value<0&&Re.negative==="sign"?"-".concat(ke).concat(A).concat(L.slice(1)):A+ke+L),O&&O!=="postfix"||(L=L+(ke=S?"":ke)+A),L}(Q,K,a);case"percent":return K=w(K,a.currentPercentageDefaultFormat()),function(we,F,Se,Ie){var Re=F.prefixSymbol,Pe=y({instance:Ie(100*we._value),providedFormat:F,state:Se}),ke=Object.assign({},f,F);return Re?"%".concat(ke.spaceSeparated?" ":"").concat(Pe):"".concat(Pe).concat(ke.spaceSeparated?" ":"","%")}(Q,K,a,X);case"byte":return K=w(K,a.currentByteDefaultFormat()),m=Q,R=a,k=X,j=(b=K).base||"binary",W=c[j],q=d(m._value,W.suffixes,W.scale),Z=q.value,ne=q.suffix,te=y({instance:k(Z),providedFormat:b,state:R,defaults:R.currentByteDefaultFormat()}),ue=R.currentAbbreviations(),"".concat(te).concat(ue.spaced?" ":"").concat(ne);case"time":return K=w(K,a.currentTimeDefaultFormat()),P=Q,T=Math.floor(P._value/60/60),Y=Math.floor((P._value-60*T*60)/60),p=Math.round(P._value-60*T*60-60*Y),"".concat(T,":").concat(Y<10?"0":"").concat(Y,":").concat(p<10?"0":"").concat(p);case"ordinal":return K=w(K,a.currentOrdinalDefaultFormat()),J=Q,le=K,he=(ee=a).currentOrdinal(),Ce=Object.assign({},f,le),_e=y({instance:J,providedFormat:le,state:ee}),be=he(J._value),"".concat(_e).concat(Ce.spaceSeparated?" ":"").concat(be);case"number":default:return y({instance:Q,providedFormat:K,numbro:X})}var J,le,ee,he,Ce,_e,be,P,T,Y,p,m,b,R,k,j,W,q,Z,ne,te,ue}(C,_,I);return G=(G=E+G)+U}function d(C,_,I){var E=_[0],U=Math.abs(C);if(I<=U){for(var G=1;G<_.length;++G){var Q=Math.pow(I,G),K=Math.pow(I,G+1);if(Q<=U&&U<K){E=_[G],C/=Q;break}}E===_[0]&&(C/=Math.pow(I,_.length-1),E=_[_.length-1])}return{value:C,suffix:E}}function v(C){for(var _="",I=0;I<C;I++)_+="0";return _}function g(C,_){return C.toString().indexOf("e")!==-1?function(I,E){var U=I.toString(),G=i(U.split("e"),2),Q=G[0],K=G[1],X=i(Q.split("."),2),J=X[0],le=X[1],ee=le===void 0?"":le;if(0<+K)U=J+ee+v(K-ee.length);else{var he=".";he=+J<0?"-0".concat(he):"0".concat(he);var Ce=(v(-K-1)+Math.abs(J)+ee).substr(0,E);Ce.length<E&&(Ce+=v(E-Ce.length)),U=he+Ce}return 0<+K&&0<E&&(U+=".".concat(v(E))),U}(C,_):(Math.round(+"".concat(C,"e+").concat(_))/Math.pow(10,_)).toFixed(_)}function y(C){var _=C.instance,I=C.providedFormat,E=C.state,U=E===void 0?a:E,G=C.decimalSeparator,Q=C.defaults,K=Q===void 0?U.currentDefaults():Q,X=_._value;if(X===0&&U.hasZeroFormat())return U.getZeroFormat();if(!isFinite(X))return X.toString();var J,le,ee,he,Ce,_e,be,P,T=Object.assign({},f,K,I),Y=T.totalLength,p=Y?0:T.characteristic,m=T.optionalCharacteristic,b=T.forceAverage,R=!!Y||!!b||T.average,k=Y?-1:R&&I.mantissa===void 0?0:T.mantissa,j=!Y&&(I.optionalMantissa===void 0?k===-1:T.optionalMantissa),W=T.trimMantissa,q=T.thousandSeparated,Z=T.spaceSeparated,ne=T.negative,te=T.forceSign,ue=T.exponential,we="";if(R){var F=function(S){var O=S.value,A=S.forceAverage,L=S.abbreviations,M=S.spaceSeparated,V=M!==void 0&&M,H=S.totalLength,x=H===void 0?0:H,B="",D=Math.abs(O),z=-1;if(D>=Math.pow(10,12)&&!A||A==="trillion"?(B=L.trillion,O/=Math.pow(10,12)):D<Math.pow(10,12)&&D>=Math.pow(10,9)&&!A||A==="billion"?(B=L.billion,O/=Math.pow(10,9)):D<Math.pow(10,9)&&D>=Math.pow(10,6)&&!A||A==="million"?(B=L.million,O/=Math.pow(10,6)):(D<Math.pow(10,6)&&D>=Math.pow(10,3)&&!A||A==="thousand")&&(B=L.thousand,O/=Math.pow(10,3)),B&&(B=(V?" ":"")+B),x){var oe=O.toString().split(".")[0];z=Math.max(x-oe.length,0)}return{value:O,abbreviation:B,mantissaPrecision:z}}({value:X,forceAverage:b,abbreviations:U.currentAbbreviations(),spaceSeparated:Z,totalLength:Y});X=F.value,we+=F.abbreviation,Y&&(k=F.mantissaPrecision)}if(ue){var Se=(le=(J={value:X,characteristicPrecision:p}).value,ee=J.characteristicPrecision,he=ee===void 0?0:ee,Ce=i(le.toExponential().split("e"),2),_e=Ce[0],be=Ce[1],P=+_e,he&&1<he&&(P*=Math.pow(10,he-1),be=0<=(be=+be-(he-1))?"+".concat(be):be),{value:P,abbreviation:"e".concat(be)});X=Se.value,we=Se.abbreviation+we}var Ie,Re,Pe,ke=function(S,O,A,L,M){if(L===-1)return S;var V=g(O,L),H=i(V.toString().split("."),2),x=H[0],B=H[1],D=B===void 0?"":B;if(D.match(/^0+$/)&&(A||M))return x;var z=D.match(/0+$/);return M&&z?"".concat(x,".").concat(D.toString().slice(0,z.index)):V.toString()}(X.toString(),X,j,k,W);return ke=function(S,O,A,L,M){var V=L.currentDelimiters(),H=V.thousands;M=M||V.decimal;var x=V.thousandsSize||3,B=S.toString(),D=B.split(".")[0],z=B.split(".")[1];return A&&(O<0&&(D=D.slice(1)),function(oe,ae){for(var se=[],Ee=0,$e=oe;0<$e;$e--)Ee===ae&&(se.unshift($e),Ee=0),Ee++;return se}(D.length,x).forEach(function(oe,ae){D=D.slice(0,oe+ae)+H+D.slice(oe+ae)}),O<0&&(D="-".concat(D))),B=z?D+M+z:D}(ke=function(S,O,A,L){var M=S,V=i(M.toString().split("."),2),H=V[0],x=V[1];if(H.match(/^-?0$/)&&A)return x?"".concat(H.replace("0",""),".").concat(x):H.replace("0","");if(H.length<L)for(var B=L-H.length,D=0;D<B;D++)M="0".concat(M);return M.toString()}(ke,0,m,p),X,q,U,G),(R||ue)&&(ke=ke+we),(te||X<0)&&(Ie=ke,Pe=ne,ke=(Re=X)===0?Ie:+Ie==0?Ie.replace("-",""):0<Re?"+".concat(Ie):Pe==="sign"?Ie:"(".concat(Ie.replace("-",""),")")),ke}function w(C,_){if(!C)return _;var I=Object.keys(C);return I.length===1&&I[0]==="output"?_:C}n.exports=function(C){return{format:function(){for(var _=arguments.length,I=new Array(_),E=0;E<_;E++)I[E]=arguments[E];return h.apply(void 0,I.concat([C]))},getByteUnit:function(){for(var _=arguments.length,I=new Array(_),E=0;E<_;E++)I[E]=arguments[E];return function(U){var G=c.general;return d(U._value,G.suffixes,G.scale).suffix}.apply(void 0,I.concat([C]))},getBinaryByteUnit:function(){for(var _=arguments.length,I=new Array(_),E=0;E<_;E++)I[E]=arguments[E];return function(U){var G=c.binary;return d(U._value,G.suffixes,G.scale).suffix}.apply(void 0,I.concat([C]))},getDecimalByteUnit:function(){for(var _=arguments.length,I=new Array(_),E=0;E<_;E++)I[E]=arguments[E];return function(U){var G=c.decimal;return d(U._value,G.suffixes,G.scale).suffix}.apply(void 0,I.concat([C]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,c={},f=null,h={};function d(g){u=g}function v(){return c[u]}s.languages=function(){return Object.assign({},c)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(g){g=l.parseFormat(g),a.validateFormat(g)&&(h=g)},s.getZeroFormat=function(){return f},s.setZeroFormat=function(g){return f=typeof g=="string"?g:null},s.hasZeroFormat=function(){return f!==null},s.languageData=function(g){if(g){if(c[g])return c[g];throw new Error('Unknown tag "'.concat(g,'"'))}return v()},s.registerLanguage=function(g){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(g))throw new Error("Invalid language data");c[g.languageTag]=g,y&&d(g.languageTag)},s.setLanguage=function(g){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!c[g]){var w=g.split("-")[0],C=Object.keys(c).find(function(_){return _.split("-")[0]===w});return c[C]?void d(C):void d(y)}d(g)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var c=new i(l._value),f=s;return u.isNumbro(s)&&(f=s._value),f=new i(f),l._value=c.minus(f).toNumber(),l}n.exports=function(l){return{add:function(s,u){return f=u,h=l,d=new i((c=s)._value),v=f,h.isNumbro(f)&&(v=f._value),v=new i(v),c._value=d.plus(v).toNumber(),c;var c,f,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return f=u,h=l,d=new i((c=s)._value),v=f,h.isNumbro(f)&&(v=f._value),v=new i(v),c._value=d.times(v).toNumber(),c;var c,f,h,d,v},divide:function(s,u){return f=u,h=l,d=new i((c=s)._value),v=f,h.isNumbro(f)&&(v=f._value),v=new i(v),c._value=d.dividedBy(v).toNumber(),c;var c,f,h,d,v},set:function(s,u){return c=s,h=f=u,l.isNumbro(f)&&(h=f._value),c._value=h,c;var c,f,h},difference:function(s,u){return c=u,a(h=(f=l)(s._value),c,f),Math.abs(h._value);var c,f,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(y,w){for(var C=0;C<w.length;C++){var _=w[C];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(y,_.key,_)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(g),u=r("./unformatting"),c=r("./formatting")(g),f=r("./manipulating")(g),h=r("./parsing"),d=function(){function y(_){(function(I,E){if(!(I instanceof E))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=_}var w,C;return w=y,(C=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,_)}},{key:"formatCurrency",value:function(_){return typeof _=="string"&&(_=h.parseFormat(_)),(_=c.formatOrDefault(_,a.currentCurrencyDefaultFormat())).output="currency",c.format(this,_)}},{key:"formatTime",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return _.output="time",c.format(this,_)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(_){return f.difference(this,_)}},{key:"add",value:function(_){return f.add(this,_)}},{key:"subtract",value:function(_){return f.subtract(this,_)}},{key:"multiply",value:function(_){return f.multiply(this,_)}},{key:"divide",value:function(_){return f.divide(this,_)}},{key:"set",value:function(_){return f.set(this,v(_))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,C),y}();function v(y){var w=y;return g.isNumbro(y)?w=y._value:typeof y=="string"?w=g.unformat(y):isNaN(y)&&(w=NaN),w}function g(y){return new d(v(y))}g.version="2.1.2",g.isNumbro=function(y){return y instanceof d},g.language=a.currentLanguage,g.registerLanguage=a.registerLanguage,g.setLanguage=a.setLanguage,g.languages=a.languages,g.languageData=a.languageData,g.zeroFormat=a.setZeroFormat,g.defaultFormat=a.currentDefaults,g.setDefaults=a.setDefaults,g.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,g.validate=l.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=u.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,c,f,h,d,v,g,y,w,C,_,I,E,U,G,Q,K,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=X,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,c=X,function(J,le){if(J.indexOf("$")===-1){if(J.indexOf("%")===-1)return J.indexOf("bd")!==-1?(le.output="byte",le.base="general"):J.indexOf("b")!==-1?(le.output="byte",le.base="binary"):J.indexOf("d")!==-1?(le.output="byte",le.base="decimal"):J.indexOf(":")===-1?J.indexOf("o")!==-1&&(le.output="ordinal"):le.output="time";le.output="percent"}else le.output="currency"}(i=(f=(u=i).match(/{([^}]*)}$/))?(c.postfix=f[1],u.slice(0,-f[0].length)):u,X),h=X,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=X,(g=i.split(".")[0].match(/0+/))&&(v.characteristic=g[0].length),function(J,le){if(J.indexOf(".")!==-1){var ee=J.split(".")[0];le.optionalCharacteristic=ee.indexOf("0")===-1}}(i,X),y=X,i.indexOf("a")!==-1&&(y.average=!0),C=X,(w=i).indexOf("K")!==-1?C.forceAverage="thousand":w.indexOf("M")!==-1?C.forceAverage="million":w.indexOf("B")!==-1?C.forceAverage="billion":w.indexOf("T")!==-1&&(C.forceAverage="trillion"),function(J,le){var ee=J.split(".")[1];if(ee){var he=ee.match(/0+/);he&&(le.mantissa=he[0].length)}}(i,X),I=X,(_=i).match(/\[\.]/)?I.optionalMantissa=!0:_.match(/\./)&&(I.optionalMantissa=!1),E=X,i.indexOf(",")!==-1&&(E.thousandSeparated=!0),U=X,i.indexOf(" ")!==-1&&(U.spaceSeparated=!0),Q=X,(G=i).match(/^\+?\([^)]*\)$/)&&(Q.negative="parenthesis"),G.match(/^\+?-/)&&(Q.negative="sign"),K=X,i.match(/^\+/)&&(K.forceSign=!0),X)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",f=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function g(y,w){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=3<arguments.length?arguments[3]:void 0,I=4<arguments.length?arguments[4]:void 0,E=5<arguments.length?arguments[5]:void 0,U=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var G="",Q=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(Q!==y)return-1*g(Q,w,C,_,I,E,U);for(var K=0;K<i.length;K++){var X=i[K];if((G=y.replace(X.key,""))!==y)return g(G,w,C,_,I,E,U)*X.factor}if((G=y.replace("%",""))!==y)return g(G,w,C,_,I,E,U)/100;var J=parseFloat(y);if(!isNaN(J)){var le=_(J);if(le&&le!=="."&&(G=y.replace(new RegExp("".concat(a(le),"$")),""))!==y)return g(G,w,C,_,I,E,U);var ee={};Object.keys(E).forEach(function(Y){ee[E[Y]]=Y});for(var he=Object.keys(ee).sort().reverse(),Ce=he.length,_e=0;_e<Ce;_e++){var be=he[_e],P=ee[be];if((G=y.replace(be,""))!==y){var T=void 0;switch(P){case"thousand":T=Math.pow(10,3);break;case"million":T=Math.pow(10,6);break;case"billion":T=Math.pow(10,9);break;case"trillion":T=Math.pow(10,12)}return g(G,w,C,_,I,E,U)*T}}}}(function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=g.replace(w,"");return C=(C=C.replace(new RegExp("([0-9])".concat(a(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(s,u,c),u,c,f,h,d,v)}n.exports={unformat:function(s,u){var c,f,h,d=r("./globalState"),v=d.currentDelimiters(),g=d.currentCurrency().symbol,y=d.currentOrdinal(),w=d.getZeroFormat(),C=d.currentAbbreviations(),_=void 0;if(typeof s=="string")_=function(I,E){if(!I.indexOf(":")||E.thousands===":")return!1;var U=I.split(":");if(U.length!==3)return!1;var G=+U[0],Q=+U[1],K=+U[2];return!isNaN(G)&&!isNaN(Q)&&!isNaN(K)}(s,v)?(c=s.split(":"),f=+c[0],h=+c[1],+c[2]+60*h+3600*f):l(s,v,g,y,w,C,u);else{if(typeof s!="number")return;_=s}if(_!==void 0)return _}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(g){if(Array.isArray(g)){for(var y=0,w=new Array(g.length);y<g.length;y++)w[y]=g[y];return w}}(v)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(v){return!!l.unformat(v)}function h(v,g,y){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],C=Object.keys(v).map(function(_){if(!g[_])return console.error("".concat(y," Invalid key: ").concat(_)),!1;var I=v[_],E=g[_];if(typeof E=="string"&&(E={type:E}),E.type==="format"){if(!h(I,u,"[Validate ".concat(_,"]"),!0))return!1}else if(a(I)!==E.type)return console.error("".concat(y," ").concat(_,' type mismatched: "').concat(E.type,'" expected, "').concat(a(I),'" provided')),!1;if(E.restrictions&&E.restrictions.length)for(var U=E.restrictions.length,G=0;G<U;G++){var Q=E.restrictions[G],K=Q.restriction,X=Q.message;if(!K(I,v))return console.error("".concat(y," ").concat(_," invalid value: ").concat(X)),!1}return E.restriction&&!E.restriction(I,v)?(console.error("".concat(y," ").concat(_," invalid value: ").concat(E.message)),!1):E.validValues&&E.validValues.indexOf(I)===-1?(console.error("".concat(y," ").concat(_," invalid value: must be among ").concat(JSON.stringify(E.validValues),', "').concat(I,'" provided')),!1):!(E.children&&!h(I,E.children,"[Validate ".concat(_,"]")))});return w||C.push.apply(C,i(Object.keys(g).map(function(_){var I=g[_];if(typeof I=="string"&&(I={type:I}),I.mandatory){var E=I.mandatory;if(typeof E=="function"&&(E=E(v)),E&&v[_]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(_,'"')),!1}return!0}))),C.reduce(function(_,I){return _&&I},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,g){var y=f(v),w=d(g);return y&&w},validateFormat:d,validateInput:f,validateLanguage:function(v){return h(v,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(eq);const xo=$g;var tq=Ae,rq=Wi.map,nq=Ks,oq=nq("map");tq({target:"Array",proto:!0,forced:!oq},{map:function(t){return rq(this,t,arguments.length>1?arguments[1]:void 0)}});function iq(e){return uq(e)||sq(e)||lq(e)||aq()}function aq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lq(e,t){if(e){if(typeof e=="string")return Mg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mg(e,t)}}function sq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uq(e){if(Array.isArray(e))return Mg(e)}function Mg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xg(e){return xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xg(e)}function br(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=xg(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(iq(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function cq(e){return br(e,[","])}function me(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function Dg(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function YD(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}var fq="numeric";function dC(e,t,r,n,o,i,a){var l=i;if(br(l)){var s=a.numericFormat,u=s&&s.culture||"-",c=s&&s.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(typeof u<"u"&&!xo.languages()[u]){var d=u.replace("-",""),v=xo.allLanguages?xo.allLanguages[u]:xo[d];v&&xo.registerLanguage(v)}xo.setLanguage(u),l=xo(l).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}ko(e,t,r,n,o,l,a)}dC.RENDERER_TYPE=fq;var hq="password";function vC(e,t,r,n,o,i,a){ko.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";me(l-1,function(){u+=s}),zi(t,u)}vC.RENDERER_TYPE=hq;var dq="time";function pC(e,t,r,n,o,i,a){ko.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}pC.RENDERER_TYPE=dq;var ou=Rr("renderers"),vq=ou.register,pq=ou.getItem,KD=ou.hasItem;ou.getNames;ou.getValues;function gq(e){if(typeof e=="function")return e;if(!KD(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return pq(e)}function fn(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),vq(e,t)}function yq(){fn(pl),fn(ru),fn(fC),fn(sC),fn(dC),fn(vC),fn(ko),fn(pC)}var MT=FS,mq=Math.floor,Hg=function(e,t){var r=e.length,n=mq(r/2);return r<8?bq(e,t):wq(e,Hg(MT(e,0,n),t),Hg(MT(e,n),t),t)},bq=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},wq=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?n(t[a],r[l])<=0?t[a++]:r[l++]:a<o?t[a++]:r[l++];return e},Sq=Hg,Cq=Li,xT=Cq.match(/firefox\/(\d+)/i),_q=!!xT&&+xT[1],Oq=Li,Rq=/MSIE|Trident/.test(Oq),Eq=Li,DT=Eq.match(/AppleWebKit\/(\d+)\./),Tq=!!DT&&+DT[1],kq=Ae,XD=He,Pq=cl,Aq=nr,HT=Or,Iq=xD,NT=Pt,gC=Le,$q=Sq,Mq=vl,LT=_q,xq=Rq,jT=js,BT=Tq,so=[],FT=XD(so.sort),Dq=XD(so.push),Hq=gC(function(){so.sort(void 0)}),Nq=gC(function(){so.sort(null)}),Lq=Mq("sort"),qD=!gC(function(){if(jT)return jT<70;if(!(LT&&LT>3)){if(xq)return!0;if(BT)return BT<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)so.push({k:r+o,v:n})}for(so.sort(function(i,a){return a.v-i.v}),o=0;o<so.length;o++)r=so[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),jq=Hq||!Nq||!Lq||!qD,Bq=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:NT(t)>NT(r)?1:-1}};kq({target:"Array",proto:!0,forced:jq},{sort:function(t){t!==void 0&&Pq(t);var r=Aq(this);if(qD)return t===void 0?FT(r):FT(r,t);var n=[],o=HT(r),i,a;for(a=0;a<o;a++)a in r&&Dq(n,r[a]);for($q(n,Bq(t)),i=HT(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)Iq(r,a++);return r}});var Fq=mt,Vq=Math.floor,Wq=Number.isInteger||function(t){return!Fq(t)&&isFinite(t)&&Vq(t)===t},Uq=Ae,zq=Wq;Uq({target:"Number",stat:!0},{isInteger:zq});var Gq=He,QD=Gq(1 .valueOf),Yq=St,yC=et,ZD=He,Kq=Rh,Xq=_r,VT=bt,qq=PS,Qq=Ro,Zq=Bs,JD=IM,Jq=Le,e7=Fi.f,t7=nn.f,r7=Nt.f,n7=QD,o7=cx.trim,Ng="Number",ro=yC[Ng],Tv=ro.prototype,i7=yC.TypeError,a7=ZD("".slice),Wu=ZD("".charCodeAt),l7=function(e){var t=JD(e,"number");return typeof t=="bigint"?t:s7(t)},s7=function(e){var t=JD(e,"number"),r,n,o,i,a,l,s,u;if(Zq(t))throw i7("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=o7(t),r=Wu(t,0),r===43||r===45){if(n=Wu(t,2),n===88||n===120)return NaN}else if(r===48){switch(Wu(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=a7(t,2),l=a.length,s=0;s<l;s++)if(u=Wu(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t};if(Kq(Ng,!ro(" 0o1")||!ro("0b1")||ro("+0x1"))){for(var oa=function(t){var r=arguments.length<1?0:ro(l7(t)),n=this;return Qq(Tv,n)&&Jq(function(){n7(n)})?qq(Object(r),n,oa):r},WT=Yq?e7(ro):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),kv=0,Uu;WT.length>kv;kv++)VT(ro,Uu=WT[kv])&&!VT(oa,Uu)&&r7(oa,Uu,t7(ro,Uu));oa.prototype=Tv,Tv.constructor=oa,Xq(yC,Ng,oa,{constructor:!0})}var u7=nr,UT=Ws,c7=Or,f7=function(t){for(var r=u7(this),n=c7(r),o=arguments.length,i=UT(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:UT(a,n);l>i;)r[i++]=t;return r},h7=Ae,d7=f7,v7=Ys;h7({target:"Array",proto:!0},{fill:d7});v7("fill");var p7=Li,g7=/(?:ipad|iphone|ipod).*applewebkit/i.test(p7),y7=Un,m7=et,eH=y7(m7.process)=="process",hr=et,b7=Ui,w7=qs,zT=ut,S7=bt,C7=Le,GT=UM,_7=Xs,YT=_h,O7=aD,R7=g7,E7=eH,Lg=hr.setImmediate,jg=hr.clearImmediate,T7=hr.process,Pv=hr.Dispatch,k7=hr.Function,KT=hr.MessageChannel,P7=hr.String,Av=0,os={},XT="onreadystatechange",_s,Do,Iv,$v;try{_s=hr.location}catch{}var mC=function(e){if(S7(os,e)){var t=os[e];delete os[e],t()}},Mv=function(e){return function(){mC(e)}},qT=function(e){mC(e.data)},QT=function(e){hr.postMessage(P7(e),_s.protocol+"//"+_s.host)};(!Lg||!jg)&&(Lg=function(t){O7(arguments.length,1);var r=zT(t)?t:k7(t),n=_7(arguments,1);return os[++Av]=function(){b7(r,void 0,n)},Do(Av),Av},jg=function(t){delete os[t]},E7?Do=function(e){T7.nextTick(Mv(e))}:Pv&&Pv.now?Do=function(e){Pv.now(Mv(e))}:KT&&!R7?(Iv=new KT,$v=Iv.port2,Iv.port1.onmessage=qT,Do=w7($v.postMessage,$v)):hr.addEventListener&&zT(hr.postMessage)&&!hr.importScripts&&_s&&_s.protocol!=="file:"&&!C7(QT)?(Do=QT,hr.addEventListener("message",qT,!1)):XT in YT("script")?Do=function(e){GT.appendChild(YT("script"))[XT]=function(){GT.removeChild(this),mC(e)}}:Do=function(e){setTimeout(Mv(e),0)});var tH={set:Lg,clear:jg},A7=Ae,I7=et,ZT=tH.clear;A7({global:!0,bind:!0,enumerable:!0,forced:I7.clearImmediate!==ZT},{clearImmediate:ZT});var $7=Ae,M7=et,JT=tH.set;$7({global:!0,bind:!0,enumerable:!0,forced:M7.setImmediate!==JT},{setImmediate:JT});var x7=Ae,D7=nr,rH=Gs,H7=Le,N7=H7(function(){rH(1)});x7({target:"Object",stat:!0,forced:N7},{keys:function(t){return rH(D7(t))}});var L7=kt,j7=Ih,B7=Ct,F7=Nr,V7=Vi,xv=Pt,W7=rr,U7=ji,z7=LS,ek=$h;j7("match",function(e,t,r){return[function(o){var i=W7(this),a=F7(o)?void 0:U7(o,e);return a?L7(a,o,i):new RegExp(o)[e](xv(i))},function(n){var o=B7(this),i=xv(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return ek(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,c;(c=ek(o,i))!==null;){var f=xv(c[0]);s[u]=f,f===""&&(o.lastIndex=z7(i,V7(o.lastIndex),l)),u++}return u===0?null:s}]});var G7=Ui,Y7=dr,K7=Eo,X7=Or,q7=vl,Q7=Math.min,Bg=[].lastIndexOf,nH=!!Bg&&1/[1].lastIndexOf(1,-0)<0,Z7=q7("lastIndexOf"),J7=nH||!Z7,e9=J7?function(t){if(nH)return G7(Bg,this,arguments)||0;var r=Y7(this),n=X7(r),o=n-1;for(arguments.length>1&&(o=Q7(o,K7(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:Bg,t9=Ae,tk=e9;t9({target:"Array",proto:!0,forced:tk!==[].lastIndexOf},{lastIndexOf:tk});var r9=cl,n9=nr,o9=Ls,i9=Or,a9=TypeError,rk=function(e){return function(t,r,n,o){r9(r);var i=n9(t),a=o9(i),l=i9(i),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw a9("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},l9={left:rk(!1),right:rk(!0)},s9=Ae,u9=l9.left,c9=vl,nk=js,f9=eH,h9=c9("reduce"),d9=!f9&&nk>79&&nk<83;s9({target:"Array",proto:!0,forced:!h9||d9},{reduce:function(t){var r=arguments.length;return u9(this,t,r,r>1?arguments[1]:void 0)}});var v9=Ae,p9=Wi.findIndex,g9=Ys,Fg="findIndex",oH=!0;Fg in[]&&Array(1)[Fg](function(){oH=!1});v9({target:"Array",proto:!0,forced:oH},{findIndex:function(t){return p9(this,t,arguments.length>1?arguments[1]:void 0)}});g9(Fg);function Dv(e){return w9(e)||b9(e)||m9(e)||y9()}function y9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m9(e,t){if(e){if(typeof e=="string")return Vg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vg(e,t)}}function b9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function w9(e){if(Array.isArray(e))return Vg(e)}function Vg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var iH={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},S9=new RegExp(Object.keys(iH).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function C9(e){return(e&&e.nodeName||"")==="TABLE"}function ok(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],g=0;g<a;g+=1){var y=!d&&r&&g===0,w="";if(d)w="<th>".concat(e.getColHeader(g-c),"</th>");else if(y)w="<th>".concat(e.getRowHeader(h-f),"</th>");else{var C=o[h][g],_=e.getCellMeta(h-f,g-c),I=_.hidden,E=_.rowspan,U=_.colspan;if(!I){var G=[];if(E&&G.push('rowspan="'.concat(E,'"')),U&&G.push('colspan="'.concat(U,'"')),At(C))w="<td ".concat(G.join(" "),"></td>");else{var Q=C.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(G.join(" "),">").concat(Q,"</td>")}}}v.push(w)}var K=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,K):u.splice(-1,0,K)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function ik(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=At(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function _9(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(m){var b=m.match(/<td\b[^>]*?>/g)[0],R=m.substring(b.length,m.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),k="</td>";return"".concat(b).concat(R).concat(k)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!C9(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),c=u?Array.from(u.cells).reduce(function(m,b){return m+b.colSpan},0)-(s?1:0):0,f=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,g=0;if(i.tHead){var y=Array.from(i.tHead.rows).filter(function(m){var b=m.querySelector("td")!==null;return b&&h.push(m),!b});v=y.length,d=v>0,v>1?r.nestedHeaders=Array.from(y).reduce(function(m,b){var R=Array.from(b.cells).reduce(function(k,j,W){if(s&&W===0)return k;var q=j.colSpan,Z=j.innerHTML,ne=q>1?{label:Z,colspan:q}:Z;return k.push(ne),k},[]);return m.push(R),m},[]):d&&(r.colHeaders=Array.from(y[0].children).reduce(function(m,b,R){return s&&R===0||m.push(b.innerHTML),m},[]))}h.length&&(r.fixedRowsTop=h.length),f.length&&(r.fixedRowsBottom=f.length);var w=[].concat(h,Dv(Array.from(i.tBodies).reduce(function(m,b){return m.push.apply(m,Dv(Array.from(b.rows))),m},[])),Dv(f));g=w.length;for(var C=new Array(g),_=0;_<g;_++)C[_]=new Array(c);for(var I=[],E=[],U=0;U<g;U++)for(var G=w[U],Q=Array.from(G.cells),K=Q.length,X=0;X<K;X++){var J=Q[X],le=J.nodeName,ee=J.innerHTML,he=J.rowSpan,Ce=J.colSpan,_e=C[U].findIndex(function(m){return m===void 0});if(le==="TD"){if(he>1||Ce>1){for(var be=U;be<U+he;be++)if(be<g)for(var P=_e;P<_e+Ce;P++)C[be][P]=null;var T=J.getAttribute("style"),Y=T&&T.includes("mso-ignore:colspan");Y||I.push({col:_e,row:U,rowspan:he,colspan:Ce})}var p="";l&&/excel/gi.test(l.content)?p=ee.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):p=ee.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[U][_e]=p.replace(S9,function(m){return iH[m]})}else E.push(ee)}return I.length&&(r.mergeCells=I),E.length&&(r.rowHeaders=E),C.length&&(r.data=C),r}}function O9(e){return T9(e)||E9(e)||aH(e)||R9()}function R9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function T9(e){if(Array.isArray(e))return Wg(e)}function k9(e,t){return I9(e)||A9(e,t)||aH(e,t)||P9()}function P9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aH(e,t){if(e){if(typeof e=="string")return Wg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wg(e,t)}}function Wg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A9(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function I9(e){if(Array.isArray(e))return e}var Ug="asc",$9="desc",ak=new Map([[Ug,[-1,1]],[$9,[1,-1]]]),M9=function(t){return"The priority '".concat(t,"' is already declared in a map.")},x9=function(t){return"The priority '".concat(t,"' is not a number.")};function D9(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=nt(t)?t:M9,r=nt(r)?r:x9;function o(a,l){if(!br(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ug,l=ak.get(a)||ak.get(Ug),s=k9(l,2),u=s[0],c=s[1];return O9(n).sort(function(f,h){return f[0]<h[0]?u:c}).map(function(f){return f[1]})}return{addItem:o,getItems:i}}var H9=Ae,N9=Wi.find,L9=Ys,zg="find",lH=!0;zg in[]&&Array(1)[zg](function(){lH=!1});H9({target:"Array",proto:!0,forced:lH},{find:function(t){return N9(this,t,arguments.length>1?arguments[1]:void 0)}});L9(zg);function j9(e){return V9(e)||F9(e)||sH(e)||B9()}function B9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function V9(e){if(Array.isArray(e))return Gg(e)}function lk(e,t){return z9(e)||U9(e,t)||sH(e,t)||W9()}function W9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sH(e,t){if(e){if(typeof e=="string")return Gg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gg(e,t)}}function Gg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U9(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function z9(e){if(Array.isArray(e))return e}var G9=function(t){return"The id '".concat(t,"' is already declared in a map.")};function zh(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=nt(t)?t:G9;function n(c,f){if(u(c))throw new Error(t(c));r.set(c,f)}function o(c){return r.delete(c)}function i(){r.clear()}function a(c){var f=s().find(function(v){var g=lk(v,2),y=g[0],w=g[1];return c===w?y:!1})||[null],h=lk(f,1),d=h[0];return d}function l(c){return r.get(c)}function s(){return j9(r)}function u(c){return r.has(c)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function Y9(e){return Q9(e)||q9(e)||X9(e)||K9()}function K9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X9(e,t){if(e){if(typeof e=="string")return Yg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yg(e,t)}}function q9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Q9(e){if(Array.isArray(e))return Yg(e)}function Yg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Z9=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function J9(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=nt(t)?t:Z9;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return Y9(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function eQ(e,t){return nQ(e)||rQ(e,t)||uH(e,t)||tQ()}function tQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function nQ(e){if(Array.isArray(e))return e}function sk(e){return aQ(e)||iQ(e)||uH(e)||oQ()}function oQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uH(e,t){if(e){if(typeof e=="string")return Kg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kg(e,t)}}function iQ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aQ(e){if(Array.isArray(e))return Kg(e)}function Kg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bC=function(t){return'There is already registered "'.concat(t,'" plugin.')},lQ=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},sQ=function(t){return'The priority "'.concat(t,'" is not a number.')},cH=D9({errorPriorityExists:lQ,errorPriorityNaN:sQ}),fH=J9({errorItemExists:bC}),Xg=zh({errorIdExists:bC});function hH(){return[].concat(sk(cH.getItems()),sk(fH.getItems()))}function wC(e){var t=Bn(e);return Xg.getItem(t)}function uQ(e){return!!wC(e)}function Ge(e,t,r){var n=fQ(e,t,r),o=eQ(n,3);e=o[0],t=o[1],r=o[2],wC(e)===void 0&&cQ(e,t,r)}function cQ(e,t,r){var n=Bn(e);if(Xg.hasItem(n))throw new Error(bC(n));r===void 0?fH.addItem(n):cH.addItem(r,n),Xg.addItem(n,t)}function fQ(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var iu=Rr("validators"),hQ=iu.register,dQ=iu.getItem,dH=iu.hasItem;iu.getNames;iu.getValues;function vQ(e){if(typeof e=="function")return e;if(!dH(e))throw Error('No registered validator found under "'.concat(e,'" name'));return dQ(e)}function Ql(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),hQ(e,t)}var Yo=1,Sr=2;function pQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gQ(e,t,r){return t&&uk(e.prototype,t),r&&uk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ia=new WeakMap,yQ=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,c=u===void 0?function(f){return f}:u;pQ(this,e),ia.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return gQ(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=ia.get(this),l=a.calculationType,s=a.overrideFn,u=a.scrollOffset,c=a.totalColumns,f=a.viewportWidth,h=0;h<c;h++){i=this._getColumnWidth(h),r<=u&&l!==Sr&&(this.startColumn=h);var d=u>0?f+1:f;if(r>=u&&r+(l===Sr?i:0)<=u+d&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=h),this.endColumn=h),o.push(r),r+=i,l!==Sr&&(this.endColumn=h),r>=u+f){n=!1;break}}if(this.endColumn===c-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var v=o[this.endColumn]+i-o[this.startColumn-1];if((v<=f||l!==Sr)&&(this.startColumn-=1),v>f)break}l===Yo&&this.startColumn!==null&&s&&s(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),c<this.endColumn&&(this.endColumn=c-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=ia.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var c=n-a;if(this.stretch==="all"&&c>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var f=this._getColumnWidth(i-1),h=c+f;this.stretchLastWidth=h>=0?h:f}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=ia.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=ia.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=ia.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const SC=yQ;function mQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ck(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bQ(e,t,r){return t&&ck(e.prototype,t),r&&ck(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var fk=new WeakMap,wQ=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;mQ(this,e),fk.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return bQ(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i=fk.get(this),a=i.calculationType,l=i.overrideFn,s=i.rowHeightFn,u=i.scrollOffset,c=i.totalRows,f=i.viewportHeight,h=i.horizontalScrollbarHeight||0,d,v=0;v<c;v++)if(d=s(v),isNaN(d)&&(d=e.DEFAULT_HEIGHT),r<=u&&a!==Sr&&(this.startRow=v),r>=u&&r+(a===Sr?d:0)<=u+f-h&&(this.startRow===null&&(this.startRow=v),this.endRow=v),o.push(r),r+=d,a!==Sr&&(this.endRow=v),r>=u+f-h){n=!1;break}if(this.endRow===c-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var g=o[this.endRow]+d-o[this.startRow-1];if((g<=f-h||a!==Sr)&&(this.startRow-=1),g>=f-h)break}a===Yo&&this.startRow!==null&&l&&l(this),this.startPosition=o[this.startRow],this.startPosition===void 0&&(this.startPosition=null),c<this.endRow&&(this.endRow=c-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const vH=wQ;function SQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function CQ(e,t,r){return t&&hk(e.prototype,t),r&&hk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Q(e,t,r){OQ(e,t),t.set(e,r)}function OQ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dk(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $l(e,t){var r=pH(e,t,"get");return RQ(e,r)}function RQ(e,t){return t.get?t.get.call(e):t.value}function EQ(e,t,r){var n=pH(e,t,"set");return TQ(e,n,r),r}function pH(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function TQ(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ho=new WeakMap,kQ=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;SQ(this,e),dk(this,"row",null),dk(this,"col",null),_Q(this,Ho,{writable:!0,value:!1}),EQ(this,Ho,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return CQ(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&($l(this,Ho)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&($l(this,Ho)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&($l(this,Ho)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&($l(this,Ho)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,$l(this,Ho))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const qg=kQ;function PQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function AQ(e,t,r){return t&&vk(e.prototype,t),r&&vk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IQ(e,t,r){$Q(e,t),t.set(e,r)}function $Q(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Br(e,t){var r=gH(e,t,"get");return MQ(e,r)}function MQ(e,t){return t.get?t.get.call(e):t.value}function xQ(e,t,r){var n=gH(e,t,"set");return DQ(e,n,r),r}function gH(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function DQ(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var pr=new WeakMap,HQ=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;PQ(this,e),Hv(this,"highlight",null),Hv(this,"from",null),Hv(this,"to",null),IQ(this,pr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),xQ(this,pr,o)}return AQ(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),c=Math.max(o.row,l.row),f=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(c,f);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Br(this,pr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Br(this,pr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Br(this,pr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Br(this,pr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Br(this,pr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Br(this,pr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Br(this,pr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Br(this,pr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof qg))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Br(this,pr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new qg(r,n,Br(this,pr))}}]),e}();const yH=HQ;var NQ=Ae,LQ=kS;NQ({target:"Object",stat:!0},{setPrototypeOf:LQ});var mH=He,jQ=cl,BQ=mt,FQ=bt,pk=Xs,VQ=Ds,bH=Function,WQ=mH([].concat),UQ=mH([].join),Nv={},zQ=function(e,t,r){if(!FQ(Nv,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";Nv[t]=bH("C,a","return new C("+UQ(n,",")+")")}return Nv[t](e,r)},GQ=VQ?bH.bind:function(t){var r=jQ(this),n=r.prototype,o=pk(arguments,1),i=function(){var l=WQ(o,pk(arguments));return this instanceof i?zQ(r,l.length,l):r.apply(t,l)};return BQ(n)&&(i.prototype=n),i},YQ=Ae,KQ=on,Lv=Ui,XQ=GQ,gk=yD,qQ=Ct,yk=mt,QQ=fl,wH=Le,CC=KQ("Reflect","construct"),ZQ=Object.prototype,JQ=[].push,SH=wH(function(){function e(){}return!(CC(function(){},[],e)instanceof e)}),CH=!wH(function(){CC(function(){})}),mk=SH||CH;YQ({target:"Reflect",stat:!0,forced:mk,sham:mk},{construct:function(t,r){gk(t),qQ(r);var n=arguments.length<3?t:gk(arguments[2]);if(CH&&!SH)return CC(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return Lv(JQ,o,r),new(Lv(XQ,t,o))}var i=n.prototype,a=QQ(yk(i)?i:ZQ),l=Lv(t,a,r);return yk(l)?l:a}});function eZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tZ(e,t,r){return t&&bk(e.prototype,t),r&&bk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var aa=new WeakMap,rZ=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;eZ(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,aa.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return tZ(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};Jr()?n():(uD()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=aa.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],c=u[0],f=u[1];return l===s&&c===f}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=xu(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=aa.get(this),o=this.domBindings.rootDocument.activeElement,i=WD(d5,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=xu(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&Oi(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=xu(r.target,["TD","TH"],n),i=xu(r.relatedTarget,["TD","TH"],n);o&&o!==i&&Oi(o,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o)}}},{key:"onMouseUp",value:function(r){var n=aa.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=aa.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=fe(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];SD()&&(e6()||t6())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=aa.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const _H=rZ;function nZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oZ(e,t,r){return t&&wk(e.prototype,t),r&&wk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var iZ=function(){function e(t,r,n){nZ(this,e),this.offset=t,this.total=r,this.countTH=n}return oZ(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const aZ=iZ;function lZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sZ(e,t,r){return t&&Sk(e.prototype,t),r&&Sk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var uZ=function(){function e(t,r,n){lZ(this,e),this.offset=t,this.total=r,this.countTH=n}return sZ(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const cZ=uZ;var fZ=0,Sf=1,Cf=2;function hZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ck(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dZ(e,t,r){return t&&Ck(e.prototype,t),r&&Ck(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var _k=function(){function e(){hZ(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return dZ(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function vZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ok(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pZ(e,t,r){return t&&Ok(e.prototype,t),r&&Ok(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var gZ=function(){function e(){vZ(this,e),this.size=new _k,this.workingSpace=fZ,this.sharedSize=null}return pZ(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof _k}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Sf,r.workingSpace=Cf,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=Cf,r.workingSpace=Sf,this.sharedSize=r.getViewSize()}}]),e}();function yZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mZ(e,t,r){return t&&Rk(e.prototype,t),r&&Rk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var OH=function(){function e(t,r,n){yZ(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new gZ,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return mZ(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(Sf))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(Cf)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(Sf);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Cf)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Qg(e){return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qg(e)}function bZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ek(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wZ(e,t,r){return t&&Ek(e.prototype,t),r&&Ek(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zg(e,t)}function Zg(e,t){return Zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Zg(e,t)}function CZ(e){var t=RZ();return function(){var n=_f(e),o;if(t){var i=_f(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _Z(this,o)}}function _Z(e,t){if(t&&(Qg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OZ(e)}function OZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _f(e){return _f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_f(e)}var RH=function(e){SZ(r,e);var t=CZ(r);function r(){return bZ(this,r),t.apply(this,arguments)}return wZ(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(OH);function EZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function TZ(e,t,r){return t&&Tk(e.prototype,t),r&&Tk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var kZ=function(){function e(t){EZ(this,e),this.nodeType=t.toUpperCase()}return TZ(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function PZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function AZ(e,t,r){return t&&kk(e.prototype,t),r&&kk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var au=function(){function e(t,r){PZ(this,e),this.nodesPool=typeof t=="string"?new kZ(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return AZ(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function Jg(e){return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jg(e)}function IZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $Z(e,t,r){return t&&Pk(e.prototype,t),r&&Pk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ey(e,t)}function ey(e,t){return ey=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ey(e,t)}function xZ(e){var t=NZ();return function(){var n=Of(e),o;if(t){var i=Of(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DZ(this,o)}}function DZ(e,t){if(t&&(Jg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HZ(e)}function HZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Of(e){return Of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Of(e)}var LZ=function(e){MZ(r,e);var t=xZ(r);function r(){var n;return IZ(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return $Z(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new RH(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,c=0;c<i;c++){var f=this.table.renderedRowToSource(c),h=s.getRenderedNode(c);this.sourceRowIndex=f;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var g=0;g<l;g++){d.render();var y=d.getCurrentNode();y.className="",y.removeAttribute("style"),a[g](f,y,g)}d.end()}}}]),r}(au);function ty(e){return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ty(e)}function jZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ak(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BZ(e,t,r){return t&&Ak(e.prototype,t),r&&Ak(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ry(e,t)}function ry(e,t){return ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ry(e,t)}function VZ(e){var t=zZ();return function(){var n=Rf(e),o;if(t){var i=Rf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return WZ(this,o)}}function WZ(e,t){if(t&&(ty(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UZ(e)}function UZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rf(e){return Rf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rf(e)}var GZ=function(e){FZ(r,e);var t=VZ(r);function r(n){return jZ(this,r),t.call(this,null,n)}return BZ(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,c=0,f=i;c<f;c++){for(l=this.rootNode.childNodes[c],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&Hr(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,c=this.rootNode.childNodes[i],f=-1*u;f<s;f+=1){var h=this.table.renderedColumnToSource(f),d=c.childNodes[f+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(au);function ny(e){return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(e)}function YZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ik(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function KZ(e,t,r){return t&&Ik(e.prototype,t),r&&Ik(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oy(e,t)}function oy(e,t){return oy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oy(e,t)}function qZ(e){var t=JZ();return function(){var n=Ef(e),o;if(t){var i=Ef(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return QZ(this,o)}}function QZ(e,t){if(t&&(ny(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZZ(e)}function ZZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ef(e){return Ef=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ef(e)}var eJ=function(e){XZ(r,e);var t=qZ(r);function r(n){return YZ(this,r),t.call(this,null,n)}return KZ(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var c=0;c<i;c++){var f=this.table.renderedColumnToSource(c),h=this.table.columnUtils.getStretchedColumnWidth(f);this.rootNode.childNodes[c+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&re(d,"rowHeader")}}]),r}(au);function iy(e){return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iy(e)}var $k;function tJ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function rJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nJ(e,t,r){return t&&Mk(e.prototype,t),r&&Mk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ay(e,t)}function ay(e,t){return ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ay(e,t)}function iJ(e){var t=sJ();return function(){var n=Tf(e),o;if(t){var i=Tf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aJ(this,o)}}function aJ(e,t){if(t&&(iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lJ(e)}function lJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tf(e){return Tf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tf(e)}var xk=!1,uJ=function(e){oJ(r,e);var t=iJ(r);function r(n){var o;return rJ(this,r),o=t.call(this,"TR",n),o.orderView=new OH(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return nJ(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!xk&&o>1e3&&(xk=!0,ot(Je($k||($k=tJ([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(au);function ly(e){return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ly(e)}function cJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fJ(e,t,r){return t&&Dk(e.prototype,t),r&&Dk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sy(e,t)}function sy(e,t){return sy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sy(e,t)}function dJ(e){var t=gJ();return function(){var n=kf(e),o;if(t){var i=kf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vJ(this,o)}}function vJ(e,t){if(t&&(ly(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pJ(e)}function pJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kf(e){return kf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kf(e)}var yJ=function(e){hJ(r,e);var t=dJ(r);function r(){var n;return cJ(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return fJ(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new RH(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var c=this.table.renderedRowToSource(u),f=l.getRenderedNode(u);this.sourceRowIndex=c;var h=this.obtainOrderView(f),d=s.obtainOrderView(f);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var g=h.getCurrentNode(),y=this.table.renderedColumnToSource(v);xe(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),this.table.cellRenderer(c,y,g)}h.end()}}}]),r}(au);function mJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bJ(e,t,r){return t&&Hk(e.prototype,t),r&&Hk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var wJ=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;mJ(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return bJ(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function SJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function CJ(e,t,r){return t&&Nk(e.prototype,t),r&&Nk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var _J=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;SJ(this,e),this.renderer=new wJ(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new LZ,columnHeaders:new GZ(n),colGroup:new eJ(o),rows:new uJ(i),cells:new yJ}),this.renderer.setAxisUtils(a,l)}return CJ(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function OJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function RJ(e,t,r){return t&&Lk(e.prototype,t),r&&Lk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var EJ=function(){function e(t,r){OJ(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return RJ(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Ht():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var c=r.getSetting("rowHeaders").length,f=r.getSetting("defaultColumnWidth"),h=0;h<c;h++){var d=Array.isArray(u)?u[h]:u;d=d??f,this.headerWidths.set(h,d)}}}]),e}();function TJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kJ(e,t,r){return t&&jk(e.prototype,t),r&&jk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var PJ=function(){function e(t,r){TJ(this,e),this.dataAccessObject=t,this.wtSettings=r}return kJ(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function AJ(e){return MJ(e)||$J(e)||EH(e)||IJ()}function IJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $J(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MJ(e){if(Array.isArray(e))return uy(e)}function xJ(e,t){return NJ(e)||HJ(e,t)||EH(e,t)||DJ()}function DJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EH(e,t){if(e){if(typeof e=="string")return uy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uy(e,t)}}function uy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function NJ(e){if(Array.isArray(e))return e}function LJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jJ(e,t,r){return t&&Bk(e.prototype,t),r&&Bk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var BJ=function(){function e(t,r,n,o,i){var a=this;LJ(this,e),Fr(this,"wtSettings",null),Fr(this,"domBindings",void 0),Fr(this,"TBODY",null),Fr(this,"THEAD",null),Fr(this,"COLGROUP",null),Fr(this,"hasTableHeight",!0),Fr(this,"hasTableWidth",!0),Fr(this,"isTableVisible",!1),Fr(this,"tableOffset",0),Fr(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,AD(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new PJ(this.dataAccessObject,this.wtSettings),this.columnUtils=new EJ(this.dataAccessObject,this.wtSettings),this.tableRenderer=new _J({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return jJ(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),c=u.length,f=n.getSetting("columnHeaders"),h=f.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Tt(this.holder),v=a.createRenderCalculators(v),c&&!n.getSetting("fixedColumnsStart"))){var g=i.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,y!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Tt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,C=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new cZ(w,l,h),this.columnFilter=new aZ(C,s,c);var _=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var I={};this.wtSettings.getSetting("beforeDraw",!0,I),_=I.skipRender!==!0}if(_){this.tableRenderer.setHeaderContentRenderers(u,f),(this.is(Zr)||this.is(fo))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var E;if(this.isMaster&&(E=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Zr))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var U=Ze(this.hider),G=Ze(this.TABLE);U!==0&&G!==U&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),E!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Zr)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var Q=!1;return this.isMaster&&(Q=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(Q=i.bottomOverlay.resetFixedPosition()||Q),Q=i.inlineStartOverlay.resetFixedPosition()||Q,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),Q?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=lo(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Zr))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)De(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,c=u.highlightHeaderClassName,f=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,g=0;g<v;g++)l.includes(d[g])||l.push(d[g]);c&&!l.includes(c)&&l.push(c),f&&!l.includes(f)&&l.push(f),h&&!l.includes(h)&&l.push(h)}var y=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(y))for(var w=0;w<y.length;w++)l.push(y[w]);for(var C=l.length,_=0;_<C;_++)this.removeClassFromCells(l[_])}for(var I=0;I<a;I++)i[I].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=xJ(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l;if(n<0?l=this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:l=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)],!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=_i(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=p5(o),l=n.cellIndex;if(Mo($i,n,this.wtRootElement)||Mo(Ai,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(Mo(fo,n,this.wtRootElement)||Mo(Zr,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return Mo($i,n,this.wtRootElement)||Mo(Ii,n,this.wtRootElement)||Mo(fo,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=lo(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=lo(u):a=lo(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Ze(this.TABLE)}},{key:"getHeight",value:function(){return dt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=Ze(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=dt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return bs(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=nt(r)?r():null;return Array.isArray(n)?(n=AJ(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const gl=BJ;var FJ="stickyRowsBottom",TH={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Gn(TH,"MIXIN_NAME",FJ,{writable:!1,enumerable:!1});const kH=TH;var VJ="stickyColumnsStart",PH={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Gn(PH,"MIXIN_NAME",VJ,{writable:!1,enumerable:!1});const _C=PH;function cy(e){return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cy(e)}function Fk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function WJ(e,t,r){return t&&Fk(e.prototype,t),r&&Fk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fy(e,t)}function fy(e,t){return fy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fy(e,t)}function GJ(e){var t=XJ();return function(){var n=Pf(e),o;if(t){var i=Pf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YJ(this,o)}}function YJ(e,t){if(t&&(cy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KJ(e)}function KJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pf(e){return Pf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pf(e)}var OC=function(e){zJ(r,e);var t=GJ(r);function r(n,o,i,a){return UJ(this,r),t.call(this,n,o,i,a,fo)}return WJ(r)}(gl);rt(OC,kH);rt(OC,_C);const qJ=OC;var Ai="top",Zr="bottom",Ii="inline_start",$i="top_inline_start_corner",fo="bottom_inline_start_corner",QJ=[Ai,Zr,Ii,$i,fo],ZJ=new Map([[Ai,"ht_clone_".concat(Ai)],[Zr,"ht_clone_".concat(Zr)],[Ii,"ht_clone_".concat(Ii," ht_clone_left")],[$i,"ht_clone_".concat($i," ht_clone_top_left_corner")],[fo,"ht_clone_".concat(fo," ht_clone_bottom_left_corner")]]);function JJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function eee(e,t,r){return t&&Vk(e.prototype,t),r&&Vk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tee=function(){function e(t){JJ(this,e),jv(this,"dataAccessObject",void 0),jv(this,"lastScrolledColumnPos",-1),jv(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return eee(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),c=n===void 0&&o===void 0,f=this.dataAccessObject,h=f.fixedColumnsStart,d=f.inlineStartOverlay;if(c&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,c?r>this.lastScrolledColumnPos:n):(c&&(r<s||r>u)||!c)&&(v=d.scrollTo(r,c?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=n===void 0&&o===void 0,f=this.dataAccessObject,h=f.fixedRowsBottom,d=f.fixedRowsTop,v=f.topOverlay;if(c&&(r<d||r>l-h-1))return!1;var g=!1;return s===-1?g=v.scrollTo(r,c?r>this.lastScrolledRowPos:o):(c&&(r<s||r>u)||!c)&&(g=v.scrollTo(r,c?r>u:o)),g&&(this.lastScrolledRowPos=r),g}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var c=Tt(o.wtRootElement),f=lo(o.hider),h=lo(s),d=mf(s,s);if(c.top+f-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var g=a;g>0;g--)if(v+=n.sumCellSizes(g-1,g),c.top+f-v<=d){u=g;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Tt(o.wtRootElement),c=mf(l,l);if(u.top>c){for(var f=lo(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-c>=f){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Tt(o.wtRootElement),c=Ac(o.hider),f=Ac(l),h=Math.abs(Eg(l,l));if(u.left+c-f<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+c-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getLastVisibleColumn();if(n.mainTableScrollableElement===l){var u=Tt(o.wtRootElement),c=Math.abs(Eg(l,l));if(u.left>c){for(var f=Ac(l),h=i.getRowHeaderWidth(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.left+h-c>=f){s=d-2;break}}}return s}}]),e}();const ree=tee;function nee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oee(e,t,r){return t&&Wk(e.prototype,t),r&&Wk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var RC=function(){function e(t,r){nee(this,e),kr(this,"wtTable",void 0),kr(this,"wtScroll",void 0),kr(this,"wtViewport",void 0),kr(this,"wtOverlays",void 0),kr(this,"selections",void 0),kr(this,"wtEvent",void 0),kr(this,"guid","wt_".concat(TD())),kr(this,"drawInterrupted",!1),kr(this,"drawn",!1),kr(this,"domBindings",void 0),kr(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new ree(this.createScrollDao())}return oee(e,[{key:"eventManager",get:function(){return new vt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Ti(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new qg(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new yH(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function hy(e){return hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hy(e)}function Uk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function iee(e,t,r){return t&&Uk(e.prototype,t),r&&Uk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dy(e,t)}function dy(e,t){return dy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dy(e,t)}function see(e){var t=cee();return function(){var n=Af(e),o;if(t){var i=Af(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uee(this,o)}}function uee(e,t){if(t&&(hy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ic(e)}function Ic(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Af(e){return Af=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Af(e)}function zk(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var fee=function(e){lee(r,e);var t=see(r);function r(n,o,i){var a;aee(this,r),a=t.call(this,n,o),zk(Ic(a),"cloneSource",void 0),zk(Ic(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",Ic(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new _H(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return iee(r)}(RC);function hee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dee(e,t,r){return t&&Gk(e.prototype,t),r&&Gk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var lu=function(){function e(t,r,n,o,i){hee(this,e),vee(this,"wtSettings",null),Gn(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=Ss(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return dee(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Ss(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=bf(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){ot("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},f={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,f,c):h=this.getRelativeCellPositionWithinHolder(l,s,a,f,c),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Ht())),l=u<=0?-1*u:0}if(r){var c=this.clone.wtTable.TABLE.getBoundingClientRect();s=c.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var c=this.wot.wtTable.wtRootElement.getBoundingClientRect(),f=this.clone.wtTable.TABLE.getBoundingClientRect();u=f.top*-1+c.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(QJ.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(ZJ.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ai||u==="vertical"&&this.type===Ii?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=bf(r.TABLE),new fee(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;$([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function vy(e){return vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vy(e)}function $c(e,t,r){return AH()?$c=Reflect.construct.bind():$c=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&If(u,a.prototype),u},$c.apply(null,arguments)}function pee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gee(e,t,r){return t&&Yk(e.prototype,t),r&&Yk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&If(e,t)}function If(e,t){return If=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},If(e,t)}function mee(e){var t=AH();return function(){var n=$f(e),o;if(t){var i=$f(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bee(this,o)}}function bee(e,t){if(t&&(vy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wee(e)}function wee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $f(e){return $f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$f(e)}var See=function(e){yee(r,e);var t=mee(r);function r(n,o,i,a,l,s){var u;return pee(this,r),u=t.call(this,n,o,fo,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return gee(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return $c(qJ,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else Wh(i),this.repositionOverlay();var s=dt(this.clone.wtTable.TABLE),u=Ze(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Ht(l)),s.style.bottom="".concat(u,"px")}}]),r}(lu),Cee="calculatedColumns",IH={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Gn(IH,"MIXIN_NAME",Cee,{writable:!1,enumerable:!1});const EC=IH;function py(e){return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},py(e)}function Kk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _ee(e,t,r){return t&&Kk(e.prototype,t),r&&Kk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ree(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gy(e,t)}function gy(e,t){return gy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gy(e,t)}function Eee(e){var t=Pee();return function(){var n=Mf(e),o;if(t){var i=Mf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tee(this,o)}}function Tee(e,t){if(t&&(py(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kee(e)}function kee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mf(e){return Mf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mf(e)}var TC=function(e){Ree(r,e);var t=Eee(r);function r(n,o,i,a){return Oee(this,r),t.call(this,n,o,i,a,Zr)}return _ee(r)}(gl);rt(TC,kH);rt(TC,EC);const Aee=TC;function yy(e){return yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yy(e)}function Mc(e,t,r){return MH()?Mc=Reflect.construct.bind():Mc=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&xf(u,a.prototype),u},Mc.apply(null,arguments)}function Iee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $ee(e,t,r){return t&&Xk(e.prototype,t),r&&Xk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xf(e,t)}function xf(e,t){return xf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xf(e,t)}function xee(e){var t=MH();return function(){var n=Df(e),o;if(t){var i=Df(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Dee(this,o)}}function Dee(e,t){if(t&&(yy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $H(e)}function $H(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Df(e){return Df=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Df(e)}function Hee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Nee=function(e){Mee(r,e);var t=xee(r);function r(n,o,i,a){var l;return Iee(this,r),l=t.call(this,n,o,Zr,i,a),Hee($H(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return $ee(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Mc(Aee,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Ht(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Ba(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),c=o,f=0;c<i;){var h=l.getRowHeight(c);f+=h===void 0?u:h,c+=1}return f}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,c=Ht(s),f=this.clone.wtTable.holder.parentNode,h=f.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=c),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var g=dt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(g=0),h.height="".concat(g,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Ht(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return mf(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,c=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,c=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(re(u,"innerBorderBottom"),s=!c):(De(u,"innerBorderBottom"),s=c)}return s}}]),r}(lu),Lee="calculatedRows",xH={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Gn(xH,"MIXIN_NAME",Lee,{writable:!1,enumerable:!1});const DH=xH;function my(e){return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},my(e)}function qk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jee(e,t,r){return t&&qk(e.prototype,t),r&&qk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&by(e,t)}function by(e,t){return by=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},by(e,t)}function Vee(e){var t=zee();return function(){var n=Hf(e),o;if(t){var i=Hf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Wee(this,o)}}function Wee(e,t){if(t&&(my(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uee(e)}function Uee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hf(e){return Hf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hf(e)}var kC=function(e){Fee(r,e);var t=Vee(r);function r(n,o,i,a){return Bee(this,r),t.call(this,n,o,i,a,Ii)}return jee(r)}(gl);rt(kC,DH);rt(kC,_C);const Gee=kC;function wy(e){return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function xc(e,t,r){return HH()?xc=Reflect.construct.bind():xc=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Nf(u,a.prototype),u},xc.apply(null,arguments)}function Yee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kee(e,t,r){return t&&Qk(e.prototype,t),r&&Qk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nf(e,t)}function Nf(e,t){return Nf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Nf(e,t)}function qee(e){var t=HH();return function(){var n=Lf(e),o;if(t){var i=Lf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qee(this,o)}}function Qee(e,t){if(t&&(wy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zee(e)}function Zee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lf(e){return Lf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lf(e)}var Jee=function(e){Xee(r,e);var t=qee(r);function r(n,o,i,a){return Yee(this,r),t.call(this,n,o,Ii,i,a)}return Kee(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return xc(Gee,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),lC(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),Wh(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,ws(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Ht(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||f==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),c.height="".concat(h,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var d=Ze(this.clone.wtTable.TABLE);c.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var c=this.wot.wtTable.getColumnWidth(o),f=this.wot.wtViewport.getViewportWidth();c>f&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Ht(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(Eg(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?De(i,"emptyRows"):re(i,"emptyRows");var u=!1;if(l&&!a.length)re(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var c=xe(i,"innerBorderInlineStart");o?(re(i,"innerBorderLeft innerBorderInlineStart"),u=!c):(De(i,"innerBorderLeft innerBorderInlineStart"),u=c)}return u}}]),r}(lu),ete="stickyRowsTop",NH={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Gn(NH,"MIXIN_NAME",ete,{writable:!1,enumerable:!1});const LH=NH;function Sy(e){return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function Zk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tte(e,t,r){return t&&Zk(e.prototype,t),r&&Zk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cy(e,t)}function Cy(e,t){return Cy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Cy(e,t)}function ote(e){var t=lte();return function(){var n=jf(e),o;if(t){var i=jf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ite(this,o)}}function ite(e,t){if(t&&(Sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ate(e)}function ate(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jf(e){return jf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jf(e)}var PC=function(e){nte(r,e);var t=ote(r);function r(n,o,i,a){return rte(this,r),t.call(this,n,o,i,a,$i)}return tte(r)}(gl);rt(PC,LH);rt(PC,_C);const ste=PC;function _y(e){return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_y(e)}function Dc(e,t,r){return jH()?Dc=Reflect.construct.bind():Dc=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Bf(u,a.prototype),u},Dc.apply(null,arguments)}function ute(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cte(e,t,r){return t&&Jk(e.prototype,t),r&&Jk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bf(e,t)}function Bf(e,t){return Bf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Bf(e,t)}function hte(e){var t=jH();return function(){var n=Ff(e),o;if(t){var i=Ff(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dte(this,o)}}function dte(e,t){if(t&&(_y(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oy(e)}function Oy(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ff(e){return Ff=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ff(e)}function e0(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var vte=function(e){fte(r,e);var t=hte(r);function r(n,o,i,a,l,s){var u;return ute(this,r),u=t.call(this,n,o,$i,i,a),e0(Oy(u),"topOverlay",void 0),e0(Oy(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return cte(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Dc(ste,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();lC(o,"".concat(i,"px"),"".concat(a,"px"))}else Wh(o);var l=dt(this.clone.wtTable.TABLE),s=Ze(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(lu);function Ry(e){return Ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ry(e)}function t0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pte(e,t,r){return t&&t0(e.prototype,t),r&&t0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ey(e,t)}function Ey(e,t){return Ey=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ey(e,t)}function mte(e){var t=Ste();return function(){var n=Vf(e),o;if(t){var i=Vf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bte(this,o)}}function bte(e,t){if(t&&(Ry(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wte(e)}function wte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ste(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vf(e){return Vf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vf(e)}var AC=function(e){yte(r,e);var t=mte(r);function r(n,o,i,a){return gte(this,r),t.call(this,n,o,i,a,Ai)}return pte(r)}(gl);rt(AC,LH);rt(AC,EC);const Cte=AC;function Ty(e){return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}function Hc(e,t,r){return FH()?Hc=Reflect.construct.bind():Hc=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Wf(u,a.prototype),u},Hc.apply(null,arguments)}function _te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ote(e,t,r){return t&&r0(e.prototype,t),r&&r0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wf(e,t)}function Wf(e,t){return Wf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Wf(e,t)}function Ete(e){var t=FH();return function(){var n=Uf(e),o;if(t){var i=Uf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tte(this,o)}}function Tte(e,t){if(t&&(Ty(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BH(e)}function BH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Uf(e){return Uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Uf(e)}function kte(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Pte=function(e){Rte(r,e);var t=Ete(r);function r(n,o,i,a){var l;return _te(this,r),l=t.call(this,n,o,Ai,i,a),kte(BH(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return Ote(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Hc(Cte,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,c=u.hider.getBoundingClientRect(),f=Math.ceil(c.bottom),h=o.offsetHeight;s=f===h,l=this.getOverlayOffset(),lC(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),Wh(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Ba(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Ht(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||f==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),c.width="".concat(h,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var d=dt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),c.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,c=this.getTableParentOffset(),f=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(f=Ht(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),g=l.getSetting("totalRows");c+=this.sumCellSizes(0,o+1),c-=a.wtViewport.getViewportHeight()-this.sumCellSizes(g-v,g),c+=1}else c+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return c+=f,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return mf(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?De(a,"emptyColumns"):re(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,f=this.wtSettings.getSetting("columnHeaders");if((c||u===0)&&f.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(re(a,"innerBorderTop"),s=!h):(De(a,"innerBorderTop"),s=h)}}return s}}]),r}(lu);function ao(e,t,r){return Ate()?ao=Reflect.construct.bind():ao=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&ky(u,a.prototype),u},ao.apply(null,arguments)}function Ate(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ky(e,t){return ky=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ky(e,t)}function Ite(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $te(e,t,r){return t&&n0(e.prototype,t),r&&n0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Mte=function(){function e(t,r,n,o,i,a){Ite(this,e),Xn(this,"wot",null),Xn(this,"topOverlay",null),Xn(this,"bottomOverlay",null),Xn(this,"inlineStartOverlay",null),Xn(this,"topInlineStartCornerOverlay",null),Xn(this,"bottomInlineStartCornerOverlay",null),Xn(this,"browserLineHeight",void 0),Xn(this,"wtSettings",null),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var l=this.domBindings,s=l.rootDocument,u=l.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Ht(s);var c=u.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:bf(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=u.scrollX,this.lastScrollY=u.scrollY}return $te(e,[{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ao(Pte,r),this.bottomOverlay=ao(Nee,r),this.inlineStartOverlay=ao(Jee,r),this.topInlineStartCornerOverlay=ao(vte,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ao(See,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,c=this.wtSettings.getSetting("preventWheel"),f={passive:u};(c||s||!J4())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,c)},f);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var g=v.clone.wtTable.holder;r.eventManager.addEventListener(g,"wheel",function(y){return r.onCloneWheel(y,c)},f)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)})}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var c=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&c)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Cs(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=bf(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtTable.spreader,o=n.clientWidth,i=n.clientHeight;(o!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=o,this.spreaderLastSize.height=i,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var c=o.wtRootElement,f=c.scrollHeight,h=c.scrollWidth,d=o.holder,v=d.scrollHeight,g=d.scrollWidth;this.hasScrollbarRight=f<v,this.hasScrollbarBottom=h<g,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>f&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return $(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];$(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const xte=Mte;function Dte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Hte(e,t,r){return t&&o0(e.prototype,t),r&&o0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i0(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Nte=function(){function e(t){var r=this;Dte(this,e),i0(this,"settings",{}),i0(this,"defaults",Object.freeze(this.getDefaults())),Ve(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return Hte(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Ti(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?Ve(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Py(e){return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Py(e)}function Lte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jte(e,t,r){return t&&a0(e.prototype,t),r&&a0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ay(e,t)}function Ay(e,t){return Ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ay(e,t)}function Fte(e){var t=Ute();return function(){var n=zf(e),o;if(t){var i=zf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vte(this,o)}}function Vte(e,t){if(t&&(Py(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wte(e)}function Wte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ute(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zf(e){return zf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zf(e)}var IC=function(e){Bte(r,e);var t=Fte(r);function r(n,o,i,a){return Lte(this,r),t.call(this,n,o,i,a,"master")}return jte(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=Ss(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=Tg(o,"height",i),u=Tg(o,"overflow",i),c=this.holder.style,f=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,g=d.height,y=["auto","hidden","scroll"];if(l&&y.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var C=parseInt(ki(w,i).height,10);l.removeChild(w),C===0&&(g=0)}g=Math.min(g,h),c.height=s==="auto"?"auto":"".concat(g,"px"),v=Math.min(v,f),c.width="".concat(v,"px"),c.overflow="",this.hasTableHeight=c.height==="auto"?!0:g>0,this.hasTableWidth=v>0}this.isTableVisible=bs(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),c=u.length,f=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*c;d<f;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(gl);rt(IC,DH);rt(IC,EC);const zte=IC;function Gte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yte(e,t,r){return t&&l0(e.prototype,t),r&&l0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Kte=function(){function e(t,r,n,o,i){var a=this;Gte(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return Yte(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=dt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),c=r.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),h=c?f.right-l:f.left,d=l-h,v,g;if(u)return Ze(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(g=Tg(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(v,a.clientWidth);var y=r.getSetting("stretchH");return y==="none"||!y?Math.max(v,Ze(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Tt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=dt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=Ze(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yo,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Yo?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;s<0&&(s=0);var u=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),f=n.getSetting("totalRows");return u&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),c&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(f-c,f),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Ht(this.domBindings.rootDocument),new vH({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yo,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,a<0&&(a=0);var l=n.getSetting("fixedColumnsStart");if(l){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Ht(this.domBindings.rootDocument)),new SC({viewportSize:i,scrollOffset:Math.abs(a),totalItems:n.getSetting("totalColumns"),itemSizeFn:function(c){return o.getColumnWidth(c)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(c,f){return n.getSetting("onBeforeStretchingColumnWidth",c,f)}})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(Sr),i=this.createColumnsCalculator(Sr);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Yo),this.columnsRenderCalculator=this.createColumnsCalculator(Yo)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Sr),this.columnsVisibleCalculator=this.createColumnsCalculator(Sr)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow;if(n===null&&o===null)return!1;var i=this.rowsRenderCalculator,a=i.startRow,l=i.endRow;return n<a||n===a&&n>0?!1:!(o>l||o===l&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn;if(n===null&&o===null)return!1;var i=this.columnsRenderCalculator,a=i.startColumn,l=i.endColumn;return n<a||n===a&&n>0?!1:!(o>l||o===l&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Ve(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const Xte=Kte;function Iy(e){return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iy(e)}function qte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qte(e,t,r){return t&&s0(e.prototype,t),r&&s0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$y(e,t)}function $y(e,t){return $y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$y(e,t)}function Jte(e){var t=tre();return function(){var n=Gf(e),o;if(t){var i=Gf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ere(this,o)}}function ere(e,t){if(t&&(Iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return My(e)}function My(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gf(e){return Gf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gf(e)}var rre=function(e){Zte(r,e);var t=Jte(r);function r(n,o){var i;qte(this,r),i=t.call(this,n,new Nte(o));var a=i.wtSettings.getSetting("facade",My(i));return i.wtTable=new zte(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new Xte(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new _H(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new xte(My(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return Qte(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];Ve(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),De(this.wtTable.wtRootElement.parentNode,a),re(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(RC);function nre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ore(e,t,r){return t&&u0(e.prototype,t),r&&u0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ire=function(){function e(t){nre(this,e),t instanceof RC?this._wot=t:this._initFromSettings(t)}return ore(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new rre(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),are=St,VH=He,lre=Gs,sre=dr,ure=Hs.f,cre=VH(ure),fre=VH([].push),c0=function(e){return function(t){for(var r=sre(t),n=lre(r),o=n.length,i=0,a=[],l;o>i;)l=n[i++],(!are||cre(r,l))&&fre(a,e?[l,r[l]]:r[l]);return a}},hre={entries:c0(!0),values:c0(!1)},dre=Ae,vre=hre.values;dre({target:"Object",stat:!0},{values:function(t){return vre(t)}});function Bv(e,t){return mre(e)||yre(e,t)||gre(e,t)||pre()}function pre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gre(e,t){if(e){if(typeof e=="string")return f0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f0(e,t)}}function f0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function mre(e){if(Array.isArray(e))return e}function bre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wre(e,t,r){return t&&h0(e.prototype,t),r&&h0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Sre=function(){function e(t,r){bre(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return wre(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s,u){var c=r.main.childNodes[s];r.eventManager.addEventListener(c,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),rn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Jr()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,c=u.bordersHolder;c||(c=n.createElement("div"),c.className="htBorders",u.bordersHolder=c,u.spreader.appendChild(c)),c.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};Ve(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Ve(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",c=this.selectionHandles.styles,f=c.top,h=c.topHitArea,d=c.bottom,v=c.bottomHitArea,g=parseInt(f.borderWidth,10),y=parseInt(f.width,10),w=parseInt(h.width,10),C=this.wot.wtTable.getWidth(),_=this.wot.wtTable.getHeight();f.top="".concat(parseInt(o-y-1,10),"px"),f[u]="".concat(parseInt(i-y-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var I=Math.min(parseInt(i+a,10),C-y-g*2),E=Math.min(parseInt(i+a-w/4,10),C-w-g*2);d[u]="".concat(I,"px"),v[u]="".concat(E,"px");var U=Math.min(parseInt(o+l,10),_-y-g*2),G=Math.min(parseInt(o+l-w/4,10),_-w-g*2);d.top="".concat(U,"px"),v.top="".concat(G,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(f.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(f.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(f.zIndex="9999",h.zIndex="9999"):(f.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,c,f,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var g=o.rowFilter.renderedToSource(v);if(g>=r[0]&&g<=r[2]){l=g,f=r[0];break}}for(var y=d-1;y>=0;y-=1){var w=o.rowFilter.renderedToSource(y);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var C=o.getRenderedColumnsCount(),_=0;_<C;_+=1){var I=o.columnFilter.renderedToSource(_);if(I>=r[1]&&I<=r[3]){u=I,h=r[1];break}}for(var E=C-1;E>=0;E-=1){var U=o.columnFilter.renderedToSource(E);if(U>=r[1]&&U<=r[3]){c=U;break}}if(l===void 0||u===void 0){this.disappear();return}var G=o.getCell(this.wot.createCellCoords(l,u)),Q=l!==s||u!==c,K=Q?o.getCell(this.wot.createCellCoords(s,c)):G,X=Tt(G),J=Q?Tt(K):X,le=Tt(o.TABLE),ee=Ze(o.TABLE),he=X.top,Ce=X.left,_e=this.wot.wtSettings.getSetting("rtlMode"),be=0,P=0;if(_e){var T=Ze(G),Y=a.innerWidth-le.left-ee;P=Ce+T-J.left,be=a.innerWidth-Ce-T-Y-1}else P=J.left+Ze(K)-Ce,be=Ce-le.left-1;if(this.isEntireColumnSelected(l,s)){var p=this.getDimensionsFromHeader("columns",u,c,f,le),m=null;if(p){var b=Bv(p,3);m=b[0],be=b[1],P=b[2]}m&&(G=m)}var R=he-le.top-1,k=J.top+dt(K)-he;if(this.isEntireRowSelected(u,c)){var j=this.getDimensionsFromHeader("rows",l,s,h,le),W=null;if(j){var q=Bv(j,3);W=q[0],R=q[1],k=q[2]}W&&(G=W)}var Z=ki(G,a);parseInt(Z.borderTopWidth,10)>0&&(R+=1,k=k>0?k-1:0),parseInt(Z[_e?"borderRightWidth":"borderLeftWidth"],10)>0&&(be+=1,P=P>0?P-1:0);var ne=_e?"right":"left";this.topStyle.top="".concat(R,"px"),this.topStyle[ne]="".concat(be,"px"),this.topStyle.width="".concat(P,"px"),this.topStyle.display="block",this.startStyle.top="".concat(R,"px"),this.startStyle[ne]="".concat(be,"px"),this.startStyle.height="".concat(k,"px"),this.startStyle.display="block";var te=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(R+k-te,"px"),this.bottomStyle[ne]="".concat(be,"px"),this.bottomStyle.width="".concat(P,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(R,"px"),this.endStyle[ne]="".concat(be+P-te,"px"),this.endStyle.height="".concat(k+1,"px"),this.endStyle.display="block";var ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;var we=this.wot.getSetting("onModifyGetCellCoords",s,c),F=s,Se=c;if(we&&Array.isArray(we)){var Ie=Bv(we,4);F=Ie[2],Se=Ie[3]}if(Jr()||!ue||this.isPartRange(F,Se))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(R+k+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ne]="".concat(be+P+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Re=Ss(o.TABLE),Pe=Re===a;Pe&&(Re=i.documentElement);var ke=parseInt(this.cornerDefaultStyle.width,10)/2,S=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){var O=Pe?K.getBoundingClientRect().left:K.offsetLeft,A=!1,L=0;_e?(L=O-parseInt(this.cornerDefaultStyle.width,10)/2,A=L<0):(L=O+Ze(K)+parseInt(this.cornerDefaultStyle.width,10)/2,A=L>=Ac(Re)),A&&(this.cornerStyle[ne]="".concat(Math.floor(be+P+this.cornerCenterPointOffset-ke),"px"),this.cornerStyle[_e?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Pe?K.getBoundingClientRect().top:K.offsetTop,V=M+dt(K)+parseInt(this.cornerDefaultStyle.height,10)/2,H=V>=lo(Re);H&&(this.cornerStyle.top="".concat(Math.floor(R+k+this.cornerCenterPointOffset-S),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Jr()&&this.updateMultipleSelectionHandlesPosition(s,c,R,be,P,k)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,c=null,f=null,h=null,d=null,v=null,g=null,y=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},c=function(){return dt.apply(void 0,arguments)},f="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},c=function(){return Ze.apply(void 0,arguments)},f="ht__selection--columns",v="left";break}if(s.classList.contains(f)){var w=this.wot.getSetting("columnHeaders").length;if(g=u(n,w-i),y=u(o,w-i),!g||!y)return!1;var C=Tt(g),_=Tt(y);return g&&y&&(h=C[v]-a[v]-1,d=_[v]+c(y)-C[v]),[g,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?re(this[r],"hidden"):(xe(this[r],"hidden")&&De(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?re(this[r],"hidden"):De(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Jr()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Cre=Sre;function _re(e,t){return Tre(e)||Ere(e,t)||Rre(e,t)||Ore()}function Ore(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rre(e,t){if(e){if(typeof e=="string")return d0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d0(e,t)}}function d0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ere(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Tre(e){if(Array.isArray(e))return e}function xy(e){return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xy(e)}function kre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pre(e,t,r){return t&&v0(e.prototype,t),r&&v0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Are=function(){function e(t,r){kre(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Pre(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Cre(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(xy(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),re(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var c=l+1;s="".concat(r,"-").concat(c)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=_re(i,4),l=a[0],s=a[1],u=a[2],c=a[3],f=this.settings,h=f.highlightHeaderClassName,d=f.highlightColumnClassName,v=f.highlightRowClassName,g=f.highlightOnlyClosestHeader,y=f.selectionType,w=y===void 0||["active-header","header"].includes(y);if(w&&s!==null&&c!==null)for(var C=0,_=0;_<o;_+=1){var I=r.wtTable.columnFilter.renderedToSource(_);if(I>=s&&I<=c){var E=r.wtTable.getColumnHeaders(I),U=E.length-1;g&&E.length>1&&(E=[E[U]]);for(var G=0;G<E.length;G+=1){var Q=[],K=E[G];h&&Q.push(h),d&&Q.push(d),G=g?U:G;var X=r.getSetting("onBeforeHighlightingColumnHeader",I,G,{selectionType:y,columnCursor:C,selectionWidth:c-s+1,classNames:Q});X!==I&&(K=r.wtTable.getColumnHeader(X,G)),re(K,Q)}C+=1}}if(l!==null&&u!==null)for(var J=0,le=0;le<n;le+=1){var ee=r.wtTable.rowFilter.renderedToSource(le);if(w&&ee>=l&&ee<=u){var he=r.wtTable.getRowHeaders(ee),Ce=he.length-1;g&&he.length>1&&(he=[he[Ce]]);for(var _e=0;_e<he.length;_e+=1){var be=[],P=he[_e];h&&be.push(h),v&&be.push(v),_e=g?Ce:_e;var T=r.getSetting("onBeforeHighlightingRowHeader",ee,_e,{selectionType:y,rowCursor:J,selectionHeight:u-l+1,classNames:be});T!==ee&&(P=r.wtTable.getRowHeader(T,_e)),re(P,be)}J+=1}if(s!==null&&c!==null)for(var Y=0;Y<o;Y+=1){var p=r.wtTable.columnFilter.renderedToSource(Y);ee>=l&&ee<=u&&p>=s&&p<=c?this.settings.className&&this.addClassAtCoords(r,ee,p,this.settings.className,this.settings.markIntersections):ee>=l&&ee<=u?v&&this.addClassAtCoords(r,ee,p,v):p>=s&&p<=c&&d&&this.addClassAtCoords(r,ee,p,d);var m=r.getSetting("onAfterDrawSelection",ee,p,this.settings.layerLevel);typeof m=="string"&&this.addClassAtCoords(r,ee,p,m)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const Ire=Are;function p0(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=r||n&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function $re(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var Mre=new Map([["mousedown",p0],["mouseover",$re],["touchstart",p0]]);function g0(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;Mre.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:uC(e)||e.type==="touchstart",isRightClick:Pi(e)})}var WH=new WeakMap,$C=Symbol("rootInstance");function xre(e){WH.set(e,!0)}function Dre(e){return e===$C}function Dy(e){return WH.has(e)}function Ml(e,t){return Lre(e)||Nre(e,t)||UH(e,t)||Hre()}function Hre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Lre(e){if(Array.isArray(e))return e}function y0(e){return Fre(e)||Bre(e)||UH(e)||jre()}function jre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UH(e,t){if(e){if(typeof e=="string")return Hy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hy(e,t)}}function Bre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fre(e){if(Array.isArray(e))return Hy(e)}function Hy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wre(e,t,r){return t&&m0(e.prototype,t),r&&m0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var No=new WeakMap,Ure=function(){function e(t){Vre(this,e),this.instance=t,this.eventManager=new vt(t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this._wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,No.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return Wre(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=No.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),re(o,"handsontable"),r.table=i.createElement("TABLE"),re(r.table,"htCore"),this.instance.getSettings().tableClassName&&re(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=No.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var c=r.instance.rootWindow;pT(c),u.preventDefault(),c.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&pT(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&uC(u)&&l.finish(),n.mouseDown=!1,($D(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!Pi(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&Pi(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var c=u.target,f=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var g=Ht(a);if(a.elementFromPoint(f+g,h)!==v||a.elementFromPoint(f,h+g)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var y=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(c):r.settings.outsideClickDeselects;y?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||wf(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,y0(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=No.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return Dy(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(c,f){var h;return(h=r.instance).getDataAtCell.apply(h,y0(r.translateFromRenderableToVisualIndex(c,f)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var c=[];return r.instance.hasRowHeaders()&&c.push(function(f,h){var d=f>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(f):f;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",c),c},columnHeaders:function(){var c=[];return r.instance.hasColHeaders()&&c.push(function(f,h){var d=f>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(f):f;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",c),c},columnWidth:function(c){var f=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getColWidth(f===null?c:f)},rowHeight:function(c){var f=r.instance.rowIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getRowHeight(f===null?c:f)},cellRenderer:function(c,f,h){var d=r.translateFromRenderableToVisualIndex(c,f),v=Ml(d,2),g=v[0],y=v[1],w=r.instance.runHooks("modifyGetCellCoords",g,y),C=g,_=y;if(Array.isArray(w)){var I=Ml(w,2);C=I[0],_=I[1]}var E=r.instance.getCellMeta(C,_),U=r.instance.colToProp(_),G=r.instance.getDataAtRowProp(C,U);r.instance.hasHook("beforeValueRender")&&(G=r.instance.runHooks("beforeValueRender",G,E)),r.instance.runHooks("beforeRenderer",h,g,y,U,G,E),r.instance.getCellRenderer(E)(r.instance,h,g,y,U,G,E),r.instance.runHooks("afterRenderer",h,g,y,U,G,E)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){!r.instance||r.instance.isDestroyed||r.instance.refreshDimensions()},onCellMouseDown:function(c,f,h,d){var v=r.translateFromRenderableToVisualCoords(f),g={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",c,v,h,g),!Ca(c)&&(g0(c,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(w,C){return r.instance._createCellCoords(w,C)}}),r.instance.runHooks("afterOnCellMouseDown",c,v,h),r.activeWt=r._wt)},onCellContextMenu:function(c,f,h,d){var v=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",c,v,h),!Ca(c)&&(r.instance.runHooks("afterOnCellContextMenu",c,v,h),r.activeWt=r._wt)},onCellMouseOut:function(c,f,h,d){var v=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",c,v,h),!Ca(c)&&(r.instance.runHooks("afterOnCellMouseOut",c,v,h),r.activeWt=r._wt)},onCellMouseOver:function(c,f,h,d){var v=r.translateFromRenderableToVisualCoords(f),g={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",c,v,h,g),!Ca(c)&&(n.mouseDown&&g0(c,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(w,C){return r.instance._createCellCoords(w,C)}}),r.instance.runHooks("afterOnCellMouseOver",c,v,h),r.activeWt=r._wt)},onCellMouseUp:function(c,f,h,d){var v=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",c,v,h),!(Ca(c)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",c,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",c)},onCellCornerDblClick:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",c)},beforeDraw:function(c,f){return r.beforeRender(c,f)},onDraw:function(c){return r.afterRender(c)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(c,f,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(c),g=r.instance.runHooks("beforeHighlightingRowHeader",v,f,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:function(c,f,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(c),g=r.instance.runHooks("beforeHighlightingColumnHeader",v,f,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:function(c,f,h){var d,v=r.translateFromRenderableToVisualIndex(c,f),g=Ml(v,2),y=g[0],w=g[1],C=r.instance.selection.getSelectedRange(),_=C.size();if(_>0){var I=(h??0)+1-_,E=C.peekByIndex(I);d=[E.from.row,E.from.col,E.to.row,E.to.col]}return r.instance.runHooks("afterDrawSelection",y,w,d,h)},onBeforeDrawBorders:function(c,f){var h=Ml(c,4),d=h[0],v=h[1],g=h[2],y=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(g),r.instance.columnIndexMapper.getVisualFromRenderableIndex(y)];return r.instance.runHooks("beforeDrawBorders",w,f)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(c,f){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.runHooks("beforeStretchingColumnWidth",c,h)},onModifyRowHeaderWidth:function(c){return r.instance.runHooks("modifyRowHeaderWidth",c)},onModifyGetCellCoords:function(c,f,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,g=f>=0?v.getVisualFromRenderableIndex(f):f,y=c>=0?d.getVisualFromRenderableIndex(c):c,w=r.instance.runHooks("modifyGetCellCoords",y,g,h);if(Array.isArray(w)){var C=Ml(w,4),_=C[0],I=C[1],E=C[2],U=C[3];return[_>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(_,1)):_,I>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(I,1)):I,E>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(E,-1)):E,U>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(U,-1)):U]}},viewportRowCalculatorOverride:function(c){var f=r.settings.viewportRowRenderingOffset;if(f==="auto"&&r.settings.fixedRowsTop&&(f=10),f>0||f==="auto"){var h=r.countRenderableRows(),d=c.startRow,v=c.endRow;if(typeof f=="number")c.startRow=Math.max(d-f,0),c.endRow=Math.min(v+f,h-1);else if(f==="auto"){var g=Math.ceil(v/h*12);c.startRow=Math.max(d-g,0),c.endRow=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",c)},viewportColumnCalculatorOverride:function(c){var f=r.settings.viewportColumnRenderingOffset;if(f==="auto"&&r.settings.fixedColumnsStart&&(f=10),f>0||f==="auto"){var h=r.countRenderableColumns(),d=c.startColumn,v=c.endColumn;if(typeof f=="number"&&(c.startColumn=Math.max(d-f,0),c.endColumn=Math.min(v+f,h-1)),f==="auto"){var g=Math.ceil(v/h*6);c.startColumn=Math.max(d-g,0),c.endColumn=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",c)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var c=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||c}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new ire(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(wf(r))return!0;var n=Oi(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return No.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){Hr(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;xe(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),r,this.instance.getColHeader):(Hr(n),this.appendColHeader(r,n))}else{var i=this.instance.rootDocument,a=i.createElement("div"),l=i.createElement("span");a.className="relative",l.className="colHeader",this.updateCellHeader(l,r,this.instance.getColHeader),a.appendChild(l),n.appendChild(a)}this.instance.runHooks("afterGetColHeader",r,n)}},{key:"updateCellHeader",value:function(r,n,o){var i=n,a=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?i=a.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(i=a.wtTable.rowFilter.sourceToRendered(n))),i>-1?zi(r,o(n)):(Ti(r,String.fromCharCode(160)),re(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=No.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=No.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const zre=Ure;var su=Rr("cellTypes"),Gre=su.register,Yre=su.getItem,zH=su.hasItem;su.getNames;su.getValues;function GH(e){if(!zH(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Yre(e)}function Xr(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&ur(e,n),o&&fn(e,o),i&&Ql(e,i),Gre(e,t)}function Ny(e){return Ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ny(e)}var Kre="ABCDEFGHIJKLMNOPQRSTUVWXYZ",b0=Kre.length;function Xre(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%b0,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/b0,10);return r}function Nc(e,t){var r=typeof t>"u"?!0:t;return function(o,i){return function a(l){if(l){if(it(l,e)&&l[e]!==void 0)return l[e];if(it(l,"type")&&l.type){if(typeof l.type!="string")throw new Error('Cell "type" must be a string');var s=GH(l.type);if(it(s,e))return s[e];if(r)return}return a(Object.getPrototypeOf(l))}}(typeof o=="number"?this.getCellMeta(o,i):o)}}function w0(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function YH(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ne(e[0])&&(t=iC(e[0]))),t}function qre(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function Qre(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Ny(t)==="object"&&!Array.isArray(t)&&t!==null}))}function Zre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jre(e,t,r){return t&&S0(e.prototype,t),r&&S0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ene=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Zre(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Jre(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return $(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):me(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ne(s)||nt(s))if(a?u=[]:u={},!l||a){var c=0,f=this.countFirstRowKeys()-1;me(c,f,function(h){var d=i.colToProp(h);if(h>=(n||c)&&h<=(o||f)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):hv(u,d,v)}})}else Ve(s,function(h,d){hv(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=ja(o);this.hot.runHooks("modifySourceData",r,this.propToCol(n),i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:hv(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=q4(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=ja(i);this.hot.runHooks("modifySourceData",r,this.colToProp(n),a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,c=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),c=Math.max(n.col,o.col));var f=[];return me(l,u,function(h){f.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,c,i))}),f}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return YH(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const tne=ene;var C0=bt,rne=function(e){return e!==void 0&&(C0(e,"value")||C0(e,"writable"))},nne=Ae,one=kt,ine=mt,ane=Ct,lne=rne,sne=nn,une=Eh;function KH(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(ane(e)===r)return e[t];if(n=sne.f(e,t),n)return lne(n)?n.value:n.get===void 0?void 0:one(n.get,r);if(ine(o=une(e)))return KH(o,t,r)}nne({target:"Reflect",stat:!0},{get:KH});var cne=Ae,fne=Le,hne=dr,XH=nn.f,qH=St,dne=fne(function(){XH(1)}),vne=!qH||dne;cne({target:"Object",stat:!0,forced:vne,sham:!qH},{getOwnPropertyDescriptor:function(t,r){return XH(hne(t),r)}});var pne="localHooks",QH={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)kg(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Gn(QH,"MIXIN_NAME",pne,{writable:!1,enumerable:!1});const or=QH;function gne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yne(e,t,r){return t&&_0(e.prototype,t),r&&_0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Gi=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;gne(this,e),this.indexedValues=[],this.initValueOrFn=t}return yne(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,nt(this.initValueOrFn)?me(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):me(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();rt(Gi,or);function Fv(e){return Sne(e)||wne(e)||bne(e)||mne()}function mne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bne(e,t){if(e){if(typeof e=="string")return Ly(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ly(e,t)}}function wne(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sne(e){if(Array.isArray(e))return Ly(e)}function Ly(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MC(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Fv(e.slice(0,o)),Fv(r.map(function(i,a){return nt(n)?n(i,a):n})),Fv(o===void 0?[]:e.slice(o)))}function xC(e,t){return Cr(e,function(r,n){return t.includes(n)===!1})}function jy(e){return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}function Cne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _ne(e,t,r){return t&&O0(e.prototype,t),r&&O0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function is(){return typeof Reflect<"u"&&Reflect.get?is=Reflect.get.bind():is=function(t,r,n){var o=One(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},is.apply(this,arguments)}function One(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mi(e),e!==null););return e}function Rne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&By(e,t)}function By(e,t){return By=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},By(e,t)}function Ene(e){var t=Pne();return function(){var n=Mi(e),o;if(t){var i=Mi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tne(this,o)}}function Tne(e,t){if(t&&(jy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kne(e)}function kne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mi(e){return Mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mi(e)}var Po=function(e){Rne(r,e);var t=Ene(r);function r(){return Cne(this,r),t.apply(this,arguments)}return _ne(r,[{key:"insert",value:function(o,i){this.indexedValues=MC(this.indexedValues,o,i,this.initValueOrFn),is(Mi(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=xC(this.indexedValues,o),is(Mi(r.prototype),"remove",this).call(this,o)}}]),r}(Gi);function Fy(e){return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fy(e)}function Ane(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ine(e,t,r){return t&&R0(e.prototype,t),r&&R0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vy(e,t)}function Vy(e,t){return Vy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Vy(e,t)}function Mne(e){var t=Hne();return function(){var n=Yf(e),o;if(t){var i=Yf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xne(this,o)}}function xne(e,t){if(t&&(Fy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dne(e)}function Dne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yf(e){return Yf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yf(e)}var Gh=function(e){$ne(r,e);var t=Mne(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Ane(this,r),t.call(this,n)}return Ine(r,[{key:"getHiddenIndexes",value:function(){return Vt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Po);function Vv(e){return Bne(e)||jne(e)||Lne(e)||Nne()}function Nne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lne(e,t){if(e){if(typeof e=="string")return Wy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wy(e,t)}}function jne(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bne(e){if(Array.isArray(e))return Wy(e)}function Wy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DC(e,t,r){return[].concat(Vv(e.slice(0,t)),Vv(r),Vv(e.slice(t)))}function Os(e,t){return Cr(e,function(r){return t.includes(r)===!1})}function HC(e,t){return Fe(e,function(r){return r-t.filter(function(n){return n<r}).length})}function NC(e,t){var r=t[0],n=t.length;return Fe(e,function(o){return o>=r?o+n:o})}function Uy(e){return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uy(e)}function Fne(e){return zne(e)||Une(e)||Wne(e)||Vne()}function Vne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wne(e,t){if(e){if(typeof e=="string")return zy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zy(e,t)}}function Une(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zne(e){if(Array.isArray(e))return zy(e)}function zy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yne(e,t,r){return t&&E0(e.prototype,t),r&&E0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vn(){return typeof Reflect<"u"&&Reflect.get?vn=Reflect.get.bind():vn=function(t,r,n){var o=Kne(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},vn.apply(this,arguments)}function Kne(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mr(e),e!==null););return e}function Xne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gy(e,t)}function Gy(e,t){return Gy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Gy(e,t)}function qne(e){var t=Zne();return function(){var n=Mr(e),o;if(t){var i=Mr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qne(this,o)}}function Qne(e,t){if(t&&(Uy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZH(e)}function ZH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mr(e){return Mr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mr(e)}function Jne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Yh=function(e){Xne(r,e);var t=qne(r);function r(){var n;Gne(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Jne(ZH(n),"orderOfIndexes",[]),n}return Yne(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=Fne(Array(o.length).keys()),vn(Mr(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=Os(this.orderOfIndexes,[o]),nt(this.initValueOrFn)?vn(Mr(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):vn(Mr(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,vn(Mr(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=MC(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=NC(this.orderOfIndexes,i),vn(Mr(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=xC(this.indexedValues,o),this.orderOfIndexes=Os(this.orderOfIndexes,o),this.orderOfIndexes=HC(this.orderOfIndexes,o),vn(Mr(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(Gi);function Yy(e){return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yy(e)}function eoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function toe(e,t,r){return t&&T0(e.prototype,t),r&&T0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function roe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ky(e,t)}function Ky(e,t){return Ky=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ky(e,t)}function noe(e){var t=aoe();return function(){var n=Kf(e),o;if(t){var i=Kf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ooe(this,o)}}function ooe(e,t){if(t&&(Yy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ioe(e)}function ioe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aoe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kf(e){return Kf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kf(e)}var uu=function(e){roe(r,e);var t=noe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return eoe(this,r),t.call(this,n)}return toe(r,[{key:"getTrimmedIndexes",value:function(){return Vt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Po),k0=new Map([["indexesSequence",{getListWithInsertedItems:DC,getListWithRemovedItems:Os}],["physicallyIndexed",{getListWithInsertedItems:MC,getListWithRemovedItems:xC}]]),JH=function(t){if(k0.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return k0.get(t)};function Xy(e){return Xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xy(e)}function loe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function soe(e,t,r){return t&&P0(e.prototype,t),r&&P0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function as(){return typeof Reflect<"u"&&Reflect.get?as=Reflect.get.bind():as=function(t,r,n){var o=uoe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},as.apply(this,arguments)}function uoe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xi(e),e!==null););return e}function coe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qy(e,t)}function qy(e,t){return qy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qy(e,t)}function foe(e){var t=voe();return function(){var n=xi(e),o;if(t){var i=xi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hoe(this,o)}}function hoe(e,t){if(t&&(Xy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return doe(e)}function doe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function voe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xi(e){return xi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xi(e)}var eN=function(e){coe(r,e);var t=foe(r);function r(){return loe(this,r),t.call(this,function(n){return n})}return soe(r,[{key:"insert",value:function(o,i){var a=NC(this.indexedValues,i);this.indexedValues=DC(a,o,i),as(xi(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=Os(this.indexedValues,o);this.indexedValues=HC(i,o),as(xi(r.prototype),"remove",this).call(this,o)}}]),r}(Gi),A0=new Map([["hiding",Gh],["index",Gi],["linkedPhysicalIndexToValue",Yh],["physicalIndexToValue",Po],["trimming",uu]]);function poe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!A0.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(A0.get(e))(t)}function goe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yoe(e,t,r){return t&&I0(e.prototype,t),r&&I0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var LC=function(){function e(){goe(this,e),this.collection=new Map}return yoe(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);fe(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return at(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();rt(LC,or);function Qy(e){return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qy(e)}function moe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function boe(e,t,r){return t&&$0(e.prototype,t),r&&$0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function woe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zy(e,t)}function Zy(e,t){return Zy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Zy(e,t)}function Soe(e){var t=Ooe();return function(){var n=Xf(e),o;if(t){var i=Xf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Coe(this,o)}}function Coe(e,t){if(t&&(Qy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _oe(e)}function _oe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ooe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xf(e){return Xf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xf(e)}var M0=function(e){woe(r,e);var t=Soe(r);function r(n,o){var i;return moe(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return boe(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=Fe(this.get(),function(f){return f.getValues()}),a=[],l=fe(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],c=0;c<this.getLength();c+=1)u.push(i[c][s]);a.push(u)}return Fe(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return fe(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(LC);function Roe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Eoe(e,t,r){return t&&x0(e.prototype,t),r&&x0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Toe(e,t,r){koe(e,t),t.set(e,r)}function koe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Poe(e,t,r){var n=tN(e,t,"set");return Aoe(e,n,r),r}function Aoe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ioe(e,t){var r=tN(e,t,"get");return $oe(e,r)}function tN(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $oe(e,t){return t.get?t.get.call(e):t.value}var Wv=new WeakMap,rN=function(){function e(){Roe(this,e),Toe(this,Wv,{writable:!0,value:[]})}return Eoe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(Ioe(this,Wv)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){Poe(this,Wv,r)}}]),e}();rt(rN,or);function D0(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function Moe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xoe(e,t,r){return t&&H0(e.prototype,t),r&&H0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xl(e,t,r){Doe(e,t),t.set(e,r)}function Doe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(e,t){var r=nN(e,t,"get");return Hoe(e,r)}function Hoe(e,t){return t.get?t.get.call(e):t.value}function zu(e,t,r){var n=nN(e,t,"set");return Noe(e,n,r),r}function nN(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Noe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gu=new WeakMap,Dl=new WeakMap,Yu=new WeakMap,Ku=new WeakMap,Xu=new WeakMap,Loe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;Moe(this,e),xl(this,Gu,{writable:!0,value:new Set}),xl(this,Dl,{writable:!0,value:[]}),xl(this,Yu,{writable:!0,value:[]}),xl(this,Ku,{writable:!0,value:!1}),xl(this,Xu,{writable:!0,value:!1}),zu(this,Xu,r??!1)}return xoe(e,[{key:"createObserver",value:function(){var r=this,n=new rN;return gr(this,Gu).add(n),n.addLocalHook("unsubscribe",function(){gr(r,Gu).delete(n)}),n._writeInitialChanges(D0(gr(this,Dl),gr(this,Yu))),n}},{key:"emit",value:function(r){var n=gr(this,Yu);(!gr(this,Ku)||gr(this,Dl).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(gr(this,Xu)):zu(this,Dl,new Array(r.length).fill(gr(this,Xu))),gr(this,Ku)||(zu(this,Ku,!0),n=gr(this,Dl)));var o=D0(n,r);gr(this,Gu).forEach(function(i){return i._write(o)}),zu(this,Yu,r)}}]),e}(),N0;function Uv(e){return Voe(e)||Foe(e)||Boe(e)||joe()}function joe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Boe(e,t){if(e){if(typeof e=="string")return Jy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jy(e,t)}}function Foe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Voe(e){if(Array.isArray(e))return Jy(e)}function Jy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Woe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Uoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zoe(e,t,r){return t&&L0(e.prototype,t),r&&L0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var j0=new Set(["getFirstNotHiddenIndex"]),em=function(){function e(){var t=this;Uoe(this,e),this.indexesSequence=new eN,this.trimmingMapsCollection=new M0(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new M0(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new LC,this.hidingChangesObservable=new Loe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return zoe(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,poe(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof uu?this.trimmingMapsCollection.register(r,n):n instanceof Gh?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return fe(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return fe(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return fe(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return fe(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;j0.has("getFirstNotHiddenIndex")&&(j0.delete("getFirstNotHiddenIndex"),ot(Je(N0||(N0=Woe([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?o===!0&&i!==r-n?this.getFirstNotHiddenIndex(i,-n,!1,i):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,o,i)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Uv(new Array(r).keys()),this.notHiddenIndexesCache=Uv(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=Uv(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=Fe(r,function(f){return o.getPhysicalFromVisualIndex(f)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=Os(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var c=s.filter(function(f){return o.isTrimmed(f)===!1})[n];u=s.indexOf(c)}this.setIndexesSequence(DC(s,u,i))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=fe(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=Fe(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesSequence.insert(a,l),this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();rt(em,or);var B0;function Goe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Yoe(e,t){return Ve(t,function(r,n){at(e[n])&&(e[n]=r)}),e}function oN(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function iN(e){fe(e)&&cC(Je(B0||(B0=Goe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function Koe(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var aN=Rr("phraseFormatters"),Xoe=aN.register,qoe=aN.getValues;function Qoe(e,t){Xoe(e,t)}function Zoe(){return qoe()}Qoe("pluralize",Koe);var je="ContextMenu:items",jC="".concat(je,".noItems"),BC="".concat(je,".insertRowAbove"),FC="".concat(je,".insertRowBelow"),VC="".concat(je,".insertColumnOnTheLeft"),WC="".concat(je,".insertColumnOnTheRight"),UC="".concat(je,".removeRow"),zC="".concat(je,".removeColumn"),GC="".concat(je,".undo"),YC="".concat(je,".redo"),KC="".concat(je,".readOnly"),XC="".concat(je,".clearColumn"),qC="".concat(je,".copy"),QC="".concat(je,".cut"),ZC="".concat(je,".freezeColumn"),JC="".concat(je,".unfreezeColumn"),e_="".concat(je,".mergeCells"),t_="".concat(je,".unmergeCells"),r_="".concat(je,".addComment"),n_="".concat(je,".editComment"),o_="".concat(je,".removeComment"),i_="".concat(je,".readOnlyComment"),a_="".concat(je,".align"),l_="".concat(je,".align.left"),s_="".concat(je,".align.center"),u_="".concat(je,".align.right"),c_="".concat(je,".align.justify"),f_="".concat(je,".align.top"),h_="".concat(je,".align.middle"),d_="".concat(je,".align.bottom"),v_="".concat(je,".borders"),p_="".concat(je,".borders.top"),g_="".concat(je,".borders.right"),y_="".concat(je,".borders.bottom"),m_="".concat(je,".borders.left"),b_="".concat(je,".borders.remove"),w_="".concat(je,".nestedHeaders.insertChildRow"),S_="".concat(je,".nestedHeaders.detachFromParent"),C_="".concat(je,".hideColumn"),__="".concat(je,".showColumn"),O_="".concat(je,".hideRow"),R_="".concat(je,".showRow"),qt="Filters:",pt="".concat(qt,"conditions"),Kh="".concat(pt,".none"),E_="".concat(pt,".isEmpty"),T_="".concat(pt,".isNotEmpty"),k_="".concat(pt,".isEqualTo"),P_="".concat(pt,".isNotEqualTo"),A_="".concat(pt,".beginsWith"),I_="".concat(pt,".endsWith"),$_="".concat(pt,".contains"),M_="".concat(pt,".doesNotContain"),Joe="".concat(pt,".byValue"),x_="".concat(pt,".greaterThan"),D_="".concat(pt,".greaterThanOrEqualTo"),H_="".concat(pt,".lessThan"),N_="".concat(pt,".lessThanOrEqualTo"),L_="".concat(pt,".isBetween"),j_="".concat(pt,".isNotBetween"),B_="".concat(pt,".after"),F_="".concat(pt,".before"),V_="".concat(pt,".today"),W_="".concat(pt,".tomorrow"),U_="".concat(pt,".yesterday"),z_="".concat(qt,"labels.filterByCondition"),G_="".concat(qt,"labels.filterByValue"),Y_="".concat(qt,"labels.conjunction"),Xh="".concat(qt,"labels.disjunction"),qf="".concat(qt,"values.blankCells"),K_="".concat(qt,"buttons.selectAll"),X_="".concat(qt,"buttons.clear"),q_="".concat(qt,"buttons.ok"),Q_="".concat(qt,"buttons.cancel"),Z_="".concat(qt,"buttons.placeholder.search"),J_="".concat(qt,"buttons.placeholder.value"),eO="".concat(qt,"buttons.placeholder.secondValue");const eie=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:r_,CONTEXTMENU_ITEMS_ALIGNMENT:a_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:d_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:s_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:c_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:l_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:h_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:u_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:f_,CONTEXTMENU_ITEMS_BORDERS:v_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:y_,CONTEXTMENU_ITEMS_BORDERS_LEFT:m_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:g_,CONTEXTMENU_ITEMS_BORDERS_TOP:p_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:XC,CONTEXTMENU_ITEMS_COPY:qC,CONTEXTMENU_ITEMS_CUT:QC,CONTEXTMENU_ITEMS_EDIT_COMMENT:n_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:ZC,CONTEXTMENU_ITEMS_HIDE_COLUMN:C_,CONTEXTMENU_ITEMS_HIDE_ROW:O_,CONTEXTMENU_ITEMS_INSERT_LEFT:VC,CONTEXTMENU_ITEMS_INSERT_RIGHT:WC,CONTEXTMENU_ITEMS_MERGE_CELLS:e_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:S_,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:w_,CONTEXTMENU_ITEMS_NO_ITEMS:jC,CONTEXTMENU_ITEMS_READ_ONLY:KC,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:i_,CONTEXTMENU_ITEMS_REDO:YC,CONTEXTMENU_ITEMS_REMOVE_BORDERS:b_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:zC,CONTEXTMENU_ITEMS_REMOVE_COMMENT:o_,CONTEXTMENU_ITEMS_REMOVE_ROW:UC,CONTEXTMENU_ITEMS_ROW_ABOVE:BC,CONTEXTMENU_ITEMS_ROW_BELOW:FC,CONTEXTMENU_ITEMS_SHOW_COLUMN:__,CONTEXTMENU_ITEMS_SHOW_ROW:R_,CONTEXTMENU_ITEMS_UNDO:GC,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:JC,CONTEXTMENU_ITEMS_UNMERGE_CELLS:t_,CONTEXT_MENU_ITEMS_NAMESPACE:je,FILTERS_BUTTONS_CANCEL:Q_,FILTERS_BUTTONS_CLEAR:X_,FILTERS_BUTTONS_OK:q_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Z_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:eO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:J_,FILTERS_BUTTONS_SELECT_ALL:K_,FILTERS_CONDITIONS_AFTER:B_,FILTERS_CONDITIONS_BEFORE:F_,FILTERS_CONDITIONS_BEGINS_WITH:A_,FILTERS_CONDITIONS_BETWEEN:L_,FILTERS_CONDITIONS_BY_VALUE:Joe,FILTERS_CONDITIONS_CONTAINS:$_,FILTERS_CONDITIONS_EMPTY:E_,FILTERS_CONDITIONS_ENDS_WITH:I_,FILTERS_CONDITIONS_EQUAL:k_,FILTERS_CONDITIONS_GREATER_THAN:x_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:D_,FILTERS_CONDITIONS_LESS_THAN:H_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:N_,FILTERS_CONDITIONS_NAMESPACE:pt,FILTERS_CONDITIONS_NONE:Kh,FILTERS_CONDITIONS_NOT_BETWEEN:j_,FILTERS_CONDITIONS_NOT_CONTAIN:M_,FILTERS_CONDITIONS_NOT_EMPTY:T_,FILTERS_CONDITIONS_NOT_EQUAL:P_,FILTERS_CONDITIONS_TODAY:V_,FILTERS_CONDITIONS_TOMORROW:W_,FILTERS_CONDITIONS_YESTERDAY:U_,FILTERS_DIVS_FILTER_BY_CONDITION:z_,FILTERS_DIVS_FILTER_BY_VALUE:G_,FILTERS_LABELS_CONJUNCTION:Y_,FILTERS_LABELS_DISJUNCTION:Xh,FILTERS_NAMESPACE:qt,FILTERS_VALUES_BLANK_CELLS:qf},Symbol.toStringTag,{value:"Module"}));var ce;function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tie=(ce={languageCode:"en-US"},de(ce,jC,"No available options"),de(ce,BC,"Insert row above"),de(ce,FC,"Insert row below"),de(ce,VC,"Insert column left"),de(ce,WC,"Insert column right"),de(ce,UC,["Remove row","Remove rows"]),de(ce,zC,["Remove column","Remove columns"]),de(ce,GC,"Undo"),de(ce,YC,"Redo"),de(ce,KC,"Read only"),de(ce,XC,"Clear column"),de(ce,a_,"Alignment"),de(ce,l_,"Left"),de(ce,s_,"Center"),de(ce,u_,"Right"),de(ce,c_,"Justify"),de(ce,f_,"Top"),de(ce,h_,"Middle"),de(ce,d_,"Bottom"),de(ce,ZC,"Freeze column"),de(ce,JC,"Unfreeze column"),de(ce,v_,"Borders"),de(ce,p_,"Top"),de(ce,g_,"Right"),de(ce,y_,"Bottom"),de(ce,m_,"Left"),de(ce,b_,"Remove border(s)"),de(ce,r_,"Add comment"),de(ce,n_,"Edit comment"),de(ce,o_,"Delete comment"),de(ce,i_,"Read-only comment"),de(ce,e_,"Merge cells"),de(ce,t_,"Unmerge cells"),de(ce,qC,"Copy"),de(ce,QC,"Cut"),de(ce,w_,"Insert child row"),de(ce,S_,"Detach from parent"),de(ce,C_,["Hide column","Hide columns"]),de(ce,__,["Show column","Show columns"]),de(ce,O_,["Hide row","Hide rows"]),de(ce,R_,["Show row","Show rows"]),de(ce,Kh,"None"),de(ce,E_,"Is empty"),de(ce,T_,"Is not empty"),de(ce,k_,"Is equal to"),de(ce,P_,"Is not equal to"),de(ce,A_,"Begins with"),de(ce,I_,"Ends with"),de(ce,$_,"Contains"),de(ce,M_,"Does not contain"),de(ce,x_,"Greater than"),de(ce,D_,"Greater than or equal to"),de(ce,H_,"Less than"),de(ce,N_,"Less than or equal to"),de(ce,L_,"Is between"),de(ce,j_,"Is not between"),de(ce,B_,"After"),de(ce,F_,"Before"),de(ce,V_,"Today"),de(ce,W_,"Tomorrow"),de(ce,U_,"Yesterday"),de(ce,qf,"Blank cells"),de(ce,z_,"Filter by condition"),de(ce,G_,"Filter by value"),de(ce,Y_,"And"),de(ce,Xh,"Or"),de(ce,K_,"Select all"),de(ce,X_,"Clear"),de(ce,q_,"OK"),de(ce,Q_,"Cancel"),de(ce,Z_,"Search"),de(ce,J_,"Value"),de(ce,eO,"Second value"),ce);const lN=tie;var tm=lN.languageCode,qh=Rr("languagesDictionaries"),rie=qh.register,sN=qh.getItem,nie=qh.hasItem,oie=qh.getValues;uN(lN);function uN(e,t){var r=e,n=t;return Ne(e)&&(n=e,r=n.languageCode),iie(r,n),rie(r,Kt(n)),Kt(n)}function iie(e,t){e!==tm&&Yoe(t,sN(tm))}function cN(e){return tO(e)?Kt(sN(e)):null}function tO(e){return nie(e)}function aie(){return oie()}function fN(e,t,r){var n=cN(e);if(n===null)return null;var o=n[t];if(at(o))return null;var i=lie(o,r);return Array.isArray(i)?i[0]:i}function lie(e,t){var r=e;return $(Zoe(),function(n){r=n(e,t)}),r}function sie(e){var t=oN(e);return tO(t)||(t=tm,iN(e)),t}var uie=Ae,cie=St,fie=BM,hie=dr,die=nn,vie=dl;uie({target:"Object",stat:!0,sham:!cie},{getOwnPropertyDescriptors:function(t){for(var r=hie(t),n=die.f,o=fie(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&vie(i,l,s);return i}});var Qh="active-header",Zh="area",Rs="cell",rO="fill",cu="header",nO="custom-selection";function rm(e){return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rm(e)}function pie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F0(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gie(e,t,r){return t&&F0(e.prototype,t),r&&F0(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lc(){return typeof Reflect<"u"&&Reflect.get?Lc=Reflect.get.bind():Lc=function(t,r,n){var o=yie(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Lc.apply(this,arguments)}function yie(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wa(e),e!==null););return e}function mie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nm(e,t)}function nm(e,t){return nm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nm(e,t)}function bie(e){var t=Sie();return function(){var n=Wa(e),o;if(t){var i=Wa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wie(this,o)}}function wie(e,t){if(t&&(rm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hN(e)}function hN(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wa(e){return Wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wa(e)}function Cie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _ie=function(e){mie(r,e);var t=bie(r);function r(n,o){var i;return pie(this,r),i=t.call(this,n,null),Cie(hN(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return gie(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,Lc(Wa(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),c=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(Ire);const yl=_ie;var Oie=["activeHeaderClassName"];function V0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function W0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V0(Object(r),!0).forEach(function(n){Rie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V0(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eie(e,t){if(e==null)return{};var r=Tie(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Tie(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function kie(e){var t=e.activeHeaderClassName,r=Eie(e,Oie),n=new yl(W0(W0({highlightHeaderClassName:t},r),{},{selectionType:Qh}));return n}var Pie=["layerLevel","areaCornerVisible"];function U0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function z0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U0(Object(r),!0).forEach(function(n){Aie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U0(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Aie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iie(e,t){if(e==null)return{};var r=$ie(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $ie(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Mie(e){var t=e.layerLevel,r=e.areaCornerVisible,n=Iie(e,Pie),o=new yl(z0(z0({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:Zh}));return o}var xie=["cellCornerVisible"];function G0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Y0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G0(Object(r),!0).forEach(function(n){Die(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G0(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Die(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hie(e,t){if(e==null)return{};var r=Nie(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Nie(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Lie(e){var t=e.cellCornerVisible,r=Hie(e,xie),n=new yl(Y0(Y0({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:Rs}));return n}var jie=["border","visualCellRange"];function K0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K0(Object(r),!0).forEach(function(n){Bie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K0(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fie(e,t){if(e==null)return{};var r=Vie(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Vie(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Wie(e){var t=e.border,r=e.visualCellRange,n=Fie(e,jie),o=new yl(zv(zv(zv({},t),n),{},{selectionType:nO}),r);return o}var X0=St,Uie=He,zie=kt,Gie=Le,Gv=Gs,Yie=Us,Kie=Hs,Xie=nr,qie=Ls,la=Object.assign,q0=Object.defineProperty,Qie=Uie([].concat),Zie=!la||Gie(function(){if(X0&&la({b:1},la(q0({},"a",{enumerable:!0,get:function(){q0(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),la({},e)[r]!=7||Gv(la({},t)).join("")!=n})?function(t,r){for(var n=Xie(t),o=arguments.length,i=1,a=Yie.f,l=Kie.f;o>i;)for(var s=qie(arguments[i++]),u=a?Qie(Gv(s),a(s)):Gv(s),c=u.length,f=0,h;c>f;)h=u[f++],(!X0||zie(l,s,h))&&(n[h]=s[h]);return n}:la,Jie=Ae,Q0=Zie;Jie({target:"Object",stat:!0,arity:2,forced:Object.assign!==Q0},{assign:Q0});function Z0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function J0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z0(Object(r),!0).forEach(function(n){eae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z0(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tae(e){var t=Object.assign({},e),r=new yl(J0(J0({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:rO}));return r}var rae=["headerClassName","rowClassName","columnClassName"];function eP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function tP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eP(Object(r),!0).forEach(function(n){nae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eP(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oae(e,t){if(e==null)return{};var r=iae(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iae(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function aae(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=oae(e,rae),i=new yl(tP(tP({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:cu}));return i}function rP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lae(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rP(Object(r),!0).forEach(function(n){sae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rP(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dN=Rr("highlight/types"),ml=dN.register,uae=dN.getItem;ml(Qh,kie);ml(Zh,Mie);ml(Rs,Lie);ml(nO,Wie);ml(rO,tae);ml(cu,aae);function sa(e,t){return uae(e)(lae({type:e},t))}function qn(e){return dae(e)||hae(e)||fae(e)||cae()}function cae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fae(e,t){if(e){if(typeof e=="string")return om(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return om(e,t)}}function hae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dae(e){if(Array.isArray(e))return om(e)}function om(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Hl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nP(Object(r),!0).forEach(function(n){vae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nP(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gae(e,t,r){return t&&oP(e.prototype,t),r&&oP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var yae=function(e){function t(r){pae(this,t),this.options=r,this.layerLevel=0,this.cell=sa(Rs,r),this.fill=sa(rO,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return gae(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===Rs&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=sa(Zh,Hl({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return qn(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=sa(cu,Hl({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return qn(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=sa(Qh,Hl({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return qn(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return qn(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(sa(nO,Hl(Hl({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),$(this.areas.values(),function(n){return void n.clear()}),$(this.headers.values(),function(n){return void n.clear()}),$(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(qn(this.areas.values()),qn(this.headers.values()),qn(this.activeHeaders.values()),qn(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const mae=yae;function bae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wae(e,t,r){return t&&iP(e.prototype,t),r&&iP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Sae=function(e){function t(r){bae(this,t),this.ranges=[],this.createCellRange=r}return wae(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Cae=Sae;function _ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Oae(e,t,r){return t&&aP(e.prototype,t),r&&aP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var vN=function(){function e(t,r){_ae(this,e),this.range=t,this.options=r}return Oae(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,c=a,f=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),g=this.options.fixedRowsBottom(),y=this.options.minSpareRows(),w=this.options.minSpareCols(),C=this.options.autoWrapRow(),_=this.options.autoWrapCol();s+r>d-1?o&&y>0&&!(g&&s>=d-g-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):_&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):_&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):C&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):C&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var I=this.options.createCellCoords(s+i.row,u+i.col);f=0,h=0,I.row<0?(f=-1,I.row=0):I.row>0&&I.row>=d&&(f=1,I.row=d-1),I.col<0?(h=-1,I.col=0):I.col>0&&I.col>=v&&(h=1,I.col=v-1),c=this.options.renderableToVisualCoords(I)}return this.runLocalHooks("afterTransformStart",c,f,h),c}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),c=u.row,f=u.col;if(c!==null&&f!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),g=v.row,y=v.col,w=this.options.createCellCoords(g+o.row,y+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();rt(vN,or);const Rae=vN;function pN(e,t){return Pae(e)||kae(e,t)||Tae(e,t)||Eae()}function Eae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tae(e,t){if(e){if(typeof e=="string")return lP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lP(e,t)}}function lP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Pae(e){if(Array.isArray(e))return e}function im(e){return im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},im(e)}var Jh=0,ed=1,gN=2,oO=3,Aae=[oO,gN],Iae=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Yv=Symbol("root"),sP=Symbol("child");function Ua(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yv;if(t!==Yv&&t!==sP)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===Yv,o=Jh;if(r){var i=e[0];if(e.length===0)o=ed;else if(n&&i instanceof yH)o=oO;else if(n&&Array.isArray(i))o=Ua(i,sP);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!Iae[s].includes(im(l))});a&&(o=gN)}}return o}function Es(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!Aae.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===oO,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],c=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof c=="string"&&(c=o(c))),at(u)&&(u=l),at(c)&&(c=s),!n){var f=l,h=s,d=u,v=c;l=Math.min(f,d),s=Math.min(h,v),u=Math.max(f,d),c=Math.max(h,v)}return[l,s,u,c]}}function $ae(e){var t=Ua(e);if(t===Jh||t===ed)return[];var r=Es(t),n=new Set;$(e,function(a){var l=r(a),s=pN(l,4),u=s[1],c=s[3],f=Math.max(u,0),h=c-f+1;$(Array.from(new Array(h),function(d,v){return f+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Vt(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Mae(e){var t=Ua(e);if(t===Jh||t===ed)return[];var r=Es(t),n=new Set;$(e,function(a){var l=r(a),s=pN(l,3),u=s[0],c=s[2],f=Math.max(u,0),h=c-f+1;$(Array.from(new Array(h),function(d,v){return f+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Vt(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Qn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}var uP;function cP(e,t){return Nae(e)||Hae(e,t)||Dae(e,t)||xae()}function xae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dae(e,t){if(e){if(typeof e=="string")return fP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fP(e,t)}}function fP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Nae(e){if(Array.isArray(e))return e}function Lae(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Bae(e,t,r){return t&&hP(e.prototype,t),r&&hP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var yN=function(){function e(t,r){var n=this;jae(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Cae(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new mae({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Rae(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Bae(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=at(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,c=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),c),(!i||i&&!a&&at(n))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Rs,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&($(this.highlight.getAreas(),function(g){return void g.clear()}),$(this.highlight.getHeaders(),function(g){return void g.clear()}),$(this.highlight.getActiveHeaders(),function(g){return void g.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(Zh,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(cu,o.highlight)){var c=this.tableProps.countRowsTranslated()===0,f=this.tableProps.countColsTranslated()===0,h=o;if((c||f)&&(h=o.clone()),c&&(h.from.row=-1),f&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=ja(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(this.tableProps.createCellCoords(o-1,i-1)),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=Ua(r);if(o===ed)return!1;if(o===Jh)throw new Error(Je(uP||(uP=Lae([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Es(o,{propToCol:function(c){return n.tableProps.propToCol(c)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var c=i(u),f=cP(c,4),h=f[0],d=f[1],v=f[2],g=f[3],y=Qn(h,a)&&Qn(d,l)&&Qn(v,a)&&Qn(g,l);return!y});return s&&(this.clear(),$(r,function(u){var c=i(u),f=cP(c,4),h=f[0],d=f[1],v=f[2],g=f[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,g)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Qn(i,l)&&Qn(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Qn(r,i)&&Qn(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();rt(yN,or);const Fae=yN;var Vae=Ae,mN=He,Wae=nn.f,Uae=Vi,dP=Pt,zae=_S,Gae=rr,Yae=RS,vP=mN("".startsWith),Kae=mN("".slice),Xae=Math.min,bN=Yae("startsWith"),qae=!bN&&!!function(){var e=Wae(String.prototype,"startsWith");return e&&!e.writable}();Vae({target:"String",proto:!0,forced:!qae&&!bN},{startsWith:function(t){var r=dP(Gae(this));zae(t);var n=Uae(Xae(arguments.length>1?arguments[1]:void 0,r.length)),o=dP(t);return vP?vP(r,o,n):Kae(r,n,n+o.length)===o}});var pP=/^(\r\n|\n\r|\r|\n)/,Qae=/^[^\t\r\n]+/,gP=/^\t/;function Zae(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(gP))e=e.replace(gP,""),r+=1,t[n][r]="";else if(e.match(pP))e=e.replace(pP,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(c){return new Array(Math.floor(c.length/2)).fill('"').join("")})}else{var u=e.match(Qae);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function ls(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function Kv(e){return rle(e)||tle(e)||ele(e)||Jae()}function Jae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ele(e,t){if(e){if(typeof e=="string")return am(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return am(e,t)}}function tle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rle(e){if(Array.isArray(e))return am(e)}function am(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lm(e){return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lm(e)}function nle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ole(e,t,r){return t&&yP(e.prototype,t),r&&yP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ile=Nc("copyable",!1),ale=function(){function e(t,r,n){nle(this,e),this.instance=t,this.tableMeta=n,this.dataSource=r,this.duckSchema=this.dataSource&&this.dataSource[0]?ms(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return ole(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=iC(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var c=l?n(o):n[o];if(Ne(c)){if(typeof c.data<"u"){var f=l?a:o;this.colToPropCache[f]=c.data,this.propToColCache.set(c.data,f)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return YH(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),lm(r)==="object"&&!Array.isArray(r)&&Ve(r,function(u,c){u===null?(s=l+c,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(c,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&fe(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(fe(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=this.instance.countSourceRows(),l=a,s=0,u=r;(typeof u!="number"||u>=a)&&(u=a),u<this.instance.countRows()&&(l=this.instance.toPhysicalRow(u));var c=this.instance.runHooks("beforeCreateRow",u,o,i);if(c===!1||l===null)return 0;for(var f=this.tableMeta.maxRows,h=this.instance.countCols(),d=[],v=function(){var y=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?y=Kt(n.getSchema()):(y=[],me(h-1,function(){return y.push(null)})):n.instance.dataType==="function"?y=n.tableMeta.dataSchema(u+s):(y={},Fh(y,n.getSchema())),d.push(y),s+=1};s<o&&a+s<f;)v();return this.instance.rowIndexMapper.insertIndexes(u,s),this.spliceData(l,0,d),this.instance.runHooks("afterCreateRow",u,s,i),this.instance.forceFullRender=!0,s}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i=this.dataSource,a=this.tableMeta.maxCols,l=r;(typeof l!="number"||l>=this.instance.countSourceCols())&&(l=this.instance.countSourceCols());var s=this.instance.runHooks("beforeCreateCol",l,n,o);if(s===!1)return 0;var u=this.instance.countSourceCols();l<this.instance.countCols()&&(u=this.instance.toPhysicalColumn(l));for(var c=this.instance.countSourceRows(),f=this.instance.countCols(),h=0,d=u;h<n&&f<a;){if(typeof l!="number"||l>=f)if(c>0)for(var v=0;v<c;v+=1)typeof i[v]>"u"&&(i[v]=[]),i[v].push(null);else i.push([null]);else for(var g=0;g<c;g++)i[g].splice(d,0,null);h+=1,d+=1,f+=1}return this.instance.columnIndexMapper.insertIndexes(l,h),this.instance.runHooks("afterCreateCol",l,h,o),this.instance.forceFullRender=!0,h}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(r)?r:-n,a=this.visualRowsToPhysical(i,n),l=this.instance.countSourceRows();i=(l+i)%l;var s=this.instance.runHooks("beforeRemoveRow",i,a.length,a,o);if(s===!1)return!1;var u=a.length;if(this.filterData(i,u,a),i<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(a);var c=fe(this.tableMeta.columns)||fe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",i,u,a,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(C,_){return _-C}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,c=l.length,f=this.dataSource,h=0;h<c;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)f[d].splice(a[0],n);else for(var g=0,y=this.instance.countSourceRows();g<y;g++)for(var w=0;w<c;w++)f[g].splice(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),c=3;c<s;c++)u[c-3]=arguments[c];VE(u,l);for(var f=0;f<o;)u.push(null),f+=1;return X4(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),c=3;c<s;c++)u[c-3]=arguments[c];VE(u,l);for(var f=0;f<o;)u.push(null),f+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(Kv(this.dataSource.slice(0,r)),Kv(o),Kv(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&it(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var c=0,f=s.length;c<f;c++)if(u=u[s[c]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=ja(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return ile.call(this.instance,r,this.propToCol(n))?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=ja(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&it(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var c=n.split("."),f=l,h=0,d;for(h=0,d=c.length-1;h<d;h++)typeof f[c[h]]>"u"&&(f[c[h]]={}),f=f[c[h]];f[c[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];var f=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(c-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(f.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return ls(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return ls(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const lle=ale;function td(e,t){var r=typeof e=="string"?GH(e):e;if(Ne(r)){var n=Ne(t),o={};return Ve(r,function(i,a){a!=="CELL_TYPE"&&(!n||n&&!it(t,a))&&(o[a]=i)}),o}}function sle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}To(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function jc(e){return Number.isInteger(e)&&e>=0}function Bc(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function qu(e){return e==null}function sm(e){return sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sm(e)}const wN=function(){return{activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),At(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),At(o)===!1)return sm(o)==="object"?(i=this.getCellMeta(t,r),wD(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function mP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function SN(e,t,r){return t&&mP(e.prototype,t),r&&mP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ule(){return SN(function e(){CN(this,e)})}var cle=function(){function e(t){CN(this,e),this.metaCtor=ule(),this.meta=this.metaCtor.prototype,ht(this.meta,wN()),this.meta.instance=t}return SN(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){ht(this.meta,r),ht(this.meta,td(r.type,r))}}]),e}();function fle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hle(e,t,r){return t&&bP(e.prototype,t),r&&bP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var dle=function(){function e(t){fle(this,e);var r=t.getMetaConstructor();this.meta=new r}return hle(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){ht(this.meta,r),ht(this.meta,td(r.type,r))}}]),e}();function wP(e){return yle(e)||gle(e)||ple(e)||vle()}function vle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ple(e,t){if(e){if(typeof e=="string")return um(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return um(e,t)}}function gle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yle(e){if(Array.isArray(e))return um(e)}function um(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ble(e,t,r){return t&&SP(e.prototype,t),r&&SP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var cm=function(e){function t(r){mle(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return ble(t,[{key:"obtain",value:function(n){Bc(function(){return jc(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Bc(function(){return jc(n)||qu(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=qu(n)?this.index.length:n;this.index=[].concat(wP(this.index.slice(0,s)),i,wP(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Bc(function(){return jc(n)||qu(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(qu(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Cr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function wle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sle(e,t,r){return t&&CP(e.prototype,t),r&&CP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Cle=["data","width"],_le=function(){function e(t){var r=this;wle(this,e),this.globalMeta=t,this.metas=new cm(function(){return r._createMeta()})}return Sle(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);ht(o,n),ht(o,td(n.type,o))}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return sle(this.globalMeta.getMetaConstructor(),Cle).prototype}}]),e}();function Ole(e){return kle(e)||Tle(e)||Ele(e)||Rle()}function Rle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ele(e,t){if(e){if(typeof e=="string")return fm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fm(e,t)}}function Tle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kle(e){if(Array.isArray(e))return fm(e)}function fm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ple(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ale(e,t,r){return t&&_P(e.prototype,t),r&&_P(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ile=function(){function e(t){var r=this;Ple(this,e),this.columnMeta=t,this.metas=new cm(function(){return r._createRow()})}return Ale(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);ht(i,o),ht(i,td(o.type,i))}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a=this.metas.obtain(r).obtain(n);a[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,Ole(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){Bc(function(){return jc(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new cm(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function $le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mle(e,t,r){return t&&OP(e.prototype,t),r&&OP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var _N=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];$le(this,e),this.hot=t,this.globalMeta=new cle(t),this.tableMeta=new dle(this.globalMeta),this.columnMeta=new _le(this.globalMeta),this.cellMeta=new Ile(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return Mle(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();rt(_N,or);function Qf(e){return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(e)}function RP(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.firstRun,c=Bn(l),f=o.getSettings();Array.isArray(f.dataSchema)?o.dataType="array":nt(f.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,u,s);var h=new lle(o,e,f);if(t(h),Qf(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var d=h.getSchema();e=[];var v,g=0,y=0;for(g=0,y=f.startRows;g<y;g++)if((o.dataType==="object"||o.dataType==="function")&&f.dataSchema)v=Kt(d),e.push(v);else if(o.dataType==="array")v=Kt(d[0]),e.push(v);else{v=[];for(var w=0,C=f.startCols;w<C;w++)v.push(null);e.push(v)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(Qf(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),f.data=e,h.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=h.colToProp.bind(h),a.propToCol=h.propToCol.bind(h),a.countCachedColumns=h.countCachedColumns.bind(h),r(h),o.runHooks("after".concat(c),e,u,s),u||(o.runHooks("afterChange",null,l),o.render())}function xle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dle(e,t,r){return t&&EP(e.prototype,t),r&&EP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Hle=function(){function e(t){var r=this;xle(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ge.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return Dle(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var c=it(r,"type")?r.type:null,f=nt(r.cells)?r.cells(o,i,u):null;if(c)if(f){var h;f.type=(h=f.type)!==null&&h!==void 0?h:c}else f={type:c};f&&this.metaManager.updateCellMeta(o,i,f),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function Nle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lle(e,t,r){return t&&TP(e.prototype,t),r&&TP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var jle=function(){function e(t){Nle(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return Lle(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,c="_".concat(u);r.metaManager.globalMeta.meta[c]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,c,l),s&&r.installPropWatcher(i,c,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),kP=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Qu=function(t){return t.map(function(r){var n=r.toLowerCase();return kP.has(n)?kP.get(n):n}).sort().join("+")},Ble=function(t){return t.split("+")},PP=function(t){return t.toLowerCase()},AP;function Fle(e){return Ule(e)||Wle(e)||ON(e)||Vle()}function Vle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ule(e){if(Array.isArray(e))return hm(e)}function zle(e,t){return Kle(e)||Yle(e,t)||ON(e,t)||Gle()}function Gle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ON(e,t){if(e){if(typeof e=="string")return hm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hm(e,t)}}function hm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Kle(e){if(Array.isArray(e))return e}function Xle(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var qle=function(t){var r=zh({errorIdExists:function(c){return'The "'.concat(c,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=c.keys,h=c.callback,d=c.group,v=c.runOnlyIf,g=v===void 0?function(){return!0}:v,y=c.captureCtrl,w=y===void 0?!1:y,C=c.preventDefault,_=C===void 0?!0:C,I=c.stopPropagation,E=I===void 0?!1:I,U=c.relativeToGroup,G=c.position;if(at(d))throw new Error("You need to define the shortcut's group.");if(nt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(f)===!1)throw new Error(Je(AP||(AP=Xle([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var Q={callback:h,group:d,runOnlyIf:g,captureCtrl:w,preventDefault:_,stopPropagation:E};if(fe(U)){var K=[U,G];Q.relativeToGroup=K[0],Q.position=K[1]}f.forEach(function(X){var J=Qu(X),le=r.hasItem(J);if(le){var ee=r.getItem(J),he=ee.findIndex(function(Ce){return Ce.group===U});he!==-1?G==="before"?he-=1:he+=1:he=ee.length,ee.splice(he,0,Q)}else r.addItem(J,[Q])})},o=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(function(h){Ve(f,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=f[v])}),n(h)})},i=function(c){var f=Qu(c);r.removeItem(f)},a=function(c){var f=r.getItems();f.forEach(function(h){var d=zle(h,2),v=d[0],g=d[1],y=g.filter(function(w){return w.group!==c});y.length===0?i(Ble(v)):(g.length=0,g.push.apply(g,Fle(y)))})},l=function(c){var f=Qu(c),h=r.getItem(f);return fe(h)?h.slice():[]},s=function(c){var f=Qu(c);return r.hasItem(f)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function Qle(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var Zle=["meta","alt","shift","control"],Zu=Qle();function Jle(e,t,r,n,o){var i=function(d){return Zle.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=[];return d.altKey&&g.push("alt"),v&&(d.ctrlKey||d.metaKey)?g.push("control/meta"):(d.ctrlKey&&g.push("control"),d.metaKey&&g.push("meta")),d.shiftKey&&g.push("shift"),g},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||Ca(d))){var g=PP(d.key),y=[];i(g)?Zu.press(g):y=a(d);var w=[g].concat(y),C=o(d,w);!C&&(YE()&&y.includes("meta")||!YE()&&y.includes("control"))&&o(d,[g].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=PP(d.key);i(v)!==!1&&Zu.release(v)}},u=function(){Zu.releaseAll()},c=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=yf(d)},f=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=yf(d)};return{mount:c,unmount:f,isPressed:function(d){return Zu.isPressed(d)}}}var ese=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=zh({errorIdExists:function(g){return'The "'.concat(g,'" context name is already registered.')}}),l="grid",s=function(g){var y=qle(g);return a.addItem(g,y),y},u=function(){return l},c=function(g){return a.getItem(g)},f=function(g){l=g},h=!1,d=Jle(r,n,o,i,function(v,g){var y=c(u()),w=!1;if(!y.hasShortcut(g))return w;for(var C=y.getShortcuts(g),_=0;_<C.length;_++){var I=C[_],E=I.callback,U=I.runOnlyIf,G=I.preventDefault,Q=I.stopPropagation,K=I.captureCtrl;if(U(v)!==!1&&(h=K,w=E(v,g)===!1,h=!1,G&&v.preventDefault(),Q&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:c,setActiveContextName:f,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},destroy:function(){return d.unmount()}}};function Zt(e){return Zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zt(e)}function Vr(e,t){return nse(e)||rse(e,t)||RN(e,t)||tse()}function tse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function nse(e){if(Array.isArray(e))return e}function Zn(e){return ase(e)||ise(e)||RN(e)||ose()}function ose(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RN(e,t){if(e){if(typeof e=="string")return dm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dm(e,t)}}function ise(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ase(e){if(Array.isArray(e))return dm(e)}function dm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lse="gridDefault",Xv=null;function iO(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new vt(a),s,u,c,f,h=!0;Dre(o)&&xre(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=sie(t.language);var g=new _N(a,t,[Hle,jle]),y=g.getTableMeta(),w=g.getGlobalMeta(),C=zh();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Dy(this)&&l5(t.licenseKey,e),this.guid="ht_".concat(TD()),this.columnIndexMapper=new em,this.rowIndexMapper=new em,u=new tne(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var _=function(m){var b=m.row,R=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,R>=0?a.columnIndexMapper.getRenderableFromVisualIndex(R):R)},I=function(m){var b=m.row,R=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,R>=0?a.columnIndexMapper.getVisualFromRenderableIndex(R):R)},E=new Fae(y,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(m){return s.propToCol(m)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(m,b){return a._createCellCoords(m,b)},createCellRange:function(m,b,R){return a._createCellRange(m,b,R)},visualToRenderableCoords:_,renderableToVisualCoords:I,isDisabledCellSelection:function(m,b){return a.getCellMeta(m,b).disableVisualSelection}});this.selection=E;var U=function(m){var b=m.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",U),this.rowIndexMapper.addLocalHook("cacheUpdated",U),this.selection.addLocalHook("beforeSetRangeStart",function(p){n.runHooks("beforeSetRangeStart",p)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(p){n.runHooks("beforeSetRangeStartOnly",p)}),this.selection.addLocalHook("beforeSetRangeEnd",function(p){n.runHooks("beforeSetRangeEnd",p),p.row<0&&(p.row=n.view._wt.wtTable.getFirstVisibleRow()),p.col<0&&(p.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(p){var m=ja(!1),b=n.selection.getSelectedRange(),R=b.current(),k=R.from,j=R.to,W=b.size()-1;n.runHooks("afterSelection",k.row,k.col,j.row,j.col,m,W),n.runHooks("afterSelectionByProp",k.row,a.colToProp(k.col),j.row,a.colToProp(j.col),m,W);var q=n.selection.isSelectedByAnyHeader(),Z=n.selection.selectedRange.current(),ne=!0;i&&(ne=!1),m.isTouched()&&(ne=!m.value);var te=n.selection.isSelectedByRowHeader(),ue=n.selection.isSelectedByColumnHeader();ne!==!1&&(q?te?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(p.row)):ue&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(p.col)):Z&&!n.selection.isMultiple()?n.view.scrollViewport(_(Z.from)):n.view.scrollViewport(_(p))),te&&ue?re(n.rootElement,["ht__selection--rows","ht__selection--columns"]):te?(De(n.rootElement,"ht__selection--columns"),re(n.rootElement,"ht__selection--rows")):ue?(De(n.rootElement,"ht__selection--rows"),re(n.rootElement,"ht__selection--columns")):De(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(p){var m=p.length-1,b=p[m],R=b.from,k=b.to;n.runHooks("afterSelectionEnd",R.row,R.col,k.row,k.col,m),n.runHooks("afterSelectionEndByProp",R.row,a.colToProp(R.col),k.row,a.colToProp(k.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",function(p){var m=n.runHooks("afterIsMultipleSelection",p.value);p.value&&(p.value=m)}),this.selection.addLocalHook("beforeModifyTransformStart",function(p){n.runHooks("modifyTransformStart",p)}),this.selection.addLocalHook("afterModifyTransformStart",function(p,m,b){n.runHooks("afterModifyTransformStart",p,m,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(p){n.runHooks("modifyTransformEnd",p)}),this.selection.addLocalHook("afterModifyTransformEnd",function(p,m,b){n.runHooks("afterModifyTransformEnd",p,m,b)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),n._refreshBorders(),De(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(p){n.alter("insert_row",p,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(p){n.alter("insert_col",p,1,"auto")}),c={alter:function(m,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,k=arguments.length>3?arguments[3]:void 0,j=arguments.length>4?arguments[4]:void 0,W,q=function(B){if(B.length===0)return[];var D=Zn(B);D.sort(function(oe,ae){var se=Vr(oe,1),Ee=se[0],$e=Vr(ae,1),ze=$e[0];return Ee===ze?0:Ee>ze?1:-1});var z=Vt(D,function(oe,ae){var se=Vr(ae,2),Ee=se[0],$e=se[1],ze=oe[oe.length-1],Me=Vr(ze,2),Oe=Me[0],qe=Me[1],ir=Oe+qe;if(Ee<=ir){var Er=Math.max($e-(ir-Ee),0);ze[1]+=Er}else oe.push([Ee,$e]);return oe},[D[0]]);return z};switch(m){case"insert_row":var Z=a.countSourceRows();if(y.maxRows===Z)return;if(b=fe(b)?b:Z,W=s.createRow(b,R,k),W){g.createRow(a.toPhysicalRow(b),R);var ne=E.selectedRange.current(),te=ne==null?void 0:ne.from,ue=te==null?void 0:te.row;if(fe(ue)&&ue>=b){var we=ne.to,F=we.row,Se=we.col,Ie=te.col;E.isSelectedByRowHeader()&&(Ie=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(a._createCellCoords(ue+W,Ie),!0),E.setRangeEnd(a._createCellCoords(F+W,Se))}else a._refreshBorders()}break;case"insert_col":if(W=s.createCol(b,R,k),W){if(g.createColumn(a.toPhysicalColumn(b),R),Array.isArray(y.colHeaders)){var Re=[b,0];Re.length+=W,Array.prototype.splice.apply(y.colHeaders,Re)}var Pe=E.selectedRange.current(),ke=Pe==null?void 0:Pe.from,S=ke==null?void 0:ke.col;if(fe(S)&&S>=b){var O=Pe.to,A=O.row,L=O.col,M=ke.row;E.isSelectedByColumnHeader()&&(M=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(a._createCellCoords(M,S+W),!0),E.setRangeEnd(a._createCellCoords(A,L+W))}else a._refreshBorders()}break;case"remove_row":var V=function(B){var D=0;$(B,function(z){var oe=Vr(z,2),ae=oe[0],se=oe[1],Ee=At(ae)?a.countRows()-1:Math.max(ae-D,0);Number.isInteger(ae)&&(ae=Math.max(ae-D,0));var $e=s.removeRow(ae,se,k);if($e){g.removeRow(a.toPhysicalRow(Ee),se);var ze=a.countRows(),Me=y.fixedRowsTop;Me>=Ee+1&&(y.fixedRowsTop-=Math.min(se,Me-Ee));var Oe=y.fixedRowsBottom;Oe&&Ee>=ze-Oe&&(y.fixedRowsBottom-=Math.min(se,Oe)),D+=se}})};Array.isArray(b)?V(q(b)):V([[b,R]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var H=function(B){var D=0;$(B,function(z){var oe=Vr(z,2),ae=oe[0],se=oe[1],Ee=At(ae)?a.countCols()-1:Math.max(ae-D,0),$e=a.toPhysicalColumn(Ee);Number.isInteger(ae)&&(ae=Math.max(ae-D,0));var ze=s.removeCol(ae,se,k);if(ze){g.removeColumn($e,se);var Me=y.fixedColumnsStart;Me>=Ee+1&&(y.fixedColumnsStart-=Math.min(se,Me-Ee)),Array.isArray(y.colHeaders)&&(typeof $e>"u"&&($e=-1),y.colHeaders.splice($e,se)),D+=se}})};Array.isArray(b)?H(q(b)):H([[b,R]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(m,'"'))}j||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var m=y.minRows,b=y.minSpareRows,R=y.minCols,k=y.minSpareCols;if(m){var j=a.countRows();j<m&&s.createRow(j,m-j,"auto")}if(b){var W=a.countEmptyRows(!0);if(W<b){var q=b-W,Z=Math.min(q,y.maxRows-a.countSourceRows());s.createRow(a.countRows(),Z,"auto")}}{var ne;(R||k)&&(ne=a.countEmptyCols(!0));var te=a.countCols();if(R&&!y.columns&&te<R){var ue=R-te;ne+=ue,s.createCol(te,ue,"auto")}if(k&&!y.columns&&a.dataType==="array"&&ne<k){te=a.countCols();var we=k-ne,F=Math.min(we,y.maxCols-te);s.createCol(te,F,"auto")}}var Se=a.countRows(),Ie=a.countCols();(Se===0||Ie===0)&&E.deselect(),E.isSelected()&&$(E.selectedRange,function(Re){var Pe=!1,ke=Re.from.row,S=Re.from.col,O=Re.to.row,A=Re.to.col;ke>Se-1?(ke=Se-1,Pe=!0,O>ke&&(O=ke)):O>Se-1&&(O=Se-1,Pe=!0,ke>O&&(ke=O)),S>Ie-1?(S=Ie-1,Pe=!0,A>S&&(A=S)):A>Ie-1&&(A=Ie-1,Pe=!0,S>A&&(S=A)),Pe&&a.selectCell(ke,S,O,A)}),a.view&&a.view.adjustElementsSize()},populateFromArray:function(m,b,R,k,j,W,q){var Z,ne,te,ue,we=[],F={},Se=[],Ie=m.row,Re=m.col;if(ne=b.length,ne===0)return!1;var Pe=0,ke=0;switch(Ne(R)&&(Pe=R.col-Re+1,ke=R.row-Ie+1),j){case"shift_down":var S=Tc(b),O=S.length,A=Math.max(O,Pe),L=a.getData().slice(Ie),M=Tc(L).slice(Re,Re+A);for(te=0;te<A;te+=1)if(te<O){for(Z=0,ne=S[te].length;Z<ke-ne;Z+=1)S[te].push(S[te][Z%ne]);te<M.length?Se.push(S[te].concat(M[te])):Se.push(S[te].concat(new Array(L.length).fill(null)))}else Se.push(S[te%O].concat(M[te]));a.populateFromArray(Ie,Re,Tc(Se));break;case"shift_right":var V=b.length,H=Math.max(V,ke),x=a.getData().slice(Ie).map(function(yu){return yu.slice(Re)});for(Z=0;Z<H;Z+=1)if(Z<V){for(te=0,ue=b[Z].length;te<Pe-ue;te+=1)b[Z].push(b[Z][te%ue]);if(Z<x.length)for(var B=0;B<x[Z].length;B+=1)b[Z].push(x[Z][B]);else{var D;(D=b[Z]).push.apply(D,Zn(new Array(x[0].length).fill(null)))}}else b.push(b[Z%ne].slice(0,H).concat(x[Z]));a.populateFromArray(Ie,Re,b);break;case"overwrite":default:F.row=m.row,F.col=m.col;var z={row:R&&m?R.row-m.row+1:1,col:R&&m?R.col-m.col+1:1},oe=0,ae=0,se=!0,Ee,$e=function(Tr){var Xi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,qi=b[Tr%b.length];return Xi!==null?qi[Xi%qi.length]:qi},ze=b.length,Me=R?R.row-m.row+1:0;for(R?ne=Me:ne=Math.max(ze,Me),Z=0;Z<ne&&!(R&&F.row>R.row&&Me>ze||!y.allowInsertRow&&F.row>a.countRows()-1||F.row>=y.maxRows);Z++){var Oe=Z-oe,qe=$e(Oe).length,ir=R?R.col-m.col+1:0;if(R?ue=ir:ue=Math.max(qe,ir),F.col=m.col,Ee=a.getCellMeta(F.row,F.col),(k==="CopyPaste.paste"||k==="Autofill.fill")&&Ee.skipRowOnPaste){oe+=1,F.row+=1,ne+=1;continue}for(ae=0,te=0;te<ue&&!(R&&F.col>R.col&&ir>qe||!y.allowInsertColumn&&F.col>a.countCols()-1||F.col>=y.maxCols);te++){if(Ee=a.getCellMeta(F.row,F.col),(k==="CopyPaste.paste"||k==="Autofill.fill")&&Ee.skipColumnOnPaste){ae+=1,F.col+=1,ue+=1;continue}if(Ee.readOnly&&k!=="UndoRedo.undo"){F.col+=1;continue}var Er=te-ae,Ot=$e(Oe,Er),st=a.getDataAtCell(F.row,F.col),Lr={row:Oe,col:Er};if(k==="Autofill.fill"){var It=a.runHooks("beforeAutofillInsidePopulate",Lr,W,b,q,{},z);It&&(Ot=at(It.value)?Ot:It.value)}if(Ot!==null&&Zt(Ot)==="object")if(Array.isArray(Ot)&&st===null&&(st=[]),st===null||Zt(st)!=="object")se=!1;else{var gt=ms(Array.isArray(st)?st:st[0]||st),Qe=ms(Array.isArray(Ot)?Ot:Ot[0]||Ot);wD(gt,Qe)?Ot=Kt(Ot):se=!1}else st!==null&&Zt(st)==="object"&&(se=!1);se&&we.push([F.row,F.col,Ot]),se=!0,F.col+=1}F.row+=1}a.setDataAtCell(we,null,null,k||"populateFromArray");break}}};function G(p){var m=oN(p);tO(m)?(a.runHooks("beforeLanguageChange",m),w.language=m,a.runHooks("afterLanguageChange",m)):iN(p)}function Q(p,m){var b=p==="className"?a.rootElement:a.table;if(h)re(b,m);else{var R=[],k=[];w[p]&&(R=Array.isArray(w[p])?w[p]:UE(w[p])),m&&(k=Array.isArray(m)?m:UE(m));var j=WE(R,k),W=WE(k,R);j.length&&De(b,j),W.length&&re(b,W)}w[p]=m}this.init=function(){u.setData(y.data),a.runHooks("beforeInit"),(Jr()||CD())&&re(a.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new zre(this),f=zX.getInstance(a,y,E),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),Zt(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function K(){var p=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,p=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&p===!1&&(p=!0,this.onQueueEmpty(this.valid))}}}function X(p){var m=p.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):p}function J(p,m,b){if(p.length){var R=a.getActiveEditor(),k=a.runHooks("beforeChange",p,m||"edit"),j=!0;if(k===!1){R&&R.cancelChanges();return}var W=new K;W.onQueueEmpty=function(Se){R&&j&&R.cancelChanges(),b(Se)};for(var q=p.length-1;q>=0;q--)if(p[q]===null)p.splice(q,1);else{var Z=Vr(p[q],4),ne=Z[0],te=Z[1],ue=Z[3],we=s.propToCol(te),F=a.getCellMeta(ne,we);F.type==="numeric"&&typeof ue=="string"&&cq(ue)&&(p[q][3]=X(ue)),a.getCellValidator(F)&&(W.addValidatorToQueue(),a.validateCell(p[q][3],F,function(Se,Ie){return function(Re){if(typeof Re!="boolean")throw new Error("Validation error: result is not boolean");if(Re===!1&&Ie.allowInvalid===!1){j=!1,p.splice(Se,1),Ie.valid=!0;var Pe=a.getCell(Ie.visualRow,Ie.visualCol);Pe!==null&&De(Pe,y.invalidCellClassName)}W.removeValidatorFormQueue()}}(q,F),m))}W.checkIfQueueIsEmpty()}}function le(p,m){var b=p.length-1;if(!(b<0)){for(;b>=0;b--){var R=!1;if(p[b]===null){p.splice(b,1);continue}if(!((p[b][2]===null||p[b][2]===void 0)&&(p[b][3]===null||p[b][3]===void 0))){if(y.allowInsertRow)for(;p[b][0]>a.countRows()-1;){var k=s.createRow(void 0,void 0,m);if(k>=1)g.createRow(null,k);else{R=!0;break}}if(a.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;s.propToCol(p[b][1])>a.countCols()-1;){var j=s.createCol(void 0,void 0,m);if(j>=1)g.createColumn(null,j);else{R=!0;break}}R||s.set(p[b][0],p[b][1],p[b][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",p,m),f.lockEditor(),a._refreshBorders(null),f.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",p,m||"edit");var W=a.getActiveEditor();W&&fe(W.refreshValue)&&W.refreshValue()}}this._createCellCoords=function(p,m){return a.view._wt.createCellCoords(p,m)},this._createCellRange=function(p,m,b){return a.view._wt.createCellRange(p,m,b)},this.validateCell=function(p,m,b,R){var k=a.getCellValidator(m);function j(W){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!q||m.hidden===!0){b(W);return}var Z=m.visualCol,ne=m.visualRow,te=a.getCell(ne,Z,!0);if(te&&te.nodeName!=="TH"){var ue=a.rowIndexMapper.getRenderableFromVisualIndex(ne),we=a.columnIndexMapper.getRenderableFromVisualIndex(Z);a.view._wt.getSetting("cellRenderer",ue,we,te)}b(W)}o5(k)&&(k=function(W){return function(q,Z){Z(W.test(q))}}(k)),nt(k)?(p=a.runHooks("beforeValidate",p,m.visualRow,m.prop,R),a._registerImmediate(function(){k.call(m,p,function(W){a&&(W=a.runHooks("afterValidate",W,p,m.visualRow,m.prop,R),m.valid=W,j(W),a.runHooks("postAfterValidate",W,p,m.visualRow,m.prop,R))})})):a._registerImmediate(function(){m.valid=!0,j(m.valid,!1)})};function ee(p,m,b){return Array.isArray(p)?p:[[p,m,b]]}this.setDataAtCell=function(p,m,b,R){var k=ee(p,m,b),j=[],W=R,q,Z,ne;for(q=0,Z=k.length;q<Z;q++){if(Zt(k[q])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof k[q][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");k[q][1]>=this.countCols()?ne=k[q][1]:ne=s.colToProp(k[q][1]),j.push([k[q][0],ne,u.getAtCell(this.toPhysicalRow(k[q][0]),k[q][1]),k[q][2]])}!W&&Zt(p)==="object"&&(W=m),a.runHooks("afterSetDataAtCell",j,W),J(j,W,function(){le(j,W)})},this.setDataAtRowProp=function(p,m,b,R){var k=ee(p,m,b),j=[],W=R,q,Z;for(q=0,Z=k.length;q<Z;q++)j.push([k[q][0],k[q][1],u.getAtCell(this.toPhysicalRow(k[q][0]),k[q][1]),k[q][2]]);!W&&Zt(p)==="object"&&(W=m),a.runHooks("afterSetDataAtRowProp",j,W),J(j,W,function(){le(j,W)})},this.listen=function(){a&&!a.isListening()&&(Xv=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Xv=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return Xv===a.guid},this.destroyEditor=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(p,m)},this.populateFromArray=function(p,m,b,R,k,j,W,q,Z){if(!(Zt(b)==="object"&&Zt(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var ne=typeof R=="number"?a._createCellCoords(R,k):null;return c.populateFromArray(a._createCellCoords(p,m),b,ne,j,W,q,Z)},this.spliceCol=function(p,m,b){for(var R,k=arguments.length,j=new Array(k>3?k-3:0),W=3;W<k;W++)j[W-3]=arguments[W];return(R=s).spliceCol.apply(R,[p,m,b].concat(j))},this.spliceRow=function(p,m,b){for(var R,k=arguments.length,j=new Array(k>3?k-3:0),W=3;W<k;W++)j[W-3]=arguments[W];return(R=s).spliceRow.apply(R,[p,m,b].concat(j))},this.getSelected=function(){if(E.isSelected())return Fe(E.getSelectedRange(),function(p){var m=p.from,b=p.to;return[m.row,m.col,b.row,b.col]})},this.getSelectedLast=function(){var p=this.getSelected(),m;return p&&p.length>0&&(m=p[p.length-1]),m},this.getSelectedRange=function(){if(E.isSelected())return Array.from(E.getSelectedRange())},this.getSelectedRangeLast=function(){var p=this.getSelectedRange(),m;return p&&p.length>0&&(m=p[p.length-1]),m},this.emptySelectedCells=function(p){var m=this;if(!(!E.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];$(E.getSelectedRange(),function(R){var k=R.getTopStartCorner(),j=R.getBottomEndCorner();me(k.row,j.row,function(W){me(k.col,j.col,function(q){m.getCellMeta(W,q).readOnly||b.push([W,q,null])})})}),b.length>0&&this.setDataAtCell(b,p)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var p=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(p,0),!this.isRenderSuspended()&&p===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(p){this.suspendRender();var m=p();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||p)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(p){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=p();return this.resumeExecution(m),b},this.batch=function(p){this.suspendRender(),this.suspendExecution();var m=p();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(a.view){var p=a.view.getLastSize(),m=p.width,b=p.height,R=a.rootElement.getBoundingClientRect(),k=R.width,j=R.height,W=k!==m||j!==b,q=a.runHooks("beforeRefreshDimensions",{width:m,height:b},{width:k,height:j},W)===!1;q||((W||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(k,j),a.render()),a.runHooks("afterRefreshDimensions",{width:m,height:b},{width:k,height:j},W))}},this.updateData=function(p,m){var b=this;RP(p,function(R){s=R},function(R){s=R,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:m,firstRun:h})},this.loadData=function(p,m){RP(p,function(b){s=b},function(){g.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:m,firstRun:h})},this.getInitialColumnCount=function(){var p=y.columns,m=0;if(Array.isArray(p))m=p.length;else if(nt(p))if(a.dataType==="array")for(var b=this.countSourceCols(),R=0;R<b;R+=1)p(R)&&(m+=1);else(a.dataType==="object"||a.dataType==="function")&&(m=s.colToPropCache.length);else if(fe(y.dataSchema)){var k=s.getSchema();m=Array.isArray(k)?k.length:iC(k)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(p,m,b,R){return at(p)?s.getAll():s.getRange(a._createCellCoords(p,m),a._createCellCoords(b,R),s.DESTINATION_RENDERER)},this.getCopyableText=function(p,m,b,R){return s.getCopyableText(a._createCellCoords(p,m),a._createCellCoords(b,R))},this.getCopyableData=function(p,m){return s.getCopyable(p,s.colToProp(m))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(p){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),R=!1,k,j;if(fe(p.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(fe(p.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(fe(p.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(k in p)k==="data"||(k==="language"?G(p.language):k==="className"?Q("className",p.className):k==="tableClassName"&&a.table?(Q("tableClassName",p.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(k)||ge.getSingleton().isDeprecated(k)?(nt(p[k])||Array.isArray(p[k]))&&(p[k].initialHook=!0,a.addHook(k,p[k])):!m&&it(p,k)&&(w[k]=p[k]));p.data===void 0&&y.data===void 0?b(null,"updateSettings"):p.data!==void 0?b(p.data,"updateSettings"):p.columns!==void 0&&(s.createMap(),a.initIndexMappers());var W=a.countCols(),q=y.columns;if(q&&nt(q)&&(R=!0),(p.cell!==void 0||p.cells!==void 0||p.columns!==void 0)&&g.clearCache(),W>0)for(k=0,j=0;k<W;k++){if(q){var Z=R?q(k):q[j];Z&&g.updateColumnMeta(j,Z)}j+=1}fe(p.cell)&&Ve(p.cell,function(Se){a.setCellMetaObject(Se.row,Se.col,Se)}),a.runHooks("afterCellMetaReset");var ne=a.rootElement.style.height;ne!==""&&(ne=parseInt(a.rootElement.style.height,10));var te=p.height;if(nt(te)&&(te=te()),m){var ue=a.rootElement.getAttribute("style");ue&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(te===null){var we=a.rootElement.getAttribute("data-initialstyle");we&&(we.indexOf("height")>-1||we.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",we):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else te!==void 0&&(a.rootElement.style.height=isNaN(te)?"".concat(te):"".concat(te,"px"),a.rootElement.style.overflow="hidden");if(typeof p.width<"u"){var F=p.width;nt(F)&&(F=F()),a.rootElement.style.width=isNaN(F)?"".concat(F):"".concat(F,"px")}m||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",p)),c.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,f.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!m&&a.view&&(ne===""||te===""||te===void 0)&&ne!==te&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var p=a.getSelectedLast();if(y.getValue){if(nt(y.getValue))return y.getValue.call(a);if(p)return a.getData()[p[0][0]][y.getValue]}else if(p)return a.getDataAtCell(p[0],p[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(p,m,b,R,k){c.alter(p,m,b,R,k)},this.getCell=function(p,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=m,k=p;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;R=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(p>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(p)))return null;k=this.rowIndexMapper.getRenderableFromVisualIndex(p)}return k===null||R===null?null:a.view.getCellAtCoords(a._createCellCoords(k,R),b)},this.getCoords=function(p){var m=this.view._wt.wtTable.getCoords(p);if(m===null)return null;var b=m.row,R=m.col,k=b,j=R;return b>=0&&(k=this.rowIndexMapper.getVisualFromRenderableIndex(b)),R>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(R)),a._createCellCoords(k,j)},this.colToProp=function(p){return s.colToProp(p)},this.propToCol=function(p){return s.propToCol(p)},this.toVisualRow=function(p){return n.rowIndexMapper.getVisualFromPhysicalIndex(p)},this.toVisualColumn=function(p){return n.columnIndexMapper.getVisualFromPhysicalIndex(p)},this.toPhysicalRow=function(p){return n.rowIndexMapper.getPhysicalFromVisualIndex(p)},this.toPhysicalColumn=function(p){return n.columnIndexMapper.getPhysicalFromVisualIndex(p)},this.getDataAtCell=function(p,m){return s.get(p,s.colToProp(m))},this.getDataAtRowProp=function(p,m){return s.get(p,m)},this.getDataAtCol=function(p){var m;return(m=[]).concat.apply(m,Zn(s.getRange(a._createCellCoords(0,p),a._createCellCoords(y.data.length-1,p),s.DESTINATION_RENDERER)))},this.getDataAtProp=function(p){var m,b=s.getRange(a._createCellCoords(0,s.propToCol(p)),a._createCellCoords(y.data.length-1,s.propToCol(p)),s.DESTINATION_RENDERER);return(m=[]).concat.apply(m,Zn(b))},this.getSourceData=function(p,m,b,R){var k;return p===void 0?k=u.getData():k=u.getByRange(a._createCellCoords(p,m),a._createCellCoords(b,R)),k},this.getSourceDataArray=function(p,m,b,R){var k;return p===void 0?k=u.getData(!0):k=u.getByRange(a._createCellCoords(p,m),a._createCellCoords(b,R),!0),k},this.getSourceDataAtCol=function(p){return u.getAtColumn(p)},this.setSourceDataAtCell=function(p,m,b,R){var k=ee(p,m,b),j=this.hasHook("afterSetSourceDataAtCell"),W=[];j&&$(k,function(Z){var ne=Vr(Z,3),te=ne[0],ue=ne[1],we=ne[2];W.push([te,ue,u.getAtCell(te,ue),we])}),$(k,function(Z){var ne=Vr(Z,3),te=ne[0],ue=ne[1],we=ne[2];u.setAtCell(te,ue,we)}),j&&this.runHooks("afterSetSourceDataAtCell",W,R),this.render();var q=a.getActiveEditor();q&&fe(q.refreshValue)&&q.refreshValue()},this.getSourceDataAtRow=function(p){return u.getAtRow(p)},this.getSourceDataAtCell=function(p,m){return u.getAtCell(p,m)},this.getDataAtRow=function(p){var m=s.getRange(a._createCellCoords(p,0),a._createCellCoords(p,this.countCols()-1),s.DESTINATION_RENDERER);return m[0]||[]},this.getDataType=function(p,m,b,R){var k=this,j=p===void 0?[0,0,this.countRows(),this.countCols()]:[p,m,b,R],W=j[0],q=j[1],Z=j[2],ne=j[3],te=null,ue=null;Z===void 0&&(Z=W),ne===void 0&&(ne=q);var we="mixed";return me(Math.max(Math.min(W,Z),0),Math.max(W,Z),function(F){var Se=!0;return me(Math.max(Math.min(q,ne),0),Math.max(q,ne),function(Ie){var Re=k.getCellMeta(F,Ie);return ue=Re.type,te?Se=te===ue:te=ue,Se}),we=Se?ue:"mixed",Se}),we},this.removeCellMeta=function(p,m,b){var R=[this.toPhysicalRow(p),this.toPhysicalColumn(m)],k=R[0],j=R[1],W=g.getCellMetaKeyValue(k,j,b),q=a.runHooks("beforeRemoveCellMeta",p,m,b,W);q!==!1&&(g.removeCellMeta(k,j,b),a.runHooks("afterRemoveCellMeta",p,m,b,W)),W=null},this.spliceCellsMeta=function(p){for(var m=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,R=arguments.length,k=new Array(R>2?R-2:0),j=2;j<R;j++)k[j-2]=arguments[j];if(k.length>0&&!Array.isArray(k[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&g.removeRow(this.toPhysicalRow(p),b),k.length>0&&$(k.reverse(),function(W){g.createRow(m.toPhysicalRow(p)),$(W,function(q,Z){return m.setCellMetaObject(p,Z,q)})}),a.render()},this.setCellMetaObject=function(p,m,b){var R=this;Zt(b)==="object"&&Ve(b,function(k,j){R.setCellMeta(p,m,j,k)})},this.setCellMeta=function(p,m,b,R){var k=a.runHooks("beforeSetCellMeta",p,m,b,R);if(k!==!1){var j=p,W=m;p<this.countRows()&&(j=this.toPhysicalRow(p)),m<this.countCols()&&(W=this.toPhysicalColumn(m)),g.setCellMeta(j,W,b,R),a.runHooks("afterSetCellMeta",p,m,b,R)}},this.getCellsMeta=function(){return g.getCellsMeta()},this.getCellMeta=function(p,m){var b=this.toPhysicalRow(p),R=this.toPhysicalColumn(m);return b===null&&(b=p),R===null&&(R=m),g.getCellMeta(b,R,{visualRow:p,visualColumn:m})},this.getCellMetaAtRow=function(p){return g.getCellsMetaAtRow(p)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||y.columns)};var he=Nc("renderer");this.getCellRenderer=function(p,m){return gq(he.call(this,p,m))},this.getCellEditor=Nc("editor");var Ce=Nc("validator");this.getCellValidator=function(p,m){var b=Ce.call(this,p,m);return typeof b=="string"&&(b=vQ(b)),b},this.validateCells=function(p){this._validateCells(p)},this.validateRows=function(p,m){if(!Array.isArray(p))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,p)},this.validateColumns=function(p,m){if(!Array.isArray(p))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,p)},this._validateCells=function(p,m,b){var R=new K;p&&(R.onQueueEmpty=p);for(var k=a.countRows()-1;k>=0;){if(m!==void 0&&m.indexOf(k)===-1){k-=1;continue}for(var j=a.countCols()-1;j>=0;){if(b!==void 0&&b.indexOf(j)===-1){j-=1;continue}R.addValidatorToQueue(),a.validateCell(a.getDataAtCell(k,j),a.getCellMeta(k,j),function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&(R.valid=!1),R.removeValidatorFormQueue()},"validateCells"),j-=1}k-=1}R.checkIfQueueIsEmpty()},this.getRowHeader=function(p){var m=y.rowHeaders,b=p;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(m=[],me(a.countRows()-1,function(R){m.push(a.getRowHeader(R))})):Array.isArray(m)&&m[b]!==void 0?m=m[b]:nt(m)?m=m(b):m&&typeof m!="string"&&typeof m!="number"&&(m=b+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(var p=0,m=a.countCols();p<m;p++)if(a.getColHeader(p))return!0;return!1},this.getColHeader=function(p){var m=a.runHooks("modifyColHeader",p),b=y.colHeaders;if(m===void 0){for(var R=[],k=a.countCols(),j=0;j<k;j++)R.push(a.getColHeader(j));b=R}else{var W=function(te){for(var ue=[],we=a.countCols(),F=0;F<we;F++)nt(y.columns)&&y.columns(F)&&ue.push(F);return ue[te]},q=a.toPhysicalColumn(m),Z=W(q);y.colHeaders===!1?b=null:y.columns&&nt(y.columns)&&y.columns(Z)&&y.columns(Z).title?b=y.columns(Z).title:y.columns&&y.columns[q]&&y.columns[q].title?b=y.columns[q].title:Array.isArray(y.colHeaders)&&y.colHeaders[q]!==void 0?b=y.colHeaders[q]:nt(y.colHeaders)?b=y.colHeaders(q):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(b=Xre(m))}return b},this._getColWidthFromSettings=function(p){var m;if(p>=0){var b=a.getCellMeta(0,p);m=b.width}if((m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(Zt(m)){case"object":m=m[p];break;case"function":m=m(p);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(p){var m=a._getColWidthFromSettings(p);return m=a.runHooks("modifyColWidth",m,p),m===void 0&&(m=SC.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(p){var m=y.rowHeights;if(m!=null){switch(Zt(m)){case"object":m=m[p];break;case"function":m=m(p);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(p){var m=a._getRowHeightFromSettings(p);return m=a.runHooks("modifyRowHeight",m,p),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var p=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(p,m)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Dg(a.countRows()-1,function(b){if(a.isEmptyRow(b))m+=1;else if(p===!0)return!1}),m},this.countEmptyCols=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(a.countRows()<1)return 0;var m=0;return Dg(a.countCols()-1,function(b){if(a.isEmptyCol(b))m+=1;else if(p===!0)return!1}),m},this.isEmptyRow=function(p){return y.isEmptyRow.call(a,p)},this.isEmptyCol=function(p){return y.isEmptyCol.call(a,p)},this.selectCell=function(p,m,b,R){var k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return at(p)||at(m)?!1:this.selectCells([[p,m,b,R]],k,j)},this.selectCells=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(i=!0);var R=E.selectCells(p);return R&&b&&a.listen(),i=!1,R},this.selectColumns=function(p){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p;return E.selectColumns(p,m)},this.selectRows=function(p){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p;return E.selectRows(p,m)},this.deselectCell=function(){E.deselect()},this.selectAll=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=p&&this.hasRowHeaders(),b=p&&this.hasColHeaders();i=!0,E.selectAll(m,b),i=!1};var _e=function(m,b){return m.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(p,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=!b,W=!R,q=p,Z=m;if(k){var ne=Number.isInteger(p),te=Number.isInteger(m),ue=ne?_e(this.rowIndexMapper,p):void 0,we=te?_e(this.columnIndexMapper,m):void 0;if(ue===null||we===null)return!1;q=ne?a.rowIndexMapper.getRenderableFromVisualIndex(ue):void 0,Z=te?a.columnIndexMapper.getRenderableFromVisualIndex(we):void 0}var F=Number.isInteger(q),Se=Number.isInteger(Z);return F&&Se?a.view.scrollViewport(a._createCellCoords(q,Z),j,R,b,W):F&&Se===!1?a.view.scrollViewportVertically(q,j,b):Se&&F===!1?a.view.scrollViewportHorizontally(Z,R,W):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),g.clearCache(),Dy(a)){var p=this.rootDocument.querySelector("#hot-display-license-info");p&&p.parentNode.removeChild(p)}Hr(a.rootElement),l.destroy(),f&&f.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),C.getItems().forEach(function(m){var b=Vr(m,2),R=b[1];R.destroy()}),C.clear(),a.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(a),Ve(a,function(m,b,R){nt(m)?R[b]=be(b):b!=="guid"&&(R[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),a.rowIndexMapper=null,a.columnIndexMapper=null,s=null,c=null,E=null,f=null,a=null};function be(p){return function(){throw new Error('The "'.concat(p,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(p){var m=Bn(p);return m==="UndoRedo"?this.undoRedo:C.getItem(m)},this.getPluginName=function(p){return p===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(p)},this.getInstance=function(){return a},this.addHook=function(p,m){ge.getSingleton().add(p,m,a)},this.hasHook=function(p){return ge.getSingleton().has(p,a)||ge.getSingleton().has(p)},this.addHookOnce=function(p,m){ge.getSingleton().once(p,m,a)},this.removeHook=function(p,m){ge.getSingleton().remove(p,m,a)},this.runHooks=function(p,m,b,R,k,j,W){return ge.getSingleton().run(a,p,m,b,R,k,j,W)},this.getTranslatedPhrase=function(p,m){return fN(y.language,p,m)},this.toHTML=function(){return ok(n)},this.toTableElement=function(){var p=n.rootDocument.createElement("div");return p.insertAdjacentHTML("afterbegin",ok(n)),p.firstElementChild},this.timeouts=[],this._registerTimeout=function(p){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=p;typeof b=="function"&&(b=setTimeout(b,m)),this.timeouts.push(b)},this._clearTimeouts=function(){$(this.timeouts,function(p){clearTimeout(p)})},this.immediates=[],this._registerImmediate=function(p){this.immediates.push(setImmediate(p))},this._clearImmediates=function(){$(this.immediates,function(p){clearImmediate(p)})},this._refreshBorders=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(p),a.view.render(),m&&E.isSelected()&&f.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var P=ese({handleEvent:function(m){var b=a.isListening(),R=(m==null?void 0:m.key)!==void 0;return b&&R},beforeKeyDown:function(m){return n.runHooks("beforeKeyDown",m)},afterKeyDown:function(m){n.isDestroyed||a.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.getShortcutManager=function(){return P};var T=P.addContext("grid"),Y={runOnlyIf:function(){return fe(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:lse};P.setActiveContextName("grid"),T.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var m=a.getSelectedRange(),b=m[m.length-1].highlight,R=b.row,k=b.col,j=a.getDataAtCell(R,k),W=new Map,q=0;q<m.length;q++)m[q].forAll(function(Z,ne){if(Z>=0&&ne>=0&&(Z!==R||ne!==k)){var te=a.getCellMeta(Z,ne),ue=te.readOnly;ue||W.set("".concat(Z,"x").concat(ne),[Z,ne,j])}});a.setDataAtCell(Array.from(W.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){E.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){E.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,R=m.to,k=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);E.setRangeStart(b.clone()),E.setRangeEnd(a._createCellCoords(k,R.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){E.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){E.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,R=m.to,k=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);E.setRangeStart(b.clone()),E.setRangeEnd(a._createCellCoords(k,R.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){E.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,R=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,Zn(a.isRtl()?[a.countCols()-1,-1]:[0,1]));E.setRangeStart(a._createCellCoords(b,R))}},{keys:[["ArrowLeft","Shift"]],callback:function(){E.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),R=b.from,k=b.to,j=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,Zn(a.isRtl()?[a.countCols()-1,-1]:[0,1]));E.setRangeStart(R.clone()),E.setRangeEnd(a._createCellCoords(k.row,j))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){E.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,R=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,Zn(a.isRtl()?[0,1]:[a.countCols()-1,-1]));E.setRangeStart(a._createCellCoords(b,R))}},{keys:[["ArrowRight","Shift"]],callback:function(){E.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),R=b.from,k=b.to,j=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,Zn(a.isRtl()?[0,1]:[a.countCols()-1,-1]));E.setRangeStart(R.clone()),E.setRangeEnd(a._createCellCoords(k.row,j))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,R=a.columnIndexMapper.getNearestNotHiddenIndex(m,1);E.setRangeStart(a._createCellCoords(b,R))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){E.setRangeEnd(a._createCellCoords(E.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),R=a.rowIndexMapper.getNearestNotHiddenIndex(m,1),k=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);E.setRangeStart(a._createCellCoords(R,k))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){E.setRangeEnd(a._createCellCoords(E.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-m-1,-1),R=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);E.setRangeStart(a._createCellCoords(b,R))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){E.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,R=Math.max(b.row-a.countVisibleRows(),0),k=a.rowIndexMapper.getNearestNotHiddenIndex(R,1);if(k!==null){var j=a._createCellCoords(k,b.col),W=b.row-a.view.getFirstFullyVisibleRow(),q=Math.max(j.row-W,0);E.setRangeEnd(j),a.scrollViewportTo(q)}}},{keys:[["PageDown"]],callback:function(){E.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,R=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),k=a.rowIndexMapper.getNearestNotHiddenIndex(R,-1);if(k!==null){var j=a._createCellCoords(k,b.col),W=b.row-a.view.getFirstFullyVisibleRow(),q=Math.min(j.row-W,a.countRows()-1);E.setRangeEnd(j),a.scrollViewportTo(q)}}},{keys:[["Tab"]],callback:function(m){var b=typeof y.tabMoves=="function"?y.tabMoves(m):y.tabMoves;E.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(m){var b=typeof y.tabMoves=="function"?y.tabMoves(m):y.tabMoves;E.transformStart(-b.row,-b.col)}}],Y),hH().forEach(function(p){var m=wC(p);C.addItem(p,new m(n))}),ge.getSingleton().run(a,"construct")}var sse="hooksRefRegisterer",EN={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;$(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;Ve(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Gn(EN,"MIXIN_NAME",sse,{writable:!1,enumerable:!1});const use=EN;function vm(e){return vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vm(e)}function cse(e,t){return vse(e)||dse(e,t)||hse(e,t)||fse()}function fse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hse(e,t){if(e){if(typeof e=="string")return IP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IP(e,t)}}function IP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function vse(e){if(Array.isArray(e))return e}function pse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pm(e,t)}function pm(e,t){return pm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pm(e,t)}function gse(e){var t=bse();return function(){var n=Zf(e),o;if(t){var i=Zf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yse(this,o)}}function yse(e,t){if(t&&(vm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mse(e)}function mse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zf(e){return Zf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zf(e)}function $P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xP(e,t,r){return t&&MP(e.prototype,t),r&&MP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var wse="base",Mt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),gm="baseEditor",bl=function(){function e(t){$P(this,e),this.hot=t,this.instance=t,this.state=Mt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return xP(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=Mt.VIRGIN}},{key:"extend",value:function(){return function(r){pse(o,r);var n=gse(o);function o(){return $P(this,o),n.apply(this,arguments)}return xP(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var c=[this.row,this.col,null,null];i=c[0],a=c[1],l=c[2],s=c[3]}var f=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(f)){var h=cse(f,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),g={runOnlyIf:function(){return fe(o.hot.getSelected())},group:gm};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],g),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===Mt.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=Mt.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:wt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(f){l&&l(f),o(f),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(gm),u.removeShortcutsByGroup(Uh),this.state===Mt.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===Mt.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var c=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof c=="string"?String.prototype.trim.call(c||""):c]]:a=[[c]],this.state=Mt.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(f){i.state=Mt.FINISHED,i.discardEditor(f)}):(this.state=Mt.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Mt.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===Mt.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Mt.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Mt.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Mt.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Tt(n),u=Ze(n),c=Tt(this.hot.rootElement),f=Ze(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,g=d!==l?d.scrollLeft:0,y=l.innerWidth-c.left-f,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,C=w.wtTable,_=C.name,I=["master","inline_start"].includes(_)?v:0,E=["master","top","bottom"].includes(_)?g:0,U=s.top===c.top?0:1,G=s.top-c.top-U-I,Q=0;this.hot.isRtl()?Q=l.innerWidth-s.left-u-y-1+E:Q=s.left-c.left-1-E,["top","top_inline_start_corner"].includes(_)&&(G+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(_)&&(Q+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var K=this.hot.hasColHeaders(),X=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),J=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),le=this.hot.rowIndexMapper.getRenderableIndexesLength(),ee=le-this.hot.view._wt.getSetting("fixedRowsBottom");(K&&X<=0||X===ee)&&(G+=1),J<=0&&(Q+=1);var he=a.rowsRenderCalculator.startPosition,Ce=a.columnsRenderCalculator.startPosition,_e=Math.abs(i.inlineStartOverlay.getScrollPosition()),be=i.topOverlay.getScrollPosition(),P=Ht(this.hot.rootDocument),T=n.offsetTop+he-be,Y=0;if(this.hot.isRtl()){var p=n.offsetLeft;p>=0?Y=C.getWidth()-n.offsetLeft:Y=Math.abs(p),Y+=Ce-_e-u}else Y=n.offsetLeft+Ce-_e;var m=ki(this.TD,this.hot.rootWindow),b=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",R=parseInt(m[b],10)>0?0:1,k=parseInt(m.borderTopWidth,10)>0?0:1,j=Ze(n)+R,W=dt(n)+k,q=w5(h)?P:0,Z=S5(d)?P:0,ne=this.hot.view.maximumVisibleElementWidth(Y)-q+R,te=Math.max(this.hot.view.maximumVisibleElementHeight(T)-Z+k,23);return{top:G,start:Q,height:W,maxHeight:te,width:j,maxWidth:ne}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return wse}}]),e}();rt(bl,use);function Sse(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,g){d.addEventListener(v,g,!1)},a=function(d,v,g){d.removeEventListener(v,g,!1)},l=function(d){var v,g;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.fontSize=f(t).fontSize,o.style.fontFamily=f(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",g=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>g?t.style.height=e.minHeight+"px":e.maxHeight<g?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=g+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var g=parseInt(d.maxHeight);isNaN(g)||(e.maxHeight=g)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var y=parseInt(d.minWidth);isNaN(y)||(e.minWidth=y)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},c=function(d,v,g){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),g&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function f(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,g){c(d,v,g)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function DP(e,t){for(var r=ID(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}Vh(t,o)}function ym(e){return ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ym(e)}function HP(e,t){return Rse(e)||Ose(e,t)||_se(e,t)||Cse()}function Cse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _se(e,t){if(e){if(typeof e=="string")return NP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NP(e,t)}}function NP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ose(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Rse(e){if(Array.isArray(e))return e}function Ese(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Tse(e,t,r){return t&&LP(e.prototype,t),r&&LP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ss(){return typeof Reflect<"u"&&Reflect.get?ss=Reflect.get.bind():ss=function(t,r,n){var o=kse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ss.apply(this,arguments)}function kse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Di(e),e!==null););return e}function Pse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mm(e,t)}function mm(e,t){return mm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mm(e,t)}function Ase(e){var t=$se();return function(){var n=Di(e),o;if(t){var i=Di(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ise(this,o)}}function Ise(e,t){if(t&&(ym(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TN(e)}function TN(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $se(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Di(e){return Di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Di(e)}var Mse="ht_editor_visible",Ju="ht_editor_hidden",jP="textEditor",xse="text",Yi=function(e){Pse(r,e);var t=Ase(r);function r(n){var o;return Ese(this,r),o=t.call(this,n),o.eventManager=new vt(TN(o)),o.autoResize=Sse(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return Tse(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var c=this.state;if(ss(Di(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var f=u.allowInvalid,h=u.fragmentSelection;f&&(this.TEXTAREA.value=""),c!==Mt.FINISHED&&this.hideEditableElement();var d=!h;d&&!Jr()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===Mt.VIRGIN&&(this.TEXTAREA.value="",ss(Di(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),Vh(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),re(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&De(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,Ju),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(o6()||n6())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",De(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,Ju)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;me(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,Ju)&&De(this.TEXTAREA_PARENT,Ju),i?(this.layerClass=Mse,re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),re(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Mt.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,c=i.height,f=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=ki(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=ki(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),g=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),y=s-v,w=c-g,C=u-v,_=f-g;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(y,C),minHeight:Math.min(w,_),maxWidth:C,maxHeight:_},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),SD()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return fe(o.hot.getSelected())},group:jP},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(c){var f=o.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(c){var f=o.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(c){return!o.hot.selection.isMultiple()&&!c.altKey},relativeToGroup:ns,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:ns,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:ns,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(c,f){var h=HP(f,1),d=h[0];DP(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(c,f){var h=HP(f,1),d=h[0];DP(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Uh),i.removeShortcutsByGroup(jP),i.removeShortcutsByGroup(gm)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[ye.ARROW_UP,ye.ARROW_RIGHT,ye.ARROW_DOWN,ye.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return xse}}]),r}(bl),Dse="text",kN={CELL_TYPE:Dse,editor:Yi,renderer:ko};Xr(kN);Ue.editors={BaseEditor:bl};function Ue(e,t){var r=new iO(e,t||{},$C);return r.init(),r}Ue.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new iO(e,t,$C)};Ue.DefaultSettings=wN();Ue.hooks=ge.getSingleton();Ue.packageName="handsontable";Ue.buildDate="22/09/2022 09:54:36";Ue.version="12.1.3";Ue.languages={dictionaryKeys:eie,getLanguageDictionary:cN,getLanguagesDictionaries:aie,registerLanguageDictionary:uN,getTranslatedPhrase:fN};function BP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Hse(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BP(Object(r),!0).forEach(function(n){Nse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BP(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ts(e){return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function za(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ga(e,t,r){return t&&FP(e.prototype,t),r&&FP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nse(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ks(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bm(e,t)}function Jf(e){return Jf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jf(e)}function bm(e,t){return bm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bm(e,t)}function Lse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ps(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jse(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ps(e)}function As(e){var t=Lse();return function(){var n=Jf(e),o;if(t){var i=Jf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jse(this,o)}}var qv=null,Bse="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",Fse="The Handsontable instance bound to this component was destroyed and cannot be used properly.",eh="global",PN="hot-wrapper-editor-container";function Vse(){if(typeof console<"u"){var e;(e=console).warn.apply(e,arguments)}}function wm(e,t){var r=Et.Children.toArray(e),n=Et.Children.count(e),o=null;return n!==0&&(n===1&&r[0].props[t]?o=r[0]:o=r.find(function(i){return i.props[t]!==void 0})),o||null}function AN(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function Qv(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;e.querySelectorAll('[class^="'.concat(PN,'"]')).forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)})}function IN(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;if(t!==null){var r=e.createElement("DIV"),n=$N(t.props,!1),o=n.id,i=n.className,a=n.style;return o&&(r.id=o),r.className=[PN,i].join(" "),a&&Object.assign(r.style,a),e.body.appendChild(r),mM.createPortal(t,r)}}function Sm(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:eh,n=wm(e,"hot-editor"),o=AN(n);return n?Et.cloneElement(n,{emitEditorInstance:function(a,l){t.get(o)||t.set(o,new Map);var s=t.get(o);s.set(l??eh,a)},editorColumnScope:r,isEditor:!0}):null}function Wse(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:document;n||(n=document),qv||(qv=n.createDocumentFragment());var o=n.createElement("DIV");qv.appendChild(o);var i=Et.cloneElement(e,Hse({key:"".concat(t.row,"-").concat(t.col)},t));return{portal:mM.createPortal(i,o,"".concat(t.row,"-").concat(t.col,"-").concat(Math.random())),portalContainer:o}}function $N(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}function MN(e){var t=Et.version.split(".").map(function(n){return parseInt(n)}),r=t[0]>=16&&t[1]>=3||t[0]>=17;r&&(e.UNSAFE_componentWillUpdate=e.componentWillUpdate,e.componentWillUpdate=void 0,e.UNSAFE_componentWillMount=e.componentWillMount,e.componentWillMount=void 0)}var xN=function(){function e(){za(this,e)}return Ga(e,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var o=r.settings;for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])}for(var a in r)a!=="settings"&&a!=="children"&&r.hasOwnProperty(a)&&(n[a]=r[a]);return n}}]),e}(),Use=function(e){ks(r,e);var t=As(r);function r(n,o){var i;return za(this,r),i=t.call(this,n,o),i.localEditorPortal=null,MN(Ps(i)),i}return Ga(r,[{key:"getLocalEditorPortal",value:function(){return this.localEditorPortal}},{key:"setLocalEditorPortal",value:function(o){this.localEditorPortal=o}},{key:"getSettingsProps",value:function(){var o=this;return this.internalProps=["__componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!o.internalProps.includes(i)}).reduce(function(i,a){return i[a]=o.props[a],i},{})}},{key:"hasProp",value:function(o){return!!this.props[o]}},{key:"getLocalEditorElement",value:function(){return Sm(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var o=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=xN.getSettings(this.getSettingsProps()),o!==null?(this.columnSettings.renderer=this.props._getRendererWrapper(o),this.props._componentRendererColumns.set(this.props._columnIndex,!0)):this.hasProp("renderer")?this.columnSettings.renderer=this.props.renderer:this.columnSettings.renderer=void 0,i!==null?this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex):this.hasProp("editor")?this.columnSettings.editor=this.props.editor:this.columnSettings.editor=void 0}},{key:"createLocalEditorPortal",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children,i=this.props._getEditorCache(),a=Sm(o,i,this.props._columnIndex);a&&this.setLocalEditorPortal(IN(this.props._getOwnerDocument(),a,i))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentWillMount",value:function(){this.createLocalEditorPortal()}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentWillUpdate",value:function(o,i,a){this.createLocalEditorPortal(o.children)}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){return Et.createElement(Et.Fragment,null,this.getLocalEditorPortal())}}]),r}(Et.Component),zse=function(e){ks(r,e);var t=As(r);function r(n){var o;return za(this,r),o=t.call(this,n),o.state={portals:[]},o}return Ga(r,[{key:"render",value:function(){return Et.createElement(Et.Fragment,null,this.state.portals)}}]),r}(Et.Component),Gse="12.1.3";function aO(e,t){return t={exports:{}},e(t,t.exports),t.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lt=typeof Symbol=="function"&&Symbol.for,lO=Lt?Symbol.for("react.element"):60103,sO=Lt?Symbol.for("react.portal"):60106,rd=Lt?Symbol.for("react.fragment"):60107,nd=Lt?Symbol.for("react.strict_mode"):60108,od=Lt?Symbol.for("react.profiler"):60114,id=Lt?Symbol.for("react.provider"):60109,ad=Lt?Symbol.for("react.context"):60110,uO=Lt?Symbol.for("react.async_mode"):60111,ld=Lt?Symbol.for("react.concurrent_mode"):60111,sd=Lt?Symbol.for("react.forward_ref"):60112,ud=Lt?Symbol.for("react.suspense"):60113,Yse=Lt?Symbol.for("react.suspense_list"):60120,cd=Lt?Symbol.for("react.memo"):60115,fd=Lt?Symbol.for("react.lazy"):60116,Kse=Lt?Symbol.for("react.block"):60121,Xse=Lt?Symbol.for("react.fundamental"):60117,qse=Lt?Symbol.for("react.responder"):60118,Qse=Lt?Symbol.for("react.scope"):60119;function vr(e){if(Ts(e)==="object"&&e!==null){var t=e.$$typeof;switch(t){case lO:switch(e=e.type,e){case uO:case ld:case rd:case od:case nd:case ud:return e;default:switch(e=e&&e.$$typeof,e){case ad:case sd:case fd:case cd:case id:return e;default:return t}}case sO:return t}}}function DN(e){return vr(e)===ld}var Zse=uO,Jse=ld,eue=ad,tue=id,rue=lO,nue=sd,oue=rd,iue=fd,aue=cd,lue=sO,sue=od,uue=nd,cue=ud,fue=function(t){return DN(t)||vr(t)===uO},hue=DN,due=function(t){return vr(t)===ad},vue=function(t){return vr(t)===id},pue=function(t){return Ts(t)==="object"&&t!==null&&t.$$typeof===lO},gue=function(t){return vr(t)===sd},yue=function(t){return vr(t)===rd},mue=function(t){return vr(t)===fd},bue=function(t){return vr(t)===cd},wue=function(t){return vr(t)===sO},Sue=function(t){return vr(t)===od},Cue=function(t){return vr(t)===nd},_ue=function(t){return vr(t)===ud},Oue=function(t){return typeof t=="string"||typeof t=="function"||t===rd||t===ld||t===od||t===nd||t===ud||t===Yse||Ts(t)==="object"&&t!==null&&(t.$$typeof===fd||t.$$typeof===cd||t.$$typeof===id||t.$$typeof===ad||t.$$typeof===sd||t.$$typeof===Xse||t.$$typeof===qse||t.$$typeof===Qse||t.$$typeof===Kse)},Rue=vr,Eue={AsyncMode:Zse,ConcurrentMode:Jse,ContextConsumer:eue,ContextProvider:tue,Element:rue,ForwardRef:nue,Fragment:oue,Lazy:iue,Memo:aue,Portal:lue,Profiler:sue,StrictMode:uue,Suspense:cue,isAsyncMode:fue,isConcurrentMode:hue,isContextConsumer:due,isContextProvider:vue,isElement:pue,isForwardRef:gue,isFragment:yue,isLazy:mue,isMemo:bue,isPortal:wue,isProfiler:Sue,isStrictMode:Cue,isSuspense:_ue,isValidElementType:Oue,typeOf:Rue},tt=aO(function(e,t){});tt.AsyncMode;tt.ConcurrentMode;tt.ContextConsumer;tt.ContextProvider;tt.Element;tt.ForwardRef;tt.Fragment;tt.Lazy;tt.Memo;tt.Portal;tt.Profiler;tt.StrictMode;tt.Suspense;tt.isAsyncMode;tt.isConcurrentMode;tt.isContextConsumer;tt.isContextProvider;tt.isElement;tt.isForwardRef;tt.isFragment;tt.isLazy;tt.isMemo;tt.isPortal;tt.isProfiler;tt.isStrictMode;tt.isSuspense;tt.isValidElementType;tt.typeOf;aO(function(e){e.exports=Eue});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var VP=Object.getOwnPropertySymbols,Tue=Object.prototype.hasOwnProperty,kue=Object.prototype.propertyIsEnumerable;function Pue(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function Aue(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(i){return t[i]});if(n.join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(i){o[i]=i}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Aue();var Iue="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$ue=Iue;Function.call.bind(Object.prototype.hasOwnProperty);function HN(){}function NN(){}NN.resetWarningCache=HN;var Mue=function(){function t(o,i,a,l,s,u){if(u!==$ue){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function r(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:NN,resetWarningCache:HN};return n.PropTypes=n,n},xue=aO(function(e){e.exports=Mue()}),Zv=xue,LN=function(e){ks(r,e);var t=As(r);function r(n,o){var i;return za(this,r),i=t.call(this,n,o),i.id=null,i.__hotInstance=null,i.hotElementRef=null,i.columnSettings=[],i.portalManager=null,i.portalCacheArray=[],i.globalEditorPortal=null,i.renderedCellCache=new Map,i.editorCache=new Map,i.componentRendererColumns=new Map,MN(Ps(i)),i}return Ga(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Fse),null)},set:function(o){this.__hotInstance=o}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"getGlobalEditorPortal",value:function(){return this.globalEditorPortal}},{key:"setGlobalEditorPortal",value:function(o){this.globalEditorPortal=o}},{key:"clearCache",value:function(){var o=this.getRenderedCellCache();this.setGlobalEditorPortal(null),Qv(this.getOwnerDocument()),this.getEditorCache().clear(),o.clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(o){this.hotElementRef=o}},{key:"getRendererWrapper",value:function(o){var i=this;return function(a,l,s,u,c,f,h){var d=i.getRenderedCellCache();if(d.has("".concat(s,"-").concat(u))&&(l.innerHTML=d.get("".concat(s,"-").concat(u)).innerHTML),l&&!l.getAttribute("ghost-table")){for(var v=Wse(o,{TD:l,row:s,col:u,prop:c,value:f,cellProperties:h,isRenderer:!0},function(){},l.ownerDocument),g=v.portal,y=v.portalContainer;l.firstChild;)l.removeChild(l.firstChild);l.appendChild(y),i.portalCacheArray.push(g)}return d.set("".concat(s,"-").concat(u),l),l}}},{key:"getEditorClass",value:function(o){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:eh,l=AN(o),s=this.getEditorCache(),u=(i=s.get(l))===null||i===void 0?void 0:i.get(a);return this.makeEditorClass(u)}},{key:"makeEditorClass",value:function(o){var i=function(a){ks(s,a);var l=As(s);function s(u){var c;return za(this,s),c=l.call(this,u),o.hotCustomEditorInstance=Ps(c),c.editorComponent=o,c}return Ga(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),s}(Ue.editors.BaseEditor);return Object.getOwnPropertyNames(Ue.editors.BaseEditor.prototype).forEach(function(a){a!=="constructor"&&(i.prototype[a]=function(){for(var l,s=arguments.length,u=new Array(s),c=0;c<s;c++)u[c]=arguments[c];return(l=o[a]).call.apply(l,[o].concat(u))})}),i}},{key:"getGlobalRendererElement",value:function(){var o=this.props.children;return wm(o,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children;return Sm(o,this.getEditorCache())}},{key:"createGlobalEditorPortal",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children,i=this.getGlobalEditorElement(o);i&&this.setGlobalEditorPortal(IN(this.getOwnerDocument(),i,this.getEditorCache()))}},{key:"createNewGlobalSettings",value:function(){var o=xN.getSettings(this.props),i=this.getGlobalRendererElement(),a=this.getGlobalEditorElement();return o.columns=this.columnSettings.length?this.columnSettings:o.columns,a?o.editor=this.getEditorClass(a,eh):o.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),i?(o.renderer=this.getRendererWrapper(i),this.componentRendererColumns.set("global",!0)):o.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),o}},{key:"displayAutoSizeWarning",value:function(o){var i,a;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(a=this.hotInstance.getPlugin("autoColumnSize"))!==null&&a!==void 0&&a.enabled)&&this.componentRendererColumns.size>0&&Vse(Bse)}},{key:"setHotColumnSettings",value:function(o,i){this.columnSettings[i]=o}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var o=this;this.portalManager.setState(function(){return Object.assign({},{portals:o.portalCacheArray})},function(){o.portalCacheArray.length=0})}},{key:"updateHot",value:function(o){this.hotInstance&&this.hotInstance.updateSettings(o,!1)}},{key:"setPortalManagerRef",value:function(o){this.portalManager=o}},{key:"componentWillMount",value:function(){this.clearCache(),this.createGlobalEditorPortal()}},{key:"componentDidMount",value:function(){var o=this,i=this.createNewGlobalSettings();this.hotInstance=new Ue.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(a){o.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){o.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentWillUpdate",value:function(o,i,a){this.clearCache(),Qv(this.getOwnerDocument()),this.createGlobalEditorPortal(o.children)}},{key:"componentDidUpdate",value:function(){var o=this.createNewGlobalSettings();this.updateHot(o),this.displayAutoSizeWarning(o)}},{key:"componentWillUnmount",value:function(){this.hotInstance&&this.hotInstance.destroy(),Qv(this.getOwnerDocument())}},{key:"render",value:function(){var o=this,i=$N(this.props),a=i.id,l=i.className,s=i.style,u=function(d){return d.type===Use},c=Et.Children.toArray(this.props.children);c=c.filter(function(h){return u(h)});var f=c.map(function(h,d){return Et.cloneElement(h,{_componentRendererColumns:o.componentRendererColumns,_emitColumnSettings:o.setHotColumnSettings.bind(o),_columnIndex:d,_getChildElementByType:wm.bind(o),_getRendererWrapper:o.getRendererWrapper.bind(o),_getEditorClass:o.getEditorClass.bind(o),_getOwnerDocument:o.getOwnerDocument.bind(o),_getEditorCache:o.getEditorCache.bind(o),children:h.props.children})});return f.push(this.getGlobalEditorPortal()),Et.createElement(Et.Fragment,null,Et.createElement("div",{ref:this.setHotElementRef.bind(this),id:a,className:l,style:s},f),Et.createElement(zse,{ref:this.setPortalManagerRef.bind(this)}))}}],[{key:"version",get:function(){return Gse}}]),r}(Et.Component);LN.propTypes={style:Zv.object,id:Zv.string,className:Zv.string};Et.Component;function Cm(e){return Cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cm(e)}function Due(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Hue(e,t,r){return t&&WP(e.prototype,t),r&&WP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ir(){return typeof Reflect<"u"&&Reflect.get?Ir=Reflect.get.bind():Ir=function(t,r,n){var o=Nue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ir.apply(this,arguments)}function Nue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fr(e),e!==null););return e}function Lue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_m(e,t)}function _m(e,t){return _m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_m(e,t)}function jue(e){var t=Vue();return function(){var n=fr(e),o;if(t){var i=fr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bue(this,o)}}function Bue(e,t){if(t&&(Cm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fue(e)}function Fue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fr(e){return fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fr(e)}var UP="handsontableEditor",Wue="handsontable",cO=function(e){Lue(r,e);var t=jue(r);function r(){return Due(this,r),t.apply(this,arguments)}return Hue(r,[{key:"open",value:function(){Ir(fr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Vh(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),Ir(fr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){Ir(fr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this,f={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var g=this.getSourceData(v.row,v.col);g!==void 0&&c.setValue(g),c.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&ht(f,u.handsontable),this.htOptions=f}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||Ir(fr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){Ir(fr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}Ir(fr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");Ir(fr(r.prototype),"registerShortcuts",this).call(this);var l={group:UP,relativeToGroup:Uh,position:"before"},s=function(c,f){var h=o.htEditor.getInstance();if(c!==void 0&&(c<0||h.flipped&&c>h.countRows()-1?h.deselectCell():h.selectCell(c,0),h.getData().length))return f.preventDefault(),rn(f),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(c){var f=o.htEditor.getInstance(),h,d;return!f.getSelectedLast()&&f.flipped?h=f.countRows()-1:f.getSelectedLast()&&(f.flipped?(d=f.getSelectedLast()[0],h=Math.max(0,d-1)):(d=f.getSelectedLast()[0],h=d-1)),s(h,c)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(c){var f=o.htEditor.getInstance(),h,d;if(!f.getSelectedLast()&&!f.flipped)h=0;else if(f.getSelectedLast()){if(f.flipped)h=f.getSelectedLast()[0]+1;else if(!f.flipped){var v=f.countRows()-1;d=f.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,c)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){Ir(fr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(UP)}}],[{key:"EDITOR_TYPE",get:function(){return Wue}}]),r}(Yi);function Om(e){return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Om(e)}function Uue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zue(e,t,r){return t&&zP(e.prototype,t),r&&zP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ko(){return typeof Reflect<"u"&&Reflect.get?Ko=Reflect.get.bind():Ko=function(t,r,n){var o=Gue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ko.apply(this,arguments)}function Gue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gn(e),e!==null););return e}function Yue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rm(e,t)}function Rm(e,t){return Rm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Rm(e,t)}function Kue(e){var t=que();return function(){var n=gn(e),o;if(t){var i=gn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Xue(this,o)}}function Xue(e,t){if(t&&(Om(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Em(e)}function Em(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function que(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gn(e){return gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gn(e)}function Que(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Jv=new WeakMap,Zue="autocomplete",fO=function(e){Yue(r,e);var t=Kue(r);function r(n){var o;return Uue(this,r),o=t.call(this,n),Que(Em(o),"sortByRelevance",function(i,a,l){var s=[],u=[],c=i.length,f=a.length,h,d,v,g;if(c===0){for(v=0;v<f;v++)u.push(v);return u}for(v=0;v<f;v++){if(d=hT(wt(a[v])),l)g=d.indexOf(i);else{var y=this.cellProperties.locale;g=d.toLocaleLowerCase(y).indexOf(i.toLocaleLowerCase(y))}g!==-1&&(h=d.length-g-c,s.push({baseIndex:v,index:g,charsLeft:h,value:d}))}for(s.sort(function(w,C){if(C.index===-1)return-1;if(w.index===-1)return 1;if(w.index<C.index)return-1;if(C.index<w.index)return 1;if(w.index===C.index){if(w.charsLeft<C.charsLeft)return-1;if(w.charsLeft>C.charsLeft)return 1}return 0}),v=0,f=s.length;v<f;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],Jv.set(Em(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return zue(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return fe(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){Ko(gn(r.prototype),"createElements",this).call(this),re(this.htContainer,"autocompleteEditor"),re(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=Jv.get(this);Ko(gn(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Ht();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[Ze(this.TEXTAREA)-2]:void 0,width:l?Ze(this.TEXTAREA)+s:void 0,renderer:function(c,f,h,d,v,g,y){ko(c,f,h,d,v,g,y);var w=o.cellProperties,C=w.filteringCaseSensitive,_=w.allowHtml,I=w.locale,E=o.query,U=wt(g),G,Q;U&&!_&&(G=C===!0?U.indexOf(E):U.toLocaleLowerCase(I).indexOf(E.toLocaleLowerCase(I)),G!==-1&&(Q=U.substr(G,E.length),U=U.replace(Q,"<strong>".concat(Q,"</strong>")))),f.innerHTML=U},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Ko(gn(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){Ko(gn(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=ID(this.TEXTAREA),a=y5(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,c=null,f=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),f,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(c=u[0]);else{for(var d=[],v=0,g=f.length;v<g&&!(l&&h<=v);v++)h?d.push(f[u[v]]):d.push(f[v]);c=0,f=d}this.strippedChoices=f,this.htEditor.loadData(Tc([f])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(c),this.hot.listen(),Vh(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=Ss(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Tt(this.TEXTAREA),s=dt(this.TEXTAREA),u=this.getDropdownHeight(),c=o.scrollTop,f=dt(this.hot.view._wt.wtTable.THEAD),h=Tt(o),d=l.top-h.top-f+c,v=o.scrollHeight-d-f-s,g=u>v&&d>v;return g?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(g?d:v,u),g}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Ht(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=Fe(o,function(s){return wt(s)}),l=Fe(a,function(s){return i?s:hT(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===ye.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===ye.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=Jv.get(this);if(a.skipOne=!1,pX(o.keyCode)||o.keyCode===ye.BACKSPACE||o.keyCode===ye.DELETE||o.keyCode===ye.INSERT){var l=10;if(o.keyCode===ye.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return Zue}}]),r}(cO);function Tm(e){return Tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tm(e)}function Jue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ece(e,t,r){return t&&GP(e.prototype,t),r&&GP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&km(e,t)}function km(e,t){return km=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},km(e,t)}function rce(e){var t=ice();return function(){var n=th(e),o;if(t){var i=th(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nce(this,o)}}function nce(e,t){if(t&&(Tm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oce(e)}function oce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ice(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function th(e){return th=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},th(e)}var ace="checkbox",jN=function(e){tce(r,e);var t=rce(r);function r(){return Jue(this,r),t.apply(this,arguments)}return ece(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return ace}}]),r}(bl),Pm={},lce={get exports(){return Pm},set exports(e){Pm=e}};/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=Fj}catch{}e.exports=n(o)}})(Vp,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function(P,T,Y,p){o?P.addEventListener(T,Y,!!p):P.attachEvent("on"+T,Y)},s=function(P,T,Y,p){o?P.removeEventListener(T,Y,!!p):P.detachEvent("on"+T,Y)},u=function(P){return P.trim?P.trim():P.replace(/^\s+|\s+$/g,"")},c=function(P,T){return(" "+P.className+" ").indexOf(" "+T+" ")!==-1},f=function(P,T){c(P,T)||(P.className=P.className===""?T:P.className+" "+T)},h=function(P,T){P.className=u((" "+P.className+" ").replace(" "+T+" "," "))},d=function(P){return/Array/.test(Object.prototype.toString.call(P))},v=function(P){return/Date/.test(Object.prototype.toString.call(P))&&!isNaN(P.getTime())},g=function(P){var T=P.getDay();return T===0||T===6},y=function(P){return P%4===0&&P%100!==0||P%400===0},w=function(P,T){return[31,y(P)?29:28,31,30,31,30,31,31,30,31,30,31][T]},C=function(P){v(P)&&P.setHours(0,0,0,0)},_=function(P,T){return P.getTime()===T.getTime()},I=function(P,T,Y){var p,m;for(p in T)m=P[p]!==void 0,m&&typeof T[p]=="object"&&T[p]!==null&&T[p].nodeName===void 0?v(T[p])?Y&&(P[p]=new Date(T[p].getTime())):d(T[p])?Y&&(P[p]=T[p].slice(0)):P[p]=I({},T[p],Y):(Y||!m)&&(P[p]=T[p]);return P},E=function(P,T,Y){var p;i.createEvent?(p=i.createEvent("HTMLEvents"),p.initEvent(T,!0,!1),p=I(p,Y),P.dispatchEvent(p)):i.createEventObject&&(p=i.createEventObject(),p=I(p,Y),P.fireEvent("on"+T,p))},U=function(P){return P.month<0&&(P.year-=Math.ceil(Math.abs(P.month)/12),P.month+=12),P.month>11&&(P.year+=Math.floor(Math.abs(P.month)/12),P.month-=12),P},G={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},Q=function(P,T,Y){for(T+=P.firstDay;T>=7;)T-=7;return Y?P.i18n.weekdaysShort[T]:P.i18n.weekdays[T]},K=function(P){var T=[],Y="false";if(P.isEmpty)if(P.showDaysInNextAndPreviousMonths)T.push("is-outside-current-month"),P.enableSelectionDaysInNextAndPreviousMonths||T.push("is-selection-disabled");else return'<td class="is-empty"></td>';return P.isDisabled&&T.push("is-disabled"),P.isToday&&T.push("is-today"),P.isSelected&&(T.push("is-selected"),Y="true"),P.hasEvent&&T.push("has-event"),P.isInRange&&T.push("is-inrange"),P.isStartRange&&T.push("is-startrange"),P.isEndRange&&T.push("is-endrange"),'<td data-day="'+P.day+'" class="'+T.join(" ")+'" aria-selected="'+Y+'"><button class="pika-button pika-day" type="button" data-pika-year="'+P.year+'" data-pika-month="'+P.month+'" data-pika-day="'+P.day+'">'+P.day+"</button></td>"},X=function(P,T){P.setHours(0,0,0,0);var Y=P.getDate(),p=P.getDay(),m=T,b=m-1,R=7,k=function(ne){return(ne+R-1)%R};P.setDate(Y+b-k(p));var j=new Date(P.getFullYear(),0,m),W=24*60*60*1e3,q=(P.getTime()-j.getTime())/W,Z=1+Math.round((q-b+k(j.getDay()))/R);return Z},J=function(P,T,Y,p){var m=new Date(Y,T,P),b=n?r(m).isoWeek():X(m,p);return'<td class="pika-week">'+b+"</td>"},le=function(P,T,Y,p){return'<tr class="pika-row'+(Y?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(T?P.reverse():P).join("")+"</tr>"},ee=function(P){return"<tbody>"+P.join("")+"</tbody>"},he=function(P){var T,Y=[];for(P.showWeekNumber&&Y.push("<th></th>"),T=0;T<7;T++)Y.push('<th scope="col"><abbr title="'+Q(P,T)+'">'+Q(P,T,!0)+"</abbr></th>");return"<thead><tr>"+(P.isRTL?Y.reverse():Y).join("")+"</tr></thead>"},Ce=function(P,T,Y,p,m,b){var R,k,j,W=P._o,q=Y===W.minYear,Z=Y===W.maxYear,ne='<div id="'+b+'" class="pika-title" role="heading" aria-live="assertive">',te,ue,we=!0,F=!0;for(j=[],R=0;R<12;R++)j.push('<option value="'+(Y===m?R-T:12+R-T)+'"'+(R===p?' selected="selected"':"")+(q&&R<W.minMonth||Z&&R>W.maxMonth?' disabled="disabled"':"")+">"+W.i18n.months[R]+"</option>");for(te='<div class="pika-label">'+W.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+j.join("")+"</select></div>",d(W.yearRange)?(R=W.yearRange[0],k=W.yearRange[1]+1):(R=Y-W.yearRange,k=1+Y+W.yearRange),j=[];R<k&&R<=W.maxYear;R++)R>=W.minYear&&j.push('<option value="'+R+'"'+(R===Y?' selected="selected"':"")+">"+R+"</option>");return ue='<div class="pika-label">'+Y+W.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+j.join("")+"</select></div>",W.showMonthAfterYear?ne+=ue+te:ne+=te+ue,q&&(p===0||W.minMonth>=p)&&(we=!1),Z&&(p===11||W.maxMonth<=p)&&(F=!1),T===0&&(ne+='<button class="pika-prev'+(we?"":" is-disabled")+'" type="button">'+W.i18n.previousMonth+"</button>"),T===P._o.numberOfMonths-1&&(ne+='<button class="pika-next'+(F?"":" is-disabled")+'" type="button">'+W.i18n.nextMonth+"</button>"),ne+="</div>"},_e=function(P,T,Y){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+Y+'">'+he(P)+ee(T)+"</table>"},be=function(P){var T=this,Y=T.config(P);T._onMouseDown=function(m){if(T._v){m=m||window.event;var b=m.target||m.srcElement;if(b)if(c(b,"is-disabled")||(c(b,"pika-button")&&!c(b,"is-empty")&&!c(b.parentNode,"is-disabled")?(T.setDate(new Date(b.getAttribute("data-pika-year"),b.getAttribute("data-pika-month"),b.getAttribute("data-pika-day"))),Y.bound&&a(function(){T.hide(),Y.blurFieldOnSelect&&Y.field&&Y.field.blur()},100)):c(b,"pika-prev")?T.prevMonth():c(b,"pika-next")&&T.nextMonth()),c(b,"pika-select"))T._c=!0;else if(m.preventDefault)m.preventDefault();else return m.returnValue=!1,!1}},T._onChange=function(m){m=m||window.event;var b=m.target||m.srcElement;b&&(c(b,"pika-select-month")?T.gotoMonth(b.value):c(b,"pika-select-year")&&T.gotoYear(b.value))},T._onKeyChange=function(m){if(m=m||window.event,T.isVisible())switch(m.keyCode){case 13:case 27:Y.field&&Y.field.blur();break;case 37:T.adjustDate("subtract",1);break;case 38:T.adjustDate("subtract",7);break;case 39:T.adjustDate("add",1);break;case 40:T.adjustDate("add",7);break;case 8:case 46:T.setDate(null);break}},T._parseFieldValue=function(){if(Y.parse)return Y.parse(Y.field.value,Y.format);if(n){var m=r(Y.field.value,Y.format,Y.formatStrict);return m&&m.isValid()?m.toDate():null}else return new Date(Date.parse(Y.field.value))},T._onInputChange=function(m){var b;m.firedBy!==T&&(b=T._parseFieldValue(),v(b)&&T.setDate(b),T._v||T.show())},T._onInputFocus=function(){T.show()},T._onInputClick=function(){T.show()},T._onInputBlur=function(){var m=i.activeElement;do if(c(m,"pika-single"))return;while(m=m.parentNode);T._c||(T._b=a(function(){T.hide()},50)),T._c=!1},T._onClick=function(m){m=m||window.event;var b=m.target||m.srcElement,R=b;if(b){!o&&c(b,"pika-select")&&(b.onchange||(b.setAttribute("onchange","return;"),l(b,"change",T._onChange)));do if(c(R,"pika-single")||R===Y.trigger)return;while(R=R.parentNode);T._v&&b!==Y.trigger&&R!==Y.trigger&&T.hide()}},T.el=i.createElement("div"),T.el.className="pika-single"+(Y.isRTL?" is-rtl":"")+(Y.theme?" "+Y.theme:""),l(T.el,"mousedown",T._onMouseDown,!0),l(T.el,"touchend",T._onMouseDown,!0),l(T.el,"change",T._onChange),Y.keyboardInput&&l(i,"keydown",T._onKeyChange),Y.field&&(Y.container?Y.container.appendChild(T.el):Y.bound?i.body.appendChild(T.el):Y.field.parentNode.insertBefore(T.el,Y.field.nextSibling),l(Y.field,"change",T._onInputChange),Y.defaultDate||(Y.defaultDate=T._parseFieldValue(),Y.setDefaultDate=!0));var p=Y.defaultDate;v(p)?Y.setDefaultDate?T.setDate(p,!0):T.gotoDate(p):T.gotoDate(new Date),Y.bound?(this.hide(),T.el.className+=" is-bound",l(Y.trigger,"click",T._onInputClick),l(Y.trigger,"focus",T._onInputFocus),l(Y.trigger,"blur",T._onInputBlur)):this.show()};return be.prototype={config:function(P){this._o||(this._o=I({},G,!0));var T=I(this._o,P,!0);T.isRTL=!!T.isRTL,T.field=T.field&&T.field.nodeName?T.field:null,T.theme=typeof T.theme=="string"&&T.theme?T.theme:null,T.bound=!!(T.bound!==void 0?T.field&&T.bound:T.field),T.trigger=T.trigger&&T.trigger.nodeName?T.trigger:T.field,T.disableWeekends=!!T.disableWeekends,T.disableDayFn=typeof T.disableDayFn=="function"?T.disableDayFn:null;var Y=parseInt(T.numberOfMonths,10)||1;if(T.numberOfMonths=Y>4?4:Y,v(T.minDate)||(T.minDate=!1),v(T.maxDate)||(T.maxDate=!1),T.minDate&&T.maxDate&&T.maxDate<T.minDate&&(T.maxDate=T.minDate=!1),T.minDate&&this.setMinDate(T.minDate),T.maxDate&&this.setMaxDate(T.maxDate),d(T.yearRange)){var p=new Date().getFullYear()-10;T.yearRange[0]=parseInt(T.yearRange[0],10)||p,T.yearRange[1]=parseInt(T.yearRange[1],10)||p}else T.yearRange=Math.abs(parseInt(T.yearRange,10))||G.yearRange,T.yearRange>100&&(T.yearRange=100);return T},toString:function(P){return P=P||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,P):n?r(this._d).format(P):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(P,T){n&&r.isMoment(P)&&this.setDate(P.toDate(),T)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(P,T){if(!P)return this._d=null,this._o.field&&(this._o.field.value="",E(this._o.field,"change",{firedBy:this})),this.draw();if(typeof P=="string"&&(P=new Date(Date.parse(P))),!!v(P)){var Y=this._o.minDate,p=this._o.maxDate;v(Y)&&P<Y?P=Y:v(p)&&P>p&&(P=p),this._d=new Date(P.getTime()),C(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),E(this._o.field,"change",{firedBy:this})),!T&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(P){var T=!0;if(v(P)){if(this.calendars){var Y=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),m=P.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),T=m<Y.getTime()||p.getTime()<m}T&&(this.calendars=[{month:P.getMonth(),year:P.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(P,T){var Y=this.getDate()||new Date,p=parseInt(T)*24*60*60*1e3,m;P==="add"?m=new Date(Y.valueOf()+p):P==="subtract"&&(m=new Date(Y.valueOf()-p)),this.setDate(m)},adjustCalendars:function(){this.calendars[0]=U(this.calendars[0]);for(var P=1;P<this._o.numberOfMonths;P++)this.calendars[P]=U({month:this.calendars[0].month+P,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(P){isNaN(P)||(this.calendars[0].month=parseInt(P,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(P){isNaN(P)||(this.calendars[0].year=parseInt(P,10),this.adjustCalendars())},setMinDate:function(P){P instanceof Date?(C(P),this._o.minDate=P,this._o.minYear=P.getFullYear(),this._o.minMonth=P.getMonth()):(this._o.minDate=G.minDate,this._o.minYear=G.minYear,this._o.minMonth=G.minMonth,this._o.startRange=G.startRange),this.draw()},setMaxDate:function(P){P instanceof Date?(C(P),this._o.maxDate=P,this._o.maxYear=P.getFullYear(),this._o.maxMonth=P.getMonth()):(this._o.maxDate=G.maxDate,this._o.maxYear=G.maxYear,this._o.maxMonth=G.maxMonth,this._o.endRange=G.endRange),this.draw()},setStartRange:function(P){this._o.startRange=P},setEndRange:function(P){this._o.endRange=P},draw:function(P){if(!(!this._v&&!P)){var T=this._o,Y=T.minYear,p=T.maxYear,m=T.minMonth,b=T.maxMonth,R="",k;this._y<=Y&&(this._y=Y,!isNaN(m)&&this._m<m&&(this._m=m)),this._y>=p&&(this._y=p,!isNaN(b)&&this._m>b&&(this._m=b));for(var j=0;j<T.numberOfMonths;j++)k="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),R+='<div class="pika-lendar">'+Ce(this,j,this.calendars[j].year,this.calendars[j].month,this.calendars[0].year,k)+this.render(this.calendars[j].year,this.calendars[j].month,k)+"</div>";this.el.innerHTML=R,T.bound&&T.field.type!=="hidden"&&a(function(){T.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),T.bound&&T.field.setAttribute("aria-label",T.ariaLabel)}},adjustPosition:function(){var P,T,Y,p,m,b,R,k,j,W,q,Z;if(!this._o.container){if(this.el.style.position="absolute",P=this._o.trigger,T=P,Y=this.el.offsetWidth,p=this.el.offsetHeight,m=window.innerWidth||i.documentElement.clientWidth,b=window.innerHeight||i.documentElement.clientHeight,R=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,q=!0,Z=!0,typeof P.getBoundingClientRect=="function")W=P.getBoundingClientRect(),k=W.left+window.pageXOffset,j=W.bottom+window.pageYOffset;else for(k=T.offsetLeft,j=T.offsetTop+T.offsetHeight;T=T.offsetParent;)k+=T.offsetLeft,j+=T.offsetTop;(this._o.reposition&&k+Y>m||this._o.position.indexOf("right")>-1&&k-Y+P.offsetWidth>0)&&(k=k-Y+P.offsetWidth,q=!1),(this._o.reposition&&j+p>b+R||this._o.position.indexOf("top")>-1&&j-p-P.offsetHeight>0)&&(j=j-p-P.offsetHeight,Z=!1),this.el.style.left=k+"px",this.el.style.top=j+"px",f(this.el,q?"left-aligned":"right-aligned"),f(this.el,Z?"bottom-aligned":"top-aligned"),h(this.el,q?"right-aligned":"left-aligned"),h(this.el,Z?"top-aligned":"bottom-aligned")}},render:function(P,T,Y){var p=this._o,m=new Date,b=w(P,T),R=new Date(P,T,1).getDay(),k=[],j=[];C(m),p.firstDay>0&&(R-=p.firstDay,R<0&&(R+=7));for(var W=T===0?11:T-1,q=T===11?0:T+1,Z=T===0?P-1:P,ne=T===11?P+1:P,te=w(Z,W),ue=b+R,we=ue;we>7;)we-=7;ue+=7-we;for(var F=!1,Se=0,Ie=0;Se<ue;Se++){var Re=new Date(P,T,1+(Se-R)),Pe=v(this._d)?_(Re,this._d):!1,ke=_(Re,m),S=p.events.indexOf(Re.toDateString())!==-1,O=Se<R||Se>=b+R,A=1+(Se-R),L=T,M=P,V=p.startRange&&_(p.startRange,Re),H=p.endRange&&_(p.endRange,Re),x=p.startRange&&p.endRange&&p.startRange<Re&&Re<p.endRange,B=p.minDate&&Re<p.minDate||p.maxDate&&Re>p.maxDate||p.disableWeekends&&g(Re)||p.disableDayFn&&p.disableDayFn(Re);O&&(Se<R?(A=te+A,L=W,M=Z):(A=A-b,L=q,M=ne));var D={day:A,month:L,year:M,hasEvent:S,isSelected:Pe,isToday:ke,isDisabled:B,isEmpty:O,isStartRange:V,isEndRange:H,isInRange:x,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&Pe&&(F=!0),j.push(K(D)),++Ie===7&&(p.showWeekNumber&&j.unshift(J(Se-R,T,P,p.firstWeekOfYearMinDays)),k.push(le(j,p.isRTL,p.pickWholeWeek,F)),j=[],Ie=0,F=!1)}return _e(p,k,Y)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var P=this._v;P!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),f(this.el,"is-hidden"),this._v=!1,P!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var P=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),P.keyboardInput&&s(i,"keydown",this._onKeyChange),P.field&&(s(P.field,"change",this._onInputChange),P.bound&&(s(P.trigger,"click",this._onInputClick),s(P.trigger,"focus",this._onInputFocus),s(P.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},be})})(lce);const YP=Pm;function Am(e){return Am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Am(e)}function sce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uce(e,t,r){return t&&KP(e.prototype,t),r&&KP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pn(){return typeof Reflect<"u"&&Reflect.get?pn=Reflect.get.bind():pn=function(t,r,n){var o=cce(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pn.apply(this,arguments)}function cce(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xr(e),e!==null););return e}function fce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Im(e,t)}function Im(e,t){return Im=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Im(e,t)}function hce(e){var t=pce();return function(){var n=xr(e),o;if(t){var i=xr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dce(this,o)}}function dce(e,t){if(t&&(Am(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vce(e)}function vce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xr(e){return xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xr(e)}var BN="date",XP="dateEditor",FN=function(e){fce(r,e);var t=hce(r);function r(n){var o;return sce(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return uce(r,[{key:"init",value:function(){var o=this;if(typeof Xe!="function")throw new Error("You need to include moment.js to your project.");if(typeof YP!="function")throw new Error("You need to include Pikaday to your project.");pn(xr(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){pn(xr(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),re(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new vt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){pn(xr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");pn(xr(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:XP})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(XP),pn(xr(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}pn(xr(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?FD(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new YP(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+dt(this.TD),"px");var c=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?c=i.right-Ze(this.datePicker):c=i.left,this.datePickerStyle.left="".concat(c,"px"),this.originalValue?(u=this.originalValue,Xe(u,a,!0).isValid()&&this.$datePicker.setMoment(Xe(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,Xe(u,a,!0).isValid()&&this.$datePicker.setMoment(Xe(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Fh(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var c=u;isNaN(c.getTime())||(c=Xe(c).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(c),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return BN}}]),r}(Yi);function $m(e){return $m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$m(e)}function gce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yce(e,t,r){return t&&qP(e.prototype,t),r&&qP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fc(){return typeof Reflect<"u"&&Reflect.get?Fc=Reflect.get.bind():Fc=function(t,r,n){var o=mce(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Fc.apply(this,arguments)}function mce(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ya(e),e!==null););return e}function bce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mm(e,t)}function Mm(e,t){return Mm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Mm(e,t)}function wce(e){var t=_ce();return function(){var n=Ya(e),o;if(t){var i=Ya(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Sce(this,o)}}function Sce(e,t){if(t&&($m(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cce(e)}function Cce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ya(e){return Ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ya(e)}var Oce="dropdown",hO=function(e){bce(r,e);var t=wce(r);function r(){return gce(this,r),t.apply(this,arguments)}return yce(r,[{key:"prepare",value:function(o,i,a,l,s,u){Fc(Ya(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return Oce}}]),r}(fO);ge.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===hO&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function xm(e){return xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xm(e)}function Rce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ece(e,t,r){return t&&QP(e.prototype,t),r&&QP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dm(e,t)}function Dm(e,t){return Dm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Dm(e,t)}function kce(e){var t=Ice();return function(){var n=rh(e),o;if(t){var i=rh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Pce(this,o)}}function Pce(e,t){if(t&&(xm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ace(e)}function Ace(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ice(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rh(e){return rh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rh(e)}var $ce="numeric",VN=function(e){Tce(r,e);var t=kce(r);function r(){return Rce(this,r),t.apply(this,arguments)}return Ece(r,null,[{key:"EDITOR_TYPE",get:function(){return $ce}}]),r}(Yi);function Hm(e){return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hm(e)}function Mce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xce(e,t,r){return t&&ZP(e.prototype,t),r&&ZP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vc(){return typeof Reflect<"u"&&Reflect.get?Vc=Reflect.get.bind():Vc=function(t,r,n){var o=Dce(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Vc.apply(this,arguments)}function Dce(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ka(e),e!==null););return e}function Hce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nm(e,t)}function Nm(e,t){return Nm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Nm(e,t)}function Nce(e){var t=Bce();return function(){var n=Ka(e),o;if(t){var i=Ka(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lce(this,o)}}function Lce(e,t){if(t&&(Hm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jce(e)}function jce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ka(e){return Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ka(e)}var Fce="password",WN=function(e){Hce(r,e);var t=Nce(r);function r(){return Mce(this,r),t.apply(this,arguments)}return xce(r,[{key:"createElements",value:function(){Vc(Ka(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Hr(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return Fce}}]),r}(Yi);function nh(e){return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function Vce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wce(e,t,r){return t&&JP(e.prototype,t),r&&JP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wc(){return typeof Reflect<"u"&&Reflect.get?Wc=Reflect.get.bind():Wc=function(t,r,n){var o=Uce(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Wc.apply(this,arguments)}function Uce(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xa(e),e!==null););return e}function zce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lm(e,t)}function Lm(e,t){return Lm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Lm(e,t)}function Gce(e){var t=Xce();return function(){var n=Xa(e),o;if(t){var i=Xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Yce(this,o)}}function Yce(e,t){if(t&&(nh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kce(e)}function Kce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xa(e){return Xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xa(e)}var ep="ht_editor_visible",eA="selectEditor",qce="select",Qce=function(e){zce(r,e);var t=Gce(r);function r(){return Vce(this,r),t.apply(this,arguments)}return Wce(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),re(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,ep)&&De(this.select,ep),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var c=this;Wc(Xa(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this.cellProperties.selectOptions,h;typeof f=="function"?h=this.prepareOptions(f(this.row,this.col,this.prop)):h=this.prepareOptions(f),Hr(this.select),Ve(h,function(d,v){var g=c.hot.rootDocument.createElement("OPTION");g.value=v,zi(g,d),c.select.appendChild(g)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else nh(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Mt.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",re(this.select,ep)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:eA};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(eA)}}],[{key:"EDITOR_TYPE",get:function(){return qce}}]),r}(bl);function jm(e){return jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jm(e)}function Zce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jce(e,t,r){return t&&tA(e.prototype,t),r&&tA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uc(){return typeof Reflect<"u"&&Reflect.get?Uc=Reflect.get.bind():Uc=function(t,r,n){var o=efe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Uc.apply(this,arguments)}function efe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qa(e),e!==null););return e}function tfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bm(e,t)}function Bm(e,t){return Bm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Bm(e,t)}function rfe(e){var t=ife();return function(){var n=qa(e),o;if(t){var i=qa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nfe(this,o)}}function nfe(e,t){if(t&&(jm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ofe(e)}function ofe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ife(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qa(e){return qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qa(e)}var afe="time",UN=function(e){tfe(r,e);var t=rfe(r);function r(){return Zce(this,r),t.apply(this,arguments)}return Jce(r,[{key:"prepare",value:function(o,i,a,l,s,u){Uc(qa(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return afe}}]),r}(Yi);function lfe(){ur(bl),ur(fO),ur(jN),ur(FN),ur(hO),ur(cO),ur(VN),ur(WN),ur(Qce),ur(Yi),ur(UN)}var sfe="autocomplete";function hd(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,rA(r,t)):rA(r,t)(this.source):t(!0)}hd.VALIDATOR_TYPE=sfe;function rA(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var ufe=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},cfe=kt,ffe=Ih,hfe=Ct,dfe=Nr,vfe=rr,nA=ufe,oA=Pt,pfe=ji,gfe=$h;ffe("search",function(e,t,r){return[function(o){var i=vfe(this),a=dfe(o)?void 0:pfe(o,e);return a?cfe(a,o,i):new RegExp(o)[e](oA(i))},function(n){var o=hfe(this),i=oA(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;nA(l,0)||(o.lastIndex=0);var s=gfe(o,i);return nA(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function yfe(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var mfe="date";function dO(e,t){var r=zD(BN,this.instance),n=e,o=!0;n==null&&(n="");var i=Xe(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=Xe(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=bfe(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}dO.VALIDATOR_TYPE=mfe;function bfe(e,t){var r=Xe(yfe(e)),n=Xe(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var wfe="numeric";function vO(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:br(e))}vO.VALIDATOR_TYPE=wfe;var Sfe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Cfe="time";function pO(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=Xe(o,Sfe,!0).isValid()?Xe(o):Xe(o,r),l=a.isValid(),s=Xe(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),n=!0}else n=!1;t(n)}pO.VALIDATOR_TYPE=Cfe;function _fe(){Ql(hd),Ql(dO),Ql(vO),Ql(pO)}var Ofe="autocomplete",Rfe={CELL_TYPE:Ofe,editor:fO,renderer:pl,validator:hd},Efe="checkbox",Tfe={CELL_TYPE:Efe,editor:jN,renderer:fC},kfe="date",Pfe={CELL_TYPE:kfe,editor:FN,renderer:pl,validator:dO},Afe="dropdown",Ife={CELL_TYPE:Afe,editor:hO,renderer:pl,validator:hd},$fe="handsontable",Mfe={CELL_TYPE:$fe,editor:cO,renderer:pl},xfe="numeric",Dfe={CELL_TYPE:xfe,editor:VN,renderer:dC,validator:vO,dataType:"number"},Hfe="password",Nfe={CELL_TYPE:Hfe,editor:WN,renderer:vC,copyable:!1},Lfe="time",jfe={CELL_TYPE:Lfe,editor:UN,renderer:pC,validator:pO};function Bfe(){Xr(Rfe),Xr(Tfe),Xr(Pfe),Xr(Ife),Xr(Mfe),Xr(Dfe),Xr(Nfe),Xr(kN),Xr(jfe)}var Ffe=Bh,Vfe=LD;Ffe("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Vfe);function Wfe(e,t){return Yfe(e)||Gfe(e,t)||zfe(e,t)||Ufe()}function Ufe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zfe(e,t){if(e){if(typeof e=="string")return iA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iA(e,t)}}function iA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gfe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Yfe(e){if(Array.isArray(e))return e}function Kfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xfe(e,t,r){return t&&aA(e.prototype,t),r&&aA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qfe(e,t){Qfe(e,t),t.add(e)}function Qfe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zfe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var lA=new Map([["plugin",uQ],["cell-type",zH],["editor",HX],["renderer",KD],["validator",dH]]),Jfe="base",Lo=new WeakMap,tp=[],Wr=null,sA=new WeakSet,Ke=function(){function e(t){var r=this;Kfe(this,e),qfe(this,sA),Gn(this,"hot",t,{writable:!1}),Lo.set(this,{hooks:{}}),Wr=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Xfe(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var c=u.split(":"),f=Wfe(c,2),h=f[0],d=f[1];if(!lA.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));lA.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");tp.push(a)}}Wr||(Wr=hH()),Wr.indexOf("UndoRedo")>=0&&Wr.splice(Wr.indexOf("UndoRedo"),1),Wr.indexOf(this.pluginName)>=0&&Wr.splice(Wr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=Wr.length===0;if(l){if(tp.length>0){var s=["".concat(tp.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Lo.get(this).hooks[r]=Lo.get(this).hooks[r]||[];var o=Lo.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Lo.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;$(Lo.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Lo.get(this).hooks;Ve(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){$(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=Zfe(this,sA,ehe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Ve(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Jfe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function ehe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function the(e,t){return ihe(e)||ohe(e,t)||nhe(e,t)||rhe()}function rhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nhe(e,t){if(e){if(typeof e=="string")return uA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uA(e,t)}}function uA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ohe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function ihe(e){if(Array.isArray(e))return e}function ahe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lhe(e,t,r){return t&&cA(e.prototype,t),r&&cA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var she=function(){function e(t){ahe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return lhe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),$(this.rows,function(n){r(n.row,dt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),$(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){$(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){$(l.strings,function(s){var u=s.col,c=n.hot.getCellMeta(r,u);c.col=u,c.row=r;var f=n.hot.getCellRenderer(c),h=o.createElement("td");h.setAttribute("ghost-table",1),f(n.hot,h,r,u,n.hot.colToProp(u),s.value,c),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){$(l.strings,function(s){var u=s.col,c=n.createElement("th");i.push([u,c]),o.appendChild(c)})}),this.table.tHead.appendChild(o),$(i,function(l){var s=the(l,2),u=s[0],c=s[1];r.hot.view.appendColHeader(u,c)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){$(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var c=n.hot.getCellRenderer(u),f=o.createElement("td"),h=o.createElement("tr");f.setAttribute("ghost-table",1),c(n.hot,f,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(f),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(c),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),re(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:c}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return re(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const zN=she;function uhe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function che(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fhe(e,t,r){return t&&fA(e.prototype,t),r&&fA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var hhe=function(){function e(t){che(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return fhe(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return me(s,u,function(c){var f=i.generateSample(r,n,c);a.set(c,f)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return me(n.from,n.to,function(u){var c=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),f=c.value,h=c.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ne(f)?v="".concat(Object.keys(f).length):Array.isArray(f)?v="".concat(f.length):v="".concat(wt(f).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var g=a.get(v);if(g.needed){var y=s.indexOf(f)>-1;(!y||i.allowDuplicates||d)&&(g.strings.push(uhe({value:f},l,u)),s.push(f),g.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const GN=hhe;function Fm(e){return Fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fm(e)}function hA(e,t){return ghe(e)||phe(e,t)||vhe(e,t)||dhe()}function dhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vhe(e,t){if(e){if(typeof e=="string")return dA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dA(e,t)}}function dA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function phe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function ghe(e){if(Array.isArray(e))return e}function yhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mhe(e,t,r){return t&&vA(e.prototype,t),r&&vA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xo(){return typeof Reflect<"u"&&Reflect.get?Xo=Reflect.get.bind():Xo=function(t,r,n){var o=bhe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xo.apply(this,arguments)}function bhe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yn(e),e!==null););return e}function whe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vm(e,t)}function Vm(e,t){return Vm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Vm(e,t)}function She(e){var t=_he();return function(){var n=yn(e),o;if(t){var i=yn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Che(this,o)}}function Che(e,t){if(t&&(Fm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YN(e)}function YN(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _he(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yn(e){return yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yn(e)}ge.getSingleton().register("modifyAutoColumnSizeSeed");var Nl="autoColumnSize",Ohe=10,rp=new WeakMap,Rhe="autoColumnSize",Ehe=function(e){whe(r,e);var t=She(r);function r(n){var o;return yhe(this,r),o=t.call(this,n),rp.set(YN(o),{cachedColumnHeaders:[]}),o.ghostTable=new zN(o.hot),o.samplesGenerator=new GN(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Po,o.hot.columnIndexMapper.registerMap(Rhe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return mhe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Nl]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Nl];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),Xo(yn(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),Xo(yn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;Xo(yn(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;me(s.from,s.to,function(c){var f=o.hot.toPhysicalColumn(c);if(f===null&&(f=c),l||o.columnWidthsMap.getValueAtIndex(f)===null&&!o.hot._getColWidthFromSettings(f)){var h=o.samplesGenerator.generateColumnSamples(c,u);$(h,function(d){var v=hA(d,2),g=v[0],y=v[1];return o.ghostTable.addColumn(g,y)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(c,f){var h=o.hot.toPhysicalColumn(c);o.columnWidthsMap.setValueAtIndex(h,f)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function f(){if(!o.hot){vf(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=sD(f):(vf(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateColumnsWidth({from:0,to:c},i),this.firstCalculation=!1,a=c+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[Nl],i=o&&it(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&it(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[Nl],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ne(o)&&(i=o.syncLimit,kD(i)?i=YD(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,SC.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=rp.get(this),a=i.cachedColumnHeaders,l=Vt(o,function(s,u,c){var f=a.length;return(f-1<c||a[c]!==u)&&s.push(c),f-1<c?a.push(u):a[c]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){$(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Cr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=Fe(o,function(l){var s=hA(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){rp.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Cr(o,function(l){var s;return fe((s=l.address)===null||s===void 0?void 0:s.col)}),a=Fe(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Xo(yn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Nl}},{key:"PLUGIN_PRIORITY",get:function(){return Ohe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(Ke),qo={horizontal:"horizontal",vertical:"vertical"};function The(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],l=t.row-e.row,s=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],c=0;c<s;c++){var f=parseInt(r[0][c],10),h=parseInt(r[o-1][c],10),d=(n==="down"?h-f:f-h)/(o-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<l;v++){var g=parseInt(r[v][0],10),y=parseInt(r[v][i-1],10),w=(n==="right"?y-g:g-y)/(i-1)||0;a.push([w])}return a}function khe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function Phe(e){var t={};return e===!0?(t.directions=Object.keys(qo),t.autoInsertRow=!0):Ne(e)?(fe(e.autoInsertRow)?e.direction===qo.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,fe(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(qo)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function Wm(e){return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wm(e)}function Ahe(e){return Mhe(e)||$he(e)||KN(e)||Ihe()}function Ihe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $he(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mhe(e){if(Array.isArray(e))return Um(e)}function xhe(e,t){return Nhe(e)||Hhe(e,t)||KN(e,t)||Dhe()}function Dhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KN(e,t){if(e){if(typeof e=="string")return Um(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Um(e,t)}}function Um(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Nhe(e){if(Array.isArray(e))return e}function Lhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jhe(e,t,r){return t&&pA(e.prototype,t),r&&pA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qo(){return typeof Reflect<"u"&&Reflect.get?Qo=Reflect.get.bind():Qo=function(t,r,n){var o=Bhe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Qo.apply(this,arguments)}function Bhe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mn(e),e!==null););return e}function Fhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zm(e,t)}function zm(e,t){return zm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zm(e,t)}function Vhe(e){var t=Uhe();return function(){var n=mn(e),o;if(t){var i=mn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Whe(this,o)}}function Whe(e,t){if(t&&(Wm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XN(e)}function XN(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mn(e){return mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mn(e)}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");var gA="autofill",zhe=20,Ghe=["fillHandle"],Yhe="insert_row",Khe=200,Xhe=function(e){Fhe(r,e);var t=Vhe(r);function r(n){var o;return Lhe(this,r),o=t.call(this,n),o.eventManager=new vt(XN(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return jhe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),Qo(mn(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qo(mn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Qo(mn(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),c=u.row,f=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:c,endCol:f}]),d=[],v=[],g=[];return $(h,function(y){for(var w=y.startRow;w<=y.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var C=y.startCol;C<=y.endCol;C+=1)v.indexOf(C)===-1&&v.push(C)}),$(d,function(y){var w=[];$(v,function(C){w.push(o.hot.getCopyableData(y,C))}),g.push(w)}),g}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=xhe(i,4),l=a[0],s=a[1],u=a[2],c=a[3],f=this.hot.getSelectedRangeLast(),h=f.getTopStartCorner(),d=f.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],g=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,c)],v),y=khe(v,g,function(P,T){return o.hot._createCellCoords(P,T)}),w=y.directionOfDrag,C=y.startOfDragCoords,_=y.endOfDragCoords;if(C&&C.row>-1&&C.col>-1){var I=this.getSelectionData(),E=f.clone(),U=this.hot._createCellRange(C,C,_),G=this.hot.runHooks("beforeAutofill",I,E,U,w);if(G===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var Q=The(C,_,I,w),K=G,X=G;if(["up","left"].indexOf(w)>-1&&!(X.length===1&&X[0].length===0))if(K=[],w==="up")for(var J=_.row-C.row+1,le=J%X.length,ee=0;ee<J;ee++)K.push(X[(ee+(X.length-le))%X.length]);else for(var he=_.col-C.col+1,Ce=he%X[0].length,_e=0;_e<X.length;_e++){K.push([]);for(var be=0;be<he;be++)K[_e].push(X[_e][(be+(X[_e].length-Ce))%X[_e].length])}this.hot.populateFromArray(C.row,C.col,K,_.row,_.col,"".concat(this.pluginName,".fill"),null,w,Q),this.setSelection(g),this.hot.runHooks("afterAutofill",K,E,U,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(qo.vertical)&&this.directions.includes(qo.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(qo.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(qo.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(Yhe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},Khe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var c=i[s][u];if(c)return-1}var f=i[s][o[1]-1],h=i[s][o[3]+1];(f||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,Ahe(Fe(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Tt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+dt(this.hot.table),l=Tt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+Ze(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=Phe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){Qo(mn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gA}},{key:"PLUGIN_PRIORITY",get:function(){return zhe}},{key:"SETTING_KEYS",get:function(){return[gA].concat(Ghe)}}]),r}(Ke);function Gm(e){return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gm(e)}function qhe(e,t){return ede(e)||Jhe(e,t)||Zhe(e,t)||Qhe()}function Qhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zhe(e,t){if(e){if(typeof e=="string")return yA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yA(e,t)}}function yA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function ede(e){if(Array.isArray(e))return e}function tde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rde(e,t,r){return t&&mA(e.prototype,t),r&&mA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ta(){return typeof Reflect<"u"&&Reflect.get?Ta=Reflect.get.bind():Ta=function(t,r,n){var o=nde(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ta.apply(this,arguments)}function nde(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function ode(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ym(e,t)}function Ym(e,t){return Ym=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ym(e,t)}function ide(e){var t=sde();return function(){var n=ho(e),o;if(t){var i=ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ade(this,o)}}function ade(e,t){if(t&&(Gm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lde(e)}function lde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(e)}var ec="autoRowSize",ude=40,cde="autoRowSize",fde=function(e){ode(r,e);var t=ide(r);function r(n){var o;return tde(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new zN(o.hot),o.samplesGenerator=new GN(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Po,o.hot.rowIndexMapper.registerMap(cde,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return rde(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[ec];return o===!0||Ne(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),Ta(ho(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,Ta(ho(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var c=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(c.get(-1))}me(s.from,s.to,function(f){if(l||o.rowHeightsMap.getValueAtIndex(f)===null){var h=o.samplesGenerator.generateRowSamples(f,u);$(h,function(d){var v=qhe(d,2),g=v[0],y=v[1];return o.ghostTable.addRow(g,y)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(f,h){f<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(f),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function f(){if(!o.hot){vf(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=sD(f):(vf(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateRowsHeight({from:0,to:c},i),this.firstCalculation=!1,a=c+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[ec],i=o&&it(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&it(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){bs(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[ec],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ne(o)&&(i=o.syncLimit,kD(i)?i=YD(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){me(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Cr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),Ta(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ec}},{key:"PLUGIN_PRIORITY",get:function(){return ude}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(Ke);function Km(e){return Km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Km(e)}function hde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dde(e,t,r){return t&&bA(e.prototype,t),r&&bA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function us(){return typeof Reflect<"u"&&Reflect.get?us=Reflect.get.bind():us=function(t,r,n){var o=vde(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},us.apply(this,arguments)}function vde(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hi(e),e!==null););return e}function pde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xm(e,t)}function Xm(e,t){return Xm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Xm(e,t)}function gde(e){var t=bde();return function(){var n=Hi(e),o;if(t){var i=Hi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yde(this,o)}}function yde(e,t){if(t&&(Km(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mde(e)}function mde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hi(e){return Hi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hi(e)}var qN=JH("physicallyIndexed"),wde=qN.getListWithInsertedItems,Sde=qN.getListWithRemovedItems,Cde=function(e){pde(r,e);var t=gde(r);function r(){return hde(this,r),t.call(this,function(n){return n})}return dde(r,[{key:"insert",value:function(o,i){var a=NC(this.indexedValues,i);this.indexedValues=wde(a,o,i,this.initValueOrFn),us(Hi(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=Sde(this.indexedValues,o);this.indexedValues=HC(i,o),us(Hi(r.prototype),"remove",this).call(this,o)}}]),r}(Gi);const _de=Cde;function qm(e){return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qm(e)}function Ode(e){return kde(e)||Tde(e)||Ede(e)||Rde()}function Rde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ede(e,t){if(e){if(typeof e=="string")return Qm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qm(e,t)}}function Tde(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kde(e){if(Array.isArray(e))return Qm(e)}function Qm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ade(e,t,r){return t&&wA(e.prototype,t),r&&wA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cs(){return typeof Reflect<"u"&&Reflect.get?cs=Reflect.get.bind():cs=function(t,r,n){var o=Ide(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cs.apply(this,arguments)}function Ide(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ni(e),e!==null););return e}function $de(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zm(e,t)}function Zm(e,t){return Zm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Zm(e,t)}function Mde(e){var t=Hde();return function(){var n=Ni(e),o;if(t){var i=Ni(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xde(this,o)}}function xde(e,t){if(t&&(qm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dde(e)}function Dde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ni(e){return Ni=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ni(e)}var QN=JH("physicallyIndexed"),Nde=QN.getListWithInsertedItems,Lde=QN.getListWithRemovedItems,jde=function(e){$de(r,e);var t=Mde(r);function r(){return Pde(this,r),t.call(this,function(n){return n})}return Ade(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=Nde(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),cs(Ni(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=Lde(this.indexedValues,o),cs(Ni(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,Ode(this.getValues()))+1+o}}]),r}(Gi);const Bde=jde;function Jm(e){return Jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jm(e)}function Fde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vde(e,t,r){return t&&SA(e.prototype,t),r&&SA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ka(){return typeof Reflect<"u"&&Reflect.get?ka=Reflect.get.bind():ka=function(t,r,n){var o=Wde(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ka.apply(this,arguments)}function Wde(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function Ude(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eb(e,t)}function eb(e,t){return eb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eb(e,t)}function zde(e){var t=Kde();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Gde(this,o)}}function Gde(e,t){if(t&&(Jm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yde(e)}function Yde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}var np="bindRowsWithHeaders",Xde=210,qde="loose",Qde=new Map([["loose",_de],["strict",Bde]]),Zde=function(e){Ude(r,e);var t=zde(r);function r(n){var o;return Fde(this,r),o=t.call(this,n),o.headerIndexes=null,o}return Vde(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[np]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[np];typeof i!="string"&&(i=qde);var a=Qde.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),ka(vo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),ka(vo(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){ka(vo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return np}},{key:"PLUGIN_PRIORITY",get:function(){return Xde}}]),r}(Ke);function tb(e){return tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tb(e)}function CA(e){return rve(e)||tve(e)||eve(e)||Jde()}function Jde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eve(e,t){if(e){if(typeof e=="string")return rb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rb(e,t)}}function tve(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rve(e){if(Array.isArray(e))return rb(e)}function rb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ove(e,t,r){return t&&_A(e.prototype,t),r&&_A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zo(){return typeof Reflect<"u"&&Reflect.get?Zo=Reflect.get.bind():Zo=function(t,r,n){var o=ive(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Zo.apply(this,arguments)}function ive(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bn(e),e!==null););return e}function ave(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nb(e,t)}function nb(e,t){return nb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nb(e,t)}function lve(e){var t=uve();return function(){var n=bn(e),o;if(t){var i=bn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sve(this,o)}}function sve(e,t){if(t&&(tb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _a(e)}function _a(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bn(e){return bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bn(e)}function cve(e,t,r){fve(e,t),t.set(e,r)}function fve(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function op(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OA(e,t){var r=ZN(e,t,"get");return hve(e,r)}function hve(e,t){return t.get?t.get.call(e):t.value}function ip(e,t,r){var n=ZN(e,t,"set");return dve(e,n,r),r}function ZN(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function dve(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ap="collapsibleColumns",vve=290,pve=["nestedHeaders"],RA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),ua=new WeakMap,gve=function(e){ave(r,e);var t=lve(r);function r(){var n;nve(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),op(_a(n),"nestedHeadersPlugin",null),op(_a(n),"eventManager",new vt(_a(n))),op(_a(n),"headerStateManager",null),cve(_a(n),ua,{writable:!0,value:null}),n}return ove(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ap]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||ot("You need to configure the Nested Headers plugin in order to use collapsible headers."),ip(this,ua,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(l,s){return o.onAfterGetColHeader(l,s)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),Zo(bn(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}Zo(bn(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ip(this,ua,null),this.nestedHeadersPlugin=null,this.clearButtons(),Zo(bn(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(c){c&&c.parentNode.removeChild(c)};me(0,o-1,function(u){var c=i.childNodes[u],f=a.childNodes[u],h=l?l.childNodes[u]:null;me(0,c.childNodes.length-1,function(d){var v=c.childNodes[d].querySelector(".collapsibleIndicator");s(v),f&&f.childNodes[d]&&(v=f.childNodes[d].querySelector(".collapsibleIndicator"),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".collapsibleIndicator"),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,c=l.headerLevel,f=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(c),col:f}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!RA.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Cr(o,function(y){var w=y.row;return w<0}),s=l.length>0;$(l,function(y){var w,C=y.row,_=y.col,I=(w=a.headerStateManager.getHeaderSettings(C,_))!==null&&w!==void 0?w:{},E=I.collapsible,U=I.isCollapsed;if(!E||U&&i==="collapse"||!U&&i==="expand")return s=!1,!1});var u=[],c=[];s&&$(l,function(y){var w=y.row,C=y.col,_=a.headerStateManager.triggerNodeModification(i,w,C),I=_.colspanCompensation,E=_.affectedColumns,U=_.rollbackModification;I>0&&(c.push.apply(c,CA(E)),u.push(U))});var f=this.getCollapsedColumns(),h=[];i==="collapse"?h=bD([].concat(CA(f),c)):i==="expand"&&(h=Cr(f,function(y){return!c.includes(y)}));var d=RA.get(i),v=this.hot.runHooks(d.beforeHook,f,h,s);if(v===!1){$(u,function(y){y()});return}this.hot.batchExecution(function(){$(c,function(y){OA(a,ua).setValueAtIndex(a.hot.toPhysicalColumn(y),d.hideColumn)})},!0);var g=this.getCollapsedColumns().length!==f.length;this.hot.runHooks(d.afterHook,f,h,s,g),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return OA(this,ua).getHiddenIndexes()}},{key:"generateIndicator",value:function(o,i){var a=this.hot.rootDocument.createElement("div"),l=this.headerStateManager.getHeaderSettings(o,i);return re(a,"collapsibleIndicator"),l.isCollapsed?(re(a,"collapsed"),Ti(a,"+")):(re(a,"expanded"),Ti(a,"-")),a}},{key:"onAfterGetColHeader",value:function(o,i){var a,l=i.parentNode,s=l.parentNode,u=-1*s.childNodes.length+Array.prototype.indexOf.call(s.childNodes,l),c=(a=this.headerStateManager.getHeaderSettings(u,o))!==null&&a!==void 0?a:{},f=c.collapsible,h=c.origColspan;if(f&&h>1&&o>=this.hot.getSettings().fixedColumnsStart){var d=this.generateIndicator(u,o);i.querySelector("div:first-child").appendChild(d)}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,"collapsibleIndicator")&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),rn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){ip(this,ua,null),Zo(bn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ap}},{key:"PLUGIN_PRIORITY",get:function(){return vve}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[ap].concat(pve)}}]),r}(Ke);function EA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yve(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EA(Object(r),!0).forEach(function(n){mve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TA(e,t){return Cve(e)||Sve(e,t)||wve(e,t)||bve()}function bve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wve(e,t){if(e){if(typeof e=="string")return kA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kA(e,t)}}function kA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Cve(e){if(Array.isArray(e))return e}function _ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ove(e,t,r){return t&&PA(e.prototype,t),r&&PA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Rve=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Eve=!1,Tve=!0,kve=!0,Pve=function(){function e(t,r){_ve(this,e),this.hot=t,this.sortingStates=new Yh,this.sortEmptyCells=Eve,this.indicator=Tve,this.headerAction=kve,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return Ove(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ne(r)&&Ve(r,function(o,i){Rve.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=TA(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ne(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=TA(o,2),a=i[0],l=i[1];return yve({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(fe(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),oh="asc",ih="desc",Ave="colHeader";function Ive(e){if(Ne(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[oh,ih].includes(r)}function $ve(e){if(e.some(function(r){return Ive(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function AA(e){if(e!==ih)return e===oh?ih:oh}function IA(e){var t=e.querySelector(".".concat(Ave));return t}function $A(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function ob(e,t,r){return e===-1&&t>=0&&Pi(r)===!1}var Mve="ascending",xve="descending",JN="indicatorDisabled",eL="columnSorting",tL="sortAction",rL=new Map([[oh,Mve],[ih,xve]]);function Dve(e,t,r,n){var o=[eL];if(n&&o.push(tL),r===!1)return o.push(JN),o;var i=e.getSortOrderOfColumn(t);return fe(i)&&o.push(rL.get(i)),o}function Hve(){return Array.from(rL.values()).concat(tL,JN,eL)}function nL(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?en:At(o)?At(i)?en:a&&e==="asc"?ct:ft:At(i)?a&&e==="asc"?ft:ct:isNaN(o)&&!isNaN(i)?e==="asc"?ft:ct:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?ct:ft:o>i?e==="asc"?ft:ct:en}}var oL="default";function Nve(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return en;if(l){if(At(n))return e==="asc"?ct:ft;if(At(o))return e==="asc"?ft:ct}return isNaN(i)?ft:isNaN(a)?ct:i<a?e==="asc"?ct:ft:i>a?e==="asc"?ft:ct:en}}var Lve="numeric";function jve(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=At(a),u=At(l),c=s?o:a,f=u?o:l,h=c===o||c===n,d=f===o||f===n;if(i===!1){if(s&&u===!1)return ft;if(s===!1&&u)return ct}return h===!1&&d?e==="asc"?ct:ft:h&&d===!1?e==="asc"?ft:ct:h===!1&&d===!1?nL(e,t,r)(a,l):c===o&&f===n?e==="asc"?ct:ft:c===n&&f===o?e==="asc"?ft:ct:en}}var Bve="checkbox";function Fve(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return en;if(At(n))return At(o)?en:i&&e==="asc"?ct:ft;if(At(o))return i&&e==="asc"?ft:ct;var a=t.dateFormat,l=Xe(n,a),s=Xe(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?ct:ft:s.isBefore(l)?e==="asc"?ft:ct:en:ct:ft}}var Vve="date",gO=Rr("sorting.compareFunctionFactory"),dd=gO.register,MA=gO.getItem,Wve=gO.hasItem,iL=Rr("sorting.mainSortComparator"),aL=iL.register,Uve=iL.getItem;function lL(e){return Wve(e)?MA(e):MA(oL)}dd(Lve,Nve);dd(Bve,jve);dd(Vve,Fve);dd(oL,nL);var en=0,ct=-1,ft=1;function zve(e,t){for(var r=Uve(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function xA(e){return Xve(e)||Kve(e)||Yve(e)||Gve()}function Gve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yve(e,t){if(e){if(typeof e=="string")return DA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DA(e,t)}}function DA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kve(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xve(e){if(Array.isArray(e))return e}function qve(e,t){return function(r,n){var o=xA(r),i=o.slice(1),a=xA(n),l=a.slice(1);return function(u){var c=e[u],f=t[u],h=i[u],d=l[u],v=f.columnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:lL(f.type),y=g(c,f,v)(h,d);return y}(0)}}function ib(e){return ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ib(e)}var Qve=["column"],Zve=["column"];function ca(e){return rpe(e)||tpe(e)||epe(e)||Jve()}function Jve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function epe(e,t){if(e){if(typeof e=="string")return ab(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ab(e,t)}}function tpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rpe(e){if(Array.isArray(e))return ab(e)}function ab(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function NA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HA(Object(r),!0).forEach(function(n){npe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function npe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LA(e,t){if(e==null)return{};var r=ope(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ope(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function ipe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ape(e,t,r){return t&&jA(e.prototype,t),r&&jA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jo(){return typeof Reflect<"u"&&Reflect.get?Jo=Reflect.get.bind():Jo=function(t,r,n){var o=lpe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Jo.apply(this,arguments)}function lpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wn(e),e!==null););return e}function spe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lb(e,t)}function lb(e,t){return lb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lb(e,t)}function upe(e){var t=hpe();return function(){var n=wn(e),o;if(t){var i=wn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cpe(this,o)}}function cpe(e,t){if(t&&(ib(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fpe(e)}function fpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wn(e){return wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wn(e)}var sb="columnSorting",dpe=50,BA="append",vpe="replace";aL(sb,qve);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var sL=function(e){spe(r,e);var t=upe(r);function r(n){var o;return ipe(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=sb,o.indexesSequenceCache=null,o}return ape(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new Pve(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Po(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Jo(wn(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=IA(s);$A(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Jo(wn(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new eN),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return fe(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return $ve(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var c=u.column,f=LA(u,Qve);return NA({column:i.hot.toPhysicalColumn(c)},f)};a.initialConfig=Fe(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var c=u.column,f=LA(u,Zve);return NA({column:o.hot.toVisualColumn(c)},f)};return fe(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=Fe(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(fe(i)){var a=AA(i);return fe(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:AA()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:BA,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(at(u))return[].concat(ca(s.slice(0,a)),ca(s.slice(a+1)));if(i===BA)return[].concat(ca(s.slice(0,a)),ca(s.slice(a+1)),[u]);if(i===vpe)return[].concat(ca(s.slice(0,a)),[u],ca(s.slice(a+1)))}return fe(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ne(o)){var i=o[this.pluginKey];if(Ne(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):nt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(y){return Fe(o,function(w){return i.hot.getDataAtCell(y,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var c=Fe(a,function(g){return g[0]});zve(a,this.pluginKey,Fe(o,function(g){return g.sortOrder}),Fe(o,function(g){return i.getFirstCellSettings(g.column)}));for(var f=a.length;f<l;f+=1)a.push([f].concat(s(f)));var h=Fe(a,function(g){return g[0]}),d=new Map(Fe(c,function(g,y){return[g,h[y]]})),v=Fe(this.hot.rowIndexMapper.getIndexesSequence(),function(g){return d.has(g)?d.get(g):g});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ne(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ne(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ne(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=IA(i);if(!($A(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(De(o,Hve()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];re(o,Dve.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){Jo(wn(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),fe(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){ob(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){ob(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),Jo(wn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sb}},{key:"PLUGIN_PRIORITY",get:function(){return dpe}}]),r}(Ke),ppe=Ae,yO=He,gpe=Eo,ype=QD,mpe=RD,FA=Le,bpe=RangeError,uL=String,cL=Math.floor,ub=yO(mpe),VA=yO("".slice),Ll=yO(1 .toFixed),Ra=function(e,t,r){return t===0?r:t%2===1?Ra(e,t-1,r*e):Ra(e*e,t/2,r)},wpe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},fa=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=cL(o/1e7)},lp=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=cL(n/t),n=n%t*1e7},WA=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=uL(e[t]);r=r===""?n:r+ub("0",7-n.length)+n}return r},Spe=FA(function(){return Ll(8e-5,3)!=="0.000"||Ll(.9,0)!=="1"||Ll(1.255,2)!=="1.25"||Ll(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!FA(function(){Ll({})});ppe({target:"Number",proto:!0,forced:Spe},{toFixed:function(t){var r=ype(this),n=gpe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,c;if(n<0||n>20)throw bpe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return uL(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=wpe(r*Ra(2,69,1))-69,s=l<0?r*Ra(2,-l,1):r/Ra(2,l,1),s*=4503599627370496,l=52-l,l>0){for(fa(o,0,s),u=n;u>=7;)fa(o,1e7,0),u-=7;for(fa(o,Ra(10,u,1),0),u=l-1;u>=23;)lp(o,1<<23),u-=23;lp(o,1<<u),fa(o,1,1),lp(o,2),a=WA(o)}else fa(o,0,s),fa(o,1<<-l,0),a=WA(o)+ub("0",n);return n>0?(c=a.length,a=i+(c<=n?"0."+ub("0",n-c)+a:VA(a,0,c-n)+"."+VA(a,c-n))):a=i+a,a}});function Cpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _pe(e,t,r){return t&&UA(e.prototype,t),r&&UA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ope=function(){function e(t,r){Cpe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return _pe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),$(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();$(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function g(){return l.hot.removeHook("beforeViewRender",g),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var c=r.indexOf("row")>-1?"row":"col",f=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;$(h,function(g){c==="row"&&g.destinationRow>=v&&(g.alterRowOffset=f*o),c==="col"&&g.destinationColumn>=v&&(g.alterColumnOffset=f*o)}),this.resetAllEndpoints(h,!d),d?$(h,function(g){l.extendEndpointRanges(g,v,i[0],i.length),l.recreatePhysicalRanges(g),l.clearOffsetInformation(g)}):$(h,function(g){l.shiftEndpointCoordinates(g,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){$(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];$(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),$(a,function(l){var s=[];$(l,function(u,c){c===0?s.push(u):l[c]!==l[c-1]+1&&(s.push(l[c-1]),i.push(s),s=[],s.push(u)),c===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,$(r.ranges,function(o){$(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],$(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],$(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],$(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&$(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),$(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0,a=[this.hot.toVisualRow(r.destinationRow),this.hot.toVisualColumn(r.destinationColumn)],l=a[0],s=a[1];if(s!==null&&l!==null){var u=this.hot.getCellMeta(l,s);u.readOnly=!1,u.className=""}this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=-1*r.alterRowOffset||0,a=-1*r.alterColumnOffset||0,l=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var s=this.hot.toVisualRow(r.destinationRow+i);if(s!==null){var u=this.hot.getCellMeta(s,r.destinationColumn+a);(n==="init"||u.readOnly!==r.readOnly)&&(u.readOnly=r.readOnly,u.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(l,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([l,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){ot("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const Rpe=Ope;function sp(e){return e==null||isNaN(e)}function cb(e){return cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cb(e)}var zA;function Epe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Tpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kpe(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zc(){return typeof Reflect<"u"&&Reflect.get?zc=Reflect.get.bind():zc=function(t,r,n){var o=Ppe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},zc.apply(this,arguments)}function Ppe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qa(e),e!==null););return e}function Ape(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fb(e,t)}function fb(e,t){return fb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fb(e,t)}function Ipe(e){var t=xpe();return function(){var n=Qa(e),o;if(t){var i=Qa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $pe(this,o)}}function $pe(e,t){if(t&&(cb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mpe(e)}function Mpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qa(e){return Qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qa(e)}var up="columnSummary",Dpe=220,Hpe=function(e){Ape(r,e);var t=Ipe(r);function r(n){var o;return Tpe(this,r),o=t.call(this,n),o.endpoints=null,o}return kpe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[up]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[up],this.endpoints=new Rpe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),zc(Qa(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return Ve(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=sp(s)?null:s,s!==null){var c=("".concat(s).split(".")[1]||[]).length||1;c>u&&(u=c)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return Ve(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=sp(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=sp(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return Ve(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,c=i.countEmpty(s,o.sourceColumn);a+=u,a-=c}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Je(zA||(zA=Epe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return up}},{key:"PLUGIN_PRIORITY",get:function(){return Dpe}}]),r}(Ke);function Npe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lpe(e,t,r){return t&&YA(e.prototype,t),r&&YA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var jpe=function(){function e(t,r){Npe(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Lpe(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:Ze(this.getInputElement()),height:dt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),re(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),re(r,e.CLASS_EDITOR),re(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const Bpe=jpe;var Be="---------";function Fpe(){return{name:Be}}function Vpe(e){return Fe(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function tc(e){return xe(e,"htSeparator")}function Wpe(e){return xe(e,"htSubmenu")}function rc(e){return xe(e,"htDisabled")}function nc(e){return xe(e,"htSelectionDisabled")}function Ki(e){var t=e.getSelected();return!t||t[0]<0?null:t}function Upe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function zpe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function jo(e,t){var r={};return $(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function no(e,t,r,n,o){$(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&Gpe(a,l,t,r,n,o)})})}function Gpe(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=Upe(a.className,n):l=zpe(a.className,n)),i(e,t,"className",l)}function Qr(e,t){var r=!1;return Array.isArray(e)&&$(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function dn(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Ype(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function fL(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function Kpe(e,t){var r=e.slice(0);return r.reverse(),r=fL(r,t),r.reverse(),r}function Xpe(e){var t=[];return $(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function qpe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Be,r=e.slice(0);return r=fL(r,t),r=Kpe(r,t),r=Xpe(r),r}function Qpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zpe(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Jpe=250,ege=250,hL=function(){function e(t){Qpe(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return Zpe(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},ege)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jpe;this.showDebounced=VD(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();rt(hL,or);const tge=hL;function hb(e){return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hb(e)}function cp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nge(e,t,r){return t&&XA(e.prototype,t),r&&XA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ei(){return typeof Reflect<"u"&&Reflect.get?ei=Reflect.get.bind():ei=function(t,r,n){var o=oge(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ei.apply(this,arguments)}function oge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Sn(e),e!==null););return e}function ige(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&db(e,t)}function db(e,t){return db=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},db(e,t)}function age(e){var t=sge();return function(){var n=Sn(e),o;if(t){var i=Sn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lge(this,o)}}function lge(e,t){if(t&&(hb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dL(e)}function dL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sn(e){return Sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sn(e)}var fp="comments",uge=60,oc=new WeakMap,Ur="comment",ha="value",qA="style",ic="readOnly",cge=function(e){ige(r,e);var t=age(r);function r(n){var o;return rge(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,oc.set(dL(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return nge(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fp]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new Bpe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new vt(this)),this.displaySwitch||(this.displaySwitch=new tge(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,c){return o.onAfterRenderer(i,c)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),ei(Sn(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ei(Sn(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){ei(Sn(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=_i(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&_i(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,cp({},ha,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ur),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,ha)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,ha)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[Ur]?l[Ur][ha]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,c=this.range.from,f=c.row,h=c.col,d=s.getRenderableFromVisualIndex(f),v=u.getRenderableFromVisualIndex(h),g=d===null;d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(f,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var y=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var C=this.hot,_=C.rootWindow,I=C.view._wt,E=I.wtTable,U=E.getCell({row:d,col:v}),G=this.getCommentMeta(f,h,qA);G?this.editor.setSize(G.width,G.height):this.editor.resetSize();var Q=w?0:E.getStretchedColumnWidth(v),K=g&&!y?dt(U):0,X=U.getBoundingClientRect(),J=X.left,le=X.top,ee=X.width,he=X.height,Ce=this.editor.getSize(),_e=Ce.width,be=Ce.height,P=this.hot.rootWindow,T=P.innerWidth,Y=P.innerHeight,p=this.hot.rootDocument.documentElement,m=J+_.scrollX+Q,b=le+_.scrollY+K;this.hot.isRtl()&&(m-=_e+Q),this.hot.isLtr()&&J+ee+_e>T?m=J+_.scrollX-_e-1:this.hot.isRtl()&&m<-(p.scrollWidth-p.clientWidth)&&(m=J+_.scrollX+Q+1),le+be>Y&&(b-=be-he+1),this.editor.setPosition(m,b),this.editor.setReadOnlyState(this.getCommentMeta(f,h,ic))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,ha)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[Ur],s;l?(s=Kt(l),Fh(s,a)):s=a,this.hot.setCellMeta(o,i,Ur,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[Ur])return l[Ur][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=_i(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=oc.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else Oi(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[Ur]&&i[Ur][ha]&&re(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=oc.get(this);i.tempEditorDimensions={width:Ze(o.target),height:dt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=oc.get(this),a=Ze(o.target),l=dt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,cp({},qA,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,ic);o.updateCommentMeta(a,l,cp({},ic,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(n_):i.hot.getTranslatedPhrase(r_)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(o_)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(i_),c=Qr(this.getSelectedRangeLast(),function(f,h){var d=s.getCellMeta(f,h)[Ur];if(d&&(d=d[ic]),d)return!0});return c&&(u=dn(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[fp];if(Ne(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),ei(Sn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fp}},{key:"PLUGIN_PRIORITY",get:function(){return uge}}]),r}(Ke);function fge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hge(e,t,r){return t&&QA(e.prototype,t),r&&QA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var dge=function(){function e(t){fge(this,e),this.hot=t,this.commands={},this.commonCallback=null}return hge(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,c=this.commands[s];if(!c)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&c.submenu&&(c=vge(u,c.submenu.items)),c.disabled!==!0&&!(typeof c.disabled=="function"&&c.disabled.call(this.hot)===!0)&&!it(c,"submenu")){var f=[];typeof c.callback=="function"&&f.push(c.callback),typeof this.commonCallback=="function"&&f.push(this.commonCallback),i.unshift(l.join(":")),$(f,function(h){return h.apply(n.hot,i)})}}}]),e}();function vge(e,t){var r;return $(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const vL=dge;var mr="alignment";function pge(){return{key:mr,name:function(){return this.getTranslatedPhrase(a_)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(mr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(l_),n=Qr(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=dn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jo(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),no(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(mr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(s_),n=Qr(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=dn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jo(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),no(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(mr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(u_),n=Qr(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=dn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jo(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),no(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(mr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(c_),n=Qr(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=dn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jo(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),no(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:Be},{key:"".concat(mr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(f_),n=Qr(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=dn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jo(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),no(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(mr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(h_),n=Qr(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=dn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jo(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),no(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(mr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(d_),n=Qr(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=dn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jo(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),no(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var vd="clear_column";function gge(){return{key:vd,name:function(){return this.getTranslatedPhrase(XC)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=Ki(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var fu="col_left";function yge(){return{key:fu,name:function(){return this.getTranslatedPhrase(VC)},callback:function(){var t=this.selection.isSelectedByCorner(),r=this.isRtl()?this.countCols():0;if(!t){var n=this.getSelectedRangeLast();if(fe(n)){var o=n.getTopLeftCorner(),i=o.col;r=this.isRtl()?i+1:i}}this.alter("insert_col",r,1,"ContextMenu.columnLeft"),t&&this.selectAll()},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Ki(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var hu="col_right";function mge(){return{key:hu,name:function(){return this.getTranslatedPhrase(WC)},callback:function(){var t=this.selection.isSelectedByCorner(),r=this.isRtl()?0:this.countCols();if(!t){var n=this.getSelectedRangeLast();if(fe(n)){var o=n.getTopRightCorner(),i=o.col;r=this.isRtl()?i:i+1}}this.alter("insert_col",r,1,"ContextMenu.columnRight"),t&&this.selectAll()},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Ki(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var du="make_read_only";function bge(){return{key:du,name:function(){var t=this,r=this.getTranslatedPhrase(KC),n=Qr(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=dn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Qr(r,function(o,i){return t.getCellMeta(o,i).readOnly});$(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var pd="redo";function wge(){return{key:pd,name:function(){return this.getTranslatedPhrase(YC)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function Sge(e,t){return Rge(e)||Oge(e,t)||_ge(e,t)||Cge()}function Cge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _ge(e,t){if(e){if(typeof e=="string")return ZA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZA(e,t)}}function ZA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oge(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Rge(e){if(Array.isArray(e))return e}var vu="remove_col";function Ege(){return{key:vu,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=Sge(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(zC,r)},callback:function(){this.alter("remove_col",$ae(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Ki(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function Tge(e,t){return Ige(e)||Age(e,t)||Pge(e,t)||kge()}function kge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pge(e,t){if(e){if(typeof e=="string")return JA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JA(e,t)}}function JA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Age(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Ige(e){if(Array.isArray(e))return e}var gd="remove_row";function $ge(){return{key:gd,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=Tge(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(UC,r)},callback:function(){this.alter("remove_row",Mae(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=Ki(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var yd="row_above";function Mge(){return{key:yd,name:function(){return this.getTranslatedPhrase(BC)},callback:function(t,r){var n=this.selection.isSelectedByCorner(),o=0;if(!n){var i=r[Math.max(r.length-1,0)];o=i.start.row}this.alter("insert_row",o,1,"ContextMenu.rowAbove"),n&&this.selectAll()},disabled:function(){var t=Ki(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var md="row_below";function xge(){return{key:md,name:function(){return this.getTranslatedPhrase(FC)},callback:function(t,r){var n=this.selection.isSelectedByCorner(),o=0;if(n)o=this.countRows();else{var i,a=r[Math.max(r.length-1,0)],l=a==null||(i=a.end)===null||i===void 0?void 0:i.row;o=fe(l)?l+1:0}this.alter("insert_row",o,1,"ContextMenu.rowBelow"),n&&this.selectAll()},disabled:function(){var t=Ki(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Is="no_items";function Dge(){return{key:Is,name:function(){return this.getTranslatedPhrase(jC)},disabled:!0,isCommand:!1}}var bd="undo";function Hge(){return{key:bd,name:function(){return this.getTranslatedPhrase(GC)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}var Ut;function ar(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Nge=[yd,md,fu,hu,vd,gd,vu,bd,pd,du,mr,Be,Is],Lge=(Ut={},ar(Ut,Be,Fpe),ar(Ut,Is,Dge),ar(Ut,yd,Mge),ar(Ut,md,xge),ar(Ut,fu,yge),ar(Ut,hu,mge),ar(Ut,vd,gge),ar(Ut,gd,$ge),ar(Ut,vu,Ege),ar(Ut,bd,Hge),ar(Ut,pd,wge),ar(Ut,du,bge),ar(Ut,mr,pge),Ut);function pL(){var e={};return Ve(Lge,function(t,r){e[r]=t()}),e}function jge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Bge(e,t,r){return t&&eI(e.prototype,t),r&&eI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Fge=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;jge(this,e),this.hot=t,this.predefinedItems=pL(),this.defaultOrderPattern=r}return Bge(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,Ve(r,function(i,a){var l="";i.name===Be?(o[Be]=i,l=Be):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Vge(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function Vge(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ne(o)?Ve(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ne(i)?ht(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):$(o,function(i,a){var l=r[i];!l&&Nge.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ne(i)&&ht(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const gL=Fge;function Wge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Uge(e,t,r){return t&&tI(e.prototype,t),r&&tI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var zge=function(){function e(t,r){Wge(this,e);var n=ws(r),o=Ba(r),i,a,l,s,u,c;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,c=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,c=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=c}return Uge(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const Gge=zge;function rI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rI(Object(r),!0).forEach(function(n){Yge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xge(e,t,r){return t&&oI(e.prototype,t),r&&oI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var iI=215,yL="menu",qge=yL,mL=function(){function e(t,r){Kge(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:iI,container:this.hot.rootDocument.documentElement},this.eventManager=new vt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return Xge(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=yf(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=VD(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||iI,i=!1,a=Cr(this.menuItems,function(d){return d.key===Is&&(i=!0),Ype(d,r.hot)});if(a.length<1&&!i)a.push(pL()[Is]);else if(a.length===0)return;a=qpe(a,Be);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return fe(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,g,y,w,C,_){return r.menuItemRenderer(v,g,y,w,C,_)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,g){r.isAllSubMenusClosed()?n(g.row):r.openSubMenu(g.row)},rowHeights:function(v){return a[v].name===Be?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),GE()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!GE()||!Pi(v))&&l&&r.hasSelectedItem()&&(Jr()||CD()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new iO(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),c=u.addContext(qge),f={group:yL},h=nI(nI({},f),{},{runOnlyIf:function(v){return wf(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),c.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var g=r.openSubMenu(v[0]);g&&g.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var g=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(g[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!Wpe(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;$(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?Vpe(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===Be||l===!0||a}},{key:"setPosition",value:function(r){var n=new Gge(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);tc(r)||rc(r)||nc(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);tc(n)||rc(n)||nc(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(tc(i)||rc(i)||nc(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(tc(i)||rc(i)||nc(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),c=this.hot.rootDocument.createElement("div"),f=function(w){return it(w,"submenu")},h=function(w){return new RegExp(Be,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},g=l;typeof g=="function"&&(g=g.call(this.hot)),Hr(n),re(c,"htItemWrapper"),n.appendChild(c),h(u)?re(n,"htSeparator"):typeof u.renderer=="function"?(re(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,c,o,i,a,g))):zi(c,g),d(u)?(re(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(re(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):f(u)?(re(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(De(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(nt(o)&&(o=o.call(this.hot),o===null||at(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),re(i,"htMenu ".concat(this.options.className)),o&&re(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=Vt(n,function(s,u){return s+(u.name===Be?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Oi(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Oi(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&Oi(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();rt(mL,or);const mO=mL;function vb(e){return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vb(e)}function Qge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zge(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ti(){return typeof Reflect<"u"&&Reflect.get?ti=Reflect.get.bind():ti=function(t,r,n){var o=Jge(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ti.apply(this,arguments)}function Jge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cn(e),e!==null););return e}function eye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pb(e,t)}function pb(e,t){return pb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pb(e,t)}function tye(e){var t=nye();return function(){var n=Cn(e),o;if(t){var i=Cn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rye(this,o)}}function rye(e,t){if(t&&(vb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bL(e)}function bL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cn(e){return Cn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cn(e)}var ac="contextMenu",oye=70;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var wL=function(e){eye(r,e);var t=tye(r);function r(n){var o;return Qge(this,r),o=t.call(this,n),o.eventManager=new vt(bL(o)),o.commandExecutor=new vL(o.hot),o.itemsFactory=null,o.menu=null,o}return Zge(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ac]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[ac];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new mO(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),ti(Cn(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ti(Cn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),ti(Cn(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,c=s.left;i=u-ws(o.view),a=c-Ba(o.view)}else i=-1*ws(this.menu.hotMenu.rootWindow),a=-1*Ba(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new gL(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[ac],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),$(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(c){return c.nodeName==="TD"||c.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ti(Cn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ac}},{key:"PLUGIN_PRIORITY",get:function(){return oye}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[yd,md,Be,fu,hu,Be,gd,vu,Be,bd,pd,Be,du,Be,mr]}}]),r}(Ke);wL.SEPARATOR={name:Be};function iye(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(qC)},callback:function(){e.copy()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function aye(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(QC)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function lye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sye(e,t,r){return t&&lI(e.prototype,t),r&&lI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var uye=function(){function e(){lye(this,e),this.data={}}return sye(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function sI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cye(e,t,r){return t&&sI(e.prototype,t),r&&sI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var hye=cye(function e(){fye(this,e),this.clipboardData=new uye});function dye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vye(e,t,r){return t&&uI(e.prototype,t),r&&uI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var bO=function(){function e(t){dye(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new vt(this),this.listenersCount=new WeakSet,this.container=t}return vye(e,[{key:"useSecondaryElement",value:function(){var r=yye(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),cI(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),cI(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Jr()||C5(this.mainElement)}}]),e}();rt(bO,or);var ah=new WeakMap;function pye(e){var t=new bO(e),r=ah.get(e);return r=isNaN(r)?0:r,ah.set(e,r+1),t}function gye(e){e.eventManager.clear()}var hp=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function cI(e,t,r){e.addEventListener(t,"copy",hp("copy",r)),e.addEventListener(t,"cut",hp("cut",r)),e.addEventListener(t,"paste",hp("paste",r))}var lh=new WeakMap;function yye(e){var t=lh.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return lh.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function fI(e){if(e instanceof bO){var t=ah.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),gye(e),t<=0){t=0;var r=lh.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),lh.delete(e.container)),e.mainElement=null}ah.set(e.container,t)}}function mye(e,t){return Cye(e)||Sye(e,t)||wye(e,t)||bye()}function bye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wye(e,t){if(e){if(typeof e=="string")return hI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hI(e,t)}}function hI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Cye(e){if(Array.isArray(e))return e}function sh(e){return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function _ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Oye(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ri(){return typeof Reflect<"u"&&Reflect.get?ri=Reflect.get.bind():ri=function(t,r,n){var o=Rye(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ri.apply(this,arguments)}function Rye(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_n(e),e!==null););return e}function Eye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gb(e,t)}function gb(e,t){return gb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gb(e,t)}function Tye(e){var t=Pye();return function(){var n=_n(e),o;if(t){var i=_n(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kye(this,o)}}function kye(e,t){if(t&&(sh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SL(e)}function SL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _n(e){return _n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_n(e)}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");var lc="copyPaste",Aye=80,Iye=["fragmentSelection"],$ye=1/0,Mye=1/0,Bo=new WeakMap,vI=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),xye=function(e){Eye(r,e);var t=Tye(r);function r(n){var o;return _ye(this,r),o=t.call(this,n),o.columnsLimit=Mye,o.copyableRanges=[],o.focusableElement=void 0,o.pasteMode="overwrite",o.rowsLimit=$ye,o.uiContainer=o.hot.rootDocument.body,Bo.set(SL(o),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),o}return Oye(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[lc]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[lc],l=i.fragmentSelection,s=Bo.get(this);s.isFragmentSelectionEnabled=!!l,sh(a)==="object"&&(this.pasteMode=a.pasteMode||this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,this.uiContainer=a.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=pye(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),ri(_n(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ri(_n(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&fI(this.focusableElement),ri(_n(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=Bo.get(this);o.isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){var o=Bo.get(this);o.isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){var i=this,a=[],l=[],s=[];return $(o,function(u){me(u.startRow,u.endRow,function(c){l.indexOf(c)===-1&&l.push(c)}),me(u.startCol,u.endCol,function(c){s.indexOf(c)===-1&&s.push(c)})}),$(l,function(u){var c=[];$(s,function(f){c.push(i.hot.getCopyableData(u,f))}),a.push(c)}),ls(a)}},{key:"getRangedData",value:function(o){var i=this,a=[],l=[],s=[];return $(o,function(u){me(u.startRow,u.endRow,function(c){l.indexOf(c)===-1&&l.push(c)}),me(u.startCol,u.endCol,function(c){s.indexOf(c)===-1&&s.push(c)})}),$(l,function(u){var c=[];$(s,function(f){c.push(i.hot.getCopyableData(u,f))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new hye;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){var i=o.getTopStartCorner(),a=o.getBottomEndCorner(),l=i.row,s=i.col,u=a.row,c=a.col,f=Math.min(u,l+this.rowsLimit-1),h=Math.min(c,s+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:l,startCol:s,endRow:f,endCol:h}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),(u!==f||c!==h)&&this.hot.runHooks("afterCopyLimit",u-l+1,c-s+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var o=this.hot.getActiveEditor(),i=o?o.TEXTAREA:void 0;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o=this.hot.getActiveEditor();return o&&o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),c=u.row,f=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,g=c,y=f,w=c,C=f;s.length<a||g<=d;){var _=this.hot.getCellMeta(g,f),I=_.skipRowOnPaste,E=_.visualRow;if(g=E+1,I!==!0){w=E,y=f;for(var U=[],G=s.length%a;U.length<l||y<=v;){var Q=this.hot.getCellMeta(c,y),K=Q.skipColumnOnPaste,X=Q.visualCol;if(y=X+1,K!==!0){C=X;var J=U.length%l;U.push(o[G][J])}}s.push(U)}}return this.hot.populateFromArray(c,f,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,f,w,C]}}},{key:"onCopy",value:function(o){var i=Bo.get(this);if(!(!this.hot.isListening()&&!i.isTriggeredByCopy||this.isEditorOpened())){this.setCopyableText(),i.isTriggeredByCopy=!1;var a=this.getRangedData(this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",a,this.copyableRanges);if(l){var s=ls(a);if(o&&o.clipboardData){var u=ik(a,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[vI,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",a,this.copyableRanges)}o.preventDefault()}}},{key:"onCut",value:function(o){var i=Bo.get(this);if(!(!this.hot.isListening()&&!i.isTriggeredByCut||this.isEditorOpened())){this.setCopyableText(),i.isTriggeredByCut=!1;var a=this.getRangedData(this.copyableRanges),l=!!this.hot.runHooks("beforeCut",a,this.copyableRanges);if(l){var s=ls(a);if(o&&o.clipboardData){var u=ik(a,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[vI,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=aC(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=_9(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=Zae(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=mye(s,4),c=u[0],f=u[1],h=u[2],d=u[3];this.hot.selectCell(c,f,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},iye(this),aye(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var o=Bo.get(this),i=o.isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(i&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&m5())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(fI(this.focusableElement),this.focusableElement=null),ri(_n(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return lc}},{key:"SETTING_KEYS",get:function(){return[lc].concat(Iye)}},{key:"PLUGIN_PRIORITY",get:function(){return Aye}}]),r}(Ke);function CL(e,t){return"border_row".concat(e,"col").concat(t)}function Zl(){return{width:1,color:"#000"}}function On(){return{hide:!0}}function Dye(){return{width:1,color:"#000",cornerVisible:!1}}function dp(e){if(fe(e.start)||fe(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(fe(e.end)||fe(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function jl(e){return fe(e.start)&&(e.left=e.start),fe(e.end)&&(e.right=e.end),e}function vp(e,t){return{id:CL(e,t),border:Dye(),row:e,col:t,top:On(),bottom:On(),start:On(),end:On()}}function Hye(e,t){return it(t,"border")&&t.border&&(e.border=t.border),it(t,"top")&&fe(t.top)&&(t.top?(Ne(t.top)||(t.top=Zl()),e.top=t.top):(t.top=On(),e.top=t.top)),it(t,"bottom")&&fe(t.bottom)&&(t.bottom?(Ne(t.bottom)||(t.bottom=Zl()),e.bottom=t.bottom):(t.bottom=On(),e.bottom=t.bottom)),it(t,"start")&&fe(t.start)&&(t.start?(Ne(t.start)||(t.start=Zl()),e.start=t.start):(t.start=On(),e.start=t.start)),it(t,"end")&&fe(t.end)&&(t.end?(Ne(t.end)||(t.end=Zl()),e.end=t.end):(t.end=On(),e.end=t.end)),e}function Wn(e,t){var r=!1;return $(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!it(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function wd(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Nye(e){return e.some(function(t){return fe(t.left)||fe(t.right)})}function Lye(e){return e.some(function(t){return fe(t.start)||fe(t.end)})}var jye=new Map([["left","start"],["right","end"]]);function Bye(e){var t;return(t=jye.get(e))!==null&&t!==void 0?t:e}function Fye(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(y_),n=Wn(this,"bottom");return n&&(r=wd(r)),r},callback:function(r,n){var o=Wn(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function Vye(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(m_),o=Wn(this,t);return o&&(n=wd(n)),n},callback:function(n,o){var i=Wn(this,t);e.prepareBorder(o,t,i)}}}function Wye(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(b_)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Wn(this)}}}function Uye(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(g_),o=Wn(this,t);return o&&(n=wd(n)),n},callback:function(n,o){var i=Wn(this,t);e.prepareBorder(o,t,i)}}}function zye(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(p_),n=Wn(this,"top");return n&&(r=wd(r)),r},callback:function(r,n){var o=Wn(this,"top");e.prepareBorder(n,"top",o)}}}function yb(e){return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}function pI(e,t){return Xye(e)||Kye(e,t)||Yye(e,t)||Gye()}function Gye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yye(e,t){if(e){if(typeof e=="string")return gI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gI(e,t)}}function gI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Xye(e){if(Array.isArray(e))return e}function qye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qye(e,t,r){return t&&yI(e.prototype,t),r&&yI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ni(){return typeof Reflect<"u"&&Reflect.get?ni=Reflect.get.bind():ni=function(t,r,n){var o=Zye(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ni.apply(this,arguments)}function Zye(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Rn(e),e!==null););return e}function Jye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mb(e,t)}function mb(e,t){return mb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mb(e,t)}function eme(e){var t=rme();return function(){var n=Rn(e),o;if(t){var i=Rn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tme(this,o)}}function tme(e,t){if(t&&(yb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _L(e)}function _L(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rn(e){return Rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rn(e)}function nme(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var sc="customBorders",ome=90,ime=function(e){Jye(r,e);var t=eme(r);function r(){var n;qye(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),nme(_L(n),"savedBorders",[]),n}return Qye(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),ni(Rn(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),ni(Rn(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),ni(Rn(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=dp(i));var u=Ua(o),c=Es(u);$(o,function(f){for(var h=c(f),d=pI(h,4),v=d[0],g=d[1],y=d[2],w=d[3],C=function(E){for(var U=function(K){$(l,function(X){a.prepareBorderFromCustomAdded(E,K,s,Bye(X))})},G=g;G<=w;G+=1)U(G)},_=v;_<=y;_+=1)C(_)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=Ua(o),l=Es(a),s=[];return $(o,function(u){for(var c=l(u),f=pI(c,4),h=f[0],d=f[1],v=f[2],g=f[3],y=function(_){for(var I=function(G){$(i.savedBorders,function(Q){Q.row===_&&Q.col===G&&s.push(jl(Q))})},E=d;E<=g;E+=1)I(E)},w=h;w<=v;w+=1)y(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):($(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var c=vp(o,i);a&&(c=Hye(c,a),$(this.hot.selection.highlight.customSelections,function(f){if(c.id===f.settings.id)return Object.assign(f.settings,a),c.id=f.settings.id,c.top=f.settings.top,c.bottom=f.settings.bottom,c.start=f.settings.start,c.end=f.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",jl(c)),this.insertBorderIntoSettings(c,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);me(o.from.row,l,function(u){me(o.from.col,s,function(c){var f=vp(u,c),h=0;u===o.from.row&&it(i,"top")&&(h+=1,f.top=i.top),u===o.to.row&&it(i,"bottom")&&(h+=1,f.bottom=i.bottom),c===o.from.col&&it(i,"start")&&(h+=1,f.start=i.start),c===o.to.col&&it(i,"end")&&(h+=1,f.end=i.end),h>0&&(a.hot.setCellMeta(u,c,"borders",jl(f)),a.insertBorderIntoSettings(f))})})}},{key:"removeAllBorders",value:function(o,i){var a=CL(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=vp(o,i):s=dp(s),l){s[a]=On();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",jl(s))}}else{s[a]=Zl();var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",jl(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;$(o,function(s){var u=s.start,c=s.end;if(u.row===c.row&&u.col===c.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":me(u.col,c.col,function(f){me(u.row,c.row,function(h){l.removeAllBorders(h,f)})});break;case"top":me(u.col,c.col,function(f){l.setBorder(u.row,f,i,a)});break;case"bottom":me(u.col,c.col,function(f){l.setBorder(c.row,f,i,a)});break;case"start":me(u.row,c.row,function(f){l.setBorder(f,u.col,i,a)});break;case"end":me(u.row,c.row,function(f){l.setBorder(f,c.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;$(o,function(a){var l=dp(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return Vt(u,function(c,f){var h=c;return f&&f.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=Fe(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;$(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;$(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=Fe(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):$(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return $(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return Ve(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):$(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&Ve(u.instanceBorders,function(c){c.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[sc];if(Array.isArray(o)){var i=Kt(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=Nye(o),a=Lye(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[sc]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(v_)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[zye(this),Uye(this),Fye(this),Vye(this),Wye(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){ni(Rn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sc}},{key:"PLUGIN_PRIORITY",get:function(){return ome}}]),r}(Ke);function bb(e){return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bb(e)}function ame(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lme(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oi(){return typeof Reflect<"u"&&Reflect.get?oi=Reflect.get.bind():oi=function(t,r,n){var o=sme(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oi.apply(this,arguments)}function sme(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=En(e),e!==null););return e}function ume(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wb(e,t)}function wb(e,t){return wb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wb(e,t)}function cme(e){var t=hme();return function(){var n=En(e),o;if(t){var i=En(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fme(this,o)}}function fme(e,t){if(t&&(bb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OL(e)}function OL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function En(e){return En=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},En(e)}var bI="dragToScroll",dme=100,vme=function(e){ume(r,e);var t=cme(r);function r(n){var o;return ame(this,r),o=t.call(this,n),o.eventManager=new vt(OL(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return lme(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bI]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),oi(En(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),oi(En(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),oi(En(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=yf(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!Pi(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){oi(En(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bI}},{key:"PLUGIN_PRIORITY",get:function(){return dme}}]),r}(Ke);function Sb(e){return Sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sb(e)}function pme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gme(e,t,r){return t&&wI(e.prototype,t),r&&wI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ii(){return typeof Reflect<"u"&&Reflect.get?ii=Reflect.get.bind():ii=function(t,r,n){var o=yme(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ii.apply(this,arguments)}function yme(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Tn(e),e!==null););return e}function mme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cb(e,t)}function Cb(e,t){return Cb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Cb(e,t)}function bme(e){var t=Sme();return function(){var n=Tn(e),o;if(t){var i=Tn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wme(this,o)}}function wme(e,t){if(t&&(Sb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RL(e)}function RL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tn(e){return Tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tn(e)}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");var pp="dropdownMenu",Cme=230,gp="changeType",EL=function(e){mme(r,e);var t=bme(r);function r(n){var o;return pme(this,r),o=t.call(this,n),o.eventManager=new vt(RL(o)),o.commandExecutor=new vL(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return gme(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[pp]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new gL(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[pp],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),ii(Tn(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new mO(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,c=new Array(u),f=0;f<u;f++)c[f]=arguments[f];return(s=o.executeCommand).call.apply(s,[o].concat(c))}),$(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ii(Tn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),ii(Tn(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,gp)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,c=s.left;i=u,a=c}var f=o.target.getBoundingClientRect();this.open({left:f.left+a,top:f.top+o.target.offsetHeight+3+i,width:f.width,height:f.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(gp));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var c=this.hot.rootDocument.createElement("button");c.className=gp,c.type="button",c.onclick=function(){return!1},i.firstChild.insertBefore(c,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ii(Tn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return pp}},{key:"PLUGIN_PRIORITY",get:function(){return Cme}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[fu,hu,Be,vu,Be,vd,Be,du,Be,mr]}}]),r}(Ke);EL.SEPARATOR={name:Be};function _me(e,t){return Tme(e)||Eme(e,t)||Rme(e,t)||Ome()}function Ome(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rme(e,t){if(e){if(typeof e=="string")return SI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SI(e,t)}}function SI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Eme(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Tme(e){if(Array.isArray(e))return e}function kme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pme(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ame=function(){function e(t){kme(this,e),this.hot=t,this.options={}}return Pme(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return me(o,a,function(c){var f=[];!s.exportHiddenRows&&r._isHiddenRow(c)||(me(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||f.push(r.hot.getDataAtCell(c,h))}),u.push(f))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();me(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();me(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=_me(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],c=u===void 0?n:u,f=o[3],h=f===void 0?r:f;return a=Math.max(a,0),s=Math.max(s,0),c=Math.min(c,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:c,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const Ime=Ame;function $me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mme(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var xme=function(){function e(t,r){$me(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return Mme(e,[{key:"_mergeOptions",value:function(r){var n=tr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=ht(tr(e.DEFAULT_OPTIONS),n),n=ht(n,r),n.filename=PD(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const Dme=xme;function _b(e){return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_b(e)}function Hme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nme(e,t,r){return t&&OI(e.prototype,t),r&&OI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ob(e,t)}function Ob(e,t){return Ob=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ob(e,t)}function jme(e){var t=Vme();return function(){var n=uh(e),o;if(t){var i=uh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bme(this,o)}}function Bme(e,t){if(t&&(_b(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fme(e)}function Fme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uh(e){return uh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uh(e)}var Wme=String.fromCharCode(13),Ume=String.fromCharCode(34),zme=String.fromCharCode(10),Gme=function(e){Lme(r,e);var t=jme(r);function r(){return Hme(this,r),t.apply(this,arguments)}return Nme(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),c=u.length>0,f=i.bom?String.fromCharCode(65279):"";return s&&(l=Fe(l,function(h){return o._escapeCell(h,!0)}),c&&(f+=i.columnDelimiter),f+=l.join(i.columnDelimiter),f+=i.rowDelimiter),$(a,function(h,d){d>0&&(f+=i.rowDelimiter),c&&(f+=o._escapeCell(u[d])+i.columnDelimiter),f+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),f}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=wt(o);return a!==""&&(i||a.indexOf(Wme)>=0||a.indexOf(Ume)>=0||a.indexOf(zme)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(Dme);const Yme=Gme;function Kme(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Xme="csv",Rb=Kme({},Xme,Yme);function qme(e,t,r){return typeof Rb[e]=="function"?new Rb[e](t,r):null}function Eb(e){return Eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eb(e)}function Qme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zme(e,t,r){return t&&RI(e.prototype,t),r&&RI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tb(e,t)}function Tb(e,t){return Tb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Tb(e,t)}function ebe(e){var t=nbe();return function(){var n=ch(e),o;if(t){var i=ch(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tbe(this,o)}}function tbe(e,t){if(t&&(Eb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rbe(e)}function rbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ch(e){return ch=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ch(e)}var obe="exportFile",ibe=240,abe=function(e){Jme(r,e);var t=ebe(r);function r(){return Qme(this,r),t.apply(this,arguments)}return Zme(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),c=this._createBlob(u),f=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=f.createObjectURL(c);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){f.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(c,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Rb[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return qme(o,new Ime(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return obe}},{key:"PLUGIN_PRIORITY",get:function(){return ibe}}]),r}(Ke);function lbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sbe(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var TL=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;lbe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Yh)}return sbe(e,[{key:"reset",value:function(){$(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),$(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();rt(TL,or);const Sd=TL;var $s={};function Oo(e,t){if(!$s[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=$s[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function ai(e){if(!$s[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return $s[e].descriptor}function _t(e,t,r){r.key=e,$s[e]={condition:t,descriptor:r}}var xt="none";function ube(){return!0}_t(xt,ube,{name:Kh,inputsCount:0,showOperators:!1});var fs="empty";function cbe(e){return At(e.value)}_t(fs,cbe,{name:E_,inputsCount:0,showOperators:!0});var Gc="not_empty";function fbe(e,t){return!Oo(fs,t)(e)}_t(Gc,fbe,{name:T_,inputsCount:0,showOperators:!0});function hbe(e,t){return gbe(e)||pbe(e,t)||vbe(e,t)||dbe()}function dbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vbe(e,t){if(e){if(typeof e=="string")return TI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TI(e,t)}}function TI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function gbe(e){if(Array.isArray(e))return e}var hs="eq";function ybe(e,t){var r=hbe(t,1),n=r[0];return wt(e.value).toLocaleLowerCase(e.meta.locale)===wt(n)}_t(hs,ybe,{name:k_,inputsCount:1,showOperators:!0});var Yc="neq";function mbe(e,t){return!Oo(hs,t)(e)}_t(Yc,mbe,{name:P_,inputsCount:1,showOperators:!0});function bbe(e,t){return _be(e)||Cbe(e,t)||Sbe(e,t)||wbe()}function wbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sbe(e,t){if(e){if(typeof e=="string")return kI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kI(e,t)}}function kI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function _be(e){if(Array.isArray(e))return e}var kL="gt";function Obe(e,t){var r=bbe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}_t(kL,Obe,{name:x_,inputsCount:1,showOperators:!0});function Rbe(e,t){return Pbe(e)||kbe(e,t)||Tbe(e,t)||Ebe()}function Ebe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tbe(e,t){if(e){if(typeof e=="string")return PI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PI(e,t)}}function PI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Pbe(e){if(Array.isArray(e))return e}var PL="gte";function Abe(e,t){var r=Rbe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}_t(PL,Abe,{name:D_,inputsCount:1,showOperators:!0});function Ibe(e,t){return Dbe(e)||xbe(e,t)||Mbe(e,t)||$be()}function $be(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mbe(e,t){if(e){if(typeof e=="string")return AI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AI(e,t)}}function AI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Dbe(e){if(Array.isArray(e))return e}var AL="lt";function Hbe(e,t){var r=Ibe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}_t(AL,Hbe,{name:H_,inputsCount:1,showOperators:!0});function Nbe(e,t){return Fbe(e)||Bbe(e,t)||jbe(e,t)||Lbe()}function Lbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jbe(e,t){if(e){if(typeof e=="string")return II(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return II(e,t)}}function II(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Fbe(e){if(Array.isArray(e))return e}var IL="lte";function Vbe(e,t){var r=Nbe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}_t(IL,Vbe,{name:N_,inputsCount:1,showOperators:!0});function Wbe(e,t){return Ybe(e)||Gbe(e,t)||zbe(e,t)||Ube()}function Ube(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zbe(e,t){if(e){if(typeof e=="string")return $I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $I(e,t)}}function $I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Ybe(e){if(Array.isArray(e))return e}var wO="date_after";function Kbe(e,t){var r=Wbe(t,1),n=r[0],o=Xe(e.value,e.meta.dateFormat),i=Xe(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}_t(wO,Kbe,{name:B_,inputsCount:1,showOperators:!0});function Xbe(e,t){return Jbe(e)||Zbe(e,t)||Qbe(e,t)||qbe()}function qbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qbe(e,t){if(e){if(typeof e=="string")return MI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MI(e,t)}}function MI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Jbe(e){if(Array.isArray(e))return e}var SO="date_before";function ewe(e,t){var r=Xbe(t,1),n=r[0],o=Xe(e.value,e.meta.dateFormat),i=Xe(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}_t(SO,ewe,{name:F_,inputsCount:1,showOperators:!0});function twe(e,t){return iwe(e)||owe(e,t)||nwe(e,t)||rwe()}function rwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nwe(e,t){if(e){if(typeof e=="string")return xI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xI(e,t)}}function xI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function owe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function iwe(e){if(Array.isArray(e))return e}var fh="between";function awe(e,t){var r=twe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=Oo(SO,[a]),c=Oo(wO,[i]);return u(e)&&c(e)}return e.value>=i&&e.value<=a}_t(fh,awe,{name:L_,inputsCount:2,showOperators:!0});var $L="not_between";function lwe(e,t){return!Oo(fh,t)(e)}_t($L,lwe,{name:j_,inputsCount:2,showOperators:!0});function swe(e,t){return hwe(e)||fwe(e,t)||cwe(e,t)||uwe()}function uwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cwe(e,t){if(e){if(typeof e=="string")return DI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DI(e,t)}}function DI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fwe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function hwe(e){if(Array.isArray(e))return e}var ML="begins_with";function dwe(e,t){var r=swe(t,1),n=r[0];return wt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(wt(n))}_t(ML,dwe,{name:A_,inputsCount:1,showOperators:!0});var vwe=Ae,xL=He,pwe=nn.f,gwe=Vi,HI=Pt,ywe=_S,mwe=rr,bwe=RS,NI=xL("".endsWith),wwe=xL("".slice),Swe=Math.min,DL=bwe("endsWith"),Cwe=!DL&&!!function(){var e=pwe(String.prototype,"endsWith");return e&&!e.writable}();vwe({target:"String",proto:!0,forced:!Cwe&&!DL},{endsWith:function(t){var r=HI(mwe(this));ywe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:Swe(gwe(n),o),a=HI(t);return NI?NI(r,a,i):wwe(r,i-a.length,i)===a}});function _we(e,t){return Twe(e)||Ewe(e,t)||Rwe(e,t)||Owe()}function Owe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rwe(e,t){if(e){if(typeof e=="string")return LI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LI(e,t)}}function LI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ewe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Twe(e){if(Array.isArray(e))return e}var HL="ends_with";function kwe(e,t){var r=_we(t,1),n=r[0];return wt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(wt(n))}_t(HL,kwe,{name:I_,inputsCount:1,showOperators:!0});function Pwe(e,t){return Mwe(e)||$we(e,t)||Iwe(e,t)||Awe()}function Awe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iwe(e,t){if(e){if(typeof e=="string")return jI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jI(e,t)}}function jI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $we(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Mwe(e){if(Array.isArray(e))return e}var CO="contains";function xwe(e,t){var r=Pwe(t,1),n=r[0];return wt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(wt(n))>=0}_t(CO,xwe,{name:$_,inputsCount:1,showOperators:!0});var NL="not_contains";function Dwe(e,t){return!Oo(CO,t)(e)}_t(NL,Dwe,{name:M_,inputsCount:1,showOperators:!0});var LL="date_tomorrow";function Hwe(e){var t=Xe(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Xe().subtract(-1,"days").startOf("day"),"d"):!1}_t(LL,Hwe,{name:W_,inputsCount:0});var jL="date_today";function Nwe(e){var t=Xe(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Xe().startOf("day"),"d"):!1}_t(jL,Nwe,{name:V_,inputsCount:0});var BL="date_yesterday";function Lwe(e){var t=Xe(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Xe().subtract(1,"days").startOf("day"),"d"):!1}_t(BL,Lwe,{name:U_,inputsCount:0});g8();function jwe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var kb=new Set([1]).has(1),Bwe=kb&&typeof Array.from=="function";function pu(e){var t=e;return kb&&(t=new Set(t)),function(r){var n;return kb?n=t.has(r):n=!!~t.indexOf(r),n}}function FL(e){return e??""}function Pb(e){var t=e;return Bwe?t=Array.from(new Set(t)):t=bD(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function BI(e,t,r,n){var o=[],i=e===t,a;return i||(a=pu(t)),$(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:jwe(l,r)};n&&n(u),o.push(u)}),o}function VL(e,t){return Uwe(e)||Wwe(e,t)||Vwe(e,t)||Fwe()}function Fwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vwe(e,t){if(e){if(typeof e=="string")return FI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FI(e,t)}}function FI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wwe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Uwe(e){if(Array.isArray(e))return e}var li="by_value";function zwe(e,t){var r=VL(t,1),n=r[0];return n(e.value)}_t(li,zwe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=VL(t,1),n=r[0];return[pu(n)]},showOperators:!1});var Ms={};function Gwe(e){if(!Ms[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=Ms[e].func;return function(r,n){return t(r,n)}}function Ywe(e){return Ms[e].name}function _O(e,t,r){Ms[e]={name:t,func:r}}var po="conjunction",Kwe=Y_;function Xwe(e,t){return e.every(function(r){return r.func(t)})}_O(po,Kwe,Xwe);var hh="disjunction",qwe=Xh;function Qwe(e,t){return e.some(function(r){return r.func(t)})}_O(hh,qwe,Qwe);var OO="disjunctionWithExtraCondition",Zwe=Xh;function Jwe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}_O(OO,Zwe,Jwe);var Bl;function yp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var eSe="numeric",WL="text",tSe="date",VI=(Bl={},yp(Bl,eSe,[xt,Be,fs,Gc,Be,hs,Yc,Be,kL,PL,AL,IL,fh,$L]),yp(Bl,WL,[xt,Be,fs,Gc,Be,hs,Yc,Be,ML,HL,Be,CO,NL]),yp(Bl,tSe,[xt,Be,fs,Gc,Be,hs,Yc,Be,SO,wO,fh,Be,LL,jL,BL]),Bl);function rSe(e){var t=[],r=e;return VI[r]||(r=WL),$(VI[r],function(n){var o;n===Be?o={name:Be}:o=tr(ai(n)),t.push(o)}),t}function nSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oSe(e,t,r){return t&&WI(e.prototype,t),r&&WI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var mp="built",bp="building",UI=["click","input","keydown","keypress","keyup","focus","blur","change"],UL=function(){function e(t,r){nSe(this,e),this.hot=t,this.eventManager=new vt(this),this.options=ht(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return oSe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===bp?this._element:this.buildState===mp?(this.update(),this._element):(this.buildState=bp,this.build(),this.buildState=mp,this._element)}},{key:"isBuilt",value:function(){return this.buildState===mp}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(qt)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=bp),this.options.className&&re(this._element,this.options.className),this.options.children.length)$(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);Ve(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),$(UI,function(i){return n(o,i)})}else $(UI,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return tr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();rt(UL,or);const go=UL;function Ab(e){return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ab(e)}function iSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function aSe(e,t,r){return t&&zI(e.prototype,t),r&&zI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kc(){return typeof Reflect<"u"&&Reflect.get?Kc=Reflect.get.bind():Kc=function(t,r,n){var o=lSe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Kc.apply(this,arguments)}function lSe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Za(e),e!==null););return e}function sSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ib(e,t)}function Ib(e,t){return Ib=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ib(e,t)}function uSe(e){var t=fSe();return function(){var n=Za(e),o;if(t){var i=Za(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cSe(this,o)}}function cSe(e,t){if(t&&(Ab(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zL(e)}function zL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Za(e){return Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Za(e)}var uc=new WeakMap,hSe=function(e){sSe(r,e);var t=uSe(r);function r(n,o){var i;return iSe(this,r),i=t.call(this,n,ht(r.DEFAULTS,o)),uc.set(zL(i),{}),i.registerHooks(),i}return aSe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){Kc(Za(r.prototype),"build",this).call(this);var o=uc.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,re(this._element,"htUIInput"),re(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=uc.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&uc.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return tr({placeholder:"",type:"text",tagName:"input"})}}]),r}(go);const Pa=hSe;function $b(e){return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}function dSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vSe(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aa(){return typeof Reflect<"u"&&Reflect.get?Aa=Reflect.get.bind():Aa=function(t,r,n){var o=pSe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Aa.apply(this,arguments)}function pSe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function gSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mb(e,t)}function Mb(e,t){return Mb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Mb(e,t)}function ySe(e){var t=bSe();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mSe(this,o)}}function mSe(e,t){if(t&&($b(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GL(e)}function GL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}var cc=new WeakMap,wSe=function(e){gSe(r,e);var t=ySe(r);function r(n,o){var i;return dSe(this,r),i=t.call(this,n,ht(r.DEFAULTS,o)),cc.set(GL(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return vSe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return $(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;Aa(yo(r.prototype),"build",this).call(this),this.menu=new mO(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new go(this.hot,{className:"htUISelectCaption"}),a=new go(this.hot,{className:"htUISelectDropdown"}),l=cc.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,$([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(Kh),cc.get(this).captionElement.textContent=o,Aa(yo(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==Be&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=cc.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),Aa(yo(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return tr({className:"htUISelect",wrapIt:!1})}}]),r}(go);const YI=wSe;function xb(e){return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function SSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function CSe(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xc(){return typeof Reflect<"u"&&Reflect.get?Xc=Reflect.get.bind():Xc=function(t,r,n){var o=_Se(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xc.apply(this,arguments)}function _Se(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ja(e),e!==null););return e}function OSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Db(e,t)}function Db(e,t){return Db=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Db(e,t)}function RSe(e){var t=kSe();return function(){var n=Ja(e),o;if(t){var i=Ja(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ESe(this,o)}}function ESe(e,t){if(t&&(xb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TSe(e)}function TSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ja(e){return Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ja(e)}var PSe=function(e){OSe(r,e);var t=RSe(r);function r(n,o){var i;return SSe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new YI(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new Pa(i.hot,{placeholder:J_})),i.elements.push(new Pa(i.hot,{placeholder:eO})),i.registerHooks(),i}return CSe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),$(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=tr(o.command);a.name.startsWith(pt)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),$(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||ai(xt),i=[];return $(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=ai(o?o.name:xt);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||$(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof YI})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof Pa})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,c,f){re(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&re(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=f,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[ai(xt)];if(o!==null){var a=o.visualIndex;i=rSe(this.hot.getDataType(0,a,this.hot.countRows(),a))}$(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),Xc(Ja(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){$(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){Cs(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),rn(o)):Cs(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),rn(o))}}]),r}(Sd);const wp=PSe;function Hb(e){return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hb(e)}function ASe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ISe(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qc(){return typeof Reflect<"u"&&Reflect.get?qc=Reflect.get.bind():qc=function(t,r,n){var o=$Se(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},qc.apply(this,arguments)}function $Se(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=el(e),e!==null););return e}function MSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nb(e,t)}function Nb(e,t){return Nb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Nb(e,t)}function xSe(e){var t=HSe();return function(){var n=el(e),o;if(t){var i=el(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DSe(this,o)}}function DSe(e,t){if(t&&(Hb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YL(e)}function YL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function el(e){return el=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},el(e)}var fc=new WeakMap,NSe=function(e){MSe(r,e);var t=xSe(r);function r(n,o){var i;return ASe(this,r),i=t.call(this,n,ht(r.DEFAULTS,o)),fc.set(YL(i),{}),i}return ISe(r,[{key:"build",value:function(){qc(el(r.prototype),"build",this).call(this);var o=fc.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=fc.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&fc.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return tr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(go);const qI=NSe;function Lb(e){return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}var QI;function LSe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BSe(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jb(e,t)}function jb(e,t){return jb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jb(e,t)}function VSe(e){var t=zSe();return function(){var n=dh(e),o;if(t){var i=dh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return WSe(this,o)}}function WSe(e,t){if(t&&(Lb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return USe(e)}function USe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dh(e){return dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dh(e)}var JI=0,GSe=function(e){FSe(r,e);var t=VSe(r);function r(n,o){var i;return jSe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return BSe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[po,hh];$(i,function(a){var l=new qI(o.hot,{name:"operator",label:{htmlFor:a,textContent:Ywe(a)},value:a,checked:a===i[JI],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(Je(QI||(QI=LSe(["Radio button with index "," doesn't exist."])),o));$(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof qI&&i.isChecked()});return o?o.getValue():po}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&$(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:po,i=arguments.length>1?arguments[1]:void 0,a=o;a===OO&&(a=hh),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(JI)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(Sd);const YSe=GSe;var KSe=He,XSe=rr,e$=Pt,qSe=/"/g,QSe=KSe("".replace),ZSe=function(e,t,r,n){var o=e$(XSe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+QSe(e$(n),qSe,"&quot;")+'"'),i+">"+o+"</"+t+">"},JSe=Le,eCe=function(e){return JSe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},tCe=Ae,rCe=ZSe,nCe=eCe;tCe({target:"String",proto:!0,forced:nCe("link")},{link:function(t){return rCe(this,"a","href",t)}});function Bb(e){return Bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bb(e)}function oCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function iCe(e,t,r){return t&&t$(e.prototype,t),r&&t$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qc(){return typeof Reflect<"u"&&Reflect.get?Qc=Reflect.get.bind():Qc=function(t,r,n){var o=aCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Qc.apply(this,arguments)}function aCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tl(e),e!==null););return e}function lCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fb(e,t)}function Fb(e,t){return Fb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Fb(e,t)}function sCe(e){var t=cCe();return function(){var n=tl(e),o;if(t){var i=tl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uCe(this,o)}}function uCe(e,t){if(t&&(Bb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KL(e)}function KL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tl(e){return tl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tl(e)}var Sp=new WeakMap,fCe=function(e){lCe(r,e);var t=sCe(r);function r(n,o){var i;return oCe(this,r),i=t.call(this,n,ht(r.DEFAULTS,o)),Sp.set(KL(i),{}),i}return iCe(r,[{key:"build",value:function(){Qc(tl(r.prototype),"build",this).call(this);var o=Sp.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(Sp.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return tr({href:"#",tagName:"a"})}}]),r}(go);const r$=fCe;function Vb(e){return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vb(e)}function n$(e){return pCe(e)||vCe(e)||dCe(e)||hCe()}function hCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dCe(e,t){if(e){if(typeof e=="string")return Wb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wb(e,t)}}function vCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pCe(e){if(Array.isArray(e))return Wb(e)}function Wb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yCe(e,t,r){return t&&o$(e.prototype,t),r&&o$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ia(){return typeof Reflect<"u"&&Reflect.get?Ia=Reflect.get.bind():Ia=function(t,r,n){var o=mCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ia.apply(this,arguments)}function mCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function bCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ub(e,t)}function Ub(e,t){return Ub=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ub(e,t)}function wCe(e){var t=CCe();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SCe(this,o)}}function SCe(e,t){if(t&&(Vb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XL(e)}function XL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}var _Ce=new WeakMap,OCe="multipleSelect.itemBox",RCe=function(e){bCe(r,e);var t=wCe(r);function r(n,o){var i;return gCe(this,r),i=t.call(this,n,ht(r.DEFAULTS,o)),_Ce.set(XL(i),{}),i.searchInput=new Pa(i.hot,{placeholder:Z_,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new r$(i.hot,{textContent:K_,className:"htUISelectAll"}),i.clearAllUI=new r$(i.hot,{textContent:X_,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return yCe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return n$(this.items)}},{key:"getValue",value:function(){return TCe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;Ia(mo(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new go(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(c){if(o._element){o.itemsBox&&o.itemsBox.destroy(),re(c,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(c,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,g,y,w,C,_){v.title=_.instance.getDataAtRowProp(g,_.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Ht(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var f=o.itemsBox.getShortcutManager(),h=f.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:OCe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(ECe(this.items,this.options.value)),Ia(mo(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Ia(mo(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=n$(this.items):l=Cr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=WD(Cs,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(rn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),$(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(w0(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),$(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(w0(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return tr({className:"htUIMultipleSelect",value:[]})}}]),r}(go);const i$=RCe;function ECe(e,t){var r=pu(t);return Fe(e,function(n){return n.checked=r(n.value),n})}function TCe(e){var t=[];return $(e,function(r){r.checked&&t.push(r.value)}),t}function zb(e){return zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zb(e)}function kCe(e,t){return $Ce(e)||ICe(e,t)||ACe(e,t)||PCe()}function PCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ACe(e,t){if(e){if(typeof e=="string")return a$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a$(e,t)}}function a$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ICe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function $Ce(e){if(Array.isArray(e))return e}function MCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xCe(e,t,r){return t&&l$(e.prototype,t),r&&l$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zc(){return typeof Reflect<"u"&&Reflect.get?Zc=Reflect.get.bind():Zc=function(t,r,n){var o=DCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Zc.apply(this,arguments)}function DCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=rl(e),e!==null););return e}function HCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gb(e,t)}function Gb(e,t){return Gb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Gb(e,t)}function NCe(e){var t=BCe();return function(){var n=rl(e),o;if(t){var i=rl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LCe(this,o)}}function LCe(e,t){if(t&&(zb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jCe(e)}function jCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rl(e){return rl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rl(e)}var FCe=function(e){HCe(r,e);var t=NCe(r);function r(n,o){var i;return MCe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new i$(i.hot)),i.registerHooks(),i}return xCe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===li){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?xt:li},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,c,f,h){var d=Cr(u,function(U){return U.name===li}),v=kCe(d,1),g=v[0],y={},w=i.hot.getTranslatedPhrase(qf);if(g){var C=Pb(Fe(f(s,h),function(U){return U.value}));c&&(g.args[0]=c);var _=[],I=BI(C,g.args[0],w,function(U){U.checked&&_.push(U.value)}),E=o.editedConditionStack.column;y.locale=i.hot.getCellMeta(0,E).locale,y.args=[_],y.command=ai(li),y.itemsSnapshot=I}else y.args=[],y.command=ai(xt);i.state.setValueAtIndex(s,y)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof i$})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,c,f){re(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=f,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(qf),i=Pb(this._getColumnVisibleValues()),a=BI(i,i,o);this.getMultipleSelectElement().setItems(a),Zc(rl(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){Cs(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),rn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:Fe(this.hot.getDataAtCol(o.visualIndex),function(i){return FL(i)})}}]),r}(Sd);const VCe=FCe;function Yb(e){return Yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yb(e)}function WCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function UCe(e,t,r){return t&&s$(e.prototype,t),r&&s$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kb(e,t)}function Kb(e,t){return Kb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Kb(e,t)}function GCe(e){var t=XCe();return function(){var n=vh(e),o;if(t){var i=vh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YCe(this,o)}}function YCe(e,t){if(t&&(Yb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KCe(e)}function KCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vh(e){return vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vh(e)}var qCe=function(e){zCe(r,e);var t=GCe(r);function r(n,o){var i;return WCe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new Pa(i.hot,{type:"button",value:q_,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new Pa(i.hot,{type:"button",value:Q_,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return UCe(r,[{key:"registerHooks",value:function(){var o=this;$(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(Sd);const QCe=qCe;var u$,c$;function f$(e,t){return t_e(e)||e_e(e,t)||JCe(e,t)||ZCe()}function ZCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JCe(e,t){if(e){if(typeof e=="string")return h$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h$(e,t)}}function h$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function t_e(e){if(Array.isArray(e))return e}function d$(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function r_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n_e(e,t,r){return t&&v$(e.prototype,t),r&&v$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var p$="ConditionCollection.filteringStates",qL=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r_e(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Yh,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(p$,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return n_e(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:po;return r.length?Gwe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:po,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=Fe(n.args,function(f){return typeof f=="string"?f.toLocaleLowerCase(a):f}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(Je(u$||(u$=d$(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(at(Ms[o]))throw new Error(Je(c$||(c$=d$(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var c=this.getConditions(r);c.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:Oo(s,l)}]},i):c.push({name:s,args:l,func:Oo(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=f$(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Vt(this.filteringStates.getEntries(),function(r,n){var o=f$(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:Fe(s,function(u){var c=u.name,f=u.args;return{name:c,args:f}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),$(r,function(o){$(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(p$),this.filteringStates=null,this.clearLocalHooks()}}]),e}();rt(qL,or);const QL=qL;function o_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i_e(e,t,r){return t&&g$(e.prototype,t),r&&g$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var a_e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};o_e(this,e),this.conditionCollection=t,this.columnDataFactory=r}return i_e(e,[{key:"filter",value:function(){var r=this,n=[];return $(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return $(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return $(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const ZL=a_e;function l_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s_e(e,t,r){return t&&y$(e.prototype,t),r&&y$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var JL=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};l_e(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return s_e(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,$(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=_X(function(f,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new QL(o.hot,!1),g=[].concat(f,d);v.importAllConditions(g);var y=o.columnDataFactory(h),w;v.isEmpty()?w=y:w=new ZL(v,function(_){return o.columnDataFactory(_)}).filter(),w=Fe(w,function(_){return _.meta.visualRow});var C=pu(w);return v.destroy(),Cr(y,function(_){return C(_.meta.visualRow)})})(l),c=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:c},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;$(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),Ve(this,function(n,o){r[o]=null})}}]),e}();rt(JL,or);const u_e=JL;function Xb(e){return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(e)}var m$;function c_e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function f_e(e,t){return p_e(e)||v_e(e,t)||d_e(e,t)||h_e()}function h_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d_e(e,t){if(e){if(typeof e=="string")return b$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b$(e,t)}}function b$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function p_e(e){if(Array.isArray(e))return e}function g_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y_e(e,t,r){return t&&w$(e.prototype,t),r&&w$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $a(){return typeof Reflect<"u"&&Reflect.get?$a=Reflect.get.bind():$a=function(t,r,n){var o=m_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$a.apply(this,arguments)}function m_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function b_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qb(e,t)}function qb(e,t){return qb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qb(e,t)}function w_e(e){var t=C_e();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return S_e(this,o)}}function S_e(e,t){if(t&&(Xb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ej(e)}function ej(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var S$="filters",__e=250,O_e=function(e){b_e(r,e);var t=w_e(r);function r(n){var o;return g_e(this,r),o=t.call(this,n),o.eventManager=new vt(ej(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.lastSelectedColumn=null,o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return y_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[S$]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new uu),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(z_),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(G_),":")};if(!this.components.get("filter_by_condition")){var c=new wp(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(c))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new YSe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var f=new wp(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(f))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new VCe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new QCe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new QL(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new u_e(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),$a(bo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}$a(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:po,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var c=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=Fe(i.filter(),function(h){return h.meta.visualRow});var f=pu(l);me(o.hot.countSourceRows()-1,function(h){f(h)||c.push(h)}),$(c,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return $(this.hot.getSourceDataAtCol(a),function(s,u){var c,f=i.hot.getCellMeta(u,a),h=f.row,d=f.col,v=f.visualCol,g=f.visualRow,y=f.type,w=f.instance,C=f.dateFormat,_=f.locale,I=(c=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&c!==void 0?c:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:g,type:y,instance:w,dateFormat:C,locale:_},value:FL(I)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&$(o,function(a){var l=f_e(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=Pb(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:Be}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===hh&&i.command.key!==xt&&a.command.key!==xt&&l.command.key!==xt?s=OO:l.command.key!==xt&&(i.command.key===xt||a.command.key===xt)&&(s=po),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),c=this.components.get("filter_by_condition2").getState(),f=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,c,f);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==xt&&(this.conditionCollection.addCondition(s,u,h,d),c.command.key!==xt&&this.conditionCollection.addCondition(s,c,h,d)),f.command.key!==xt&&this.conditionCollection.addCondition(s,f,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===wp&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?re(i,"htFiltersActive"):De(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new ZL(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===li}),c=l.filter(function(h){return h.name!==li});if(u.length>=2||c.length>=3)ot(Je(m$||(m$=c_e([`The filter conditions have been applied properly, but couldnât be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnât be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var f=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(c[0],s),this.components.get("filter_by_condition2").updateState(c[1],s),this.components.get("filter_operators").updateState(f,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return $(l,function(u){$(i.menuItems,function(c,f){c.key===u.getMenuItemDescriptor().key&&o.push(f)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),c=1;c<s;c++)u[c-1]=arguments[c];var f=this.getIndexesOfComponents.apply(this,u);o?l.showRows(f):l.hideRows(f),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),$a(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return S$}},{key:"PLUGIN_PRIORITY",get:function(){return __e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(Ke);function C$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ds(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C$(Object(r),!0).forEach(function(n){R_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R_e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tj="internal-use-in-handsontable",E_e={licenseKey:tj,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function rj(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[Yt])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function nj(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function T_e(e){var t,r=e[Yt],n=nj(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=rj(e);return ds(ds(ds({},E_e),n),o)}function k_e(e){var t,r=e[Yt],n=nj(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=rj(e);return ds(ds({},n),o)}function Qb(e){return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}function Cd(){var e="engine_relationship",t=Rr(Yt);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function RO(){var e="shared_engine_usage",t=Rr(Yt);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function P_e(e){var t=e.getSettings(),r=t[Yt],n=r==null?void 0:r.engine;if(r===!0||at(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return A_e((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(Qb(n)==="object"&&at(n.hyperformula)){var i=Cd(),a=RO().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:tj}),n}return null}function A_e(e,t,r){var n=t[Yt],o=T_e(t),i=Cd(),a=RO();I_e(e,n.functions),$_e(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),M_e(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function _$(e){var t,r=Cd(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function O$(e,t){if(e){var r=Cd(),n=r.get(e),o=RO(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function I_e(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){ot(a.message)}})}function $_e(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){ot(n.message)}}}function M_e(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){ot(l.message)}}),e.resumeEvaluation())}function x_e(e,t){return(at(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function oj(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function D_e(e){return oj(e)?e.substr(1):e}function H_e(e){return j_e(e)||L_e(e)||ij(e)||N_e()}function N_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function j_e(e){if(Array.isArray(e))return Zb(e)}function R$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function E$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R$(Object(r),!0).forEach(function(n){Jc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xs(e){return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function da(e,t){return V_e(e)||F_e(e,t)||ij(e,t)||B_e()}function B_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ij(e,t){if(e){if(typeof e=="string")return Zb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zb(e,t)}}function Zb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function F_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function V_e(e){if(Array.isArray(e))return e}function W_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function U_e(e,t,r){return t&&T$(e.prototype,t),r&&T$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function si(){return typeof Reflect<"u"&&Reflect.get?si=Reflect.get.bind():si=function(t,r,n){var o=z_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},si.apply(this,arguments)}function z_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=kn(e),e!==null););return e}function G_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jb(e,t)}function Jb(e,t){return Jb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Jb(e,t)}function Y_e(e){var t=X_e();return function(){var n=kn(e),o;if(t){var i=kn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return K_e(this,o)}}function K_e(e,t){if(t&&(xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Go(e)}function Go(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kn(e){return kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kn(e)}function Jc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cp(e,t,r){q_e(e,t),t.set(e,r)}function q_e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function va(e,t,r){var n=aj(e,t,"set");return Q_e(e,n,r),r}function Q_e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function pa(e,t){var r=aj(e,t,"get");return Z_e(e,r)}function aj(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Z_e(e,t){return t.get?t.get.call(e):t.value}var Yt="formulas",J_e=260,k$="row_move";ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");var ga=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Fo=new WeakMap,_p=new WeakMap,Fl=new WeakMap,eOe=function(e){G_e(r,e);var t=Y_e(r);function r(){var n;W_e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Cp(Go(n),Fo,{writable:!0,value:!1}),Cp(Go(n),_p,{writable:!0,value:!1}),Cp(Go(n),Fl,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Jc(Go(n),"staticRegister",Rr("formulas")),Jc(Go(n),"engine",null),Jc(Go(n),"sheetName",null),n}return U_e(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Yt]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=P_e(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){ot("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("beforeUndo",function(l){(l==null?void 0:l.actionType)!==k$&&i.engine.undo()}),this.addHook("beforeRedo",function(l){(l==null?void 0:l.actionType)!==k$&&i.engine.redo()}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),pa(this,Fl).forEach(function(l){var s=da(l,2),u=s[0],c=s[1];return i.engine.on(u,c)}),si(kn(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;pa(this,Fl).forEach(function(i){var a=da(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),O$(this.engine,this.hot),this.engine=null,si(kn(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){this.engine.updateConfig(k_e(this.hot.getSettings()));var i=this.hot.getSettings()[Yt];if(fe(i)&&fe(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!o.data&&this.sheetName===null){var a=this.hot.getSettings()[Yt].sheetName;a&&this.engine.doesSheetExist(a)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(a??void 0,this.hot.getSourceDataArray())}si(kn(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;pa(this,Fl).forEach(function(i){var a,l=da(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),va(this,Fl,null),O$(this.engine,this.hot),this.engine=null,si(kn(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(o,i,a,l,s){return!s&&o>=a?l+(o-a):i}},{key:"toPhysicalRowPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(o,this.hot.toPhysicalRow(o),this.hot.countRows(),this.hot.countSourceRows(),i)}},{key:"toPhysicalColumnPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(o,this.hot.toPhysicalColumn(o),this.hot.countCols(),this.hot.countSourceCols(),i)}},{key:"addSheet",value:function(o,i){if(fe(i)&&!qre(i))return ot("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return ot("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return ot(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){cC("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(Bn(Yt),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:l,col:s}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l===null||s===null?!1:this.engine.doesCellHaveFormula({sheet:a,row:l,col:s})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,c=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;c!==void 0&&(l.has(c)||l.add(c))}),_$(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var c;s.render(),(c=s.view)===null||c===void 0||c.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(c){var f,h=(f=c==null?void 0:c.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col,g=h.sheet;return fe(g)?"".concat(g,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var c,f,h=(c=u.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,g=fe(d)?i.hot.toVisualRow(d):null,y=fe(v)?i.hot.toVisualColumn(v):null;if(!(g===null||y===null)){var w=u==null||(f=u.address)===null||f===void 0?void 0:f.sheet,C=l(u);if(w!==void 0&&!s.has(C)){var _=_$(i.engine).get(w);if(!_)return;_.validateCell(_.getDataAtCell(g,y),_.getCellMeta(g,y),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.toPhysicalRowPosition(o),col:this.toPhysicalColumnPosition(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){ot("Not possible to set cell data at ".concat(JSON.stringify(l)));return}return this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.hot.toPhysicalRow(i),col:this.hot.toPhysicalColumn(l),sheet:this.sheetId},u=this.engine.getCellValue(s);return xs(u)==="object"&&u!==null?u.value:u}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=this,s=function(h){return E$(E$({},h),{},{sheet:l.sheetId})},u={start:s(i.getTopStartCorner()),end:s(i.getBottomEndCorner())},c={start:s(a.getTopStartCorner()),end:s(a.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(c)===!1?!1:this.engine.getFillRangeData(u,c)}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(Bn(Yt))||va(this,_p,at(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(Bn(Yt)))if(this.sheetName=x_e(this.engine,this.hot.getSettings()[Yt].sheetName),pa(this,_p))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){va(this,Fo,!0);var s=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(s),va(this,Fo,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||pa(this,Fo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.isFormulaCellType(s,i);if(!u){var c=this.getCellType(s,i);if(c!=="ARRAY"){oj(a.value)&&(a.value=D_e(a.value));return}}var f={row:o,col:this.toPhysicalColumnPosition(i),sheet:this.sheetId},h=this.engine.getCellValue(f),d=xs(h)==="object"&&h!==null?h.value:h;a.value=d}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||pa(this,Fo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i),c=this.isFormulaCellType(s,u);if(!c){var f=this.getCellType(s,u);if(f!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:o,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!ga(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(c){var f=da(c,4),h=f[0],d=f[1],v=f[3],g=a.hot.propToCol(d),y=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(g),C={row:y,col:w,sheet:a.sheetId};y!==null&&w!==null?a.syncChangeWithEngine(h,g,v):l.push([h,g,v]),s.push({address:C})})});l.length&&this.hot.addHookOnce("afterChange",function(){var c=a.engine.batch(function(){l.forEach(function(f){var h=da(f,3),d=h[0],v=h[1],g=h[2];a.syncChangeWithEngine(d,v,g)})});a.renderDependentSheets(c,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!ga(i)){var l=[],s=[];o.forEach(function(u){var c=da(u,4),f=c[0],h=c[1],d=c[3],v=a.hot.propToCol(h);if(br(v)){var g={row:f,col:a.toPhysicalColumnPosition(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(g)){ot("Not possible to set source cell data at ".concat(JSON.stringify(g)));return}s.push({address:g}),l.push.apply(l,H_e(a.engine.setCellContents(g,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(o),i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(o),i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=a.every(function(u){return l.engine.isItPossibleToRemoveRows(l.sheetId,[u,1])});return s===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=a.every(function(u){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[u,1])});return s===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!ga(a)){var l=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!ga(a)){var l=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!ga(l)){var u=a.sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){s.engine.removeRows(s.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!ga(l)){var u=a.sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){s.engine.removeColumns(s.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;va(this,Fo,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());va(this,Fo,!1),u.forEach(function(c,f){c.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+f,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return Yt}},{key:"PLUGIN_PRIORITY",get:function(){return J_e}}]),r}(Ke);function tOe(e,t){return iOe(e)||oOe(e,t)||nOe(e,t)||rOe()}function rOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nOe(e,t){if(e){if(typeof e=="string")return P$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P$(e,t)}}function P$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function iOe(e){if(Array.isArray(e))return e}function aOe(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=tOe(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(C_,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],c=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectColumns(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function hc(e){return cOe(e)||uOe(e)||sOe(e)||lOe()}function lOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sOe(e,t){if(e){if(typeof e=="string")return ew(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ew(e,t)}}function uOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cOe(e){if(Array.isArray(e))return ew(e)}function ew(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fOe(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(__,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=Fe(e.getHiddenColumns(),function(C){return n.toPhysicalColumn(C)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),c=s.getRenderableFromVisualIndex(l),f=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=c-u+1;if(d>v){var g=f.slice(a,l+1);h.push.apply(h,hc(g.filter(function(C){return o.includes(C)})))}}else if(u===0&&u<a)h.push.apply(h,hc(f.slice(0,a)));else if(u===null)h.push.apply(h,hc(f.slice(0,this.countCols())));else{var y=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(y,-1));c===w&&y>l&&h.push.apply(h,hc(f.slice(l+1)))}return $(h,function(C){t.push(n.toVisualColumn(C))}),t.length===0}}}function tw(e){return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}function hOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dOe(e,t,r){return t&&A$(e.prototype,t),r&&A$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ui(){return typeof Reflect<"u"&&Reflect.get?ui=Reflect.get.bind():ui=function(t,r,n){var o=vOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ui.apply(this,arguments)}function vOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pn(e),e!==null););return e}function pOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rw(e,t)}function rw(e,t){return rw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rw(e,t)}function gOe(e){var t=mOe();return function(){var n=Pn(e),o;if(t){var i=Pn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yOe(this,o)}}function yOe(e,t){if(t&&(tw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nw(e)}function nw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pn(e){return Pn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pn(e)}function I$(e,t,r){bOe(e,t),t.set(e,r)}function bOe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lr(e,t){var r=lj(e,t,"get");return wOe(e,r)}function wOe(e,t){return t.get?t.get.call(e):t.value}function Vl(e,t,r){var n=lj(e,t,"set");return SOe(e,n,r),r}function lj(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function SOe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");var Op="hiddenColumns",COe=310,zr=new WeakMap,Gr=new WeakMap,_Oe=function(e){pOe(r,e);var t=gOe(r);function r(){var n;hOe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),I$(nw(n),zr,{writable:!0,value:{}}),I$(nw(n),Gr,{writable:!0,value:null}),n}return dOe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Op]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Op];Ne(i)&&(Vl(this,zr,i),at(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Vl(this,Gr,new Gh),lr(this,Gr).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,lr(this,Gr)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),ui(Pn(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ui(Pn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Vl(this,zr,{}),ui(Pn(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=lr(this,Gr).getValues().slice(),c=o.length>0;if(l&&c){var f=o.map(function(d){return i.hot.toPhysicalColumn(d)});$(f,function(d){u[d]=!1}),s=Vt(u,function(d,v,g){return v&&d.push(i.hot.toVisualColumn(g)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&c);h!==!1&&(l&&c&&lr(this,Gr).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&c,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(c){lr(i,Gr).setValueAtIndex(i.hot.toPhysicalColumn(c),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return Fe(lr(this,Gr).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return lr(this,Gr).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){$(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(lr(this,zr).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(lr(this,zr).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(lr(this,zr).copyPasteEnabled)return o;var a=[],l=function(u,c,f,h){a.push({startRow:u,endRow:c,startCol:f,endCol:h})};return $(o,function(s){var u=!0,c=0;me(s.startCol,s.endCol,function(f){i.isHidden(f)?(u||l(s.startRow,s.endRow,c,f-1),u=!0):(u&&(c=f),f===s.endCol&&l(s.startRow,s.endRow,c,f),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!lr(this,zr).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Be},aOe(this),fOe(this))}},{key:"onMapInit",value:function(){Array.isArray(lr(this,zr).columns)&&this.hideColumns(lr(this,zr).columns)}},{key:"destroy",value:function(){Vl(this,zr,null),Vl(this,Gr,null),ui(Pn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Op}},{key:"PLUGIN_PRIORITY",get:function(){return COe}}]),r}(Ke);function OOe(e,t){return kOe(e)||TOe(e,t)||EOe(e,t)||ROe()}function ROe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EOe(e,t){if(e){if(typeof e=="string")return $$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $$(e,t)}}function $$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function kOe(e){if(Array.isArray(e))return e}function POe(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=OOe(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(O_,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],c=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectRows(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function dc(e){return MOe(e)||$Oe(e)||IOe(e)||AOe()}function AOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IOe(e,t){if(e){if(typeof e=="string")return ow(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ow(e,t)}}function $Oe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MOe(e){if(Array.isArray(e))return ow(e)}function ow(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xOe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(R_,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=Fe(e.getHiddenRows(),function(C){return n.toPhysicalRow(C)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),c=s.getRenderableFromVisualIndex(l),f=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=c-u+1;if(d>v){var g=f.slice(a,l+1);h.push.apply(h,dc(g.filter(function(C){return o.includes(C)})))}}else if(u===0&&u<a)h.push.apply(h,dc(f.slice(0,a)));else if(u===null)h.push.apply(h,dc(f.slice(0,this.countRows())));else{var y=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(y,-1));c===w&&y>l&&h.push.apply(h,dc(f.slice(l+1)))}return $(h,function(C){t.push(n.toVisualRow(C))}),t.length===0}}}function iw(e){return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(e)}function DOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function HOe(e,t,r){return t&&M$(e.prototype,t),r&&M$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ci(){return typeof Reflect<"u"&&Reflect.get?ci=Reflect.get.bind():ci=function(t,r,n){var o=NOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ci.apply(this,arguments)}function NOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=An(e),e!==null););return e}function LOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aw(e,t)}function aw(e,t){return aw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aw(e,t)}function jOe(e){var t=FOe();return function(){var n=An(e),o;if(t){var i=An(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BOe(this,o)}}function BOe(e,t){if(t&&(iw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lw(e)}function lw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function An(e){return An=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},An(e)}function x$(e,t,r){VOe(e,t),t.set(e,r)}function VOe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yr(e,t){var r=sj(e,t,"get");return WOe(e,r)}function WOe(e,t){return t.get?t.get.call(e):t.value}function Wl(e,t,r){var n=sj(e,t,"set");return UOe(e,n,r),r}function sj(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function UOe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");var Rp="hiddenRows",zOe=320,sn=new WeakMap,Yr=new WeakMap,GOe=function(e){LOe(r,e);var t=jOe(r);function r(){var n;DOe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),x$(lw(n),sn,{writable:!0,value:{}}),x$(lw(n),Yr,{writable:!0,value:null}),n}return HOe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Rp]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Rp];Ne(i)&&(Wl(this,sn,i),at(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Wl(this,Yr,new Gh),yr(this,Yr).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,yr(this,Yr)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),ci(An(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ci(An(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Wl(this,sn,{}),ci(An(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=yr(this,Yr).getValues().slice(),c=o.length>0;if(l&&c){var f=o.map(function(d){return i.hot.toPhysicalRow(d)});$(f,function(d){u[d]=!1}),s=Vt(u,function(d,v,g){return v&&d.push(i.hot.toVisualRow(g)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&c);h!==!1&&(l&&c&&yr(this,Yr).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&c,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(c){yr(i,Yr).setValueAtIndex(i.hot.toPhysicalRow(c),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return Fe(yr(this,Yr).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return yr(this,Yr).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){$(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(yr(this,sn).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(yr(this,sn).copyPasteEnabled)return o;var a=[],l=function(u,c,f,h){a.push({startRow:u,endRow:c,startCol:f,endCol:h})};return $(o,function(s){var u=!0,c=0;me(s.startRow,s.endRow,function(f){i.isHidden(f)?(u||l(c,f-1,s.startCol,s.endCol),u=!0):(u&&(c=f),f===s.endRow&&l(c,f,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!yr(this,sn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Be},POe(this),xOe(this))}},{key:"onMapInit",value:function(){Array.isArray(yr(this,sn).rows)&&this.hideRows(yr(this,sn).rows)}},{key:"destroy",value:function(){Wl(this,sn,null),Wl(this,Yr,null),ci(An(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Rp}},{key:"PLUGIN_PRIORITY",get:function(){return zOe}}]),r}(Ke);function YOe(e,t){return QOe(e)||qOe(e,t)||XOe(e,t)||KOe()}function KOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XOe(e,t){if(e){if(typeof e=="string")return D$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D$(e,t)}}function D$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function QOe(e){if(Array.isArray(e))return e}function ZOe(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(ZC)},callback:function(r,n){var o=YOe(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function JOe(e,t){return nRe(e)||rRe(e,t)||tRe(e,t)||eRe()}function eRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tRe(e,t){if(e){if(typeof e=="string")return H$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H$(e,t)}}function H$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function nRe(e){if(Array.isArray(e))return e}function oRe(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(JC)},callback:function(r,n){var o=JOe(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function sw(e){return sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sw(e)}function iRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function aRe(e,t,r){return t&&N$(e.prototype,t),r&&N$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ma(){return typeof Reflect<"u"&&Reflect.get?Ma=Reflect.get.bind():Ma=function(t,r,n){var o=lRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ma.apply(this,arguments)}function lRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function sRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uw(e,t)}function uw(e,t){return uw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uw(e,t)}function uRe(e){var t=fRe();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cRe(this,o)}}function cRe(e,t){if(t&&(sw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uj(e)}function uj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");var L$="manualColumnFreeze",hRe=110,Ul=new WeakMap,dRe=function(e){sRe(r,e);var t=uRe(r);function r(n){var o;return iRe(this,r),o=t.call(this,n),Ul.set(uj(o),{afterFirstUse:!1}),o}return aRe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[L$]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),Ma(wo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=Ul.get(this);o.afterFirstUse=!1,Ma(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ma(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=Ul.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=Ul.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},ZOe(this),oRe(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=Ul.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return L$}},{key:"PLUGIN_PRIORITY",get:function(){return hRe}}]),r}(Ke);function vRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pRe(e,t,r){return t&&j$(e.prototype,t),r&&j$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ep=0,B$=1,F$=2,ya="px",gRe=function(){function e(t){vRe(this,e),this.hot=t,this._element=null,this.state=Ep,this.inlineProperty=t.isRtl()?"right":"left"}return pRe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=F$}},{key:"build",value:function(){this.state===Ep&&(this._element=this.hot.rootDocument.createElement("div"),this.state=B$)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Ep}},{key:"isAppended",value:function(){return this.state===F$}},{key:"isBuilt",value:function(){return this.state>=B$}},{key:"setPosition",value:function(r,n){br(r)&&(this._element.style.top=r+ya),br(n)&&(this._element.style[this.inlineProperty]=n+ya)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){br(r)&&(this._element.style.width=r+ya),br(n)&&(this._element.style.height=n+ya)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){br(r)&&(this._element.style.marginTop=r+ya),br(n)&&(this._element.style["margin".concat(Bn(this.inlineProperty))]=n+ya)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(Bn(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const cj=gRe;function cw(e){return cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cw(e)}function yRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mRe(e,t,r){return t&&V$(e.prototype,t),r&&V$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ef(){return typeof Reflect<"u"&&Reflect.get?ef=Reflect.get.bind():ef=function(t,r,n){var o=bRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ef.apply(this,arguments)}function bRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=nl(e),e!==null););return e}function wRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fw(e,t)}function fw(e,t){return fw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fw(e,t)}function SRe(e){var t=ORe();return function(){var n=nl(e),o;if(t){var i=nl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CRe(this,o)}}function CRe(e,t){if(t&&(cw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Re(e)}function _Re(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ORe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nl(e){return nl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nl(e)}var RRe="ht__manualColumnMove--backlight",ERe=function(e){wRe(r,e);var t=SRe(r);function r(){return yRe(this,r),t.apply(this,arguments)}return mRe(r,[{key:"build",value:function(){ef(nl(r.prototype),"build",this).call(this),re(this._element,RRe)}}]),r}(cj);const TRe=ERe;function hw(e){return hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hw(e)}function kRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function PRe(e,t,r){return t&&W$(e.prototype,t),r&&W$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tf(){return typeof Reflect<"u"&&Reflect.get?tf=Reflect.get.bind():tf=function(t,r,n){var o=ARe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},tf.apply(this,arguments)}function ARe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ol(e),e!==null););return e}function IRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dw(e,t)}function dw(e,t){return dw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dw(e,t)}function $Re(e){var t=DRe();return function(){var n=ol(e),o;if(t){var i=ol(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MRe(this,o)}}function MRe(e,t){if(t&&(hw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xRe(e)}function xRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ol(e){return ol=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ol(e)}var HRe="ht__manualColumnMove--guideline",NRe=function(e){IRe(r,e);var t=$Re(r);function r(){return kRe(this,r),t.apply(this,arguments)}return PRe(r,[{key:"build",value:function(){tf(ol(r.prototype),"build",this).call(this),re(this._element,HRe)}}]),r}(cj);const LRe=NRe;function vw(e){return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}function jRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BRe(e,t,r){return t&&U$(e.prototype,t),r&&U$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fi(){return typeof Reflect<"u"&&Reflect.get?fi=Reflect.get.bind():fi=function(t,r,n){var o=FRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fi.apply(this,arguments)}function FRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=In(e),e!==null););return e}function VRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pw(e,t)}function pw(e,t){return pw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pw(e,t)}function WRe(e){var t=zRe();return function(){var n=In(e),o;if(t){var i=In(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return URe(this,o)}}function URe(e,t){if(t&&(vw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gw(e)}function gw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function In(e){return In=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},In(e)}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");var Tp="manualColumnMove",GRe=120,Jn=new WeakMap,z$="ht__manualColumnMove",vc="show-ui",kp="on-moving--columns",Pp="after-selection--columns",YRe=function(e){VRe(r,e);var t=WRe(r);function r(n){var o;return jRe(this,r),o=t.call(this,n),Jn.set(gw(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new vt(gw(o)),o.backlight=new TRe(n),o.guideline=new LRe(n),o}return BRe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Tp]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,z$),fi(In(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),fi(In(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){De(this.hot.rootElement,z$),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),fi(In(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=Jn.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var c=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,c),c}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=Jn.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(f){return f<0}),c=o.some(function(f){return f>=a});return!(l||s||u||c)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Vt(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[Tp];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return me(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=Jn.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),c=a.hider.offsetWidth,f=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,g=0;if(this.hot.isRtl()){var y=this.hot.rootWindow,w=Ze(this.hot.rootElement),C=y.innerWidth-o.rootElementOffset-w;g=y.innerWidth-o.target.eventPageX-C-(l.scrollX===void 0?s:0)}else g=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=g){var _=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=_+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var I=g,E=u;g+d+h>=c?I=c-d-h:g+h<f+v&&(I=f+v+Math.abs(h)),u>=c-1?E=c-1:E===0?E=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(E-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,I),this.guideline.setPosition(null,E)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),f=Jn.get(this),h=xe(o.target,"sortAction");if(!c||!u||f.pressed||o.button!==0||h){f.pressed=!1,f.columnsToMove.length=0,De(this.hot.rootElement,[kp,vc]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var g=c.from,y=c.to,w=Math.min(g.col,y.col),C=Math.max(g.col,y.col);if(i.row<0&&i.col>=w&&i.col<=C){l.column=!0,f.pressed=!0,f.target.eventPageX=o.pageX,f.target.eventOffsetX=o.offsetX,f.hoveredColumn=i.col,f.target.TD=a,f.target.col=i.col,f.columnsToMove=this.prepareColumnsToMoving(w,C),f.hasRowHeaders=!!this.hot.getSettings().rowHeaders,f.countCols=this.hot.countCols(),f.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,f.rootElementOffset=Tt(this.hot.rootElement).left;var _=f.hasRowHeaders?-1:0,I=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,E=i.col<f.fixedColumnsStart,U=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),G=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),Q=this.getColumnsWidth(w,i.col-1)+G,K=this.getColumnsWidth(_,w-1)+(E?U:0)+Q;this.backlight.setPosition(I,K),this.backlight.setSize(this.getColumnsWidth(w,C),s.hider.offsetHeight-I),this.backlight.setOffset(null,-Q),re(this.hot.rootElement,kp)}else De(this.hot.rootElement,Pp),f.pressed=!1,f.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Jn.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Jn.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?De(this.hot.rootElement,vc):re(this.hot.rootElement,vc),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Jn.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,De(this.hot.rootElement,[kp,vc,Pp]),this.hot.selection.isSelectedByColumnHeader()&&re(this.hot.rootElement,Pp),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualColumn(s),f=c+a-1;this.hot.selectColumns(c,f)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),fi(In(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Tp}},{key:"PLUGIN_PRIORITY",get:function(){return GRe}}]),r}(Ke);function yw(e){return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(e)}function KRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XRe(e,t,r){return t&&G$(e.prototype,t),r&&G$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hi(){return typeof Reflect<"u"&&Reflect.get?hi=Reflect.get.bind():hi=function(t,r,n){var o=qRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hi.apply(this,arguments)}function qRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$n(e),e!==null););return e}function QRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mw(e,t)}function mw(e,t){return mw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mw(e,t)}function ZRe(e){var t=eEe();return function(){var n=$n(e),o;if(t){var i=$n(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JRe(this,o)}}function JRe(e,t){if(t&&(yw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bw(e)}function bw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $n(e){return $n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$n(e)}var pc="manualColumnResize",tEe=130,Y$="manualColumnWidths",Ap=new WeakMap,rEe=function(e){QRe(r,e);var t=ZRe(r);function r(n){var o;KRe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new vt(bw(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,Ap.set(bw(o),{config:void 0}),re(o.handle,"manualColumnResizer"),re(o.guide,"manualColumnResizerGuide"),o}return XRe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[pc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Po,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),hi($n(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),hi($n(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=Ap.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),hi($n(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",Y$,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",Y$,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=Ap.get(this),a=this.hot.getSettings()[pc],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=dt(this.currentTH),c=this.currentTH.getBoundingClientRect(),f=s<a.getSetting("fixedColumnsStart"),h;f&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();$(v,function(g){var y=g.getTopStartCorner().col,w=g.getBottomEndCorner().col;me(y,w,function(C){i.selectedCols.includes(C)||i.selectedCols.push(C)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(c.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(dt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){De(this.handle,"active"),De(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!_i(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!MD(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);f!==void 0&&(o.newSize=f),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),c&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?($(this.selectedCols,function(s){a(s)}),i()):$(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,$(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,c){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),c&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?($(this.selectedCols,function(s){a(s)}),i()):$(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[pc]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){hi($n(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return pc}},{key:"PLUGIN_PRIORITY",get:function(){return tEe}}]),r}(Ke);function nEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oEe(e,t,r){return t&&K$(e.prototype,t),r&&K$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ip=0,X$=1,q$=2,ma="px",iEe=function(){function e(t){nEe(this,e),this.hot=t,this._element=null,this.state=Ip}return oEe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=q$}},{key:"build",value:function(){this.state===Ip&&(this._element=this.hot.rootDocument.createElement("div"),this.state=X$)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Ip}},{key:"isAppended",value:function(){return this.state===q$}},{key:"isBuilt",value:function(){return this.state>=X$}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+ma),n!==void 0&&(this._element.style.left=n+ma)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+ma),n&&(this._element.style.height=n+ma)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+ma),n&&(this._element.style.marginLeft=n+ma)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const fj=iEe;function ww(e){return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(e)}function aEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lEe(e,t,r){return t&&Q$(e.prototype,t),r&&Q$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rf(){return typeof Reflect<"u"&&Reflect.get?rf=Reflect.get.bind():rf=function(t,r,n){var o=sEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},rf.apply(this,arguments)}function sEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=il(e),e!==null););return e}function uEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sw(e,t)}function Sw(e,t){return Sw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Sw(e,t)}function cEe(e){var t=dEe();return function(){var n=il(e),o;if(t){var i=il(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fEe(this,o)}}function fEe(e,t){if(t&&(ww(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hEe(e)}function hEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function il(e){return il=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},il(e)}var vEe="ht__manualRowMove--backlight",pEe=function(e){uEe(r,e);var t=cEe(r);function r(){return aEe(this,r),t.apply(this,arguments)}return lEe(r,[{key:"build",value:function(){rf(il(r.prototype),"build",this).call(this),re(this._element,vEe)}}]),r}(fj);const gEe=pEe;function Cw(e){return Cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cw(e)}function yEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mEe(e,t,r){return t&&Z$(e.prototype,t),r&&Z$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nf(){return typeof Reflect<"u"&&Reflect.get?nf=Reflect.get.bind():nf=function(t,r,n){var o=bEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},nf.apply(this,arguments)}function bEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=al(e),e!==null););return e}function wEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_w(e,t)}function _w(e,t){return _w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_w(e,t)}function SEe(e){var t=OEe();return function(){var n=al(e),o;if(t){var i=al(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CEe(this,o)}}function CEe(e,t){if(t&&(Cw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ee(e)}function _Ee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function al(e){return al=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},al(e)}var REe="ht__manualRowMove--guideline",EEe=function(e){wEe(r,e);var t=SEe(r);function r(){return yEe(this,r),t.apply(this,arguments)}return mEe(r,[{key:"build",value:function(){nf(al(r.prototype),"build",this).call(this),re(this._element,REe)}}]),r}(fj);const TEe=EEe;function Ow(e){return Ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ow(e)}function kEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function PEe(e,t,r){return t&&J$(e.prototype,t),r&&J$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function di(){return typeof Reflect<"u"&&Reflect.get?di=Reflect.get.bind():di=function(t,r,n){var o=AEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},di.apply(this,arguments)}function AEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mn(e),e!==null););return e}function IEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rw(e,t)}function Rw(e,t){return Rw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Rw(e,t)}function $Ee(e){var t=xEe();return function(){var n=Mn(e),o;if(t){var i=Mn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MEe(this,o)}}function MEe(e,t){if(t&&(Ow(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ew(e)}function Ew(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mn(e){return Mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mn(e)}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");var $p="manualRowMove",DEe=140,eo=new WeakMap,e1="ht__manualRowMove",gc="show-ui",Mp="on-moving--rows",xp="after-selection--rows",HEe=function(e){IEe(r,e);var t=$Ee(r);function r(n){var o;return kEe(this,r),o=t.call(this,n),eo.set(Ew(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new vt(Ew(o)),o.backlight=new gEe(n),o.guideline=new TEe(n),o}return PEe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$p]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,e1),di(Mn(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),di(Mn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){De(this.hot.rootElement,e1),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),di(Mn(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=eo.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var c=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,c),c}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=eo.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(f){return f<0}),c=o.some(function(f){return f>=a});return!(l||s||u||c)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Vt(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[$p];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return me(s,u,function(c){i.push(c)}),i}},{key:"refreshPositions",value:function(){var o=eo.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,c=o.target.TD,f=Tt(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),d=o.target.eventPageY-f.top+u.holder.scrollTop,v=u.hider.offsetHeight,g=u.TBODY.offsetTop,y=this.backlight.getOffset().top,w=this.backlight.getSize().height;this.isFixedRowTop(i.row)&&(h+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:c.offsetHeight/2+h<=d?(o.target.row=i.row+1,h+=i.row===0?c.offsetHeight-1:c.offsetHeight):o.target.row=i.row;var C=d,_=h;d+w+y>=v?C=v-w-y:d+y<g&&(C=g+Math.abs(y)),h>=v-1&&(_=v-1),this.backlight.setPosition(C),this.guideline.setPosition(_)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,c=s.wtViewport,f=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=eo.get(this);if(!h||!f||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,De(this.hot.rootElement,[Mp,gc]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),g=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&g&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var y=h.from,w=h.to,C=Math.min(y.row,w.row),_=Math.max(y.row,w.row);if(i.col<0&&i.row>=C&&i.row<=_){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var I=u.holder.scrollLeft+c.getRowHeaderWidth();this.backlight.setPosition(null,I),this.backlight.setSize(u.hider.offsetWidth-I,this.getRowsHeight(C,_)),this.backlight.setOffset((this.getRowsHeight(C,i.row-1)+o.offsetY)*-1,null),re(this.hot.rootElement,Mp),this.refreshPositions()}else De(this.hot.rootElement,xp),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=eo.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=eo.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?De(this.hot.rootElement,gc):re(this.hot.rootElement,gc),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=eo.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,De(this.hot.rootElement,[Mp,gc,xp]),this.hot.selection.isSelectedByRowHeader()&&re(this.hot.rootElement,xp),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualRow(s),f=c+a-1;this.hot.selectRows(c,f)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),di(Mn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $p}},{key:"PLUGIN_PRIORITY",get:function(){return DEe}}]),r}(Ke);function Tw(e){return Tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tw(e)}function NEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function LEe(e,t,r){return t&&t1(e.prototype,t),r&&t1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vi(){return typeof Reflect<"u"&&Reflect.get?vi=Reflect.get.bind():vi=function(t,r,n){var o=jEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},vi.apply(this,arguments)}function jEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xn(e),e!==null););return e}function BEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kw(e,t)}function kw(e,t){return kw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kw(e,t)}function FEe(e){var t=WEe();return function(){var n=xn(e),o;if(t){var i=xn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VEe(this,o)}}function VEe(e,t){if(t&&(Tw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pw(e)}function Pw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xn(e){return xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xn(e)}var yc="manualRowResize",UEe=30,r1="manualRowHeights",Dp=new WeakMap,zEe=function(e){BEe(r,e);var t=FEe(r);function r(n){var o;NEe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new vt(Pw(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,Dp.set(Pw(o),{config:void 0}),re(o.handle,"manualRowResizer"),re(o.guide,"manualRowResizerGuide"),o}return LEe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[yc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Po,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),vi(xn(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),vi(xn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=Dp.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),vi(xn(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",r1,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",r1,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,vH.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var c=Ze(this.currentTH),f=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){var y=this.hot.getSelectedRange();$(y,function(w){var C=w.getTopStartCorner().row,_=w.getBottomStartCorner().row;me(C,_,function(I){i.selectedRows.includes(I)||i.selectedRows.push(I)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(f.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(c,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Ze(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){De(this.handle,"active"),De(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=_i(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!MD(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);f!==void 0&&(o.newSize=f),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),c&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?($(this.selectedRows,function(s){a(s)}),i()):$(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),$(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,c){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),c&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?($(this.selectedRows,function(s){a(s)}),i()):$(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[yc]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=Dp.get(this),a=this.hot.getSettings()[yc],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){vi(xn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yc}},{key:"PLUGIN_PRIORITY",get:function(){return UEe}}]),r}(Ke),n1,o1,i1,a1;function mc(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function GEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function YEe(e,t,r){return t&&l1(e.prototype,t),r&&l1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var KEe=function(){function e(t,r,n,o,i,a){GEe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return YEe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),c=this[l],f=this[l]+this[a]-1;if(c>=n&&(this[l]+=o),o>0)n<=f&&n>c&&(this[a]+=o);else if(o<0){if(s<=c&&u>=f)return this.removed=!0,!1;if(c>=s&&c<=u){var h=u-c+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(c<=s&&f>=u)this[a]+=o;else if(c<=s&&f>=s&&f<u){var v=f-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return Je(n1||(n1=mc(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return Je(o1||(o1=mc(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return Je(i1||(i1=mc(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return Je(a1||(a1=mc(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const qr=KEe;function Aw(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}var s1;function XEe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function u1(e){return JEe(e)||ZEe(e)||QEe(e)||qEe()}function qEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QEe(e,t){if(e){if(typeof e=="string")return Iw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Iw(e,t)}}function ZEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JEe(e){if(Array.isArray(e))return Iw(e)}function Iw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tTe(e,t,r){return t&&c1(e.prototype,t),r&&c1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var rTe=function(){function e(t){eTe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return tTe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return $(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return $(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return $(i,function(c){var f=n.hot._createCellCoords(c.row,c.col),h=n.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),d=n.hot._createCellRange(f,f,h);o?l.overlaps(d)&&a.push(c):l.includesRange(d)&&a.push(c)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new qr(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),c=this.isOverlapping(s);return!u&&!c?(this.hot&&s.normalize(this.hot),n.push(s),s):(ot(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];$(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,$(o,function(a,l){me(0,a.rowspan-1,function(s){me(0,a.colspan-1,function(u){if(u!==0||s!==0){var c=r.hot.getCell(a.row+s,a.col+u);c&&i.push([c,null,null,null])}})}),o[l][1]=null}),$(o,function(a){Aw.apply(void 0,u1(a))}),$(i,function(a){Aw.apply(void 0,u1(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return $(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}$(this.mergedCells,function(l){l.shift(a,n)}),Dg(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return Je(s1||(s1=XEe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const nTe=rTe;function Vo(e,t){return lTe(e)||aTe(e,t)||iTe(e,t)||oTe()}function oTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iTe(e,t){if(e){if(typeof e=="string")return f1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f1(e,t)}}function f1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function lTe(e){if(Array.isArray(e))return e}function sTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uTe(e,t,r){return t&&h1(e.prototype,t),r&&h1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var cTe=function(){function e(t){sTe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return uTe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=Vo(r,4),u=s[0],c=s[1],f=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?f-u+1:h-c+1,g=Math.floor(l/v)*v,y=l-g,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var C=w.row+w.rowspan-u-y,_=a[2]+C;_>=this.plugin.hot.countRows()?a[2]-=y:a[2]+=y?C:0}else if(o==="right"){var I=w.col+w.colspan-c-y,E=a[3]+I;E>=this.plugin.hot.countCols()?a[3]-=y:a[3]+=y?I:0}else if(o==="up"){var U=f-y-w.row+1,G=a[0]+U;G<0?a[0]+=y:a[0]-=y?U:0}else if(o==="left"){var Q=h-y-w.col+1,K=a[1]+Q;K<0?a[1]+=y:a[1]-=y?Q:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),ht(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=Vo(r,4),a=i[0],l=i[1],s=i[2],u=i[3],c=Vo(n,4),f=c[0],h=c[1],d=c[2],v=c[3];switch(o){case"up":return a-f;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=Vo(r,4),a=i[0],l=i[1],s=i[2],u=i[3],c=Vo(n,4),f=c[0],h=c[1],d=c[2],v=c[3];switch(o){case"up":return[f,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[f,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=Vo(r,4),l=a[0],s=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(o)>-1,h=f?u:c,d=f?l:s,v=this.getAutofillSize(r,n,o),g=f?u-l+1:c-s+1,y=Math.floor(v/g)*g,w=v-y,C=null,_=null,I=null;switch(o){case"up":C="includesVertically",I=h-w+1;break;case"left":C="includesHorizontally",I=h-w+1;break;case"down":C="includesVertically",I=d+w-1;break;case"right":C="includesHorizontally",I=d+w-1;break}return $(i,function(E){E[C](I)&&E.isFarther(_,o)&&(_=E)}),_}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var c=0;c<o.length;c+=1){if(s=o[c],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}c===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return $(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=Vo(i,4),l=a[0],s=a[1],u=a[2],c=a[3],f=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,c),d=this.plugin.hot._createCellRange(f,f,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const fTe=cTe;function hTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dTe(e,t,r){return t&&d1(e.prototype,t),r&&d1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var vTe=function(){function e(t){hTe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return dTe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var c=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(c){var f=this.plugin.mergedCellsCollection.get(r,n);if(f){var h=f.getLastRow(),d=f.getLastColumn(),v=a<=f.row&&l<=f.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(f,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const pTe=vTe;function gTe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(t_)}return this.getTranslatedPhrase(e_)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=qr.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function $w(e){return $w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$w(e)}function v1(e,t){return bTe(e)||mTe(e,t)||hj(e,t)||yTe()}function yTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function bTe(e){if(Array.isArray(e))return e}function p1(e){return CTe(e)||STe(e)||hj(e)||wTe()}function wTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hj(e,t){if(e){if(typeof e=="string")return Mw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mw(e,t)}}function STe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CTe(e){if(Array.isArray(e))return Mw(e)}function Mw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function OTe(e,t,r){return t&&g1(e.prototype,t),r&&g1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xa(){return typeof Reflect<"u"&&Reflect.get?xa=Reflect.get.bind():xa=function(t,r,n){var o=RTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xa.apply(this,arguments)}function RTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function ETe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xw(e,t)}function xw(e,t){return xw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xw(e,t)}function TTe(e){var t=PTe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kTe(this,o)}}function kTe(e,t){if(t&&($w(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dj(e)}function dj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");var Jl="mergeCells",ATe=150,y1=new WeakMap,m1=Jl,ITe=function(e){ETe(r,e);var t=TTe(r);function r(n){var o;return _Te(this,r),o=t.call(this,n),y1.set(dj(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return OTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Jl]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new nTe(this),this.autofillCalculations=new fTe(this),this.selectionCalculations=new pTe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),xa(So(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),xa(So(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[Jl];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),xa(So(r.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(o){var i=!0;return o?(qr.containsNegativeValues(o)?(ot(qr.NEGATIVE_VALUES_WARNING(o)),i=!1):qr.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(ot(qr.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):qr.isSingleCell(o)?(ot(qr.IS_SINGLE_CELL(o)),i=!1):qr.containsZeroSpan(o)&&(ot(qr.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a,l=[];$(o,function(u){if(i.validateSetting(u)){var c=i.hot._createCellCoords(u.row,u.col),f=i.hot._createCellCoords(u.row+u.rowspan-1,u.col+u.colspan-1),h=i.hot._createCellRange(c,c,f);l.push(i.mergeRange(h,!0,!0))}}),l=l.filter(function(u){return u!==!0});var s=this.getBulkCollectionData(l);(a=this.hot).populateFromArray.apply(a,p1(s))}}},{key:"getBulkCollectionData",value:function(o){var i,a=this.getBulkCollectionDataRange(o),l=(i=this.hot).getData.apply(i,p1(a)),s=l.splice(0);return $(o,function(u){var c=v1(u,3),f=c[0],h=c[1],d=c[2];$(d,function(v,g){$(v,function(y,w){s[f-a[0]+g][h-a[1]+w]=y})})}),[a[0],a[1],s]}},{key:"getBulkCollectionDataRange",value:function(o){var i=[0,0],a=[0,0],l=null,s=null,u=null;return $(o,function(c){l=c[0],s=c[1],u=c[2],i[0]=Math.min(l,i[0]),i[1]=Math.min(s,i[1]),a[0]=Math.max(l+u.length-1,a[0]),a[1]=Math.max(s+u[0].length-1,a[1])}),[].concat(i,a)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),c={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},f=[],h=null;if(!this.canMergeRange(c,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),me(0,c.rowspan-1,function(v){me(0,c.colspan-1,function(g){var y=null;f[v]||(f[v]=[]),v===0&&g===0?y=i.hot.getDataAtCell(c.row,c.col):i.hot.setCellMeta(c.row+v,c.col+g,"hidden",!0),f[v][g]=y})}),this.hot.setCellMeta(c.row,c.col,"spanned",!0);var d=this.mergedCellsCollection.add(c);return d?(l?h=[c.row,c.col,f]:this.hot.populateFromArray(c.row,c.col,f,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",o,c,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),$(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),me(0,s.rowspan-1,function(u){me(0,s.colspan-1,function(c){i.hot.removeCellMeta(s.row+u,s.col+c,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Jl]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:m1})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(m1)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=y1.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),c=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),c){var f=this.hot._createCellCoords(c.row,c.col),h=this.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),d=this.hot._createCellRange(f,f,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=c.row+c.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-c.row+o.row),o.col>0?l.col=c.col+c.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-c.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var g=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:g.row-u.row,col:g.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=tr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=tr(l),c=this.mergedCellsCollection.getWithinRange(s,!0);do u=tr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),$(c,function(f){i.selectionCalculations.snapDelta(l,a,f)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,c=a.rowspan;return[l,s,l+c-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},gTe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ne(l)?tr(l):void 0;if(Ne(s)){var u=this.hot,c=u.rowIndexMapper,f=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,g=s.rowspan,y=this.translateMergedCellToRenderable(h,g,d,v),w=v1(y,2),C=w[0],_=w[1],I=c.getRenderableFromVisualIndex(i),E=f.getRenderableFromVisualIndex(a),U=C-I+1,G=_-E+1;s.row=c.getNearestNotHiddenIndex(s.row,1),s.col=f.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,U),s.colspan=Math.min(s.colspan,G)}Aw(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ne(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(c<o.startRow){o.startRow=c,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ne(u)){var c=u.row+u.rowspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>o.endRow){o.endRow=f,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ne(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(c<o.startColumn){o.startColumn=c,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ne(u)){var c=u.col+u.colspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>o.endColumn){o.endColumn=f,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,c=s.columnIndexMapper,f,h;i===0?f=u.getNearestNotHiddenIndex(o,1):f=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=c.getNearestNotHiddenIndex(a,1):h=c.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(f):o,v=a>=0?c.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);$(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,c=a<0,f=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,g=l.col===0;(s&&h||u&&d||f&&v||c&&g)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Jl}},{key:"PLUGIN_PRIORITY",get:function(){return ATe}}]),r}(Ke);function b1(e){return DTe(e)||xTe(e)||MTe(e)||$Te()}function $Te(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MTe(e,t){if(e){if(typeof e=="string")return w1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w1(e,t)}}function w1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DTe(e){if(Array.isArray(e))return e}function HTe(e,t){return function(r,n){var o=b1(r),i=o.slice(1),a=b1(n),l=a.slice(1);return function s(u){var c=e[u],f=t[u],h=i[u],d=l[u],v=f.multiColumnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:lL(f.type),y=g(c,f,v)(h,d);if(y===en){var w=u+1;if(typeof t[w]<"u")return s(w)}return y}(0)}}var S1;function NTe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function C1(){ot(Je(S1||(S1=NTe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var vj="sort";function LTe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(vj,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function jTe(e){var t=e.className.split(" "),r=new RegExp("^".concat(vj,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function Dw(e){return Dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dw(e)}function BTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function FTe(e,t,r){return t&&_1(e.prototype,t),r&&_1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cr(){return typeof Reflect<"u"&&Reflect.get?cr=Reflect.get.bind():cr=function(t,r,n){var o=VTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cr.apply(this,arguments)}function VTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gt(e),e!==null););return e}function WTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hw(e,t)}function Hw(e,t){return Hw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Hw(e,t)}function UTe(e){var t=YTe();return function(){var n=Gt(e),o;if(t){var i=Gt(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zTe(this,o)}}function zTe(e,t){if(t&&(Dw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GTe(e)}function GTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gt(e){return Gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gt(e)}var Nw="multiColumnSorting",KTe=170,XTe="append",O1="columnSorting";aL(Nw,HTe);var qTe=function(e){WTe(r,e);var t=UTe(r);function r(n){var o;return BTe(this,r),o=t.call(this,n),o.pluginKey=Nw,o}return FTe(r,[{key:"isEnabled",value:function(){return cr(Gt(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[O1]&&C1(),cr(Gt(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){cr(Gt(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){cr(Gt(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){cr(Gt(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return cr(Gt(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return cr(Gt(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){cr(Gt(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=cr(Gt(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),De(o,jTe(o)),this.enabled!==!1&&re(o,LTe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[O1]&&C1(),cr(Gt(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){ob(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,XTe))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return Nw}},{key:"PLUGIN_PRIORITY",get:function(){return KTe}}]),r}(sL);function Lw(e){return Lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lw(e)}function QTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ZTe(e,t,r){return t&&R1(e.prototype,t),r&&R1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function of(){return typeof Reflect<"u"&&Reflect.get?of=Reflect.get.bind():of=function(t,r,n){var o=JTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},of.apply(this,arguments)}function JTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ll(e),e!==null););return e}function eke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jw(e,t)}function jw(e,t){return jw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jw(e,t)}function tke(e){var t=oke();return function(){var n=ll(e),o;if(t){var i=ll(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rke(this,o)}}function rke(e,t){if(t&&(Lw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nke(e)}function nke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ll(e){return ll=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ll(e)}var ike="multipleSelectionHandles",ake=160,lke=function(e){eke(r,e);var t=tke(r);function r(n){var o;return QTe(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return ZTe(r,[{key:"isEnabled",value:function(){return Jr()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new vt(this)),this.registerListeners(),of(ll(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,c,f,h,d,v,g;if(i.dragged.length!==0){var y=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!y||y===i.lastSetCell||((y.nodeName==="TD"||y.nodeName==="TH")&&(c=i.hot.getCoords(y),c.col===-1&&(c.col=0),f=i.hot.getSelectedRangeLast(),h=f.getWidth(),d=f.getHeight(),v=f.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(c),g=i.getCurrentRangeCoords(f,c,i.touchStartRange.direction,v,i.dragged[0]),g.start!==null&&i.hot.selection.setRangeStart(g.start),i.hot.selection.setRangeEnd(g.end),i.lastSetCell=y),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),c=o.getBottomEndCorner(),f=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(f.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(c.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:f}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:c}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(f.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,c.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,c.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:f,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return ike}},{key:"PLUGIN_PRIORITY",get:function(){return ake}}]),r}(Ke);function Bw(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,c=u===void 0?[]:u,f=e.isCollapsed,h=f===void 0?!1:f,d=e.isHidden,v=d===void 0?!1:d,g=e.isRoot,y=g===void 0?!1:g,w=e.isPlaceholder,C=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:c,isHidden:v,isRoot:y,isPlaceholder:C}}function pj(){return{label:"",isPlaceholder:!0}}function E1(e){return fke(e)||cke(e)||uke(e)||ske()}function ske(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uke(e,t){if(e){if(typeof e=="string")return Fw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fw(e,t)}}function cke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fke(e){if(Array.isArray(e))return Fw(e)}function Fw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hke(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;$(e,function(o){var i=[],a=0;r.push(i),$(o,function(l){var s=Bw();if(Ne(l)){var u=l.label,c=l.colspan;s.label=wt(u),typeof c=="number"&&c>1&&(s.colspan=c,s.origColspan=c)}else s.label=wt(l);a+=s.origColspan;var f=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,f=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(pj());return!f})});var n=Math.max.apply(Math,E1(Fe(r,function(o){return o.length})));return $(r,function(o){if(o.length<n){var i=Fe(new Array(n-o.length),function(){return Bw()});o.splice.apply(o,[o.length,0].concat(E1(i)))}}),r}var dke=["row","col"];function T1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function vke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T1(Object(r),!0).forEach(function(n){pke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gke(e,t){if(e==null)return{};var r=yke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function mke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bke(e,t,r){return t&&k1(e.prototype,t),r&&k1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hp(e,t,r){wke(e,t),t.set(e,r)}function wke(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pr(e,t){var r=gj(e,t,"get");return Ske(e,r)}function Ske(e,t){return t.get?t.get.call(e):t.value}function zl(e,t,r){var n=gj(e,t,"set");return Cke(e,n,r),r}function gj(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Cke(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var P1=["label","collapsible"],un=new WeakMap,Wo=new WeakMap,Np=new WeakMap,_ke=function(){function e(){mke(this,e),Hp(this,un,{writable:!0,value:[]}),Hp(this,Wo,{writable:!0,value:0}),Hp(this,Np,{writable:!0,value:1/0})}return bke(e,[{key:"setColumnsLimit",value:function(r){zl(this,Np,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];zl(this,un,hke(r,Pr(this,Np))),zl(this,Wo,Pr(this,un).length)}},{key:"getData",value:function(){return Pr(this,un)}},{key:"mergeWith",value:function(r){var n=this;$(r,function(o){var i=o.row,a=o.col,l=gke(o,dke),s=n.getHeaderSettings(i,a);s!==null&&ht(s,l,P1)})}},{key:"map",value:function(r){$(Pr(this,un),function(n){$(n,function(o){var i=r(vke({},o));Ne(i)&&ht(o,i,P1)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=Pr(this,Wo)||r<0)return null;var i=Pr(this,un)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=Pr(this,Wo)||r<0)return i;for(var a=Pr(this,un)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return Pr(this,Wo)}},{key:"getColumnsCount",value:function(){return Pr(this,Wo)>0?Pr(this,un)[0].length:0}},{key:"clear",value:function(){zl(this,un,[]),zl(this,Wo,0)}}]),e}();function A1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function I1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A1(Object(r),!0).forEach(function(n){af(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rke(e,t,r){return t&&$1(e.prototype,t),r&&$1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function af(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eke(e){return Ake(e)||Pke(e)||kke(e)||Tke()}function Tke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kke(e,t){if(e){if(typeof e=="string")return Vw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vw(e,t)}}function Pke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ake(e){if(Array.isArray(e))return Vw(e)}function Vw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ike="DF-pre-order";function yj(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=yj.call(this.childs[n],e,t)}return r}var $ke="DF-post-order";function mj(e,t){for(var r=0;r<this.childs.length;r++){var n=mj.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var bj="BF";function Mke(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,Eke(o.childs)),e.call(t,o)!==!1&&n()}}n()}var xke=bj,M1=new Map([[Ike,yj],[$ke,mj],[bj,Mke]]),x1=function(){function e(t){Oke(this,e),af(this,"data",{}),af(this,"parent",null),af(this,"childs",[]),this.data=t}return Rke(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(I1({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=I1({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xke;if(!M1.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));M1.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function D1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function H1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D1(Object(r),!0).forEach(function(n){Dke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hke(e,t){return Bke(e)||jke(e,t)||Lke(e,t)||Nke()}function Nke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lke(e,t){if(e){if(typeof e=="string")return N1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N1(e,t)}}function N1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Bke(e){if(Array.isArray(e))return e}function Fke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vke(e,t,r){return t&&L1(e.prototype,t),r&&L1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lp(e,t,r){Wke(e,t),t.set(e,r)}function Wke(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(e,t){var r=wj(e,t,"get");return Uke(e,r)}function Uke(e,t){return t.get?t.get.call(e):t.value}function zke(e,t,r){var n=wj(e,t,"set");return Gke(e,n,r),r}function wj(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Gke(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ba=new WeakMap,Uo=new WeakMap,wa=new WeakMap,Yke=function(){function e(t){Fke(this,e),Lp(this,ba,{writable:!0,value:new Map}),Lp(this,Uo,{writable:!0,value:new Map}),Lp(this,wa,{writable:!0,value:null}),zke(this,wa,t)}return Vke(e,[{key:"getRoots",value:function(){return Array.from(zt(this,ba).values())}},{key:"getRootByColumn",value:function(r){var n;return zt(this,Uo).has(r)&&(n=zt(this,ba).get(zt(this,Uo).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-zt(this,Uo).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,c=u.origColspan,f=u.headerLevel;if(r===f){if(i>=a&&i<=a+c-1)return l=s,!1;a+=c}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;zt(this,Uo).clear(),$(zt(this,ba),function(o){for(var i=Hke(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)zt(r,Uo).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=zt(this,wa).getColumnsCount(),n=0;n<r;){var o=zt(this,wa).getHeaderSettings(0,n),i=new x1;zt(this,ba).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=zt(this,wa).getHeadersSettings(o,n,a);o+=1,$(l,function(s){var u=H1(H1({},s),{},{headerLevel:o-1,columnIndex:n}),c;o===1?(r.data=u,c=r):(c=new x1(u),r.addChild(c)),o<zt(i,wa).getLayersCount()&&i.buildLeaves(c,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){zt(this,ba).clear(),zt(this,Uo).clear()}}]),e}();function Sj(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function ph(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function gh(e){return ph(e,"origColspan")===e.data.origColspan}function EO(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=gh(e);if(n)return EO(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)$(o,function(f){f.replaceTreeWith(f.data.clonedTree),f.data.clonedTree=null;var h=f.data;a+=h.colspan,Sj(f,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var c=1;c<s;c++)i.add(u+c)}return e.walkUp(function(f){var h=f.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):gh(f)&&(h.isCollapsed=ph(f,"isCollapsed"))}),{rollbackModification:function(){return TO(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function TO(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=gh(e);if(o)return TO(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)$(i,function(h){Sj(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var c=s+u;a.add(c)}var f=r.colspan-((t=ph(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=f,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):gh(h)&&(d.isCollapsed=ph(h,"isCollapsed"))}),{rollbackModification:function(){return EO(e)},affectedColumns:Array.from(a),colspanCompensation:f}}var j1;function Kke(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Xke(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Je(j1||(j1=Kke([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var B1;function qke(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Qke(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Je(B1||(B1=qke([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var F1=new Map([["collapse",TO],["expand",EO],["hide-column",Xke],["show-column",Qke]]);function Zke(e,t,r){if(!F1.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return F1.get(e)(t,r)}var Jke=["crossHiddenColumns"];function e0e(e,t){if(e==null)return{};var r=t0e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t0e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function bc(e){var t=[];return $(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=n0e(t,l),c=!1,f=a;f<a+i;f++){var h=s.includes(f);if(h||c)u.push(pj());else{var d=r0e(o);d.isRoot=!0,u.push(d),c=!0}}})}),t}function r0e(e){var t=Bw(e);t.crossHiddenColumns;var r=e0e(t,Jke);return r}function n0e(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}var o0e=["row"];function V1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function W1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V1(Object(r),!0).forEach(function(n){i0e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i0e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a0e(e,t){if(e==null)return{};var r=l0e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function l0e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function s0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u0e(e,t,r){return t&&U1(e.prototype,t),r&&U1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jp(e,t,r){c0e(e,t),t.set(e,r)}function c0e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gl(e,t,r){var n=Cj(e,t,"set");return f0e(e,n,r),r}function f0e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function yt(e,t){var r=Cj(e,t,"get");return h0e(e,r)}function Cj(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function h0e(e,t){return t.get?t.get.call(e):t.value}var Kr=new WeakMap,sr=new WeakMap,zo=new WeakMap,d0e=function(){function e(){s0e(this,e),jp(this,Kr,{writable:!0,value:new _ke}),jp(this,sr,{writable:!0,value:new Yke(yt(this,Kr))}),jp(this,zo,{writable:!0,value:[[]]})}return u0e(e,[{key:"setState",value:function(r){yt(this,Kr).setData(r);var n=!1;try{yt(this,sr).buildTree()}catch{yt(this,sr).clear(),yt(this,Kr).clear(),n=!0}return Gl(this,zo,bc(yt(this,sr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){yt(this,Kr).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=Fe(r,function(i){var a=i.row,l=a0e(i,o0e);return W1({row:a<0?n.rowCoordsToLevel(a):a},l)});yt(this,Kr).mergeWith(o),yt(this,sr).buildTree(),Gl(this,zo,bc(yt(this,sr).getRoots()))}},{key:"mapState",value:function(r){yt(this,Kr).map(r),yt(this,sr).buildTree(),Gl(this,zo,bc(yt(this,sr).getRoots()))}},{key:"mapNodes",value:function(r){return Vt(yt(this,sr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=yt(this,sr).getNode(n,o),a;return i&&(a=Zke(r,i,o),Gl(this,zo,bc(yt(this,sr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){var n=Math.max(this.getLayersCount(),1),o=n-1,i=0;return Math.min(Math.max(r+n,i),o)}},{key:"levelToRowCoords",value:function(r){var n=Math.max(this.getLayersCount(),1),o=-1,i=-n;return Math.min(Math.max(r-n,i),o)}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r>=this.getLayersCount()?null:(o=(i=yt(this,zo)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){r<0&&(r=this.rowCoordsToLevel(r));var o=yt(this,sr).getNode(r,n);return o?W1({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},c=u.isRoot;if(c)break;l-=1}return l}},{key:"getLayersCount",value:function(){return yt(this,Kr).getLayersCount()}},{key:"getColumnsCount",value:function(){return yt(this,Kr).getColumnsCount()}},{key:"clear",value:function(){Gl(this,zo,[]),yt(this,Kr).clear(),yt(this,sr).clear()}}]),e}();function v0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p0e(e,t,r){return t&&z1(e.prototype,t),r&&z1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g0e=function(){function e(t,r){v0e(this,e),Yl(this,"hot",void 0),Yl(this,"nestedHeaderSettingsGetter",void 0),Yl(this,"layersCount",0),Yl(this,"container",void 0),Yl(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return p0e(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),c=0;c<this.layersCount;c++){for(var f=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),g=this.nestedHeaderSettingsGetter(c,d);if(g&&(!g.isPlaceholder||g.isHidden)){var y=g.label;s&&(y+='<button class="changeType"></button>'),zi(v,y),v.colSpan=g.colspan,f.appendChild(v)}}l.appendChild(f)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const y0e=g0e;function Ww(e){return Ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ww(e)}var G1,Y1;function K1(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function m0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b0e(e,t,r){return t&&X1(e.prototype,t),r&&X1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pi(){return typeof Reflect<"u"&&Reflect.get?pi=Reflect.get.bind():pi=function(t,r,n){var o=w0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pi.apply(this,arguments)}function w0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Dn(e),e!==null););return e}function S0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uw(e,t)}function Uw(e,t){return Uw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Uw(e,t)}function C0e(e){var t=O0e();return function(){var n=Dn(e),o;if(t){var i=Dn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _0e(this,o)}}function _0e(e,t){if(t&&(Ww(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return es(e)}function es(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dn(e){return Dn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dn(e)}function q1(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q1(e,t,r){R0e(e,t),t.set(e,r)}function R0e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wc(e,t,r){var n=_j(e,t,"set");return E0e(e,n,r),r}function E0e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Rt(e,t){var r=_j(e,t,"get");return T0e(e,r)}function _j(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function T0e(e,t){return t.get?t.get.call(e):t.value}var Z1="nestedHeaders",k0e=280,$t=new WeakMap,to=new WeakMap,P0e=function(e){S0e(r,e);var t=C0e(r);function r(){var n;m0e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Q1(es(n),$t,{writable:!0,value:new d0e}),Q1(es(n),to,{writable:!0,value:null}),q1(es(n),"ghostTable",new y0e(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),q1(es(n),"detectedOverlappedHeaders",!1),n}return b0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Z1]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&ot(Je(G1||(G1=K1([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),pi(Dn(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;Rt(this,$t).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=Rt(this,$t).setState(a)),this.detectedOverlappedHeaders&&ot(Je(Y1||(Y1=K1([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";Rt(o,$t).triggerColumnModification(u,s)}),!Rt(this,to)&&this.enabled&&wc(this,to,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,c=s.index,f=s.newValue;if(u==="replace"){var h=f===!0?"hide-column":"show-column";Rt(o,$t).triggerColumnModification(h,c)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),pi(Dn(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Rt(this,$t).clear(),Rt(this,to).unsubscribe(),wc(this,to,null),this.ghostTable.clear(),pi(Dn(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Rt(this,$t)}},{key:"getLayersCount",value:function(){return Rt(this,$t).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return Rt(this,$t).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var c=a.childNodes[u];if(!c)break;for(var f=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=c.childNodes.length;d<v;d++)c.childNodes[d].removeAttribute("colspan"),De(c.childNodes[d],"hiddenHeader"),f&&f.childNodes[d]&&(f.childNodes[d].removeAttribute("colspan"),De(f.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),De(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,c=i.hot,f=c.rootDocument,h=c.columnIndexMapper,d=c.view,v=h.getVisualFromRenderableIndex(l);v===null&&(v=l),s.removeAttribute("colspan"),De(s,"hiddenHeader");var g=(u=Rt(i,$t).getHeaderSettings(o,v))!==null&&u!==void 0?u:{label:""},y=g.colspan,w=g.label,C=g.isHidden,_=g.isPlaceholder;if(_||C)re(s,"hiddenHeader");else if(y>1){var I,E,U=d._wt.wtOverlays,G=(I=U.topInlineStartCornerOverlay)===null||I===void 0?void 0:I.clone.wtTable.THEAD.contains(s),Q=(E=U.inlineStartOverlay)===null||E===void 0?void 0:E.clone.wtTable.THEAD.contains(s),K=G||Q?Math.min(y,a-l):y;K>1&&s.setAttribute("colspan",K)}var X=f.createElement("div"),J=f.createElement("span");re(X,"relative"),re(J,"colHeader"),zi(J,w),X.appendChild(J),Hr(s),s.appendChild(X),i.hot.runHooks("afterGetColHeader",v,s)}}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=Rt(this,$t).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,c=a.selectionType,f=a.selectionWidth,h=Rt(this,$t).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(c===cu){if(!d)return l.columnIndex}else c===Qh&&(v>f-u||!d)&&(s.length=0);return o}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],c=a.columnIndex,f=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,c,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,c+f-1,i.row):u.push(c,c+f-1,i.row):(uC(o)||Pi(o)&&h)&&u.push(c,c+f-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var c=u.columnIndex,f=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),g=h.from;l.column=!0,l.cell=!0;var y=[];i.col<g.col?y.push(v.col,c):i.col>g.col?y.push(d.col,c+f-1):y.push(c,c+f-1),(s=this.hot).selectColumns.apply(s,y)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){if(o){o.length=0;for(var i=0;i<Rt(this,$t).getLayersCount();i++)o.push(this.headerRendererFactory(i))}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=Rt(this,$t).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=Rt(this,$t).findLeftMostColumnIndex(s,o.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),br(c)&&c<o.startColumn){a=c;break}}o.startColumn=l?Rt(this,$t).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){wc(this,$t,null),Rt(this,to)!==null&&(Rt(this,to).unsubscribe(),wc(this,to,null)),pi(Dn(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return Rt(this,$t).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return Z1}},{key:"PLUGIN_PRIORITY",get:function(){return k0e}}]),r}(Ke);function J1(e){return M0e(e)||$0e(e)||I0e(e)||A0e()}function A0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I0e(e,t){if(e){if(typeof e=="string")return zw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zw(e,t)}}function $0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function M0e(e){if(Array.isArray(e))return zw(e)}function zw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gw(e){return Gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gw(e)}function x0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D0e(e,t,r){return t&&eM(e.prototype,t),r&&eM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var H0e=function(){function e(t,r){x0e(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return D0e(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&$(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&$(u.__children,function(c){if(a.parentReference.set(c,l?null:u),s=a.readTreeNodes(c,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return Ve(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:($(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||Gw(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(me(r[0],r[2],function(w){var C=n.translateTrimmedRow(w);a.push(n.getDataObject(C))}),me(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),c=this.getRowParent(i),f=this.getRowParent(c),h=this.getRowIndex(f),d=null;if(this.hot.runHooks("beforeDetachChild",c,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),c.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),f){d=h+this.countChildren(f);var g=this.getChild(f,this.countChildren(f)-1),y=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",y+1,s+1,this.plugin.pluginName),f.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];$(o,function(l){a.push(i.getDataObject(l))}),$(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(J1(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(J1(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),c=r>n,f=a?this.getRowParent(n-1):this.getRowParent(n);f==null&&(f=this.getRowParent(n-1)),f==null&&(f=this.getDataObject(n-1)),f?f.__children||(f.__children=[]):(f=this.getDataObject(n),f.__children=[]);var h=a||o||i?f.__children.length:this.getRowIndexWithinParent(n),d=l===f;f.__children.splice(h,0,u[0]),l.__children.splice(s+(c&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(f)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const N0e=H0e;function tM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L0e(e,t,r){return t&&tM(e.prototype,t),r&&tM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var B0e=L0e(function e(t,r){j0e(this,e),this.hot=r,this.plugin=t});const kO=B0e;function Yw(e){return Yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yw(e)}function F0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function V0e(e,t,r){return t&&rM(e.prototype,t),r&&rM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kw(e,t)}function Kw(e,t){return Kw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Kw(e,t)}function U0e(e){var t=Y0e();return function(){var n=yh(e),o;if(t){var i=yh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return z0e(this,o)}}function z0e(e,t){if(t&&(Yw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G0e(e)}function G0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yh(e){return yh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yh(e)}var K0e=function(e){W0e(r,e);var t=U0e(r);function r(n,o){var i;return F0e(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return V0e(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],c=u.querySelector("span.rowHeader"),f=u.querySelectorAll('[class^="ht_nesting"]');if($(f,function(g){g&&u.removeChild(g)}),re(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=c.cloneNode(!0);u.innerHTML="",me(0,l-1,function(){var g=h.createElement("SPAN");re(g,r.CSS_CLASSES.emptyIndicator),u.appendChild(g)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");re(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(kO);const Oj=K0e;function Xw(e){return Xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xw(e)}function nM(e){return Z0e(e)||Q0e(e)||q0e(e)||X0e()}function X0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q0e(e,t){if(e){if(typeof e=="string")return qw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qw(e,t)}}function Q0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Z0e(e){if(Array.isArray(e))return qw(e)}function qw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ePe(e,t,r){return t&&oM(e.prototype,t),r&&oM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qw(e,t)}function Qw(e,t){return Qw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Qw(e,t)}function rPe(e){var t=iPe();return function(){var n=mh(e),o;if(t){var i=mh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nPe(this,o)}}function nPe(e,t){if(t&&(Xw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oPe(e)}function oPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mh(e){return mh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mh(e)}var aPe=function(e){tPe(r,e);var t=rPe(r);function r(n,o){var i;return J0e(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),$(i.lastCollapsedRows,function(c,f){c>=l&&c<s&&(i.lastCollapsedRows[f]=c+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){me(l,l+s-1,function(u){var c=i.lastCollapsedRows.indexOf(u);c>-1&&i.lastCollapsedRows.splice(c,1)})}},i}return ePe(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,c=null,f=null;return isNaN(o)?(u=o,c=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),c=o),this.dataManager.hasChildren(u)&&$(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),f=this.collapseRows(s,!0,!1),l&&this.trimRows(f),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(c)===-1&&this.collapsedRows.push(c),f}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];$(o,function(u){s.push.apply(s,nM(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return $(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);$(s.__children,function(u){var c=i.dataManager.getRowIndex(u);a.push(c),i.collapseChildRows(c,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return $(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);$(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var c=i.dataManager.getRowIndex(u);a.push(c),i.expandChildRows(c,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,c=null,f=null;return isNaN(o)?(u=o,c=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),c=o),this.collapsedRows.splice(this.collapsedRows.indexOf(c),1),this.dataManager.hasChildren(u)&&$(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),f=this.expandRows(s,!0,!1),l&&this.untrimRows(f),a&&this.renderAndAdjust(),f}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];$(o,function(u){s.push.apply(s,nM(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];$(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];$(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){$(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){$(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&$(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,Oj.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),rn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(kO);const lPe=aPe;function Zw(e){return Zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zw(e)}function sPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uPe(e,t,r){return t&&iM(e.prototype,t),r&&iM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jw(e,t)}function Jw(e,t){return Jw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Jw(e,t)}function fPe(e){var t=dPe();return function(){var n=bh(e),o;if(t){var i=bh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hPe(this,o)}}function hPe(e,t){if(t&&(Zw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rj(e)}function Rj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bh(e){return bh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bh(e)}var aM=new WeakMap,vPe=function(e){cPe(r,e);var t=fPe(r);function r(n,o){var i;return sPe(this,r),i=t.call(this,n,o),aM.set(Rj(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return uPe(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(w_)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(S_)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),c=i.dataManager.getRowParent(u);return!c||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return me(0,o.items.length-1,function(l){if(l===0)return $(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=aM.get(this);return me(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(kO);const pPe=vPe;var lM;function sM(e){return bPe(e)||mPe(e)||yPe(e)||gPe()}function gPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yPe(e,t){if(e){if(typeof e=="string")return eS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eS(e,t)}}function mPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bPe(e){if(Array.isArray(e))return eS(e)}function eS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wPe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function SPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function CPe(e,t,r){return t&&uM(e.prototype,t),r&&uM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var _Pe=function(){function e(t){SPe(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return CPe(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),c=!0,f=r.map(function(y){if(!c)return!1;var w=a.dataManager.translateTrimmedRow(y);return c=a.shouldAllowMoving(w,u),w}),h=f.indexOf(u)===-1;if(!c||!h)return!1;var d=this.getBaseParent(f),v=this.getTargetParent(s,u),g=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(f,u,g),this.moveRows(f,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(f,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return at(i)&&(ot(Je(lM||(lM=wPe([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,sM(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,sM(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var c=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),f=this.dataManager.getRowIndex(c);i=this.dataManager.untranslateTrimmedRow(f),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function tS(e){return tS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tS(e)}function OPe(e){return kPe(e)||TPe(e)||EPe(e)||RPe()}function RPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EPe(e,t){if(e){if(typeof e=="string")return rS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rS(e,t)}}function TPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kPe(e){if(Array.isArray(e))return rS(e)}function rS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function APe(e,t,r){return t&&cM(e.prototype,t),r&&cM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gi(){return typeof Reflect<"u"&&Reflect.get?gi=Reflect.get.bind():gi=function(t,r,n){var o=IPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},gi.apply(this,arguments)}function IPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hn(e),e!==null););return e}function $Pe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nS(e,t)}function nS(e,t){return nS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nS(e,t)}function MPe(e){var t=DPe();return function(){var n=Hn(e),o;if(t){var i=Hn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xPe(this,o)}}function xPe(e,t){if(t&&(tS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ej(e)}function Ej(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hn(e){return Hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hn(e)}var Bp="nestedRows",HPe=300,cn=new WeakMap,NPe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",LPe=function(e){$Pe(r,e);var t=MPe(r);function r(n){var o;return PPe(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,cn.set(Ej(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return APe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Bp]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new uu),this.dataManager=new N0e(this,this.hot),this.collapsingUI=new lPe(this,this.hot),this.headersUI=new Oj(this,this.hot),this.contextMenuUI=new pPe(this,this.hot),this.rowMoveController=new _Pe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),gi(Hn(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),gi(Hn(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),gi(Hn(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=cn.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=cn.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=cn.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=cn.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=cn.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=cn.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=cn.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,c){if(l.dataManager.isParent(c)){var f=l.dataManager.getDataObject(c).__children;return u.add(c),Array.isArray(f)&&f.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(c)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,OPe(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=cn.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){gi(Hn(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!Qre(o)){cC(NPe),this.hot.getSettings()[Bp]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return Bp}},{key:"PLUGIN_PRIORITY",get:function(){return HPe}}]),r}(Ke);function jPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BPe(e,t,r){return t&&fM(e.prototype,t),r&&fM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var FPe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;jPe(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return BPe(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;$(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const VPe=FPe;function oS(e){return oS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oS(e)}function WPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function UPe(e,t,r){return t&&hM(e.prototype,t),r&&hM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yi(){return typeof Reflect<"u"&&Reflect.get?yi=Reflect.get.bind():yi=function(t,r,n){var o=zPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},yi.apply(this,arguments)}function zPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Nn(e),e!==null););return e}function GPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iS(e,t)}function iS(e,t){return iS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iS(e,t)}function YPe(e){var t=qPe();return function(){var n=Nn(e),o;if(t){var i=Nn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return KPe(this,o)}}function KPe(e,t){if(t&&(oS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XPe(e)}function XPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nn(e){return Nn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nn(e)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");var dM="persistentState",QPe=0,ZPe=function(e){GPe(r,e);var t=YPe(r);function r(n){var o;return WPe(this,r),o=t.call(this,n),o.storage=void 0,o}return UPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[dM]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new VPe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),yi(Nn(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,yi(Nn(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),yi(Nn(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){yi(Nn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return dM}},{key:"PLUGIN_PRIORITY",get:function(){return QPe}}]),r}(Ke);function aS(e){return aS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aS(e)}function JPe(e){return nAe(e)||rAe(e)||tAe(e)||eAe()}function eAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tAe(e,t){if(e){if(typeof e=="string")return lS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lS(e,t)}}function rAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nAe(e){if(Array.isArray(e))return lS(e)}function lS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function iAe(e,t,r){return t&&vM(e.prototype,t),r&&vM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mi(){return typeof Reflect<"u"&&Reflect.get?mi=Reflect.get.bind():mi=function(t,r,n){var o=aAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},mi.apply(this,arguments)}function aAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ln(e),e!==null););return e}function lAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sS(e,t)}function sS(e,t){return sS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sS(e,t)}function sAe(e){var t=fAe();return function(){var n=Ln(e),o;if(t){var i=Ln(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uAe(this,o)}}function uAe(e,t){if(t&&(aS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cAe(e)}function cAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ln(e){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ln(e)}var Fp="search",hAe=190,dAe="htSearchResult",vAe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},pAe=function(t,r,n){return at(t)||t===null||!t.toLocaleLowerCase||t.length===0||at(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},gAe=function(e){lAe(r,e);var t=sAe(r);function r(n){var o;return oAe(this,r),o=t.call(this,n),o.callback=vAe,o.queryMethod=pAe,o.searchResultClass=dAe,o}return iAe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Fp]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Fp];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),mi(Ln(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),mi(Ln(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),mi(Ln(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),c=[],f=this.hot;return me(0,s-1,function(h){me(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),g=i.hot.getCellMeta(h,d),y=g.search.callback||a,w=g.search.queryMethod||l,C=w(o,v,g);if(C){var _={row:h,col:d,data:v};c.push(_)}y&&y(f,h,d,v,C)})}),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ne(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var c=u.className||[],f=[];if(typeof c=="string")f=c.split(" ");else{var h;(h=f).push.apply(h,JPe(c))}this.isEnabled()&&u.isSearchResult?f.includes(this.searchResultClass)||f.push("".concat(this.searchResultClass)):f.includes(this.searchResultClass)&&f.splice(f.indexOf(this.searchResultClass),1),u.className=f.join(" ")}},{key:"destroy",value:function(){mi(Ln(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Fp}},{key:"PLUGIN_PRIORITY",get:function(){return hAe}}]),r}(Ke);function uS(e){return uS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uS(e)}function yAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mAe(e,t,r){return t&&pM(e.prototype,t),r&&pM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Da(){return typeof Reflect<"u"&&Reflect.get?Da=Reflect.get.bind():Da=function(t,r,n){var o=bAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Da.apply(this,arguments)}function bAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function wAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cS(e,t)}function cS(e,t){return cS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cS(e,t)}function SAe(e){var t=OAe();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CAe(this,o)}}function CAe(e,t){if(t&&(uS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ae(e)}function _Ae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}var RAe="touchScroll",EAe=200,TAe=function(e){wAe(r,e);var t=SAe(r);function r(n){var o;return yAe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return mAe(r,[{key:"isEnabled",value:function(){return uD()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),Da(Co(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Da(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Da(Co(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,$(this.clones,function(o){re(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,$(this.clones,function(i){De(i,"hide-tween"),re(i,"show-tween")}),this.hot._registerTimeout(function(){$(o.clones,function(i){De(i,"show-tween")})},400),$(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return RAe}},{key:"PLUGIN_PRIORITY",get:function(){return EAe}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(Ke);function fS(e){return fS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fS(e)}function kAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function PAe(e,t,r){return t&&gM(e.prototype,t),r&&gM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bi(){return typeof Reflect<"u"&&Reflect.get?bi=Reflect.get.bind():bi=function(t,r,n){var o=AAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},bi.apply(this,arguments)}function AAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=jn(e),e!==null););return e}function IAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hS(e,t)}function hS(e,t){return hS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hS(e,t)}function $Ae(e){var t=DAe();return function(){var n=jn(e),o;if(t){var i=jn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MAe(this,o)}}function MAe(e,t){if(t&&(fS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xAe(e)}function xAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jn(e){return jn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jn(e)}var Sc="trimRows",HAe=330,NAe=function(e){IAe(r,e);var t=$Ae(r);function r(n){var o;return kAe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return PAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Sc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new uu),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),bi(jn(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[Sc];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),$(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),bi(jn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),bi(jn(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(c){i.trimmedRowsMap.setValueAtIndex(c,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&($(o,function(f){s[f]=!1}),l=Vt(s,function(f,h,d){return h&&f.push(d),f},[]));var c=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);c!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[Sc];Array.isArray(i)&&this.hot.batchExecution(function(){$(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){bi(jn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Sc}},{key:"PLUGIN_PRIORITY",get:function(){return HAe}}]),r}(Ke);function dS(e){return dS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dS(e)}function Tj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kj(e,t,r){return t&&yM(e.prototype,t),r&&yM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pj(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vS(e,t)}function vS(e,t){return vS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vS(e,t)}function Aj(e){var t=BAe();return function(){var n=wh(e),o;if(t){var i=wh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LAe(this,o)}}function LAe(e,t){if(t&&(dS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jAe(e)}function jAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wh(e){return wh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wh(e)}function FAe(e){return UAe(e)||WAe(e)||$j(e)||VAe()}function VAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UAe(e){if(Array.isArray(e))return pS(e)}function Ij(e,t){return YAe(e)||GAe(e,t)||$j(e,t)||zAe()}function zAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $j(e,t){if(e){if(typeof e=="string")return pS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pS(e,t)}}function pS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,l;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(s){i=!0,l=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function YAe(e){if(Array.isArray(e))return e}var Mj="undoRedo",KAe="undoRedo";function ve(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=Ij(s,4),c=u[2],f=u[3];return c!==f});if(a){var l=function(){var u=r.reduce(function(f,h){return f.push(FAe(h)),f},[]);$(u,function(f){f[1]=e.propToCol(f[1])});var c=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ve.ChangeAction(u,c)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ve.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(s.length+r)%s.length,c=e.toPhysicalRow(u),f=Kt(s.slice(c,c+n));return new ve.RemoveRowAction(u,f,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop)};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ve.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),c=[],f=[],h=[];me(s.length-1,function(g){var y=[],w=s[g];me(u,u+(n-1),function(C){y.push(w[e.toPhysicalColumn(C)])}),c.push(y)}),me(n-1,function(g){h.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&me(n-1,function(g){f.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ve.RemoveColumnAction(u,h,c,f,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ve.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ve.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ve.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ve.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ve.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ve.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ve.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=Kt(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ve.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=Kt(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ve.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ve.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ve.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ve.prototype.isEnabled=function(){return this.enabled};ve.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,QAe(e),this.registerShortcuts(),e.addHook("afterChange",xj)}};ve.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,ZAe(e),this.unregisterShortcuts(),e.removeHook("afterChange",xj)}};ve.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ve.Action=function(){};ve.Action.prototype.undo=function(){};ve.Action.prototype.redo=function(){};ve.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};To(ve.ChangeAction,ve.Action);ve.ChangeAction.prototype.undo=function(e,t){for(var r=Kt(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=Ij(r[l],2),c=u[0],f=u[1];e.getSettings().minSpareRows&&c+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(c+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&f+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(f+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ve.ChangeAction.prototype.redo=function(e,t){for(var r=Kt(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ve.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};To(ve.CreateRowAction,ve.Action);ve.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ve.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};ve.RemoveRowAction=function(e,t,r,n){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n};To(ve.RemoveRowAction,ve.Action);ve.RemoveRowAction.prototype.undo=function(e,t){var r=e.getSettings();r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};ve.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ve.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};To(ve.CreateColumnAction,ve.Action);ve.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ve.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};ve.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};To(ve.RemoveColumnAction,ve.Action);ve.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(Fe(this.data[s],i));var u=Fe(this.headers,i),c=[];e.alter("insert_col",this.indexes[0],this.indexes.length,"UndoRedo.undo"),$(e.getSourceDataArray(),function(f,h){$(o,function(d,v){f[d]=l[h][v],c.push([h,d,f[d]])})}),e.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(o[0],o.length),typeof this.headers<"u"&&$(u,function(f,h){e.getSettings().colHeaders[o[h]]=f}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ve.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ve.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ve.CellAlignmentAction.prototype.undo=function(e,t){var r=this;$(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ve.CellAlignmentAction.prototype.redo=function(e,t){no(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ve.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};To(ve.FiltersAction,ve.Action);ve.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ve.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var XAe=function(e){Pj(r,e);var t=Aj(r);function r(n,o){var i;Tj(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return kj(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ve.Action);ve.MergeCellsAction=XAe;var qAe=function(e){Pj(r,e);var t=Aj(r);function r(n,o){var i;return Tj(this,r),i=t.call(this),i.cellRange=o,i}return kj(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ve.Action);ve.UnmergeCellsAction=qAe;ve.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};To(ve.RowMoveAction,ve.Action);ve.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(c){return c>r.finalIndex}),a=o.filter(function(c){return c<=r.finalIndex}),l=i.sort(function(c,f){return f-c}).concat(a.sort(function(c,f){return c-f}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ve.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ve.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ve.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:Mj};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ve.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(Mj)};function xj(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function QAe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function ZAe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var gu=ge.getSingleton();gu.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});gu.register("beforeUndo");gu.register("afterUndo");gu.register("beforeRedo");gu.register("afterRedo");ve.PLUGIN_KEY=KAe;ve.SETTING_KEYS=!0;function JAe(){Ge(Ehe),Ge(Xhe),Ge(fde),Ge(Zde),Ge(gve),Ge(sL),Ge(Hpe),Ge(cge),Ge(wL),Ge(xye),Ge(ime),Ge(vme),Ge(EL),Ge(abe),Ge(O_e),Ge(eOe),Ge(_Oe),Ge(GOe),Ge(dRe),Ge(YRe),Ge(rEe),Ge(HEe),Ge(zEe),Ge(ITe),Ge(qTe),Ge(lke),Ge(P0e),Ge(LPe),Ge(ZPe),Ge(gAe),Ge(TAe),Ge(NAe),Ge(ve)}function eIe(){lfe(),yq(),_fe(),Bfe(),JAe()}eIe();const aIe=Et.memo(function(t){let{name:r,id:n,SVs:o,actions:i,callAction:a}=Nj(t),l=s=>{a({action:i.recordVisibilityChange,args:{isVisible:s}})};return Lj.useEffect(()=>()=>{a({action:i.recordVisibilityChange,args:{isVisible:!1}})},[]),o.hidden?null:Od(Vj,{partialVisibility:!0,onChange:l,children:jj("div",{id:n,style:{margin:"12px 0"},children:[Od("a",{name:n}),Od(LN,{licenseKey:"non-commercial-and-evaluation",data:o.cells.map(s=>[...s]),colHeaders:o.columnHeaders,rowHeaders:o.rowHeaders,width:DO(o.width),height:DO(o.height),afterChange:(s,u)=>a({action:i.onChange,args:{changes:s,source:u}}),formulas:{engine:Bj},fixedRowsTop:o.fixedRowsTop,fixedColumnsLeft:o.fixedColumnsLeft,hiddenColumns:{columns:o.hiddenColumns.map(s=>s-1),indicators:!1},hiddenRows:{rows:o.hiddenRows.map(s=>s-1),indicators:!1},readOnly:o.disabled,disableVisualSelection:o.disabled,stretchH:"all"})]})})});export{aIe as default};
