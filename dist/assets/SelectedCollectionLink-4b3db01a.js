import{e as r,z as L,A as y,s as k,r as C,ab as x,v as S,a as m,j as t,H as M,Z as O,F as f,C as A,B as I,bg as B}from"./index-a1cd8b25.js";import{T}from"./Textfield-07b7a0c1.js";import{R as h}from"./RelatedItems-9e7662ee.js";import{e as w}from"./RoleDropdown-6cbb7a86.js";import"./DropdownMenu-3b5a6419.js";function j({courseId:n,selectedDoenetId:e}){let o=r(B(n)),i=[];for(let[s,a]of o.entries())e==a.doenetId?i.push(t("option",{selected:!0,value:a.doenetId,children:a.label},`CollectionOptions${s}`)):i.push(t("option",{value:a.doenetId,children:a.label},`CollectionOptions${s}`));return t(f,{children:i})}function R({selected:n,i:e,pageId:o}){let i=r(y(o));return n?t("option",{selected:!0,value:o,children:i.label},`PagesInACollection${e}`):t("option",{value:o,children:i.label},`PagesInACollection${e}`)}function _(){const n=r(L)[0],e=r(y(n)),o=r(k("courseId")),{canEditContent:i}=r(w(o)),[s,a]=C.useState(e.label);let{deleteItem:F,updateCollectionLink:c,updateContentLinksToSources:v}=x(o);C.useEffect(()=>{s!==e.label&&a(e.label)},[n]);const b=()=>{let l=s;s===""&&(l=e.label,e.label===""&&(l="Untitled Collection Link"),a(l)),e.label!==l&&(console.log("Rename",n,l),c({courseId:o,doenetId:n,label:l,collectionDoenetId:e.collectionDoenetId,isManuallyFiltered:e.isManuallyFiltered,manuallyFilteredPages:e.manuallyFilteredPages}))};S();let P=m("h2",{"data-test":"infoPanelItemLabel",style:{margin:"16px 5px"},children:[t(M,{icon:O})," ",e.label]});if(i!=="1")return null;let D=t(j,{courseId:o,selectedDoenetId:e.collectionDoenetId}),g=null;if(e.collectionDoenetId){let l=[];for(let[p,d]of Object.entries(e.pagesByCollectionSource[e.collectionDoenetId])){let u=!1;e!=null&&e.manuallyFilteredPages&&e.manuallyFilteredPages.includes(d)&&(u=!0),l.push(t(R,{selected:u,i:p,pageId:d}))}g=m(f,{children:[m("div",{style:{display:"flex"},children:[t(A,{style:{marginRight:"5px"},checked:e.isManuallyFiltered,onClick:()=>{c({courseId:o,doenetId:n,collectionDoenetId:e.collectionDoenetId,isManuallyFiltered:!e.isManuallyFiltered,manuallyFilteredPages:e.manuallyFilteredPages})}}),"Filter Page Links"]}),t(h,{width:"menu",options:l,disabled:!e.isManuallyFiltered,onChange:p=>{let d=Array.from(p.target.selectedOptions,u=>u.value);c({courseId:o,doenetId:n,collectionDoenetId:e.collectionDoenetId,isManuallyFiltered:e.isManuallyFiltered,manuallyFilteredPages:d})},multiple:!0}),t("br",{})]})}return m(f,{children:[P,t(T,{label:"Label",vertical:!0,width:"menu",dataTest:"Label Collection",value:s,onChange:l=>a(l.target.value),onKeyDown:l=>{l.keyCode===13&&b()},onBlur:b}),t("br",{}),t("br",{}),t("div",{children:"collection"}),t(h,{width:"menu",dataTest:"Collection Link Selector",options:D,onChange:l=>{c({courseId:o,doenetId:n,collectionDoenetId:l.target.value,isManuallyFiltered:!1,manuallyFilteredPages:[]})}}),t("br",{}),g,t("br",{}),t(I,{width:"menu",value:"Update Content to Sources",onClick:l=>{l.preventDefault(),l.stopPropagation(),v({collectionLinkObj:e,pages:e.pages})}}),t("br",{}),t(I,{width:"menu",value:"Delete Collection Link",alert:!0,onClick:l=>{l.preventDefault(),l.stopPropagation(),F({doenetId:n})}})]})}export{_ as default};
