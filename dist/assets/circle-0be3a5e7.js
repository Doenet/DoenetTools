import{av as _,bn as M,r as l,l as X,bs as E,j as J}from"./index-ab5ab855.js";import{BoardContext as N,LINE_LAYER_OFFSET as L}from"./graph-7de05658.js";import"./css-14ccef8c.js";import"./visibility-sensor-7b80a154.js";const I=_.memo(function u(F){let{name:Y,id:P,SVs:e,actions:h,callAction:p}=M(F);u.ignoreActionsWithoutCore=!0;const o=l.useContext(N);let r=l.useRef(null),C=l.useRef(!1),d=l.useRef(!1),g=l.useRef(!1),b=l.useRef(!1),v=l.useRef(!1),S=l.useRef(!1),m=l.useRef(null),R=l.useRef(null),w=l.useRef(null);R.current=e.numericalCenter,w.current=e.throughAngles;const y=X(E);l.useEffect(()=>()=>{r.current&&O()},[]);function D(){if(!(Number.isFinite(e.numericalCenter[0])&&Number.isFinite(e.numericalCenter[1])&&e.numericalRadius>0))return null;let a=!e.draggable||e.fixed,i=y==="dark"?e.selectedStyle.lineColorDarkMode:e.selectedStyle.lineColor;i=i.toLowerCase();let c=y==="dark"?e.selectedStyle.fillColorDarkMode:e.selectedStyle.fillColor;c=e.filled?c.toLowerCase():"none";var n={name:e.labelForGraph,visible:!e.hidden,withLabel:e.showLabel&&e.labelForGraph!=="",fixed:a,layer:10*e.layer+L,strokeColor:i,strokeOpacity:e.selectedStyle.lineOpacity,highlightStrokeColor:i,strokeWidth:e.selectedStyle.lineWidth,highlightStrokeWidth:e.selectedStyle.lineWidth,highlightStrokeOpacity:e.selectedStyle.lineOpacity*.5,dash:A(e.selectedStyle.lineStyle),fillColor:c,fillOpacity:e.selectedStyle.fillOpacity,highlightFillColor:c,highlightFillOpacity:e.selectedStyle.fillOpacity*.5,highlight:!a};e.filled&&(n.hasInnerPoints=!0),n.label={highlight:!1},e.labelHasLatex&&(n.label.useMathJax=!0),e.showLabel&&e.labelForGraph!==""&&(e.applyStyleToLabel?n.label.strokeColor=i:n.label.strokeColor="var(--canvastext)");let s=o.create("circle",[[...e.numericalCenter],e.numericalRadius],n);return s.on("drag",function(t){(Math.abs(t.x-d.current[0])>.1||Math.abs(t.y-d.current[1])>.1)&&(C.current=!0),m.current=G(t),p({action:h.moveCircle,args:{center:m.current,radius:b.current,throughAngles:v.current,transient:!0,skippable:!0}}),s.center.coords.setCoordinates(JXG.COORDS_BY_USER,[...R.current])}),s.on("up",function(t){C.current?p({action:h.moveCircle,args:{center:m.current,radius:b.current,throughAngles:v.current}}):p({action:h.circleClicked})}),s.on("down",function(t){C.current=!1,d.current=[t.x,t.y],g.current=[...s.center.coords.scrCoords],b.current=s.radius,v.current=[...w.current],p({action:h.mouseDownOnCircle})}),S.current=e.showLabel&&e.labelForGraph!=="",s}function G(a){var i=o.origin.scrCoords;let c=(g.current[1]+a.x-d.current[0]-i[1])/o.unitX,n=(i[2]-(g.current[2]+a.y-d.current[1]))/o.unitY;return[c,n]}function O(){r.current.off("drag"),r.current.off("down"),r.current.off("up"),o.removeObject(r.current),r.current=null}if(o)if(!r.current)r.current=D();else if(!(Number.isFinite(e.numericalCenter[0])&&Number.isFinite(e.numericalCenter[1])&&e.numericalRadius>0))O();else{o.updateQuality===o.BOARD_QUALITY_LOW&&(o.itemsRenderedLowQuality[P]=r.current);let a=e.numericalCenter.every(W=>Number.isFinite(W));r.current.center.coords.setCoordinates(JXG.COORDS_BY_USER,[...e.numericalCenter]),r.current.setRadius(e.numericalRadius);let i=!e.hidden;a?(r.current.visProp.visible=i,r.current.visPropCalc.visible=i):(r.current.visProp.visible=!1,r.current.visPropCalc.visible=!1);let c=!e.draggable||e.fixed;r.current.visProp.fixed=c,r.current.visProp.highlight=!c;let n=10*e.layer+L;r.current.visProp.layer!==n&&r.current.setAttribute({layer:n});let t=y==="dark"?e.selectedStyle.lineColorDarkMode:e.selectedStyle.lineColor;t=t.toLowerCase();let f=y==="dark"?e.selectedStyle.fillColorDarkMode:e.selectedStyle.fillColor;f=e.filled?f.toLowerCase():"none",r.current.visProp.strokecolor!==t&&(r.current.visProp.strokecolor=t,r.current.visProp.highlightstrokecolor=t),r.current.visProp.strokeopacity!==e.selectedStyle.lineOpacity&&(r.current.visProp.strokeopacity=e.selectedStyle.lineOpacity,r.current.visProp.highlightstrokeopacity=e.selectedStyle.lineOpacity*.5);let x=A(e.selectedStyle.lineStyle);r.current.visProp.dash!==x&&(r.current.visProp.dash=x),r.current.visProp.strokewidth!==e.selectedStyle.lineWidth&&(r.current.visProp.strokewidth=e.selectedStyle.lineWidth,r.current.visProp.highlightstrokewidth=e.selectedStyle.lineWidth),r.current.visProp.fillcolor!==f&&(r.current.visProp.fillcolor=f,r.current.visProp.highlightfillcolor=f,r.current.visProp.hasinnerpoints=e.filled),r.current.visProp.fillopacity!==e.selectedStyle.fillOpacity&&(r.current.visProp.fillopacity=e.selectedStyle.fillOpacity,r.current.visProp.highlightfillopacity=e.selectedStyle.fillOpacity*.5),r.current.name=e.labelForGraph;let k=e.showLabel&&e.labelForGraph!=="";k!=S.current&&(r.current.setAttribute({withlabel:k}),S.current=k),r.current.needsUpdate=!0,r.current.update(),r.current.hasLabel&&(e.applyStyleToLabel?r.current.label.visProp.strokecolor=t:r.current.label.visProp.strokecolor="var(--canvastext)",r.current.label.needsUpdate=!0,r.current.label.update()),o.updateRenderer()}return e.hidden?null:J("a",{name:P})});function A(u){return u==="solid"?0:u==="dashed"?2:u==="dotted"?1:0}export{I as default};
