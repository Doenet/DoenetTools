import{l as R,m as I,S as xe,r as _,R as ce,o as Be,v as W,T as H,q as se,G as g,j as i,s as $e,V as de,a as B,F as A,W as Y,X as U,Y as Q,Z as ne,_ as le,J as we,$ as pe,i as E,B as ie,a0 as N,a1 as Ce,a2 as De}from"./index-61b6fc23.js";import{M as Re}from"./index.esm-d246f4c9.js";/* empty css             */import{e as Ae}from"./RoleDropdown-c9fff172.js";import{B as Te}from"./ButtonGroup-6d856500.js";const ae=$e.button`
  border: none;
  border-radius: 35px;
  &:focus {
    outline: 2px solid var(--canvastext);
    outline-offset: 2px;
  }
`;function He(l){const t=R(I("courseId")),e=R(I("sectionId")),{canViewUnassignedContent:a}=R(Ae(t));xe(t);const[n,s]=_.useState(1);let c=ce(Be),p=W(({snapshot:d,set:r})=>async()=>{const h=await d.getPromise(H);r(se,null),r(H,[]);for(let u of h)r(g(u),v=>{let x={...v};return x.isSelected=!1,x})});return _.useEffect(()=>{c(d=>{let r=[...d];return r.push(p),r})},[p,c]),a=="0"||l.displayRole=="student"?i(je,{courseNavigatorProps:l,courseId:t,sectionId:e,numberOfVisibleColumns:n,setNumberOfVisibleColumns:s}):a=="1"||l.displayRole=="instructor"?i(Fe,{courseNavigatorProps:l,courseId:t,sectionId:e,numberOfVisibleColumns:n,setNumberOfVisibleColumns:s}):null}function je({courseId:l,sectionId:t,numberOfVisibleColumns:e,setNumberOfVisibleColumns:a,courseNavigatorProps:n}){let s=R(de({courseId:l,sectionId:t}));console.log("studentItemOrder",s);let c=_.useRef([]),p=_.useRef("");p.current!=t&&(c.current=[],p.current=t);let d=[];return s.map(r=>d.push(i(re,{courseId:l,doenetId:r,indentLevel:0,previousSections:c,courseNavigatorProps:n,numberOfVisibleColumns:e},`itemcomponent${r}`))),B(A,{children:[i(fe,{courseId:l,sectionId:t,columnLabels:["Due Date"],numberOfVisibleColumns:e,setNumberOfVisibleColumns:a}),d]})}function re({courseId:l,doenetId:t,numberOfVisibleColumns:e,indentLevel:a,previousSections:n,courseNavigatorProps:s}){let c=R(g(t));return c.type=="section"&&(n!=null&&n.current)&&n.current.push(c.doenetId),n!=null&&n.current.includes(c.parentDoenetId)?null:c.type=="section"?i(ve,{courseNavigatorProps:s,courseId:l,doenetId:t,itemInfo:c,numberOfVisibleColumns:e,indentLevel:a},`Item${t}`):c.type=="activity"?i(Me,{courseNavigatorProps:s,courseId:l,doenetId:t,itemInfo:c,numberOfVisibleColumns:e,indentLevel:a},`Item${t}`):null}function ve({courseId:l,doenetId:t,itemInfo:e,numberOfVisibleColumns:a,indentLevel:n,courseNavigatorProps:s}){let c=R(de({courseId:l,sectionId:e.doenetId})),p=_.useRef([]);if(e.isOpen){let d=c.map(r=>i(re,{courseNavigatorProps:s,previousSections:p,courseId:l,doenetId:r,numberOfVisibleColumns:a,indentLevel:n+1},`itemcomponent${r}`));return B(A,{children:[i($,{courseId:l,courseNavigatorProps:s,numberOfVisibleColumns:a,icon:Y,label:e.label,doenetId:t,hasToggle:!0,isOpen:e.isOpen,isSelected:e.isSelected,indentLevel:n}),d]})}else return i($,{courseId:l,courseNavigatorProps:s,numberOfVisibleColumns:a,icon:Y,label:e.label,doenetId:t,hasToggle:!0,isOpen:e.isOpen,isSelected:e.isSelected,indentLevel:n})}function Me({courseId:l,doenetId:t,itemInfo:e,numberOfVisibleColumns:a,indentLevel:n,courseNavigatorProps:s}){let c=[null];return e.dueDate&&(c[0]=i("span",{children:e.dueDate},`activityColumn2${t}`)),i(A,{children:i($,{courseId:l,courseNavigatorProps:s,columnsJSX:c,numberOfVisibleColumns:a,icon:U,label:e.label,doenetId:t,isSelected:e.isSelected,indentLevel:n,isBeingCut:e.isBeingCut})})}function Fe({courseId:l,sectionId:t,numberOfVisibleColumns:e,setNumberOfVisibleColumns:a,courseNavigatorProps:n}){let s=R(Q({courseId:l,sectionId:t}));console.log(`authorItemOrder CourseId-${l}-SectionId-${t}-`,s);let c=_.useRef([]),p=_.useRef("");p.current!=t&&(c.current=[],p.current=t);let d=s.map(r=>i(ye,{courseNavigatorProps:n,previousSections:c,courseId:l,doenetId:r,numberOfVisibleColumns:e,indentLevel:0},`itemcomponent${r}`));return B(A,{children:[i(fe,{courseId:l,sectionId:t,columnLabels:["Assigned","Public"],numberOfVisibleColumns:e,setNumberOfVisibleColumns:a}),d]})}function ye({courseId:l,doenetId:t,numberOfVisibleColumns:e,indentLevel:a,previousSections:n,courseNavigatorProps:s}){let c=R(g(t));return c.type=="section"&&(n!=null&&n.current)&&n.current.push(c.doenetId),n!=null&&n.current.includes(c.parentDoenetId)?null:c.type=="section"?i(Ke,{courseNavigatorProps:s,courseId:l,doenetId:t,itemInfo:c,numberOfVisibleColumns:e,indentLevel:a},`Item${t}`):c.type=="bank"?i(_e,{courseNavigatorProps:s,courseId:l,doenetId:t,itemInfo:c,numberOfVisibleColumns:e,indentLevel:a},`Item${t}`):c.type=="activity"?i(ke,{courseNavigatorProps:s,courseId:l,doenetId:t,itemInfo:c,numberOfVisibleColumns:e,indentLevel:a},`Item${t}`):null}function Ke({courseId:l,doenetId:t,itemInfo:e,numberOfVisibleColumns:a,indentLevel:n,courseNavigatorProps:s}){let c=R(Q({courseId:l,sectionId:e.doenetId})),p=_.useRef([]),d=[null,null];if(e.isAssigned&&(d[0]=i(E,{icon:N},`activityColumn2${t}`)),e.isOpen){let r=c.map(h=>i(ye,{courseNavigatorProps:s,previousSections:p,courseId:l,doenetId:h,numberOfVisibleColumns:a,indentLevel:n+1},`itemcomponent${h}`));return B(A,{children:[i($,{courseId:l,columnsJSX:d,courseNavigatorProps:s,isBeingCut:e.isBeingCut,numberOfVisibleColumns:a,icon:Y,label:e.label,doenetId:t,hasToggle:!0,isOpen:e.isOpen,isSelected:e.isSelected,indentLevel:n}),r]})}else return i($,{courseId:l,columnsJSX:d,courseNavigatorProps:s,isBeingCut:e.isBeingCut,numberOfVisibleColumns:a,icon:Y,label:e.label,doenetId:t,hasToggle:!0,isOpen:e.isOpen,isSelected:e.isSelected,indentLevel:n})}function _e({courseId:l,doenetId:t,itemInfo:e,numberOfVisibleColumns:a,indentLevel:n,courseNavigatorProps:s}){if(e.isOpen){let c=e.pages.map((p,d)=>i(Z,{courseNavigatorProps:s,courseId:l,doenetId:p,numberOfVisibleColumns:a,indentLevel:n+1,number:d+1},`Page${p}`));return B(A,{children:[i($,{courseId:l,courseNavigatorProps:s,numberOfVisibleColumns:a,icon:ne,label:e.label,doenetId:t,hasToggle:!0,isOpen:e.isOpen,isSelected:e.isSelected,isBeingCut:e.isBeingCut,indentLevel:n}),c]})}else return i($,{courseId:l,courseNavigatorProps:s,numberOfVisibleColumns:a,icon:ne,label:e.label,doenetId:t,hasToggle:!0,isOpen:e.isOpen,isSelected:e.isSelected,isBeingCut:e.isBeingCut,indentLevel:n})}function ke({courseId:l,doenetId:t,itemInfo:e,numberOfVisibleColumns:a,indentLevel:n,courseNavigatorProps:s}){let c=[null,null];if(e.isAssigned&&(c[0]=i(E,{icon:N},`activityColumn2${t}`)),e.isPublic&&(c[1]=i(E,{icon:N},`activityColumn3${t}`)),e.isSinglePage)return i(A,{children:i($,{courseId:l,courseNavigatorProps:s,columnsJSX:c,numberOfVisibleColumns:a,icon:U,label:e.label,doenetId:t,isSelected:e.isSelected,indentLevel:n,isBeingCut:e.isBeingCut})});if(e.isOpen){let p=e.content.map((d,r)=>{if((d==null?void 0:d.type)=="order")return i(P,{courseNavigatorProps:s,orderInfo:d,courseId:l,activityDoenetId:t,numberOfVisibleColumns:1,indentLevel:n+1},`Order${r}${t}`);if(d!=null&&d.type){if((d==null?void 0:d.type)=="collectionLink")return i(b,{courseNavigatorProps:s,courseId:l,collectionLinkInfo:d,activityDoenetId:e.doenetId,numberOfVisibleColumns:a,indentLevel:n+1},`CollectionLink${r}`)}else return i(Z,{courseNavigatorProps:s,courseId:l,doenetId:d,activityDoenetId:e.doenetId,numberOfVisibleColumns:a,indentLevel:n+1},`NavPage${r}`)});return B(A,{children:[i($,{courseId:l,courseNavigatorProps:s,columnsJSX:c,numberOfVisibleColumns:a,icon:U,label:e.label,doenetId:t,hasToggle:!0,isOpen:e.isOpen,isSelected:e.isSelected,indentLevel:n,isBeingCut:e.isBeingCut}),p]})}else return i(A,{children:i($,{courseId:l,courseNavigatorProps:s,columnsJSX:c,numberOfVisibleColumns:a,icon:U,label:e.label,doenetId:t,hasToggle:!0,isOpen:e.isOpen,isSelected:e.isSelected,indentLevel:n,isBeingCut:e.isBeingCut})})}function P({courseId:l,activityDoenetId:t,numberOfVisibleColumns:e,indentLevel:a,orderInfo:n,courseNavigatorProps:s}){let{behavior:c,doenetId:p,content:d,numberToSelect:r,withReplacement:h}=n,u=R(g(p)),v=[];c=="sequence"?v=d.map((f,w)=>(f==null?void 0:f.type)=="order"?i(P,{courseNavigatorProps:s,orderInfo:f,courseId:l,activityDoenetId:p,numberOfVisibleColumns:1,indentLevel:a+1},`Order${w}${p}`):(f==null?void 0:f.type)=="collectionLink"?i(b,{courseNavigatorProps:s,courseId:l,collectionLinkInfo:f,activityDoenetId:p,numberOfVisibleColumns:e,indentLevel:a+1},`CollectionLink${w}`):i(Z,{courseNavigatorProps:s,courseId:l,doenetId:f,activityDoenetId:t,numberOfVisibleColumns:e,indentLevel:a+1,number:w+1},`NavPage${w}`)):v=d.map((f,w)=>(f==null?void 0:f.type)=="order"?i(P,{courseNavigatorProps:s,orderInfo:f,courseId:l,activityDoenetId:p,numberOfVisibleColumns:1,indentLevel:a+1},`Order${w}${p}`):(f==null?void 0:f.type)=="collectionLink"?i(b,{courseNavigatorProps:s,courseId:l,collectionLinkInfo:f,activityDoenetId:p,numberOfVisibleColumns:e,indentLevel:a+1},`CollectionLink${w}`):i(Z,{courseNavigatorProps:s,courseId:l,doenetId:f,activityDoenetId:t,numberOfVisibleColumns:e,indentLevel:a+1},`NavPage${w}`));let x=c;return c=="select"&&(h?x=`${c} ${r} with replacement`:x=`${c} ${r} without replacement`),u.isOpen?B(A,{children:[i($,{courseId:l,isBeingCut:u.isBeingCut,courseNavigatorProps:s,numberOfVisibleColumns:e,icon:le,label:x,doenetId:p,hasToggle:!0,isOpen:u.isOpen,isSelected:u.isSelected,indentLevel:a}),v]}):i($,{courseId:l,isBeingCut:u.isBeingCut,courseNavigatorProps:s,numberOfVisibleColumns:e,icon:le,label:x,doenetId:p,hasToggle:!0,isOpen:u.isOpen,isSelected:u.isSelected,indentLevel:a})}function Z({courseId:l,doenetId:t,activityDoenetId:e,numberOfVisibleColumns:a,indentLevel:n,number:s=null,courseNavigatorProps:c}){let p=R(g(t));return i($,{courseId:l,courseNavigatorProps:c,numberOfVisibleColumns:a,icon:we,label:p.label,doenetId:p.doenetId,indentLevel:n,numbered:s,isSelected:p.isSelected,isBeingCut:p.isBeingCut})}function Je({courseId:l,indentLevel:t,pages:e,courseNavigatorProps:a}){if(!e)return null;let n=[];for(let[s,c]of e.entries())n.push(i(Xe,{courseId:l,doenetId:c,number:s+1,indentLevel:t+1,courseNavigatorProps:a}));return i(A,{children:n})}function b({courseId:l,numberOfVisibleColumns:t,indentLevel:e,number:a=null,courseNavigatorProps:n,collectionLinkInfo:s}){let{doenetId:c}=s,p=R(g(c)),d=null;if(p.isOpen){let r=p.pages;d=i(Je,{courseId:l,indentLevel:e,pages:r,courseNavigatorProps:n})}return B(A,{children:[i($,{courseId:l,courseNavigatorProps:n,hasToggle:!0,isOpen:p.isOpen,numberOfVisibleColumns:t,icon:pe,label:p.label,doenetId:c,indentLevel:e,numbered:a,isSelected:p.isSelected,isBeingCut:p.isBeingCut}),d]})}function Xe({courseId:l,doenetId:t,indentLevel:e,numberOfVisibleColumns:a,number:n=null,courseNavigatorProps:s}){let c=R(g(t));return i($,{courseId:l,itemType:"pageLink",courseNavigatorProps:s,numberOfVisibleColumns:a,icon:pe,label:`Link to ${c.label}`,doenetId:t,indentLevel:e,numbered:n,isSelected:c.isSelected,isBeingCut:c.isBeingCut})}function $({courseId:l,doenetId:t,itemType:e,numberOfVisibleColumns:a,columnsJSX:n=[],icon:s,label:c,isSelected:p=!1,indentLevel:d=0,numbered:r,hasToggle:h=!1,isOpen:u,isBeingCut:v=!1,courseNavigatorProps:x}){const f=ce(se);let w=null,k=W(({set:y})=>()=>{y(g(t),F=>{let K={...F};return K.isOpen=!K.isOpen,K})},[t]),o=W(({snapshot:y,set:F})=>async K=>{K.preventDefault(),K.stopPropagation();let T=await y.getPromise(H),j=[];if(T.length==0)j=[t],F(g(t),C=>{let S={...C};return S.isSelected=!0,S});else if(T.length==1&&T[0]==t)K.metaKey?(j=[],F(g(t),C=>{let S={...C};return S.isSelected=!1,S})):j=[...T];else if(K.shiftKey){let C=await y.getPromise(I("sectionId"));C||(C=l);const S=await y.getPromise(Q({courseId:l,sectionId:C}));let D=[],G=!1,q=[];for(let J=0;J<S.length;J++){let z=S[J];const M=await y.getPromise(g(z));G&&(q.includes(M.parentDoenetId)?M.type=="order"&&q.push(M.doenetId):(G=!1,q=[])),G||(D.push(z),(M==null?void 0:M.isOpen)!==void 0&&!M.isOpen&&(G=!0,q.push(M.doenetId)))}let ge=T[T.length-1],L=D.indexOf(ge),m=D.indexOf(t),te=D.slice(Math.min(L,m),Math.max(L,m)+1);L>m&&te.reverse(),j=[...T];for(let J of te)T.includes(J)||(j.push(J),F(g(J),z=>{let M={...z};return M.isSelected=!0,M}))}else if(K.metaKey)T.includes(t)?(j=T.filter(S=>S!=t),F(g(t),S=>{let D={...S};return D.isSelected=!1,D})):(j=[...T,t],F(g(t),S=>{let D={...S};return D.isSelected=!0,D}));else{j=[t],F(g(t),C=>{let S={...C};return S.isSelected=!0,S});for(let C of T)t!=C&&F(g(C),S=>{let D={...S};return D.isSelected=!1,D})}let ee=null;j.length==1&&(ee=await y.getPromise(g(j[0]))),F(H,j),x==null||x.updateSelectMenu({selectedItems:j,singleItem:ee})},[t,l,f]),X="var(--canvas)",V="var(--canvastext)";p?(V="black",X="var(--lightBlue)"):v&&(X="var(--mainGray)"),h&&(w=u?i(ae,{"data-text":"folderToggleCloseIcon","aria-expanded":"true",style:{backgroundColor:X},onClick:()=>{h&&k()},onKeyDown:y=>{y.key==="enter"&&h&&k()},children:i(E,{icon:Ce})}):i(ae,{"data-test":"folderToggleOpenIcon","aria-expanded":"false",style:{backgroundColor:X},onClick:()=>{h&&k()},onKeyDown:y=>{y.key==="enter"&&h&&k()},children:i(E,{icon:De})}));let O=W(()=>async y=>{y.preventDefault(),y.stopPropagation(),x==null||x.doubleClickItem({doenetId:t,courseId:l})},[t,l,x]),ue=he(a),Se=i("div",{role:"button",tabIndex:0,className:"navigationRow noselect nooutline",style:{cursor:"pointer",padding:"8px",border:"0px",borderBottom:"2px solid var(--canvastext)",backgroundColor:X,color:V,width:"auto"},onClick:y=>{o(y)},onKeyDown:y=>{y.key==="Enter"&&(X==="var(--canvas)"||y.key==="Enter"&&y.metaKey?o(y):O(y))},onDoubleClick:y=>{O(y)},children:B("div",{style:{display:"grid",gridTemplateColumns:ue,gridTemplateRows:"1fr",alignContent:"center"},children:[i("span",{className:"navigationColumn1",style:{marginLeft:`${d*25}px`},children:B("p",{style:{display:"inline",margin:"0px"},children:[r?B("svg",{style:{verticalAlign:"middle"},width:"22",height:"22",viewBox:"0 0 22 22",children:[i("circle",{cx:"11",cy:"11",r:"12",stroke:"var(--canvas)",strokeWidth:"2",fill:"var(--mainBlue)"}),i("text",{fontSize:"14",fill:"var(--canvas)",fontFamily:"Verdana",textAnchor:"middle",alignmentBaseline:"baseline",x:"11",y:"16",children:r})]}):null,w,i("span",{style:{marginLeft:"8px"},"data-test":"rowIcon",children:i(E,{icon:s})}),B("span",{style:{marginLeft:"4px"},"data-test":"rowLabel",children:[c," "]})]})}),a>1?i("span",{className:"navigationColumn2",style:{textAlign:"center"},children:n[0]}):null,a>2?i("span",{className:"navigationColumn3",style:{textAlign:"center"},children:n[1]}):null,a>3?i("span",{className:"navigationColumn4",style:{textAlign:"center"},children:n[2]}):null,a>4?i("span",{className:"navigationColumn5",style:{textAlign:"center"},children:n[3]}):null]})},`Row${t}`);return i(A,{children:Se})}function he(l){let t="300px repeat(4,1fr)";return l===4?t="300px repeat(3,1fr)":l===3?t="300px 1fr 1fr":l===2?t="300px 1fr":l===1&&(t="100%"),t}function fe({courseId:l,sectionId:t,columnLabels:e,numberOfVisibleColumns:a,setNumberOfVisibleColumns:n}){let s=W(({set:d,snapshot:r})=>async({isOpen:h=!0,courseId:u,sectionId:v})=>{v||(v=u);let x=await r.getPromise(Q({courseId:u,sectionId:v}));for(let f of x)d(g(f),w=>{let k={...w};return"isOpen"in k&&(k.isOpen=h),k})},[]);const c=_.useCallback(d=>{const r=e.length+1,h=[375,500,650,800];if(d>=h[3]&&a!==5){const u=Math.min(r,5);n==null||n(u)}else if(d<h[3]&&d>=h[2]&&a!==4){const u=Math.min(r,4);n==null||n(u)}else if(d<h[2]&&d>=h[1]&&a!==3){const u=Math.min(r,3);n==null||n(u)}else if(d<h[1]&&d>=h[0]&&a!==2){const u=Math.min(r,2);n==null||n(u)}else d<h[0]&&a!==1?n==null||n(1):a>r&&(n==null||n(r))},[e,a,n]);let p=he(a);return i(Re,{bounds:!0,onResize:d=>{const r=d.bounds.width;c(r)},children:({measureRef:d})=>i("div",{ref:d,className:"noselect nooutline",style:{padding:"8px",border:"0px",borderBottom:"1px solid var(--canvastext)",maxWidth:"850px",margin:"0px"},children:B("div",{style:{display:"grid",gridTemplateColumns:p,gridTemplateRows:"1fr",alignContent:"center"},children:[B("span",{style:{display:"flex"},children:[i("span",{style:{marginRight:"10px"},children:"Label"}),B(Te,{children:[i(ie,{value:"Open All",onClick:()=>s({isOpen:!0,courseId:l,sectionId:t})}),i(ie,{value:"Close All",onClick:()=>s({isOpen:!1,courseId:l,sectionId:t})})]})]}),a>=2&&e[0]?i("span",{style:{textAlign:"center"},children:e[0]}):null,a>=3&&e[1]?i("span",{style:{textAlign:"center"},children:e[1]}):null,a>=4&&e[2]?i("span",{style:{textAlign:"center"},children:e[2]}):null,a>=5&&e[3]?i("span",{style:{textAlign:"center"},children:e[3]}):null]})})})}export{He as C};
