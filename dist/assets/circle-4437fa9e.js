import{av as D,bn as W,r as l,j as X}from"./index-7c464f87.js";import{BoardContext as _,LINE_LAYER_OFFSET as w}from"./graph-fcef2c02.js";import"./css-14ccef8c.js";import"./visibility-sensor-82f19459.js";const U=D.memo(function u(F){let{name:E,id:m,SVs:e,actions:d,callAction:f}=W(F);u.ignoreActionsWithoutCore=!0;const n=l.useContext(_);let r=l.useRef(null),h=l.useRef(!1),a=l.useRef(!1),p=l.useRef(!1),y=l.useRef(!1),C=l.useRef(!1),g=l.useRef(!1),b=l.useRef(null),P=l.useRef(null),R=l.useRef(null);P.current=e.numericalCenter,R.current=e.throughAngles,l.useEffect(()=>()=>{r.current&&O()},[]);function L(){if(!(Number.isFinite(e.numericalCenter[0])&&Number.isFinite(e.numericalCenter[1])&&e.numericalRadius>0))return null;let s=!e.draggable||e.fixed;const o=e.filled?e.selectedStyle.fillColor.toLowerCase():"none";var i={name:e.labelForGraph,visible:!e.hidden,withLabel:e.showLabel&&e.labelForGraph!=="",fixed:s,layer:10*e.layer+w,strokeColor:e.selectedStyle.lineColor,strokeOpacity:e.selectedStyle.lineOpacity,highlightStrokeColor:e.selectedStyle.lineColor,strokeWidth:e.selectedStyle.lineWidth,highlightStrokeWidth:e.selectedStyle.lineWidth,highlightStrokeOpacity:e.selectedStyle.lineOpacity*.5,dash:A(e.selectedStyle.lineStyle),fillColor:o,fillOpacity:e.selectedStyle.fillOpacity,highlightFillColor:o,highlightFillOpacity:e.selectedStyle.fillOpacity*.5,highlight:!s};e.filled&&(i.hasInnerPoints=!0),i.label={highlight:!1},e.labelHasLatex&&(i.label.useMathJax=!0),e.showLabel&&e.labelForGraph!==""&&(e.applyStyleToLabel?i.label.strokeColor=e.selectedStyle.lineColor:i.label.strokeColor="#000000");let t=n.create("circle",[[...e.numericalCenter],e.numericalRadius],i);return t.on("drag",function(c){(Math.abs(c.x-a.current[0])>.1||Math.abs(c.y-a.current[1])>.1)&&(h.current=!0),b.current=x(c),f({action:d.moveCircle,args:{center:b.current,radius:y.current,throughAngles:C.current,transient:!0,skippable:!0}}),t.center.coords.setCoordinates(JXG.COORDS_BY_USER,[...P.current])}),t.on("up",function(c){h.current?f({action:d.moveCircle,args:{center:b.current,radius:y.current,throughAngles:C.current}}):f({action:d.circleClicked})}),t.on("down",function(c){h.current=!1,a.current=[c.x,c.y],p.current=[...t.center.coords.scrCoords],y.current=t.radius,C.current=[...R.current],f({action:d.mouseDownOnCircle})}),g.current=e.showLabel&&e.labelForGraph!=="",t}function x(s){var o=n.origin.scrCoords;let i=(p.current[1]+s.x-a.current[0]-o[1])/n.unitX,t=(o[2]-(p.current[2]+s.y-a.current[1]))/n.unitY;return[i,t]}function O(){r.current.off("drag"),r.current.off("down"),r.current.off("up"),n.removeObject(r.current),r.current=null}if(n)if(!r.current)r.current=L();else if(!(Number.isFinite(e.numericalCenter[0])&&Number.isFinite(e.numericalCenter[1])&&e.numericalRadius>0))O();else{n.updateQuality===n.BOARD_QUALITY_LOW&&(n.itemsRenderedLowQuality[m]=r.current);let s=e.numericalCenter.every(G=>Number.isFinite(G));r.current.center.coords.setCoordinates(JXG.COORDS_BY_USER,[...e.numericalCenter]),r.current.setRadius(e.numericalRadius);let o=!e.hidden;s?(r.current.visProp.visible=o,r.current.visPropCalc.visible=o):(r.current.visProp.visible=!1,r.current.visPropCalc.visible=!1);let i=!e.draggable||e.fixed;r.current.visProp.fixed=i,r.current.visProp.highlight=!i;let t=10*e.layer+w;r.current.visProp.layer!==t&&r.current.setAttribute({layer:t}),r.current.visProp.strokecolor!==e.selectedStyle.lineColor&&(r.current.visProp.strokecolor=e.selectedStyle.lineColor,r.current.visProp.highlightstrokecolor=e.selectedStyle.lineColor),r.current.visProp.strokeopacity!==e.selectedStyle.lineOpacity&&(r.current.visProp.strokeopacity=e.selectedStyle.lineOpacity,r.current.visProp.highlightstrokeopacity=e.selectedStyle.lineOpacity*.5);let k=A(e.selectedStyle.lineStyle);r.current.visProp.dash!==k&&(r.current.visProp.dash=k),r.current.visProp.strokewidth!==e.selectedStyle.lineWidth&&(r.current.visProp.strokewidth=e.selectedStyle.lineWidth,r.current.visProp.highlightstrokewidth=e.selectedStyle.lineWidth);const v=e.filled?e.selectedStyle.fillColor.toLowerCase():"none";r.current.visProp.fillcolor!==v&&(r.current.visProp.fillcolor=v,r.current.visProp.highlightfillcolor=v,r.current.visProp.hasinnerpoints=e.filled),r.current.visProp.fillopacity!==e.selectedStyle.fillOpacity&&(r.current.visProp.fillopacity=e.selectedStyle.fillOpacity,r.current.visProp.highlightfillopacity=e.selectedStyle.fillOpacity*.5),r.current.name=e.labelForGraph;let S=e.showLabel&&e.labelForGraph!=="";S!=g.current&&(r.current.setAttribute({withlabel:S}),g.current=S),r.current.needsUpdate=!0,r.current.update(),r.current.hasLabel&&(e.applyStyleToLabel?r.current.label.visProp.strokecolor=e.selectedStyle.lineColor:r.current.label.visProp.strokecolor="#000000",r.current.label.needsUpdate=!0,r.current.label.update()),n.updateRenderer()}return e.hidden?null:X("a",{name:m})});function A(u){return u==="solid"?0:u==="dashed"?2:u==="dotted"?1:0}export{U as default};
