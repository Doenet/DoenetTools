import{r as u,l as h,T as p,m as y,v as f,G as D,V as w,y as x,a as g,F as S,j as c,z as A,k as v}from"./index-ab5ab855.js";import{A as C}from"./ActionButton-7b9dd35d.js";function B(){const[s,r]=u.useState([]),n=h(p),i=h(y("courseId")),l=f(({snapshot:t})=>async o=>{let e=[];for(let d of o){let a=await t.getPromise(D(d));if(a.type=="activity"&&a.isAssigned)e.push(d);else if(a.type=="section"&&a.isAssigned){let I=await t.getPromise(w({courseId:i,sectionId:d}));e=[...await l(I),...e]}}return e=[...new Set(e)],e},[i]);u.useEffect(()=>{n.length>0?l(n).then(t=>{r(t)}):r([])},[n]);const m=x();return g(S,{children:[c("h2",{"data-test":"selectedDataSourcesHeading",style:{margin:"16px 5px"},children:"Event Data"}),g("div",{children:[s.length," ",s.length==1?"Activity":"Activities"]}),c("br",{}),c(C,{width:"menu",value:"View on Shiny",disabled:s.length==0,onClick:async()=>{if(s.length==0)m("No activities found",A.INFO);else{let t=s.join("&data=");const o=await v.get(`/api/createSecretCode.php?courseId=${i}`),{secretCode:e}=o.data;window.open(`https://doenet.shinyapps.io/analyzer/?data=${t}&code=${e}`,"_blank")}}})]})}export{B as default};
