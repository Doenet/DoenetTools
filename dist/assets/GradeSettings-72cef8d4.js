import{h as G,ba as N,bb as Z,r as c,j as l,H as z,e as b,s as O,v as J,a as f,g as v,bc as w,M as T,w as D,F as y,aZ as S,at as M}from"./index-a1cd8b25.js";import{D as P}from"./DateTime-3a486389.js";import{I as X}from"./IncrementMenu-54a2d7c6.js";import"./moment-e3d6e6af.js";const _="var(--mainBlue)",H=G.button`
  height: 24px;
  border: 2px solid;
  border-color: ${s=>s.color};
  border-radius: 5px;
  color: var(--canvas);
  background-color: ${s=>s.color};
`;function W(s){const d=s.checked?N:Z,n=s.checked?_:"var(--mainGray)",i=c.useRef(null);return l(H,{color:n,ref:i,onClick:A=>{s.onClick(A)},children:l(z,{icon:d})})}function V(){let s=b(O("courseId")),d=b(O("doenetId")),n=b(O("userId"));const[i,A]=c.useState(null),[h,E]=c.useState(null);let[m,I]=c.useState(null),[j,k]=c.useState(null),[x,B]=c.useState(!1);const u=J();c.useEffect(()=>{async function t(a,e,o){let r=await v.get("/api/loadGradebookAdjustmentSettingsInfo.php",{params:{doenetId:a,userId:e,courseId:o}}),R=Number(r.data.numberOfAttemptsAllowedAdjustment);A(R);let p="unlimited";r.data.baseAttemptsAllowed!="unlimited"&&(p=Number(r.data.baseAttemptsAllowed)),E(p)}i==null&&t(d,n,s)},[i,d,n,s]);const $=async(t,a)=>{try{let{data:e}=await v.get("/api/loadDueDateInfo.php",{params:{courseId:s,doenetId:t,userId:a}});if(B(!0),e.success){const o=e.dueDateInfo.dueDateOverride;let r=null;o&&(r=w(T(o))),I(r);const R=e.dueDateInfo.dueDate;let p="No Due Date";R&&(p=w(T(R))),k(p)}else u(`ERROR: ${e.message}`,D.ERROR)}catch(e){u(`ERROR: ${e}`,D.ERROR)}},C=async(t,a,e)=>{e===null?e="Cancel Due Date Override":e=M(new Date(e));try{let{data:o}=await v.get("/api/saveDueDateInfo.php",{params:{doenetId:t,userId:a,newDateString:e}});if(o.success)if(e==="Cancel Due Date Override")u("Cancelled Due Date Override!",D.SUCCESS);else{const r=w(new Date(e));u(`Set Due Date Override to ${r}`,D.SUCCESS)}else u(`ERROR: ${o.message}`,D.ERROR)}catch(o){u(`ERROR: ${o}`,D.ERROR)}};if(!d||!n)return null;x||$(d,n);let U=f(y,{children:["Due Date Override:",f("div",{style:{display:"flex"},onClick:t=>{t.preventDefault()},children:[l(W,{checked:m!==null,onClick:()=>{let t=null;if(m===null){let a=new Date;a.setDate(a.getDate()+7),t=S(a)}I(t),C(d,n,t)}}),l(P,{value:m?new Date(m):null,onBlur:({valid:t,value:a})=>{if(t){try{a=a.toDate()}catch{}new Date(S(a)).getTime()!==new Date(m).getTime()&&(I(a),C(d,n,a))}else u("Invalid Due Date")}})]})]}),F=h+i,g=l("p",{children:"Unlimited Attempts"});return h!="unlimited"&&i!=null&&(g=f(y,{children:[l("div",{children:"Base Attempts Allowed: "}),l("div",{children:h}),l("div",{children:"Attempts Allowed Adjustment: "}),l(X,{min:-h,value:i,onChange:t=>{A(t),v.get("/api/updateGradebookAdjustment.php",{params:{doenetId:d,userId:n,courseId:s,attemptsAdjustment:t}}).then(({data:a})=>{})}}),l("div",{children:"Resulting Attempts Allowed: "}),l("div",{children:F})]})),f("div",{children:[l("div",{children:"Due Date: "}),f("div",{children:[j," "]}),U,l("br",{}),g]})}export{V as default};
