import{l as i,m as S,x as $,R as T,Q as B,r as e,S as Q,T as G,H as J,w as K,k as U,j as n,F as W}from"./index-b4c9ab18.js";import{A as X}from"./ActivityViewer-aba7aef3.js";import{r as Y}from"./activityUtils-ccc6a30c.js";import"./visibility-sensor-bc268969.js";import"./ActionButton-399b8f22.js";import"./ButtonGroup-3ededee9.js";function de(){const t=i(S("doenetId")),m=i($),o=i(S("requestedVariant")),v=o&&Number.isFinite(Number(o))?Number(o):1,y=T(B);let[f,r]=e.useState("Initializing"),[I,p]=e.useState("");const[{showCorrectness:V,paginate:A,showFeedback:C,showHints:D,autoSubmit:_,cid:x,doenetId:b,solutionDisplayMode:F},k]=e.useState({});let P=e.useRef([]);Q(t),G(m);let l=i(J(t)),u=l.label;e.useEffect(()=>{const a=document.title;return u&&(document.title=`${u} - Doenet`),()=>{document.title=a}},[u]),e.useEffect(()=>{R(t,l)},[l,t]);function M(a,g){y({index:a,numberOfVariants:g})}const R=K(({snapshot:a,set:g})=>async(w,{type:E,timeLimit:Z,assignedDate:ee,dueDate:te,showCorrectness:O,showCreditAchievedMenu:ae,paginate:H,showFeedback:L,showHints:N,autoSubmit:j,showSolution:q,proctorMakesAvailable:se})=>{if(E===void 0)return;let h="button";q||(h="none");let d=null,s=await U.get("/api/getCidForAssignment.php",{params:{doenetId:w,latestAttemptOverrides:!1,getDraft:!0}});if(!s.data.success||!s.data.cid){r("Problem"),p(`Error loading assignment: ${s.data.message}`);return}else d=s.data.cid;let c=await Y(d);if(!c.success){r("Problem"),p(c.message);return}P.current=[...Array(c.numberOfVariants).keys()].map(z=>z+1),k({showCorrectness:O,paginate:H,showFeedback:L,showHints:N,autoSubmit:j,cid:d,doenetId:w,solutionDisplayMode:h}),r("Ready")},[]);return t===""?null:m==="__not_found__"?n("h1",{children:"Content not found or no permission to view content"}):f==="Initializing"?null:f==="Problem"?n("h1",{children:I}):n(W,{children:n(X,{cid:x,doenetId:b,flags:{showCorrectness:V,readOnly:!1,solutionDisplayMode:F,showFeedback:C,showHints:D,autoSubmit:_,allowLoadState:!1,allowSaveState:!1,allowLocalState:!1,allowSaveSubmissions:!1,allowSaveEvents:!1},requestedVariantIndex:v,generatedVariantCallback:M,paginate:A},`activityViewer${b}`)})}export{de as default};
