import{av as I,bn as q,r as f,a as F,F as W,j as m,bo as Y,ad as Q}from"./index-ab5ab855.js";import{s as E}from"./css-14ccef8c.js";import{V as D}from"./visibility-sensor-7b80a154.js";function G(b){return b=Q(b,{isIdentifier:!0}),b.slice(0,2)==="\\#"&&(b=b.slice(1)),b}const K=f.createContext(),it=I.memo(function(N){let{name:Z,id:g,SVs:t,children:X,actions:L,callAction:P}=q(N);const[n,J]=f.useState(null),A=f.useRef(null),v=f.useRef(null),o=f.useRef(null),c=f.useRef(null),S=f.useRef(!1),C=f.useRef(!1),y=f.useRef(!1);let O=f.useRef(null),R=f.useRef(null),_=t.showNavigation&&!t.fixAxes,B=d=>{P({action:L.recordVisibilityChange,args:{isVisible:d}})};if(f.useEffect(()=>{if(!t.haveGraphParent)return()=>{P({action:L.recordVisibilityChange,args:{isVisible:!1}})}},[]),f.useEffect(()=>{if(t.haveGraphParent)return;let d=[t.xmin,t.ymax,t.xmax,t.ymin];v.current=d,JXG.Options.layer.numlayers=100,JXG.Options.navbar.highlightFillColor="var(--canvastext)",JXG.Options.navbar.strokeColor="var(--canvastext)";let a=!1;Array.isArray(t.grid)&&(a=!0,JXG.Options.grid.gridX=t.grid[0],JXG.Options.grid.gridY=t.grid[1]);let s=window.JXG.JSXGraph.initBoard(g,{boundingbox:d,axis:!1,showCopyright:!1,showNavigation:!1,zoom:{wheel:!t.fixAxes},pan:{enabled:!t.fixAxes},grid:a});return s.itemsRenderedLowQuality={},s.on("boundingbox",()=>{if(!S.current){let i=s.getBoundingBox(),[e,u,l,r]=i,h=Math.abs(l-e),x=Math.abs(u-r),T=i.map((z,V)=>Math.abs(z-v.current[V]));Math.max(T[0]/h,T[1]/x,T[2]/h,T[3]/x)>1e-12&&(v.current=i,P({action:L.changeAxisLimits,args:{xmin:e,xmax:l,ymin:r,ymax:u}}))}}),J(s),A.current={width:parseFloat(E(t.width)),aspectRatio:t.aspectRatio},t.displayXAxis&&j(s),t.displayYAxis&&M(s),C.current=!0,y.current=_,()=>{s.off("boundingbox")}},[]),f.useEffect(()=>{n&&_&&H()},[n]),t.haveGraphParent)return F(W,{children:[m("a",{name:g}),X]});const p={width:E(t.width),aspectRatio:String(t.aspectRatio),maxWidth:"100%"};let w={};if(t.hidden?p.display="none":t.displayMode==="inline"?w={display:"inline-block",verticalAlign:"middle"}:w={display:"flex",justifyContent:t.horizontalAlign},t.showBorder?p.border="2px solid var(--canvastext)":p.border="none",p.marginBottom="12px",p.marginTop="12px",p.backgroundColor="var(--canvas)",p.color="var(--canvastext)",!n)return m(D,{partialVisibility:!0,onChange:B,children:F("div",{style:w,children:[m("a",{name:g}),m("div",{id:g,className:"jxgbox",style:p})]})});if(C.current)C.current=!1;else{Array.isArray(t.grid)?((JXG.Options.grid.gridX!==t.grid[0]||JXG.Options.grid.gridY!==t.grid[1])&&(JXG.Options.grid.gridX=t.grid[0],JXG.Options.grid.gridY=t.grid[1],n.grids.length>0&&(n.removeObject(n.grids[0]),n.grids=[])),n.grids.length===0&&n.create("grid",[],{gridX:t.grid[0],gridY:t.grid[1]})):n.grids.length>0&&(n.removeObject(n.grids[0]),n.grids=[]),t.grid==="dense"?(o.current&&(o.current.defaultTicks.setAttribute({majorHeight:-1}),o.current.defaultTicks.setAttribute({minorHeight:-1})),c.current&&(c.current.defaultTicks.setAttribute({majorHeight:-1}),c.current.defaultTicks.setAttribute({minorHeight:-1}))):t.grid==="medium"?(o.current&&(o.current.defaultTicks.setAttribute({majorHeight:-1}),o.current.defaultTicks.setAttribute({minorHeight:10})),c.current&&(c.current.defaultTicks.setAttribute({majorHeight:-1}),c.current.defaultTicks.setAttribute({minorHeight:10}))):(o.current&&(o.current.defaultTicks.setAttribute({majorHeight:20}),o.current.defaultTicks.setAttribute({minorHeight:10})),c.current&&(c.current.defaultTicks.setAttribute({majorHeight:20}),c.current.defaultTicks.setAttribute({minorHeight:10})));let d=t.displayXAxis?!o.current:!!o.current,a=t.displayYAxis?!c.current:!!c.current;if(a&&!d&&t.displayXAxis&&(n.removeObject(o.current),o.current=null),d&&!a&&t.displayYAxis&&(n.removeObject(c.current),c.current=null),t.displayXAxis)if(o.current){let e=!!t.xlabel;if(e!==O.current&&(o.current.setAttribute({withlabel:e}),O.current=e),o.current.name=t.xlabel,o.current.defaultTicks.setAttribute({drawLabels:t.displayXAxisTickLabels}),o.current.hasLabel){let u="rt",l=[5,10],r="right";t.xlabelPosition==="left"&&(u="lft",r="left",l=[-5,10]),o.current.label.visProp.position=u,o.current.label.visProp.anchorx=r,o.current.label.visProp.offset=l,o.current.label.needsUpdate=!0,o.current.label.fullUpdate()}}else j(n);else o.current&&(n.removeObject(o.current),o.current=null);if(t.displayYAxis)if(c.current){let e=!!t.ylabel;if(e!==R.current&&(c.current.setAttribute({withlabel:e}),R.current=e),c.current.name=t.ylabel,c.current.defaultTicks.setAttribute({drawLabels:t.displayYAxisTickLabels}),c.current.hasLabel){let u="rt",l=[-10,-5],r="right";t.ylabelPosition==="bottom"&&(u="lft",l[1]=5),t.ylabelAlignment==="right"&&(r="left",l[0]=10),c.current.label.visProp.position=u,c.current.label.visProp.offset=l,c.current.label.visProp.anchorx=r,c.current.label.needsUpdate=!0,c.current.label.fullUpdate()}}else M(n);else c.current&&(n.removeObject(c.current),c.current=null);_?y.current||(H(),y.current=!0):y.current&&(U(),y.current=!1);let s={width:parseFloat(E(t.width)),aspectRatio:t.aspectRatio};(s.width!==A.current.width||s.aspectRatio!==A.current.aspectRatio)&&Number.isFinite(s.width)&&Number.isFinite(s.aspectRatio)&&(A.current=s);let i=[t.xmin,t.ymax,t.xmax,t.ymin];i.some((e,u)=>e!==v.current[u])&&(S.current=!0,n.setBoundingBox(i),S.current=!1,n.fullUpdate(),n.updateQuality===n.BOARD_QUALITY_LOW&&(n.itemsRenderedLowQuality[g]=n),v.current=i)}return m(D,{partialVisibility:!0,onChange:B,children:F("div",{style:w,children:[m("a",{name:g}),m("div",{id:g,className:"jxgbox",style:p}),m(K.Provider,{value:n,children:X})]})});function M(d){let a={highlight:!1,fixed:!0};if(t.ylabel){let s="rt",i=[-10,-5],e="right";t.ylabelPosition==="bottom"&&(s="lft",i[1]=5),t.ylabelAlignment==="right"&&(e="left",i[0]=10),a.name=t.ylabel,a.withLabel=!0,a.label={position:s,offset:i,anchorx:e,strokeColor:"var(--canvastext)",highlight:!1},t.ylabelHasLatex&&(a.label.useMathJax=!0)}if(R.current=!!t.ylabel,a.strokeColor="var(--canvastext)",a.highlight=!1,a.ticks={ticksDistance:2,label:{offset:[12,-2],layer:2,strokeColor:"var(--canvastext)",highlightStrokeColor:"var(--canvastext)",highlightStrokeOpacity:1},strokeColor:"var(--canvastext)",strokeOpacity:.5,precision:4,drawLabels:t.displayYAxisTickLabels},t.yTickScaleFactor!==null){let s=Y.fromAst(t.yTickScaleFactor),i=s.evaluate_to_constant();if(i>0){let e=s.toString();a.ticks.scale=i,a.ticks.scaleSymbol=e}}t.grid==="dense"?(a.ticks.majorHeight=-1,a.ticks.minorHeight=-1):t.grid==="medium"?(a.ticks.majorHeight=-1,a.ticks.minorHeight=10):(a.ticks.majorHeight=20,a.ticks.minorHeight=10),t.displayXAxis||(a.ticks.drawZero=!0),d.suspendUpdate(),c.current=d.create("axis",[[0,0],[0,1]],a),c.current.defaultTicks.ticksFunction=function(){var s,i,e;return i=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),e=i.upper-i.lower,s=Math.pow(10,Math.floor(Math.log(.2*e)/Math.LN10)),e<=6*s&&(s*=.5),s},c.current.defaultTicks.generateEquidistantTicks=function(s,i){var e,u=1e-6,l,r=this.equidistant?this.ticksFunction(1):this.ticksDelta,h=4;if(this.visProp.minorticks=4,l=this.getXandYdeltas(),r*=this.visProp.scale,this.minTicksDistance>1e-6){r=this.adjustTickDistance(r,s,l);let x=10**Math.floor(Math.log10(r))*this.visProp.scale;Math.abs(r/x-2)<1e-14&&(h=3,this.visProp.minorticks=3),r/=h+1}if(this.ticksDelta=r,!(r<1e-6)){for(e=0,this.visProp.drawzero||(e=r);e<=i.upper+u&&(e>=i.lower-u&&this.processTickPosition(s,e,r,l),e+=r,!(i.upper-e>r*1e4)););for(e=-r;e>=i.lower-u&&(e<=i.upper+u&&this.processTickPosition(s,e,r,l),e-=r,!(e-i.lower>r*1e4)););}},d.unsuspendUpdate()}function j(d){let a={highlight:!1,fixed:!0};if(t.xlabel){let s="rt",i=[5,10],e="right";t.xlabelPosition==="left"&&(s="lft",e="left",i=[-5,10]),a.name=t.xlabel,a.withLabel=!0,a.label={position:s,offset:i,anchorx:e,strokeColor:"var(--canvastext)",highlight:!1},t.xlabelHasLatex&&(a.label.useMathJax=!0)}if(O.current=!!t.xlabel,a.ticks={ticksDistance:2,label:{offset:[-5,-15],layer:2,strokeColor:"var(--canvastext)",highlightStrokeColor:"var(--canvastext)",highlightStrokeOpacity:1},strokeColor:"var(--canvastext)",strokeOpacity:.5,precision:4,drawLabels:t.displayXAxisTickLabels},t.xTickScaleFactor!==null){let s=Y.fromAst(t.xTickScaleFactor),i=s.evaluate_to_constant();if(i>0){let e=s.toString();a.ticks.scale=i,a.ticks.scaleSymbol=e}}a.strokeColor="var(--canvastext)",a.highlight=!1,t.grid==="dense"?(a.ticks.majorHeight=-1,a.ticks.minorHeight=-1):t.grid==="medium"?(a.ticks.majorHeight=-1,a.ticks.minorHeight=10):(a.ticks.majorHeight=20,a.ticks.minorHeight=10),t.displayYAxis||(a.ticks.drawZero=!0),d.suspendUpdate(),o.current=d.create("axis",[[0,0],[1,0]],a),o.current.defaultTicks.ticksFunction=function(){var s,i,e;return i=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),e=i.upper-i.lower,s=Math.pow(10,Math.floor(Math.log(.2*e)/Math.LN10)),e<=6*s&&(s*=.5),s},o.current.defaultTicks.generateEquidistantTicks=function(s,i){this.minTicksDistance=2*Math.max(2.5,Math.log10(Math.abs(i.lower)),Math.log10(Math.abs(i.upper)));var e,u=1e-6,l,r=this.equidistant?this.ticksFunction(1):this.ticksDelta,h=4;if(this.visProp.minorticks=4,l=this.getXandYdeltas(),r*=this.visProp.scale,this.minTicksDistance>1e-6){r=this.adjustTickDistance(r,s,l);let x=10**Math.floor(Math.log10(r))*this.visProp.scale;Math.abs(r/x-2)<1e-14&&(h=3,this.visProp.minorticks=3),r/=h+1}if(this.ticksDelta=r,!(r<1e-6)){for(e=0,this.visProp.drawzero||(e=r);e<=i.upper+u&&(e>=i.lower-u&&this.processTickPosition(s,e,r,l),e+=r,!(i.upper-e>r*1e4)););for(e=-r;e>=i.lower-u&&(e<=i.upper+u&&this.processTickPosition(s,e,r,l),e-=r,!(e-i.lower>r*1e4)););}},d.unsuspendUpdate()}function H(){let d=document.querySelector("#"+G(g)+"_navigationbar"),a=function(e,u,l){var r=function(){return l.apply(n,arguments)};n["x_internal"+u]=n["x_internal"+u]||[],n["x_internal"+u].push(r),e.addEventListener(u,r,!1)},s=function(e){e||(e=window.event),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},i=function(e,u){var l;l=document.createElement("span"),d.appendChild(l);let r=document.createElement("span");r.setAttribute("style","color: var(--canvastext); opacity: 0.7");let h=document.createTextNode(e);l.appendChild(r),r.appendChild(h),l.style.paddingLeft="7px",l.style.paddingRight="7px",l.classList!==void 0&&l.classList.add("JXG_navigation_button"),a(l,"click",function(x){return u.bind(n)(),!1}),a(l,"mouseup",s),a(l,"mousedown",s),a(l,"touchend",s),a(l,"touchstart",s)};n.attr.showzoom&&(i("–",n.zoomOut),i("o",n.zoom100),i("+",n.zoomIn)),i("←",n.clickLeftArrow),i("↓",n.clickUpArrow),i("↑",n.clickDownArrow),i("→",n.clickRightArrow)}function U(){for(let d=7;d>=1;d--)document.querySelector("#"+G(g)+"_navigationbar > :first-child").remove();n.internalclick=[],n.internalmousedown=[],n.internalmouseup=[],n.internaltouchend=[],n.internaltouchstart=[]}});let k=0;const rt=k++,at=k++,st=k++,nt=k++,lt=k++,ot=k++,ct=k++;export{rt as BASE_LAYER_OFFSET,K as BoardContext,lt as CONTROL_POINT_LAYER_OFFSET,at as IMAGE_LAYER_OFFSET,st as LINE_LAYER_OFFSET,ot as POINT_LAYER_OFFSET,ct as TEXT_LAYER_OFFSET,nt as VERTEX_LAYER_OFFSET,it as default};
