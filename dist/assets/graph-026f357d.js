import{av as V,bn as I,r as f,j as m,a as B,bo as M,ad as q}from"./index-5e1f94d1.js";import{s as C}from"./css-14ccef8c.js";import{V as j}from"./visibility-sensor-cb98a906.js";function H(b){return b=q(b,{isIdentifier:!0}),b.slice(0,2)==="\\#"&&(b=b.slice(1)),b}const W=f.createContext(),tt=V.memo(function(Y){let{name:Q,id:g,SVs:t,children:D,actions:L,callAction:R}=I(Y);const[n,N]=f.useState(null),A=f.useRef(null),v=f.useRef(null),o=f.useRef(null),c=f.useRef(null),P=f.useRef(!1),S=f.useRef(!1),y=f.useRef(!1);let O=f.useRef(null),_=f.useRef(null),F=d=>{R({action:L.recordVisibilityChange,args:{isVisible:d}})};f.useEffect(()=>()=>{R({action:L.recordVisibilityChange,args:{isVisible:!1}})},[]),f.useEffect(()=>{let d=[t.xmin,t.ymax,t.xmax,t.ymin];v.current=d,JXG.Options.layer.numlayers=100,JXG.Options.navbar.highlightFillColor="var(--canvastext)",JXG.Options.navbar.strokeColor="var(--canvastext)";let r=!1;Array.isArray(t.grid)&&(r=!0,JXG.Options.grid.gridX=t.grid[0],JXG.Options.grid.gridY=t.grid[1]);let a=window.JXG.JSXGraph.initBoard(g,{boundingbox:d,axis:!1,showCopyright:!1,showNavigation:t.showNavigation&&!t.fixAxes,zoom:{wheel:!t.fixAxes},pan:{enabled:!t.fixAxes},grid:r});return a.itemsRenderedLowQuality={},a.on("boundingbox",()=>{if(!P.current){let i=a.getBoundingBox(),[e,u,l,s]=i,p=Math.abs(l-e),k=Math.abs(u-s),T=i.map((U,z)=>Math.abs(U-v.current[z]));Math.max(T[0]/p,T[1]/k,T[2]/p,T[3]/k)>1e-12&&(v.current=i,R({action:L.changeAxisLimits,args:{xmin:e,xmax:l,ymin:s,ymax:u}}))}}),N(a),A.current={width:parseFloat(C(t.width)),aspectRatio:t.aspectRatio},t.displayXAxis&&E(a),t.displayYAxis&&X(a),S.current=!0,y.current=t.showNavigation,()=>{a.off("boundingbox")}},[]);const h={width:C(t.width),aspectRatio:String(t.aspectRatio),maxWidth:"100%"};let w={};if(t.hidden?h.display="none":t.displayMode==="inline"?w={display:"inline-block",verticalAlign:"middle"}:w={display:"flex",justifyContent:t.horizontalAlign},t.showBorder?h.border="2px solid var(--canvastext)":h.border="none",h.marginBottom="12px",h.marginTop="12px",h.backgroundColor="var(--canvas)",h.color="var(--canvastext)",!n)return m(j,{partialVisibility:!0,onChange:F,children:B("div",{style:w,children:[m("a",{name:g}),m("div",{id:g,className:"jxgbox",style:h})]})});if(S.current)S.current=!1;else{Array.isArray(t.grid)?((JXG.Options.grid.gridX!==t.grid[0]||JXG.Options.grid.gridY!==t.grid[1])&&(JXG.Options.grid.gridX=t.grid[0],JXG.Options.grid.gridY=t.grid[1],n.grids.length>0&&(n.removeObject(n.grids[0]),n.grids=[])),n.grids.length===0&&n.create("grid",[],{gridX:t.grid[0],gridY:t.grid[1]})):n.grids.length>0&&(n.removeObject(n.grids[0]),n.grids=[]),t.grid==="dense"?(o.current&&(o.current.defaultTicks.setAttribute({majorHeight:-1}),o.current.defaultTicks.setAttribute({minorHeight:-1})),c.current&&(c.current.defaultTicks.setAttribute({majorHeight:-1}),c.current.defaultTicks.setAttribute({minorHeight:-1}))):t.grid==="medium"?(o.current&&(o.current.defaultTicks.setAttribute({majorHeight:-1}),o.current.defaultTicks.setAttribute({minorHeight:10})),c.current&&(c.current.defaultTicks.setAttribute({majorHeight:-1}),c.current.defaultTicks.setAttribute({minorHeight:10}))):(o.current&&(o.current.defaultTicks.setAttribute({majorHeight:20}),o.current.defaultTicks.setAttribute({minorHeight:10})),c.current&&(c.current.defaultTicks.setAttribute({majorHeight:20}),c.current.defaultTicks.setAttribute({minorHeight:10})));let d=t.displayXAxis?!o.current:!!o.current,r=t.displayYAxis?!c.current:!!c.current;if(r&&!d&&t.displayXAxis&&(n.removeObject(o.current),o.current=null),d&&!r&&t.displayYAxis&&(n.removeObject(c.current),c.current=null),t.displayXAxis)if(o.current){let e=!!t.xlabel;if(e!==O.current&&(o.current.setAttribute({withlabel:e}),O.current=e),o.current.name=t.xlabel,o.current.defaultTicks.setAttribute({drawLabels:t.displayXAxisTickLabels}),o.current.hasLabel){let u="rt",l=[5,10],s="right";t.xlabelPosition==="left"&&(u="lft",s="left",l=[-5,10]),o.current.label.visProp.position=u,o.current.label.visProp.anchorx=s,o.current.label.visProp.offset=l,o.current.label.needsUpdate=!0,o.current.label.fullUpdate()}}else E(n);else o.current&&(n.removeObject(o.current),o.current=null);if(t.displayYAxis)if(c.current){let e=!!t.ylabel;if(e!==_.current&&(c.current.setAttribute({withlabel:e}),_.current=e),c.current.name=t.ylabel,c.current.defaultTicks.setAttribute({drawLabels:t.displayYAxisTickLabels}),c.current.hasLabel){let u="rt",l=[-10,-5],s="right";t.ylabelPosition==="bottom"&&(u="lft",l[1]=5),t.ylabelAlignment==="right"&&(s="left",l[0]=10),c.current.label.visProp.position=u,c.current.label.visProp.offset=l,c.current.label.visProp.anchorx=s,c.current.label.needsUpdate=!0,c.current.label.fullUpdate()}}else X(n);else c.current&&(n.removeObject(c.current),c.current=null);t.showNavigation?y.current||(G(),y.current=!0):y.current&&(J(),y.current=!1);let a={width:parseFloat(C(t.width)),aspectRatio:t.aspectRatio};(a.width!==A.current.width||a.aspectRatio!==A.current.aspectRatio)&&Number.isFinite(a.width)&&Number.isFinite(a.aspectRatio)&&(A.current=a);let i=[t.xmin,t.ymax,t.xmax,t.ymin];i.some((e,u)=>e!==v.current[u])&&(P.current=!0,n.setBoundingBox(i),P.current=!1,n.fullUpdate(),n.updateQuality===n.BOARD_QUALITY_LOW&&(n.itemsRenderedLowQuality[g]=n),v.current=i)}return m(j,{partialVisibility:!0,onChange:F,children:B("div",{style:w,children:[m("a",{name:g}),m("div",{id:g,className:"jxgbox",style:h}),m(W.Provider,{value:n,children:D})]})});function X(d){let r={highlight:!1,fixed:!0};if(t.ylabel){let a="rt",i=[-10,-5],e="right";t.ylabelPosition==="bottom"&&(a="lft",i[1]=5),t.ylabelAlignment==="right"&&(e="left",i[0]=10),r.name=t.ylabel,r.withLabel=!0,r.label={position:a,offset:i,anchorx:e,strokeColor:"var(--canvastext)",highlight:!1},t.ylabelHasLatex&&(r.label.useMathJax=!0)}if(_.current=!!t.ylabel,r.strokeColor="var(--canvastext)",r.highlight=!1,r.ticks={ticksDistance:2,label:{offset:[12,-2],layer:2,strokeColor:"var(--canvastext)"},precision:4,drawLabels:t.displayYAxisTickLabels},t.yTickScaleFactor!==null){let a=M.fromAst(t.yTickScaleFactor),i=a.evaluate_to_constant();if(i>0){let e=a.toString();r.ticks.scale=i,r.ticks.scaleSymbol=e}}t.grid==="dense"?(r.ticks.majorHeight=-1,r.ticks.minorHeight=-1):t.grid==="medium"?(r.ticks.majorHeight=-1,r.ticks.minorHeight=10):(r.ticks.majorHeight=20,r.ticks.minorHeight=10),t.displayXAxis||(r.ticks.drawZero=!0),d.suspendUpdate(),c.current=d.create("axis",[[0,0],[0,1]],r),c.current.defaultTicks.ticksFunction=function(){var a,i,e;return i=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),e=i.upper-i.lower,a=Math.pow(10,Math.floor(Math.log(.2*e)/Math.LN10)),e<=6*a&&(a*=.5),a},c.current.defaultTicks.generateEquidistantTicks=function(a,i){var e,u=1e-6,l,s=this.equidistant?this.ticksFunction(1):this.ticksDelta,p=4;if(this.visProp.minorticks=4,l=this.getXandYdeltas(),s*=this.visProp.scale,this.minTicksDistance>1e-6){s=this.adjustTickDistance(s,a,l);let k=10**Math.floor(Math.log10(s))*this.visProp.scale;Math.abs(s/k-2)<1e-14&&(p=3,this.visProp.minorticks=3),s/=p+1}if(this.ticksDelta=s,!(s<1e-6)){for(e=0,this.visProp.drawzero||(e=s);e<=i.upper+u&&(e>=i.lower-u&&this.processTickPosition(a,e,s,l),e+=s,!(i.upper-e>s*1e4)););for(e=-s;e>=i.lower-u&&(e<=i.upper+u&&this.processTickPosition(a,e,s,l),e-=s,!(e-i.lower>s*1e4)););}},d.unsuspendUpdate()}function E(d){let r={highlight:!1,fixed:!0};if(t.xlabel){let a="rt",i=[5,10],e="right";t.xlabelPosition==="left"&&(a="lft",e="left",i=[-5,10]),r.name=t.xlabel,r.withLabel=!0,r.label={position:a,offset:i,anchorx:e,strokeColor:"var(--canvastext)",highlight:!1},t.xlabelHasLatex&&(r.label.useMathJax=!0)}if(O.current=!!t.xlabel,r.ticks={ticksDistance:2,label:{offset:[-5,-15],layer:2,strokeColor:"var(--canvastext)"},precision:4,drawLabels:t.displayXAxisTickLabels},t.xTickScaleFactor!==null){let a=M.fromAst(t.xTickScaleFactor),i=a.evaluate_to_constant();if(i>0){let e=a.toString();r.ticks.scale=i,r.ticks.scaleSymbol=e}}r.strokeColor="var(--canvastext)",r.highlight=!1,t.grid==="dense"?(r.ticks.majorHeight=-1,r.ticks.minorHeight=-1):t.grid==="medium"?(r.ticks.majorHeight=-1,r.ticks.minorHeight=10):(r.ticks.majorHeight=20,r.ticks.minorHeight=10),t.displayYAxis||(r.ticks.drawZero=!0),d.suspendUpdate(),o.current=d.create("axis",[[0,0],[1,0]],r),o.current.defaultTicks.ticksFunction=function(){var a,i,e;return i=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),e=i.upper-i.lower,a=Math.pow(10,Math.floor(Math.log(.2*e)/Math.LN10)),e<=6*a&&(a*=.5),a},o.current.defaultTicks.generateEquidistantTicks=function(a,i){this.minTicksDistance=2*Math.max(2.5,Math.log10(Math.abs(i.lower)),Math.log10(Math.abs(i.upper)));var e,u=1e-6,l,s=this.equidistant?this.ticksFunction(1):this.ticksDelta,p=4;if(this.visProp.minorticks=4,l=this.getXandYdeltas(),s*=this.visProp.scale,this.minTicksDistance>1e-6){s=this.adjustTickDistance(s,a,l);let k=10**Math.floor(Math.log10(s))*this.visProp.scale;Math.abs(s/k-2)<1e-14&&(p=3,this.visProp.minorticks=3),s/=p+1}if(this.ticksDelta=s,!(s<1e-6)){for(e=0,this.visProp.drawzero||(e=s);e<=i.upper+u&&(e>=i.lower-u&&this.processTickPosition(a,e,s,l),e+=s,!(i.upper-e>s*1e4)););for(e=-s;e>=i.lower-u&&(e<=i.upper+u&&this.processTickPosition(a,e,s,l),e-=s,!(e-i.lower>s*1e4)););}},d.unsuspendUpdate()}function G(){let d=document.querySelector("#"+H(g)+"_navigationbar"),r=function(e,u,l){var s=function(){return l.apply(n,arguments)};n["x_internal"+u]=n["x_internal"+u]||[],n["x_internal"+u].push(s),e.addEventListener(u,s,!1)},a=function(e){e||(e=window.event),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},i=function(e,u){var l;l=document.createElement("span"),d.appendChild(l),l.appendChild(document.createTextNode(e)),l.style.paddingLeft="7px",l.style.paddingRight="7px",l.classList!==void 0&&l.classList.add("JXG_navigation_button"),r(l,"click",function(s){return u.bind(n)(),!1}),r(l,"mouseup",a),r(l,"mousedown",a),r(l,"touchend",a),r(l,"touchstart",a)};n.attr.showzoom&&(i("–",n.zoomOut),i("o",n.zoom100),i("+",n.zoomIn)),i("←",n.clickLeftArrow),i("↓",n.clickUpArrow),i("↑",n.clickDownArrow),i("→",n.clickRightArrow)}function J(){for(let d=7;d>=1;d--)document.querySelector("#"+H(g)+"_navigationbar > :first-child").remove();n.internalclick=[],n.internalmousedown=[],n.internalmouseup=[],n.internaltouchend=[],n.internaltouchstart=[]}});let x=0;const et=x++,it=x++,rt=x++,at=x++,st=x++,nt=x++,lt=x++;export{et as BASE_LAYER_OFFSET,W as BoardContext,st as CONTROL_POINT_LAYER_OFFSET,it as IMAGE_LAYER_OFFSET,rt as LINE_LAYER_OFFSET,nt as POINT_LAYER_OFFSET,lt as TEXT_LAYER_OFFSET,at as VERTEX_LAYER_OFFSET,tt as default};
