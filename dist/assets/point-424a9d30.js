import{av as N,bn as T,r as a,j as A,a as V,F as W,b9 as H}from"./index-51be1395.js";import{BoardContext as q,POINT_LAYER_OFFSET as E}from"./graph-c205e3dc.js";import"./css-14ccef8c.js";import"./visibility-sensor-31436047.js";const ee=N.memo(function f(P){var M,D;let{name:_,id:F,SVs:e,actions:v,sourceOfUpdate:B,callAction:g}=T(P);f.ignoreActionsWithoutCore=!0;const s=a.useContext(q);let t=a.useRef(null),r=a.useRef(null),S=a.useRef(!1),X=a.useRef(!1),C=a.useRef(!1),G=a.useRef(null),J=a.useRef(null),k=a.useRef(null),w=a.useRef(null),L=a.useRef(null);L.current=e.numericalXs;const R=e.open||["cross","plus"].includes(e.selectedStyle.markerStyle);a.useEffect(()=>()=>{t.current!==null&&(r.current.off("drag"),r.current.off("down"),r.current.off("up"),s.removeObject(t.current),s.removeObject(r.current),t.current=null,r.current=null)},[]);function j(){let x=R?"var(--canvas)":e.selectedStyle.markerColor,O=R?e.selectedStyle.markerColor:"none",b=!e.draggable||e.fixed,h=e.showLabel&&e.labelForGraph!=="",o={name:e.labelForGraph,visible:!e.hidden,withlabel:h,fixed:!0,layer:10*e.layer+E,fillColor:x,strokeColor:O,strokeOpacity:e.selectedStyle.lineOpacity,fillOpacity:e.selectedStyle.lineOpacity,highlightFillColor:getComputedStyle(document.documentElement).getPropertyValue("--mainGray"),highlightStrokeColor:getComputedStyle(document.documentElement).getPropertyValue("--lightBlue"),size:U(e.selectedStyle.markerSize,e.selectedStyle.markerStyle),face:I(e.selectedStyle.markerStyle),highlight:!b};if(h){let i,n,l;e.labelPosition==="upperright"?(l=[5,5],i="left",n="bottom"):e.labelPosition==="upperleft"?(l=[-5,5],i="right",n="bottom"):e.labelPosition==="lowerright"?(l=[5,-5],i="left",n="top"):e.labelPosition==="lowerleft"?(l=[-5,-5],i="right",n="top"):e.labelPosition==="top"?(l=[0,10],i="middle",n="bottom"):e.labelPosition==="bottom"?(l=[0,-10],i="middle",n="top"):e.labelPosition==="left"?(l=[-10,0],i="right",n="middle"):(l=[10,0],i="left",n="middle"),o.label={offset:l,anchorx:i,anchory:n,highlight:!1},e.labelHasLatex&&(o.label.useMathJax=!0),e.applyStyleToLabel?o.label.strokeColor=e.selectedStyle.markerColor:o.label.strokeColor="#000000"}else o.label={highlight:!1},e.labelHasLatex&&(o.label.useMathJax=!0);b?o.showInfoBox=!1:o.showInfoBox=e.showCoordsWhenDragging;let p=[e.numericalXs[0],e.numericalXs[1]];Number.isFinite(p[0])||(p[0]=0,o.visible=!1),Number.isFinite(p[1])||(p[1]=0,o.visible=!1);let m={...o};m.fixed=b,m.showInfoBox=!1,m.withlabel=!1,m.fillOpacity=0,m.strokeOpacity=0;let d=s.create("point",p,m),y=s.create("point",p,o);d.on("down",function(i){S.current=[i.x,i.y],X.current=[...d.coords.scrCoords],C.current=!1,r.current.visProp.fillopacity=t.current.visProp.fillopacity,r.current.visProp.strokeopacity=t.current.visProp.strokeopacity,g({action:v.mouseDownOnPoint})}),d.on("up",function(i){C.current?g({action:v.movePoint,args:{x:k.current,y:w.current}}):e.switchable&&!e.fixed?(g({action:v.switchPoint}),g({action:v.pointClicked})):g({action:v.pointClicked}),C.current=!1,r.current.visProp.fillopacity=0,r.current.visProp.strokeopacity=0}),d.on("drag",function(i){var n=s.origin.scrCoords;let[l,c,u,Y]=s.getBoundingBox();k.current=(X.current[1]+i.x-S.current[0]-n[1])/s.unitX,k.current=Math.min(u,Math.max(l,k.current)),w.current=(n[2]-(X.current[2]+i.y-S.current[1]))/s.unitY,w.current=Math.min(c,Math.max(Y,w.current)),g({action:v.movePoint,args:{x:k.current,y:w.current,transient:!0,skippable:!0}}),y.coords.setCoordinates(JXG.COORDS_BY_USER,L.current),s.updateInfobox(y),(Math.abs(i.x-S.current[0])>.1||Math.abs(i.y-S.current[1])>.1)&&(C.current=!0)}),t.current=y,r.current=d,J.current=e.labelPosition,G.current=h}if(s){if(t.current===null)j();else{let x=R?"var(--canvas)":e.selectedStyle.markerColor,O=R?e.selectedStyle.markerColor:"none";t.current.visProp.fillcolor!==x&&(t.current.visProp.fillcolor=x);let b=(M=e.numericalXs)==null?void 0:M[0],h=(D=e.numericalXs)==null?void 0:D[1];t.current.coords.setCoordinates(JXG.COORDS_BY_USER,[b,h]),C.current||r.current.coords.setCoordinates(JXG.COORDS_BY_USER,[b,h]);let o=!e.hidden;if(Number.isFinite(b)&&Number.isFinite(h)){let l=t.current.visProp.visible!==o;t.current.visProp.visible=o,t.current.visPropCalc.visible=o,r.current.visProp.visible=o,r.current.visPropCalc.visible=o,l&&(t.current.setAttribute({visible:o}),r.current.setAttribute({visible:o}))}else t.current.visProp.visible=!1,t.current.visPropCalc.visible=!1,r.current.visProp.visible=!1,r.current.visPropCalc.visible=!1;let p=10*e.layer+E;t.current.visProp.layer!==p&&(t.current.setAttribute({layer:p}),r.current.setAttribute({layer:p}));let d=!e.draggable||e.fixed;t.current.visProp.highlight=!d,r.current.visProp.highlight=!d,r.current.visProp.fixed=d,t.current.visProp.strokecolor!==O&&(t.current.visProp.strokecolor=O,r.current.visProp.strokecolor=O,t.current.visProp.fillColor=x,r.current.visProp.fillColor=x),t.current.visProp.strokeopacity!==e.selectedStyle.lineOpacity&&(t.current.visProp.strokeopacity=e.selectedStyle.lineOpacity,t.current.visProp.fillopacity=e.selectedStyle.lineOpacity);let y=I(e.selectedStyle.markerStyle);t.current.visProp.face!==y&&(t.current.setAttribute({face:y}),r.current.setAttribute({face:y}));let i=U(e.selectedStyle.markerSize,e.selectedStyle.markerStyle);t.current.visProp.size!==i&&(t.current.setAttribute({size:i}),r.current.setAttribute({size:i})),d?t.current.visProp.showinfobox=!1:t.current.visProp.showinfobox=e.showCoordsWhenDragging,B.sourceInformation&&_ in B.sourceInformation&&s.updateInfobox(t.current),t.current.name=e.labelForGraph;let n=e.showLabel&&e.labelForGraph!=="";if(n!=G.current&&(t.current.setAttribute({withlabel:n}),G.current=n),t.current.hasLabel)if(t.current.label.needsUpdate=!0,e.applyStyleToLabel?t.current.label.visProp.strokecolor=e.selectedStyle.markerColor:t.current.label.visProp.strokecolor="#000000",e.labelPosition!==J.current){let l,c,u;e.labelPosition==="upperright"?(u=[5,5],l="left",c="bottom"):e.labelPosition==="upperleft"?(u=[-5,5],l="right",c="bottom"):e.labelPosition==="lowerright"?(u=[5,-5],l="left",c="top"):e.labelPosition==="lowerleft"?(u=[-5,-5],l="right",c="top"):e.labelPosition==="top"?(u=[0,10],l="middle",c="bottom"):e.labelPosition==="bottom"?(u=[0,-10],l="middle",c="top"):e.labelPosition==="left"?(u=[-10,0],l="right",c="middle"):(u=[10,0],l="left",c="middle"),t.current.label.visProp.anchorx=l,t.current.label.visProp.anchory=c,t.current.label.visProp.offset=u,J.current=e.labelPosition,t.current.label.fullUpdate()}else t.current.label.update();t.current.needsUpdate=!0,t.current.update(),r.current.needsUpdate=!0,r.current.update(),s.updateRenderer()}return A("a",{name:F})}if(e.hidden)return null;let z="\\("+e.latex+"\\)";return V(W,{children:[A("a",{name:F}),A("span",{id:F,children:A(H.MathJax,{hideUntilTypeset:"first",inline:!0,dynamic:!0,children:z})})]})});function U(f,P){return P==="diamond"?f*1.4:P==="plus"?f*1.2:P==="square"?f*1.1:P.substring(0,8)==="triangle"?f*1.5:f}function I(f){return f==="triangle"?"triangleup":f}export{ee as default};
