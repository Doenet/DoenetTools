var EH=Object.create;var Kp=Object.defineProperty;var RH=Object.getOwnPropertyDescriptor;var xH=Object.getOwnPropertyNames;var VH=Object.getPrototypeOf,OH=Object.prototype.hasOwnProperty;var DH=(a,t,e)=>t in a?Kp(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var GR=a=>Kp(a,"__esModule",{value:!0});var Ee=(a,t)=>()=>(a&&(t=a(a=0)),t);var L=(a,t)=>()=>(t||a((t={exports:{}}).exports,t),t.exports),st=(a,t)=>{GR(a);for(var e in t)Kp(a,e,{get:t[e],enumerable:!0})},IH=(a,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of xH(t))!OH.call(a,r)&&r!=="default"&&Kp(a,r,{get:()=>t[r],enumerable:!(e=RH(t,r))||e.enumerable});return a},M=a=>IH(GR(Kp(a!=null?EH(VH(a)):{},"default",a&&a.__esModule&&"default"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var T=(a,t,e)=>(DH(a,typeof t!="symbol"?t+"":t,e),e);var N0=L((Jd,WR)=>{(function(a,t){typeof Jd=="object"?WR.exports=Jd=t():typeof define=="function"&&define.amd?define([],t):a.CryptoJS=t()})(Jd,function(){var a=a||function(t,e){var r=Object.create||function(){function h(){}return function(y){var b;return h.prototype=y,b=new h,h.prototype=null,b}}(),n={},i=n.lib={},s=i.Base=function(){return{extend:function(h){var y=r(this);return h&&y.mixIn(h),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var h=this.extend();return h.init.apply(h,arguments),h},init:function(){},mixIn:function(h){for(var y in h)h.hasOwnProperty(y)&&(this[y]=h[y]);h.hasOwnProperty("toString")&&(this.toString=h.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=i.WordArray=s.extend({init:function(h,y){h=this.words=h||[],y!=e?this.sigBytes=y:this.sigBytes=h.length*4},toString:function(h){return(h||u).stringify(this)},concat:function(h){var y=this.words,b=h.words,g=this.sigBytes,v=h.sigBytes;if(this.clamp(),g%4)for(var A=0;A<v;A++){var C=b[A>>>2]>>>24-A%4*8&255;y[g+A>>>2]|=C<<24-(g+A)%4*8}else for(var A=0;A<v;A+=4)y[g+A>>>2]=b[A>>>2];return this.sigBytes+=v,this},clamp:function(){var h=this.words,y=this.sigBytes;h[y>>>2]&=4294967295<<32-y%4*8,h.length=t.ceil(y/4)},clone:function(){var h=s.clone.call(this);return h.words=this.words.slice(0),h},random:function(h){for(var y=[],b=function(C){var C=C,S=987654321,w=4294967295;return function(){S=36969*(S&65535)+(S>>16)&w,C=18e3*(C&65535)+(C>>16)&w;var x=(S<<16)+C&w;return x/=4294967296,x+=.5,x*(t.random()>.5?1:-1)}},g=0,v;g<h;g+=4){var A=b((v||t.random())*4294967296);v=A()*987654071,y.push(A()*4294967296|0)}return new o.init(y,h)}}),l=n.enc={},u=l.Hex={stringify:function(h){for(var y=h.words,b=h.sigBytes,g=[],v=0;v<b;v++){var A=y[v>>>2]>>>24-v%4*8&255;g.push((A>>>4).toString(16)),g.push((A&15).toString(16))}return g.join("")},parse:function(h){for(var y=h.length,b=[],g=0;g<y;g+=2)b[g>>>3]|=parseInt(h.substr(g,2),16)<<24-g%8*4;return new o.init(b,y/2)}},c=l.Latin1={stringify:function(h){for(var y=h.words,b=h.sigBytes,g=[],v=0;v<b;v++){var A=y[v>>>2]>>>24-v%4*8&255;g.push(String.fromCharCode(A))}return g.join("")},parse:function(h){for(var y=h.length,b=[],g=0;g<y;g++)b[g>>>2]|=(h.charCodeAt(g)&255)<<24-g%4*8;return new o.init(b,y)}},p=l.Utf8={stringify:function(h){try{return decodeURIComponent(escape(c.stringify(h)))}catch(y){throw new Error("Malformed UTF-8 data")}},parse:function(h){return c.parse(unescape(encodeURIComponent(h)))}},m=i.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(h){typeof h=="string"&&(h=p.parse(h)),this._data.concat(h),this._nDataBytes+=h.sigBytes},_process:function(h){var y=this._data,b=y.words,g=y.sigBytes,v=this.blockSize,A=v*4,C=g/A;h?C=t.ceil(C):C=t.max((C|0)-this._minBufferSize,0);var S=C*v,w=t.min(S*4,g);if(S){for(var x=0;x<S;x+=v)this._doProcessBlock(b,x);var R=b.splice(0,S);y.sigBytes-=w}return new o.init(R,w)},clone:function(){var h=s.clone.call(this);return h._data=this._data.clone(),h},_minBufferSize:0}),f=i.Hasher=m.extend({cfg:s.extend(),init:function(h){this.cfg=this.cfg.extend(h),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(h){return this._append(h),this._process(),this},finalize:function(h){h&&this._append(h);var y=this._doFinalize();return y},blockSize:512/32,_createHelper:function(h){return function(y,b){return new h.init(b).finalize(y)}},_createHmacHelper:function(h){return function(y,b){return new d.HMAC.init(h,b).finalize(y)}}}),d=n.algo={};return n}(Math);return a})});var C0=L((Qd,$R)=>{(function(a,t){typeof Qd=="object"?$R.exports=Qd=t(N0()):typeof define=="function"&&define.amd?define(["./core"],t):t(a.CryptoJS)})(Qd,function(a){return function(){var t=a,e=t.lib,r=e.WordArray,n=e.Hasher,i=t.algo,s=[],o=i.SHA1=n.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(l,u){for(var c=this._hash.words,p=c[0],m=c[1],f=c[2],d=c[3],h=c[4],y=0;y<80;y++){if(y<16)s[y]=l[u+y]|0;else{var b=s[y-3]^s[y-8]^s[y-14]^s[y-16];s[y]=b<<1|b>>>31}var g=(p<<5|p>>>27)+h+s[y];y<20?g+=(m&f|~m&d)+1518500249:y<40?g+=(m^f^d)+1859775393:y<60?g+=(m&f|m&d|f&d)-1894007588:g+=(m^f^d)-899497514,h=d,d=f,f=m<<30|m>>>2,m=p,p=g}c[0]=c[0]+p|0,c[1]=c[1]+m|0,c[2]=c[2]+f|0,c[3]=c[3]+d|0,c[4]=c[4]+h|0},_doFinalize:function(){var l=this._data,u=l.words,c=this._nDataBytes*8,p=l.sigBytes*8;return u[p>>>5]|=128<<24-p%32,u[(p+64>>>9<<4)+14]=Math.floor(c/4294967296),u[(p+64>>>9<<4)+15]=c,l.sigBytes=u.length*4,this._process(),this._hash},clone:function(){var l=n.clone.call(this);return l._hash=this._hash.clone(),l}});t.SHA1=n._createHelper(o),t.HmacSHA1=n._createHmacHelper(o)}(),a.SHA1})});var A0=L((eh,KR)=>{(function(a,t){typeof eh=="object"?KR.exports=eh=t(N0()):typeof define=="function"&&define.amd?define(["./core"],t):t(a.CryptoJS)})(eh,function(a){return function(){var t=a,e=t.lib,r=e.WordArray,n=t.enc,i=n.Base64={stringify:function(o){var l=o.words,u=o.sigBytes,c=this._map;o.clamp();for(var p=[],m=0;m<u;m+=3)for(var f=l[m>>>2]>>>24-m%4*8&255,d=l[m+1>>>2]>>>24-(m+1)%4*8&255,h=l[m+2>>>2]>>>24-(m+2)%4*8&255,y=f<<16|d<<8|h,b=0;b<4&&m+b*.75<u;b++)p.push(c.charAt(y>>>6*(3-b)&63));var g=c.charAt(64);if(g)for(;p.length%4;)p.push(g);return p.join("")},parse:function(o){var l=o.length,u=this._map,c=this._reverseMap;if(!c){c=this._reverseMap=[];for(var p=0;p<u.length;p++)c[u.charCodeAt(p)]=p}var m=u.charAt(64);if(m){var f=o.indexOf(m);f!==-1&&(l=f)}return s(o,l,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function s(o,l,u){for(var c=[],p=0,m=0;m<l;m++)if(m%4){var f=u[o.charCodeAt(m-1)]<<m%4*2,d=u[o.charCodeAt(m)]>>>6-m%4*2;c[p>>>2]|=(f|d)<<24-p%4*8,p++}return r.create(c,p)}}(),a.enc.Base64})});var Xx=L((jOe,Kx)=>{Kx.exports={space:"",cycles:!1,replacer:(a,t)=>t,stringify:JSON.stringify}});var Ts=L((MOe,Yx)=>{"use strict";Yx.exports={isArray:Array.isArray,assign:Object.assign,isObject:a=>typeof a=="object",isFunction:a=>typeof a=="function",isBoolean:a=>typeof a=="boolean",isRegex:a=>a instanceof RegExp,keys:Object.keys}});var Jx=L((BOe,Zx)=>{"use strict";var Am=Xx(),Eq=Ts().isFunction,Rq=Ts().isBoolean,xq=Ts().isObject,Vq=Ts().isArray,Oq=Ts().isRegex,Dq=Ts().assign,Iq=Ts().keys;function Pq(a){return a==null?a:Oq(a)?a.toString():a.toJSON?a.toJSON():a}function _q(a,t){t=t||Dq({},Am),Eq(t)&&(t={compare:t});let e=t.space||Am.space,r=Rq(t.cycles)?t.cycles:Am.cycles,n=t.replacer||Am.replacer,i=t.stringify||Am.stringify,s=t.compare&&function(l){return function(u){return function(c,p){let m={key:c,value:u[c]},f={key:p,value:u[p]};return l(m,f)}}}(t.compare);r||i(a);let o=[];return function l(u,c,p,m){let f=e?`
`+new Array(m+1).join(e):"",d=e?": ":":";if(p=Pq(p),p=n.call(u,c,p),p!==void 0){if(!xq(p)||p===null)return i(p);if(Vq(p)){let h=[];for(let y=0;y<p.length;y++){let b=l(p,y,p[y],m+1)||i(null);h.push(f+e+b)}return"["+h.join(",")+f+"]"}else{if(r){if(o.indexOf(p)!==-1)return i("[Circular]");o.push(p)}let h=Iq(p).sort(s&&s(p)),y=[];for(let b=0;b<h.length;b++){let g=h[b],v=l(p,g,p[g],m+1);if(!v)continue;let A=i(g)+d+v;y.push(f+e+A)}return o.splice(o.indexOf(p),1),"{"+y.join(",")+f+"}"}}}({"":a},"",a,0)}Zx.exports=_q});var pe=L((nIe,aV)=>{var Qh=function(a){return a&&a.Math==Math&&a};aV.exports=Qh(typeof globalThis=="object"&&globalThis)||Qh(typeof window=="object"&&window)||Qh(typeof self=="object"&&self)||Qh(typeof global=="object"&&global)||function(){return this}()||Function("return this")()});var De=L((aIe,iV)=>{iV.exports=function(a){try{return!!a()}catch(t){return!0}}});var sr=L((iIe,sV)=>{var zq=De();sV.exports=!zq(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})});var Uu=L((sIe,oV)=>{var Gq=De();oV.exports=!Gq(function(){var a=function(){}.bind();return typeof a!="function"||a.hasOwnProperty("prototype")})});var Br=L((oIe,lV)=>{var Hq=Uu(),ey=Function.prototype.call;lV.exports=Hq?ey.bind(ey):function(){return ey.apply(ey,arguments)}});var _m=L(pV=>{"use strict";var uV={}.propertyIsEnumerable,cV=Object.getOwnPropertyDescriptor,qq=cV&&!uV.call({1:2},1);pV.f=qq?function(t){var e=cV(this,t);return!!e&&e.enumerable}:uV});var zu=L((uIe,mV)=>{mV.exports=function(a,t){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:t}}});var Ne=L((cIe,hV)=>{var fV=Uu(),dV=Function.prototype,Wq=dV.bind,IT=dV.call,$q=fV&&Wq.bind(IT,IT);hV.exports=fV?function(a){return a&&$q(a)}:function(a){return a&&function(){return IT.apply(a,arguments)}}});var Ei=L((pIe,bV)=>{var yV=Ne(),Kq=yV({}.toString),Xq=yV("".slice);bV.exports=function(a){return Xq(Kq(a),8,-1)}});var Gu=L((mIe,gV)=>{var Yq=pe(),Zq=Ne(),Jq=De(),Qq=Ei(),PT=Yq.Object,eW=Zq("".split);gV.exports=Jq(function(){return!PT("z").propertyIsEnumerable(0)})?function(a){return Qq(a)=="String"?eW(a,""):PT(a)}:PT});var Gn=L((fIe,vV)=>{var tW=pe(),rW=tW.TypeError;vV.exports=function(a){if(a==null)throw rW("Can't call method on "+a);return a}});var Hn=L((dIe,TV)=>{var nW=Gu(),aW=Gn();TV.exports=function(a){return nW(aW(a))}});var It=L((hIe,NV)=>{NV.exports=function(a){return typeof a=="function"}});var zt=L((yIe,CV)=>{var iW=It();CV.exports=function(a){return typeof a=="object"?a!==null:iW(a)}});var Ri=L((bIe,AV)=>{var _T=pe(),sW=It(),oW=function(a){return sW(a)?a:void 0};AV.exports=function(a,t){return arguments.length<2?oW(_T[a]):_T[a]&&_T[a][t]}});var xi=L((gIe,SV)=>{var lW=Ne();SV.exports=lW({}.isPrototypeOf)});var Hu=L((vIe,wV)=>{var uW=Ri();wV.exports=uW("navigator","userAgent")||""});var qu=L((TIe,DV)=>{var EV=pe(),kT=Hu(),RV=EV.process,xV=EV.Deno,VV=RV&&RV.versions||xV&&xV.version,OV=VV&&VV.v8,da,ty;OV&&(da=OV.split("."),ty=da[0]>0&&da[0]<4?1:+(da[0]+da[1]));!ty&&kT&&(da=kT.match(/Edge\/(\d+)/),(!da||da[1]>=74)&&(da=kT.match(/Chrome\/(\d+)/),da&&(ty=+da[1])));DV.exports=ty});var ry=L((NIe,PV)=>{var IV=qu(),cW=De();PV.exports=!!Object.getOwnPropertySymbols&&!cW(function(){var a=Symbol();return!String(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&IV&&IV<41})});var FT=L((CIe,_V)=>{var pW=ry();_V.exports=pW&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var km=L((AIe,kV)=>{var mW=pe(),fW=Ri(),dW=It(),hW=xi(),yW=FT(),bW=mW.Object;kV.exports=yW?function(a){return typeof a=="symbol"}:function(a){var t=fW("Symbol");return dW(t)&&hW(t.prototype,bW(a))}});var Fm=L((SIe,FV)=>{var gW=pe(),vW=gW.String;FV.exports=function(a){try{return vW(a)}catch(t){return"Object"}}});var _o=L((wIe,jV)=>{var TW=pe(),NW=It(),CW=Fm(),AW=TW.TypeError;jV.exports=function(a){if(NW(a))return a;throw AW(CW(a)+" is not a function")}});var Wu=L((EIe,MV)=>{var SW=_o();MV.exports=function(a,t){var e=a[t];return e==null?void 0:SW(e)}});var LV=L((RIe,BV)=>{var wW=pe(),jT=Br(),MT=It(),BT=zt(),EW=wW.TypeError;BV.exports=function(a,t){var e,r;if(t==="string"&&MT(e=a.toString)&&!BT(r=jT(e,a))||MT(e=a.valueOf)&&!BT(r=jT(e,a))||t!=="string"&&MT(e=a.toString)&&!BT(r=jT(e,a)))return r;throw EW("Can't convert object to primitive value")}});var Es=L((xIe,UV)=>{UV.exports=!1});var ny=L((VIe,GV)=>{var zV=pe(),RW=Object.defineProperty;GV.exports=function(a,t){try{RW(zV,a,{value:t,configurable:!0,writable:!0})}catch(e){zV[a]=t}return t}});var ay=L((OIe,qV)=>{var xW=pe(),VW=ny(),HV="__core-js_shared__",OW=xW[HV]||VW(HV,{});qV.exports=OW});var jm=L((DIe,$V)=>{var DW=Es(),WV=ay();($V.exports=function(a,t){return WV[a]||(WV[a]=t!==void 0?t:{})})("versions",[]).push({version:"3.21.1",mode:DW?"pure":"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"})});var Yr=L((IIe,KV)=>{var IW=pe(),PW=Gn(),_W=IW.Object;KV.exports=function(a){return _W(PW(a))}});var or=L((PIe,XV)=>{var kW=Ne(),FW=Yr(),jW=kW({}.hasOwnProperty);XV.exports=Object.hasOwn||function(t,e){return jW(FW(t),e)}});var Mm=L((_Ie,YV)=>{var MW=Ne(),BW=0,LW=Math.random(),UW=MW(1 .toString);YV.exports=function(a){return"Symbol("+(a===void 0?"":a)+")_"+UW(++BW+LW,36)}});var ct=L((kIe,tO)=>{var zW=pe(),GW=jm(),ZV=or(),HW=Mm(),JV=ry(),QV=FT(),$u=GW("wks"),ko=zW.Symbol,eO=ko&&ko.for,qW=QV?ko:ko&&ko.withoutSetter||HW;tO.exports=function(a){if(!ZV($u,a)||!(JV||typeof $u[a]=="string")){var t="Symbol."+a;JV&&ZV(ko,a)?$u[a]=ko[a]:QV&&eO?$u[a]=eO(t):$u[a]=qW(t)}return $u[a]}});var LT=L((FIe,aO)=>{var WW=pe(),$W=Br(),rO=zt(),nO=km(),KW=Wu(),XW=LV(),YW=ct(),ZW=WW.TypeError,JW=YW("toPrimitive");aO.exports=function(a,t){if(!rO(a)||nO(a))return a;var e=KW(a,JW),r;if(e){if(t===void 0&&(t="default"),r=$W(e,a,t),!rO(r)||nO(r))return r;throw ZW("Can't convert object to primitive value")}return t===void 0&&(t="number"),XW(a,t)}});var Bm=L((jIe,iO)=>{var QW=LT(),e$=km();iO.exports=function(a){var t=QW(a,"string");return e$(t)?t:t+""}});var iy=L((MIe,oO)=>{var t$=pe(),sO=zt(),UT=t$.document,r$=sO(UT)&&sO(UT.createElement);oO.exports=function(a){return r$?UT.createElement(a):{}}});var zT=L((BIe,lO)=>{var n$=sr(),a$=De(),i$=iy();lO.exports=!n$&&!a$(function(){return Object.defineProperty(i$("div"),"a",{get:function(){return 7}}).a!=7})});var Vi=L(cO=>{var s$=sr(),o$=Br(),l$=_m(),u$=zu(),c$=Hn(),p$=Bm(),m$=or(),f$=zT(),uO=Object.getOwnPropertyDescriptor;cO.f=s$?uO:function(t,e){if(t=c$(t),e=p$(e),f$)try{return uO(t,e)}catch(r){}if(m$(t,e))return u$(!o$(l$.f,t,e),t[e])}});var GT=L((UIe,pO)=>{var d$=sr(),h$=De();pO.exports=d$&&h$(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})});var Wt=L((zIe,fO)=>{var mO=pe(),y$=zt(),b$=mO.String,g$=mO.TypeError;fO.exports=function(a){if(y$(a))return a;throw g$(b$(a)+" is not an object")}});var Er=L(hO=>{var v$=pe(),T$=sr(),N$=zT(),C$=GT(),sy=Wt(),dO=Bm(),A$=v$.TypeError,HT=Object.defineProperty,S$=Object.getOwnPropertyDescriptor,qT="enumerable",WT="configurable",$T="writable";hO.f=T$?C$?function(t,e,r){if(sy(t),e=dO(e),sy(r),typeof t=="function"&&e==="prototype"&&"value"in r&&$T in r&&!r[$T]){var n=S$(t,e);n&&n[$T]&&(t[e]=r.value,r={configurable:WT in r?r[WT]:n[WT],enumerable:qT in r?r[qT]:n[qT],writable:!1})}return HT(t,e,r)}:HT:function(t,e,r){if(sy(t),e=dO(e),sy(r),N$)try{return HT(t,e,r)}catch(n){}if("get"in r||"set"in r)throw A$("Accessors not supported");return"value"in r&&(t[e]=r.value),t}});var Oi=L((HIe,yO)=>{var w$=sr(),E$=Er(),R$=zu();yO.exports=w$?function(a,t,e){return E$.f(a,t,R$(1,e))}:function(a,t,e){return a[t]=e,a}});var oy=L((qIe,bO)=>{var x$=Ne(),V$=It(),KT=ay(),O$=x$(Function.toString);V$(KT.inspectSource)||(KT.inspectSource=function(a){return O$(a)});bO.exports=KT.inspectSource});var XT=L((WIe,vO)=>{var D$=pe(),I$=It(),P$=oy(),gO=D$.WeakMap;vO.exports=I$(gO)&&/native code/.test(P$(gO))});var Lm=L(($Ie,NO)=>{var _$=jm(),k$=Mm(),TO=_$("keys");NO.exports=function(a){return TO[a]||(TO[a]=k$(a))}});var Ku=L((KIe,CO)=>{CO.exports={}});var Xa=L((XIe,RO)=>{var F$=XT(),AO=pe(),YT=Ne(),j$=zt(),M$=Oi(),ZT=or(),JT=ay(),B$=Lm(),L$=Ku(),SO="Object already initialized",QT=AO.TypeError,U$=AO.WeakMap,ly,Um,uy,z$=function(a){return uy(a)?Um(a):ly(a,{})},G$=function(a){return function(t){var e;if(!j$(t)||(e=Um(t)).type!==a)throw QT("Incompatible receiver, "+a+" required");return e}};F$||JT.state?(Rs=JT.state||(JT.state=new U$),wO=YT(Rs.get),eN=YT(Rs.has),EO=YT(Rs.set),ly=function(a,t){if(eN(Rs,a))throw new QT(SO);return t.facade=a,EO(Rs,a,t),t},Um=function(a){return wO(Rs,a)||{}},uy=function(a){return eN(Rs,a)}):(Fo=B$("state"),L$[Fo]=!0,ly=function(a,t){if(ZT(a,Fo))throw new QT(SO);return t.facade=a,M$(a,Fo,t),t},Um=function(a){return ZT(a,Fo)?a[Fo]:{}},uy=function(a){return ZT(a,Fo)});var Rs,wO,eN,EO,Fo;RO.exports={set:ly,get:Um,has:uy,enforce:z$,getterFor:G$}});var Xu=L((YIe,VO)=>{var tN=sr(),H$=or(),xO=Function.prototype,q$=tN&&Object.getOwnPropertyDescriptor,rN=H$(xO,"name"),W$=rN&&function(){}.name==="something",$$=rN&&(!tN||tN&&q$(xO,"name").configurable);VO.exports={EXISTS:rN,PROPER:W$,CONFIGURABLE:$$}});var qn=L((ZIe,PO)=>{var K$=pe(),OO=It(),X$=or(),DO=Oi(),Y$=ny(),Z$=oy(),IO=Xa(),J$=Xu().CONFIGURABLE,Q$=IO.get,eK=IO.enforce,tK=String(String).split("String");(PO.exports=function(a,t,e,r){var n=r?!!r.unsafe:!1,i=r?!!r.enumerable:!1,s=r?!!r.noTargetGet:!1,o=r&&r.name!==void 0?r.name:t,l;if(OO(e)&&(String(o).slice(0,7)==="Symbol("&&(o="["+String(o).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!X$(e,"name")||J$&&e.name!==o)&&DO(e,"name",o),l=eK(e),l.source||(l.source=tK.join(typeof o=="string"?o:""))),a===K$){i?a[t]=e:Y$(t,e);return}else n?!s&&a[t]&&(i=!0):delete a[t];i?a[t]=e:DO(a,t,e)})(Function.prototype,"toString",function(){return OO(this)&&Q$(this).source||Z$(this)})});var xs=L((JIe,_O)=>{var rK=Math.ceil,nK=Math.floor;_O.exports=function(a){var t=+a;return t!==t||t===0?0:(t>0?nK:rK)(t)}});var jo=L((QIe,kO)=>{var aK=xs(),iK=Math.max,sK=Math.min;kO.exports=function(a,t){var e=aK(a);return e<0?iK(e+t,0):sK(e,t)}});var Mo=L((e3e,FO)=>{var oK=xs(),lK=Math.min;FO.exports=function(a){return a>0?lK(oK(a),9007199254740991):0}});var Wn=L((t3e,jO)=>{var uK=Mo();jO.exports=function(a){return uK(a.length)}});var nN=L((r3e,BO)=>{var cK=Hn(),pK=jo(),mK=Wn(),MO=function(a){return function(t,e,r){var n=cK(t),i=mK(n),s=pK(r,i),o;if(a&&e!=e){for(;i>s;)if(o=n[s++],o!=o)return!0}else for(;i>s;s++)if((a||s in n)&&n[s]===e)return a||s||0;return!a&&-1}};BO.exports={includes:MO(!0),indexOf:MO(!1)}});var iN=L((n3e,UO)=>{var fK=Ne(),aN=or(),dK=Hn(),hK=nN().indexOf,yK=Ku(),LO=fK([].push);UO.exports=function(a,t){var e=dK(a),r=0,n=[],i;for(i in e)!aN(yK,i)&&aN(e,i)&&LO(n,i);for(;t.length>r;)aN(e,i=t[r++])&&(~hK(n,i)||LO(n,i));return n}});var cy=L((a3e,zO)=>{zO.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var Bo=L(GO=>{var bK=iN(),gK=cy(),vK=gK.concat("length","prototype");GO.f=Object.getOwnPropertyNames||function(t){return bK(t,vK)}});var py=L(HO=>{HO.f=Object.getOwnPropertySymbols});var WO=L((o3e,qO)=>{var TK=Ri(),NK=Ne(),CK=Bo(),AK=py(),SK=Wt(),wK=NK([].concat);qO.exports=TK("Reflect","ownKeys")||function(t){var e=CK.f(SK(t)),r=AK.f;return r?wK(e,r(t)):e}});var sN=L((l3e,KO)=>{var $O=or(),EK=WO(),RK=Vi(),xK=Er();KO.exports=function(a,t,e){for(var r=EK(t),n=xK.f,i=RK.f,s=0;s<r.length;s++){var o=r[s];!$O(a,o)&&!(e&&$O(e,o))&&n(a,o,i(t,o))}}});var Gm=L((u3e,XO)=>{var VK=De(),OK=It(),DK=/#|\.prototype\./,zm=function(a,t){var e=PK[IK(a)];return e==kK?!0:e==_K?!1:OK(t)?VK(t):!!t},IK=zm.normalize=function(a){return String(a).replace(DK,".").toLowerCase()},PK=zm.data={},_K=zm.NATIVE="N",kK=zm.POLYFILL="P";XO.exports=zm});var he=L((c3e,YO)=>{var oN=pe(),FK=Vi().f,jK=Oi(),MK=qn(),BK=ny(),LK=sN(),UK=Gm();YO.exports=function(a,t){var e=a.target,r=a.global,n=a.stat,i,s,o,l,u,c;if(r?s=oN:n?s=oN[e]||BK(e,{}):s=(oN[e]||{}).prototype,s)for(o in t){if(u=t[o],a.noTargetGet?(c=FK(s,o),l=c&&c.value):l=s[o],i=UK(r?o:e+(n?".":"#")+o,a.forced),!i&&l!==void 0){if(typeof u==typeof l)continue;LK(u,l)}(a.sham||l&&l.sham)&&jK(u,"sham",!0),MK(s,o,u,a)}}});var lN=L((p3e,ZO)=>{var zK=De();ZO.exports=!zK(function(){function a(){}return a.prototype.constructor=null,Object.getPrototypeOf(new a)!==a.prototype})});var Hm=L((m3e,QO)=>{var GK=pe(),HK=or(),qK=It(),WK=Yr(),$K=Lm(),KK=lN(),JO=$K("IE_PROTO"),uN=GK.Object,XK=uN.prototype;QO.exports=KK?uN.getPrototypeOf:function(a){var t=WK(a);if(HK(t,JO))return t[JO];var e=t.constructor;return qK(e)&&t instanceof e?e.prototype:t instanceof uN?XK:null}});var Yu=L((d3e,tD)=>{"use strict";var tX=Bm(),rX=Er(),nX=zu();tD.exports=function(a,t,e){var r=tX(t);r in a?rX.f(a,r,nX(0,e)):a[r]=e}});var my=L((h3e,nD)=>{var aX=pe(),rD=jo(),iX=Wn(),sX=Yu(),oX=aX.Array,lX=Math.max;nD.exports=function(a,t,e){for(var r=iX(a),n=rD(t,r),i=rD(e===void 0?r:e,r),s=oX(lX(i-n,0)),o=0;n<i;n++,o++)sX(s,o,a[n]);return s.length=o,s}});var fy=L((y3e,sD)=>{var uX=Ei(),cX=Hn(),aD=Bo().f,pX=my(),iD=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],mX=function(a){try{return aD(a)}catch(t){return pX(iD)}};sD.exports.f=function(t){return iD&&uX(t)=="Window"?mX(t):aD(cX(t))}});var dy=L((g3e,lD)=>{var bX=ct(),gX=bX("toStringTag"),oD={};oD[gX]="z";lD.exports=String(oD)==="[object z]"});var qm=L((v3e,uD)=>{var vX=pe(),TX=dy(),NX=It(),hy=Ei(),CX=ct(),AX=CX("toStringTag"),SX=vX.Object,wX=hy(function(){return arguments}())=="Arguments",EX=function(a,t){try{return a[t]}catch(e){}};uD.exports=TX?hy:function(a){var t,e,r;return a===void 0?"Undefined":a===null?"Null":typeof(e=EX(t=SX(a),AX))=="string"?e:wX?hy(t):(r=hy(t))=="Object"&&NX(t.callee)?"Arguments":r}});var Rr=L((T3e,cD)=>{var RX=pe(),xX=qm(),VX=RX.String;cD.exports=function(a){if(xX(a)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return VX(a)}});var yy=L((N3e,pD)=>{var OX=zt(),DX=Ei(),IX=ct(),PX=IX("match");pD.exports=function(a){var t;return OX(a)&&((t=a[PX])!==void 0?!!t:DX(a)=="RegExp")}});var by=L((C3e,mD)=>{var _X=pe(),kX=yy(),FX=_X.TypeError;mD.exports=function(a){if(kX(a))throw FX("The method doesn't accept regular expressions");return a}});var gy=L((A3e,fD)=>{var jX=ct(),MX=jX("match");fD.exports=function(a){var t=/./;try{"/./"[a](t)}catch(e){try{return t[MX]=!1,"/./"[a](t)}catch(r){}}return!1}});var vD=L((w3e,gD)=>{"use strict";var XX=dy(),YX=qm();gD.exports=XX?{}.toString:function(){return"[object "+YX(this)+"]"}});var Wm=L((R3e,AD)=>{var eY=Uu(),TD=Function.prototype,ND=TD.apply,CD=TD.call;AD.exports=typeof Reflect=="object"&&Reflect.apply||(eY?CD.bind(ND):function(){return CD.apply(ND,arguments)})});var vy=L((x3e,SD)=>{var tY=Ne();SD.exports=tY([].slice)});var VD=L((V3e,xD)=>{"use strict";var rY=pe(),wD=Ne(),nY=_o(),aY=zt(),iY=or(),ED=vy(),sY=Uu(),RD=rY.Function,oY=wD([].concat),lY=wD([].join),cN={},uY=function(a,t,e){if(!iY(cN,t)){for(var r=[],n=0;n<t;n++)r[n]="a["+n+"]";cN[t]=RD("C,a","return new C("+lY(r,",")+")")}return cN[t](a,e)};xD.exports=sY?RD.bind:function(t){var e=nY(this),r=e.prototype,n=ED(arguments,1),i=function(){var o=oY(n,ED(arguments));return this instanceof i?uY(e,o.length,o):e.apply(t,o)};return aY(r)&&(i.prototype=r),i}});var Km=L((O3e,_D)=>{var cY=Ne(),pY=De(),OD=It(),mY=qm(),fY=Ri(),dY=oy(),DD=function(){},hY=[],ID=fY("Reflect","construct"),pN=/^\s*(?:class|function)\b/,yY=cY(pN.exec),bY=!pN.exec(DD),$m=function(t){if(!OD(t))return!1;try{return ID(DD,hY,t),!0}catch(e){return!1}},PD=function(t){if(!OD(t))return!1;switch(mY(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return bY||!!yY(pN,dY(t))}catch(e){return!0}};PD.sham=!0;_D.exports=!ID||pY(function(){var a;return $m($m.call)||!$m(Object)||!$m(function(){a=!0})||a})?PD:$m});var mN=L((D3e,kD)=>{var gY=pe(),vY=Km(),TY=Fm(),NY=gY.TypeError;kD.exports=function(a){if(vY(a))return a;throw NY(TY(a)+" is not a constructor")}});var Zu=L((I3e,FD)=>{var CY=iN(),AY=cy();FD.exports=Object.keys||function(t){return CY(t,AY)}});var fN=L(jD=>{var SY=sr(),wY=GT(),EY=Er(),RY=Wt(),xY=Hn(),VY=Zu();jD.f=SY&&!wY?Object.defineProperties:function(t,e){RY(t);for(var r=xY(e),n=VY(e),i=n.length,s=0,o;i>s;)EY.f(t,o=n[s++],r[o]);return t}});var BD=L((_3e,MD)=>{var OY=Ri();MD.exports=OY("document","documentElement")});var Vs=L((k3e,WD)=>{var DY=Wt(),IY=fN(),LD=cy(),PY=Ku(),_Y=BD(),kY=iy(),FY=Lm(),UD=">",zD="<",dN="prototype",hN="script",GD=FY("IE_PROTO"),yN=function(){},HD=function(a){return zD+hN+UD+a+zD+"/"+hN+UD},qD=function(a){a.write(HD("")),a.close();var t=a.parentWindow.Object;return a=null,t},jY=function(){var a=kY("iframe"),t="java"+hN+":",e;return a.style.display="none",_Y.appendChild(a),a.src=String(t),e=a.contentWindow.document,e.open(),e.write(HD("document.F=Object")),e.close(),e.F},Ty,Ny=function(){try{Ty=new ActiveXObject("htmlfile")}catch(t){}Ny=typeof document!="undefined"?document.domain&&Ty?qD(Ty):jY():qD(Ty);for(var a=LD.length;a--;)delete Ny[dN][LD[a]];return Ny()};PY[GD]=!0;WD.exports=Object.create||function(t,e){var r;return t!==null?(yN[dN]=DY(t),r=new yN,yN[dN]=null,r[GD]=t):r=Ny(),e===void 0?r:IY.f(r,e)}});var Ju=L((j3e,QD)=>{var qY=Ei();QD.exports=Array.isArray||function(t){return qY(t)=="Array"}});var Qu=L((M3e,e7)=>{var WY=De(),$Y=ct(),KY=qu(),XY=$Y("species");e7.exports=function(a){return KY>=51||!WY(function(){var t=[],e=t.constructor={};return e[XY]=function(){return{foo:1}},t[a](Boolean).foo!==1})}});var Xm=L((U3e,o7)=>{var s7=Ne(),hZ=_o(),yZ=Uu(),bZ=s7(s7.bind);o7.exports=function(a,t){return hZ(a),t===void 0?a:yZ?bZ(a,t):function(){return a.apply(t,arguments)}}});var TN=L((z3e,u7)=>{var gZ=Br(),l7=Wt(),vZ=Wu();u7.exports=function(a,t,e){var r,n;l7(a);try{if(r=vZ(a,"return"),!r){if(t==="throw")throw e;return e}r=gZ(r,a)}catch(i){n=!0,r=i}if(t==="throw")throw e;if(n)throw r;return l7(r),e}});var p7=L((G3e,c7)=>{var TZ=Wt(),NZ=TN();c7.exports=function(a,t,e,r){try{return r?t(TZ(e)[0],e[1]):t(e)}catch(n){NZ(a,"throw",n)}}});var ec=L((H3e,m7)=>{m7.exports={}});var NN=L((q3e,f7)=>{var CZ=ct(),AZ=ec(),SZ=CZ("iterator"),wZ=Array.prototype;f7.exports=function(a){return a!==void 0&&(AZ.Array===a||wZ[SZ]===a)}});var Cy=L((W3e,h7)=>{var EZ=qm(),d7=Wu(),RZ=ec(),xZ=ct(),VZ=xZ("iterator");h7.exports=function(a){if(a!=null)return d7(a,VZ)||d7(a,"@@iterator")||RZ[EZ(a)]}});var CN=L(($3e,y7)=>{var OZ=pe(),DZ=Br(),IZ=_o(),PZ=Wt(),_Z=Fm(),kZ=Cy(),FZ=OZ.TypeError;y7.exports=function(a,t){var e=arguments.length<2?kZ(a):t;if(IZ(e))return PZ(DZ(e,a));throw FZ(_Z(a)+" is not iterable")}});var T7=L((K3e,v7)=>{"use strict";var jZ=pe(),MZ=Xm(),BZ=Br(),LZ=Yr(),UZ=p7(),zZ=NN(),GZ=Km(),HZ=Wn(),b7=Yu(),qZ=CN(),WZ=Cy(),g7=jZ.Array;v7.exports=function(t){var e=LZ(t),r=GZ(this),n=arguments.length,i=n>1?arguments[1]:void 0,s=i!==void 0;s&&(i=MZ(i,n>2?arguments[2]:void 0));var o=WZ(e),l=0,u,c,p,m,f,d;if(o&&!(this==g7&&zZ(o)))for(m=qZ(e,o),f=m.next,c=r?new this:[];!(p=BZ(f,m)).done;l++)d=s?UZ(m,i,[p.value,l],!0):p.value,b7(c,l,d);else for(u=HZ(e),c=r?new this(u):g7(u);u>l;l++)d=s?i(e[l],l):e[l],b7(c,l,d);return c.length=l,c}});var SN=L((X3e,S7)=>{var $Z=ct(),N7=$Z("iterator"),C7=!1;try{A7=0,AN={next:function(){return{done:!!A7++}},return:function(){C7=!0}},AN[N7]=function(){return this},Array.from(AN,function(){throw 2})}catch(a){}var A7,AN;S7.exports=function(a,t){if(!t&&!C7)return!1;var e=!1;try{var r={};r[N7]=function(){return{next:function(){return{done:e=!0}}}},a(r)}catch(n){}return e}});var Ay=L((Z3e,R7)=>{var wN=Ne(),JZ=xs(),QZ=Rr(),eJ=Gn(),tJ=wN("".charAt),w7=wN("".charCodeAt),rJ=wN("".slice),E7=function(a){return function(t,e){var r=QZ(eJ(t)),n=JZ(e),i=r.length,s,o;return n<0||n>=i?a?"":void 0:(s=w7(r,n),s<55296||s>56319||n+1===i||(o=w7(r,n+1))<56320||o>57343?a?tJ(r,n):s:a?rJ(r,n,n+2):(s-55296<<10)+(o-56320)+65536)}};R7.exports={codeAt:E7(!1),charAt:E7(!0)}});var VN=L((J3e,O7)=>{"use strict";var nJ=De(),aJ=It(),iJ=Vs(),x7=Hm(),sJ=qn(),oJ=ct(),lJ=Es(),EN=oJ("iterator"),V7=!1,Di,RN,xN;[].keys&&(xN=[].keys(),"next"in xN?(RN=x7(x7(xN)),RN!==Object.prototype&&(Di=RN)):V7=!0);var uJ=Di==null||nJ(function(){var a={};return Di[EN].call(a)!==a});uJ?Di={}:lJ&&(Di=iJ(Di));aJ(Di[EN])||sJ(Di,EN,function(){return this});O7.exports={IteratorPrototype:Di,BUGGY_SAFARI_ITERATORS:V7}});var Ym=L((Q3e,I7)=>{var cJ=Er().f,pJ=or(),mJ=ct(),D7=mJ("toStringTag");I7.exports=function(a,t,e){a&&!e&&(a=a.prototype),a&&!pJ(a,D7)&&cJ(a,D7,{configurable:!0,value:t})}});var _7=L((e4e,P7)=>{"use strict";var fJ=VN().IteratorPrototype,dJ=Vs(),hJ=zu(),yJ=Ym(),bJ=ec(),gJ=function(){return this};P7.exports=function(a,t,e,r){var n=t+" Iterator";return a.prototype=dJ(fJ,{next:hJ(+!r,e)}),yJ(a,n,!1,!0),bJ[n]=gJ,a}});var j7=L((t4e,F7)=>{var k7=pe(),vJ=It(),TJ=k7.String,NJ=k7.TypeError;F7.exports=function(a){if(typeof a=="object"||vJ(a))return a;throw NJ("Can't set "+TJ(a)+" as a prototype")}});var ON=L((r4e,M7)=>{var CJ=Ne(),AJ=Wt(),SJ=j7();M7.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var a=!1,t={},e;try{e=CJ(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(t,[]),a=t instanceof Array}catch(r){}return function(n,i){return AJ(n),SJ(i),a?e(n,i):n.__proto__=i,n}}():void 0)});var Ey=L((n4e,K7)=>{"use strict";var wJ=he(),EJ=Br(),Sy=Es(),B7=Xu(),RJ=It(),xJ=_7(),L7=Hm(),U7=ON(),VJ=Ym(),OJ=Oi(),DN=qn(),DJ=ct(),z7=ec(),G7=VN(),IJ=B7.PROPER,PJ=B7.CONFIGURABLE,H7=G7.IteratorPrototype,wy=G7.BUGGY_SAFARI_ITERATORS,Zm=DJ("iterator"),q7="keys",Jm="values",W7="entries",$7=function(){return this};K7.exports=function(a,t,e,r,n,i,s){xJ(e,t,r);var o=function(b){if(b===n&&m)return m;if(!wy&&b in c)return c[b];switch(b){case q7:return function(){return new e(this,b)};case Jm:return function(){return new e(this,b)};case W7:return function(){return new e(this,b)}}return function(){return new e(this)}},l=t+" Iterator",u=!1,c=a.prototype,p=c[Zm]||c["@@iterator"]||n&&c[n],m=!wy&&p||o(n),f=t=="Array"&&c.entries||p,d,h,y;if(f&&(d=L7(f.call(new a)),d!==Object.prototype&&d.next&&(!Sy&&L7(d)!==H7&&(U7?U7(d,H7):RJ(d[Zm])||DN(d,Zm,$7)),VJ(d,l,!0,!0),Sy&&(z7[l]=$7))),IJ&&n==Jm&&p&&p.name!==Jm&&(!Sy&&PJ?OJ(c,"name",Jm):(u=!0,m=function(){return EJ(p,this)})),n)if(h={values:o(Jm),keys:i?m:o(q7),entries:o(W7)},s)for(y in h)(wy||u||!(y in c))&&DN(c,y,h[y]);else wJ({target:t,proto:!0,forced:wy||u},h);return(!Sy||s)&&c[Zm]!==m&&DN(c,Zm,m,{name:n}),z7[t]=m,h}});var Ry=L((i4e,Z7)=>{"use strict";var BJ=Wt();Z7.exports=function(){var a=BJ(this),t="";return a.global&&(t+="g"),a.ignoreCase&&(t+="i"),a.multiline&&(t+="m"),a.dotAll&&(t+="s"),a.unicode&&(t+="u"),a.sticky&&(t+="y"),t}});var xy=L((s4e,J7)=>{var IN=De(),LJ=pe(),PN=LJ.RegExp,_N=IN(function(){var a=PN("a","y");return a.lastIndex=2,a.exec("abcd")!=null}),UJ=_N||IN(function(){return!PN("a","y").sticky}),zJ=_N||IN(function(){var a=PN("^r","gy");return a.lastIndex=2,a.exec("str")!=null});J7.exports={BROKEN_CARET:zJ,MISSED_STICKY:UJ,UNSUPPORTED_Y:_N}});var kN=L((o4e,Q7)=>{var GJ=De(),HJ=pe(),qJ=HJ.RegExp;Q7.exports=GJ(function(){var a=qJ(".","s");return!(a.dotAll&&a.exec(`
`)&&a.flags==="s")})});var FN=L((l4e,eI)=>{var WJ=De(),$J=pe(),KJ=$J.RegExp;eI.exports=WJ(function(){var a=KJ("(?<a>b)","g");return a.exec("b").groups.a!=="b"||"b".replace(a,"$<a>c")!=="bc"})});var Qm=L((u4e,rI)=>{"use strict";var tc=Br(),Vy=Ne(),XJ=Rr(),YJ=Ry(),ZJ=xy(),JJ=jm(),QJ=Vs(),eQ=Xa().get,tQ=kN(),rQ=FN(),nQ=JJ("native-string-replace",String.prototype.replace),Oy=RegExp.prototype.exec,jN=Oy,aQ=Vy("".charAt),iQ=Vy("".indexOf),sQ=Vy("".replace),MN=Vy("".slice),BN=function(){var a=/a/,t=/b*/g;return tc(Oy,a,"a"),tc(Oy,t,"a"),a.lastIndex!==0||t.lastIndex!==0}(),tI=ZJ.BROKEN_CARET,LN=/()??/.exec("")[1]!==void 0,oQ=BN||LN||tI||tQ||rQ;oQ&&(jN=function(t){var e=this,r=eQ(e),n=XJ(t),i=r.raw,s,o,l,u,c,p,m;if(i)return i.lastIndex=e.lastIndex,s=tc(jN,i,n),e.lastIndex=i.lastIndex,s;var f=r.groups,d=tI&&e.sticky,h=tc(YJ,e),y=e.source,b=0,g=n;if(d&&(h=sQ(h,"y",""),iQ(h,"g")===-1&&(h+="g"),g=MN(n,e.lastIndex),e.lastIndex>0&&(!e.multiline||e.multiline&&aQ(n,e.lastIndex-1)!==`
`)&&(y="(?: "+y+")",g=" "+g,b++),o=new RegExp("^(?:"+y+")",h)),LN&&(o=new RegExp("^"+y+"$(?!\\s)",h)),BN&&(l=e.lastIndex),u=tc(Oy,d?o:e,g),d?u?(u.input=MN(u.input,b),u[0]=MN(u[0],b),u.index=e.lastIndex,e.lastIndex+=u[0].length):e.lastIndex=0:BN&&u&&(e.lastIndex=e.global?u.index+u[0].length:l),LN&&u&&u.length>1&&tc(nQ,u[0],o,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&f)for(u.groups=p=QJ(null),c=0;c<f.length;c++)m=f[c],p[m[0]]=u[m[1]];return u});rI.exports=jN});var ie=L(()=>{"use strict";var lQ=he(),nI=Qm();lQ({target:"RegExp",proto:!0,forced:/./.exec!==nI},{exec:nI})});var UN=L(aI=>{var uQ=ct();aI.f=uQ});var sI=L((f4e,iI)=>{var cQ=pe();iI.exports=cQ});var zN=L((d4e,lI)=>{var oI=sI(),pQ=or(),mQ=UN(),fQ=Er().f;lI.exports=function(a){var t=oI.Symbol||(oI.Symbol={});pQ(t,a)||fQ(t,a,{value:mQ.f(a)})}});var mI=L((h4e,pI)=>{var dQ=pe(),uI=Ju(),hQ=Km(),yQ=zt(),bQ=ct(),gQ=bQ("species"),cI=dQ.Array;pI.exports=function(a){var t;return uI(a)&&(t=a.constructor,hQ(t)&&(t===cI||uI(t.prototype))?t=void 0:yQ(t)&&(t=t[gQ],t===null&&(t=void 0))),t===void 0?cI:t}});var Dy=L((y4e,fI)=>{var vQ=mI();fI.exports=function(a,t){return new(vQ(a))(t===0?0:t)}});var Ds=L((b4e,hI)=>{var TQ=Xm(),NQ=Ne(),CQ=Gu(),AQ=Yr(),SQ=Wn(),wQ=Dy(),dI=NQ([].push),Os=function(a){var t=a==1,e=a==2,r=a==3,n=a==4,i=a==6,s=a==7,o=a==5||i;return function(l,u,c,p){for(var m=AQ(l),f=CQ(m),d=TQ(u,c),h=SQ(f),y=0,b=p||wQ,g=t?b(l,h):e||s?b(l,0):void 0,v,A;h>y;y++)if((o||y in f)&&(v=f[y],A=d(v,y,m),a))if(t)g[y]=A;else if(A)switch(a){case 3:return!0;case 5:return v;case 6:return y;case 2:dI(g,v)}else switch(a){case 4:return!1;case 7:dI(g,v)}return i?-1:r||n?n:g}};hI.exports={forEach:Os(0),map:Os(1),filter:Os(2),some:Os(3),every:Os(4),find:Os(5),findIndex:Os(6),filterReject:Os(7)}});var ac=L((N4e,zI)=>{var ree=ct(),nee=Vs(),aee=Er(),sC=ree("unscopables"),oC=Array.prototype;oC[sC]==null&&aee.f(oC,sC,{configurable:!0,value:nee(null)});zI.exports=function(a){oC[sC][a]=!0}});var q=L((C4e,$I)=>{"use strict";var iee=Hn(),lC=ac(),GI=ec(),HI=Xa(),see=Er().f,oee=Ey(),lee=Es(),uee=sr(),qI="Array Iterator",cee=HI.set,pee=HI.getterFor(qI);$I.exports=oee(Array,"Array",function(a,t){cee(this,{type:qI,target:iee(a),index:0,kind:t})},function(){var a=pee(this),t=a.target,e=a.kind,r=a.index++;return!t||r>=t.length?(a.target=void 0,{value:void 0,done:!0}):e=="keys"?{value:r,done:!1}:e=="values"?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");var WI=GI.Arguments=GI.Array;lC("keys");lC("values");lC("entries");if(!lee&&uee&&WI.name!=="values")try{see(WI,"name",{value:"values"})}catch(a){}});var uC=L((A4e,KI)=>{KI.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}});var pC=L((S4e,YI)=>{var mee=iy(),cC=mee("span").classList,XI=cC&&cC.constructor&&cC.constructor.prototype;YI.exports=XI===Object.prototype?void 0:XI});var i3=L((E4e,a3)=>{"use strict";var r3=sr(),dee=Ne(),hee=Br(),yee=De(),hC=Zu(),bee=py(),gee=_m(),vee=Yr(),Tee=Gu(),ic=Object.assign,n3=Object.defineProperty,Nee=dee([].concat);a3.exports=!ic||yee(function(){if(r3&&ic({b:1},ic(n3({},"a",{enumerable:!0,get:function(){n3(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var a={},t={},e=Symbol(),r="abcdefghijklmnopqrst";return a[e]=7,r.split("").forEach(function(n){t[n]=n}),ic({},a)[e]!=7||hC(ic({},t)).join("")!=r})?function(t,e){for(var r=vee(t),n=arguments.length,i=1,s=bee.f,o=gee.f;n>i;)for(var l=Tee(arguments[i++]),u=s?Nee(hC(l),s(l)):hC(l),c=u.length,p=0,m;c>p;)m=u[p++],(!r3||hee(o,l,m))&&(r[m]=l[m]);return r}:ic});var xr=L((V4e,yC)=>{var m3=function(a){"use strict";var t=Object.prototype,e=t.hasOwnProperty,r,n=typeof Symbol=="function"?Symbol:{},i=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function l(j,P,F){return Object.defineProperty(j,P,{value:F,enumerable:!0,configurable:!0,writable:!0}),j[P]}try{l({},"")}catch(j){l=function(P,F,G){return P[F]=G}}function u(j,P,F,G){var z=P&&P.prototype instanceof y?P:y,Z=Object.create(z.prototype),ne=new B(G||[]);return Z._invoke=R(j,F,ne),Z}a.wrap=u;function c(j,P,F){try{return{type:"normal",arg:j.call(P,F)}}catch(G){return{type:"throw",arg:G}}}var p="suspendedStart",m="suspendedYield",f="executing",d="completed",h={};function y(){}function b(){}function g(){}var v={};v[i]=function(){return this};var A=Object.getPrototypeOf,C=A&&A(A(U([])));C&&C!==t&&e.call(C,i)&&(v=C);var S=g.prototype=y.prototype=Object.create(v);b.prototype=S.constructor=g,g.constructor=b,b.displayName=l(g,o,"GeneratorFunction");function w(j){["next","throw","return"].forEach(function(P){l(j,P,function(F){return this._invoke(P,F)})})}a.isGeneratorFunction=function(j){var P=typeof j=="function"&&j.constructor;return P?P===b||(P.displayName||P.name)==="GeneratorFunction":!1},a.mark=function(j){return Object.setPrototypeOf?Object.setPrototypeOf(j,g):(j.__proto__=g,l(j,o,"GeneratorFunction")),j.prototype=Object.create(S),j},a.awrap=function(j){return{__await:j}};function x(j,P){function F(Z,ne,ve,xe){var ye=c(j[Z],j,ne);if(ye.type==="throw")xe(ye.arg);else{var it=ye.arg,gr=it.value;return gr&&typeof gr=="object"&&e.call(gr,"__await")?P.resolve(gr.__await).then(function(ar){F("next",ar,ve,xe)},function(ar){F("throw",ar,ve,xe)}):P.resolve(gr).then(function(ar){it.value=ar,ve(it)},function(ar){return F("throw",ar,ve,xe)})}}var G;function z(Z,ne){function ve(){return new P(function(xe,ye){F(Z,ne,xe,ye)})}return G=G?G.then(ve,ve):ve()}this._invoke=z}w(x.prototype),x.prototype[s]=function(){return this},a.AsyncIterator=x,a.async=function(j,P,F,G,z){z===void 0&&(z=Promise);var Z=new x(u(j,P,F,G),z);return a.isGeneratorFunction(P)?Z:Z.next().then(function(ne){return ne.done?ne.value:Z.next()})};function R(j,P,F){var G=p;return function(Z,ne){if(G===f)throw new Error("Generator is already running");if(G===d){if(Z==="throw")throw ne;return H()}for(F.method=Z,F.arg=ne;;){var ve=F.delegate;if(ve){var xe=O(ve,F);if(xe){if(xe===h)continue;return xe}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(G===p)throw G=d,F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);G=f;var ye=c(j,P,F);if(ye.type==="normal"){if(G=F.done?d:m,ye.arg===h)continue;return{value:ye.arg,done:F.done}}else ye.type==="throw"&&(G=d,F.method="throw",F.arg=ye.arg)}}}function O(j,P){var F=j.iterator[P.method];if(F===r){if(P.delegate=null,P.method==="throw"){if(j.iterator.return&&(P.method="return",P.arg=r,O(j,P),P.method==="throw"))return h;P.method="throw",P.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var G=c(F,j.iterator,P.arg);if(G.type==="throw")return P.method="throw",P.arg=G.arg,P.delegate=null,h;var z=G.arg;if(!z)return P.method="throw",P.arg=new TypeError("iterator result is not an object"),P.delegate=null,h;if(z.done)P[j.resultName]=z.value,P.next=j.nextLoc,P.method!=="return"&&(P.method="next",P.arg=r);else return z;return P.delegate=null,h}w(S),l(S,o,"Generator"),S[i]=function(){return this},S.toString=function(){return"[object Generator]"};function _(j){var P={tryLoc:j[0]};1 in j&&(P.catchLoc=j[1]),2 in j&&(P.finallyLoc=j[2],P.afterLoc=j[3]),this.tryEntries.push(P)}function k(j){var P=j.completion||{};P.type="normal",delete P.arg,j.completion=P}function B(j){this.tryEntries=[{tryLoc:"root"}],j.forEach(_,this),this.reset(!0)}a.keys=function(j){var P=[];for(var F in j)P.push(F);return P.reverse(),function G(){for(;P.length;){var z=P.pop();if(z in j)return G.value=z,G.done=!1,G}return G.done=!0,G}};function U(j){if(j){var P=j[i];if(P)return P.call(j);if(typeof j.next=="function")return j;if(!isNaN(j.length)){var F=-1,G=function z(){for(;++F<j.length;)if(e.call(j,F))return z.value=j[F],z.done=!1,z;return z.value=r,z.done=!0,z};return G.next=G}}return{next:H}}a.values=U;function H(){return{value:r,done:!0}}return B.prototype={constructor:B,reset:function(j){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(k),!j)for(var P in this)P.charAt(0)==="t"&&e.call(this,P)&&!isNaN(+P.slice(1))&&(this[P]=r)},stop:function(){this.done=!0;var j=this.tryEntries[0],P=j.completion;if(P.type==="throw")throw P.arg;return this.rval},dispatchException:function(j){if(this.done)throw j;var P=this;function F(xe,ye){return Z.type="throw",Z.arg=j,P.next=xe,ye&&(P.method="next",P.arg=r),!!ye}for(var G=this.tryEntries.length-1;G>=0;--G){var z=this.tryEntries[G],Z=z.completion;if(z.tryLoc==="root")return F("end");if(z.tryLoc<=this.prev){var ne=e.call(z,"catchLoc"),ve=e.call(z,"finallyLoc");if(ne&&ve){if(this.prev<z.catchLoc)return F(z.catchLoc,!0);if(this.prev<z.finallyLoc)return F(z.finallyLoc)}else if(ne){if(this.prev<z.catchLoc)return F(z.catchLoc,!0)}else if(ve){if(this.prev<z.finallyLoc)return F(z.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(j,P){for(var F=this.tryEntries.length-1;F>=0;--F){var G=this.tryEntries[F];if(G.tryLoc<=this.prev&&e.call(G,"finallyLoc")&&this.prev<G.finallyLoc){var z=G;break}}z&&(j==="break"||j==="continue")&&z.tryLoc<=P&&P<=z.finallyLoc&&(z=null);var Z=z?z.completion:{};return Z.type=j,Z.arg=P,z?(this.method="next",this.next=z.finallyLoc,h):this.complete(Z)},complete:function(j,P){if(j.type==="throw")throw j.arg;return j.type==="break"||j.type==="continue"?this.next=j.arg:j.type==="return"?(this.rval=this.arg=j.arg,this.method="return",this.next="end"):j.type==="normal"&&P&&(this.next=P),h},finish:function(j){for(var P=this.tryEntries.length-1;P>=0;--P){var F=this.tryEntries[P];if(F.finallyLoc===j)return this.complete(F.completion,F.afterLoc),k(F),h}},catch:function(j){for(var P=this.tryEntries.length-1;P>=0;--P){var F=this.tryEntries[P];if(F.tryLoc===j){var G=F.completion;if(G.type==="throw"){var z=G.arg;k(F)}return z}}throw new Error("illegal catch attempt")},delegateYield:function(j,P,F){return this.delegate={iterator:U(j),resultName:P,nextLoc:F},this.method==="next"&&(this.arg=r),h}},a}(typeof yC=="object"?yC.exports:{});try{regeneratorRuntime=m3}catch(a){Function("r","regeneratorRuntime = r")(m3)}});var d3=L((D4e,f3)=>{var zee=De();f3.exports=zee(function(){if(typeof ArrayBuffer=="function"){var a=new ArrayBuffer(8);Object.isExtensible(a)&&Object.defineProperty(a,"a",{value:8})}})});var bC=L((I4e,y3)=>{var Gee=De(),Hee=zt(),qee=Ei(),h3=d3(),By=Object.isExtensible,Wee=Gee(function(){By(1)});y3.exports=Wee||h3?function(t){return!Hee(t)||h3&&qee(t)=="ArrayBuffer"?!1:By?By(t):!0}:By});var g3=L((P4e,b3)=>{var $ee=De();b3.exports=!$ee(function(){return Object.isExtensible(Object.preventExtensions({}))})});var uf=L((_4e,N3)=>{var Kee=he(),Xee=Ne(),Yee=Ku(),Zee=zt(),gC=or(),Jee=Er().f,v3=Bo(),Qee=fy(),vC=bC(),ete=Mm(),tte=g3(),T3=!1,ki=ete("meta"),rte=0,TC=function(a){Jee(a,ki,{value:{objectID:"O"+rte++,weakData:{}}})},nte=function(a,t){if(!Zee(a))return typeof a=="symbol"?a:(typeof a=="string"?"S":"P")+a;if(!gC(a,ki)){if(!vC(a))return"F";if(!t)return"E";TC(a)}return a[ki].objectID},ate=function(a,t){if(!gC(a,ki)){if(!vC(a))return!0;if(!t)return!1;TC(a)}return a[ki].weakData},ite=function(a){return tte&&T3&&vC(a)&&!gC(a,ki)&&TC(a),a},ste=function(){ote.enable=function(){},T3=!0;var a=v3.f,t=Xee([].splice),e={};e[ki]=1,a(e).length&&(v3.f=function(r){for(var n=a(r),i=0,s=n.length;i<s;i++)if(n[i]===ki){t(n,i,1);break}return n},Kee({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Qee.f}))},ote=N3.exports={enable:ste,fastKey:nte,getWeakData:ate,onFreeze:ite};Yee[ki]=!0});var Uy=L((k4e,w3)=>{var lte=pe(),ute=Xm(),cte=Br(),pte=Wt(),mte=Fm(),fte=NN(),dte=Wn(),C3=xi(),hte=CN(),yte=Cy(),A3=TN(),bte=lte.TypeError,Ly=function(a,t){this.stopped=a,this.result=t},S3=Ly.prototype;w3.exports=function(a,t,e){var r=e&&e.that,n=!!(e&&e.AS_ENTRIES),i=!!(e&&e.IS_ITERATOR),s=!!(e&&e.INTERRUPTED),o=ute(t,r),l,u,c,p,m,f,d,h=function(b){return l&&A3(l,"normal",b),new Ly(!0,b)},y=function(b){return n?(pte(b),s?o(b[0],b[1],h):o(b[0],b[1])):s?o(b,h):o(b)};if(i)l=a;else{if(u=yte(a),!u)throw bte(mte(a)+" is not iterable");if(fte(u)){for(c=0,p=dte(a);p>c;c++)if(m=y(a[c]),m&&C3(S3,m))return m;return new Ly(!1)}l=hte(a,u)}for(f=l.next;!(d=cte(f,l)).done;){try{m=y(d.value)}catch(b){A3(l,"throw",b)}if(typeof m=="object"&&m&&C3(S3,m))return m}return new Ly(!1)}});var zy=L((F4e,E3)=>{var gte=pe(),vte=xi(),Tte=gte.TypeError;E3.exports=function(a,t){if(vte(t,a))return a;throw Tte("Incorrect invocation")}});var Gy=L((j4e,x3)=>{var Nte=It(),Cte=zt(),R3=ON();x3.exports=function(a,t,e){var r,n;return R3&&Nte(r=t.constructor)&&r!==e&&Cte(n=r.prototype)&&n!==e.prototype&&R3(a,n),a}});var Hy=L((M4e,O3)=>{"use strict";var Ate=he(),Ste=pe(),wte=Ne(),V3=Gm(),Ete=qn(),Rte=uf(),xte=Uy(),Vte=zy(),Ote=It(),NC=zt(),CC=De(),Dte=SN(),Ite=Ym(),Pte=Gy();O3.exports=function(a,t,e){var r=a.indexOf("Map")!==-1,n=a.indexOf("Weak")!==-1,i=r?"set":"add",s=Ste[a],o=s&&s.prototype,l=s,u={},c=function(b){var g=wte(o[b]);Ete(o,b,b=="add"?function(A){return g(this,A===0?0:A),this}:b=="delete"?function(v){return n&&!NC(v)?!1:g(this,v===0?0:v)}:b=="get"?function(A){return n&&!NC(A)?void 0:g(this,A===0?0:A)}:b=="has"?function(A){return n&&!NC(A)?!1:g(this,A===0?0:A)}:function(A,C){return g(this,A===0?0:A,C),this})},p=V3(a,!Ote(s)||!(n||o.forEach&&!CC(function(){new s().entries().next()})));if(p)l=e.getConstructor(t,a,r,i),Rte.enable();else if(V3(a,!0)){var m=new l,f=m[i](n?{}:-0,1)!=m,d=CC(function(){m.has(1)}),h=Dte(function(b){new s(b)}),y=!n&&CC(function(){for(var b=new s,g=5;g--;)b[i](g,g);return!b.has(-0)});h||(l=t(function(b,g){Vte(b,o);var v=Pte(new s,b,l);return g!=null&&xte(g,v[i],{that:v,AS_ENTRIES:r}),v}),l.prototype=o,o.constructor=l),(d||y)&&(c("delete"),c("has"),r&&c("get")),(y||f)&&c(i),n&&o.clear&&delete o.clear}return u[a]=l,Ate({global:!0,forced:l!=s},u),Ite(l,a),n||e.setStrong(l,a,r),l}});var qy=L((B4e,D3)=>{var _te=qn();D3.exports=function(a,t,e){for(var r in t)_te(a,r,t[r],e);return a}});var AC=L((L4e,P3)=>{"use strict";var kte=Ri(),Fte=Er(),jte=ct(),Mte=sr(),I3=jte("species");P3.exports=function(a){var t=kte(a),e=Fte.f;Mte&&t&&!t[I3]&&e(t,I3,{configurable:!0,get:function(){return this}})}});var wC=L((U4e,M3)=>{"use strict";var Bte=Er().f,Lte=Vs(),_3=qy(),Ute=Xm(),zte=zy(),Gte=Uy(),Hte=Ey(),qte=AC(),cf=sr(),k3=uf().fastKey,F3=Xa(),j3=F3.set,SC=F3.getterFor;M3.exports={getConstructor:function(a,t,e,r){var n=a(function(u,c){zte(u,i),j3(u,{type:t,index:Lte(null),first:void 0,last:void 0,size:0}),cf||(u.size=0),c!=null&&Gte(c,u[r],{that:u,AS_ENTRIES:e})}),i=n.prototype,s=SC(t),o=function(u,c,p){var m=s(u),f=l(u,c),d,h;return f?f.value=p:(m.last=f={index:h=k3(c,!0),key:c,value:p,previous:d=m.last,next:void 0,removed:!1},m.first||(m.first=f),d&&(d.next=f),cf?m.size++:u.size++,h!=="F"&&(m.index[h]=f)),u},l=function(u,c){var p=s(u),m=k3(c),f;if(m!=="F")return p.index[m];for(f=p.first;f;f=f.next)if(f.key==c)return f};return _3(i,{clear:function(){for(var c=this,p=s(c),m=p.index,f=p.first;f;)f.removed=!0,f.previous&&(f.previous=f.previous.next=void 0),delete m[f.index],f=f.next;p.first=p.last=void 0,cf?p.size=0:c.size=0},delete:function(u){var c=this,p=s(c),m=l(c,u);if(m){var f=m.next,d=m.previous;delete p.index[m.index],m.removed=!0,d&&(d.next=f),f&&(f.previous=d),p.first==m&&(p.first=f),p.last==m&&(p.last=d),cf?p.size--:c.size--}return!!m},forEach:function(c){for(var p=s(this),m=Ute(c,arguments.length>1?arguments[1]:void 0),f;f=f?f.next:p.first;)for(m(f.value,f.key,this);f&&f.removed;)f=f.previous},has:function(c){return!!l(this,c)}}),_3(i,e?{get:function(c){var p=l(this,c);return p&&p.value},set:function(c,p){return o(this,c===0?0:c,p)}}:{add:function(c){return o(this,c=c===0?0:c,c)}}),cf&&Bte(i,"size",{get:function(){return s(this).size}}),n},setStrong:function(a,t,e){var r=t+" Iterator",n=SC(t),i=SC(r);Hte(a,t,function(s,o){j3(this,{type:r,target:s,state:n(s),kind:o,last:void 0})},function(){for(var s=i(this),o=s.kind,l=s.last;l&&l.removed;)l=l.previous;return!s.target||!(s.last=l=l?l.next:s.state.first)?(s.target=void 0,{value:void 0,done:!0}):o=="keys"?{value:l.key,done:!1}:o=="values"?{value:l.value,done:!1}:{value:[l.key,l.value],done:!1}},e?"entries":"values",!e,!0),qte(t)}}});var pf=L((G4e,B3)=>{"use strict";var Kte=De();B3.exports=function(a,t){var e=[][a];return!!e&&Kte(function(){e.call(null,t||function(){return 1},1)})}});var U3=L((H4e,L3)=>{"use strict";var Xte=Ds().forEach,Yte=pf(),Zte=Yte("forEach");L3.exports=Zte?[].forEach:function(t){return Xte(this,t,arguments.length>1?arguments[1]:void 0)}});var W3=L(($4e,q3)=>{var are=pe(),ire=are.isFinite;q3.exports=Number.isFinite||function(t){return typeof t=="number"&&ire(t)}});var RC=L((X4e,$3)=>{var lre=Ne();$3.exports=lre(1 .valueOf)});var xC=L((Y4e,K3)=>{K3.exports=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`});var OC=L((Z4e,Y3)=>{var ure=Ne(),cre=Gn(),pre=Rr(),mre=xC(),X3=ure("".replace),$y="["+mre+"]",fre=RegExp("^"+$y+$y+"*"),dre=RegExp($y+$y+"*$"),VC=function(a){return function(t){var e=pre(cre(t));return a&1&&(e=X3(e,fre,"")),a&2&&(e=X3(e,dre,"")),e}};Y3.exports={start:VC(1),end:VC(2),trim:VC(3)}});var zC=L((b8e,v4)=>{"use strict";ie();var h4=Ne(),y4=qn(),gne=Qm(),b4=De(),g4=ct(),vne=Oi(),Tne=g4("species"),UC=RegExp.prototype;v4.exports=function(a,t,e,r){var n=g4(a),i=!b4(function(){var u={};return u[n]=function(){return 7},""[a](u)!=7}),s=i&&!b4(function(){var u=!1,c=/a/;return a==="split"&&(c={},c.constructor={},c.constructor[Tne]=function(){return c},c.flags="",c[n]=/./[n]),c.exec=function(){return u=!0,null},c[n](""),!u});if(!i||!s||e){var o=h4(/./[n]),l=t(n,""[a],function(u,c,p,m,f){var d=h4(u),h=c.exec;return h===gne||h===UC.exec?i&&!f?{done:!0,value:o(c,p,m)}:{done:!0,value:d(p,c,m)}:{done:!1}});y4(String.prototype,a,l[0]),y4(UC,n,l[1])}r&&vne(UC[n],"sham",!0)}});var C4=L((g8e,N4)=>{var T4=Wt(),Nne=mN(),Cne=ct(),Ane=Cne("species");N4.exports=function(a,t){var e=T4(a).constructor,r;return e===void 0||(r=T4(e)[Ane])==null?t:Nne(r)}});var GC=L((v8e,A4)=>{"use strict";var Sne=Ay().charAt;A4.exports=function(a,t,e){return t+(e?Sne(a,t).length:1)}});var HC=L((T8e,w4)=>{var wne=pe(),S4=Br(),Ene=Wt(),Rne=It(),xne=Ei(),Vne=Qm(),One=wne.TypeError;w4.exports=function(a,t){var e=a.exec;if(Rne(e)){var r=S4(e,a,t);return r!==null&&Ene(r),r}if(xne(a)==="RegExp")return S4(Vne,a,t);throw One("RegExp#exec called on incompatible receiver")}});var P4=L((C8e,I4)=>{var qne=pe(),Wne=_o(),$ne=Yr(),Kne=Gu(),Xne=Wn(),Yne=qne.TypeError,D4=function(a){return function(t,e,r,n){Wne(e);var i=$ne(t),s=Kne(i),o=Xne(i),l=a?o-1:0,u=a?-1:1;if(r<2)for(;;){if(l in s){n=s[l],l+=u;break}if(l+=u,a?l<0:o<=l)throw Yne("Reduce of empty array with no initial value")}for(;a?l>=0:o>l;l+=u)l in s&&(n=e(n,s[l],l,i));return n}};I4.exports={left:D4(!1),right:D4(!0)}});var k4=L((A8e,_4)=>{var Zne=Ei(),Jne=pe();_4.exports=Zne(Jne.process)=="process"});var M4=L((w8e,j4)=>{var $C=Ne(),iae=Yr(),sae=Math.floor,KC=$C("".charAt),oae=$C("".replace),XC=$C("".slice),lae=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,uae=/\$([$&'`]|\d{1,2})/g;j4.exports=function(a,t,e,r,n,i){var s=e+a.length,o=r.length,l=uae;return n!==void 0&&(n=iae(n),l=lae),oae(i,l,function(u,c){var p;switch(KC(c,0)){case"$":return"$";case"&":return a;case"`":return XC(t,0,e);case"'":return XC(t,s);case"<":p=n[XC(c,1,-1)];break;default:var m=+c;if(m===0)return u;if(m>o){var f=sae(m/10);return f===0?u:f<=o?r[f-1]===void 0?KC(c,1):r[f-1]+KC(c,1):u}p=r[m-1]}return p===void 0?"":p})}});var QC=Ee(()=>{});function Ve(a){return a&&a.length===0}function Xn(a){return a==null?[]:Object.keys(a)}function Ct(a){for(var t=[],e=Object.keys(a),r=0;r<e.length;r++)t.push(a[e[r]]);return t}function W4(a,t){for(var e=[],r=Xn(a),n=0;n<r.length;n++){var i=r[n];e.push(t.call(null,a[i],i))}return e}function Y(a,t){for(var e=[],r=0;r<a.length;r++)e.push(t.call(null,a[r],r));return e}function Pt(a){for(var t=[],e=0;e<a.length;e++){var r=a[e];Array.isArray(r)?t=t.concat(Pt(r)):t.push(r)}return t}function Vr(a){return Ve(a)?void 0:a[0]}function bb(a){var t=a&&a.length;return t?a[t-1]:void 0}function ee(a,t){if(Array.isArray(a))for(var e=0;e<a.length;e++)t.call(null,a[e],e);else if(gb(a))for(var r=Xn(a),e=0;e<r.length;e++){var n=r[e],i=a[n];t.call(null,i,n)}else throw Error("non exhaustive match")}function Yn(a){return typeof a=="string"}function Xt(a){return a===void 0}function ha(a){return a instanceof Function}function Yt(a,t){return t===void 0&&(t=1),a.slice(t,a.length)}function Ms(a,t){return t===void 0&&(t=1),a.slice(0,a.length-t)}function Zn(a,t){var e=[];if(Array.isArray(a))for(var r=0;r<a.length;r++){var n=a[r];t.call(null,n)&&e.push(n)}return e}function Ya(a,t){return Zn(a,function(e){return!t(e)})}function Zr(a,t){for(var e=Object.keys(a),r={},n=0;n<e.length;n++){var i=e[n],s=a[i];t(s)&&(r[i]=s)}return r}function ae(a,t){return gb(a)?a.hasOwnProperty(t):!1}function Je(a,t){return Bi(a,function(e){return e===t})!==void 0}function _t(a){for(var t=[],e=0;e<a.length;e++)t.push(a[e]);return t}function Bs(a){var t={};for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(t[e]=a[e]);return t}function Bi(a,t){for(var e=0;e<a.length;e++){var r=a[e];if(t.call(null,r))return r}}function $4(a,t){for(var e=[],r=0;r<a.length;r++){var n=a[r];t.call(null,n)&&e.push(n)}return e}function ht(a,t,e){for(var r=Array.isArray(a),n=r?a:Ct(a),i=r?[]:Xn(a),s=e,o=0;o<n.length;o++)s=t.call(null,s,n[o],r?o:i[o]);return s}function Li(a){return Ya(a,function(t){return t==null})}function Nf(a,t){t===void 0&&(t=function(r){return r});var e=[];return ht(a,function(r,n){var i=t(n);return Je(e,i)?r:(e.push(i),r.concat(n))},[])}function F8e(a){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=[null],n=r.concat(t);return Function.bind.apply(a,n)}function fr(a){return Array.isArray(a)}function ya(a){return a instanceof RegExp}function gb(a){return a instanceof Object}function Or(a,t){for(var e=0;e<a.length;e++)if(!t(a[e],e))return!1;return!0}function qo(a,t){return Ya(a,function(e){return Je(t,e)})}function vb(a,t){for(var e=0;e<a.length;e++)if(t(a[e]))return!0;return!1}function K4(a,t){for(var e=0;e<a.length;e++)if(a[e]===t)return e;return-1}function j8e(a,t){var e=_t(a);return e.sort(function(r,n){return t(r)-t(n)}),e}function M8e(a,t){if(a.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var e={},r=0;r<a.length;r++)e[a[r]]=t[r];return e}function Vn(a){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var r=0;r<t.length;r++)for(var n=t[r],i=Xn(n),s=0;s<i.length;s++){var o=i[s];a[o]=n[o]}return a}function Pae(a){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var r=0;r<t.length;r++){var n=t[r];if(!Xt(n))for(var i=Xn(n),s=0;s<i.length;s++){var o=i[s];ae(a,o)||(a[o]=n[o])}}return a}function Wo(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];return Pae.apply(null,[{}].concat(a))}function Tb(a,t){var e={};return ee(a,function(r){var n=t(r),i=e[n];i?i.push(r):e[n]=[r]}),e}function e6(a,t){for(var e=Bs(a),r=Xn(t),n=0;n<r.length;n++){var i=r[n],s=t[i];e[i]=s}return e}function Zt(){}function t6(a){return a}function X4(a){for(var t=[],e=0;e<a.length;e++){var r=a[e];t.push(r!==void 0?r:void 0)}return t}function Cf(a){console&&console.error&&console.error("Error: "+a)}function fc(a){console&&console.warn&&console.warn("Warning: "+a)}function r6(){return typeof Map=="function"}function Y4(a,t){t.forEach(function(e){var r=e.prototype;Object.getOwnPropertyNames(r).forEach(function(n){if(n!=="constructor"){var i=Object.getOwnPropertyDescriptor(r,n);i&&(i.get||i.set)?Object.defineProperty(a.prototype,n,i):a.prototype[n]=e.prototype[n]}})})}function Nb(toBecomeFast){function FakeConstructor(){}FakeConstructor.prototype=toBecomeFast;var fakeInstance=new FakeConstructor;function fakeAccess(){return typeof fakeInstance.bar}return fakeAccess(),fakeAccess(),toBecomeFast;eval(toBecomeFast)}function Af(a){return a[a.length-1]}function Cb(a){var t=new Date().getTime(),e=a(),r=new Date().getTime(),n=r-t;return{time:n,value:e}}var Me=Ee(()=>{});var Sb=L((Z4,Ab)=>{(function(a,t){typeof define=="function"&&define.amd?define([],t):typeof Ab=="object"&&Ab.exports?Ab.exports=t():a.regexpToAst=t()})(typeof self!="undefined"?self:Z4,function(){function a(){}a.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},a.prototype.restoreState=function(d){this.idx=d.idx,this.input=d.input,this.groupIdx=d.groupIdx},a.prototype.pattern=function(d){this.idx=0,this.input=d,this.groupIdx=0,this.consumeChar("/");var h=this.disjunction();this.consumeChar("/");for(var y={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(y,"global");break;case"i":s(y,"ignoreCase");break;case"m":s(y,"multiLine");break;case"u":s(y,"unicode");break;case"y":s(y,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:y,value:h}},a.prototype.disjunction=function(){var d=[];for(d.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),d.push(this.alternative());return{type:"Disjunction",value:d}},a.prototype.alternative=function(){for(var d=[];this.isTerm();)d.push(this.term());return{type:"Alternative",value:d}},a.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},a.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var d;switch(this.popChar()){case"=":d="Lookahead";break;case"!":d="NegativeLookahead";break}o(d);var h=this.disjunction();return this.consumeChar(")"),{type:d,value:h}}l()},a.prototype.quantifier=function(d){var h;switch(this.popChar()){case"*":h={atLeast:0,atMost:1/0};break;case"+":h={atLeast:1,atMost:1/0};break;case"?":h={atLeast:0,atMost:1};break;case"{":var y=this.integerIncludingZero();switch(this.popChar()){case"}":h={atLeast:y,atMost:y};break;case",":var b;this.isDigit()?(b=this.integerIncludingZero(),h={atLeast:y,atMost:b}):h={atLeast:y,atMost:1/0},this.consumeChar("}");break}if(d===!0&&h===void 0)return;o(h);break}if(!(d===!0&&h===void 0))return o(h),this.peekChar(0)==="?"?(this.consumeChar("?"),h.greedy=!1):h.greedy=!0,h.type="Quantifier",h},a.prototype.atom=function(){var d;switch(this.peekChar()){case".":d=this.dotAll();break;case"\\":d=this.atomEscape();break;case"[":d=this.characterClass();break;case"(":d=this.group();break}return d===void 0&&this.isPatternCharacter()&&(d=this.patternCharacter()),o(d),this.isQuantifier()&&(d.quantifier=this.quantifier()),d},a.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[n(`
`),n("\r"),n("\u2028"),n("\u2029")]}},a.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},a.prototype.decimalEscapeAtom=function(){var d=this.positiveInteger();return{type:"GroupBackReference",value:d}},a.prototype.characterClassEscape=function(){var d,h=!1;switch(this.popChar()){case"d":d=c;break;case"D":d=c,h=!0;break;case"s":d=m;break;case"S":d=m,h=!0;break;case"w":d=p;break;case"W":d=p,h=!0;break}return o(d),{type:"Set",value:d,complement:h}},a.prototype.controlEscapeAtom=function(){var d;switch(this.popChar()){case"f":d=n("\f");break;case"n":d=n(`
`);break;case"r":d=n("\r");break;case"t":d=n("	");break;case"v":d=n("\v");break}return o(d),{type:"Character",value:d}},a.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var d=this.popChar();if(/[a-zA-Z]/.test(d)===!1)throw Error("Invalid ");var h=d.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:h}},a.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:n("\0")}},a.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},a.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},a.prototype.identityEscapeAtom=function(){var d=this.popChar();return{type:"Character",value:n(d)}},a.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var d=this.popChar();return{type:"Character",value:n(d)}}},a.prototype.characterClass=function(){var d=[],h=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),h=!0);this.isClassAtom();){var y=this.classAtom(),b=y.type==="Character";if(b&&this.isRangeDash()){this.consumeChar("-");var g=this.classAtom(),v=g.type==="Character";if(v){if(g.value<y.value)throw Error("Range out of order in character class");d.push({from:y.value,to:g.value})}else i(y.value,d),d.push(n("-")),i(g.value,d)}else i(y.value,d)}return this.consumeChar("]"),{type:"Set",complement:h,value:d}},a.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},a.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:n("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},a.prototype.group=function(){var d=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),d=!1;break;default:this.groupIdx++;break}var h=this.disjunction();this.consumeChar(")");var y={type:"Group",capturing:d,value:h};return d&&(y.idx=this.groupIdx),y},a.prototype.positiveInteger=function(){var d=this.popChar();if(r.test(d)===!1)throw Error("Expecting a positive integer");for(;e.test(this.peekChar(0));)d+=this.popChar();return parseInt(d,10)},a.prototype.integerIncludingZero=function(){var d=this.popChar();if(e.test(d)===!1)throw Error("Expecting an integer");for(;e.test(this.peekChar(0));)d+=this.popChar();return parseInt(d,10)},a.prototype.patternCharacter=function(){var d=this.popChar();switch(d){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:n(d)}}},a.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},a.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},a.prototype.isDigit=function(){return e.test(this.peekChar(0))},a.prototype.isClassAtom=function(d){switch(d===void 0&&(d=0),this.peekChar(d)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},a.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},a.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},a.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},a.prototype.isQuantifier=function(){var d=this.saveState();try{return this.quantifier(!0)!==void 0}catch(h){return!1}finally{this.restoreState(d)}},a.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},a.prototype.parseHexDigits=function(d){for(var h="",y=0;y<d;y++){var b=this.popChar();if(t.test(b)===!1)throw Error("Expecting a HexDecimal digits");h+=b}var g=parseInt(h,16);return{type:"Character",value:g}},a.prototype.peekChar=function(d){return d===void 0&&(d=0),this.input[this.idx+d]},a.prototype.popChar=function(){var d=this.peekChar(0);return this.consumeChar(),d},a.prototype.consumeChar=function(d){if(d!==void 0&&this.input[this.idx]!==d)throw Error("Expected: '"+d+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,e=/[0-9]/,r=/[1-9]/;function n(d){return d.charCodeAt(0)}function i(d,h){d.length!==void 0?d.forEach(function(y){h.push(y)}):h.push(d)}function s(d,h){if(d[h]===!0)throw"duplicate flag "+h;d[h]=!0}function o(d){if(d===void 0)throw Error("Internal Error - Should never get here!")}function l(){throw Error("Internal Error - Should never get here!")}var u,c=[];for(u=n("0");u<=n("9");u++)c.push(u);var p=[n("_")].concat(c);for(u=n("a");u<=n("z");u++)p.push(u);for(u=n("A");u<=n("Z");u++)p.push(u);var m=[n(" "),n("\f"),n(`
`),n("\r"),n("	"),n("\v"),n("	"),n("\xA0"),n("\u1680"),n("\u2000"),n("\u2001"),n("\u2002"),n("\u2003"),n("\u2004"),n("\u2005"),n("\u2006"),n("\u2007"),n("\u2008"),n("\u2009"),n("\u200A"),n("\u2028"),n("\u2029"),n("\u202F"),n("\u205F"),n("\u3000"),n("\uFEFF")];function f(){}return f.prototype.visitChildren=function(d){for(var h in d){var y=d[h];d.hasOwnProperty(h)&&(y.type!==void 0?this.visit(y):Array.isArray(y)&&y.forEach(function(b){this.visit(b)},this))}},f.prototype.visit=function(d){switch(d.type){case"Pattern":this.visitPattern(d);break;case"Flags":this.visitFlags(d);break;case"Disjunction":this.visitDisjunction(d);break;case"Alternative":this.visitAlternative(d);break;case"StartAnchor":this.visitStartAnchor(d);break;case"EndAnchor":this.visitEndAnchor(d);break;case"WordBoundary":this.visitWordBoundary(d);break;case"NonWordBoundary":this.visitNonWordBoundary(d);break;case"Lookahead":this.visitLookahead(d);break;case"NegativeLookahead":this.visitNegativeLookahead(d);break;case"Character":this.visitCharacter(d);break;case"Set":this.visitSet(d);break;case"Group":this.visitGroup(d);break;case"GroupBackReference":this.visitGroupBackReference(d);break;case"Quantifier":this.visitQuantifier(d);break}this.visitChildren(d)},f.prototype.visitPattern=function(d){},f.prototype.visitFlags=function(d){},f.prototype.visitDisjunction=function(d){},f.prototype.visitAlternative=function(d){},f.prototype.visitStartAnchor=function(d){},f.prototype.visitEndAnchor=function(d){},f.prototype.visitWordBoundary=function(d){},f.prototype.visitNonWordBoundary=function(d){},f.prototype.visitLookahead=function(d){},f.prototype.visitNegativeLookahead=function(d){},f.prototype.visitCharacter=function(d){},f.prototype.visitSet=function(d){},f.prototype.visitGroup=function(d){},f.prototype.visitGroupBackReference=function(d){},f.prototype.visitQuantifier=function(d){},{RegExpParser:a,BaseRegExpVisitor:f,VERSION:"0.4.0"}})});function dc(a){var t=a.toString();if(wb.hasOwnProperty(t))return wb[t];var e=_ae.pattern(t);return wb[t]=e,e}function Q4(){wb={}}var J4,wb,_ae,Eb=Ee(()=>{J4=M(Sb()),wb={},_ae=new J4.RegExpParser});function t8(a,t){t===void 0&&(t=!1);try{var e=dc(a),r=n6(e.value,{},e.flags.ignoreCase);return r}catch(i){if(i.message===e8)t&&fc(""+Sf+("	Unable to optimize: < "+a.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var n="";t&&(n=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Cf(Sf+`
`+("	Failed parsing: < "+a.toString()+` >
`)+("	Using the regexp-to-ast library version: "+Rb.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}function n6(a,t,e){switch(a.type){case"Disjunction":for(var r=0;r<a.value.length;r++)n6(a.value[r],t,e);break;case"Alternative":for(var n=a.value,r=0;r<n.length;r++){var i=n[r];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var s=i;switch(s.type){case"Character":xb(s.value,t,e);break;case"Set":if(s.complement===!0)throw Error(e8);ee(s.value,function(u){if(typeof u=="number")xb(u,t,e);else{var c=u;if(e===!0)for(var p=c.from;p<=c.to;p++)xb(p,t,e);else{for(var p=c.from;p<=c.to&&p<hc;p++)xb(p,t,e);if(c.to>=hc)for(var m=c.from>=hc?c.from:hc,f=c.to,d=Za(m),h=Za(f),y=d;y<=h;y++)t[y]=y}}});break;case"Group":n6(s.value,t,e);break;default:throw Error("Non Exhaustive Match")}var o=s.quantifier!==void 0&&s.quantifier.atLeast===0;if(s.type==="Group"&&a6(s)===!1||s.type!=="Group"&&o===!1)break}break;default:throw Error("non exhaustive match!")}return Ct(t)}function xb(a,t,e){var r=Za(a);t[r]=r,e===!0&&Fae(a,t)}function Fae(a,t){var e=String.fromCharCode(a),r=e.toUpperCase();if(r!==e){var n=Za(r.charCodeAt(0));t[n]=n}else{var i=e.toLowerCase();if(i!==e){var n=Za(i.charCodeAt(0));t[n]=n}}}function r8(a,t){return Bi(a.value,function(e){if(typeof e=="number")return Je(t,e);var r=e;return Bi(t,function(n){return r.from<=n&&n<=r.to})!==void 0})}function a6(a){return a.quantifier&&a.quantifier.atLeast===0?!0:a.value?fr(a.value)?Or(a.value,a6):a6(a.value):!1}function Vb(a,t){if(t instanceof RegExp){var e=dc(t),r=new jae(a);return r.visit(e),r.found}else return Bi(t,function(n){return Je(a,n.charCodeAt(0))})!==void 0}var Rb,kae,e8,Sf,jae,n8=Ee(()=>{Rb=M(Sb());Me();Eb();i6();kae=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),e8="Complement Sets are not supported for first char optimization",Sf=`Unable to use "first char" lexer optimizations:
`;jae=function(a){kae(t,a);function t(e){var r=a.call(this)||this;return r.targetCharCodes=e,r.found=!1,r}return t.prototype.visitChildren=function(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}a.prototype.visitChildren.call(this,e)}},t.prototype.visitCharacter=function(e){Je(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?r8(e,this.targetCharCodes)===void 0&&(this.found=!0):r8(e,this.targetCharCodes)!==void 0&&(this.found=!0)},t}(Rb.BaseRegExpVisitor)});function i8(a,t){t=Wo(t,{useSticky:o6,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(g,v){return v()}});var e=t.tracer;e("initCharCodeToOptimizedIndexMap",function(){tie()});var r;e("Reject Lexer.NA",function(){r=Ya(a,function(g){return g[Ja]===Jt.NA})});var n=!1,i;e("Transform Patterns",function(){n=!1,i=Y(r,function(g){var v=g[Ja];if(ya(v)){var A=v.source;return A.length===1&&A!=="^"&&A!=="$"&&A!=="."?A:A.length===2&&A[0]==="\\"&&!Je(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],A[1])?A[1]:t.useSticky?l8(v):o8(v)}else{if(ha(v))return n=!0,{exec:v};if(ae(v,"exec"))return n=!0,v;if(typeof v=="string"){if(v.length===1)return v;var C=v.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),S=new RegExp(C);return t.useSticky?l8(S):o8(S)}else throw Error("non exhaustive match")}})});var s,o,l,u,c;e("misc mapping",function(){s=Y(r,function(g){return g.tokenTypeIdx}),o=Y(r,function(g){var v=g.GROUP;if(v!==Jt.SKIPPED){if(Yn(v))return v;if(Xt(v))return!1;throw Error("non exhaustive match")}}),l=Y(r,function(g){var v=g.LONGER_ALT;if(v){var A=K4(r,v);return A}}),u=Y(r,function(g){return g.PUSH_MODE}),c=Y(r,function(g){return ae(g,"POP_MODE")})});var p;e("Line Terminator Handling",function(){var g=h8(t.lineTerminatorCharacters);p=Y(r,function(v){return!1}),t.positionTracking!=="onlyOffset"&&(p=Y(r,function(v){if(ae(v,"LINE_BREAKS"))return v.LINE_BREAKS;if(d8(v,g)===!1)return Vb(g,v.PATTERN)}))});var m,f,d,h;e("Misc Mapping #2",function(){m=Y(r,m8),f=Y(i,Qae),d=ht(r,function(g,v){var A=v.GROUP;return Yn(A)&&A!==Jt.SKIPPED&&(g[A]=[]),g},{}),h=Y(i,function(g,v){return{pattern:i[v],longerAlt:l[v],canLineTerminator:p[v],isCustom:m[v],short:f[v],group:o[v],push:u[v],pop:c[v],tokenTypeIdx:s[v],tokenType:r[v]}})});var y=!0,b=[];return t.safeMode||e("First Char Optimization",function(){b=ht(r,function(g,v,A){if(typeof v.PATTERN=="string"){var C=v.PATTERN.charCodeAt(0),S=Za(C);l6(g,S,h[A])}else if(fr(v.START_CHARS_HINT)){var w;ee(v.START_CHARS_HINT,function(R){var O=typeof R=="string"?R.charCodeAt(0):R,_=Za(O);w!==_&&(w=_,l6(g,_,h[A]))})}else if(ya(v.PATTERN))if(v.PATTERN.unicode)y=!1,t.ensureOptimizations&&Cf(""+Sf+("	Unable to analyze < "+v.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var x=t8(v.PATTERN,t.ensureOptimizations);Ve(x)&&(y=!1),ee(x,function(R){l6(g,R,h[A])})}else t.ensureOptimizations&&Cf(""+Sf+("	TokenType: <"+v.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),y=!1;return g},[])}),e("ArrayPacking",function(){b=X4(b)}),{emptyGroups:d,patternIdxToConfig:h,charCodeToPatternIdxToConfig:b,hasCustom:n,canBeOptimized:y}}function s8(a,t){var e=[],r=Bae(a);e=e.concat(r.errors);var n=Lae(r.valid),i=n.valid;return e=e.concat(n.errors),e=e.concat(Mae(i)),e=e.concat(Kae(i)),e=e.concat(Xae(i,t)),e=e.concat(Yae(i)),e}function Mae(a){var t=[],e=Zn(a,function(r){return ya(r[Ja])});return t=t.concat(zae(e)),t=t.concat(qae(e)),t=t.concat(Wae(e)),t=t.concat($ae(e)),t=t.concat(Gae(e)),t}function Bae(a){var t=Zn(a,function(n){return!ae(n,Ja)}),e=Y(t,function(n){return{message:"Token Type: ->"+n.name+"<- missing static 'PATTERN' property",type:At.MISSING_PATTERN,tokenTypes:[n]}}),r=qo(a,t);return{errors:e,valid:r}}function Lae(a){var t=Zn(a,function(n){var i=n[Ja];return!ya(i)&&!ha(i)&&!ae(i,"exec")&&!Yn(i)}),e=Y(t,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:At.INVALID_PATTERN,tokenTypes:[n]}}),r=qo(a,t);return{errors:e,valid:r}}function zae(a){var t=function(n){a8(i,n);function i(){var s=n!==null&&n.apply(this,arguments)||this;return s.found=!1,s}return i.prototype.visitEndAnchor=function(s){this.found=!0},i}(s6.BaseRegExpVisitor),e=Zn(a,function(n){var i=n[Ja];try{var s=dc(i),o=new t;return o.visit(s),o.found}catch(l){return Uae.test(i.source)}}),r=Y(e,function(n){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+n.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:At.EOI_ANCHOR_FOUND,tokenTypes:[n]}});return r}function Gae(a){var t=Zn(a,function(r){var n=r[Ja];return n.test("")}),e=Y(t,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:At.EMPTY_MATCH_PATTERN,tokenTypes:[r]}});return e}function qae(a){var t=function(n){a8(i,n);function i(){var s=n!==null&&n.apply(this,arguments)||this;return s.found=!1,s}return i.prototype.visitStartAnchor=function(s){this.found=!0},i}(s6.BaseRegExpVisitor),e=Zn(a,function(n){var i=n[Ja];try{var s=dc(i),o=new t;return o.visit(s),o.found}catch(l){return Hae.test(i.source)}}),r=Y(e,function(n){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+n.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:At.SOI_ANCHOR_FOUND,tokenTypes:[n]}});return r}function Wae(a){var t=Zn(a,function(r){var n=r[Ja];return n instanceof RegExp&&(n.multiline||n.global)}),e=Y(t,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:At.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}});return e}function $ae(a){var t=[],e=Y(a,function(i){return ht(a,function(s,o){return i.PATTERN.source===o.PATTERN.source&&!Je(t,o)&&o.PATTERN!==Jt.NA&&(t.push(o),s.push(o)),s},[])});e=Li(e);var r=Zn(e,function(i){return i.length>1}),n=Y(r,function(i){var s=Y(i,function(l){return l.name}),o=Vr(i).PATTERN;return{message:"The same RegExp pattern ->"+o+"<-"+("has been used in all of the following Token Types: "+s.join(", ")+" <-"),type:At.DUPLICATE_PATTERNS_FOUND,tokenTypes:i}});return n}function Kae(a){var t=Zn(a,function(r){if(!ae(r,"GROUP"))return!1;var n=r.GROUP;return n!==Jt.SKIPPED&&n!==Jt.NA&&!Yn(n)}),e=Y(t,function(r){return{message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:At.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}});return e}function Xae(a,t){var e=Zn(a,function(n){return n.PUSH_MODE!==void 0&&!Je(t,n.PUSH_MODE)}),r=Y(e,function(n){var i="Token Type: ->"+n.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+n.PUSH_MODE+"<-which does not exist";return{message:i,type:At.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[n]}});return r}function Yae(a){var t=[],e=ht(a,function(r,n,i){var s=n.PATTERN;return s===Jt.NA||(Yn(s)?r.push({str:s,idx:i,tokenType:n}):ya(s)&&Jae(s)&&r.push({str:s.source,idx:i,tokenType:n})),r},[]);return ee(a,function(r,n){ee(e,function(i){var s=i.str,o=i.idx,l=i.tokenType;if(n<o&&Zae(s,r.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+r.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:u,type:At.UNREACHABLE_PATTERN,tokenTypes:[r,l]})}})}),t}function Zae(a,t){if(ya(t)){var e=t.exec(a);return e!==null&&e.index===0}else{if(ha(t))return t(a,0,[],{});if(ae(t,"exec"))return t.exec(a,0,[],{});if(typeof t=="string")return t===a;throw Error("non exhaustive match")}}function Jae(a){var t=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return Bi(t,function(e){return a.source.indexOf(e)!==-1})===void 0}function o8(a){var t=a.ignoreCase?"i":"";return new RegExp("^(?:"+a.source+")",t)}function l8(a){var t=a.ignoreCase?"iy":"y";return new RegExp(""+a.source,t)}function u8(a,t,e){var r=[];return ae(a,Ls)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Ls+`> property in its definition
`,type:At.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),ae(a,Ob)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Ob+`> property in its definition
`,type:At.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),ae(a,Ob)&&ae(a,Ls)&&!ae(a.modes,a.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+Ls+": <"+a.defaultMode+`>which does not exist
`,type:At.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),ae(a,Ob)&&ee(a.modes,function(n,i){ee(n,function(s,o){Xt(s)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+i+"> at index: <"+o+`>
`),type:At.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r}function c8(a,t,e){var r=[],n=!1,i=Li(Pt(W4(a.modes,function(l){return l}))),s=Ya(i,function(l){return l[Ja]===Jt.NA}),o=h8(e);return t&&ee(s,function(l){var u=d8(l,o);if(u!==!1){var c=eie(l,u),p={message:c,type:u.issue,tokenType:l};r.push(p)}else ae(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(n=!0):Vb(o,l.PATTERN)&&(n=!0)}),t&&!n&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:At.NO_LINE_BREAKS_FLAGS}),r}function p8(a){var t={},e=Xn(a);return ee(e,function(r){var n=a[r];if(fr(n))t[r]=[];else throw Error("non exhaustive match")}),t}function m8(a){var t=a.PATTERN;if(ya(t))return!1;if(ha(t))return!0;if(ae(t,"exec"))return!0;if(Yn(t))return!1;throw Error("non exhaustive match")}function Qae(a){return Yn(a)&&a.length===1?a.charCodeAt(0):!1}function d8(a,t){if(ae(a,"LINE_BREAKS"))return!1;if(ya(a.PATTERN)){try{Vb(t,a.PATTERN)}catch(e){return{issue:At.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}else{if(Yn(a.PATTERN))return!1;if(m8(a))return{issue:At.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function eie(a,t){if(t.issue===At.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+a.name+`> Token Type
`)+("	 Root cause: "+t.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===At.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+a.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function h8(a){var t=Y(a,function(e){return Yn(e)&&e.length>0?e.charCodeAt(0):e});return t}function l6(a,t,e){a[t]===void 0?a[t]=[e]:a[t].push(e)}function Za(a){return a<hc?a:Db[a]}function tie(){if(Ve(Db)){Db=new Array(65536);for(var a=0;a<65536;a++)Db[a]=a>255?255+~~(a/255):a}}var s6,a8,Ja,Ls,Ob,o6,Uae,Hae,f8,hc,Db,i6=Ee(()=>{s6=M(Sb());wf();Me();n8();Eb();a8=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ja="PATTERN",Ls="defaultMode",Ob="modes",o6=typeof new RegExp("(?:)").sticky=="boolean";Uae=/[^\\][\$]/;Hae=/[^\\[][\^]|^\^/;f8={test:function(a){for(var t=a.length,e=this.lastIndex;e<t;e++){var r=a.charCodeAt(e);if(r===10)return this.lastIndex=e+1,!0;if(r===13)return a.charCodeAt(e+1)===10?this.lastIndex=e+2:this.lastIndex=e+1,!0}return!1},lastIndex:0};hc=256;Db=[]});function $o(a,t){var e=a.tokenTypeIdx;return e===t.tokenTypeIdx?!0:t.isParent===!0&&t.categoryMatchesMap[e]===!0}function yc(a,t){return a.tokenTypeIdx===t.tokenTypeIdx}function Ui(a){var t=rie(a);nie(t),iie(t),aie(t),ee(t,function(e){e.isParent=e.categoryMatches.length>0})}function rie(a){for(var t=_t(a),e=a,r=!0;r;){e=Li(Pt(Y(e,function(i){return i.CATEGORIES})));var n=qo(e,t);t=t.concat(n),Ve(n)?r=!1:e=n}return t}function nie(a){ee(a,function(t){u6(t)||(b8[y8]=t,t.tokenTypeIdx=y8++),v8(t)&&!fr(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),v8(t)||(t.CATEGORIES=[]),sie(t)||(t.categoryMatches=[]),oie(t)||(t.categoryMatchesMap={})})}function aie(a){ee(a,function(t){t.categoryMatches=[],ee(t.categoryMatchesMap,function(e,r){t.categoryMatches.push(b8[r].tokenTypeIdx)})})}function iie(a){ee(a,function(t){g8([],t)})}function g8(a,t){ee(a,function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0}),ee(t.CATEGORIES,function(e){var r=a.concat(t);Je(r,e)||g8(r,e)})}function u6(a){return ae(a,"tokenTypeIdx")}function v8(a){return ae(a,"CATEGORIES")}function sie(a){return ae(a,"categoryMatches")}function oie(a){return ae(a,"categoryMatchesMap")}function T8(a){return ae(a,"tokenTypeIdx")}var y8,b8,bc=Ee(()=>{Me();y8=1,b8={}});var c6,p6=Ee(()=>{c6={buildUnableToPopLexerModeMessage:function(a){return"Unable to pop Lexer Mode after encountering Token ->"+a.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(a,t,e,r,n){return"unexpected character: ->"+a.charAt(t)+"<- at offset: "+t+","+(" skipped "+e+" characters.")}}});var At,Ef,Jt,wf=Ee(()=>{i6();Me();bc();p6();Eb();(function(a){a[a.MISSING_PATTERN=0]="MISSING_PATTERN",a[a.INVALID_PATTERN=1]="INVALID_PATTERN",a[a.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",a[a.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",a[a.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",a[a.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",a[a.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",a[a.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",a[a.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",a[a.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",a[a.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",a[a.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",a[a.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",a[a.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",a[a.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",a[a.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",a[a.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(At||(At={}));Ef={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:c6,traceInitPerf:!1,skipValidations:!1};Object.freeze(Ef);Jt=function(){function a(t,e){var r=this;if(e===void 0&&(e=Ef),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof e=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=e6(Ef,e);var n=this.config.traceInitPerf;n===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof n=="number"&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var i,s=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===Ef.lineTerminatorsPattern)r.config.lineTerminatorsPattern=f8;else if(r.config.lineTerminatorCharacters===Ef.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(e.safeMode&&e.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),fr(t)?(i={modes:{}},i.modes[Ls]=_t(t),i[Ls]=Ls):(s=!1,i=Bs(t))}),r.config.skipValidations===!1&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(u8(i,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(c8(i,r.trackStartLines,r.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},ee(i.modes,function(c,p){i.modes[p]=Ya(c,function(m){return Xt(m)})});var o=Xn(i.modes);if(ee(i.modes,function(c,p){r.TRACE_INIT("Mode: <"+p+"> processing",function(){if(r.modes.push(p),r.config.skipValidations===!1&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(s8(c,o))}),Ve(r.lexerDefinitionErrors)){Ui(c);var m;r.TRACE_INIT("analyzeTokenTypes",function(){m=i8(c,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:e.positionTracking,ensureOptimizations:e.ensureOptimizations,safeMode:e.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[p]=m.patternIdxToConfig,r.charCodeToPatternIdxToConfig[p]=m.charCodeToPatternIdxToConfig,r.emptyGroups=e6(r.emptyGroups,m.emptyGroups),r.hasCustom=m.hasCustom||r.hasCustom,r.canModeBeOptimized[p]=m.canBeOptimized}})}),r.defaultMode=i.defaultMode,!Ve(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var l=Y(r.lexerDefinitionErrors,function(c){return c.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}ee(r.lexerDefinitionWarning,function(c){fc(c.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(o6?(r.chopInput=t6,r.match=r.matchWithTest):(r.updateLastIndex=Zt,r.match=r.matchWithExec),s&&(r.handleModes=Zt),r.trackStartLines===!1&&(r.computeNewColumn=t6),r.trackEndLines===!1&&(r.updateTokenEndLineColumnLocation=Zt),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var c=ht(r.canModeBeOptimized,function(p,m,f){return m===!1&&p.push(f),p},[]);if(e.ensureOptimizations&&!Ve(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),r.TRACE_INIT("clearRegExpParserCache",function(){Q4()}),r.TRACE_INIT("toFastProperties",function(){Nb(r)})})}return a.prototype.tokenize=function(t,e){if(e===void 0&&(e=this.defaultMode),!Ve(this.lexerDefinitionErrors)){var r=Y(this.lexerDefinitionErrors,function(s){return s.message}),n=r.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+n)}var i=this.tokenizeInternal(t,e);return i},a.prototype.tokenizeInternal=function(t,e){var r=this,n,i,s,o,l,u,c,p,m,f,d,h,y,b,g,v=t,A=v.length,C=0,S=0,w=this.hasCustom?0:Math.floor(t.length/10),x=new Array(w),R=[],O=this.trackStartLines?1:void 0,_=this.trackStartLines?1:void 0,k=p8(this.emptyGroups),B=this.trackStartLines,U=this.config.lineTerminatorsPattern,H=0,j=[],P=[],F=[],G=[];Object.freeze(G);var z=void 0;function Z(){return j}function ne(qr){var $p=Za(qr),ql=P[$p];return ql===void 0?G:ql}var ve=function(qr){if(F.length===1&&qr.tokenType.PUSH_MODE===void 0){var $p=r.config.errorMessageProvider.buildUnableToPopLexerModeMessage(qr);R.push({offset:qr.startOffset,line:qr.startLine!==void 0?qr.startLine:void 0,column:qr.startColumn!==void 0?qr.startColumn:void 0,length:qr.image.length,message:$p})}else{F.pop();var ql=bb(F);j=r.patternIdxToConfig[ql],P=r.charCodeToPatternIdxToConfig[ql],H=j.length;var wH=r.canModeBeOptimized[ql]&&r.config.safeMode===!1;P&&wH?z=ne:z=Z}};function xe(qr){F.push(qr),P=this.charCodeToPatternIdxToConfig[qr],j=this.patternIdxToConfig[qr],H=j.length,H=j.length;var $p=this.canModeBeOptimized[qr]&&this.config.safeMode===!1;P&&$p?z=ne:z=Z}xe.call(this,e);for(var ye;C<A;){l=null;var it=v.charCodeAt(C),gr=z(it),ar=gr.length;for(n=0;n<ar;n++){ye=gr[n];var mt=ye.pattern;u=null;var jn=ye.short;if(jn!==!1?it===jn&&(l=mt):ye.isCustom===!0?(g=mt.exec(v,C,x,k),g!==null?(l=g[0],g.payload!==void 0&&(u=g.payload)):l=null):(this.updateLastIndex(mt,C),l=this.match(mt,t,C)),l!==null){if(o=ye.longerAlt,o!==void 0){var pi=j[o],fs=pi.pattern;c=null,pi.isCustom===!0?(g=fs.exec(v,C,x,k),g!==null?(s=g[0],g.payload!==void 0&&(c=g.payload)):s=null):(this.updateLastIndex(fs,C),s=this.match(fs,t,C)),s&&s.length>l.length&&(l=s,u=c,ye=pi)}break}}if(l!==null){if(p=l.length,m=ye.group,m!==void 0&&(f=ye.tokenTypeIdx,d=this.createTokenInstance(l,C,f,ye.tokenType,O,_,p),this.handlePayload(d,u),m===!1?S=this.addToken(x,S,d):k[m].push(d)),t=this.chopInput(t,p),C=C+p,_=this.computeNewColumn(_,p),B===!0&&ye.canLineTerminator===!0){var Mn=0,oa=void 0,ds=void 0;U.lastIndex=0;do oa=U.test(l),oa===!0&&(ds=U.lastIndex-1,Mn++);while(oa===!0);Mn!==0&&(O=O+Mn,_=p-ds,this.updateTokenEndLineColumnLocation(d,m,ds,Mn,O,_,p))}this.handleModes(ye,ve,xe,d)}else{for(var Gl=C,qp=O,Hl=_,Wp=!1;!Wp&&C<A;)for(y=v.charCodeAt(C),t=this.chopInput(t,1),C++,i=0;i<H;i++){var T0=j[i],mt=T0.pattern,jn=T0.short;if(jn!==!1?v.charCodeAt(C)===jn&&(Wp=!0):T0.isCustom===!0?Wp=mt.exec(v,C,x,k)!==null:(this.updateLastIndex(mt,C),Wp=mt.exec(t)!==null),Wp===!0)break}h=C-Gl,b=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(v,Gl,h,qp,Hl),R.push({offset:Gl,line:qp,column:Hl,length:h,message:b})}}return this.hasCustom||(x.length=S),{tokens:x,groups:k,errors:R}},a.prototype.handleModes=function(t,e,r,n){if(t.pop===!0){var i=t.push;e(n),i!==void 0&&r.call(this,i)}else t.push!==void 0&&r.call(this,t.push)},a.prototype.chopInput=function(t,e){return t.substring(e)},a.prototype.updateLastIndex=function(t,e){t.lastIndex=e},a.prototype.updateTokenEndLineColumnLocation=function(t,e,r,n,i,s,o){var l,u;e!==void 0&&(l=r===o-1,u=l?-1:0,n===1&&l===!0||(t.endLine=i+u,t.endColumn=s-1+-u))},a.prototype.computeNewColumn=function(t,e){return t+e},a.prototype.createTokenInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},a.prototype.createOffsetOnlyToken=function(t,e,r,n){return{image:t,startOffset:e,tokenTypeIdx:r,tokenType:n}},a.prototype.createStartOnlyToken=function(t,e,r,n,i,s){return{image:t,startOffset:e,startLine:i,startColumn:s,tokenTypeIdx:r,tokenType:n}},a.prototype.createFullToken=function(t,e,r,n,i,s,o){return{image:t,startOffset:e,endOffset:e+o-1,startLine:i,endLine:i,startColumn:s,endColumn:s+o-1,tokenTypeIdx:r,tokenType:n}},a.prototype.addToken=function(t,e,r){return 666},a.prototype.addTokenUsingPush=function(t,e,r){return t.push(r),e},a.prototype.addTokenUsingMemberAccess=function(t,e,r){return t[e]=r,e++,e},a.prototype.handlePayload=function(t,e){},a.prototype.handlePayloadNoCustom=function(t,e){},a.prototype.handlePayloadWithCustom=function(t,e){e!==null&&(t.payload=e)},a.prototype.match=function(t,e,r){return null},a.prototype.matchWithTest=function(t,e,r){var n=t.test(e);return n===!0?e.substring(r,t.lastIndex):null},a.prototype.matchWithExec=function(t,e){var r=t.exec(e);return r!==null?r[0]:r},a.prototype.TRACE_INIT=function(t,e){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+t+">");var n=Cb(e),i=n.time,s=n.value,o=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,s}else return e()},a.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",a.NA=/NOT_APPLICABLE/,a}()});function zi(a){return m6(a)?a.LABEL:a.name}function m6(a){return Yn(a.LABEL)&&a.LABEL!==""}function Oe(a){return uie(a)}function uie(a){var t=a.pattern,e={};if(e.name=a.name,Xt(t)||(e.PATTERN=t),ae(a,lie))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return ae(a,N8)&&(e.CATEGORIES=a[N8]),Ui([e]),ae(a,C8)&&(e.LABEL=a[C8]),ae(a,A8)&&(e.GROUP=a[A8]),ae(a,w8)&&(e.POP_MODE=a[w8]),ae(a,S8)&&(e.PUSH_MODE=a[S8]),ae(a,E8)&&(e.LONGER_ALT=a[E8]),ae(a,R8)&&(e.LINE_BREAKS=a[R8]),ae(a,x8)&&(e.START_CHARS_HINT=a[x8]),e}function Ko(a,t,e,r,n,i,s,o){return{image:t,startOffset:e,endOffset:r,startLine:n,endLine:i,startColumn:s,endColumn:o,tokenTypeIdx:a.tokenTypeIdx,tokenType:a}}function Ue(a,t){return $o(a,t)}var lie,N8,C8,A8,S8,w8,E8,R8,x8,ba,Us=Ee(()=>{Me();wf();bc();lie="parent",N8="categories",C8="label",A8="group",S8="push_mode",w8="pop_mode",E8="longer_alt",R8="line_breaks",x8="start_chars_hint";ba=Oe({name:"EOF",pattern:Jt.NA});Ui([ba])});function f6(a){return Y(a,Rf)}function Rf(a){function t(n){return Y(n,Rf)}if(a instanceof St)return{type:"NonTerminal",name:a.nonTerminalName,idx:a.idx};if(a instanceof yt)return{type:"Flat",definition:t(a.definition)};if(a instanceof at)return{type:"Option",idx:a.idx,definition:t(a.definition)};if(a instanceof kt)return{type:"RepetitionMandatory",name:a.name,idx:a.idx,definition:t(a.definition)};if(a instanceof Ft)return{type:"RepetitionMandatoryWithSeparator",name:a.name,idx:a.idx,separator:Rf(new Le({terminalType:a.separator})),definition:t(a.definition)};if(a instanceof wt)return{type:"RepetitionWithSeparator",name:a.name,idx:a.idx,separator:Rf(new Le({terminalType:a.separator})),definition:t(a.definition)};if(a instanceof Xe)return{type:"Repetition",name:a.name,idx:a.idx,definition:t(a.definition)};if(a instanceof Et)return{type:"Alternation",name:a.name,idx:a.idx,definition:t(a.definition)};if(a instanceof Le){var e={type:"Terminal",name:a.terminalType.name,label:zi(a.terminalType),idx:a.idx},r=a.terminalType.PATTERN;return a.terminalType.PATTERN&&(e.pattern=ya(r)?r.source:r),e}else{if(a instanceof Jn)return{type:"Rule",name:a.name,orgText:a.orgText,definition:t(a.definition)};throw Error("non exhaustive match")}}var Gi,ga,St,Jn,yt,at,kt,Ft,Xe,wt,Et,Le,Ur=Ee(()=>{Me();Us();Gi=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ga=function(){function a(t){this.definition=t}return a.prototype.accept=function(t){t.visit(this),ee(this.definition,function(e){e.accept(t)})},a}(),St=function(a){Gi(t,a);function t(e){var r=a.call(this,[])||this;return r.idx=1,Vn(r,Zr(e,function(n){return n!==void 0})),r}return Object.defineProperty(t.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(ga),Jn=function(a){Gi(t,a);function t(e){var r=a.call(this,e.definition)||this;return r.orgText="",Vn(r,Zr(e,function(n){return n!==void 0})),r}return t}(ga),yt=function(a){Gi(t,a);function t(e){var r=a.call(this,e.definition)||this;return r.ignoreAmbiguities=!1,Vn(r,Zr(e,function(n){return n!==void 0})),r}return t}(ga),at=function(a){Gi(t,a);function t(e){var r=a.call(this,e.definition)||this;return r.idx=1,Vn(r,Zr(e,function(n){return n!==void 0})),r}return t}(ga),kt=function(a){Gi(t,a);function t(e){var r=a.call(this,e.definition)||this;return r.idx=1,Vn(r,Zr(e,function(n){return n!==void 0})),r}return t}(ga),Ft=function(a){Gi(t,a);function t(e){var r=a.call(this,e.definition)||this;return r.idx=1,Vn(r,Zr(e,function(n){return n!==void 0})),r}return t}(ga),Xe=function(a){Gi(t,a);function t(e){var r=a.call(this,e.definition)||this;return r.idx=1,Vn(r,Zr(e,function(n){return n!==void 0})),r}return t}(ga),wt=function(a){Gi(t,a);function t(e){var r=a.call(this,e.definition)||this;return r.idx=1,Vn(r,Zr(e,function(n){return n!==void 0})),r}return t}(ga),Et=function(a){Gi(t,a);function t(e){var r=a.call(this,e.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,Vn(r,Zr(e,function(n){return n!==void 0})),r}return t}(ga),Le=function(){function a(t){this.idx=1,Vn(this,Zr(t,function(e){return e!==void 0}))}return a.prototype.accept=function(t){t.visit(this)},a}()});function V8(a,t,e){var r=[new at({definition:[new Le({terminalType:a.separator})].concat(a.definition)})],n=r.concat(t,e);return n}var Xo,Ib=Ee(()=>{Me();Ur();Xo=function(){function a(){}return a.prototype.walk=function(t,e){var r=this;e===void 0&&(e=[]),ee(t.definition,function(n,i){var s=Yt(t.definition,i+1);if(n instanceof St)r.walkProdRef(n,s,e);else if(n instanceof Le)r.walkTerminal(n,s,e);else if(n instanceof yt)r.walkFlat(n,s,e);else if(n instanceof at)r.walkOption(n,s,e);else if(n instanceof kt)r.walkAtLeastOne(n,s,e);else if(n instanceof Ft)r.walkAtLeastOneSep(n,s,e);else if(n instanceof wt)r.walkManySep(n,s,e);else if(n instanceof Xe)r.walkMany(n,s,e);else if(n instanceof Et)r.walkOr(n,s,e);else throw Error("non exhaustive match")})},a.prototype.walkTerminal=function(t,e,r){},a.prototype.walkProdRef=function(t,e,r){},a.prototype.walkFlat=function(t,e,r){var n=e.concat(r);this.walk(t,n)},a.prototype.walkOption=function(t,e,r){var n=e.concat(r);this.walk(t,n)},a.prototype.walkAtLeastOne=function(t,e,r){var n=[new at({definition:t.definition})].concat(e,r);this.walk(t,n)},a.prototype.walkAtLeastOneSep=function(t,e,r){var n=V8(t,e,r);this.walk(t,n)},a.prototype.walkMany=function(t,e,r){var n=[new at({definition:t.definition})].concat(e,r);this.walk(t,n)},a.prototype.walkManySep=function(t,e,r){var n=V8(t,e,r);this.walk(t,n)},a.prototype.walkOr=function(t,e,r){var n=this,i=e.concat(r);ee(t.definition,function(s){var o=new yt({definition:[s]});n.walk(o,i)})},a}()});var On,Yo=Ee(()=>{Ur();On=function(){function a(){}return a.prototype.visit=function(t){var e=t;switch(e.constructor){case St:return this.visitNonTerminal(e);case yt:return this.visitFlat(e);case at:return this.visitOption(e);case kt:return this.visitRepetitionMandatory(e);case Ft:return this.visitRepetitionMandatoryWithSeparator(e);case wt:return this.visitRepetitionWithSeparator(e);case Xe:return this.visitRepetition(e);case Et:return this.visitAlternation(e);case Le:return this.visitTerminal(e);case Jn:return this.visitRule(e);default:throw Error("non exhaustive match")}},a.prototype.visitNonTerminal=function(t){},a.prototype.visitFlat=function(t){},a.prototype.visitOption=function(t){},a.prototype.visitRepetition=function(t){},a.prototype.visitRepetitionMandatory=function(t){},a.prototype.visitRepetitionMandatoryWithSeparator=function(t){},a.prototype.visitRepetitionWithSeparator=function(t){},a.prototype.visitAlternation=function(t){},a.prototype.visitTerminal=function(t){},a.prototype.visitRule=function(t){},a}()});function O8(a){return a instanceof yt||a instanceof at||a instanceof Xe||a instanceof kt||a instanceof Ft||a instanceof wt||a instanceof Le||a instanceof Jn}function gc(a,t){t===void 0&&(t=[]);var e=a instanceof at||a instanceof Xe||a instanceof wt;return e?!0:a instanceof Et?vb(a.definition,function(r){return gc(r,t)}):a instanceof St&&Je(t,a)?!1:a instanceof ga?(a instanceof St&&t.push(a),Or(a.definition,function(r){return gc(r,t)})):!1}function D8(a){return a instanceof Et}function dn(a){if(a instanceof St)return"SUBRULE";if(a instanceof at)return"OPTION";if(a instanceof Et)return"OR";if(a instanceof kt)return"AT_LEAST_ONE";if(a instanceof Ft)return"AT_LEAST_ONE_SEP";if(a instanceof wt)return"MANY_SEP";if(a instanceof Xe)return"MANY";if(a instanceof Le)return"CONSUME";throw Error("non exhaustive match")}function P8(a){Pb.reset(),a.accept(Pb);var t=Pb.dslMethods;return Pb.reset(),t}var cie,I8,Pb,vc=Ee(()=>{Me();Ur();Yo();cie=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();I8=function(a){cie(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}return t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var r=e.terminalType.name+this.separator+"Terminal";ae(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(e)},t.prototype.visitNonTerminal=function(e){var r=e.nonTerminalName+this.separator+"Terminal";ae(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(On),Pb=new I8});function Zo(a){if(a instanceof St)return Zo(a.referencedRule);if(a instanceof Le)return fie(a);if(O8(a))return pie(a);if(D8(a))return mie(a);throw Error("non exhaustive match")}function pie(a){for(var t=[],e=a.definition,r=0,n=e.length>r,i,s=!0;n&&s;)i=e[r],s=gc(i),t=t.concat(Zo(i)),r=r+1,n=e.length>r;return Nf(t)}function mie(a){var t=Y(a.definition,function(e){return Zo(e)});return Nf(Pt(t))}function fie(a){return[a.terminalType]}var d6=Ee(()=>{Me();Ur();vc()});var _b,h6=Ee(()=>{_b="_~IN~_"});function _8(a){var t={};return ee(a,function(e){var r=new hie(e).startWalking();Vn(t,r)}),t}function yie(a,t){return a.name+t+_b}var die,hie,k8=Ee(()=>{Ib();d6();Me();h6();Ur();die=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),hie=function(a){die(t,a);function t(e){var r=a.call(this)||this;return r.topProd=e,r.follows={},r}return t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,r,n){},t.prototype.walkProdRef=function(e,r,n){var i=yie(e.referencedRule,e.idx)+this.topProd.name,s=r.concat(n),o=new yt({definition:s}),l=Zo(o);this.follows[i]=l},t}(Xo)});function Qo(a,t,e){return e|t|a}function kb(a,t,e,r){var n=r+1<<gie;return Qo(a,t,e)|n}var F8,Qa,bie,Hi,Jo,zs,Gs,Hs,qi,gie,Tc=Ee(()=>{F8=4,Qa=8,bie=8,Hi=1<<Qa,Jo=2<<Qa,zs=3<<Qa,Gs=4<<Qa,Hs=5<<Qa,qi=6<<Qa;gie=32-bie});function y6(a,t){isNaN(a.startOffset)===!0?(a.startOffset=t.startOffset,a.endOffset=t.endOffset):a.endOffset<t.endOffset&&(a.endOffset=t.endOffset)}function b6(a,t){isNaN(a.startOffset)===!0?(a.startOffset=t.startOffset,a.startColumn=t.startColumn,a.startLine=t.startLine,a.endOffset=t.endOffset,a.endColumn=t.endColumn,a.endLine=t.endLine):a.endOffset<t.endOffset&&(a.endOffset=t.endOffset,a.endColumn=t.endColumn,a.endLine=t.endLine)}function j8(a,t,e){a.children[e]===void 0?a.children[e]=[t]:a.children[e].push(t)}function g6(a,t,e){a.children[t]===void 0?a.children[t]=[e]:a.children[t].push(e)}function M8(a,t){var e={allRuleNames:[]};return ee(a,function(r){var n=t[r.name];e.allRuleNames.push(r.name);var i=new Fb(n);r.accept(i),ee(i.result,function(s){var o=s.def,l=s.key,u=s.name;e.allRuleNames.push(r.name+u)})}),e}var vie,Fb,jb=Ee(()=>{Me();Tc();Ur();Yo();vie=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Fb=function(a){vie(t,a);function t(e){var r=a.call(this)||this;return r.result=[],r.ruleIdx=e,r}return t.prototype.collectNamedDSLMethod=function(e,r,n){if(!Xt(e.name)){var i=void 0;if(e instanceof at||e instanceof Xe||e instanceof kt||e instanceof Et)i=new r({definition:e.definition,idx:e.idx});else if(e instanceof Ft||e instanceof wt)i=new r({definition:e.definition,idx:e.idx,separator:e.separator});else throw Error("non exhaustive match");var s=[i],o=Qo(this.ruleIdx,n,e.idx);this.result.push({def:s,key:o,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,at,Jo)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,Xe,zs)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,kt,Gs)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,Ft,qi)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,wt,Hs)},t.prototype.visitAlternation=function(e){var r=this;this.collectNamedDSLMethod(e,Et,Hi);var n=e.definition.length>1;ee(e.definition,function(i,s){if(!Xt(i.name)){var o=i.definition;n?o=[new at({definition:i.definition})]:o=i.definition;var l=kb(r.ruleIdx,Hi,e.idx,s);r.result.push({def:o,key:l,name:i.name,orgProd:i})}})},t}(On)});function Bb(a,t,e){e===void 0&&(e=[]),e=_t(e);var r=[],n=0;function i(u){return u.concat(Yt(a,n+1))}function s(u){var c=Bb(i(u),t,e);return r.concat(c)}for(;e.length<t&&n<a.length;){var o=a[n];if(o instanceof yt)return s(o.definition);if(o instanceof St)return s(o.definition);if(o instanceof at)r=s(o.definition);else if(o instanceof kt){var l=o.definition.concat([new Xe({definition:o.definition})]);return s(l)}else if(o instanceof Ft){var l=[new yt({definition:o.definition}),new Xe({definition:[new Le({terminalType:o.separator})].concat(o.definition)})];return s(l)}else if(o instanceof wt){var l=o.definition.concat([new Xe({definition:[new Le({terminalType:o.separator})].concat(o.definition)})]);r=s(l)}else if(o instanceof Xe){var l=o.definition.concat([new Xe({definition:o.definition})]);r=s(l)}else{if(o instanceof Et)return ee(o.definition,function(u){r=s(u.definition)}),r;if(o instanceof Le)e.push(o.terminalType);else throw Error("non exhaustive match")}n++}return r.push({partialPath:e,suffixDef:Yt(a,n)}),r}function Lb(a,t,e,r){var n="EXIT_NONE_TERMINAL",i=[n],s="EXIT_ALTERNATIVE",o=!1,l=t.length,u=l-r-1,c=[],p=[];for(p.push({idx:-1,def:a,ruleStack:[],occurrenceStack:[]});!Ve(p);){var m=p.pop();if(m===s){o&&bb(p).idx<=u&&p.pop();continue}var f=m.def,d=m.idx,h=m.ruleStack,y=m.occurrenceStack;if(!Ve(f)){var b=f[0];if(b===n){var g={idx:d,def:Yt(f),ruleStack:Ms(h),occurrenceStack:Ms(y)};p.push(g)}else if(b instanceof Le)if(d<l-1){var v=d+1,A=t[v];if(e(A,b.terminalType)){var g={idx:v,def:Yt(f),ruleStack:h,occurrenceStack:y};p.push(g)}}else if(d===l-1)c.push({nextTokenType:b.terminalType,nextTokenOccurrence:b.idx,ruleStack:h,occurrenceStack:y}),o=!0;else throw Error("non exhaustive match");else if(b instanceof St){var C=_t(h);C.push(b.nonTerminalName);var S=_t(y);S.push(b.idx);var g={idx:d,def:b.definition.concat(i,Yt(f)),ruleStack:C,occurrenceStack:S};p.push(g)}else if(b instanceof at){var w={idx:d,def:Yt(f),ruleStack:h,occurrenceStack:y};p.push(w),p.push(s);var x={idx:d,def:b.definition.concat(Yt(f)),ruleStack:h,occurrenceStack:y};p.push(x)}else if(b instanceof kt){var R=new Xe({definition:b.definition,idx:b.idx}),O=b.definition.concat([R],Yt(f)),g={idx:d,def:O,ruleStack:h,occurrenceStack:y};p.push(g)}else if(b instanceof Ft){var _=new Le({terminalType:b.separator}),R=new Xe({definition:[_].concat(b.definition),idx:b.idx}),O=b.definition.concat([R],Yt(f)),g={idx:d,def:O,ruleStack:h,occurrenceStack:y};p.push(g)}else if(b instanceof wt){var w={idx:d,def:Yt(f),ruleStack:h,occurrenceStack:y};p.push(w),p.push(s);var _=new Le({terminalType:b.separator}),k=new Xe({definition:[_].concat(b.definition),idx:b.idx}),O=b.definition.concat([k],Yt(f)),x={idx:d,def:O,ruleStack:h,occurrenceStack:y};p.push(x)}else if(b instanceof Xe){var w={idx:d,def:Yt(f),ruleStack:h,occurrenceStack:y};p.push(w),p.push(s);var k=new Xe({definition:b.definition,idx:b.idx}),O=b.definition.concat([k],Yt(f)),x={idx:d,def:O,ruleStack:h,occurrenceStack:y};p.push(x)}else if(b instanceof Et)for(var B=b.definition.length-1;B>=0;B--){var U=b.definition[B],H={idx:d,def:U.definition.concat(Yt(f)),ruleStack:h,occurrenceStack:y};p.push(H),p.push(s)}else if(b instanceof yt)p.push({idx:d,def:b.definition.concat(Yt(f)),ruleStack:h,occurrenceStack:y});else if(b instanceof Jn)p.push(Nie(b,d,h,y));else throw Error("non exhaustive match")}}return c}function Nie(a,t,e,r){var n=_t(e);n.push(a.name);var i=_t(r);return i.push(1),{idx:t,def:a.definition,ruleStack:n,occurrenceStack:i}}var el,Tie,B8,Mb,L8,v6,U8,T6,xf=Ee(()=>{Ib();Me();d6();Ur();el=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Tie=function(a){el(t,a);function t(e,r){var n=a.call(this)||this;return n.topProd=e,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=_t(this.path.ruleStack).reverse(),this.occurrenceStack=_t(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(e,r){r===void 0&&(r=[]),this.found||a.prototype.walk.call(this,e,r)},t.prototype.walkProdRef=function(e,r,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var i=r.concat(n);this.updateExpectedNext(),this.walk(e.referencedRule,i)}},t.prototype.updateExpectedNext=function(){Ve(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(Xo),B8=function(a){el(t,a);function t(e,r){var n=a.call(this,e,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return t.prototype.walkTerminal=function(e,r,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var i=r.concat(n),s=new yt({definition:i});this.possibleTokTypes=Zo(s),this.found=!0}},t}(Tie),Mb=function(a){el(t,a);function t(e,r){var n=a.call(this)||this;return n.topRule=e,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(Xo),L8=function(a){el(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t.prototype.walkMany=function(e,r,n){if(e.idx===this.occurrence){var i=Vr(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof Le&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else a.prototype.walkMany.call(this,e,r,n)},t}(Mb),v6=function(a){el(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t.prototype.walkManySep=function(e,r,n){if(e.idx===this.occurrence){var i=Vr(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof Le&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else a.prototype.walkManySep.call(this,e,r,n)},t}(Mb),U8=function(a){el(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t.prototype.walkAtLeastOne=function(e,r,n){if(e.idx===this.occurrence){var i=Vr(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof Le&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else a.prototype.walkAtLeastOne.call(this,e,r,n)},t}(Mb),T6=function(a){el(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t.prototype.walkAtLeastOneSep=function(e,r,n){if(e.idx===this.occurrence){var i=Vr(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof Le&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else a.prototype.walkAtLeastOneSep.call(this,e,r,n)},t}(Mb)});function G8(a){if(a instanceof at)return Qe.OPTION;if(a instanceof Xe)return Qe.REPETITION;if(a instanceof kt)return Qe.REPETITION_MANDATORY;if(a instanceof Ft)return Qe.REPETITION_MANDATORY_WITH_SEPARATOR;if(a instanceof wt)return Qe.REPETITION_WITH_SEPARATOR;if(a instanceof Et)return Qe.ALTERNATION;throw Error("non exhaustive match")}function H8(a,t,e,r,n,i){var s=Vf(a,t,e),o=J8(s)?yc:$o;return i(s,r,o,n)}function q8(a,t,e,r,n,i){var s=Of(a,t,n,e),o=J8(s)?yc:$o;return i(s[0],o,r)}function W8(a,t,e,r){var n=a.length,i=Or(a,function(l){return Or(l,function(u){return u.length===1})});if(t)return function(l){for(var u=Y(l,function(v){return v.GATE}),c=0;c<n;c++){var p=a[c],m=p.length,f=u[c];if(f!==void 0&&f.call(this)===!1)continue;e:for(var d=0;d<m;d++){for(var h=p[d],y=h.length,b=0;b<y;b++){var g=this.LA(b+1);if(e(g,h[b])===!1)continue e}return c}}};if(i&&!r){var s=Y(a,function(l){return Pt(l)}),o=ht(s,function(l,u,c){return ee(u,function(p){ae(l,p.tokenTypeIdx)||(l[p.tokenTypeIdx]=c),ee(p.categoryMatches,function(m){ae(l,m)||(l[m]=c)})}),l},[]);return function(){var l=this.LA(1);return o[l.tokenTypeIdx]}}else return function(){for(var l=0;l<n;l++){var u=a[l],c=u.length;e:for(var p=0;p<c;p++){for(var m=u[p],f=m.length,d=0;d<f;d++){var h=this.LA(d+1);if(e(h,m[d])===!1)continue e}return l}}}}function $8(a,t,e){var r=Or(a,function(u){return u.length===1}),n=a.length;if(r&&!e){var i=Pt(a);if(i.length===1&&Ve(i[0].categoryMatches)){var s=i[0],o=s.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{var l=ht(i,function(u,c,p){return u[c.tokenTypeIdx]=!0,ee(c.categoryMatches,function(m){u[m]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<n;u++){for(var c=a[u],p=c.length,m=0;m<p;m++){var f=this.LA(m+1);if(t(f,c[m])===!1)continue e}return!0}return!1}}function X8(a){for(var t=new Array(a),e=0;e<a;e++)t[e]=[];return t}function N6(a){for(var t=[""],e=0;e<a.length;e++){for(var r=a[e],n=[],i=0;i<t.length;i++){var s=t[i];n.push(s+"_"+r.tokenTypeIdx);for(var o=0;o<r.categoryMatches.length;o++){var l="_"+r.categoryMatches[o];n.push(s+l)}}t=n}return t}function Aie(a,t,e){for(var r=0;r<a.length;r++)if(r!==e)for(var n=a[r],i=0;i<t.length;i++){var s=t[i];if(n[s]===!0)return!1}return!0}function Y8(a,t){for(var e=Y(a,function(c){return Bb([c],1)}),r=X8(e.length),n=Y(e,function(c){var p={};return ee(c,function(m){var f=N6(m.partialPath);ee(f,function(d){p[d]=!0})}),p}),i=e,s=1;s<=t;s++){var o=i;i=X8(o.length);for(var l=function(c){for(var p=o[c],m=0;m<p.length;m++){var f=p[m].partialPath,d=p[m].suffixDef,h=N6(f),y=Aie(n,h,c);if(y||Ve(d)||f.length===t){var b=r[c];if(Ub(b,f)===!1){b.push(f);for(var g=0;g<h.length;g++){var v=h[g];n[c][v]=!0}}}else{var A=Bb(d,s+1,f);i[c]=i[c].concat(A),ee(A,function(C){var S=N6(C.partialPath);ee(S,function(w){n[c][w]=!0})})}}},u=0;u<o.length;u++)l(u)}return r}function Vf(a,t,e,r){var n=new K8(a,Qe.ALTERNATION,r);return t.accept(n),Y8(n.result,e)}function Of(a,t,e,r){var n=new K8(a,e);t.accept(n);var i=n.result,s=new Cie(t,a,e),o=s.startWalking(),l=new yt({definition:i}),u=new yt({definition:o});return Y8([l,u],r)}function Ub(a,t){e:for(var e=0;e<a.length;e++){var r=a[e];if(r.length===t.length){for(var n=0;n<r.length;n++){var i=t[n],s=r[n],o=i===s||s.categoryMatchesMap[i.tokenTypeIdx]!==void 0;if(o===!1)continue e}return!0}}return!1}function Z8(a,t){return a.length<t.length&&Or(a,function(e,r){var n=t[r];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]})}function J8(a){return Or(a,function(t){return Or(t,function(e){return Or(e,function(r){return Ve(r.categoryMatches)})})})}var z8,Qe,Cie,K8,Df=Ee(()=>{Me();xf();Ib();bc();Ur();Yo();z8=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(a){a[a.OPTION=0]="OPTION",a[a.REPETITION=1]="REPETITION",a[a.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",a[a.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",a[a.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",a[a.ALTERNATION=5]="ALTERNATION"})(Qe||(Qe={}));Cie=function(a){z8(t,a);function t(e,r,n){var i=a.call(this)||this;return i.topProd=e,i.targetOccurrence=r,i.targetProdType=n,i}return t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,r,n,i){return e.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=n.concat(i),!0):!1},t.prototype.walkOption=function(e,r,n){this.checkIsTarget(e,Qe.OPTION,r,n)||a.prototype.walkOption.call(this,e,r,n)},t.prototype.walkAtLeastOne=function(e,r,n){this.checkIsTarget(e,Qe.REPETITION_MANDATORY,r,n)||a.prototype.walkOption.call(this,e,r,n)},t.prototype.walkAtLeastOneSep=function(e,r,n){this.checkIsTarget(e,Qe.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||a.prototype.walkOption.call(this,e,r,n)},t.prototype.walkMany=function(e,r,n){this.checkIsTarget(e,Qe.REPETITION,r,n)||a.prototype.walkOption.call(this,e,r,n)},t.prototype.walkManySep=function(e,r,n){this.checkIsTarget(e,Qe.REPETITION_WITH_SEPARATOR,r,n)||a.prototype.walkOption.call(this,e,r,n)},t}(Xo),K8=function(a){z8(t,a);function t(e,r,n){var i=a.call(this)||this;return i.targetOccurrence=e,i.targetProdType=r,i.targetRef=n,i.result=[],i}return t.prototype.checkIsTarget=function(e,r){e.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,Qe.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,Qe.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,Qe.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,Qe.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,Qe.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,Qe.ALTERNATION)},t}(On)});function Q8(a,t,e,r,n,i){var s=Y(a,function(g){return wie(g,n)}),o=Y(a,function(g){return r9(g,g,n)}),l=[],u=[],c=[];Or(o,Ve)&&(l=Y(a,function(g){return Iie(g,n)}),u=Y(a,function(g){return Pie(g,t,r,n)}),c=Fie(a,t,n));var p=Bie(a,e,n),m=Y(e,function(g){return Oie(g,n)}),f=Sie(a,n),d=Lie(a,n),h=Y(a,function(g){return kie(g,n)}),y=Y(a,function(g){return xie(g,n)}),b=Y(a,function(g){return Die(g,a,i,n)});return Pt(s.concat(m,f,d,c,o,l,u,p,h,y,b))}function Sie(a,t){var e=[];return ee(a,function(r){var n=new Fb("");r.accept(n);var i=Y(n.result,function(s){return s.orgProd});e.push(Y(i,function(s){return Vie(r,s,t)}))}),Pt(e)}function wie(a,t){var e=new Rie;a.accept(e);var r=e.allProductions,n=Tb(r,Eie),i=Zr(n,function(o){return o.length>1}),s=Y(Ct(i),function(o){var l=Vr(o),u=t.buildDuplicateFoundError(a,o),c=dn(l),p={message:u,type:jt.DUPLICATE_PRODUCTIONS,ruleName:a.name,dslName:c,occurrence:l.idx},m=e9(l);return m&&(p.parameter=m),p});return s}function Eie(a){return dn(a)+"_#_"+a.idx+"_#_"+e9(a)}function e9(a){return a instanceof Le?a.terminalType.name:a instanceof St?a.nonTerminalName:""}function xie(a,t){var e=[],r=a.name;return r.match(qs)||e.push({message:t.buildInvalidRuleNameError({topLevelRule:a,expectedPattern:qs}),type:jt.INVALID_RULE_NAME,ruleName:r}),e}function Vie(a,t,e){var r=[],n;return t.name.match(A6)||(n=e.buildInvalidNestedRuleNameError(a,t),r.push({message:n,type:jt.INVALID_NESTED_RULE_NAME,ruleName:a.name})),r}function Oie(a,t){var e=[],r=a.name;return r.match(qs)||e.push({message:t.buildTokenNameError({tokenType:a,expectedPattern:qs}),type:jt.INVALID_TOKEN_NAME}),e}function Die(a,t,e,r){var n=[],i=ht(t,function(o,l){return l.name===a.name?o+1:o},0);if(i>1){var s=r.buildDuplicateRuleNameError({topLevelRule:a,grammarName:e});n.push({message:s,type:jt.DUPLICATE_RULE_NAME,ruleName:a.name})}return n}function t9(a,t,e){var r=[],n;return Je(t,a)||(n="Invalid rule override, rule: ->"+a+"<- cannot be overridden in the grammar: ->"+e+"<-as it is not defined in any of the super grammars ",r.push({message:n,type:jt.INVALID_RULE_OVERRIDE,ruleName:a})),r}function r9(a,t,e,r){r===void 0&&(r=[]);var n=[],i=zb(t.definition);if(Ve(i))return[];var s=a.name,o=Je(i,a);o&&n.push({message:e.buildLeftRecursionError({topLevelRule:a,leftRecursionPath:r}),type:jt.LEFT_RECURSION,ruleName:s});var l=qo(i,r.concat([a])),u=Y(l,function(c){var p=_t(r);return p.push(c),r9(a,c,e,p)});return n.concat(Pt(u))}function zb(a){var t=[];if(Ve(a))return t;var e=Vr(a);if(e instanceof St)t.push(e.referencedRule);else if(e instanceof yt||e instanceof at||e instanceof kt||e instanceof Ft||e instanceof wt||e instanceof Xe)t=t.concat(zb(e.definition));else if(e instanceof Et)t=Pt(Y(e.definition,function(s){return zb(s.definition)}));else if(!(e instanceof Le))throw Error("non exhaustive match");var r=gc(e),n=a.length>1;if(r&&n){var i=Yt(a);return t.concat(zb(i))}else return t}function Iie(a,t){var e=new S6;a.accept(e);var r=e.alternations,n=ht(r,function(i,s){var o=Ms(s.definition),l=Y(o,function(u,c){var p=Lb([u],[],null,1);return Ve(p)?{message:t.buildEmptyAlternationError({topLevelRule:a,alternation:s,emptyChoiceIdx:c}),type:jt.NONE_LAST_EMPTY_ALT,ruleName:a.name,occurrence:s.idx,alternative:c+1}:null});return i.concat(Li(l))},[]);return n}function Pie(a,t,e,r){var n=new S6;a.accept(n);var i=n.alternations,s=e[a.name];s&&(i=Ya(i,function(l){return s[dn(l)+(l.idx===0?"":l.idx)]})),i=Ya(i,function(l){return l.ignoreAmbiguities===!0});var o=ht(i,function(l,u){var c=u.idx,p=u.maxLookahead||t,m=Vf(c,a,p,u),f=jie(m,u,a,r),d=Mie(m,u,a,r);return l.concat(f,d)},[]);return o}function kie(a,t){var e=new S6;a.accept(e);var r=e.alternations,n=ht(r,function(i,s){return s.definition.length>255&&i.push({message:t.buildTooManyAlternativesError({topLevelRule:a,alternation:s}),type:jt.TOO_MANY_ALTS,ruleName:a.name,occurrence:s.idx}),i},[]);return n}function Fie(a,t,e){var r=[];return ee(a,function(n){var i=new _ie;n.accept(i);var s=i.allProductions;ee(s,function(o){var l=G8(o),u=o.maxLookahead||t,c=o.idx,p=Of(c,n,l,u),m=p[0];if(Ve(Pt(m))){var f=e.buildEmptyRepetitionError({topLevelRule:n,repetition:o});r.push({message:f,type:jt.NO_NON_EMPTY_LOOKAHEAD,ruleName:n.name})}})}),r}function jie(a,t,e,r){var n=[],i=ht(a,function(o,l,u){return t.definition[u].ignoreAmbiguities===!0||ee(l,function(c){var p=[u];ee(a,function(m,f){u!==f&&Ub(m,c)&&t.definition[f].ignoreAmbiguities!==!0&&p.push(f)}),p.length>1&&!Ub(n,c)&&(n.push(c),o.push({alts:p,path:c}))}),o},[]),s=Y(i,function(o){var l=Y(o.alts,function(c){return c+1}),u=r.buildAlternationAmbiguityError({topLevelRule:e,alternation:t,ambiguityIndices:l,prefixPath:o.path});return{message:u,type:jt.AMBIGUOUS_ALTS,ruleName:e.name,occurrence:t.idx,alternatives:[o.alts]}});return s}function Mie(a,t,e,r){var n=[],i=ht(a,function(s,o,l){var u=Y(o,function(c){return{idx:l,path:c}});return s.concat(u)},[]);return ee(i,function(s){var o=t.definition[s.idx];if(o.ignoreAmbiguities!==!0){var l=s.idx,u=s.path,c=$4(i,function(m){return t.definition[m.idx].ignoreAmbiguities!==!0&&m.idx<l&&Z8(m.path,u)}),p=Y(c,function(m){var f=[m.idx+1,l+1],d=t.idx===0?"":t.idx,h=r.buildAlternationPrefixAmbiguityError({topLevelRule:e,alternation:t,ambiguityIndices:f,prefixPath:m.path});return{message:h,type:jt.AMBIGUOUS_PREFIX_ALTS,ruleName:e.name,occurrence:d,alternatives:f}});n=n.concat(p)}}),n}function Bie(a,t,e){var r=[],n=Y(t,function(i){return i.name});return ee(a,function(i){var s=i.name;if(Je(n,s)){var o=e.buildNamespaceConflictError(i);r.push({message:o,type:jt.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:s})}}),r}function Lie(a,t){var e=[];return ee(a,function(r){var n=new Fb("");r.accept(n);var i=Tb(n.result,function(o){return o.name}),s=Zr(i,function(o){return o.length>1});ee(Ct(s),function(o){var l=Y(o,function(c){return c.orgProd}),u=t.buildDuplicateNestedRuleNameError(r,l);e.push({message:u,type:jt.DUPLICATE_NESTED_NAME,ruleName:r.name})})}),e}var C6,Rie,qs,A6,S6,_ie,If=Ee(()=>{Me();Me();Dn();vc();Df();jb();xf();Ur();Yo();C6=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Rie=function(a){C6(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.allProductions=[],e}return t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(On),qs=/^[a-zA-Z_]\w*$/,A6=new RegExp(qs.source.replace("^","^\\$"));S6=function(a){C6(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.alternations=[],e}return t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(On);_ie=function(a){C6(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.allProductions=[],e}return t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(On)});var Gb,w6,tl,Pf=Ee(()=>{Us();Me();Me();Ur();vc();If();Gb={buildMismatchTokenMessage:function(a){var t=a.expected,e=a.actual,r=a.previous,n=a.ruleName,i=m6(t),s=i?"--> "+zi(t)+" <--":"token of type --> "+t.name+" <--",o="Expecting "+s+" but found --> '"+e.image+"' <--";return o},buildNotAllInputParsedMessage:function(a){var t=a.firstRedundant,e=a.ruleName;return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(a){var t=a.expectedPathsPerAlt,e=a.actual,r=a.previous,n=a.customUserDescription,i=a.ruleName,s="Expecting: ",o=Vr(e).image,l=`
but found: '`+o+"'";if(n)return s+n+l;var u=ht(t,function(f,d){return f.concat(d)},[]),c=Y(u,function(f){return"["+Y(f,function(d){return zi(d)}).join(", ")+"]"}),p=Y(c,function(f,d){return"  "+(d+1)+". "+f}),m=`one of these possible Token sequences:
`+p.join(`
`);return s+m+l},buildEarlyExitMessage:function(a){var t=a.expectedIterationPaths,e=a.actual,r=a.customUserDescription,n=a.ruleName,i="Expecting: ",s=Vr(e).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var l=Y(t,function(c){return"["+Y(c,function(p){return zi(p)}).join(",")+"]"}),u=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+l.join(" ,")+">");return i+u+o}};Object.freeze(Gb);w6={buildRuleNotFoundError:function(a,t){var e="Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+`<-
inside top level rule: ->`+a.name+"<-";return e}},tl={buildDuplicateFoundError:function(a,t){function e(c){return c instanceof Le?c.terminalType.name:c instanceof St?c.nonTerminalName:""}var r=a.name,n=Vr(t),i=n.idx,s=dn(n),o=e(n),l=i>0,u="->"+s+(l?i:"")+"<- "+(o?"with argument: ->"+o+"<-":"")+`
                  appears more than once (`+t.length+" times) in the top level rule: ->"+r+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(a,t){var e="Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+a.name+`<-
`+("it must match the pattern: ->"+A6.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return e},buildDuplicateNestedRuleNameError:function(a,t){var e=Vr(t).name,r="Duplicate nested rule name: ->"+e+"<- inside rule: ->"+a.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return r},buildNamespaceConflictError:function(a){var t=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+a.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return t},buildAlternationPrefixAmbiguityError:function(a){var t=Y(a.prefixPath,function(n){return zi(n)}).join(", "),e=a.alternation.idx===0?"":a.alternation.idx,r="Ambiguous alternatives: <"+a.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+e+"> inside <"+a.topLevelRule.name+`> Rule,
`)+("<"+t+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return r},buildAlternationAmbiguityError:function(a){var t=Y(a.prefixPath,function(n){return zi(n)}).join(", "),e=a.alternation.idx===0?"":a.alternation.idx,r="Ambiguous Alternatives Detected: <"+a.ambiguityIndices.join(" ,")+"> in <OR"+e+">"+(" inside <"+a.topLevelRule.name+`> Rule,
`)+("<"+t+`> may appears as a prefix path in all these alternatives.
`);return r=r+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError:function(a){var t=dn(a.repetition);a.repetition.idx!==0&&(t+=a.repetition.idx);var e="The repetition <"+t+"> within Rule <"+a.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return e},buildTokenNameError:function(a){var t=a.tokenType.name,e="Invalid Grammar Token name: ->"+t+"<- it must match the pattern: ->"+a.expectedPattern.toString()+"<-";return e},buildEmptyAlternationError:function(a){var t="Ambiguous empty alternative: <"+(a.emptyChoiceIdx+1)+">"+(" in <OR"+a.alternation.idx+"> inside <"+a.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return t},buildTooManyAlternativesError:function(a){var t=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+a.alternation.idx+"> inside <"+a.topLevelRule.name+`> Rule.
 has `+(a.alternation.definition.length+1)+" alternatives.");return t},buildLeftRecursionError:function(a){var t=a.topLevelRule.name,e=Y(a.leftRecursionPath,function(i){return i.name}),r=t+" --> "+e.concat([t]).join(" --> "),n=`Left Recursion found in grammar.
`+("rule: <"+t+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+r+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return n},buildInvalidRuleNameError:function(a){var t=a.topLevelRule.name,e=a.expectedPattern.toString(),r="Invalid grammar rule name: ->"+t+"<- it must match the pattern: ->"+e+"<-";return r},buildDuplicateRuleNameError:function(a){var t;a.topLevelRule instanceof Jn?t=a.topLevelRule.name:t=a.topLevelRule;var e="Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+a.grammarName+"<-";return e}}});function n9(a,t){var e=new zie(a,t);return e.resolveRefs(),e.errors}var Uie,zie,a9=Ee(()=>{Dn();Me();Yo();Uie=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();zie=function(a){Uie(t,a);function t(e,r){var n=a.call(this)||this;return n.nameToTopRule=e,n.errMsgProvider=r,n.errors=[],n}return t.prototype.resolveRefs=function(){var e=this;ee(Ct(this.nameToTopRule),function(r){e.currTopLevel=r,r.accept(e)})},t.prototype.visitNonTerminal=function(e){var r=this.nameToTopRule[e.nonTerminalName];if(r)e.referencedRule=r;else{var n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:n,type:jt.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(On)});function E6(a){a=Wo(a,{errMsgProvider:w6});var t={};return ee(a.rules,function(e){t[e.name]=e}),n9(t,a.errMsgProvider)}function R6(a){return a=Wo(a,{errMsgProvider:tl,ignoredIssues:{}}),Q8(a.rules,a.maxLookahead,a.tokenTypes,a.ignoredIssues,a.errMsgProvider,a.grammarName)}var x6=Ee(()=>{Me();a9();If();Pf();vc()});function Ws(a){return Je(u9,a.name)}function Nc(a,t,e){this.name=i9,this.message=a,this.token=t,this.previousToken=e,this.resyncedTokens=[]}function Hb(a,t,e){this.name=s9,this.message=a,this.token=t,this.previousToken=e,this.resyncedTokens=[]}function qb(a,t){this.name=l9,this.message=a,this.token=t,this.resyncedTokens=[]}function Wb(a,t,e){this.name=o9,this.message=a,this.token=t,this.previousToken=e,this.resyncedTokens=[]}var i9,s9,o9,l9,u9,Cc=Ee(()=>{Me();i9="MismatchedTokenException",s9="NoViableAltException",o9="EarlyExitException",l9="NotAllInputParsedException",u9=[i9,s9,o9,l9];Object.freeze(u9);Nc.prototype=Error.prototype;Hb.prototype=Error.prototype;qb.prototype=Error.prototype;Wb.prototype=Error.prototype});function c9(a){this.name=O6,this.message=a}function Gie(a,t,e,r,n,i,s){var o=this.getKeyForAutomaticLookahead(r,n),l=this.firstAfterRepMap[o];if(l===void 0){var u=this.getCurrRuleFullName(),c=this.getGAstProductions()[u],p=new i(c,n);l=p.startWalking(),this.firstAfterRepMap[o]=l}var m=l.token,f=l.occurrence,d=l.isEndOfRule;this.RULE_STACK.length===1&&d&&m===void 0&&(m=ba,f=1),this.shouldInRepetitionRecoveryBeTried(m,f,s)&&this.tryInRepetitionRecovery(a,t,e,m)}var V6,O6,p9,D6=Ee(()=>{Us();Me();Cc();h6();Dn();V6={},O6="InRuleRecoveryException";c9.prototype=Error.prototype;p9=function(){function a(){}return a.prototype.initRecoverable=function(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=ae(t,"recoveryEnabled")?t.recoveryEnabled:ur.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Gie)},a.prototype.getTokenToInsert=function(t){var e=Ko(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},a.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},a.prototype.tryInRepetitionRecovery=function(t,e,r,n){for(var i=this,s=this.findReSyncTokenType(),o=this.exportLexerState(),l=[],u=!1,c=this.LA(1),p=this.LA(1),m=function(){var f=i.LA(0),d=i.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:c,previous:f,ruleName:i.getCurrRuleFullName()}),h=new Nc(d,c,i.LA(0));h.resyncedTokens=Ms(l),i.SAVE_ERROR(h)};!u;)if(this.tokenMatcher(p,n)){m();return}else if(r.call(this)){m(),t.apply(this,e);return}else this.tokenMatcher(p,s)?u=!0:(p=this.SKIP_TOKEN(),this.addToResyncTokens(p,l));this.importLexerState(o)},a.prototype.shouldInRepetitionRecoveryBeTried=function(t,e,r){return!(r===!1||t===void 0||e===void 0||this.tokenMatcher(this.LA(1),t)||this.isBackTracking()||this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e)))},a.prototype.getFollowsForInRuleRecovery=function(t,e){var r=this.getCurrentGrammarPath(t,e),n=this.getNextPossibleTokenTypes(r);return n},a.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e)){var r=this.getTokenToInsert(t);return r}if(this.canRecoverWithSingleTokenDeletion(t)){var n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new c9("sad sad panda")},a.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},a.prototype.canRecoverWithSingleTokenInsertion=function(t,e){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(t)||Ve(e))return!1;var n=this.LA(1),i=Bi(e,function(s){return r.tokenMatcher(n,s)})!==void 0;return i},a.prototype.canRecoverWithSingleTokenDeletion=function(t){var e=this.tokenMatcher(this.LA(2),t);return e},a.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(e);return Je(r,t)},a.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.LA(1),r=2;;){var n=e.tokenType;if(Je(t,n))return n;e=this.LA(r),r++}},a.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return V6;var t=this.getLastExplicitRuleShortName(),e=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:e,inRule:this.shortRuleNameToFullName(r)}},a.prototype.buildFullFollowKeyStack=function(){var t=this,e=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return Ve(this.LAST_EXPLICIT_RULE_STACK)||(e=Y(this.LAST_EXPLICIT_RULE_STACK,function(n){return t.RULE_STACK[n]}),r=Y(this.LAST_EXPLICIT_RULE_STACK,function(n){return t.RULE_OCCURRENCE_STACK[n]})),Y(e,function(n,i){return i===0?V6:{ruleName:t.shortRuleNameToFullName(n),idxInCallingRule:r[i],inRule:t.shortRuleNameToFullName(e[i-1])}})},a.prototype.flattenFollowSet=function(){var t=this,e=Y(this.buildFullFollowKeyStack(),function(r){return t.getFollowSetFromFollowKey(r)});return Pt(e)},a.prototype.getFollowSetFromFollowKey=function(t){if(t===V6)return[ba];var e=t.ruleName+t.idxInCallingRule+_b+t.inRule;return this.resyncFollows[e]},a.prototype.addToResyncTokens=function(t,e){return this.tokenMatcher(t,ba)||e.push(t),e},a.prototype.reSyncTo=function(t){for(var e=[],r=this.LA(1);this.tokenMatcher(r,t)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,e);return Ms(e)},a.prototype.attemptInRepetitionRecovery=function(t,e,r,n,i,s,o){},a.prototype.getCurrentGrammarPath=function(t,e){var r=this.getHumanReadableRuleStack(),n=_t(this.RULE_OCCURRENCE_STACK),i={ruleStack:r,occurrenceStack:n,lastTok:t,lastTokOccurrence:e};return i},a.prototype.getHumanReadableRuleStack=function(){var t=this;return Ve(this.LAST_EXPLICIT_RULE_STACK)?Y(this.RULE_STACK,function(e){return t.shortRuleNameToFullName(e)}):Y(this.LAST_EXPLICIT_RULE_STACK,function(e){return t.shortRuleNameToFullName(t.RULE_STACK[e])})},a}()});var m9,f9=Ee(()=>{Df();Me();Dn();Tc();vc();m9=function(){function a(){}return a.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=ae(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:ur.dynamicTokensEnabled,this.maxLookahead=ae(t,"maxLookahead")?t.maxLookahead:ur.maxLookahead,this.lookAheadFuncsCache=r6()?new Map:[],r6()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},a.prototype.preComputeLookaheadFunctions=function(t){var e=this;ee(t,function(r){e.TRACE_INIT(r.name+" Rule Lookahead",function(){var n=P8(r),i=n.alternation,s=n.repetition,o=n.option,l=n.repetitionMandatory,u=n.repetitionMandatoryWithSeparator,c=n.repetitionWithSeparator;ee(i,function(p){var m=p.idx===0?"":p.idx;e.TRACE_INIT(""+dn(p)+m,function(){var f=H8(p.idx,r,p.maxLookahead||e.maxLookahead,p.hasPredicates,e.dynamicTokensEnabled,e.lookAheadBuilderForAlternatives),d=Qo(e.fullRuleNameToShort[r.name],Hi,p.idx);e.setLaFuncCache(d,f)})}),ee(s,function(p){e.computeLookaheadFunc(r,p.idx,zs,Qe.REPETITION,p.maxLookahead,dn(p))}),ee(o,function(p){e.computeLookaheadFunc(r,p.idx,Jo,Qe.OPTION,p.maxLookahead,dn(p))}),ee(l,function(p){e.computeLookaheadFunc(r,p.idx,Gs,Qe.REPETITION_MANDATORY,p.maxLookahead,dn(p))}),ee(u,function(p){e.computeLookaheadFunc(r,p.idx,qi,Qe.REPETITION_MANDATORY_WITH_SEPARATOR,p.maxLookahead,dn(p))}),ee(c,function(p){e.computeLookaheadFunc(r,p.idx,Hs,Qe.REPETITION_WITH_SEPARATOR,p.maxLookahead,dn(p))})})})},a.prototype.computeLookaheadFunc=function(t,e,r,n,i,s){var o=this;this.TRACE_INIT(""+s+(e===0?"":e),function(){var l=q8(e,t,i||o.maxLookahead,o.dynamicTokensEnabled,n,o.lookAheadBuilderForOptional),u=Qo(o.fullRuleNameToShort[t.name],r,e);o.setLaFuncCache(u,l)})},a.prototype.lookAheadBuilderForOptional=function(t,e,r){return $8(t,e,r)},a.prototype.lookAheadBuilderForAlternatives=function(t,e,r,n){return W8(t,e,r,n)},a.prototype.getKeyForAutomaticLookahead=function(t,e){var r=this.getLastExplicitRuleShortName();return Qo(r,t,e)},a.prototype.getLaFuncFromCache=function(t){},a.prototype.getLaFuncFromMap=function(t){return this.lookAheadFuncsCache.get(t)},a.prototype.getLaFuncFromObj=function(t){return this.lookAheadFuncsCache[t]},a.prototype.setLaFuncCache=function(t,e){},a.prototype.setLaFuncCacheUsingMap=function(t,e){this.lookAheadFuncsCache.set(t,e)},a.prototype.setLaFuncUsingObj=function(t,e){this.lookAheadFuncsCache[t]=e},a}()});function d9(a){return _f(a.constructor)}function _f(a){var t=a.name;if(t)return t;var e=a.toString().match(Hie)[1];return e}function I6(a,t){var e=Object.getOwnPropertyDescriptor(a,h9);return Xt(e)||e.configurable?(Object.defineProperty(a,h9,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0):!1}var Hie,h9,P6=Ee(()=>{Me();Hie=/^\s*function\s*(\S*)\s*\(/,h9="name"});function qie(a,t){for(var e=Xn(a),r=e.length,n=0;n<r;n++)for(var i=e[n],s=a[i],o=s.length,l=0;l<o;l++){var u=s[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,t):this[u.name](u.children,t))}}function y9(a,t){var e=function(){};I6(e,a+"BaseSemantics");var r={visit:function(n,i){if(fr(n)&&(n=n[0]),!Xt(n))return n.fullName!==void 0?this[n.fullName](n.children,i):this[n.name](n.children,i)},validateVisitor:function(){var n=Wie(this,t);if(!Ve(n)){var i=Y(n,function(s){return s.msg});throw Error("Errors Detected in CST Visitor <"+_f(this.constructor)+`>:
	`+(""+i.join(`

`).replace(/\n/g,`
	`)))}}};return e.prototype=r,e.prototype.constructor=e,e._RULE_NAMES=t,e}function b9(a,t,e){var r=function(){};I6(r,a+"BaseSemanticsWithDefaults");var n=Object.create(e.prototype);return ee(t,function(i){n[i]=qie}),r.prototype=n,r.prototype.constructor=r,r}function Wie(a,t){var e=$ie(a,t),r=Xie(a,t);return e.concat(r)}function $ie(a,t){var e=Y(t,function(r){if(!ha(a[r]))return{msg:"Missing visitor method: <"+r+"> on "+_f(a.constructor)+" CST Visitor.",type:$b.MISSING_METHOD,methodName:r}});return Li(e)}function Xie(a,t){var e=[];for(var r in a)qs.test(r)&&ha(a[r])&&!Je(Kie,r)&&!Je(t,r)&&e.push({msg:"Redundant visitor method: <"+r+"> on "+_f(a.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+qs.source+"/."),type:$b.REDUNDANT_METHOD,methodName:r});return e}var $b,Kie,g9=Ee(()=>{Me();P6();If();(function(a){a[a.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",a[a.MISSING_METHOD=1]="MISSING_METHOD"})($b||($b={}));Kie=["constructor","visit","validateVisitor"]});var v9,T9=Ee(()=>{jb();Me();g9();Tc();Dn();v9=function(){function a(){}return a.prototype.initTreeBuilder=function(t){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=ae(t,"outputCst")?t.outputCst:ur.outputCst,this.nodeLocationTracking=ae(t,"nodeLocationTracking")?t.nodeLocationTracking:ur.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Zt,this.cstFinallyStateUpdate=Zt,this.cstPostTerminal=Zt,this.cstPostNonTerminal=Zt,this.cstPostRule=Zt,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=b6,this.setNodeLocationFromNode=b6,this.cstPostRule=Zt,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Zt,this.setNodeLocationFromNode=Zt,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=y6,this.setNodeLocationFromNode=y6,this.cstPostRule=Zt,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Zt,this.setNodeLocationFromNode=Zt,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Zt,this.setNodeLocationFromNode=Zt,this.cstPostRule=Zt,this.setInitialNodeLocation=Zt;else throw Error('Invalid <nodeLocationTracking> config option: "'+t.nodeLocationTracking+'"')},a.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},a.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},a.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},a.prototype.setInitialNodeLocationFullRegular=function(t){var e=this.LA(1);t.location={startOffset:e.startOffset,startLine:e.startLine,startColumn:e.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},a.prototype.cstNestedInvocationStateUpdate=function(t,e){var r={name:t,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+t,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},a.prototype.cstInvocationStateUpdate=function(t,e){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:t,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},a.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},a.prototype.cstNestedFinallyStateUpdate=function(){var t=this.CST_STACK.pop();this.cstPostRule(t)},a.prototype.cstPostRuleFull=function(t){var e=this.LA(0),r=t.location;r.startOffset<=e.startOffset?(r.endOffset=e.endOffset,r.endLine=e.endLine,r.endColumn=e.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},a.prototype.cstPostRuleOnlyOffset=function(t){var e=this.LA(0),r=t.location;r.startOffset<=e.startOffset?r.endOffset=e.endOffset:r.startOffset=NaN},a.prototype.cstPostTerminal=function(t,e){var r=this.CST_STACK[this.CST_STACK.length-1];j8(r,e,t),this.setNodeLocationFromToken(r.location,e)},a.prototype.cstPostNonTerminal=function(t,e){if(this.isBackTracking()!==!0){var r=this.CST_STACK[this.CST_STACK.length-1];g6(r,e,t),this.setNodeLocationFromNode(r.location,t.location)}},a.prototype.getBaseCstVisitorConstructor=function(){if(Xt(this.baseCstVisitorConstructor)){var t=y9(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor},a.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Xt(this.baseCstVisitorWithDefaultsConstructor)){var t=b9(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor},a.prototype.nestedRuleBeforeClause=function(t,e){var r;if(t.NAME!==void 0)return r=t.NAME,this.nestedRuleInvocationStateUpdate(r,e),r},a.prototype.nestedAltBeforeClause=function(t,e,r,n){var i=this.getLastExplicitRuleShortName(),s=kb(i,r,e,n),o;if(t.NAME!==void 0)return o=t.NAME,this.nestedRuleInvocationStateUpdate(o,s),{shortName:s,nestedName:o}},a.prototype.nestedRuleFinallyClause=function(t,e){var r=this.CST_STACK,n=r[r.length-1];this.nestedRuleFinallyStateUpdate();var i=r[r.length-1];g6(i,e,n),this.setNodeLocationFromNode(i.location,n.location)},a.prototype.getLastExplicitRuleShortName=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[t]},a.prototype.getLastExplicitRuleShortNameNoCst=function(){var t=this.RULE_STACK;return t[t.length-1]},a.prototype.getPreviousExplicitRuleShortName=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[t]},a.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var t=this.RULE_STACK;return t[t.length-2]},a.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[t]},a.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},a.prototype.nestedRuleInvocationStateUpdate=function(t,e){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(e),this.cstNestedInvocationStateUpdate(t,e)},a.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},a}()});var N9,C9=Ee(()=>{Dn();N9=function(){function a(){}return a.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(a.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!0,configurable:!0}),a.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Ac},a.prototype.LA=function(t){var e=this.currIdx+t;return e<0||this.tokVectorLength<=e?Ac:this.tokVector[e]},a.prototype.consumeToken=function(){this.currIdx++},a.prototype.exportLexerState=function(){return this.currIdx},a.prototype.importLexerState=function(t){this.currIdx=t},a.prototype.resetLexerState=function(){this.currIdx=-1},a.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},a.prototype.getLexerPosition=function(){return this.exportLexerState()},a}()});var A9,S9=Ee(()=>{Me();Cc();Dn();Pf();If();Ur();A9=function(){function a(){}return a.prototype.ACTION=function(t){return t.call(this)},a.prototype.consume=function(t,e,r){return this.consumeInternal(e,t,r)},a.prototype.subrule=function(t,e,r){return this.subruleInternal(e,t,r)},a.prototype.option=function(t,e){return this.optionInternal(e,t)},a.prototype.or=function(t,e){return this.orInternal(e,t)},a.prototype.many=function(t,e){return this.manyInternal(t,e)},a.prototype.atLeastOne=function(t,e){return this.atLeastOneInternal(t,e)},a.prototype.CONSUME=function(t,e){return this.consumeInternal(t,0,e)},a.prototype.CONSUME1=function(t,e){return this.consumeInternal(t,1,e)},a.prototype.CONSUME2=function(t,e){return this.consumeInternal(t,2,e)},a.prototype.CONSUME3=function(t,e){return this.consumeInternal(t,3,e)},a.prototype.CONSUME4=function(t,e){return this.consumeInternal(t,4,e)},a.prototype.CONSUME5=function(t,e){return this.consumeInternal(t,5,e)},a.prototype.CONSUME6=function(t,e){return this.consumeInternal(t,6,e)},a.prototype.CONSUME7=function(t,e){return this.consumeInternal(t,7,e)},a.prototype.CONSUME8=function(t,e){return this.consumeInternal(t,8,e)},a.prototype.CONSUME9=function(t,e){return this.consumeInternal(t,9,e)},a.prototype.SUBRULE=function(t,e){return this.subruleInternal(t,0,e)},a.prototype.SUBRULE1=function(t,e){return this.subruleInternal(t,1,e)},a.prototype.SUBRULE2=function(t,e){return this.subruleInternal(t,2,e)},a.prototype.SUBRULE3=function(t,e){return this.subruleInternal(t,3,e)},a.prototype.SUBRULE4=function(t,e){return this.subruleInternal(t,4,e)},a.prototype.SUBRULE5=function(t,e){return this.subruleInternal(t,5,e)},a.prototype.SUBRULE6=function(t,e){return this.subruleInternal(t,6,e)},a.prototype.SUBRULE7=function(t,e){return this.subruleInternal(t,7,e)},a.prototype.SUBRULE8=function(t,e){return this.subruleInternal(t,8,e)},a.prototype.SUBRULE9=function(t,e){return this.subruleInternal(t,9,e)},a.prototype.OPTION=function(t){return this.optionInternal(t,0)},a.prototype.OPTION1=function(t){return this.optionInternal(t,1)},a.prototype.OPTION2=function(t){return this.optionInternal(t,2)},a.prototype.OPTION3=function(t){return this.optionInternal(t,3)},a.prototype.OPTION4=function(t){return this.optionInternal(t,4)},a.prototype.OPTION5=function(t){return this.optionInternal(t,5)},a.prototype.OPTION6=function(t){return this.optionInternal(t,6)},a.prototype.OPTION7=function(t){return this.optionInternal(t,7)},a.prototype.OPTION8=function(t){return this.optionInternal(t,8)},a.prototype.OPTION9=function(t){return this.optionInternal(t,9)},a.prototype.OR=function(t){return this.orInternal(t,0)},a.prototype.OR1=function(t){return this.orInternal(t,1)},a.prototype.OR2=function(t){return this.orInternal(t,2)},a.prototype.OR3=function(t){return this.orInternal(t,3)},a.prototype.OR4=function(t){return this.orInternal(t,4)},a.prototype.OR5=function(t){return this.orInternal(t,5)},a.prototype.OR6=function(t){return this.orInternal(t,6)},a.prototype.OR7=function(t){return this.orInternal(t,7)},a.prototype.OR8=function(t){return this.orInternal(t,8)},a.prototype.OR9=function(t){return this.orInternal(t,9)},a.prototype.MANY=function(t){this.manyInternal(0,t)},a.prototype.MANY1=function(t){this.manyInternal(1,t)},a.prototype.MANY2=function(t){this.manyInternal(2,t)},a.prototype.MANY3=function(t){this.manyInternal(3,t)},a.prototype.MANY4=function(t){this.manyInternal(4,t)},a.prototype.MANY5=function(t){this.manyInternal(5,t)},a.prototype.MANY6=function(t){this.manyInternal(6,t)},a.prototype.MANY7=function(t){this.manyInternal(7,t)},a.prototype.MANY8=function(t){this.manyInternal(8,t)},a.prototype.MANY9=function(t){this.manyInternal(9,t)},a.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},a.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},a.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},a.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},a.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},a.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},a.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},a.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},a.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},a.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},a.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},a.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},a.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},a.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},a.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},a.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},a.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},a.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},a.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},a.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},a.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},a.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},a.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},a.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},a.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},a.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},a.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},a.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},a.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},a.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},a.prototype.RULE=function(t,e,r){if(r===void 0&&(r=Sc),Je(this.definedRulesNames,t)){var n=tl.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),i={message:n,type:jt.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(i)}this.definedRulesNames.push(t);var s=this.defineRule(t,e,r);return this[t]=s,s},a.prototype.OVERRIDE_RULE=function(t,e,r){r===void 0&&(r=Sc);var n=[];n=n.concat(t9(t,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n);var i=this.defineRule(t,e,r);return this[t]=i,i},a.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return t.apply(this,e),!0}catch(n){if(Ws(n))return!1;throw n}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},a.prototype.getGAstProductions=function(){return this.gastProductionsCache},a.prototype.getSerializedGastProductions=function(){return f6(Ct(this.gastProductionsCache))},a}()});var w9,E9=Ee(()=>{Me();Tc();Cc();Df();xf();Dn();D6();Us();bc();P6();w9=function(){function a(){}return a.prototype.initRecognizerEngine=function(t,e){if(this.className=d9(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=yc,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},ae(e,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(fr(t)){if(Ve(t))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof t[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(fr(t))this.tokensMap=ht(t,function(s,o){return s[o.name]=o,s},{});else if(ae(t,"modes")&&Or(Pt(Ct(t.modes)),T8)){var r=Pt(Ct(t.modes)),n=Nf(r);this.tokensMap=ht(n,function(s,o){return s[o.name]=o,s},{})}else if(gb(t))this.tokensMap=Bs(t);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=ba;var i=Or(Ct(t),function(s){return Ve(s.categoryMatches)});this.tokenMatcher=i?yc:$o,Ui(Ct(this.tokensMap))},a.prototype.defineRule=function(t,e,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+t+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var n=ae(r,"resyncEnabled")?r.resyncEnabled:Sc.resyncEnabled,i=ae(r,"recoveryValueFunc")?r.recoveryValueFunc:Sc.recoveryValueFunc,s=this.ruleShortNameIdx<<F8+Qa;this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=t,this.fullRuleNameToShort[t]=s;function o(c){try{if(this.outputCst===!0){e.apply(this,c);var p=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(p),p}else return e.apply(this,c)}catch(m){return this.invokeRuleCatch(m,n,i)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(c,p){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(s,t,c),o.call(this,p)};var u="ruleName";return l[u]=t,l.originalGrammarAction=e,l},a.prototype.invokeRuleCatch=function(t,e,r){var n=this.RULE_STACK.length===1,i=e&&!this.isBackTracking()&&this.recoveryEnabled;if(Ws(t)){var s=t;if(i){var o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(s.resyncedTokens=this.reSyncTo(o),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,s.partialCstResult=l}throw s}}else{if(n)return this.moveToTerminatedState(),r();throw s}}else throw t},a.prototype.optionInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(Jo,e),n=this.nestedRuleBeforeClause(t,r);try{return this.optionInternalLogic(t,e,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},a.prototype.optionInternalNoCst=function(t,e){var r=this.getKeyForAutomaticLookahead(Jo,e);return this.optionInternalLogic(t,e,r)},a.prototype.optionInternalLogic=function(t,e,r){var n=this,i=this.getLaFuncFromCache(r),s,o;if(t.DEF!==void 0){if(s=t.DEF,o=t.GATE,o!==void 0){var l=i;i=function(){return o.call(n)&&l.call(n)}}}else s=t;if(i.call(this)===!0)return s.call(this)},a.prototype.atLeastOneInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(Gs,t),n=this.nestedRuleBeforeClause(e,r);try{return this.atLeastOneInternalLogic(t,e,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},a.prototype.atLeastOneInternalNoCst=function(t,e){var r=this.getKeyForAutomaticLookahead(Gs,t);this.atLeastOneInternalLogic(t,e,r)},a.prototype.atLeastOneInternalLogic=function(t,e,r){var n=this,i=this.getLaFuncFromCache(r),s,o;if(e.DEF!==void 0){if(s=e.DEF,o=e.GATE,o!==void 0){var l=i;i=function(){return o.call(n)&&l.call(n)}}}else s=e;if(i.call(this)===!0)for(var u=this.doSingleRepetition(s);i.call(this)===!0&&u===!0;)u=this.doSingleRepetition(s);else throw this.raiseEarlyExitException(t,Qe.REPETITION_MANDATORY,e.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,e],i,Gs,t,U8)},a.prototype.atLeastOneSepFirstInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(qi,t),n=this.nestedRuleBeforeClause(e,r);try{this.atLeastOneSepFirstInternalLogic(t,e,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},a.prototype.atLeastOneSepFirstInternalNoCst=function(t,e){var r=this.getKeyForAutomaticLookahead(qi,t);this.atLeastOneSepFirstInternalLogic(t,e,r)},a.prototype.atLeastOneSepFirstInternalLogic=function(t,e,r){var n=this,i=e.DEF,s=e.SEP,o=this.getLaFuncFromCache(r);if(o.call(this)===!0){i.call(this);for(var l=function(){return n.tokenMatcher(n.LA(1),s)};this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,l,i,T6],l,qi,t,T6)}else throw this.raiseEarlyExitException(t,Qe.REPETITION_MANDATORY_WITH_SEPARATOR,e.ERR_MSG)},a.prototype.manyInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(zs,t),n=this.nestedRuleBeforeClause(e,r);try{return this.manyInternalLogic(t,e,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},a.prototype.manyInternalNoCst=function(t,e){var r=this.getKeyForAutomaticLookahead(zs,t);return this.manyInternalLogic(t,e,r)},a.prototype.manyInternalLogic=function(t,e,r){var n=this,i=this.getLaFuncFromCache(r),s,o;if(e.DEF!==void 0){if(s=e.DEF,o=e.GATE,o!==void 0){var l=i;i=function(){return o.call(n)&&l.call(n)}}}else s=e;for(var u=!0;i.call(this)===!0&&u===!0;)u=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[t,e],i,zs,t,L8,u)},a.prototype.manySepFirstInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(Hs,t),n=this.nestedRuleBeforeClause(e,r);try{this.manySepFirstInternalLogic(t,e,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},a.prototype.manySepFirstInternalNoCst=function(t,e){var r=this.getKeyForAutomaticLookahead(Hs,t);this.manySepFirstInternalLogic(t,e,r)},a.prototype.manySepFirstInternalLogic=function(t,e,r){var n=this,i=e.DEF,s=e.SEP,o=this.getLaFuncFromCache(r);if(o.call(this)===!0){i.call(this);for(var l=function(){return n.tokenMatcher(n.LA(1),s)};this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,l,i,v6],l,Hs,t,v6)}},a.prototype.repetitionSepSecondInternal=function(t,e,r,n,i){for(;r();)this.CONSUME(e),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,r,n,i],r,qi,t,i)},a.prototype.doSingleRepetition=function(t){var e=this.getLexerPosition();t.call(this);var r=this.getLexerPosition();return r>e},a.prototype.orInternalNoCst=function(t,e){var r=fr(t)?t:t.DEF,n=this.getKeyForAutomaticLookahead(Hi,e),i=this.getLaFuncFromCache(n),s=i.call(this,r);if(s!==void 0){var o=r[s];return o.ALT.call(this)}this.raiseNoAltException(e,t.ERR_MSG)},a.prototype.orInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(Hi,e),n=this.nestedRuleBeforeClause(t,r);try{var i=fr(t)?t:t.DEF,s=this.getLaFuncFromCache(r),o=s.call(this,i);if(o!==void 0){var l=i[o],u=this.nestedAltBeforeClause(l,e,Hi,o);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(e,t.ERR_MSG)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},a.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var t=this.LA(1),e=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new qb(e,t))}},a.prototype.subruleInternal=function(t,e,r){var n;try{var i=r!==void 0?r.ARGS:void 0;return n=t.call(this,e,i),this.cstPostNonTerminal(n,r!==void 0&&r.LABEL!==void 0?r.LABEL:t.ruleName),n}catch(s){this.subruleInternalError(s,r,t.ruleName)}},a.prototype.subruleInternalError=function(t,e,r){throw Ws(t)&&t.partialCstResult!==void 0&&(this.cstPostNonTerminal(t.partialCstResult,e!==void 0&&e.LABEL!==void 0?e.LABEL:r),delete t.partialCstResult),t},a.prototype.consumeInternal=function(t,e,r){var n;try{var i=this.LA(1);this.tokenMatcher(i,t)===!0?(this.consumeToken(),n=i):this.consumeInternalError(t,i,r)}catch(s){n=this.consumeInternalRecovery(t,e,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:t.name,n),n},a.prototype.consumeInternalError=function(t,e,r){var n,i=this.LA(0);throw r!==void 0&&r.ERR_MSG?n=r.ERR_MSG:n=this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:e,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Nc(n,e,i))},a.prototype.consumeInternalRecovery=function(t,e,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){var n=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,n)}catch(i){throw i.name===O6?r:i}}else throw r},a.prototype.saveRecogState=function(){var t=this.errors,e=_t(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:e,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},a.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},a.prototype.ruleInvocationStateUpdate=function(t,e,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(e,t)},a.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},a.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},a.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},a.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),ba)},a.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},a}()});var R9,x9=Ee(()=>{Cc();Me();Df();Dn();R9=function(){function a(){}return a.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=Wo(t.errorMessageProvider,ur.errorMessageProvider)},a.prototype.SAVE_ERROR=function(t){if(Ws(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:_t(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(a.prototype,"errors",{get:function(){return _t(this._errors)},set:function(t){this._errors=t},enumerable:!0,configurable:!0}),a.prototype.raiseEarlyExitException=function(t,e,r){for(var n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],s=Of(t,i,e,this.maxLookahead),o=s[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new Wb(c,this.LA(1),this.LA(0)))},a.prototype.raiseNoAltException=function(t,e){for(var r=this.getCurrRuleFullName(),n=this.getGAstProductions()[r],i=Vf(t,n,this.maxLookahead),s=[],o=1;o<=this.maxLookahead;o++)s.push(this.LA(o));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:s,previous:l,customUserDescription:e,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new Hb(u,this.LA(1),l))},a}()});var V9,O9=Ee(()=>{xf();Me();V9=function(){function a(){}return a.prototype.initContentAssist=function(){},a.prototype.computeContentAssist=function(t,e){var r=this.gastProductionsCache[t];if(Xt(r))throw Error("Rule ->"+t+"<- does not exist in this grammar.");return Lb([r],e,this.tokenMatcher,this.maxLookahead)},a.prototype.getNextPossibleTokenTypes=function(t){var e=Vr(t.ruleStack),r=this.getGAstProductions(),n=r[e],i=new B8(n,t).startWalking();return i},a}()});function kf(a,t,e,r){r===void 0&&(r=!1),Xb(e);var n=Af(this.recordingProdStack),i=ha(t)?t:t.DEF,s=new a({definition:[],idx:e});return ae(t,"NAME")&&(s.name=t.NAME),r&&(s.separator=t.SEP),ae(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),i.call(this),n.definition.push(s),this.recordingProdStack.pop(),Kb}function Zie(a,t){var e=this;Xb(t);var r=Af(this.recordingProdStack),n=fr(a)===!1,i=n===!1?a:a.DEF,s=new Et({definition:[],idx:t,ignoreAmbiguities:n&&a.IGNORE_AMBIGUITIES===!0});ae(a,"NAME")&&(s.name=a.NAME),ae(a,"MAX_LOOKAHEAD")&&(s.maxLookahead=a.MAX_LOOKAHEAD);var o=vb(i,function(l){return ha(l.GATE)});return s.hasPredicates=o,r.definition.push(s),ee(i,function(l){var u=new yt({definition:[]});s.definition.push(u),ae(l,"NAME")&&(u.name=l.NAME),ae(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:ae(l,"GATE")&&(u.ignoreAmbiguities=!0),e.recordingProdStack.push(u),l.ALT.call(e),e.recordingProdStack.pop()}),Kb}function F9(a){return a===0?"":""+a}function Xb(a){if(a<0||a>I9){var t=new Error("Invalid DSL Method idx value: <"+a+`>
	`+("Idx value must be a none negative value smaller than "+(I9+1)));throw t.KNOWN_RECORDER_ERROR=!0,t}}var Kb,D9,I9,P9,_9,Yie,k9,j9=Ee(()=>{Me();Ur();wf();bc();Us();Dn();Tc();Kb={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Kb);D9=!0,I9=Math.pow(2,Qa)-1,P9=Oe({name:"RECORDING_PHASE_TOKEN",pattern:Jt.NA});Ui([P9]);_9=Ko(P9,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(_9);Yie={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},k9=function(){function a(){}return a.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},a.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var e=function(n){var i=n>0?n:"";t["CONSUME"+i]=function(s,o){return this.consumeInternalRecord(s,n,o)},t["SUBRULE"+i]=function(s,o){return this.subruleInternalRecord(s,n,o)},t["OPTION"+i]=function(s){return this.optionInternalRecord(s,n)},t["OR"+i]=function(s){return this.orInternalRecord(s,n)},t["MANY"+i]=function(s){this.manyInternalRecord(n,s)},t["MANY_SEP"+i]=function(s){this.manySepFirstInternalRecord(n,s)},t["AT_LEAST_ONE"+i]=function(s){this.atLeastOneInternalRecord(n,s)},t["AT_LEAST_ONE_SEP"+i]=function(s){this.atLeastOneSepFirstInternalRecord(n,s)}},r=0;r<10;r++)e(r);t.consume=function(n,i,s){return this.consumeInternalRecord(i,n,s)},t.subrule=function(n,i,s){return this.subruleInternalRecord(i,n,s)},t.option=function(n,i){return this.optionInternalRecord(i,n)},t.or=function(n,i){return this.orInternalRecord(i,n)},t.many=function(n,i){this.manyInternalRecord(n,i)},t.atLeastOne=function(n,i){this.atLeastOneInternalRecord(n,i)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},a.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var e=0;e<10;e++){var r=e>0?e:"";delete t["CONSUME"+r],delete t["SUBRULE"+r],delete t["OPTION"+r],delete t["OR"+r],delete t["MANY"+r],delete t["MANY_SEP"+r],delete t["AT_LEAST_ONE"+r],delete t["AT_LEAST_ONE_SEP"+r]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA})},a.prototype.ACTION_RECORD=function(t){},a.prototype.BACKTRACK_RECORD=function(t,e){return function(){return!0}},a.prototype.LA_RECORD=function(t){return Ac},a.prototype.topLevelRuleRecord=function(t,e){try{var r=new Jn({definition:[],name:t});return r.name=t,this.recordingProdStack.push(r),e.call(this),this.recordingProdStack.pop(),r}catch(n){if(n.KNOWN_RECORDER_ERROR!==!0)try{n.message=n.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch(i){throw n}throw n}},a.prototype.optionInternalRecord=function(t,e){return kf.call(this,at,t,e)},a.prototype.atLeastOneInternalRecord=function(t,e){kf.call(this,kt,e,t)},a.prototype.atLeastOneSepFirstInternalRecord=function(t,e){kf.call(this,Ft,e,t,D9)},a.prototype.manyInternalRecord=function(t,e){kf.call(this,Xe,e,t)},a.prototype.manySepFirstInternalRecord=function(t,e){kf.call(this,wt,e,t,D9)},a.prototype.orInternalRecord=function(t,e){return Zie.call(this,t,e)},a.prototype.subruleInternalRecord=function(t,e,r){if(Xb(e),!t||ae(t,"ruleName")===!1){var n=new Error("<SUBRULE"+F9(e)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(t)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw n.KNOWN_RECORDER_ERROR=!0,n}var i=Af(this.recordingProdStack),s=t.ruleName,o=new St({idx:e,nonTerminalName:s,referencedRule:void 0});return i.definition.push(o),this.outputCst?Yie:Kb},a.prototype.consumeInternalRecord=function(t,e,r){if(Xb(e),!u6(t)){var n=new Error("<CONSUME"+F9(e)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(t)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw n.KNOWN_RECORDER_ERROR=!0,n}var i=Af(this.recordingProdStack),s=new Le({idx:e,terminalType:t});return i.definition.push(s),_9},a}()});var M9,B9=Ee(()=>{Me();Dn();M9=function(){function a(){}return a.prototype.initPerformanceTracer=function(t){if(ae(t,"traceInitPerf")){var e=t.traceInitPerf,r=typeof e=="number";this.traceInitMaxIdent=r?e:1/0,this.traceInitPerf=r?e>0:e}else this.traceInitMaxIdent=0,this.traceInitPerf=ur.traceInitPerf;this.traceInitIndent=-1},a.prototype.TRACE_INIT=function(t,e){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+t+">");var n=Cb(e),i=n.time,s=n.value,o=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,s}else return e()},a}()});function _6(a){return a===void 0&&(a=void 0),function(){return a}}var L9,Ac,ur,Sc,jt,Yb,Jie,k6,Dn=Ee(()=>{Me();k8();Us();jb();Pf();x6();D6();f9();T9();C9();S9();E9();x9();O9();j9();B9();L9=function(){var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},a(t,e)};return function(t,e){a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ac=Ko(ba,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Ac);ur=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Gb,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Sc=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});(function(a){a[a.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",a[a.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",a[a.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",a[a.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",a[a.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",a[a.LEFT_RECURSION=5]="LEFT_RECURSION",a[a.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",a[a.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",a[a.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",a[a.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",a[a.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",a[a.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",a[a.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",a[a.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",a[a.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(jt||(jt={}));Yb=function(){function a(t,e){e===void 0&&(e=ur),this.ignoredIssues=ur.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(e),r.initLexerAdapter(),r.initLooksAhead(e),r.initRecognizerEngine(t,e),r.initRecoverable(e),r.initTreeBuilder(e),r.initContentAssist(),r.initGastRecorder(e),r.initPerformanceTracer(e),ae(e,"ignoredIssues")&&e.ignoredIssues!==ur.ignoredIssues&&fc(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=ae(e,"ignoredIssues")?e.ignoredIssues:ur.ignoredIssues,this.skipValidations=ae(e,"skipValidations")?e.skipValidations:ur.skipValidations}return a.performSelfAnalysis=function(t){t.performSelfAnalysis()},a.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",function(){var e;t.selfAnalysisDone=!0;var r=t.className;t.TRACE_INIT("toFastProps",function(){Nb(t)}),t.TRACE_INIT("Grammar Recording",function(){try{t.enableRecording(),ee(t.definedRulesNames,function(i){var s=t[i],o=s.originalGrammarAction,l=void 0;t.TRACE_INIT(i+" Rule",function(){l=t.topLevelRuleRecord(i,o)}),t.gastProductionsCache[i]=l})}finally{t.disableRecording()}});var n=[];if(t.TRACE_INIT("Grammar Resolving",function(){n=E6({rules:Ct(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,n)}),t.TRACE_INIT("Grammar Validations",function(){if(Ve(n)&&t.skipValidations===!1){var i=R6({rules:Ct(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:Ct(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:tl,grammarName:r});t.definitionErrors.push.apply(t.definitionErrors,i)}}),Ve(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",function(){var i=_8(Ct(t.gastProductionsCache));t.resyncFollows=i}),t.TRACE_INIT("ComputeLookaheadFunctions",function(){t.preComputeLookaheadFunctions(Ct(t.gastProductionsCache))})),t.TRACE_INIT("expandAllNestedRuleNames",function(){var i=M8(Ct(t.gastProductionsCache),t.fullRuleNameToShort);t.allRuleNames=i.allRuleNames}),!a.DEFER_DEFINITION_ERRORS_HANDLING&&!Ve(t.definitionErrors))throw e=Y(t.definitionErrors,function(i){return i.message}),new Error(`Parser Definition Errors detected:
 `+e.join(`
-------------------------------
`))})},a.DEFER_DEFINITION_ERRORS_HANDLING=!1,a}();Y4(Yb,[p9,m9,v9,N9,w9,A9,R9,V9,k9,M9]);Jie=function(a){L9(t,a);function t(e,r){r===void 0&&(r=ur);var n=this,i=Bs(r);return i.outputCst=!0,n=a.call(this,e,i)||this,n}return t}(Yb),k6=function(a){L9(t,a);function t(e,r){r===void 0&&(r=ur);var n=this,i=Bs(r);return i.outputCst=!1,n=a.call(this,e,i)||this,n}return t}(Yb)});var U9=Ee(()=>{QC()});var z9=Ee(()=>{Me();Ur()});var G9=Ee(()=>{z9()});var Zb=Ee(()=>{QC();Dn();wf();Us();Pf();Cc();p6();Ur();Ur();Yo();x6();U9();G9()});var TP=L((VFe,vP)=>{var Rse=zt(),xse=Math.floor;vP.exports=Number.isInteger||function(t){return!Rse(t)&&isFinite(t)&&xse(t)===t}});var AP=L((DFe,CP)=>{var NP=or();CP.exports=function(a){return a!==void 0&&(NP(a,"value")||NP(a,"writable"))}});var YP=L((UMe,XP)=>{var boe=Xu().PROPER,goe=De(),$P=xC(),KP="\u200B\x85\u180E";XP.exports=function(a){return goe(function(){return!!$P[a]()||KP[a]()!==KP||boe&&$P[a].name!==a})}});var JP=L((ZP,gA)=>{(function(a){"use strict";for(var t=[null,0,{}],e=10,r=44032,n=4352,i=4449,s=4519,o=19,l=21,u=28,c=l*u,p=o*c,m=function(P,F){this.codepoint=P,this.feature=F},f={},d=[],h=0;h<=255;++h)d[h]=0;function y(P,F,G){var z=f[F];return z||(z=P(F,G),!!z.feature&&++d[F>>8&255]>e&&(f[F]=z)),z}function b(P,F,G){var z=F&65280,Z=m.udata[z]||{},ne=Z[F];return ne?new m(F,ne):new m(F,t)}function g(P,F,G){return G?P(F,G):new m(F,null)}function v(P,F,G){var z;if(F<n||n+o<=F&&F<r||r+p<F)return P(F,G);if(n<=F&&F<n+o){var Z={},ne=(F-n)*l;for(z=0;z<l;++z)Z[i+z]=r+u*(z+ne);return new m(F,[,,Z])}var ve=F-r,xe=ve%u,ye=[];if(xe!==0)ye[0]=[r+ve-xe,s+xe];else for(ye[0]=[n+Math.floor(ve/c),i+Math.floor(ve%c/u)],ye[2]={},z=1;z<u;++z)ye[2][s+z]=F+z;return new m(F,ye)}function A(P,F,G){return F<60||13311<F&&F<42607?new m(F,t):P(F,G)}var C=[A,y,g,v,b];m.fromCharCode=C.reduceRight(function(P,F){return function(G,z){return F(P,G,z)}},null),m.isHighSurrogate=function(P){return P>=55296&&P<=56319},m.isLowSurrogate=function(P){return P>=56320&&P<=57343},m.prototype.prepFeature=function(){this.feature||(this.feature=m.fromCharCode(this.codepoint,!0).feature)},m.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var P=this.codepoint-65536;return String.fromCharCode(Math.floor(P/1024)+55296,P%1024+56320)},m.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},m.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<8},m.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<9},m.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?this.feature[1]&255:0},m.prototype.getComposite=function(P){if(this.prepFeature(),!this.feature[2])return null;var F=this.feature[2][P.codepoint];return F?m.fromCharCode(F):null};var S=function(P){this.str=P,this.cursor=0};S.prototype.next=function(){if(!!this.str&&this.cursor<this.str.length){var P=this.str.charCodeAt(this.cursor++),F;return m.isHighSurrogate(P)&&this.cursor<this.str.length&&m.isLowSurrogate(F=this.str.charCodeAt(this.cursor))&&(P=(P-55296)*1024+(F-56320)+65536,++this.cursor),m.fromCharCode(P)}else return this.str=null,null};var w=function(P,F){this.it=P,this.canonical=F,this.resBuf=[]};w.prototype.next=function(){function P(G,z){var Z=z.getDecomp();if(!!Z&&!(G&&z.isCompatibility())){for(var ne=[],ve=0;ve<Z.length;++ve){var xe=P(G,m.fromCharCode(Z[ve]));ne=ne.concat(xe)}return ne}else return[z]}if(this.resBuf.length===0){var F=this.it.next();if(!F)return null;this.resBuf=P(this.canonical,F)}return this.resBuf.shift()};var x=function(P){this.it=P,this.resBuf=[]};x.prototype.next=function(){var P;if(this.resBuf.length===0)do{var F=this.it.next();if(!F)break;P=F.getCanonicalClass();var G=this.resBuf.length;if(P!==0)for(;G>0;--G){var z=this.resBuf[G-1],Z=z.getCanonicalClass();if(Z<=P)break}this.resBuf.splice(G,0,F)}while(P!==0);return this.resBuf.shift()};var R=function(P){this.it=P,this.procBuf=[],this.resBuf=[],this.lastClass=null};R.prototype.next=function(){for(;this.resBuf.length===0;){var P=this.it.next();if(!P){this.resBuf=this.procBuf,this.procBuf=[];break}if(this.procBuf.length===0)this.lastClass=P.getCanonicalClass(),this.procBuf.push(P);else{var F=this.procBuf[0],G=F.getComposite(P),z=P.getCanonicalClass();!!G&&(this.lastClass<z||this.lastClass===0)?this.procBuf[0]=G:(z===0&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=z,this.procBuf.push(P))}}return this.resBuf.shift()};var O=function(P,F){switch(P){case"NFD":return new x(new w(new S(F),!0));case"NFKD":return new x(new w(new S(F),!1));case"NFC":return new R(new x(new w(new S(F),!0)));case"NFKC":return new R(new x(new w(new S(F),!1)))}throw P+" is invalid"},_=function(P,F){for(var G=O(P,F),z="",Z;Z=G.next();)z+=Z.toString();return z};function k(P){return _("NFD",P)}function B(P){return _("NFKD",P)}function U(P){return _("NFC",P)}function H(P){return _("NFKC",P)}m.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var j={nfc:U,nfd:k,nfkc:H,nfkd:B};typeof gA=="object"?gA.exports=j:typeof define=="function"&&define.amd?define("unorm",function(){return j}):a.unorm=j,j.shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var F=""+this,G=arguments[0]===void 0?"NFC":arguments[0];if(this===null||this===void 0)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if(G==="NFC")return j.nfc(F);if(G==="NFD")return j.nfd(F);if(G==="NFKC")return j.nfkc(F);if(G==="NFKD")return j.nfkd(F);throw new RangeError("Invalid normalization form: "+G)}}),j.shimApplied=!0)})(ZP)});var D_=L((dUe,O_)=>{"use strict";var gle=Yr(),V_=jo(),vle=Wn();O_.exports=function(t){for(var e=gle(this),r=vle(e),n=arguments.length,i=V_(n>1?arguments[1]:void 0,r),s=n>2?arguments[2]:void 0,o=s===void 0?r:V_(s,r);o>i;)e[i++]=t;return e}});var Q_=L((yGe,J_)=>{var Z_=my(),bue=Math.floor,UA=function(a,t){var e=a.length,r=bue(e/2);return e<8?gue(a,t):vue(a,UA(Z_(a,0,r),t),UA(Z_(a,r),t),t)},gue=function(a,t){for(var e=a.length,r=1,n,i;r<e;){for(i=r,n=a[r];i&&t(a[i-1],n)>0;)a[i]=a[--i];i!==r++&&(a[i]=n)}return a},vue=function(a,t,e,r){for(var n=t.length,i=e.length,s=0,o=0;s<n||o<i;)a[s+o]=s<n&&o<i?r(t[s],e[o])<=0?t[s++]:e[o++]:s<n?t[s++]:e[o++];return a};J_.exports=UA});var rk=L((bGe,tk)=>{var Tue=Hu(),ek=Tue.match(/firefox\/(\d+)/i);tk.exports=!!ek&&+ek[1]});var ak=L((gGe,nk)=>{var Nue=Hu();nk.exports=/MSIE|Trident/.test(Nue)});var ok=L((vGe,sk)=>{var Cue=Hu(),ik=Cue.match(/AppleWebKit\/(\d+)\./);sk.exports=!!ik&&+ik[1]});var WA=L((qGe,Nk)=>{var $ue=sr(),vk=Ne(),Kue=Zu(),Xue=Hn(),Yue=_m().f,Zue=vk(Yue),Jue=vk([].push),Tk=function(a){return function(t){for(var e=Xue(t),r=Kue(e),n=r.length,i=0,s=[],o;n>i;)o=r[i++],(!$ue||Zue(e,o))&&Jue(s,a?[o,e[o]]:e[o]);return s}};Nk.exports={entries:Tk(!0),values:Tk(!1)}});var Zk=L((OWe,Yk)=>{"use strict";var Mce=Ne(),qk=qy(),wg=uf().getWeakData,Bce=Wt(),aS=zt(),Lce=zy(),Uce=Uy(),Wk=Ds(),$k=or(),Kk=Xa(),zce=Kk.set,Gce=Kk.getterFor,Hce=Wk.find,qce=Wk.findIndex,Wce=Mce([].splice),$ce=0,Eg=function(a){return a.frozen||(a.frozen=new Xk)},Xk=function(){this.entries=[]},iS=function(a,t){return Hce(a.entries,function(e){return e[0]===t})};Xk.prototype={get:function(a){var t=iS(this,a);if(t)return t[1]},has:function(a){return!!iS(this,a)},set:function(a,t){var e=iS(this,a);e?e[1]=t:this.entries.push([a,t])},delete:function(a){var t=qce(this.entries,function(e){return e[0]===a});return~t&&Wce(this.entries,t,1),!!~t}};Yk.exports={getConstructor:function(a,t,e,r){var n=a(function(l,u){Lce(l,i),zce(l,{type:t,id:$ce++,frozen:void 0}),u!=null&&Uce(u,l[r],{that:l,AS_ENTRIES:e})}),i=n.prototype,s=Gce(t),o=function(l,u,c){var p=s(l),m=wg(Bce(u),!0);return m===!0?Eg(p).set(u,c):m[p.id]=c,l};return qk(i,{delete:function(l){var u=s(this);if(!aS(l))return!1;var c=wg(l);return c===!0?Eg(u).delete(l):c&&$k(c,u.id)&&delete c[u.id]},has:function(u){var c=s(this);if(!aS(u))return!1;var p=wg(u);return p===!0?Eg(c).has(u):p&&$k(p,c.id)}}),qk(i,e?{get:function(u){var c=s(this);if(aS(u)){var p=wg(u);return p===!0?Eg(c).get(u):p?p[c.id]:void 0}},set:function(u,c){return o(this,u,c)}}:{add:function(u){return o(this,u,!0)}}),n}}});var kg=L((V$e,bF)=>{"use strict";var wpe=pe(),Epe=xs(),Rpe=Rr(),xpe=Gn(),Vpe=wpe.RangeError;bF.exports=function(t){var e=Rpe(xpe(this)),r="",n=Epe(t);if(n<0||n==1/0)throw Vpe("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))n&1&&(r+=e);return r}});var BF=L((rKe,MF)=>{var kF=Ne(),Kpe=Mo(),FF=Rr(),Xpe=kg(),Ype=Gn(),Zpe=kF(Xpe),Jpe=kF("".slice),Qpe=Math.ceil,jF=function(a){return function(t,e,r){var n=FF(Ype(t)),i=Kpe(e),s=n.length,o=r===void 0?" ":FF(r),l,u;return i<=s||o==""?n:(l=i-s,u=Zpe(o,Qpe(l/o.length)),u.length>l&&(u=Jpe(u,0,l)),a?n+u:u+n)}};MF.exports={start:jF(!1),end:jF(!0)}});var UF=L((nKe,LF)=>{var eme=Hu();LF.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(eme)});var oM=L((OQe,sM)=>{var Jfe=Math.log,Qfe=Math.LOG10E;sM.exports=Math.log10||function(t){return Jfe(t)*Qfe}});var YM=L((hat,a5)=>{function n5(){}n5.prototype={on:function(a,t,e){var r=this.e||(this.e={});return(r[a]||(r[a]=[])).push({fn:t,ctx:e}),this},once:function(a,t,e){var r=this;function n(){r.off(a,n),t.apply(e,arguments)}return n._=t,this.on(a,n,e)},emit:function(a){var t=[].slice.call(arguments,1),e=((this.e||(this.e={}))[a]||[]).slice(),r=0,n=e.length;for(r;r<n;r++)e[r].fn.apply(e[r].ctx,t);return this},off:function(a,t){var e=this.e||(this.e={}),r=e[a],n=[];if(r&&t)for(var i=0,s=r.length;i<s;i++)r[i].fn!==t&&r[i].fn._!==t&&n.push(r[i]);return n.length?e[a]=n:delete e[a],this}};a5.exports=n5;a5.exports.TinyEmitter=n5});var r1=L((Aht,EL)=>{var gd=Math.expm1,h0e=Math.exp;EL.exports=!gd||gd(10)>22025.465794806718||gd(10)<22025.465794806718||gd(-2e-17)!=-2e-17?function(t){return(t=+t)==0?t:t>-1e-6&&t<1e-6?t+t*t/2:h0e(t)-1}:gd});var PL=L((Rht,IL)=>{var R0e=Math.log;IL.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:R0e(1+t)}});var PR=L(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.FORMATS=oo.FORMAT_PLAIN=oo.FORMAT_HTML=void 0;var KG="html";oo.FORMAT_HTML=KG;var XG="plain";oo.FORMAT_PLAIN=XG;var CSe=[KG,XG];oo.FORMATS=CSe});var rH=L(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.UNITS=Hr.UNIT_PARAGRAPH=Hr.UNIT_PARAGRAPHS=Hr.UNIT_SENTENCE=Hr.UNIT_SENTENCES=Hr.UNIT_WORD=Hr.UNIT_WORDS=void 0;var YG="words";Hr.UNIT_WORDS=YG;var ZG="word";Hr.UNIT_WORD=ZG;var JG="sentences";Hr.UNIT_SENTENCES=JG;var QG="sentence";Hr.UNIT_SENTENCE=QG;var eH="paragraphs";Hr.UNIT_PARAGRAPHS=eH;var tH="paragraph";Hr.UNIT_PARAGRAPH=tH;var ASe=[YG,ZG,JG,QG,eH,tH];Hr.UNITS=ASe});var _R=L(n0=>{"use strict";Object.defineProperty(n0,"__esModule",{value:!0});n0.WORDS=void 0;var SSe=["ad","adipisicing","aliqua","aliquip","amet","anim","aute","cillum","commodo","consectetur","consequat","culpa","cupidatat","deserunt","do","dolor","dolore","duis","ea","eiusmod","elit","enim","esse","est","et","eu","ex","excepteur","exercitation","fugiat","id","in","incididunt","ipsum","irure","labore","laboris","laborum","Lorem","magna","minim","mollit","nisi","non","nostrud","nulla","occaecat","officia","pariatur","proident","qui","quis","reprehenderit","sint","sit","sunt","tempor","ullamco","ut","velit","veniam","voluptate"];n0.WORDS=SSe});var nH=L(a0=>{"use strict";Object.defineProperty(a0,"__esModule",{value:!0});a0.LINE_ENDINGS=void 0;var wSe={POSIX:`
`,WIN32:`\r
`};a0.LINE_ENDINGS=wSe});var aH=L(i0=>{"use strict";Object.defineProperty(i0,"__esModule",{value:!0});i0.default=void 0;var ESe=function(t){var e=t.trim();return e.charAt(0).toUpperCase()+e.slice(1)},RSe=ESe;i0.default=RSe});var iH=L((s0,kR)=>{"use strict";Object.defineProperty(s0,"__esModule",{value:!0});s0.default=void 0;var xSe=function(){return typeof kR!="undefined"&&!!kR.exports},VSe=xSe;s0.default=VSe});var sH=L(o0=>{"use strict";Object.defineProperty(o0,"__esModule",{value:!0});o0.default=void 0;var OSe=function(){var t=!1;try{t=navigator.product==="ReactNative"}catch(e){t=!1}return t},DSe=OSe;o0.default=DSe});var oH=L(l0=>{"use strict";Object.defineProperty(l0,"__esModule",{value:!0});l0.SUPPORTED_PLATFORMS=void 0;var ISe={DARWIN:"darwin",LINUX:"linux",WIN32:"win32"};l0.SUPPORTED_PLATFORMS=ISe});var lH=L(u0=>{"use strict";Object.defineProperty(u0,"__esModule",{value:!0});u0.default=void 0;var PSe=oH(),_Se=function(){var t=!1;try{t=process.platform===PSe.SUPPORTED_PLATFORMS.WIN32}catch(e){t=!1}return t},kSe=_Se;u0.default=kSe});var uH=L(c0=>{"use strict";Object.defineProperty(c0,"__esModule",{value:!0});c0.default=void 0;var FSe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return Array.apply(null,Array(t)).map(function(e,r){return r})},jSe=FSe;c0.default=jSe});var cH=L(p0=>{"use strict";Object.defineProperty(p0,"__esModule",{value:!0});p0.default=void 0;var MSe=m0(),BSe=function(t,e){var r=(0,MSe.makeArrayOfLength)(t);return r.map(function(){return e()})},LSe=BSe;p0.default=LSe});var m0=L(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});Object.defineProperty(lo,"capitalize",{enumerable:!0,get:function(){return USe.default}});Object.defineProperty(lo,"isNode",{enumerable:!0,get:function(){return zSe.default}});Object.defineProperty(lo,"isReactNative",{enumerable:!0,get:function(){return GSe.default}});Object.defineProperty(lo,"isWindows",{enumerable:!0,get:function(){return HSe.default}});Object.defineProperty(lo,"makeArrayOfLength",{enumerable:!0,get:function(){return qSe.default}});Object.defineProperty(lo,"makeArrayOfStrings",{enumerable:!0,get:function(){return WSe.default}});var USe=Ip(aH()),zSe=Ip(iH()),GSe=Ip(sH()),HSe=Ip(lH()),qSe=Ip(uH()),WSe=Ip(cH());function Ip(a){return a&&a.__esModule?a:{default:a}}});var mH=L(d0=>{"use strict";Object.defineProperty(d0,"__esModule",{value:!0});d0.default=void 0;var $Se=_R(),FR=m0();function KSe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function pH(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function XSe(a,t,e){return t&&pH(a.prototype,t),e&&pH(a,e),a}function f0(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var YSe=function(){function a(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.sentencesPerParagraph,r=e===void 0?{max:7,min:3}:e,n=t.wordsPerSentence,i=n===void 0?{max:15,min:5}:n,s=t.random,o=t.seed,l=t.words,u=l===void 0?$Se.WORDS:l;if(KSe(this,a),f0(this,"sentencesPerParagraph",void 0),f0(this,"wordsPerSentence",void 0),f0(this,"random",void 0),f0(this,"words",void 0),r.min>r.max)throw new Error("Minimum number of sentences per paragraph (".concat(r.min,") cannot exceed maximum (").concat(r.max,")."));if(i.min>i.max)throw new Error("Minimum number of words per sentence (".concat(i.min,") cannot exceed maximum (").concat(i.max,")."));this.sentencesPerParagraph=r,this.words=u,this.wordsPerSentence=i,this.random=s||Math.random}return XSe(a,[{key:"generateRandomInteger",value:function(e,r){return Math.floor(this.random()*(r-e+1)+e)}},{key:"generateRandomWords",value:function(e){var r=this,n=this.wordsPerSentence,i=n.min,s=n.max,o=e||this.generateRandomInteger(i,s);return(0,FR.makeArrayOfLength)(o).reduce(function(l,u){return"".concat(r.pluckRandomWord()," ").concat(l)},"").trim()}},{key:"generateRandomSentence",value:function(e){return"".concat((0,FR.capitalize)(this.generateRandomWords(e)),".")}},{key:"generateRandomParagraph",value:function(e){var r=this,n=this.sentencesPerParagraph,i=n.min,s=n.max,o=e||this.generateRandomInteger(i,s);return(0,FR.makeArrayOfLength)(o).reduce(function(l,u){return"".concat(r.generateRandomSentence()," ").concat(l)},"").trim()}},{key:"pluckRandomWord",value:function(){var e=0,r=this.words.length-1,n=this.generateRandomInteger(e,r);return this.words[n]}}]),a}(),ZSe=YSe;d0.default=ZSe});var hH=L(b0=>{"use strict";Object.defineProperty(b0,"__esModule",{value:!0});b0.default=void 0;var h0=PR(),fH=nH(),JSe=QSe(mH()),y0=m0();function QSe(a){return a&&a.__esModule?a:{default:a}}function e5e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function t5e(a,t,e){return t&&dH(a.prototype,t),e&&dH(a,e),a}function r5e(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var n5e=function(){function a(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h0.FORMAT_PLAIN,r=arguments.length>2?arguments[2]:void 0;if(e5e(this,a),this.format=e,this.suffix=r,r5e(this,"generator",void 0),h0.FORMATS.indexOf(e.toLowerCase())===-1)throw new Error("".concat(e," is an invalid format. Please use ").concat(h0.FORMATS.join(" or "),"."));this.generator=new JSe.default(t)}return t5e(a,[{key:"getLineEnding",value:function(){return this.suffix?this.suffix:!(0,y0.isReactNative)()&&(0,y0.isNode)()&&(0,y0.isWindows)()?fH.LINE_ENDINGS.WIN32:fH.LINE_ENDINGS.POSIX}},{key:"formatString",value:function(e){return this.format===h0.FORMAT_HTML?"<p>".concat(e,"</p>"):e}},{key:"formatStrings",value:function(e){var r=this;return e.map(function(n){return r.formatString(n)})}},{key:"generateWords",value:function(e){return this.formatString(this.generator.generateRandomWords(e))}},{key:"generateSentences",value:function(e){return this.formatString(this.generator.generateRandomParagraph(e))}},{key:"generateParagraphs",value:function(e){var r=this.generator.generateRandomParagraph.bind(this.generator);return this.formatStrings((0,y0.makeArrayOfStrings)(e,r)).join(this.getLineEnding())}}]),a}(),a5e=n5e;b0.default=a5e});var bH=L(Gd=>{"use strict";Object.defineProperty(Gd,"__esModule",{value:!0});Object.defineProperty(Gd,"LoremIpsum",{enumerable:!0,get:function(){return yH.default}});Gd.loremIpsum=void 0;var i5e=PR(),Pl=rH(),s5e=_R(),yH=o5e(hH());function o5e(a){return a&&a.__esModule?a:{default:a}}var l5e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.count,r=e===void 0?1:e,n=t.format,i=n===void 0?i5e.FORMAT_PLAIN:n,s=t.paragraphLowerBound,o=s===void 0?3:s,l=t.paragraphUpperBound,u=l===void 0?7:l,c=t.random,p=t.sentenceLowerBound,m=p===void 0?5:p,f=t.sentenceUpperBound,d=f===void 0?15:f,h=t.units,y=h===void 0?Pl.UNIT_SENTENCES:h,b=t.words,g=b===void 0?s5e.WORDS:b,v=t.suffix,A=v===void 0?"":v,C={random:c,sentencesPerParagraph:{max:u,min:o},words:g,wordsPerSentence:{max:d,min:m}},S=new yH.default(C,i,A);switch(y){case Pl.UNIT_PARAGRAPHS:case Pl.UNIT_PARAGRAPH:return S.generateParagraphs(r);case Pl.UNIT_SENTENCES:case Pl.UNIT_SENTENCE:return S.generateSentences(r);case Pl.UNIT_WORDS:case Pl.UNIT_WORD:return S.generateWords(r);default:return""}};Gd.loremIpsum=l5e});var Yd=class{constructor(t){this.stack=[{}],t!==void 0&&Object.assign(this.parameters,t)}get parameters(){return this.stack[this.stack.length-1]}push(t,e=!0){let r={};e?(Object.assign(r,this.parameters),t!==void 0&&Object.assign(r,t)):r=t,this.stack.push(r)}pop(){let t=this.stack.pop();return this.stack.length===0&&(this.stack=[{}]),t}};var Zd=class{constructor({maxIterationsRoot:t=80,maxIterationsMinimize:e=500,eps:r=1e-6}={}){this.maxIterationsRoot=t,this.maxIterationsMinimize=e,this.eps=r}fzero(t,e,r){var n,i,s,o,l,u,c,p,m,f,d,h,y,b,g,v,A,C,S,w,x=this.eps,R=this.maxIterationsRoot,O=0,_=0;if(Array.isArray(e)){if(e.length<2)throw new Error("fzero: length of array x0 has to be at least two.");n=e[0],o=t.call(r,n),_+=1,i=e[1],l=t.call(r,i),_+=1}else{for(n=e,o=t.call(r,n),_+=1,n===0?c=1:c=n,p=[.9*c,1.1*c,c-1,c+1,.5*c,1.5*c,-c,2*c,-10*c,10*c],f=p.length,m=0;m<f&&(i=p[m],l=t.call(r,i),_+=1,!(o*l<=0));m++);i<n&&(d=n,n=i,i=d,h=o,o=l,l=h)}if(o*l>0)return Array.isArray(e)?this.fminbr(t,[n,i],r).x:this.Newton(t,n,r);for(s=n,u=o;O<R;){if(y=i-n,Math.abs(u)<Math.abs(l)&&(n=i,i=s,s=n,o=l,l=u,u=o),A=.5*x*(Math.abs(i)+1),w=(s-i)*.5,Math.abs(w)<=A&&Math.abs(l)<=x)return i;Math.abs(y)>=A&&Math.abs(o)>Math.abs(l)&&(g=s-i,n===s?(b=l/o,C=g*b,S=1-b):(S=o/u,b=l/u,v=l/o,C=v*(g*S*(S-b)-(i-n)*(b-1)),S=(S-1)*(b-1)*(v-1)),C>0?S=-S:C=-C,C<.75*g*S-Math.abs(A*S)*.5&&C<Math.abs(y*S*.5)&&(w=C/S)),Math.abs(w)<A&&(w>0?w=A:w=-A),n=i,o=l,i+=w,l=t.call(r,i),_+=1,(l>0&&u>0||l<0&&u<0)&&(s=n,u=o),O++}return i}fminbr(t,e,r,n){let i=n!==void 0?n:this.eps;var s,o,l,u,c,p,m,f,d,h,y,b,g,v,A,C,S=(3-Math.sqrt(5))*.5,w=i,x=i,R=this.maxIterationsMinimize,O=0,_=0;if(!Array.isArray(e)||e.length<2)throw new Error("Numerics.fminbr: length of array x0 has to be at least two.");if(s=e[0],o=e[1],u=s+S*(o-s),m=t.call(r,u),Number.isNaN(m))return{success:!1};for(_+=1,l=u,c=u,p=m,f=m;O<R;){if(d=o-s,h=(s+o)*.5,y=x*Math.abs(l)+w/3,Math.abs(l-h)+d*.5<=2*y)return{success:!0,x:l,fx:p,tol:y};if(b=S*(l<h?o-l:s-l),Math.abs(l-c)>=y&&(A=(l-c)*(p-m),v=(l-u)*(p-f),g=(l-u)*v-(l-c)*A,v=2*(v-A),v>0?g=-g:v=-v,Math.abs(g)<Math.abs(b*v)&&g>v*(s-l+2*y)&&g<v*(o-l-2*y)&&(b=g/v)),Math.abs(b)<y&&(b>0?b=y:b=-y),A=l+b,C=t.call(r,A),Number.isNaN(C))return{success:!1};_+=1,C<=p?(A<l?o=l:s=l,u=c,c=l,l=A,m=f,f=p,p=C):(A<l?s=A:o=A,C<=f||c===l?(u=c,c=A,m=f,f=C):(C<=m||u===l||u===c)&&(u=A,m=C)),O+=1}return{success:!1,x:l,fx:p}}Newton(t,e,r){var n,i=0,s=this.eps,o=t.apply(r,[e]),l=1;for(Array.isArray(e)&&(e=e[0]);i<50&&Math.abs(o)>s;)n=this.D(t,r)(e),l+=2,Math.abs(n)>s?e-=o/n:e+=Math.random()*.2-1,o=t.apply(r,[e]),l+=1,i+=1;return e}D(t,e){return e!=null?function(r){var n=1e-5,i=n*2;return(t(r+n)-t(r-n))/i}:function(r){var n=1e-5,i=n*2;return(t.apply(e,[r+n])-t.apply(e,[r-n]))/i}}};function PH(a,t,e){let r=e&&e.state;r&&(typeof r=="object"&&t.copy(r,t),a.state=()=>t.copy(t,{}))}function HR(a,t){let e=new qR(a),r=()=>e.next();return r.double=()=>r()+(r()*2097152|0)*11102230246251565e-32,r.int32=()=>e.next()*4294967296|0,r.quick=r,PH(r,e,t),r}var qR=class{constructor(t){t==null&&(t=+new Date);let e=4022871197;this.c=1,this.s0=r(" "),this.s1=r(" "),this.s2=r(" "),this.s0-=r(t),this.s0<0&&(this.s0+=1),this.s1-=r(t),this.s1<0&&(this.s1+=1),this.s2-=r(t),this.s2<0&&(this.s2+=1);function r(n){n=String(n);for(let i=0;i<n.length;i++){e+=n.charCodeAt(i);let s=.02519603282416938*e;e=s>>>0,s-=e,s*=e,e=s>>>0,s-=e,e+=s*4294967296}return(e>>>0)*23283064365386963e-26}}next(){let{c:t,s0:e,s1:r,s2:n}=this,i=2091639*e+t*23283064365386963e-26;return this.s0=r,this.s1=n,this.s2=i-(this.c=i|0)}copy(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}};import c5e from"math-expressions";var XR=M(C0()),YR=M(A0()),_H=/\+/g,kH=/\//g;function Va(a,t){let e=YR.default.stringify((0,XR.default)(t)).slice(0,10).replace(_H,"_").replace(kH,"-");return"__"+a+"_"+e}function Oa(a,t){let e=1,r=a+e;for(;t.includes(r);)e+=1,r=a+e;return t.push(r),r}function mo(a){let t=a.lastIndexOf("/");if(t===-1)throw Error(`Encountered name ${a} that doesn't include a slash`);return a.slice(0,t+1)}import WH from"math-expressions";function vr(a){return a.reduce((t,e)=>Array.isArray(e)?t.concat(vr(e)):t.concat(e),[])}function S0(a,t){return console.log(`levels: ${t}`),a.reduce((e,r)=>Array.isArray(r)&&t>1?e.concat(S0(r,t-1)):e.concat(r),[])}import V0 from"math-expressions";import Bn from"math-expressions";var fo=class{union(t){return this.complement().intersect(t.complement()).complement()}intersectWithOpenInterval(t){return this.intersect(t)}setMinus(t){return this.intersect(t.complement())}symmetricDifference(t){return this.setMinus(t).union(t.setMinus(this))}equals(t){return this.symmetricDifference(t).isEmpty()}toJSON(){return{objectType:"subset",data:Object.assign({},this),subsetType:this.constructor.subsetType}}static reviver(t,e){if(e&&e.objectType==="subset"&&e.subsetType!==void 0){if(e.subsetType==="emptySet")return new Fe;if(e.subsetType==="realLine")return new wn;if(e.subsetType==="singleton")return new ln(e.data.element);if(e.subsetType==="union")return new un(e.data.subsets);if(e.subsetType==="openInterval")return new Vt(e.data.left,e.data.right)}return e}copy(){return this.constructor.reviver(null,this.toJSON())}},w0=class extends fo{union(t){return t}intersect(){return new w0}contains(){return!1}isEmpty(){return!0}complement(){return new wn}toString(){return"\u2205"}toMathExpression(){return Bn.fromAst("\u2205")}},Fe=w0;T(Fe,"subsetType","emptySet");var E0=class extends fo{union(){return new E0}intersect(t){return t}contains(){return!0}complement(){return new Fe}isEmpty(){return!1}toString(){return"\u211D"}toMathExpression(){return Bn.fromAst("R")}},wn=E0;T(wn,"subsetType","realLine");var R0=class extends fo{constructor(t){super();if(!Number.isFinite(t))return new Fe;this.element=t}union(t){return t.contains(this.element)?t:new un([t,this])}intersect(t){return t.contains(this.element)?new R0(this.element):new Fe}isEmpty(){return!1}contains(t){return t===this.element}complement(){return new un([new Vt(-1/0,this.element),new Vt(this.element,1/0)])}toString(){return`{${this.element}}`}toMathExpression(){return Bn.fromAst(["set",this.element])}},ln=R0;T(ln,"subsetType","singleton");var rh=class extends fo{intersect(t){return new rh(this.subsets.map(e=>t.intersect(e)))}toString(){return this.subsets.map(t=>t.toString()).join(" U ")}toMathExpression(){return Bn.fromAst(["union",...this.subsets.map(t=>t.toMathExpression().tree)])}constructor(t){super();let e=t.filter(r=>!r.isEmpty());if(e.length===0)return new Fe;e=e.reduce((r,n)=>n instanceof rh?r.concat(n.subsets):r.concat(n),[]),this.subsets=[];for(let r=0;r<e.length;r++){let n=e[r],i=!0;if(n instanceof wn)return new wn;if(n instanceof Vt){let s=n.left,o=n.right;for(let l=r+1;l<e.length;l++){let u=e[l];if(u instanceof Vt){if(s<u.right&&u.left<o){s=Math.min(s,u.left),o=Math.max(o,u.right),e.splice(l,1),l--,i=!1,r--;break}else if(s===u.right||o===u.left){let c=s===u.right?s:o,p=!1;for(let m=0;m<this.subsets.length;m++){let f=this.subsets[m];if(f instanceof ln&&f.element===c){this.subsets.splice(m,1),p=!0;break}}if(!p)for(let m=r+1;m<e.length;m++){let f=e[m];if(f instanceof ln&&f.element===c){e.splice(m,1),p=!0;break}}if(p){s=Math.min(s,u.left),o=Math.max(o,u.right),e.splice(l,1),l--,i=!1,r--;break}}}else u.element>s&&u.element<o&&(e.splice(l,1),l--)}if(n.left=s,n.right=o,n.left===-1/0&&n.right===1/0)return new wn}else{let s=n.element;for(let o=r+1;o<e.length;o++){let l=e[o];if(l instanceof Vt){if(s>l.left&&s<l.right){e.splice(r,1),r--,i=!1;break}}else l.element===s&&(e.splice(o,1),o--)}}i&&this.subsets.push(n)}return this.subsets.length===1?this.subsets[0]:this}contains(t){return this.subsets.some(e=>e.contains(t))}isEmpty(){return this.subsets.every(t=>t.isEmpty())}complement(){return this.subsets.map(t=>t.complement()).reduce((t,e)=>t.intersect(e))}},un=rh;T(un,"subsetType","union");var Wl=class extends fo{constructor(t,e){super();return this.left=t,this.right=e,this.left<=this.right?this.left===-1/0&&this.right===1/0?new wn:this:new Fe}},x0=class extends Wl{constructor(t,e){super(t,e);return t===e?new Fe:this}intersect(t){return t.intersectWithOpenInterval(this)}intersectWithOpenInterval(t){return new x0(Math.max(this.left,t.left),Math.min(this.right,t.right))}complement(){return new un([new ho(-1/0,this.left),new yo(this.right,1/0)])}isEmpty(){return this.left>=this.right}contains(t){return t>this.left&&t<this.right}toString(){return`(${this.left.toString()},${this.right.toString()})`}toMathExpression(){return Bn.fromAst(["interval",["tuple",this.left,this.right],["tuple",!1,!1]])}},Vt=x0;T(Vt,"subsetType","openInterval");var th=class extends Wl{constructor(t,e){super(t,e);if(!(t<=e))return new Fe;let r=[new Vt(t,e)];return Number.isFinite(t)&&r.push(new ln(t)),Number.isFinite(e)&&r.push(new ln(e)),new un(r)}},ho=class extends Wl{constructor(t,e){super(t,e);if(!(t<e))return new Fe;let r=[new Vt(t,e)];return Number.isFinite(e)&&r.push(new ln(e)),new un(r)}},yo=class extends Wl{constructor(t,e){super(t,e);if(!(t<e))return new Fe;let r=[new Vt(t,e)];return Number.isFinite(t)&&r.push(new ln(t)),new un(r)}},FH={Subset:fo,EmptySet:Fe,RealLine:wn,Singleton:ln,Union:un,Interval:Wl,OpenInterval:Vt,ClosedInterval:th,OpenClosedInterval:ho,ClosedOpenInterval:yo},Nt=FH;function Da(a,t){if(!Array.isArray(a))return Number.isFinite(a)?new ln(a):a==="R"?new wn:a==="varnothing"||a==="emptyset"||a==="\u2205"?new Fe:new Fe;let e=a[0];if(e==="interval"){let r=a[1],n=a[2],i=r[1];if(!Number.isFinite(i)&&(i=Bn.fromAst(i).evaluate_to_constant(),!(Number.isFinite(i)||i===1/0||i===-1/0)))return new Fe;let s=r[2];return!Number.isFinite(s)&&(s=Bn.fromAst(s).evaluate_to_constant(),!(Number.isFinite(s)||s===1/0||s===-1/0))?new Fe:n[1]?n[2]?new th(i,s):new yo(i,s):n[2]?new ho(i,s):new Vt(i,s)}else if(e==="union"||e==="or"){let r=a.slice(1).map(n=>Da(n,t)).filter(n=>n);return r.length===0?new Fe:r.length===1?r[0]:new un(r)}else if(e==="intersect"||e==="and"){let r=a.slice(1).map(n=>Da(n,t)).filter(n=>n);return r.length===0?new wn:r.reduce((n,i)=>n.intersect(i))}else if(e==="set"){let r=a.slice(1).map(n=>Da(n,t)).filter(n=>n);return r.length===0?new Fe:r.length===1?r[0]:new un(r)}else if(["<","le",">","ge","=","ne"].includes(e)){let r=a[1],n=!1;if(!Number.isFinite(r)){if(Ot(r,t))n=!0;else if(r=Bn.fromAst(r).evaluate_to_constant(),!(Number.isFinite(r)||r===1/0||r===-1/0))return new Fe}let i=a[2],s=!1;if(!Number.isFinite(i)){if(Ot(i,t))s=!0;else if(i=Bn.fromAst(i).evaluate_to_constant(),!(Number.isFinite(i)||i===1/0||i===-1/0))return new Fe}return n?s?new Fe:e==="<"?new Vt(-1/0,i):e==="le"?new ho(-1/0,i):e===">"?new Vt(i,1/0):e==="ge"?new yo(i,1/0):e==="="?Number.isFinite(i)?new ln(i):new Fe:Number.isFinite(i)?new un([new Vt(-1/0,i),new Vt(i,1/0)]):new wn:s?e==="<"?new Vt(r,1/0):e==="le"?new yo(r,1/0):e===">"?new Vt(-1/0,r):e==="ge"?new ho(-1/0,r):e==="="?Number.isFinite(r)?new ln(r):new Fe:Number.isFinite(r)?new un([new Vt(-1/0,r),new Vt(r,1/0)]):new wn:new Fe}else if(["lts","gts"].includes(e)){let r=a[1].slice(1),n=a[2].slice(1);if(r.length!==3||!Ot(r[1],t))return new Fe;e==="gts"&&(r.reverse(),n.reverse());let i=r[0];if(!Number.isFinite(i)&&(i=Bn.fromAst(i).evaluate_to_constant(),!(Number.isFinite(i)||i===1/0||i===-1/0)))return new Fe;let s=r[2];return!Number.isFinite(s)&&(s=Bn.fromAst(s).evaluate_to_constant(),!(Number.isFinite(s)||s===1/0||s===-1/0))?new Fe:n[0]?n[1]?new Vt(i,s):new ho(i,s):n[1]?new yo(i,s):new th(i,s)}else if(e==="|"){let r=a[1];return Da(a[2],r)}else if(e==="^"&&(a[2]==="C"||a[2]==="c")){let r=Da(a[1],t);return r?r.complement():new Fe}else{if(e==="in")return Ot(a[1],t)?Da(a[2],t):new Fe;if(e==="ni")return Ot(a[2],t)?Da(a[1],t):new Fe;if(e==="notin"){if(Ot(a[1],t)){let r=Da(a[2],t);if(r)return r.complement()}return new Fe}else if(e==="notni"){if(Ot(a[2],t)){let r=Da(a[1],t);if(r)return r.complement()}return new Fe}else{let r=Bn.fromAst(a).evaluate_to_constant();return Number.isFinite(r)?new ln(r):new Fe}}}function Xp(a,t){return Da(a.to_intervals().tree,t.tree)}function Re(a,t,e){if(Object(a)!==a||a instanceof Function||t!==void 0&&a instanceof t)return a;if(a instanceof V0.class||a instanceof Nt.Subset)return a.copy();if(e===void 0&&(e=new WeakMap),Array.isArray(a))return[...a.map(n=>Re(n,t,e))];if(a.constructor===Object&&Object.entries(a).length===0)return{};if(e.has(a))return e.get(a);try{var r=new a.constructor}catch(n){r=Object.create(Object.getPrototypeOf(a))}return a instanceof Map?Array.from(a,([n,i])=>r.set(Re(n,t,e),Re(i,t,e))):a instanceof Set&&Array.from(a,n=>r.add(Re(n,t,e))),e.set(a,r),Object.assign(r,...Object.keys(a).map(n=>({[n]:Re(a[n],t,e)})))}function Ot(a,t,e){var r,n;function i(s,o){var l;if(Number.isNaN(s)&&Number.isNaN(o)||s===o)return!0;if(e!==void 0&&s instanceof e&&o instanceof e)return s.componentName===o.componentName;if(s instanceof V0.class&&o instanceof V0.class)return i(s.tree,o.tree);if(typeof s=="function"&&typeof o=="function"||s instanceof Date&&o instanceof Date||s instanceof RegExp&&o instanceof RegExp||s instanceof String&&o instanceof String||s instanceof Number&&o instanceof Number)return s.toString()===o.toString();if(!(s instanceof Object&&o instanceof Object)||s.isPrototypeOf(o)||o.isPrototypeOf(s)||s.constructor!==o.constructor||s.prototype!==o.prototype||r.indexOf(s)>-1||n.indexOf(o)>-1)return!1;for(l in o){if(o.hasOwnProperty(l)!==s.hasOwnProperty(l))return!1;if(typeof o[l]!=typeof s[l])return!1}for(l in s){if(o.hasOwnProperty(l)!==s.hasOwnProperty(l))return!1;if(typeof o[l]!=typeof s[l])return!1;switch(typeof s[l]){case"object":case"function":if(r.push(s),n.push(o),!i(s[l],o[l]))return!1;r.pop(),n.pop();break;default:if(s[l]!==o[l]&&!(Number.isNaN(s[l])&&Number.isNaN(o[l])))return!1;break}}return!0}return r=[],n=[],i(a,t)}function nh(a){return null}function hs({childrenToComponentFunction:a,mustStripOffOuterParentheses:t=!1}){return function({matchedChildren:e}){let r=0,n=[],i=[],s=!1,o=e.length;if(t){let u=e[0];if(typeof u!="string"||u.trimLeft()[0]!=="(")return{success:!1}}for(let[u,c]of e.entries()){if(typeof c!="string"){i.push(c);continue}let p=c.trim();if(u===0&&t&&p[0]==="("){let f=e[o-1];if(typeof f=="string"){let d=f.trimRight();d[d.length-1]===")"&&(s=!0,p=p.substring(1))}}let m=0;for(let f=0;f<p.length;f++){let d=p[f];if(d==="("&&r++,d===")"){if(r===0){if(s&&u===o-1&&f===p.length-1){p=p.substring(0,p.length-1);break}return{success:!1}}r--}d===","&&r===0&&(f>m&&i.push(p.substring(m,f)),n.push(i),i=[],m=f+1)}p.length>m&&i.push(p.substring(m,p.length))}if(r!==0)return{success:!1};n.push(i);let l=n.map(a);return{success:!0,newChildren:l}}}function ZR({childrenList:a}){let t=0,e=[],r=[];for(let n of a){if(typeof n!="string"){r.push(n);continue}let i=n.trim(),s=0;for(let o=0;o<i.length;o++){let l=i[o];if(l==="("&&t++,l===")"){if(t===0)return{success:!1};t--}if(l===","&&t===0){if(o>s){let u=i.substring(s,o).trim();r.push(u)}e.push(r),r=[],s=o+1}}if(i.length>s){let o=i.substring(s,i.length).trim();r.push(o)}}return t!==0?{success:!1}:(e.push(r),{success:!0,pieces:e})}function Ia({componentList:a,removeParens:t=!1}){let e=0,r=[],n=[];for(let i of a){if(typeof i!="string"){e===0?r.push([i]):n.push(i);continue}let s=i.trim(),o=0;for(let l=0;l<s.length;l++){let u=s[l];if(u==="(")e===0&&t&&(o=l+1),e++;else if(u===")"){if(e===0)return{success:!1};if(e===1){if(l+1>o){let c=t?l:l+1,p=s.substring(o,c).trim();p.length>0&&n.push(p)}r.push(n),n=[],o=l+1}e--}else if(e===0&&!u.match(/\s/))return{success:!1}}if(s.length>o){let l=s.substring(o,s.length).trim();n.push(l)}}return e!==0?{success:!1}:(n.length>0&&r.push(n),{success:!0,pieces:r})}import{LRParser as LH}from"@lezer/lr";import{ExternalTokenizer as ix,ContextTracker as jH}from"@lezer/lr";var ah=1,JR=2,QR=3,ex=4,tx=5,rx=27;var nx=9,ax=10;function MH(a){return a==45||a==46||a==58||a>=65&&a<=90||a==95||a>=97&&a<=122||a>=161}function sx(a){return a==9||a==10||a==13||a==32}var ox=null,lx=null,ux=0;function O0(a,t){let e=a.pos+t;if(lx==a&&ux==e)return ox;for(;sx(a.peek(t));)t++;let r="";for(;;){let n=a.peek(t);if(!MH(n))break;r+=String.fromCharCode(n),t++}return lx=a,ux=e,ox=r||null}function cx(a,t){this.name=a,this.parent=t,this.hash=t?t.hash:0;for(let e=0;e<a.length;e++)this.hash+=(this.hash<<4)+a.charCodeAt(e)+(a.charCodeAt(e)<<8)}var px=new jH({start:null,shift(a,t,e,r){return t==ah?new cx(O0(r,1)||"",a):a},reduce(a,t){return t==nx&&a?a.parent:a},reuse(a,t,e,r){let n=t.type.id;return n==ah||n==ax?new cx(O0(r,1)||"",a):a},hash(a){return a?a.hash:0},strict:!1}),mx=new ix((a,t)=>{if(a.next==60){if(a.advance(),a.next==47){a.advance();let e=O0(a,0);if(!e)return a.acceptToken(tx);if(t.context&&e.toLowerCase()==t.context.name.toLowerCase())return a.acceptToken(JR);for(let r=t.context;r;r=r.parent)if(r.name==e)return a.acceptToken(QR,-2);a.acceptToken(ex)}else if(a.next!=33&&a.next!=63&&!sx(a.next))return a.acceptToken(ah)}},{contextual:!0});function BH(a,t){return new ix(e=>{for(let r=0,n=0;;n++){if(e.next<0){n&&e.acceptToken(a);break}if(e.next==t.charCodeAt(r)){if(r++,r==t.length){n>t.length&&e.acceptToken(a,1-t.length);break}}else r=0;e.advance()}})}var fx=BH(rx,"-->");import{NodeProp as dx}from"@lezer/common";var hx=LH.deserialize({version:13,states:"*[OQOTOOO]OYO'#CdOeO`O'#CfO!OOTO'#CeOOOP'#Ce'#CeOOOP'#Cx'#CxOOOP'#Co'#CoQQOTOOOOOQ'#Cp'#CpO!VOYO,59OOOOP,59O,59OO!_OpO,59QO!mO`O'#ClOOOP'#DT'#DTOOOP'#Cu'#CuO!rOTO,59PO!yO`O'#CmOOOP,59P,59POOOP-E6m-E6mOOOQ-E6n-E6nOOOP1G.j1G.jOOOO'#Cq'#CqO#ROpO1G.lO#aOpO'#ChOOOO'#Cr'#CrO#rOpO1G.lOOOP1G.l1G.lOOOP1G.t1G.tO#}OWO,59WOOOP-E6s-E6sOOOP1G.k1G.kO$SO`O,59XO$[OWO,59XOOOO-E6o-E6oO$dOpO7+$WOOOP7+$W7+$WOOOP7+$`7+$`O$oOpO,59SO%QOWO,59SOOOO-E6p-E6pOOOP1G.r1G.rO%]OWO1G.sO%]OWO1G.sOOOP1G.s1G.sOOOP<<Gr<<GrOOOP<<Gz<<GzO%QOWO1G.nO%QOWO1G.nO%eO!bO'#C}O%mO#tO'#DQOOOO'#Ck'#CkO%uOpO1G.nO&TOWO7+$_OOOP7+$_7+$_O%QOWO7+$YO&]OpO7+$YOOOO'#Cs'#CsO&kO!bO,59iOOOO,59i,59iOOOO'#Ct'#CtO&sO#tO,59lOOOO,59l,59lO&]OpO7+$YOOOP<<Gy<<GyO&{OpO<<GtO&{OpO<<GtOOOO-E6q-E6qOOOO1G/T1G/TOOOO-E6r-E6rOOOO1G/W1G/WO'ZOpOAN=`",stateData:"'i~OPQOVTOnPO~OkWOmYO~OZZO~OPQOQ`OS[OT]OV]OnPO~ORaO~PjOkWOmdO~O]gOojOpeOxkO~OZlO~ORnO~PjOZpOpeO~O]gOosOpeOxtO~O^vOpeO][Xo[Xx[X~O]gOosOxtO~OoxO~OZyOpeO~Oo{OpeO~O]gOo|Ox}O~O^!OOpeO][ao[ax[a~OpeOr!QOu!RO~Oo!VOpeO~Or![Os!YO~Ou!_Ov!]O~OpeO][io[ix[i~Oo!aOpeO~OpeO][qo[qx[q~Or!eOs!YO~Ou!gOv!]O~OpeO][yo[yx[y~OpeO][!Ro[!Rx[!R~O",goto:"$yxPPPPPPPPyy!RP!XPP!_}!i!o!u!{#R#}$X$_$ePP$kPPPP$oPP$oPP$uSTOVT]R_XRORV_XhZfirQ!TvS!X!O!PR!b!WQaRRn_XSORV_QVORbVQXPRcXQfZQo`dqfouz!P!U!W!`!c!hQugQzpQ!PvQ!UyQ!W!OQ!`!TQ!c!XR!h!bQiZQrfTwirQ!Z!QR!d!ZQ!^!RR!f!^Q_RRm_TUOVX!Sv!O!P!WT^R_",nodeNames:"\u26A0 StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text Comment Element OpenTag TagName Attribute AttributeName Is AttributeValue MismatchedCloseTag CloseTag SelfClosingTag",maxTerm:40,context:px,nodeProps:[[dx.closedBy,1,"SelfCloseEndTag EndTag",10,"CloseTag MissingCloseTag"],[dx.openedBy,17,"OpenTag"]],skippedNodes:[0],repeatNodeCount:7,tokenData:"5x!aRxOX#oX^(f^p#opq(fqr#ors*fsw#owx+Ox}#o}!O+h!O!P#o!P!Q0h!Q![.d![!^#o!^!_2O!_!`4f!`!a5W!a!c#o!c!}.d!}#R#o#R#S.d#S#T#o#T#o.d#o#y#o#y#z(f#z$f#o$f$g(f$g#BY#o#BY#BZ(f#BZ$IS#o$IS$I_(f$I_$I|#o$I|$JO(f$JO$JT#o$JT$JU(f$JU$KV#o$KV$KW(f$KW&FU#o&FU&FV(f&FV~#o!R#xVVPvps`Or#ors$_sw#owx&Qx!^#o!^!_'[!_~#oa$fTVPs`Ow$_wx$ux!^$_!^!_%^!_~$_P$zRVPO!^$u!^!_%T!_~$uP%WQpq$u!_!`$ua%cUs`Op%upq$_qw%ux!_%u!_!`$_!`~%u`%zQs`Ow%ux~%uq&XTVPvpOr&Qrs$us!^&Q!^!_&h!_~&Qq&mUvpOp'Ppq&Qqr'Ps!_'P!_!`&Q!`~'Pp'UQvpOr'Ps~'P!R'cXvps`Op(Opq#oqr(Ors%usw(Owx'Px!_(O!_!`#o!`~(O!Q(VTvps`Or(Ors%usw(Owx'Px~(O!a(qkVPvps`p^OX#oX^(f^p#opq(fqr#ors$_sw#owx&Qx!^#o!^!_'[!_#y#o#y#z(f#z$f#o$f$g(f$g#BY#o#BY#BZ(f#BZ$IS#o$IS$I_(f$I_$I|#o$I|$JO(f$JO$JT#o$JT$JU(f$JU$KV#o$KV$KW(f$KW&FU#o&FU&FV(f&FV~#o!T*oTurVPs`Ow$_wx$ux!^$_!^!_%^!_~$_!T+XTrbVPvpOr&Qrs$us!^&Q!^!_&h!_~&Q!a+ua]WZSVPvps`Or#ors$_sw#owx&Qx}#o}!O,z!O!Q#o!Q![.d![!^#o!^!_'[!_!c#o!c!}.d!}#R#o#R#S.d#S#T#o#T#o.d#o~#o!a-Xc]WZSVPvps`Or#ors$_sw#owx&Qx}#o}!O.d!O!Q#o!Q![.d![!^#o!^!_'[!_!`#o!`!a/v!a!c#o!c!}.d!}#R#o#R#S.d#S#T#o#T#o.d#o~#o!_.qa]WZSVPvps`Or#ors$_sw#owx&Qx}#o}!O.d!O!Q#o!Q![.d![!^#o!^!_'[!_!c#o!c!}.d!}#R#o#R#S.d#S#T#o#T#o.d#o~#o!T0RVmQVPvps`Or#ors$_sw#owx&Qx!^#o!^!_'[!_~#o!Z0qXVPvps`Or#ors$_sw#owx&Qx!^#o!^!_'[!_!`#o!`!a1^!a~#o!Z1iVVPvps`xWOr#ors$_sw#owx&Qx!^#o!^!_'[!_~#o!R2VXvps`Op(Opq#oqr2rrs%usw(Owx'Px!_(O!_!`#o!`~(O!R2yVvps`Or(Ors%usw(Owx'Px}(O}!O3`!O~(O!R3gVvps`Or(Ors%usw(Owx'Px}(O}!O3|!O~(O!R4VTvps`nPOr(Ors%usw(Owx'Px~(O!Z4qV^WVPvps`Or#ors$_sw#owx&Qx!^#o!^!_'[!_~#o!]5cVVPvps`oYOr#ors$_sw#owx&Qx!^#o!^!_'[!_~#o",tokenizers:[mx,fx,0,1,2,3,4,5],topRules:{Document:[0,6]},tokenPrec:0});function UH(a){return hx.parse(a).cursor()}function yx(a){function t(s){if(s.name!=="Element")throw Error("compileElement() called on a non-Element");if(s.firstChild(),s.name==="OpenTag"){s.firstChild(),s.nextSibling();let o=a.substring(s.from,s.to),l=s.from,u=s.to,c={};for(;s.nextSibling();){if(s.name!=="Attribute"){for(;s.parent(););throw Error(`Invalid DoenetML at positions ${s.from} to ${s.to}. Error in opening <${o}> tag.`)}s.firstChild();let m=a.substring(s.from,s.to);if(s.nextSibling()===!1)c[m]=!0;else{s.nextSibling();let f=a.substring(s.from+1,s.to-1);c[m]=f}s.parent()}s.parent();let p={componentType:o,props:{...c},children:[]};for(;s.nextSibling();)if(s.name==="Text"){let m=a.substring(s.from,s.to);m!==""&&p.children.push(m)}else if(s.name==="Element")p.children.push(t(s.node.cursor));else{if(s.name==="CloseTag")break;if(s.name==="Comment")continue;throw s.name==="MismatchedCloseTag"?Error(`Invalid DoenetML at position ${s.from}. Mismatched closing tag.  Expected </${o}>.  Found ${a.slice(s.from,s.to)}.`):Error(`Invalid DoenetML at position ${s.from}. Expected a closing </${o}> tag.  Instead found ${a.slice(s.from,s.to)}.`)}return p.range={openBegin:l,openEnd:u,closeBegin:s.from,closeEnd:s.to},p}else if(s.name==="SelfClosingTag"){s.firstChild(),s.nextSibling();let o=a.substring(s.from,s.to),l={};for(;s.nextSibling();){if(s.name!=="Attribute")throw Error(`Invalid DoenetML at positions ${s.from} to ${s.to}. Error in self-closing <${o}/> tag.`);s.firstChild();let c=a.substring(s.from,s.to);if(s.nextSibling()===!1)l[c]=!0;else{s.nextSibling();let p=a.substring(s.from+1,s.to-1);l[c]=p}s.parent()}let u={selfCloseBegin:s.from,selfCloseEnd:s.to};return{componentType:o,props:{...l},children:[],range:u}}else throw Error("Non SelfClosingTag/OpenTag in Element. How did you do that?")}function e(s){if(s.node.name==="Element")return t(s.node.cursor);if(s.node.name==="Comment")return null;if(s.node.name==="Text"){let o=a.substring(s.node.from,s.node.to);if(o!=="")return o}else return null}let r=UH(a),n=[];if(!r.firstChild())return n;let i=e(r);for(i!=null&&n.push(i);r.nextSibling();){let s=e(r);s!=null&&n.push(s)}return n}import zH from"hi-base32";async function Yp(a){let e=new TextEncoder().encode(a);return await GH(e)}async function GH(a){let t=await crypto.subtle.digest("SHA-256",a),e=new Uint8Array(36);return e.set([1,85,18,32]),e.set(new Uint8Array(t),4),"b"+zH.encode(e).toLowerCase().replace(/=+/,"")}function bx(a,t="doenet"){return new Promise((e,r)=>{let n=HH(a),i=n.promise,s=n.controller,o,l=!1,u=!1,c;i.then(p=>{clearTimeout(c),o&&!u&&o.abort(),e(p)}).catch(p=>{l=!0,u&&(clearTimeout(c),r(p))}),c=setTimeout(()=>{let p=qH(a,t),m=p.promise;o=p.controller,m.then(f=>{l||s.abort(),e(f)}).catch(f=>{u=!0,l?r(f):c=setTimeout(()=>{s.abort(),r(f)},5e3)})},100)})}function HH(a){let t=new AbortController,e=t.signal;return{promise:async function(){try{let i=await fetch(`https://${a}.ipfs.dweb.link/`,{signal:e});if(i.ok){let s=await i.text();return await Yp(s)===a?s:Promise.reject(new Error("cid mismatch"))}else return Promise.reject(new Error(`cid not found: ${a}`))}catch(i){return Promise.reject(new Error(`cid not found: ${a}`))}}(),controller:t}}function qH(a,t){let e=new AbortController,r=e.signal;return{promise:async function(){try{let s=await fetch(`/media/${a}.${t}`,{signal:r});if(s.ok){let o=await s.text(),l=await Yp(o);return l===a?o:(console.warn(`cid mismatch, ${a}, ${l}`),Promise.reject(new Error("cid mismatch")))}else return Promise.reject(new Error(`cid not found: ${a}`))}catch(s){return Promise.reject(new Error(`cid not found: ${a}`))}}(),controller:e}}function gx(a){let e=/<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[\^'">\s]+))?)+\s*|\s*)\/?>/.exec(a);if(e===null)return!1;let r=e[0];r=r.toLowerCase();let n=e.index,i=r.split(" "),s=i[0].substring(1,i[0].length-1);i.length>1&&(s=i[0].substring(1,i[0].length)),s.substring(s.length-1,s.length)==="/"&&(s=s.substring(0,s.length-1));let o=e[1];o=o.trim();let l={},u=/\w+\s*=\s*["]/;for(e="not null";e!==null;)if(e=u.exec(o),e!==null){let p=o.substring(e.index+e[0].length-1,o.length),f=/"[^"\\]*(?:\\.[^"\\]*)*"/.exec(p),d=f[0].substring(1,f[0].length-1),y=e[0].split("=")[0].trim();if(y.substring(0,1)==="_")throw Error("The prop "+y+" is reserved for internal use only.");if(d=d.replace(/\\"/g,'"'),y in l)throw Error("Duplicate attribute "+y+" in tag "+s);l[y]=d,o=o.substring(0,e.index)+o.substring(e.index+e[0].length+f[0].length,o.length)}let c=/\w+\s*=\s*[']/;for(e="not null";e!==null;)if(e=c.exec(o),e!==null){let p=o.substring(e.index+e[0].length-1,o.length),f=/'[^'\\]*(?:\\.[^'\\]*)*'/.exec(p),d=f[0].substring(1,f[0].length-1),y=e[0].split("=")[0].trim();if(y.substring(0,1)==="_")throw Error("The prop "+y+" is reserved for internal use only.");if(d=d.replace(/\\'/g,"'"),y in l)throw Error("Duplicate attribute "+y+" in tag "+s);l[y]=d,o=o.substring(0,e.index)+o.substring(e.index+e[0].length+f[0].length,o.length)}if(/\S/.test(o)){let p=o.split(" ");for(let m of p)/\S/.test(m)&&(l[m]=!0)}return{tagString:r,tagType:s,tagIndex:n,tagProps:l}}async function Zp({cids:a,doenetMLs:t,componentInfoObjects:e,flags:r}){let n=[],i={};for(let o of t){let l=yx(o);Cx(l),Ax(l,e.componentTypeLowerCaseMapping),ih(l,e,r),Pa(l,e,r),$l(l,e),sh(l),go({serializedComponents:l,componentInfoObjects:e}),n.push(l);let u=Tx({serializedComponents:l});for(let c in u.cidComponents)i[c]===void 0&&(i[c]=[]),i[c].push(...u.cidComponents[c])}let s=Object.keys(i);if(s.length>0){let{newDoenetMLs:o,newCids:l}=await $H(s);for(let[p,m]of s.entries())if(l[p]&&l[p].substring(0,m.length)!==m)return Promise.reject(new Error(`Requested cid ${m} but got back ${l[p]}!`));let u=s.length;for(let p=0;p<u;p++)l[p]||(console.warn(`Unable to retrieve content with cid = ${s[p]}`),o[p]="");let{fullSerializedComponents:c}=await Zp({doenetMLs:o,cids:l,componentInfoObjects:e,flags:r});for(let[p,m]of s.entries()){let f=c[p];for(let d of i[m])d.children===void 0&&(d.children=[]),d.children.push({componentType:"externalContent",children:JSON.parse(JSON.stringify(f)),attributes:{newNamespace:{primitive:!0}},doenetAttributes:{createUniqueName:!0}})}}return{cids:a,fullSerializedComponents:n}}function $H(a){let t=[],e=a;for(let r of a)t.push(bx(r,"doenet"));return Promise.all(t).then(r=>Promise.resolve({newDoenetMLs:r,newCids:e})).catch(r=>{let n;return e.length===1?n=`Could not retrieve cid ${e[0]}`:n=`Could not retrieve cids ${e.join(",")}`,n+=": "+r.message,console.error(n),Promise.reject(new Error(n))})}function vx(a,t=!0){if(a===void 0)return[];if(t){let i=a.search("<!--");for(;i!==-1;){let s=a.search("-->");s===-1?s=a.length:s=s+3,a=a.substring(0,i)+a.substring(s,a.length),i=a.search("<!--")}}let e=[],r="",n="";for(;a.length>0;){let i=gx(a);if(i===!1)return a.length>0&&e.push(a),e;if(i.tagString.substring(i.tagString.length-2,i.tagString.length-1)==="/")r=a.substring(0,i.tagIndex),n="",a=a.substring(i.tagIndex+i.tagString.length,a.length);else{let l=1,u=0,c=JSON.parse(JSON.stringify(i)),p=0,m="";for(;l>u;){if(p=Number(p)+Number(c.tagString.length)+Number(c.tagIndex),m=a.substring(p,a.length),c=gx(m),c===!1)throw Error("No matching </"+i.tagType+"> end tag");c.tagType===i.tagType&&l++,c.tagType==="/"+i.tagType&&u++}r=a.substring(0,i.tagIndex);let f=Number(i.tagIndex)+Number(i.tagString.length),d=Number(p)+Number(c.tagIndex);n=a.substring(f,d),a=a.substring(Number(d)+Number(c.tagString.length),a.length)}(/\S/.test(r)||r.length>0)&&e.push(r);let o=[];if(n.length>0&&(o=vx(n,!1)),e.push({componentType:i.tagType,children:o,props:i.tagProps}),!/\S/.test(a)){if(a.length>0&&e.push(a),t){let l,u;for(let[c,p]of e.entries())(typeof p!="string"||p.trim()!=="")&&(l===void 0&&(l=c),u=c);e=e.slice(l,u+1)}return e}}return e}function $l(a,t){for(let e of a){if(e.children){let r=t.allComponentClasses[e.componentType];r&&!r.includeBlankStringChildren&&(e.children=e.children.filter(n=>typeof n!="string"||n.trim()!=="")),$l(e.children,t)}for(let r in e.attributes){let n=e.attributes[r].component;n&&n.children&&$l([n],t)}}}function Tx({serializedComponents:a}){let t={};for(let e of a)if(e.componentType==="copy"){if(e.attributes&&e.attributes.uri){let r=e.attributes.uri.primitive;if(r&&r.substring(0,7).toLowerCase()==="doenet:"){let n=r.match(/[:&]cid=([^&]+)/i);if(n){let i=n[1];t[i]===void 0&&(t[i]=[]),t[i].push(e)}}}}else if(e.children!==void 0){let r=Tx({serializedComponents:e.children});for(let n in r.cidComponents)t[n]===void 0&&(t[n]=[]),t[n].push(...r.cidComponents[n])}return{cidComponents:t}}function Nx(a){if(a.length!==1||a[0].componentType!=="document"){let t=a.splice(0);a.push({componentType:"document",children:t})}}function Cx(a){let t={tname:"target",triggerwithtnames:"triggerWithTargets",updatewithtname:"updateWithTarget",paginatortname:"paginator"};for(let e of a)if(typeof e=="object"){if(e.props){let r=!0;for(;r;){r=!1;for(let n in e.props){let i=n.toLowerCase();if(i in t){let s=t[i];console.warn(`Attribute ${n} is deprecated.  Use ${s} instead.`),e.props[s]=e.props[n],delete e.props[n],r=!0;break}}}}e.children&&Cx(e.children)}}function Ax(a,t){for(let e of a){if(typeof e!="object")continue;let r=t[e.componentType.toLowerCase()];if(r)e.componentType=r;else throw Error(`Invalid component type: ${e.componentType}`);e.children&&Ax(e.children,t)}}function ih(a,t,e){for(let r of a){if(typeof r!="object")continue;let n=t.allComponentClasses[r.componentType],i=n.createAttributesObject({flags:e}),s={};for(let u in i)s[u.toLowerCase()]=u;let o={},l=Object.assign({},r.props);if(r.props)for(let u in r.props){let c=s[u.toLowerCase()],p=i[c];if(p){if(c in o)throw Error(`Cannot repeat prop ${c}`);o[c]=bo({attrObj:p,value:r.props[u],originalComponentProps:l,componentInfoObjects:t,flags:e}),delete r.props[u]}else if(!["name","assignnames","target"].includes(u.toLowerCase()))if(n.acceptAnyAttribute)o[u]=bo({value:r.props[u],originalComponentProps:l,componentInfoObjects:t,flags:e});else throw Error(`Invalid attribute for component of type ${r.componentType}: ${u}`)}for(let u in i){let c=i[u];c.createPrimitiveOfType&&"defaultPrimitiveValue"in c&&!(u in o)&&(o[u]=bo({attrObj:c,originalComponentProps:l,value:c.defaultPrimitiveValue.toString(),componentInfoObjects:t,flags:e}))}r.attributes=o,r.children!==void 0&&ih(r.children,t,e)}}function bo({attrObj:a,value:t,originalComponentProps:e,componentInfoObjects:r,flags:n}){if(typeof t!="object"?t={rawString:t.toString()}:t===null&&(t={rawString:""}),a&&a.createComponentOfType){let i,s=t.rawString.trim().toLowerCase();if(s==="true"&&a.valueForTrue!==void 0)i={componentType:a.createComponentOfType,state:{value:a.valueForTrue}};else if(s==="false"&&a.valueForFalse!==void 0)i={componentType:a.createComponentOfType,state:{value:a.valueForFalse}};else if(r.isInheritedComponentType({inheritedComponentType:a.createComponentOfType,baseComponentType:"boolean"})&&["true","false"].includes(s))i={componentType:a.createComponentOfType,state:{value:s==="true"}};else{let o=t.childrenForComponent;o?o=JSON.parse(JSON.stringify(o)):o=[t.rawString],i={componentType:a.createComponentOfType,children:o},$l([i],r)}if(a.attributesForCreatedComponent||a.copyComponentAttributesForCreatedComponent){if(a.attributesForCreatedComponent?i.props=a.attributesForCreatedComponent:i.props={},a.copyComponentAttributesForCreatedComponent)for(let o of a.copyComponentAttributesForCreatedComponent)e[o]&&(i.props[o]=JSON.parse(JSON.stringify(e[o])));ih([i],r,n)}return{component:i}}else if(a&&a.createPrimitiveOfType){let i;return a.createPrimitiveOfType==="boolean"?i=t.rawString.trim().toLowerCase()==="true":a.createPrimitiveOfType==="number"?i=Number(t.rawString):a.createPrimitiveOfType==="integer"?i=Math.round(Number(t.rawString)):i=t.rawString,a.validationFunction&&(i=a.validationFunction(i)),{primitive:i}}else return t.childrenForComponent||(t.childrenForComponent=[t.rawString]),t}function D0(a){let t=[];for(let e of a)if(typeof e=="object"){if(e.preSugarInd!==void 0)t.push(e.preSugarInd);else if(e.doenetAttributes||(e.doenetAttributes={}),e.doenetAttributes.createdFromSugar=!0,e.children){let r=D0(e.children);t.push(...r)}}return t}function Pa(a,t,e){for(let r of a)if(r.children&&Pa(r.children,t,e),r.attributes)for(let n in r.attributes){let i=r.attributes[n];if(i.component){let s=i.component;s.children&&Pa(s.children,t,e)}else i.childrenForComponent&&Pa(i.childrenForComponent,t,e)}KH(a,t,e)}function KH(a,t,e){for(let r=0;r<a.length;r++){let n=a[r];if(typeof n=="string"){let i=0;for(;i<n.length;){let s=n,o=wx(s.slice(i));if(!o.success)break;let l=o.firstIndMatched+i,u=o.matchLength,c=o.nDollarSigns,p;if(o.additionalAttributes){let h=`<copy target="${o.targetName}" ${o.additionalAttributes} />`,y=vx(h);ih(y,t,e),Ex(y),Pa(y,t),p=y}else{let h={target:o.targetName,createdFromMacro:!0};o.additionalAttributes===void 0&&(h.isPlainMacro=!0),p=[{componentType:"copy",doenetAttributes:h}]}let m=1,f=s.substring(l+u);if(c===2){let h=s.slice(l+u).match(/^\s*\(/);if(!h){i=l+2;continue}let y=u+h[0].length,b=[],g=!1;s.length>l+y&&(g=!0,b.push(s.substring(l+y))),b.push(...a.slice(r+1));let v=YH({componentsFromMacro:p,remainingComponents:b,includeFirstInRemaining:g,componentInfoObjects:t});if(!v.success){i=l+2;continue}p=v.componentsFromMacro,m=v.lastComponentIndMatched+1,g||m++,f=""}let d=[];l>0&&d.push(s.substring(0,l)),d.push(...p),f.length>0&&d.push(f),a.splice(r,m,...d),l>0&&r++;break}}if(n.componentType==="award"&&n.children&&n.attributes.targetsAreResponses){let i=n.attributes.targetsAreResponses.primitive.split(/\s+/).filter(s=>s);for(let s of i)Sx(n.children,s)}}}function Sx(a,t){for(let e of a){let r=e.props;if(r||(r=e.doenetAttributes),r)for(let n in r)n.toLowerCase()==="target"&&r[n]===t&&(e.attributes||(e.attributes={}),Object.keys(e.attributes).map(s=>s.toLowerCase()).includes("isresponse")||(e.attributes.isResponse=!0));e.children&&Sx(e.children,t)}}function wx(a){let t=/(\$\$?)(([a-zA-Z_]\w*\b)|\(([a-zA-Z0-9_:.\/\-]+)\s*(\)|{))/,e=0,r;for(;;){if(r=a.substring(e).match(t),!r)return{success:!1};if(r.index===0||a[e+r.index-1]!=="$")break;e+=r.index+r[0].length}let n=r.index+e,i=r[0].length,s=r[1].length;if(r[3])return{success:!0,firstIndMatched:n,matchLength:i,targetName:r[3],nDollarSigns:s};let o=r[4];if(r[5]===")")return{success:!0,firstIndMatched:n,matchLength:i,targetName:o,nDollarSigns:s};let l=a.substring(n+i),u=XH(l);if(u.success)return{success:!0,firstIndMatched:n,matchLength:i+u.parenInd+1,targetName:o,nDollarSigns:s,additionalAttributes:l.substring(0,u.braceInd)};{let c=wx(l);return c.success?{success:!0,firstIndMatched:n+i+c.firstIndMatched,matchLength:c.matchLength,targetName:c.targetName,nDollarSigns:c.nDollarSigns,additionalAttributes:c.additionalAttributes}:{success:!1}}}function XH(a){let t=0;for(let e=0;e<a.length;e++){let r=a[e];if(r==="}"){if(t===0){if(a.substring(e+1).trim()[0]===")"){let n=a.substring(e+1).indexOf(")")+e+1;return{success:!0,braceInd:e,parenInd:n}}return{success:!1}}t--}else r==="{"&&t++}return{success:!1}}function Ex(a){for(let t of a)t.doenetAttributes||(t.doenetAttributes={}),t.doenetAttributes.createdFromMacro=!0,t.children&&Ex(t.children)}function YH({componentsFromMacro:a,remainingComponents:t,includeFirstInRemaining:e,componentInfoObjects:r}){let n=ZH(t);if(!n.success)return n;let i=n.componentInd;t=t.slice(0,i+1);let s=t[i],o="";n.charInd+1<s.length&&(o=s.substring(n.charInd+1)),n.charInd>0?t[i]=s.substring(0,n.charInd):t=t.slice(0,i);let l=ZR({childrenList:t});l.pieces.forEach(m=>Pa(m,r));let u=l.pieces.map(m=>m.length===1&&typeof m[0]!="string"?m[0]:{componentType:"math",doenetAttributes:{createdFromMacro:!0},children:m}),p=[{componentType:"evaluate",doenetAttributes:{createdFromMacro:!0},attributes:{function:{component:{componentType:"function",doenetAttributes:{createdFromMacro:!0},children:a}},input:{component:{componentType:"mathList",doenetAttributes:{createdFromMacro:!0},children:u}}}}];return o.length>0&&p.push(o),{success:!0,componentsFromMacro:p,lastComponentIndMatched:i}}function ZH(a){let t=0;for(let[e,r]of a.entries())if(typeof r=="string"){let n=r;for(let i=0;i<n.length;i++){let s=n[i];if(s==="(")t++;else if(s===")"){if(t===0)return{success:!0,componentInd:e,charInd:i};t--}}}return{success:!1}}function sh(a){function t(e){return e.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&dollar;/g,"$").replace(/&amp;/g,"&")}for(let[e,r]of a.entries())if(typeof r=="string")a[e]=t(r);else if(r.children&&sh(r.children),r.attributes)for(let n in r.attributes){let i=r.attributes[n];i.component?sh([i.component]):i.primitive?typeof i.primitive=="string"&&(i.primitive=t(i.primitive)):(i.childrenForComponent&&sh(i.childrenForComponent),i.rawString&&(i.rawString=t(i.rawString)))}}function go({serializedComponents:a,parentParametersFromSugar:t={},parentAttributes:e={},componentInfoObjects:r,parentUniqueId:n="",isAttributeComponent:i=!1}){for(let[s,o]of a.entries()){if(typeof o!="object")continue;let l=o.componentType,u=r.allComponentClasses[l];if(!u)throw Error(`Unrecognized component type ${l}`);let c=n+"|"+l+s,p={};for(let m in o.attributes){let f=o.attributes[m];f.primitive!==void 0&&(p[m]=f.primitive)}if(o.children){let m={};if(!o.skipSugar)for(let[f,d]of u.returnSugarInstructions().entries()){let h=o.children.map(A=>typeof A=="string"?"s":"n").join("");if(d.childrenRegex){let A=h.match(d.childrenRegex);if(!A||A[0].length!==o.children.length)continue}let y=Re(o.children),b=0;for(let A of y)typeof A!="string"&&(A.preSugarInd=b,b++);let g=!1;o.doenetAttributes&&o.doenetAttributes.createdFromMacro&&(g=!0);let v=d.replacementFunction({matchedChildren:y,parentParametersFromSugar:t,parentAttributes:e,componentAttributes:p,uniqueId:c+"|sugar"+f,componentInfoObjects:r,isAttributeComponent:i,createdFromMacro:g});if(v.success){let A=v.newChildren,C=v.newAttributes,S=[],w=[];if(A&&(S=D0(A)),C)for(let R in C){let O=C[R].component;O&&w.push(...D0(O.children))}let x=[...S,...w];if(x.length!==b||!x.sort((R,O)=>R-O).every((R,O)=>R===O))throw Error(`Invalid sugar for ${l} as didn't return set of original components`);if(S.length>0&&![...S].sort((O,_)=>O-_).every((O,_)=>O===S[_]))throw Error(`Invalid sugar for ${l} as didn't return original components in order`);v.parametersForChildrenSugar&&Object.assign(m,v.parametersForChildrenSugar),A?o.children=A:o.children=[],C&&(o.attributes||(o.attributes={}),Object.assign(o.attributes,C))}}u.removeBlankStringChildrenPostSugar&&(o.children=o.children.filter(f=>typeof f!="string"||/\S/.test(f))),go({serializedComponents:o.children,parentParametersFromSugar:m,parentAttributes:p,componentInfoObjects:r,parentUniqueId:c})}if(o.attributes)for(let m in o.attributes){let f=o.attributes[m];f.component&&go({serializedComponents:[f.component],parentAttributes:p,componentInfoObjects:r,parentUniqueId:c,isAttributeComponent:!0})}}}function Rx(a){if(typeof a!="string")return{success:!1};let t=0,e=[];a=a.trim();let r=0;for(let i=0;i<a.length;i++){let s=a[i];if(s==="("){if(t===0){let o=a.substring(r,i).trim();o.length>0&&e.push(o),r=i}t++}else if(s===")"){if(t===0)return{success:!1};if(t===1){let o=a.substring(r+1,i).trim();if(o.length>0){let l=Rx(o);l.success===!0?e.push(l.pieces):e.push(o)}r=i+1}t--}else if(t===0&&s.match(/\s/)){let o=a.substring(r,i).trim();o.length>0&&e.push(o),r=i}}if(t!==0)return{success:!1};let n=a.substring(r,a.length).trim();return n.length>0&&e.push(n),{success:!0,pieces:e}}function mi({serializedComponents:a,namespaceStack:t=[],componentInfoObjects:e,parentDoenetAttributes:r={},parentName:n,useOriginalNames:i=!1,doenetAttributesByTargetComponentName:s,indOffset:o=0,createNameContext:l=""}){t.length===0&&t.push({namespace:"",componentCounts:{},namesUsed:{}});let u=t.length-1,c=t[u];for(let[p,m]of a.entries()){if(typeof m!="object")continue;let f=m.componentType,d=e.allComponentClasses[f],h=m.doenetAttributes;h===void 0&&(h=m.doenetAttributes={});let y=m.attributes;y||(y=m.attributes={});let b=h.prescribedName,g=h.assignNames,v=h.target,A=h.isAttributeChild||h.createdFromSugar||h.createdFromMacro||h.createUniqueName,C;(y.newNamespace&&y.newNamespace.primitive||i&&m.originalAttributes&&m.originalAttributes.newNamespace)&&(C=!0);let S=b!==void 0,w=m.props;if(w===void 0)w=m.props={};else for(let O in w){let _=O.toLowerCase();if(_==="name")if(b===void 0)b=w[O],delete w[O];else throw Error("Cannot define name twice for a component");else if(_==="assignnames")if(g===void 0){let k=Rx(w[O]);if(k.success)g=k.pieces;else throw Error("Invalid format for assignnames");delete w[O]}else throw Error("Cannot define assignNames twice for a component");else if(_==="target")if(v===void 0){if(typeof w[O]!="string")throw Error("Must specify value for target");v=w[O].trim(),delete w[O]}else throw Error("Cannot define target twice for a component")}if(b){if(!S&&!h.createdFromSugar){if(!/[a-zA-Z]/.test(b.substring(0,1)))throw Error(`Invalid component name: ${b}.  Component name must begin with a letter`);if(!/^[a-zA-Z0-9_\-]+$/.test(b))throw Error(`Invalid component name: ${b}.  Component name can contain only letters, numbers, hyphens, and underscores`)}h.prescribedName=b}else if(A){let O=n+"|createUniqueName|";m.downstreamDependencies?O+=JSON.stringify(m.downstreamDependencies):O+=p+"|"+o+"|"+l,b=Va(f.toLowerCase(),O)}if(!g&&i&&m.originalDoenetAttributes&&m.originalDoenetAttributes.assignNames&&(g=m.originalDoenetAttributes.assignNames),g){if(!d.assignNamesToReplacements)throw Error("Cannot assign names for component type "+m.componentType);if(h.assignNames=g,!h.createUniqueAssignNames){let _=vr(g);for(let k of _){if(!/[a-zA-Z]/.test(k.substring(0,1)))throw Error("All assigned names must begin with a letter");if(!/^[a-zA-Z0-9_\-]+$/.test(k))throw Error("Assigned names can contain only letters, numbers, hyphens, and underscores")}if(_.length!==new Set(_).size)throw Error("Duplicate assigned names")}}C&&(y.newNamespace={primitive:C});let x=c.componentCounts[f];x===void 0&&(x=0),h.isAttributeChild||h.createdFromSugar||h.createdFromMacro||(c.componentCounts[f]=++x);let R="";for(let O=0;O<=u;O++)R+=t[O].namespace+"/";if(!b){if(i&&m.originalName){let O=m.originalName.lastIndexOf("/");b=m.originalName.substring(O+1)}b||(b="_"+f.toLowerCase()+x)}if(R+=b,m.componentName=R,b){if(b in c.namesUsed)throw Error("Duplicate component name "+R);c.namesUsed[b]=!0}if(!C&&g)for(let O of vr(g)){if(O in c.namesUsed)throw Error(`Duplicate component name (from assignNames of ${R}): ${O}`);c.namesUsed[O]=!0}if(m.doenetAttributes.createUniqueAssignNames&&m.originalName){let O=m.doenetAttributes.assignNames;O||(O=m.doenetAttributes.originalAssignNames);let _=R+"|createUniqueName|assignNames|",k="",B;if(C)k=R+"/",B=m.originalName+"/";else{for(let j=0;j<=u;j++)k+=t[j].namespace+"/";let H=m.originalName.lastIndexOf("/");B=m.originalName.slice(0,H+1)}let U=xx({originalAssignNames:O,longNameIdBase:_,namespace:k,oldNamespace:B,doenetAttributesByTargetComponentName:s});g=m.doenetAttributes.assignNames=U}if(Ox(m,s),v){if(!d.acceptTarget)throw Error(`Component type ${f} does not accept a target attribute`);if(v.includes("|"))throw Error("target cannot include |");h.target=v,h.targetComponentName=I0({target:v,oldTargetComponentName:h.targetComponentName,namespaceStack:t,acceptDoubleUnderscore:h.createdFromSugar})}if(m.children)if(!C)mi({serializedComponents:m.children,namespaceStack:t,componentInfoObjects:e,parentDoenetAttributes:h,parentName:R,useOriginalNames:i,doenetAttributesByTargetComponentName:s});else{let O={};g&&vr(g).forEach(k=>O[k]=!0);let _={namespace:b,componentCounts:{},namesUsed:O};t.push(_),mi({serializedComponents:m.children,namespaceStack:t,componentInfoObjects:e,parentDoenetAttributes:h,parentName:R,useOriginalNames:i,doenetAttributesByTargetComponentName:s}),t.pop()}if(m.attributes)for(let O in m.attributes){let _=m.attributes[O];if(_.component){let k=_.component;k.doenetAttributes||(k.doenetAttributes={}),k.doenetAttributes.isAttributeChild=!0,mi({serializedComponents:[k],namespaceStack:t,componentInfoObjects:e,parentDoenetAttributes:h,parentName:R,useOriginalNames:i,doenetAttributesByTargetComponentName:s,createNameContext:O})}else _.childrenForComponent&&mi({serializedComponents:_.childrenForComponent,namespaceStack:t,componentInfoObjects:e,parentDoenetAttributes:h,parentName:R,useOriginalNames:i,doenetAttributesByTargetComponentName:s,createNameContext:O})}}return a}function xx({originalAssignNames:a,longNameIdBase:t,namespace:e,oldNamespace:r,doenetAttributesByTargetComponentName:n}){let i=[];for(let[s,o]of a.entries())if(Array.isArray(o)){let l=xx({originalAssignNames:o,longNameIdBase:t+s+"_",namespace:e,oldNamespace:r,doenetAttributesByTargetComponentName:n});i.push(l)}else{let l=t+s,u=Va("fromAssignNames",l);i.push(u);let c={componentName:e+u,originalName:r+o};Ox(c,n,!0)}return i}function I0({target:a,oldTargetComponentName:t,namespaceStack:e,acceptDoubleUnderscore:r}){if(!t&&/__/.test(a)&&!r)throw Error("Invalid reference target: "+a);let n;if(a.substring(0,1)==="/")n=a;else{let i=e.length-1;for(;a.substring(0,3)==="../";)a=a.substring(3),i--;i<0&&(i=0),n="";for(let s=0;s<=i;s++)n+=e[s].namespace+"/";n+=a}return n}function cn(a,t){return t!==t?{objectType:"special-numeric",stringValue:"NaN"}:t===1/0?{objectType:"special-numeric",stringValue:"Infinity"}:t===-1/0?{objectType:"special-numeric",stringValue:"-Infinity"}:t}var JH=function(a,t){if(t&&t.objectType==="special-numeric"){if(t.stringValue==="NaN")return NaN;if(t.stringValue==="Infinity")return 1/0;if(t.stringValue==="-Infinity")return-1/0}return t};function Kl(a,t){return WH.reviver(a,Nt.Subset.reviver(a,JH(a,t)))}function _a({serializedComponents:a,componentInfoObjects:t}){let e=[];for(let r of a){if(r.variants?.isVariantComponent){e.push(r);continue}if(r.componentType in t.componentTypesCreatingVariants){r.variants={isVariantComponent:!0},e.push(r);continue}if(!r.children)continue;if(r.children.some(s=>s.componentType==="variantControl")){r.variants={isVariantComponent:!0},e.push(r);continue}let i=_a({serializedComponents:r.children,componentInfoObjects:t});i.length>0&&(r.variants={descendantVariantComponents:i},e.push(...i))}return e}function Vx({serializedComponent:a,componentInfoObjects:t}){a.variants||(a.variants={});let e;for(let s of a.children)if(s.componentType==="variantControl"){e=s;break}if(!e)return 100;let r=e.attributes.nVariants?.primitive;if(r===void 0&&(r=100),!e.attributes.uniqueVariants?.primitive)return r;let i=t.allComponentClasses[a.componentType].determineNumberOfUniqueVariants({serializedComponent:a,componentInfoObjects:t});return i.success&&(r=i.numberOfVariants,a.variants.uniqueVariants=!0),r}function de({assignNames:a=[],serializedComponents:t,parentName:e,parentCreatesNewNamespace:r,componentInfoObjects:n,indOffset:i=0,originalNamesAreConsistent:s=!1}){let o=t.length;oh(t);let l={},u=null;if(s){if(o>0){let m=t.filter(f=>typeof f=="object")[0];if(m&&m.originalName){let f=m.originalName.lastIndexOf("/");u=m.originalName.substring(0,f)}}if(u!==null)for(let m of t)Jp({namespace:u,components:[m],doenetAttributesByTargetComponentName:l})}else for(let m=0;m<o;m++){let f=t[m];if(typeof f=="object"){if(u=null,o>0&&f.originalName){let d=f.originalName.lastIndexOf("/");u=f.originalName.substring(0,d)}u!==null&&Jp({namespace:u,components:[f],doenetAttributesByTargetComponentName:l})}}let c=[],p=0;for(let m=0;m<o;m++){let f=m+i,d=t[m];if(typeof d!="object"){p++,c.push(d);continue}let h=a[f-p];if(d.doenetAttributes||(d.doenetAttributes={}),!s&&(u=null,o>0&&d.originalName)){let y=d.originalName.lastIndexOf("/");u=d.originalName.substring(0,y)}if(n.allComponentClasses[d.componentType].assignNamesSkipOver)h=[h];else if(d.attributes&&d.attributes.assignNamesSkip){let y=d.attributes.assignNamesSkip.primitive;if(y>0)for(let b=0;b<y;b++)h=[h]}if(Array.isArray(h))if(n.allComponentClasses[d.componentType].assignNamesToReplacements){let y=e+"|assignName|"+f.toString();d.doenetAttributes.prescribedName=Va(d.componentType.toLowerCase(),y);let b=e;if(!r){let g=e.lastIndexOf("/");b=e.substring(0,g)}b+="/"+d.doenetAttributes.prescribedName,d.componentName=b,d.doenetAttributes.assignNames=h,c.push(d);continue}else console.warn(`Cannot assign names recursively to ${d.componentType}`),h=null;if(!h)if(s&&d.originalName)h=d.originalName.slice(u.length+1);else{let y=e+"|assignName|"+f.toString();h=Va(d.componentType.toLowerCase(),y)}d.doenetAttributes.prescribedName=h,s&&!d.doenetAttributes.assignNames&&d.originalDoenetAttributes&&d.originalDoenetAttributes.assignNames&&(d.doenetAttributes.assignNames=d.originalDoenetAttributes.assignNames),QH({parentName:e,ind:f,component:d,parentCreatesNewNamespace:r,componentInfoObjects:n,doenetAttributesByTargetComponentName:l,originalNamesAreConsistent:s}),c.push(d)}return{serializedComponents:c}}function QH({parentName:a,component:t,ind:e,parentCreatesNewNamespace:r,componentInfoObjects:n,doenetAttributesByTargetComponentName:i,originalNamesAreConsistent:s}){let o=a.split("/");r||o.pop();let l=o.map(c=>({namespace:c,componentCounts:{},namesUsed:{}}));a[0]!=="/"&&l.splice(0,0,{componentCounts:{},namesUsed:{},namespace:""}),t.doenetAttributes||(t.doenetAttributes={}),t.attributes||(t.attributes={});let u;t.attributes.newNamespace&&t.attributes.newNamespace.primitive||s?u=!0:(u=!1,t.children&&Xl(t.children));for(let c in t.attributes){let p=t.attributes[c];p.component?Xl([p.component]):p.childrenForComponent&&Xl(p.childrenForComponent)}mi({serializedComponents:[t],namespaceStack:l,componentInfoObjects:n,parentName:a,useOriginalNames:u,doenetAttributesByTargetComponentName:i,indOffset:e})}function Jp({namespace:a,components:t,doenetAttributesByTargetComponentName:e}){let r=a.length;for(let n of t)if(typeof n=="object"){if(n.doenetAttributes&&n.doenetAttributes.target){let i=n.doenetAttributes.targetComponentName;i!==void 0&&(i.substring(0,r)!==a&&(n.doenetAttributes.target=i),e[i]||(e[i]=[]),e[i].push(n.doenetAttributes))}if(n.children&&Jp({namespace:a,components:n.children,doenetAttributesByTargetComponentName:e}),n.attributes)for(let i in n.attributes){let s=n.attributes[i];s.component?Jp({namespace:a,components:[s.component],doenetAttributesByTargetComponentName:e}):s.childrenForComponent&&Jp({namespace:a,components:s.childrenForComponent,doenetAttributesByTargetComponentName:e})}}}function Ox(a,t,e=!1){if(a.originalName&&t&&a.componentName!==a.originalName){if(t[a.originalName])for(let r of t[a.originalName])r.target=a.componentName,r.targetComponentName=a.componentName;if(e){let r=a.originalName+"/",n=r.length;for(let i in t)if(i.substring(0,n)===r){let s=i.substring(n);for(let o of t[i])o.target=a.componentName+"/"+s,o.targetComponentName=a.componentName+"/"+s}}}}function oh(a){for(let t of a)if(t.componentName&&(t.originalName=t.componentName,delete t.componentName),t.children&&oh(t.children),t.attributes)for(let e in t.attributes){let r=t.attributes[e];r.component?oh([r.component]):r.childrenForComponent&&oh(r.childrenForComponent)}}function Xl(a){for(let t of a)if(typeof t=="object"&&(t.doenetAttributes||(t.doenetAttributes={}),t.doenetAttributes.createUniqueName=!0,t.doenetAttributes.assignNames?(t.doenetAttributes.createUniqueAssignNames=!0,t.doenetAttributes.originalAssignNames=t.doenetAttributes.assignNames,delete t.doenetAttributes.assignNames):t.originalDoenetAttributes&&t.originalDoenetAttributes.assignNames&&(t.doenetAttributes.createUniqueAssignNames=!0,t.doenetAttributes.originalAssignNames=t.originalDoenetAttributes.assignNames),delete t.doenetAttributes.prescribedName,t.children&&Xl(t.children),t.attributes))for(let e in t.attributes){let r=t.attributes[e];r.component?Xl([r.component]):r.childrenForComponent&&Xl(r.childrenForComponent)}}function ys(a){for(let t of a){if(t.doenetAttributes&&t.doenetAttributes.target){let e=t.doenetAttributes.targetComponentName;e!==void 0&&(t.doenetAttributes.target=e)}if(t.children&&ys(t.children),t.attributes)for(let e in t.attributes){let r=t.attributes[e];r.component?ys([r.component]):r.childrenForComponent&&ys(r.childrenForComponent)}}}function vo({components:a,namespace:t,parentNamespace:e,parentIsCopy:r=!1}){e===void 0&&(e=t);let n=t.length;for(let i of a){if(i.doenetAttributes&&i.doenetAttributes.target){let s=i.doenetAttributes.target;if(s[0]==="/"){if(s.substring(0,n)!==t){let o=t+s.substring(1);i.doenetAttributes.target=o,i.doenetAttributes.targetComponentName=o}}else if(s.substring(0,3)==="../"){let o=s,l=e;for(;o.substring(0,3)==="../";){o=o.substring(3);let u=l.substring(0,l.length-1).lastIndexOf("/");if(l=l.substring(0,u+1),l.substring(0,n)!==t){for(;o.substring(0,3)==="../";)o=o.substring(3);let c=t+o;i.doenetAttributes.target=c,i.doenetAttributes.targetComponentName=c;break}}}}if(i.children){let s=t;r&&i.componentType==="externalContent"&&(s=i.componentName+"/");let o=e;i.attributes&&i.attributes.newNamespace&&i.attributes.newNamespace.primitive&&(o=i.componentName),vo({components:i.children,namespace:s,parentNamespace:o,parentIsCopy:i.componentType==="copy"})}if(i.attributes)for(let s in i.attributes){let o=i.attributes[s];o.component?vo({components:[o.component],namespace:t,parentNamespace:e}):o.childrenForComponent&&vo({components:o.childrenForComponent,namespace:t,parentNamespace:e})}}}function P0(){return{get:function(a,t){let e=a[t];return e!==void 0&&(e.isArray&&(e.public||e.trackChanges)?e=new Proxy(e.value,_0({variable:t,nDimensions:e.nDimensions})):e=e.value),e},set:function(a,t,e){throw Error("Property "+t+" is read-only")},deleteProperty:function(a,t){throw Error("Property "+t+" is read-only")}}}function _0({variable:a,nDimensions:t,indicesSoFar:e=[]}){return{variable:a,nDimensions:t,indicesSoFar:e,get:function(r,n){if(n==="then"&&r instanceof Promise)return s=>r.then.bind(r)(o=>s(o!==null&&typeof o=="object"?new Proxy(o,_0({variable:this.variable,nDimensions:this.nDimensions,indicesSoFar:this.indicesSoFar})):o));let i=r[n];return i!==null&&typeof i=="object"&&t>1&&(i=new Proxy(i,_0({variable:this.variable,nDimensions:this.nDimensions-1,indicesSoFar:[...this.indicesSoFar,n]}))),i},set:function(r,n,i){throw Error("Property "+n+" is read-only")},deleteProperty:function(r,n){throw Error("Property "+n+" is read-only")}}}function _r({serializedComponents:a,componentName:t,addShadowDependencies:e=!0,uniqueIdentifiersUsed:r=[],identifierPrefix:n="",unlinkExternalCopies:i=!1,copiesByTargetComponentName:s={},componentNamesFound:o=[],assignNamesFound:l=[],activeAliases:u=[],init:c=!0}){for(let p in a){let m=a[p];if(typeof m!="object")continue;let f;if(m.originalName){if(i){if(o.push(m.originalName),m.originalDoenetAttributes&&m.originalDoenetAttributes.assignNames){let d;if(m.attributes.newNamespace&&m.attributes.newNamespace.primitive)d=m.originalName;else{let h=m.originalName.lastIndexOf("/");d=m.originalName.substring(0,h)}for(let h of m.originalDoenetAttributes.assignNames)o.push(d+"/"+h),l.push(d+"/"+h)}m.attributes&&(m.attributes.alias&&u.push(m.attributes.alias.primitive),m.attributes.indexAlias&&u.push(m.attributes.indexAlias.primitive))}if(f=n+m.originalName+"|shadow",e&&!m.originalNameFromSerializedComponent){let d={[m.originalName]:[{dependencyType:"referenceShadow",compositeName:t}]};if(c&&(d[m.originalName][0].firstLevelReplacement=!0),m.state){let h=Object.keys(m.state);d[m.originalName].downstreamStateVariables=h,d[m.originalName].upstreamStateVariables=h}m.downstreamDependencies=d}}else f=n+m.componentType+"|shadowUnnamed";if(m.componentType==="copy"&&i){let d=m.doenetAttributes.targetComponentName;if(d)u.includes(m.doenetAttributes.target)?m.doenetAttributes.targetComponentName=m.doenetAttributes.target:(s[d]===void 0&&(s[d]=[]),s[d].push(m));else if(!m.attributes.uri)throw Error("we need to create a targetComponentName here, then.")}m.uniqueIdentifier=Oa(f,r)}for(let p in a){let m=a[p];if(typeof m=="object"){_r({serializedComponents:m.children,componentName:t,addShadowDependencies:e,uniqueIdentifiersUsed:r,identifierPrefix:n,unlinkExternalCopies:i,copiesByTargetComponentName:s,componentNamesFound:o,assignNamesFound:l,activeAliases:[...u],init:!1});for(let f in m.attributes){let d=m.attributes[f];d.component&&(d.component=_r({serializedComponents:[d.component],componentName:t,addShadowDependencies:e,uniqueIdentifiersUsed:r,identifierPrefix:n,unlinkExternalCopies:i,copiesByTargetComponentName:s,componentNamesFound:o,assignNamesFound:l,activeAliases:[...u],init:!1})[0])}m.replacements&&_r({serializedComponents:m.replacements,componentName:t,addShadowDependencies:e,uniqueIdentifiersUsed:r,identifierPrefix:n,unlinkExternalCopies:i,copiesByTargetComponentName:s,componentNamesFound:o,assignNamesFound:l,activeAliases:[...u],init:!1})}}if(c&&i){for(let p in s)if(!o.includes(p)){let m=!1;for(let f of l){let d=f+"/",h=d.length;if(p.substring(0,h)===d){m=!0;break}}if(!m)for(let f of s[p])f.attributes||(f.attributes={}),f.attributes.link={primitive:!1},f.doenetAttributes.target=f.doenetAttributes.targetComponentName}}return a}function Ze({attributes:a,componentType:t,componentInfoObjects:e,compositeAttributesObj:r={},compositeCreatesNewNamespace:n,flags:i}){let s=e.allComponentClasses[t],o=s.createAttributesObject({flags:i}),l={};for(let c in o)l[c.toLowerCase()]=c;let u={};for(let c in a){if(c in r&&!r[c].leaveRaw)continue;let p=l[c.toLowerCase()],m=o[p];if(m){if(p in u)throw Error(`Cannot repeat prop ${p}`);if(u[p]=bo({attrObj:m,value:JSON.parse(JSON.stringify(a[c])),componentInfoObjects:e}),u[p].component?.children){let f=[u[p].component];if(Pa(f,e),$l(f,e),go({serializedComponents:f,componentInfoObjects:e,isAttributeComponent:!0}),n){for(let d of u[p].component.children)if(d.componentType==="copy"){let h=d.doenetAttributes.target;/[a-zA-Z_]/.test(h[0])&&(d.doenetAttributes.target="../"+h)}}}}else s.acceptAnyAttribute&&(u[c]=JSON.parse(JSON.stringify(a[c])))}return u}function k0({ancestor:a,descendantTypes:t,recurseToMatchedChildren:e=!0,useReplacementsForComposites:r=!1,includeNonActiveChildren:n=!1,skipOverAdapters:i=!1,ignoreReplacementsOfMatchedComposites:s=!1,ignoreReplacementsOfEncounteredComposites:o=!1,init:l=!0,componentInfoObjects:u}){let c=f=>t.some(d=>u.isInheritedComponentType({inheritedComponentType:f.componentType,baseComponentType:d})),p=[];if(r&&u.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"_composite"}))l&&p.push(...F0({composite:a,componentInfoObjects:u,includeComposites:n}).filter(f=>typeof f=="object"));else for(let f of a.allChildrenOrdered){let d=a.allChildren[f],h,y=!1,b=!1;if(d)h=d.component,h.adaptedFrom&&(b=!0),a.activeChildren.includes(h)&&(y=!0);else for(let g of a.activeChildren)if(g.placeholderInd===f){h=g,y=!0,typeof f=="string"&&f.substring(f.length-5,f.length)==="adapt"&&(b=!0);break}else if(g.adaptedFrom&&achild.adaptedFrom.placeholderInd===f){h=g.adaptedFrom;break}h&&(b&&i?p.includes(h.adaptedFrom)||p.push(h.adaptedFrom):(y||n)&&p.push(h))}if(s||o){let f=[];for(let d of p){let h=c(d);o&&(h=!0),h&&u.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"_composite"})&&(f=[...f,...F0({composite:d,componentInfoObjects:u,includeComposites:!0}).filter(y=>typeof y=="object").map(y=>y.componentName?y.componentName:y.placeholderInd)])}f.length>0&&(p=p.filter(d=>!(f.includes(d.componentName)||f.includes(d.placeholderInd))))}let m=[];for(let f of p){let d=c(f);if(d&&m.push({componentName:f.componentName?f.componentName:f.placeholderInd,componentType:f.componentType}),(!d||e)&&f.placeholderInd===void 0){let h=k0({ancestor:f,descendantTypes:t,recurseToMatchedChildren:e,useReplacementsForComposites:r,includeNonActiveChildren:n,skipOverAdapters:i,ignoreReplacementsOfMatchedComposites:s,ignoreReplacementsOfEncounteredComposites:o,init:!1,componentInfoObjects:u});m.push(...h)}}return m}function F0({composite:a,includeComposites:t=!1,componentInfoObjects:e}){let r=[];if(a.replacements){let n;if(a.replacementsToWithhold){let i=a.replacements.length-a.replacementsToWithhold;n=a.replacements.slice(0,i)}else n=a.replacements;for(let i of n)e.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"_composite"})?(t&&r.push(i),r.push(...F0({composite:i,componentInfoObjects:e,includeComposites:t}))):r.push(i)}return r}function Yl(a,t){if(a.ancestors===void 0||a.ancestors.length===0)return[];let e=[a.ancestors[0].componentName],r=t[a.ancestors[0].componentName];if(r&&e.push(...Yl(r,t)),a.replacementOf){e.push(a.replacementOf.componentName);let n=Yl(a.replacementOf,t);for(let i of n)e.includes(i)||e.push(i)}return e}var et=[],j0=class{constructor({_components:t,componentInfoObjects:e,core:r}){this.upstreamDependencies={},this.downstreamDependencies={},this.switchDependencies={},this.circularCheckPassed={},this.circularResolveBlockedCheckPassed={},this.dependencyTypes={},et.forEach(n=>this.dependencyTypes[n.dependencyType]=n),this.core=r,this._components=t,this.componentInfoObjects=e,this.updateTriggers={descendantDependenciesByAncestor:{},ancestorDependenciesByPotentialAncestor:{},replacementDependenciesByComposite:{},childDependenciesByParent:{},parentDependenciesByParent:{},dependenciesMissingComponentBySpecifiedName:{},dependenciesBasedOnDependenciesOfStateVariables:{}},this.resolveBlockers={neededToResolve:{},resolveBlockedBy:{}}}async setUpComponentDependencies(t){this.downstreamDependencies[t.componentName]&&this.deleteAllDownstreamDependencies({component:t}),this.downstreamDependencies[t.componentName]={},this.upstreamDependencies[t.componentName]||(this.upstreamDependencies[t.componentName]={});let e=[],r=[];for(let n in t.state)t.state[n].isArrayEntry||t.state[n].isAlias||r.includes(n)||(e.push(n),t.state[n].additionalStateVariablesDefined&&r.push(...t.state[n].additionalStateVariablesDefined));for(let n of e){let i=[n];t.state[n].additionalStateVariablesDefined&&i.push(...t.state[n].additionalStateVariablesDefined),await this.setUpStateVariableDependencies({component:t,stateVariable:n,allStateVariablesAffected:i})}}async setUpStateVariableDependencies({component:t,stateVariable:e,allStateVariablesAffected:r}){let n=t.state[e],i;n.stateVariablesDeterminingDependencies?(i={},n.stateVariablesDeterminingDependencies&&(i.__determine_dependencies={dependencyType:"determineDependencies",variableNames:n.stateVariablesDeterminingDependencies})):i=await n.returnDependencies({componentInfoObjects:this.componentInfoObjects,sharedParameters:t.sharedParameters});for(let s in i){let o=i[s];if(!(o.dependencyType in this.dependencyTypes))throw Error(`Unrecognized dependency type ${o.dependencyType} for ${s} of ${e} of ${t.componentName}`);let l=new this.dependencyTypes[o.dependencyType]({component:t,stateVariable:e,allStateVariablesAffected:r,dependencyName:s,dependencyDefinition:o,dependencyHandler:this,expandComposites:!1,forceExpandComposites:!1});await l.initialize(),l.checkForCircular()}}deleteAllDownstreamDependencies({component:t,stateVariables:e="__all__"}){let r=t.componentName,n;e==="__all__"?n=Object.keys(this.downstreamDependencies[r]):n=e;for(let i of n){let s=this.downstreamDependencies[r][i];for(let o in s)s[o].deleteDependency();delete this.downstreamDependencies[r][i]}Object.keys(this.downstreamDependencies[r]).length===0&&!this.components[r]&&delete this.downstreamDependencies[r]}async deleteAllUpstreamDependencies({component:t,stateVariables:e="__all__",completelyDelete:r=!1}){let n=t.componentName,i;e==="__all__"?i=Object.keys(this.upstreamDependencies[n]):i=e;for(let s of i){if(this.upstreamDependencies[n][s])for(let o of[...this.upstreamDependencies[n][s]])if(r){for(let l of o.upstreamVariableNames)this._components[o.upstreamComponentName].state[l].initiallyResolved&&await this.core.recordActualChangeInStateVariable({componentName:o.upstreamComponentName,varName:l});o.deleteDependency()}else await o.removeDownstreamComponent({indexToRemove:o.downstreamComponentNames.indexOf(n)});delete this.upstreamDependencies[n][s]}Object.keys(this.upstreamDependencies[n]).length===0&&!this._components[n]&&delete this.upstreamDependencies[n]}async addBlockersFromChangedStateVariableDependencies({componentName:t,stateVariables:e}){let r=this.updateTriggers.dependenciesBasedOnDependenciesOfStateVariables[t];if(r)for(let n of e){let i=r[n];if(i)for(let s of i)if(s.gettingValue){let o=s.varsWithUpdatedDeps[t];o||(o=s.varsWithUpdatedDeps[t]=[]),o.includes(n)||o.push(n)}else for(let o of s.upstreamVariableNames)await this.addBlocker({blockerComponentName:s.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:o,blockerDependency:s.dependencyName,componentNameBlocked:s.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:o})}}async addBlockersFromChangedActiveChildren({parent:t}){if(await this.collateCountersAndPropagateToAncestors(t),this.updateTriggers.childDependenciesByParent[t.componentName])for(let e of this.updateTriggers.childDependenciesByParent[t.componentName]){for(let r of e.upstreamVariableNames)await this.addBlocker({blockerComponentName:e.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:e.dependencyName,componentNameBlocked:e.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});await this.addBlockersFromChangedStateVariableDependencies({componentName:e.upstreamComponentName,stateVariables:e.upstreamVariableNames})}if(t.ancestors){if(this.updateTriggers.parentDependenciesByParent[t.componentName])for(let e of this.updateTriggers.parentDependenciesByParent[t.componentName]){for(let r of e.upstreamVariableNames)await this.addBlocker({blockerComponentName:e.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:e.dependencyName,componentNameBlocked:e.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});await this.addBlockersFromChangedStateVariableDependencies({componentName:e.upstreamComponentName,stateVariables:e.upstreamVariableNames})}for(let e of[t.componentName,...Yl(t,this.components)])await this.addDescendantBlockersToAncestor(e);if(this.updateTriggers.ancestorDependenciesByPotentialAncestor[t.componentName])for(let e of this.updateTriggers.ancestorDependenciesByPotentialAncestor[t.componentName]){for(let r of e.upstreamVariableNames)await this.addBlocker({blockerComponentName:e.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:e.dependencyName,componentNameBlocked:e.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});await this.addBlockersFromChangedStateVariableDependencies({componentName:e.upstreamComponentName,stateVariables:e.upstreamVariableNames})}}}async resolveBlockersFromChangedActiveChildren(t,e=!1){if(await this.collateCountersAndPropagateToAncestors(t),this.updateTriggers.childDependenciesByParent[t.componentName])for(let r of this.updateTriggers.childDependenciesByParent[t.componentName])await this.resolveIfReady({componentName:r.upstreamComponentName,type:"recalculateDownstreamComponents",stateVariable:r.representativeStateVariable,dependency:r.dependencyName,force:e});if(t.ancestors){if(this.updateTriggers.parentDependenciesByParent[t.componentName])for(let r of this.updateTriggers.parentDependenciesByParent[t.componentName])await this.resolveIfReady({componentName:r.upstreamComponentName,type:"recalculateDownstreamComponents",stateVariable:r.representativeStateVariable,dependency:r.dependencyName,force:e});for(let r of[t.componentName,...Yl(t,this.components)])await this.resolveDescendantBlockersToAncestor(r,e);if(this.updateTriggers.ancestorDependenciesByPotentialAncestor[t.componentName])for(let r of this.updateTriggers.ancestorDependenciesByPotentialAncestor[t.componentName])await this.resolveIfReady({componentName:r.upstreamComponentName,type:"recalculateDownstreamComponents",stateVariable:r.representativeStateVariable,dependency:r.dependencyName,force:e})}}async addDescendantBlockersToAncestor(t){if(this.updateTriggers.descendantDependenciesByAncestor[t])for(let e of this.updateTriggers.descendantDependenciesByAncestor[t]){for(let r of e.upstreamVariableNames)await this.addBlocker({blockerComponentName:e.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:e.dependencyName,componentNameBlocked:e.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});await this.addBlockersFromChangedStateVariableDependencies({componentName:e.upstreamComponentName,stateVariables:e.upstreamVariableNames})}}async resolveDescendantBlockersToAncestor(t,e=!1){if(this.updateTriggers.descendantDependenciesByAncestor[t])for(let r of this.updateTriggers.descendantDependenciesByAncestor[t])await this.resolveIfReady({componentName:r.upstreamComponentName,type:"recalculateDownstreamComponents",stateVariable:r.representativeStateVariable,dependency:r.dependencyName,force:e})}async addBlockersFromChangedReplacements(t){if(this.updateTriggers.replacementDependenciesByComposite[t.componentName])for(let e of this.updateTriggers.replacementDependenciesByComposite[t.componentName])for(let r of e.upstreamVariableNames)await this.addBlocker({blockerComponentName:e.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:e.dependencyName,componentNameBlocked:e.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});for(let e of[t.componentName,...Yl(t,this.components)])await this.addDescendantBlockersToAncestor(e)}checkForCircularDependency({componentName:t,varName:e,previouslyVisited:r=[]}){let n=t+":"+e;if(r.includes(n)){console.log("found circular",n,r);let i=/^(.*):/,s=r.map(u=>u.match(i)[1]),o=s.filter(u=>u.slice(0,2)!=="__").reduce((u,c)=>u.includes(c)?u:[...u,c],[]);o.length===0&&(o=[s[0]]);let l;throw o.length===1?l=o[0]:o.length===2?l=o.join(" and "):(o[o.length-2]=o.slice(o.length-2).join(", and "),o.pop(),l=o.join(", ")),Error(`Circular dependency involving ${l}`)}else r=[...r,n];if(!this.circularCheckPassed[n]&&(this.circularCheckPassed[n]=!0,t in this.downstreamDependencies)){let i=this.downstreamDependencies[t][e];for(let s in i){let o=i[s],l=o.downstreamComponentNames;if(!l)continue;let u=o.mappedDownstreamVariableNamesByComponent;if(!!u)for(let[c,p]of l.entries()){let m=u[c];for(let f of m)this.checkForCircularDependency({componentName:p,varName:f,previouslyVisited:r})}}}}resetCircularCheckPassed(t,e){let r=t+":"+e;if(this.circularCheckPassed[r]){delete this.circularCheckPassed[r];let n=this.upstreamDependencies[t][e];if(n)for(let i of n)for(let s of i.upstreamVariableNames)s!=="__identity"&&this.resetCircularCheckPassed(i.upstreamComponentName,s)}}async updateDependencies({componentName:t,stateVariable:e,dependency:r}){let n=this._components[t],i=n.state[e],s=[e];i.additionalStateVariablesDefined&&s.push(...i.additionalStateVariablesDefined);let o=this.downstreamDependencies[t][e].__determine_dependencies,l;if(o){let m=!0;if(o.originalDownstreamVariableNames.length>0)for(let[f,d]of o.downstreamComponentNames.entries()){let h=this._components[d];for(let y of o.mappedDownstreamVariableNamesByComponent[f]){let b=h.state[y].isResolved;if(b||(b=(await this.resolveItem({componentName:d,type:"stateVariable",stateVariable:y})).success),!b){m=!1;for(let g of s)await this.addBlocker({blockerComponentName:d,blockerType:"stateVariable",blockerStateVariable:y,componentNameBlocked:t,typeBlocked:"determineDependencies",stateVariableBlocked:g,dependencyBlocked:r})}}}if(m)l=await o.getValue();else return{success:!1}}else l={changes:{},value:{stateValues:{}}};if(Object.keys(l.changes).length===0&&i._previousValue!==void 0)return{success:!0};let u={stateValues:Object.assign({},l.value.stateValues),componentInfoObjects:this.componentInfoObjects,sharedParameters:n.sharedParameters},c=await i.returnDependencies(u);i.stateVariablesDeterminingDependencies&&(c.__determine_dependencies={dependencyType:"determineDependencies",variableNames:i.stateVariablesDeterminingDependencies});let p=await this.replaceDependenciesIfChanged({component:n,stateVariable:e,newDependencies:c,allStateVariablesAffected:s});if(!(p.changedDependency||u.changedDependency))return{success:!0};for(let m of p.newlyCreatedDependencies)m.checkForCircular();for(let m of s)this.checkForCircularDependency({componentName:n.componentName,varName:m}),n.state[m].forceRecalculation=!0;i.initiallyResolved&&await this.core.markStateVariableAndUpstreamDependentsStale({component:n,varName:e});for(let m of s)n.state[m].initiallyResolved&&this.recordActualChangeInUpstreamDependencies({component:n,varName:m});return await this.addBlockersFromChangedStateVariableDependencies({componentName:t,stateVariables:s}),{success:!0}}async replaceDependenciesIfChanged({component:t,stateVariable:e,newDependencies:r,allStateVariablesAffected:n}){let i=this.downstreamDependencies[t.componentName][e],s=!1,o=[];for(let l in i)l in r||(s=!0,i[l].deleteDependency());for(let l in r)if(l in i){let u=r[l],c=i[l];if(!Ot(u,c.definition)){s=!0,i[l].deleteDependency();let p=r[l],m=new this.dependencyTypes[p.dependencyType]({component:t,stateVariable:e,allStateVariablesAffected:n,dependencyName:l,dependencyDefinition:p,dependencyHandler:this});await m.initialize(),o.push(m)}}else{s=!0;let u=r[l],c=new this.dependencyTypes[u.dependencyType]({component:t,stateVariable:e,allStateVariablesAffected:n,dependencyName:l,dependencyDefinition:u,dependencyHandler:this});await c.initialize(),o.push(c)}return{changedDependency:s,newlyCreatedDependencies:o}}async checkForDependenciesOnNewComponent(t){let e=[],r={};if(this.updateTriggers.dependenciesMissingComponentBySpecifiedName[t]){for(let n of this.updateTriggers.dependenciesMissingComponentBySpecifiedName[t]){let i=this._components[n.upstreamComponentName];if(!i)continue;let s=!0;for(let l of n.upstreamVariableNames)if(!(l in i.state)){s=!1;break}if(!s)continue;for(let l of n.upstreamVariableNames)i.state[l].initiallyResolved&&(r[n.upstreamComponentName]&&r[n.upstreamComponentName][l]||e.push({componentName:n.upstreamComponentName,varName:l}));for(let l of n.upstreamVariableNames)this.deleteFromNeededToResolve({componentNameBlocked:n.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:l,dependencyBlocked:n.dependencyName,blockerComponentName:t,blockerType:"componentIdentity"});if((await this.resolveIfReady({componentName:n.upstreamComponentName,type:"recalculateDownstreamComponents",stateVariable:n.representativeStateVariable,dependency:n.dependencyName,expandComposites:!1,recurseUpstream:!0})).success)for(let l of n.upstreamVariableNames)i.state[l].initiallyResolved||(r[n.upstreamComponentName]||(r[n.upstreamComponentName]={}),r[n.upstreamComponentName][l]=!0);else for(let l of n.upstreamVariableNames)await this.addBlocker({blockerComponentName:n.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:l,blockerDependency:n.dependencyName,componentNameBlocked:n.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:l})}delete this.updateTriggers.dependenciesMissingComponentBySpecifiedName[t]}return e}async getStateVariableDependencyValues({component:t,stateVariable:e}){let r={},n={},i={},s=this.downstreamDependencies[t.componentName][e];for(let o in s){let{value:l,changes:u,usedDefault:c}=await s[o].getValue();r[o]=l,Object.keys(u).length>0&&(n[o]=u),c&&(i[o]=c)}return{dependencyValues:r,changes:n,usedDefault:i}}recordActualChangeInUpstreamDependencies({component:t,varName:e,changes:r}){let n=t.componentName,i=this.upstreamDependencies[n][e];if(i){for(let s of i)if(s.valuesChanged){let o=s.downstreamComponentNames.indexOf(n),l=s.valuesChanged[o][e];if(!l&&t.stateVarAliases)for(let u in t.stateVarAliases)t.stateVarAliases[u]===e&&u in upValuesChangedSub&&(l=upValuesChangedSub[u]);if(!l){if(!t.state[e].isArrayEntry)throw Error(`Something is wrong, as a variable ${e} of ${t.componentName} actually changed, but wasn't marked with a potential change`);l=upValuesChangedSub[e]={changed:{}}}t.state[e]&&t.state[e].isArray?(l.changed===void 0?l.changed={arrayKeysChanged:{}}:l.changed===!0&&(l.changed={allArrayKeysChanged:!0,arraySizeChanged:!0,arrayKeysChanged:{}}),r&&(r.allArrayKeysChanged&&(l.changed.allArrayKeysChanged=!0),r.arraySizeChanged&&(l.changed.arraySizeChanged=!0),Object.assign(l.changed.arrayKeysChanged,r.arrayKeysChanged))):l.changed=!0}}}async collateCountersAndPropagateToAncestors(t){let e=Object.keys(t.counters);for(let s of t.allChildrenOrdered){let o=this._components[s];if(o)for(let l in o.counters)e.includes(l)||e.push(l)}let r=!1;for(let s of e){let o=t.counters[s];o||(o=t.counters[s]={dependencies:[],componentList:[]});let l=[];o.dependencies.length>0&&l.push(t.componentName);for(let u of t.allChildrenOrdered){let c=this._components[u];if(c){let p=c.counters[s];p&&l.push(...p.componentList)}}(l.length!==o.componentList.length||o.componentList.some((u,c)=>u!=l[c]))&&(r=!0,o.componentList=l)}if(!r)return{foundChange:!1};if(!t.ancestors[0]){for(let s of e){let o=t.counters[s];for(let[l,u]of o.componentList.entries()){let c=this._components[u],p=c.counters[s];p.value=l+1;for(let m of p.dependencies)if(c.state[m.representativeStateVariable].initiallyResolved){await this.core.markStateVariableAndUpstreamDependentsStale({component:c,varName:m.representativeStateVariable});for(let f of m.upstreamVariableNames)c.state[f].forceRecalculation=!0,this.recordActualChangeInUpstreamDependencies({component:c,varName:f})}}}return{foundChange:!0,finishedPropagation:!0}}let n=this._components[t.ancestors[0].componentName];if(!(n&&n.allChildrenOrdered.includes(t.componentName)))return{foundChange:!0,finishedPropagation:!1};let i=await this.collateCountersAndPropagateToAncestors(n);return i.foundChange||console.error(`we found a change in propagating counters for ${t.componentName}, but no change for ancestors!`),{foundChange:!0,finishedPropagation:i.finishedPropagation}}getNeededToResolve({componentName:t,type:e,stateVariable:r,dependency:n}){let i=this.resolveBlockers.neededToResolve[t];i||(i=this.resolveBlockers.neededToResolve[t]={});let s=i[e];if(s||(s=i[e]={}),r){let o=s;if(s=o[r],s||(s=o[r]={}),n){let l=s;s=l[n],s||(s=l[n]={})}}return s}deleteFromNeededToResolve({componentNameBlocked:t,typeBlocked:e,stateVariableBlocked:r,dependencyBlocked:n,blockerType:i,blockerCode:s,deleteFromReciprocal:o=!0}){let l=t;r&&(l+="|"+r,n&&(l+="|"+n));let u=function(p){if(i){if(p[i])if(s){let m=p[i].indexOf(s);if(m!==-1&&p[i].splice(m,1),p[i].length===0&&delete p[i],o){let[f,d,h]=s.split("|");this.deleteFromResolveBlockedBy({blockerComponentName:f,blockerType:i,blockerStateVariable:d,blockerDependency:h,typeBlocked:e,codeBlocked:l,deleteFromReciprocal:!1})}}else{if(o)for(let m of p[i]){let[f,d,h]=m.split("|");this.deleteFromResolveBlockedBy({blockerComponentName:f,blockerType:i,blockerStateVariable:d,blockerDependency:h,typeBlocked:e,codeBlocked:l,deleteFromReciprocal:!1})}delete p[i]}}else if(o)for(let m in p)for(let f of p[m]){let[d,h,y]=f.split("|");this.deleteFromResolveBlockedBy({blockerComponentName:d,blockerType:m,blockerStateVariable:h,blockerDependency:y,typeBlocked:e,codeBlocked:l,deleteFromReciprocal:!1})}}.bind(this),c=this.resolveBlockers.neededToResolve[t];if(c){let p=c[e];if(p)if(r){let m=p[r];if(m)if(n){let f=m[n];f&&(u(f),(!i||Object.keys(f).length===0)&&delete m[n]),Object.keys(m).length===0&&delete p[r]}else u(m),(!i||Object.keys(m).length===0)&&delete p[r];Object.keys(p).length===0&&delete c[e]}else u(p),(!i||Object.keys(p).length===0)&&delete c[e];Object.keys(c).length===0&&delete this.resolveBlockers.neededToResolve[t]}}checkIfHaveNeededToResolve({componentName:t,type:e,stateVariable:r,dependency:n}){let i=this.resolveBlockers.neededToResolve[t];if(!i)return!1;let s=i[e];return!s||r&&(s=s[r],!s||n&&(s=s[n],!s))?!1:Object.keys(s).length>0}getResolveBlockedBy({componentName:t,type:e,stateVariable:r,dependency:n}){let i=this.resolveBlockers.resolveBlockedBy[t];i||(i=this.resolveBlockers.resolveBlockedBy[t]={});let s=i[e];if(s||(s=i[e]={}),r){let o=s;if(s=o[r],s||(s=o[r]={}),n){let l=s;s=l[n],s||(s=l[n]={})}}return s}deleteFromResolveBlockedBy({blockerComponentName:t,blockerType:e,blockerStateVariable:r,blockerDependency:n,typeBlocked:i,codeBlocked:s,deleteFromReciprocal:o=!0}){let l=t;r&&(l+="|"+r,n&&(l+="|"+n));let u=function(p){if(i){if(p[i])if(s){let m=p[i].indexOf(s);if(m!==-1&&p[i].splice(m,1),p[i].length===0&&delete p[i],o){let[f,d,h]=s.split("|");this.deleteFromNeededToResolve({componentNameBlocked:f,typeBlocked:i,stateVariableBlocked:d,dependencyBlocked:h,blockerType:e,blockerCode:l,deleteFromReciprocal:!1})}}else{if(o)for(let m of p[i]){let[f,d,h]=m.split("|");this.deleteFromNeededToResolve({componentNameBlocked:f,typeBlocked:i,stateVariableBlocked:d,dependencyBlocked:h,blockerType:e,blockerCode:l,deleteFromReciprocal:!1})}delete p[i]}}else if(o)for(let m in p)for(let f of p[m]){let[d,h,y]=f.split("|");this.deleteFromNeededToResolve({componentNameBlocked:d,typeBlocked:m,stateVariableBlocked:h,dependencyBlocked:y,blockerType:e,blockerCode:l,deleteFromReciprocal:!1})}}.bind(this),c=this.resolveBlockers.resolveBlockedBy[t];if(c){let p=c[e];if(p)if(r){let m=p[r];if(m)if(n){let f=m[n];f&&(u(f),(!i||Object.keys(f).length===0)&&delete m[n]),Object.keys(m).length===0&&delete p[r]}else u(m),(!i||Object.keys(m).length===0)&&delete p[r];Object.keys(p).length===0&&delete c[e]}else u(p),(!i||Object.keys(p).length===0)&&delete c[e];Object.keys(c).length===0&&delete this.resolveBlockers.resolveBlockedBy[t]}}async addBlocker({blockerComponentName:t,blockerType:e,blockerStateVariable:r,blockerDependency:n,componentNameBlocked:i,typeBlocked:s,stateVariableBlocked:o,dependencyBlocked:l}){let u=t;r&&(u+="|"+r,n&&(u+="|"+n));let c=i;o&&(c+="|"+o,l&&(c+="|"+l));let p=this.getNeededToResolve({componentName:i,type:s,stateVariable:o,dependency:l}),m=p[e];if(m||(m=p[e]=[]),m.includes(u))return;if(m.push(u),s==="stateVariable"){let h=this._components[i];if(h){let y=h.state[o];if(y.isResolved=!1,y.initiallyResolved){await this.core.markStateVariableAndUpstreamDependentsStale({component:h,varName:o});let b=this.upstreamDependencies[i][o];if(b){for(let g of b)if(this._components[g.upstreamComponentName])for(let v of g.upstreamVariableNames)await this.addBlocker({blockerComponentName:i,blockerType:"stateVariable",blockerStateVariable:o,componentNameBlocked:g.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:v})}}}}let f=this.getResolveBlockedBy({componentName:t,type:e,stateVariable:r,dependency:n}),d=f[s];d||(d=f[s]=[]),d.includes(c)||d.push(c),this.resetCircularResolveBlockerCheckPassed({componentName:i,type:s,stateVariable:o,dependency:l}),this.checkForCircularResolveBlocker({componentName:i,type:s,stateVariable:o,dependency:l})}async processNewlyResolved({componentNameNewlyResolved:t,typeNewlyResolved:e,stateVariableNewlyResolved:r,dependencyNewlyResolved:n,expandComposites:i=!0,force:s=!1,recurseUpstream:o=!1}){if(e==="stateVariable"){let u=this._components[t];u&&u.state[r]&&(u.state[r].isResolved=!0,u.state[r].initiallyResolved=!0)}else if(e==="componentIdentity"){if(!(t in this._components||s))return{success:!1}}else if(e==="recalculateDownstreamComponents"){let u;try{u=this.downstreamDependencies[t][r][n]}catch(c){}if(u){let c=await u.recalculateDownstreamComponents({force:s});if(!(c.success||s))return c;for(let p of u.upstreamVariableNames)this.deleteFromNeededToResolve({componentNameBlocked:u.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:p,blockerType:"recalculateDownstreamComponents",blockerCode:u.upstreamComponentName+"|"+p+"|"+n});for(let p of u.upstreamVariableNames)await this.resolveIfReady({componentName:u.upstreamComponentName,type:"stateVariable",stateVariable:p,expandComposites:i,force:s,recurseUpstream:o});return{success:!0}}}else if(e==="determineDependencies"){let u;try{u=this.downstreamDependencies[t][r][n]}catch(c){}if(u){let c=this.getNeededToResolve({componentName:t,type:"stateVariable",stateVariable:r}),p=!1,m=[];if(c.determineDependencies)for(let d of c.determineDependencies){let[h,y,b]=d.split("|");if(this.checkIfHaveNeededToResolve({componentName:t,type:"determineDependency",stateVariable:r,dependency:b})){p=!0;break}m.push(b)}if(p)return{success:!0};if(!(await this.updateDependencies({componentName:t,stateVariable:r,dependency:n})).success)return{success:!1};for(let d of u.upstreamVariableNames){for(let h of m)this.deleteFromResolveBlockedBy({blockerComponentName:u.upstreamComponentName,blockerType:"determineDependencies",blockerStateVariable:d,blockerDependency:h});await this.resolveIfReady({componentName:t,type:"stateVariable",stateVariable:d,expandComposites:i,force:s,recurseUpstream:o})}return{success:!0}}}else if(e==="childMatches"){let u=this._components[t];if(u&&!u.childrenMatched&&!(await this.core.deriveChildResultsFromDefiningChildren({parent:u,expandComposites:i,forceExpandComposites:s})).skipping&&!(u.childrenMatchedWithPlaceholders||s))return{success:!1}}else if(e==="expandComposite"){if(!this._components[t].isExpanded){if(this.core.updateInfo.compositesBeingExpanded.includes(t))return{success:!1};await this.core.expandCompositeComponent(this._components[t])}}else throw Error(`Unrecognized type newly resolved: ${e}`);let l=this.getResolveBlockedBy({componentName:t,type:e,stateVariable:r,dependency:n});l=Object.assign({},l);for(let u in l)for(let c of[...l[u]])if(this.deleteFromResolveBlockedBy({blockerComponentName:t,blockerType:e,blockerStateVariable:r,blockerDependency:n,typeBlocked:u,codeBlocked:c}),o){let[p,m,f]=c.split("|");await this.resolveIfReady({componentName:p,type:u,stateVariable:m,dependency:f,expandComposites:i,force:s,recurseUpstream:o})}return{success:!0}}async resolveStateVariablesIfReady({component:t,stateVariables:e}){let r=t.componentName;e||(await this.resolveIfReady({componentName:r,type:"componentIdentity",expandComposites:!1}),e=Object.keys(t.state));for(let n of e){let i=t.state[n];if(i&&i.determineDependenciesImmediately){let o=this.getNeededToResolve({componentName:r,type:"stateVariable",stateVariable:n}).determineDependencies;if(o)for(let l of o){let[u,c,p]=l.split("|");await this.resolveIfReady({componentName:u,type:"determineDependencies",stateVariable:c,dependency:p,expandComposites:!0})}}await this.resolveIfReady({componentName:r,type:"stateVariable",stateVariable:n,expandComposites:!1})}}async resolveIfReady({componentName:t,type:e,stateVariable:r,dependency:n,expandComposites:i=!0,force:s=!1,recurseUpstream:o=!1}){return this.checkIfHaveNeededToResolve({componentName:t,type:e,stateVariable:r,dependency:n})?{success:!1}:(this.deleteFromNeededToResolve({componentNameBlocked:t,typeBlocked:e,stateVariableBlocked:r,dependencyBlocked:n}),await this.processNewlyResolved({componentNameNewlyResolved:t,typeNewlyResolved:e,stateVariableNewlyResolved:r,dependencyNewlyResolved:n,expandComposites:i,force:s,recurseUpstream:o}))}async resolveItem({componentName:t,type:e,stateVariable:r,dependency:n,force:i=!1,recurseUpstream:s=!1,expandComposites:o=!0,numPreviouslyNeeded:l}){let u=this.getNeededToResolve({componentName:t,type:e,stateVariable:r,dependency:n}),c=u.determineDependencies;if(c&&c.length>0)for(let h of[...c]){let[y,b,g]=h.split("|"),v=await this.resolveItem({componentName:y,type:"determineDependencies",stateVariable:b,dependency:g,force:i,expandComposites:o});if(!v.success)return v}let p;e==="stateVariable"&&this._components[t]&&(p=this._components[t].state[r],p&&(p.currentlyResolving=!0));let m=1/0,f=1/0;for(;(Object.keys(u).length>0||f>0)&&!(Number.isFinite(f)&&f>=m);){f>0&&(u=this.getNeededToResolve({componentName:t,type:e,stateVariable:r,dependency:n})),m=f,f=0;for(let h in u){if(h==="determineDependencies")throw Error(`Shouldn't have determine dependencies blocker after determining dependencies: ${t}, ${e}, ${r}, ${n}`);for(let y of[...u[h]]){let[b,g,v]=y.split("|"),A=await this.resolveItem({componentName:b,type:h,stateVariable:g,dependency:v,expandComposites:o});if(!A.success)if(i)f++;else return A}}}if(f>0)for(u=this.getNeededToResolve({componentName:t,type:e,stateVariable:r,dependency:n});Object.keys(u).length>0;)for(let h in u){if(h==="determineDependencies")throw Error(`Shouldn't have determine dependencies blocker after determining dependencies: ${t}, ${e}, ${r}, ${n}`);for(let y of[...u[h]]){let[b,g,v]=y.split("|"),A=await this.resolveItem({componentName:b,type:h,stateVariable:g,dependency:v,force:i,expandComposites:o});if(!A.success)return A}}p&&(p.currentlyResolving=!1);let d=await this.resolveIfReady({componentName:t,type:e,stateVariable:r,dependency:n,force:i,recurseUpstream:s,expandComposites:o});if(!d.success){let h=this.getNeededToResolve({componentName:t,type:e,stateVariable:r,dependency:n}),y=Object.keys(h).length;y>0&&(l===void 0||y<l)&&(d=await this.resolveItem({componentName:t,type:e,stateVariable:r,dependency:n,force:i,recurseUpstream:s,expandComposites:o,numPreviouslyNeeded:y}))}return d}checkForCircularResolveBlocker({componentName:t,type:e,stateVariable:r,dependency:n,previouslyVisited:i=[]}){let s=t;r&&(s+="|"+r,n&&(s+="|"+n));let o=s+"|"+e;if(i.includes(o)){console.log("found circular",o,i);let l=/^([^\|]*)\|/,u=i.map(y=>y.match(l)[1]),c=u.filter(y=>y.slice(0,2)!=="__").reduce((y,b)=>y.includes(b)?y:[...y,b],[]);c.length===0&&(c=[u[0]]);let p;c.length===1?p=c[0]:c.length===2?p=c.join(" and "):(c[c.length-2]=c.slice(c.length-2).join(", and "),c.pop(),p=c.join(", "));let m=[],f=[];for(let y of i){let[b,g]=y.split("|"),v=this._components[b];v&&this.componentInfoObjects.isInheritedComponentType({inheritedComponentType:v.componentType,baseComponentType:"_composite"})&&!(v.attributes.componentType&&v.attributes.componentType.primitive)&&(g==="readyToExpandWhenResolved"?m.push(b):g===v.constructor.stateVariableToEvaluateAfterReplacements&&f.push(b))}let d=!1;for(let y of m)if(f.includes(y)){d=!0;break}let h=`Circular dependency involving ${p}.`;throw d&&(h+="  Specifying the type of a composite component may address this circular dependency."),Error(h)}else i=[...i,o];if(!this.circularResolveBlockedCheckPassed[o]){this.circularResolveBlockedCheckPassed[o]=!0;let l=this.getNeededToResolve({componentName:t,type:e,stateVariable:r,dependency:n});for(let u in l)for(let c of l[u]){let[p,m,f]=c.split("|");this.checkForCircularResolveBlocker({componentName:p,type:u,stateVariable:m,dependency:f,previouslyVisited:i})}}}resetCircularResolveBlockerCheckPassed({componentName:t,type:e,stateVariable:r,dependency:n}){let i=t;r&&(i+="|"+r,n&&(i+="|"+n));let s=i+"|"+e;if(this.circularResolveBlockedCheckPassed[s]){delete this.circularResolveBlockedCheckPassed[s];let o=this.getResolveBlockedBy({componentName:t,type:e,stateVariable:r,dependency:n});for(let l in o)for(let u of o[l]){let[c,p,m]=u.split("|");this.resetCircularResolveBlockerCheckPassed({componentName:c,type:l,stateVariable:p,dependency:m})}}}get components(){return this._components}set components(t){return null}},ft=class{constructor({component:t,stateVariable:e,allStateVariablesAffected:r,dependencyName:n,dependencyDefinition:i,dependencyHandler:s}){this.dependencyName=n,this.dependencyHandler=s,this.upstreamComponentName=t.componentName,this.upstreamVariableNames=r,this.definition=Object.assign({},i),this.representativeStateVariable=e,i.doNotProxy&&(this.doNotProxy=!0),i.variablesOptional&&(this.variablesOptional=!0),i.publicStateVariablesOnly&&(this.publicStateVariablesOnly=!0),i.caseInsensitiveVariableMatch&&(this.caseInsensitiveVariableMatch=!0),i.useMappedVariableNames&&(this.useMappedVariableNames=!0),Number.isInteger(i.propIndex)&&(this.propIndex=i.propIndex),this.returnSingleVariableValue=!1,this.returnSingleComponent=!1,this.originalDownstreamVariableNames=[]}downstreamVariableNameIfNoVariables="__identity";static get rendererType(){return this.componentType}get dependencyType(){return this.constructor.dependencyType}setUpParameters(){}async determineDownstreamComponents(){return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]}}async initialize(){this.setUpParameters();let t=await this.determineDownstreamComponents(),e=t.downstreamComponentNames,r=t.downstreamComponentTypes;this.componentIdentitiesChanged=!0;let n=this.dependencyHandler.downstreamDependencies[this.upstreamComponentName];n||(n=this.dependencyHandler.downstreamDependencies[this.upstreamComponentName]={});for(let i of this.upstreamVariableNames)n[i]||(n[i]={}),n[i][this.dependencyName]=this;this.originalDownstreamVariableNames.length===0&&!this.originalVariablesByComponent?(delete this.mappedDownstreamVariableNamesByComponent,delete this.upValuesChanged):(this.mappedDownstreamVariableNamesByComponent=[],this.valuesChanged=[]),this.downstreamComponentNames=[],this.downstreamComponentTypes=[];for(let[i,s]of e.entries())await this.addDownstreamComponent({downstreamComponentName:s,downstreamComponentType:r[i],index:i})}async addDownstreamComponent({downstreamComponentName:t,downstreamComponentType:e,index:r}){this.componentIdentitiesChanged=!0,this.downstreamComponentNames.splice(r,0,t),this.downstreamComponentTypes.splice(r,0,e);let n=this.dependencyHandler._components[t];if(n){let i;this.originalVariablesByComponent?i=this.originalDownstreamVariableNamesByComponent[r]:i=this.originalDownstreamVariableNames,this.caseInsensitiveVariableMatch&&(i=this.dependencyHandler.core.findCaseInsensitiveMatches({stateVariables:i,componentClass:n.constructor})),this.publicStateVariablesOnly&&(i=this.dependencyHandler.core.matchPublicStateVariables({stateVariables:i,componentClass:n.constructor}));let s=this.dependencyHandler.core.substituteAliases({stateVariables:i,componentClass:n.constructor});this.constructor.convertToArraySize&&(s=s.map(function(u){let c=n.state[u];if(c)return c.arraySizeStateVariable?c.arraySizeStateVariable:`__${u}_is_not_an_array`;if(n.arrayEntryPrefixes){let p=Object.keys(n.arrayEntryPrefixes).sort((m,f)=>f.length-m.length);for(let m of p)if(u.substring(0,m.length)===m){let f=n.arrayEntryPrefixes[m],d=n.state[f];if(d.getArrayKeysFromVarName({arrayEntryPrefix:m,varEnding:u.substring(m.length),nDimensions:d.nDimensions}).length>0)return n.state[f].arraySizeStateVariable}}return`__${u}_is_not_an_array`})),this.propIndex!==void 0&&console.warn("Need to implement propIndex!");let o=s;if(i.length>0||this.originalVariablesByComponent){this.mappedDownstreamVariableNamesByComponent.splice(r,0,s);let u={};for(let c of s)u[c]={changed:!0};this.valuesChanged.splice(r,0,u),this.variablesOptional&&(o=o.filter(c=>c in n.state||this.dependencyHandler.core.checkIfArrayEntry({stateVariable:c,component:n})));for(let c of o)if(n.state[c]||await this.dependencyHandler.core.createFromArrayEntry({component:n,stateVariable:c}),!n.state[c].isResolved)for(let p of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:t,blockerType:"stateVariable",blockerStateVariable:c,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:p}),this.dependencyType==="determineDependencies"&&await this.dependencyHandler.addBlocker({blockerComponentName:t,blockerType:"stateVariable",blockerStateVariable:c,componentNameBlocked:this.upstreamComponentName,typeBlocked:"determineDependencies",stateVariableBlocked:p,dependencyBlocked:this.dependencyName})}o.length===0&&(o=[this.downstreamVariableNameIfNoVariables]);let l=this.dependencyHandler.upstreamDependencies[t];l||(l=this.dependencyHandler.upstreamDependencies[t]={});for(let u of o)if(l[u]===void 0&&(l[u]=[]),l[u].push(this),u!==this.downstreamVariableNameIfNoVariables)for(let c of this.upstreamVariableNames)this.dependencyHandler.resetCircularCheckPassed(this.upstreamComponentName,c)}for(let i of this.upstreamVariableNames)this.dependencyHandler._components[this.upstreamComponentName].state[i].initiallyResolved&&await this.dependencyHandler.core.recordActualChangeInStateVariable({componentName:this.upstreamComponentName,varName:i})}async removeDownstreamComponent({indexToRemove:t,recordChange:e=!0}){e&&(this.componentIdentitiesChanged=!0);let r=this.downstreamComponentNames[t];if(this.downstreamComponentNames.splice(t,1),this.downstreamComponentTypes.splice(t,1),r in this.dependencyHandler._components){let n;this.mappedDownstreamVariableNamesByComponent?(n=this.mappedDownstreamVariableNamesByComponent[t],this.mappedDownstreamVariableNamesByComponent.splice(t,1),this.valuesChanged.splice(t,1),this.variablesOptional&&n.push(this.downstreamVariableNameIfNoVariables)):n=[this.downstreamVariableNameIfNoVariables];for(let i of n){let s=this.dependencyHandler.upstreamDependencies[r][i];if(s){let o=s.indexOf(this);o!==-1&&(s.length===1?delete this.dependencyHandler.upstreamDependencies[r][i]:s.splice(o,1))}if(i!==this.downstreamVariableNameIfNoVariables)for(let o of this.upstreamVariableNames)this.dependencyHandler.resetCircularCheckPassed(this.upstreamComponentName,o)}}if(e)for(let n of this.upstreamVariableNames)this.dependencyHandler._components[this.upstreamComponentName].state[n].initiallyResolved&&await this.dependencyHandler.core.recordActualChangeInStateVariable({componentName:this.upstreamComponentName,varName:n})}async swapDownstreamComponents(t,e){this.componentIdentitiesChanged=!0,[this.downstreamComponentNames[t],this.downstreamComponentNames[e]]=[this.downstreamComponentNames[e],this.downstreamComponentNames[t]],[this.downstreamComponentTypes[t],this.downstreamComponentTypes[e]]=[this.downstreamComponentTypes[e],this.downstreamComponentTypes[t]],(this.originalDownstreamVariableNames.length>0||this.originalVariablesByComponent)&&([this.mappedDownstreamVariableNamesByComponent[t],this.mappedDownstreamVariableNamesByComponent[e]]=[this.mappedDownstreamVariableNamesByComponent[e],this.mappedDownstreamVariableNamesByComponent[t]],[this.valuesChanged[t],this.valuesChanged[e]]=[this.valuesChanged[e],this.valuesChanged[t]]);for(let r of this.upstreamVariableNames)this.dependencyHandler._components[this.upstreamComponentName].state[r].initiallyResolved&&await this.dependencyHandler.core.recordActualChangeInStateVariable({componentName:this.upstreamComponentName,varName:r})}deleteDependency(){let t=[];if(!this.mappedDownstreamVariableNamesByComponent)t=Array(this.downstreamComponentNames.length).fill([this.downstreamVariableNameIfNoVariables]);else if(t=this.mappedDownstreamVariableNamesByComponent,this.variablesOptional){let r=[];for(let[n,i]of this.downstreamComponentNames.entries()){let s=[];for(let o of t[n])this.dependencyHandler.components[i].state[o]&&s.push(o);s.length>0?r.push(s):r.push([this.downstreamVariableNameIfNoVariables])}t=r}for(let[r,n]of this.downstreamComponentNames.entries())for(let i of t[r]){let s=this.dependencyHandler.upstreamDependencies[n][i];if(s){let o=s.indexOf(this);o!==-1&&(s.length===1?delete this.dependencyHandler.upstreamDependencies[n][i]:s.splice(o,1))}if(i!==this.downstreamVariableNameIfNoVariables)for(let o of this.upstreamVariableNames)this.dependencyHandler.resetCircularCheckPassed(this.upstreamComponentName,o)}this.deleteFromUpdateTriggers();let e=this.dependencyHandler.downstreamDependencies[this.upstreamComponentName];for(let r of this.upstreamVariableNames)delete e[r][this.dependencyName]}deleteFromUpdateTriggers(){}async getValue({verbose:t=!1,skipProxy:e=!1}={}){let r=[],n={},i=[];this.componentIdentitiesChanged&&(n.componentIdentitiesChanged=!0,this.componentIdentitiesChanged=!1);for(let[s,o]of this.downstreamComponentNames.entries()){let l=this.dependencyHandler._components[o];if(i[s]=!1,l){let u={componentType:l.componentType};this.skipComponentNames||(u.componentName=o);let c;if(this.originalVariablesByComponent?c=this.originalDownstreamVariableNamesByComponent[s]:c=this.originalDownstreamVariableNames,c.length>0){u.stateValues={};let p={},m=!1;for(let[f,d]of c.entries()){let h=this.mappedDownstreamVariableNamesByComponent[s][f],y=this.useMappedVariableNames?h:d;if(!this.variablesOptional||h in l.state){let b=l.state[h];b.deferred||(u.stateValues[y]=await b.value,this.valuesChanged[s][h].changed&&(n.valuesChanged||(n.valuesChanged={}),n.valuesChanged[s]||(n.valuesChanged[s]={}),n.valuesChanged[s][y]=this.valuesChanged[s][h]),this.valuesChanged[s][h]={},(b.usedDefault||b.isArrayEntry&&b.arrayKeys.length===1&&l.state[b.arrayStateVariable].usedDefaultByArrayKey[b.arrayKeys[0]])&&(p[y]=!0,m=!0))}}m&&(i[s]=p)}r.push(u)}else r.push({componentType:this.downstreamComponentTypes[s]})}if(!t)if(this.returnSingleVariableValue)if(r.length===1){r=r[0],n.valuesChanged&&n.valuesChanged[0]?n.valuesChanged=n.valuesChanged[0]:delete n.valuesChanged,i=i[0];let s=Object.keys(r.stateValues);if(s.length===1){let o=s[0];r=r.stateValues[o],n.valuesChanged&&n.valuesChanged[o]&&(n.valuesChanged=n.valuesChanged[o]),i&&(i=i[o])}else r=null,n.valuesChanged={},i=!1}else r=null,n.valuesChanged={},i=!1;else this.returnSingleComponent&&(r.length===1?(r=r[0],n.valuesChanged&&n.valuesChanged[0]?n.valuesChanged=n.valuesChanged[0]:delete n.valuesChanged,i=i[0]):(r=null,i=!1));return{value:r,changes:n,usedDefault:i}}checkForCircular(){for(let t of this.upstreamVariableNames)this.dependencyHandler.resetCircularCheckPassed(this.upstreamComponentName,t);for(let t of this.upstreamVariableNames)this.dependencyHandler.checkForCircularDependency({componentName:this.upstreamComponentName,varName:t})}async recalculateDownstreamComponents({force:t=!1}={}){let e=await this.determineDownstreamComponents({force:t}),r=e.downstreamComponentNames;if(r.length!==this.downstreamComponentNames.length||this.downstreamComponentNames.some((i,s)=>i!=r[s])){this.componentIdentitiesChanged=!0;let i=0;for(let[s,o]of[...this.downstreamComponentNames].entries())r.includes(o)||(await this.removeDownstreamComponent({indexToRemove:s-i}),i++);for(let[s,o]of r.entries()){let l=this.downstreamComponentNames.indexOf(o);l!==-1?l!==s&&await this.swapDownstreamComponents(l,s):await this.addDownstreamComponent({downstreamComponentName:o,downstreamComponentType:e.downstreamComponentTypes[s],index:s})}}if(this.originalVariablesByComponent)for(let[i,s]of[...this.downstreamComponentNames].entries())(this.mappedDownstreamVariableNamesByComponent[i].length!==this.originalDownstreamVariableNamesByComponent[i].length||this.mappedDownstreamVariableNamesByComponent[i].some((o,l)=>this.originalDownstreamVariableNamesByComponent[i][l]!==o))&&(await this.removeDownstreamComponent({indexToRemove:i}),await this.addDownstreamComponent({downstreamComponentName:s,downstreamComponentType:e.downstreamComponentTypes[i],index:i}));return{success:e.success}}};T(ft,"dependencyType","_base");var To=class extends ft{setUpParameters(){if(this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName,this.definition.variableName===void 0)throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableName is not defined`);this.originalDownstreamVariableNames=[this.definition.variableName],this.definition.returnAsComponentObject?this.returnSingleComponent=!0:this.returnSingleVariableValue=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName]=[]),e.includes(this)||e.push(this);for(let r of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.componentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:r,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}return{success:!0,downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(To,"dependencyType","stateVariable");et.push(To);var M0=class extends ft{setUpParameters(){if(this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName,this.definition.variableNames===void 0)throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames is not defined`);this.originalDownstreamVariableNames=this.definition.variableNames,this.returnSingleComponent=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName]=[]),e.includes(this)||e.push(this);for(let r of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.componentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:r,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}return{success:!0,downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(M0,"dependencyType","multipleStateVariables");et.push(M0);var B0=class extends To{async getValue({verbose:t=!1}={}){let e=[],r={};if(this.staticValue)e=[this.staticValue];else if(this.componentIdentitiesChanged&&(r.componentIdentitiesChanged=!0,this.componentIdentitiesChanged=!1),this.downstreamComponentNames.length===1){let n=this.downstreamComponentNames[0],i=this.dependencyHandler.components[n],s={componentName:i.componentName,componentType:i.componentType};s.stateValues={};let o=this.originalDownstreamVariableNames[0],l=this.mappedDownstreamVariableNamesByComponent[0][0],u=this.useMappedVariableNames?l:o;if((!this.variablesOptional||l in i.state)&&!i.state[l].deferred){let c=i.state[l];if(await c.value,s.stateValues[u]=c.componentType,c.isArray&&c.wrappingComponents&&c.wrappingComponents.length>0){let m=c.wrappingComponents[c.wrappingComponents.length-1][0];typeof m=="object"&&(m=m.componentType),s.stateValues[u]=m}this.valuesChanged[0][l].changed&&(r.valuesChanged||(r.valuesChanged={}),r.valuesChanged[0]||(r.valuesChanged[0]={}),r.valuesChanged[0][u]=this.valuesChanged[0][l]),this.valuesChanged[0][l]={};let p=c.hasVariableComponentType;!p&&c.isArrayEntry&&(p=i.state[c.arrayStateVariable].hasVariableComponentType),p||(this.staticValue=s,await this.removeDownstreamComponent({indexToRemove:0,recordChange:!1}))}e=[s]}if(!t)if(this.returnSingleVariableValue)if(e.length===1){e=e[0];let n=Object.keys(e.stateValues);r.valuesChanged&&r.valuesChanged[0]&&r.valuesChanged[0][0]&&(r.valuesChanged=r.valuesChanged[0][0]),n.length===1?e=e.stateValues[n[0]]:e=null}else e=null;else this.returnSingleComponent&&(e.length===1?(e=e[0],r.valuesChanged&&r.valuesChanged[0]&&(r.valuesChanged=r.valuesChanged[0])):e=null);return{value:e,changes:r,usedDefault:!1}}};T(B0,"dependencyType","stateVariableComponentType");et.push(B0);var lh=class extends To{};T(lh,"dependencyType","stateVariableArraySize"),T(lh,"convertToArraySize",!0);et.push(lh);var L0=class extends ft{setUpParameters(){if(this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName,this.definition.variableNames===void 0)throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames is not defined`);this.startingVariableNames=this.definition.variableNames,this.originalVariablesByComponent=!0,this.includeImmediateValueWithValue=this.definition.includeImmediateValueWithValue,this.includeRawValueWithImmediateValue=this.definition.includeRawValueWithImmediateValue,this.includeOnlyEssentialValues=this.definition.includeOnlyEssentialValues,this.variablesOptional=!0}async determineDownstreamComponents({force:t=!1}={}){this.missingComponents=[],this.originalDownstreamVariableNamesByComponent=[];let e=await this.getRecursiveDependencyVariables({componentName:this.componentName,variableNames:this.startingVariableNames,force:t});if(!e.success)return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]};let r=[],n=[];for(let i in e.components)if(this.includeOnlyEssentialValues){let s=[],o=this.dependencyHandler._components[i];for(let l of e.components[i].variableNames)(o.state[l]?.hasEssential||o.state[l]?.isArrayEntry&&o.state[o.state[l].arrayStateVariable].hasEssential)&&s.push(l);s.length>0&&(r.push(i),n.push(e.components[i].componentType),this.originalDownstreamVariableNamesByComponent.push(s))}else r.push(i),n.push(e.components[i].componentType),this.originalDownstreamVariableNamesByComponent.push(e.components[i].variableNames);return{success:!0,downstreamComponentNames:r,downstreamComponentTypes:n}}async getRecursiveDependencyVariables({componentName:t,variableNames:e,force:r,components:n={}}){let i=this.dependencyHandler._components[t];if(!i){if(!this.missingComponents.includes(t)){let l=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[t];l||(l=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[t]=[]),l.includes(this)||l.push(this)}for(let l of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:t,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:l,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:l,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:l});return{success:!1}}this.includeImmediateValueWithValue&&e.includes("value")&&!e.includes("immediateValue")&&"immediateValue"in i.state&&(e=[...e,"immediateValue"]),this.includeRawValueWithImmediateValue&&e.includes("immediateValue")&&!e.includes("rawRendererValue")&&"rawRendererValue"in i.state&&(e=[...e,"rawRendererValue"]);let s=n[t];s||(s=n[t]={componentName:t,componentType:i.componentType,variableNames:[]});let o=this.dependencyHandler.updateTriggers.dependenciesBasedOnDependenciesOfStateVariables[t];o||(o=this.dependencyHandler.updateTriggers.dependenciesBasedOnDependenciesOfStateVariables[t]={});for(let l of e)if(!s.variableNames.includes(l)){s.variableNames.push(l);let u=o[l];u||(u=o[l]=[]),u.includes(this)||u.push(this);let c=i.state[l];if(c){if(!c.isResolved)if(r)await c.value;else{for(let m of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:t,blockerType:"stateVariable",blockerStateVariable:l,componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:m,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:m,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:m});return{success:!1}}let p=this.dependencyHandler.downstreamDependencies[i.componentName][l];for(let m in p){let f=p[m];for(let[d,h]of f.downstreamComponentNames.entries()){let y=[];if((f.originalDownstreamVariableNames.length>0||f.originalVariablesByComponent)&&(y=f.mappedDownstreamVariableNamesByComponent[d]),!(await this.getRecursiveDependencyVariables({componentName:h,variableNames:y,force:r,components:n})).success)return{success:!1}}}}}return{success:!0,components:n}}async getValue(){this.gettingValue=!0,this.varsWithUpdatedDeps={};let t,e={},r=!0,n={};for(;r;){if(r=!1,t=await super.getValue(),t.changes.valuesChanged)if(!n.valuesChanged)n.valuesChanged=t.changes.valuesChanged;else for(let i in t.changes.valuesChanged){let s=t.changes.valuesChanged[i];if(!n.valuesChanged[i])n.valuesChanged[i]=s;else for(let o in s)n.valuesChanged[i][o]=s[o]}for(let i in this.varsWithUpdatedDeps){let s=e[i];s||(s=e[i]=[]);for(let o of this.varsWithUpdatedDeps[i])s.includes(o)||(s.push(o),r=!0)}r&&await this.recalculateDownstreamComponents()}return this.gettingValue=!1,t.changes=n,t}deleteFromUpdateTriggers(){for(let t of this.missingComponents){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[t];if(e){let r=e.indexOf(this);r!==-1&&e.splice(r,1)}}}};T(L0,"dependencyType","recursiveDependencyValues");et.push(L0);var U0=class extends ft{setUpParameters(){this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName,this.returnSingleComponent=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName]=[]),e.includes(this)||e.push(this);for(let r of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.componentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:r,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}return{success:!0,downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(U0,"dependencyType","componentIdentity");et.push(U0);var z0=class extends ft{setUpParameters(){if(this.definition.parentName?(this.parentName=this.definition.parentName,this.specifiedComponentName=this.parentName):this.parentName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.attributeName=this.definition.attributeName,this.fallBackToAttributeFromShadow=!0,this.definition.fallBackToAttributeFromShadow!==void 0&&(this.fallBackToAttributeFromShadow=this.definition.fallBackToAttributeFromShadow),this.returnSingleComponent=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.parentName];if(!t){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName]=[]),r.includes(this)||r.push(this);for(let n of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:n,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:n,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:n});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}let e=t.attributes[this.attributeName];if(e?.component)return{success:!0,downstreamComponentNames:[e.component.componentName],downstreamComponentTypes:[e.component.componentType]};if(this.fallBackToAttributeFromShadow){let r=t;for(;r.shadows;){let n=r.shadows.propVariable;if(r=this.dependencyHandler._components[r.shadows.componentName],!r||n&&!(r.state[n]?.additionalAttributeComponentsToShadow&&r.state[n].additionalAttributeComponentsToShadow.includes(this.attributeName)))break;if(e=r.attributes[this.attributeName],e?.component)return{success:!0,downstreamComponentNames:[e.component.componentName],downstreamComponentTypes:[e.component.componentType]}}}return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(z0,"dependencyType","attributeComponent");et.push(z0);var G0=class extends ft{setUpParameters(){if(this.definition.parentName?(this.parentName=this.definition.parentName,this.specifiedComponentName=this.parentName):this.parentName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];if(this.childGroups=this.definition.childGroups,!Array.isArray(this.childGroups))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: childGroups must be an array`);this.definition.childIndices!==void 0&&(this.childIndices=this.definition.childIndices.map(t=>Number(t))),this.skipComponentNames=this.definition.skipComponentNames,this.skipPlaceholders=this.definition.skipPlaceholders,this.proceedIfAllChildrenNotMatched=this.definition.proceedIfAllChildrenNotMatched}async determineDownstreamComponents(){this.downstreamPrimitives?this.previousDownstreamPrimitives=[...this.downstreamPrimitives]:this.previousDownstreamPrimitives=[],this.downstreamPrimitives=[];let t=this.dependencyHandler._components[this.parentName];if(!t){let o=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];o||(o=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName]=[]),o.includes(this)||o.push(this);for(let l of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:l,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:l,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:l});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}let e=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName];e||(e=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName]=[]),e.includes(this)||e.push(this);let r=t.returnMatchedChildIndices(this.childGroups);if(r===void 0)throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: childGroups ${this.childGroups} does not exist.`);if(this.childIndices&&(r=r.filter((o,l)=>this.childIndices.includes(l))),!t.childrenMatched&&!this.proceedIfAllChildrenNotMatched){let o=!1;if(t.childrenMatchedWithPlaceholders&&(this.skipPlaceholders&&(r=r.filter(l=>!t.placeholderActiveChildrenIndices.includes(l))),this.skipComponentNames&&this.originalDownstreamVariableNames.length===0?o=!0:o=r.every(l=>!t.placeholderActiveChildrenIndices.includes(l))),!o){let l=t.unexpandedCompositesNotReady.length>0;if(!l&&t.unexpandedCompositesReady.length>0){for(let u of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"childMatches",blockerStateVariable:u,componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:u,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:u,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:u});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(l){for(let m of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"childMatches",blockerStateVariable:m,componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:m,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:m,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:m});let u=[],c=[];for(let m of t.unexpandedCompositesNotReady){if(t.childrenMatchedWithPlaceholders&&t.placeholderActiveChildrenIndicesByComposite[m].every(h=>!r.includes(h)))continue;let f=this.dependencyHandler._components[m];f.attributes.componentType&&f.attributes.componentType.primitive?u.push(m):c.push(m)}let p=c;p.length===0&&(p=u);for(let m of p)for(let f of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:m,blockerType:"stateVariable",blockerStateVariable:"readyToExpandWhenResolved",componentNameBlocked:this.upstreamComponentName,typeBlocked:"childMatches",stateVariableBlocked:f});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}}}let n=r.map(o=>t.activeChildren[o]);if(this.compositeReplacementRange=[],t.compositeReplacementActiveRange&&n.length>0){let o=0;for(;o<r.length;){let l=r[o];for(let u of t.compositeReplacementActiveRange)if(u.firstInd<=l&&u.lastInd>=l){let c=o,p=o;for(;u.lastInd>l&&o<r.length-1&&(o++,l=r[o],u.lastInd>=l);)p=o;if(this.compositeReplacementRange.push({compositeName:u.compositeName,target:u.target,firstInd:c,lastInd:p}),o++,o===r.length)break;l=r[o]}o++}}this.activeChildrenIndices=r;let i=[],s=[];for(let[o,l]of n.entries()){if(typeof l!="object"){this.downstreamPrimitives.push(l);continue}this.downstreamPrimitives.push(null),i.push(l.componentName?l.componentName:`__placeholder_${o}`),s.push(l.componentType)}return{success:!0,downstreamComponentNames:i,downstreamComponentTypes:s}}async getValue({verbose:t}={}){let e=await super.getValue({verbose:t,skipProxy:!0}),r=[],n=0;for(let i of this.downstreamPrimitives)i===null?(r.push(e.value[n]),n++):r.push(i);return r.compositeReplacementRange=this.compositeReplacementRange,e.value=r,(this.downstreamPrimitives.length!==this.previousDownstreamPrimitives.length||this.downstreamPrimitives.some((i,s)=>i!==this.previousDownstreamPrimitives[s]))&&(e.changes.componentIdentitiesChanged=!0,this.previousDownstreamPrimitives=[...this.downstreamPrimitives]),e}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(e){let r=e.indexOf(this);r!==-1&&e.splice(r,1)}}}};T(G0,"dependencyType","child");et.push(G0);var H0=class extends ft{setUpParameters(){if(this.definition.ancestorName?(this.ancestorName=this.definition.ancestorName,this.specifiedComponentName=this.ancestorName):this.ancestorName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.componentTypes=this.definition.componentTypes,this.recurseToMatchedChildren=this.definition.recurseToMatchedChildren,this.useReplacementsForComposites=this.definition.useReplacementsForComposites,this.includeNonActiveChildren=this.definition.includeNonActiveChildren,this.includeAttributeChildren=this.definition.includeAttributeChildren,this.skipOverAdapters=this.definition.skipOverAdapters,this.ignoreReplacementsOfMatchedComposites=this.definition.ignoreReplacementsOfMatchedComposites,this.ignoreReplacementsOfEncounteredComposites=this.definition.ignoreReplacementsOfEncounteredComposites}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.ancestorName];if(!t){let i=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.ancestorName];i||(i=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.ancestorName]=[]),i.includes(this)||i.push(this);for(let s of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.ancestorName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:s,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:s,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:s});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}let e=this.dependencyHandler.updateTriggers.descendantDependenciesByAncestor[this.ancestorName];e||(e=this.dependencyHandler.updateTriggers.descendantDependenciesByAncestor[this.ancestorName]=[]),e.includes(this)||e.push(this);let r=this.gatherUnexpandedComposites(t);if(r.haveCompositesNotReady||r.haveUnexpandedCompositeReady){for(let i of this.upstreamVariableNames){await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:i,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:i});for(let s in r.unexpandedCompositesReadyByParentName)await this.dependencyHandler.addBlocker({blockerComponentName:s,blockerType:"childMatches",blockerStateVariable:i,componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName});for(let s in r.unexpandedCompositesNotReadyByParentName)await this.dependencyHandler.addBlocker({blockerComponentName:s,blockerType:"childMatches",blockerStateVariable:i,componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName})}return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}let n=k0({ancestor:t,descendantTypes:this.componentTypes,recurseToMatchedChildren:this.recurseToMatchedChildren,useReplacementsForComposites:this.useReplacementsForComposites,includeNonActiveChildren:this.includeNonActiveChildren,skipOverAdapters:this.skipOverAdapters,ignoreReplacementsOfMatchedComposites:this.ignoreReplacementsOfMatchedComposites,ignoreReplacementsOfEncounteredComposites:this.ignoreReplacementsOfEncounteredComposites,componentInfoObjects:this.dependencyHandler.componentInfoObjects});return{success:!0,downstreamComponentNames:n.map(i=>i.componentName),downstreamComponentTypes:n.map(i=>i.componentType)}}gatherUnexpandedComposites(t){let e={},r={},n=!1,i=!1,s=this.skipComponentNames&&this.originalDownstreamVariableNames.length===0;if(!t.childrenMatched)if(t.childrenMatchedWithPlaceholders){if(t.unexpandedCompositesReady.length>0){let o=this.unexpandedCompositesAdjustedForPlacedholders(t.unexpandedCompositesReady,s);o.length>0&&(e[t.componentName]=o,n=!0)}if(t.unexpandedCompositesNotReady.length>0){let o=this.unexpandedCompositesAdjustedForPlacedholders(t.unexpandedCompositesNotReady,s);o.length>0&&(r[t.componentName]=o,i=!0)}}else t.unexpandedCompositesReady.length>0&&(e[t.componentName]=t.unexpandedCompositesReady,n=!0),t.unexpandedCompositesNotReady.length>0&&(r[t.componentName]=t.unexpandedCompositesNotReady,i=!0);for(let o in t.allChildren){let l=t.allChildren[o].component;if(typeof l=="object"){let u=this.gatherUnexpandedComposites(l);u.haveUnexpandedCompositeReady&&(Object.assign(e,u.unexpandedCompositesReadyByParentName),n=!0),u.haveCompositesNotReady&&(Object.assign(r,u.unexpandedCompositesNotReadyByParentName),i=!0)}}return{unexpandedCompositesReadyByParentName:e,haveUnexpandedCompositeReady:n,unexpandedCompositesNotReadyByParentName:r,haveCompositesNotReady:i}}unexpandedCompositesAdjustedForPlacedholders(t,e){let r=[];for(let n of t){let i=this.dependencyHandler._components[n];if(i.attributes.componentType){let s=i.attributes.componentType.primitive;this.componentTypes.some(l=>this.dependencyHandler.componentInfoObjects.isInheritedComponentType({inheritedComponentType:s,baseComponentType:l}))&&e||r.push(n)}else r.push(n)}return r}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.descendantDependenciesByAncestor[this.ancestorName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(e){let r=e.indexOf(this);r!==-1&&e.splice(r,1)}}}};T(H0,"dependencyType","descendant");et.push(H0);var q0=class extends ft{setUpParameters(){if(this.definition.childName?(this.childName=this.definition.childName,this.specifiedComponentName=this.childName):this.childName=this.upstreamComponentName,this.definition.variableName)this.originalDownstreamVariableNames=[this.definition.variableName];else throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: must have a variableName`);this.definition.parentComponentType&&(this.parentComponentType=this.definition.parentComponentType),this.returnSingleVariableValue=!0,this.variablesOptional=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.childName];if(!t){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.childName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.childName]=[]),n.includes(this)||n.push(this);for(let i of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.childName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:i,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:i});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(!t.parentName)return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};this.parentName=t.parentName;let e=this.dependencyHandler._components[this.parentName];if(!e){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName]=[]),n.includes(this)||n.push(this);for(let i of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:i,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:i});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(this.parentComponentType&&!this.dependencyHandler.componentInfoObjects.isInheritedComponentType({inheritedComponentType:e.componentType,baseComponentType:this.parentComponentType}))return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};let r=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName];return r||(r=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName]=[]),r.includes(this)||r.push(this),{success:!0,downstreamComponentNames:[this.parentName],downstreamComponentTypes:[e.componentType]}}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName];if(t){let r=t.indexOf(this);r!==-1&&t.splice(r,1)}if(this.specifiedComponentName){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(r){let n=r.indexOf(this);n!==-1&&r.splice(n,1)}}let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];if(e){let r=e.indexOf(this);r!==-1&&e.splice(r,1)}}};T(q0,"dependencyType","parentStateVariable");et.push(q0);var W0=class extends ft{setUpParameters(){this.definition.childName?(this.childName=this.definition.childName,this.specifiedComponentName=this.childName):this.childName=this.upstreamComponentName,this.definition.parentComponentType&&(this.parentComponentType=this.definition.parentComponentType),this.returnSingleComponent=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.childName];if(!t){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.childName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.childName]=[]),n.includes(this)||n.push(this);for(let i of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.childName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:i,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:i});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(!t.parentName)return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};this.parentName=t.parentName;let e=this.dependencyHandler._components[this.parentName];if(!e){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName]=[]),n.includes(this)||n.push(this);for(let i of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:i,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:i});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(this.parentComponentType&&!this.dependencyHandler.componentInfoObjects.isInheritedComponentType({inheritedComponentType:e.componentType,baseComponentType:this.parentComponentType}))return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};let r=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName];return r||(r=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName]=[]),r.includes(this)||r.push(this),{success:!0,downstreamComponentNames:[this.parentName],downstreamComponentTypes:[e.componentType]}}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName];if(t){let r=t.indexOf(this);r!==-1&&t.splice(r,1)}if(this.specifiedComponentName){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(r){let n=r.indexOf(this);n!==-1&&r.splice(n,1)}}let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];if(e){let r=e.indexOf(this);r!==-1&&e.splice(r,1)}}};T(W0,"dependencyType","parentIdentity");et.push(W0);var $0=class extends ft{setUpParameters(){if(this.definition.descendantName?(this.descendantName=this.definition.descendantName,this.specifiedComponentName=this.descendantName):this.descendantName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.returnSingleComponent=!0,this.definition.componentType&&(this.componentType=this.definition.componentType)}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.descendantName];if(!t){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.descendantName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.descendantName]=[]),r.includes(this)||r.push(this);for(let n of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.descendantName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:n,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:n,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:n});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(!(this.dependencyHandler.core.documentName in this.dependencyHandler._components)){for(let r of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r}),await this.dependencyHandler.addBlocker({blockerComponentName:this.dependencyHandler.core.documentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:r,dependencyBlocked:this.dependencyName});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}let e=this.findMatchingAncestor(t);if(e.missingComponentName){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[e.missingComponentName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[e.missingComponentName]=[]),r.includes(this)||r.push(this);for(let n of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:e.missingComponentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:n,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:n,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:n});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}for(let r of e.ancestorsExamined){let n=this.dependencyHandler.updateTriggers.ancestorDependenciesByPotentialAncestor[r];n||(n=this.dependencyHandler.updateTriggers.ancestorDependenciesByPotentialAncestor[r]=[]),n.includes(this)||n.push(this)}return this.ancestorResults=e,e.ancestorFound?{success:!0,downstreamComponentNames:[e.ancestorFound.componentName],downstreamComponentTypes:[e.ancestorFound.componentClass.componentType]}:{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]}}findMatchingAncestor(t){let e=[];if(this.componentType){for(let n of t.ancestors){let i=this.dependencyHandler._components[n.componentName];if(!i)return{missingComponentName:n.componentName};if(e.push(n.componentName),this.dependencyHandler.componentInfoObjects.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:this.componentType}))return{ancestorsExamined:e,ancestorFound:n}}return{ancestorsExamined:e}}if(this.originalDownstreamVariableNames.length===0)return console.warn(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: must specify componentType or variableNames to find ancestor`),{ancestorsExamined:e};let r=this.originalDownstreamVariableNames;for(let n of t.ancestors){let i=this.dependencyHandler._components[n.componentName];if(!i)return{missingComponentName:n.componentName};e.push(n.componentName);let s=!0;for(let o of r)if(!(o in i.state||this.dependencyHandler.core.checkIfArrayEntry({stateVariable:o,component:i}))){s=!1;break}if(s)return{ancestorsExamined:e,ancestorFound:n}}return{ancestorsExamined:e}}deleteFromUpdateTriggers(){for(let t of this.ancestorResults.ancestorsExamined){let e=this.dependencyHandler.updateTriggers.ancestorDependenciesByPotentialAncestor[t];if(e){let r=e.indexOf(this);r!==-1&&e.splice(r,1)}}if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}if(this.ancestorResults&&this.ancestorResults.missingComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.ancestorResults.missingComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T($0,"dependencyType","ancestor");et.push($0);var K0=class extends ft{setUpParameters(){if(this.definition.compositeName?(this.compositeName=this.definition.compositeName,this.specifiedComponentName=this.compositeName):this.compositeName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.recursive=this.definition.recursive,this.recurseNonStandardComposites=this.definition.recurseNonStandardComposites,Number.isInteger(this.definition.componentIndex)&&(this.componentIndex=this.definition.componentIndex),this.includeWithheldReplacements=this.definition.includeWithheldReplacements,this.expandReplacements=!0}async determineDownstreamComponents(){this.replacementPrimitives?this.previousReplacementPrimitives=[...this.replacementPrimitives]:this.previousReplacementPrimitives=[],this.replacementPrimitives=[];let t=this.dependencyHandler._components[this.compositeName];if(!t){let i=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.compositeName];i||(i=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.compositeName]=[]),i.includes(this)||i.push(this);for(let s of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.compositeName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:s,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:s,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:s});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(!t.isExpanded){for(let i of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:i,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:i}),await this.dependencyHandler.addBlocker({blockerComponentName:this.compositeName,blockerType:"expandComposite",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName});return t.state.readyToExpandWhenResolved.isResolved||await this.dependencyHandler.addBlocker({blockerComponentName:this.compositeName,blockerType:"stateVariable",blockerStateVariable:"readyToExpandWhenResolved",componentNameBlocked:this.compositeName,typeBlocked:"expandComposite"}),{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}this.compositesFound=[this.compositeName];let e=t.replacements;if(!this.includeWithheldReplacements&&t.replacementsToWithhold>0&&(e=e.slice(0,-t.replacementsToWithhold)),this.recursive){let i=this.dependencyHandler.core.recursivelyReplaceCompositesWithReplacements({replacements:e,recurseNonStandardComposites:this.recurseNonStandardComposites,includeWithheldReplacements:this.includeWithheldReplacements});if(i.unexpandedCompositesNotReady.length>0||i.unexpandedCompositesReady.length>0){for(let s of this.upstreamVariableNames){await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:s,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:s});for(let o of[...i.unexpandedCompositesReady,...i.unexpandedCompositesNotReady])await this.dependencyHandler.addBlocker({blockerComponentName:o,blockerType:"expandComposite",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:s,dependencyBlocked:this.dependencyName})}for(let s of i.unexpandedCompositesNotReady)await this.dependencyHandler.addBlocker({blockerComponentName:s,blockerType:"stateVariable",blockerStateVariable:"readyToExpandWhenResolved",componentNameBlocked:s,typeBlocked:"expandComposite"});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}e=i.newReplacements,this.compositesFound.push(...i.compositesFound)}for(let i of this.compositesFound){let s=this.dependencyHandler.updateTriggers.replacementDependenciesByComposite[i];s||(s=this.dependencyHandler.updateTriggers.replacementDependenciesByComposite[i]=[]),s.includes(this)||s.push(this)}if(this.componentIndex!==void 0){let i=e[this.componentIndex-1];i?e=[i]:e=[]}let r=[],n=[];for(let i of e){if(typeof i!="object"){this.replacementPrimitives.push(i);continue}this.replacementPrimitives.push(null),r.push(i.componentName),n.push(i.componentType)}return{success:!0,downstreamComponentNames:r,downstreamComponentTypes:n}}async getValue({verbose:t}={}){let e=await super.getValue({verbose:t,skipProxy:!0}),r=[],n=0;for(let i of this.replacementPrimitives)i===null?(r.push(e.value[n]),n++):r.push(i);return e.value=r,(this.replacementPrimitives.length!==this.previousReplacementPrimitives.length||this.replacementPrimitives.some((i,s)=>i!==this.previousReplacementPrimitives[s]))&&(e.changes.componentIdentitiesChanged=!0,this.previousReplacementPrimitives=[...this.replacementPrimitives]),e}deleteFromUpdateTriggers(){if(this.compositesFound)for(let t of this.compositesFound){let e=this.dependencyHandler.updateTriggers.replacementDependenciesByComposite[t];if(e){let r=e.indexOf(this);r!==-1&&e.splice(r,1)}}if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(K0,"dependencyType","replacement");et.push(K0);var X0=class extends ft{setUpParameters(){if(this.definition.replacementName?(this.replacementName=this.definition.replacementName,this.specifiedComponentName=this.replacementName):this.replacementName=this.upstreamComponentName,this.definition.variableName)this.originalDownstreamVariableNames=[this.definition.variableName];else throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: must have a variableName`);this.definition.compositeComponentType&&(this.compositeComponentType=this.definition.compositeComponentType),this.returnSingleVariableValue=!0,this.variablesOptional=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.replacementName];if(!t){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.replacementName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.replacementName]=[]),r.includes(this)||r.push(this);for(let n of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.replacementName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:n,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:n,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:n});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(!t.replacementOf)return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};let e=t.replacementOf;if(this.compositeComponentType)for(;!this.dependencyHandler.componentInfoObjects.isInheritedComponentType({inheritedComponentType:e.componentType,baseComponentType:this.compositeComponentType});)if(e.replacementOf)e=e.replacementOf;else return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};return{success:!0,downstreamComponentNames:[e.componentName],downstreamComponentTypes:[e.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(X0,"dependencyType","sourceCompositeStateVariable");et.push(X0);var Y0=class extends ft{setUpParameters(){this.definition.replacementName?(this.replacementName=this.definition.replacementName,this.specifiedComponentName=this.replacementName):this.replacementName=this.upstreamComponentName,this.returnSingleComponent=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.replacementName];if(!t){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.replacementName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.replacementName]=[]),r.includes(this)||r.push(this);for(let n of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.replacementName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:n,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:n,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:n});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(!t.replacementOf)return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};let e=t.replacementOf;return{success:!0,downstreamComponentNames:[e.componentName],downstreamComponentTypes:[e.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(Y0,"dependencyType","sourceCompositeIdentity");et.push(Y0);var Z0=class extends ft{setUpParameters(){if(this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName,this.definition.variableName)this.originalDownstreamVariableNames=[this.definition.variableName];else throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: must have a variableName`);this.returnSingleVariableValue=!0,this.variablesOptional=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName]=[]),r.includes(this)||r.push(this);for(let n of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.componentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:n,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:n,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:n});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(!t.adaptedFrom)return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};let e=t.adaptedFrom;return{success:!0,downstreamComponentNames:[e.componentName],downstreamComponentTypes:[e.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(Z0,"dependencyType","adapterSourceStateVariable");et.push(Z0);var J0=class extends ft{setUpParameters(){this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName]=[]),n.includes(this)||n.push(this);for(let i of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.componentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:i,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:i});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(!t.parentName)return console.warn(`component ${this.componentName} does not have a parent for state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}.`),{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]};this.parentName=t.parentName;let e=this.dependencyHandler._components[this.parentName];if(!e){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName]=[]),n.includes(this)||n.push(this);for(let i of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:i,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:i,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:i});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}let r=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName];if(r||(r=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName]=[]),r.includes(this)||r.push(this),!e.childrenMatched&&!e.childrenMatchedWithPlaceholders){let i=e.unexpandedCompositesNotReady.length>0;if(!i&&e.unexpandedCompositesReady.length>0){for(let s of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"childMatches",blockerStateVariable:s,componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:s,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:s,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:s});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}if(i){for(let s of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"childMatches",blockerStateVariable:s,componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:s,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:s,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:s});for(let s of e.unexpandedCompositesNotReady)for(let o of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:s,blockerType:"stateVariable",blockerStateVariable:"readyToExpandWhenResolved",componentNameBlocked:this.upstreamComponentName,typeBlocked:"childMatches",stateVariableBlocked:o});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}}return{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]}}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName];if(t){let r=t.indexOf(this);r!==-1&&t.splice(r,1)}if(this.specifiedComponentName){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(r){let n=r.indexOf(this);n!==-1&&r.splice(n,1)}}let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];if(e){let r=e.indexOf(this);r!==-1&&e.splice(r,1)}}async getValue(){let t=this.dependencyHandler.components[this.upstreamComponentName].componentType;return{value:this.dependencyHandler.components[this.parentName].activeChildren.filter(n=>n.componentType===t).map(n=>n.componentName).indexOf(this.upstreamComponentName)+1,changes:{}}}};T(J0,"dependencyType","countAmongSiblingsOfSameType");et.push(J0);var Q0=class extends ft{setUpParameters(){let t=this.dependencyHandler._components[this.upstreamComponentName];if(this.target=t.doenetAttributes.target,this.target&&(this.targetComponentName=this.specifiedComponentName=t.doenetAttributes.targetComponentName),this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.returnSingleComponent=!0}async determineDownstreamComponents(){if(!this.target)return{downstreamComponentNames:[],downstreamComponentTypes:[]};let t=this.dependencyHandler._components[this.targetComponentName];if(!t){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.targetComponentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.targetComponentName]=[]),e.includes(this)||e.push(this);for(let r of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.targetComponentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:r,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}return{success:!0,downstreamComponentNames:[this.targetComponentName],downstreamComponentTypes:[t.componentType]}}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}};T(Q0,"dependencyType","targetComponent");et.push(Q0);var e2=class extends ft{setUpParameters(){this.parentName=this.upstreamComponentName,this.target=this.definition.target}async getValue(){let t=this.dependencyHandler._components[this.parentName],e=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,r=this.parentName.split("/").map(i=>({namespace:i}));e||(r=r.slice(0,r.length-1));let n;try{n=I0({target:this.target,namespaceStack:r})}catch(i){n=null}return{value:n,changes:{}}}};T(e2,"dependencyType","expandTargetName");et.push(e2);var uh=class extends ft{setUpParameters(){this.value=this.definition.value}async getValue(){return{value:this.value,changes:{}}}};T(uh,"dependencyType","value");et.push(uh);var t2=class extends uh{setUpParameters(){this.flagName=this.definition.flagName,this.value=this.dependencyHandler.core.flags[this.flagName]}};T(t2,"dependencyType","flag");et.push(t2);var r2=class extends To{setUpParameters(){this.attributeName=this.definition.attributeName,this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName}async getValue(){let t=null,e={};return this.componentIdentitiesChanged&&(e.componentIdentitiesChanged=!0,this.componentIdentitiesChanged=!1),this.downstreamComponentNames.length===1&&(t=this.dependencyHandler.components[this.downstreamComponentNames[0]].doenetAttributes[this.attributeName]),{value:t,changes:e}}};T(r2,"dependencyType","doenetAttribute");et.push(r2);var n2=class extends To{setUpParameters(){this.attributeName=this.definition.attributeName,this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName}async getValue(){let t=null,e={};return this.componentIdentitiesChanged&&(e.componentIdentitiesChanged=!0,this.componentIdentitiesChanged=!1),this.downstreamComponentNames.length===1&&(t=this.dependencyHandler.components[this.downstreamComponentNames[0]].attributes[this.attributeName],t?t=t.primitive:t=null),{value:t,changes:e}}};T(n2,"dependencyType","attributePrimitive");et.push(n2);var a2=class extends ft{setUpParameters(){this.definition.parentName?(this.parentName=this.definition.parentName,this.specifiedComponentName=this.parentName):this.parentName=this.upstreamComponentName}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.parentName];if(!t){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName]=[]),e.includes(this)||e.push(this);for(let r of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.parentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:r,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}return{success:!0,downstreamComponentNames:[this.parentName],downstreamComponentTypes:[t.componentType]}}async getValue(){return{value:this.dependencyHandler._components[this.parentName].serializedChildren,changes:{}}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(a2,"dependencyType","serializedChildren");et.push(a2);var i2=class extends ft{setUpParameters(){this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName]=[]),e.includes(this)||e.push(this);for(let r of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.componentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:r,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}return{success:!0,downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}async getValue(){return{value:this.dependencyHandler._components[this.componentName].variants,changes:{}}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};T(i2,"dependencyType","variants");et.push(i2);var s2=class extends ft{setUpParameters(){this.counterName=this.definition.counterName,this.componentName=this.upstreamComponentName}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName],e=t.counters[this.counterName];return e||(e=t.counters[this.counterName]={dependencies:[],componentList:[],value:null}),e.dependencies.includes(this)||e.dependencies.push(this),await this.dependencyHandler.collateCountersAndPropagateToAncestors(t),{success:!0,downstreamComponentNames:[],downstreamComponentTypes:[]}}async getValue(){return{value:this.dependencyHandler._components[this.componentName].counters[this.counterName].value,changes:{}}}};T(s2,"dependencyType","counter");et.push(s2);var o2=class extends ft{setUpParameters(){if(this.recalculateDependencies=!0,this.definition.componentName?this.componentName=this.definition.componentName:this.componentName=this.upstreamComponentName,this.definition.variableNames===void 0)throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames is not defined`);this.originalDownstreamVariableNames=this.definition.variableNames,this.returnSingleComponent=!0}async determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.componentName]=[]),e.includes(this)||e.push(this);for(let r of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.componentName,blockerType:"componentIdentity",componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:r,dependencyBlocked:this.dependencyName}),await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"recalculateDownstreamComponents",blockerStateVariable:r,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:r});return{success:!1,downstreamComponentNames:[],downstreamComponentTypes:[]}}for(let e of this.upstreamVariableNames)await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"determineDependencies",blockerStateVariable:e,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:e});return{success:!0,downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}async markStale(){let t=this.dependencyHandler._components[this.upstreamComponentName];for(let e of this.upstreamVariableNames)if(!(t&&t.state[e]&&t.state[e].currentlyResolving)){await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"determineDependencies",blockerStateVariable:e,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"stateVariable",stateVariableBlocked:e});for(let r in this.dependencyHandler.downstreamDependencies[this.upstreamComponentName][e])this.dependencyHandler.downstreamDependencies[this.upstreamComponentName][e][r].dependencyType!=="determineDependencies"&&await this.dependencyHandler.addBlocker({blockerComponentName:this.upstreamComponentName,blockerType:"determineDependencies",blockerStateVariable:e,blockerDependency:this.dependencyName,componentNameBlocked:this.upstreamComponentName,typeBlocked:"recalculateDownstreamComponents",stateVariableBlocked:e,dependencyBlocked:r})}}};T(o2,"dependencyType","determineDependencies");et.push(o2);import nt from"math-expressions";var Zl=["abs","exp","log","ln","log10","sign","sqrt","erf","acos","acosh","acot","acoth","acsc","acsch","asec","asech","asin","asinh","atan","atanh","cos","cosh","cot","coth","csc","csch","sec","sech","sin","sinh","tan","tanh","arcsin","arccos","arctan","arccsc","arcsec","arccot","cosec","arg","min","max","mean","median","floor","ceil","round","sum","prod","var","std","count","mod"],l2=["alpha","beta","gamma","Gamma","delta","Delta","epsilon","zeta","eta","theta","Theta","iota","kappa","lambda","Lambda","mu","nu","xi","Xi","pi","Pi","rho","sigma","Sigma","tau","Tau","upsilon","Upsilon","phi","Phi","chi","psi","Psi","omega","Omega","partial","varnothing","emptyset"],pn=new nt.converters.textToAstObj({appliedFunctionSymbols:Zl});function la({functionSymbols:a,appliedFunctionSymbols:t=Zl,splitSymbols:e=!0}){return r=>nt.fromAst(new nt.converters.textToAstObj({appliedFunctionSymbols:t,functionSymbols:a,splitSymbols:e}).convert(r))}var ch=new nt.converters.latexToAstObj({appliedFunctionSymbols:Zl,allowedLatexSymbols:l2});function Jl({functionSymbols:a,appliedFunctionSymbols:t=Zl,splitSymbols:e=!0}){return e?r=>nt.fromAst(new nt.converters.latexToAstObj({appliedFunctionSymbols:t,functionSymbols:a,allowedLatexSymbols:l2}).convert(tq(r))):r=>nt.fromAst(new nt.converters.latexToAstObj({appliedFunctionSymbols:t,functionSymbols:a,allowedLatexSymbols:l2}).convert(eq(r)))}function Wr({value:a,simplify:t,expand:e=!1,createVectors:r=!1,createIntervals:n=!1}){return r&&(a=a.tuples_to_vectors()),n&&(a=a.to_intervals()),e&&(a=a.expand()),t==="full"?a.simplify():t==="numbers"?a.evaluate_numbers():t==="numberspreserveorder"?a.evaluate_numbers({skip_ordering:!0}):a}function lt(a){if(a!==void 0)return Number.isFinite(a)||a.evaluate_to_constant!==void 0&&(a=a.evaluate_to_constant(),Number.isFinite(a))?a:null}function se(a){return a instanceof nt.class?a:typeof a=="number"||typeof a=="string"?nt.fromAst(a):Array.isArray(a)?nt.fromAst(a):nt.fromAst("\uFF3F")}function En(a,t){if(!Number.isInteger(a)||a<1)return[];let e=t.length;if(e===0){if(a===1)return[nt.fromAst("x")];if(a===2)return[nt.fromAst("x"),nt.fromAst("y")];if(a===3)return[nt.fromAst("x"),nt.fromAst("y"),nt.fromAst("z")];{let i=[];for(let s=1;s<=a;s++)i.push(nt.fromAst(pn.convert(`x_${s}`)));return i}}if(new Set(t.map(i=>i.toString())).size<e&&console.warn("Duplicate variables specified"),a<=e)return t.slice(0,a);let r=[...t.map(i=>i.toString())],n=[...t];for(let i=e+1;i<=a;i++){let s;i==1?a>3?s=["x_1"]:s=["x"]:i==2?a>3?s=["x_2","y_2"]:s=["y","x_2"]:i==3?a>3?s=["x_3","y_3","z_3"]:s=["z","x_3","z_3"]:s=["x","y","z","u","v","w","X","Y","Z"].map(l=>`${l}_${i}`);let o=!1;for(let l of s)if(!r.includes(l)){n.push(nt.fromAst(pn.convert(l))),r.push(l),o=!0;break}if(!o){let l=s[0];n.push(nt.fromAst(pn.convert(l))),r.push(l),console.warn("Variables added were not unique")}}return n}async function Ql({desiredValue:a,stateValues:t,variableName:e="value",arrayKey:r,workspace:n}){if(a.tree[0]!=="tuple"&&a.tree[0]!=="vector"||!a.tree.includes())return{desiredValue:a};let i,s=e+"Ast";if(r!==void 0&&(s+=`_${r}`),n[s])i=n[s].slice(0,a.tree.length);else{let o=await t[e];o&&r!==void 0&&(o=o[r]),o&&(o.tree[0]==="tuple"||o.tree[0]==="vector")&&(i=o.tree.slice(0,a.tree.length))}if(i){let o=[],l=!1;for(let[u,c]of a.tree.entries())c===void 0?(l=!0,o.push(u)):i[u]=c;return a=nt.fromAst(i),n[s]=i,l?{desiredValue:a,vectorComponentsNotAffected:o}:{desiredValue:a}}else{let o=[];for(let l of a.tree.slice(1))l===void 0?o.push("\uFF3F"):o.push(l);return a=nt.fromAst([a.tree[0],...o]),{desiredValue:a}}}function ph(a,{unionFromU:t=!1}={}){let e=[["\u03B1","\\alpha "],["\u03B2","\\beta "],["\u03D0","\\beta "],["\u0393","\\Gamma "],["\u03B3","\\gamma "],["\u0394","\\Delta "],["\u03B4","\\delta "],["\u03B5","\\epsilon "],["\u03F5","\\epsilon "],["\u03B6","\\zeta "],["\u03B7","\\eta "],["\u0398","\\Theta "],["\u03F4","\\Theta "],["\u03B8","\\theta "],["\u1DBF","\\theta "],["\u03D1","\\theta "],["\u03B9","\\iota "],["\u03BA","\\kappa "],["\u039B","\\Lambda "],["\u03BB","\\lambda "],["\u03BC","\\mu "],["\xB5","\\mu "],["\u03BD","\\nu "],["\u039E","\\Xi "],["\u03BE","\\xi "],["\u03A0","\\Pi "],["\u03C0","\\pi "],["\u03D6","\\pi "],["\u03C1","\\rho "],["\u03F1","\\rho "],["\u03A3","\\Sigma "],["\u03C3","\\sigma "],["\u03C2","\\sigma "],["\u03C4","\\tau "],["\u03A5","\\Upsilon "],["\u03C5","\\upsilon "],["\u03A6","\\Phi "],["\u03C6","\\phi "],["\u03D5","\\phi "],["\u03A8","\\Psi "],["\u03C8","\\psi "],["\u03A9","\\Omega "],["\u03C9","\\omega "],["\u2212","-"],["\u22C5"," \\cdot "],["\xB7"," \\cdot "],["\u222A"," \\cup "],["\u2229"," \\cap "],["\u221E"," \\infty "],["\u2205"," \\emptyset "]];for(let i of e)a=a.replaceAll(i[0],i[1]);let r=a.match(/^(\\ )*(\\ldots|\.(\\ )*\.(\\ )*\.)(\\ )*(.*)$/);if(r){let i=r[6];i[0]!==","?a="\\ldots,"+i:a="\\ldots"+i}let n=a.match(/^(.*?)(\\ )*(\\ldots|\.(\\ )*\.(\\ )*\.)(\\ )*$/);if(n){let i=n[1];i[i.length-1]!==","?a=i+",\\ldots":a=i+"\\ldots"}return a=a.replaceAll(/(\b|\\ )or(\b|\\ )/g,"$1\\lor$2"),a=a.replaceAll(/(\b|\\ )and(\b|\\ )/g,"$1\\land$2"),t&&(a=a.replaceAll(/(\b|\\ )U(\b|\\ )/g,"$1\\cup$2")),a}function mh(a){let t=a.tree,e=!0;return typeof t=="string"?t==="\uFF3F"&&(e=!1):(!Array.isArray(t)||t[0]!=="_"||typeof t[1]!="string"||typeof t[2]!="string"&&typeof t[2]!="number")&&(e=!1),e}function fh({numberVariableName:a="number",mathVariableName:t="math",isPublic:e=!1}={}){let r={returnDependencies:()=>({number:{dependencyType:"stateVariable",variableName:a}}),definition:function({dependencyValues:n}){return{setValue:{[t]:nt.fromAst(n.number)}}},inverseDefinition:function({desiredStateVariableValues:n}){let i=n[t].evaluate_to_constant();return i===null&&(i=NaN),{success:!0,instructions:[{setDependency:"number",desiredValue:i}]}}};return e&&(r.public=!0,r.componentType="math"),r}function Lt({value:a,dependencyValues:t,usedDefault:e}){let r;return e.displayDigits&&!e.displayDecimals?Number.isFinite(t.displayDecimals)?r=nt.round_numbers_to_decimals(a,t.displayDecimals):r=a:(t.displayDigits>=1?r=nt.round_numbers_to_precision(a,t.displayDigits):r=a,t.displaySmallAsZero>0&&(r=nt.evaluate_numbers(r,{skip_ordering:!0,set_small_zero:t.displaySmallAsZero}))),r}function u2(a){if(!Array.isArray(a))return a;let t=a[0],e=a.slice(1);return["tuple","vector","list","set"].includes(t)&&(e=e.reduce((r,n)=>Array.isArray(n)&&n[0]==="list"?[...r,...n.slice(1)]:[...r,n],[])),e=e.map(r=>u2(r)),[t,...e]}function eq(a){let t="",e=/\\var\s*{[^{}]*}/,r=a.match(e);for(;r;){let n=r.index,i=n+r[0].length;t+=Dx(a.substring(0,n)),t+=a.substring(n,i),a=a.substring(i),r=a.match(e)}return t+=Dx(a),t}function Dx(a){let t="",e=/([^a-zA-Z0-9]?)([a-zA-Z][a-zA-Z0-9]+)([^a-zA-Z0-9]?)/,r=a.match(e);for(;r;){let n=r.index,i=n+r[0].length-r[3].length;if(r[1]==="\\")t+=a.substring(0,i),a=a.substring(i);else{let s=n+r[1].length;t+=a.substring(0,s),t+=`\\var{${r[2]}}`,a=a.substring(i)}r=a.match(e)}return t+=a,t}function tq(a){let t="",e=/\\var\s*{[^{}]*}/,r=a.match(e);for(;r;){let n=r.index,i=n+r[0].length;t+=Ix(a.substring(0,n)),t+=a.substring(n,i),a=a.substring(i),r=a.match(e)}return t+=Ix(a),t}function Ix(a){let t="",e=/([^a-zA-Z0-9]?)([a-zA-Z][a-zA-Z0-9]*[0-9][a-zA-Z0-9]*)([^a-zA-Z0-9]?)/,r=a.match(e);for(;r;){let n=r.index,i=n+r[0].length-r[3].length;if(r[1]==="\\")t+=a.substring(0,i),a=a.substring(i);else{let s=n+r[1].length;t+=a.substring(0,s),t+=`\\var{${r[2]}}`,a=a.substring(i)}r=a.match(e)}return t+=a,t}function eu(a){return a.replaceAll("\\,","").replaceAll(/\\var{([^{}]*)}/g,"$1")}function $r({stateVariableDefinitions:a,oldName:t,newName:e}){let r=a[e]=a[t];if(delete a[t],r.additionalStateVariablesDefined){let l=r.additionalStateVariablesDefined.indexOf(t);l!==-1&&(r.additionalStateVariablesDefined[l]=e)}let n=r.definition,i=["setValue","useEssentialOrDefaultValue","setEssentialValue"],s=["noChanges"];r.definition=function(l){let u=n(l);for(let c of i)u[c]&&t in u[c]&&(u[c][e]=u[c][t],delete u[c][t]);for(let c of s)if(u[c]){let p=u[c].indexOf(t);p!==-1&&(u[c][p]=e)}return u};let o=r.inverseDefinition;o&&(r.inverseDefinition=async function(l){let u=l.desiredStateVariableValues;u[t]=u[e],delete u[e];let c=await o(l);if(c.success)for(let p of c.instructions)p.setEssentialValue===t&&(p.setEssentialValue=e);return c})}function dh(a){return a>1?function({arrayEntryPrefix:t,varEnding:e,arraySize:r,nDimensions:n}){let i=e.split("_").map(s=>Number(s)-1);return i.length===n&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?r?i.every((s,o)=>s<r[o])?[String(i)]:[]:[String(i)]:[]}:function({arrayEntryPrefix:t,varEnding:e,arraySize:r}){let n=Number(e)-1;return Number.isInteger(n)&&n>=0?r?n<r[0]?[String(n)]:[]:[String(n)]:[]}}var Qp=(a=21)=>{let t="",e=crypto.getRandomValues(new Uint8Array(a));for(;a--;){let r=e[a]&63;r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r<63?t+="_":t+="-"}return t};var f2={};st(f2,{Columns:()=>yh,Description:()=>vh,Else:()=>p2,RightHandSide:()=>gh,Title:()=>bh,externalContent:()=>m2});import c2 from"math-expressions";function em({numberOfIndices:a,numberOfOptions:t,maxNumber:e=1/0,withReplacement:r=!1,skipZero:n=!1}){if(a===1){let l=[...Array(t).keys()];return l=l.slice(1),n||(l=[...l,0]),l=l.slice(0,e),l=l.map(u=>[u]),l}let i=em({numberOfIndices:a-1,numberOfOptions:t,maxNumber:e,withReplacement:r,skipZero:!r}),s=[],o=0;for(let l of i)for(let u=1;u<=t;u++){let c=[u%t,...l.map(p=>(u+p)%t)];if(!(n&&c.includes(0))&&(s.push(c),o++,o>=e))return s}return s}function ka({numberOfOptionsByIndex:a,maxNumber:t=1/0}){let e=a.length;if(e===0)return[];let r=[];for(let d=0;d<e;d++){let h=[];for(let y=0;y<d;y++)h.push(c2.math.gcd(a[d],a[y]));r.push(h)}let n=r.reduce((d,h)=>[...h,...d],[]).reduce((d,h)=>Math.max(d,h),1);if(n===1){let d=a.reduce((y,b)=>y*b);d=Math.min(d,t);let h=[];for(let y=0;y<d;y++){let b=a.map(g=>y%g);h.push(b)}return h}if(e===2){let d=n,h=c2.math.lcm(...a),y=[],b=0;for(let g=0;g<d;g++)for(let v=0;v<h;v++){let A=[v%a[0],(v+g)%a[1]];if(y.push(A),b++,b>=t)return y}return y}let i=[];for(let d=0;d<e;d++){let h=[];for(let y=0;y<d;y++)r[d][y]>1?h.push(c2.math.lcm(a[d],a[y])):h.push(null);i.push(h)}let s=i.reduce((d,h)=>[...h,...d],[]).filter(d=>d!==null).reduce((d,h)=>Math.min(d,h),1/0),o;for(let d=0;d<e;d++){for(let h=0;h<d;h++)if(i[d][h]===s){o=[h,d];break}if(o)break}let l=a[o[0]],u=a[o[1]],c=[l,u],p=a;p[o[0]]=l*u,p.splice(o[1],1);let m=ka({numberOfOptionsByIndex:p,maxNumber:t}),f=ka({numberOfOptionsByIndex:c,maxNumber:t});for(let d of m){let h=f[d[o[0]]];d.splice(o[0],1,h[0]),d.splice(o[1],0,h[1])}return m}function Px({values:a,maxNumber:t}){let e=[],r=(n,i=[])=>{if(n.length===0)e.push(i);else for(let s=0;s<n.length;s++){let o=n.slice(),l=o.splice(s,1);if(r(o.slice(),i.concat(l)),e.length>=t)return}};return r(a),e}var J=class{constructor({componentName:t,ancestors:e,serializedComponent:r,definingChildren:n,serializedChildren:i,attributes:s,stateVariableDefinitions:o,componentInfoObjects:l,coreFunctions:u,flags:c,shadow:p,numerics:m,parentSharedParameters:f,sharedParameters:d}){this.numerics=m,this.parentSharedParameters=f,this.sharedParameters=d,this.componentName=t,this.ancestors=e,this.counters={},this.componentInfoObjects=l,this.coreFunctions=u,this.flags=c,p===!0&&(this.isShadow=!0),this.definingChildren=n,this.definingChildren===void 0&&(this.definingChildren=[]),this.serializedChildren=i,this.attributes=s,this.state={};for(let h in o)this.state[h]=Object.assign({},o[h]);this.stateValues=new Proxy(this.state,P0()),this.essentialState={},r.state&&(this.essentialState=Re(r.state)),this.doenetAttributes={},r.doenetAttributes!==void 0&&Object.assign(this.doenetAttributes,r.doenetAttributes),r.variants!==void 0&&(this.variants=r.variants)}static get rendererType(){return this.componentType}get componentType(){return this.constructor.componentType}get componentOrAdaptedName(){return this.adaptedFrom?this.adaptedFrom.componentOrAdaptedName:this.componentName}get rendererType(){return this.constructor.rendererType}get allPotentialRendererTypes(){let t=[];this.rendererType&&t.push(this.rendererType);for(let e in this.state){let r=this.state[e];if(r.public){let n=r.componentType;Array.isArray(n)||(n=[n]),r.wrappingComponents&&n.push(...vr(r.wrappingComponents).map(i=>typeof i=="object"?i.componentType:i));for(let i of n){let s=this.componentInfoObjects.allComponentClasses[i];if(s){let o=s.rendererType;o&&!t.includes(o)&&t.push(o)}}}}if(this.constructor.adapters)for(let e of this.constructor.adapters){let r;typeof e=="string"?r=e:r=e.componentType;let n=this.componentInfoObjects.allComponentClasses[r];if(n){let i=n.rendererType;i&&!t.includes(i)&&t.push(i)}}if(!this.rendererType)return t;for(let e in this.allChildren){let r=this.allChildren[e].component;if(typeof r=="object")for(let n of r.allPotentialRendererTypes)t.includes(n)||t.push(n)}return t}potentialRendererTypesFromSerializedComponents(t){let e=[];for(let r of t){let n=this.componentInfoObjects.allComponentClasses[r.componentType];if(n){let i=n.rendererType;i&&!e.includes(i)&&e.push(i);let s=n.returnStateVariableInfo({onlyPublic:!0,flags:this.flags}).stateVariableDescriptions;for(let o in s){let l=s[o],u=l.componentType;Array.isArray(u)||(u=[u]),l.wrappingComponents&&u.push(...vr(l.wrappingComponents).map(c=>typeof c=="object"?c.componentType:c));for(let c of u){let p=this.componentInfoObjects.allComponentClasses[c];if(p){let m=p.rendererType;m&&!e.includes(m)&&e.push(m)}}}if(n.adapters)for(let o of n.adapters){let l;typeof o=="string"?l=o:l=o.componentType;let u=this.componentInfoObjects.allComponentClasses[l];if(u){let c=u.rendererType;c&&!e.includes(c)&&e.push(c)}}}if(r.children){let i=this.potentialRendererTypesFromSerializedComponents(r.children);for(let s of i)e.includes(s)||e.push(s)}}return e}get childrenMatched(){return this.childrenMatchedWithPlaceholders&&!this.placeholderActiveChildrenIndices}static createAttributesObject({flags:t={}}={}){return{hide:{createComponentOfType:"boolean",createStateVariable:"hide",defaultValue:!1,public:!0},disabled:{createComponentOfType:"boolean",createStateVariable:"disabledPreliminary",defaultValue:null},disabledIgnoresParentReadOnly:{createComponentOfType:"boolean",createStateVariable:"disabledIgnoresParentReadOnly",defaultValue:!1},modifyIndirectly:{createComponentOfType:"boolean",createStateVariable:"modifyIndirectly",defaultValue:!0,public:!0,propagateToProps:!0},fixed:{createComponentOfType:"boolean",createStateVariable:"fixedPreliminary",defaultValue:null},styleNumber:{createComponentOfType:"number",createStateVariable:"styleNumber",defaultValue:1,public:!0,fallBackToParentStateVariable:"styleNumber"},isResponse:{createPrimitiveOfType:"boolean",createStateVariable:"isResponse",defaultValue:!1,public:!0},newNamespace:{createPrimitiveOfType:"boolean"}}}static returnSugarInstructions(){return[]}static returnChildGroups(){return[]}static get childGroups(){return this.hasOwnProperty("childGroupsData")?this.childGroupsData:(this.childGroupsData=this.returnChildGroups(),this.childGroupsData)}static get childGroupOfComponentType(){return this.hasOwnProperty("childGroupOfComponentTypeData")?this.childGroupOfComponentTypeData:(this.childGroupOfComponentTypeData={},this.childGroupOfComponentTypeData)}static get childGroupIndsByName(){if(this.hasOwnProperty("childGroupIndsByNameData"))return Object.assign({},this.childGroupIndsByNameData);this.childGroupIndsByNameData={};for(let[t,e]of this.childGroups.entries()){if(e.group in this.childGroupIndsByNameData)throw Error(`Invalid childGroups for componentClass ${this.componentType}: ${e} is repeated`);this.childGroupIndsByNameData[e.group]=t}return Object.assign({},this.childGroupIndsByNameData)}returnMatchedChildIndices(t){let e=[];for(let r of t){let n=this.childMatchesByGroup[r];if(!n)throw Error(`child group ${r} is not defined for a component of type ${this.componentType}`);e.push(...n)}return e.sort((r,n)=>r-n)}static returnStateVariableDefinitions(){let t={};return t.hidden={public:!0,componentType:"boolean",forRenderer:!0,returnDependencies:()=>({hide:{dependencyType:"stateVariable",variableName:"hide",variablesOptional:!0},parentHidden:{dependencyType:"parentStateVariable",variableName:"hidden"},sourceCompositeHidden:{dependencyType:"sourceCompositeStateVariable",variableName:"hidden"},adapterSourceHidden:{dependencyType:"adapterSourceStateVariable",variableName:"hidden"}}),definition:({dependencyValues:e})=>({setValue:{hidden:e.parentHidden===!0||e.sourceCompositeHidden===!0||e.adapterSourceHidden===!0||e.hide===!0}}),markStale:()=>({updateParentRenderedChildren:!0})},t.disabled={public:!0,componentType:"boolean",forRenderer:!0,hasEssential:!0,doNotShadowEssential:!0,defaultValue:!1,returnDependencies:()=>({disabledPreliminary:{dependencyType:"stateVariable",variableName:"disabledPreliminary",variablesOptional:!0},disabledAttr:{dependencyType:"attributeComponent",attributeName:"disabled"},readOnly:{dependencyType:"flag",flagName:"readOnly"},disabledIgnoresParentReadOnly:{dependencyType:"stateVariable",variableName:"disabledIgnoresParentReadOnly",variablesOptional:!0},parentDisabled:{dependencyType:"parentStateVariable",variableName:"disabled"},sourceCompositeDisabled:{dependencyType:"sourceCompositeStateVariable",variableName:"disabled"},adapterSourceDisabled:{dependencyType:"adapterSourceStateVariable",variableName:"disabled"}}),definition({dependencyValues:e,usedDefault:r}){if(e.readOnly&&!e.disabledIgnoresParentReadOnly)return{setValue:{disabled:!0}};if(e.disabledPreliminary!==null&&e.disabledAttr!==null)return{setValue:{disabled:e.disabledPreliminary}};let n=!1,i=!0;return!e.disabledIgnoresParentReadOnly&&e.parentDisabled!==null&&!r.parentDisabled&&(n=n||e.parentDisabled,i=!1),e.sourceCompositeDisabled!==null&&!r.sourceCompositeDisabled&&(n=n||e.sourceCompositeDisabled,i=!1),e.adapterSourceDisabled!==null&&!r.adapterSourceDisabled&&(n=n||e.adapterSourceDisabled,i=!1),i&&e.disabledPreliminary!==null&&!r.disabledPreliminary&&(i=!1,n=e.disabledPreliminary),i?{useEssentialOrDefaultValue:{disabled:!0}}:{setValue:{disabled:n}}}},t.fixed={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,hasEssential:!0,doNotShadowEssential:!0,returnDependencies:()=>({fixedPreliminary:{dependencyType:"stateVariable",variableName:"fixedPreliminary",variablesOptional:!0},fixedAttr:{dependencyType:"attributeComponent",attributeName:"fixed"},parentFixed:{dependencyType:"parentStateVariable",variableName:"fixed"},sourceCompositeFixed:{dependencyType:"sourceCompositeStateVariable",variableName:"fixed"},adapterSourceFixed:{dependencyType:"adapterSourceStateVariable",variableName:"fixed"}}),definition({dependencyValues:e,usedDefault:r}){if(e.fixedPreliminary!==null&&e.fixedAttr!==null)return{setValue:{fixed:e.fixedPreliminary}};let n=!1,i=!0;return e.parentFixed!==null&&!r.parentFixed&&(n=n||e.parentFixed,i=!1),e.sourceCompositeFixed!==null&&!r.sourceCompositeFixed&&(n=n||e.sourceCompositeFixed,i=!1),e.adapterSourceFixed!==null&&!r.adapterSourceFixed&&(n=n||e.adapterSourceFixed,i=!1),i&&e.fixedPreliminary!==null&&!r.fixedPreliminary&&(i=!1,n=e.fixedPreliminary),i?{useEssentialOrDefaultValue:{fixed:!0}}:{setValue:{fixed:n}}}},t.isInactiveCompositeReplacement={defaultValue:!1,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{isInactiveCompositeReplacement:!0}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:{variableName:"isInactiveCompositeReplacement",value:e.isInactiveCompositeReplacement}}]}}},t}static returnNormalizedStateVariableDefinitions({attributeNames:t,numerics:e}){let r=this.returnStateVariableDefinitions({attributeNames:t,numerics:e});if(!r)throw Error(`Error in state variable definitions of ${this.componentType}: returnStateVariableDefinitions did not return anything`);let n=function(o){for(let[l,u]of o.entries())typeof u=="object"&&(o[l]=u.variableName)},i=["returnDependencies","definition","inverseDefinition","stateVariablesDeterminingDependencies","stateVariablesDeterminingArraySizeDependencies","isArray","nDimensions","returnArraySizeDependencies","returnArraySize","returnArrayDependenciesByKey","arrayDefinitionByKey","inverseArrayDefinitionByKey","basedOnArrayKeyStateVariables","markStale","getPreviousDependencyValuesForMarkStale","determineDependenciesImmediately","createWorkspace","workspace","provideEssentialValuesInDefinition","providePreviousValuesInDefinition"],s={};for(let o in r){let l=r[o];if(s[o]=l,l.createWorkspace&&(l.workspace={}),l.additionalStateVariablesDefined){for(let[u,c]of l.additionalStateVariablesDefined.entries()){let p={};for(let f of i)f in l&&(p[f]=l[f]);p.additionalStateVariablesDefined=[...l.additionalStateVariablesDefined],p.additionalStateVariablesDefined[u]=o,n(p.additionalStateVariablesDefined);let m=c;typeof c=="object"&&(m=c.variableName,c=Object.assign({},c),delete c.variableName,Object.assign(p,c)),s[m]=p}n(l.additionalStateVariablesDefined)}}return s}static returnStateVariableInfo({onlyPublic:t=!1,flags:e,onlyForRenderer:r=!1}){let n=this.createAttributesObject({flags:e}),i={},s={},o={};for(let u in n){let c=n[u],p=c.componentType;(!t||c.public)&&(!r||c.forRenderer)&&(i[u]={componentType:p||u,public:c.public})}let l=this.returnNormalizedStateVariableDefinitions({attributeNames:Object.keys(i)});for(let u in l){let c=l[u];if(c.isAlias){o[u]=c.targetVariableName;continue}if((!t||c.public)&&(!r||c.forRenderer)&&(i[u]={componentType:c.componentType,public:c.public,containsComponentNamesToCopy:c.containsComponentNamesToCopy},c.isArray)){if(i[u].isArray=!0,i[u].nDimensions=c.nDimensions===void 0?1:c.nDimensions,i[u].wrappingComponents=c.returnWrappingComponents?c.returnWrappingComponents():[],c.entryPrefixes)for(let p of c.entryPrefixes)s[p]={arrayVariableName:u,nDimensions:c.returnEntryDimensions?c.returnEntryDimensions(p):1,wrappingComponents:c.returnWrappingComponents?c.returnWrappingComponents(p):[]};c.getArrayKeysFromVarName?i[u].getArrayKeysFromVarName=c.getArrayKeysFromVarName:i[u].getArrayKeysFromVarName=dh(i[u].nDimensions)}}return{stateVariableDescriptions:i,arrayEntryPrefixes:s,aliases:o}}get parentName(){if(!(this.ancestors===void 0||this.ancestors.length===0))return this.ancestors[0].componentName}getAllChildrenDownstreamComponentNames(t=!1){let e=Object.keys(this.allChildren),r=Object.keys(this.downstreamDependencies);return t!==!0&&(r=r.filter(n=>this.downstreamDependencies[n].inactive!==!0)),[...e,...r]}get allDescendants(){let t=[];for(let e in this.allChildren){let r=this.allChildren[e].component;t=[...t,e,...r.allDescendants]}return t}async serialize(t={}){let e=!0,r={componentType:this.componentType},n=[];if(e){for(let s of this.definingChildren)typeof s!="object"?n.push(s):n.push(await s.serialize(t));if(this.serializedChildren!==void 0)for(let s of this.serializedChildren)n.push(this.copySerializedComponent(s));n.length>0&&(r.children=n)}let i=this.constructor.createAttributesObject({flags:this.flags});r.attributes={};for(let s in this.attributes){let o=this.attributes[s];if(o.component){let l=i[s];t.copyAll&&(r.attributes[s]={component:await o.component.serialize(t)})}else(s!=="isResponse"||t.copyAll)&&(r.attributes[s]=JSON.parse(JSON.stringify(o)))}return this.essentialState&&Object.keys(this.essentialState).length>0&&(r.state=Re(this.essentialState)),t.copyVariants&&this.state.generatedVariantInfo&&(r.variants={desiredVariant:await this.stateValues.generatedVariantInfo}),r.originalName=this.componentName,r.originalDoenetAttributes=Re(this.doenetAttributes),r.doenetAttributes=Re(this.doenetAttributes),r.originalAttributes=Re(r.attributes),delete r.doenetAttributes.prescribedName,delete r.doenetAttributes.assignNames,r}copySerializedComponent(t){if(typeof t!="object")return t;let e=[];if(t.children!==void 0)for(let n of t.children)e.push(this.copySerializedComponent(n));let r={componentType:t.componentType,originalName:t.componentName,originalNameFromSerializedComponent:!0,children:e,state:{},doenetAttributes:{}};return t.doenetAttributes!==void 0&&(r.originalDoenetAttributes=Re(t.doenetAttributes),r.doenetAttributes=Re(t.doenetAttributes),r.originalAttributes=Re(t.attributes),r.attributes=Re(t.attributes),delete r.doenetAttributes.prescribedName,delete r.doenetAttributes.assignNames),t.state!==void 0&&Object.assign(r.state,t.state),r}static get nAdapters(){return this.adapters.length}getAdapter(t){if(t>=this.constructor.adapters.length)return;let e=this.constructor.adapters[t],r,n,i;typeof e=="string"?r=e:(r=e.stateVariable,n=e.componentType,i=e.substituteForPrimaryStateVariable);let s=this.state[r];if(s===void 0||!s.public&&!n)throw Error("Invalid adapter "+r+" in "+this.componentType);return n===void 0&&(n=s.componentType),{componentType:n,downstreamDependencies:{[this.componentName]:[{dependencyType:"adapter",adapterVariable:r,adapterTargetIdentity:{componentName:this.componentName,componentType:this.componentType},substituteForPrimaryStateVariable:i}]}}}static getAdapterComponentType(t,e){if(t>=this.adapters.length)return;let r=this.adapters[t],n,i;if(typeof r=="string"?n=r:(n=r.stateVariable,i=r.componentType),i===void 0){let o=e[this.componentType].stateVariableDescriptions[n];if(!o)throw Error("Invalid adapter "+n+" in "+this.componentType);if(i=o.componentType,!i)throw Error(`Couldn't get adapter component type for ${n} of componentType ${this.componentType}`)}return i}static determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e}){let r=t.variants?.numberOfVariants;if(r!==void 0)return{success:!0,numberOfVariants:r};let n=_a({serializedComponents:t.children,componentInfoObjects:e});t.variants===void 0&&(t.variants={}),t.variants.descendantVariantComponents=n,r=1;let i=[];for(let s of n){let l=e.allComponentClasses[s.componentType].determineNumberOfUniqueVariants({serializedComponent:s,componentInfoObjects:e});if(!l.success)return{success:!1};i.push(l.numberOfVariants),r*=l.numberOfVariants}return t.variants.numberOfVariants=r,t.variants.uniqueVariantData={numberOfVariantsByDescendant:i},{success:!0,numberOfVariants:r}}static getUniqueVariant({serializedComponent:t,variantIndex:e,componentInfoObjects:r}){let n=t.variants?.numberOfVariants;if(n===void 0)return{success:!1};if(!Number.isInteger(e)||e<1||e>n)return{success:!1};let i=!1,s=t.variants.uniqueVariantData.numberOfVariantsByDescendant,o=t.variants.descendantVariantComponents,l=[];if(o.length>0){let c=ka({numberOfOptionsByIndex:s,maxNumber:e})[e-1].map(p=>p+1);for(let p=0;p<s.length;p++)if(s[p]>1){let m=o[p],d=r.allComponentClasses[m.componentType].getUniqueVariant({serializedComponent:m,variantIndex:c[p],componentInfoObjects:r});if(!d.success)return{success:!1};l.push(d.desiredVariant),i=!0}else l.push({})}let u={index:e};return i&&(u.subvariants=l),{success:!0,desiredVariant:u}}};T(J,"componentType","_base"),T(J,"childGroupOfComponentTypeData"),T(J,"childGroupIndsByNameData"),T(J,"adapters",[]);var re=class extends J{};T(re,"componentType","_inline");var Tr=class extends re{static returnChildGroups(){return[{group:"textLike",componentTypes:["string","text","_singleCharacterInline","_inlineRenderInlineChildren"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:this.componentType,hasEssential:!0,stateVariablesPrescribingAdditionalAttributes:{fixed:"fixed"},returnDependencies:()=>({textLikeChildren:{dependencyType:"child",childGroups:["textLike"],variableNames:["text"]}}),defaultValue:"",set:e=>e===null?"":String(e),definition:function({dependencyValues:e}){if(e.textLikeChildren.length===0)return{useEssentialOrDefaultValue:{value:!0}};let r="";for(let n of e.textLikeChildren)typeof n=="string"?r+=n:r+=n.stateValues.text;return{setValue:{value:r}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){let n=r.textLikeChildren.length;return n>1?{success:!1}:n===1?{success:!0,instructions:[{setDependency:"textLikeChildren",desiredValue:e.value,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"value",value:e.value===null?"":String(e.value)}]}}},t.text={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:({dependencyValues:e})=>({setValue:{text:e.value}}),inverseDefinition:({desiredStateVariableValues:e})=>({success:!0,instructions:[{setDependency:"value",desiredValue:e.text}]})},t}};T(Tr,"componentType","text"),T(Tr,"includeBlankStringChildren",!0),T(Tr,"variableForPlainMacro","value");var Fa=class extends re{static returnChildGroups(){return[{group:"inlines",componentTypes:["_inline"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:this.componentType,returnDependencies:()=>({inlineChildren:{dependencyType:"child",childGroups:["inlines"],variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r="";for(let n of e.inlineChildren)typeof n!="object"?r+=n.toString():typeof n.stateValues.text=="string"&&(r+=n.stateValues.text);return{setValue:{value:r}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:({dependencyValues:e})=>({setValue:{text:e.value}})},t}};T(Fa,"componentType","_textOrInline"),T(Fa,"renderChildren",!0),T(Fa,"includeBlankStringChildren",!0);var Ae=class extends J{constructor(t){super(t);this.replacementsWorkspace={}}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.replacements={returnDependencies:()=>({replacements:{dependencyType:"replacement"}}),definition:({dependencyValues:e})=>({setValue:{replacements:e.replacements}})},t.recursiveReplacements={returnDependencies:()=>({recursiveReplacements:{dependencyType:"replacement",recursive:!0}}),definition:({dependencyValues:e})=>({setValue:{recursiveReplacements:e.recursiveReplacements}})},t.fullRecursiveReplacements={returnDependencies:()=>({recursiveReplacements:{dependencyType:"replacement",recursive:!0,recurseNonStandardComposites:!0}}),definition:({dependencyValues:e})=>({setValue:{fullRecursiveReplacements:e.recursiveReplacements}})},t}static createSerializedReplacements(){return{replacements:[]}}static calculateReplacementChanges(){return[]}get allPotentialRendererTypes(){let t=super.allPotentialRendererTypes;for(let e in this.allChildren){let r=this.allChildren[e].component;for(let n of r.allPotentialRendererTypes)t.includes(n)||t.push(n)}if(this.replacements){for(let e of this.replacements)if(typeof e=="object")for(let r of e.allPotentialRendererTypes)t.includes(r)||t.push(r)}return t}};T(Ae,"componentType","_composite"),T(Ae,"rendererType");function hh({variantIndex:a,serializedComponent:t,componentInfoObjects:e}){let r=t.variants?.descendantVariantComponents;if(r===void 0)return{success:!1};let n=r.map(o=>o.variants.numberOfVariants),i=ka({numberOfOptionsByIndex:n,maxNumber:a})[a-1],s=[];for(let[o,l]of r.entries()){let c=e.allComponentClasses[l.componentType].getUniqueVariant({serializedComponent:l,variantIndex:i[o]+1,componentInfoObjects:e});if(c.success)s.push(c.desiredVariant);else return{succss:!1}}return{success:!0,desiredVariants:s}}function kr({serializedComponent:a,sharedParameters:t,descendantVariantComponents:e}){let r,n;if(a.variants&&(n=a.variants.desiredVariant),n?.seed!==void 0?r=n.seed.toString():r=t.variantRng().toString().slice(2),t.variantSeed=r,t.variantRng=new t.rngClass(t.variantSeed),n?.subvariants&&e)for(let i in n.subvariants){let s=n.subvariants[i],o=e[i];if(o===void 0)break;o.variants.desiredVariant=s}}var Dt=class extends Ae{static keepChildrenSerialized({serializedComponent:t}){return t.children===void 0?[]:Object.keys(t.children)}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.rendered={createComponentOfType:"boolean",createStateVariable:"rendered",defaultValue:this.renderedDefault,public:!0},e.isResponse={leaveRaw:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.serializedChildren={returnDependencies:()=>({serializedChildren:{dependencyType:"serializedChildren",doNotProxy:!0}}),definition:function({dependencyValues:e}){return{setValue:{serializedChildren:e.serializedChildren}}}},t.newNamespace={returnDependencies:()=>({newNamespace:{dependencyType:"attributePrimitive",attributeName:"newNamespace"}}),definition({dependencyValues:e}){return{setValue:{newNamespace:e.newNamespace}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={returnDependencies:({sharedParameters:e,componentInfoObjects:r})=>({variantSeed:{dependencyType:"value",value:e.variantSeed},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(r.componentTypesCreatingVariants),variableNames:["isVariantComponent","generatedVariantInfo"],useReplacementsForComposites:!0,recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfEncounteredComposites:!0}}),definition({dependencyValues:e,componentName:r}){let n={seed:e.variantSeed,meta:{createdBy:r}},i=n.subvariants=[];for(let s of e.variantDescendants)s.stateValues.isVariantComponent?i.push(s.stateValues.generatedVariantInfo):s.stateValues.generatedVariantInfo&&i.push(...s.stateValues.generatedVariantInfo.subvariants);return{setValue:{generatedVariantInfo:n}}}},t}static async createSerializedReplacements({component:t,componentInfoObjects:e,alwaysCreateReplacements:r,flags:n}){if(await t.stateValues.rendered||r){let i=Re(await t.state.serializedChildren.value),s=t.attributes.newNamespace&&t.attributes.newNamespace.primitive;if("isResponse"in t.attributes)for(let l of i){if(typeof l!="object")continue;let u=Ze({attributes:{isResponse:t.attributes.isResponse},componentType:l.componentType,componentInfoObjects:e,compositeCreatesNewNamespace:s,flags:n});l.attributes||(l.attributes={}),Object.assign(l.attributes,u)}return{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:i,parentName:t.componentName,parentCreatesNewNamespace:s,componentInfoObjects:e,originalNamesAreConsistent:s||!t.doenetAttributes.assignNames}).serializedComponents}}else return{replacements:[]}}static async setUpVariant({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r}){kr({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r})}get allPotentialRendererTypes(){let t=super.allPotentialRendererTypes,e=this.potentialRendererTypesFromSerializedComponents(this.serializedChildren);for(let r of e)t.includes(r)||t.push(r);return t}};T(Dt,"componentType","template"),T(Dt,"treatAsComponentForRecursiveReplacements",!0),T(Dt,"includeBlankStringChildren",!0),T(Dt,"renderedDefault",!1),T(Dt,"assignNamesToReplacements",!0),T(Dt,"originalNamesAreConsistent",!0),T(Dt,"createsVariants",!0);import ut from"math-expressions";var ot=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.format={createComponentOfType:"text",createStateVariable:"format",defaultValue:"text",public:!0,toLowerCase:!0,validValues:["text","latex"]},e.simplify={createComponentOfType:"text",createStateVariable:"simplify",defaultValue:"none",public:!0,toLowerCase:!0,valueTransformations:{true:"full"},validValues:["none","full","numbers","numberspreserveorder"]},e.expand={createComponentOfType:"boolean",createStateVariable:"expand",defaultValue:!1,public:!0},e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:10,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e.renderMode={createComponentOfType:"text",createStateVariable:"renderMode",defaultValue:"inline",public:!0,forRenderer:!0},e.unordered={createComponentOfType:"boolean"},e.createVectors={createComponentOfType:"boolean",createStateVariable:"createVectors",defaultValue:!1,public:!0},e.createIntervals={createComponentOfType:"boolean",createStateVariable:"createIntervals",defaultValue:!1,public:!0},e.functionSymbols={createComponentOfType:"textList",createStateVariable:"functionSymbols",defaultValue:["f","g"],public:!0},e.targetsAreFunctionSymbols={createComponentOfType:"textList",createStateVariable:"targetsAreFunctionSymbols",defaultValue:[]},e.splitSymbols={createComponentOfType:"boolean",createStateVariable:"splitSymbols",defaultValue:!0,public:!0},e.groupCompositeReplacements={createPrimitiveOfType:"boolean",createStateVariable:"groupCompositeReplacements",defaultValue:!0},e}static returnChildGroups(){return[{group:"maths",componentTypes:["math"]},{group:"strings",componentTypes:["string"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.valueShadow={defaultValue:ut.fromAst("\uFF3F"),hasEssential:!0,essentialVarName:"value",returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{valueShadow:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"valueShadow",value:e.valueShadow}]}}},t.unordered={defaultValue:!1,public:!0,componentType:"boolean",hasEssential:!0,returnDependencies:()=>({unorderedAttr:{dependencyType:"attributeComponent",attributeName:"unordered",variableNames:["value"]},mathChildren:{dependencyType:"child",childGroups:["maths"],variableNames:["unordered"]}}),definition({dependencyValues:e}){return e.unorderedAttr===null?e.mathChildren.length>0?{setValue:{unordered:e.mathChildren.every(n=>n.stateValues.unordered)}}:{useEssentialOrDefaultValue:{unordered:!0}}:{setValue:{unordered:e.unorderedAttr.stateValues.value}}}},t.codePre={returnDependencies:()=>({stringChildren:{dependencyType:"child",childGroups:["strings"]}}),definition({dependencyValues:e}){let r="math",n=!1;do{n=!1;for(let i of e.stringChildren)if(i.includes(r)===!0){n=!0,r+="m";break}}while(n);return{setValue:{codePre:r}}}},t.mathChildrenFunctionSymbols={returnDependencies:()=>({targetsAreFunctionSymbols:{dependencyType:"stateVariable",variableName:"targetsAreFunctionSymbols"},mathChildren:{dependencyType:"child",childGroups:["maths"]}}),definition({dependencyValues:e}){let r=[];if(e.mathChildren.compositeReplacementRange){for(let n of e.mathChildren.compositeReplacementRange)if(e.targetsAreFunctionSymbols.includes(n.target))for(let i=n.firstInd;i<=n.lastInd;i++)r.push(i)}return{setValue:{mathChildrenFunctionSymbols:r}}}},t.expressionWithCodes={hasEssential:!0,doNotShadowEssential:!0,returnDependencies:()=>({stringMathChildren:{dependencyType:"child",childGroups:["strings","maths"]},stringChildren:{dependencyType:"child",childGroups:["strings"]},mathChildren:{dependencyType:"child",childGroups:["maths"]},format:{dependencyType:"stateVariable",variableName:"format"},codePre:{dependencyType:"stateVariable",variableName:"codePre"},functionSymbols:{dependencyType:"stateVariable",variableName:"functionSymbols"},mathChildrenFunctionSymbols:{dependencyType:"stateVariable",variableName:"mathChildrenFunctionSymbols"},splitSymbols:{dependencyType:"stateVariable",variableName:"splitSymbols"},groupCompositeReplacements:{dependencyType:"stateVariable",variableName:"groupCompositeReplacements"}}),set:e=>e===null?null:se(e),definition:rq,async inverseDefinition({desiredStateVariableValues:e,dependencyValues:r,stateValues:n,componentName:i}){let s=e.expressionWithCodes,o=[{setEssentialValue:"expressionWithCodes",value:s}],l=r.stringChildren.length;if(l===0)return{success:!1};if(r.mathChildren.length===0){let u;await n.format==="latex"?u=s.toLatex():u=s.toString(),o.push({setDependency:"stringChildren",desiredValue:u,childIndex:0,variableIndex:0,ignoreChildChangeForComponent:!0});for(let c=1;c<l;c++)o.push({setDependency:"stringChildren",desiredValue:"",childIndex:c,variableIndex:0,ignoreChildChangeForComponent:!0})}else{let u;await n.format==="latex"?u=s.toLatex():u=s.toString();for(let[c,p]of(await n.codesAdjacentToStrings).entries()){let m=u;Object.keys(p).length===0?o.push({setDependency:"stringChildren",desiredValue:"",childIndex:c,variableIndex:0,ignoreChildChangeForComponent:!0}):(p.prevCode&&(m=m.split(p.prevCode)[1]),p.nextCode&&(m=m.split(p.nextCode)[0]),o.push({setDependency:"stringChildren",desiredValue:m,childIndex:c,variableIndex:0,ignoreChildChangeForComponent:!0}))}}return{success:!0,instructions:o}}},t.mathChildrenWithCanBeModified={returnDependencies:()=>({mathChildren:{dependencyType:"child",childGroups:["maths"],variableNames:["value","canBeModified"]}}),definition:({dependencyValues:e})=>({setValue:{mathChildrenWithCanBeModified:e.mathChildren}})},t.unnormalizedValue={returnDependencies:()=>({mathChildren:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]},stringChildren:{dependencyType:"child",childGroups:["strings"],variableNames:["value"]},expressionWithCodes:{dependencyType:"stateVariable",variableName:"expressionWithCodes"},codePre:{dependencyType:"stateVariable",variableName:"codePre"},valueShadow:{dependencyType:"stateVariable",variableName:"valueShadow"}}),set:se,defaultValue:ut.fromAst("\uFF3F"),definition:nq,inverseDefinition:sq},t.value={public:!0,componentType:this.componentType,additionalAttributeComponentsToShadow:["unordered"],stateVariablesPrescribingAdditionalAttributes:{fixed:"fixed",displayDigits:"displayDigits",displayDecimals:"displayDecimals",displaySmallAsZero:"displaySmallAsZero",simplify:"simplify",expand:"expand"},returnDependencies:()=>({unnormalizedValue:{dependencyType:"stateVariable",variableName:"unnormalizedValue"},simplify:{dependencyType:"stateVariable",variableName:"simplify"},expand:{dependencyType:"stateVariable",variableName:"expand"},createVectors:{dependencyType:"stateVariable",variableName:"createVectors"},createIntervals:{dependencyType:"stateVariable",variableName:"createIntervals"}}),definition:function({dependencyValues:e}){let r=e.unnormalizedValue,{simplify:n,expand:i,createVectors:s,createIntervals:o}=e;return r=Wr({value:r,simplify:n,expand:i,createVectors:s,createIntervals:o}),{setValue:{value:r}}},inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"unnormalizedValue",desiredValue:e.value}]}}},t.number={public:!0,componentType:"number",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){let r=e.value.evaluate_to_constant();return r===null&&(r=NaN),{setValue:{number:r}}},inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"value",desiredValue:ut.fromAst(e.number)}]}}},t.isNumber={public:!0,componentType:"boolean",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{setValue:{isNumber:Number.isFinite(e.value.tree)}}}},t.isNumeric={public:!0,componentType:"boolean",returnDependencies:()=>({number:{dependencyType:"stateVariable",variableName:"number"}}),definition:function({dependencyValues:e}){return{setValue:{isNumeric:Number.isFinite(e.number)}}}},t.valueForDisplay={returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"},simplify:{dependencyType:"stateVariable",variableName:"simplify"},expand:{dependencyType:"stateVariable",variableName:"expand"}}),definition:function({dependencyValues:e,usedDefault:r}){let n=Lt({value:e.value,dependencyValues:e,usedDefault:r});return{setValue:{valueForDisplay:Wr({value:n,simplify:e.simplify,expand:e.expand})}}}},t.latex={public:!0,componentType:"text",returnDependencies:()=>({valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"}}),definition:function({dependencyValues:e}){let r;try{r=e.valueForDisplay.toLatex()}catch(n){r="\uFF3F"}return{setValue:{latex:r}}}},t.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){return{setValue:{latexWithInputChildren:[e.latex]}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"},value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){let r;try{r=e.valueForDisplay.toString()}catch(n){r="\uFF3F"}return{setValue:{text:r}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r}){let n=la({functionSymbols:await r.functionSymbols,splitSymbols:await r.splitSymbols}),i;try{i=n(e.text)}catch(s){return{success:!1}}return{success:!0,instructions:[{setDependency:"value",desiredValue:i}]}}},t.codesAdjacentToStrings={returnDependencies:()=>({stringMathChildren:{dependencyType:"child",childGroups:["strings","maths"]},codePre:{dependencyType:"stateVariable",variableName:"codePre"},format:{dependencyType:"stateVariable",variableName:"format"}}),definition:aq},t.canBeModified={additionalStateVariablesDefined:["constantChildIndices","codeForExpression","inverseMaps","template","mathChildrenMapped"],returnDependencies:()=>({mathChildrenModifiable:{dependencyType:"child",childGroups:["maths"],variableNames:["canBeModified"]},expressionWithCodes:{dependencyType:"stateVariable",variableName:"expressionWithCodes"},modifyIndirectly:{dependencyType:"stateVariable",variableName:"modifyIndirectly"},fixed:{dependencyType:"stateVariable",variableName:"fixed"},codePre:{dependencyType:"stateVariable",variableName:"codePre"}}),definition:iq},t.mathChildrenByVectorComponent={returnDependencies:()=>({codePre:{dependencyType:"stateVariable",variableName:"codePre"},mathChildren:{dependencyType:"child",childGroups:["maths"]},expressionWithCodes:{dependencyType:"stateVariable",variableName:"expressionWithCodes"}}),definition:function({dependencyValues:e}){if(e.expressionWithCodes===null)return{setValue:{mathChildrenByVectorComponent:null}};let r=e.expressionWithCodes.tree,n=e.mathChildren.length;if(n===0||!Array.isArray(r)||!["tuple","vector"].includes(r[0]))return{setValue:{mathChildrenByVectorComponent:null}};let i={},s=0,o=e.codePre+s;for(let l=1;l<r.length;l++){let u=r[l],c=i[l]=[];if(Array.isArray(u)){let p=vr(u);for(;p.includes(o);)c.push(s),s++,o=e.codePre+s}else u===o&&(c.push(s),s++,o=e.codePre+s);if(s>=n)break}return{setValue:{mathChildrenByVectorComponent:i}}}},t.nDimensions={public:!0,componentType:"integer",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition({dependencyValues:e}){let r=1,n=e.value.tree;return Array.isArray(n)&&["vector","tuple","list"].includes(n[0])&&(r=n.length-1),{setValue:{nDimensions:r}}}},t.xs={public:!0,componentType:"math",isArray:!0,entryPrefixes:["x"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey(){return{globalDependencies:{value:{dependencyType:"stateVariable",variableName:"value"}}}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r,arraySize:n}){let i=e.value.tree,s=Array.isArray(i)&&["vector","tuple","list"].includes(i[0]),o={};if(s)for(let l=0;l<n[0];l++)o[l]=ut.fromAst(i[l+1]);else o[0]=e.value;return{setValue:{xs:o}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,stateValues:r,workspace:n,arraySize:i}){n.desiredXs||(n.desiredXs=[]);for(let l=0;l<i[0];l++)e.xs[l]!==void 0?n.desiredXs[l]=se(e.xs[l]):n.desiredXs[l]===void 0&&(n.desiredXs[l]=(await r.xs)[l]);let s;if(i[0]>1){let l=(await r.value).tree[0];s=ut.fromAst([l,...n.desiredXs.map(u=>u.tree)])}else s=n.desiredXs[0];return{success:!0,instructions:[{setDependency:"value",desiredValue:s}]}}},t.x={isAlias:!0,targetVariableName:"x1"},t.y={isAlias:!0,targetVariableName:"x2"},t.z={isAlias:!0,targetVariableName:"x3"},t}};T(ot,"componentType","math"),T(ot,"primaryStateVariableForDefinition","value"),T(ot,"variableForPlainMacro","value"),T(ot,"descendantCompositesMustHaveAReplacement",!0),T(ot,"descendantCompositesDefaultReplacementType","math"),T(ot,"adapters",["number","text",{componentType:"subsetOfReals",stateVariable:"value",substituteForPrimaryStateVariable:"subsetValue"}]);function rq({dependencyValues:a,changes:t}){if(!("stringMathChildren"in t&&t.stringMathChildren.componentIdentitiesChanged||"format"in t||"splitSymbols"in t||"functionSymbols"in t||"mathChildrenFunctionSymbols"in t))return{useEssentialOrDefaultValue:{expressionWithCodes:!0}};if(a.stringMathChildren.length===0)return{setValue:{expressionWithCodes:null}};let e="",r=0,n="",i=a.stringMathChildren.compositeReplacementRange,s,o,l,u;a.groupCompositeReplacements&&i.length>0&&(l=0,u=i[l].firstInd);for(let[m,f]of a.stringMathChildren.entries()){if(s===void 0&&m===u){s=l,o=i[l].lastInd,n="";let d=o===m;if(!d){for(let h=m;h<=o;h++)if(typeof a.stringMathChildren[h]=="string"){d=!0;break}}d&&(i.length>s+1?(l=s+1,u=i[l].firstInd):(l=void 0,u=void 0),s=void 0,o=void 0)}if(typeof f=="string")e+=" "+f+" ";else{let d=a.codePre+r;r++;let h;a.format==="latex"?h="\\var{"+d+"}":h=" "+d+" ",s!==void 0?(n&&(n+=","),n+=h):e+=h}if(m===o){let d=e.trimEnd(),h=!1;if(d.length===0)h=!0;else{let y=d[d.length-1];if(!["{","[","(","|",","].includes(y))h=!0;else{let b=a.stringMathChildren[m+1];if(typeof b!="string")h=!0;else{let g=b.trimStart();if(g.length===0)h=!0;else{let v=g[0];a.format==="latex"&&v==="\\"&&g.length>1&&(v=g[1]),["}","]",")","|",","].includes(v)||(h=!0)}}}}h&&(n="("+n+")"),e+=n,n="",i.length>s+1?(l=s+1,u=i[l].firstInd):(l=void 0,u=void 0),s=void 0,o=void 0}}let c=null,p=[...a.functionSymbols];if(p.push(...a.mathChildrenFunctionSymbols.map(m=>a.codePre+m)),e==="")c=ut.fromAst("\uFF3F");else if(a.format==="text"){let m=la({functionSymbols:p,splitSymbols:a.splitSymbols});try{c=m(e)}catch(f){c=ut.fromAst("\uFF3F"),console.log("Invalid value for a math of text format: "+e)}}else if(a.format==="latex"){let m=Jl({functionSymbols:p,splitSymbols:a.splitSymbols});try{c=m(e)}catch(f){c=ut.fromAst("\uFF3F"),console.log("Invalid value for a math of latex format: "+e)}}return{setValue:{expressionWithCodes:c},setEssentialValue:{expressionWithCodes:c}}}function nq({dependencyValues:a}={}){if(a.expressionWithCodes===null)return{setValue:{unnormalizedValue:a.valueShadow}};let t={};for(let[r,n]of a.mathChildren.entries())t[a.codePre+r]=n.stateValues.value;let e=a.expressionWithCodes;return a.mathChildren.length>0&&(e=e.substitute(t)),e=ut.fromAst(u2(e.tree)),{setValue:{unnormalizedValue:e}}}function aq({dependencyValues:a}){let t=[],e;for(let[r,n]of a.stringMathChildren.entries())if(typeof n=="string"){let i=a.stringMathChildren[r+1];if(i!==void 0&&typeof i=="string")continue;let s={};if(e!==void 0&&(a.format==="latex"?s.prevCode="\\var{"+a.codePre+e+"}":s.prevCode=a.codePre+e),i!==void 0){let o=0;e!==void 0&&(o=e+1),a.format==="latex"?s.nextCode="\\var{"+a.codePre+o+"}":s.nextCode=a.codePre+o}t.push(s)}else e===void 0?e=0:e++;return{setValue:{codesAdjacentToStrings:t}}}function iq({dependencyValues:a}){if(!a.modifyIndirectly||a.fixed)return{setValue:{canBeModified:!1,constantChildIndices:null,codeForExpression:null,inverseMaps:null,template:null,mathChildrenMapped:null}};if(a.mathChildrenModifiable.length===0)return{setValue:{canBeModified:!0,constantChildIndices:null,codeForExpression:null,inverseMaps:null,template:null,mathChildrenMapped:null}};let t=[],e=[],r=[],n={};for(let[l,u]of a.mathChildrenModifiable.entries()){let c=a.codePre+l;u.stateValues.canBeModified===!0?(t.push(l),e.push(c)):(r.push(c),n[c]=l)}let i=a.codePre+"expr",s=ut.utils.unflattenLeft(a.expressionWithCodes.tree),o=_x(s,e,i,r);if(o.foundLinear){let l={},u=o.template,c=new Set;for(let p in o.mappings){l[p]=o.mappings[p];let m=l[p].mathChildSub;if(m){let f=t[e.indexOf(m)];l[p].mathChildInd=f,c.add(Number(f))}}return c.has=c.has.bind(c),{setValue:{canBeModified:!0,constantChildIndices:n,codeForExpression:i,inverseMaps:l,template:u,mathChildrenMapped:c}}}return{setValue:{canBeModified:!1,constantChildIndices:null,codeForExpression:null,inverseMaps:null,template:null,mathChildrenMapped:null}}}function _x(a,t,e,r=[],n=[]){let i=ut.variables(a);if(i.every(l=>!t.includes(l))&&i.every(l=>!r.includes(l))){let l={},u="x"+n.join("_");return l[u]={result:ut.fromAst(e).simplify(),components:n},{foundLinear:!0,mappings:l,template:u}}if(!Array.isArray(a))return bs(a,t,e,n);let s=a[0],o=a.slice(1);if(s==="tuple"||s==="vector"||s==="list"){let l={mappings:{},template:[s]},u=0;for(let c=0;c<o.length;c++){let p=[...n,c],m=_x(o[c],t,e,r,p);m.foundLinear?(u++,l.mappings=Object.assign(l.mappings,m.mappings),l.template.push(m.template)):l.template.push("x"+p.join("_"))}return u===0?{foundLinear:!1}:(l.foundLinear=!0,l)}else return bs(a,t,e,n)}function bs(a,t,e,r=[]){if(typeof a=="string"&&t.includes(a)){let s={},o="x"+r.join("_");return s[o]={result:ut.fromAst(e).simplify(),components:r,mathChildSub:a},{foundLinear:!0,mappings:s,template:o}}if(!Array.isArray(a))return{foundLinear:!1};let n=a[0],i=a.slice(1);return n==="-"?(e=["-",e],bs(i[0],t,e,r)):n==="+"?ut.variables(i[0]).every(s=>!t.includes(s))?(e=["+",e,["-",i[0]]],bs(i[1],t,e,r)):ut.variables(i[1]).every(s=>!t.includes(s))?(e=["+",e,["-",i[1]]],bs(i[0],t,e,r)):{foundLinear:!1}:n==="*"?ut.variables(i[0]).every(s=>!t.includes(s))?(e=["/",e,i[0]],bs(i[1],t,e,r)):ut.variables(i[1]).every(s=>!t.includes(s))?(e=["/",e,i[1]],bs(i[0],t,e,r)):{foundLinear:!1}:n==="/"?ut.variables(i[1]).every(s=>!t.includes(s))?(e=["*",e,i[1]],bs(i[0],t,e,r)):{foundLinear:!1}:{foundLinear:!1}}async function sq({desiredStateVariableValues:a,dependencyValues:t,stateValues:e,workspace:r,overrideFixed:n,componentName:i}){if(!await e.canBeModified&&!n)return{success:!1};let s=t.mathChildren,o=t.stringChildren.length;if(s.length===1&&o===0)return{success:!0,instructions:[{setDependency:"mathChildren",desiredValue:a.unnormalizedValue,childIndex:0,variableIndex:0}]};let l=se(a.unnormalizedValue),u=await Ql({desiredValue:l,stateValues:e,variableName:"value",workspace:r}),c=u.vectorComponentsNotAffected;if(l=u.desiredValue,s.length===0){let h=[];return o>0?h.push({setDependency:"expressionWithCodes",desiredValue:l}):h.push({setDependency:"valueShadow",desiredValue:l}),{success:!0,instructions:h}}let p=await oq({expression:l,stateValues:e});if(!p)return{success:!1};let m=[],f=[];if(c&&await e.mathChildrenByVectorComponent){let h=await e.mathChildrenByVectorComponent;for(let y of c)h[y]&&f.push(...h[y])}let d=await e.mathChildrenWithCanBeModified;for(let[h,y]of s.entries())if(e.mathChildrenMapped.has(h)&&d[h].stateValues.canBeModified){if(!f.includes(h)){let b=p[h],g={},v=!1,A=await e.constantChildIndices;for(let C in A){let S=A[C];g[C]=s[S].stateValues.value,v=!0}v&&(b=b.substitute(g)),b=b.simplify(),m.push({setDependency:"mathChildren",desiredValue:b,childIndex:h,variableIndex:0})}delete p[h]}if(o>0){let g=function(A){return typeof A=="string"&&A.substring(0,b)===y},v=function(A){return Array.isArray(A)?vr(A.slice(1)).some(g):g(A)},h=t.expressionWithCodes,y=t.codePre,b=y.length;if(["vector","tuple","list"].includes(h.tree[0])&&!h.tree.slice(1).every(v)){let A=await e.inverseMaps;for(let C in p){let S=A[C];if(S.mathChildInd!==void 0)continue;let w=S.components;h=h.substitute_component(w,p[C])}m.push({setDependency:"expressionWithCodes",desiredValue:h})}}return{success:!0,instructions:m}}async function oq({expression:a,stateValues:t}){let e=await t.template,r=ut.utils.match(a.tree,e);if(!r&&(r=ut.utils.match(a.tuples_to_vectors().tree,ut.fromAst(e).tuples_to_vectors().tree),!r&&(r=ut.utils.match(a.to_intervals().tree,ut.fromAst(e).to_intervals().tree),!r&&(r=ut.utils.match(a.tuples_to_vectors().to_intervals().tree,ut.fromAst(e).tuples_to_vectors().to_intervals().tree),!r))))return!1;let n={};for(let i in r){let s={};s[await t.codeForExpression]=r[i];let o=(await t.inverseMaps)[i];if(o!==void 0){let l=i;o.mathChildInd!==void 0&&(l=o.mathChildInd),n[l]=o.result.substitute(s),n[l]=Wr({value:n[l],simplify:await t.simplify,expand:await t.expand,createVectors:await t.createVectors,createIntervals:await t.createIntervals})}}return n}var yh=class extends Tr{};T(yh,"componentType","columns"),T(yh,"rendererType","text");var bh=class extends Fa{};T(bh,"componentType","title"),T(bh,"rendererType","textOrInline");var gh=class extends ot{};T(gh,"componentType","rightHandSide"),T(gh,"rendererType","math");var vh=class extends Fa{};T(vh,"componentType","description"),T(vh,"rendererType");var p2=class extends Dt{};T(p2,"componentType","else");var m2=class extends Dt{};T(m2,"componentType","externalContent");var y2={};st(y2,{M:()=>ja,Me:()=>d2,Men:()=>h2});import lq from"math-expressions";var ja=class extends re{static returnChildGroups(){return[{group:"stringsTextsAndMaths",componentTypes:["string","text","math","mathList","m","mathInput"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.latex={public:!0,componentType:"text",defaultValue:"",hasEssential:!0,returnDependencies:()=>({stringTextMathChildren:{dependencyType:"child",childGroups:["stringsTextsAndMaths"],variableNames:["latex","text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){if(e.stringTextMathChildren.length===0)return{useEssentialOrDefaultValue:{latex:!0}};let r="";for(let n of e.stringTextMathChildren)typeof n=="string"?r+=n:n.stateValues.latex?r+=n.stateValues.latex:n.stateValues.text&&(r+=n.stateValues.text);return{setValue:{latex:r}}}},t.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({stringTextMathChildren:{dependencyType:"child",childGroups:["stringsTextsAndMaths"],variableNames:["latex","text"],variablesOptional:!0},latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e,componentInfoObjects:r}){if(e.stringTextMathChildren.length===0)return{setValue:{latexWithInputChildren:[e.latex]}};let n=[],i="",s=0;for(let o of e.stringTextMathChildren)typeof o=="string"?i+=o:r.isInheritedComponentType({inheritedComponentType:o.componentType,baseComponentType:"mathInput"})?(i.length>0&&(n.push(i),i=""),n.push(s),s++):o.stateValues.latex?i+=o.stateValues.latex:o.stateValues.text&&(i+=o.stateValues.text);return i.length>0&&n.push(i),{setValue:{latexWithInputChildren:n}}}},t.renderMode={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{renderMode:"inline"}})},t.text={returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){let r;try{r=lq.fromAst(ch.convert(e.latex))}catch(n){return{setValue:{text:e.latex}}}return{setValue:{text:r.toString()}}}},t}};T(ja,"componentType","m"),T(ja,"rendererType","math"),T(ja,"includeBlankStringChildren",!0),T(ja,"primaryStateVariableForDefinition","latex");var d2=class extends ja{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.renderMode.definition=()=>({setValue:{renderMode:"display"}}),t}};T(d2,"componentType","me");var h2=class extends ja{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.renderMode.definition=()=>({setValue:{renderMode:"numbered"}}),t.equationTag={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({equationCounter:{dependencyType:"counter",counterName:"equation"}}),definition({dependencyValues:e}){return{setValue:{equationTag:String(e.equationCounter)}}}},t}};T(h2,"componentType","men");var v2={};st(v2,{Md:()=>tu,Mdn:()=>b2,Mrow:()=>g2});import uq from"math-expressions";var tu=class extends re{static returnChildGroups(){return[{group:"mrows",componentTypes:["mrow"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mrowChildNames={forRenderer:!0,returnDependencies:()=>({mrowChildren:{dependencyType:"child",childGroups:["mrows"]}}),definition:({dependencyValues:e})=>({setValue:{mrowChildNames:e.mrowChildren.map(r=>r.componentName)}})},t.latex={public:!0,componentType:"text",defaultValue:"",hasEssential:!0,shadowVariable:!0,returnDependencies:()=>({mrowChildren:{dependencyType:"child",childGroups:["mrows"],variableNames:["latex","hide","equationTag","numbered"]}}),definition:function({dependencyValues:e}){if(e.mrowChildren.length>0){let r="";for(let n of e.mrowChildren)n.stateValues.hide||(r.length>0&&(r+="\\\\"),n.stateValues.numbered?r+=`\\tag{${n.stateValues.equationTag}}`:r+="\\notag ",r+=n.stateValues.latex);return{setValue:{latex:r}}}else return{useEssentialOrDefaultValue:{latex:!0}}}},t.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({mrowChildren:{dependencyType:"child",childGroups:["mrows"],variableNames:["latexWithInputChildren","hide","equationTag","numbered"]},latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){if(e.mrowChildren.length>0){let r=[],n=0,i="";for(let s of e.mrowChildren)if(!s.stateValues.hide){i.length>0&&(i+="\\\\"),s.stateValues.numbered?i+=`\\tag{${s.stateValues.equationTag}}`:i+="\\notag ";for(let o of s.stateValues.latexWithInputChildren)typeof o=="number"?(i.length>0&&(r.push(i),i=""),r.push(n),n++):i+=o}return i.length>0&&r.push(i),{setValue:{latexWithInputChildren:r}}}else return{setValue:{latexWithInputChildren:[e.latex]}}}},t.text={returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){let r;try{r=e.latex.replaceAll("\\notag","").replaceAll("\\amp","").split("\\\\").map(n=>uq.fromAst(ch.convert(n)).toString()).join(`\\\\
`)}catch(n){return{setValue:{text:e.latex}}}return{setValue:{text:r}}}},t.renderMode={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{renderMode:"align"}})},t.numbered={returnDependencies:()=>({}),definition:()=>({setValue:{numbered:!1}})},t}};T(tu,"componentType","md"),T(tu,"rendererType","math"),T(tu,"primaryStateVariableForDefinition","latex");var b2=class extends tu{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numbered={returnDependencies:()=>({}),definition:()=>({setValue:{numbered:!0}})},t}};T(b2,"componentType","mdn");var g2=class extends ja{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.number={createComponentOfType:"boolean"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.renderMode.definition=()=>({setValue:{renderMode:"display"}}),t.numbered={forRenderer:!0,returnDependencies:()=>({parentNumbered:{dependencyType:"parentStateVariable",variableName:"numbered"},numberAttr:{dependencyType:"attributeComponent",attributeName:"number",variableNames:["value"]}}),definition({dependencyValues:e}){let r;return e.numberAttr!==null?r=e.numberAttr.stateValues.value:r=e.parentNumbered,{setValue:{numbered:r}}}},t.equationTag={public:!0,componentType:"text",forRenderer:!0,stateVariablesDeterminingDependencies:["numbered"],returnDependencies({stateValues:e}){return e.numbered?{equationCounter:{dependencyType:"counter",counterName:"equation"}}:{}},definition({dependencyValues:e}){return e.equationCounter!==void 0?{setValue:{equationTag:String(e.equationCounter)}}:{setValue:{equationTag:null}}}},t}};T(g2,"componentType","mrow");var w2={};st(w2,{And:()=>C2,Not:()=>N2,Or:()=>A2,Xor:()=>S2});import Ut from"math-expressions";import Kr from"math-expressions";function T2(a,t,{min_elements_match:e=3,match_partial:r=!1}={}){if(!kx(a))return!1;if(kx(t))if(r){let n=ru(a.tree,t.tree,r);if(n===!1)return 0;let i=ru(t.tree,a.tree,r);return i===!1?0:n===!0?i===!0?1:i:i===!0?n:Math.min(n,i)}else return ru(a.tree,t.tree,r)&&ru(t.tree,a.tree,r);else{let n=a.tree.slice(1);if(n.length>1)return!1;let i=Kr.fromAst(n[0][1]).evaluate_to_constant(),s=Kr.fromAst(["apply","abs",n[0][2]]).evaluate_to_constant();if(!Number.isFinite(i)||!Number.isFinite(s))return!1;let o=n[0][3],l=n[0][4];if(o!==-1/0||l!==1/0||t.tree[0]!=="list")return!1;let u=t.tree.slice(1),c=0;if(u[0][0]==="ldots")c++,u=u.slice(1);else if(!r)return!1;if(u[u.length-1][0]==="ldots")c++,u=u.slice(0,u.length-1);else if(!r)return!1;let p=u.length;if(p===0||!r&&p<e)return!1;u=u.map(h=>Kr.fromAst(h).evaluate_to_constant()).map(h=>Number.isFinite(h)?h:NaN);let m=Kr.math.mod(u[0]-i,s);if(!(Kr.math.min(m,s-m)<1e-10*s))return!1;let f=1;for(let h=1;h<p;h++)if(Math.abs(u[h]-u[h-1]-s)<1e-10*s)f++;else{if(!r)return!1;break}if(f===p&&c===2&&p>=e)return!0;let d=f/Math.max(p,e);return d*=(9+c/2)/10,d;return!1}}function kx(a){var t=a.tree;if(!Array.isArray(t)||t[0]!=="periodic_set")return!1;var e=t.slice(1);for(var r of e)if(!Array.isArray(r)||r[0]!=="tuple"||r.length!==5)return!1;return!0}function ru(a,t,e){if(a[0]==="periodic_set")if(e){let p=0;for(let f of a.slice(1)){let d=ru(f,t,e);d===!0?p++:d!==!1&&(p+=d)}let m=a.length-1;return p===m?!0:p===0?!1:p/m}else return a.slice(1).every(p=>ru(p,t));var r=a[1],n=a[2],i=a[3],s=a[4];if(i!==-1/0||s!==1/0)return!1;r=Kr.fromAst(["/",r,n]).evaluate_to_constant();var o=t.slice(1),l=[];for(let p=0;p<o.length;p++){let m=o[p][3],f=o[p][4];if(m!==-1/0||f!==1/0)return!1;let d=Kr.fromAst(["/",o[p][1],n]).evaluate_to_constant(),h=Kr.fromAst(["apply","abs",["/",o[p][2],n]]).evaluate_to_constant();if(typeof h!="number")return!1;let y=Kr.math.fraction(h),b=y.n;if(b>1e3)return!1;let g=y.d;l.push([b,g,d,h])}for(l.sort();l[0][0]===1;){let m=l[0][2],f=l[0][3],d=Kr.fromAst(["+",m,["-",r]]).evaluate_to_constant();if(Number.isFinite(d)&&Number.isFinite(f)&&(d=Kr.math.mod(d,f),Kr.math.min(d,f-d)<1e-10*f))return!0;if(l.splice(0,1),l.length===0)return!1}var u=[...new Set(l.map(p=>p[0]))];let c=0;for(let p of u){let m=l.map(function(d,h){let y=p/d[0];if(Number.isInteger(y))return[d[0],y,h]}).filter(d=>d),f=[];for(let d of m){let h=d[0],y=d[1],b=d[2],g=l[b][2],v=l[b][3];for(let A=0;A<h;A++){let C=Kr.fromAst(["+",g,["-",["+",r,A]]]).evaluate_to_constant();if(Number.isFinite(C)&&Number.isFinite(v)&&(C=Kr.math.mod(C,v),Kr.math.min(C,v-C)<1e-10*v)){for(let w=0;w<y;w++)f[A+w*h]=!0;let S=!0;for(let w=0;w<p;w++)if(!f[w]){S=!1;break}if(S)return!0;break}}}if(e){let d=0;for(let h=0;h<p;h++)f[h]&&d++;d/=p,d>c&&(c=d)}}return e&&c>0?c:!1}function Fr({object1:a,object2:t,isUnordered:e=!1,partialMatches:r=!1,matchByExactPositions:n=!1,symbolicEquality:i=!1,simplify:s="none",expand:o=!1,allowedErrorInNumbers:l=0,includeErrorInNumberExponents:u=!1,allowedErrorIsAbsolute:c=!1,nSignErrorsMatched:p=0,nPeriodicSetMatchesRequired:m=3}){let f=!1;if(a instanceof Ut.class){if(f=!0,!(t instanceof Ut.class))if(typeof t=="number"||typeof t=="string")t=Ut.fromAst(t);else return{fraction_equal:0}}else if(t instanceof Ut.class)if(f=!0,typeof a=="number"||typeof a=="string")a=Ut.fromAst(a);else return{fraction_equal:0};let d=function(C){return C instanceof Ut.class||(C=Ut.fromAst(C)),C=C.normalize_function_names().normalize_applied_functions(),s==="none"?l>0&&(C=C.constants_to_floats()):s==="numberspreserveorder"?C=C.evaluate_numbers({max_digits:1/0,skip_ordering:!0}):s==="number"?C=C.evaluate_numbers({max_digits:1/0}):C=C.evaluate_numbers({max_digits:1/0,evaluate_functions:!0}),Wr({value:C,simplify:s,expand:o})},h;if(f?i?h=function(C,S){let w=d(C),x=d(S);if(p>0){x=JSON.parse(JSON.stringify(x),Ut.reviver);let R=function(_,k){return _.variables().includes("\uFF3F")||k.variables().includes("\uFF3F")?!1:(_=d(_),_.equalsViaSyntax(k,{allowed_error_in_numbers:l,include_error_in_number_exponents:u,allowed_error_is_absolute:c}))};return w.tree.im||x.tree.im?{fraction_equal:0}:{fraction_equal:Ut.equalSpecifiedSignErrors(x,w,{equalityFunction:R,n_sign_errors:p})?1:0}}else return w.variables().includes("\uFF3F")||x.variables().includes("\uFF3F")?{fraction_equal:0}:w.tree.im||x.tree.im?{fraction_equal:0}:{fraction_equal:w.equalsViaSyntax(x,{allowed_error_in_numbers:l,include_error_in_number_exponents:u,allowed_error_is_absolute:c})?1:0}}:h=function(C,S){let w=C,x=S;if(C instanceof Ut.class||(w=Ut.fromAst(C)),S instanceof Ut.class||(x=Ut.fromAst(S)),p>0){x=JSON.parse(JSON.stringify(x),Ut.reviver);let R=function(_,k){return _.equals(k,{allowed_error_in_numbers:l,include_error_in_number_exponents:u,allowed_error_is_absolute:c})};return w.tree.im||x.tree.im?{fraction_equal:0}:{fraction_equal:Ut.equalSpecifiedSignErrors(x,w,{equalityFunction:R,n_sign_errors:p})?1:0}}else return w.tree.im||x.tree.im?{fraction_equal:0}:{fraction_equal:w.equals(x,{allowed_error_in_numbers:l,include_error_in_number_exponents:u,allowed_error_is_absolute:c})?1:0}}:h=(C,S)=>({fraction_equal:Ot(C,S)?1:0}),f){let C=a.tree[0],S=t.tree[0];if(C==="periodic_set"||S==="periodic_set"){let w=a,x=t;C!=="periodic_set"&&(w=t,x=a);let R=T2(w,x,{match_partial:r,min_elements_match:m});return R===!0?{fraction_equal:1}:R===!1?{fraction_equal:0}:{fraction_equal:R}}else if(C==="list")a=a.tree.slice(1),S==="list"?t=t.tree.slice(1):t=[t.tree];else if(S==="list")t=t.tree.slice(1),a=[a.tree];else if(C==="vector"){if(a=a.tree.slice(1),S==="interval"||S==="matrix"||S==="array"||S==="set")return{fraction_equal:0};S==="tuple"||S==="vector"?t=t.tree.slice(1):t=[t.tree]}else if(S==="vector"){if(t=t.tree.slice(1),C==="interval"||C==="matrix"||C==="array"||C==="set")return{fraction_equal:0};C==="tuple"?a=a.tree.slice(1):a=[a.tree]}else if(C==="interval"){n=!0;let w=a.tree[2],x=w[1],R=w[2];if(a=a.tree[1].slice(1),S==="matrix"||S==="set")return{fraction_equal:0};if(S==="tuple"){let O=t.tree.slice(1);if(O.length===2&&x===!1&&R===!1)t=O;else return{fraction_equal:0}}else if(S==="array"){let O=t.tree.slice(1);if(O.length===2&&x===!0&&R===!0)t=O;else return{fraction_equal:0}}else if(S==="interval"){let O=t.tree[2];if(O[1]!==x||O[2]!==R)return{fraction_equal:0};t=t.tree[1].slice(1)}else return{fraction_equal:0}}else if(S==="interval"){n=!0;let w=t.tree[2],x=w[1],R=w[2];if(t=t.tree[1].slice(1),C==="matrix"||C==="set")return{fraction_equal:0};if(C==="tuple"){let O=a.tree.slice(1);if(O.length===2&&x===!1&&R===!1)a=O;else return{fraction_equal:0}}else if(C==="array"){let O=a.tree.slice(1);if(O.length===2&&x===!0&&R===!0)a=O;else return{fraction_equal:0}}else return{fraction_equal:0}}else if(C==="matrix")if(S==="matrix")a=a.tree.slice(1),t=t.tree.slice(1);else return{fraction_equal:0};else{if(S==="matrix")return{fraction_equal:0};if(C==="set"){let w=[];for(let x of a.tree.slice(1))w.some(R=>h(R,x).fraction_equal===1)||w.push(x);if(a=w,e=!0,S==="tuple"||S==="array")return{fraction_equal:0};if(S==="set"){w=[];for(let x of t.tree.slice(1))w.some(R=>h(R,x).fraction_equal===1)||w.push(x);t=w}else t=[t.tree]}else if(S==="set"){let w=[];for(let x of t.tree.slice(1))w.some(R=>h(R,x).fraction_equal===1)||w.push(x);if(t=w,e=!0,C==="tuple"||C==="array")return{fraction_equal:0};a=[a.tree]}else if(C==="tuple"){if(a=a.tree.slice(1),S==="array")return{fraction_equal:0};S==="tuple"?t=t.tree.slice(1):t=[t.tree]}else if(S==="tuple"){if(t=t.tree.slice(1),C==="array")return{fraction_equal:0};a=[a.tree]}else if(C==="array")a=a.tree.slice(1),S==="array"?t=t.tree.slice(1):t=[t.tree];else if(S==="array")t=t.tree.slice(1),a=[a.tree];else return h(a.tree,t.tree)}}else if(Array.isArray(a))Array.isArray(t)||(typeof t=="string"&&a.every(C=>typeof C=="string"&&!C.includes(","))?t=t.split(",").map(C=>C.trim()):t=[t]);else if(Array.isArray(t))typeof a=="string"&&t.every(C=>typeof C=="string"&&!C.includes(","))?a=a.split(",").map(C=>C.trim()):a=[a];else return h(a,t);let y=a.length,b=t.length,g={fraction_equal:0};if(n&&(e=!1),!e){let C=0,S=Math.min(y,b);for(let R=0;R<S;R++)C+=Fr({object1:Ut.fromAst(a[R]),object2:Ut.fromAst(t[R]),isUnordered:!1,partialMatches:!1,matchByExactPositions:!1,symbolicEquality:i,simplify:s,expand:o,allowedErrorInNumbers:l,allowedErrorIsAbsolute:c,nSignErrorsMatched:p,nPeriodicSetMatchesRequired:m}).fraction_equal;if(y===b&&y===C)return g.fraction_equal=1,g;if(!r)return g;if(n)return g.fraction_equal=C/Math.max(y,b),g;let w=Array.from(Array(y+1),R=>Array(b+1).fill(0));for(let R=0;R<y;R++)for(let O=0;O<b;O++){let _=Fr({object1:Ut.fromAst(a[R]),object2:Ut.fromAst(t[O]),isUnordered:!1,partialMatches:!1,matchByExactPositions:!1,symbolicEquality:i,simplify:s,expand:o,allowedErrorInNumbers:l,allowedErrorIsAbsolute:c,nSignErrorsMatched:p,nPeriodicSetMatchesRequired:m});w[R+1][O+1]=Math.max(w[R][O]+_.fraction_equal,w[R+1][O],w[R][O+1])}let x=w[y][b];return g.fraction_equal=x/Math.max(y,b),g}let v=new Set,A=0;for(let C of a){let S=-1,w=0;for(let[x,R]of t.entries()){if(v.has(x))continue;let O=Fr({object1:Ut.fromAst(C),object2:Ut.fromAst(R),isUnordered:!1,partialMatches:!1,matchByExactPositions:!1,symbolicEquality:i,simplify:s,expand:o,allowedErrorInNumbers:l,allowedErrorIsAbsolute:c,nSignErrorsMatched:p,nPeriodicSetMatchesRequired:m});O.fraction_equal>w&&(w=O.fraction_equal,S=x)}S!==-1&&(A+=w,v.add(S))}return y===b&&y===A?(g.fraction_equal=1,g):(r&&(g.fraction_equal=A/Math.max(y,b)),g)}import No from"math-expressions";var cq=[...Zl,"isnumber","isinteger"],pq=la({splitSymbols:!1,appliedFunctionSymbols:cq});function tm({dependencyValues:a,componentInfoObjects:t}){let e="comp",r=!0;for(;r;){r=!1;for(let u of a.stringChildren)if(u.includes(e)){r=!0,e+="p";break}}let n="",i=0,s=[],o=0;for(let u of a.allChildren)if(typeof u=="string")n+=" "+a.stringChildren[o]+" ",o++;else{let c=e+i;n+=" "+c+" ",t.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"math"})||t.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"mathList"})||t.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"number"})||t.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"numberList"})||s.push(c),i+=1}let l=null;try{l=pq(n)}catch(u){}return l&&(l=No.fromAst(rm({logicTree:l.tree,nonMathCodes:s}))),{setValue:{codePre:e,parsedExpression:l}}}function Ma({logicTree:a,canOverrideUnorderedCompare:t=!1,dependencyValues:e,valueOnInvalid:r=0}){let n=b=>Ma({logicTree:b,canOverrideUnorderedCompare:t,dependencyValues:e,valueOnInvalid:r});if(!Array.isArray(a)){if(typeof a=="string"){let b=e.booleanChildrenByCode[a];if(b)return e.matchPartial&&b.stateValues.fractionSatisfied!==void 0?b.stateValues.fractionSatisfied:b.stateValues.value?1:0;{let g=e.mathChildrenByCode[a];if(g){let v=g.stateValues.value.simplify().evaluate_to_constant();return Number.isFinite(v)&&v!==0?1:0}else{let v=e.numberChildrenByCode[a];if(v){let A=v.stateValues.value;return Number.isFinite(A)&&A!==0?1:0}else{if(a.toLowerCase()==="true")return 1;if(a.toLowerCase()==="false")return 0}}}}else if(typeof a=="number")return a===0?0:1;return console.warn("Invalid format for boolean condition"),r}let i=a[0],s=a.slice(1);if(i==="not")return s.length!==1?(console.warn("Invalid format for boolean condition"),r):n(s[0])===0?1:0;if(i==="and")return e.matchPartial?s.reduce((b,g)=>b+n(g),0)/s.length:s.every(b=>n(b)===1)?1:0;if(i==="or")return e.matchPartial?s.reduce((b,g)=>Math.max(n(g),b),0):s.some(b=>n(b)===1)?1:0;let o=!1,l=!1,u=!1;s.forEach(function(b){typeof b=="string"&&(b in e.mathChildrenByCode||b in e.mathListChildrenByCode||b in e.numberChildrenByCode||b in e.numberListChildrenByCode?o=!0:b in e.textChildrenByCode||b in e.textListChildrenByCode?l=!0:(b in e.booleanChildrenByCode||b in e.booleanListChildrenByCode)&&(u=!0))});let c=function(b){if(typeof b=="string"){let g=e.mathChildrenByCode[b];return g!==void 0?g.stateValues.value.tree:(g=e.mathListChildrenByCode[b],g!==void 0?["list",...g.stateValues.maths.map(v=>v.tree)]:(g=e.numberChildrenByCode[b],g!==void 0?g.stateValues.value:(g=e.numberListChildrenByCode[b],g!==void 0?["list",...g.stateValues.numbers]:b)))}return Array.isArray(b)?[b[0],...b.slice(1).map(c)]:b};if(i==="apply"&&["isnumber","isinteger"].includes(s[0])){if(l||u)return 0;let g=No.fromAst(c(s[1])).simplify().evaluate_to_constant();if(!Number.isFinite(g))return 0;if(s[0]==="isnumber")return 1;{let v=Math.round(g);return Math.abs(v-g)<=1e-15*Math.abs(g)?1:0}}if(!["=","ne","<",">","le","ge","lts","gts","in","notin"].includes(i)){if(l||u)return console.warn("Invalid format for boolean condition"),r;let g=No.fromAst(c(a)).simplify().evaluate_to_constant();return Number.isFinite(g)&&g!==0?1:0}if(u){if(o||l)return console.warn("Invalid format for boolean condition"),r;let b=!1,g=!1;if(s=s.map(function(A){if(typeof A=="string"){let C=e.booleanChildrenByCode[A];return C!==void 0?C.stateValues.value:(C=e.booleanListChildrenByCode[A],C!==void 0?(C.stateValues.unordered&&(g=!0),C.stateValues.booleans):(A=A.toLowerCase().trim(),A==="true"||A==="t"?!0:A==="false"||A==="f"?!1:(console.warn("Invalid format for boolean condition"),b=!0,r)))}return console.warn("Invalid format for boolean condition"),b=!0,r}),b)return r;let v=e.unorderedCompare;if(t&&g&&(v=!0),i==="="){let A=s[0];if(e.matchPartial){let C=s.slice(1).map(w=>Fr({object1:A,object2:w,isUnordered:v,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions}));return C.reduce((w,x)=>w+x.fraction_equal,0)/C.length}else return s.slice(1).every(C=>Fr({object1:A,object2:C,isUnordered:v,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions}).fraction_equal===1)?1:0}else return i==="ne"?s.length!==2?(console.warn("Invalid format for boolean condition"),r):Fr({object1:s[0],object2:s[1],isUnordered:v,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions}).fraction_equal===0?1:0:(console.warn("Invalid format for boolean condition"),r)}else if(l){if(o)return console.warn("Invalid format for boolean condition"),r;let b=!1,g=!1,v=function(C,S=!1){if(typeof C=="string"){let w=e.textChildrenByCode[C];return w!==void 0?w.stateValues.value.trim():(w=e.textListChildrenByCode[C],w!==void 0?(w.stateValues.unordered&&(g=!0),w.stateValues.texts.map(x=>x.trim())):C.trim())}return typeof C=="number"?C.toString():S&&Array.isArray(C)&&C[0]==="*"?C.slice(1).map(v).join(" "):(console.warn("Invalid format for boolean condition"),b=!0,"")};if(s=s.map(C=>v(C,!0)),b)return r;let A=e.unorderedCompare;if(t&&g&&(A=!0),i==="="){let C=s[0];if(e.matchPartial){let S=s.slice(1).map(x=>Fr({object1:C,object2:x,isUnordered:A,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions}));return S.reduce((x,R)=>x+R.fraction_equal,0)/S.length}else return s.slice(1).every(S=>Fr({object1:C,object2:S,isUnordered:A,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions}).fraction_equal===1)?1:0}else return i==="ne"?s.length!==2?(console.warn("Invalid format for boolean condition"),0):Fr({object1:s[0],object2:s[1],isUnordered:A,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions}).fraction_equal===0?1:0:(console.warn("Invalid format for boolean condition"),r)}let p;(i==="lts"||i==="gts")&&(p=s[1].slice(1),s=s[0].slice(1));let m=!1,f=function(b){if(typeof b=="string"){let g=e.mathChildrenByCode[b];return g!==void 0?(g.stateValues.unordered&&(m=!0),g.stateValues.value.tree):(g=e.mathListChildrenByCode[b],g!==void 0?(g.stateValues.unordered&&(m=!0),["list",...g.stateValues.maths.map(v=>v.tree)]):(g=e.numberChildrenByCode[b],g!==void 0?g.stateValues.value:(g=e.numberListChildrenByCode[b],g!==void 0?(g.stateValues.unordered&&(m=!0),["list",...g.stateValues.numbers]):b)))}return Array.isArray(b)?[b[0],...b.slice(1).map(f)]:b},d=s.map(function(b){return No.fromAst(f(b))}),h=e.unorderedCompare;if(t&&m&&(h=!0),i==="="){let b=d[0];if(Number.isNaN(b.tree))return d.slice(1).every(g=>Number.isNaN(g.tree))?1:0;if(e.matchPartial){let g=d.slice(1).map(A=>Fr({object1:b,object2:A,isUnordered:h,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions,symbolicEquality:e.symbolicEquality,simplify:e.simplifyOnCompare,expand:e.expandOnCompare,allowedErrorInNumbers:e.allowedErrorInNumbers,includeErrorInNumberExponents:e.includeErrorInNumberExponents,allowedErrorIsAbsolute:e.allowedErrorIsAbsolute,nSignErrorsMatched:e.nSignErrorsMatched,nPeriodicSetMatchesRequired:e.nPeriodicSetMatchesRequired}));return g.reduce((A,C)=>A+C.fraction_equal,0)/g.length}else return d.slice(1).every(g=>Fr({object1:b,object2:g,isUnordered:h,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions,symbolicEquality:e.symbolicEquality,simplify:e.simplifyOnCompare,expand:e.expandOnCompare,allowedErrorInNumbers:e.allowedErrorInNumbers,includeErrorInNumberExponents:e.includeErrorInNumberExponents,allowedErrorIsAbsolute:e.allowedErrorIsAbsolute,nSignErrorsMatched:e.nSignErrorsMatched,nPeriodicSetMatchesRequired:e.nPeriodicSetMatchesRequired}).fraction_equal===1)?1:0}if(i==="ne")return Fr({object1:d[0],object2:d[1],isUnordered:h,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions,symbolicEquality:e.symbolicEquality,simplify:e.simplifyOnCompare,expand:e.expandOnCompare,allowedErrorInNumbers:e.allowedErrorInNumbers,includeErrorInNumberExponents:e.includeErrorInNumberExponents,allowedErrorIsAbsolute:e.allowedErrorIsAbsolute,nSignErrorsMatched:e.nSignErrorsMatched,nPeriodicSetMatchesRequired:e.nPeriodicSetMatchesRequired}).fraction_equal===0?1:0;if(i==="in"||i==="notin"){let b=d[0],v=d[1].tree;if(!(Array.isArray(v)&&v[0]==="set"))return console.warn("Invalid format for boolean condition"),r;if(e.matchPartial){let C=v.slice(1).map(S=>Fr({object1:b,object2:No.fromAst(S),isUnordered:h,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions,symbolicEquality:e.symbolicEquality,simplify:e.simplifyOnCompare,expand:e.expandOnCompare,allowedErrorInNumbers:e.allowedErrorInNumbers,includeErrorInNumberExponents:e.includeErrorInNumberExponents,allowedErrorIsAbsolute:e.allowedErrorIsAbsolute,nSignErrorsMatched:e.nSignErrorsMatched,nPeriodicSetMatchesRequired:e.nPeriodicSetMatchesRequired})).reduce((S,w)=>Math.max(S,w.fraction_equal),0);return i==="in"?C:1-C}else{let A=v.slice(1).some(C=>Fr({object1:b,object2:No.fromAst(C),isUnordered:h,partialMatches:e.matchPartial,matchByExactPositions:e.matchByExactPositions,symbolicEquality:e.symbolicEquality,simplify:e.simplifyOnCompare,expand:e.expandOnCompare,allowedErrorInNumbers:e.allowedErrorInNumbers,includeErrorInNumberExponents:e.includeErrorInNumberExponents,allowedErrorIsAbsolute:e.allowedErrorIsAbsolute,nSignErrorsMatched:e.nSignErrorsMatched,nPeriodicSetMatchesRequired:e.nPeriodicSetMatchesRequired}).fraction_equal===1);return i==="in"?A?1:0:A?0:1}}let y=d.map(b=>b.simplify().evaluate_to_constant());if(y.some(b=>b===null||Number.isNaN(b)))return 0;if(i==="<")return y[0]<y[1]?1:0;if(i===">")return y[0]>y[1]?1:0;if(i==="le")return y[0]<=y[1]?1:0;if(i==="ge")return y[0]>=y[1]?1:0;for(let b=0;b<p.length;b++)if(i==="lts"){if(p[b]===!0){if(!(y[b]<y[b+1]))return 0}else if(!(y[b]<=y[b+1]))return 0}else if(p[b]===!0){if(!(y[b]>y[b+1]))return 0}else if(!(y[b]>=y[b+1]))return 0;return 1}function rm({logicTree:a,nonMathCodes:t,foundNonMath:e=!1,init:r=!0}){if(!Array.isArray(a))return typeof a=="string"&&!e&&!r?No.fromAst(pn.convert(a)).tree:a;let n=a[0],i=a.slice(1);return["and","not","or"].includes(n)?n==="apply"?[n,i[0],...i.slice(1).map(s=>rm({logicTree:s,nonMathCodes:t,foundNonMath:e,init:r}))]:[n,...i.map(s=>rm({logicTree:s,nonMathCodes:t,foundNonMath:e,init:r}))]:(i.some(s=>t.includes(s))&&(e=!0),n==="apply"?[n,i[0],...i.slice(1).map(s=>rm({logicTree:s,nonMathCodes:t,foundNonMath:e,init:!1}))]:[n,...i.map(s=>rm({logicTree:s,nonMathCodes:t,foundNonMath:e,init:!1}))])}var Nr=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.symbolicEquality={createComponentOfType:"boolean",createStateVariable:"symbolicEquality",defaultValue:!1,public:!0},e.expandOnCompare={createComponentOfType:"boolean",createStateVariable:"expandOnCompare",defaultValue:!1,public:!0},e.simplifyOnCompare={createComponentOfType:"text",createStateVariable:"simplifyOnCompare",defaultValue:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numbersepreserveorder"],public:!0},e.unorderedCompare={createComponentOfType:"boolean",createStateVariable:"unorderedCompare",defaultValue:!1,public:!0},e.matchByExactPositions={createComponentOfType:"boolean",createStateVariable:"matchByExactPositions",defaultValue:!1,public:!0},e.allowedErrorInNumbers={createComponentOfType:"number",createStateVariable:"allowedErrorInNumbers",defaultValue:0,public:!0},e.includeErrorInNumberExponents={createComponentOfType:"boolean",createStateVariable:"includeErrorInNumberExponents",defaultValue:!1,public:!0},e.allowedErrorIsAbsolute={createComponentOfType:"boolean",createStateVariable:"allowedErrorIsAbsolute",defaultValue:!1,public:!0},e.nSignErrorsMatched={createComponentOfType:"number",createStateVariable:"nSignErrorsMatched",defaultValue:0,public:!0},e.nPeriodicSetMatchesRequired={createComponentOfType:"integer",createStateVariable:"nPeriodicSetMatchesRequired",defaultValue:3,public:!0},e}static returnChildGroups(){return[{group:"strings",componentTypes:["string"]},{group:"mathsNumbersTextsBooleans",componentTypes:["math","mathList","number","numberList","text","textList","boolean","booleanList"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.parsedExpression={additionalStateVariablesDefined:["codePre"],returnDependencies:()=>({allChildren:{dependencyType:"child",childGroups:["strings","mathsNumbersTextsBooleans"]},stringChildren:{dependencyType:"child",childGroups:["strings"],variableNames:["value"]}}),definition:tm},t.mathChildrenByCode={additionalStateVariablesDefined:["mathListChildrenByCode","numberChildrenByCode","numberListChildrenByCode","textChildrenByCode","textListChildrenByCode","booleanChildrenByCode","booleanListChildrenByCode"],returnDependencies:()=>({allChildren:{dependencyType:"child",childGroups:["strings","mathsNumbersTextsBooleans"],variableNames:["value","texts","maths","numbers","booleans","fractionSatisfied","unordered"],variablesOptional:!0},codePre:{dependencyType:"stateVariable",variableName:"codePre"}}),definition({dependencyValues:e,componentInfoObjects:r}){let n={},i={},s={},o={},l={},u={},c={},p={},m=0,f=e.codePre;for(let d of e.allChildren)if(typeof d!="string"){let h=f+m;r.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"math"})?n[h]=d:r.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"mathList"})?i[h]=d:r.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"number"})?s[h]=d:r.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"numberList"})?o[h]=d:r.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"text"})?l[h]=d:r.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"textList"})?u[h]=d:r.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"boolean"})?c[h]=d:p[h]=d,m+=1}return{setValue:{mathChildrenByCode:n,mathListChildrenByCode:i,numberChildrenByCode:s,numberListChildrenByCode:o,textChildrenByCode:l,textListChildrenByCode:u,booleanChildrenByCode:c,booleanListChildrenByCode:p}}}},t.value={public:!0,componentType:"boolean",forRenderer:!0,hasEssential:!0,defaultValue:!1,set:Boolean,stateVariablesPrescribingAdditionalAttributes:{fixed:"fixed"},returnDependencies:()=>({symbolicEquality:{dependencyType:"stateVariable",variableName:"symbolicEquality"},expandOnCompare:{dependencyType:"stateVariable",variableName:"expandOnCompare"},simplifyOnCompare:{dependencyType:"stateVariable",variableName:"simplifyOnCompare"},unorderedCompare:{dependencyType:"stateVariable",variableName:"unorderedCompare"},matchByExactPositions:{dependencyType:"stateVariable",variableName:"matchByExactPositions"},allowedErrorInNumbers:{dependencyType:"stateVariable",variableName:"allowedErrorInNumbers"},includeErrorInNumberExponents:{dependencyType:"stateVariable",variableName:"includeErrorInNumberExponents"},allowedErrorIsAbsolute:{dependencyType:"stateVariable",variableName:"allowedErrorIsAbsolute"},nSignErrorsMatched:{dependencyType:"stateVariable",variableName:"nSignErrorsMatched"},nPeriodicSetMatchesRequired:{dependencyType:"stateVariable",variableName:"nPeriodicSetMatchesRequired"},parsedExpression:{dependencyType:"stateVariable",variableName:"parsedExpression"},allChildren:{dependencyType:"child",childGroups:["strings","mathsNumbersTextsBooleans"],variableNames:["value"],variablesOptional:!0},booleanChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanChildrenByCode"},booleanListChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanListChildrenByCode"},textChildrenByCode:{dependencyType:"stateVariable",variableName:"textChildrenByCode"},textListChildrenByCode:{dependencyType:"stateVariable",variableName:"textListChildrenByCode"},mathChildrenByCode:{dependencyType:"stateVariable",variableName:"mathChildrenByCode"},mathListChildrenByCode:{dependencyType:"stateVariable",variableName:"mathListChildrenByCode"},numberChildrenByCode:{dependencyType:"stateVariable",variableName:"numberChildrenByCode"},numberListChildrenByCode:{dependencyType:"stateVariable",variableName:"numberListChildrenByCode"}}),definition({dependencyValues:e,usedDefault:r}){if(e.allChildren.length===0)return{useEssentialOrDefaultValue:{value:!0}};if(e.parsedExpression===null)return{setValue:{value:!1}};let n=r.unorderedCompare;return{setValue:{value:Ma({logicTree:e.parsedExpression.tree,canOverrideUnorderedCompare:n,dependencyValues:e})===1}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r,componentInfoObjects:n}){if(r.allChildren.length===0)return{success:!0,instructions:[{setEssentialValue:"value",value:Boolean(e.value)}]};if(r.allChildren.length===1){let i=r.allChildren[0];if(typeof i=="string")return{success:!0,instructions:[{setDependency:"allChildren",desiredValue:e.value.toString(),childIndex:0,variableIndex:0}]};if(n.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"boolean"}))return{success:!0,instructions:[{setDependency:"allChildren",desiredValue:e.value,childIndex:0,variableIndex:0}]}}return{success:!1}}},t.text={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{setValue:{text:e.value?"true":"false"}}},inverseDefinition({desiredStateVariableValues:e}){let r=String(e.text).toLowerCase(),n;return r==="true"?n=!0:r==="false"&&(n=!1),n!==void 0?{success:!0,instructions:[{setDependency:"value",desiredValue:n}]}:{success:!1}}},t}};T(Nr,"componentType","boolean"),T(Nr,"variableForPlainMacro","value"),T(Nr,"descendantCompositesMustHaveAReplacement",!0),T(Nr,"descendantCompositesDefaultReplacementType","math"),T(Nr,"adapters",["text"]);var ua=class extends Nr{static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=r.reduce(function(i,s){return typeof s=="string"?[...i,...s.split(/\s+/).filter(o=>o).map(o=>({componentType:"boolean",children:[o]}))]:[...i,s]},[]);return{success:!0,newChildren:n}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"booleans",componentTypes:["boolean"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();delete t.parsedExpression,delete t.mathChildrenByCode;let e=this;return t.value={public:!0,componentType:"boolean",forRenderer:!0,returnDependencies:()=>({booleanChildren:{dependencyType:"child",childGroups:["booleans"],variableNames:["value"]}}),definition:function({dependencyValues:r}){return{setValue:{value:e.applyBooleanOperator(r.booleanChildren.map(n=>n.stateValues.value))}}}},t}};T(ua,"componentType","_booleanOperator"),T(ua,"rendererType","boolean"),T(ua,"descendantCompositesMustHaveAReplacement",!1);var nu=class extends Nr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=this;return $r({stateVariableDefinitions:t,oldName:"value",newName:"valuePreOperator"}),t.value={public:!0,componentType:"boolean",forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"valuePreOperator"}}),definition:function({dependencyValues:r}){return{setValue:{value:e.applyBooleanOperator(r.value)}}}},t}};T(nu,"componentType","_booleanOperatorOneInput"),T(nu,"rendererType","boolean");var N2=class extends nu{static applyBooleanOperator(t){return!t}};T(N2,"componentType","not");var C2=class extends ua{static applyBooleanOperator(t){return t.every(e=>e)}};T(C2,"componentType","and");var A2=class extends ua{static applyBooleanOperator(t){return t.some(e=>e)}};T(A2,"componentType","or");var S2=class extends ua{static applyBooleanOperator(t){return t.reduce((r,n)=>r+n,0)===1}};T(S2,"componentType","xor");var V2={};st(V2,{IsBetween:()=>x2,IsInteger:()=>E2,IsNumber:()=>R2});var Ba=class extends Nr{static returnSugarInstructions(){let t=[],e=function({matchedChildren:r}){return r.every(n=>typeof n=="string"||n.doenetAttributes&&n.doenetAttributes.createdFromMacro)?r.length===1&&typeof r[0]!="string"?{success:!1}:{success:!0,newChildren:[{componentType:"math",children:r}]}:{success:!1}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"maths",componentTypes:["math"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();delete t.parsedExpression,delete t.mathChildrenByCode,t.booleanOperator={returnDependencies:()=>({}),definition:()=>({setValue:{booleanOperator:r=>!1}})};let e=this;return t.value={public:!0,componentType:"boolean",forRenderer:!0,returnDependencies:()=>({mathChildren:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]},booleanOperator:{dependencyType:"stateVariable",variableName:"booleanOperator"}}),definition:function({dependencyValues:r}){return{setValue:{value:r.booleanOperator(r.mathChildren.map(n=>n.stateValues.value))}}}},t}};T(Ba,"componentType","_booleanOperatorOfMath"),T(Ba,"rendererType","boolean");var E2=class extends Ba{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.booleanOperator.definition=()=>({setValue:{booleanOperator:function(e){if(e.length===0)return!1;if(e.length!==1)return console.warn("IsInteger requires exactly one math child"),null;let r=e[0].evaluate_to_constant();if(!Number.isFinite(r))return!1;let n=Math.round(r);return Math.abs(n-r)<=1e-15*Math.abs(r)}}}),t}};T(E2,"componentType","isInteger");var R2=class extends Ba{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.booleanOperator.definition=()=>({setValue:{booleanOperator:function(e){if(e.length===0)return!1;if(e.length!==1)return console.warn("IsNumber requires exactly one math child"),null;let r=e[0].evaluate_to_constant();return Number.isFinite(r)}}}),t}};T(R2,"componentType","isNumber");var x2=class extends Ba{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.limits={createComponentOfType:"numberList",createStateVariable:"limits",defaultValue:[],public:!0},e.strict={createComponentOfType:"boolean",createStateVariable:"strict",defaultValue:!1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.booleanOperator={returnDependencies:()=>({limits:{dependencyType:"stateVariable",variableName:"limits"},strict:{dependencyType:"stateVariable",variableName:"strict"}}),definition({dependencyValues:e}){let r,n,i=e.limits[0],s=e.limits[1];if(i<s)n=i,r=s;else if(s<i)n=s,r=i;else return{setValue:{booleanOperator:()=>!1}};let o=e.strict;return{setValue:{booleanOperator:function(l){if(l.length===0)return!1;if(l.length!==1)return console.warn("IsBetween requires exactly one math child"),null;let u=l[0].evaluate_to_constant();return o?u>n&&u<r:u>=n&&u<=r}}}}},t}};T(x2,"componentType","isBetween");var X2={};st(X2,{Abs:()=>M2,Ceil:()=>F2,ClampNumber:()=>I2,ConvertSetToList:()=>k2,Count:()=>z2,ExtractMath:()=>$2,Floor:()=>j2,Gcd:()=>W2,Max:()=>H2,Mean:()=>L2,Min:()=>G2,Mod:()=>q2,Product:()=>D2,Round:()=>_2,Sign:()=>B2,StandardDeviation:()=>U2,Sum:()=>O2,Variance:()=>Th,WrapNumberPeriodic:()=>P2});import au from"math-expressions";var jr=class extends ot{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.forceSymbolic={createComponentOfType:"boolean",createStateVariable:"forceSymbolic",defaultValue:!1,public:!0},e.forceNumeric={createComponentOfType:"boolean",createStateVariable:"forceNumeric",defaultValue:!1,public:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=r.reduce(function(i,s){return typeof s=="string"?[...i,...s.split(/\s+/).filter(o=>o).map(o=>({componentType:Number.isFinite(Number(o))?"number":"math",children:[o]}))]:[...i,s]},[]);return{success:!0,newChildren:n}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"maths",componentTypes:["math"]},{group:"numbers",componentTypes:["number"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.isNumericOperator={returnDependencies:()=>({forceNumeric:{dependencyType:"stateVariable",variableName:"forceNumeric"},forceSymbolic:{dependencyType:"stateVariable",variableName:"forceSymbolic"},mathChildren:{dependencyType:"child",childGroups:["maths"],variableNames:["isNumber"],variablesOptional:!0}}),definition({dependencyValues:e}){let r;return e.forceNumeric?r=!0:e.forceSymbolic?r=!1:e.mathChildren.length===0?r=!0:r=e.mathChildren.every(n=>n.stateValues.isNumber),{setValue:{isNumericOperator:r}}}},delete t.codePre,delete t.expressionWithCodes,delete t.mathChildrenFunctionSymbols,delete t.codesAdjacentToStrings,delete t.mathChildrenByVectorComponent,t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:e=>au.fromAst("\uFF3F")}})},t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:e=>au.fromAst("\uFF3F")}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{inverseMathOperator:null}})},t.inverseNumericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{inverseNumericOperator:null}})},t.unnormalizedValue={returnDependencies:()=>({mathNumberChildren:{dependencyType:"child",childGroups:["maths","numbers"],variableNames:["value"]},isNumericOperator:{dependencyType:"stateVariable",variableName:"isNumericOperator"},mathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"},numericOperator:{dependencyType:"stateVariable",variableName:"numericOperator"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"inverseMathOperator"},inverseNumericOperator:{dependencyType:"stateVariable",variableName:"inverseNumericOperator"}}),definition:function({dependencyValues:e,componentInfoObjects:r}){if(e.mathNumberChildren.length===0)return{setValue:{unnormalizedValue:au.fromAst("\uFF3F")}};if(e.isNumericOperator){let n=[];for(let i of e.mathNumberChildren)if(r.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"number"}))n.push(i.stateValues.value);else{let s=i.stateValues.value.evaluate_to_constant();Number.isFinite(s)||(s=NaN),n.push(s)}return{setValue:{unnormalizedValue:au.fromAst(e.numericOperator(n))}}}else{let n=[];for(let i of e.mathNumberChildren)r.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"number"})?n.push(au.fromAst(i.stateValues.value)):n.push(i.stateValues.value);return{setValue:{unnormalizedValue:e.mathOperator(n)}}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){if(r.mathNumberChildren.length===0)return{success:!1};if(r.isNumericOperator)if(r.inverseNumericOperator){let n=[];for(let s of r.mathNumberChildren)if(componentInfoObjects.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"number"}))n.push(s.stateValues.value);else{let o=s.stateValues.value.evaluate_to_constant();Number.isFinite(o)||(o=NaN),n.push(o)}let i=r.inverseNumericOperator({desiredValue:e.unnormalizedValue.evaluate_to_constant(),inputs:n});return i.success?{success:!0,instructions:[{setDependency:"mathNumberChildren",desiredValue:i.inputValue,childIndex:i.inputNumber,variableIndex:0}]}:{success:!1}}else return{success:!1};else if(r.inverseMathOperator){let n=[];for(let s of r.mathNumberChildren)componentInfoObjects.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"number"})?n.push(au.fromAst(s.stateValues.value)):n.push(s.stateValues.value);let i=r.inverseMathOperator({desiredValue:e.unnormalizedValue,inputs:n});return i.success?{success:!0,instructions:[{setDependency:"mathNumberChildren",desiredValue:i.inputValue,childIndex:i.inputNumber,variableIndex:0}]}:{success:!1}}else return{success:!1}}},t.canBeModified={returnDependencies:()=>({modifyIndirectly:{dependencyType:"stateVariable",variableName:"modifyIndirectly"},fixed:{dependencyType:"stateVariable",variableName:"fixed"},mathNumberChildren:{dependencyType:"child",childGroups:["maths","numbers"]},isNumericOperator:{dependencyType:"stateVariable",variableName:"isNumericOperator"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"},inverseNumericOperator:{dependencyType:"stateVariable",variableName:"inverseNumericOperator"}}),definition:function({dependencyValues:e}){return{setValue:{canBeModified:e.modifyIndirectly&&!e.fixed&&e.mathNumberChildren.length===1&&(e.isNumericOperator?e.inverseNumericOperator:e.inverseMathOperator)}}}},t}};T(jr,"componentType","_mathOperator"),T(jr,"rendererType","math");var Mr=class extends ot{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:e=>me.fromAst("\uFF3F")}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{inverseMathOperator:null}})},$r({stateVariableDefinitions:t,oldName:"unnormalizedValue",newName:"unnormalizedValuePreOperator"}),t.unnormalizedValue={returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"unnormalizedValuePreOperator"},mathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"inverseMathOperator"}}),definition:function({dependencyValues:e}){return{setValue:{unnormalizedValue:e.mathOperator(e.value)}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r,componentName:n}){if(r.inverseMathOperator){let i=r.inverseMathOperator(e.unnormalizedValue);return{success:!0,instructions:[{setDependency:"value",desiredValue:i}]}}else return{success:!1}}},$r({stateVariableDefinitions:t,oldName:"canBeModified",newName:"canBeModifiedPreOperator"}),t.canBeModified={returnDependencies:()=>({canBeModifiedPreOperator:{dependencyType:"stateVariable",variableName:"canBeModifiedPreOperator"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"}}),definition:function({dependencyValues:e}){let r=e.canBeModifiedPreOperator;return e.inverseMathOperator||(r=!1),{setValue:{canBeModified:r}}}},t}};T(Mr,"componentType","_mathOperatorOneInput"),T(Mr,"rendererType","math");import be from"math-expressions";var O2=class extends jr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:function(e){return e.reduce((r,n)=>r+n)}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){return e.reduce((r,n)=>r.add(n))}}})},t}};T(O2,"componentType","sum");var D2=class extends jr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:function(e){return e.reduce((r,n)=>r*n)}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){return e.reduce((r,n)=>r.multiply(n))}}})},t}};T(D2,"componentType","product");var I2=class extends Mr{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.lowerValue={createComponentOfType:"number",createStateVariable:"lowerValue",defaultValue:0,public:!0},e.upperValue={createComponentOfType:"number",createStateVariable:"upperValue",defaultValue:1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.isNumericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{isNumericOperator:!0}})},t.mathOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:({dependencyValues:e})=>({setValue:{mathOperator:function(r){return Fx({value:r,lowerValue:e.lowerValue,upperValue:e.upperValue})}}})},t.inverseMathOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:({dependencyValues:e})=>({setValue:{inverseMathOperator:function(r){return Fx({value:r,lowerValue:e.lowerValue,upperValue:e.upperValue})}}})},t}};T(I2,"componentType","clampNumber");function Fx({value:a,lowerValue:t,upperValue:e}){let r=a;return r instanceof be.class&&(r=r.evaluate_to_constant()),Number.isFinite(r)?be.fromAst(Math.max(t,Math.min(e,r))):be.fromAst(NaN)}var P2=class extends Mr{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.lowerValue={createComponentOfType:"number",createStateVariable:"lowerValue",defaultValue:0,public:!0},e.upperValue={createComponentOfType:"number",createStateVariable:"upperValue",defaultValue:1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.isNumericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{isNumericOperator:!0}})},t.mathOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:({dependencyValues:e})=>({setValue:{mathOperator:function(r){return jx({value:r,lowerValue:e.lowerValue,upperValue:e.upperValue})}}})},t.inverseMathOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:({dependencyValues:e})=>({setValue:{inverseMathOperator:function(r){return jx({value:r,lowerValue:e.lowerValue,upperValue:e.upperValue})}}})},t}};T(P2,"componentType","wrapNumberPeriodic");function jx({value:a,lowerValue:t,upperValue:e}){let r=a;return r instanceof be.class&&(r=r.evaluate_to_constant()),Number.isFinite(r)?t===e?be.fromAst(t):(t>e&&([e,t]=[t,e]),be.fromAst(t+be.math.mod(r-t,e-t))):be.fromAst(NaN)}var _2=class extends Mr{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.numberDecimals={createComponentOfType:"number",createStateVariable:"numberDecimals",defaultValue:0,public:!0},e.numberDigits={createComponentOfType:"number",createStateVariable:"numberDigits",defaultValue:null,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({numberDecimals:{dependencyType:"stateVariable",variableName:"numberDecimals"},numberDigits:{dependencyType:"stateVariable",variableName:"numberDigits"}}),definition:({dependencyValues:e})=>({setValue:{mathOperator:function(r){let n=r.evaluate_numbers({max_digits:1/0,evaluate_functions:!0});return e.numberDigits!==null?n.round_numbers_to_precision(e.numberDigits):n.round_numbers_to_decimals(e.numberDecimals)}}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{inverseMathOperator:e=>e}})},t}};T(_2,"componentType","round");var k2=class extends Mr{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.unordered,e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.unordered={returnDependencies:()=>({}),definition:()=>({setValue:{unordered:!0}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){if(e!==void 0&&Array.isArray(e.tree)&&e.tree[0]==="set"){let r=[];for(let n of e.tree.slice(1))r.some(i=>e.context.equalsViaSyntax(e.context.fromAst(i),e.context.fromAst(n)))||r.push(n);return e.context.fromAst(["list",...r])}return e}}})},t}};T(k2,"componentType","convertSetToList");var F2=class extends Mr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){let r=e.evaluate_to_constant();if(!Number.isFinite(r))return be.fromAst(["apply","ceil",e.tree]);let n=Math.round(r);return Math.abs((n-r)/r)<1e-15?be.fromAst(n):be.fromAst(Math.ceil(r))}}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{inverseMathOperator:e=>e}})},t}};T(F2,"componentType","ceil");var j2=class extends Mr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){let r=e.evaluate_to_constant();if(!Number.isFinite(r))return be.fromAst(["apply","floor",e.tree]);let n=Math.round(r);return Math.abs((n-r)/r)<1e-15?be.fromAst(n):be.fromAst(Math.floor(r))}}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{inverseMathOperator:e=>e}})},t}};T(j2,"componentType","floor");var M2=class extends Mr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){let r=e.evaluate_to_constant();return Number.isFinite(r)?be.fromAst(Math.abs(r)):be.fromAst(["apply","abs",e.tree])}}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{inverseMathOperator:function(e){let r=e,n=e.evaluate_to_constant();return Number.isFinite(n)?n<0&&(r=be.fromAst(0)):Array.isArray(e.tree)&&e.tree[0]==="apply"&&e.tree[1]==="abs"&&(r=be.fromAst(e.tree[2])),r}}})},t}};T(M2,"componentType","abs");var B2=class extends Mr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){let r=e.evaluate_to_constant();return Number.isFinite(r)?be.fromAst(Math.sign(r)):be.fromAst(["apply","sign",e.tree])}}})},t}};T(B2,"componentType","sign");var L2=class extends jr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:function(e){let r=e.reduce((n,i)=>n+i);return r/=e.length,r}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){return e.reduce((r,n)=>r.add(n)).divide(e.length)}}})},t}};T(L2,"componentType","mean");var Th=class extends jr{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.population={createComponentOfType:"boolean",createStateVariable:"population",defaultValue:!1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({population:{dependencyType:"stateVariable",variableName:"population"}}),definition:({dependencyValues:e})=>({setValue:{numericOperator:function(r){return Mx(r,e.population)}}})},t.mathOperator={returnDependencies:()=>({population:{dependencyType:"stateVariable",variableName:"population"}}),definition:({dependencyValues:e})=>({setValue:{mathOperator:function(r){return Bx(r,e.population)}}})},t}};T(Th,"componentType","variance");function Mx(a,t){let e=0,r=0;for(let i of a)e+=i,r+=i*i;let n=a.length;return r-=e**2/n,t?r/=n:r/=n-1,r}function Bx(a,t){let e=a.length,r=a.reduce((i,s)=>i.add(s)),n=a.slice(1).reduce((i,s)=>i.add(s.pow(2)),a[0].pow(2)).subtract(r.pow(2).divide(e));return t?n=n.divide(e):n=n.divide(e-1),n}var U2=class extends Th{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator.definition=({dependencyValues:e})=>({setValue:{numericOperator:function(r){return Math.sqrt(Mx(r,e.population))}}}),t.mathOperator.definition=({dependencyValues:e})=>({setValue:{mathOperator:function(r){return be.fromAst(["apply","sqrt",Bx(r,e.population).tree])}}}),t}};T(U2,"componentType","standardDeviation");var z2=class extends jr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.isNumericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{isNumericOperator:!0}})},t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:function(e){return e.length}}})},t}};T(z2,"componentType","count");var G2=class extends jr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:function(e){return e.reduce((r,n)=>Math.min(r,n),1/0)}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){return be.fromAst(["apply","min",["tuple",...e.map(r=>r.tree)]])}}})},t}};T(G2,"componentType","min");var H2=class extends jr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:function(e){return e.reduce((r,n)=>Math.max(r,n),-1/0)}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){return be.fromAst(["apply","max",["tuple",...e.map(r=>r.tree)]])}}})},t}};T(H2,"componentType","max");var q2=class extends jr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:function(e){return e.length!==2?NaN:be.math.mod(e[0],e[1])}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){return e.length!==2?be.fromAst("\uFF3F"):be.fromAst(["apply","mod",["tuple",...e.map(r=>r.tree)]])}}})},t}};T(q2,"componentType","mod");var W2=class extends jr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({setValue:{numericOperator:function(e){return e.every(Number.isInteger)?K2(...e):NaN}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({setValue:{mathOperator:function(e){return be.fromAst(["apply","gcd",["tuple",...e.map(r=>r.tree)]])}}})},t}};T(W2,"componentType","gcd");var $2=class extends Mr{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.type={createComponentOfType:"text",createStateVariable:"type",defaultValue:null,toLowerCase:!0,validValues:["operand","function","functionargument","numberofoperands"]},e.operandNumber={createComponentOfType:"number",createStateVariable:"operandNumber",defaultValue:null,public:!0},e.argumentNumber={createComponentOfType:"number",createStateVariable:"argumentNumber",defaultValue:null,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},operandNumber:{dependencyType:"stateVariable",variableName:"operandNumber"},argumentNumber:{dependencyType:"stateVariable",variableName:"argumentNumber"}}),definition({dependencyValues:e}){return e.type==="operand"?e.operandNumber===null?(console.warn("Must specify a operandNumber when extracting a math operand"),{setValue:{mathOperator:r=>be.fromAst("\uFF3F")}}):{setValue:{mathOperator:function(r){let n=r.tree;if(!Array.isArray(n))return e.operandNumber===1?r:be.fromAst("\uFF3F");if(n[0]==="apply")return e.operandNumber===1?r:be.fromAst("\uFF3F");let s=n[e.operandNumber];return s===void 0?be.fromAst("\uFF3F"):be.fromAst(s)}}}:e.type==="function"?{setValue:{mathOperator:function(r){let n=r.tree;return Array.isArray(n)?n[0]!=="apply"?be.fromAst("\uFF3F"):be.fromAst(n[1]):be.fromAst("\uFF3F")}}}:e.type==="functionargument"?{setValue:{mathOperator:function(r){let n=r.tree;if(!Array.isArray(n))return be.fromAst("\uFF3F");if(n[0]!=="apply")return be.fromAst("\uFF3F");let s=n[2];if(e.argumentNumber===null)return be.fromAst(s);if(e.argumentNumber===1)return Array.isArray(s)&&s[0]==="tuple"?be.fromAst(s[1]):be.fromAst(s);if(Array.isArray(s)&&s[0]==="tuple"){let o=s[e.argumentNumber];return o===void 0?be.fromAst("\uFF3F"):be.fromAst(o)}else return be.fromAst("\uFF3F")}}}:e.type==="numberofoperands"?{setValue:{mathOperator:function(r){let n=r.tree;return Array.isArray(n)?n[0]==="apply"?be.fromAst(1):be.fromAst(n.length-1):be.fromAst(1)}}}:{setValue:{mathOperator:r=>be.fromAst("_")}}}},t}};T($2,"componentType","extractMath");function K2(a,t,...e){return!t&&e.length>0?K2(a,...e):t?K2(t,a%t,...e):a}var nT={};st(nT,{ClampFunction:()=>eT,Derivative:()=>rT,WrapFunctionPeriodic:()=>tT});import La from"math-expressions";var nm={lineColor:{componentType:"text"},lineWidth:{componentType:"number"},lineStyle:{componentType:"text"},markerColor:{componentType:"text"},markerStyle:{componentType:"text"},markerSize:{componentType:"number"},fillColor:{componentType:"text"}},Lx={lineColor:"blue",lineWidth:4,lineStyle:"solid",markerColor:"blue",markerStyle:"circle",markerSize:3,fillColor:"none"};function Ux(){return{1:{lineColor:"#648FFF",lineWidth:4,lineStyle:"solid",markerColor:"#648FFF",markerStyle:"circle",markerSize:3,fillColor:"none"},2:{lineColor:"#D4042D",lineWidth:2,lineStyle:"solid",markerColor:"#D4042D",markerStyle:"square",markerSize:4,fillColor:"none"},3:{lineColor:"#F19143",lineWidth:3,lineStyle:"solid",markerColor:"#F19143",markerStyle:"triangle",markerSize:5,fillColor:"none"},4:{lineColor:"#644CD6",lineWidth:2,lineStyle:"solid",markerColor:"#644CD6",markerStyle:"diamond",markerSize:4,fillColor:"none"},5:{lineColor:"black",lineWidth:1,lineStyle:"solid",markerColor:"black",markerStyle:"circle",markerSize:2,fillColor:"none"},6:{lineColor:"gray",lineWidth:1,lineStyle:"dotted",markerColor:"gray",markerStyle:"circle",markerSize:2,fillColor:"none"}}}function Nh(){let a={};return a.setupChildren={returnDependencies:()=>({setupChildren:{dependencyType:"child",childGroups:["setups"],proceedIfAllChildrenNotMatched:!0}}),definition({dependencyValues:t}){return{setValue:{setupChildren:t.setupChildren}}}},a.styleDefinitions={stateVariablesDeterminingDependencies:["setupChildren"],returnDependencies({stateValues:t}){let e={ancestorWithStyle:{dependencyType:"ancestor",variableNames:["styleDefinitions"]},setupChildren:{dependencyType:"child",childGroups:["setups"],proceedIfAllChildrenNotMatched:!0}};for(let r of t.setupChildren)e[`styleDefinitionsOf${r.componentName}`]={dependencyType:"child",parentName:r.componentName,childGroups:["styleDefinitions"],variableNames:["value"]};return e},definition({dependencyValues:t}){let e={},r;t.ancestorWithStyle&&(r=t.ancestorWithStyle.stateValues.styleDefinitions),r||(r=Ux());for(let i in r)e[i]=Object.assign({},r[i]);let n=[];for(let i of t.setupChildren)n.push(...t[`styleDefinitionsOf${i.componentName}`]);for(let i of n){let s=i.stateValues.value;for(let o in s){let l=e[o];l||(l=e[o]=Object.assign({},Lx)),Object.assign(l,s[o])}}return{setValue:{styleDefinitions:e}}}},a}function Ch(){return{selectedStyle:{forRenderer:!0,willNeverBeEssential:!0,returnDependencies:()=>({styleNumber:{dependencyType:"stateVariable",variableName:"styleNumber"},ancestorWithStyle:{dependencyType:"ancestor",variableNames:["styleDefinitions"]}}),definition:function({dependencyValues:a}){let t=a.ancestorWithStyle.stateValues.styleDefinitions;t||(t=Ux());let e=t[a.styleNumber];return e===void 0&&(e=Lx),{setValue:{selectedStyle:e}}}}}}import Ah from"math-expressions";function iu({formula:a,nInputs:t,variables:e,domain:r,component:n=0}){if(n=Number(n),Array.isArray(a.tree)&&["tuple","vector"].includes(a.tree[0]))try{a=a.get_component(Number(n))}catch(l){return()=>NaN}else if(n!==0)return()=>NaN;let s;try{s=a.subscripts_to_strings().f()}catch(l){return()=>NaN}if(t===1){let l=e[0].subscripts_to_strings().tree,u=-1/0,c=1/0;if(r!==null){let p=r[0];if(p!==void 0)try{u=p[0].evaluate_to_constant(),Number.isFinite(u)||(u=-1/0),c=p[1].evaluate_to_constant(),Number.isFinite(c)||(c=1/0)}catch(m){}}return function(p){if(p<u||p>c)return NaN;try{return s({[l]:p})}catch(m){return NaN}}}let o=[];for(let l=0;l<t;l++)o.push(e[l].subscripts_to_strings().tree);return function(...l){let u={};for(let c=0;c<t;c++)u[o[c]]=l[c];try{return s(u)}catch(c){return NaN}}}function su(a,t){let e=a.formula;if(Array.isArray(e.tree)&&["tuple","vector"].includes(e.tree[0]))try{e=e.get_component(Number(t))}catch(l){return u=>Ah.fromAst("\uFF3F")}else if(t!=="0")return l=>Ah.fromAst("\uFF3F");let n=a.simplify,i=a.expand,s=e.subscripts_to_strings();if(a.nInputs===1){let l=a.variables[0].subscripts_to_strings().tree;return u=>Wr({value:s.substitute({[l]:u}).strings_to_subscripts(),simplify:n,expand:i})}let o=[];for(let l=0;l<a.nInputs;l++)o.push(a.variables[l].subscripts_to_strings().tree);return function(...l){let u={};for(let c=0;c<a.nInputs;c++)u[o[c]]=l[c];return Wr({value:s.substitute(u).strings_to_subscripts(),simplify:n,expand:i})}}function zx({nThroughPoints:a,numericalThroughPoints:t,splineCoeffs:e,extrapolateForward:r,extrapolateForwardCoeffs:n,extrapolateBackward:i,extrapolateBackwardCoeffs:s}){if(a<1){let u={};for(let c=0;c<2;c++)u[c]=()=>NaN;return u}let o=a-1,l={};for(let u=0;u<2;u++){let c=t[0][u],p=t[o][u],m=e.map(h=>h[u]),f;i&&(f=s[u]);let d;r&&(d=n[u]),l[u]=function(h){if(isNaN(h))return NaN;if(h<0)return i?(f[2]*h+f[1])*h+f[0]:c;if(h>=o)return r?(h-=o,(d[2]*h+d[1])*h+d[0]):p;let y=Math.floor(h);h-=y;let b=m[y];return((b[3]*h+b[2])*h+b[1])*h+b[0]}}return l}function Y2({xs:a,coeffs:t,interpolationPoints:e,domain:r}){let n=[];if(e&&(n=e.map(u=>u.y)),a===null)return u=>NaN;let i=-1/0,s=1/0;if(r!==null&&(r=r[0],r!==void 0))try{i=r[0].evaluate_to_constant(),Number.isFinite(i)||(i=-1/0),s=r[1].evaluate_to_constant(),Number.isFinite(s)||(s=1/0)}catch(u){}let o=a[0],l=a[a.length-1];return function(u){if(isNaN(u)||u<i||u>s)return NaN;if(u<=o){u-=o;let h=t[0];return((h[3]*u+h[2])*u+h[1])*u+h[0]}if(u>=l){let h=a.length-2;u-=a[h];let y=t[h];return((y[3]*u+y[2])*u+y[1])*u+y[0]}for(var c=0,p,m=a.length-1;c<=m;){p=Math.floor(.5*(c+m));let h=a[p];if(h<u)c=p+1;else if(h>u)m=p-1;else return n[p]}let f=Math.max(0,m);u-=a[f];let d=t[f];return((d[3]*u+d[2])*u+d[1])*u+d[0]}}function Z2({xs:a,coeffs:t,variables:e}){if(!a)return s=>NaN;let r=e[0].subscripts_to_strings().tree,n=a[0],i=a[a.length-1];return function(s){let o=s.map(u=>u.subscripts_to_strings().tree),l=o.length;return l>3||!o.every(u=>u===r)||o.includes("\uFF3F")?u=>0:l===0||a===null?u=>NaN:function(u){if(isNaN(u))return NaN;if(u<=n){u-=n;let h=t[0];return l===1?(3*h[3]*u+2*h[2])*u+h[1]:l===2?6*h[3]*u+2*h[2]:6*h[3]}if(u>=i){let h=a.length-2;u-=a[h];let y=t[h];return l===1?(3*y[3]*u+2*y[2])*u+y[1]:l===2?6*y[3]*u+2*y[2]:6*y[3]}for(var c=0,p,m=a.length-1;c<=m;){p=Math.floor(.5*(c+m));let h=a[p];if(h<u)c=p+1;else if(h>u)m=p-1;else return l===1?t[p][1]:l===2?2*t[p][2]:6*t[p][3]}let f=Math.max(0,m);u-=a[f];let d=t[f];return l===1?(3*d[3]*u+2*d[2])*u+d[1]:l===2?6*d[3]*u+2*d[2]:6*d[3]}}}var J2={clampFunction:function(a,t){return function(e){return Number.isFinite(e)?Math.max(a,Math.min(t,e)):NaN}},wrapFunctionPeriodic:function(a,t){return function(e){if(!Number.isFinite(e))return NaN;let r=a,n=t;return r===n?r:(r>n&&([n,r]=[r,n]),r+Ah.math.mod(e-r,n-r))}},derivative:function(a,t){if(console.log("derivative def",a,t),a.derivativeType==="interpolatedFunction"){let e=Z2({xs:a.xs,coeffs:a.coeffs,variables:a.variables.map(se)}),r=t.map(se);if(a.additionalDerivVariables&&(r=[...a.additionalDerivVariables.map(se),...r]),a.variableMappings)for(let i of a.variableMappings){let s=[];for(let o of r){let l=i[o.subscripts_to_strings().tree];l?s.push(se(l)):s.push(Ah.fromAst("\uFF3F"))}r=s}return e(r)}else return e=>NaN}};var Ua=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.simplify={createComponentOfType:"text",createStateVariable:"simplifySpecified",defaultValue:"none",toLowerCase:!0,valueTransformations:{true:"full"},validValues:["none","full","numbers","numberspreserveorder"]},e.expand={createComponentOfType:"boolean",createStateVariable:"expandSpecified",defaultValue:!1,public:!0},e.xscale={createComponentOfType:"number",createStateVariable:"xscale",defaultValue:1,public:!0},e.yscale={createComponentOfType:"number",createStateVariable:"yscale",defaultValue:1,public:!0},e.nInputs={createComponentOfType:"integer"},e.nOutputs={createComponentOfType:"integer"},e.domain={createComponentOfType:"_pointListComponent"},e.label={createComponentOfType:"text",createStateVariable:"label",defaultValue:"",public:!0,forRenderer:!0},e.showLabel={createComponentOfType:"boolean",createStateVariable:"showLabel",defaultValue:!0,public:!0,forRenderer:!0},e.labelPosition={createComponentOfType:"text",createStateVariable:"labelPosition",defaultValue:"upperright",public:!0,forRenderer:!0,toLowerCase:!0,validValues:["upperright","upperleft","lowerright","lowerleft","top","bottom","left","right"]},e.layer={createComponentOfType:"number",createStateVariable:"layer",defaultValue:0,public:!0,forRenderer:!0},e.minima={createComponentOfType:"extrema"},e.maxima={createComponentOfType:"extrema"},e.extrema={createComponentOfType:"extrema"},e.through={createComponentOfType:"_pointListComponent"},e.throughSlopes={createComponentOfType:"mathList"},e.variables={createComponentOfType:"variables"},e.symbolic={createComponentOfType:"boolean"},e.displayDigits={createComponentOfType:"integer"},e.displayDecimals={createComponentOfType:"integer"},e.displaySmallAsZero={createComponentOfType:"number",valueForTrue:1e-14,valueForFalse:0},e.fDefinition={leaveRaw:!0,createStateVariable:"fDefinitionAttr",defaultValue:null},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){return r.length===1&&typeof r[0]!="string"||r.length===0?{success:!1}:{success:!0,newChildren:[{componentType:"math",children:r}]}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"maths",componentTypes:["math"]},{group:"functions",componentTypes:["function"]}]}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions(),r=Ch();return Object.assign(e,r),e.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:n}){let i="";return n.selectedStyle.lineWidth>=4?i+="thick ":n.selectedStyle.lineWidth<=1&&(i+="thin "),n.selectedStyle.lineStyle==="dashed"?i+="dashed ":n.selectedStyle.lineStyle==="dotted"&&(i+="dotted "),i+=n.selectedStyle.lineColor,{setValue:{styleDescription:i}}}},e.displayDigits={public:!0,componentType:"integer",defaultValue:10,hasEssential:!0,returnDependencies:()=>({displayDecimalsAttr:{dependencyType:"attributeComponent",attributeName:"displayDigits",variableNames:["value"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["displayDigits"]}}),definition({dependencyValues:n,usedDefault:i}){return n.displayDecimalsAttr!==null?{setValue:{displayDigits:n.displayDecimalsAttr.stateValues.value}}:n.functionChild.length>0&&!i.functionChild[0]?{setValue:{displayDigits:n.functionChild[0].stateValues.displayDigits}}:{useEssentialOrDefaultValue:{displayDigits:!0}}}},e.displayDecimals={public:!0,componentType:"integer",defaultValue:10,hasEssential:!0,returnDependencies:()=>({displayDecimalsAttr:{dependencyType:"attributeComponent",attributeName:"displayDecimals",variableNames:["value"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["displayDecimals"]}}),definition({dependencyValues:n,usedDefault:i}){return n.displayDecimalsAttr!==null?{setValue:{displayDecimals:n.displayDecimalsAttr.stateValues.value}}:n.functionChild.length>0&&!i.functionChild[0]?{setValue:{displayDecimals:n.functionChild[0].stateValues.displayDecimals}}:{useEssentialOrDefaultValue:{displayDecimals:!0}}}},e.displaySmallAsZero={public:!0,componentType:"number",defaultValue:0,hasEssential:!0,returnDependencies:()=>({displayDecimalsAttr:{dependencyType:"attributeComponent",attributeName:"displaySmallAsZero",variableNames:["value"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["displaySmallAsZero"]}}),definition({dependencyValues:n,usedDefault:i}){return n.displayDecimalsAttr!==null?{setValue:{displaySmallAsZero:n.displayDecimalsAttr.stateValues.value}}:n.functionChild.length>0&&!i.functionChild[0]?{setValue:{displaySmallAsZero:n.functionChild[0].stateValues.displaySmallAsZero}}:{useEssentialOrDefaultValue:{displaySmallAsZero:!0}}}},e.isInterpolatedFunction={returnDependencies:()=>({through:{dependencyType:"attributeComponent",attributeName:"through"},minima:{dependencyType:"attributeComponent",attributeName:"minima"},maxima:{dependencyType:"attributeComponent",attributeName:"maxima"},extrema:{dependencyType:"attributeComponent",attributeName:"extrema"}}),definition({dependencyValues:n}){return{setValue:{isInterpolatedFunction:n.through||n.minima||n.maxima||n.extrema}}}},e.nInputs={defaultValue:1,public:!0,componentType:"integer",hasEssential:!0,returnDependencies:()=>({nInputsAttr:{dependencyType:"attributeComponent",attributeName:"nInputs",variableNames:["value"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["nInputs"]},variablesAttr:{dependencyType:"attributeComponent",attributeName:"variables",variableNames:["nComponents"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}),definition({dependencyValues:n}){if(n.isInterpolatedFunction)return{setValue:{nInputs:1}};if(n.nInputsAttr!==null){let i=n.nInputsAttr.stateValues.value;return i>=0||(i=1),{setValue:{nInputs:i}}}else return n.variablesAttr!==null?{setValue:{nInputs:Math.max(1,n.variablesAttr.stateValues.nComponents)}}:n.functionChild.length>0?{setValue:{nInputs:n.functionChild[0].stateValues.nInputs}}:{useEssentialOrDefaultValue:{nInputs:!0}}}},e.nOutputs={defaultValue:1,hasEssential:!0,public:!0,componentType:"integer",returnDependencies:()=>({nOutputsAttr:{dependencyType:"attributeComponent",attributeName:"nOutputs",variableNames:["value"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["nOutputs"]},mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]}}),definition({dependencyValues:n}){if(n.functionChild.length>0)return{setValue:{nOutputs:n.functionChild[0].stateValues.nOutputs}};if(n.nOutputsAttr!==null){let i=n.nOutputsAttr.stateValues.value;return i>=0||(i=1),{setValue:{nOutputs:i}}}else if(n.mathChild.length>0){let i=n.mathChild[0].stateValues.value,s=Array.isArray(i.tree)&&["tuple","vector"].includes(i.tree[0]),o=1;return s&&(o=i.tree.length-1),{setValue:{nOutputs:o}}}else return{useEssentialOrDefaultValue:{nOutputs:!0}}}},e.domain={defaultValue:null,hasEssential:!0,returnDependencies:()=>({domainAttr:{dependencyType:"attributeComponent",attributeName:"domain",variableNames:["points"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["domain"]}}),definition({dependencyValues:n}){return n.domainAttr!==null?{setValue:{domain:n.domainAttr.stateValues.points}}:n.functionChild.length>0?{setValue:{domain:n.functionChild[0].stateValues.domain}}:{useEssentialOrDefaultValue:{domain:!0}}}},e.simplify={public:!0,componentType:"text",returnDependencies:()=>({simplifySpecified:{dependencyType:"stateVariable",variableName:"simplifySpecified"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["simplify"]}}),definition({dependencyValues:n,usedDefault:i}){return i.simplifySpecified&&n.functionChild.length>0?{setValue:{simplify:n.functionChild[0].stateValues.simplify}}:{setValue:{simplify:n.simplifySpecified}}},inverseDefinition({desiredStateVariableValues:n,dependencyValues:i,usedDefault:s}){return s.simplifySpecified&&i.functionChild.length>0?{success:!0,instructions:[{setDependency:"functionChild",desiredValue:n.simplify,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setDependency:"simplifySpecified",desiredValue:n.simplify}]}}},e.expand={public:!0,componentType:"text",returnDependencies:()=>({expandSpecified:{dependencyType:"stateVariable",variableName:"expandSpecified"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["expand"]}}),definition({dependencyValues:n,usedDefault:i}){return i.expandSpecified&&n.functionChild.length>0?{setValue:{expand:n.functionChild[0].stateValues.expand}}:{setValue:{expand:n.expandSpecified}}},inverseDefinition({desiredStateVariableValues:n,dependencyValues:i,usedDefault:s}){return s.expandSpecified&&i.functionChild.length>0?{success:!0,instructions:[{setDependency:"functionChild",desiredValue:n.expand,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setDependency:"expandSpecified",desiredValue:n.expand}]}}},e.numericalfShadow={defaultValue:null,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{numericalfShadow:!0}})},e.symbolicfShadow={defaultValue:null,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{symbolicfShadow:!0}})},e.symbolic={public:!0,componentType:"boolean",defaultValue:!1,hasEssential:!0,returnDependencies:()=>({symbolicAttr:{dependencyType:"attributeComponent",attributeName:"symbolic",variableNames:["value"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["symbolic"]},numericalfShadow:{dependencyType:"stateVariable",variableName:"numericalfShadow"},symbolicfShadow:{dependencyType:"stateVariable",variableName:"symbolicfShadow"}}),definition({dependencyValues:n}){return n.symbolicAttr!==null?{setValue:{symbolic:n.symbolicAttr.stateValues.value}}:n.functionChild.length>0?{setValue:{symbolic:n.functionChild[0].stateValues.symbolic}}:n.numericalfShadow?{setValue:{symbolic:!1}}:n.symbolicfShadow?{setValue:{symbolic:!0}}:{useEssentialOrDefaultValue:{symbolic:!0}}}},e.variables={isArray:!0,public:!0,componentType:"variable",entryPrefixes:["variable"],returnArraySizeDependencies:()=>({nInputs:{dependencyType:"stateVariable",variableName:"nInputs"}}),returnArraySize({dependencyValues:n}){return[n.nInputs]},returnArrayDependenciesByKey({arrayKeys:n}){let i={variablesAttr:{dependencyType:"attributeComponent",attributeName:"variables",variableNames:["variables"]},parentVariableForChild:{dependencyType:"parentStateVariable",variableName:"variableForChild"},functionChild:{dependencyType:"child",childGroups:["functions"]}},s={};for(let o of n)s[o]={functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["variable"+(Number(o)+1)]}};return{globalDependencies:i,dependenciesByKey:s}},arrayDefinitionByKey({globalDependencyValues:n,dependencyValuesByKey:i,arraySize:s,arrayKeys:o,usedDefault:l}){if(n.variablesAttr!==null){let u=n.variablesAttr.stateValues.variables;return{setValue:{variables:En(s[0],u)}}}else if(n.functionChild.length>0){let u={};for(let c of o)u[c]=i[c].functionChild[0].stateValues["variable"+(Number(c)+1)];return{setValue:{variables:u}}}else return n.parentVariableForChild&&!l.parentVariableForChild?{setValue:{variables:Array(s[0]).fill(n.parentVariableForChild)}}:{setValue:{variables:En(s[0],[])}}}},e.variable={isAlias:!0,targetVariableName:"variable1"},e.formula={public:!0,componentType:"math",defaultValue:La.fromAst(0),hasEssential:!0,returnDependencies:()=>({mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["formula"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}),definition:function({dependencyValues:n,usedDefault:i}){return n.isInterpolatedFunction?{setValue:{formula:La.fromAst("\uFF3F")}}:n.mathChild.length>0?{setValue:{formula:n.mathChild[0].stateValues.value}}:n.functionChild.length>0&&!i.functionChild[0].formula?{setValue:{formula:n.functionChild[0].stateValues.formula}}:{useEssentialOrDefaultValue:{formula:!0}}}},e.nPrescribedPoints={returnDependencies:()=>({through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nPoints"]}}),definition({dependencyValues:n}){let i=0;return n.through!==null&&(i=n.through.stateValues.nPoints),{setValue:{nPrescribedPoints:i}}}},e.prescribedPoints={isArray:!0,entryPrefixes:["prescribedPoint"],returnArraySizeDependencies:()=>({nPrescribedPoints:{dependencyType:"stateVariable",variableName:"nPrescribedPoints"}}),returnArraySize({dependencyValues:n}){return[n.nPrescribedPoints]},returnArrayDependenciesByKey({arrayKeys:n}){let i={};for(let s of n){let o=Number(s)+1;i[s]={through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["point"+o]},throughSlopes:{dependencyType:"attributeComponent",attributeName:"throughSlopes",variableNames:["math"+o]}}}return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i){let l=n[o].through;if(l!==null){let u=Number(o)+1,c=l.stateValues["point"+u],p=null,m=n[o].throughSlopes;m!==null&&(p=m.stateValues["math"+u],p===void 0&&(p=null)),s[o]={x:c[0],y:c[1],slope:p}}}return{setValue:{prescribedPoints:s}}}},e.prescribedMinima={returnDependencies:()=>({minima:{dependencyType:"attributeComponent",attributeName:"minima",variableNames:["extrema"]}}),definition({dependencyValues:n}){let i=[];return n.minima!==null&&(i=n.minima.stateValues.extrema.map(s=>({x:s[0],y:s[1]}))),{setValue:{prescribedMinima:i}}}},e.prescribedMaxima={returnDependencies:()=>({maxima:{dependencyType:"attributeComponent",attributeName:"maxima",variableNames:["extrema"]}}),definition({dependencyValues:n}){let i=[];return n.maxima!==null&&(i=n.maxima.stateValues.extrema.map(s=>({x:s[0],y:s[1]}))),{setValue:{prescribedMaxima:i}}}},e.prescribedExtrema={returnDependencies:()=>({extrema:{dependencyType:"attributeComponent",attributeName:"extrema",variableNames:["extrema"]}}),definition({dependencyValues:n}){let i=[];return n.extrema!==null&&(i=n.extrema.stateValues.extrema.map(s=>({x:s[0],y:s[1]}))),{setValue:{prescribedExtrema:i}}}},e.interpolationPoints={returnDependencies:()=>({xscale:{dependencyType:"stateVariable",variableName:"xscale"},yscale:{dependencyType:"stateVariable",variableName:"yscale"},prescribedPoints:{dependencyType:"stateVariable",variableName:"prescribedPoints"},prescribedMinima:{dependencyType:"stateVariable",variableName:"prescribedMinima"},prescribedMaxima:{dependencyType:"stateVariable",variableName:"prescribedMaxima"},prescribedExtrema:{dependencyType:"stateVariable",variableName:"prescribedExtrema"}}),definition:({dependencyValues:n})=>mq({dependencyValues:n,numerics:t})},e.xs={additionalStateVariablesDefined:["coeffs"],returnDependencies:()=>({interpolationPoints:{dependencyType:"stateVariable",variableName:"interpolationPoints"}}),definition:fq},e.symbolicfs={isArray:!0,entryPrefixes:["symbolicf"],stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnArraySizeDependencies:()=>({nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"}}),returnArraySize({dependencyValues:n}){return[n.nOutputs]},returnArrayDependenciesByKey({stateValues:n}){return n.isInterpolatedFunction?{globalDependencies:{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},interpolationPoints:{dependencyType:"stateVariable",variableName:"interpolationPoints"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},domain:{dependencyType:"stateVariable",variableName:"domain"}}}:{globalDependencies:{formula:{dependencyType:"stateVariable",variableName:"formula"},variables:{dependencyType:"stateVariable",variableName:"variables"},nInputs:{dependencyType:"stateVariable",variableName:"nInputs"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["symbolicfs"]},simplify:{dependencyType:"stateVariable",variableName:"simplify"},expand:{dependencyType:"stateVariable",variableName:"expand"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},symbolicfShadow:{dependencyType:"stateVariable",variableName:"symbolicfShadow"},numericalfShadow:{dependencyType:"stateVariable",variableName:"numericalfShadow"},domain:{dependencyType:"stateVariable",variableName:"domain"}}}},arrayDefinitionByKey:function({globalDependencyValues:n,usedDefault:i,arrayKeys:s}){if(n.isInterpolatedFunction){let o={};for(let l of s)if(l==="0"){let u=Y2({xs:n.xs,coeffs:n.coeffs,interpolationPoints:n.interpolationPoints,domain:n.domain});o[l]=function(c){La.fromAst(u(c.evaluate_to_constant()))}}else o[l]=u=>La.fromAst("\uFF3F");return{setValue:{symbolicfs:o}}}else if(!i.formula&&(n.formula.tree!=="\uFF3F"||n.functionChild.length===0)){let o={};for(let l of s)o[l]=su(n,l);return{setValue:{symbolicfs:o}}}else if(n.functionChild.length>0){let o={};for(let l of s)o[l]=n.functionChild[0].stateValues.symbolicfs[l];return{setValue:{symbolicfs:o}}}else if(n.symbolicfShadow){let o={};for(let l of s)l==="0"?o[l]=n.symbolicfShadow:o[l]=u=>La.fromAst("\uFF3F");return{setValue:{symbolicfs:o}}}else if(n.numericalfShadow){let o={};for(let l of s)l==="0"?o[l]=function(u){let c=u.evaluate_to_constant();return c===null?NaN:La.fromAst(n.numericalfShadow(c))}:o[l]=u=>La.fromAst("\uFF3F");return{setValue:{symbolicfs:o}}}else{let o={};for(let l of s)o[l]=su(n,l);return{setValue:{symbolicfs:o}}}}},e.symbolicf={isAlias:!0,targetVariableName:"symbolicf1"},e.numericalfs={isArray:!0,entryPrefixes:["numericalf"],stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnArraySizeDependencies:()=>({nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"}}),returnArraySize({dependencyValues:n}){return[n.nOutputs]},returnArrayDependenciesByKey({stateValues:n}){return n.isInterpolatedFunction?{globalDependencies:{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},interpolationPoints:{dependencyType:"stateVariable",variableName:"interpolationPoints"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},domain:{dependencyType:"stateVariable",variableName:"domain"}}}:{globalDependencies:{formula:{dependencyType:"stateVariable",variableName:"formula"},variables:{dependencyType:"stateVariable",variableName:"variables"},nInputs:{dependencyType:"stateVariable",variableName:"nInputs"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["numericalfs"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},symbolicfShadow:{dependencyType:"stateVariable",variableName:"symbolicfShadow"},numericalfShadow:{dependencyType:"stateVariable",variableName:"numericalfShadow"},domain:{dependencyType:"stateVariable",variableName:"domain"}}}},arrayDefinitionByKey:function({globalDependencyValues:n,usedDefault:i,arrayKeys:s}){if(n.isInterpolatedFunction){let o={};for(let l of s)l==="0"?o[l]=Y2({xs:n.xs,coeffs:n.coeffs,interpolationPoints:n.interpolationPoints,domain:n.domain}):o[l]=u=>La.fromAst("\uFF3F");return{setValue:{numericalfs:o}}}else if(!i.formula&&(n.formula.tree!=="\uFF3F"||n.functionChild.length===0)){let o={};for(let l of s)o[l]=iu({formula:n.formula,nInputs:n.nInputs,variables:n.variables,domain:n.domain,component:l});return{setValue:{numericalfs:o}}}else if(n.functionChild.length>0){let o={};for(let l of s)o[l]=n.functionChild[0].stateValues.numericalfs[l];return{setValue:{numericalfs:o}}}else if(n.numericalfShadow){let o={};for(let l of s)l==="0"?o[l]=n.numericalfShadow:o[l]=()=>NaN;return{setValue:{numericalfs:o}}}else if(n.symbolicfShadow){let o={};for(let l of s)l==="0"?o[l]=function(u){let c=dependencyValues.symbolicfShadow(La.fromAst(u)).evaluate_to_constant();return c===null&&(c=NaN),c}:o[l]=()=>NaN;return{setValue:{numericalfs:o}}}else{let o={};for(let l of s)o[l]=iu({formula:n.formula,nInputs:n.nInputs,variables:n.variables,domain:n.domain,component:l});return{setValue:{numericalfs:o}}}}},e.numericalf={returnDependencies:()=>({numericalf1:{dependencyType:"stateVariable",variableName:"numericalf1"}}),definition({dependencyValues:n}){return{setValue:{numericalf:n.numericalf1}}}},e.fDefinition={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},interpolationPoints:{dependencyType:"stateVariable",variableName:"interpolationPoints"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},domain:{dependencyType:"stateVariable",variableName:"domain"}}:{formula:{dependencyType:"stateVariable",variableName:"formula"},variables:{dependencyType:"stateVariable",variableName:"variables"},nInputs:{dependencyType:"stateVariable",variableName:"nInputs"},nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["fDefinition"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},symbolicfShadow:{dependencyType:"stateVariable",variableName:"symbolicfShadow"},numericalfShadow:{dependencyType:"stateVariable",variableName:"numericalfShadow"},domain:{dependencyType:"stateVariable",variableName:"domain"},fDefinitionAttr:{dependencyType:"stateVariable",variableName:"fDefinitionAttr"}}},definition({dependencyValues:n,usedDefault:i}){return n.isInterpolatedFunction?{setValue:{fDefinition:{functionType:"interpolated",xs:n.xs,coeffs:n.coeffs,interpolationPoints:n.interpolationPoints,domain:n.domain}}}:!i.formula&&(n.formula.tree!=="\uFF3F"||n.functionChild.length===0)?{setValue:{fDefinition:{functionType:"formula",formula:n.formula.tree,variables:n.variables.map(s=>s.tree),nInputs:n.nInputs,nOutputs:n.nOutputs,domain:n.domain}}}:n.functionChild.length>0?{setValue:{fDefinition:n.functionChild[0].stateValues.fDefinition}}:n.fDefinitionAttr?{setValue:{fDefinition:n.fDefinitionAttr}}:n.numericalfShadow?{setValue:{fDefinition:{}}}:n.symbolicfShadow?{setValue:{fDefinition:{}}}:{setValue:{fDefinition:{functionType:"formula",formula:n.formula.tree,variables:n.variables.map(s=>s.tree),nInputs:n.nInputs,nOutputs:n.nOutputs,domain:n.domain}}}}},e.fs={isArray:!0,entryPrefixes:["f"],returnArraySizeDependencies:()=>({nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"}}),returnArraySize({dependencyValues:n}){return[n.nOutputs]},returnArrayDependenciesByKey({arrayKeys:n}){let i={symbolic:{dependencyType:"stateVariable",variableName:"symbolic"}},s={};for(let o of n){let l=Number(o)+1;s[o]={symbolicf:{dependencyType:"stateVariable",variableName:"symbolicf"+l},numericalf:{dependencyType:"stateVariable",variableName:"numericalf"+l}}}return{globalDependencies:i,dependenciesByKey:s}},arrayDefinitionByKey({globalDependencyValues:n,dependencyValuesByKey:i,arrayKeys:s}){let o={};if(n.symbolic)for(let l of s)o[l]=i[l].symbolicf;else for(let l of s)o[l]=i[l].numericalf;return{setValue:{fs:o}}}},e.f={isAlias:!0,targetVariableName:"f1"},e.latex={public:!0,componentType:"text",returnDependencies:()=>({formula:{dependencyType:"stateVariable",variableName:"formula"}}),definition:function({dependencyValues:n}){return{setValue:{latex:n.formula.toLatex()}}}},e.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:n}){return{setValue:{latexWithInputChildren:[n.latex]}}}},e.allMinima={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},domain:{dependencyType:"stateVariable",variableName:"domain"}}:{numericalf:{dependencyType:"stateVariable",variableName:"numericalf"},formula:{dependencyType:"stateVariable",variableName:"formula"},variables:{dependencyType:"stateVariable",variableName:"variables"},xscale:{dependencyType:"stateVariable",variableName:"xscale"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["allMinima"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},nInputs:{dependencyType:"stateVariable",variableName:"nInputs"},nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"},domain:{dependencyType:"stateVariable",variableName:"domain"}}},definition:function({dependencyValues:n}){if(n.isInterpolatedFunction){let i=n.xs,s=n.coeffs,o=t.eps,l=[];if(i===null)return{setValue:{allMinima:l}};let u=!1,c=-1/0,p=1/0;if(n.domain!==null){let d=n.domain[0];if(d!==void 0)try{c=d[0].evaluate_to_constant(),Number.isFinite(c)||(c=-1/0),p=d[1].evaluate_to_constant(),Number.isFinite(p)||(p=1/0)}catch(h){}}let m=s[0],f=i[1]-i[0];if(m[3]===0){if(m[2]>0){let d=-m[1]/(2*m[2]);d+i[0]>=c&&d+i[0]<=p&&(d<=f-o?l.push([d+i[0],((m[3]*d+m[2])*d+m[1])*d+m[0]]):Math.abs(d-f)<o&&(u=!0))}}else{let d=4*m[2]*m[2]-12*m[3]*m[1];if(d>0){let h=Math.sqrt(d),y=(-2*m[2]+h)/(6*m[3]);y+i[0]>=c&&y+i[0]<=p&&(y<=f-o?l.push([y+i[0],((m[3]*y+m[2])*y+m[1])*y+m[0]]):Math.abs(y-f)<o&&(u=!0))}}for(let d=1;d<i.length-2;d++)if(m=s[d],f=i[d+1]-i[d],m[3]===0)if(m[2]>0){let h=-m[1]/(2*m[2]);if(h+i[d]>=c)if(h+i[d]<=p)Math.abs(h)<o?u&&l.push([h+i[d],((m[3]*h+m[2])*h+m[1])*h+m[0]]):h>=o&&h<=f-o&&l.push([h+i[d],((m[3]*h+m[2])*h+m[1])*h+m[0]]),u=Math.abs(h-f)<o;else{u=!1;continue}}else u=!1;else{let h=4*m[2]*m[2]-12*m[3]*m[1];if(h>0){let y=Math.sqrt(h),b=(-2*m[2]+y)/(6*m[3]);if(b+i[d]>=c)if(b+i[d]<=p)Math.abs(b)<o?u&&l.push([b+i[d],((m[3]*b+m[2])*b+m[1])*b+m[0]]):b>=o&&b<=f-o&&l.push([b+i[d],((m[3]*b+m[2])*b+m[1])*b+m[0]]),u=Math.abs(b-f)<o;else{u=!1;continue}}else u=!1}if(m=s[i.length-2],m[3]===0){if(m[2]>0){let d=-m[1]/(2*m[2]);d+i[i.length-2]>=c&&d+i[i.length-2]<=p&&(Math.abs(d)<o?u&&l.push([d+i[i.length-2],((m[3]*d+m[2])*d+m[1])*d+m[0]]):d>=o&&l.push([d+i[i.length-2],((m[3]*d+m[2])*d+m[1])*d+m[0]]))}}else{let d=4*m[2]*m[2]-12*m[3]*m[1];if(d>0){let h=Math.sqrt(d),y=(-2*m[2]+h)/(6*m[3]);y+i[i.length-2]>=c&&y+i[i.length-2]<=p&&(y>=o?l.push([y+i[i.length-2],((m[3]*y+m[2])*y+m[1])*y+m[0]]):Math.abs(y)<o&&u&&l.push([y+i[i.length-2],((m[3]*y+m[2])*y+m[1])*y+m[0]]))}}return{setValue:{allMinima:l}}}else{if(n.functionChild&&n.functionChild.length>0)return{setValue:{allMinima:n.functionChild[0].stateValues.allMinima}};if(!(n.nInputs===1&&n.nOutputs===1))return{setValue:{allMinima:[]}};let i=n.variables[0].subscripts_to_strings().tree,s=n.formula.subscripts_to_strings().derivative(i),o,l=!0,u;try{o=s.subscripts_to_strings().f()}catch(v){l=!1,u=()=>NaN}l&&(u=function(v){try{return o({[i]:v})}catch(A){return NaN}});let c=n.numericalf,p=-100*n.xscale,m=100*n.xscale;if(n.domain!==null){let v=n.domain[0];if(v!==void 0)try{p=v[0].evaluate_to_constant(),Number.isFinite(p)||(p=-100*n.xscale),m=v[1].evaluate_to_constant(),Number.isFinite(m)||(m=100*n.xscale)}catch(A){}}let f=1e3,d=(m-p)/f,h=[],y=!1,b=c(p),g=u(p);for(let v=0;v<f;v++){let A=p+v*d,C=p+(v+1)*d,S=b;b=c(C);let w=g;if(g=u(C),Number.isNaN(S)||Number.isNaN(b))continue;let x=!1;if(l&&w*g<=0){let R=t.fzero(u,[A,C]),_=.5*1e-6*(Math.abs(R)+1);u(R-_)<0&&u(R+_)>0&&R!==C&&(x=!0,h.push([R,c(R)]),y=!1)}if(!x){let R=t.fminbr(c,[A,C]);if(R.success!==!0)continue;let O=R.x,_=R.fx;S<_?(y&&Number.isFinite(S)&&h.push([A,S]),y=!1):b<_?y=!0:(y=!1,_<b&&_<S&&_<c(O+R.tol)&&_<c(O-R.tol)&&Number.isFinite(_)&&h.push([O,_]))}}return{setValue:{allMinima:h}}}}},e.numberMinima={public:!0,componentType:"number",returnDependencies:()=>({allMinima:{dependencyType:"stateVariable",variableName:"allMinima"}}),definition({dependencyValues:n}){return{setValue:{numberMinima:n.allMinima.length},checkForActualChange:{numberMinima:!0}}}},e.minima={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["minimum","minimumLocations","minimumLocation","minimumValues","minimumValue"],returnWrappingComponents(n){return n==="minimum"||n===void 0?[["point",{componentType:"mathList",isAttribute:"xs"}]]:[]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:i,arraySize:s}){if(["minimum","minimumLocation","minimumValue"].includes(n)){let o=Number(i)-1;return Number.isInteger(o)&&o>=0?!s||o<s[0]?n==="minimum"?[o+",0",o+",1"]:n==="minimumLocation"?[o+",0"]:[o+",1"]:[]:[]}else return n==="minimumLocations"?i!==""?[]:s?Array.from(Array(s[0]),(o,l)=>l+",0"):["0,0"]:n==="minimumValues"?i!==""?[]:s?Array.from(Array(s[0]),(o,l)=>l+",1"):["0,1"]:[]},arrayVarNameFromArrayKey(n){let[i,s]=n.split(",");return s==="0"?"minimumLocation"+(Number(i)+1):"minimumValue"+(Number(i)+1)},returnArraySizeDependencies:()=>({numberMinima:{dependencyType:"stateVariable",variableName:"numberMinima"}}),returnArraySize({dependencyValues:n}){return[n.numberMinima,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allMinima:{dependencyType:"stateVariable",variableName:"allMinima"}}}},arrayDefinitionByKey({globalDependencyValues:n}){let i={};for(let s=0;s<n.__array_size[0];s++)for(let o=0;o<2;o++){let l=`${s},${o}`;i[l]=n.allMinima[s][o]}return{setValue:{minima:i}}}},e.allMaxima={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},domain:{dependencyType:"stateVariable",variableName:"domain"}}:{numericalf:{dependencyType:"stateVariable",variableName:"numericalf"},formula:{dependencyType:"stateVariable",variableName:"formula"},variables:{dependencyType:"stateVariable",variableName:"variables"},xscale:{dependencyType:"stateVariable",variableName:"xscale"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["allMaxima"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},nInputs:{dependencyType:"stateVariable",variableName:"nInputs"},nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"},domain:{dependencyType:"stateVariable",variableName:"domain"}}},definition:function({dependencyValues:n}){if(n.isInterpolatedFunction){let i=n.xs,s=n.coeffs,o=t.eps,l=[];if(i===null)return{setValue:{allMaxima:l}};let u=!1,c=-1/0,p=1/0;if(n.domain!==null){let d=n.domain[0];if(d!==void 0)try{c=d[0].evaluate_to_constant(),Number.isFinite(c)||(c=-1/0),p=d[1].evaluate_to_constant(),Number.isFinite(p)||(p=1/0)}catch(h){}}let m=s[0],f=i[1]-i[0];if(m[3]===0){if(m[2]<0){let d=-m[1]/(2*m[2]);d+i[0]>=c&&d+i[0]<=p&&(d<=f-o?l.push([d+i[0],((m[3]*d+m[2])*d+m[1])*d+m[0]]):Math.abs(d-f)<o&&(u=!0))}}else{let d=4*m[2]*m[2]-12*m[3]*m[1];if(d>0){let h=Math.sqrt(d),y=(-2*m[2]-h)/(6*m[3]);y+i[0]>=c&&y+i[0]<=p&&(y<=f-o?l.push([y+i[0],((m[3]*y+m[2])*y+m[1])*y+m[0]]):Math.abs(y-f)<o&&(u=!0))}}for(let d=1;d<i.length-2;d++)if(m=s[d],f=i[d+1]-i[d],m[3]===0)if(m[2]<0){let h=-m[1]/(2*m[2]);if(h+i[d]>=c)if(h+i[d]<=p)Math.abs(h)<o?u&&l.push([h+i[d],((m[3]*h+m[2])*h+m[1])*h+m[0]]):h>=o&&h<=f-o&&l.push([h+i[d],((m[3]*h+m[2])*h+m[1])*h+m[0]]),u=Math.abs(h-f)<o;else{u=!1;continue}}else u=!1;else{let h=4*m[2]*m[2]-12*m[3]*m[1];if(h>0){let y=Math.sqrt(h),b=(-2*m[2]-y)/(6*m[3]);if(b+i[d]>=c)if(b+i[d]<=p)Math.abs(b)<o?u&&l.push([b+i[d],((m[3]*b+m[2])*b+m[1])*b+m[0]]):b>=o&&b<=f-o&&l.push([b+i[d],((m[3]*b+m[2])*b+m[1])*b+m[0]]),u=Math.abs(b-f)<o;else{u=!1;continue}}else u=!1}if(m=s[i.length-2],m[3]===0){if(m[2]<0){let d=-m[1]/(2*m[2]);d+i[i.length-2]>=c&&d+i[i.length-2]<=p&&(Math.abs(d)<o?u&&l.push([d+i[i.length-2],((m[3]*d+m[2])*d+m[1])*d+m[0]]):d>=o&&l.push([d+i[i.length-2],((m[3]*d+m[2])*d+m[1])*d+m[0]]))}}else{let d=4*m[2]*m[2]-12*m[3]*m[1];if(d>0){let h=Math.sqrt(d),y=(-2*m[2]-h)/(6*m[3]);y+i[i.length-2]>=c&&y+i[i.length-2]<=p&&(y>=o?l.push([y+i[i.length-2],((m[3]*y+m[2])*y+m[1])*y+m[0]]):Math.abs(y)<o&&u&&l.push([y+i[i.length-2],((m[3]*y+m[2])*y+m[1])*y+m[0]]))}}return{setValue:{allMaxima:l}}}else{if(n.functionChild&&n.functionChild.length>0)return{setValue:{allMaxima:n.functionChild[0].stateValues.allMaxima}};if(!(n.nInputs===1&&n.nOutputs===1))return{setValue:{allMaxima:[]}};let i=n.variables[0].subscripts_to_strings().tree,s=n.formula.subscripts_to_strings().derivative(i),o,l=!0,u;try{o=s.subscripts_to_strings().f()}catch(v){l=!1,u=()=>NaN}l&&(u=function(v){try{return o({[i]:v})}catch(A){return NaN}});let c=v=>-n.numericalf(v),p=-100*n.xscale,m=100*n.xscale;if(n.domain!==null){let v=n.domain[0];if(v!==void 0)try{p=v[0].evaluate_to_constant(),Number.isFinite(p)||(p=-100*n.xscale),m=v[1].evaluate_to_constant(),Number.isFinite(m)||(m=100*n.xscale)}catch(A){}}let f=1e3,d=(m-p)/f,h=[],y=!1,b=c(p),g=u(p);for(let v=0;v<f;v++){let A=p+v*d,C=p+(v+1)*d,S=b;b=c(C);let w=g;if(g=u(C),Number.isNaN(S)||Number.isNaN(b))continue;let x=!1;if(l&&w*g<=0){let R=t.fzero(u,[A,C]),_=.5*1e-6*(Math.abs(R)+1);u(R-_)>0&&u(R+_)<0&&R!==C&&(x=!0,h.push([R,-c(R)]),y=!1)}if(!x){let R=t.fminbr(c,[A,C],void 0,1e-6);if(R.success!==!0)continue;let O=R.x,_=R.fx;S<_?(y&&Number.isFinite(S)&&h.push([A,-S]),y=!1):b<_?y=!0:(y=!1,_<b&&_<S&&_<c(O+R.tol)&&_<c(O-R.tol)&&Number.isFinite(_)&&h.push([O,-_]))}}return{setValue:{allMaxima:h}}}}},e.numberMaxima={public:!0,componentType:"number",returnDependencies:()=>({allMaxima:{dependencyType:"stateVariable",variableName:"allMaxima"}}),definition({dependencyValues:n}){return{setValue:{numberMaxima:n.allMaxima.length},checkForActualChange:{numberMaxima:!0}}}},e.maxima={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["maximum","maximumLocations","maximumLocation","maximumValues","maximumValue"],returnWrappingComponents(n){return n==="maximum"||n===void 0?[["point",{componentType:"mathList",isAttribute:"xs"}]]:[]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:i,arraySize:s}){if(["maximum","maximumLocation","maximumValue"].includes(n)){let o=Number(i)-1;return Number.isInteger(o)&&o>=0?!s||o<s[0]?n==="maximum"?[o+",0",o+",1"]:n==="maximumLocation"?[o+",0"]:[o+",1"]:[]:[]}else return n==="maximumLocations"?i!==""?[]:s?Array.from(Array(s[0]),(o,l)=>l+",0"):["0,0"]:n==="maximumValues"?i!==""?[]:s?Array.from(Array(s[0]),(o,l)=>l+",1"):["0,1"]:[]},arrayVarNameFromArrayKey(n){let[i,s]=n.split(",");return s==="0"?"maximumLocation"+(Number(i)+1):"maximumValue"+(Number(i)+1)},returnArraySizeDependencies:()=>({numberMaxima:{dependencyType:"stateVariable",variableName:"numberMaxima"}}),returnArraySize({dependencyValues:n}){return[n.numberMaxima,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allMaxima:{dependencyType:"stateVariable",variableName:"allMaxima"}}}},arrayDefinitionByKey({globalDependencyValues:n}){let i={};for(let s=0;s<n.__array_size[0];s++)for(let o=0;o<2;o++){let l=`${s},${o}`;i[l]=n.allMaxima[s][o]}return{setValue:{maxima:i}}}},e.numberExtrema={public:!0,componentType:"number",returnDependencies:()=>({numberMinima:{dependencyType:"stateVariable",variableName:"numberMinima"},numberMaxima:{dependencyType:"stateVariable",variableName:"numberMaxima"}}),definition:function({dependencyValues:n}){return{setValue:{numberExtrema:n.numberMinima+n.numberMaxima},checkForActualChange:{numberExtrema:!0}}}},e.allExtrema={returnDependencies:()=>({allMinima:{dependencyType:"stateVariable",variableName:"allMinima"},allMaxima:{dependencyType:"stateVariable",variableName:"allMaxima"}}),definition({dependencyValues:n}){return{setValue:{allExtrema:[...n.allMinima,...n.allMaxima].sort((s,o)=>s[0]-o[0])}}}},e.extrema={public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["extremum","extremumLocations","extremumLocation","extremumValues","extremumValue"],returnWrappingComponents(n){return n==="extremum"||n===void 0?[["point",{componentType:"mathList",isAttribute:"xs"}]]:[]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:i,arraySize:s}){if(["extremum","extremumLocation","extremumValue"].includes(n)){let o=Number(i)-1;return Number.isInteger(o)&&o>=0?!s||o<s[0]?n==="extremum"?[o+",0",o+",1"]:n==="extremumLocation"?[o+",0"]:[o+",1"]:[]:[]}else return n==="extremumLocations"?i!==""?[]:s?Array.from(Array(s[0]),(o,l)=>l+",0"):["0,0"]:n==="extremumValues"?i!==""?[]:s?Array.from(Array(s[0]),(o,l)=>l+",1"):["0,1"]:[]},arrayVarNameFromArrayKey(n){let[i,s]=n.split(",");return s==="0"?"extremumLocation"+(Number(i)+1):"extremumValue"+(Number(i)+1)},returnArraySizeDependencies:()=>({numberExtrema:{dependencyType:"stateVariable",variableName:"numberExtrema"}}),returnArraySize({dependencyValues:n}){return[n.numberExtrema,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allExtrema:{dependencyType:"stateVariable",variableName:"allExtrema"}}}},arrayDefinitionByKey({globalDependencyValues:n}){let i={};for(let s=0;s<n.__array_size[0];s++)for(let o=0;o<2;o++){let l=`${s},${o}`;i[l]=n.allExtrema[s][o]}return{setValue:{extrema:i}}}},e.returnNumericalDerivatives={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},variables:{dependencyType:"stateVariable",variableName:"variables"}}:{functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["returnNumericalDerivatives","variables"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},variables:{dependencyType:"stateVariable",variableName:"variables"}}},definition:function({dependencyValues:n}){if(n.isInterpolatedFunction)return{setValue:{returnNumericalDerivatives:Z2(n)}};if(n.functionChild.length>0&&n.functionChild[0].stateValues.returnNumericalDerivatives){let i=n.variables.map(u=>u.subscripts_to_strings().tree),s=n.functionChild[0].stateValues.variables,o=s.map(u=>u.subscripts_to_strings().tree),l={};for(let[u,c]of i.entries())o[u]&&o[u]!==c&&(l[c]=s[u]);return Object.keys(l).length===0?{setValue:{returnNumericalDerivatives:n.functionChild[0].stateValues.returnNumericalDerivatives}}:{setValue:{returnNumericalDerivatives:function(c){let p=[];for(let m of c){let f=l[m.subscripts_to_strings().tree];f?p.push(f):p.push(La.fromAst("\uFF3F"))}return n.functionChild[0].stateValues.returnNumericalDerivatives(p)}}}}else return{setValue:{returnNumericalDerivatives:null}}}},e.numericalDerivativesDefinition={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},variables:{dependencyType:"stateVariable",variableName:"variables"}}:{functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["numericalDerivativesDefinition","variables"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},variables:{dependencyType:"stateVariable",variableName:"variables"}}},definition:function({dependencyValues:n}){if(n.isInterpolatedFunction)return{setValue:{numericalDerivativesDefinition:{derivativeType:"interpolatedFunction",xs:n.xs,coeffs:n.coeffs,variables:n.variables}}};if(n.functionChild.length>0&&n.functionChild[0].stateValues.numericalDerivativesDefinition){let i=n.variables.map(u=>u.subscripts_to_strings().tree),s=n.functionChild[0].stateValues.variables,o=s.map(u=>u.subscripts_to_strings().tree),l={};for(let[u,c]of i.entries())o[u]&&o[u]!==c&&(l[c]=s[u]);if(Object.keys(l).length===0)return{setValue:{numericalDerivativesDefinition:n.functionChild[0].stateValues.numericalDerivativesDefinition}};{let u={...n.functionChild[0].stateValues.numericalDerivativesDefinition};return u.variableMappings?u.variableMappings=[l,...u.variableMappings]:u.variableMappings=[l],{setValue:{numericalDerivativesDefinition:u}}}}else return{setValue:{numericalDerivativesDefinition:{}}}}},e}};T(Ua,"componentType","function"),T(Ua,"rendererType","math"),T(Ua,"primaryStateVariableForDefinition","numericalfShadow"),T(Ua,"adapters",[{stateVariable:"numericalf",componentType:"curve"},{stateVariable:"formula",componentType:"math"}]);function mq({dependencyValues:a,numerics:t}){let e=[],r=[],n={maximum:a.prescribedMaxima,minimum:a.prescribedMinima,extremum:a.prescribedExtrema,point:a.prescribedPoints};for(let C in n)for(let S of n[C]){let w=null,x=null,R=null;if(S.x!==null&&(w=S.x.evaluate_to_constant(),!Number.isFinite(w))){console.warn(`Ignoring non-numerical ${C}`);continue}if(S.y!==null&&(x=S.y.evaluate_to_constant(),!Number.isFinite(x))){console.warn(`Ignoring non-numerical ${C}`);continue}if(S.slope!==null&&S.slope!==void 0&&(R=S.slope.evaluate_to_constant(),Number.isFinite(R)||(console.warn("Ignoring non-numerical slope"),R=null)),w===null){if(x===null){console.warn(`Ignoring empty ${C}`);continue}r.push({type:C,y:x,slope:R})}else e.push({type:C,x:w,y:x,slope:R})}e.sort((C,S)=>C.x-S.x),r.sort((C,S)=>C.y-S.y);let i=-1/0,s=t.eps;for(let C=0;C<e.length;C++){let S=e[C];if(S.x<=i+s)return console.warn("Two points with locations too close together.  Can't define function"),{setValue:{interpolationPoints:null}};i=S.x}let o=a.xscale,l=a.yscale;i=void 0;let u,c,p=[],m=e[0];for(let C=0;C<e.length;C++){let S=m;m=e[C+1];let w=y({p:S,pNext:m,typePrev:c,xPrev:i,yPrev:u});c=w.type,i=w.x,u=w.y}let f=!1;for(e.length===0&&(f=!0);r.length>0;){let C;c===void 0?C=A({allowedTypes:["maximum","minimum","extremum"],comparison:"atLeast",value:-1/0}):c==="maximum"?C=A({allowedTypes:["minimum","extremum"],comparison:"atMost",value:u-l}):c==="minimum"?C=A({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:u+l}):c==="point"&&(C=A({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:u+l}),C.success!==!0&&(C=A({allowedTypes:["minimum","extremum"],comparison:"atMost",value:u-l})));let S;C.success===!0?(S=C.point,r.splice(C.ind,1),f?(S.x=0,f=!1):S.x=i+o):(S=r.pop(),f?(S.x=0,f=!1):S.x=i+2*o);let w=y({p:S,typePrev:c,xPrev:i,yPrev:u});c=w.type,i=w.x,u=w.y}if(p.length===0&&p.push({type:"point",x:0,y:0,slope:0}),f=p[0],f.type==="maximum"){let C={type:"point",x:f.x-o,y:f.y-l,slope:2*l/o};p.splice(0,0,C)}else if(f.type==="minimum"){let C={type:"point",x:f.x-o,y:f.y+l,slope:-2*l/o};p.splice(0,0,C)}else if(f.type==="point")if(p.length===1)f.slope===null&&(f.slope=0);else{let C=p[1],S=(C.y-f.y)/(C.x-f.x);if(C.type==="maximum"||C.type==="minimum")f.slope===null&&(f.slope=2*S);else{p.length===2?f.slope===null&&(f.slope=S):(C.slope===null&&(C.slope=h({point:C,prevPoint:f,nextPoint:p[2]})),f.slope===null&&(f.slope=2*(f.y-C.y)/(f.x-C.x)-C.slope));let w={x:f.x-o,y:f.y-o*f.slope,slope:f.slope};p.splice(0,0,w)}}let d=p[p.length-1];if(d.type==="maximum"){let C={type:"point",x:d.x+o,y:d.y-l,slope:-2*l/o};p.push(C)}else if(d.type==="minimum"){let C={type:"point",x:d.x+o,y:d.y+l,slope:2*l/o};p.push(C)}else if(d.type==="point")if(p.length===1){let C={type:"point",x:d.x+o,y:d.y+f.slope*o,slope:f.slope};p.push(C)}else{let C=p[p.length-2],S=(C.y-d.y)/(C.x-d.x);if(C.type==="maximum"||C.type==="minimum")d.slope===null&&(d.slope=2*S);else{p.length===2?d.slope===null&&(d.slope=S):(C.slope===null&&(C.slope=h({point:C,prevPoint:p[p.length-3],nextPoint:d})),d.slope===null&&(d.slope=2*(C.y-d.y)/(C.x-d.x)-C.slope));let w={x:d.x+o,y:d.y+o*d.slope,slope:d.slope};p.push(w)}}for(let C=1;C<p.length-1;C++){let S=p[C];S.slope===null&&(S.slope=h({point:S,prevPoint:p[C-1],nextPoint:p[C+1]}))}return{setValue:{interpolationPoints:p}};function h({point:C,prevPoint:S,nextPoint:w}){let x=C.x-S.x,R=w.x-C.x,O=C.y-S.y,_=w.y-C.y,k=O/x,B=_/R,U=(k*R+B*x)/(x+R);return(Math.sign(k)+Math.sign(B))*Math.min(Math.abs(k),Math.abs(B),.5*Math.abs(U))}function y({p:C,pNext:S,typePrev:w,xPrev:x,yPrev:R}){let O;if(S!==void 0&&(O=S.y),C.type==="maximum")return b({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S});if(C.type==="minimum")return g({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S});if(C.type==="extremum"){let _;if(w===void 0){if(S===void 0)return b({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S});_=S.type}if(w==="maximum"||_==="maximum")return C.y!==null&&C.y>R-l?b({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S}):_!==void 0&&C.y!==null&&C.y>S.y-l?b({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S}):g({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S});if(w==="minimum"||_==="minimum")return C.y!==null&&C.y<R+l?g({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S}):_!==void 0&&C.y!==null&&C.y>S.y+l?g({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S}):b({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S});if(w==="point"||_==="point"){let k="maximum";return(C.y===null&&S!==void 0&&S.type===maximum||C.y!==null&&C.y<=R-l||_!==void 0&&C.y!==null&&C.y>=S.y-l)&&(k="minimum"),k==="minimum"?g({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S}):b({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S})}else return C.y!==null&&C.y<S.y-l?g({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S}):b({x:C.x,y:C.y,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S})}else if(C.type==="point")return v({x:C.x,y:C.y,slope:C.slope,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:S})}function b({x:C,y:S,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:_}){if(w===void 0)S===null&&(O===void 0?S=0:_.type==="maximum"?S=O:S=O+l);else if(w==="maximum"){S===null&&(O===void 0?S=R:_.type==="maximum"?S=Math.max(R,O):S=Math.max(R,O+l));let B=Math.min(R,S)-l,U=(C+x)/2,H,j,P=null,F=A({allowedTypes:["minimum","extremum"],comparison:"atMost",value:B});F.success===!0?(j="minimum",H=F.point.y,r.splice(F.ind,1),P=0):(j="point",H=B),p.push({type:j,x:U,y:H,slope:P})}else if(w==="minimum"){if(S===null)O===void 0?S=R+l:_.type==="maximum"?S=Math.max(R+l,O):S=Math.max(R,O)+l;else if(S<R+l){let B=[(2*x+C)/3,(x+2*C)/3],U=[R+l,S-l],H=["atLeast","atMost"],j=[["maximum","extremum"],["minimum","extremum"]];for(let P=0;P<2;P++){let F=B[P],G,z,Z=null,ne=A({allowedTypes:j[P],comparison:H[P],value:U[P]});ne.success===!0?(z=j[P][0],G=ne.point.y,r.splice(ne.ind,1),Z=0):(z="point",G=U[P],Z=null),p.push({type:z,x:F,y:G,slope:Z})}}}else if(w==="point"){if(S===null)O===void 0?S=R+l:_.type==="maximum"?S=Math.max(R+l,O):S=Math.max(R,O)+l;else if(S<R+l){let B=(C+x)/2,U,H,j=null,P=A({allowedTypes:["minimum","extremum"],comparison:"atMost",value:S-l});P.success===!0?(H="minimum",U=P.point.y,r.splice(P.ind,1),j=0):(H="point",U=S-l),p.push({type:H,x:B,y:U,slope:j})}}let k={type:"maximum",x:C,y:S,slope:0};return p.push(k),k}function g({x:C,y:S,typePrev:w,xPrev:x,yPrev:R,yNext:O,pNext:_}){if(w===void 0)S===null&&(O===void 0?S=0:_.type==="minimum"?S=O:S=O-l);else if(w==="maximum"){if(S===null)O===void 0?S=R-l:_.type==="minimum"?S=Math.min(R-l,O):S=Math.min(R,O)-l;else if(S>R-l){let B=[(2*x+C)/3,(x+2*C)/3],U=[R-l,S+l],H=["atMost","atLeast"],j=[["minimum","extremum"],["maximum","extremum"]];for(let P=0;P<2;P++){let F=B[P],G,z,Z=null,ne=A({allowedTypes:j[P],comparison:H[P],value:U[P]});ne.success===!0?(z=j[P][0],G=ne.point.y,r.splice(ne.ind,1),Z=0):(z="point",G=U[P],Z=null),p.push({type:z,x:F,y:G,slope:Z})}}}else if(w==="minimum"){S===null&&(O===void 0?S=R:_.type==="minimum"?S=Math.min(R,O):S=Math.min(R,O-l));let B=Math.max(R,S)+l,U=(C+x)/2,H,j,P=null,F=A({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:B});F.success===!0?(j="maximum",H=F.point.y,r.splice(F.ind,1),P=0):(j="point",H=B),p.push({type:j,x:U,y:H,slope:P})}else if(w==="point"){if(S===null)O===void 0?S=R-l:_.type==="minimum"?S=Math.min(R-l,O):S=Math.min(R,O)-l;else if(S>R-l){let B=(C+x)/2,U,H,j=null,P=A({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:S+l});P.success===!0?(H="maximum",U=P.point.y,r.splice(P.ind,1),j=0):(H="point",U=S+l),p.push({type:H,x:B,y:U,slope:j})}}let k={type:"minimum",x:C,y:S,slope:0};return p.push(k),k}function v({x:C,y:S,slope:w,typePrev:x,xPrev:R,yPrev:O,yNext:_,pNext:k}){if(x==="maximum"){if(S>O-l){let U=Math.min(O,S)-l,H=(C+R)/2,j,P,F=null,G=A({allowedTypes:["minimum","extremum"],comparison:"atMost",value:U});G.success===!0?(P="minimum",j=G.point.y,r.splice(G.ind,1),F=0):(P="point",j=O-l),p.push({type:P,x:H,y:j,slope:F})}}else if(x==="minimum"&&S<O+l){let U=Math.max(O,S)+l,H=(C+R)/2,j,P,F=null,G=A({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:U});G.success===!0?(P="maximum",j=G.point.y,r.splice(G.ind,1),F=0):(P="point",j=O+l),p.push({type:P,x:H,y:j,slope:F})}let B={type:"point",x:C,y:S,slope:w};return p.push(B),B}function A({allowedTypes:C,comparison:S,value:w}){let x=[];if(S==="atMost")x=Object.keys(r).reverse();else if(S==="atLeast")x=Object.keys(r);else return{success:!1};for(let R of C)for(let O of x){let _=r[O];if(_.type===R){if(S==="atMost"){if(_.y<=w)return{success:!0,ind:O,point:_}}else if(_.y>=w)return{success:!0,ind:O,point:_}}}return{success:!1}}}function fq({dependencyValues:a}){let t=function(o,l,u,c,p){return[o,u,(-3*o/p+3*l/p-2*u-c)/p,(2*o/p-2*l/p+u+c)/(p*p)]},e=a.interpolationPoints;if(e===null)return{setValue:{xs:null,coeffs:null}};let r=[],n=[],i,s=e[0];n.push(s.x);for(let o=1;o<e.length;o++){i=s,s=e[o];let l=t(i.y,s.y,i.slope,s.slope,s.x-i.x);Math.abs(l[3])<1e-14*Math.max(Math.abs(l[0]),Math.abs(l[1]),Math.abs(l[2]))&&(l[3]=0,Math.abs(l[2])<1e-14*Math.max(Math.abs(l[0]),Math.abs(l[1]))&&(l[2]=0)),r.push(l),n.push(s.x)}return{setValue:{xs:n,coeffs:r}}}import am from"math-expressions";var fi=class extends Ua{static returnSugarInstructions(){let t=[],e=function({matchedChildren:r}){return r.every(n=>typeof n=="string"||n.doenetAttributes&&n.doenetAttributes.createdFromMacro)?r.length===1&&typeof r[0]!="string"?{success:!1}:{success:!0,newChildren:[{componentType:"math",children:r}]}:{success:!1}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"maths",componentTypes:["math"]},{group:"functions",componentTypes:["function"]}]}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t}),r=this.componentType;e.isInterpolatedFunction={returnDependencies:()=>({}),definition:()=>({setValue:{isInterpolatedFunction:!1}})},delete e.nPrescribedPoints,delete e.prescribedPoints,delete e.prescribedMinima,delete e.prescribedMaxima,delete e.prescribedExtrema,delete e.interpolationPoints,delete e.xs,e.operatorBasedOnFormulaIfAvailable={returnDependencies:()=>({}),definition:()=>({setValue:{operatorBasedOnFormulaIfAvailable:!1}})},e.formula.returnDependencies=()=>({}),e.formula.definition=()=>({setValue:{formula:am.fromAst("\uFF3F")}}),e.operatorComposesWithOriginal={returnDependencies:()=>({}),definition:()=>({setValue:{operatorComposesWithOriginal:!0}})},e.symbolicFunctionOperator={returnDependencies:()=>({}),definition:()=>({setValue:{symbolicFunctionOperator:s=>am.fromAst("\uFF3F")}})},e.numericalFunctionOperator={additionalStateVariablesDefined:["numericalFunctionOperatorArguments"],returnDependencies:()=>({}),definition:()=>({setValue:{numericalFunctionOperator:s=>NaN,numericalFunctionOperatorArguments:[]}})},e.numericalFunctionOperatorArguments={returnDependencies:()=>({}),definition:()=>({setValue:{numericalFunctionOperatorArguments:{}}})},e.formulaOperator={returnDependencies:()=>({}),definition:()=>({setValue:{formulaOperator:s=>am.fromAst("\uFF3F")}})},e.returnNumericalDerivatives={returnDependencies:()=>({}),definition:()=>({setValue:{returnNumericalDerivatives:null}})},e.formula={public:!0,componentType:"math",additionalStateVariablesDefined:["operatorBasedOnFormula"],returnDependencies:()=>({operatorBasedOnFormulaIfAvailable:{dependencyType:"stateVariable",variableName:"operatorBasedOnFormulaIfAvailable"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["formula"]},mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]},formulaOperator:{dependencyType:"stateVariable",variableName:"formulaOperator"}}),definition:function({dependencyValues:s}){if(!s.operatorBasedOnFormulaIfAvailable||(s.functionChild.length===0||s.functionChild[0].stateValues.formula.tree==="\uFF3F")&&(s.mathChild.length===0||s.mathChild[0].stateValues.value.tree==="\uFF3F"))return{setValue:{formula:am.fromAst("\uFF3F"),operatorBasedOnFormula:!1}};let o;return s.functionChild.length===0?o=s.mathChild[0].stateValues.value:o=s.functionChild[0].stateValues.formula,{setValue:{formula:s.formulaOperator(o),operatorBasedOnFormula:!0}}}},e.symbolicfs={isArray:!0,entryPrefixes:["symbolicf"],returnArraySizeDependencies:()=>({nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"}}),returnArraySize({dependencyValues:s}){return[s.nOutputs]},returnArrayDependenciesByKey:()=>({globalDependencies:{operatorBasedOnFormula:{dependencyType:"stateVariable",variableName:"operatorBasedOnFormula"},formula:{dependencyType:"stateVariable",variableName:"formula"},variables:{dependencyType:"stateVariable",variableName:"variables"},nInputs:{dependencyType:"stateVariable",variableName:"nInputs"},simplify:{dependencyType:"stateVariable",variableName:"simplify"},expand:{dependencyType:"stateVariable",variableName:"expand"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["symbolicfs"]},mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]},symbolicFunctionOperator:{dependencyType:"stateVariable",variableName:"symbolicFunctionOperator"},operatorComposesWithOriginal:{dependencyType:"stateVariable",variableName:"operatorComposesWithOriginal"},domain:{dependencyType:"stateVariable",variableName:"domain"}}}),arrayDefinitionByKey:function({globalDependencyValues:s,usedDefault:o,arrayKeys:l,arraySize:u}){if(s.operatorBasedOnFormula){let c={};for(let p of l)return c[p]=su(s,p),{setValue:{symbolicfs:c}}}else if(s.operatorComposesWithOriginal)if(s.functionChild.length===0)if(s.mathChild.length===0){let c={};for(let p of l)c[p]=m=>am.fromAst("\uFF3F");return{setValue:{symbolicfs:c}}}else{let c=Object.assign({},s);c.formula=s.mathChild[0].stateValues.value;let p=[];for(let f=0;f<u[0];f++)p.push(su(c,f));let m={};for(let f of l)m[f]=(...d)=>s.symbolicFunctionOperator(...p.map(h=>h(...d)));return{setValue:{symbolicfs:m}}}else{let c=[];for(let m=0;m<u[0];m++)c.push(s.functionChild[0].stateValues.symbolicfs[m]);let p={};for(let m of l)p[m]=(...f)=>s.symbolicFunctionOperator(...c.map(d=>d(...f)));return{setValue:{symbolicfs:p}}}else{let c={};for(let p of l)c[p]=(...m)=>s.symbolicFunctionOperator(...m);return{setValue:{symbolicfs:c}}}}},e.numericalfs={isArray:!0,entryPrefixes:["numericalf"],returnArraySizeDependencies:()=>({nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"}}),returnArraySize({dependencyValues:s}){return[s.nOutputs]},returnArrayDependenciesByKey:()=>({globalDependencies:{operatorBasedOnFormula:{dependencyType:"stateVariable",variableName:"operatorBasedOnFormula"},formula:{dependencyType:"stateVariable",variableName:"formula"},variables:{dependencyType:"stateVariable",variableName:"variables"},nInputs:{dependencyType:"stateVariable",variableName:"nInputs"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["numericalfs"]},mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]},numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"},operatorComposesWithOriginal:{dependencyType:"stateVariable",variableName:"operatorComposesWithOriginal"},domain:{dependencyType:"stateVariable",variableName:"domain"}}}),arrayDefinitionByKey:function({globalDependencyValues:s,usedDefault:o,arrayKeys:l,arraySize:u}){if(s.operatorBasedOnFormula){let c={};for(let p of l)return c[p]=iu({formula:s.formula,nInputs:s.nInputs,variables:s.variables,domain:s.domain,component:p}),{setValue:{numericalfs:c}}}else if(s.operatorComposesWithOriginal)if(s.functionChild.length===0)if(s.mathChild.length===0){let c={};for(let p of l)c[p]=m=>NaN;return{setValue:{numericalfs:c}}}else{let c=Object.assign({},s);c.formula=s.mathChild[0].stateValues.value;let p=[];for(let f=0;f<u[0];f++)p.push(iu({formula:s.formula,nInputs:s.nInputs,variables:s.variables,domain:s.domain,component:f}));let m={};for(let f of l)m[f]=(...d)=>s.numericalFunctionOperator(...p.map(h=>h(...d)));return{setValue:{numericalfs:m}}}else{let c=[];for(let m=0;m<u[0];m++)c.push(s.functionChild[0].stateValues.numericalfs[m]);let p={};for(let m of l)p[m]=(...f)=>s.numericalFunctionOperator(...c.map(d=>d(...f)));return{setValue:{numericalfs:p}}}else{let c={};for(let p of l)c[p]=(...m)=>s.numericalFunctionOperator(...m);return{setValue:{numericalfs:c}}}}},e.fDefinition={returnDependencies:()=>({operatorBasedOnFormula:{dependencyType:"stateVariable",variableName:"operatorBasedOnFormula"},formula:{dependencyType:"stateVariable",variableName:"formula"},variables:{dependencyType:"stateVariable",variableName:"variables"},nInputs:{dependencyType:"stateVariable",variableName:"nInputs"},nOutputs:{dependencyType:"stateVariable",variableName:"nOutputs"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["fDefinition"]},mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]},numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"},numericalFunctionOperatorArguments:{dependencyType:"stateVariable",variableName:"numericalFunctionOperatorArguments"},operatorComposesWithOriginal:{dependencyType:"stateVariable",variableName:"operatorComposesWithOriginal"},domain:{dependencyType:"stateVariable",variableName:"domain"}}),definition({dependencyValues:s}){if(s.operatorBasedOnFormula)return{setValue:{fDefinition:{functionType:"formula",formula:s.formula.tree,variables:s.variables.map(o=>o.tree),nInputs:s.nInputs,nOutputs:s.nOutputs,domain:s.domain}}};if(s.operatorComposesWithOriginal)if(s.functionChild.length===0){if(s.mathChild.length===0)return{setValue:{fDefinition:{functionType:"formula",formula:"\uFF3F",variables:s.variables.map(o=>o.tree),nInputs:s.nInputs,nOutputs:s.nOutputs,domain:s.domain}}};throw Error("function operator with math child not implemented yet")}else return{setValue:{fDefinition:{functionType:"functionOperator",componentType:r,nOutputs:s.nOutputs,functionOperatorArguments:s.numericalFunctionOperatorArguments,operatorComposesWithOriginal:!0,originalFDefinition:s.functionChild[0].stateValues.fDefinition}}};else return{setValue:{fDefinition:{functionType:"functionOperator",componentType:r,nOutputs:s.nOutputs,functionOperatorArguments:s.numericalFunctionOperatorArguments,operatorComposesWithOriginal:!1,originalFDefinition:s.functionChild[0].stateValues.fDefinition}}}}};let n=e.allMinima.returnDependencies;e.allMinima.returnDependencies=function(s){let o=n(s);return delete o.functionChild,o};let i=e.allMaxima.returnDependencies;return e.allMaxima.returnDependencies=function(s){let o=i(s);return delete o.functionChild,o},e}};T(fi,"componentType","_functionOperator");import Q2 from"math-expressions";var eT=class extends fi{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.lowerValue={createComponentOfType:"number",createStateVariable:"lowerValue",defaultValue:0,public:!0},e.upperValue={createComponentOfType:"number",createStateVariable:"upperValue",defaultValue:1,public:!0},e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.numericalFunctionOperator={additionalStateVariablesDefined:["numericalFunctionOperatorArguments"],returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:function({dependencyValues:r}){return{setValue:{numericalFunctionOperator:J2.clampFunction(r.lowerValue,r.upperValue),numericalFunctionOperatorArguments:[r.lowerValue,r.upperValue]}}}},e.symbolicFunctionOperator={returnDependencies:()=>({numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"}}),definition({dependencyValues:r}){return{setValue:{symbolicFunctionOperator:n=>Q2.fromAst(r.numericalFunctionOperator(n.evaluate_to_constant()))}}}},e}};T(eT,"componentType","clampFunction");var tT=class extends fi{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.lowerValue={createComponentOfType:"number",createStateVariable:"lowerValue",defaultValue:0,public:!0},e.upperValue={createComponentOfType:"number",createStateVariable:"upperValue",defaultValue:1,public:!0},e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.numericalFunctionOperator={additionalStateVariablesDefined:["numericalFunctionOperatorArguments"],returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:function({dependencyValues:r}){return{setValue:{numericalFunctionOperator:J2.wrapFunctionPeriodic(r.lowerValue,r.upperValue),numericalFunctionOperatorArguments:[r.lowerValue,r.upperValue]}}}},e.symbolicFunctionOperator={returnDependencies:()=>({numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"}}),definition({dependencyValues:r}){return{setValue:{symbolicFunctionOperator:n=>Q2.fromAst(r.numericalFunctionOperator(n.evaluate_to_constant()))}}}},e}};T(tT,"componentType","wrapFunctionPeriodic");var rT=class extends fi{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.derivVariables={createComponentOfType:"variables"},e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.operatorBasedOnFormulaIfAvailable={returnDependencies:()=>({}),definition:()=>({setValue:{operatorBasedOnFormulaIfAvailable:!0}})},e.operatorComposesWithOriginal={returnDependencies:()=>({}),definition:()=>({setValue:{operatorComposesWithOriginal:!1}})},e.haveFunctionChild={returnDependencies:()=>({functionChild:{dependencyType:"child",childGroups:["functions"]}}),definition({dependencyValues:r}){return{setValue:{haveFunctionChild:r.functionChild.length>0}}}},e.nInputs={defaultValue:1,hasEssential:!0,public:!0,componentType:"integer",stateVariablesDeterminingDependencies:["haveFunctionChild"],returnDependencies({stateValues:r}){let n={nInputsAttr:{dependencyType:"attributeComponent",attributeName:"nInputs",variableNames:["value"]},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["nInputs"]},variablesAttr:{dependencyType:"attributeComponent",attributeName:"variables",variableNames:["nComponents"]}};return r.haveFunctionChild||(n.derivVariablesAttr={dependencyType:"attributeComponent",attributeName:"derivVariables",variableNames:["variables"]}),n},definition({dependencyValues:r}){if(r.nInputsAttr!==null){let n=r.nInputsAttr.stateValues.value;return n>=0||(n=1),{setValue:{nInputs:n}}}else return r.variablesAttr!==null?{setValue:{nInputs:Math.max(1,r.variablesAttr.stateValues.nComponents)}}:r.functionChild.length>0?{setValue:{nInputs:r.functionChild[0].stateValues.nInputs}}:r.derivVariablesAttr!==null?{setValue:{nInputs:[...new Set(r.derivVariablesAttr.stateValues.variables.map(i=>i.subscripts_to_strings().tree))].length}}:{useEssentialOrDefaultValue:{nInputs:!0}}}},e.variables={isArray:!0,public:!0,componentType:"variable",entryPrefixes:["variable"],returnArraySizeDependencies:()=>({nInputs:{dependencyType:"stateVariable",variableName:"nInputs"}}),returnArraySize({dependencyValues:r}){return[r.nInputs]},stateVariablesDeterminingDependencies:["haveFunctionChild"],returnArrayDependenciesByKey({arrayKeys:r,stateValues:n}){let i={variablesAttr:{dependencyType:"attributeComponent",attributeName:"variables",variableNames:["variables"]},parentVariableForChild:{dependencyType:"parentStateVariable",variableName:"variableForChild"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"},haveFunctionChild:{dependencyType:"stateVariable",variableName:"haveFunctionChild"}},s={};if(n.haveFunctionChild)for(let o of r)s[o]={functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["variable"+(Number(o)+1)]}};else i.derivVariablesAttr={dependencyType:"attributeComponent",attributeName:"derivVariables",variableNames:["variables"]};return{globalDependencies:i,dependenciesByKey:s}},arrayDefinitionByKey({globalDependencyValues:r,dependencyValuesByKey:n,arraySize:i,arrayKeys:s,usedDefault:o}){if(r.variablesAttr!==null){let l=r.variablesAttr.stateValues.variables;return{setValue:{variables:En(i[0],l)}}}else if(r.haveFunctionChild){let l={};for(let u of s)l[u]=n[u].functionChild[0].stateValues["variable"+(Number(u)+1)];return{setValue:{variables:l}}}else if(r.derivVariablesAttr!==null){let l=[],u=[];for(let c of r.derivVariablesAttr.stateValues.variables){let p=c.subscripts_to_strings().tree;u.includes(p)||(l.push(c),u.push(p))}return{setValue:{variables:En(i[0],l)}}}else return r.parentVariableForChild&&!o.parentVariableForChild?{setValue:{variables:Array(i[0]).fill(r.parentVariableForChild)}}:{setValue:{variables:En(i[0],[])}}}},e.nDerivatives={public:!0,componentType:"integer",returnDependencies(){return{derivVariablesAttr:{dependencyType:"attributeComponent",attributeName:"derivVariables",variableNames:["nComponents"]}}},definition({dependencyValues:r}){return r.derivVariablesAttr!==null?{setValue:{nDerivatives:r.derivVariablesAttr.stateValues.nComponents}}:{setValue:{nDerivatives:1}}}},e.derivVariables={isArray:!0,public:!0,componentType:"variable",entryPrefixes:["derivVariable"],returnArraySizeDependencies:()=>({nDerivatives:{dependencyType:"stateVariable",variableName:"nDerivatives"}}),returnArraySize({dependencyValues:r}){return[r.nDerivatives]},returnArrayDependenciesByKey(){return{globalDependencies:{derivVariablesAttr:{dependencyType:"attributeComponent",attributeName:"derivVariables",variableNames:["variables"]},variable1:{dependencyType:"stateVariable",variableName:"variable1"}}}},arrayDefinitionByKey({globalDependencyValues:r}){return r.derivVariablesAttr!==null?{setValue:{derivVariables:r.derivVariablesAttr.stateValues.variables}}:{setValue:{derivVariables:{0:r.variable1}}}}},e.formulaOperator={returnDependencies:()=>({derivVariables:{dependencyType:"stateVariable",variableName:"derivVariables"}}),definition({dependencyValues:r}){return{setValue:{formulaOperator:function(n){let i=n.subscripts_to_strings();for(let s of r.derivVariables)i=i.derivative(s.subscripts_to_strings().tree);return i.strings_to_subscripts()}}}}},e.numericalFunctionOperator={returnDependencies:()=>({functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["returnNumericalDerivatives"],variablesOptional:!0},derivVariables:{dependencyType:"stateVariable",variableName:"derivVariables"}}),additionalStateVariablesDefined:["returnNumericalDerivatives"],definition:function({dependencyValues:r}){return r.functionChild.length===0||!r.functionChild[0].stateValues.returnNumericalDerivatives?{setValue:{numericalFunctionOperator:s=>NaN,returnNumericalDerivatives:null}}:{setValue:{numericalFunctionOperator:r.functionChild[0].stateValues.returnNumericalDerivatives(r.derivVariables),returnNumericalDerivatives:function(s){let o=[...r.derivVariables,...s];return r.functionChild[0].stateValues.returnNumericalDerivatives(o)}}}}},e.numericalFunctionOperatorArguments={returnDependencies:()=>({functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["numericalDerivativesDefinition"],variablesOptional:!0},derivVariables:{dependencyType:"stateVariable",variableName:"derivVariables"}}),additionalStateVariablesDefined:["numericalDerivativesDefinition"],definition:function({dependencyValues:r}){if(r.functionChild.length===0||!r.functionChild[0].stateValues.numericalDerivativesDefinition)return{setValue:{numericalFunctionOperatorArguments:[],numericalDerivativesDefinition:{}}};let n=r.functionChild[0].stateValues.numericalDerivativesDefinition,i={...n};return i.additionalDerivVariables?i.additionalDerivVariables=[...r.derivVariables,...i.additionalDerivVariables]:i.additionalDerivVariables=[...r.derivVariables],{setValue:{numericalFunctionOperatorArguments:[n,r.derivVariables],numericalDerivativesDefinition:i}}}},e.symbolicFunctionOperator={returnDependencies:()=>({numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"}}),definition({dependencyValues:r}){return{setValue:{symbolicFunctionOperator:n=>Q2.fromAst(r.numericalFunctionOperator(n.evaluate_to_constant()))}}}},e}};T(rT,"componentType","derivative");var iT={};st(iT,{ExtractMathOperator:()=>aT});var ou=class extends Tr{static returnChildGroups(){return[{group:"maths",componentTypes:["math"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=this;return t.value={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({mathChildren:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]}}),definition:function({dependencyValues:r}){return{setValue:{value:e.applyTextOperator(r.mathChildren.map(n=>n.stateValues.value))}}}},t}};T(ou,"componentType","_textOperatorOfMath"),T(ou,"rendererType","text");var aT=class extends ou{static applyTextOperator(t){return t.length===0?"":t.length!==1?(console.warn("MathOperator requires exactly one math child"),""):Array.isArray(t[0].tree)?t[0].tree[0]:""}};T(aT,"componentType","extractMathOperator");var sT={};st(sT,{Extrema:()=>im,Extremum:()=>Sh});var Sh=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.location={createComponentOfType:"math"},e.value={createComponentOfType:"math"},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let s=hs({childrenToComponentFunction:o=>({componentType:"math",children:o}),mustStripOffOuterParentheses:!0})({matchedChildren:r});if(!s.success&&r.length===1)return{success:!0,newAttributes:{value:{component:{componentType:"math",children:r}}}};if(s.success){if(s.newChildren.length===1)return{success:!0,newAttributes:{value:{component:s.newChildren[0]}}};if(s.newChildren.length===2){let o=s.newChildren[0],l=s.newChildren[1],u={location:{component:o},value:{component:l}};return(o.children.length===0||o.children.length===1&&typeof o.children[0]=="string"&&o.children[0].trim()==="")&&delete u.location,(l.children.length===0||l.children.length===1&&typeof l.children[0]=="string"&&l.children[0].trim()==="")&&delete u.value,{success:!0,newAttributes:u}}else return{success:!1}}return s};return t.push({childrenRegex:/s+(.*s)?/,replacementFunction:e}),t}static returnChildGroups(){return[{group:"points",componentTypes:["point"]}]}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t}),r=this;return e.value={public:!0,componentType:"math",defaultValue:null,hasEssential:!0,additionalStateVariablesDefined:[{variableName:"location",public:!0,componentType:"math",defaultValue:null,hasEssential:!0}],returnDependencies:()=>({extremumChild:{dependencyType:"child",childGroups:["points"],variableNames:["nDimensions","xs"]},location:{dependencyType:"attributeComponent",attributeName:"location",variableNames:["value"]},value:{dependencyType:"attributeComponent",attributeName:"value",variableNames:["value"]}}),definition:function({dependencyValues:n}){let i,s;if(n.extremumChild.length>0){let m=n.extremumChild[0];m.stateValues.nDimensions!==2?(console.log("Cannot determine "+r.componentType+" from a point that isn't 2D"),i=null,s=null):(i=m.stateValues.xs[0],s=m.stateValues.xs[1])}else n.location!==null&&(i=n.location.stateValues.value),n.value!==null&&(s=n.value.stateValues.value);let o={},l={},u=!1,c=!1;i===void 0?(l.location=!0,c=!0):(o.location=i,u=!0),s===void 0?(l.value=!0,c=!0):(o.value=s,u=!0);let p={};return u&&(p.setValue=o),c&&(p.useEssentialOrDefaultValue=l),p}},e}};T(Sh,"componentType","extremum"),T(Sh,"rendererType");var im=class extends J{static get componentTypeCapitalized(){return this.componentType.charAt(0).toUpperCase()+this.componentType.slice(1)}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=this,r=function({matchedChildren:n}){let i=Ia({componentList:n});return i.success!==!0?{success:!1}:{success:!0,newChildren:i.pieces.map(function(s){return s.length>1||typeof s[0]=="string"?{componentType:e.componentTypeSingular,children:s}:s[0]})}};return t.push({replacementFunction:r}),t}static returnChildGroups(){return[{group:"extrema",componentTypes:[this.componentTypeSingular]},{group:"points",componentTypes:["point"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=this;return t["n"+e.componentTypeCapitalized]={additionalStateVariablesDefined:["childIdentities"],returnDependencies:()=>({children:{dependencyType:"child",childGroups:["extrema","points"]}}),definition:function({dependencyValues:r}){return{setValue:{["n"+e.componentTypeCapitalized]:r.children.length,childIdentities:r.children}}}},t[e.componentType]={isArray:!0,nDimensions:2,entryPrefixes:[e.componentTypeSingular,e.componentTypeSingular+"Locations",e.componentTypeSingular+"Location",e.componentTypeSingular+"Values",e.componentTypeSingular+"Value"],stateVariablesDeterminingDependencies:["childIdentities"],getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:n,arraySize:i}){if([e.componentTypeSingular,e.componentTypeSingular+"Location",e.componentTypeSingular+"Value"].includes(r)){let s=Number(n)-1;return Number.isInteger(s)&&s>=0?!i||s<i[0]?r===e.componentTypeSingular?[s+",0",s+",1"]:r===e.componentTypeSingular+"Location"?[s+",0"]:[s+",1"]:[]:[]}else return r===e.componentTypeSingular+"Locations"?n!==""?[]:i?Array.from(Array(i[0]),(s,o)=>o+",0"):["0,0"]:r===e.componentTypeSingular+"Values"?n!==""?[]:i?Array.from(Array(i[0]),(s,o)=>o+",1"):["0,1"]:[]},arrayVarNameFromArrayKey(r){let[n,i]=r.split(",");return i==="0"?e.componentTypeSingular+"Location"+(Number(n)+1):e.componentTypeSingular+"Value"+(Number(n)+1)},returnArraySizeDependencies:()=>({nChildren:{dependencyType:"stateVariable",variableName:"n"+e.componentTypeCapitalized}}),returnArraySize({dependencyValues:r}){return[r.nChildren,2]},returnArrayDependenciesByKey({arrayKeys:r,stateValues:n}){let i={};for(let s of r){let[o,l]=s.split(","),u;n.childIdentities[o].componentType===e.componentTypeSingular?u=Number(l)===0?"location":"value":u="x"+(Number(l)+1),i[s]={child:{dependencyType:"child",childGroups:["extrema","points"],variableNames:[u],childIndices:[o]}}}return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].child[0];if(o){let l=s.split(",")[1],u=Number(l)===0?"location":"value";u in o.stateValues?i[s]=o.stateValues[u]:i[s]=o.stateValues["x"+(Number(l)+1)]}}return{setValue:{[e.componentType]:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyNamesByKey:n}){let i=[];for(let s in r[e.componentType])i.push({setDependency:n[s].extremumChild,desiredValue:r[e.componentType][s],childIndex:0,variableIndex:0});return{success:!0,instructions:i}}},t}};T(im,"componentType","extrema"),T(im,"rendererType"),T(im,"componentTypeSingular","extremum");var cT={};st(cT,{Alert:()=>lT,Attr:()=>Eh,C:()=>uT,Em:()=>oT,Q:()=>sm,SQ:()=>om,Tag:()=>lu,Tage:()=>uu,Term:()=>wh});var ir=class extends re{static returnChildGroups(){return[{group:"inlines",componentTypes:["_inline"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=this;return t.text={public:!0,componentType:"text",returnDependencies:()=>({inlineChildren:{dependencyType:"child",childGroups:["inlines"],variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:r}){let n="";for(let i of r.inlineChildren)typeof i!="object"?n+=i.toString():typeof i.stateValues.text=="string"?n+=i.stateValues.text:n+=" ";return n=e.beginTextDelimiter+n+e.endTextDelimiter,{setValue:{text:n}}}},t}};T(ir,"componentType","_inlineRenderInlineChildren"),T(ir,"renderChildren",!0),T(ir,"includeBlankStringChildren",!0),T(ir,"beginTextDelimiter",""),T(ir,"endTextDelimiter","");var oT=class extends ir{};T(oT,"componentType","em");var lT=class extends ir{};T(lT,"componentType","alert");var sm=class extends ir{};T(sm,"componentType","q"),T(sm,"beginTextDelimiter",'"'),T(sm,"endTextDelimiter",'"');var om=class extends ir{};T(om,"componentType","sq"),T(om,"beginTextDelimiter","'"),T(om,"endTextDelimiter","'");var wh=class extends ir{};T(wh,"componentType","term"),T(wh,"rendererType","alert");var uT=class extends ir{};T(uT,"componentType","c");var lu=class extends ir{};T(lu,"componentType","tag"),T(lu,"rendererType","tag"),T(lu,"beginTextDelimiter","<"),T(lu,"endTextDelimiter",">");var uu=class extends ir{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.selfClosed={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{selfClosed:!0}})},t}};T(uu,"componentType","tage"),T(uu,"rendererType","tag"),T(uu,"beginTextDelimiter","<"),T(uu,"endTextDelimiter","/>");var Eh=class extends ir{};T(Eh,"componentType","attr"),T(Eh,"rendererType","c");var pT={};st(pT,{Ellipsis:()=>Oh,Mdash:()=>xh,NBSP:()=>Vh,Ndash:()=>Rh});var ca=class extends re{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.text={public:!0,componentType:"text",returnDependencies:()=>({}),definition:()=>({setValue:{text:this.unicodeCharacter}})},t}};T(ca,"componentType","_singleCharacterInline"),T(ca,"unicodeCharacter","");var Rh=class extends ca{};T(Rh,"componentType","ndash"),T(Rh,"unicodeCharacter","\u2013");var xh=class extends ca{};T(xh,"componentType","mdash"),T(xh,"unicodeCharacter","\u2014");var Vh=class extends ca{};T(Vh,"componentType","nbsp"),T(Vh,"unicodeCharacter","\xA0");var Oh=class extends ca{};T(Oh,"componentType","ellipsis"),T(Oh,"unicodeCharacter","\u2026");var dT={};st(dT,{Aside:()=>jh,Example:()=>Bh,Exercise:()=>Mh,Paragraphs:()=>Fh,Problem:()=>lm,Section:()=>fT,StandinForFutureLayoutTag:()=>Lh,Subsection:()=>_h,Subsubsection:()=>kh});var ce=class extends J{};T(ce,"componentType","_block");import Cr from"math-expressions";function Dh(){return{type:{createPrimitiveOfType:"string",createStateVariable:"type",defaultPrimitiveValue:"number",toLowerCase:!0,validValues:["number","math","letters"]},from:{createComponentOfType:"_componentWithSelectableType"},to:{createComponentOfType:"_componentWithSelectableType"},step:{createComponentOfType:"math"},length:{createComponentOfType:"number"},exclude:{createComponentOfType:"_componentListWithSelectableType"}}}function Ih(){let a={};return a.specifiedFrom={returnDependencies:()=>({fromAttr:{dependencyType:"attributeComponent",attributeName:"from",variableNames:["value"]}}),defaultValue:null,hasEssential:!0,essentialVarName:"from",definition:function({dependencyValues:t}){return t.fromAttr===null?{useEssentialOrDefaultValue:{specifiedFrom:!0}}:t.fromAttr.stateValues.value===null?{setValue:{specifiedFrom:NaN}}:{setValue:{specifiedFrom:t.fromAttr.stateValues.value}}}},a.specifiedTo={returnDependencies:()=>({toAttr:{dependencyType:"attributeComponent",attributeName:"to",variableNames:["value"]}}),defaultValue:null,hasEssential:!0,essentialVarName:"to",definition:function({dependencyValues:t}){return t.toAttr===null?{useEssentialOrDefaultValue:{specifiedTo:!0}}:t.toAttr.stateValues.value===null?{setValue:{specifiedTo:NaN}}:{setValue:{specifiedTo:t.toAttr.stateValues.value}}}},a.specifiedLength={returnDependencies:()=>({lengthAttr:{dependencyType:"attributeComponent",attributeName:"length",variableNames:["value"]}}),defaultValue:null,hasEssential:!0,essentialVarName:"length",definition:function({dependencyValues:t}){return t.lengthAttr===null?{useEssentialOrDefaultValue:{specifiedLength:!0}}:t.lengthAttr.stateValues.value===null?{setValue:{specifiedLength:NaN}}:{setValue:{specifiedLength:t.lengthAttr.stateValues.value}}}},a.specifiedStep={returnDependencies:()=>({stepAttr:{dependencyType:"attributeComponent",attributeName:"step",variableNames:["value"]},type:{dependencyType:"stateVariable",variableName:"type"}}),defaultValue:null,hasEssential:!0,essentialVarName:"step",definition:function({dependencyValues:t}){if(t.stepAttr===null)return{useEssentialOrDefaultValue:{specifiedStep:!0}};let e=t.stepAttr.stateValues.value;return e===null?{setValue:{specifiedStep:NaN}}:{setValue:{specifiedStep:e}}}},a.specifiedExclude={returnDependencies:()=>({excludeAttr:{dependencyType:"attributeComponent",attributeName:"exclude",variableNames:["values"]}}),defaultValue:[],hasEssential:!0,essentialVarName:"exclude",definition:function({dependencyValues:t}){return t.excludeAttr===null?{useEssentialOrDefaultValue:{specifiedExclude:!0}}:{setValue:{specifiedExclude:t.excludeAttr.stateValues.values}}}},a.lowercase={returnDependencies:()=>({specifiedTo:{dependencyType:"stateVariable",variableName:"specifiedTo"},specifiedFrom:{dependencyType:"stateVariable",variableName:"specifiedFrom"}}),definition:function({dependencyValues:t}){let e=/^[A-Z]*$/,r=!0;return t.specifiedFrom!==null?e.test(t.specifiedFrom)&&(r=!1):t.specifiedTo!==null&&e.test(t.specifiedTo)&&(r=!1),{setValue:{lowercase:r}}}},a.validSequence={returnDependencies:()=>({specifiedLength:{dependencyType:"stateVariable",variableName:"specifiedLength"},specifiedStep:{dependencyType:"stateVariable",variableName:"specifiedStep"},specifiedFrom:{dependencyType:"stateVariable",variableName:"specifiedFrom"},specifiedTo:{dependencyType:"stateVariable",variableName:"specifiedTo"},type:{dependencyType:"stateVariable",variableName:"type"},lowercase:{dependencyType:"stateVariable",variableName:"lowercase"}}),definition:function({dependencyValues:t}){let e=!0;if(t.specifiedLength!==null&&(!Number.isInteger(t.specifiedLength)||t.specifiedLength<0)&&(console.warn("Invalid length of sequence.  Must be a non-negative integer."),e=!1),t.specifiedStep!==null&&t.type!=="math"){let r=lt(t.specifiedStep);Number.isFinite(r)||(console.warn("Invalid step of sequence.  Must be a number for sequence of type "+t.type+"."),e=!1)}if(t.specifiedFrom!==null)if(t.type==="number"){let r=lt(t.specifiedFrom);Number.isFinite(r)||(console.warn("Invalid from of number sequence.  Must be a number"),e=!1)}else Number.isNaN(t.specifiedFrom)&&(console.warn("Invalid from of sequence"),e=!1);if(t.specifiedTo!==null)if(t.type==="number"){let r=lt(t.specifiedTo);Number.isFinite(r)||(console.warn("Invalid to of number sequence.  Must be a number"),e=!1)}else Number.isNaN(t.specifiedTo)&&(console.warn("Invalid to of sequence"),e=!1);return{setValue:{validSequence:e}}}},a.from={additionalStateVariablesDefined:["step","length","exclude"],returnDependencies:()=>({specifiedFrom:{dependencyType:"stateVariable",variableName:"specifiedFrom"},specifiedTo:{dependencyType:"stateVariable",variableName:"specifiedTo"},specifiedLength:{dependencyType:"stateVariable",variableName:"specifiedLength"},specifiedStep:{dependencyType:"stateVariable",variableName:"specifiedStep"},type:{dependencyType:"stateVariable",variableName:"type"},specifiedExclude:{dependencyType:"stateVariable",variableName:"specifiedExclude"},validSequence:{dependencyType:"stateVariable",variableName:"validSequence"}}),definition:function({dependencyValues:t}){let e=t.specifiedFrom,r=t.specifiedTo,n=t.specifiedStep,i=t.specifiedLength,s=[...t.specifiedExclude],o=t.type;if(t.type==="math")r!==null&&(r instanceof Cr.class||(r=Cr.fromAst(r))),e!==null&&(e instanceof Cr.class||(e=Cr.fromAst(e))),n!==null&&(n instanceof Cr.class||(n=Cr.fromAst(n)));else if(n!==null&&n instanceof Cr.class&&(n=n.evaluate_to_constant()),t.type==="letters")e!==null&&(e=di(e)),r!==null&&(r=di(r)),s=s.map(di);else if(t.type==="number"){r!==null&&(r instanceof Cr.class?r=r.evaluate_to_constant():r=Number(r)),e!==null&&(e instanceof Cr.class?e=e.evaluate_to_constant():e=Number(e));for(let[l,u]of s.entries())u instanceof Cr.class?s[l]=u.evaluate_to_constant():s[l]=Number(u)}if(t.validSequence){let l=mT({from:e,to:r,step:n,length:i,type:o});return l.exclude=s,{setValue:l}}return(!Number.isInteger(i)||i<0)&&(i=0),{setValue:{from:e,step:n,length:i,exclude:s}}}},a}function mT({from:a,to:t,step:e,length:r,type:n}){if(a===null)t===null?(n==="math"?a=Cr.fromAst(1):a=1,e===null&&(n==="math"?e=Cr.fromAst(1):e=1),r===null&&(r=10)):(e===null&&(n==="math"?e=Cr.fromAst(1):e=1),r===null&&(n==="math"?r=Math.floor((t.subtract(1).divide(e).evaluate_to_constant()+1)*(1+1e-14)):r=Math.floor(((t-1)/e+1)*(1+1e-14))),n==="math"?a=t.subtract(e.multiply(r-1)).simplify():(a=t-e*(r-1),n==="letters"&&a<1&&(r=Math.floor(((t-1)/e+1)*(1+1e-14)),a=t-e*(r-1))));else if(t===null)e===null&&(n==="math"?e=Cr.fromAst(1):e=1),r===null&&(r=10);else if(e===null)r===null?n==="math"?(e=Cr.fromAst(1),r=Math.floor(t.subtract(a).add(1).evaluate_to_constant()*(1+1e-14))):(e=1,r=Math.floor((t-a+1)*(1+1e-14))):n==="math"?e=t.subtract(a).divide(r-1):(e=(t-a)/(r-1),n==="letters"&&(e=Math.floor(e)));else if(r===null)n==="math"?r=Math.floor(t.subtract(a).divide(e).add(1).evaluate_to_constant()*(1+1e-14)):r=Math.floor(((t-a)/e+1)*(1+1e-14));else throw Error("Can't define from, to, step, and length for sequence");return(!Number.isInteger(r)||r<0)&&(console.warn("Invalid length of sequence.  Must be a non-negative integer."),r=0),{from:a,step:e,length:r}}function cu({from:a,step:t,length:e,exclude:r,type:n,lowercase:i,maxNum:s},o=!1){let l=[],u=0;for(let c=0;c<e;c++){let p=a;if(c>0&&(n==="math"?p=p.add(t.multiply(Cr.fromAst(c))).expand().simplify():p+=t*c),n==="math"){if(r.some(m=>m&&m.equals(p)))continue}else if(n==="number"){if(r.some(m=>Math.abs(m-p)<=1e-14*Math.max(Math.abs(m),Math.abs(p))))continue}else if(r.includes(p))continue;if(n==="letters"&&(p=pu(p,i)),o?l.push({value:p,originalIndex:c}):l.push(p),u++,u===s)break}return l}function Co({index:a,from:t,step:e,length:r,exclude:n,type:i,lowercase:s}){if(!(a>=0&&(r===void 0||a<r)))return null;let o=t;if(a>0&&(i==="math"?o=o.add(e.multiply(Cr.fromAst(a))).expand().simplify():o+=e*a),i==="math"){if(n.some(l=>l&&l.equals(o)))return null}else if(i==="number"){if(n.some(l=>Math.abs(l-o)<=1e-14*Math.max(Math.abs(l),Math.abs(o))))return null}else if(n.includes(o))return null;return i==="letters"&&(o=pu(o,s)),o}function di(a){try{a=a.toUpperCase()}catch(n){console.warn("Cannot convert "+a+" to a number");return}let t=0,e=a.length,r=e;for(;(r-=1)>-1;){let n=a.charCodeAt(r)-64;if(n<1||n>26){console.warn("Cannot convert "+a+" to a number");return}t+=n*Math.pow(26,e-1-r)}return t}function pu(a,t){a--;let e=65;t&&(e=97);let r="";for(;;){let n=a%26;if(r=String.fromCharCode(e+n)+r,a<26)break;a=Math.floor(a/26)-1}return r}function dq(){return{numericalerror:"Credit reduced because numbers in your answer weren't quite right.  Did you round too much?",goodjob:"Good job!",onesignerror:"Credit reduced because it appears that you made a sign error.",twosignerrors:"Credit reduced because it appears that you made two sign errors."}}function Ph(){let a={};return a.setupChildren={returnDependencies:()=>({setupChildren:{dependencyType:"child",childGroups:["setups"],proceedIfAllChildrenNotMatched:!0}}),definition({dependencyValues:t}){return{setValue:{setupChildren:t.setupChildren}}}},a.feedbackDefinitions={stateVariablesDeterminingDependencies:["setupChildren"],returnDependencies({stateValues:t}){let e={ancestorWithFeedback:{dependencyType:"ancestor",variableNames:["feedbackDefinitions"]},setupChildren:{dependencyType:"child",childGroups:["setups"],proceedIfAllChildrenNotMatched:!0}};for(let r of t.setupChildren)e[`feedbackDefinitionsOf${r.componentName}`]={dependencyType:"child",parentName:r.componentName,childGroups:["feedbackDefinitions"],variableNames:["value"]};return e},definition({dependencyValues:t}){let e={},r;t.ancestorWithFeedback&&(r=t.ancestorWithFeedback.stateValues.feedbackDefinitions),r||(r=dq()),Object.assign(e,r);let n=[];for(let i of t.setupChildren)n.push(...t[`feedbackDefinitionsOf${i.componentName}`]);for(let i of n)Object.assign(e,i.stateValues.value);return{setValue:{feedbackDefinitions:e}}}},a}var Ar=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.aggregateScores={createComponentOfType:"boolean",createStateVariable:"aggregateScores",defaultValue:!1,public:!0},e.weight={createComponentOfType:"number",createStateVariable:"weight",defaultValue:1,public:!0},e.sectionWideCheckWork={createComponentOfType:"boolean",createStateVariable:"sectionWideCheckWork",defaultValue:!1,public:!0},e.boxed={createComponentOfType:"boolean",createStateVariable:"boxed",defaultValue:!1,public:!0,forRenderer:!0},e}static returnChildGroups(){return[{group:"variantControls",componentTypes:["variantControl"]},{group:"titles",componentTypes:["title"]},{group:"setups",componentTypes:["setup"]},{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=this,e=super.returnStateVariableDefinitions(),r=Nh();Object.assign(e,r);let n=Ph();return Object.assign(e,n),e.enumeration={forRenderer:!0,returnDependencies:()=>({countAmongSiblings:{dependencyType:"countAmongSiblingsOfSameType"},sectionAncestor:{dependencyType:"ancestor",componentType:"_sectioningComponent",variableNames:["enumeration"]}}),definition({dependencyValues:i}){let s=[];return i.sectionAncestor&&s.push(...i.sectionAncestor.stateValues.enumeration),s.push(i.countAmongSiblings),{setValue:{enumeration:s}}}},e.sectionName={returnDependencies:()=>({}),definition:()=>({setValue:{sectionName:"Section"}})},e.titleChildName={forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childGroups:["titles"]}}),definition({dependencyValues:i}){let s=null;return i.titleChild.length>0&&(s=i.titleChild[0].componentName),{setValue:{titleChildName:s}}}},e.title={public:!0,componentType:"text",forRenderer:!0,shadowVariable:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childGroups:["titles"],variableNames:["text"]},sectionName:{dependencyType:"stateVariable",variableName:"sectionName"},enumeration:{dependencyType:"stateVariable",variableName:"enumeration"}}),definition({dependencyValues:i}){if(i.titleChild.length===0){let s=t.defaultTitle;return s||(s=i.sectionName+" "+i.enumeration.join(".")),{setValue:{title:s}}}else return{setValue:{title:i.titleChild[0].stateValues.text}}}},e.containerTag={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{containerTag:"section"}})},e.level={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{level:1}})},e.viewedSolution={defaultValue:!1,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{viewedSolution:!0}}),inverseDefinition({desiredStateVariableValues:i}){return{success:!0,instructions:[{setEssentialValue:"viewedSolution",value:i.viewedSolution}]}}},e.scoredDescendants={returnDependencies:()=>({scoredDescendants:{dependencyType:"descendant",componentTypes:["_sectioningComponent","answer","setup"],variableNames:["scoredDescendants","aggregateScores","weight"],recurseToMatchedChildren:!1,variablesOptional:!0}}),definition({dependencyValues:i}){let s=[];for(let o of i.scoredDescendants)o.componentType!=="setup"&&(o.stateValues.aggregateScores||o.stateValues.scoredDescendants===void 0?s.push(o):s.push(...o.stateValues.scoredDescendants));return{setValue:{scoredDescendants:s}}}},e.answerDescendants={returnDependencies:()=>({answerDescendants:{dependencyType:"descendant",componentTypes:["answer"],variableNames:["justSubmitted"],recurseToMatchedChildren:!1}}),definition({dependencyValues:i}){return{setValue:{answerDescendants:i.answerDescendants}}}},e.justSubmitted={forRenderer:!0,returnDependencies:()=>({answerDescendants:{dependencyType:"stateVariable",variableName:"answerDescendants"}}),definition({dependencyValues:i}){return{setValue:{justSubmitted:i.answerDescendants.every(s=>s.stateValues.justSubmitted)}}}},e.showCorrectness={forRenderer:!0,returnDependencies:()=>({showCorrectnessFlag:{dependencyType:"flag",flagName:"showCorrectness"}}),definition({dependencyValues:i}){return{setValue:{showCorrectness:i.showCorrectnessFlag!==!1}}}},e.displayDigitsForCreditAchieved={returnDependencies:()=>({}),definition:()=>({setValue:{displayDigitsForCreditAchieved:3}})},e.creditAchieved={public:!0,componentType:"number",forRenderer:!0,defaultValue:0,hasEssential:!0,stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigitsForCreditAchieved"},additionalStateVariablesDefined:[{variableName:"percentCreditAchieved",public:!0,componentType:"number",defaultValue:0,hasEssential:!0,stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigitsForCreditAchieved"}}],stateVariablesDeterminingDependencies:["aggregateScores","scoredDescendants"],returnDependencies({stateValues:i}){let s={aggregateScores:{dependencyType:"stateVariable",variableName:"aggregateScores"}};if(i.aggregateScores){s.scoredDescendants={dependencyType:"stateVariable",variableName:"scoredDescendants"};for(let[o,l]of i.scoredDescendants.entries())s["creditAchieved"+o]={dependencyType:"stateVariable",componentName:l.componentName,variableName:"creditAchieved"}}return s},definition({dependencyValues:i}){if(!i.aggregateScores)return{setValue:{creditAchieved:0,percentCreditAchieved:0}};let s=0,o=0;for(let[c,p]of i.scoredDescendants.entries()){let m=p.stateValues.weight;s+=i["creditAchieved"+c]*m,o+=m}let l;o>0?l=s/o:l=1;let u=l*100;return{setValue:{creditAchieved:l,percentCreditAchieved:u}}}},e.creditAchievedIfSubmit={defaultValue:0,stateVariablesDeterminingDependencies:["aggregateScores","scoredDescendants"],returnDependencies({stateValues:i}){let s={aggregateScores:{dependencyType:"stateVariable",variableName:"aggregateScores"}};if(i.aggregateScores){s.scoredDescendants={dependencyType:"stateVariable",variableName:"scoredDescendants"};for(let[o,l]of i.scoredDescendants.entries())s["creditAchievedIfSubmit"+o]={dependencyType:"stateVariable",componentName:l.componentName,variableName:"creditAchievedIfSubmit"}}return s},definition({dependencyValues:i}){if(!i.aggregateScores)return{setValue:{creditAchievedIfSubmit:0}};let s=0,o=0;for(let[u,c]of i.scoredDescendants.entries()){let p=c.stateValues.weight;s+=i["creditAchievedIfSubmit"+u]*p,o+=p}return{setValue:{creditAchievedIfSubmit:s/o}}}},e.generatedVariantInfo={additionalStateVariablesDefined:["isVariantComponent"],returnDependencies:({sharedParameters:i,componentInfoObjects:s})=>({variantSeed:{dependencyType:"value",value:i.variantSeed},variantIndex:{dependencyType:"value",value:i.variantIndex},variantName:{dependencyType:"value",value:i.variantName},variantControlChild:{dependencyType:"child",childGroups:["variantControls"],variableNames:["selectedVariantIndex","selectedVariantName"]},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(s.componentTypesCreatingVariants),variableNames:["isVariantComponent","generatedVariantInfo"],recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfEncounteredComposites:!0}}),definition({dependencyValues:i,componentName:s}){let o={};i.variantControlChild.length===0?o.seed=i.variantSeed:(o.index=i.variantControlChild[0].stateValues.selectedVariantIndex,o.name=i.variantControlChild[0].stateValues.selectedVariantName),o.meta={createdBy:s};let l=o.subvariants=[];for(let u of i.variantDescendants)u.stateValues.isVariantComponent?l.push(u.stateValues.generatedVariantInfo):u.stateValues.generatedVariantInfo&&l.push(...u.stateValues.generatedVariantInfo.subvariants);return{setValue:{generatedVariantInfo:o,isVariantComponent:!0}}}},e.collapsible={componentType:"boolean",forRenderer:!0,returnDependencies:()=>({}),definition(){return{setValue:{collapsible:!1}}}},e.open={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!0,hasEssential:!0,returnDependencies:()=>({}),definition(){return{useEssentialOrDefaultValue:{open:!0}}},inverseDefinition({desiredStateVariableValues:i}){return{success:!0,instructions:[{setEssentialValue:"open",value:i.open}]}}},e.createSubmitAllButton={forRenderer:!0,additionalStateVariablesDefined:[{variableName:"suppressAnswerSubmitButtons",forRenderer:!0}],returnDependencies:()=>({sectionWideCheckWork:{dependencyType:"stateVariable",variableName:"sectionWideCheckWork"},aggregateScores:{dependencyType:"stateVariable",variableName:"aggregateScores"},sectionAncestor:{dependencyType:"ancestor",componentType:"_sectioningComponent",variableNames:["suppressAnswerSubmitButtons"]},documentAncestor:{dependencyType:"ancestor",componentType:"document",variableNames:["suppressAnswerSubmitButtons"]}}),definition({dependencyValues:i,componentName:s}){let o=!1,l=!1;return i.documentAncestor.stateValues.suppressAnswerSubmitButtons||i.sectionAncestor&&i.sectionAncestor.stateValues.suppressAnswerSubmitButtons?l=!0:i.sectionWideCheckWork&&(i.aggregateScores?(o=!0,l=!0):console.warn(`Cannot create submit all button for ${s} because it doesn't aggegrate scores`)),{setValue:{createSubmitAllButton:o,suppressAnswerSubmitButtons:l}}}},e}actions={submitAllAnswers:this.submitAllAnswers.bind(this),revealSection:this.revealSection.bind(this),closeSection:this.closeSection.bind(this)};async submitAllAnswers({actionId:t}){this.coreFunctions.requestRecordEvent({verb:"submitted",object:{componentName:this.componentName,componentType:this.componentType},result:{creditAchieved:await this.stateValues.creditAchievedIfSubmit}});for(let e of await this.stateValues.answerDescendants)await e.stateValues.justSubmitted||await this.coreFunctions.performAction({componentName:e.componentName,actionName:"submitAnswer"});this.coreFunctions.resolveAction({actionId:t})}async revealSection({actionId:t}){return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!0}],actionId:t,event:{verb:"viewed",object:{componentName:this.componentName,componentType:this.componentType}}})}async closeSection({actionId:t}){return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!1}],actionId:t,event:{verb:"closed",object:{componentName:this.componentName,componentType:this.componentType}}})}static async setUpVariant({serializedComponent:t,sharedParameters:e,definingChildrenSoFar:r,descendantVariantComponents:n}){let i;for(let o of r)if(o!==void 0&&o.componentType==="variantControl"){i=o;break}i===void 0?kr({serializedComponent:t,sharedParameters:e,descendantVariantComponents:n}):(e.variantSeed=await i.state.selectedSeed.value,e.variantName=await i.state.selectedVariantName.value,e.variantIndex=await i.state.selectedVariantIndex.value,e.variantRng=await i.state.variantRng.value,e.allPossibleVariants=await i.state.variantNames.value);let s;if(t.variants&&(s=t.variants.desiredVariant),s===void 0&&(s={}),s.subvariants&&n)for(let o in s.subvariants){let l=s.subvariants[o],u=n[o];if(u===void 0)break;u.variants.desiredVariant=l}}static determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e}){t.variants===void 0&&(t.variants={});let r;for(let s of t.children)if(s.componentType==="variantControl"){r=s;break}if(!r)return super.determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e});let n=r.attributes.nVariants?.primitive;if(n===void 0&&(n=100),!r.attributes.uniqueVariants?.primitive)return t.variants.numberOfVariants=n,{success:!0,numberOfVariants:n};let i=super.determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e});return i.success?(n=Math.min(i.numberOfVariants,n),t.variants.numberOfVariants=n,t.variants.uniqueVariants=!0,console.log("Actual number of variants for section is "+n),{success:!0,numberOfVariants:n}):(t.variants.numberOfVariants=n,{success:!0,numberOfVariants:n})}static getUniqueVariant({serializedComponent:t,variantIndex:e,componentInfoObjects:r}){let n=t.variants?.numberOfVariants;if(n===void 0)return{success:!1};if(!Number.isInteger(e)||e<1||e>n)return{success:!1};let i;for(let o of t.children)if(o.componentType==="variantControl"){i=o;break}if(!i)return super.getUniqueVariant({serializedComponent:t,variantIndex:e,componentInfoObjects:r});if(!t.variants.uniqueVariants)return{success:!0,desiredVariant:{index:e}};let s=hh({variantIndex:e,serializedComponent:t,componentInfoObjects:r});return s.success?{success:!0,desiredVariant:{index:e,subvariants:s.desiredVariants}}:(console.log("Failed to get unique variant for section."),{success:!1})}};T(Ar,"componentType","_sectioningComponent"),T(Ar,"renderChildren",!0),T(Ar,"createsVariants",!0),T(Ar,"includeBlankStringChildren",!0);var fT=class extends Ar{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({setValue:{level:1}}),t}};T(fT,"componentType","section");var _h=class extends Ar{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({setValue:{level:2}}),t}};T(_h,"componentType","subsection"),T(_h,"rendererType","section");var kh=class extends Ar{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({setValue:{level:3}}),t}};T(kh,"componentType","subsubsection"),T(kh,"rendererType","section");var Fh=class extends Ar{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({setValue:{level:4}}),t}};T(Fh,"componentType","paragraphs"),T(Fh,"rendererType","section");var jh=class extends Ar{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.collapsible={createComponentOfType:"boolean",createStateVariable:"collapsible",defaultValue:!0,public:!0,forRenderer:!0},e.startOpen={createComponentOfType:"boolean",createStateVariable:"startOpen",defaultValue:!1},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return delete t.collapsible,t.open.returnDependencies=()=>({startOpen:{dependencyType:"stateVariable",variableName:"startOpen"}}),t.open.definition=({dependencyValues:e})=>({useEssentialOrDefaultValue:{open:{defaultValue:e.startOpen}}}),t.level.definition=()=>({setValue:{level:3}}),t.containerTag.definition=()=>({setValue:{containerTag:"aside"}}),t}};T(jh,"componentType","aside"),T(jh,"rendererType","section");var lm=class extends Ar{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.aggregateScores.defaultValue=!0,e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.sectionName.definition=()=>({setValue:{sectionName:"Problem"}}),t.level.definition=()=>({setValue:{level:3}}),t}};T(lm,"componentType","problem"),T(lm,"rendererType","section");var Mh=class extends lm{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.sectionName.definition=()=>({setValue:{sectionName:"Exercise"}}),t}};T(Mh,"componentType","exercise"),T(Mh,"rendererType","section");var Bh=class extends Ar{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.sectionName.definition=()=>({setValue:{sectionName:"Example"}}),t.level.definition=()=>({setValue:{level:3}}),t}};T(Bh,"componentType","example"),T(Bh,"rendererType","section");var Lh=class extends Ar{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({setValue:{level:3}}),t.containerTag.definition=()=>({setValue:{containerTag:"aside"}}),t}};T(Lh,"componentType","standinForFutureLayoutTag"),T(Lh,"rendererType","section");var hT={};st(hT,{Li:()=>fu,Ol:()=>mu,Ul:()=>Uh});var mu=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.label={createComponentOfType:"text",createStateVariable:"label",defaultValue:null,public:!0,forRenderer:!0},e}static returnChildGroups(){return[{group:"lis",componentTypes:["li"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numbered={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{numbered:!0}})},t}};T(mu,"componentType","ol"),T(mu,"rendererType","list"),T(mu,"renderChildren",!0);var Uh=class extends mu{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numbered={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{numbered:!1}})},t}};T(Uh,"componentType","ul"),T(Uh,"rendererType","list");var fu=class extends J{static returnChildGroups(){return[{group:"inlinesBlocks",componentTypes:["_inline","_block"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.item={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{item:!0}})},t}};T(fu,"componentType","li"),T(fu,"rendererType","list"),T(fu,"renderChildren",!0),T(fu,"includeBlankStringChildren",!0);var bT={};st(bT,{CobwebPolyline:()=>hu,EquilibriumCurve:()=>gu,EquilibriumLine:()=>bu,EquilibriumPoint:()=>yu,ODESystem:()=>du});import zh from"math-expressions";var du=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.independentVariable={createComponentOfType:"variable",createStateVariable:"independentVariable",defaultValue:zh.fromAst("t"),public:!0},e.initialIndependentVariableValue={createComponentOfType:"math",createStateVariable:"initialIndependentVariableValue",defaultValue:zh.fromAst(0),public:!0},e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:14,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e.renderMode={createComponentOfType:"text",createStateVariable:"renderMode",defaultValue:"align",public:!0,forRenderer:!0},e.chunkSize={createComponentOfType:"number",createStateVariable:"chunkSize",defaultValue:10,public:!0},e.tolerance={createComponentOfType:"number",createStateVariable:"tolerance",defaultValue:1e-6,public:!0},e.maxIterations={createComponentOfType:"number",createStateVariable:"maxIterations",defaultValue:1e3,public:!0},e.hideInitialCondition={createComponentOfType:"boolean",createStateVariable:"hideInitialCondition",defaultValue:!1,public:!0},e.initialConditions={createComponentOfType:"mathList"},e.variables={createComponentOfType:"variables"},e.number={createComponentOfType:"boolean",createStateVariable:"number",defaultValue:!1,public:!0},e}static returnChildGroups(){return[{group:"rightHandSides",componentTypes:["rightHandSide"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.validIndependentVariable={returnDependencies:()=>({independentVarAttr:{dependencyType:"attributeComponent",attributeName:"independentVariable",variableNames:["validVariable"]}}),definition({dependencyValues:e}){let r=!0;return e.independentVarAttr&&(r=e.independentVarAttr.stateValues.validVariable),{setValue:{validIndependentVariable:r}}}},t.nDimensions={returnDependencies:()=>({rhsChildren:{dependencyType:"child",childGroups:["rightHandSides"],skipComponentNames:!0}}),definition:function({dependencyValues:e}){return{setValue:{nDimensions:e.rhsChildren.length},checkForActualChange:{nDimensions:!0}}}},t.variables={additionalStateVariablesDefined:[{variableName:"validVariables",isArray:!0,entryPrefixes:["validVar"]}],isArray:!0,public:!0,componentType:"variable",entryPrefixes:["var"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey(){return{globalDependencies:{nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},variables:{dependencyType:"attributeComponent",attributeName:"variables",variableNames:["variables","validVariables"]},independentVariable:{dependencyType:"stateVariable",variableName:"independentVariable"}}}},arrayDefinitionByKey({globalDependencyValues:e}){let r=[],n=[],i=e.nDimensions;e.variables!==null&&(r=e.variables.stateValues.variables,n=[...e.variables.stateValues.validVariables].slice(0,i));let s=En(i,r);return s.some(o=>o.equals(e.independentVariable))&&console.warn("Variables of odesystem must be different than independent variable."),n.length<i&&n.push(...Array(i-n.length).fill(!0)),{setValue:{variables:s,validVariables:n}}}},t.rhss={isArray:!0,public:!0,componentType:"math",entryPrefixes:["rhs","righthandside"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={rhsChild:{dependencyType:"child",childGroups:["rightHandSides"],variableNames:["value"],childIndices:[n]}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r)n[i]=e[i].rhsChild[0].stateValues.value;return{setValue:{rhss:n}}}},t.rhs={isAlias:!0,targetVariableName:"rhs1"},t.righthandside={isAlias:!0,targetVariableName:"rhs1"},t.righthandsides={isAlias:!0,targetVariableName:"rhss"},t.initialConditions={isArray:!0,public:!0,componentType:"math",entryPrefixes:["initialCondition"],defaultValueByArrayKey:()=>zh.fromAst(0),returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={initialConditionAttr:{dependencyType:"attributeComponent",attributeName:"initialConditions",variableNames:[`math${Number(n)+1}`]}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={},i={};for(let o of r){let l=!1;if(e[o].initialConditionAttr){let u=e[o].initialConditionAttr.stateValues[`math${Number(o)+1}`];u!==void 0&&(l=!0,n[o]=u)}l||(i[o]=!0)}let s={};return Object.keys(n).length>0&&(s.setValue={initialConditions:n}),Object.keys(i).length>0&&(s.useEssentialOrDefaultValue={initialConditions:i}),s}},t.initialCondition={isAlias:!0,targetVariableName:"initialCondition1"},t.equationTag={public:!0,componentType:"text",forRenderer:!0,stateVariablesDeterminingDependencies:["number"],returnDependencies({stateValues:e}){return e.number?{equationCounter:{dependencyType:"counter",counterName:"equation"}}:{}},definition({dependencyValues:e}){return e.equationCounter!==void 0?{setValue:{equationTag:String(e.equationCounter)}}:{setValue:{equationTag:null}}}},t.latex={public:!0,componentType:"text",forRenderer:!0,returnDependencies(){return{nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},variables:{dependencyType:"stateVariable",variableName:"variables"},initialConditions:{dependencyType:"stateVariable",variableName:"initialConditions"},hideInitialCondition:{dependencyType:"stateVariable",variableName:"hideInitialCondition"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"},independentVariable:{dependencyType:"stateVariable",variableName:"independentVariable"},initialIndependentVariableValue:{dependencyType:"stateVariable",variableName:"initialIndependentVariableValue"},rhss:{dependencyType:"stateVariable",variableName:"rhss"},number:{dependencyType:"stateVariable",variableName:"number"},equationTag:{dependencyType:"stateVariable",variableName:"equationTag"}}},definition({dependencyValues:e,usedDefault:r}){let n=[],i=e.independentVariable.toLatex();for(let o=0;o<e.nDimensions;o++){let l=e.variables[o].toLatex(),u=Lt({value:e.rhss[o],dependencyValues:e,usedDefault:r}),c=`\\frac{d${l}}{d${i}} &=  ${u.toLatex()}`;e.number&&o===0?c+=`\\tag{${e.equationTag}}`:c+="\\notag",n.push(c)}if(!e.hideInitialCondition){let o=e.initialIndependentVariableValue;for(let l=0;l<e.nDimensions;l++){let u=e.variables[l].toLatex(),c=Lt({value:e.initialConditions[l],dependencyValues:e,usedDefault:r});n.push(`${u}(${o}) &= ${c.toLatex()}\\notag`)}}return{setValue:{latex:n.join("\\\\")}}}},t.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){return{setValue:{latexWithInputChildren:[e.latex]}}}},t.numericalRHSf={additionalStateVariablesDefined:["numericalRHSfDefinitions"],returnDependencies:()=>({validIndependentVariable:{dependencyType:"stateVariable",variableName:"validIndependentVariable"},independentVariable:{dependencyType:"stateVariable",variableName:"independentVariable"},validVariables:{dependencyType:"stateVariable",variableName:"validVariables"},variables:{dependencyType:"stateVariable",variableName:"variables"},rhss:{dependencyType:"stateVariable",variableName:"rhss"}}),definition({dependencyValues:e}){let r=!0;e.validIndependentVariable||(console.warn("Can't define ODE RHS functions with invalid independent variable."),r=!1),e.validVariables.every(o=>o)||(console.warn("Can't define ODE RHS functions with an invalid variable."),r=!1);let n=e.independentVariable.subscripts_to_strings().tree,i=e.variables.map(o=>o.subscripts_to_strings().tree);i.includes(n)&&(console.warn("Can't define ODE RHS functions when independent variable is a dependent variable"),r=!1),[...new Set(i)].length!==i.length&&(console.warn("Can't define ODE RHS functions with duplicate dependent variable names"),r=!1);let s;try{s=e.rhss.map(o=>o.subscripts_to_strings().f())}catch(o){console.warn("Cannot define ODE RHS function.  Error creating mathjs function"),r=!1}if(!r){let o=e.rhss.length;return{setValue:{numericalRHSf:()=>NaN,numericalRHSfDefinitions:Array(o).fill({})}}}return{setValue:{numericalRHSf:function(o,l){let u={[n]:o};Array.isArray(l)?l.forEach((c,p)=>u[i[p]]=c):u[i[0]]=l;try{return s.map(c=>c(u))}catch(c){return NaN}},numericalRHSfDefinitions:e.rhss.map(o=>({functionType:"formula",formula:o,nInputs:i.length+1,variables:[n,...i]}))}}}},t.haveNumericalInitialConditions={additionalStateVariablesDefined:["t0","x0s"],returnDependencies:()=>({initialIndependentVariableValue:{dependencyType:"stateVariable",variableName:"initialIndependentVariableValue"},initialConditions:{dependencyType:"stateVariable",variableName:"initialConditions"}}),definition({dependencyValues:e}){let r=e.initialIndependentVariableValue.evaluate_to_constant(),n=e.initialConditions.map(s=>s.evaluate_to_constant()),i=Number.isFinite(r)&&n.every(s=>Number.isFinite(s));return{setValue:{t0:r,x0s:n,haveNumericalInitialConditions:i}}}},t.numericalSolutions={isArray:!0,entryPrefixes:["numericalSolution"],public:!0,componentType:"function",createWorkspace:!0,stateVariablesPrescribingAdditionalAttributes:{fDefinition:"numericalSolutionFDefinitions"},returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey(){return{globalDependencies:{nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},validIndependentVariable:{dependencyType:"stateVariable",variableName:"validIndependentVariable"},independentVariable:{dependencyType:"stateVariable",variableName:"independentVariable"},validVariables:{dependencyType:"stateVariable",variableName:"validVariables"},variables:{dependencyType:"stateVariable",variableName:"variables"},chunkSize:{dependencyType:"stateVariable",variableName:"chunkSize"},tolerance:{dependencyType:"stateVariable",variableName:"tolerance"},maxIterations:{dependencyType:"stateVariable",variableName:"maxIterations"},haveNumericalInitialConditions:{dependencyType:"stateVariable",variableName:"haveNumericalInitialConditions"},t0:{dependencyType:"stateVariable",variableName:"t0"},x0s:{dependencyType:"stateVariable",variableName:"x0s"},numericalRHSf:{dependencyType:"stateVariable",variableName:"numericalRHSf"}}}},arrayDefinitionByKey({globalDependencyValues:e,workspace:r,componentName:n}){let i={};if(r.calculatedNumericSolutions=[],r.endingNumericalValues=[],r.maxPossibleTime=void 0,!e.haveNumericalInitialConditions){for(let m=0;m<e.nDimensions;m++)i[m]=f=>NaN;return{setValue:{numericalSolutions:i}}}let s=e.t0,o=e.x0s,l=e.chunkSize,u=e.tolerance,c=e.numericalRHSf,p=e.maxIterations;for(let m=0;m<e.nDimensions;m++)i[m]=function(d){if(!Number.isFinite(d))return NaN;if(d===s)return o[m];let h=r.calculatedNumericSolutions.length,y=Math.ceil((d-s)/l)-1;if(y<0)return NaN;if(r.maxPossibleTime===void 0&&y>=h)for(let g=h;g<=y;g++){let v=r.endingNumericalValues[g-1];v===void 0&&(v=o);let A=s+g*l,C=zh.math.dopri(A,A+l,v,c,u,p);r.endingNumericalValues.push(C.y[C.y.length-1]),r.calculatedNumericSolutions.push(C.at.bind(C));let S=C.x[C.x.length-1];if(S<(A+l)*(1-1e-6)){r.maxPossibleTime=S;let w="For chunksize "+l+" and tolerance "+u+", odesystem";n!==void 0&&(w+=" ("+n+")"),w+=" hit maxiterations ("+p+") at t = "+r.maxPossibleTime+". Will not calculate solution beyond that time. Decrease chunksize, increase maxiterations, or increase tolerance to calculate further.";break}}return d>r.maxPossibleTime?NaN:r.calculatedNumericSolutions[y](d)[m]};return{setValue:{numericalSolutions:i}}}},t.numericalSolution={isAlias:!0,targetVariableName:"numericalSolution1"},t.numericalSolutionFDefinitions={forRenderer:!0,isArray:!0,entryPrefixes:["numericalSolutionFDefinition"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey(){return{globalDependencies:{nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},validIndependentVariable:{dependencyType:"stateVariable",variableName:"validIndependentVariable"},independentVariable:{dependencyType:"stateVariable",variableName:"independentVariable"},validVariables:{dependencyType:"stateVariable",variableName:"validVariables"},variables:{dependencyType:"stateVariable",variableName:"variables"},chunkSize:{dependencyType:"stateVariable",variableName:"chunkSize"},tolerance:{dependencyType:"stateVariable",variableName:"tolerance"},maxIterations:{dependencyType:"stateVariable",variableName:"maxIterations"},haveNumericalInitialConditions:{dependencyType:"stateVariable",variableName:"haveNumericalInitialConditions"},t0:{dependencyType:"stateVariable",variableName:"t0"},x0s:{dependencyType:"stateVariable",variableName:"x0s"},numericalRHSfDefinitions:{dependencyType:"stateVariable",variableName:"numericalRHSfDefinitions"}}}},arrayDefinitionByKey({globalDependencyValues:e}){return e.haveNumericalInitialConditions?{setValue:{numericalSolutionFDefinitions:[...Array(e.nDimensions).keys()].map(r=>({functionType:"ODESolution",nDimensions:e.nDimensions,t0:e.t0,x0s:e.x0s,chunkSize:e.chunkSize,tolerance:e.tolerance,numericalRHSfDefinitions:e.numericalRHSfDefinitions,maxIterations:e.maxIterations,component:r}))}}:{setValue:{numericalSolutionFDefinitions:Array(e.nDimensions).fill({})}}}},t}};T(du,"componentType","odesystem"),T(du,"rendererType","math");var Ge=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.label={createComponentOfType:"text",createStateVariable:"label",defaultValue:"",public:!0,forRenderer:!0},e.showLabel={createComponentOfType:"boolean",createStateVariable:"showLabel",defaultValue:!0,public:!0,forRenderer:!0},e.layer={createComponentOfType:"number",createStateVariable:"layer",defaultValue:0,public:!0,forRenderer:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=Ch();return Object.assign(t,e),t}};T(Ge,"componentType","_graphical");import yT from"math-expressions";var hi=class extends Ge{actions={movePolyline:this.movePolyline.bind(this),finalizePolylinePosition:this.finalizePolylinePosition.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.vertices={createComponentOfType:"_pointListComponent"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let r="";return e.selectedStyle.lineWidth>=4?r+="thick ":e.selectedStyle.lineWidth<=1&&(r+="thin "),e.selectedStyle.lineStyle==="dashed"?r+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=e.selectedStyle.lineColor,{setValue:{styleDescription:r}}}},t.nVertices={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({vertices:{dependencyType:"attributeComponent",attributeName:"vertices",variableNames:["nPoints"]}}),definition:function({dependencyValues:e}){return e.vertices!==null?{setValue:{nVertices:e.vertices.stateValues.nPoints}}:{setValue:{nVertices:0}}}},t.nDimensions={public:!0,componentType:"number",returnDependencies(){return{vertices:{dependencyType:"attributeComponent",attributeName:"vertices",variableNames:["nDimensions"]}}},definition:function({dependencyValues:e}){return e.vertices!==null?{setValue:{nDimensions:e.vertices.stateValues.nDimensions},checkForActualChange:{nDimensions:!0}}:{setValue:{nDimensions:2}}}},t.vertices={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["vertexX","vertex"],returnWrappingComponents(e){return e==="vertexX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="vertexX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},getAllArrayKeys(e,r=!0,n){function i(s){if(s.length===1)return Array.from(Array(s[0]),(o,l)=>String(l));{let o=s[0],l=i(s.slice(1)),u=[];for(let c=0;c<o;c++)r?u.push(...l.map(p=>c+","+p)):u.push(l.map(p=>c+","+p));return u}}if(n){if(n.length===0||!e)return[];{let s=[...e];return s[0]=n[0],i(s)}}else return!e||e.length===0?[]:i(e)},returnArraySizeDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nVertices,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let[i,s]=n.split(","),o=Number(i)+1+"_"+(Number(s)+1);r[n]={vertices:{dependencyType:"attributeComponent",attributeName:"vertices",variableNames:["pointX"+o]}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let[s,o]=i.split(","),l=Number(s)+1+"_"+(Number(o)+1),u=e[i].vertices;u!==null&&u.stateValues["pointX"+l]?n[i]=u.stateValues["pointX"+l]:n[i]=yT.fromAst("\uFF3F")}return{setValue:{vertices:n}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:r,dependencyNamesByKey:n,initialChange:i,stateValues:s}){if(i&&!await s.draggable)return{success:!1};let o=[];for(let l in e.vertices){let[u,c]=l.split(","),p=Number(u)+1+"_"+(Number(c)+1);if(r[l].vertices!==null&&r[l].vertices.stateValues["pointX"+p])o.push({setDependency:n[l].vertices,desiredValue:e.vertices[l],variableIndex:0});else return{success:!1}}return{success:!0,instructions:o}}},t.numericalVertices={isArray:!0,entryPrefixes:["numericalVertex"],forRenderer:!0,returnArraySizeDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),returnArraySize({dependencyValues:e}){return[e.nVertices]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={vertex:{dependencyType:"stateVariable",variableName:"vertex"+(Number(n)+1)}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=e[i].vertex.map(o=>o.evaluate_to_constant());s.every(o=>Number.isFinite(o))||(s=Array(s.length).fill(NaN)),n[i]=s}return{setValue:{numericalVertices:n}}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalVertices:{dependencyType:"stateVariable",variableName:"numericalVertices"},nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition({dependencyValues:e}){let r=e.nDimensions,n=e.nVertices,i=e.numericalVertices,s=[],o,l,u=i[0]?.[0],c=i[0]?.[1];for(let p=1;p<n;p++)if(o=u,l=c,u=i[p]?.[0],c=i[p]?.[1],!(Number.isFinite(o)&&Number.isFinite(l)&&Number.isFinite(u)&&Number.isFinite(c)))s.push(null);else{let m=u-o,f=c-l;m===0&&f===0?s.push(null):s.push([m,f])}return{setValue:{nearestPoint:function({variables:p,scales:m}){let f=m[0],d=m[1];if(r!==2||n===0)return{};let h=1/0,y={},b=p.x1.evaluate_to_constant(),g=p.x2.evaluate_to_constant(),v,A,C=i[0][0],S=i[0][1];for(let w=1;w<n;w++){v=C,A=S,C=i[w][0],S=i[w][1];let x=s[w-1];if(x===null)continue;let R=x[0]/f,O=x[1]/d,_=R*R+O*O,k=((b-v)/f*R+(g-A)/d*O)/_,B;k<=0?B={x1:v,x2:A}:k>=1?B={x1:C,x2:S}:B={x1:v+k*R*f,x2:A+k*O*d};let U=Math.pow((b-B.x1)/f,2)+Math.pow((g-B.x2)/d,2);U<h&&(h=U,y=B)}return p.x3!==void 0&&Object.keys(y).length>0&&(y.x3=0),y}}}}},t}async movePolyline({pointCoords:t,transient:e,sourceInformation:r,actionId:n}){let i={};for(let s in t)i[s+",0"]=yT.fromAst(t[s][0]),i[s+",1"]=yT.fromAst(t[s][1]);return e?await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"vertices",value:i,sourceInformation:r}],transient:e,actionId:n}):await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"vertices",value:i,sourceInformation:r}],actionId:n,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{pointCoordinates:t}}})}async finalizePolylinePosition(){return await this.actions.movePolyline({pointCoords:await this.stateValues.numericalVertices,transient:!1})}};T(hi,"componentType","polyline");import yi from"math-expressions";var hu=class extends hi{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.attractThreshold={createComponentOfType:"number",createStateVariable:"attractThreshold",defaultValue:.5,public:!0},e.nPoints={createComponentOfType:"number",createStateVariable:"nPoints",defaultValue:1,public:!0,clamp:[0,1/0],forRenderer:!0},e.variable={createComponentOfType:"variable",createStateVariable:"variable",defaultValue:yi.fromAst("x"),public:!0,forRenderer:!0},e.nIterationsRequired={createComponentOfType:"number",createStateVariable:"nIterationsRequired",defaultValue:0,public:!0},e.initialPoint={createComponentOfType:"point"},e.function={createComponentOfType:"function"},e.lockToSolution={createComponentOfType:"boolean",createStateVariable:"lockToSolution",defaultValue:!1},e.defaultPoint={createComponentOfType:"point"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nDimensions.returnDependencies=()=>({}),t.nDimensions.definition=()=>({setValue:{nDimensions:2}}),t.initialPoint={isArray:!0,public:!0,componentType:"math",entryPrefixes:["initialPointX"],defaultValueByArrayKey:()=>yi.fromAst(0),hasEssential:!0,returnWrappingComponents(e){return e==="initialPointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},returnArraySizeDependencies:()=>({}),returnArraySize:()=>[2],returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let i=Number(n)+1;r[n]={initialPointAttr:{dependencyType:"attributeComponent",attributeName:"initialPoint",variableNames:["x"+i]}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={},i={};for(let o of r){let l=Number(o)+1;e[o].initialPointAttr?n[o]=e[o].initialPointAttr.stateValues["x"+l]:i[o]=!0}let s={};return Object.keys(n).length>0&&(s.setValue={initialPoint:n}),Object.keys(i).length>0&&(s.useEssentialOrDefaultValue={initialPoint:i}),s},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:r,dependencyNamesByKey:n}){let i=[];for(let s in e.initialPoint)r[s].initialPointAttr&&r[s].initialPointAttr.stateValues["x"+(Number(s)+1)]?i.push({setDependency:n[s].initialPointAttr,desiredValue:e.initialPoint[s],variableIndex:0}):i.push({setEssentialValue:"initialPoint",value:{[s]:e.initialPoint[s]}});return{success:!0,instructions:i}}},t.f={additionalStateVariablesDefined:[{variableName:"fDefinition",forRenderer:!0}],returnDependencies:()=>({functionAttr:{dependencyType:"attributeComponent",attributeName:"function",variableNames:["numericalf","fDefinition"]}}),definition({dependencyValues:e}){return e.functionAttr?{setValue:{f:e.functionAttr.stateValues.numericalf,fDefinition:e.functionAttr.stateValues.fDefinition}}:{setValue:{f:null,fDefinition:null}}}},t.nVertices={isAlias:!0,targetVariableName:"nPoints"},t.nOriginalVertices={providePreviousValuesInDefinition:!0,returnDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition({dependencyValues:e,previousValues:r}){let n=e.nVertices;return r.nOriginalVertices>n&&(n=r.nOriginalVertices),{setValue:{nOriginalVertices:n}}}},t.originalVertices={isArray:!0,nDimensions:2,hasEssential:!0,entryPrefixes:["originalVertexX","originalVertex"],getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="originalVertexX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},returnArraySizeDependencies:()=>({nOriginalVertices:{dependencyType:"stateVariable",variableName:"nOriginalVertices"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nOriginalVertices-1,e.nDimensions]},returnArrayDependenciesByKey:()=>({globalDependencies:{graphAncestor:{dependencyType:"ancestor",componentType:"graph",variableNames:["xmin","xmax","ymin","ymax"]},defaultPoint:{dependencyType:"attributeComponent",attributeName:"defaultPoint",variableNames:["xs"]}}}),arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r}){let n={};for(let i of r){let s=i.split(",").map(Number);n[i]={get defaultValue(){if(e.defaultPoint){let o=e.defaultPoint.stateValues.xs;if(o.length===2&&s[1]<2)return o[s[1]]}if(e.graphAncestor){if(s[1]===0){let o=e.graphAncestor.stateValues.xmin,l=e.graphAncestor.stateValues.xmax;return yi.fromAst((o+l)/2)}else if(s[1]===1){let o=e.graphAncestor.stateValues.ymin,l=e.graphAncestor.stateValues.ymax;return yi.fromAst((o+l)/2)}}return yi.fromAst(0)}}}return{useEssentialOrDefaultValue:{originalVertices:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let r=[];for(let n in e.originalVertices)r.push({setEssentialValue:"originalVertices",value:{[n]:e.originalVertices[n]}});return{success:!0,instructions:r}}},t.vertices.additionalStateVariablesDefined=[{variableName:"prelimCorrectVertices",entryPrefixes:["prelimCorrectVertexX","prelimCorrectVertex"],getArrayKeysFromVarName:function({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="prelimCorrectVertexX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}}}],t.vertices.basedOnArrayKeyStateVariables=!0,t.vertices.returnArrayDependenciesByKey=function({arrayKeys:e}){let r={f:{dependencyType:"stateVariable",variableName:"f"},attractThreshold:{dependencyType:"stateVariable",variableName:"attractThreshold"},lockToSolution:{dependencyType:"stateVariable",variableName:"lockToSolution"}},n={};for(let i of e){let[s,o]=i.split(",");s==="0"?n[i]={initialPoint:{dependencyType:"stateVariable",variableName:"initialPointX"+(Number(o)+1)}}:n[i]={originalVertexX1:{dependencyType:"stateVariable",variableName:"originalVertexX"+s+"_1"},originalVertexX2:{dependencyType:"stateVariable",variableName:"originalVertexX"+s+"_2"},previousVertexX1:{dependencyType:"stateVariable",variableName:"vertexX"+s+"_1"},previousVertexX2:{dependencyType:"stateVariable",variableName:"vertexX"+s+"_2"}}}return{globalDependencies:r,dependenciesByKey:n}},t.vertices.arrayDefinitionByKey=function({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={},s={};for(let o of n){let[l,u]=o.split(",");if(l==="0")i[o]=r[o].initialPoint,s[o]=null;else{let c,p;try{c=[r[o].originalVertexX1.evaluate_to_constant(),r[o].originalVertexX2.evaluate_to_constant()],p=[r[o].previousVertexX1.evaluate_to_constant(),r[o].previousVertexX2.evaluate_to_constant()]}catch(d){i[l+",0"]=yi.fromAst(0),i[l+",1"]=yi.fromAst(0),s[l+",0"]=!1;continue}let m;if(Number(l)%2==1){let d=e.f(p[0]);m=[p[0],d]}else m=[p[1],p[1]];Math.pow(c[0]-m[0],2)+Math.pow(c[1]-m[1],2)<e.attractThreshold*e.attractThreshold||e.lockToSolution?(i[l+",0"]=yi.fromAst(m[0]),i[l+",1"]=yi.fromAst(m[1]),s[l+",0"]=!0):(i[l+",0"]=r[o].originalVertexX1,i[l+",1"]=r[o].originalVertexX2,s[l+",0"]=!1),s[l+",1"]=null}}return{setValue:{vertices:i,prelimCorrectVertices:s}}},t.vertices.inverseArrayDefinitionByKey=async function({desiredStateVariableValues:e,dependencyNamesByKey:r,initialChange:n,stateValues:i}){if(n&&!await i.draggable)return{success:!1};let s=[];for(let o in e.vertices){let[l,u]=o.split(",");l==="0"?s.push({setDependency:r[o].initialPoint,desiredValue:e.vertices[o]}):s.push({setDependency:r[o]["originalVertexX"+(Number(u)+1)],desiredValue:e.vertices[o]})}return{success:!0,instructions:s}},t.correctVertices={isArray:!0,public:!0,componentType:"boolean",entryPrefixes:["correctVertex"],returnArraySizeDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),returnArraySize({dependencyValues:e}){return[e.nVertices-1]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={prelimCorrectVertex:{dependencyType:"stateVariable",variableName:"prelimCorrectVertexX"+(Number(n)+2)+"_1"}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r)n[i]=e[i].prelimCorrectVertex;return{setValue:{correctVertices:n}}}},t.fractionCorrectVertices={public:!0,componentType:"number",additionalStateVariablesDefined:[{variableName:"nGradedVertices",public:!0,componentType:"number"},{variableName:"nCorrectVertices",public:!0,componentType:"number"}],returnDependencies:()=>({correctVertices:{dependencyType:"stateVariable",variableName:"correctVertices"}}),definition({dependencyValues:e}){let r=e.correctVertices.length,n,i;return r===0?(n=0,i=0):(i=e.correctVertices.reduce((s,o)=>s+o,0),n=i/r),{setValue:{fractionCorrectVertices:n,nGradedVertices:r,nCorrectVertices:i}}}},t.fractionCorrectVerticesAdjusted={public:!0,componentType:"number",additionalStateVariablesDefined:[{variableName:"nGradedVerticesAdjusted",public:!0,componentType:"number"}],returnDependencies:()=>({nCorrectVertices:{dependencyType:"stateVariable",variableName:"nCorrectVertices"},nGradedVertices:{dependencyType:"stateVariable",variableName:"nGradedVertices"},nIterationsRequired:{dependencyType:"stateVariable",variableName:"nIterationsRequired"}}),definition({dependencyValues:e}){let r=0;e.nIterationsRequired>0&&(r=2*e.nIterationsRequired-1);let n=Math.max(e.nGradedVertices,r),i;return n===0?i=0:i=e.nCorrectVertices/n,{setValue:{fractionCorrectVerticesAdjusted:i,nGradedVerticesAdjusted:n}}}},t.nIterateValues={public:!0,componentType:"number",returnDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition:({dependencyValues:e})=>({setValue:{nIterateValues:Math.ceil((e.nVertices+1)/2)}})},t.iterateValues={isArray:!0,public:!0,componentType:"math",entryPrefixes:["iterateValue"],returnArraySizeDependencies:()=>({nIterateValues:{dependencyType:"stateVariable",variableName:"nIterateValues"}}),returnArraySize({dependencyValues:e}){return[e.nIterateValues]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)n==="0"?r[n]={iterateValue:{dependencyType:"stateVariable",variableName:"vertexX1_1"}}:r[n]={iterateValue:{dependencyType:"stateVariable",variableName:"vertexX"+2*Number(n)+"_2"}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r)n[i]=e[i].iterateValue;return{setValue:{iterateValues:n}}}},t}};T(hu,"componentType","cobwebPolyline"),T(hu,"rendererType","cobwebPolyline");import gs from"math-expressions";var Ln=class extends Ge{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.x={createComponentOfType:"math"},e.y={createComponentOfType:"math"},e.z={createComponentOfType:"math"},e.xs={createComponentOfType:"mathList"},e.coords={createComponentOfType:"coords"},e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:10,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e.labelPosition={createComponentOfType:"text",createStateVariable:"labelPosition",defaultValue:"upperright",public:!0,forRenderer:!0,toLowerCase:!0,validValues:["upperright","upperleft","lowerright","lowerleft","top","bottom","left","right"]},e.showCoordsWhenDragging={createComponentOfType:"boolean",createStateVariable:"showCoordsWhenDragging",defaultValue:!0,public:!0,forRenderer:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let i=hs({childrenToComponentFunction:p=>({componentType:"math",children:p}),mustStripOffOuterParentheses:!0}),s=r.map(p=>typeof p),o=s.indexOf("string"),l=s.lastIndexOf("string");if(o===-1){let p=r.filter(m=>m.doenetAttributes&&m.doenetAttributes.createdFromMacro);if(p.length===1){let m=p[0],f=r.indexOf(m),d=[...r.slice(0,f),...r.slice(f+1)];return{success:!0,newAttributes:{coords:{component:{componentType:"math",children:p}}},newChildren:d}}else return{success:!1}}let u=[...r.slice(0,o),...r.slice(l+1)];r=r.slice(o,l+1);let c=i({matchedChildren:r});return!c.success&&r.length===1?{success:!0,newAttributes:{x:{component:{componentType:"math",children:r}}},newChildren:u}:c.success?{success:!0,newAttributes:{xs:{component:{componentType:"mathList",children:c.newChildren,skipSugar:!0}}},newChildren:u}:{success:!1}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"points",componentTypes:["point"]},{group:"constraints",componentTypes:["constraints"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){return{setValue:{styleDescription:e.selectedStyle.markerColor}}}},t.styleDescriptionWithNoun={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let r=e.selectedStyle.markerColor;return e.selectedStyle.markerStyle==="circle"?r+=" point":r+=` ${e.selectedStyle.markerStyle}`,{setValue:{styleDescriptionWithNoun:r}}}},t.coordsShadow={defaultValue:null,hasEssential:!0,essentialVarName:"coords",returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{coordsShadow:!0}}),inverseDefinition:async function({desiredStateVariableValues:e,stateValues:r,workspace:n}){return{success:!0,instructions:[{setEssentialValue:"coordsShadow",value:e.coordsShadow}]}}},t.nDimensions={public:!0,componentType:"number",returnDependencies:()=>({coordsShadow:{dependencyType:"stateVariable",variableName:"coordsShadow"},coords:{dependencyType:"attributeComponent",attributeName:"coords",variableNames:["value"]},x:{dependencyType:"attributeComponent",attributeName:"x"},y:{dependencyType:"attributeComponent",attributeName:"y"},z:{dependencyType:"attributeComponent",attributeName:"z"},xs:{dependencyType:"attributeComponent",attributeName:"xs",variableNames:["nComponents"]},pointChild:{dependencyType:"child",childGroups:["points"],variableNames:["nDimensions"]}}),definition:function({dependencyValues:e}){let r=!1,n,i;if(e.z!==null?i=3:e.y!==null?i=2:e.x!==null?i=1:i=0,e.coords!==null?(r=!0,n=e.coords.stateValues.value):e.coordsShadow&&(r=!0,n=e.coordsShadow),r){let s=n.tree;return Array.isArray(s)&&["tuple","vector"].includes(s[0])?i=Math.max(s.length-1,i):i=Math.max(1,i),{setValue:{nDimensions:i},checkForActualChange:{nDimensions:!0}}}else return e.xs!==null?{setValue:{nDimensions:Math.max(e.xs.stateValues.nComponents,i)}}:e.pointChild.length>0?{setValue:{nDimensions:Math.max(e.pointChild[0].stateValues.nDimensions,i)}}:(i===0&&(i=2),{setValue:{nDimensions:i},checkForActualChange:{nDimensions:!0}})}},t.arrayVariableForConstraints={returnDependencies:()=>({}),definition:()=>({setValue:{arrayVariableForConstraints:"unconstrainedXs"}})},t.arrayEntryPrefixForConstraints={returnDependencies:()=>({}),definition:()=>({setValue:{arrayEntryPrefixForConstraints:"unconstrainedX"}})},t.nDimensionsForConstraints={isAlias:!0,targetVariableName:"nDimensions"},t.unconstrainedXs={isArray:!0,entryPrefixes:["unconstrainedX"],defaultValueByArrayKey:()=>gs.fromAst(0),hasEssential:!0,returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={coordsShadow:{dependencyType:"stateVariable",variableName:"coordsShadow"},coords:{dependencyType:"attributeComponent",attributeName:"coords",variableNames:["value"]}},n={};for(let i of e){let s=Number(i)+1;n[i]={xs:{dependencyType:"attributeComponent",attributeName:"xs",variableNames:["math"+s]},pointChild:{dependencyType:"child",childGroups:["points"],variableNames:["x"+s]}},i==="0"?n[i].component={dependencyType:"attributeComponent",attributeName:"x",variableNames:["value"]}:i==="1"?n[i].component={dependencyType:"attributeComponent",attributeName:"y",variableNames:["value"]}:i==="2"&&(n[i].component={dependencyType:"attributeComponent",attributeName:"z",variableNames:["value"]})}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={},s={},o=!1,l;if(e.coords!==null?(o=!0,l=e.coords.stateValues.value):e.coordsShadow&&(o=!0,l=e.coordsShadow),o){let c=l.tree;if(Array.isArray(c)&&["tuple","vector"].includes(c[0]))for(let p of n){let m=Number(p);(m>=0||m<c.length-1)&&(l.tree[m+1]===void 0?i[p]=gs.fromAst("\uFF3F"):i[p]=l.get_component(m).simplify())}else n.includes("0")&&(i[0]=l.simplify())}else for(let c of n){let p=Number(c)+1,m=r[c].xs;if(m!==null){let f=m.stateValues["math"+p];f!==void 0&&(i[c]=f.simplify())}else{let f=r[c].pointChild;f.length>0&&(i[c]=f[0].stateValues["x"+p])}}for(let c of n){let p=r[c].component;p?i[c]=p.stateValues.value.simplify():i[c]===void 0&&(s[c]=!0)}let u={};return Object.keys(i).length>0&&(u.setValue={unconstrainedXs:i}),Object.keys(s).length>0&&(u.useEssentialOrDefaultValue={unconstrainedXs:s}),u},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[],l=!1,u,c,p=!1;r.coords!==null?(l=!0,u="coords",c=Array(s[0]+1)):r.coordsShadow!==null&&(l=!0,u="coordsShadow",c=Array(s[0]+1));for(let m of Object.keys(e.unconstrainedXs).reverse()){let f=se(e.unconstrainedXs[m]);n[m].component!==null?o.push({setDependency:i[m].component,desiredValue:f,childIndex:0,variableIndex:0}):l?(c[Number(m)+1]=f.tree,p=!0):n[m].xs!==null?o.push({setDependency:i[m].xs,desiredValue:f,childIndex:0,variableIndex:0}):n[m].pointChild.length>0?o.push({setDependency:i[m].pointChild,desiredValue:f,childIndex:0,variableIndex:0}):o.push({setEssentialValue:"unconstrainedXs",value:{[m]:f}})}if(p){let m;s[0]===1?m=gs.fromAst(c[1]):(c[0]="vector",m=gs.fromAst(c));let f={setDependency:u,desiredValue:m};u==="coords"&&(f.childIndex=0,f.variableIndex=0),o.push(f)}return{success:!0,instructions:o}}},t.xs={public:!0,componentType:"math",isArray:!0,entryPrefixes:["x"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let i=Number(n)+1,s={};s.unconstrainedX={dependencyType:"stateVariable",variableName:`unconstrainedX${i}`},s.constraintsChild={dependencyType:"child",childGroups:["constraints"],variableNames:[`constraintResult${i}`]},r[n]=s}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r)if(e[i].constraintsChild.length>0){let s=Number(i)+1;n[i]=se(e[i].constraintsChild[0].stateValues["constraintResult"+s])}else n[i]=se(e[i].unconstrainedX);return r.length>0?{setValue:{xs:n}}:{}},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:r,dependencyNamesByKey:n,initialChange:i,stateValues:s}){if(i&&!await s.draggable)return{success:!1};let o=[];for(let l of Object.keys(e.xs).reverse())!r[l]||(r[l].constraintsChild.length>0?o.push({setDependency:n[l].constraintsChild,desiredValue:e.xs[l],childIndex:0,variableIndex:0}):o.push({setDependency:n[l].unconstrainedX,desiredValue:e.xs[l]}));return{success:!0,instructions:o}}},t.x={isAlias:!0,targetVariableName:"x1"},t.y={isAlias:!0,targetVariableName:"x2"},t.z={isAlias:!0,targetVariableName:"x3"},t.coords={public:!0,componentType:"coords",returnDependencies:()=>({xs:{dependencyType:"stateVariable",variableName:"xs"}}),definition:function({dependencyValues:e}){let r=[];for(let n of e.xs)n?r.push(n.tree):r.push("\uFF3F");return r.length>1?r=["vector",...r]:r.length===1?r=r[0]:r="\uFF3F",{setValue:{coords:gs.fromAst(r)}}},inverseDefinition:async function({desiredStateVariableValues:e,stateValues:r,initialChange:n}){if(n&&!await r.draggable)return{success:!1};let i=[],s={},o=e.coords.tree;if(!(Array.isArray(o)&&["tuple","vector"].includes(o[0])))s[0]=e.coords;else for(let l=0;l<o.length-1;l++){let u=e.coords.get_component(l);u.tree!==void 0&&(s[l]=u)}return i.push({setDependency:"xs",desiredValue:s}),{success:!0,instructions:i}}},t.coordsForDisplay={forRenderer:!0,returnDependencies:()=>({coords:{dependencyType:"stateVariable",variableName:"coords"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}}),definition:function({dependencyValues:e,usedDefault:r}){return{setValue:{coordsForDisplay:Lt({value:e.coords,dependencyValues:e,usedDefault:r})}}}},t.value={isAlias:!0,targetVariableName:"coords"},t.constraintUsed={public:!0,componentType:"boolean",returnDependencies:()=>({constraintsChild:{dependencyType:"child",childGroups:["constraints"],variableNames:["constraintUsed"]}}),definition:function({dependencyValues:e}){return e.constraintsChild.length===0?{setValue:{constraintUsed:!1}}:{setValue:{constraintUsed:e.constraintsChild[0].stateValues.constraintUsed}}}},t.numericalXs={public:!0,componentType:"number",isArray:!0,entryPrefixes:["numericalX"],forRenderer:!0,returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let i=Number(n)+1;r[n]={x:{dependencyType:"stateVariable",variableName:`x${i}`}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=e[i].x;s?(s=e[i].x.evaluate_to_constant(),Number.isFinite(s)?n[i]=s:n[i]=NaN):n[i]=NaN}return{setValue:{numericalXs:n}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,initialChange:n,stateValues:i}){if(n&&!await i.draggable)return{success:!1};let s=[];for(let o in e.numericalXs)!dependencyValuesByKey[o]||s.push({setDependency:r[o].xs,desiredValue:e.numericalXs[o]});return{success:!0,instructions:s}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalXs:{dependencyType:"stateVariable",variableName:"numericalXs"}}),definition:({dependencyValues:e})=>({setValue:{nearestPoint:function(){let r={};for(let n=1;n<=e.nDimensions;n++){let i=e.numericalXs[n-1];if(!Number.isFinite(i))return{};r["x"+n]=i}return r}}})},t}async movePoint({x:t,y:e,z:r,transient:n,actionId:i}){let s={};return t!==void 0&&(s[0]=gs.fromAst(t)),e!==void 0&&(s[1]=gs.fromAst(e)),r!==void 0&&(s[2]=gs.fromAst(r)),n?await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"xs",value:s}],transient:n,actionId:i}):await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"xs",value:s}],actionId:i,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{x:t,y:e,z:r}}})}switchPoint(){}actions={movePoint:this.movePoint.bind(this),switchPoint:this.switchPoint.bind(this)}};T(Ln,"componentType","point"),T(Ln,"primaryStateVariableForDefinition","coordsShadow"),T(Ln,"stateVariableForAttributeValue","coords"),T(Ln,"adapters",["coords"]);var yu=class extends Ln{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.stable={createComponentOfType:"boolean",createStateVariable:"stable",defaultValue:!0,public:!0},e.switchable={createComponentOfType:"boolean",createStateVariable:"switchable",defaultValue:!1,public:!0,forRenderer:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.open={forRenderer:!0,returnDependencies:()=>({stable:{dependencyType:"stateVariable",variableName:"stable"}}),definition({dependencyValues:e}){return{setValue:{open:!e.stable}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"stable",desiredValue:!e.open}]}}},t}async switchPoint({actionId:t}){if(await this.stateValues.switchable)return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"stable",value:!this.stateValues.stable}],actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{stable:!this.stateValues.stable}}});this.coreFunctions.resolveAction({actionId:t})}};T(yu,"componentType","equilibriumPoint"),T(yu,"rendererType","point");import je from"math-expressions";var za=class extends Ge{actions={moveLine:this.moveLine.bind(this),switchLine:this.switchLine.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.equation={createComponentOfType:"math"},e.through={createComponentOfType:"_pointListComponent"},e.slope={createComponentOfType:"number"},e.variables={createComponentOfType:"variables"},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){return r.length===0?{success:!1}:r.every(n=>typeof n=="string"||n.doenetAttributes&&n.doenetAttributes.createdFromMacro)?{success:!0,newAttributes:{equation:{component:{componentType:"math",children:r}}}}:{success:!1}};return t.push({replacementFunction:e}),t}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let r="";return e.selectedStyle.lineWidth>=4?r+="thick ":e.selectedStyle.lineWidth<=1&&(r+="thin "),e.selectedStyle.lineStyle==="dashed"?r+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=e.selectedStyle.lineColor,{setValue:{styleDescription:r}}}},t.nDimensions={public:!0,componentType:"number",stateVariablesDeterminingDependencies:["equationIdentity"],returnDependencies:function({stateValues:e}){return e.equationIdentity===null?{through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nDimensions"]}}:{equation:{dependencyType:"attributeComponent",attributeName:"equation"}}},definition:function({dependencyValues:e,changes:r}){return e.equation?r.equation&&r.equation.componentIdentitiesChanged?{setValue:{nDimensions:2},checkForActualChange:{nDimensions:!0}}:{noChanges:["nDimensions"]}:e.through?{setValue:{nDimensions:e.through.stateValues.nDimensions},checkForActualChange:{nDimensions:!0}}:{setValue:{nDimensions:2}}}},t.nPointsPrescribed={returnDependencies:()=>({throughAttr:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nPoints"]}}),definition:function({dependencyValues:e}){return e.throughAttr===null?{setValue:{nPointsPrescribed:0}}:{setValue:{nPointsPrescribed:e.throughAttr.stateValues.nPoints}}}},t.basedOnSlope={returnDependencies:()=>({slopeAttr:{dependencyType:"attributeComponent",attributeName:"slope"},nPointsPrescribed:{dependencyType:"stateVariable",variableName:"nPointsPrescribed"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),definition({dependencyValues:e}){return{setValue:{basedOnSlope:e.nPointsPrescribed<2&&e.slopeAttr!==null&&e.nDimensions===2}}}},t.dForSlope={defaultValue:1,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{dForSlope:!0}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"dForSlope",value:e.dForSlope}]}}},t.variables={isArray:!0,public:!0,componentType:"variable",entryPrefixes:["var"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey(){return{globalDependencies:{variables:{dependencyType:"attributeComponent",attributeName:"variables",variableNames:["variables"]}}}},arrayDefinitionByKey({globalDependencyValues:e,arraySize:r}){let n=[];return e.variables!==null&&(n=e.variables.stateValues.variables),{setValue:{variables:En(r[0],n)}}}},t.equationIdentity={returnDependencies:()=>({equation:{dependencyType:"attributeComponent",attributeName:"equation"}}),definition:function({dependencyValues:e}){return e.equation!==null?{setValue:{equationIdentity:e.equation}}:{setValue:{equationIdentity:null}}}},t.essentialPoints={isArray:!0,nDimensions:"2",hasEssential:!0,entryPrefixes:["essentialPointX","essentialPoint"],set:se,defaultValueByArrayKey:e=>je.fromAst(e==="0,0"?1:0),getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="essentialPointX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[2,e.nDimensions]},returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey({arrayKeys:e}){let r={};for(let n of e)r[n]=!0;return{useEssentialOrDefaultValue:{essentialPoints:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let r=[];for(let n in e.essentialPoints)r.push({setEssentialValue:"essentialPoints",value:{[n]:se(e.essentialPoints[n])}});return{success:!0,instructions:r}}},t.points={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["pointX","point"],returnWrappingComponents(e){return e==="pointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="pointX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},stateVariablesDeterminingDependencies:["equationIdentity","nPointsPrescribed","basedOnSlope"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[2,e.nDimensions]},returnArrayDependenciesByKey({stateValues:e,arrayKeys:r}){if(e.equationIdentity===null){let n={};for(let s of r){let[o,l]=s.split(","),u=Number(o)+1+"_"+(Number(l)+1);n[s]={through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["pointX"+u]}},e.basedOnSlope?(o==="1"&&(e.nPointsPrescribed===1&&n[s].through.variableNames.push("pointX1_"+(Number(l)+1)),n[s].dForSlope={dependencyType:"stateVariable",variableName:"dForSlope"},n[s].slopeAttr={dependencyType:"attributeComponent",attributeName:"slope",variableNames:["value"]}),e.nPointsPrescribed===0&&(n[s].essentialPoint={dependencyType:"stateVariable",variableName:"essentialPointX2_"+(Number(l)+1)})):n[s].essentialPoint={dependencyType:"stateVariable",variableName:"essentialPointX"+u}}return{dependenciesByKey:n,globalDependencies:{nPointsPrescribed:{dependencyType:"stateVariable",variableName:"nPointsPrescribed"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},basedOnSlope:{dependencyType:"stateVariable",variableName:"basedOnSlope"}}}}else return{globalDependencies:{coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"},variables:{dependencyType:"stateVariable",variableName:"variables"},lastPointsFromInverting:{dependencyType:"stateVariable",variableName:"lastPointsFromInverting"}}}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n,arraySize:i,componentName:s}){if("coeff0"in e){let o=yq(e);if(o.success)return{setValue:{points:o.points}};{let l={};for(let u=0;u<i[0];u++)for(let c=0;c<i[1];c++)l[u+","+c]=je.fromAst("\uFF3F");return{setValue:{points:l}}}}else{let o={};for(let l of n){let[u,c]=l.split(","),p=Number(u)+1+"_"+(Number(c)+1);if(r[l].through!==null&&r[l].through.stateValues["pointX"+p])o[l]=r[l].through.stateValues["pointX"+p];else if(e.basedOnSlope){let m;if(e.nPointsPrescribed===1?m=r[l].through.stateValues["pointX1_"+(Number(c)+1)]:m=r[l].essentialPoint,u==="0")o[l]=m;else{let f=r[l].slopeAttr.stateValues.value;if(f===1/0||f===-1/0)c==="0"?o[l]=m:o[l]=je.fromAst(["+",m.tree,r[l].dForSlope*Math.sign(f)]);else if(Number.isFinite(f)){let d=Math.atan(f);c==="0"?o[l]=je.fromAst(["+",m.tree,r[l].dForSlope*Math.cos(d)]):o[l]=je.fromAst(["+",m.tree,r[l].dForSlope*Math.sin(d)])}else o[l]=je.fromAst("\uFF3F")}}else o[l]=r[l].essentialPoint}return{setValue:{points:o}}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,initialChange:s,stateValues:o,workspace:l}){if(s&&!await o.draggable)return{success:!1};if("coeff0"in r){l.desiredPoints||(l.desiredPoints={}),Object.assign(l.desiredPoints,e.points);let u=await o.points,c,p,m,f;if(l.desiredPoints["0,0"]?c=l.desiredPoints["0,0"]:c=u[0][0],l.desiredPoints["0,1"]?p=l.desiredPoints["0,1"]:p=u[0][1],l.desiredPoints["1,0"]?m=l.desiredPoints["1,0"]:m=u[1][0],l.desiredPoints["1,1"]?f=l.desiredPoints["1,1"]:f=u[1][1],typeof c.tree=="number"&&typeof p.tree=="number"&&typeof m.tree=="number"&&typeof f.tree=="number"){let b=[c.tree,p.tree],g=[m.tree,f.tree],v=b[1]-g[1],A=g[0]-b[0],C=b[0]*g[1]-b[1]*g[0],S=await o.coeffvar1,w=await o.coeffvar2,x=Math.abs(v*w-S*A),R=[];return x<Math.abs(v*w)*1e-12?(v!==0?C*=S/v:C*=w/A,R.push({setDependency:"coeff0",desiredValue:C,additionalDependencyValues:{coeffvar1:S,coeffvar2:w}})):R.push({setDependency:"coeff0",desiredValue:C,additionalDependencyValues:{coeffvar1:v,coeffvar2:A}}),R.push({setDependency:"lastPointsFromInverting",desiredValue:[b,g]}),{success:!0,instructions:R}}let d=p.subtract(f).simplify(),h=m.subtract(c).simplify(),y=c.multiply(f).subtract(p.multiply(m)).simplify();return{success:!0,instructions:[{setDependency:"coeff0",desiredValue:y,additionalDependencyValues:{coeffvar1:d,coeffvar2:h}}]}}else{let u=[];for(let c of Object.keys(e.points).reverse()){let[p,m]=c.split(","),f=Number(p)+1+"_"+(Number(m)+1);if(n[c].through!==null&&n[c].through.stateValues["pointX"+f])u.push({setDependency:i[c].through,desiredValue:e.points[c],variableIndex:0});else if(r.basedOnSlope)if(p==="0")u.push({setDependency:i[c].essentialPoint,desiredValue:e.points[c],variableIndex:0});else{let d=e.points[c];d instanceof je.class&&(d=d.evaluate_to_constant(),d===null&&(d=NaN)),l.desiredPoint1||(l.desiredPoint1=[]),l.desiredPoint1[m]=d;let h=m==="0"?"1":"0";if(l.desiredPoint1[h]===void 0){let y=(await o.points)[1][h].evaluate_to_constant();y===null&&(y=NaN),l.desiredPoint1[h]=y}if(l.desiredPoint1.every(Number.isFinite)){let y=(await o.points)[0][0].evaluate_to_constant(),b=(await o.points)[0][1].evaluate_to_constant();if(Number.isFinite(y)&&Number.isFinite(b)){let g=l.desiredPoint1[0]-y,v=l.desiredPoint1[1]-b,A=Math.sqrt(g*g+v*v);g!==0&&(A*=Math.sign(g)),u.push({setDependency:i[c].dForSlope,desiredValue:A}),u.push({setDependency:i[c].slopeAttr,desiredValue:v/g,variableIndex:0})}}}else u.push({setDependency:i[c].essentialPoint,desiredValue:e.points[c]})}return{success:!0,instructions:u}}}},t.equation={public:!0,componentType:"math",forRenderer:!0,stateVariablesDeterminingDependencies:["equationIdentity"],additionalStateVariablesDefined:[{variableName:"coeff0",public:!0,componentType:"math"},{variableName:"coeffvar1",public:!0,componentType:"math"},{variableName:"coeffvar2",public:!0,componentType:"math"}],returnDependencies:function({stateValues:e}){let r={variables:{dependencyType:"stateVariable",variableName:"variables"}};return e.equationIdentity===null?(r.points={dependencyType:"stateVariable",variableName:"points"},r.nDimensions={dependencyType:"stateVariable",variableName:"nDimensions"}):r.equation={dependencyType:"attributeComponent",attributeName:"equation",variableNames:["value"]},r},definition:function({dependencyValues:e}){let r=e.variables,n=je.fromAst("\uFF3F");if(e.equation){let h=e.equation.stateValues.value,y=hq({equation:h,variables:r});if(!y.success)return{setValue:{equation:h,coeff0:n,coeffvar1:n,coeffvar2:n}};let{coeff0:b,coeffvar1:g,coeffvar2:v}=y;return{setValue:{equation:h,coeff0:b,coeffvar1:g,coeffvar2:v}}}let i=e.nDimensions;if(Number.isNaN(i))return console.warn("Line through points of undetermined dimensions"),{setValue:{equation:n,coeff0:n,coeffvar1:n,coeffvar2:n}};if(i<2)return console.warn("Line must be through points of at least two dimensions"),{setValue:{equation:n,coeff0:n,coeffvar1:n,coeffvar2:n}};let s=e.points[0][0],o=e.points[0][1],l=e.points[1][0],u=e.points[1][1],c=[...r.map(h=>h.toString())];for(let h=0;h<i;h++)if(s.variables().indexOf(c[h])!==-1||o.variables().indexOf(c[h])!==-1||l.variables().indexOf(c[h])!==-1||u.variables().indexOf(c[h])!==-1)return console.warn("Points through line depend on variables: "+c.join(", ")),{setValue:{equation:n,coeff0:n,coeffvar1:n,coeffvar2:n}};if(i!==2)return{setValue:{equation:n,coeff0:n,coeffvar1:n,coeffvar2:n}};if(s.equals(l)&&o.equals(u)){let h=je.fromAst(0);return{setValue:{equation:n,coeff0:h,coeffvar1:h,coeffvar2:h}}}let p=o.subtract(u).simplify(),m=l.subtract(s).simplify(),f=s.multiply(u).subtract(o.multiply(l)).simplify();return{setValue:{equation:je.fromAst(["=",["+",["*","a","x"],["*","b","y"],"c"],0]).substitute({a:p,b:m,c:f,x:r[0],y:r[1]}).simplify(),coeff0:f,coeffvar1:p,coeffvar2:m}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){if(r.points)return console.log("Haven't implemented inverse definition of equation of line based on points"),{success:!1};if(e.equation)return{success:!0,instructions:[{setDependency:"equation",desiredValue:e.equation,variableIndex:0}]};if(!("coeff0"in e&&"coeffvar1"in e&&"coeffvar2"in e))return console.log("Haven't implemented inverting coeffs if not specifying all of them"),{success:!1};let n=je.fromAst(["=",0,["+",["*","a","x"],["*","b","y"],"c"]]).substitute({a:e.coeffvar1,b:e.coeffvar2,c:e.coeff0,x:r.variables[0],y:r.variables[1]}).simplify();return{success:!0,instructions:[{setDependency:"equation",desiredValue:n,variableIndex:0}]}}},t.numericalPoints={isArray:!0,entryPrefixes:["numericalPoint"],forRenderer:!0,returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return Number.isNaN(e.nDimensions)?[0]:[2]},returnArrayDependenciesByKey({arrayKeys:e}){let r={nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}},n={};for(let i of e)n[i]={point:{dependencyType:"stateVariable",variableName:"point"+(Number(i)+1)}};return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n,componentName:i}){if(Number.isNaN(e.nDimensions))return{};let s={};for(let o of n){let l=r[o].point;Array.isArray(l)||(l=[l]);let u=[];for(let c=0;c<e.nDimensions;c++){let p=l[c].evaluate_to_constant();Number.isFinite(p)||(p=NaN),u.push(p)}s[o]=u}return{setValue:{numericalPoints:s}}}},t.numericalCoeff0={additionalStateVariablesDefined:["numericalCoeffvar1","numericalCoeffvar2"],returnDependencies:()=>({coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"}}),definition:function({dependencyValues:e}){let r=e.coeff0.evaluate_to_constant();Number.isFinite(r)||(r=NaN);let n=e.coeffvar1.evaluate_to_constant();Number.isFinite(n)||(n=NaN);let i=e.coeffvar2.evaluate_to_constant();return Number.isFinite(i)||(i=NaN),{setValue:{numericalCoeff0:r,numericalCoeffvar1:n,numericalCoeffvar2:i}}}},t.slope={public:!0,componentType:"math",returnDependencies:()=>({coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"}}),definition:function({dependencyValues:e}){return{setValue:{slope:je.fromAst(["-",["/","a","b"]]).substitute({a:e.coeffvar1,b:e.coeffvar2}).simplify()}}}},t.xintercept={public:!0,componentType:"math",returnDependencies:()=>({coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"}}),definition:({dependencyValues:e})=>({setValue:{xintercept:je.fromAst(["-",["/","a","b"]]).substitute({a:e.coeff0,b:e.coeffvar1}).simplify()}})},t.yintercept={public:!0,componentType:"math",returnDependencies:()=>({coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"}}),definition:({dependencyValues:e})=>({setValue:{yintercept:je.fromAst(["-",["/","a","b"]]).substitute({a:e.coeff0,b:e.coeffvar2}).simplify()}})},t.lastPointsFromInverting={defaultValue:null,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{lastPointsFromInverting:!0}}),inverseDefinition:({desiredStateVariableValues:e})=>({success:!0,instructions:[{setEssentialValue:"lastPointsFromInverting",value:e.lastPointsFromInverting}]})},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalCoeff0:{dependencyType:"stateVariable",variableName:"numericalCoeff0"},numericalCoeffvar1:{dependencyType:"stateVariable",variableName:"numericalCoeffvar1"},numericalCoeffvar2:{dependencyType:"stateVariable",variableName:"numericalCoeffvar2"}}),definition({dependencyValues:e}){let r=e.numericalCoeffvar1,n=e.numericalCoeffvar2,i=e.numericalCoeff0,s=Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i),o=e.nDimensions!==2||!s||r===0&&n===0;return{setValue:{nearestPoint:function({variables:l,scales:u}){if(o)return{};let c=u[0],p=u[1],m=r*c,f=n*p,d=m*m+f*f,h=l.x1.evaluate_to_constant(),y=l.x2.evaluate_to_constant();if(!(Number.isFinite(h)&&Number.isFinite(y)))return{};let b=h/c,g=y/p,v={};return v.x1=(f*(f*b-m*g)-m*i)*c/d,v.x2=(m*(-f*b+m*g)-f*i)*p/d,l.x3!==void 0&&(v.x3=0),v}}}}},t}async moveLine({point1coords:t,point2coords:e,transient:r,actionId:n}){let i={"0,0":je.fromAst(t[0]),"0,1":je.fromAst(t[1])};return await this.stateValues.basedOnSlope||(i["1,0"]=je.fromAst(e[0]),i["1,1"]=je.fromAst(e[1])),r?await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"points",value:i}],transient:!0,actionId:n}):await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"points",value:i}],actionId:n,event:{verb:"interacted",object:{componentId:this.componentName},result:{point1:t,point2:e}}})}switchLine(){}};T(za,"componentType","line"),T(za,"adapters",["equation"]);function hq({equation:a,variables:t}){let e=t[0],r=t[1],n=e.toString(),i=r.toString();a=a.expand().simplify();let s=je.fromAst(["+",a.tree[2],["-",a.tree[1]]]).expand().simplify(),o=[];Array.isArray(s.tree)&&s.tree[0]==="+"?o=s.tree.slice(1):o=[s.tree];let l=je.fromAst(0),u=je.fromAst(0),c=je.fromAst(0);for(let m of o){let f=p(m);if(!f.success)return{success:!1};l=l.add(f.coeffvar1),u=u.add(f.coeffvar2),c=c.add(f.coeff0)}return l=l.simplify(),u=u.simplify(),c=c.simplify(),{success:!0,coeff0:c,coeffvar1:l,coeffvar2:u};function p(m){let f=0,d=0,h=0;if(typeof m=="string")m===n?f=1:m===i?d=1:h=m;else if(typeof m=="number")h=m;else if(Array.isArray(m)){let y=m[0],b=m.slice(1);if(y==="-"){let g=p(b[0]);if(!g.success)return{success:!1};f=["-",g.coeffvar1.tree],d=["-",g.coeffvar2.tree],h=["-",g.coeff0.tree]}else{if(y==="+")return console.warn("Invalid format for equation of line in variables "+e+" and "+r),{success:!1};if(y==="*"){let g=-1,v=-1;for(let A=0;A<b.length;A++)if(e.equals(je.fromAst(b[A]))){g=A;break}else if(r.equals(je.fromAst(b[A]))){v=A;break}g!==-1?(b.splice(g,1),b.length===1?f=b[0]:f=["*"].concat(b)):v!==-1?(b.splice(v,1),b.length===1?d=b[0]:d=["*"].concat(b)):h=m}else if(y==="/"){let g=p(b[0]);if(!g.success)return{success:!1};f=["/",g.coeffvar1.tree,b[1]],d=["/",g.coeffvar2.tree,b[1]],h=["/",g.coeff0.tree,b[1]]}else y==="_"?e.equals(je.fromAst(m))?f=1:r.equals(je.fromAst(m))?d=1:h=m:h=m}}else return console.warn("Invalid format for equation of line in variables "+e+" and "+r),{success:!1};return{success:!0,coeffvar1:je.fromAst(f),coeffvar2:je.fromAst(d),coeff0:je.fromAst(h)}}}function yq({coeff0:a,coeffvar1:t,coeffvar2:e,variables:r,lastPointsFromInverting:n}){let i=r[0],s=r[1],o=i.toString(),l=s.toString();if(t.variables(!0).indexOf(o)!==-1||t.variables(!0).indexOf(l)!==-1||e.variables(!0).indexOf(o)!==-1||e.variables(!0).indexOf(l)!==-1||a.variables(!0).indexOf(o)!==-1||a.variables(!0).indexOf(l)!==-1)return console.warn("Invalid format for equation of line in variables "+o+" and "+l),{success:!1};let u=je.fromAst(0);if(t.equals(u)&&e.equals(u))return console.warn("Invalid format for equation of line in variables "+o+" and "+l),{success:!1};let c=t.evaluate_to_constant(),p=e.evaluate_to_constant(),m=a.evaluate_to_constant(),f,d,h,y,b={};if(Number.isFinite(m)&&Number.isFinite(c)&&Number.isFinite(p)){let g=c*c+p*p;if(g===0)return{success:!1};if(n){let v=n[0][0],A=n[0][1];f=(p*(p*v-c*A)-c*m)/g,d=(c*(-p*v+c*A)-p*m)/g,v=n[1][0],A=n[1][1],h=(p*(p*v-c*A)-c*m)/g,y=(c*(-p*v+c*A)-p*m)/g}else f=(2*p-c*m)/g,d=(-2*c-p*m)/g,h=(p-c*m)/g,y=-(c+p*m)/g;b["0,0"]=je.fromAst(f),b["0,1"]=je.fromAst(d),b["1,0"]=je.fromAst(h),b["1,1"]=je.fromAst(y)}else{let g=t.pow(2).add(e.pow(2));f=e.multiply(2).subtract(t.multiply(a)).divide(g),d=t.multiply(-2).subtract(e.multiply(a)).divide(g),h=e.subtract(t.multiply(a)).divide(g),y=t.add(e.multiply(a)).multiply(-1).divide(g),b["0,0"]=f,b["0,1"]=d,b["1,0"]=h,b["1,1"]=y}return{success:!0,points:b}}var bu=class extends za{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.stable={createComponentOfType:"boolean",createStateVariable:"stable",defaultValue:!0,public:!0},e.switchable={createComponentOfType:"boolean",createStateVariable:"switchable",defaultValue:!1,public:!0,forRenderer:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.dashed={forRenderer:!0,returnDependencies:()=>({stable:{dependencyType:"stateVariable",variableName:"stable"}}),definition({dependencyValues:e}){return{setValue:{dashed:!e.stable}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"stable",desiredValue:!e.dashed}]}}},t}async switchLine({actionId:t}){if(await this.stateValues.switchable)return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"stable",value:!this.stateValues.stable}],actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{stable:!this.stateValues.stable}}});this.coreFunctions.resolveAction({actionId:t})}};T(bu,"componentType","equilibriumLine"),T(bu,"rendererType","line");import Sr from"math-expressions";var Rn=class extends Ge{actions={moveControlVector:this.moveControlVector.bind(this),moveThroughPoint:this.moveThroughPoint.bind(this),changeVectorControlDirection:this.changeVectorControlDirection.bind(this),switchCurve:this.switchCurve.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.labelPosition={createComponentOfType:"text",createStateVariable:"labelPosition",defaultValue:"upperright",public:!0,forRenderer:!0,toLowerCase:!0,validValues:["upperright","upperleft","lowerright","lowerleft","top","bottom","left","right"]},e.flipFunction={createComponentOfType:"boolean",createStateVariable:"flipFunction",defaultValue:!1,public:!0,forRenderer:!0},e.nDiscretizationPoints={createComponentOfType:"number",createStateVariable:"nDiscretizationPoints",defaultValue:1e3,public:!0},e.periodic={createComponentOfType:"boolean",createStateVariable:"periodic",defaultValue:!1,public:!0},e.splineTension={createComponentOfType:"number",createStateVariable:"splineTension",defaultValue:.8,clamp:[0,1],public:!0},e.extrapolateBackward={createComponentOfType:"boolean",createStateVariable:"extrapolateBackward",defaultValue:!1,public:!0,forRenderer:!0},e.extrapolateForward={createComponentOfType:"boolean",createStateVariable:"extrapolateForward",defaultValue:!1,public:!0,forRenderer:!0},e.splineForm={createComponentOfType:"text",createStateVariable:"splineForm",defaultValue:"centripetal",public:!0,toLowerCase:!0,validValues:["centripetal","uniform"]},e.variable={createComponentOfType:"variable",createStateVariable:"variableForChild",defaultValue:Sr.fromAst("x")},e.through={createComponentOfType:"_pointListComponent"},e.parMin={createComponentOfType:"math"},e.parMax={createComponentOfType:"math"},e.nearestPointAsCurve={createComponentOfType:"boolean",createStateVariable:"nearestPointAsCurve",defaultValue:!1},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){if(r.length===0||!r.every(o=>typeof o=="string"||o.doenetAttributes&&o.doenetAttributes.createdFromMacro))return{success:!1};let s=hs({childrenToComponentFunction:o=>({componentType:"function",children:o}),mustStripOffOuterParentheses:!0})({matchedChildren:r});return s.success?s:{success:!0,newChildren:[{componentType:"function",children:r}]}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"functions",componentTypes:["function"]},{group:"bezierControls",componentTypes:["bezierControls"]}]}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:r}){let n="";return r.selectedStyle.lineWidth>=4?n+="thick ":r.selectedStyle.lineWidth<=1&&(n+="thin "),r.selectedStyle.lineStyle==="dashed"?n+="dashed ":r.selectedStyle.lineStyle==="dotted"&&(n+="dotted "),n+=r.selectedStyle.lineColor,{setValue:{styleDescription:n}}}},e.curveType={forRenderer:!0,returnDependencies:()=>({functionChildren:{dependencyType:"child",childGroups:["functions"]},through:{dependencyType:"attributeComponent",attributeName:"through"}}),definition({dependencyValues:r}){let n="function";return r.through!==null?n="bezier":r.functionChildren.length>1&&(n="parameterization"),{setValue:{curveType:n}}}},e.fShadow={defaultValue:null,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{fShadow:!0}})},e.graphXmin={forRenderer:!0,additionalStateVariablesDefined:[{variableName:"graphXmax",forRenderer:!0},{variableName:"graphYmin",forRenderer:!0},{variableName:"graphYmax",forRenderer:!0}],returnDependencies:()=>({graphAncestor:{dependencyType:"ancestor",componentType:"graph",variableNames:["xmin","xmax","ymin","ymax"]}}),definition({dependencyValues:r}){return r.graphAncestor?{setValue:{graphXmin:r.graphAncestor.stateValues.xmin,graphXmax:r.graphAncestor.stateValues.xmax,graphYmin:r.graphAncestor.stateValues.ymin,graphYmax:r.graphAncestor.stateValues.ymax}}:{setValue:{graphXmin:null,graphXmax:null,graphYmin:null,graphYmax:null}}}},e.parMax={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({curveType:{dependencyType:"stateVariable",variableName:"curveType"},parMaxAttr:{dependencyType:"attributeComponent",attributeName:"parMax",variableNames:["value"]},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},extrapolateForward:{dependencyType:"stateVariable",variableName:"extrapolateForward"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["domain"]},adapterSourceDomain:{dependencyType:"adapterSourceStateVariable",variableName:"domain"},graphXmin:{dependencyType:"stateVariable",variableName:"graphXmin"},graphXmax:{dependencyType:"stateVariable",variableName:"graphXmax"},graphYmin:{dependencyType:"stateVariable",variableName:"graphYmin"},graphYmax:{dependencyType:"stateVariable",variableName:"graphYmax"},flipFunction:{dependencyType:"stateVariable",variableName:"flipFunction"}}),definition:function({dependencyValues:r}){let n;if(r.curveType==="bezier")n=r.nThroughPoints-1,r.extrapolateForward&&(n*=2);else if(r.parMaxAttr!==null)n=r.parMaxAttr.stateValues.value.evaluate_to_constant(),Number.isFinite(n)||(n=NaN);else if(r.curveType==="function"){let i=null;if(r.functionChild.length===1?i=r.functionChild[0].stateValues.domain:i=r.adapterSourceDomain,i!==null){i=i[0];try{n=i[1].evaluate_to_constant(),!Number.isFinite(n)&&n!==1/0&&(n=NaN)}catch(l){}}let s,o;r.flipFunction?(o=r.graphYmax,s=r.graphYmin):(o=r.graphXmax,s=r.graphXmin),o!==null&&s!==null&&(n===void 0?n=o+.1*(o-s):n=Math.min(n,o+.1*(o-s))),n===void 0&&(n=1/0)}else n=10;return{setValue:{parMax:n}}}},e.parMin={forRenderer:!0,public:!0,componentType:"number",returnDependencies:()=>({curveType:{dependencyType:"stateVariable",variableName:"curveType"},parMinAttr:{dependencyType:"attributeComponent",attributeName:"parMin",variableNames:["value"]},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},extrapolateBackward:{dependencyType:"stateVariable",variableName:"extrapolateBackward"},functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["domain"]},adapterSourceDomain:{dependencyType:"adapterSourceStateVariable",variableName:"domain"},graphXmin:{dependencyType:"stateVariable",variableName:"graphXmin"},graphXmax:{dependencyType:"stateVariable",variableName:"graphXmax"},graphYmin:{dependencyType:"stateVariable",variableName:"graphYmin"},graphYmax:{dependencyType:"stateVariable",variableName:"graphYmax"},flipFunction:{dependencyType:"stateVariable",variableName:"flipFunction"}}),definition:function({dependencyValues:r}){let n;if(r.curveType==="bezier")n=0,r.extrapolateBackward&&(n=-(r.nThroughPoints-1));else if(r.parMinAttr!==null)n=r.parMinAttr.stateValues.value.evaluate_to_constant(),Number.isFinite(n)||(n=NaN);else if(r.curveType==="function"){let i=null;if(r.functionChild.length===1?i=r.functionChild[0].stateValues.domain:i=r.adapterSourceDomain,i!==null){i=i[0];try{n=i[0].evaluate_to_constant(),!Number.isFinite(n)&&n!==-1/0&&(n=NaN)}catch(l){}}let s,o;r.flipFunction?(o=r.graphYmax,s=r.graphYmin):(o=r.graphXmax,s=r.graphXmin),o!==null&&s!==null&&(n===void 0?n=s+.1*(s-o):n=Math.max(n,s+.1*(s-o))),n===void 0&&(n=-1/0)}else n=-10;return{setValue:{parMin:n}}}},e.nThroughPoints={returnDependencies:()=>({through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nPoints"]}}),definition({dependencyValues:r}){let n=0;return r.through!==null&&(n=r.through.stateValues.nPoints),{setValue:{nThroughPoints:n}}}},e.nDimensions={public:!0,componentType:"number",returnDependencies(){return{through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nDimensions"]}}},definition:function({dependencyValues:r}){return r.through!==null?{setValue:{nDimensions:r.through.stateValues.nDimensions},checkForActualChange:{nDimensions:!0}}:{setValue:{nDimensions:2}}}},e.throughPoints={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["throughPointX","throughPoint"],returnWrappingComponents(r){return r==="throughPointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:n,arraySize:i}){if(r==="throughPointX"){let s=n.split("_").map(o=>Number(o)-1);return s.length===2&&s.every((o,l)=>Number.isInteger(o)&&o>=0)?i?s.every((o,l)=>o<i[l])?[String(s)]:[]:[String(s)]:[]}else{let s=Number(n)-1;return Number.isInteger(s)&&s>=0?i?s<i[0]?Array.from(Array(i[1]),(o,l)=>s+","+l):[]:[s+",0"]:[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints,r.nDimensions]},returnArrayDependenciesByKey({arrayKeys:r}){let n={};for(let i of r){let[s,o]=i.split(","),l=Number(s)+1+"_"+(Number(o)+1);n[i]={through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["pointX"+l]}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let[o,l]=s.split(","),u=Number(o)+1+"_"+(Number(l)+1),c=r[s].through;c!==null&&c.stateValues["pointX"+u]?i[s]=c.stateValues["pointX"+u]:i[s]=Sr.fromAst(0)}return{setValue:{throughPoints:i}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,initialChange:s,stateValues:o}){if(s&&!await o.draggable)return{success:!1};let l=[];for(let u in r.throughPoints){let[c,p]=u.split(","),m=Number(c)+1+"_"+(Number(p)+1);if(n[u].through!==null&&n[u].through.stateValues["pointX"+m])l.push({setDependency:i[u].through,desiredValue:r.throughPoints[u],childIndex:0,variableIndex:0});else return{success:!1}}return{success:!0,instructions:l}}},e.numericalThroughPoints={isArray:!0,entryPrefixes:["numericalThroughPoint"],forRenderer:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints]},returnArrayDependenciesByKey({arrayKeys:r}){let n={};for(let i of r)n[i]={throughPoint:{dependencyType:"stateVariable",variableName:"throughPoint"+(Number(i)+1)}};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].throughPoint.map(l=>l.evaluate_to_constant());o.every(l=>Number.isFinite(l))||(o=Array(o.length).fill(NaN)),i[s]=o}return{setValue:{numericalThroughPoints:i}}}},e.haveBezierControls={forRenderer:!0,returnDependencies:()=>({controlChild:{dependencyType:"child",childGroups:["bezierControls"]}}),definition({dependencyValues:r}){return{setValue:{haveBezierControls:r.controlChild.length>0}}}},e.bezierControlsAlwaysVisible={forRenderer:!0,returnDependencies:()=>({controlChild:{dependencyType:"child",childGroups:["bezierControls"],variableNames:["alwaysVisible"]}}),definition({dependencyValues:r}){return{setValue:{bezierControlsAlwaysVisible:r.controlChild.length>0&&r.controlChild[0].stateValues.alwaysVisible}}}},e.vectorControlDirections={public:!0,componentType:"text",isArray:!0,entryPrefixes:["vectorControlDirection"],forRenderer:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints]},returnArrayDependenciesByKey({arrayKeys:r}){let n={};for(let s of r)n[s]={controlChild:{dependencyType:"child",childGroups:["bezierControls"],variableNames:["direction"+(Number(s)+1)]}};return{dependenciesByKey:n,globalDependencies:{haveBezierControls:{dependencyType:"stateVariable",variableName:"haveBezierControls"}}}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].controlChild;o&&o.length>0?i[s]=o[0].stateValues["direction"+(Number(s)+1)]:i[s]="none"}return{setValue:{vectorControlDirections:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyNamesByKey:n,dependencyValuesByKey:i,globalDependencyValues:s}){if(!s.haveBezierControls)return{success:!1};let o=[];for(let l in r.vectorControlDirections){let u=i[l].controlChild;u&&u.length>0&&o.push({setDependency:n[l].controlChild,desiredValue:r.vectorControlDirections[l],childIndex:0,variableIndex:0})}return{success:!0,instructions:o}}},e.hiddenControls={public:!0,componentType:"boolean",isArray:!0,entryPrefixes:["hiddenControl"],forRenderer:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints]},returnArrayDependenciesByKey({arrayKeys:r}){let n={};for(let s of r)n[s]={controlChild:{dependencyType:"child",childGroups:["bezierControls"],variableNames:["hiddenControl"+(Number(s)+1)]}};return{dependenciesByKey:n,globalDependencies:{haveBezierControls:{dependencyType:"stateVariable",variableName:"haveBezierControls"}}}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].controlChild;o&&o.length>0?i[s]=o[0].stateValues["hiddenControl"+(Number(s)+1)]:i[s]=!1}return{setValue:{hiddenControls:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyNamesByKey:n,dependencyValuesByKey:i,globalDependencyValues:s}){if(!s.haveBezierControls)return{success:!1};let o=[];for(let l in r.hiddenControls){let u=i[l].controlChild;u&&u.length>0&&o.push({setDependency:n[l].controlChild,desiredValue:r.hiddenControls[l],childIndex:0,variableIndex:0})}return{success:!0,instructions:o}}},e.controlVectors={isArray:!0,public:!0,componentType:"math",entryPrefixes:["controlVectorX","controlVector"],nDimensions:3,stateVariablesDeterminingDependencies:["vectorControlDirections","nThroughPoints"],returnWrappingComponents(r){return r==="controlVectorX"?[]:[["vector",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:n,arraySize:i}){if(r==="controlVectorX"){let s=n.split("_").map(o=>Number(o)-1);return s.length===3&&s.every((o,l)=>Number.isInteger(o)&&o>=0)?i?s.every((o,l)=>o<i[l])?[String(s)]:[]:[String(s)]:[]}else{let s=n.split("_").map(o=>Number(o)-1);return s.length===2&&s.every(o=>Number.isInteger(o)&&o>=0)?i?s.every((o,l)=>o<i[l])?Array.from(Array(i[2]),(o,l)=>String(s)+","+l):[]:[String(s)+",0"]:[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints,2,r.nDimensions]},returnArrayDependenciesByKey({arrayKeys:r,stateValues:n}){let i={haveBezierControls:{dependencyType:"stateVariable",variableName:"haveBezierControls"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},splineTension:{dependencyType:"stateVariable",variableName:"splineTension"},splineForm:{dependencyType:"stateVariable",variableName:"splineForm"}},s={};for(let o of r){let l=o.split(",").map(d=>Number(d)),u=l.map(d=>d+1),c=u.join("_");s[o]={direction:{dependencyType:"stateVariable",variableName:"vectorControlDirection"+u[0]},controlChild:{dependencyType:"child",childGroups:["bezierControls"],variableNames:["control"+c]}};let p=l[0],m=n.vectorControlDirections[p],f=[];m==="none"?f=[p-1,p,p+1]:m==="previous"?f=[p,p+1]:m==="next"&&(f=[p-1,p]);for(let d of f)d>=0&&d<n.nThroughPoints&&(s[o]["throughPoint"+(d+1)]={dependencyType:"stateVariable",variableName:"throughPoint"+(d+1)})}return{globalDependencies:i,dependenciesByKey:s}},arrayDefinitionByKey({globalDependencyValues:r,dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i){if(r.nDimensions!==2){s[o]=Sr.fromAst(NaN);continue}if(o in s)continue;let l=o.split(",").map(d=>Number(d)),c=l.map(d=>d+1).join("_"),p=l[0],m=l[1],f=n[o].direction;if(f==="none"){let d=n[o]["throughPoint"+(p+1)],h,y;p>0&&(h=n[o]["throughPoint"+p]),p<r.nThroughPoints&&(y=n[o]["throughPoint"+(p+2)]);let{coordsNumeric:b,numericEntries:g}=Gx({tau:r.splineTension,eps:t.eps,splineForm:r.splineForm,point1:h,point2:d,point3:y});for(let v=0;v<2;v++){let A=p+","+m+","+v,C=p+","+(1-m)+","+v;m===0?(s[A]=b[v],s[C]=Sr.fromAst(-b[v].tree)):(s[A]=Sr.fromAst(-b[v].tree),s[C]=b[v])}}else if(l[1]===0&&f==="next"||l[1]===1&&f==="previous"){let d=n[o]["throughPoint"+p],h=n[o]["throughPoint"+(p+1)],y=n[o]["throughPoint"+(p+2)],{coordsNumeric:b,numericEntries:g}=Gx({tau:r.splineTension,eps:t.eps,splineForm:r.splineForm,point1:d||y,point2:h,point3:void 0});for(let v=0;v<2;v++){let A=p+","+m+","+v;s[A]=b[v]}}else s[o]=n[o].controlChild[0].stateValues["control"+c]}return{setValue:{controlVectors:s}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyNamesByKey:n,dependencyValuesByKey:i,globalDependencyValues:s}){if(!s.haveBezierControls||s.nDimensions!==2)return{success:!1};let o=[];for(let l in r.controlVectors){let p=l.split(",").map(f=>Number(f)).map(f=>f+1).join("_"),m=i[l].controlChild;m.length>0&&m[0].stateValues["control"+p]&&o.push({setDependency:n[l].controlChild,desiredValue:r.controlVectors[l],childIndex:0,variableIndex:0})}return{success:!0,instructions:o}}},e.numericalControlVectors={isArray:!0,entryPrefixes:["numericalControlVector"],forRenderer:!0,nDimensions:2,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints,2]},returnArrayDependenciesByKey({arrayKeys:r}){let n={};for(let i of r){let l=i.split(",").map(u=>Number(u)).map(u=>u+1).join("_");n[i]={controlVector:{dependencyType:"stateVariable",variableName:"controlVector"+l}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].controlVector.map(l=>l.tree);i[s]=o}return{setValue:{numericalControlVectors:i}}}},e.controlPoints={isArray:!0,public:!0,componentType:"math",entryPrefixes:["controlPointX","controlPoint"],nDimensions:3,returnWrappingComponents(r){return r==="controlPointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:n,arraySize:i}){if(r==="controlPointX"){let s=n.split("_").map(o=>Number(o)-1);return s.length===3&&s.every((o,l)=>Number.isInteger(o)&&o>=0)?i?s.every((o,l)=>o<i[l])?[String(s)]:[]:[String(s)]:[]}else{let s=n.split("_").map(o=>Number(o)-1);return s.length===2&&s.every(o=>Number.isInteger(o)&&o>=0)?i?s.every((o,l)=>o<i[l])?Array.from(Array(i[2]),(o,l)=>String(s)+","+l):[]:[String(s)+",0"]:[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints,2,r.nDimensions]},returnArrayDependenciesByKey({arrayKeys:r}){let n={haveBezierControls:{dependencyType:"stateVariable",variableName:"haveBezierControls"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}},i={};for(let s of r){let l=s.split(",").map(c=>Number(c)).map(c=>c+1),u=l.join("_");i[s]={throughPointX:{dependencyType:"stateVariable",variableName:"throughPointX"+l[0]+"_"+l[2]},controlVectorX:{dependencyType:"stateVariable",variableName:"controlVectorX"+u}}}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey({globalDependencyValues:r,dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i)if(r.nDimensions!==2)s[o]=Sr.fromAst(NaN);else{let l=n[o].controlVectorX;if(l){let u=n[o].throughPointX.evaluate_to_constant();Number.isFinite(u)||(u=NaN),s[o]=Sr.fromAst(u+l.tree)}else s[o]=null}return{setValue:{controlPoints:s}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyNamesByKey:n,dependencyValuesByKey:i,globalDependencyValues:s}){if(!s.haveBezierControls||s.nDimensions!==2)return{success:!1};let o=[];for(let l in r.controlPoints)if(i[l].controlVectorX){let c=i[l].throughPointX,p=r.controlPoints[l];p.tree&&(p=p.tree);let m=Sr.fromAst(["+",p,["-",c.tree]]);o.push({setDependency:n[l].controlVectorX,desiredValue:m})}return{success:!0,instructions:o}}},e.numericalControlPoints={isArray:!0,entryPrefixes:["numericalControlPoint"],forRenderer:!0,nDimensions:2,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints,2]},returnArrayDependenciesByKey({arrayKeys:r}){let n={};for(let i of r){let l=i.split(",").map(u=>Number(u)).map(u=>u+1).join("_");n[i]={controlPoint:{dependencyType:"stateVariable",variableName:"controlPoint"+l}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].controlPoint.map(l=>l.tree);i[s]=o}return{setValue:{numericalControlPoints:i}}}},e.splineCoeffs={isArray:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints-1]},returnArrayDependenciesByKey({arrayKeys:r}){let n={};for(let i of r){let s=Number(i)+1,o=s+1;n[i]={previousPoint:{dependencyType:"stateVariable",variableName:"numericalThroughPoint"+s},nextPoint:{dependencyType:"stateVariable",variableName:"numericalThroughPoint"+o},previousVector:{dependencyType:"stateVariable",variableName:"numericalControlVector"+s+"_2"},nextVector:{dependencyType:"stateVariable",variableName:"numericalControlVector"+o+"_1"}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].previousPoint,l=r[s].nextPoint,u=r[s].previousVector,c=r[s].nextVector,p=[];for(let m=0;m<2;m++)p.push(vq(o[m],l[m],3*u[m],-3*c[m]));i[s]=p}return{setValue:{splineCoeffs:i}}}},e.extrapolateBackwardCoeffs={stateVariablesDeterminingDependencies:["extrapolateBackward"],additionalStateVariablesDefined:[{variableName:"extrapolateBackwardMode",public:!0,componentType:"text"}],returnDependencies({stateValues:r}){let n={extrapolateBackward:{dependencyType:"stateVariable",variableName:"extrapolateBackward"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}};return r.extrapolateBackward&&(n.firstSplineCoeffs={dependencyType:"stateVariable",variableName:"splineCoeffs1"},n.graphXmin={dependencyType:"stateVariable",variableName:"graphXmin"},n.graphXmax={dependencyType:"stateVariable",variableName:"graphXmax"},n.graphYmin={dependencyType:"stateVariable",variableName:"graphYmin"},n.graphYmax={dependencyType:"stateVariable",variableName:"graphYmax"}),n},definition({dependencyValues:r}){if(!r.extrapolateBackward||!r.firstSplineCoeffs)return{setValue:{extrapolateBackwardCoeffs:null,extrapolateBackwardMode:""}};let n=r.firstSplineCoeffs[0],i=r.firstSplineCoeffs[1],s=n[0],o=n[1],l=2*n[2],u=i[0],c=i[1],p=2*i[2],m=o*o+c*c,f=(c*l-o*p)/(m*m);if(Math.abs(f)<1e-12||Math.abs(o)<1e-12||Math.abs(c)<1e-12){let y=o,b=c;if(r.graphXmin!==null&&r.graphXmax!==null&&r.graphYmin!==null&&r.graphYmax!==null){let v=r.graphXmax-r.graphXmin,A=r.graphYmax-r.graphYmin,C=r.nThroughPoints-1,S=v/C/Math.abs(y),w=A/C/Math.abs(b),x=Math.min(S,w);x>1&&(y*=x,b*=x)}return{setValue:{extrapolateBackwardCoeffs:[[s,y,0],[u,b,0]],extrapolateBackwardMode:"line"}}}let d=c*f,h=-o*f;if(d*o>0){let y=d/h,b=(1+y*y)**2,g=o;if(r.graphXmin!==null&&r.graphXmax!==null&&r.graphYmin!==null&&r.graphYmax!==null){let S=r.graphXmax-r.graphXmin,w=r.graphYmax-r.graphYmin,x=r.nThroughPoints-1,R=S/x,O=1/0;if(h!==0){let k=h*b/2*x*x,B=-y*x,U=Math.sqrt(B*B+4*Math.abs(k)*w);O=(Math.abs(B)+U)/(2*Math.abs(k))}let _=Math.min(R,O);_>Math.abs(g)&&(g*=_/Math.abs(g))}let v=-g*y,A=h*g*g*b;return{setValue:{extrapolateBackwardCoeffs:[[s,g,0],[u,v,A/2]],extrapolateBackwardMode:"parabolaVertical"}}}else{let y=h/d,b=(1+y*y)**2,g=c;if(r.graphXmin!==null&&r.graphXmax!==null&&r.graphYmin!==null&&r.graphYmax!==null){let S=r.graphXmax-r.graphXmin,w=r.graphYmax-r.graphYmin,x=r.nThroughPoints-1,R=w/x,O=1/0;if(d!==0){let k=d*b/2*x*x,B=-y*x,U=Math.sqrt(B*B+4*Math.abs(k)*S);O=(Math.abs(B)+U)/(2*Math.abs(k))}let _=Math.min(O,R);_>Math.abs(g)&&(g*=_/Math.abs(g))}let v=-g*y,A=d*g*g*b;return{setValue:{extrapolateBackwardCoeffs:[[s,v,A/2],[u,g,0]],extrapolateBackwardMode:"parabolaHorizontal"}}}}},e.extrapolateForwardCoeffs={stateVariablesDeterminingDependencies:["nThroughPoints","extrapolateForward"],additionalStateVariablesDefined:[{variableName:"extrapolateForwardMode",public:!0,componentType:"text"}],returnDependencies({stateValues:r}){let n={extrapolateForward:{dependencyType:"stateVariable",variableName:"extrapolateForward"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}};return r.extrapolateForward&&r.nThroughPoints>=2&&(n.lastSplineCoeffs={dependencyType:"stateVariable",variableName:"splineCoeffs"+(r.nThroughPoints-1)},n.graphXmin={dependencyType:"stateVariable",variableName:"graphXmin"},n.graphXmax={dependencyType:"stateVariable",variableName:"graphXmax"},n.graphYmin={dependencyType:"stateVariable",variableName:"graphYmin"},n.graphYmax={dependencyType:"stateVariable",variableName:"graphYmax"}),n},definition({dependencyValues:r}){if(!r.extrapolateForward||!r.lastSplineCoeffs)return{setValue:{extrapolateForwardCoeffs:null,extrapolateForwardMode:""}};let n=r.lastSplineCoeffs[0],i=r.lastSplineCoeffs[1],s=n[0]+n[1]+n[2]+n[3],o=n[1]+2*n[2]+3*n[3],l=2*n[2]+6*n[3],u=i[0]+i[1]+i[2]+i[3],c=i[1]+2*i[2]+3*i[3],p=2*i[2]+6*i[3],m=o*o+c*c,f=(c*l-o*p)/(m*m);if(Math.abs(f)<1e-12||Math.abs(o)<1e-12||Math.abs(c)<1e-12){let y=o,b=c;if(r.graphXmin!==null&&r.graphXmax!==null&&r.graphYmin!==null&&r.graphYmax!==null){let v=r.graphXmax-r.graphXmin,A=r.graphYmax-r.graphYmin,C=r.nThroughPoints-1,S=v/C/Math.abs(y),w=A/C/Math.abs(b),x=Math.min(S,w);x>1&&(y*=x,b*=x)}return{setValue:{extrapolateForwardCoeffs:[[s,y,0],[u,b,0]],extrapolateForwardMode:"line"}}}let d=c*f,h=-o*f;if(d*o<0){let y=d/h,b=(1+y*y)**2,g=o;if(r.graphXmin!==null&&r.graphXmax!==null&&r.graphYmin!==null&&r.graphYmax!==null){let S=r.graphXmax-r.graphXmin,w=r.graphYmax-r.graphYmin,x=r.nThroughPoints-1,R=S/x,O=1/0;if(h!==0){let k=h*b/2*x*x,B=-y*x,U=Math.sqrt(B*B+4*Math.abs(k)*w);O=(Math.abs(B)+U)/(2*Math.abs(k))}let _=Math.min(R,O);_>Math.abs(g)&&(g*=_/Math.abs(g))}let v=-g*y,A=h*g*g*b;return{setValue:{extrapolateForwardCoeffs:[[s,g,0],[u,v,A/2]],extrapolateForwardMode:"parabolaVertical"}}}else{let y=h/d,b=(1+y*y)**2,g=c;if(r.graphXmin!==null&&r.graphXmax!==null&&r.graphYmin!==null&&r.graphYmax!==null){let S=r.graphXmax-r.graphXmin,w=r.graphYmax-r.graphYmin,x=r.nThroughPoints-1,R=w/x,O=1/0;if(d!==0){let k=d*b/2*x*x,B=-y*x,U=Math.sqrt(B*B+4*Math.abs(k)*S);O=(Math.abs(B)+U)/(2*Math.abs(k))}let _=Math.min(O,R);_>Math.abs(g)&&(g*=_/Math.abs(g))}let v=-g*y,A=d*g*g*b;return{setValue:{extrapolateForwardCoeffs:[[s,v,A/2],[u,g,0]],extrapolateForwardMode:"parabolaHorizontal"}}}}},e.fs={isArray:!0,entryPrefixes:["f"],additionalStateVariablesDefined:[{variableName:"fDefinitions",isArray:!0,forRenderer:!0}],returnArraySizeDependencies:()=>({functionChildren:{dependencyType:"child",childGroups:["functions"]},curveType:{dependencyType:"stateVariable",variableName:"curveType"}}),returnArraySize({dependencyValues:r}){return r.curveType==="bezier"?[2]:[Math.max(1,r.functionChildren.length)]},returnArrayDependenciesByKey({arrayKeys:r}){let n={curveType:{dependencyType:"stateVariable",variableName:"curveType"},numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},splineCoeffs:{dependencyType:"stateVariable",variableName:"splineCoeffs"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},extrapolateBackward:{dependencyType:"stateVariable",variableName:"extrapolateBackward"},extrapolateBackwardCoeffs:{dependencyType:"stateVariable",variableName:"extrapolateBackwardCoeffs"},extrapolateForward:{dependencyType:"stateVariable",variableName:"extrapolateForward"},extrapolateForwardCoeffs:{dependencyType:"stateVariable",variableName:"extrapolateForwardCoeffs"}},i={};for(let s of r)i[s]={functionChild:{dependencyType:"child",childGroups:["functions"],variableNames:["numericalf","fDefinition"],childIndices:[s]}},Number(s)===0&&(i[s].fShadow={dependencyType:"stateVariable",variableName:"fShadow"},i[s].fDefinitionAdapted={dependencyType:"adapterSourceStateVariable",variableName:"fDefinition"});return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey({globalDependencyValues:r,dependencyValuesByKey:n,arrayKeys:i}){if(r.curveType==="bezier")return{setValue:{fs:zx(r),fDefinitions:{0:{functionType:"bezier",nThroughPoints:r.nThroughPoints,numericalThroughPoints:r.numericalThroughPoints,splineCoeffs:r.splineCoeffs,extrapolateForward:r.extrapolateForward,extrapolateForwardCoeffs:r.extrapolateForwardCoeffs,extrapolateBackward:r.extrapolateBackward,extrapolateBackwardCoeffs:r.extrapolateBackwardCoeffs},1:null}}};let s={},o={};for(let l of i){let u=n[l].functionChild;u.length===1?(s[l]=u[0].stateValues.numericalf,o[l]=u[0].stateValues.fDefinition):Number(l)===0&&n[l].fShadow?(s[l]=n[l].fShadow,o[l]=n[l].fDefinitionAdapted):(s[l]=()=>0,o[l]={functionType:"zero"})}return{setValue:{fs:s,fDefinitions:o}}}},e.f={isAlias:!0,targetVariableName:"f1"},e.allXCriticalPoints={returnDependencies:()=>({splineCoeffs:{dependencyType:"stateVariable",variableName:"splineCoeffs"},fs:{dependencyType:"stateVariable",variableName:"fs"},curveType:{dependencyType:"stateVariable",variableName:"curveType"}}),definition({dependencyValues:r}){let n=[];if(r.curveType!=="bezier")return{setValue:{allXCriticalPoints:n}};let i=r.fs[0],s=r.fs[1],o=[],l=!1;for(let[u,c]of r.splineCoeffs.entries()){let p=c[0],m=3*p[3],f=2*p[2],d=p[1];if(Math.abs(m)<1e-14){let h=-d/f;l=bi({t:h,ind:u,ts:o,ignoreLeft:l})}else{let h=f*f-4*m*d;if(h==0){let y=-f/(2*m);l=bi({t:y,ind:u,ts:o,ignoreLeft:l})}else if(h>0){let y=Math.sqrt(h),b=[(-f-y)/(2*m),(-f+y)/(2*m)];m<0&&(b=[b[1],b[0]]);let g=!1;for(let v of b)bi({t:v,ind:u,ts:o,ignoreLeft:l})&&(g=!0);l=g}else l=!1}}for(let u of o)n.push([i(u),s(u)]);return{setValue:{allXCriticalPoints:n}}}},e.nXCriticalPoints={public:!0,componentType:"integer",returnDependencies:()=>({allXCriticalPoints:{dependencyType:"stateVariable",variableName:"allXCriticalPoints"}}),definition({dependencyValues:r}){return{setValue:{nXCriticalPoints:r.allXCriticalPoints.length}}}},e.xCriticalPoints={public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["xCriticalPointX","xCriticalPoint"],returnWrappingComponents(r){return r==="xCriticalPointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:n,arraySize:i}){if(r==="xCriticalPointX"){let s=n.split("_").map(o=>Number(o)-1);return s.length===2&&s.every((o,l)=>Number.isInteger(o)&&o>=0)?i?s.every((o,l)=>o<i[l])?[String(s)]:[]:[String(s)]:[]}else{let s=Number(n)-1;return Number.isInteger(s)&&s>=0?i?s<i[0]?Array.from(Array(i[1]),(o,l)=>s+","+l):[]:[s+",0"]:[]}},returnArraySizeDependencies:()=>({nXCriticalPoints:{dependencyType:"stateVariable",variableName:"nXCriticalPoints"}}),returnArraySize({dependencyValues:r}){return[r.nXCriticalPoints,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allXCriticalPoints:{dependencyType:"stateVariable",variableName:"allXCriticalPoints"}}}},arrayDefinitionByKey({globalDependencyValues:r}){let n={};for(let i=0;i<r.__array_size[0];i++)for(let s=0;s<2;s++){let o=`${i},${s}`;n[o]=r.allXCriticalPoints[i][s]}return{setValue:{xCriticalPoints:n}}}},e.allYCriticalPoints={returnDependencies:()=>({splineCoeffs:{dependencyType:"stateVariable",variableName:"splineCoeffs"},fs:{dependencyType:"stateVariable",variableName:"fs"},curveType:{dependencyType:"stateVariable",variableName:"curveType"}}),definition({dependencyValues:r}){let n=[];if(r.curveType!=="bezier")return{setValue:{allYCriticalPoints:n}};let i=r.fs[0],s=r.fs[1],o=[],l=!1;for(let[u,c]of r.splineCoeffs.entries()){let p=c[1],m=3*p[3],f=2*p[2],d=p[1];if(Math.abs(m)<1e-14){let h=-d/f;l=bi({t:h,ind:u,ts:o,ignoreLeft:l})}else{let h=f*f-4*m*d;if(h==0){let y=-f/(2*m);l=bi({t:y,ind:u,ts:o,ignoreLeft:l})}else if(h>0){let y=Math.sqrt(h),b=[(-f-y)/(2*m),(-f+y)/(2*m)];m<0&&(b=[b[1],b[0]]);let g=!1;for(let v of b)bi({t:v,ind:u,ts:o,ignoreLeft:l})&&(g=!0);l=g}else l=!1}}for(let u of o)n.push([i(u),s(u)]);return{setValue:{allYCriticalPoints:n}}}},e.nYCriticalPoints={public:!0,componentType:"integer",returnDependencies:()=>({allYCriticalPoints:{dependencyType:"stateVariable",variableName:"allYCriticalPoints"}}),definition({dependencyValues:r}){return{setValue:{nYCriticalPoints:r.allYCriticalPoints.length}}}},e.yCriticalPoints={public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["yCriticalPointX","yCriticalPoint"],returnWrappingComponents(r){return r==="yCriticalPointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:n,arraySize:i}){if(r==="yCriticalPointX"){let s=n.split("_").map(o=>Number(o)-1);return s.length===2&&s.every((o,l)=>Number.isInteger(o)&&o>=0)?i?s.every((o,l)=>o<i[l])?[String(s)]:[]:[String(s)]:[]}else{let s=Number(n)-1;return Number.isInteger(s)&&s>=0?i?s<i[0]?Array.from(Array(i[1]),(o,l)=>s+","+l):[]:[s+",0"]:[]}},returnArraySizeDependencies:()=>({nYCriticalPoints:{dependencyType:"stateVariable",variableName:"nYCriticalPoints"}}),returnArraySize({dependencyValues:r}){return[r.nYCriticalPoints,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allYCriticalPoints:{dependencyType:"stateVariable",variableName:"allYCriticalPoints"}}}},arrayDefinitionByKey({globalDependencyValues:r}){let n={};for(let i=0;i<r.__array_size[0];i++)for(let s=0;s<2;s++){let o=`${i},${s}`;n[o]=r.allYCriticalPoints[i][s]}return{setValue:{yCriticalPoints:n}}}},e.allCurvatureChangePoints={returnDependencies:()=>({splineCoeffs:{dependencyType:"stateVariable",variableName:"splineCoeffs"},fs:{dependencyType:"stateVariable",variableName:"fs"},curveType:{dependencyType:"stateVariable",variableName:"curveType"}}),definition({dependencyValues:r}){let n=[];if(r.curveType!=="bezier")return{setValue:{allCurvatureChangePoints:n}};let i=r.fs[0],s=r.fs[1],o=[],l=!1;for(let[u,c]of r.splineCoeffs.entries()){let[p,m,f,d]=c[0],[h,y,b,g]=c[1],v=3*(f*g-b*d),A=3*(m*g-y*d),C=m*b-y*f;if(Math.abs(v)<1e-14){let S=-C/A;l=bi({t:S,ind:u,ts:o,ignoreLeft:l})}else{let S=A*A-4*v*C;if(S==0){let w=-A/(2*v);l=bi({t:w,ind:u,ts:o,ignoreLeft:l})}else if(S>0){let w=Math.sqrt(S),x=[(-A-w)/(2*v),(-A+w)/(2*v)];v<0&&(x=[x[1],x[0]]);let R=!1;for(let O of x)bi({t:O,ind:u,ts:o,ignoreLeft:l})&&(R=!0);l=R}else l=!1}}for(let u of o)n.push([i(u),s(u)]);return{setValue:{allCurvatureChangePoints:n}}}},e.nCurvatureChangePoints={public:!0,componentType:"integer",returnDependencies:()=>({allCurvatureChangePoints:{dependencyType:"stateVariable",variableName:"allCurvatureChangePoints"}}),definition({dependencyValues:r}){return{setValue:{nCurvatureChangePoints:r.allCurvatureChangePoints.length}}}},e.curvatureChangePoints={public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["curvatureChangePointX","curvatureChangePoint"],returnWrappingComponents(r){return r==="curvatureChangePointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:n,arraySize:i}){if(r==="curvatureChangePointX"){let s=n.split("_").map(o=>Number(o)-1);return s.length===2&&s.every((o,l)=>Number.isInteger(o)&&o>=0)?i?s.every((o,l)=>o<i[l])?[String(s)]:[]:[String(s)]:[]}else{let s=Number(n)-1;return Number.isInteger(s)&&s>=0?i?s<i[0]?Array.from(Array(i[1]),(o,l)=>s+","+l):[]:[s+",0"]:[]}},returnArraySizeDependencies:()=>({nCurvatureChangePoints:{dependencyType:"stateVariable",variableName:"nCurvatureChangePoints"}}),returnArraySize({dependencyValues:r}){return[r.nCurvatureChangePoints,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allCurvatureChangePoints:{dependencyType:"stateVariable",variableName:"allCurvatureChangePoints"}}}},arrayDefinitionByKey({globalDependencyValues:r}){let n={};for(let i=0;i<r.__array_size[0];i++)for(let s=0;s<2;s++){let o=`${i},${s}`;n[o]=r.allCurvatureChangePoints[i][s]}return{setValue:{curvatureChangePoints:n}}}},e.nearestPoint={returnDependencies:()=>({curveType:{dependencyType:"stateVariable",variableName:"curveType"},fs:{dependencyType:"stateVariable",variableName:"fs"},flipFunction:{dependencyType:"stateVariable",variableName:"flipFunction"},nDiscretizationPoints:{dependencyType:"stateVariable",variableName:"nDiscretizationPoints"},parMin:{dependencyType:"stateVariable",variableName:"parMin"},parMax:{dependencyType:"stateVariable",variableName:"parMax"},periodic:{dependencyType:"stateVariable",variableName:"periodic"},graphXmin:{dependencyType:"stateVariable",variableName:"graphXmin"},graphXmax:{dependencyType:"stateVariable",variableName:"graphXmax"},graphYmin:{dependencyType:"stateVariable",variableName:"graphYmin"},graphYmax:{dependencyType:"stateVariable",variableName:"graphYmax"},nearestPointAsCurve:{dependencyType:"stateVariable",variableName:"nearestPointAsCurve"}}),definition({dependencyValues:r}){let n=null;return r.curveType==="function"?n=bq({dependencyValues:r,numerics:t}):["parameterization","bezier"].includes(r.curveType)&&(n=gq({dependencyValues:r,numerics:t})),{setValue:{nearestPoint:n}}}},e}async moveControlVector({controlVector:t,controlVectorInds:e,transient:r,actionId:n}){let i={[e+",0"]:Sr.fromAst(t[0]),[e+",1"]:Sr.fromAst(t[1])};return r?await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"controlVectors",value:i,sourceInformation:{controlVectorMoved:e}}],transient:r,actionId:n}):await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"controlVectors",value:i,sourceInformation:{controlVectorMoved:e}}],actionId:n,event:{verb:"interacted",object:{componentId:this.componentName},result:{["controlVector"+e.join("_")]:t}}})}async moveThroughPoint({throughPoint:t,throughPointInd:e,transient:r,actionId:n}){let i={[e+",0"]:Sr.fromAst(t[0]),[e+",1"]:Sr.fromAst(t[1])};return r?await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"throughPoints",value:i,sourceInformation:{throughPointMoved:e}}],transient:r,actionId:n}):await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"throughPoints",value:i,sourceInformation:{throughPointMoved:e}}],actionId:n,event:{verb:"interacted",object:{componentId:this.componentName},result:{["throughPoint"+e]:t}}})}async changeVectorControlDirection({direction:t,throughPointInd:e,actionId:r}){return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"vectorControlDirection",value:{[e]:t}}],actionId:r})}switchCurve(){}};T(Rn,"componentType","curve"),T(Rn,"rendererType","curve"),T(Rn,"primaryStateVariableForDefinition","fShadow");function bq({dependencyValues:a,numerics:t}){let e=a.flipFunction,r=a.fs[0],n=a.nDiscretizationPoints,i=a.parMax,s=a.parMin;return function({variables:o,scales:l}){let u=o.x1.evaluate_to_constant(),c=o.x2.evaluate_to_constant(),p=l[0],m=l[1],f,d;s!==-1/0&&(e?(f=r(s),d=s):(f=s,d=r(s)));let h,y;if(i!==1/0&&(e?(h=r(i),y=i):(h=i,y=r(i))),!a.nearestPointAsCurve||!(Number.isFinite(u)&&Number.isFinite(c))){let P,F;if(e?(F=c,P=r(F)):(P=u,F=r(P)),!(Number.isFinite(P)&&Number.isFinite(F))){let G,z;e?(G=Math.abs(s-c),z=Math.abs(i-c)):(G=Math.abs(s-u),z=Math.abs(i-u)),G<z||!Number.isFinite(z)?(P=f,F=d):(P=h,F=y)}if(Number.isFinite(P)&&Number.isFinite(F)){let G={x1:P,x2:F};return o.x3!==void 0&&(G.x3=0),G}if(!(Number.isFinite(u)&&Number.isFinite(c)))return{}}let b=function(P){let F=-10*Math.log(1/P-1),G=u,z=c;return e?(G-=r(F),z-=F):(G-=F,z-=r(F)),G/=p,z/=m,G*G+z*z},g=0,v=1;s!==-1/0&&(g=1/(Math.exp(-s/10)+1)),i!==-1/0&&(v=1/(Math.exp(-i/10)+1));let A=n,C=(v-g)/A,S=g,w=b(g),x=g,R=g+C,O,_;for(let P=1;P<=A;P++){let F=g+P*C,G=b(F);Number.isFinite(G)&&Number.isFinite(O)&&(G<w||Number.isNaN(w))&&(S=F,w=G,x=_,P===A?R=F:R=F+C),O=G,_=F}let k=b(R);Number.isFinite(k)||(R-=C);let B=t.fminbr(b,[x,R]);S=B.x;let U=-10*Math.log(1/S-1),H=r(U),j;if(B.success&&Number.isFinite(U)&&Number.isFinite(H)?(e&&([U,H]=[H,U]),j=Math.pow((U-u)/p,2)+Math.pow((H-c)/m,2)):j=1/0,s!==-1/0){let P=Math.pow((f-u)/p,2)+Math.pow((d-c)/m,2);P<j&&(U=f,H=d,j=P)}if(i!==1/0){let P=Math.pow((h-u)/p,2)+Math.pow((y-c)/m,2);P<j&&(U=h,H=y,j=P)}return B={x1:U,x2:H},o.x3!==void 0&&(B.x3=0),B}}function gq({dependencyValues:a,numerics:t}){let e=a.fs,r=a.parMin,n=a.parMax,i=a.nDiscretizationPoints,s=a.periodic;return function({variables:o,scales:l}){let u=l[0],c=l[1];if(a.fs.length!==2)return{};let p=o.x1.evaluate_to_constant(),m=o.x2.evaluate_to_constant();if(!(Number.isFinite(p)&&Number.isFinite(m)))return{};let f=function(k){let B=(p-e[0](k))/u,U=(m-e[1](k))/c;return B*B+U*U},d=r,h=n,y=i,b=(h-d)/y,g=d,v=f(d),A=d,C=d+b,S,w;for(let k=1;k<=y;k++){let B=d+k*b,U=f(B);Number.isFinite(U)&&Number.isFinite(S)&&(U<v||Number.isNaN(v))&&(g=B,v=U,A=w,k===y?C=B:C=B+b),S=U,w=B}s&&(Math.abs(g-d)<t.eps?A=d-b:Math.abs(g-h)<t.eps&&(C=h+b));let x=t.fminbr(f,[A,C]);g=x.x;let R=e[0](g),O=e[1](g),_=f(g);if(!x.success&&Number.isFinite(R)&&Number.isFinite(O)&&(_=1/0),Number.isFinite(r)){let k=f(r);k<_&&(g=r,R=e[0](g),O=e[1](g),_=k)}if(Number.isFinite(n)){let k=f(n);k<_&&(g=n,R=e[0](g),O=e[1](g),_=k)}return x={x1:R,x2:O},o.x3!==void 0&&(x.x3=0),x}}function Gx({tau:a,eps:t,point1:e,point2:r,point3:n,splineForm:i}){let s=function(f,d){let h=f[0]-d[0],y=f[1]-d[1];return Math.sqrt(h*h+y*y)},o,l,u;if(r)l=r.map(f=>f.evaluate_to_constant());else return{coordsNumeric:[Sr.fromAst(NaN),Sr.fromAst(NaN)],numericEntries:!1};if(n)u=n.map(f=>f.evaluate_to_constant()),e?o=e.map(f=>f.evaluate_to_constant()):o=[2*l[0]-u[0],2*l[1]-u[1]];else if(e)o=e.map(f=>f.evaluate_to_constant()),u=[2*l[0]-o[0],2*l[1]-o[1]];else return{coordsNumeric:[Sr.fromAst(NaN),Sr.fromAst(NaN)],numericEntries:!1};let c=[];if(i==="centripetal"){let f=s(o,l),d=s(l,u);f=Math.sqrt(f),d=Math.sqrt(d),d<t&&(d=1),f<t&&(f=d);for(let h=0;h<2;h++){let y=(l[h]-o[h])/f-(u[h]-o[h])/(d+f)+(u[h]-l[h])/d;y*=a*Math.sqrt(f*d),c.push(-y/3)}}else for(let f=0;f<2;f++)c.push(-a*(u[f]-o[f])/3);let p=c.map(f=>Sr.fromAst(f)),m=Number.isFinite(c[0])&&Number.isFinite(c[1]);return{coordsNumeric:p,numericEntries:m}}function vq(a,t,e,r){return[a,e,-3*a+3*t-2*e-r,2*a-2*t+e+r]}function bi({t:a,ind:t,ts:e,ignoreLeft:r=!1}){let n=1e-14,i=1+n,s=1-n,o=!1;return a>=n?a<=s?e.push(t+a):a<i&&(e.push(t+1),o=!0):a>-n&&!r&&e.push(t),o}var gu=class extends Rn{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.stable={createComponentOfType:"boolean",createStateVariable:"stable",defaultValue:!0,public:!0},e.switchable={createComponentOfType:"boolean",createStateVariable:"switchable",defaultValue:!1,public:!0,forRenderer:!0},e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.dashed={forRenderer:!0,returnDependencies:()=>({stable:{dependencyType:"stateVariable",variableName:"stable"}}),definition({dependencyValues:r}){return{setValue:{dashed:!r.stable}}},inverseDefinition({desiredStateVariableValues:r}){return{success:!0,instructions:[{setDependency:"stable",desiredValue:!r.dashed}]}}},e}async switchCurve({actionId:t}){if(await this.stateValues.switchable)return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"stable",value:!this.stateValues.stable}],actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{stable:!this.stateValues.stable}}});this.coreFunctions.resolveAction({actionId:t})}};T(gu,"componentType","equilibriumCurve"),T(gu,"rendererType","curve");var gT={};st(gT,{Atom:()=>vu});import qt from"math-expressions";var Ga={H:{name:"Hydrogen",atomicNumber:1,nValenceElectrons:1,electronConfiguration:qt.fromText("1s^1"),defaultMassNumber:1,groupNumber:1,metal:"nonmetal"},He:{name:"Helium",atomicNumber:2,nValenceElectrons:2,electronConfiguration:qt.fromText("1s^2"),defaultMassNumber:4,groupNumber:18,groupName:"Noble Gases",metal:"nonmetal"},Li:{name:"Lithium",atomicNumber:3,nValenceElectrons:1,electronConfiguration:qt.fromText("1s^2 2s^1"),defaultMassNumber:7,groupNumber:1,groupName:"Alkali Metals",metal:"metal"},Be:{name:"Beryllium",atomicNumber:4,nValenceElectrons:2,electronConfiguration:qt.fromText("1s^2 2s^2"),defaultMassNumber:9,groupNumber:2,groupName:"Alkaline Earth Metals",metal:"metal"},B:{name:"Boron",atomicNumber:5,nValenceElectrons:3,electronConfiguration:qt.fromText("1s^2 2s^2 2p^1"),defaultMassNumber:11,groupNumber:13,metal:"metalloid"},C:{name:"Carbon",atomicNumber:6,nValenceElectrons:4,electronConfiguration:qt.fromText("1s^2 2s^2 2p^2"),defaultMassNumber:12,groupNumber:14,metal:"nonmetal"},N:{name:"Nitrogen",atomicNumber:7,nValenceElectrons:5,electronConfiguration:qt.fromText("1s^2 2s^2 2p^3"),defaultMassNumber:14,groupNumber:15,metal:"nonmetal"},O:{name:"Oxygen",atomicNumber:8,nValenceElectrons:6,electronConfiguration:qt.fromText("1s^2 2s^2 2p^4"),defaultMassNumber:16,groupNumber:16,groupName:"Chalcogens",metal:"nonmetal"},F:{name:"Fluorine",atomicNumber:9,nValenceElectrons:7,electronConfiguration:qt.fromText("1s^2 2s^2 2p^5"),defaultMassNumber:19,groupNumber:17,groupName:"Halogens",metal:"nonmetal"},Ne:{name:"Neon",atomicNumber:10,nValenceElectrons:8,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6"),defaultMassNumber:20,groupNumber:18,groupName:"Noble gases",metal:"nonmetal"},Na:{name:"Sodium",atomicNumber:11,nValenceElectrons:1,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6 3s^1"),defaultMassNumber:23,groupNumber:1,groupName:"Alkali metals",metal:"metal"},Mg:{name:"Magnesium",atomicNumber:12,nValenceElectrons:2,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6 3s^2"),defaultMassNumber:24,groupNumber:2,groupName:"Alkaline earth metals",metal:"metal"},Al:{name:"Aluminum",atomicNumber:13,nValenceElectrons:3,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6 3s^2 3p^1"),defaultMassNumber:27,groupNumber:13,metal:"metal"},Si:{name:"Silicon",atomicNumber:14,nValenceElectrons:4,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6 3s^2 3p^2"),defaultMassNumber:28,groupNumber:14,metal:"metalloid"},P:{name:"Phosphorus",atomicNumber:15,nValenceElectrons:5,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6 3s^2 3p^3"),defaultMassNumber:31,groupNumber:15,metal:"nonmetal"},S:{name:"Sulfur",atomicNumber:16,nValenceElectrons:6,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6 3s^2 3p^4"),defaultMassNumber:32,groupNumber:16,groupName:"Chalcogens",metal:"nonmetal"},Cl:{name:"Chlorine",atomicNumber:17,nValenceElectrons:7,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6 3s^2 3p^5"),defaultMassNumber:35,groupNumber:17,groupName:"Halogens",metal:"nonmetal"},Ar:{name:"Argon",atomicNumber:18,nValenceElectrons:8,electronConfiguration:qt.fromText("1s^2 2s^2 2p^6 3s^2 3p^6"),defaultMassNumber:40,groupNumber:18,groupName:"Noble gases",metal:"nonmetal"}},Hx={};for(let a in Ga)Hx[a.toLowerCase()]=a;var Tq=16749274980495e-40,Nq=16726219236951e-40,Cq=9109383701528e-43,vu=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.symbol={createComponentOfType:"text",createStateVariable:"symbol",defaultValue:null,public:!0},e.massNumber={createComponentOfType:"number"},e.displayMassNumber={createComponentOfType:"boolean",createStateVariable:"displayMassNumber",defaultValue:!1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.symbol={public:!0,componentType:"text",returnDependencies:()=>({symbolAttr:{dependencyType:"attributeComponent",attributeName:"symbol",variableNames:["value"]}}),definition({dependencyValues:e}){let r=Hx[e.symbolAttr?.stateValues.value.toLowerCase()];return r||(r=null),{setValue:{symbol:r}}}},t.massNumber={public:!0,componentType:"number",hasEssential:!0,returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"},massNumberAttr:{dependencyType:"attributeComponent",attributeName:"massNumber",variableNames:["value"]}}),definition:function({dependencyValues:e}){return e.massNumberAttr?{setValue:{massNumber:e.massNumberAttr.stateValues.value}}:{useEssentialOrDefaultValue:{massNumber:{get defaultValue(){let r=Ga[e.symbol]?.defaultMassNumber;return r||(r=null),r}}}}}},t.displayMassNumber={public:!0,componentType:"boolean",hasEssential:!0,defaultValue:!1,returnDependencies:()=>({massNumber:{dependencyType:"stateVariable",variableName:"massNumber"},displayMassNumberAttr:{dependencyType:"attributeComponent",attributeName:"displayMassNumber",variableNames:["value"]}}),definition({dependencyValues:e,usedDefault:r}){return e.displayMassNumberAttr?{setValue:{displayMassNumber:e.displayMassNumberAttr.stateValues.value}}:{useEssentialOrDefaultValue:{displayMassNumber:{defaultValue:!r.massNumber}}}}},t.atomicNumber={public:!0,componentType:"number",returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"}}),definition({dependencyValues:e}){let r=Ga[e.symbol]?.atomicNumber;return r||(r=null),{setValue:{atomicNumber:r}}}},t.nValenceElectrons={public:!0,componentType:"number",returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"}}),definition({dependencyValues:e}){let r=Ga[e.symbol]?.nValenceElectrons;return r||(r=null),{setValue:{nValenceElectrons:r}}}},t.electronConfiguration={public:!0,componentType:"math",returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"}}),definition({dependencyValues:e}){let r=Ga[e.symbol]?.electronConfiguration;return r||(r=qt.fromAst("\uFF3F")),{setValue:{electronConfiguration:r}}}},t.mass={public:!0,componentType:"math",returnDependencies:()=>({atomicNumber:{dependencyType:"stateVariable",variableName:"atomicNumber"},massNumber:{dependencyType:"stateVariable",variableName:"massNumber"}}),definition({dependencyValues:e}){return{setValue:{mass:qt.fromAst(e.atomicNumber*(Nq+Cq)+(e.massNumber-e.atomicNumber)*Tq)}}}},t.groupNumber={public:!0,componentType:"number",returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"}}),definition({dependencyValues:e}){let r=Ga[e.symbol]?.groupNumber;return r||(r=null),{setValue:{groupNumber:r}}}},t.groupName={public:!0,componentType:"text",returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"}}),definition({dependencyValues:e}){let r=Ga[e.symbol]?.groupName;return r||(r=null),{setValue:{groupName:r}}}},t.metal={public:!0,componentType:"text",returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"}}),definition({dependencyValues:e}){let r=Ga[e.symbol]?.metal;return r||(r=null),{setValue:{metal:r}}}},t.isotopeSymbol={public:!0,componentType:"m",returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"},atomicNumber:{dependencyType:"stateVariable",variableName:"atomicNumber"},massNumber:{dependencyType:"stateVariable",variableName:"massNumber"}}),definition({dependencyValues:e}){let r;return e.symbol in Ga?r=`{}^{${e.massNumber}}_{${e.atomicNumber}}\\text{${e.symbol}}`:r="[Invalid Chemical Symbol]",{setValue:{isotopeSymbol:r}}}},t.latex={additionalStateVariablesDefined:[{variableName:"latexWithInputChildren",forRenderer:!0}],returnDependencies:()=>({symbol:{dependencyType:"stateVariable",variableName:"symbol"},massNumber:{dependencyType:"stateVariable",variableName:"massNumber"},displayMassNumber:{dependencyType:"stateVariable",variableName:"displayMassNumber"}}),definition({dependencyValues:e}){let r;return e.symbol in Ga?(r=`\\text{${e.symbol}}`,e.displayMassNumber&&(r=`{}^{${e.massNumber}} ${r}`)):r="[Invalid Chemical Symbol]",{setValue:{latex:r,latexWithInputChildren:[r]}}}},t}};T(vu,"componentType","atom"),T(vu,"rendererType","math");var TT={};st(TT,{FeedbackDefinition:()=>vT,FeedbackDefinitions:()=>Gh});var vT=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.code={createComponentOfType:"text"},e.text={createComponentOfType:"text"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.feedbackDefinition={returnDependencies:()=>({codeAttr:{dependencyType:"attributeComponent",attributeName:"code",variableNames:["value"]},textAttr:{dependencyType:"attributeComponent",attributeName:"text",variableNames:["value"]}}),definition({dependencyValues:e}){return e.codeAttr!==null&&e.textAttr!==null?{setValue:{feedbackDefinition:{[e.codeAttr.stateValues.value.toLowerCase()]:e.textAttr.stateValues.value}}}:{setValue:{feedbackDefinition:null}}}},t}};T(vT,"componentType","feedbackDefinition");var Gh=class extends J{static returnChildGroups(){return[{group:"feedbackDefinition",componentTypes:["feedbackDefinition"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={returnDependencies:()=>({feedbackDefinitionChildren:{dependencyType:"child",childGroups:["feedbackDefinition"],variableNames:["feedbackDefinition"]}}),definition({dependencyValues:e}){let r={};for(let n of e.feedbackDefinitionChildren)n.stateValues.feedbackDefinition&&Object.assign(r,n.stateValues.feedbackDefinition);return{setValue:{value:r}}}},t}};T(Gh,"componentType","feedbackDefinitions"),T(Gh,"rendererType");var NT={};st(NT,{StyleDefinition:()=>Hh,StyleDefinitions:()=>qh});var Hh=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);e.styleNumber={createPrimitiveOfType:"number",createStateVariable:"styleNumber",defaultValue:1};for(let r in nm)e[r]={createComponentOfType:nm[r].componentType};return e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDefinition={returnDependencies:function(){let e={};for(let r in nm)e[r]={dependencyType:"attributeComponent",attributeName:r,variableNames:["value"]};return e},definition:function({dependencyValues:e}){let r={};for(let n in nm)e[n]!==null&&(r[n]=e[n].stateValues.value);return{setValue:{styleDefinition:r}}}},t}};T(Hh,"componentType","styleDefinition"),T(Hh,"rendererType");var qh=class extends J{static returnChildGroups(){return[{group:"styleDefinition",componentTypes:["styleDefinition"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={returnDependencies:()=>({styleDefinitionChildren:{dependencyType:"child",childGroups:["styleDefinition"],variableNames:["styleNumber","styleDefinition"]}}),definition({dependencyValues:e}){let r={};for(let n of e.styleDefinitionChildren){let i=n.stateValues.styleNumber,s=r[i];s||(s=r[i]={}),Object.assign(s,n.stateValues.styleDefinition)}return{setValue:{value:r}}}},t}};T(qh,"componentType","styleDefinitions"),T(qh,"rendererType");var ST={};st(ST,{ComponentListOfListsWithSelectableType:()=>AT,ComponentListWithSelectableType:()=>um,ComponentWithSelectableType:()=>Ao});import CT from"math-expressions";function Un({componentType:a,forceComponentType:t=!1}){return function({matchedChildren:e,componentInfoObjects:r}){let n=[],i=[];function s(){let o=!1;if(t){if(i.length===1){let l=i[0],u=l.componentType;u==="copy"&&l.attributes&&l.attributes.componentType&&(!l.attributes.nComponents||l.attributes.nComponents.primitive===1)&&(u=l.attributes.componentType.primitive),r.isInheritedComponentType({inheritedComponentType:u,baseComponentType:a})&&(n.push(l),o=!0)}}else i.length===1&&typeof i[0]!="string"&&(n.push(i[0]),o=!0);!o&&i.length>0&&n.push({componentType:a,children:i}),i=[]}for(let o of e)if(typeof o!="string")i.push(o);else{let l=o.split(/\s+/),u=l[0];u===""?s():i.push(u);for(let c of l.slice(1))s(),c!==""&&i.push(c)}return s(),{success:!0,newChildren:n}}}function Ha({componentType:a}){return function({matchedChildren:t}){let e=t.reduce(function(r,n){return typeof n=="string"?[...r,...n.split(/\s+/).filter(i=>i).map(i=>({componentType:a,children:[i]}))]:[...r,n]},[]);return{success:!0,newChildren:e}}}var Ao=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.type={createPrimitiveOfType:"string"},e}static returnSugarInstructions(){let t=[];function e({matchedChildren:r,componentAttributes:n,parentAttributes:i}){let s=n.type;s||(s=i.type),s?["number","letters","math","text","boolean"].includes(s)||(console.warn(`Invalid type ${s}, setting type to number`),s="number"):s="number";let o=s==="letters"?"text":s;return o!=="text"&&(r=r.filter(l=>typeof l!="string"||l.trim()!=="")),{success:!0,newChildren:[{componentType:o,children:r}]}}return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.type={shadowVariable:!0,returnDependencies:()=>({type:{dependencyType:"doenetAttribute",attributeName:"type"},parentType:{dependencyType:"parentStateVariable",variableName:"type"}}),definition:function({dependencyValues:e,componentName:r}){let n=e.type;return n||(n=e.parentType),n?["number","letters","math","text","boolean"].includes(n)||(console.warn(`Invalid type ${n}, setting type to number`),n="number"):n="number",{setValue:{type:n}}}},t.value={public:!0,hasVariableComponentType:!0,shadowVariable:!0,returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},atMostOneChild:{dependencyType:"child",childGroups:["anything"],variableNames:["value"]}}),definition({dependencyValues:e}){let r;return e.atMostOneChild.length>0?r=e.atMostOneChild[0].stateValues.value:e.type==="text"||e.type==="letters"?r="":e.type==="boolean"?r=!1:e.type==="number"?r=NaN:r=CT.fromAst("\uFF3F"),{setValue:{value:r},setComponentType:{value:e.type}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.atMostOneChild.length>0?{success:!0,instructions:[{setDependency:"atMostOneChild",desiredValue:e.value,childIndex:0,variableIndex:0}]}:{success:!1}}},t}};T(Ao,"componentType","_componentWithSelectableType"),T(Ao,"rendererType"),T(Ao,"includeBlankStringChildren",!0);var um=class extends Ao{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.type={createPrimitiveOfType:"string"},e}static returnSugarInstructions(){let t=[];return t.push({replacementFunction:function({matchedChildren:e,componentAttributes:r,parentAttributes:n,isAttributeComponent:i=!1,createdFromMacro:s=!1,componentInfoObjects:o}){let l=r.type;l||(l=n.type),l?["number","letters","math","text","boolean"].includes(l)||(console.warn(`Invalid type ${l}, setting type to number`),l="number"):l="number";let u=l==="letters"?"text":l;return i&&!s?Un({componentType:u})({matchedChildren:e}):Ha({componentType:u})({matchedChildren:e})}}),t}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return delete t.value,t.nValues={additionalStateVariablesDefined:["childForValue"],returnDependencies:()=>({anythingForSelectedType:{dependencyType:"child",childGroups:["anything"],variableNames:["nValues"],variablesOptional:!0}}),definition({dependencyValues:e}){let r=0,n=[];for(let[i,s]of e.anythingForSelectedType.entries()){let o=Number.isInteger(s.stateValues.nValues)?s.stateValues.nValues:1;r+=o;for(let l=0;l<o;l++)n.push({child:i,valueIndex:l})}return{setValue:{nValues:r,childForValue:n}}}},t.values={public:!0,isArray:!0,entryPrefixes:["value"],stateVariablesDeterminingDependencies:["childForValue"],hasVariableComponentType:!0,returnArraySizeDependencies:()=>({nValues:{dependencyType:"stateVariable",variableName:"nValues"}}),returnArraySize({dependencyValues:e}){return[e.nValues]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={type:{dependencyType:"stateVariable",variableName:"type"}},i={};for(let s of e){let o=r.childForValue[s];i[s]={anythingForSelectedType:{dependencyType:"child",childGroups:["anything"],variableNames:["value","values"],childIndices:[o.child],variablesOptional:!0},valueIndex:{dependencyType:"value",value:o.valueIndex}}}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n,componentName:i}){let s={};for(let o of n)if(r[o].anythingForSelectedType&&r[o].anythingForSelectedType.length===1){let l=r[o].anythingForSelectedType[0],u;l.stateValues.values?u=l.stateValues.values[r[o].valueIndex]:u=l.stateValues.value,s[o]=qx(u,e.type)}return{setValue:{values:s},setComponentType:{values:e.type}}}},t}};T(um,"componentType","_componentListWithSelectableType"),T(um,"includeBlankStringChildren",!0),T(um,"removeBlankStringChildrenPostSugar",!0);var AT=class extends Ao{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.type={createPrimitiveOfType:"string"},e}static returnSugarInstructions(){let t=[],e=function({matchedChildren:r,componentAttributes:n,parentAttributes:i}){let s=Ia({componentList:r,removeParens:!0});if(s.success!==!0)return{success:!1};let o=n.type;return o||(o=i.type),o?["number","letters","math","text","boolean"].includes(o)||(console.warn(`Invalid type ${o}, setting type to number`),o="number"):o="number",{success:!0,newChildren:s.pieces.map(l=>({componentType:"_componentListWithSelectableType",attributes:{type:{primitive:o}},children:l}))}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"lists",componentTypes:["_componentListWithSelectableType"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return delete t.value,t.nLists={returnDependencies:()=>({listChildren:{dependencyType:"child",childGroups:["lists"]}}),definition({dependencyValues:e}){return{setValue:{nLists:e.listChildren.length}}}},t.lists={isArray:!0,entryPrefixes:["list"],returnArraySizeDependencies:()=>({nLists:{dependencyType:"stateVariable",variableName:"nLists"}}),returnArraySize({dependencyValues:e}){return[e.nLists]},returnArrayDependenciesByKey({arrayKeys:e}){let r={type:{dependencyType:"stateVariable",variableName:"type"}},n={};for(let i of e)n[i]={listChildren:{dependencyType:"child",childGroups:["lists"],variableNames:["values","type"],childIndices:[i]}};return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n)if(r[s].listChildren&&r[s].listChildren.length===1){let o=r[s].listChildren[0];o.stateValues.type===e.type?i[s]=o.stateValues.values:i[s]=o.stateValues.values.map(l=>qx(l,e.type))}return{setValue:{lists:i}}}},t}};T(AT,"componentType","_componentListOfListsWithSelectableType");function qx(a,t){if(Array.isArray(a)&&(a=a[0]),t==="number"){if(a instanceof CT.class){let e=a.evaluate_to_constant();return Number.isFinite(e)||(e=NaN),e}return Number(a)}else if(t==="math"){if(typeof a=="string")try{return CT.fromAst(pn.convert(a))}catch(e){}return se(a)}else return t==="boolean"?Boolean(a):String(a)}var wT={};st(wT,{SbsGroup:()=>cm,SideBySide:()=>Wh,Stack:()=>pm});import Aq from"math-expressions";var Wh=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.width={createComponentOfType:"_componentSize"},e.widths={createComponentOfType:"_componentSizeList"},e.margins={createComponentOfType:"_componentSizeList"},e.valign={createComponentOfType:"text"},e.valigns={createComponentOfType:"textList"},e}static returnChildGroups(){return[{group:"blocks",componentTypes:["_block"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nPanels={forRenderer:!0,returnDependencies:()=>({blockChildren:{dependencyType:"child",childGroups:["blocks"],skipComponentNames:!0}}),definition({dependencyValues:e}){return{setValue:{nPanels:e.blockChildren.length},checkForActualChange:{nPanels:!0}}}},t.essentialWidths={isArray:!0,entryPrefixes:["essentialWidth"],defaultValueByArrayKey:()=>null,hasEssential:!0,returnArraySizeDependencies:()=>({nPanels:{dependencyType:"stateVariable",variableName:"nPanels"}}),returnArraySize({dependencyValues:e}){return[e.nPanels]},returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey({arrayKeys:e}){let r={};for(let n of e)r[n]=!0;return{useEssentialOrDefaultValue:{essentialWidths:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let r={};for(let n in e.essentialWidths)r[n]=e.essentialWidths[n];return{success:!0,instructions:[{setEssentialValue:"essentialWidths",value:r}]}}},t.allWidthsSpecified={additionalStateVariablesDefined:[{variableName:"widthsAbsolute"}],returnDependencies(){return{nPanels:{dependencyType:"stateVariable",variableName:"nPanels"},widthAttr:{dependencyType:"attributeComponent",attributeName:"width",variableNames:["componentSize"]},widthsAttr:{dependencyType:"attributeComponent",attributeName:"widths",variableNames:["nComponents","componentSizes"]},parentWidths:{dependencyType:"parentStateVariable",parentComponentType:"sbsGroup",variableName:"specifiedWidths"},parentWidthsAbsolute:{dependencyType:"parentStateVariable",parentComponentType:"sbsGroup",variableName:"widthsAbsolute"},essentialWidth:{dependencyType:"stateVariable",variableName:"essentialWidths"}}},definition({dependencyValues:e}){let r=[],n=null,i,s=!1;e.widthsAttr!==null?i=e.widthsAttr.stateValues.nComponents:e.widthAttr!==null?(i=e.nPanels,s=!0):i=0;for(let o=0;o<e.nPanels;o++){let l=null;if(o<i?s?e.widthAttr.stateValues.componentSize?(r[o]=e.widthAttr.stateValues.componentSize.size,l=Boolean(e.widthAttr.stateValues.componentSize.isAbsolute)):r[o]=null:e.widthsAttr.stateValues.componentSizes[o]?(r[o]=e.widthsAttr.stateValues.componentSizes[o].size,l=Boolean(e.widthsAttr.stateValues.componentSizes[o].isAbsolute)):r[o]=null:e.parentWidths?(e.essentialWidth[o]===null?r[o]=e.parentWidths[o]:r[o]=e.essentialWidth[o],l=e.parentWidthsAbsolute):r[o]=e.essentialWidth[o],n===null)n=l;else if(l!==null&&n!==l)throw Error("SideBySide is not implemented for absolute measurements")}return r=r.map(o=>Number.isFinite(o)?o:null),{setValue:{allWidthsSpecified:r,widthsAbsolute:n}}}},t.essentialMargins={isArray:!0,entryPrefixes:["essentialMargin"],hasEssential:!0,defaultValueByArrayKey:()=>null,returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey({arrayKeys:e}){let r={};for(let n of e)r[n]=!0;return{useEssentialOrDefaultValue:{essentialMargins:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let r={};for(let n in e.essentialMargins)r[n]=e.essentialMargins[n];return{success:!0,instructions:[{setEssentialValue:"essentialMargins",value:r}]}}},t.allMarginsSpecified={additionalStateVariablesDefined:[{variableName:"marginsAbsolute"}],returnDependencies(){return{nPanels:{dependencyType:"stateVariable",variableName:"nPanels"},marginsAttr:{dependencyType:"attributeComponent",attributeName:"margins",variableNames:["nComponents","componentSizes"]},parentMargins:{dependencyType:"parentStateVariable",parentComponentType:"sbsGroup",variableName:"specifiedMargins"},parentMarginsAbsolute:{dependencyType:"parentStateVariable",parentComponentType:"sbsGroup",variableName:"marginsAbsolute"},essentialMargins:{dependencyType:"stateVariable",variableName:"essentialMargins"}}},definition({dependencyValues:e}){console.log(e);let r=[],n=null;if(e.marginsAttr===null)if(e.parentMargins){n=e.parentMarginsAbsolute;for(let i=0;i<2;i++)e.essentialMargins[i]===null?r[i]=e.parentMargins[i]:r[i]=e.essentialMargins[i]}else for(let i=0;i<2;i++)r[i]=e.essentialMargins[i];else if(e.marginsAttr.stateValues.nComponents===0)for(let i=0;i<2;i++)r[i]=e.essentialMargins[i];else if(e.marginsAttr.stateValues.nComponents===1){let i=null;e.marginsAttr.stateValues.componentSizes[0]&&(i=e.marginsAttr.stateValues.componentSizes[0].size,Number.isFinite(i)||(i=null),n=Boolean(e.marginsAttr.stateValues.componentSizes[0].isAbsolute)),r=[i,i]}else{e.marginsAttr.stateValues.componentSizes[0]?n=Boolean(e.marginsAttr.stateValues.componentSizes[0].isAbsolute):n=!1;let i;if(e.marginsAttr.stateValues.componentSizes[1]?i=Boolean(e.marginsAttr.stateValues.componentSizes[1].isAbsolute):i=!1,i!==n)throw Error("SideBySide is not implemented for absolute measurements");r=e.marginsAttr.stateValues.componentSizes.slice(0,2).map(s=>s&&Number.isFinite(s.size)?s.size:null)}return{setValue:{allMarginsSpecified:r,marginsAbsolute:n}}}},t.absoluteMeasurements={public:!0,componentType:"boolean",forRenderer:!0,returnDependencies:()=>({widthsAbsolute:{dependencyType:"stateVariable",variableName:"widthsAbsolute"},marginsAbsolute:{dependencyType:"stateVariable",variableName:"marginsAbsolute"}}),definition({dependencyValues:e}){let r;if(e.widthsAbsolute===null)e.marginsAbsolute===null?r=!1:r=e.marginsAbsolute;else if(e.marginsAbsolute===null)r=e.widthsAbsolute;else{if(e.widthsAbsolute!==e.marginsAbsolute)throw Error("SideBySide is not implemented for absolute measurements");r=e.widthsAbsolute}if(r===!0)throw Error("SideBySide is not implemented for absolute measurements");return{setValue:{absoluteMeasurements:r}}}},t.allWidths={additionalStateVariablesDefined:["allMargins",{variableName:"gapWidth",public:!0,componentType:"number",forRenderer:!0}],returnDependencies:()=>({nPanels:{dependencyType:"stateVariable",variableName:"nPanels"},allWidthsSpecified:{dependencyType:"stateVariable",variableName:"allWidthsSpecified"},allMarginsSpecified:{dependencyType:"stateVariable",variableName:"allMarginsSpecified"},absoluteMeasurements:{dependencyType:"stateVariable",variableName:"absoluteMeasurements"}}),definition({dependencyValues:e}){let r=0,n=[...e.allWidthsSpecified],i=[...e.allMarginsSpecified],s=0,o=0;for(let c=0;c<e.nPanels;c++){let p=n[c];p===null?o++:s+=p}let l=0,u=0;for(let c=0;c<2;c++){let p=i[c];p===null?u++:l+=p}if(l*=e.nPanels,!e.absoluteMeasurements)if(s+l>=100){let c=100/(s+l);for(let p=0;p<e.nPanels;p++)n[p]===null?n[p]=0:n[p]*=c;for(let p=0;p<2;p++)i[p]===null?i[p]=0:i[p]*=c}else if(o>0){let c=(100-(s+l))/o;for(let p=0;p<e.nPanels;p++)n[p]===null&&(n[p]=c);for(let p=0;p<2;p++)i[p]===null&&(i[p]=0)}else if(u>0){let c=(100-(s+l))/(u*e.nPanels);for(let p=0;p<2;p++)i[p]===null&&(i[p]=c)}else e.nPanels>1?r=(100-(s+l))/(e.nPanels-1):e.nPanels===1?i[1]=100-(i[0]+n[0]):console.warn("Invalid sideBySide, as it must have at least one block child");return{setValue:{allWidths:n,allMargins:i,gapWidth:r}}}},t.widths={public:!0,isArray:!0,componentType:"number",entryPrefixes:["width"],forRenderer:!0,returnArraySizeDependencies:()=>({nPanels:{dependencyType:"stateVariable",variableName:"nPanels"}}),returnArraySize({dependencyValues:e}){return[e.nPanels]},returnArrayDependenciesByKey({arrayKeys:e}){let r={allWidths:{dependencyType:"stateVariable",variableName:"allWidths"},widthsAttr:{dependencyType:"attributeComponent",attributeName:"widths",variableNames:["nComponents"]},widthAttr:{dependencyType:"attributeComponent",attributeName:"width",variableNames:["componentSize"]},absoluteMeasurements:{dependencyType:"stateVariable",variableName:"absoluteMeasurements"}},n={};for(let i of e){let s=Number(i)+1;n[i]={widthsAttr:{dependencyType:"attributeComponent",attributeName:"widths",variableNames:[`componentSize${s}`]},essentialWidth:{dependencyType:"stateVariable",variableName:`essentialWidth${s}`}}}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r}){let n={};for(let i of r)n[i]=e.allWidths[i];return{setValue:{widths:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,dependencyValuesByKey:n,globalDependencyValues:i,arraySize:s}){let o,l=!1;i.widthsAttr!==null?o=i.widthsAttr.stateValues.nComponents:i.widthAttr!==null?(o=s[0],l=!0):o=0;let u=[];for(let c in e.widths)Number(c)<o?l?u.push({setDependency:"widthAttr",desiredValue:{size:e.widths[c],isAbsolute:i.absoluteMeasurements},variableIndex:0}):u.push({setDependency:r[c].widthsAttr,desiredValue:{size:e.widths[c],isAbsolute:i.absoluteMeasurements},variableIndex:0}):u.push({setDependency:r[c].essentialWidth,desiredValue:e.widths[c]});return{success:!0,instructions:u}}},t.margins={public:!0,isArray:!0,componentType:"number",entryPrefixes:["margin"],forRenderer:!0,returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey({arrayKeys:e}){let r={allMargins:{dependencyType:"stateVariable",variableName:"allMargins"},marginsAttr:{dependencyType:"attributeComponent",attributeName:"margins",variableNames:["componentSize1","componentSize2","nComponents"]},absoluteMeasurements:{dependencyType:"stateVariable",variableName:"absoluteMeasurements"}},n={};for(let i of e){let s=Number(i)+1;n[i]={essentialMargin:{dependencyType:"stateVariable",variableName:`essentialMargin${s}`}}}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r}){let n={};for(let i of r)n[i]=e.allMargins[i];return{setValue:{margins:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyNamesByKey:n}){let i=[];if(r.marginsAttr===null)for(let s in e.margins)i.push({setDependency:n[s].essentialMargin,desiredValue:e.margins[s]});else if(!(r.marginsAttr.stateValues.componentSize1&&Number.isFinite(r.marginsAttr.stateValues.componentSize1.size)))"0"in e.margins?i.push({setDependency:"marginsAttr",desiredValue:{size:e.margins[0],isAbsolute:r.absoluteMeasurements},variableIndex:0}):i.push({setDependency:"marginsAttr",desiredValue:{size:e.margins[1],isAbsolute:r.absoluteMeasurements},variableIndex:0}),"1"in e.margins&&r.marginsAttr.stateValues.nComponents>1&&i.push({setDependency:"marginsAttr",desiredValue:{size:e.margins[1],isAbsolute:r.absoluteMeasurements},variableIndex:1});else{let s=r.marginsAttr.stateValues.nComponents===1;for(let o in e.margins)if(s)i.push({setDependency:"marginsAttr",desiredValue:{size:e.margins[o],isAbsolute:r.absoluteMeasurements},variableIndex:0});else{let l=Number(o)+1;i.push({setDependency:"marginsAttr",desiredValue:{size:e.margins[o],isAbsolute:r.absoluteMeasurements},variableIndex:o})}}return{success:!0,instructions:i}}},t.essentialValigns={isArray:!0,entryPrefixes:["essentialValign"],defaultValueByArrayKey:()=>null,hasEssential:!0,returnArraySizeDependencies:()=>({nPanels:{dependencyType:"stateVariable",variableName:"nPanels"}}),returnArraySize({dependencyValues:e}){return[e.nPanels]},returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey({arrayKeys:e}){let r={};for(let n of e)r[n]=!0;return{useEssentialOrDefaultValue:{essentialValigns:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let r={};for(let n in e.essentialValigns)r[n]=e.essentialValigns[n];return{success:!0,instructions:[{setEssentialValue:"essentialValigns",value:r}]}}},t.valigns={public:!0,isArray:!0,componentType:"text",entryPrefixes:["valign"],forRenderer:!0,returnArraySizeDependencies:()=>({nPanels:{dependencyType:"stateVariable",variableName:"nPanels"}}),returnArraySize({dependencyValues:e}){return[e.nPanels]},returnArrayDependenciesByKey({arrayKeys:e}){let r={valignAttr:{dependencyType:"attributeComponent",attributeName:"valign",variableNames:["value"]},valignsAttr:{dependencyType:"attributeComponent",attributeName:"valigns",variableNames:["nComponents"]}},n={};for(let i of e){let s=Number(i)+1;n[i]={valignsAttr:{dependencyType:"attributeComponent",attributeName:"valigns",variableNames:[`text${s}`]},parentValign:{dependencyType:"parentStateVariable",parentComponentType:"sbsGroup",variableName:`valign${s}`},parentValignAbsolute:{dependencyType:"parentStateVariable",parentComponentType:"sbsGroup",variableName:`valignAbsolute${s}`},essentialValign:{dependencyType:"stateVariable",variableName:`essentialValign${s}`}}}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n,arraySize:i}){let s={},o,l=!1;e.valignsAttr!==null?o=e.valignsAttr.stateValues.nComponents:e.valignAttr!==null?(o=i[0],l=!0):o=0;for(let u of n){let c=Number(u);if(c<o){if(l)s[u]=e.valignAttr.stateValues.value.toLowerCase();else{let p=c+1;s[u]=r[u].valignsAttr.stateValues[`text${p}`].toLowerCase()}["top","middle","bottom"].includes(s[u])||(s[u]="top")}else r[u].parentValign?r[u].essentialValign===null?s[u]=r[u].parentValign:s[u]=r[u].essentialValign:r[u].essentialValign===null?s[u]="top":s[u]=r[u].essentialValign}return{setValue:{valigns:s}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,globalDependencyValues:n,arraySize:i}){let s,o=!1;n.valignsAttr!==null?s=n.valignsAttr.stateValues.nComponents:n.valignAttr!==null?(s=i[0],o=!0):s=0;let l=[];for(let u in e.valigns){let c=e.valigns[u].toLowerCase();if(!["top","middle","bottom"].includes(c))continue;Number(u)<s?o?l.push({setDependency:"valignAttr",desiredValue:c,variableIndex:0}):l.push({setDependency:r[u].valignsAttr,desiredValue:c,variableIndex:0}):l.push({setDependency:r[u].essentialValign,desiredValue:c})}return{success:!0,instructions:l}}},t}};T(Wh,"componentType","sideBySide"),T(Wh,"renderChildren",!0);var cm=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.width={createComponentOfType:"_componentSize"},e.widths={createComponentOfType:"_componentSizeList"},e.margins={createComponentOfType:"_componentSizeList"},e.valign={createComponentOfType:"text"},e.valigns={createComponentOfType:"textList"},e}static returnChildGroups(){return[{group:"sideBySides",componentTypes:["sideBySide"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.maxNPanelsPerRow={returnDependencies:()=>({sideBySideChildren:{dependencyType:"child",childGroups:["sideBySides"],variableNames:["nPanels"]}}),definition({dependencyValues:e}){return{setValue:{maxNPanelsPerRow:Aq.math.max(e.sideBySideChildren.map(r=>r.stateValues.nPanels))},checkForActualChange:{maxNPanelsPerRow:!0}}}},t.specifiedWidths={additionalStateVariablesDefined:[{variableName:"widthsAbsoluteArray",isArray:!0}],isArray:!0,entryPrefixes:["specifiedWidth"],hasEssential:!0,defaultValueByArrayKey:()=>null,returnArraySizeDependencies:()=>({maxNPanelsPerRow:{dependencyType:"stateVariable",variableName:"maxNPanelsPerRow"}}),returnArraySize({dependencyValues:e}){return[e.maxNPanelsPerRow]},returnArrayDependenciesByKey({arrayKeys:e}){let r={widthAttr:{dependencyType:"attributeComponent",attributeName:"width",variableNames:["componentSize"]},widthsAttr:{dependencyType:"attributeComponent",attributeName:"widths",variableNames:["nComponents"]}},n={};for(let i of e){let s=Number(i)+1;n[i]={widthsAttr:{dependencyType:"attributeComponent",attributeName:"widths",variableNames:[`componentSize${s}`]}}}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n,arraySize:i}){let s={},o={},l={},u,c=!1;e.widthsAttr!==null?u=e.widthsAttr.stateValues.nComponents:e.widthAttr!==null?(u=i[0],c=!0):u=0;for(let m of n){let f=Number(m);if(f<u)if(c)e.widthAttr.stateValues.componentSize&&(s[m]=e.widthAttr.stateValues.componentSize.size,l[m]=e.widthAttr.stateValues.componentSize.isAbsolute);else{let d=f+1,h=r[m].widthsAttr.stateValues[`componentSize${d}`];h&&(s[m]=h.size,l[m]=h.isAbsolute)}else o[m]=!0,l[m]=null}let p={setValue:{widthsAbsoluteArray:l,specifiedWidths:s}};return Object.keys(o).length>0&&(p.useEssentialOrDefaultValue={specifiedWidths:o}),p},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,globalDependencyValues:n,stateValues:i,arraySize:s}){let o,l=!1;n.widthsAttr!==null?o=n.widthsAttr.stateValues.nComponents:n.widthAttr!==null?(o=s[0],l=!0):o=0;let u=[];for(let c in e.specifiedWidths)Number(c)<o?l?u.push({setDependency:"widthAttr",desiredValue:{size:e.specifiedWidths[c],isAbsolute:i.widthsAbsolute},variableIndex:0}):u.push({setDependency:r[c].widthsAttr,desiredValue:{size:e.specifiedWidths[c],isAbsolute:i.widthsAbsolute},variableIndex:0}):u.push({setEssentialValue:"specifiedWidths",value:{[c]:e.specifiedWidths[c]}});return{success:!0,instructions:u}}},t.widthsAbsolute={returnDependencies:()=>({widthsAbsoluteArray:{dependencyType:"stateVariable",variableName:"widthsAbsoluteArray"}}),definition({dependencyValues:e}){let r=null;for(let n in e.widthsAbsoluteArray){let i=e.widthsAbsoluteArray[n];if(i!==null){if(i=Boolean(i),r===null)r=i;else if(r!==i)throw Error("SbsGroup is not implemented for absolute measurements")}}return{setValue:{widthsAbsolute:r}}}},t.specifiedMargins={additionalStateVariablesDefined:[{variableName:"marginsAbsoluteArray",isArray:!0,entryPrefixes:["marginAbsolute"]}],isArray:!0,entryPrefixes:["specifiedMargin"],hasEssential:!0,defaultValueByArrayKey:()=>null,returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey({arrayKeys:e}){return{globalDependencies:{marginsAttr:{dependencyType:"attributeComponent",attributeName:"margins",variableNames:["componentSize1","componentSize2","nComponents"]}}}},arrayDefinitionByKey({dependencyValuesByKey:e,globalDependencyValues:r,arrayKeys:n}){let i={},s={},o={};if(r.marginsAttr===null||r.marginsAttr.stateValues.nComponents===0)for(let u of n)s[u]=!0,o[u]=null;else if(r.marginsAttr.stateValues.nComponents===1){let u=null,c=null;r.marginsAttr.stateValues.componentSize1&&(u=r.marginsAttr.stateValues.componentSize1.size,Number.isFinite(u)||(u=null),c=Boolean(r.marginsAttr.stateValues.componentSize1.isAbsolute));for(let p of n)i[p]=u,o[p]=c}else for(let u of n)if(r.marginsAttr.stateValues[`componentSize${Number(u)+1}`]){let c=r.marginsAttr.stateValues[`componentSize${Number(u)+1}`].size;Number.isFinite(c)||(c=null);let p=Boolean(r.marginsAttr.stateValues[`componentSize${Number(u)+1}`].isAbsolute);i[u]=c,o[u]=p}let l={setValue:{marginsAbsoluteArray:o,specifiedMargins:i}};return Object.keys(s).length>0&&(l.useEssentialOrDefaultValue={specifiedMargins:s}),l},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,globalDependencyValues:n,stateValues:i}){let s=[];if(n.marginsAttr===null)s.push({setEssentialValue:"specifiedMargins",value:e.specifiedMargins});else if(!(n.marginsAttr.stateValues.componentSize1&&Number.isFinite(n.marginsAttr.stateValues.componentSize1.size)))"0"in e.specifiedMargins?s.push({setDependency:"marginsAttr",desiredValue:{size:e.specifiedMargins[0],isAbsolute:await i.marginsAbsolute},variableIndex:0}):s.push({setDependency:"marginsAttr",desiredValue:{size:e.specifiedMargins[1],isAbsolute:await i.marginsAbsolute},variableIndex:0}),"1"in e.specifiedMargins&&n.marginsAttr.stateValues.nComponents>1&&s.push({setDependency:"marginsAttr",desiredValue:{size:e.specifiedMargins[1],isAbsolute:await i.marginsAbsolute},variableIndex:1});else{let o=n.marginsAttr.stateValues.nComponents===1;for(let l in e.specifiedMargins)o?s.push({setDependency:"marginsAttr",desiredValue:{size:e.specifiedMargins[l],isAbsolute:await i.marginsAbsolute},variableIndex:0}):s.push({setDependency:"marginsAttr",desiredValue:{size:e.specifiedMargins[l],isAbsolute:await i.marginsAbsolute},variableIndex:l})}return{success:!0,instructions:s}}},t.marginsAbsolute={returnDependencies:()=>({marginsAbsoluteArray:{dependencyType:"stateVariable",variableName:"marginsAbsoluteArray"}}),definition({dependencyValues:e}){let r=null;for(let n in e.marginsAbsoluteArray){let i=e.marginsAbsoluteArray[n];if(i!==null){if(i=Boolean(i),r===null)r=i;else if(r!==i)throw Error("SbsGroup is not implemented for absolute measurements")}}return{setValue:{marginsAbsolute:r}}}},t.absoluteMeasurements={public:!0,componentType:"boolean",returnDependencies:()=>({widthsAbsolute:{dependencyType:"stateVariable",variableName:"widthsAbsolute"},marginsAbsolute:{dependencyType:"stateVariable",variableName:"marginsAbsolute"}}),definition({dependencyValues:e}){let r;if(e.widthsAbsolute===null)e.marginsAbsolute===null?r=!1:r=e.marginsAbsolute;else if(e.marginsAbsolute===null)r=e.widthsAbsolute;else{if(e.widthsAbsolute!==e.marginsAbsolute)throw Error("SbsGroup is not implemented for absolute measurements");r=e.widthsAbsolute}if(r===!0)throw Error("SbsGroup is not implemented for absolute measurements");return{setValue:{absoluteMeasurements:r}}}},t.allWidths={additionalStateVariablesDefined:["allMargins",{variableName:"gapWidth",public:!0,componentType:"number"}],returnDependencies:()=>({maxNPanelsPerRow:{dependencyType:"stateVariable",variableName:"maxNPanelsPerRow"},specifiedWidths:{dependencyType:"stateVariable",variableName:"specifiedWidths"},specifiedMargins:{dependencyType:"stateVariable",variableName:"specifiedMargins"},absoluteMeasurements:{dependencyType:"stateVariable",variableName:"absoluteMeasurements"}}),definition({dependencyValues:e}){let r=0,n=[...e.specifiedWidths],i=[...e.specifiedMargins],s=0,o=0;for(let c=0;c<e.maxNPanelsPerRow;c++){let p=n[c];p===null?o++:s+=p}let l=0,u=0;for(let c=0;c<2;c++){let p=i[c];p===null?u++:l+=p}if(l*=e.maxNPanelsPerRow,!e.absoluteMeasurements)if(s+l>=100){let c=100/(s+l);for(let p=0;p<e.maxNPanelsPerRow;p++)n[p]===null?n[p]=0:n[p]*=c;for(let p=0;p<2;p++)i[p]===null?i[p]=0:i[p]*=c}else if(o>0){let c=(100-(s+l))/o;for(let p=0;p<e.maxNPanelsPerRow;p++)n[p]===null&&(n[p]=c);for(let p=0;p<2;p++)i[p]===null&&(i[p]=0)}else if(u>0){let c=(100-(s+l))/(u*e.maxNPanelsPerRow);for(let p=0;p<2;p++)i[p]===null&&(i[p]=c)}else e.maxNPanelsPerRow>1?r=(100-(s+l))/(e.maxNPanelsPerRow-1):e.maxNPanelsPerRow===1?i[1]=100-(i[0]+n[0]):console.warn("Invalid sideBySide, as it must have at least one block child");return{setValue:{allWidths:n,allMargins:i,gapWidth:r}}}},t.widths={public:!0,isArray:!0,componentType:"number",entryPrefixes:["width"],returnArraySizeDependencies:()=>({maxNPanelsPerRow:{dependencyType:"stateVariable",variableName:"maxNPanelsPerRow"}}),returnArraySize({dependencyValues:e}){return[e.maxNPanelsPerRow]},returnArrayDependenciesByKey({arrayKeys:e}){let r={allWidths:{dependencyType:"stateVariable",variableName:"allWidths"}},n={};for(let i of e){let s=Number(i)+1;n[i]={specifiedWidth:{dependencyType:"stateVariable",variableName:`specifiedWidth${s}`}}}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r}){let n={};for(let i of r)n[i]=e.allWidths[i];return{setValue:{widths:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r}){let n=[];for(let i in e.widths)n.push({setDependency:r[i].specifiedWidth,desiredValue:e.widths[i],variableIndex:0});return{success:!0,instructions:n}}},t.margins={public:!0,isArray:!0,componentType:"number",entryPrefixes:["margin"],returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey({arrayKeys:e}){let r={allMargins:{dependencyType:"stateVariable",variableName:"allMargins"}},n={};for(let i of e){let s=Number(i)+1;n[i]={specifiedMargin:{dependencyType:"stateVariable",variableName:`specifiedMargin${s}`}}}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r}){let n={};for(let i of r)n[i]=e.allMargins[i];return{setValue:{margins:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r}){let n=[];for(let i in e.margins)n.push({setDependency:r[i].specifiedMargin,desiredValue:e.margins[i],variableIndex:0});return{success:!0,instructions:n}}},t.valigns={public:!0,isArray:!0,componentType:"text",entryPrefixes:["valign"],hasEssential:!0,defaultValueByArrayKey:()=>"top",returnArraySizeDependencies:()=>({maxNPanelsPerRow:{dependencyType:"stateVariable",variableName:"maxNPanelsPerRow"}}),returnArraySize({dependencyValues:e}){return[e.maxNPanelsPerRow]},returnArrayDependenciesByKey({arrayKeys:e}){let r={valignAttr:{dependencyType:"attributeComponent",attributeName:"valign",variableNames:["value"]},valignsAttr:{dependencyType:"attributeComponent",attributeName:"valigns",variableNames:["nComponents"]}},n={};for(let i of e){let s=Number(i)+1;n[i]={valignsAttr:{dependencyType:"attributeComponent",attributeName:"valigns",variableNames:[`text${s}`]}}}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n,arraySize:i}){let s={},o={},l,u=!1;e.valignsAttr!==null?l=e.valignsAttr.stateValues.nComponents:e.valignAttr!==null?(l=i[0],u=!0):l=0;for(let p of n){let m=Number(p);if(m<l){if(u)s[p]=e.valignAttr.stateValues.value.toLowerCase();else{let f=m+1;s[p]=r[p].valignsAttr.stateValues[`text${f}`].toLowerCase()}["top","middle","bottom"].includes(s[p])||(s[p]="top")}else o[p]=!0}let c={};return Object.keys(s).length>0&&(c.setValue={valigns:s}),Object.keys(o).length>0&&(c.useEssentialOrDefaultValue={valigns:o}),c},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,globalDependencyValues:n,arraySize:i}){let s,o=!1;n.valignsAttr!==null?s=n.valignsAttr.stateValues.nComponents:n.valignAttr!==null?(s=i[0],o=!0):s=0;let l=[];for(let u in e.valigns){let c=e.valigns[u].toLowerCase();if(!["top","middle","bottom"].includes(c))continue;Number(u)<s?o?l.push({setDependency:"valignAttr",desiredValue:c,variableIndex:0}):l.push({setDependency:r[u].valignsAttr,desiredValue:c,variableIndex:0}):l.push({setEssentialValue:"valigns",value:{[u]:c}})}return{success:!0,instructions:l}}},t}};T(cm,"componentType","sbsGroup"),T(cm,"rendererType","container"),T(cm,"renderChildren",!0);var pm=class extends ce{static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}};T(pm,"componentType","stack"),T(pm,"rendererType","container"),T(pm,"renderChildren",!0);var ET={};st(ET,{H:()=>$h,Idx:()=>Kh});var $h=class extends Tr{};T($h,"componentType","h"),T($h,"rendererType","text");var Kh=class extends J{static returnChildGroups(){return[{group:"hs",componentTypes:["h"]},{group:"stringsTexts",componentTypes:["string","text"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.terms={returnDependencies:()=>({stringTextChildren:{dependencyType:"child",childGroups:["stringsTexts"],variableNames:["value"]},hChildren:{dependencyType:"child",childGroups:["hs"],variableNames:["value"]}}),definition({dependencyValues:e}){let r;if(e.hChildren.length>0)r=e.hChildren.map(n=>n.stateValues.value);else{let n="";for(let i of e.stringTextChildren)typeof i=="string"?n+=i:n+=i.stateValues.value;r=[n]}return{setValue:{terms:r}}}},t}};T(Kh,"componentType","idx"),T(Kh,"rendererType");var RT={};st(RT,{Div:()=>mm,Span:()=>fm});var mm=class extends ce{static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}};T(mm,"componentType","div"),T(mm,"rendererType","container"),T(mm,"renderChildren",!0);var fm=class extends re{static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}};T(fm,"componentType","span"),T(fm,"rendererType","container"),T(fm,"renderChildren",!0);var xT={};st(xT,{Pre:()=>dm});var dm=class extends ce{static returnChildGroups(){return[{group:"inlines",componentTypes:["_inline"]}]}};T(dm,"componentType","pre"),T(dm,"renderChildren",!0),T(dm,"includeBlankStringChildren",!0);var VT={};st(VT,{Paginator:()=>hm,PaginatorControls:()=>Xh});var hm=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.initialPage={createComponentOfType:"integer",createStateVariable:"initialPage",defaultValue:1},e}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nPages={public:!0,componentType:"integer",returnDependencies:()=>({children:{dependencyType:"child",childGroups:["anything"]}}),definition({dependencyValues:e}){return{setValue:{nPages:e.children.length}}}},t.currentPage={public:!0,componentType:"integer",hasEssential:!0,returnDependencies:()=>({initialPage:{dependencyType:"stateVariable",variableName:"initialPage"},nPages:{dependencyType:"stateVariable",variableName:"nPages"}}),definition({dependencyValues:e}){return{useEssentialOrDefaultValue:{currentPage:{get defaultValue(){let r=e.initialPage;return Number.isInteger(r)?Math.max(1,Math.min(e.nPages,r)):1}}}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r,sourceInformation:n={}}){if(!n.fromSetPage)return{success:!1};let i=Number(e.currentPage);return Number.isInteger(i)?(i=Math.max(1,Math.min(await r.nPages,i)),{success:!0,instructions:[{setEssentialValue:"currentPage",value:i}]}):{success:!1}}},t.childIndicesToRender={returnDependencies:()=>({currentPage:{dependencyType:"stateVariable",variableName:"currentPage"}}),definition({dependencyValues:e}){return{setValue:{childIndicesToRender:[e.currentPage-1]}}},markStale:()=>({updateRenderedChildren:!0})},t}async setPage({number:t,actionId:e}){if(!Number.isInteger(t)){this.coreFunctions.resolveAction({actionId:e});return}let r=Math.max(1,Math.min(await this.stateValues.nPages,t)),n=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"currentPage",value:r,sourceInformation:{fromSetPage:!0}}];await this.coreFunctions.performUpdate({updateInstructions:n,actionId:e,event:{verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:r,responseText:r.toString()}}})}actions={setPage:this.setPage.bind(this)}};T(hm,"componentType","paginator"),T(hm,"rendererType","container"),T(hm,"renderChildren",!0);var Xh=class extends ce{constructor(t){super(t);this.externalActions={},Object.defineProperty(this.externalActions,"setPage",{enumerable:!0,get:async function(){let e=await this.stateValues.paginatorComponentName;if(e)return{componentName:e,actionName:"setPage"}}.bind(this)})}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.previousLabel={createComponentOfType:"text",createStateVariable:"previousLabel",defaultValue:"Previous",forRenderer:!0,public:!0},e.nextLabel={createComponentOfType:"text",createStateVariable:"nextLabel",defaultValue:"Next",forRenderer:!0,public:!0},e.pageLabel={createComponentOfType:"text",createStateVariable:"pageLabel",defaultValue:"Page",forRenderer:!0,public:!0},e.paginator={createPrimitiveOfType:"string",createStateVariable:"paginator",defaultValue:null},e.disabledIgnoresParentReadOnly.defaultValue=!0,e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.paginatorComponentName={stateVariablesDeterminingDependencies:["paginator"],returnDependencies({stateValues:e}){return e.paginator?{paginatorComponentName:{dependencyType:"expandTargetName",target:e.paginator}}:{}},definition({dependencyValues:e}){return{setValue:{paginatorComponentName:e.paginatorComponentName}}}},t.currentPage={forRenderer:!0,stateVariablesDeterminingDependencies:["paginatorComponentName"],returnDependencies({stateValues:e}){return e.paginatorComponentName?{paginatorPage:{dependencyType:"stateVariable",componentName:e.paginatorComponentName,variableName:"currentPage"}}:{}},definition({dependencyValues:e}){return"paginatorPage"in e?{setValue:{currentPage:e.paginatorPage}}:{setValue:{currentPage:1}}}},t.nPages={forRenderer:!0,stateVariablesDeterminingDependencies:["paginatorComponentName"],returnDependencies({stateValues:e}){return e.paginatorComponentName?{paginatorNPages:{dependencyType:"stateVariable",componentName:e.paginatorComponentName,variableName:"nPages"}}:{}},definition({dependencyValues:e}){return"paginatorNPages"in e?{setValue:{nPages:e.paginatorNPages}}:{setValue:{nPages:1}}}},t}};T(Xh,"componentType","paginatorControls"),T(Xh,"renderChildren",!0);var OT={};st(OT,{MatrixInput:()=>ym,MatrixInputGrid:()=>Yh,MatrixInputRow:()=>Zh,default:()=>Tu});var Xr=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.collaborateGroups={createComponentOfType:"collaborateGroups",createStateVariable:"collaborateGroups",defaultValue:null,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nValues={returnDependencies:()=>({}),definition:()=>({setValue:{nValues:1}})},t.answerAncestor={returnDependencies:()=>({answerAncestor:{dependencyType:"ancestor",componentType:"answer",variableNames:["delegateCheckWorkToInput","justSubmitted","creditAchieved","showCorrectness","numberOfAttemptsLeft"]}}),definition:function({dependencyValues:e}){return{setValue:{answerAncestor:e.answerAncestor}}}},t.includeCheckWork={forRenderer:!0,returnDependencies:()=>({answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition:function({dependencyValues:e}){let r=!1;return e.answerAncestor&&(r=e.answerAncestor.stateValues.delegateCheckWorkToInput),{setValue:{includeCheckWork:r}}}},t.creditAchieved={defaultValue:0,public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition:function({dependencyValues:e}){let r=0;return e.answerAncestor&&(r=e.answerAncestor.stateValues.creditAchieved),{setValue:{creditAchieved:r}}}},t.valueHasBeenValidated={forRenderer:!0,returnDependencies:()=>({answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition:function({dependencyValues:e}){let r=!1;return e.answerAncestor&&e.answerAncestor.stateValues.justSubmitted&&(r=!0),{setValue:{valueHasBeenValidated:r}}}},t.showCorrectness={forRenderer:!0,returnDependencies:()=>({showCorrectnessFlag:{dependencyType:"flag",flagName:"showCorrectness"},answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition({dependencyValues:e}){let r;return e.answerAncestor?r=e.answerAncestor.stateValues.showCorrectness:r=e.showCorrectnessFlag!==!1,{setValue:{showCorrectness:r}}}},t.numberOfAttemptsLeft={forRenderer:!0,returnDependencies:()=>({answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition({dependencyValues:e}){let r;return e.answerAncestor?r=e.answerAncestor.stateValues.numberOfAttemptsLeft:r=1/0,{setValue:{numberOfAttemptsLeft:r}}}},t}};T(Xr,"componentType","_input");import ge from"math-expressions";var ym=class extends Xr{constructor(t){super(t);this.actions={updateNumRows:this.updateNumRows.bind(this),updateNumColumns:this.updateNumColumns.bind(this)},this.externalActions={},Object.defineProperty(this.externalActions,"submitAnswer",{enumerable:!0,get:async function(){let e=await this.stateValues.answerAncestor;if(e!==null)return{componentName:e.componentName,actionName:"submitAnswer"}}.bind(this)})}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.numRows={createComponentOfType:"integer",createStateVariable:"numRowsPreliminary",defaultValue:1,transformNonFiniteTo:0},e.numColumns={createComponentOfType:"integer",createStateVariable:"numColumnsPreliminary",defaultValue:1,transformNonFiniteTo:0},e.showSizeControls={createComponentOfType:"boolean",createStateVariable:"showSizeControls",defaultValue:!0,public:!0,forRenderer:!0},e.defaultEntry={createComponentOfType:"math",createStateVariable:"defaultEntry",defaultValue:ge.fromAst("\uFF3F")},e.prefill={createComponentOfType:"math",createStateVariable:"prefill",defaultValue:ge.fromAst("\uFF3F"),public:!0,copyComponentAttributesForCreatedComponent:["format","functionSymbols","splitSymbols"]},e.format={createComponentOfType:"text",createStateVariable:"format",defaultValue:"text",public:!0},e.functionSymbols={createComponentOfType:"textList",createStateVariable:"functionSymbols",defaultValue:["f","g"],public:!0},e.splitSymbols={createComponentOfType:"boolean",createStateVariable:"splitSymbols",defaultValue:!0,public:!0},e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:10,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e.bindValueTo={createComponentOfType:"math"},e.unionFromU={createComponentOfType:"boolean",createStateVariable:"unionFromU",defaultValue:!1,public:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r,componentAttributes:n}){return r.length>0?{success:!1}:{success:!0,newChildren:[{componentType:"matrixInputGrid"}]}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"matrixComponentInputs",componentTypes:["matrixComponentInput"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.valueOriginal={hasEssential:!0,shadowVariable:!0,returnDependencies:()=>({bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["value"]},prefill:{dependencyType:"stateVariable",variableName:"prefill"}}),set:se,definition:function({dependencyValues:e}){return e.bindValueTo?{setValue:{valueOriginal:e.bindValueTo.stateValues.value}}:{useEssentialOrDefaultValue:{valueOriginal:{defaultValue:e.prefill}}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){return r.bindValueTo?{success:!0,instructions:[{setDependency:"bindValueTo",desiredValue:e.valueOriginal,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"valueOriginal",value:e.valueOriginal}]}}},t.immediateValueOriginal={hasEssential:!0,shadowVariable:!0,returnDependencies:()=>({valueOriginal:{dependencyType:"stateVariable",variableName:"valueOriginal"}}),set:se,definition:function({dependencyValues:e,changes:r,justUpdatedForNewComponent:n}){return r.valueOriginal&&!n?{setValue:{immediateValueOriginal:e.valueOriginal},setEssentialValue:{immediateValueOriginal:e.valueOriginal}}:{useEssentialOrDefaultValue:{immediateValueOriginal:{defaultValue:e.valueOriginal}}}},inverseDefinition:function({desiredStateVariableValues:e,initialChange:r,shadowedVariable:n}){let i=[{setEssentialValue:"immediateValueOriginal",value:e.immediateValueOriginal}];return r||n||i.push({setDependency:"valueOriginal",desiredValue:e.immediateValueOriginal}),{success:!0,instructions:i}}},t.haveBoundValue={returnDependencies:()=>({bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo"}}),definition({dependencyValues:e}){return{setValue:{haveBoundValue:e.bindValueTo!==null}}}},t.numRows={public:!0,componentType:"integer",forRenderer:!0,returnDependencies:()=>({numRowsPreliminary:{dependencyType:"stateVariable",variableName:"numRowsPreliminary"},valueOriginal:{dependencyType:"stateVariable",variableName:"valueOriginal"},haveBoundValue:{dependencyType:"stateVariable",variableName:"haveBoundValue"}}),definition({dependencyValues:e,usedDefault:r}){let n=e.numRowsPreliminary;if(r.numRowsPreliminary||e.haveBoundValue){let i=e.valueOriginal.tree;if(n=1,Array.isArray(i)){let s=i[0];s==="matrix"?n=i[1][1]:(s==="vector"||s=="tuple")&&(n=i.length-1)}}return{setValue:{numRows:n}}},async inverseDefinition({desiredStateVariableValues:e,dependencyValues:r,stateValues:n}){let i=e.numRows;if(!Number.isInteger(i))return{success:!1};i=Math.max(0,i);let s=[{setDependency:"numRowsPreliminary",desiredValue:i}];if(r.haveBoundValue){let o=r.valueOriginal.tree,l=(await n.defaultEntry).tree;if(await n.numColumns===1&&Array.isArray(o)&&(o[0]==="vector"||o[0]==="tuple")){let u=o.length-1;if(i<u){let c=Re(o).slice(0,i+1);s.push({setDependency:"valueOriginal",desiredValue:ge.fromAst(c)})}else if(i>u){let c=Re(o),p=await n.accumulatedComponents;for(let m=u;m<i;m++){let f=p[m],d;f&&(d=f[0]),c[m+1]=d===void 0?l:d}s.push({setDependency:"valueOriginal",desiredValue:ge.fromAst(c)})}}else{let u=Re((await n.value).tree),c=u[1][1];if(u[1][1]=i,i!==c){if(i<c)u[2].length=i+1;else{let p=await n.numColumns,m=u[2],f=await n.accumulatedComponents;for(let d=c;d<i;d++){m[d+1]||(m[d+1]=["tuple"]);let h=f[d];h||(h=[]);for(let y=0;y<p;y++){let b=h[y];m[d+1][y+1]=b===void 0?l:b}}}s.push({setDependency:"valueOriginal",desiredValue:ge.fromAst(u)})}}}return{success:!0,instructions:s}}},t.numColumns={public:!0,componentType:"integer",forRenderer:!0,returnDependencies:()=>({numColumnsPreliminary:{dependencyType:"stateVariable",variableName:"numColumnsPreliminary"},valueOriginal:{dependencyType:"stateVariable",variableName:"valueOriginal"},haveBoundValue:{dependencyType:"stateVariable",variableName:"haveBoundValue"}}),definition({dependencyValues:e,usedDefault:r}){let n=e.numColumnsPreliminary;if(r.numColumnsPreliminary||e.haveBoundValue){let i=e.valueOriginal.tree;if(n=1,Array.isArray(i)){let s=i[0];s==="matrix"?n=i[1][2]:Array.isArray(i[1])&&(i[1][0]==="vector"||i[1][0]==="tuple")&&(s==="^"&&i[2]==="T"||s==="prime")&&(n=i[1].length-1)}}return{setValue:{numColumns:n}}},async inverseDefinition({desiredStateVariableValues:e,dependencyValues:r,stateValues:n}){let i=e.numColumns;if(!Number.isInteger(i))return{success:!1};i=Math.max(0,i);let s=[{setDependency:"numColumnsPreliminary",desiredValue:i}];if(r.haveBoundValue){let o=(await n.defaultEntry).tree,l=r.valueOriginal.tree,u=l[0];if(Array.isArray(l[1])&&(l[1][0]==="vector"||l[1][0]==="tuple")&&(u==="^"&&l[2]==="T"||u==="prime")){let c=l[1].length-1;if(i<c){let p=Re(l);p[1]=p[1].slice(0,i+1),s.push({setDependency:"valueOriginal",desiredValue:ge.fromAst(p)})}else if(i>c){let p=Re(l),m=(await n.accumulatedComponents)[0];m||(m=[]);for(let f=c;f<i;f++){let d=m[f];p[1][f+1]=d===void 0?o:d}s.push({setDependency:"valueOriginal",desiredValue:ge.fromAst(p)})}}else{let c=Re((await n.value).tree),p=c[1][2];if(c[1][2]=i,i!==p){let m=await n.numRows,f=c[2];if(i<p)for(let d=0;d<m;d++)f[d+1].length=i+1;else{let d=await n.accumulatedComponents;for(let h=0;h<m;h++){let y=d[h];y||(y=[]);for(let b=p;b<i;b++){let g=y[b];f[h+1][b+1]=g===void 0?o:g}}}s.push({setDependency:"valueOriginal",desiredValue:ge.fromAst(c)})}}}return{success:!0,instructions:s}}},t.accumulatedComponents={providePreviousValuesInDefinition:!0,returnDependencies:()=>({valueOriginal:{dependencyType:"stateVariable",variableName:"valueOriginal"}}),definition({dependencyValues:e,previousValues:r}){let n=[];r.accumulatedComponents&&(n=Re(r.accumulatedComponents));let i=e.valueOriginal.tree;if(Array.isArray(i)){let o=i[0];if(o==="matrix"){let l=i[2];for(let[u,c]of l.slice(1).entries()){let p=n[u];p||(p=n[u]=[]);for(let[m,f]of c.slice(1).entries())p[m]=f}return{setValue:{accumulatedComponents:n}}}else if(o==="vector"||o==="tuple"){for(let[l,u]of i.slice(1).entries()){let c=n[l];c||(c=n[l]=[]),c[0]=u}return{setValue:{accumulatedComponents:n}}}else if(Array.isArray(i[1])&&(i[1][0]==="vector"||i[1][0]==="tuple")&&(o==="^"&&i[2]==="T"||o==="prime")){let l=n[0];l||(l=n[0]=[]);for(let[u,c]of i[1].slice(1).entries())l[u]=c;return{setValue:{accumulatedComponents:n}}}}let s=n[0];return s||(s=n[0]=[]),s[0]=i,{setValue:{accumulatedComponents:n}}}},t.componentValues={isArray:!0,entryPrefixes:["componentValue"],nDimensions:2,returnArraySizeDependencies:()=>({numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),returnArraySize({dependencyValues:e}){return[e.numRows,e.numColumns]},returnArrayDependenciesByKey(){return{globalDependencies:{valueOriginal:{dependencyType:"stateVariable",variableName:"valueOriginal"},numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"},accumulatedComponents:{dependencyType:"stateVariable",variableName:"accumulatedComponents"},defaultEntry:{dependencyType:"stateVariable",variableName:"defaultEntry"}}}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r}){let n=e.valueOriginal.tree,i=e.accumulatedComponents,s=e.numRows,o=e.numColumns;if(Array.isArray(n)){let u=n[0];if(u==="matrix"){if(n[1][1]===s&&n[1][2]===o){let y={},b=n[2];for(let g=0;g<s;g++)for(let v=0;v<o;v++){let A=`${g},${v}`;y[A]=ge.fromAst(b[g+1][v+1])}return{setValue:{componentValues:y}}}let c=n[1][1],p=n[1][2],m={},f=n[2],d=Math.min(s,c),h=Math.min(o,p);for(let y=0;y<d;y++)for(let b=0;b<h;b++){let g=`${y},${b}`;m[g]=ge.fromAst(f[y+1][b+1])}if(o>p)for(let y=0;y<d;y++){let b=i[y];for(let g=p;g<o;g++){let v=b[g],A=`${y},${g}`;m[A]=ge.fromAst(v===void 0?e.defaultEntry.tree:v)}}if(s>c)for(let y=c;y<s;y++){let b=i[y];b||(b=[]);for(let g=0;g<o;g++){let v=b[g],A=`${y},${g}`;m[A]=ge.fromAst(v===void 0?e.defaultEntry.tree:v)}}return{setValue:{componentValues:m}}}else if(u==="vector"||u==="tuple"){let c=n.slice(1),p=c.length,m={};for(let f=0;f<s;f++){let d=0;if(f<p){let y=`${f},${0}`;m[y]=ge.fromAst(c[f]),d=1}let h=i[f];h||(h=[]);for(let y=d;y<o;y++){let b=h[y],g=`${f},${y}`;m[g]=ge.fromAst(b===void 0?e.defaultEntry.tree:b)}}return{setValue:{componentValues:m}}}else if(Array.isArray(n[1])&&(n[1][0]==="vector"||n[1][0]==="tuple")&&(u==="^"&&n[2]==="T"||u==="prime")){let c=n[1].slice(1,o+1),p=i[0];p||(p=[]);let m={};for(let f=0;f<s;f++){let d=i[f];d||(d=[]);let h=0;if(f===0){for(let y=0;y<c.length;y++){let b=`${0},${y}`;m[b]=ge.fromAst(c[y])}h=c.length}for(let y=h;y<o;y++){let b=d[y],g=`${f},${y}`;m[g]=ge.fromAst(b===void 0?e.defaultEntry.tree:b)}}return{setValue:{componentValues:m}}}}let l={};for(let u=0;u<s;u++){let c=0;if(u===0){let m=`${0},${0}`;l[m]=ge.fromAst(n),c=1}let p=i[u];p||(p=[]);for(let m=c;m<o;m++){let f=p[m],d=`${u},${m}`;l[d]=ge.fromAst(f===void 0?e.defaultEntry.tree:f)}}return{setValue:{componentValues:l}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,initialChange:n,workspace:i}){let s=r.numRows,o=r.numColumns,l=!1,u=!1,c=!1,p=r.valueOriginal.tree;if(Array.isArray(p)){let f=p[0];f==="vector"||f==="tuple"?l=!0:f==="matrix"?c=!0:Array.isArray(p[1])&&(p[1][0]==="vector"||p[1][0]==="tuple")&&(f==="^"&&p[2]==="T"||f==="prime")&&(u=!0)}let m;if(i.valueData)m=i.valueData.map(f=>[...f]);else{let f=r.valueOriginal.tree;if(l){if(m=f.slice(1,1+s).map(d=>[d]),m.length<s)for(let d=m.length;d<s;d++)m.push(["\uFF3F"]);if(o>1)for(let d=0;d<s;d++)m[d].push(...Array(o-1).fill("\uFF3F"))}else if(u){if(m=[f[1].slice(1,1+o)],m[0].length<o&&m[0].push(...Array(o-m[0].length).fill("\uFF3F")),s>1)for(let d=1;d<s;d++)m.push(Array(o).fill("\uFF3F"))}else if(c){if(m=f[2].slice(1,s+1).map(d=>d.slice(1,o+1)),m[0].length<o)for(let d=0;d<m.length;d++)m[d].push(...Array(o-m[d].length).fill("\uFF3F"));if(m.length<s)for(let d=m.length;d<s;d++)m.push(Array(o).fill("\uFF3F"))}else if(m=[[f]],o>1&&m[0].push(...Array(o-1).fill("\uFF3F")),s>1)for(let d=1;d<s;d++)m.push(Array(o).fill("\uFF3F"))}for(let f in e.componentValues){let[d,h]=f.split(",");m[d][h]=se(e.componentValues[f]).tree}if(i.valueData=m,o===1&&l){let f=r.valueOriginal.tree[0],d=ge.fromAst([f,...m.map(h=>h[0])]);return{success:!0,instructions:[{setDependency:"valueOriginal",desiredValue:d,treatAsInitialChange:n}]}}else if(s===1&&u){let f=r.valueOriginal.tree,d=f[0],h=[f[1][0],...m[0]];return d==="^"?h=ge.fromAst(["^",h,"T"]):h=ge.fromAst(["prime",h]),{success:!0,instructions:[{setDependency:"valueOriginal",desiredValue:h,treatAsInitialChange:n}]}}else{let f=["matrix",["tuple",r.numRows,r.numColumns],["tuple",...m.map(d=>["tuple",...d])]];return{success:!0,instructions:[{setDependency:"valueOriginal",desiredValue:ge.fromAst(f),treatAsInitialChange:n}]}}}},t.componentImmediateValues={isArray:!0,entryPrefixes:["componentImmediateValue"],nDimensions:2,returnArraySizeDependencies:()=>({numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),returnArraySize({dependencyValues:e}){return[e.numRows,e.numColumns]},returnArrayDependenciesByKey(){return{globalDependencies:{immediateValueOriginal:{dependencyType:"stateVariable",variableName:"immediateValueOriginal"},numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"},accumulatedComponents:{dependencyType:"stateVariable",variableName:"accumulatedComponents"},defaultEntry:{dependencyType:"stateVariable",variableName:"defaultEntry"}}}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r}){let n=e.immediateValueOriginal.tree,i=e.accumulatedComponents,s=e.numRows,o=e.numColumns;if(Array.isArray(n)){let u=n[0];if(u==="matrix"){if(n[1][1]===s&&n[1][2]===o){let y={},b=n[2];for(let g=0;g<s;g++)for(let v=0;v<o;v++){let A=`${g},${v}`;y[A]=ge.fromAst(b[g+1][v+1])}return{setValue:{componentImmediateValues:y}}}let c=n[1][1],p=n[1][2],m={},f=n[2],d=Math.min(s,c),h=Math.min(o,p);for(let y=0;y<d;y++)for(let b=0;b<h;b++){let g=`${y},${b}`;m[g]=ge.fromAst(f[y+1][b+1])}if(o>p)for(let y=0;y<d;y++){let b=i[y];for(let g=p;g<o;g++){let v=b[g],A=`${y},${g}`;m[A]=ge.fromAst(v===void 0?e.defaultEntry.tree:v)}}if(s>c)for(let y=c;y<s;y++){let b=i[y];b||(b=[]);for(let g=0;g<o;g++){let v=b[g],A=`${y},${g}`;m[A]=ge.fromAst(v===void 0?e.defaultEntry.tree:v)}}return{setValue:{componentImmediateValues:m}}}else if(u==="vector"||u==="tuple"){let c=n.slice(1),p=c.length,m={};for(let f=0;f<s;f++){let d=0;if(f<p){let y=`${f},${0}`;m[y]=ge.fromAst(c[f]),d=1}let h=i[f];h||(h=[]);for(let y=d;y<o;y++){let b=h[y],g=`${f},${y}`;m[g]=ge.fromAst(b===void 0?e.defaultEntry.tree:b)}}return{setValue:{componentImmediateValues:m}}}else if(Array.isArray(n[1])&&(n[1][0]==="vector"||n[1][0]==="tuple")&&(u==="^"&&n[2]==="T"||u==="prime")){let c=n[1].slice(1,o+1),p=i[0];p||(p=[]);let m={};for(let f=0;f<s;f++){let d=i[f];d||(d=[]);let h=0;if(f===0){for(let y=0;y<c.length;y++){let b=`${0},${y}`;m[b]=ge.fromAst(c[y])}h=c.length}for(let y=h;y<o;y++){let b=d[y],g=`${f},${y}`;m[g]=ge.fromAst(b===void 0?e.defaultEntry.tree:b)}}return{setValue:{componentImmediateValues:m}}}}let l={};for(let u=0;u<s;u++){let c=0;if(u===0){let m=`${0},${0}`;l[m]=ge.fromAst(n),c=1}let p=i[u];p||(p=[]);for(let m=c;m<o;m++){let f=p[m],d=`${u},${m}`;l[d]=ge.fromAst(f===void 0?e.defaultEntry.tree:f)}}return{setValue:{componentImmediateValues:l}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,initialChange:n,workspace:i}){let s=r.numRows,o=r.numColumns,l=!1,u=!1,c=!1,p=r.immediateValueOriginal.tree;if(Array.isArray(p)){let f=p[0];f==="vector"||f==="tuple"?l=!0:f==="matrix"?c=!0:Array.isArray(p[1])&&(p[1][0]==="vector"||p[1][0]==="tuple")&&(f==="^"&&p[2]==="T"||f==="prime")&&(u=!0)}let m;if(i.immediateValueData)m=i.immediateValueData.map(f=>[...f]);else{let f=r.immediateValueOriginal.tree;if(l){if(m=f.slice(1,1+s).map(d=>[d]),m.length<s)for(let d=m.length;d<s;d++)m.push(["\uFF3F"]);if(o>1)for(let d=0;d<s;d++)m[d].push(...Array(o-1).fill("\uFF3F"))}else if(u){if(m=[f[1].slice(1,1+o)],m[0].length<o&&m[0].push(...Array(o-m[0].length).fill("\uFF3F")),s>1)for(let d=1;d<s;d++)m.push(Array(o).fill("\uFF3F"))}else if(c){if(m=f[2].slice(1,s+1).map(d=>d.slice(1,o+1)),m[0].length<o)for(let d=0;d<m.length;d++)m[d].push(...Array(o-m[d].length).fill("\uFF3F"));if(m.length<s)for(let d=m.length;d<s;d++)m.push(Array(o).fill("\uFF3F"))}else if(m=[[f]],o>1&&m[0].push(...Array(o-1).fill("\uFF3F")),s>1)for(let d=1;d<s;d++)m.push(Array(o).fill("\uFF3F"))}for(let f in e.componentImmediateValues){let[d,h]=f.split(",");m[d][h]=se(e.componentImmediateValues[f]).tree}if(i.immediateValueData=m,o===1&&l){let f=r.immediateValueOriginal.tree[0],d=ge.fromAst([f,...m.map(h=>h[0])]);return{success:!0,instructions:[{setDependency:"immediateValueOriginal",desiredValue:d,treatAsInitialChange:n}]}}else if(s===1&&u){let f=r.immediateValueOriginal.tree,d=f[0],h=[f[1][0],...m[0]];return d==="^"?h=ge.fromAst(["^",h,"T"]):h=ge.fromAst(["prime",h]),{success:!0,instructions:[{setDependency:"immediateValueOriginal",desiredValue:h,treatAsInitialChange:n}]}}else{let f=["matrix",["tuple",r.numRows,r.numColumns],["tuple",...m.map(d=>["tuple",...d])]];return{success:!0,instructions:[{setDependency:"immediateValueOriginal",desiredValue:ge.fromAst(f),treatAsInitialChange:n}]}}}},t.componentValuesForDisplay={isArray:!0,entryPrefixes:["componentValueForDisplay"],nDimensions:2,forRenderer:!0,returnArraySizeDependencies:()=>({numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),returnArraySize({dependencyValues:e}){return[e.numRows,e.numColumns]},returnArrayDependenciesByKey({arrayKeys:e}){let r={displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}},n={};for(let i of e){let[s,o]=i.split(","),l=Number(s)+1+"_"+(Number(o)+1);n[i]={componentValue:{dependencyType:"stateVariable",variableName:`componentValue${l}`}}}return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n,usedDefault:i}){let s={};for(let o of n){let l=Lt({value:r[o].componentValue,dependencyValues:e,usedDefault:i});s[o]=l}return{setValue:{componentValuesForDisplay:s}}}},t.value={public:!0,componentType:"math",stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigits",displayDecimals:"displayDecimals",displaySmallAsZero:"displaySmallAsZero"},returnDependencies:()=>({componentValues:{dependencyType:"stateVariable",variableName:"componentValues"},numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"},valueOriginal:{dependencyType:"stateVariable",variableName:"valueOriginal"}}),definition({dependencyValues:e}){let r=e.numRows,n=e.numColumns,i=["matrix",["tuple",r,n]],s=i[2]=["tuple"];for(let o=0;o<r;o++){s[o+1]=["tuple"];for(let l=0;l<n;l++)s[o+1][l+1]=e.componentValues[o][l].tree}return{setValue:{value:ge.fromAst(i)}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){let n=e.value.tree;if(Array.isArray(n)&&n[0]==="matrix"&&n[1][1]===r.numRows&&n[1][2]===r.numColumns){if(r.numColumns===1){let i=r.valueOriginal.tree;if(Array.isArray(i)){let s=i[0];if(s==="vector"||s==="tuple"){let o=ge.fromAst([s,...n[2].slice(1).map(l=>l[1])]);return{success:!0,instructions:[{setDependency:"valueOriginal",desiredValue:o}]}}}}else if(r.numRows===1){let i=r.valueOriginal.tree;if(Array.isArray(i)){let s=i[0];if(Array.isArray(i[1])&&(i[1][0]==="vector"||i[1][0]==="tuple")&&(s==="^"&&i[2]==="T"||s==="prime")){let o=[i[1][0],...n[2][1].slice(1)];return s==="^"?o=ge.fromAst(["^",o,"T"]):o=ge.fromAst(["prime",o]),{success:!0,instructions:[{setDependency:"valueOriginal",desiredValue:o}]}}}}return{success:!0,instructions:[{setDependency:"valueOriginal",desiredValue:e.value}]}}else return{success:!1}}},t.immediateValue={public:!0,componentType:"math",stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigits",displayDecimals:"displayDecimals",displaySmallAsZero:"displaySmallAsZero"},returnDependencies:()=>({componentImmediateValues:{dependencyType:"stateVariable",variableName:"componentImmediateValues"},numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"},immediateValueOriginal:{dependencyType:"stateVariable",variableName:"immediateValueOriginal"}}),definition({dependencyValues:e}){let r=e.numRows,n=e.numColumns,i=["matrix",["tuple",r,n]],s=i[2]=["tuple"];for(let o=0;o<r;o++){s[o+1]=["tuple"];for(let l=0;l<n;l++)s[o+1][l+1]=e.componentImmediateValues[o][l].tree}return{setValue:{immediateValue:ge.fromAst(i)}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){let n=e.immediateValue.tree;if(Array.isArray(n)&&n[0]==="matrix"&&n[1][1]===r.numRows&&n[1][2]===r.numColumns){if(r.numColumns===1){let i=r.immediateValueOriginal.tree;if(Array.isArray(i)){let s=i[0];if(s==="vector"||s==="tuple"){let o=ge.fromAst([s,...n[2].slice(1).map(l=>l[1])]);return{success:!0,instructions:[{setDependency:"immediateValueOriginal",desiredValue:o}]}}}}else if(r.numRows===1){let i=r.immediateValueOriginal.tree;if(Array.isArray(i)){let s=i[0];if(Array.isArray(i[1])&&(i[1][0]==="vector"||i[1][0]==="tuple")&&(s==="^"&&i[2]==="T"||s==="prime")){let o=[i[1][0],...n[2][1].slice(1)];return s==="^"?o=ge.fromAst(["^",o,"T"]):o=ge.fromAst(["prime",o]),{success:!0,instructions:[{setDependency:"immediateValueOriginal",desiredValue:o}]}}}}return{success:!0,instructions:[{setDependency:"immediateValueOriginal",desiredValue:e.immediateValue}]}}else return{success:!1}}},t.valueForDisplay={forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}}),definition:function({dependencyValues:e,usedDefault:r}){return{setValue:{valueForDisplay:Lt({value:e.value,dependencyValues:e,usedDefault:r})}}}},t}async updateRawValues({rawRendererValues:t,transient:e=!1,actionId:r}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:r});else return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rawRendererValues",value:t}],transient:e,actionId:r})}async updateNumRows({numRows:t,actionId:e}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:e});else return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"numRows",value:t}],actionId:e})}async updateNumColumns({numColumns:t,actionId:e}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:e});else return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"numColumns",value:t}],actionId:e})}};T(ym,"componentType","matrixInput"),T(ym,"variableForPlainMacro","value"),T(ym,"renderChildren",!0);var Yh=class extends Ae{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numRows={returnDependencies:()=>({parentNumRows:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"numRows"}}),definition({dependencyValues:e}){return{setValue:{numRows:e.parentNumRows}}}},t.numColumns={returnDependencies:()=>({parentNumColumns:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"numColumns"}}),definition({dependencyValues:e}){return{setValue:{numColumns:e.parentNumColumns}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),markStale(){return{updateReplacements:!0}},definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,componentInfoObjects:e,flags:r,workspace:n}){let i=[],s=await t.stateValues.numRows;n.previousNumRows=s;for(let o=0;o<s;o++)i.push({componentType:"matrixInputRow",state:{rowInd:o},uniqueIdentifier:o});return{replacements:i}}static async calculateReplacementChanges({component:t,componentChanges:e,componentInfoObjects:r,flags:n,workspace:i}){let s=[],o=i.previousNumRows,l=await t.stateValues.numRows,u,c=0;if(l<o){u=t.replacements.length-l;let p={changeType:"changeReplacementsToWithhold",replacementsToWithhold:u};s.push(p)}else if(l>o&&(c=l-o,t.replacementsToWithhold>0))if(t.replacementsToWithhold>=c){u=t.replacementsToWithhold-c,o+=c,c=0;let p={changeType:"changeReplacementsToWithhold",replacementsToWithhold:u};s.push(p)}else c-=t.replacementsToWithhold,o+=t.replacementsToWithhold,u=0;if(c>0){let p=[];for(let f=o;f<l;f++)p.push({componentType:"matrixInputRow",state:{rowInd:f},uniqueIdentifier:f});let m={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:o,serializedReplacements:p,replacementsToWithhold:0,assignNamesOffset:o};s.push(m)}return i.previousNumRows=l,s}};T(Yh,"componentType","matrixInputGrid"),T(Yh,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");var Zh=class extends Ae{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.rowInd={hasEssential:!0,defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{rowInd:!0}})},t.numColumns={returnDependencies:()=>({parentNumColumns:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"numColumns"}}),definition({dependencyValues:e}){return{setValue:{numColumns:e.parentNumColumns}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),markStale(){return{updateReplacements:!0}},definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}j;static async createSerializedReplacements({component:t,componentInfoObjects:e,flags:r,workspace:n}){let i=[],s=await t.stateValues.numColumns,o=await t.stateValues.rowInd;n.previousNumColumns=s;for(let l=0;l<s;l++)i.push({componentType:"matrixComponentInput",state:{rowInd:o,colInd:l},uniqueIdentifier:l});return{replacements:i}}static async calculateReplacementChanges({component:t,componentChanges:e,componentInfoObjects:r,flags:n,workspace:i}){let s=[],o=i.previousNumColumns,l=await t.stateValues.numColumns,u=await t.stateValues.rowInd,c,p=0;if(l<o){c=t.replacements.length-l;let m={changeType:"changeReplacementsToWithhold",replacementsToWithhold:c};s.push(m)}else if(l>o&&(p=l-o,t.replacementsToWithhold>0))if(t.replacementsToWithhold>=p){c=t.replacementsToWithhold-p,o+=p,p=0;let m={changeType:"changeReplacementsToWithhold",replacementsToWithhold:c};s.push(m)}else p-=t.replacementsToWithhold,o+=t.replacementsToWithhold,c=0;if(p>0){let m=[];for(let d=o;d<l;d++)m.push({componentType:"matrixComponentInput",state:{rowInd:u,colInd:d},uniqueIdentifier:d});let f={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:o,serializedReplacements:m,replacementsToWithhold:0,assignNamesOffset:o};s.push(f)}return i.previousNumColumns=l,s}};T(Zh,"componentType","matrixInputRow"),T(Zh,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");var Tu=class extends J{constructor(t){super(t);this.actions={updateRawValue:this.updateRawValue.bind(this),updateValue:this.updateValue.bind(this)}}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.rowInd={hasEssential:!0,defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{rowInd:!0}})},t.colInd={hasEssential:!0,defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{colInd:!0}})},t.format={returnDependencies:()=>({parentFormat:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"format"}}),definition({dependencyValues:e}){return{setValue:{format:e.parentFormat}}}},t.functionSymbols={returnDependencies:()=>({parentFunctionSymbols:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"functionSymbols"}}),definition({dependencyValues:e}){return{setValue:{functionSymbols:e.parentFunctionSymbols}}}},t.splitSymbols={returnDependencies:()=>({parentSplitSymbols:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"splitSymbols"}}),definition({dependencyValues:e}){return{setValue:{splitSymbols:e.parentSplitSymbols}}}},t.displayDigits={returnDependencies:()=>({parentDisplayDigits:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"displayDigits"}}),definition({dependencyValues:e,usedDefault:r}){let n={setValue:{displayDigits:e.parentDisplayDigits}};return r.parentDisplayDigits&&(n.markAsUsedDefault={displayDigits:!0}),n}},t.displayDecimals={returnDependencies:()=>({parentDisplayDecimals:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"displayDecimals"}}),definition({dependencyValues:e,usedDefault:r}){let n={setValue:{displayDecimals:e.parentDisplayDecimals}};return r.parentDisplayDecimals&&(n.markAsUsedDefault={displayDecimals:!0}),n}},t.displaySmallAsZero={returnDependencies:()=>({parentDisplaySmallAsZero:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"displaySmallAsZero"}}),definition({dependencyValues:e}){return{setValue:{displaySmallAsZero:e.parentDisplaySmallAsZero}}}},t.unionFromU={returnDependencies:()=>({parentUnionFromU:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:"unionFromU"}}),definition({dependencyValues:e}){return{setValue:{unionFromU:e.parentUnionFromU}}}},t.value={stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigits",displayDecimals:"displayDecimals",displaySmallAsZero:"displaySmallAsZero"},stateVariablesDeterminingDependencies:["rowInd","colInd"],returnDependencies:({stateValues:e})=>{let r="";return e.rowInd!==null&&e.colInd!==null&&(r=`${e.rowInd+1}_${e.colInd+1}`),{parentComponentValue:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:`componentValue${r}`}}},definition:function({dependencyValues:e}){return e.parentComponentValue?{setValue:{value:e.parentComponentValue}}:{setValue:{value:ge.fromAst("\uFF3F")}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){let n=[{setDependency:"parentComponentValue",desiredValue:e.value}];return{success:!0,instructions:n}}},t.immediateValue={public:!0,componentType:"math",stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigits",displayDecimals:"displayDecimals",displaySmallAsZero:"displaySmallAsZero"},stateVariablesDeterminingDependencies:["rowInd","colInd"],returnDependencies:({stateValues:e})=>{let r="";return e.rowInd!==null&&e.colInd!==null&&(r=`${e.rowInd+1}_${e.colInd+1}`),{parentComponentImmediateValue:{dependencyType:"parentStateVariable",parentComponentType:"matrixInput",variableName:`componentImmediateValue${r}`}}},definition:function({dependencyValues:e}){return{setValue:{immediateValue:e.parentComponentImmediateValue}}},inverseDefinition:function({desiredStateVariableValues:e,initialChange:r}){let n=[{setDependency:"parentComponentImmediateValue",desiredValue:e.immediateValue,treatAsInitialChange:r}];return{success:!0,instructions:n}}},t.valueForDisplay={forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}}),definition:function({dependencyValues:e,usedDefault:r}){return{setValue:{valueForDisplay:Lt({value:e.value,dependencyValues:e,usedDefault:r})}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"}}),definition:function({dependencyValues:e}){return{setValue:{text:e.valueForDisplay.toString()}}}},t.rawRendererValue={forRenderer:!0,hasEssential:!0,shadowVariable:!0,defaultValue:"",provideEssentialValuesInDefinition:!0,public:!0,componentType:"text",additionalStateVariablesDefined:[{variableName:"lastValueForDisplay",hasEssential:!0,shadowVariable:!0,defaultValue:null,set:se}],returnDependencies:()=>({immediateValue:{dependencyType:"stateVariable",variableName:"immediateValue"},valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"}}),definition({dependencyValues:e,essentialValues:r}){if(r.rawRendererValue===void 0||!Ot(r.lastValueForDisplay.tree,e.valueForDisplay.tree)){let n=eu(e.valueForDisplay.toLatex());return n==="\uFF3F"&&(n=""),{setValue:{rawRendererValue:n,lastValueForDisplay:e.valueForDisplay},setEssentialValue:{rawRendererValue:n,lastValueForDisplay:e.valueForDisplay}}}else return{useEssentialOrDefaultValue:{rawRendererValue:!0,lastValueForDisplay:!0}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r,essentialValues:n}){let i=async o=>{let l;o=ph(o,{unionFromU:await r.unionFromU}),o=o.replace(/\^(\w)/g,"^{$1}");let u=Jl({functionSymbols:await r.functionSymbols,splitSymbols:await r.splitSymbols});try{l=u(o)}catch(c){l=ge.fromAst("\uFF3F")}return l},s=[];if(typeof e.rawRendererValue=="string"){let o=n.rawRendererValue,l=e.rawRendererValue;o!==l&&s.push({setEssentialValue:"rawRendererValue",value:l});let u=await i(o),c=await i(l);Ot(c.tree,u.tree)||s.push({setDependency:"immediateValue",desiredValue:c,treatAsInitialChange:!0})}else{s.push({setEssentialValue:"lastValueForDisplay",value:e.rawRendererValue});let o=await i(n.rawRendererValue);if(!Ot(e.rawRendererValue.tree,o.tree)){let l=eu(e.rawRendererValue.toLatex());l==="\uFF3F"&&(l=""),s.push({setEssentialValue:"rawRendererValue",value:l})}}return{success:!0,instructions:s}}},t.componentType={returnDependencies:()=>({}),definition:()=>({setValue:{componentType:"math"}})},t}async updateRawValue({rawRendererValue:t,actionId:e}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:e});else return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rawRendererValue",value:t}],actionId:e})}async updateValue({actionId:t}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:t});else{let e=await this.stateValues.immediateValue;if(Ot((await this.stateValues.value).tree,e.tree))await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rawRendererValue",valueOfStateVariable:"rawRendererValue"}],actionId:t});else{let r=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:e},{updateType:"executeUpdate"},{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",valueOfStateVariable:"value"}];e.tree!=="\uFF3F"&&r.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"rawRendererValue",valueOfStateVariable:"valueForDisplay"});let n={verb:"answered",object:{componentName:this.componentName,componentType:this.componentType},result:{response:e,responseText:e.toString()}},i=await this.stateValues.answerAncestor;return i&&(n.context={answerAncestor:i.componentName}),await this.coreFunctions.performUpdate({updateInstructions:r,actionId:t,event:n}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}}}};T(Tu,"componentType","matrixComponentInput"),T(Tu,"rendererType","mathInput"),T(Tu,"variableForPlainMacro","value");var gi=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.hide,delete e.disabled,delete e.modifyIndirectly,delete e.fixed,delete e.styleNumber,delete e.isResponse,e.documentWideCheckWork={createComponentOfType:"boolean",createStateVariable:"documentWideCheckWork",defaultValue:!1,public:!0},e.xmlns={createPrimitiveOfType:"string"},e.type={createPrimitiveOfType:"string"},e}static returnChildGroups(){return[{group:"variantControl",componentTypes:["variantControl"]},{group:"title",componentTypes:["title"]},{group:"description",componentTypes:["description"]},{group:"setups",componentTypes:["setup"]},{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=Nh();Object.assign(t,e);let r=Ph();return Object.assign(t,r),t.titleChildName={forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childGroups:["title"]}}),definition({dependencyValues:n}){let i=null;return n.titleChild.length>0&&(i=n.titleChild[0].componentName),{setValue:{titleChildName:i}}}},t.title={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childGroups:["title"],variableNames:["text"]}}),definition({dependencyValues:n}){return n.titleChild.length===0?{setValue:{title:""}}:{setValue:{title:n.titleChild[0].stateValues.text}}}},t.description={public:!0,componentType:"text",returnDependencies:()=>({descriptionChild:{dependencyType:"child",childGroups:["description"],variableNames:["text"]}}),definition({dependencyValues:n}){return n.descriptionChild.length===0?{setValue:{description:""}}:{setValue:{description:n.descriptionChild[0].stateValues.text}}}},t.level={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{level:0}})},t.viewedSolution={defaultValue:!1,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{viewedSolution:!0}}),inverseDefinition({desiredStateVariableValues:n}){return{success:!0,instructions:[{setEssentialValue:"viewedSolution",value:n.viewedSolution}]}}},t.scoredDescendants={returnDependencies:()=>({scoredDescendants:{dependencyType:"descendant",componentTypes:["_sectioningComponent","answer","setup"],variableNames:["scoredDescendants","aggregateScores","weight"],recurseToMatchedChildren:!1,variablesOptional:!0}}),definition({dependencyValues:n}){let i=[];for(let s of n.scoredDescendants)s.componentType!=="setup"&&(s.stateValues.aggregateScores||s.stateValues.scoredDescendants===void 0?i.push(s):i.push(...s.stateValues.scoredDescendants));return{setValue:{scoredDescendants:i}}}},t.nScoredDescendants={returnDependencies:()=>({scoredDescendants:{dependencyType:"stateVariable",variableName:"scoredDescendants"}}),definition({dependencyValues:n}){return{setValue:{nScoredDescendants:n.scoredDescendants.length}}}},t.itemCreditAchieved={isArray:!0,returnArraySizeDependencies:()=>({nScoredDescendants:{dependencyType:"stateVariable",variableName:"nScoredDescendants"}}),returnArraySize({dependencyValues:n}){return[n.nScoredDescendants]},stateVariablesDeterminingDependencies:["scoredDescendants"],returnArrayDependenciesByKey({arrayKeys:n,stateValues:i}){let s={};for(let o of n){let l=i.scoredDescendants[o];l&&(s[o]={creditAchieved:{dependencyType:"stateVariable",componentName:l.componentName,variableName:"creditAchieved"}})}return{dependenciesByKey:s}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i)s[o]=n[o].creditAchieved;return{setValue:{itemCreditAchieved:s}}}},t.itemNumberByAnswerName={stateVariablesDeterminingDependencies:["scoredDescendants"],returnDependencies({stateValues:n}){let i={scoredDescendants:{dependencyType:"stateVariable",variableName:"scoredDescendants"}};for(let s in n.scoredDescendants){let o=n.scoredDescendants[s];i[`descendantsOf${s}`]={dependencyType:"descendant",ancestorName:o.componentName,componentTypes:["answer"],recurseToMatchedChildren:!1}}return i},definition({dependencyValues:n,componentInfoObjects:i}){let s={};for(let[o,l]of n.scoredDescendants.entries()){let u=o+1;for(let c of n[`descendantsOf${o}`])s[c.componentName]=u;i.isInheritedComponentType({inheritedComponentType:l.componentType,baseComponentType:"answer"})&&(s[l.componentName]=u)}return{setValue:{itemNumberByAnswerName:s}}}},t.itemVariantInfo={isArray:!0,returnArraySizeDependencies:()=>({nScoredDescendants:{dependencyType:"stateVariable",variableName:"nScoredDescendants"}}),returnArraySize({dependencyValues:n}){return[n.nScoredDescendants]},stateVariablesDeterminingDependencies:["scoredDescendants"],returnArrayDependenciesByKey({arrayKeys:n,stateValues:i}){let s={};for(let o of n){let l=i.scoredDescendants[o];l&&(s[o]={generatedVariantInfo:{dependencyType:"stateVariable",componentName:l.componentName,variableName:"generatedVariantInfo",variablesOptional:!0}})}return{dependenciesByKey:s}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i)s[o]=n[o].generatedVariantInfo;return{setValue:{itemVariantInfo:s}}}},t.answerDescendants={returnDependencies:()=>({answerDescendants:{dependencyType:"descendant",componentTypes:["answer"],variableNames:["justSubmitted"],recurseToMatchedChildren:!1}}),definition({dependencyValues:n}){return{setValue:{answerDescendants:n.answerDescendants}}}},t.justSubmitted={forRenderer:!0,returnDependencies:()=>({answerDescendants:{dependencyType:"stateVariable",variableName:"answerDescendants"}}),definition({dependencyValues:n}){return{setValue:{justSubmitted:n.answerDescendants.every(i=>i.stateValues.justSubmitted)}}}},t.showCorrectness={forRenderer:!0,returnDependencies:()=>({showCorrectnessFlag:{dependencyType:"flag",flagName:"showCorrectness"}}),definition({dependencyValues:n}){return{setValue:{showCorrectness:n.showCorrectnessFlag!==!1}}}},t.displayDigitsForCreditAchieved={returnDependencies:()=>({}),definition:()=>({setValue:{displayDigitsForCreditAchieved:3}})},t.creditAchieved={public:!0,componentType:"number",forRenderer:!0,defaultValue:0,stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigitsForCreditAchieved"},additionalStateVariablesDefined:[{variableName:"percentCreditAchieved",public:!0,componentType:"number",stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigitsForCreditAchieved"}}],returnDependencies:()=>({scoredDescendants:{dependencyType:"stateVariable",variableName:"scoredDescendants"},itemCreditAchieved:{dependencyType:"stateVariable",variableName:"itemCreditAchieved"}}),definition({dependencyValues:n}){let i=0,s=0;for(let[u,c]of n.scoredDescendants.entries()){let p=c.stateValues.weight;i+=n.itemCreditAchieved[u]*p,s+=p}let o;s>0?o=i/s:o=1;let l=o*100;return{setValue:{creditAchieved:o,percentCreditAchieved:l}}}},t.creditAchievedIfSubmit={defaultValue:0,stateVariablesDeterminingDependencies:["scoredDescendants"],returnDependencies({stateValues:n}){let i={scoredDescendants:{dependencyType:"stateVariable",variableName:"scoredDescendants"}};for(let[s,o]of n.scoredDescendants.entries())i["creditAchievedIfSubmit"+s]={dependencyType:"stateVariable",componentName:o.componentName,variableName:"creditAchievedIfSubmit"};return i},definition({dependencyValues:n}){let i=0,s=0;for(let[l,u]of n.scoredDescendants.entries()){let c=u.stateValues.weight;i+=n["creditAchievedIfSubmit"+l]*c,s+=c}return{setValue:{creditAchievedIfSubmit:i/s}}}},t.generatedVariantInfo={providePreviousValuesInDefinition:!0,returnDependencies:({sharedParameters:n,componentInfoObjects:i})=>({variantIndex:{dependencyType:"value",value:n.variantIndex},variantName:{dependencyType:"value",value:n.variantName},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(i.componentTypesCreatingVariants),variableNames:["isVariantComponent","generatedVariantInfo"],recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfEncounteredComposites:!0}}),definition({dependencyValues:n,componentName:i,previousValues:s}){let o={index:n.variantIndex,name:n.variantName,meta:{createdBy:i}},l=o.subvariants=[];for(let u of n.variantDescendants)u.stateValues.isVariantComponent?l.push(u.stateValues.generatedVariantInfo):u.stateValues.generatedVariantInfo&&l.push(...u.stateValues.generatedVariantInfo.subvariants);for(let[u,c]of l.entries())if(!c.subvariants&&s.generatedVariantInfo){let p=s.generatedVariantInfo.subvariants;p[u]?.subvariants&&(l[u]=Object.assign({},l[u]),l[u].subvariants=p[u].subvariants)}return{setValue:{generatedVariantInfo:o}}}},t.createSubmitAllButton={forRenderer:!0,additionalStateVariablesDefined:[{variableName:"suppressAnswerSubmitButtons",forRenderer:!0}],returnDependencies:()=>({documentWideCheckWork:{dependencyType:"stateVariable",variableName:"documentWideCheckWork"}}),definition({dependencyValues:n,componentName:i}){let s=!1,o=!1;return n.documentWideCheckWork&&(s=!0,o=!0),{setValue:{createSubmitAllButton:s,suppressAnswerSubmitButtons:o}}}},t}actions={submitAllAnswers:this.submitAllAnswers.bind(this)};async submitAllAnswers({actionId:t}){this.coreFunctions.requestRecordEvent({verb:"submitted",object:{componentName:this.componentName,componentType:this.componentType}});for(let e of await this.stateValues.answerDescendants)await e.stateValues.justSubmitted||await this.coreFunctions.performAction({componentName:e.componentName,actionName:"submitAnswer"});this.coreFunctions.resolveAction({actionId:t})}static async setUpVariant({serializedComponent:t,sharedParameters:e,definingChildrenSoFar:r,descendantVariantComponents:n}){let i;for(let o of r)if(o!==void 0&&o.componentType==="variantControl"){i=o;break}if(i===void 0){let o=100;e.allPossibleVariants=[...Array(o).keys()].map(c=>Wx(c+1));let l,u=t.variants.desiredVariant;if(u!==void 0){if(u.index!==void 0){let c=Number(u.index);if(!Number.isFinite(c))console.warn("Variant index "+u.index+" must be a number"),l=1;else{Number.isInteger(c)||(console.warn("Variant index "+u.index+" must be an integer"),c=Math.round(c));let p=(c-1)%o;p<0&&(p+=o),l=p+1}}else if(u.name!==void 0){if(typeof u.name=="string"){let c=e.allPossibleVariants.indexOf(u.name.toLowerCase());c!==-1&&(l=c+1)}l===void 0&&(console.warn("Variant name "+u.name+" is not valid"),l=1)}}l===void 0&&(l=1),e.variantSeed=l.toString(),e.variantIndex=l,e.variantName=Wx(l),e.variantRng=new e.rngClass(e.variantSeed)}else e.variantSeed=await i.state.selectedSeed.value,e.variantName=await i.state.selectedVariantName.value,e.variantIndex=await i.state.selectedVariantIndex.value,e.variantRng=await i.state.variantRng.value,e.allPossibleVariants=await i.state.variantNames.value;let s=t.variants.desiredVariant;if(s===void 0&&(s={}),s.subvariants&&n)for(let o in s.subvariants){let l=s.subvariants[o],u=n[o];if(u===void 0)break;u.variants.desiredVariant=l}}static determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e}){if(t.children===void 0)return{success:!0,numberOfVariants:1};let r;for(let s of t.children)if(s.componentType==="variantControl"){r=s;break}if(!r)return{success:!0,numberOfVariants:100};let n=r.attributes.nVariants?.primitive;if(n===void 0&&(n=100),!r.attributes.uniqueVariants?.primitive)return{success:!0,numberOfVariants:n};let i=super.determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e});return i.success?(n=Math.min(i.numberOfVariants,n),t.variants.numberOfVariants=n,console.log("Actual number of variants for document is "+n),{success:!0,numberOfVariants:n}):i}static getUniqueVariant({serializedComponent:t,variantIndex:e,componentInfoObjects:r}){let n=t.variants?.numberOfVariants;if(n===void 0)return{success:!1};if(!Number.isInteger(e)||e<1||e>n)return{success:!1};let i=hh({variantIndex:e,serializedComponent:t,componentInfoObjects:r});return i.success?{success:!0,desiredVariant:{index:e,subvariants:i.desiredVariants}}:(console.log("Failed to get unique variant for document."),{success:!1})}};T(gi,"componentType","document"),T(gi,"rendererType","section"),T(gi,"renderChildren",!0),T(gi,"createsVariants",!0),T(gi,"includeBlankStringChildren",!0);function Wx(a){return pu(a,!0)}var pa=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.unordered={createComponentOfType:"boolean",createStateVariable:"unordered",defaultValue:!1,public:!0},e.maximumNumber={createComponentOfType:"number",createStateVariable:"maximumNumber",defaultValue:null,public:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=Un({componentType:"text"}),r=Ha({componentType:"text"});return t.push({replacementFunction:function({matchedChildren:n,isAttributeComponent:i=!1,createdFromMacro:s=!1}){return i&&!s?e({matchedChildren:n}):r({matchedChildren:n})}}),t}static returnChildGroups(){return[{group:"texts",componentTypes:["text"]},{group:"textLists",componentTypes:["textList"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({setValue:{overrideChildHide:!0}})},t.textsShadow={defaultValue:null,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{textsShadow:!0}})},t.nComponents={public:!0,componentType:"number",additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies(){return{maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},textListChildren:{dependencyType:"child",childGroups:["textLists"],variableNames:["nComponents"]},textAndTextListChildren:{dependencyType:"child",childGroups:["texts","textLists"],skipComponentNames:!0},textsShadow:{dependencyType:"stateVariable",variableName:"textsShadow"}}},definition:function({dependencyValues:e,componentInfoObjects:r}){let n=0,i=[];if(e.textAndTextListChildren.length>0){let o=0;for(let[l,u]of e.textAndTextListChildren.entries())if(r.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"textList"})){let c=e.textListChildren[o];o++;for(let p=0;p<c.stateValues.nComponents;p++)i[n+p]=[l,p];n+=c.stateValues.nComponents}else i[n]=[l,0],n+=1}else e.textsShadow!==null&&(n=e.textsShadow.length);let s=e.maximumNumber;return s!==null&&n>s&&(n=s,i=i.slice(0,s)),{setValue:{nComponents:n,childIndexByArrayKey:i},checkForActualChange:{nComponents:!0}}}},t.texts={public:!0,componentType:"text",isArray:!0,entryPrefixes:["text"],stateVariablesDeterminingDependencies:["childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={},i={childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"},textsShadow:{dependencyType:"stateVariable",variableName:"textsShadow"}};for(let s of e){let o=[],l="1";r.childIndexByArrayKey[s]&&(o=[r.childIndexByArrayKey[s][0]],l=r.childIndexByArrayKey[s][1]+1),n[s]={textAndTextListChildren:{dependencyType:"child",childGroups:["texts","textLists"],variableNames:["value","text"+l],variablesOptional:!0,childIndices:o}}}return{globalDependencies:i,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].textAndTextListChildren[0];if(o)if(o.stateValues.value!==void 0)i[s]=o.stateValues.value;else{let l=e.childIndexByArrayKey[s][1]+1;i[s]=o.stateValues["text"+l]}else e.textsShadow!==null&&(i[s]=e.textsShadow[s])}return{setValue:{texts:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[];for(let l in e.texts){if(!n[l])continue;let u=n[l].textAndTextListChildren[0];u&&(u.stateValues.value!==void 0?o.push({setDependency:i[l].textAndTextListChildren,desiredValue:e.texts[l],childIndex:0,variableIndex:0}):o.push({setDependency:i[l].textAndTextListChildren,desiredValue:e.texts[l],childIndex:0,variableIndex:1}))}return{success:!0,instructions:o}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"texts"},t.text={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({texts:{dependencyType:"stateVariable",variableName:"texts"}}),definition:({dependencyValues:e})=>({setValue:{text:e.texts.join(", ")}})},t.componentNamesInList={returnDependencies:()=>({textAndTextListChildren:{dependencyType:"child",childGroups:["texts","textLists"],variableNames:["componentNamesInList"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e,componentInfoObjects:r}){let n=[];for(let s of e.textAndTextListChildren)r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"textList"})?n.push(...s.stateValues.componentNamesInList):n.push(s.componentName);let i=e.maximumNumber;return i!==null&&n.length>i&&(i=Math.max(0,Math.floor(i)),n=n.slice(0,i)),{setValue:{componentNamesInList:n}}}},t.nComponentsToDisplayByChild={additionalStateVariablesDefined:["nChildrenToRender"],returnDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"},textListChildren:{dependencyType:"child",childGroups:["textLists"],variableNames:["nComponents"]},textAndTextListChildren:{dependencyType:"child",childGroups:["texts","textLists"],skipComponentNames:!0},parentNComponentsToDisplayByChild:{dependencyType:"parentStateVariable",parentComponentType:"textList",variableName:"nComponentsToDisplayByChild"}}),definition:function({dependencyValues:e,componentInfoObjects:r,componentName:n}){let i=e.nComponents;e.parentNComponentsToDisplayByChild!==null&&(i=e.parentNComponentsToDisplayByChild[n]);let s={},o=0,l=0,u=0;for(let c of e.textAndTextListChildren){let p=Math.max(0,i-o);if(p>0&&l++,r.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"textList"})){let m=e.textListChildren[u];u++;let f=Math.min(p,m.stateValues.nComponents);s[m.componentName]=f,o+=f}else o+=1}return{setValue:{nComponentsToDisplayByChild:s,nChildrenToRender:l}}},markStale:()=>({updateRenderedChildren:!0})},t}};T(pa,"componentType","textList"),T(pa,"renderChildren",!0),T(pa,"includeBlankStringChildren",!0),T(pa,"removeBlankStringChildrenPostSugar",!0),T(pa,"stateVariableForAttributeValue","texts"),T(pa,"primaryStateVariableForDefinition","textsShadow"),T(pa,"descendantCompositesMustHaveAReplacement",!1);var Nu=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.unordered={default:!1},e.maximumNumber={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t),r=e.newLeaf({name:"atLeastZeroTexts",componentType:"text",comparison:"atLeast",number:0}),n=e.newLeaf({name:"atLeastZeroTextLists",componentType:"textList",comparison:"atLeast",number:0}),i=function({dependencyValues:l}){let u=l.stringChildren[0],c=u.stateValues.value.split(",").map(p=>({componentType:"text",state:{value:p.trim()}}));return{success:!0,newChildren:c,toDelete:[u.componentName]}},s=e.newLeaf({name:"exactlyOneString",componentType:"string",number:1,isSugar:!0,returnSugarDependencies:()=>({stringChildren:{dependencyType:"child",childLogicName:"exactlyOneString",variableNames:["value"]}}),logicToWaitOnSugar:["atLeastZeroTexts"],replacementFunction:i}),o=e.newOperator({name:"textAndTextLists",operator:"and",propositions:[r,n]});return e.newOperator({name:"TextsXorSugar",operator:"xor",propositions:[s,o],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.texts={public:!0,componentType:"text",isArray:!0,entryPrefixes:["text"],returnDependencies:()=>({textAndTextListChildren:{dependencyType:"child",childLogicName:"textAndTextLists",variableNames:["value","texts"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},childrenToRender:{dependencyType:"stateVariable",variableName:"childrenToRender"}}),definition:function({dependencyValues:e}){let r=[],n=e.textAndTextListChildren.map(i=>i.componentName);for(let i of e.childrenToRender){let s=n.indexOf(i),o=e.textAndTextListChildren[s];o.stateValues.texts?r.push(...o.stateValues.texts):r.push(o.stateValues.value)}return{setValue:{texts:r}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({texts:{dependencyType:"stateVariable",variableName:"texts"}}),definition:({dependencyValues:e})=>({setValue:{text:e.texts.join(", ")}})},t.nComponents={public:!0,componentType:"number",returnDependencies:()=>({texts:{dependencyType:"stateVariable",variableName:"texts"}}),definition:function({dependencyValues:e}){return{setValue:{nComponents:e.texts.length}}}},t.childrenToRender={returnDependencies:({sharedParameters:e})=>({textAndTextListChildren:{dependencyType:"child",childLogicName:"textAndTextLists",variableNames:["childrenToRender"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},selectRng:{dependencyType:"value",value:e.selectRng,doNotProxy:!0}}),definition:function({dependencyValues:e}){let r=[];for(let s of e.textAndTextListChildren)s.stateValues.childrenToRender?r.push(...s.stateValues.childrenToRender):r.push(s.componentName);let n=e.maximumNumber;n!==null&&r.length>n&&(n=Math.max(0,Math.floor(n)),r=r.slice(0,n)),console.log("randomizing children");for(let s=r.length-1;s>0;s--){let o=e.selectRng(),l=Math.floor(o*(s+1));[r[s],r[l]]=[r[l],r[s]]}let i=Math.ceil(e.selectRng()*r.length);return console.log(`numChildren: ${i}`),r=r.slice(0,i),{setValue:{childrenToRender:r}}}},t}initializeRenderer(){this.renderer===void 0&&(this.renderer=new this.availableRenderers.aslist({key:this.componentName}))}};T(Nu,"componentType","randomizedTextList"),T(Nu,"stateVariableForAttributeValue","texts");import"math-expressions";var xn=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.unordered={createComponentOfType:"boolean",createStateVariable:"unordered",defaultValue:!1,public:!0},e.maximumNumber={createComponentOfType:"number",createStateVariable:"maximumNumber",defaultValue:null,public:!0},e.mergeMathLists={createComponentOfType:"boolean",createStateVariable:"mergeMathListsPreliminary",defaultValue:!1},e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:10,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=Un({componentType:"math"}),r=Ha({componentType:"math"});return t.push({replacementFunction:function({matchedChildren:n,isAttributeComponent:i=!1,createdFromMacro:s=!1}){return i&&!s?e({matchedChildren:n}):r({matchedChildren:n})}}),t}static returnChildGroups(){return[{group:"maths",componentTypes:["math"]},{group:"mathLists",componentTypes:["mathList"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({setValue:{overrideChildHide:!0}})},t.mathsShadow={defaultValue:null,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{mathsShadow:!0}})},t.mergeMathLists={public:!0,componentType:"boolean",returnDependencies:()=>({mergeMathListsPreliminary:{dependencyType:"stateVariable",variableName:"mergeMathListsPreliminary"},mathListChildren:{dependencyType:"child",childGroups:["mathLists"],skipComponentNames:!0},mathChildren:{dependencyType:"child",childGroups:["maths"],skipComponentNames:!0}}),definition({dependencyValues:e}){return{setValue:{mergeMathLists:e.mergeMathListsPreliminary||e.mathListChildren.length===0&&e.mathChildren.length===1}}}},t.nComponents={public:!0,componentType:"number",stateVariablesDeterminingDependencies:["mergeMathLists"],additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies({stateValues:e}){let r={maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},mergeMathLists:{dependencyType:"stateVariable",variableName:"mergeMathLists"},mathsShadow:{dependencyType:"stateVariable",variableName:"mathsShadow"}};return e.mergeMathLists?r.mathAndMathListChildren={dependencyType:"child",childGroups:["maths","mathLists"],variableNames:["value","nComponents"],variablesOptional:!0}:(r.mathListChildren={dependencyType:"child",childGroups:["mathLists"],variableNames:["nComponents"]},r.mathAndMathListChildren={dependencyType:"child",childGroups:["maths","mathLists"],skipComponentNames:!0}),r},definition:function({dependencyValues:e,componentInfoObjects:r}){let n=0,i=[];if(e.mathAndMathListChildren.length>0)if(e.mergeMathLists)for(let[o,l]of e.mathAndMathListChildren.entries())if(r.isInheritedComponentType({inheritedComponentType:l.componentType,baseComponentType:"mathList"})){for(let u=0;u<l.stateValues.nComponents;u++)i[n+u]=[o,u];n+=l.stateValues.nComponents}else{let u=l.stateValues.value;if(u&&Array.isArray(u.tree)&&u.tree[0]==="list"){let c=u.tree.length-1;for(let p=0;p<c;p++)i[p+n]=[o,p];n+=c}else i[n]=[o,0],n+=1}else{let o=0;for(let[l,u]of e.mathAndMathListChildren.entries())if(r.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"mathList"})){let c=e.mathListChildren[o];o++;for(let p=0;p<c.stateValues.nComponents;p++)i[n+p]=[l,p];n+=c.stateValues.nComponents}else i[n]=[l,0],n+=1}else e.mathsShadow!==null&&(n=e.mathsShadow.length);let s=e.maximumNumber;return s!==null&&n>s&&(n=s,i=i.slice(0,s)),{setValue:{nComponents:n,childIndexByArrayKey:i},checkForActualChange:{nComponents:!0}}}},t.maths={public:!0,componentType:"math",isArray:!0,entryPrefixes:["math"],stateVariablesDeterminingDependencies:["mergeMathLists","childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={},i={mergeMathLists:{dependencyType:"stateVariable",variableName:"mergeMathLists"},childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"},mathsShadow:{dependencyType:"stateVariable",variableName:"mathsShadow"}};for(let s of e){let o=[],l="1";r.childIndexByArrayKey[s]&&(o=[r.childIndexByArrayKey[s][0]],l=r.childIndexByArrayKey[s][1]+1),n[s]={mathAndMathListChildren:{dependencyType:"child",childGroups:["maths","mathLists"],variableNames:["value","math"+l],variablesOptional:!0,childIndices:o}}}return{globalDependencies:i,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].mathAndMathListChildren[0];if(o)if(o.stateValues.value!==void 0){let l=o.stateValues.value;if(e.mergeMathLists&&Array.isArray(l.tree)&&l.tree[0]==="list"){let u=e.childIndexByArrayKey[s][1];i[s]=l.get_component(u)}else i[s]=l}else{let l=e.childIndexByArrayKey[s][1]+1;i[s]=o.stateValues["math"+l]}else e.mathsShadow!==null&&(i[s]=e.mathsShadow[s])}return{setValue:{maths:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){if(r.mergeMathLists)return console.log("Have not implemented inverse definition for math list with mergeMathLists=true"),{success:!1};let o=[];for(let l in e.maths){if(!n[l])continue;let u=n[l].mathAndMathListChildren[0];u&&(u.stateValues.value!==void 0?o.push({setDependency:i[l].mathAndMathListChildren,desiredValue:e.maths[l],childIndex:0,variableIndex:0}):o.push({setDependency:i[l].mathAndMathListChildren,desiredValue:e.maths[l],childIndex:0,variableIndex:1}))}return{success:!0,instructions:o}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"maths"},t.latex={additionalStateVariablesDefined:["latexs"],public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({mathAndMathListChildren:{dependencyType:"child",childGroups:["maths","mathLists"],variableNames:["valueForDisplay","latex","latexs"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},mergeMathLists:{dependencyType:"stateVariable",variableName:"mergeMathLists"},mathsShadow:{dependencyType:"stateVariable",variableName:"mathsShadow"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}}),definition:function({dependencyValues:e,usedDefault:r}){let n=[];if(e.mathAndMathListChildren.length>0)for(let o of e.mathAndMathListChildren)if(o.stateValues.valueForDisplay){let l=o.stateValues.valueForDisplay;if(e.mergeMathLists&&Array.isArray(l.tree)&&l.tree[0]==="list")for(let u=0;u<l.tree.length-1;u++)n.push(l.get_component(u).toLatex());else n.push(o.stateValues.latex)}else n.push(...o.stateValues.latexs);else e.mathsShadow!==null&&(n=e.mathsShadow.map(o=>Lt({value:o,dependencyValues:e,usedDefault:r}).toLatex()));let i=e.maximumNumber;return i!==null&&n.length>i&&(i=Math.max(0,Math.floor(i)),n=n.slice(0,i)),{setValue:{latex:n.join(", "),latexs:n}}}},t.text={public:!0,componentType:"text",additionalStateVariablesDefined:["texts"],returnDependencies:()=>({mathAndMathListChildren:{dependencyType:"child",childGroups:["maths","mathLists"],variableNames:["valueForDisplay","text","texts"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},mergeMathLists:{dependencyType:"stateVariable",variableName:"mergeMathLists"},mathsShadow:{dependencyType:"stateVariable",variableName:"mathsShadow"}}),definition:function({dependencyValues:e}){let r=[];if(e.mathAndMathListChildren.length>0)for(let s of e.mathAndMathListChildren)if(s.stateValues.valueForDisplay){let o=s.stateValues.valueForDisplay;if(e.mergeMathLists&&Array.isArray(o.tree)&&o.tree[0]==="list")for(let l=0;l<o.tree.length-1;l++)r.push(o.get_component(l).toString());else r.push(s.stateValues.text)}else r.push(...s.stateValues.texts);else e.mathsShadow!==null&&(r=e.mathsShadow.map(s=>s.toString()));let n=e.maximumNumber;return n!==null&&r.length>n&&(n=Math.max(0,Math.floor(n)),r=r.slice(0,n)),{setValue:{text:r.join(", "),texts:r}}}},t.componentNamesInList={returnDependencies:()=>({mathAndMathListChildren:{dependencyType:"child",childGroups:["maths","mathLists"],variableNames:["componentNamesInList"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e,componentInfoObjects:r}){let n=[];for(let s of e.mathAndMathListChildren)r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"mathList"})?n.push(...s.stateValues.componentNamesInList):n.push(s.componentName);let i=e.maximumNumber;return i!==null&&n.length>i&&(i=Math.max(0,Math.floor(i)),n=n.slice(0,i)),{setValue:{componentNamesInList:n}}}},t.nComponentsToDisplayByChild={additionalStateVariablesDefined:["nChildrenToRender"],returnDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"},mathListChildren:{dependencyType:"child",childGroups:["mathLists"],variableNames:["nComponents"]},mathAndMathListChildren:{dependencyType:"child",childGroups:["maths","mathLists"],skipComponentNames:!0},parentNComponentsToDisplayByChild:{dependencyType:"parentStateVariable",parentComponentType:"mathList",variableName:"nComponentsToDisplayByChild"}}),definition:function({dependencyValues:e,componentInfoObjects:r,componentName:n}){let i=e.nComponents;e.parentNComponentsToDisplayByChild!==null&&(i=e.parentNComponentsToDisplayByChild[n]);let s={},o=0,l=0,u=0;for(let c of e.mathAndMathListChildren){let p=Math.max(0,i-o);if(p>0&&l++,r.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"mathList"})){let m=e.mathListChildren[u];u++;let f=Math.min(p,m.stateValues.nComponents);s[m.componentName]=f,o+=f}else o+=1}return{setValue:{nComponentsToDisplayByChild:s,nChildrenToRender:l}}},markStale:()=>({updateRenderedChildren:!0})},t}};T(xn,"componentType","mathList"),T(xn,"renderChildren",!0),T(xn,"includeBlankStringChildren",!0),T(xn,"removeBlankStringChildrenPostSugar",!0),T(xn,"stateVariableForAttributeValue","maths"),T(xn,"primaryStateVariableForDefinition","mathsShadow"),T(xn,"descendantCompositesMustHaveAReplacement",!1);var qa=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.unordered={createComponentOfType:"boolean",createStateVariable:"unordered",defaultValue:!1,public:!0},e.maximumNumber={createComponentOfType:"number",createStateVariable:"maximumNumber",defaultValue:null,public:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=Un({componentType:"number"}),r=Ha({componentType:"number"});return t.push({replacementFunction:function({matchedChildren:n,isAttributeComponent:i=!1,createdFromMacro:s=!1}){return i&&!s?e({matchedChildren:n}):r({matchedChildren:n})}}),t}static returnChildGroups(){return[{group:"numbers",componentTypes:["number"]},{group:"numberLists",componentTypes:["numberList"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({setValue:{overrideChildHide:!0}})},t.nComponents={public:!0,componentType:"number",additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies:()=>({maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},numberListChildren:{dependencyType:"child",childGroups:["numberLists"],variableNames:["nComponents"]},numberAndNumberListChildren:{dependencyType:"child",childGroups:["numbers","numberLists"],skipComponentNames:!0}}),definition:function({dependencyValues:e,componentInfoObjects:r}){let n=0,i=[],s=0;for(let[l,u]of e.numberAndNumberListChildren.entries())if(r.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"numberList"})){let c=e.numberListChildren[s];s++;for(let p=0;p<c.stateValues.nComponents;p++)i[n+p]=[l,p];n+=c.stateValues.nComponents}else i[n]=[l,0],n+=1;let o=e.maximumNumber;return o!==null&&n>o&&(n=o,i=i.slice(0,o)),{setValue:{nComponents:n,childIndexByArrayKey:i},checkForActualChange:{nComponents:!0}}}},t.numbers={public:!0,componentType:"number",isArray:!0,entryPrefixes:["number"],stateVariablesDeterminingDependencies:["childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={},i={childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"}};for(let s of e){let o=[],l="1";r.childIndexByArrayKey[s]&&(o=[r.childIndexByArrayKey[s][0]],l=r.childIndexByArrayKey[s][1]+1),n[s]={numberAndNumberListChildren:{dependencyType:"child",childGroups:["numbers","numberLists"],variableNames:["value","number"+l],variablesOptional:!0,childIndices:o}}}return{globalDependencies:i,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].numberAndNumberListChildren[0];if(o)if(o.stateValues.value!==void 0)i[s]=o.stateValues.value;else{let l=e.childIndexByArrayKey[s][1]+1;i[s]=o.stateValues["number"+l]}}return{setValue:{numbers:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[];for(let l in e.numbers){if(!n[l])continue;let u=n[l].numberAndNumberListChildren[0];u&&(u.stateValues.value!==void 0?o.push({setDependency:i[l].numberAndNumberListChildren,desiredValue:e.numbers[l],childIndex:0,variableIndex:0}):o.push({setDependency:i[l].numberAndNumberListChildren,desiredValue:e.numbers[l],childIndex:0,variableIndex:1}))}return{success:!0,instructions:o}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"numbers"},t.text={public:!0,componentType:"text",additionalStateVariablesDefined:["texts"],returnDependencies:()=>({numberAndNumberListChildren:{dependencyType:"child",childGroups:["numbers","numberLists"],variableNames:["valueForDisplay","text","texts"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e}){let r=[];for(let s of e.numberAndNumberListChildren)s.stateValues.valueForDisplay!==void 0?r.push(s.stateValues.text):r.push(...s.stateValues.texts);let n=e.maximumNumber;return n!==null&&r.length>n&&(n=Math.max(0,Math.floor(n)),r=r.slice(0,n)),{setValue:{text:r.join(", "),texts:r}}}},t.componentNamesInList={returnDependencies:()=>({numberAndNumberListChildren:{dependencyType:"child",childGroups:["numbers","numberLists"],variableNames:["componentNamesInList"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e,componentInfoObjects:r}){let n=[];for(let s of e.numberAndNumberListChildren)r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"numberList"})?n.push(...s.stateValues.componentNamesInList):n.push(s.componentName);let i=e.maximumNumber;return i!==null&&n.length>i&&(i=Math.max(0,Math.floor(i)),n=n.slice(0,i)),{setValue:{componentNamesInList:n}}}},t.nComponentsToDisplayByChild={additionalStateVariablesDefined:["nChildrenToRender"],returnDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"},numberListChildren:{dependencyType:"child",childGroups:["numberLists"],variableNames:["nComponents"]},numberAndNumberListChildren:{dependencyType:"child",childGroups:["numbers","numberLists"],skipComponentNames:!0},parentNComponentsToDisplayByChild:{dependencyType:"parentStateVariable",parentComponentType:"numberList",variableName:"nComponentsToDisplayByChild"}}),definition:function({dependencyValues:e,componentInfoObjects:r,componentName:n}){let i=e.nComponents;e.parentNComponentsToDisplayByChild!==null&&(i=e.parentNComponentsToDisplayByChild[n]);let s={},o=0,l=0,u=0;for(let c of e.numberAndNumberListChildren){let p=Math.max(0,i-o);if(p>0&&l++,r.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"numberList"})){let m=e.numberListChildren[u];u++;let f=Math.min(p,m.stateValues.nComponents);s[m.componentName]=f,o+=f}else o+=1}return{setValue:{nComponentsToDisplayByChild:s,nChildrenToRender:l}}},markStale:()=>({updateRenderedChildren:!0})},t}};T(qa,"componentType","numberList"),T(qa,"rendererType","asList"),T(qa,"renderChildren",!0),T(qa,"includeBlankStringChildren",!0),T(qa,"removeBlankStringChildrenPostSugar",!0),T(qa,"stateVariableForAttributeValue","numbers");var So=class extends ce{static returnChildGroups(){return[{group:"inlines",componentTypes:["_inline"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.text={public:!0,componentType:"text",returnDependencies:()=>({inlineChildren:{dependencyType:"child",childGroups:["inlines"],variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r="";for(let n of e.inlineChildren)typeof n!="object"?r+=n.toString():typeof n.stateValues.text=="string"?r+=n.stateValues.text:r+=" ";return{setValue:{text:r}}}},t}};T(So,"componentType","p"),T(So,"renderChildren",!0),T(So,"includeBlankStringChildren",!0);var ma=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.unordered={createComponentOfType:"boolean",createStateVariable:"unordered",defaultValue:!1,public:!0},e.maximumNumber={createComponentOfType:"number",createStateVariable:"maximumNumber",defaultValue:null,public:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=Un({componentType:"boolean"}),r=Ha({componentType:"boolean"});return t.push({replacementFunction:function({matchedChildren:n,isAttributeComponent:i=!1,createdFromMacro:s=!1}){return i&&!s?e({matchedChildren:n}):r({matchedChildren:n})}}),t}static returnChildGroups(){return[{group:"booleans",componentTypes:["boolean"]},{group:"booleanLists",componentTypes:["booleanList"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({setValue:{overrideChildHide:!0}})},t.nComponents={public:!0,componentType:"number",additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies(){return{maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},booleanListChildren:{dependencyType:"child",childGroups:["booleanLists"],variableNames:["nComponents"]},booleanAndBooleanListChildren:{dependencyType:"child",childGroups:["booleans","booleanLists"],skipComponentNames:!0}}},definition:function({dependencyValues:e,componentInfoObjects:r}){let n=0,i=[],s=0;for(let[l,u]of e.booleanAndBooleanListChildren.entries())if(r.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"booleanList"})){let c=e.booleanListChildren[s];s++;for(let p=0;p<c.stateValues.nComponents;p++)i[n+p]=[l,p];n+=c.stateValues.nComponents}else i[n]=[l,0],n+=1;let o=e.maximumNumber;return o!==null&&n>o&&(n=o,i=i.slice(0,o)),{setValue:{nComponents:n,childIndexByArrayKey:i},checkForActualChange:{nComponents:!0}}}},t.booleans={public:!0,componentType:"boolean",isArray:!0,entryPrefixes:["boolean"],stateVariablesDeterminingDependencies:["childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={},i={childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"}};for(let s of e){let o=[],l="1";r.childIndexByArrayKey[s]&&(o=[r.childIndexByArrayKey[s][0]],l=r.childIndexByArrayKey[s][1]+1),n[s]={booleanAndBooleanListChildren:{dependencyType:"child",childGroups:["booleans","booleanLists"],variableNames:["value","boolean"+l],variablesOptional:!0,childIndices:o}}}return{globalDependencies:i,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=r[s].booleanAndBooleanListChildren[0];if(o)if(o.stateValues.value!==void 0)i[s]=o.stateValues.value;else{let l=e.childIndexByArrayKey[s][1]+1;i[s]=o.stateValues["boolean"+l]}}return{setValue:{booleans:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[];for(let l in e.booleans){if(!n[l])continue;let u=n[l].booleanAndBooleanListChildren[0];u&&(u.stateValues.value!==void 0?o.push({setDependency:i[l].booleanAndBooleanListChildren,desiredValue:e.booleans[l],childIndex:0,variableIndex:0}):o.push({setDependency:i[l].booleanAndBooleanListChildren,desiredValue:e.booleans[l],childIndex:0,variableIndex:1}))}return{success:!0,instructions:o}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"booleans"},t.componentNamesInList={returnDependencies:()=>({booleanAndBooleanListChildren:{dependencyType:"child",childGroups:["booleans","booleanLists"],variableNames:["componentNamesInList"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e,componentInfoObjects:r}){let n=[];for(let s of e.booleanAndBooleanListChildren)r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"booleanList"})?n.push(...s.stateValues.componentNamesInList):n.push(s.componentName);let i=e.maximumNumber;return i!==null&&n.length>i&&(i=Math.max(0,Math.floor(i)),n=n.slice(0,i)),{setValue:{componentNamesInList:n}}}},t.nComponentsToDisplayByChild={additionalStateVariablesDefined:["nChildrenToRender"],returnDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"},booleanListChildren:{dependencyType:"child",childGroups:["booleanLists"],variableNames:["nComponents"]},booleanAndBooleanListChildren:{dependencyType:"child",childGroups:["booleans","booleanLists"],skipComponentNames:!0},parentNComponentsToDisplayByChild:{dependencyType:"parentStateVariable",parentComponentType:"booleanList",variableName:"nComponentsToDisplayByChild"}}),definition:function({dependencyValues:e,componentInfoObjects:r,componentName:n}){let i=e.nComponents;e.parentNComponentsToDisplayByChild!==null&&(i=e.parentNComponentsToDisplayByChild[n]);let s={},o=0,l=0,u=0;for(let c of e.booleanAndBooleanListChildren){let p=Math.max(0,i-o);if(p>0&&l++,r.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"booleanList"})){let m=e.booleanListChildren[u];u++;let f=Math.min(p,m.stateValues.nComponents);s[m.componentName]=f,o+=f}else o+=1}return{setValue:{nComponentsToDisplayByChild:s,nChildrenToRender:l}}},markStale:()=>({updateRenderedChildren:!0})},t}};T(ma,"componentType","booleanList"),T(ma,"rendererType","asList"),T(ma,"renderChildren",!0),T(ma,"includeBlankStringChildren",!0),T(ma,"removeBlankStringChildrenPostSugar",!0),T(ma,"stateVariableForAttributeValue","booleans"),T(ma,"descendantCompositesMustHaveAReplacement",!1);var vi=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.disabled,delete e.modifyIndirectly,delete e.fixed,delete e.styleNumber,delete e.isResponse,e.assignNamesSkip={createPrimitiveOfType:"number"},e.prop={createPrimitiveOfType:"string"},e.obtainPropFromComposite={createPrimitiveOfType:"boolean",createStateVariable:"obtainPropFromComposite",defaultValue:!1,public:!0},e.componentType={createPrimitiveOfType:"string"},e.nComponents={createPrimitiveOfType:"number"},e.componentIndex={createComponentOfType:"number",createStateVariable:"componentIndex",defaultValue:null,public:!0},e.propIndex={createComponentOfType:"number",createStateVariable:"propIndex",defaultValue:null,public:!0},e.uri={createPrimitiveOfType:"string",createStateVariable:"uri",defaultValue:null,public:!0},e.targetAttributesToIgnore={createComponentOfType:"textList",createStateVariable:"targetAttributesToIgnore",defaultValue:["hide"],public:!0},e.targetAttributesToAlwaysIgnore={createComponentOfType:"textList",createStateVariable:"targetAttributesToAlwaysIgnore",defaultValue:["isResponse"],public:!0},e.link={createPrimitiveOfType:"boolean"},e.removeEmptyArrayEntries={createPrimitiveOfType:"boolean",createStateVariable:"removeEmptyArrayEntries",defaultValue:!1},e}static keepChildrenSerialized({serializedComponent:t}){return t.children===void 0?[]:Object.keys(t.children)}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.target={returnDependencies:()=>({target:{dependencyType:"doenetAttribute",attributeName:"target"}}),definition:({dependencyValues:e})=>({setValue:{target:e.target}})},t.targetSourcesName={additionalStateVariablesDefined:[{variableName:"sourcesChildNumber",hasEssential:!0,shadowVariable:!0}],stateVariablesDeterminingDependencies:["target"],determineDependenciesImmediately:!0,hasEssential:!0,shadowVariable:!0,returnDependencies:function({stateValues:e,sharedParameters:r}){let n=r.sourceNameMappings;if(!n)return{};let i=n[e.target];return i?{targetSourcesName:{dependencyType:"value",value:i.name},sourcesChildNumber:{dependencyType:"value",value:i.childNumber}}:{}},definition:function({dependencyValues:e}){let r=e.targetSourcesName,n=e.sourcesChildNumber;return r||(r=null,n=null),{setValue:{targetSourcesName:r,sourcesChildNumber:n},setEssentialValue:{targetSourcesName:r,sourcesChildNumber:n}}}},t.targetSources={stateVariablesDeterminingDependencies:["targetSourcesName"],determineDependenciesImmediately:!0,returnDependencies({stateValues:e}){return e.targetSourcesName?{targetSourcesComponent:{dependencyType:"componentIdentity",componentName:e.targetSourcesName}}:{}},definition:function({dependencyValues:e}){let r=e.targetSourcesComponent;return r||(r=null),{setValue:{targetSources:r}}}},t.sourceIndex={stateVariablesDeterminingDependencies:["target"],determineDependenciesImmediately:!0,hasEssential:!0,shadowVariable:!0,returnDependencies:function({stateValues:e,sharedParameters:r}){let n=r.sourceIndexMappings;if(!n)return{};let i=n[e.target];return i===void 0?{}:{sourceIndex:{dependencyType:"value",value:i}}},definition:function({dependencyValues:e}){let r=e.sourceIndex;return r===void 0&&(r=null),{setValue:{sourceIndex:r},setEssentialValue:{sourceIndex:r}}}},t.targetComponent={shadowVariable:!0,stateVariablesDeterminingDependencies:["targetSources","sourceIndex"],determineDependenciesImmediately:!0,returnDependencies({stateValues:e}){return e.sourceIndex!==null?{}:e.targetSources!==null?{targetSourcesChildren:{dependencyType:"stateVariable",componentName:e.targetSources.componentName,variableName:"childIdentities"},sourcesChildNumber:{dependencyType:"stateVariable",variableName:"sourcesChildNumber"}}:{targetComponent:{dependencyType:"targetComponent"}}},definition:function({dependencyValues:e}){let r=null;return e.targetSourcesChildren?(r=e.targetSourcesChildren[e.sourcesChildNumber],r||(r=null)):e.targetComponent&&(r=e.targetComponent),{setValue:{targetComponent:r}}}},t.targetInactive={stateVariablesDeterminingDependencies:["targetComponent"],returnDependencies({stateValues:e}){return e.targetComponent?{targetIsInactiveCompositeReplacement:{dependencyType:"stateVariable",componentName:e.targetComponent.componentName,variableName:"isInactiveCompositeReplacement"}}:{}},definition:function({dependencyValues:e}){return{setValue:{targetInactive:Boolean(e.targetIsInactiveCompositeReplacement)}}}},t.cid={additionalStateVariablesDefined:["doenetId"],returnDependencies:()=>({uri:{dependencyType:"stateVariable",variableName:"uri"}}),definition:function({dependencyValues:e}){if(!e.uri||e.uri.substring(0,7).toLowerCase()!=="doenet:")return{setValue:{cid:null,doenetId:null}};let r=null,n=null,i=e.uri.match(/[:&]cid=([^&]+)/i);return i&&(r=i[1]),i=e.uri.match(/[:&]doenetid=([^&]+)/i),i&&(n=i[1]),{setValue:{cid:r,doenetId:n}}}},t.serializedComponentsForCid={returnDependencies:()=>({cid:{dependencyType:"stateVariable",variableName:"cid"},serializedChildren:{dependencyType:"serializedChildren",doNotProxy:!0}}),definition:function({dependencyValues:e}){if(!e.cid)return{setValue:{serializedComponentsForCid:null}};let r=e.serializedChildren?.[0];if(!r)return{setValue:{serializedComponentsForCid:null}};let n=r.children,i={componentType:"externalContent",state:{rendered:!0},children:n,originalName:r.componentName,variants:r.variants};return r.attributes?.newNamespace?.primitive&&(i.attributes={newNamespace:{primitive:!0}}),{setValue:{serializedComponentsForCid:i}}}},t.propName={shadowVariable:!0,returnDependencies:()=>({propName:{dependencyType:"attributePrimitive",attributeName:"prop"}}),definition:function({dependencyValues:e}){return{setValue:{propName:e.propName}}}},t.isPlainMacro={returnDependencies:()=>({isPlainMacro:{dependencyType:"doenetAttribute",attributeName:"isPlainMacro"}}),definition:function({dependencyValues:e}){return{setValue:{isPlainMacro:e.isPlainMacro}}}},t.linkAttrForDetermineDeps={returnDependencies:()=>({linkAttr:{dependencyType:"attributePrimitive",attributeName:"link"}}),definition({dependencyValues:e}){let r;return e.linkAttr===null?r=!0:r=e.linkAttr,{setValue:{linkAttrForDetermineDeps:r}}}},t.replacementSourceIdentities={stateVariablesDeterminingDependencies:["targetComponent","componentIndex","propName","obtainPropFromComposite","linkAttrForDetermineDeps"],additionalStateVariablesDefined:["addLevelToAssignNames"],returnDependencies:function({stateValues:e,componentInfoObjects:r}){let n={},i=!1,s=!1;return e.targetComponent!==null&&(r.isCompositeComponent({componentType:e.targetComponent.componentType,includeNonStandard:!1})&&!(e.propName&&e.obtainPropFromComposite)&&(e.linkAttrForDetermineDeps?(s=!0,n.targets={dependencyType:"replacement",compositeName:e.targetComponent.componentName,recursive:!0,componentIndex:e.componentIndex}):i=!0),!s&&(e.componentIndex===null||e.componentIndex===1)&&(n.targets={dependencyType:"stateVariable",variableName:"targetComponent"})),n.addLevelToAssignNames={dependencyType:"value",value:i},n},definition({dependencyValues:e}){let r=null;return e.targets&&(r=e.targets,Array.isArray(r)||(r=[r])),{setValue:{replacementSourceIdentities:r,addLevelToAssignNames:e.addLevelToAssignNames}}}},t.effectivePropNameBySource={stateVariablesDeterminingDependencies:["replacementSourceIdentities","propName","isPlainMacro"],returnDependencies:function({stateValues:e,componentInfoObjects:r}){let n={replacementSourceIdentities:{dependencyType:"stateVariable",variableName:"replacementSourceIdentities"}};if(e.replacementSourceIdentities!==null)for(let[i,s]of e.replacementSourceIdentities.entries()){let o=e.propName;e.isPlainMacro&&(o=r.allComponentClasses[s.componentType].variableForPlainMacro),o&&(n["propName"+i]={dependencyType:"value",value:o})}return n},definition({dependencyValues:e}){let r=null;if(e.replacementSourceIdentities!==null){r=[];for(let n in e.replacementSourceIdentities)e["propName"+n]&&(r[n]=e["propName"+n])}return{setValue:{effectivePropNameBySource:r}}}},t.replacementSources={stateVariablesDeterminingDependencies:["replacementSourceIdentities","propName","propIndex","isPlainMacro","effectivePropNameBySource"],returnDependencies:function({stateValues:e}){let r={replacementSourceIdentities:{dependencyType:"stateVariable",variableName:"replacementSourceIdentities"}};if(!e.propName&&e.propIndex!==null)throw Error("You cannot specify a propIndex without specifying a prop.");if(e.replacementSourceIdentities!==null)for(let[n,i]of e.replacementSourceIdentities.entries()){let s=e.effectivePropNameBySource[n],o;s?o={dependencyType:"stateVariable",componentName:i.componentName,variableName:s,returnAsComponentObject:!0,variablesOptional:!0,propIndex:e.propIndex,caseInsensitiveVariableMatch:!0,publicStateVariablesOnly:!0,useMappedVariableNames:!0}:o={dependencyType:"componentIdentity",componentName:i.componentName},r["target"+n]=o}return r},definition({dependencyValues:e}){let r=null;if(e.replacementSourceIdentities!==null){r=[];for(let n in e.replacementSourceIdentities)e["target"+n]&&r.push(e["target"+n])}return{setValue:{replacementSources:r}}}},t.nComponentsSpecified={returnDependencies:()=>({nComponentsAttr:{dependencyType:"attributePrimitive",attributeName:"nComponents"},typeAttr:{dependencyType:"attributePrimitive",attributeName:"componentType"}}),definition({dependencyValues:e,componentInfoObjects:r}){let n;if(e.typeAttr){if(!(e.typeAttr in r.allComponentClasses))throw Error(`Invalid componentType ${e.typeAttr} of copy.`);e.nComponentsAttr!==null?n=e.nComponentsAttr:n=1}else{if(e.nComponentsAttr!==null)throw Error("You must specify a componentType when specifying nComponents for a copy.");n=null}return{setValue:{nComponentsSpecified:n}}}},t.link={returnDependencies:()=>({linkAttr:{dependencyType:"attributePrimitive",attributeName:"link"},serializedComponentsForCid:{dependencyType:"stateVariable",variableName:"serializedComponentsForCid"},replacementSourceIdentities:{dependencyType:"stateVariable",variableName:"replacementSourceIdentities"}}),definition({dependencyValues:e,componentInfoObjects:r}){let n;return e.linkAttr===null?e.serializedComponentsForCid||e.replacementSourceIdentities&&e.replacementSourceIdentities.some(i=>r.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"module"}))?n=!1:n=!0:n=e.linkAttr,{setValue:{link:n}}}},t.readyToExpandWhenResolved={stateVariablesDeterminingDependencies:["targetComponent","propName","obtainPropFromComposite","link"],returnDependencies({stateValues:e,componentInfoObjects:r}){let n={targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"},needsReplacementsUpdatedWhenStale:{dependencyType:"stateVariable",variableName:"needsReplacementsUpdatedWhenStale"},serializedComponentsForCid:{dependencyType:"stateVariable",variableName:"serializedComponentsForCid"},link:{dependencyType:"stateVariable",variableName:"link"}};return e.targetComponent&&r.isCompositeComponent({componentType:e.targetComponent.componentType,includeNonStandard:!1})&&!(e.propName&&e.obtainPropFromComposite)&&(n.targetReadyToExpandWhenResolved={dependencyType:"stateVariable",componentName:e.targetComponent.componentName,variableName:"readyToExpandWhenResolved"}),e.link===!1&&(n.replacementSources={dependencyType:"stateVariable",variableName:"replacementSources"}),n},definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t.needsReplacementsUpdatedWhenStale={stateVariablesDeterminingDependencies:["targetComponent","replacementSourceIdentities","effectivePropNameBySource","propName","obtainPropFromComposite","link","removeEmptyArrayEntries"],returnDependencies:function({stateValues:e,componentInfoObjects:r}){if(e.link===!1)return{};let n={targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"},targetInactive:{dependencyType:"stateVariable",variableName:"targetInactive"},replacementSourceIdentities:{dependencyType:"stateVariable",variableName:"replacementSourceIdentities"}};if(e.effectivePropNameBySource!==null){for(let[i,s]of e.effectivePropNameBySource.entries())if(s){let o=e.replacementSourceIdentities[i];n["sourceArraySize"+i]={dependencyType:"stateVariableArraySize",componentName:o.componentName,variableName:s,variablesOptional:!0,caseInsensitiveVariableMatch:!0},n["sourceComponentType"+i]={dependencyType:"stateVariableComponentType",componentName:o.componentName,variableName:s,variablesOptional:!0,caseInsensitiveVariableMatch:!0}}}return e.targetComponent!==null&&r.isCompositeComponent({componentType:e.targetComponent.componentType,includeNonStandard:!1})&&!(e.propName&&e.obtainPropFromComposite)&&(n.allReplacementIdentities={dependencyType:"replacement",compositeName:e.targetComponent.componentName,recursive:!0,variableNames:["isInactiveCompositeReplacement"]}),e.removeEmptyArrayEntries&&(n.replacementSources={dependencyType:"stateVariable",variableName:"replacementSources"}),n},markStale(){return{updateReplacements:!0}},definition:()=>({setValue:{needsReplacementsUpdatedWhenStale:!0}})},t.effectiveAssignNames={returnDependencies:()=>({assignNames:{dependencyType:"doenetAttribute",attributeName:"assignNames"},addLevelToAssignNames:{dependencyType:"stateVariable",variableName:"addLevelToAssignNames"}}),definition({dependencyValues:e}){let r=e.assignNames;return r&&e.addLevelToAssignNames&&(r=[r]),{setValue:{effectiveAssignNames:r}}}},t}static async createSerializedReplacements({component:t,components:e,workspace:r,componentInfoObjects:n,flags:i,resolveItem:s,publicCaseInsensitiveAliasSubstitutions:o}){r.numReplacementsBySource=[],r.numNonStringReplacementsBySource=[],r.propVariablesCopiedBySource=[],r.sourceNames=[],r.uniqueIdentifiersUsedBySource={};let l=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,u=this.createAttributesObject({flags:i}),c=await t.stateValues.effectiveAssignNames,p=await t.stateValues.serializedComponentsForCid;if(p){let S=[Re(p)];S[0].children&&vo({components:S[0].children,namespace:S[0].originalName+"/"});for(let R of S[0].children){if(typeof R!="object")continue;R.attributes||(R.attributes={});let O=Ze({attributes:t.attributes,componentType:R.componentType,componentInfoObjects:n,compositeAttributesObj:u,compositeCreatesNewNamespace:l,flags:i});for(let _ in O){let k=O[_];k.component?ys([k.component]):k.childrenForComponent&&ys(k.childrenForComponent)}Object.assign(R.attributes,O)}return S=de({assignNames:c,serializedComponents:S,parentName:t.componentName,parentCreatesNewNamespace:l,componentInfoObjects:n}).serializedComponents,{replacements:(await this.verifyReplacementsMatchSpecifiedType({component:t,replacements:S,workspace:r,componentInfoObjects:n,compositeAttributesObj:u,flags:i})).replacements}}let m=await t.stateValues.sourceIndex;if(m!==null){let S=Ze({attributes:t.attributes,componentType:"number",componentInfoObjects:n,compositeAttributesObj:u,compositeCreatesNewNamespace:l,flags:i}),x=de({assignNames:c,serializedComponents:[{componentType:"number",attributes:S,state:{value:m,fixed:!0}}],parentName:t.componentName,parentCreatesNewNamespace:l,componentInfoObjects:n});return{replacements:(await this.verifyReplacementsMatchSpecifiedType({component:t,replacements:x.serializedComponents,workspace:r,componentInfoObjects:n,compositeAttributesObj:u,flags:i})).replacements}}let f=await t.stateValues.replacementSourceIdentities;if(!await t.stateValues.targetComponent||!f)return{replacements:(await this.verifyReplacementsMatchSpecifiedType({component:t,replacements:[],workspace:r,componentInfoObjects:n,compositeAttributesObj:u})).replacements};let d=await s({componentName:t.componentName,type:"determineDependencies",stateVariable:"replacementSources",dependency:"__determine_dependencies",expandComposites:!1});if(!d.success)throw Error(`Couldn't resolve determineDependencies of replacementSources of ${t.componentName}`);let h=await t.stateValues.effectivePropNameBySource;for(let S in f)if(h[S]&&(d=await s({componentName:t.componentName,type:"recalculateDownstreamComponents",stateVariable:"replacementSources",dependency:"target"+S,expandComposites:!1}),!d.success))throw Error(`Couldn't resolve recalculateDownstreamComponents for target${S} of replacementSources of ${t.componentName}`);let y=[],b=[],g=[],v=0,A=0;for(let S in f){let w=r.uniqueIdentifiersUsedBySource[S]=[],x;if(t.attributes.componentType&&t.attributes.componentType.primitive){let _=await t.stateValues.nComponentsSpecified,k=f.length;x=Math.floor(_/k);let B=_%k;S<B&&x++}let R=await this.createReplacementForSource({component:t,sourceNum:S,components:e,numReplacementsSoFar:v,numNonStringReplacementsSoFar:A,uniqueIdentifiersUsed:w,compositeAttributesObj:u,componentInfoObjects:n,nComponentsForSource:x,publicCaseInsensitiveAliasSubstitutions:o,flags:i});r.propVariablesCopiedBySource[S]=R.propVariablesCopiedByReplacement;let O=R.serializedReplacements;b[S]=O.length,g[S]=O.filter(_=>typeof _!="string").length,v+=b[S],A+=g[S],y.push(...O)}return r.numReplacementsBySource=b,r.numNonStringReplacementsBySource=g,r.sourceNames=f.map(S=>S.componentName),{replacements:(await this.verifyReplacementsMatchSpecifiedType({component:t,replacements:y,workspace:r,componentInfoObjects:n,compositeAttributesObj:u,flags:i})).replacements}}static async verifyReplacementsMatchSpecifiedType({component:t,replacements:e,replacementChanges:r,workspace:n,componentInfoObjects:i,compositeAttributesObj:s,flags:o}){if(!t.attributes.componentType?.primitive&&!t.sharedParameters.compositesMustHaveAReplacement)return{replacements:e,replacementChanges:r};let l=t.replacementsToWithhold,u;if(!r)u=e.map(m=>m.componentType),u.length===1&&u[0]==="externalContent"&&(u=e[0].children.filter(m=>m.componentType||m.trim().length>0).map(m=>m.componentType));else{u=t.replacements.map(m=>m.componentType);for(let m of r)if(m.changeType==="add"){if(m.replacementsToWithhold!==void 0&&(l=m.replacementsToWithhold),!m.changeTopLevelReplacements)continue;if(m.serializedReplacements){let f=m.numberReplacementsToReplace;f>0||(f=0);let d=m.firstReplacementInd,h=m.serializedReplacements.map(y=>y.componentType);u.splice(d,f,...h)}}else if(m.changeType==="delete"){if(m.replacementsToWithhold!==void 0&&(l=m.replacementsToWithhold),m.changeTopLevelReplacements){let f=m.firstReplacementInd,d=m.numberReplacementsToDelete;u.splice(f,d)}}else m.changeType==="changeReplacementsToWithhold"&&m.replacementsToWithhold!==void 0&&(l=m.replacementsToWithhold)}if(l>0&&(u=u.slice(0,u.length-l)),!(t.attributes.componentType&&t.attributes.componentType.primitive)&&t.sharedParameters.compositesMustHaveAReplacement&&u.length>0)return{replacements:e,replacementChanges:r};let c=t.attributes.componentType;c&&(c=t.attributes.componentType.primitive);let p=await t.stateValues.nComponentsSpecified;if(!c){if(c=t.sharedParameters.compositesDefaultReplacementType,!c)throw Error("A component class specified descendantCompositesMustHaveAReplacement but didn't specify descendantCompositesDefaultReplacementType");p=1}if(u.length!==p||!u.every(m=>m===c)){n.numReplacementsBySource=[],n.numNonStringReplacementsBySource=[],n.propVariablesCopiedBySource=[],n.sourceNames=[],n.uniqueIdentifiersUsedBySource={};let m=n.uniqueIdentifiersUsedBySource[0]=[],f=t.attributes.newNamespace&&t.attributes.newNamespace.primitive;e=[];for(let h=0;h<p;h++){let y=Ze({attributes:t.attributes,componentType:c,componentInfoObjects:i,compositeAttributesObj:s,compositeCreatesNewNamespace:f,flags:o}),b=c+"|empty"+h,g=Oa(b,m);e.push({componentType:c,attributes:y,uniqueIdentifier:g})}if(e=de({assignNames:await t.stateValues.effectiveAssignNames,serializedComponents:e,parentName:t.componentName,parentCreatesNewNamespace:f,componentInfoObjects:i}).serializedComponents,n.numReplacementsBySource.push(e.length),n.numNonStringReplacementsBySource.push(e.filter(h=>typeof h!="string").length),r){r=[],t.replacementsToWithhold>0&&r.push({changeType:"changeReplacementsToWithhold",replacementsToWithhold:0});let h=0;t.replacements&&(h=t.replacements.length),r.push({changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:h,serializedReplacements:e})}}return{replacements:e,replacementChanges:r}}static async createReplacementForSource({component:t,sourceNum:e,components:r,numReplacementsSoFar:n,numNonStringReplacementsSoFar:i,uniqueIdentifiersUsed:s,compositeAttributesObj:o,componentInfoObjects:l,nComponentsForSource:u,publicCaseInsensitiveAliasSubstitutions:c,flags:p}){let m=(await t.stateValues.replacementSourceIdentities)[e];if(typeof m!="object")return{serializedReplacements:[m]};let f=r[m.componentName],d=await t.stateValues.link;(d===!1||await t.stateValues.removeEmptyArrayEntries)&&(m=(await t.stateValues.replacementSources)[e]);let h=t.attributes.newNamespace?.primitive,y=await t.stateValues.effectiveAssignNames,b=(await t.stateValues.effectivePropNameBySource)[e];if(b){let A=await bm({component:t,components:r,replacementSource:m,propName:b,numReplacementsSoFar:n,numNonStringReplacementsSoFar:i,uniqueIdentifiersUsed:s,compositeAttributesObj:o,componentInfoObjects:l,nComponentsForSource:u,publicCaseInsensitiveAliasSubstitutions:c,flags:p});return{serializedReplacements:de({assignNames:y,serializedComponents:A.serializedReplacements,parentName:t.componentName,parentCreatesNewNamespace:h,indOffset:i,componentInfoObjects:l}).serializedComponents,propVariablesCopiedByReplacement:A.propVariablesCopiedByReplacement}}let g=[await f.serialize({copyAll:!d,copyVariants:!d})];g=_r({serializedComponents:g,componentName:t.componentName,uniqueIdentifiersUsed:s,addShadowDependencies:d!==!1,unlinkExternalCopies:d===!1});for(let A of g){if(typeof A!="object")continue;A.attributes||(A.attributes={});let C=Ze({attributes:t.attributes,componentType:A.componentType,componentInfoObjects:l,compositeAttributesObj:o,compositeCreatesNewNamespace:h,flags:p});Object.assign(A.attributes,C)}return{serializedReplacements:de({assignNames:y,serializedComponents:g,parentName:t.componentName,parentCreatesNewNamespace:h,indOffset:i,componentInfoObjects:l,originalNamesAreConsistent:h&&!y}).serializedComponents}}static async calculateReplacementChanges({component:t,componentChanges:e,components:r,workspace:n,componentInfoObjects:i,flags:s,resolveItem:o,publicCaseInsensitiveAliasSubstitutions:l}){if(await t.stateValues.serializedComponentsForCid)return[];if(await t.stateValues.sourceIndex!==null)return[];let u=this.createAttributesObject({flags:s}),c=await t.stateValues.replacementSourceIdentities;if(!await t.stateValues.targetComponent||!c){if(await t.stateValues.targetSources)return[];{let w=[];if(t.replacements.length>0){let O={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToDelete:t.replacements.length};w.push(O)}let x=n.sourceNames.length===0;n.sourceNames=[],n.numReplacementsBySource=[],n.numNonStringReplacementsBySource=[],n.propVariablesCopiedBySource=[];let R=await this.verifyReplacementsMatchSpecifiedType({component:t,replacementChanges:w,workspace:n,componentInfoObjects:i,compositeAttributesObj:u,flags:s});return x?[]:R.replacementChanges}}if(await t.stateValues.targetInactive){let w=[],x=t.replacements.length;if(x>0){if(t.replacementsToWithhold!==x){let O={changeType:"changeReplacementsToWithhold",replacementsToWithhold:x};w.push(O)}w=(await this.verifyReplacementsMatchSpecifiedType({component:t,replacementChanges:w,workspace:n,componentInfoObjects:i,compositeAttributesObj:u,flags:s})).replacementChanges}return w}let p=await o({componentName:t.componentName,type:"determineDependencies",stateVariable:"replacementSources",dependency:"__determine_dependencies",expandComposites:!1});if(!p.success)throw Error(`Couldn't resolve determineDependencies of replacementSources of ${t.componentName}`);let m=await t.stateValues.effectivePropNameBySource;for(let w in c)if(m[w]&&(p=await o({componentName:t.componentName,type:"recalculateDownstreamComponents",stateVariable:"replacementSources",dependency:"target"+w,expandComposites:!1}),!p.success))throw Error(`Couldn't resolve recalculateDownstreamComponents for target${w} of replacementSources of ${t.componentName}`);let f=[];if(t.replacementsToWithhold>0){let w={changeType:"changeReplacementsToWithhold",replacementsToWithhold:0};f.push(w)}let d=0,h=0,y=[],b=[],g=[],v=Math.max(c.length,n.numReplacementsBySource.length),A=!1;for(let w=0;w<v;w++){let x;if(t.attributes.componentType&&t.attributes.componentType.primitive){let G=await t.stateValues.nComponentsSpecified,z=c.length;x=Math.floor(G/z);let Z=G%z;w<Z&&x++}let R=c[w];if(R===void 0){if(n.numReplacementsBySource[w]>0){if(!A){let G=n.numReplacementsBySource.slice(w).reduce((z,Z)=>z+Z,0);if(G>0){let z={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:d,numberReplacementsToDelete:G};f.push(z)}A=!0,n.numReplacementsBySource.slice(w).forEach((z,Z)=>n.numReplacementsBySource[Z]=0),n.numNonStringReplacementsBySource.slice(w).forEach((z,Z)=>n.numNonStringReplacementsBySource[Z]=0)}n.uniqueIdentifiersUsedBySource[w]=[]}y[w]=0,b[w]=0,g.push([]);continue}let O=n.sourceNames[w],_=O===void 0||R.componentName!==O||A;if(!_)for(let G=0;G<n.numReplacementsBySource[w];G++){let z=t.replacements[d+G];if(z){if(!m[w]&&z.shadows&&z.shadows.componentName!==c[w].componentName){_=!0;break}}else{_=!0;break}}if(_){let G=0;w in n.numReplacementsBySource&&(G=n.numReplacementsBySource[w]);let z=G;A&&(z=0);let Z=n.uniqueIdentifiersUsedBySource[w]=[],ne=await this.recreateReplacements({component:t,sourceNum:w,numReplacementsSoFar:d,numNonStringReplacementsSoFar:h,numReplacementsToDelete:z,components:r,uniqueIdentifiersUsed:Z,compositeAttributesObj:u,componentInfoObjects:i,nComponentsForSource:x,publicCaseInsensitiveAliasSubstitutions:l,flags:s});d+=ne.numReplacements,h+=ne.numNonStringReplacements,y[w]=ne.numReplacements,b[w]=ne.numNonStringReplacements,g[w]=ne.propVariablesCopiedByReplacement;let ve=ne.replacementInstruction;if(!A&&ne.numReplacements!==G){let xe=n.numReplacementsBySource.slice(w).reduce((ye,it)=>ye+it,0);ve.numberReplacementsToReplace=xe,A=!0,n.numReplacementsBySource.slice(w).forEach((ye,it)=>n.numReplacementsBySource[it]=0),n.numNonStringReplacementsBySource.slice(w).forEach((ye,it)=>n.numNonStringReplacementsBySource[it]=0)}f.push(ve);continue}if(!m[w]&&n.numReplacementsBySource[w]>0){d+=n.numReplacementsBySource[w],h+=n.numNonStringReplacementsBySource[w],y[w]=n.numReplacementsBySource[w],b[w]=n.numNonStringReplacementsBySource[w];continue}let k=n.uniqueIdentifiersUsedBySource[w]=[],B=await this.createReplacementForSource({component:t,sourceNum:w,components:r,numReplacementsSoFar:d,numNonStringReplacementsSoFar:h,uniqueIdentifiersUsed:k,compositeAttributesObj:u,componentInfoObjects:i,nComponentsForSource:x,publicCaseInsensitiveAliasSubstitutions:l,flags:s}),U=B.propVariablesCopiedByReplacement,H=B.serializedReplacements,j=H.length,P=n.numReplacementsBySource[w];if(j!==P){let G=n.numReplacementsBySource.slice(w).reduce((Z,ne)=>Z+ne,0),z={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:d,numberReplacementsToReplace:G,serializedReplacements:H,assignNamesOffset:h};f.push(z),A=!0,n.numReplacementsBySource.slice(w).forEach((Z,ne)=>n.numReplacementsBySource[ne]=0),n.numNonStringReplacementsBySource.slice(w).forEach((Z,ne)=>n.numNonStringReplacementsBySource[ne]=0)}else{let G=0;for(let z=0;z<j;z++){if(U[z].length!==n.propVariablesCopiedBySource[w][z].length||n.propVariablesCopiedBySource[w][z].some((Z,ne)=>Z!==U[z][ne])||t.replacements[d+z].componentType!==H[z].componentType){let Z={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:d+z,numberReplacementsToReplace:1,serializedReplacements:[H[z]],assignNamesOffset:h+G};f.push(Z)}typeof H[z]!="string"&&G++}}let F=H.filter(G=>typeof G!="string").length;d+=j,h+=F,y[w]=j,b[w]=F,g[w]=U}let C=n.sourceNames.length===0;n.numReplacementsBySource=y,n.numNonStringReplacementsBySource=b,n.sourceNames=c.map(w=>w.componentName),n.propVariablesCopiedBySource=g;let S=await this.verifyReplacementsMatchSpecifiedType({component:t,replacementChanges:f,workspace:n,componentInfoObjects:i,compositeAttributesObj:u,flags:s});return C&&n.sourceNames.length===0?[]:S.replacementChanges}static async recreateReplacements({component:t,sourceNum:e,numReplacementsSoFar:r,numNonStringReplacementsSoFar:n,numReplacementsToDelete:i,uniqueIdentifiersUsed:s,components:o,compositeAttributesObj:l,componentInfoObjects:u,nComponentsForSource:c,publicCaseInsensitiveAliasSubstitutions:p,flags:m}){let f=await this.createReplacementForSource({component:t,sourceNum:e,numReplacementsSoFar:r,numNonStringReplacementsSoFar:n,components:o,uniqueIdentifiersUsed:s,compositeAttributesObj:l,componentInfoObjects:u,nComponentsForSource:c,publicCaseInsensitiveAliasSubstitutions:p,flags:m}),d=f.propVariablesCopiedByReplacement,h=f.serializedReplacements,y={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:r,numberReplacementsToReplace:i,serializedReplacements:h,assignNamesOffset:n};return{numReplacements:h.length,numNonStringReplacements:h.filter(b=>typeof b!="string").length,propVariablesCopiedByReplacement:d,replacementInstruction:y}}};T(vi,"componentType","copy"),T(vi,"assignNamesToReplacements",!0),T(vi,"acceptTarget",!0),T(vi,"acceptAnyAttribute",!0),T(vi,"stateVariableToEvaluateAfterReplacements","needsReplacementsUpdatedWhenStale");async function bm({component:a,components:t,replacementSource:e,propName:r,uniqueIdentifiersUsed:n,compositeAttributesObj:i,componentInfoObjects:s,nComponentsForSource:o,publicCaseInsensitiveAliasSubstitutions:l,flags:u}){let c=[],p=[],m=a.attributes.newNamespace&&a.attributes.newNamespace.primitive,f=-1,d=t[e.componentName],h=l({stateVariables:[r],componentClass:d.constructor})[0];if(h===void 0||h.slice(0,12)==="__not_public")return console.warn(`Could not find prop ${r} on a component of type ${e.componentType}`),{serializedReplacements:[],propVariablesCopiedByReplacement:[]};let y=d.state[h],b=await y.value;if(y.isArray||y.isArrayEntry){let g,v,A,C;if(y.isArray?(g=y,A=await y.arraySize,v=y.getAllArrayKeys(A,!1)):(g=d.state[y.arrayStateVariable],v=await y.unflattenedArrayKeys,C=await y.arrayKeys),g.hasVariableComponentType&&(await a.stateValues.replacementSources,!g.componentType))return{serializedReplacements:[],propVariablesCopiedByReplacement:[]};let S=y.wrappingComponents,w=S.length,x=o;if(y.isArray)x=A.slice(0,A.length-w).reduce((R,O)=>R*O,1);else if(C.length===0)x=0;else if(w===0)x=C.length;else if(w>=y.nDimensions)x=1;else if(w===y.nDimensions-1)x=v.length;else{let R=y.nDimensions-w-1;x=S0(v,R).length}if(w===0){let R=vr(v);for(let O=0;O<x;O++){let _=R[O];if(await a.stateValues.removeEmptyArrayEntries){if(!_)continue;let U=g.keyToIndex(_);Array.isArray(U)||(U=[U]);let H=await g.value;for(let j of U)H=H[j];if(H==null)continue}f++;let k=p[f]=[],B=g.componentType;if(Array.isArray(B)&&(B[g.keyToIndex(_)]?B=B[g.keyToIndex(_)]:B=B[0]),_){let U=g.arrayVarNameFromArrayKey(_);k.push(U);let H=e.componentName+"|shadow|"+U,j=Oa(H,n),P=Ze({attributes:a.attributes,componentType:B,componentInfoObjects:s,compositeAttributesObj:i,compositeCreatesNewNamespace:m,flags:u});if(await a.stateValues.link!==!1)c.push({componentType:B,attributes:P,downstreamDependencies:{[e.componentName]:[{dependencyType:"referenceShadow",compositeName:a.componentName,propVariable:U}]},uniqueIdentifier:j});else{let F={};if(y.stateVariablesPrescribingAdditionalAttributes){let xe={};for(let it in y.stateVariablesPrescribingAdditionalAttributes){let gr=y.stateVariablesPrescribingAdditionalAttributes[it],ar=d.state[gr],mt=await ar.value;ar.isArray&&(mt=mt[ar.keyToIndex[_]]),d.state[gr].usedDefault||(xe[it]=mt)}let ye=Ze({attributes:xe,componentType:y.componentType,componentInfoObjects:s,flags:u});Object.assign(F,ye)}Object.assign(F,P);let G="value",z=s.allComponentClasses[B];z.primaryStateVariableForDefinition&&(G=z.primaryStateVariableForDefinition);let Z=g.keyToIndex(_);Array.isArray(Z)||(Z=[Z]);let ne=await g.value;for(let xe of Z)ne=ne[xe];let ve={componentType:B,attributes:F,state:{[G]:ne},uniqueIdentifier:j};c.push(ve)}}else{let U=B+"|empty",H=Oa(U,n);c.push({componentType:B,uniqueIdentifier:H})}}}else{let R=async function(k,B){let U=[],H=[];if(B>1)for(let P of k){let F=await R(P,B-1);U.push(...F.pieces),H.push(...F.propVariablesCopiedByPiece)}else for(let P of k){let F=g.arrayVarNameFromArrayKey(P),G=[F],z=e.componentName+"|shadow|"+F,Z=Oa(z,n),ne=g.componentType;if(Array.isArray(ne)&&(ne=ne[g.keyToIndex(P)]),await a.stateValues.link!==!1)U.push({componentType:ne,downstreamDependencies:{[e.componentName]:[{dependencyType:"referenceShadow",compositeName:a.componentName,propVariable:F}]},uniqueIdentifier:Z});else{let ve={};if(y.stateVariablesPrescribingAdditionalAttributes){let mt={};for(let pi in y.stateVariablesPrescribingAdditionalAttributes){let fs=y.stateVariablesPrescribingAdditionalAttributes[pi],Mn=d.state[fs],oa=await Mn.value;Mn.isArray&&(oa=oa[Mn.keyToIndex[P]]),d.state[fs].usedDefault||(mt[pi]=oa)}let jn=Ze({attributes:mt,componentType:y.componentType,componentInfoObjects:s,flags:u});Object.assign(ve,jn)}let xe="value",ye=s.allComponentClasses[ne];ye.primaryStateVariableForDefinition&&(xe=ye.primaryStateVariableForDefinition);let it=g.keyToIndex(P);Array.isArray(it)||(it=[it]);let gr=await g.value;for(let mt of it)gr=gr[mt];let ar={componentType:ne,attributes:ve,state:{[xe]:gr},uniqueIdentifier:Z};U.push(ar)}H.push(G)}let j=S[B-1];if(U.length>0&&j&&j.length>0){for(let P=j.length-1;P>=0;P--){let F=typeof j[P]=="object"?j[P].componentType:j[P],G=F+"|wrapper",z=Oa(G,n),Z=[],ne={};for(let ve of U)if(ve.isAttribute){let xe=ve.isAttribute;delete ve.isAttribute,ne[xe]={component:ve}}else Z.push(ve);U=[{componentType:F,children:Z,attributes:ne,uniqueIdentifier:z,skipSugar:!0}],typeof j[P]=="object"&&(j[P].doenetAttributes&&(U[0].doenetAttributes=Object.assign({},j[P].doenetAttributes)),j[P].isAttribute&&(U[0].isAttribute=j[P].isAttribute))}H=[vr(H)]}return{pieces:U,propVariablesCopiedByPiece:H}},O=await R(v,y.nDimensions),_=O.pieces;p=O.propVariablesCopiedByPiece;for(let k of _){if(typeof k!="object")continue;k.attributes||(k.attributes={});let B=Ze({attributes:a.attributes,componentType:k.componentType,componentInfoObjects:s,compositeAttributesObj:i,compositeCreatesNewNamespace:m,flags:u});Object.assign(k.attributes,B),await a.stateValues.link!==!1&&(k.downstreamDependencies={[e.componentName]:[{dependencyType:"referenceShadow",compositeName:a.componentName,propVariable:h,ignorePrimaryStateVariable:!0}]})}if(f+=_.length,c.push(..._),_.length<x)for(let k=_.length;k<x;k++){f++,p[f]=[];let B,U=S[0],H;U&&U.length>0?typeof U[0]=="object"?(B=U[0].componentType,H=Object.assign({},U[0].doenetAttributes)):B=U[0]:(B=g.componentType,Array.isArray(B)&&(y.isArrayEntry?B=B[g.keyToIndex(C[k])]:B=B[k]));let j=B+"|empty",P=Oa(j,n),F={componentType:B,uniqueIdentifier:P};H&&(F.doenetAttributes=H),c.push(F)}else if(_>x)throw Error(`Something went wrong when creating replacements for ${a.componentName} as we ended up with too many replacements`)}}else{if(y.hasVariableComponentType&&await y.value,!y.componentType)return{serializedReplacements:[],propVariablesCopiedByReplacement:[]};f++,(p[f]=[]).push(h);let v=d.componentName+"|shadow|"+h,A=Oa(v,n);if(y.componentType==="string")c.push(await y.value);else{let C=Ze({attributes:a.attributes,componentType:y.componentType,componentInfoObjects:s,compositeAttributesObj:i,compositeCreatesNewNamespace:m,flags:u});if(await a.stateValues.link!==!1)c.push({componentType:y.componentType,attributes:C,downstreamDependencies:{[d.componentName]:[{dependencyType:"referenceShadow",compositeName:a.componentName,propVariable:h}]},uniqueIdentifier:A});else{let S={};if(y.stateVariablesPrescribingAdditionalAttributes){let O={};for(let k in y.stateVariablesPrescribingAdditionalAttributes){let B=y.stateVariablesPrescribingAdditionalAttributes[k],U=await d.state[B].value;d.state[B].usedDefault||(O[k]=U)}let _=Ze({attributes:O,componentType:y.componentType,componentInfoObjects:s,flags:u});Object.assign(S,_)}Object.assign(S,C);let w="value",x=s.allComponentClasses[y.componentType];x.primaryStateVariableForDefinition&&(w=x.primaryStateVariableForDefinition);let R={componentType:y.componentType,attributes:S,state:{[w]:b},uniqueIdentifier:A};c.push(R)}}}return{serializedReplacements:c,propVariablesCopiedByReplacement:p}}var vs=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.disabled,delete e.modifyIndirectly,delete e.fixed,delete e.styleNumber,delete e.isResponse,e.assignNamesSkip={createPrimitiveOfType:"number"},e.prop={createPrimitiveOfType:"string"},e.componentType={createPrimitiveOfType:"string"},e.nComponents={createPrimitiveOfType:"number"},e.componentIndex={createComponentOfType:"number",createStateVariable:"componentIndex",defaultValue:null,public:!0},e.propIndex={createComponentOfType:"number",createStateVariable:"propIndex",defaultValue:null,public:!0},e}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.propName={shadowVariable:!0,returnDependencies:()=>({propName:{dependencyType:"attributePrimitive",attributeName:"prop"}}),definition:function({dependencyValues:e}){return{setValue:{propName:e.propName}}}},t.sourceComponents={stateVariablesDeterminingDependencies:["propName","componentIndex","propIndex"],returnDependencies:({stateValues:e})=>({children:{dependencyType:"child",childGroups:["anything"],variableNames:[e.propName],variablesOptional:!0,componentIndex:e.componentIndex,propIndex:e.propIndex,publicCaseInsensitiveVariableMatch:!0,useMappedVariableNames:!0}}),definition:({dependencyValues:e})=>({setValue:{sourceComponents:e.children}})},t.readyToExpandWhenResolved={returnDependencies:()=>({replacementClasses:{dependencyType:"stateVariable",variableName:"sourceComponents"},needsReplacementsUpdatedWhenStale:{dependencyType:"stateVariable",variableName:"needsReplacementsUpdatedWhenStale"}}),definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t.needsReplacementsUpdatedWhenStale={returnDependencies(){return{sourceComponents:{dependencyType:"stateVariable",variableName:"sourceComponents"}}},markStale:()=>({updateReplacements:!0}),definition:()=>({setValue:{needsReplacementsUpdatedWhenStale:!0}})},t}static async createSerializedReplacements({component:t,components:e,workspace:r,componentInfoObjects:n,flags:i,publicCaseInsensitiveAliasSubstitutions:s}){let o=[],l=[],u=0;r.propVariablesCopiedBySource=[],r.uniqueIdentifiersUsedBySource={};let c=this.createAttributesObject({flags:i}),p=await t.stateValues.sourceComponents;for(let m=0;m<p.length;m++)if(p[m]!==void 0){let f=r.uniqueIdentifiersUsedBySource[m]=[],d=await this.createReplacementForSource({component:t,sourceNum:m,components:e,numReplacementsSoFar:u,uniqueIdentifiersUsed:f,componentInfoObjects:n,compositeAttributesObj:c,publicCaseInsensitiveAliasSubstitutions:s});r.propVariablesCopiedBySource[m]=d.propVariablesCopiedByReplacement;let h=d.serializedReplacements;l[m]=h.length,u+=h.length,o.push(...h)}else l[m]=0;return r.numReplacementsBySource=l,r.sourceNames=p.map(m=>m.componentName),{replacements:o}}static async createReplacementForSource({component:t,components:e,sourceNum:r,numReplacementsSoFar:n,uniqueIdentifiersUsed:i,componentInfoObjects:s,compositeAttributesObj:o,publicCaseInsensitiveAliasSubstitutions:l}){let u=await bm({component:t,components:e,replacementSource:(await t.stateValues.sourceComponents)[r],propName:await t.stateValues.propName,uniqueIdentifiersUsed:i,compositeAttributesObj:o,componentInfoObjects:s,publicCaseInsensitiveAliasSubstitutions:l}),c=u.serializedReplacements,p=u.propVariablesCopiedByReplacement,m=t.attributes.newNamespace&&t.attributes.newNamespace.primitive;return c=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:c,parentName:t.componentName,indOffset:n,parentCreatesNewNamespace:m,componentInfoObjects:s}).serializedComponents,{serializedReplacements:c,propVariablesCopiedByReplacement:p}}static async calculateReplacementChanges({component:t,components:e,workspace:r,componentInfoObjects:n,flags:i,publicCaseInsensitiveAliasSubstitutions:s}){let o=[],l=0,u=[],c=[],p=this.createAttributesObject({flags:i}),m=await t.stateValues.sourceComponents,f=Math.max(m.length,r.numReplacementsBySource.length),d=!1;for(let h=0;h<f;h++){let y=m[h];if(y===void 0){if(r.numReplacementsBySource[h]>0){if(!d){let R=r.numReplacementsBySource.slice(h).reduce((O,_)=>O+_,0);if(R>0){let O={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:l,numberReplacementsToDelete:R};o.push(O)}d=!0,r.numReplacementsBySource.slice(h).forEach((O,_)=>r.numReplacementsBySource[_]=0)}r.uniqueIdentifiersUsedBySource[h]=[]}u[h]=0,c.push([]);continue}let b=r.sourceNames[h],g=b===void 0||y.componentName!==b||d;if(!g){for(let R=0;R<r.numReplacementsBySource[h];R++)if(!t.replacements[l+R]){g=!0;break}}if(g){let R=0;b!==void 0&&(R=r.numReplacementsBySource[h]);let O=R;d&&(O=0);let _=r.uniqueIdentifiersUsedBySource[h]=[],k=await this.recreateReplacements({component:t,sourceNum:h,numReplacementsSoFar:l,numReplacementsToDelete:O,components:e,uniqueIdentifiersUsed:_,componentInfoObjects:n,compositeAttributesObj:p,publicCaseInsensitiveAliasSubstitutions:s});l+=k.numReplacements,u[h]=k.numReplacements,c[h]=k.propVariablesCopiedByReplacement;let B=k.replacementInstruction;if(!d&&k.numReplacements!==R){let U=r.numReplacementsBySource.slice(h).reduce((H,j)=>H+j,0);B.numberReplacementsToReplace=U,d=!0,r.numReplacementsBySource.slice(h).forEach((H,j)=>r.numReplacementsBySource[j]=0)}o.push(B);continue}let v=r.uniqueIdentifiersUsedBySource[h]=[],A=await this.createReplacementForSource({component:t,sourceNum:h,components:e,numReplacementsSoFar:l,uniqueIdentifiersUsed:v,componentInfoObjects:n,compositeAttributesObj:p,publicCaseInsensitiveAliasSubstitutions:s}),C=A.propVariablesCopiedByReplacement,S=A.serializedReplacements,w=S.length,x=r.numReplacementsBySource[h];if(w!==x){let R=r.numReplacementsBySource.slice(h).reduce((_,k)=>_+k,0),O={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:l,numberReplacementsToReplace:R,serializedReplacements:S,assignNamesOffset:l};o.push(O),d=!0,r.numReplacementsBySource.slice(h).forEach((_,k)=>r.numReplacementsBySource[k]=0)}else for(let R=0;R<w;R++)if(C[R].length!==r.propVariablesCopiedBySource[h][R].length||r.propVariablesCopiedBySource[h][R].some((O,_)=>O!==C[R][_])){let O={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:l+R,numberReplacementsToReplace:1,serializedReplacements:[S[R]],assignNamesOffset:l+R};o.push(O)}l+=w,u[h]=w,c[h]=C}return r.numReplacementsBySource=u,r.sourceNames=m.map(h=>h.componentName),r.propVariablesCopiedBySource=c,o}static async recreateReplacements({component:t,sourceNum:e,numReplacementsSoFar:r,numReplacementsToDelete:n,uniqueIdentifiersUsed:i,components:s,componentInfoObjects:o,compositeAttributesObj:l,publicCaseInsensitiveAliasSubstitutions:u}){let c=await this.createReplacementForSource({component:t,sourceNum:e,numReplacementsSoFar:r,components:s,uniqueIdentifiersUsed:i,componentInfoObjects:o,compositeAttributesObj:l,publicCaseInsensitiveAliasSubstitutions:u}),p=c.propVariablesCopiedByReplacement,m=c.serializedReplacements,f={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:r,numberReplacementsToReplace:n,serializedReplacements:m,assignNamesOffset:r};return{numReplacements:m.length,propVariablesCopiedByReplacement:p,replacementInstruction:f}}};T(vs,"componentType","extract"),T(vs,"assignNamesToReplacements",!0),T(vs,"acceptAnyAttribute",!0),T(vs,"stateVariableToEvaluateAfterReplacements","needsReplacementsUpdatedWhenStale");var Ti=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.disabled,delete e.modifyIndirectly,delete e.fixed,delete e.styleNumber,delete e.isResponse,e.assignNamesSkip={createPrimitiveOfType:"number"},e.prop={createPrimitiveOfType:"string"},e.maximumNumber={createComponentOfType:"number",createStateVariable:"maximumNumber",defaultValue:null,public:!0},e.componentIndex={createComponentOfType:"number",createStateVariable:"componentIndex",defaultValue:null,public:!0},e.propIndex={createComponentOfType:"number",createStateVariable:"propIndex",defaultValue:null,public:!0},e.targetAttributesToIgnore={createComponentOfType:"textList",createStateVariable:"targetAttributesToIgnore",defaultValue:[],public:!0},e.targetAttributesToAlwaysIgnore={createComponentOfType:"textList",createStateVariable:"targetAttributesToAlwaysIgnore",defaultValue:["isResponse"],public:!0},e.componentTypes={createComponentOfType:"textList"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.targetComponent={shadowVariable:!0,returnDependencies:()=>({targetComponent:{dependencyType:"targetComponent"}}),definition:function({dependencyValues:e}){return{setValue:{targetComponent:e.targetComponent}}}},t.targetInactive={stateVariablesDeterminingDependencies:["targetComponent"],returnDependencies({stateValues:e}){return e.targetComponent?{targetIsInactiveCompositeReplacement:{dependencyType:"stateVariable",componentName:e.targetComponent.componentName,variableName:"isInactiveCompositeReplacement"}}:{}},definition:function({dependencyValues:e}){return{setValue:{targetInactive:Boolean(e.targetIsInactiveCompositeReplacement)}}}},t.targetName={returnDependencies:()=>({targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"}}),definition:function({dependencyValues:e}){return e.targetComponent===null?(console.warn("No copy target"),{setValue:{targetName:""}}):{setValue:{targetName:e.targetComponent.componentName}}}},t.propName={shadowVariable:!0,returnDependencies:()=>({propName:{dependencyType:"attributePrimitive",attributeName:"prop"}}),definition:function({dependencyValues:e}){return{setValue:{propName:e.propName}}}},t.componentTypesToCollect={shadowVariable:!0,additionalStateVariablesDefined:[{variableName:"componentClassesToCollect",shadowVariable:!0}],returnDependencies:()=>({componentTypesAttr:{dependencyType:"attributeComponent",attributeName:"componentTypes",variableNames:["texts"]}}),definition:function({dependencyValues:e,componentInfoObjects:r}){let n=[],i=[];if(e.componentTypesAttr!==null)for(let s of e.componentTypesAttr.stateValues.texts){let o=r.componentTypeLowerCaseMapping[s.toLowerCase()],l=r.allComponentClasses[o];if(l)n.push(o),i.push(l);else{let u="Cannot collect component type "+s+". Component type not found.";console.warn(u)}}return{setValue:{componentTypesToCollect:n,componentClassesToCollect:i}}}},t.collectedComponents={stateVariablesDeterminingDependencies:["componentTypesToCollect","targetName","propName","componentIndex","propIndex"],returnDependencies:function({stateValues:e}){if(!e.targetName)return{};let r={dependencyType:"descendant",ancestorName:e.targetName,componentTypes:e.componentTypesToCollect,useReplacementsForComposites:!0,includeNonActiveChildren:!0,recurseToMatchedChildren:!1,componentIndex:e.componentIndex};return e.propName&&(r.variableNames=[e.propName],r.variablesOptional=!0,r.componentIndex=e.componentIndex,r.propIndex=e.propIndex,r.publicCaseInsensitiveVariableMatch=!0,r.useMappedVariableNames=!0),{descendants:r,maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}},definition:function({dependencyValues:e}){let r=e.descendants;if(r||(r=[]),e.maximumNumber!==null&&r.length>e.maximumNumber){let n=Math.max(0,Math.floor(e.maximumNumber));r=r.slice(0,n)}return{setValue:{collectedComponents:r}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({collectedComponents:{dependencyType:"stateVariable",variableName:"collectedComponents"},needsReplacementsUpdatedWhenStale:{dependencyType:"stateVariable",variableName:"needsReplacementsUpdatedWhenStale"}}),definition:()=>({setValue:{readyToExpandWhenResolved:!0}})},t.needsReplacementsUpdatedWhenStale={returnDependencies(){return{collectedComponents:{dependencyType:"stateVariable",variableName:"collectedComponents"}}},markStale(){return{updateReplacements:!0}},definition(){return{setValue:{needsReplacementsUpdatedWhenStale:!0}}}},t}static async createSerializedReplacements({component:t,components:e,workspace:r,componentInfoObjects:n,nComponentsForSource:i,publicCaseInsensitiveAliasSubstitutions:s,flags:o}){if(!await t.stateValues.targetComponent)return{replacements:[]};let l=[],u=[],c=0,p=[];r.propVariablesCopiedByCollected=[],r.uniqueIdentifiersUsedByCollected={};let m=this.createAttributesObject({}),f=await t.stateValues.collectedComponents;for(let d=0;d<f.length;d++)if(f[d]){let h=r.uniqueIdentifiersUsedByCollected[d]=[],y=await this.createReplacementForCollected({component:t,collectedNum:d,components:e,numReplacementsSoFar:c,uniqueIdentifiersUsed:h,componentInfoObjects:n,compositeAttributesObj:m,nComponentsForSource:i,publicCaseInsensitiveAliasSubstitutions:s,flags:o});r.propVariablesCopiedByCollected[d]=y.propVariablesCopiedByReplacement;let b=y.serializedReplacements;u[d]=b.length,c+=b.length,l.push(...b),p[d]=b.map(g=>g.componentName)}else u[d]=0,p[d]=[],r.propVariablesCopiedByCollected[d]=[];return r.numReplacementsByCollected=u,r.collectedNames=f.map(d=>d.componentName),r.replacementNamesByCollected=p,{replacements:l}}static async createReplacementForCollected({component:t,components:e,collectedNum:r,numReplacementsSoFar:n,uniqueIdentifiersUsed:i,componentInfoObjects:s,compositeAttributesObj:o,nComponentsForSource:l,publicCaseInsensitiveAliasSubstitutions:u,flags:c}){let p=(await t.stateValues.collectedComponents)[r],m=p.componentName,f=e[m],d=[],h=[];if(!f)return{serializedReplacements:d,propVariablesCopiedByReplacement:h};let y=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,b=await t.stateValues.propName;if(b){let v=await bm({component:t,components:e,replacementSource:p,propName:b,uniqueIdentifiersUsed:i,compositeAttributesObj:o,componentInfoObjects:s,nComponentsForSource:l,publicCaseInsensitiveAliasSubstitutions:u});d=v.serializedReplacements,h=v.propVariablesCopiedByReplacement}else{let v=[await f.serialize()];d=_r({serializedComponents:v,componentName:t.componentName,uniqueIdentifiersUsed:i,identifierPrefix:r+"|"});for(let A of d){A.attributes||(A.attributes={});let C=Ze({attributes:t.attributes,componentType:A.componentType,componentInfoObjects:s,compositeAttributesObj:o,compositeCreatesNewNamespace:y,flags:c});Object.assign(A.attributes,C)}}return d=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:d,parentName:t.componentName,indOffset:n,parentCreatesNewNamespace:y,componentInfoObjects:s}).serializedComponents,{serializedReplacements:d,propVariablesCopiedByReplacement:h}}static async calculateReplacementChanges({component:t,componentChanges:e,components:r,workspace:n,componentInfoObjects:i,nComponentsForSource:s,publicCaseInsensitiveAliasSubstitutions:o,flags:l}){let u=0;for(let v=0;v<n.numReplacementsByCollected.length;v++){let A=[];for(let[C,S]of n.replacementNamesByCollected[v].entries())!t.replacements[u]||t.replacements[u].componentName!==S?A.push(C):u++;for(let C of A.reverse())n.replacementNamesByCollected[v].splice(C,1),n.propVariablesCopiedByCollected[v].splice(C,1);n.numReplacementsByCollected[v]-=A.length}let c=[],p=0,m=[],f=[],d=[],h=await t.stateValues.collectedComponents,y=Math.max(h.length,n.numReplacementsByCollected.length),b=!1,g=this.createAttributesObject({});for(let v=0;v<y;v++){let A=h[v];if(A===void 0){if(n.numReplacementsByCollected[v]>0){if(!b){let k=n.numReplacementsByCollected.slice(v).reduce((B,U)=>B+U,0);if(k>0){let B={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:p,numberReplacementsToDelete:k};c.push(B)}b=!0,n.numReplacementsByCollected.slice(v).forEach((B,U)=>n.numReplacementsByCollected[U]=0)}n.uniqueIdentifiersUsedByCollected[v]=[]}m[v]=0,f.push([]),d.push([]);continue}let C=n.collectedNames[v];if(C===void 0||A.componentName!==C||b){let k=0;C!==void 0&&(k=n.numReplacementsByCollected[v]);let B=k;b&&(B=0);let U=n.uniqueIdentifiersUsedByCollected[v]=[],H=await this.recreateReplacements({component:t,collectedNum:v,numReplacementsSoFar:p,numReplacementsToDelete:B,components:r,uniqueIdentifiersUsed:U,componentInfoObjects:i,compositeAttributesObj:g,nComponentsForSource:s,publicCaseInsensitiveAliasSubstitutions:o,flags:l});p+=H.numReplacements,m[v]=H.numReplacements,f[v]=H.propVariablesCopiedByReplacement;let j=H.replacementInstruction;if(d[v]=j.serializedReplacements.map(P=>P.componentName),!b&&H.numReplacements!==k){let P=n.numReplacementsByCollected.slice(v).reduce((F,G)=>F+G,0);j.numberReplacementsToReplace=P,b=!0,n.numReplacementsByCollected.slice(v).forEach((F,G)=>n.numReplacementsByCollected[G]=0)}c.push(j);continue}if(!await t.stateValues.propName){p+=n.numReplacementsByCollected[v],m[v]=n.numReplacementsByCollected[v],d[v]=n.replacementNamesByCollected[v],f[v]=[];continue}let S=n.uniqueIdentifiersUsedByCollected[v]=[],w=await this.createReplacementForCollected({component:t,collectedNum:v,components:r,numReplacementsSoFar:p,uniqueIdentifiersUsed:S,componentInfoObjects:i,compositeAttributesObj:g,nComponentsForSource:s,publicCaseInsensitiveAliasSubstitutions:o,flags:l}),x=w.propVariablesCopiedByReplacement,R=w.serializedReplacements,O=R.length,_=n.numReplacementsByCollected[v];if(O!==_){let k=n.numReplacementsByCollected.slice(v).reduce((U,H)=>U+H,0),B={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:p,numberReplacementsToReplace:k,serializedReplacements:R,assignNamesOffset:p};c.push(B),b=!0,n.numReplacementsByCollected.slice(v).forEach((U,H)=>n.numReplacementsByCollected[H]=0)}else for(let k=0;k<O;k++)if(x[k].length!==n.propVariablesCopiedByCollected[v][k].length||n.propVariablesCopiedByCollected[v][k].some((B,U)=>B!==x[k][U])){let B={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:p+k,numberReplacementsToReplace:1,serializedReplacements:[R[k]],assignNamesOffset:p+k};c.push(B)}p+=O,m[v]=O,f[v]=x,d[v]=R.map(k=>k.componentName)}return n.numReplacementsByCollected=m,n.collectedNames=h.map(v=>v.componentName),n.propVariablesCopiedByCollected=f,n.replacementNamesByCollected=d,c}static async recreateReplacements({component:t,collectedNum:e,numReplacementsSoFar:r,numReplacementsToDelete:n,uniqueIdentifiersUsed:i,components:s,componentInfoObjects:o,compositeAttributesObj:l,nComponentsForSource:u,publicCaseInsensitiveAliasSubstitutions:c,flags:p}){let m=await this.createReplacementForCollected({component:t,collectedNum:e,components:s,numReplacementsSoFar:r,uniqueIdentifiersUsed:i,componentInfoObjects:o,compositeAttributesObj:l,nComponentsForSource:u,publicCaseInsensitiveAliasSubstitutions:c,flags:p}),f=m.propVariablesCopiedByReplacement,d=m.serializedReplacements,h={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:r,numberReplacementsToReplace:n,serializedReplacements:d,assignNamesOffset:r};return{numReplacements:d.length,propVariablesCopiedByReplacement:f,replacementInstruction:h}}};T(Ti,"componentType","collect"),T(Ti,"assignNamesToReplacements",!0),T(Ti,"acceptTarget",!0),T(Ti,"acceptAnyAttribute",!0),T(Ti,"stateVariableToEvaluateAfterReplacements","needsReplacementsUpdatedWhenStale");var wo=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.textType={createComponentOfType:"text",createStateVariable:"textType",defaultValue:"type-global",public:!0},e.uri={createPrimitiveOfType:"string",createStateVariable:"uri",defaultValue:null,public:!0,forRenderer:!0},e.createButton={createComponentOfType:"boolean",createStateVariable:"createButton",defaultValue:!1,forRenderer:!0},e}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.targetComponent={returnDependencies:()=>({targetComponent:{dependencyType:"targetComponent"}}),definition:function({dependencyValues:e}){return{setValue:{targetComponent:e.targetComponent}}}},t.targetInactive={stateVariablesDeterminingDependencies:["targetComponent"],returnDependencies({stateValues:e}){return e.targetComponent?{targetIsInactiveCompositeReplacement:{dependencyType:"stateVariable",componentName:e.targetComponent.componentName,variableName:"isInactiveCompositeReplacement"}}:{}},definition:function({dependencyValues:e}){return{setValue:{targetInactive:Boolean(e.targetIsInactiveCompositeReplacement)}}}},t.targetName={forRenderer:!0,returnDependencies:()=>({targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"},uri:{dependencyType:"stateVariable",variableName:"uri"},targetInactive:{dependencyType:"stateVariable",variableName:"targetInactive"}}),definition:function({dependencyValues:e}){return e.targetComponent===null||e.targetInactive?{setValue:{targetName:""}}:e.uri!==null?(console.warn("Haven't implemented ref with uri and target, ignoring target."),{setValue:{targetName:""}}):{setValue:{targetName:e.targetComponent.componentName}}}},t.cid={forRenderer:!0,additionalStateVariablesDefined:[{variableName:"doenetId",forRenderer:!0}],returnDependencies:()=>({uri:{dependencyType:"stateVariable",variableName:"uri"}}),definition:function({dependencyValues:e}){if(!e.uri||e.uri.substring(0,7).toLowerCase()!=="doenet:")return{setValue:{cid:null,doenetId:null}};let r=null,n=null,i=e.uri.match(/[:&]cid=([^&]+)/i);return i&&(r=i[1]),i=e.uri.match(/[:&]doenetid=([^&]+)/i),i&&(n=i[1]),{setValue:{cid:r,doenetId:n}}}},t.linkText={public:!0,componentType:"text",forRenderer:!0,stateVariablesDeterminingDependencies:["targetName"],returnDependencies({stateValues:e}){let r={allChildren:{dependencyType:"child",childGroups:["anything"],variableNames:["text"],variablesOptional:!0},uri:{dependencyType:"stateVariable",variableName:"uri"},targetInactive:{dependencyType:"stateVariable",variableName:"targetInactive"}};return e.targetName&&(r.equationTag={dependencyType:"stateVariable",componentName:e.targetName,variableName:"equationTag",variablesOptional:!0},r.title={dependencyType:"stateVariable",componentName:e.targetName,variableName:"title",variablesOptional:!0}),r},definition:function({dependencyValues:e}){let r="";if(e.allChildren.length===0)e.uri!==null?r=e.uri:e.targetInactive||(e.title!==null?r=e.title:e.equationTag!==null&&(r="("+e.equationTag+")"));else for(let n of e.allChildren)typeof n!="object"?r+=n.toString():typeof n.stateValues.text=="string"&&(r+=n.stateValues.text);return r||(r="???"),{setValue:{linkText:r}}}},t}};T(wo,"componentType","ref"),T(wo,"renderChildren",!0),T(wo,"acceptTarget",!0);var Cu=class extends ot{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.createVectors={createComponentOfType:"boolean",createStateVariable:"createVectors",defaultValue:!0,public:!0},e}};T(Cu,"componentType","coords"),T(Cu,"rendererType","math");import gm from"math-expressions";var vm=class extends Ge{actions={moveLineSegment:this.moveLineSegment.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.endpoints={createComponentOfType:"_pointListComponent"},e.showCoordsWhenDragging={createComponentOfType:"boolean",createStateVariable:"showCoordsWhenDragging",defaultValue:!0,public:!0,forRenderer:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let r="";return e.selectedStyle.lineWidth>=4?r+="thick ":e.selectedStyle.lineWidth<=1&&(r+="thin "),e.selectedStyle.lineStyle==="dashed"?r+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=e.selectedStyle.lineColor,{setValue:{styleDescription:r}}}},t.nDimensions={public:!0,componentType:"number",returnDependencies:()=>({endpointsAttr:{dependencyType:"attributeComponent",attributeName:"endpoints",variableNames:["nDimensions"]}}),definition:function({dependencyValues:e}){return e.endpointsAttr!==null?{setValue:{nDimensions:e.endpointsAttr.stateValues.nDimensions},checkForActualChange:{nDimensions:!0}}:{setValue:{nDimensions:2}}}},t.endpoints={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["endpointX","endpoint"],hasEssential:!0,set:se,defaultValueByArrayKey:e=>gm.fromAst(e==="0,0"?1:0),returnWrappingComponents(e){return e==="endpointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="endpointX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[2,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let[i,s]=n.split(","),o=Number(i)+1+"_"+(Number(s)+1);r[n]={endpointsAttr:{dependencyType:"attributeComponent",attributeName:"endpoints",variableNames:["pointX"+o]}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r,arraySize:n}){let i={},s={};for(let l of r){let[u,c]=l.split(","),p=Number(u)+1+"_"+(Number(c)+1);e[l].endpointsAttr!==null&&e[l].endpointsAttr.stateValues["pointX"+p]?i[l]=e[l].endpointsAttr.stateValues["pointX"+p]:s[l]=!0}let o={};return Object.keys(i).length>0&&(o.setValue={endpoints:i}),Object.keys(s).length>0&&(o.useEssentialOrDefaultValue={endpoints:s}),o},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:r,dependencyNamesByKey:n,initialChange:i,stateValues:s}){if(i&&!await s.draggable)return{success:!1};let o=[];for(let l in e.endpoints){let[u,c]=l.split(","),p=Number(u)+1+"_"+(Number(c)+1);r[l].endpointsAttr!==null&&r[l].endpointsAttr.stateValues["pointX"+p]?o.push({setDependency:n[l].endpointsAttr,desiredValue:e.endpoints[l],childIndex:0,variableIndex:0}):o.push({setEssentialValue:"endpoints",value:{[l]:e.endpoints[l]}})}return{success:!0,instructions:o}}},t.numericalEndpoints={isArray:!0,entryPrefixes:["numericalEndpoint"],forRenderer:!0,returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return Number.isNaN(e.nDimensions)?[0]:[2]},returnArrayDependenciesByKey({arrayKeys:e}){let r={nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}},n={};for(let i of e)n[i]={endpoint:{dependencyType:"stateVariable",variableName:"endpoint"+(Number(i)+1)}};return{globalDependencies:r,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){if(Number.isNaN(e.nDimensions))return{};let i={};for(let s of n){let o=r[s].endpoint,l=[];for(let u=0;u<e.nDimensions;u++){let c=o[u].evaluate_to_constant();Number.isFinite(c)||(c=NaN),l.push(c)}i[s]=l}return{setValue:{numericalEndpoints:i}}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalEndpoints:{dependencyType:"stateVariable",variableName:"numericalEndpoints"}}),definition({dependencyValues:e}){let r=e.numericalEndpoints[0][0],n=e.numericalEndpoints[0][1],i=e.numericalEndpoints[1][0],s=e.numericalEndpoints[1][1],o=Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(s),l=e.nDimensions!==2||!o||i===r&&s===n;return{setValue:{nearestPoint:function({variables:u,scales:c}){if(l)return{};let p=c[0],m=c[1],f=(i-r)/p,d=(s-n)/m,h=f*f+d*d,y=((u.x1-r)/p*f+(u.x2-n)/m*d)/h,b={};return y<=0?b={x1:r,x2:n}:y>=1?b={x1:i,x2:s}:b={x1:r+y*f*p,x2:n+y*d*m},u.x3!==void 0&&(b.x3=0),b}}}}},t}async moveLineSegment({point1coords:t,point2coords:e,transient:r,actionId:n}){let i={};return t!==void 0&&(i["0,0"]=gm.fromAst(t[0]),i["0,1"]=gm.fromAst(t[1])),e!==void 0&&(i["1,0"]=gm.fromAst(e[0]),i["1,1"]=gm.fromAst(e[1])),r?await this.coreFunctions.performUpdate({updateInstructions:[{componentName:this.componentName,updateType:"updateValue",stateVariable:"endpoints",value:i}],transient:!0,actionId:n}):await this.coreFunctions.performUpdate({updateInstructions:[{componentName:this.componentName,updateType:"updateValue",stateVariable:"endpoints",value:i}],actionId:n,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{point1:t,point2:e}}})}};T(vm,"componentType","lineSegment");import fa from"math-expressions";var Tm=class extends Ge{actions={moveRay:this.moveRay.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.endpoint={createComponentOfType:"point"},e.through={createComponentOfType:"point"},e.direction={createComponentOfType:"vector"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let r="";return e.selectedStyle.lineWidth>=4?r+="thick ":e.selectedStyle.lineWidth<=1&&(r+="thin "),e.selectedStyle.lineStyle==="dashed"?r+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=e.selectedStyle.lineColor,{setValue:{styleDescription:r}}}},t.directionShadow={defaultValue:null,hasEssential:!0,essentialVarName:"direction",set:se,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{directionShadow:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"directionShadow",value:se(e.directionShadow)}]}}},t.throughShadow={defaultValue:null,hasEssential:!0,essentialVarName:"through",set:se,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{throughShadow:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"throughShadow",value:se(e.throughShadow)}]}}},t.endpointShadow={defaultValue:null,hasEssential:!0,essentialVarName:"endpoint",set:se,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{endpointShadow:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"endpointShadow",value:se(e.endpointShadow)}]}}},t.basedOnThrough={returnDependencies:()=>({throughAttr:{dependencyType:"attributeComponent",attributeName:"through"},throughShadow:{dependencyType:"stateVariable",variableName:"throughShadow"},endpointAttr:{dependencyType:"attributeComponent",attributeName:"endpoint"},directionAttr:{dependencyType:"attributeComponent",attributeName:"direction"}}),definition:function({dependencyValues:e}){return e.endpointAttr!==null&&e.directionAttr!==null?(e.throughAttr!==null&&console.warn("Ray is prescribed by through, endpoint, and direction.  Ignoring specified through."),{setValue:{basedOnThrough:!1},checkForActualChange:{basedOnThrough:!0}}):e.throughAttr!==null?{setValue:{basedOnThrough:!0},checkForActualChange:{basedOnThrough:!0}}:{setValue:{basedOnThrough:e.throughShadow!==null},checkForActualChange:{basedOnThrough:!0}}}},t.basedOnEndpoint={returnDependencies:()=>({endpointAttr:{dependencyType:"attributeComponent",attributeName:"endpoint"},endpointShadow:{dependencyType:"stateVariable",variableName:"endpointShadow"}}),definition:function({dependencyValues:e}){return e.endpointAttr!==null?{setValue:{basedOnEndpoint:!0},checkForActualChange:{basedOnEndpoint:!0}}:{setValue:{basedOnEndpoint:e.endpointShadow!==null},checkForActualChange:{basedOnEndpoint:!0}}}},t.basedOnDirection={returnDependencies:()=>({directionAttr:{dependencyType:"attributeComponent",attributeName:"direction"},directionShadow:{dependencyType:"stateVariable",variableName:"directionShadow"}}),definition:function({dependencyValues:e}){return e.directionAttr!==null?{setValue:{basedOnDirection:!0},checkForActualChange:{basedOnDirection:!0}}:{setValue:{basedOnDirection:e.directionShadow!==null},checkForActualChange:{basedOnDirection:!0}}}},t.nDimDirection={stateVariablesDeterminingDependencies:["basedOnDirection","basedOnThrough","basedOnEndpoint"],returnDependencies({stateValues:e}){let r={basedOnThrough:{dependencyType:"stateVariable",variableName:"basedOnThrough"},basedOnEndpoint:{dependencyType:"stateVariable",variableName:"basedOnEndpoint"},basedOnDirection:{dependencyType:"stateVariable",variableName:"basedOnDirection"},directionShadow:{dependencyType:"stateVariable",variableName:"directionShadow"},directionAttr:{dependencyType:"attributeComponent",attributeName:"direction",variableNames:["nDimensions"]}};return e.basedOnDirection||(e.basedOnThrough&&(r.nDimThrough={dependencyType:"stateVariable",variableName:"nDimThrough"}),e.basedOnEndpoint&&(r.nDimEndpoint={dependencyType:"stateVariable",variableName:"nDimEndpoint"})),r},definition:function({dependencyValues:e}){let r;if(e.basedOnDirection){if(e.directionAttr!==null)r=e.directionAttr.stateValues.nDimensions;else if(e.directionShadow){let n=e.directionShadow.tree;Array.isArray(n)&&["tuple","vector"].includes(n[0])?r=n.length-1:r=2}}else e.basedOnThrough?e.basedOnEndpoint?e.nDimThrough===e.nDimEndpoint?r=e.nDimThrough:r=NaN:r=e.nDimThrough:e.basedOnEndpoint?r=e.nDimEndpoint:r=2;return{setValue:{nDimDirection:r},checkForActualChange:{nDimDirection:!0}}}},t.nDimThrough={stateVariablesDeterminingDependencies:["basedOnDirection","basedOnThrough","basedOnEndpoint"],returnDependencies({stateValues:e}){let r={basedOnThrough:{dependencyType:"stateVariable",variableName:"basedOnThrough"},basedOnEndpoint:{dependencyType:"stateVariable",variableName:"basedOnEndpoint"},basedOnDirection:{dependencyType:"stateVariable",variableName:"basedOnDirection"},throughShadow:{dependencyType:"stateVariable",variableName:"throughShadow"},throughAttr:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nDimensions"]}};return e.basedOnThrough||(e.basedOnEndpoint&&(r.nDimEndpoint={dependencyType:"stateVariable",variableName:"nDimEndpoint"}),e.basedOnDirection&&(r.nDimDirection={dependencyType:"stateVariable",variableName:"nDimDirection"})),r},definition:function({dependencyValues:e}){let r;if(e.basedOnThrough){if(e.throughAttr!==null)r=e.throughAttr.stateValues.nDimensions;else if(e.throughShadow){let n=e.throughShadow.tree;Array.isArray(n)&&["tuple","vector"].includes(n[0])?r=n.length-1:r=2}}else e.basedOnDirection?e.basedOnEndpoint?e.nDimDirection===e.nDimEndpoint?r=e.nDimDirection:r=NaN:r=e.nDimDirection:e.basedOnEndpoint?r=e.nDimEndpoint:r=2;return{setValue:{nDimThrough:r},checkForActualChange:{nDimThrough:!0}}}},t.nDimEndpoint={stateVariablesDeterminingDependencies:["basedOnDirection","basedOnThrough","basedOnEndpoint"],returnDependencies({stateValues:e}){let r={basedOnThrough:{dependencyType:"stateVariable",variableName:"basedOnThrough"},basedOnEndpoint:{dependencyType:"stateVariable",variableName:"basedOnEndpoint"},basedOnDirection:{dependencyType:"stateVariable",variableName:"basedOnDirection"},endpointShadow:{dependencyType:"stateVariable",variableName:"endpointShadow"},endpointAttr:{dependencyType:"attributeComponent",attributeName:"endpoint",variableNames:["nDimensions"]}};return e.basedOnEndpoint||(e.basedOnThrough&&(r.nDimThrough={dependencyType:"stateVariable",variableName:"nDimThrough"}),e.basedOnDirection&&(r.nDimDirection={dependencyType:"stateVariable",variableName:"nDimDirection"})),r},definition:function({dependencyValues:e}){let r;if(e.basedOnEndpoint){if(e.endpointAttr!==null)r=e.endpointAttr.stateValues.nDimensions;else if(e.endpointShadow){let n=e.endpointShadow.tree;Array.isArray(n)&&["tuple","vector"].includes(n[0])?r=n.length-1:r=2}}else e.basedOnDirection?e.basedOnThrough?e.nDimDirection===e.nDimThrough?r=e.nDimDirection:r=NaN:r=e.nDimDirection:e.basedOnThrough?r=e.nDimThrough:r=2;return{setValue:{nDimEndpoint:r},checkForActualChange:{nDimEndpoint:!0}}}},t.nDimensions={public:!0,componentType:"number",returnDependencies:()=>({basedOnThrough:{dependencyType:"stateVariable",variableName:"basedOnThrough"},basedOnEndpoint:{dependencyType:"stateVariable",variableName:"basedOnEndpoint"},basedOnDirection:{dependencyType:"stateVariable",variableName:"basedOnDirection"},nDimDirection:{dependencyType:"stateVariable",variableName:"nDimDirection"},nDimThrough:{dependencyType:"stateVariable",variableName:"nDimThrough"},nDimEndpoint:{dependencyType:"stateVariable",variableName:"nDimEndpoint"}}),definition:function({dependencyValues:e}){let r;if(e.basedOnDirection){if(e.basedOnEndpoint){if(e.nDimDirection!==e.nDimEndpoint)return console.warn("nDimensions mismatch in vector"),{setValue:{nDimensions:NaN}}}else if(e.basedOnThrough&&e.nDimDirection!==e.nDimThrough)return console.warn("nDimensions mismatch in vector"),{setValue:{nDimensions:NaN}};r=e.nDimDirection}else if(e.basedOnEndpoint){if(e.basedOnThrough&&e.nDimEndpoint!==e.nDimThrough)return console.warn("nDimensions mismatch in vector"),{setValue:{nDimensions:NaN}};r=e.nDimEndpoint}else e.basedOnThrough?r=e.nDimThrough:r=2;return{setValue:{nDimensions:r},checkForActualChange:{nDimensions:!0}}}},t.direction={public:!0,componentType:"math",isArray:!0,entryPrefixes:["directionX"],hasEssential:!0,essentialVarName:"direction2",set:se,returnWrappingComponents(e){return e==="directionX"?[]:[["vector",{componentType:"mathList",isAttribute:"xs"}]]},stateVariablesDeterminingDependencies:["basedOnDirection","basedOnThrough"],returnArraySizeDependencies:()=>({nDimDirection:{dependencyType:"stateVariable",variableName:"nDimDirection"}}),returnArraySize({dependencyValues:e}){return[e.nDimDirection]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={basedOnThrough:{dependencyType:"stateVariable",variableName:"basedOnThrough"},basedOnEndpoint:{dependencyType:"stateVariable",variableName:"basedOnEndpoint"},basedOnDirection:{dependencyType:"stateVariable",variableName:"basedOnDirection"},directionShadow:{dependencyType:"stateVariable",variableName:"directionShadow"}},i={};for(let s of e){let o=Number(s)+1;i[s]={directionAttr:{dependencyType:"attributeComponent",attributeName:"direction",variableNames:["x"+o]}},!r.basedOnDirection&&r.basedOnThrough&&(i[s].endpointX={dependencyType:"stateVariable",variableName:"endpointX"+o},i[s].throughX={dependencyType:"stateVariable",variableName:"throughX"+o})}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={},s={};for(let l of n){let u=Number(l)+1;e.basedOnDirection?r[l].directionAttr!==null?i[l]=r[l].directionAttr.stateValues["x"+u]:e.directionShadow!==null&&(i[l]=e.directionShadow.get_component(Number(l))):e.basedOnThrough?i[l]=r[l].throughX.subtract(r[l].endpointX).simplify():s[l]={defaultValue:fa.fromAst(l==="0"?1:0)}}let o={};return Object.keys(i).length>0&&(o.setValue={direction:i}),Object.keys(s).length>0&&(o.useEssentialOrDefaultValue={direction:s}),o},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[],l=!1;for(let u in e.direction)r.basedOnDirection?n[u].directionAttr!==null?o.push({setDependency:i[u].directionAttr,desiredValue:e.direction[u],variableIndex:0}):l=!0:r.basedOnThrough?o.push({setDependency:i[u].throughX,desiredValue:n[u].endpointX.add(e.direction[u]).simplify()}):o.push({setEssentialValue:"direction",value:{[u]:se(e.direction[u])}});if(l)if(s[0]>1){let u=["vector"];for(let c in e.direction)u[Number(c)+1]=e.direction[c].tree;u.length=s[0]+1,o.push({setDependency:"directionShadow",desiredValue:fa.fromAst(u)})}else s[0]===1&&"0"in e.direction&&o.push({setDependency:"directionShadow",desiredValue:e.direction[0]});return{success:!0,instructions:o}}},t.through={public:!0,componentType:"math",isArray:!0,entryPrefixes:["throughX"],set:se,returnWrappingComponents(e){return e==="throughX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},stateVariablesDeterminingDependencies:["basedOnThrough"],returnArraySizeDependencies:()=>({nDimThrough:{dependencyType:"stateVariable",variableName:"nDimThrough"}}),returnArraySize({dependencyValues:e}){return[e.nDimThrough]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={basedOnDirection:{dependencyType:"stateVariable",variableName:"basedOnDirection"},basedOnEndpoint:{dependencyType:"stateVariable",variableName:"basedOnEndpoint"},basedOnThrough:{dependencyType:"stateVariable",variableName:"basedOnThrough"},throughShadow:{dependencyType:"stateVariable",variableName:"throughShadow"}},i={};for(let s of e){let o=Number(s)+1;i[s]={throughAttr:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["x"+o]}},r.basedOnThrough||(i[s].endpointX={dependencyType:"stateVariable",variableName:"endpointX"+o},i[s].directionX={dependencyType:"stateVariable",variableName:"directionX"+o})}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=Number(s)+1;e.basedOnThrough?r[s].throughAttr!==null?i[s]=r[s].throughAttr.stateValues["x"+o]:e.throughShadow!==null&&(i[s]=e.throughShadow.get_component(Number(s))):i[s]=r[s].endpointX.add(r[s].directionX).simplify()}return{setValue:{through:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[],l=!1;for(let u in e.through)r.basedOnThrough?n[u].throughAttr&&n[u].throughAttr!==null?o.push({setDependency:i[u].throughAttr,desiredValue:e.through[u],variableIndex:0}):r.throughShadow!==null&&(l=!0):o.push({setDependency:i[u].directionX,desiredValue:e.through[u].subtract(n[u].endpointX).simplify()});if(l)if(s[0]>1){let u=["vector"];for(let c in e.through)u[Number(c)+1]=e.through[c].tree;u.length=s[0]+1,o.push({setDependency:"throughShadow",desiredValue:fa.fromAst(u)})}else s[0]===1&&"0"in e.through&&o.push({setDependency:"throughShadow",desiredValue:e.through[0]});return{success:!0,instructions:o}}},t.endpoint={public:!0,componentType:"math",isArray:!0,entryPrefixes:["endpointX"],hasEssential:!0,defaultValueByArrayKey:()=>fa.fromAst(0),essentialVarName:"endpoint2",set:se,returnWrappingComponents(e){return e==="endpointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},stateVariablesDeterminingDependencies:["basedOnEndpoint","basedOnThrough","basedOnDirection"],returnArraySizeDependencies:()=>({nDimEndpoint:{dependencyType:"stateVariable",variableName:"nDimEndpoint"}}),returnArraySize({dependencyValues:e}){return[e.nDimEndpoint]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={basedOnDirection:{dependencyType:"stateVariable",variableName:"basedOnDirection"},basedOnThrough:{dependencyType:"stateVariable",variableName:"basedOnThrough"},endpointShadow:{dependencyType:"stateVariable",variableName:"endpointShadow"}},i={};for(let s of e){let o=Number(s)+1;i[s]={endpointAttr:{dependencyType:"attributeComponent",attributeName:"endpoint",variableNames:["x"+o]}},r.basedOnEndpoint||r.basedOnThrough&&r.basedOnDirection&&(i[s].throughX={dependencyType:"stateVariable",variableName:"throughX"+o},i[s].directionX={dependencyType:"stateVariable",variableName:"directionX"+o})}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={},s={};for(let l of n){let u=Number(l)+1;r[l].endpointAttr!==null?i[l]=r[l].endpointAttr.stateValues["x"+u]:e.endpointShadow!==null?i[l]=e.endpointShadow.get_component(Number(l)):e.basedOnThrough&&e.basedOnDirection?i[l]=r[l].throughX.subtract(r[l].directionX).simplify():s[l]=!0}let o={};return Object.keys(i).length>0&&(o.setValue={endpoint:i}),Object.keys(s).length>0&&(o.useEssentialOrDefaultValue={endpoint:s}),o},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[],l=!1;for(let u in e.endpoint)n[u].endpointAttr&&n[u].endpointAttr!==null?o.push({setDependency:i[u].endpointAttr,desiredValue:e.endpoint[u],variableIndex:0}):r.endpointShadow!==null?l=!0:r.basedOnThrough&&r.basedOnDirection?o.push({setDependency:i[u].directionX,desiredValue:n[u].throughX.subtract(e.endpoint[u]).simplify()}):o.push({setEssentialValue:"endpoint",value:{[u]:se(e.endpoint[u])}});if(l)if(s[0]>1){let u=["vector"];for(let c in e.endpoint)u[Number(c)+1]=e.endpoint[c].tree;u.length=s[0]+1,o.push({setDependency:"endpointShadow",desiredValue:fa.fromAst(u)})}else s[0]===1&&"0"in e.endpoint&&o.push({setDependency:"endpointShadow",desiredValue:e.endpoint[0]});return{success:!0,instructions:o}}},t.numericalEndpoint={forRenderer:!0,returnDependencies(){return{nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},endpoint:{dependencyType:"stateVariable",variableName:"endpoint"}}},definition({dependencyValues:e}){if(Number.isNaN(e.nDimensions))return null;let r=e.endpoint,n=[];for(let i=0;i<e.nDimensions;i++){let s=r[i].evaluate_to_constant();Number.isFinite(s)||(s=NaN),n.push(s)}return{setValue:{numericalEndpoint:n}}}},t.numericalThroughpoint={forRenderer:!0,returnDependencies(){return{nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},through:{dependencyType:"stateVariable",variableName:"through"}}},definition({dependencyValues:e}){if(Number.isNaN(e.nDimensions))return null;let r=e.through,n=[];for(let i=0;i<e.nDimensions;i++){let s=r[i].evaluate_to_constant();Number.isFinite(s)||(s=NaN),n.push(s)}return{setValue:{numericalThroughpoint:n}}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalEndpoint:{dependencyType:"stateVariable",variableName:"numericalEndpoint"},numericalThroughpoint:{dependencyType:"stateVariable",variableName:"numericalThroughpoint"}}),definition({dependencyValues:e}){let r=e.numericalEndpoint[0],n=e.numericalEndpoint[1],i=e.numericalThroughpoint[0],s=e.numericalThroughpoint[1],o=Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(s),l=e.nDimensions!==2||!o||i===r&&s===n;return{setValue:{nearestPoint:function({variables:u,scales:c}){if(l)return{};let p=c[0],m=c[1],f=(i-r)/p,d=(s-n)/m,h=f*f+d*d,y=((u.x1-r)/p*f+(u.x2-n)/m*d)/h,b={};return y<=0?b={x1:r,x2:n}:b={x1:r+y*f*p,x2:n+y*d*m},u.x3!==void 0&&(b.x3=0),b}}}}},t}async moveRay({endpointcoords:t,throughcoords:e,transient:r,skippable:n,sourceInformation:i,actionId:s}){let o=[];if(t!==void 0){if(await this.stateValues.basedOnThrough&&await this.stateValues.basedOnDirection){let l;if(e===void 0){let u=await this.stateValues.numericalThroughpoint;l=t.map((c,p)=>u[p]-c)}else l=t.map((u,c)=>e[c]-u);o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"direction",value:l.map(u=>fa.fromAst(u)),sourceInformation:i})}else o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"endpoint",value:t.map(l=>fa.fromAst(l)),sourceInformation:i});if(e===void 0&&!await this.stateValues.basedOnThrough){let l=await this.stateValues.numericalThroughpoint,u=t.map((c,p)=>l[p]-c);o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"direction",value:u.map(c=>fa.fromAst(c)),sourceInformation:i})}}if(e!==void 0){if(await this.stateValues.basedOnThrough)o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"through",value:e.map(l=>fa.fromAst(l)),sourceInformation:i});else{t==null&&(t=await this.stateValues.numericalEndpoint);let l=t.map((u,c)=>e[c]-u);o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"direction",value:l.map(u=>fa.fromAst(u)),sourceInformation:i})}if(t===void 0&&await this.stateValues.basedOnThrough&&await this.stateValues.basedOnDirection){let l=await this.stateValues.numericalEndpoint,u=e.map((c,p)=>c-l[p]);o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"direction",value:u.map(c=>fa.fromAst(c)),sourceInformation:i})}}return r?await this.coreFunctions.performUpdate({updateInstructions:o,transient:r,skippable:n,actionId:s}):await this.coreFunctions.performUpdate({updateInstructions:o,actionId:s,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{through:e,endpoint:t}}})}};T(Tm,"componentType","ray");var Ni=class extends hi{actions={movePolygon:this.movePolygon.bind(this)};get movePolygon(){return this.movePolyline}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalVertices:{dependencyType:"stateVariable",variableName:"numericalVertices"},nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition({dependencyValues:e}){let r=e.nDimensions,n=e.nVertices,i=e.numericalVertices,s=[],o,l,u=i[n-1]?.[0],c=i[n-1]?.[1];for(let p=0;p<n;p++)if(o=u,l=c,u=i[p]?.[0],c=i[p]?.[1],!(Number.isFinite(o)&&Number.isFinite(l)&&Number.isFinite(u)&&Number.isFinite(c)))s.push(null);else{let m=u-o,f=c-l;m===0&&f===0?s.push(null):s.push([m,f])}return{setValue:{nearestPoint:function({variables:p,scales:m}){let f=m[0],d=m[1];if(r!==2||n===0)return{};let h=1/0,y={},b=p.x1.evaluate_to_constant(),g=p.x2.evaluate_to_constant(),v,A,C=i[n-1][0],S=i[n-1][1];for(let w=0;w<n;w++){v=C,A=S,C=i[w][0],S=i[w][1];let x=s[w];if(x===null)continue;let R=x[0]/f,O=x[1]/d,_=R*R+O*O,k=((b-v)/f*R+(g-A)/d*O)/_,B;k<=0?B={x1:v,x2:A}:k>=1?B={x1:C,x2:S}:B={x1:v+k*R*f,x2:A+k*O*d};let U=Math.pow((b-B.x1)/f,2)+Math.pow((g-B.x2)/d,2);U<h&&(h=U,y=B)}return p.x3!==void 0&&Object.keys(y).length>0&&(y.x3=0),y}}}}},t}};T(Ni,"componentType","polygon");import $x from"math-expressions";var Au=class extends Ni{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.vertices.hasEssential=!0,t.vertices.defaultValueByArrayKey=function(e){return["0,1","1,0"].includes(e)?$x.fromAst(1):$x.fromAst(0)},t.vertices.returnArraySizeDependencies=()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),t.vertices.returnArraySize=function({dependencyValues:e}){return[3,e.nDimensions]},t.vertices.arrayDefinitionByKey=function({dependencyValuesByKey:e,arrayKeys:r}){let n={},i={};for(let s of r){let[o,l]=s.split(","),u=Number(o)+1+"_"+(Number(l)+1),c=e[s].vertices;c!==null&&c.stateValues["pointX"+u]?n[s]=c.stateValues["pointX"+u]:i[s]=!0}return{setValue:{vertices:n},useEssentialOrDefaultValue:{vertices:i}}},t.vertices.inverseArrayDefinitionByKey=async function({desiredStateVariableValues:e,dependencyValuesByKey:r,dependencyNamesByKey:n,initialChange:i,stateValues:s}){if(i&&!await s.draggable)return{success:!1};let o=[];for(let l in e.vertices){let[u,c]=l.split(","),p=Number(u)+1+"_"+(Number(c)+1);r[l].vertices!==null&&r[l].vertices.stateValues["pointX"+p]?o.push({setDependency:n[l].vertices,desiredValue:e.vertices[l],variableIndex:0}):o.push({setEssentialValue:"vertices",value:{[l]:e.vertices[l].simplify()}})}return{success:!0,instructions:o}},t.nVertices={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{nVertices:3}})},t}};T(Au,"componentType","triangle"),T(Au,"rendererType","polygon");import zn from"math-expressions";var Su=class extends Ni{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.vertices={createComponentOfType:"_pointListComponent"},e.center={createComponentOfType:"point"},e.width={createComponentOfType:"number"},e.height={createComponentOfType:"number"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nVerticesSpecified={returnDependencies:()=>({verticesAttr:{dependencyType:"attributeComponent",attributeName:"vertices",variableNames:["nPoints"]}}),definition:function({dependencyValues:e}){return e.verticesAttr!==null?{setValue:{nVerticesSpecified:e.verticesAttr.stateValues.nPoints}}:{setValue:{nVerticesSpecified:0}}}},t.essentialVertex={isArray:!0,entryPrefixes:["essentialVertexX"],defaultValueByArrayKey:()=>zn.fromAst(0),hasEssential:!0,returnArraySizeDependencies:()=>({nVerticesSpecified:{dependencyType:"stateVariable",variableName:"nVerticesSpecified"}}),returnArraySize({dependencyValues:e}){return[e.nVerticesSpecified===0?2:0]},returnArrayDependenciesByKey(){return{}},arrayDefinitionByKey:function({arrayKeys:e}){let r={};for(let n of e)r[n]=!0;return{useEssentialOrDefaultValue:{essentialVertex:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let r=[];for(let n in e.essentialVertex)r.push({setEssentialValue:"essentialVertex",value:{[n]:e.essentialVertex[n]}});return{success:!0,instructions:r}}},t.haveSpecifiedCenter={returnDependencies:()=>({centerAttr:{dependencyType:"attributeComponent",attributeName:"center"}}),definition:({dependencyValues:e})=>({setValue:{haveSpecifiedCenter:e.centerAttr!==null}})},t.specifiedCenter={isArray:!0,entryPrefixes:["specifiedCenterX"],returnArraySizeDependencies:()=>({haveSpecifiedCenter:{dependencyType:"stateVariable",variableName:"haveSpecifiedCenter"}}),returnArraySize({dependencyValues:e}){return[e.haveSpecifiedCenter?2:0]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let i=Number(n)+1;r[n]={centerAttr:{dependencyType:"attributeComponent",attributeName:"center",variableNames:["x"+i]}}}return{dependenciesByKey:r}},arrayDefinitionByKey:function({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=Number(i)+1;e[i].centerAttr!==null&&(n[i]=e[i].centerAttr.stateValues["x"+s])}return{setValue:{specifiedCenter:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:r,dependencyNamesByKey:n}){let i=[];for(let s in e.specifiedCenter)r[s].centerAttr&&r[s].centerAttr!==null&&i.push({setDependency:n[s].centerAttr,desiredValue:e.specifiedCenter[s],variableIndex:0});return{success:!0,instructions:i}}},t.specifiedWidth={defaultValue:1,hasEssential:!0,essentialVarName:"width",returnDependencies(){return{widthAttr:{dependencyType:"attributeComponent",attributeName:"width",variableNames:["value"]},nVerticesSpecified:{dependencyType:"stateVariable",variableName:"nVerticesSpecified"},haveSpecifiedCenter:{dependencyType:"stateVariable",variableName:"haveSpecifiedCenter"}}},definition({dependencyValues:e}){return e.widthAttr!==null?{setValue:{specifiedWidth:e.widthAttr.stateValues.value}}:(e.haveSpecifiedCenter?1:0)+e.nVerticesSpecified<=1?{useEssentialOrDefaultValue:{specifiedWidth:!0}}:{setValue:{specifiedWidth:null}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.widthAttr!==null?{success:!0,instructions:[{setDependency:"widthAttr",desiredValue:e.specifiedWidth,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"specifiedWidth",value:e.specifiedWidth}]}}},t.specifiedHeight={defaultValue:1,hasEssential:!0,essentialVarName:"height",returnDependencies(){return{heightAttr:{dependencyType:"attributeComponent",attributeName:"height",variableNames:["value"]},nVerticesSpecified:{dependencyType:"stateVariable",variableName:"nVerticesSpecified"},haveSpecifiedCenter:{dependencyType:"stateVariable",variableName:"haveSpecifiedCenter"}}},definition({dependencyValues:e}){return e.heightAttr!==null?{setValue:{specifiedHeight:e.heightAttr.stateValues.value}}:(e.haveSpecifiedCenter?1:0)+e.nVerticesSpecified<=1?{useEssentialOrDefaultValue:{specifiedHeight:!0}}:{setValue:{specifiedHeight:null}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.heightAttr!==null?{success:!0,instructions:[{setDependency:"heightAttr",desiredValue:e.specifiedHeight,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"specifiedHeight",value:e.specifiedHeight}]}}},t.center={public:!0,isArray:!0,entryPrefixes:["centerX"],componentType:"math",returnWrappingComponents(e){return e==="centerX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},returnArraySizeDependencies:()=>({}),returnArraySize:()=>[2],returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let i=Number(n)+1;r[n]={vertex0:{dependencyType:"stateVariable",variableName:"vertexX1_"+i},vertex2:{dependencyType:"stateVariable",variableName:"vertexX3_"+i}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=e[i].vertex0,o=e[i].vertex2;n[i]=s.add(o).divide(2).simplify()}return{setValue:{center:n}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:r,dependencyNamesByKey:n,stateValues:i}){let s=[],o=await i.center;for(let l in e.center){let u=Number(l),c=r[l].vertex0,p=r[l].vertex2,m=e.center[u].subtract(o[u]),f=c.add(m).simplify(),d=p.add(m).simplify();s.push({setDependency:n[l].vertex0,desiredValue:f},{setDependency:n[l].vertex2,desiredValue:d})}return{success:!0,instructions:s}}},t.width={public:!0,componentType:"number",returnDependencies({}){return{vertex0:{dependencyType:"stateVariable",variableName:"vertexX1_1"},vertex2:{dependencyType:"stateVariable",variableName:"vertexX3_1"}}},definition({dependencyValues:e}){let r=e.vertex0.evaluate_to_constant(),n=e.vertex2.evaluate_to_constant();return{setValue:{width:Math.abs(r-n)}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){let n=r.vertex0.evaluate_to_constant(),i=r.vertex2.evaluate_to_constant(),s=(i+n)/2,l=(i-n<0?-1:1)*Math.max(0,e.width)/2,u=zn.fromAst(s-l),c=zn.fromAst(s+l);return{success:!0,instructions:[{setDependency:"vertex0",desiredValue:u},{setDependency:"vertex2",desiredValue:c}]}}},t.height={public:!0,componentType:"number",returnDependencies({}){return{vertex0:{dependencyType:"stateVariable",variableName:"vertexX1_2"},vertex2:{dependencyType:"stateVariable",variableName:"vertexX3_2"}}},definition({dependencyValues:e}){let r=e.vertex0.evaluate_to_constant(),n=e.vertex2.evaluate_to_constant();return{setValue:{height:Math.abs(r-n)}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){let n=r.vertex0.evaluate_to_constant(),i=r.vertex2.evaluate_to_constant(),s=(i+n)/2,l=(i-n<0?-1:1)*Math.max(0,e.height)/2,u=zn.fromAst(s-l),c=zn.fromAst(s+l);return{success:!0,instructions:[{setDependency:"vertex0",desiredValue:u},{setDependency:"vertex2",desiredValue:c}]}}},t.vertices={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["vertexX","vertex"],returnWrappingComponents(e){return e==="vertexX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="vertexX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},stateVariablesDeterminingDependencies:["nVerticesSpecified","haveSpecifiedCenter"],returnArraySizeDependencies:()=>({}),returnArraySize(){return[4,2]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={},i={nVerticesSpecified:{dependencyType:"stateVariable",variableName:"nVerticesSpecified"}};if(r.nVerticesSpecified===0)if(i.haveSpecifiedCenter={dependencyType:"stateVariable",variableName:"haveSpecifiedCenter"},r.haveSpecifiedCenter)for(let s of e){let[o,l]=s.split(",");n[s]={specifiedCenter:{dependencyType:"stateVariable",variableName:"specifiedCenterX"+(Number(l)+1)}},l==="0"?n[s].specifiedWidth={dependencyType:"stateVariable",variableName:"specifiedWidth"}:n[s].specifiedHeight={dependencyType:"stateVariable",variableName:"specifiedHeight"}}else for(let s of e){let[o,l]=s.split(",");n[s]={essentialVertex:{dependencyType:"stateVariable",variableName:"essentialVertexX"+(Number(l)+1)}},l==="0"?(o==="1"||o==="2")&&(n[s].specifiedWidth={dependencyType:"stateVariable",variableName:"specifiedWidth"}):(o==="2"||o==="3")&&(n[s].specifiedHeight={dependencyType:"stateVariable",variableName:"specifiedHeight"})}else if(r.nVerticesSpecified===1)if(i.haveSpecifiedCenter={dependencyType:"stateVariable",variableName:"haveSpecifiedCenter"},r.haveSpecifiedCenter)for(let s of e){let[o,l]=s.split(","),u="1_"+(Number(l)+1);n[s]={verticesAttr:{dependencyType:"attributeComponent",attributeName:"vertices",variableNames:["pointX"+u]}},(l==="0"&&o==="1"||o==="2"||l==="1"&&o==="2"||o==="3")&&(n[s].specifiedCenter={dependencyType:"stateVariable",variableName:"specifiedCenterX"+(Number(l)+1)})}else for(let s of e){let[o,l]=s.split(","),u="1_"+(Number(l)+1);n[s]={verticesAttr:{dependencyType:"attributeComponent",attributeName:"vertices",variableNames:["pointX"+u]}},l==="0"?(o==="1"||o==="2")&&(n[s].specifiedWidth={dependencyType:"stateVariable",variableName:"specifiedWidth"}):(o==="2"||o==="3")&&(n[s].specifiedHeight={dependencyType:"stateVariable",variableName:"specifiedHeight"})}else for(let s of e){let[o,l]=s.split(","),u="1_"+(Number(l)+1),c="2_"+(Number(l)+1),p;o==="0"?p=u:o==="2"?p=c:o==="1"?l==="0"?p=c:p=u:l==="0"?p=u:p=c,n[s]={verticesAttr:{dependencyType:"attributeComponent",attributeName:"vertices",variableNames:["pointX"+p]}}}return{dependenciesByKey:n,globalDependencies:i}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r,globalDependencyValues:n}){let i={};if(n.nVerticesSpecified===0)if(n.haveSpecifiedCenter)for(let s of r){let[o,l]=s.split(","),u=e[s].specifiedCenter;if(l==="0"){let c=e[s].specifiedWidth;o==="0"||o==="3"?i[s]=u.subtract(c/2):i[s]=u.add(c/2)}else{let c=e[s].specifiedHeight;o==="0"||o==="1"?i[s]=u.subtract(c/2):i[s]=u.add(c/2)}}else for(let s of r){let[o,l]=s.split(","),u=e[s].essentialVertex;if(l==="0")if(o==="0"||o==="3")i[s]=u;else{let c=e[s].specifiedWidth;i[s]=u.add(c)}else if(o==="0"||o==="1")i[s]=u;else{let c=e[s].specifiedHeight;i[s]=u.add(c)}}else if(n.nVerticesSpecified===1)if(n.haveSpecifiedCenter)for(let s of r){let[o,l]=s.split(","),u=e[s].verticesAttr,c;if(u!==null&&Object.keys(u.stateValues).length===1?c=Object.values(u.stateValues)[0]:c=zn.fromAst("\uFF3F"),l==="0"&&(o==="0"||o==="3")||l==="1"&&(o==="0"||o==="1"))i[s]=c;else{let p=e[s].specifiedCenter;i[s]=c.add(p.subtract(c).multiply(2))}}else for(let s of r){let[o,l]=s.split(","),u=e[s].verticesAttr,c;if(u!==null&&Object.keys(u.stateValues).length===1?c=Object.values(u.stateValues)[0]:c=zn.fromAst("\uFF3F"),l==="0")if(o==="0"||o==="3")i[s]=c;else{let p=e[s].specifiedWidth;i[s]=c.add(p)}else if(o==="0"||o==="1")i[s]=c;else{let p=e[s].specifiedHeight;i[s]=c.add(p)}}else for(let s of r){let o=e[s].verticesAttr;o!==null&&Object.keys(o.stateValues).length===1?i[s]=Object.values(o.stateValues)[0]:i[s]=zn.fromAst("\uFF3F")}return{setValue:{vertices:i}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:r,globalDependencyValues:n,stateValues:i,workspace:s,initialChange:o,dependencyNamesByKey:l}){if(o&&!await i.draggable)return{success:!1};if(!s.v0){let y=await i.vertices;s.v0=[...y[0]],s.v2=[...y[2]]}let u,c,p,m,f,d;for(let y in e.vertices){let[b,g]=y.split(","),v=e.vertices[y];b==="0"?s.v0[Number(g)]=v:b==="2"?s.v2[Number(g)]=v:b==="1"?g==="0"?s.v2[Number(g)]=v:s.v0[Number(g)]=v:g==="0"?s.v0[Number(g)]=v:s.v2[Number(g)]=v,g==="0"?(u=y,b==="0"||b==="3"?p=y:f=y):(c=y,b==="0"||b==="1"?m=y:d=y)}let h=[];if(n.nVerticesSpecified===0)if(n.haveSpecifiedCenter){if(u!==void 0){let y=s.v2[0].subtract(s.v0[0]).evaluate_to_constant(),b=s.v2[0].add(s.v0[0]).divide(2).simplify();h.push({setDependency:l[u].specifiedWidth,desiredValue:y},{setDependency:l[u].specifiedCenter,desiredValue:b})}if(c!==void 0){let y=s.v2[1].subtract(s.v0[1]).evaluate_to_constant(),b=s.v2[1].add(s.v0[1]).divide(2).simplify();h.push({setDependency:l[c].specifiedHeight,desiredValue:y},{setDependency:l[c].specifiedCenter,desiredValue:b})}}else{if(p!==void 0){let y=s.v0[0].simplify();h.push({setDependency:l[p].essentialVertex,desiredValue:y})}if(f!==void 0){let y=s.v2[0].subtract(s.v0[0]).evaluate_to_constant();h.push({setDependency:l[f].specifiedWidth,desiredValue:y})}if(m!==void 0){let y=s.v0[1].simplify();h.push({setDependency:l[m].essentialVertex,desiredValue:y})}if(d!==void 0){let y=s.v2[1].subtract(s.v0[1]).evaluate_to_constant();h.push({setDependency:l[d].specifiedHeight,desiredValue:y})}}else if(n.nVerticesSpecified===1)if(n.haveSpecifiedCenter){if(p!==void 0){let y=s.v0[0].simplify();h.push({setDependency:l[p].verticesAttr,desiredValue:y,variableIndex:0})}if(f!==void 0){let y=s.v2[0].add(s.v0[0]).divide(2).simplify();h.push({setDependency:l[f].specifiedCenter,desiredValue:y})}if(m!==void 0){let y=s.v0[1].simplify();h.push({setDependency:l[m].verticesAttr,desiredValue:y,variableIndex:0})}if(d!==void 0){let y=s.v2[1].add(s.v0[1]).divide(2).simplify();h.push({setDependency:l[d].specifiedCenter,desiredValue:y})}}else{if(p!==void 0){let y=s.v0[0].simplify();h.push({setDependency:l[p].verticesAttr,desiredValue:y,variableIndex:0})}if(f!==void 0){let y=s.v2[0].subtract(s.v0[0]).evaluate_to_constant();h.push({setDependency:l[f].specifiedWidth,desiredValue:y})}if(m!==void 0){let y=s.v0[1].simplify();h.push({setDependency:l[m].verticesAttr,desiredValue:y,variableIndex:0})}if(d!==void 0){let y=s.v2[1].subtract(s.v0[1]).evaluate_to_constant();h.push({setDependency:l[d].specifiedHeight,desiredValue:y})}}else p!==void 0&&h.push({setDependency:l[p].verticesAttr,desiredValue:s.v0[0],variableIndex:0}),f!==void 0&&h.push({setDependency:l[f].verticesAttr,desiredValue:s.v2[0],variableIndex:0}),m!==void 0&&h.push({setDependency:l[m].verticesAttr,desiredValue:s.v0[1],variableIndex:0}),d!==void 0&&h.push({setDependency:l[d].verticesAttr,desiredValue:s.v2[1],variableIndex:0});return{success:!0,instructions:h}}},t.nVertices={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{nVertices:4}})},t}async movePolygon({pointCoords:t,transient:e,actionId:r}){let n=[],i={};for(let s in t)i[s+",0"]=zn.fromAst(t[s][0]),i[s+",1"]=zn.fromAst(t[s][1]);if(n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"vertices",value:i}),Object.keys(t).length===1){let s=Number(Object.keys(t)[0]),o=zn.fromAst(t[s][0]),l=zn.fromAst(t[s][1]),u=(s+2)%4,c=await this.stateValues.vertices,p=c[u][0],m=c[u][1];if(await this.stateValues.nVerticesSpecified<2)if(await this.stateValues.haveSpecifiedCenter){let f,d;s===0?(f=o.add(p).divide(2),d=l.add(m).divide(2)):s===1?d=l.add(m).divide(2):s===3&&(f=o.add(p).divide(2)),f!==void 0&&n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"specifiedCenter",value:{0:f.simplify()}}),d!==void 0&&n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"specifiedCenter",value:{1:d.simplify()}})}else{let f,d;s===0?(f=p.subtract(o),d=m.subtract(l)):s===1?d=m.subtract(l):s===3&&(f=p.subtract(o)),f!==void 0&&n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"specifiedWidth",value:f.simplify()}),d!==void 0&&n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"specifiedHeight",value:d.simplify()})}}return e?await this.coreFunctions.performUpdate({updateInstructions:n,transient:e,actionId:r}):await this.coreFunctions.performUpdate({updateInstructions:n,actionId:r,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{pointCoordinates:t}}})}};T(Su,"componentType","rectangle"),T(Su,"rendererType","polygon");import Ie from"math-expressions";var wu=class extends Rn{actions={moveCircle:this.moveCircle.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.through={createComponentOfType:"_pointListComponent"},e.center={createComponentOfType:"point"},e.radius={createComponentOfType:"math"},delete e.parMin,delete e.parMax,delete e.variable,e}static returnChildGroups(){return[]}static returnStateVariableDefinitions(t){let e=Ge.returnStateVariableDefinitions(t),r=super.returnStateVariableDefinitions(t);return e.styleDescription=r.styleDescription,e.curveType={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{curveType:"circle"}})},e.parMax={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{parMax:NaN}})},e.parMin={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{parMin:NaN}})},e.fs={forRenderer:!0,isArray:!0,entryPrefixes:["f"],returnArraySizeDependencies:()=>({}),returnArraySize:()=>[0],returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey:()=>({setValue:{fs:{}}})},e.nThroughPoints={returnDependencies:()=>({throughAttr:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nPoints"]}}),definition:function({dependencyValues:n}){return n.throughAttr!==null?{setValue:{nThroughPoints:n.throughAttr.stateValues.nPoints}}:{setValue:{nThroughPoints:0}}}},e.throughPoints={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["throughPointX","throughPoint"],returnWrappingComponents(n){return n==="throughPointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:i,arraySize:s}){if(n==="throughPointX"){let o=i.split("_").map(l=>Number(l)-1);return o.length===2&&o.every((l,u)=>Number.isInteger(l)&&l>=0)?s?o.every((l,u)=>l<s[u])?[String(o)]:[]:[String(o)]:[]}else{let o=Number(i)-1;return Number.isInteger(o)&&o>=0?s?o<s[0]?Array.from(Array(s[1]),(l,u)=>o+","+u):[]:[o+",0"]:[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints,2]},returnArrayDependenciesByKey({arrayKeys:n}){let i={};for(let s of n){let[o,l]=s.split(","),u=Number(o)+1+"_"+(Number(l)+1);i[s]={throughAttr:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["pointX"+u]}}}return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i){let[l,u]=o.split(","),c=Number(l)+1+"_"+(Number(u)+1),p=n[o].throughAttr;p!==null&&p.stateValues["pointX"+c]?s[o]=p.stateValues["pointX"+c]:s[o]=Ie.fromAst("\uFF3F")}return{setValue:{throughPoints:s}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyValuesByKey:i,dependencyNamesByKey:s,initialChange:o,stateValues:l}){if(o&&!await l.draggable)return{success:!1};let u=[];for(let c in n.throughPoints){let[p,m]=c.split(","),f=Number(p)+1+"_"+(Number(m)+1);if(i[c].throughAttr!==null&&i[c].throughAttr.stateValues["pointX"+f])u.push({setDependency:s[c].throughAttr,desiredValue:n.throughPoints[c],variableIndex:0});else return{success:!1}}return{success:!0,instructions:u}}},e.havePrescribedCenter={returnDependencies:()=>({centerAttr:{dependencyType:"attributeComponent",attributeName:"center"}}),definition:({dependencyValues:n})=>({setValue:{havePrescribedCenter:n.centerAttr!==null},checkForActualChange:{havePrescribedCenter:!0}})},e.prescribedCenter={isArray:!0,entryPrefixes:["prescribedCenterX"],returnArraySizeDependencies:()=>({havePrescribedCenter:{dependencyType:"stateVariable",variableName:"havePrescribedCenter"}}),returnArraySize({dependencyValues:n}){return[n.havePrescribedCenter?2:0]},returnArrayDependenciesByKey({arrayKeys:n}){let i={};for(let s of n){let o=Number(s)+1;i[s]={centerAttr:{dependencyType:"attributeComponent",attributeName:"center",variableNames:["x"+o]}}}return{dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:n,dependencyValuesByKey:i,arrayKeys:s}){let o={};for(let l of s){let u=Number(l)+1;i[l].centerAttr!==null&&(o[l]=i[l].centerAttr.stateValues["x"+u],o[l]||(o[l]=Ie.fromAst("\uFF3F")))}return{setValue:{prescribedCenter:o}}},inverseArrayDefinitionByKey({desiredStateVariableValues:n,globalDependencyValues:i,dependencyValuesByKey:s,dependencyNamesByKey:o,arraySize:l}){let u=[];for(let c of Object.keys(n.prescribedCenter).reverse())s[c].centerAttr!==null&&u.push({setDependency:o[c].centerAttr,desiredValue:n.prescribedCenter[c],variableIndex:0});return{success:!0,instructions:u}}},e.prescribedRadius={defaultValue:null,returnDependencies:()=>({radiusAttr:{dependencyType:"attributeComponent",attributeName:"radius",variableNames:["value"]}}),definition:function({dependencyValues:n}){return n.radiusAttr!==null?{setValue:{prescribedRadius:n.radiusAttr.stateValues.value}}:{setValue:{prescribedRadius:null}}},inverseDefinition:function({desiredStateVariableValues:n,dependencyValues:i}){return i.radiusAttr!==null?{success:!0,instructions:[{setDependency:"radiusAttr",desiredValue:n.prescribedRadius,childIndex:0,variableIndex:0}]}:{success:!1}}},e.havePrescribedRadius={returnDependencies:()=>({radiusAttr:{dependencyType:"attributeComponent",attributeName:"radius"}}),definition:({dependencyValues:n})=>({setValue:{havePrescribedRadius:n.radiusAttr!==null},checkForActualChange:{havePrescribedRadius:!0}})},e.numericalPrescribedRadius={returnDependencies:()=>({prescribedRadius:{dependencyType:"stateVariable",variableName:"prescribedRadius"}}),additionalStateVariablesDefined:["haveNonNumericalPrescribedRadius"],definition:function({dependencyValues:n}){let i=!1,s;return n.prescribedRadius===null?s=null:(s=n.prescribedRadius.evaluate_to_constant(),Number.isFinite(s)||(s=NaN,i=!0)),{setValue:{haveNonNumericalPrescribedRadius:i,numericalPrescribedRadius:s},checkForActualChange:{haveNonNumericalEntriesNumericalRadius:!0}}},inverseDefinition:async function({desiredStateVariableValues:n,dependencyValues:i,stateValues:s}){return await s.haveNonNumericalPrescribedRadius?{success:!1}:n.numericalPrescribedRadius!==void 0?i.prescribedRadius===null?{success:!1}:{success:!0,instructions:[{setDependency:"prescribedRadius",desiredValue:Ie.fromAst(n.numericalPrescribedRadius)}]}:{success:!1}}},e.numericalPrescribedCenter={isArray:!0,entryPrefixes:["numericalPrescribedCenterX"],returnArraySizeDependencies:()=>({havePrescribedCenter:{dependencyType:"stateVariable",variableName:"havePrescribedCenter"}}),returnArraySize({dependencyValues:n}){return[n.havePrescribedCenter?2:0]},returnArrayDependenciesByKey({arrayKeys:n}){let i={};for(let s of n){let o=Number(s)+1;i[s]={prescribedCenterX:{dependencyType:"stateVariable",variableName:"prescribedCenterX"+o}}}return{dependenciesByKey:i}},arrayDefinitionByKey:function({dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i){let l=n[o].prescribedCenterX;l?(s[o]=l.evaluate_to_constant(),Number.isFinite(s[o])||(s[o]=NaN)):s[o]=NaN}return{setValue:{numericalPrescribedCenter:s}}},inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyNamesByKey:i}){let s=[];for(let o in n.numericalPrescribedCenter)s.push({setDependency:i[o].prescribedCenterX,desiredValue:Ie.fromAst(n.numericalPrescribedCenter[o])});return{success:!0,instructions:s}}},e.haveNonNumericalPrescribedCenter={returnDependencies:()=>({numericalPrescribedCenter:{dependencyType:"stateVariable",variableName:"numericalPrescribedCenter"}}),definition({dependencyValues:n}){return{setValue:{haveNonNumericalPrescribedCenter:n.numericalPrescribedCenter.some(s=>!Number.isFinite(s))},checkForActualChange:{haveNonNumericalPrescribedCenter:!0}}}},e.numericalThroughPoints={returnDependencies:()=>({throughPoints:{dependencyType:"stateVariable",variableName:"throughPoints"}}),additionalStateVariablesDefined:["haveNonNumericalThroughPoints"],definition:function({dependencyValues:n}){let i=!1,s=[];for(let o of n.throughPoints){let l=[];for(let u=0;u<2;u++){let c;try{c=o[u].evaluate_to_constant()}catch(p){console.warn("Invalid point of circle"),i=!0,l=[];break}if(Number.isFinite(c))l.push(c);else{i=!0,l=[];break}}if(l.length>0)s.push(l);else{s=[];break}}return{setValue:{haveNonNumericalThroughPoints:i,numericalThroughPoints:s},checkForActualChange:{haveNonNumericalThroughPoints:!0}}},inverseDefinition:async function({desiredStateVariableValues:n,dependencyValues:i,stateValues:s}){if(await s.haveNonNumericalThroughPoints)return{success:!1};if(n.numericalThroughPoints!==void 0){let o={};for(let[l,u]of n.numericalThroughPoints.entries())o[l+",0"]=Ie.fromAst(u[0]),o[l+",1"]=Ie.fromAst(u[1]);return{success:!0,instructions:[{setDependency:"throughPoints",desiredValue:o}]}}return{success:!1}}},e.haveNumericalEntries={returnDependencies:()=>({haveNonNumericalPrescribedCenter:{dependencyType:"stateVariable",variableName:"haveNonNumericalPrescribedCenter"},haveNonNumericalPrescribedRadius:{dependencyType:"stateVariable",variableName:"haveNonNumericalPrescribedRadius"},haveNonNumericalThroughPoints:{dependencyType:"stateVariable",variableName:"haveNonNumericalThroughPoints"}}),definition:({dependencyValues:n})=>({setValue:{haveNumericalEntries:!(n.haveNonNumericalPrescribedCenter||n.haveNonNumericalPrescribedRadius||n.haveNonNumericalThroughPoints)}})},e.numericalRadiusCalculatedWithCenter={additionalStateVariablesDefined:["numericalCenterCalculatedWithRadius"],returnDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},haveNumericalEntries:{dependencyType:"stateVariable",variableName:"haveNonNumericalThroughPoints"}}),definition:function({dependencyValues:n}){if(n.haveNonNumericalThroughPoints){let i="Haven't implemented circle through "+n.nThroughPoints+" points";return i+=" in case where don't have numerical values.",console.warn(i),{setValue:{numericalRadiusCalculatedWithCenter:null,numericalCenterCalculatedWithRadius:null}}}if(n.nThroughPoints===2){let{numericalCenter:i,numericalRadius:s}=DT({point1:n.numericalThroughPoints[0],point2:n.numericalThroughPoints[1]});return{setValue:{numericalCenterCalculatedWithRadius:i,numericalRadiusCalculatedWithCenter:s}}}else if(n.nThroughPoints===3){let i=n.numericalThroughPoints[0][0],s=n.numericalThroughPoints[1][0],o=n.numericalThroughPoints[2][0],l=n.numericalThroughPoints[0][1],u=n.numericalThroughPoints[1][1],c=n.numericalThroughPoints[2][1],p,m;if(i===s&&l===u)if(i===o&&l===c)p=[i,l],m=0;else{let f=DT({point1:[i,l],point2:[o,c]});p=f.numericalCenter,m=f.numericalRadius}else if(i===o&&l===c||s===o&&u===c){let f=DT({point1:[i,l],point2:[s,u]});p=f.numericalCenter,m=f.numericalRadius}else{let f=i*i+l*l,d=s*s+u*u,h=o*o+c*c,y=i*(u-c)-l*(s-o)+s*c-o*u,b=f*(c-u)+d*(l-c)+h*(u-l),g=f*(s-o)+d*(o-i)+h*(i-s),v=f*(o*u-s*c)+d*(i*c-o*l)+h*(s*l-i*u);y!==0?(p=[-b/(2*y),-g/(2*y)],m=Math.sqrt((b*b+g*g-4*y*v)/(4*y*y))):(p=[NaN,NaN],m=NaN)}return{setValue:{numericalCenterCalculatedWithRadius:p,numericalRadiusCalculatedWithCenter:m}}}else return n.nThroughPoints>3?(console.warn("Can't calculate circle through more than 3 points"),{setValue:{numericalRadiusCalculatedWithCenter:null,numericalCenterCalculatedWithRadius:null}}):{setValue:{numericalRadiusCalculatedWithCenter:null,numericalCenterCalculatedWithRadius:null}}}},e.essentialRadius={defaultValue:1,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{essentialRadius:!0}}),inverseDefinition:function({desiredStateVariableValues:n}){return{success:!0,instructions:[{setEssentialValue:"essentialRadius",value:n.essentialRadius}]}}},e.numericalRadius={forRenderer:!0,stateVariablesDeterminingDependencies:["nThroughPoints","havePrescribedCenter","havePrescribedRadius"],returnDependencies:function({stateValues:n}){let i={haveNonNumericalPrescribedRadius:{dependencyType:"stateVariable",variableName:"haveNonNumericalPrescribedRadius"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},essentialRadius:{dependencyType:"stateVariable",variableName:"essentialRadius"}};return n.havePrescribedRadius?(i.numericalPrescribedRadius={dependencyType:"stateVariable",variableName:"numericalPrescribedRadius"},n.havePrescribedCenter&&n.nThroughPoints>0&&(i.haveCenterRadiusPoints={dependencyType:"value",value:!0})):n.havePrescribedCenter?n.nThroughPoints===1&&(i.haveNonNumericalPrescribedCenter={dependencyType:"stateVariable",variableName:"haveNonNumericalPrescribedCenter"},i.numericalPrescribedCenter={dependencyType:"stateVariable",variableName:"numericalPrescribedCenter"},i.haveNonNumericalThroughPoints={dependencyType:"stateVariable",variableName:"haveNonNumericalThroughPoints"},i.numericalThroughPoints={dependencyType:"stateVariable",variableName:"numericalThroughPoints"}):n.nThroughPoints>1&&(i.numericalRadiusCalculatedWithCenter={dependencyType:"stateVariable",variableName:"numericalRadiusCalculatedWithCenter"},i.numericalThroughPoints={dependencyType:"stateVariable",variableName:"numericalThroughPoints"}),i},definition:function({dependencyValues:n}){if(n.haveNonNumericalPrescribedRadius||n.haveNonNumericalPrescribedCenter||n.haveNonNumericalThroughPoints)return{setValue:{numericalRadius:NaN}};if(n.numericalPrescribedRadius!==void 0)return n.haveCenterRadiusPoints?(console.warn("Can't calculate circle with specified radius and center and through points"),{setValue:{numericalRadius:NaN}}):{setValue:{numericalRadius:Math.max(0,n.numericalPrescribedRadius)}};if(n.numericalPrescribedCenter!==void 0)if(n.nThroughPoints===0){let i=n.essentialRadius;if(i instanceof Ie.class){try{i=i.evaluate_to_constant()}catch(s){}Number.isFinite(i)||(i=NaN)}return{setValue:{numericalRadius:i}}}else if(n.nThroughPoints===1){let i=n.numericalThroughPoints[0];return i===void 0?{setValue:{numericalRadius:NaN}}:{setValue:{numericalRadius:Math.sqrt(Math.pow(i[0]-n.numericalPrescribedCenter[0],2)+Math.pow(i[1]-n.numericalPrescribedCenter[1],2))}}}else return console.warn("Can't calculate circle with specified center through more than 1 point"),{setValue:{numericalRadius:NaN}};if(n.nThroughPoints<2){let i=n.essentialRadius;if(i instanceof Ie.class){try{i=i.evaluate_to_constant()}catch(s){}Number.isFinite(i)||(i=NaN)}return{setValue:{numericalRadius:i}}}else return{setValue:{numericalRadius:n.numericalRadiusCalculatedWithCenter}}},inverseDefinition:async function({desiredStateVariableValues:n,dependencyValues:i,stateValues:s}){if(i.numericalPrescribedRadius!==void 0)return{success:!0,instructions:[{setDependency:"numericalPrescribedRadius",desiredValue:Math.max(0,n.numericalRadius)}]};if(i.numericalPrescribedCenter!==void 0){if(i.nThroughPoints===0)return{success:!0,instructions:[{setDependency:"essentialRadius",desiredValue:Math.max(0,n.numericalRadius)}]};if(i.nThroughPoints===1){let o=Math.max(0,n.numericalRadius),l=(await s.throughAngles)[0];if(!Number.isFinite(l))return{success:!1};let u=await s.numericalCenter,c=[u[0]+o*Math.cos(l),u[1]+o*Math.sin(l)];return{success:!0,instructions:[{setDependency:"numericalThroughPoints",desiredValue:[c]}]}}else return{success:!1}}if(i.nThroughPoints<2)return{success:!0,instructions:[{setDependency:"essentialRadius",desiredValue:Math.max(0,n.numericalRadius)}]};{let o=[],l=Math.max(0,n.numericalRadius);for(let u=0;u<i.nThroughPoints;u++){let c=(await s.throughAngles)[u];if(!Number.isFinite(c))return{success:!1};let p=await s.numericalCenter,m=[p[0]+l*Math.cos(c),p[1]+l*Math.sin(c)];o.push(m)}return{success:!0,instructions:[{setDependency:"numericalThroughPoints",desiredValue:o}]}}}},e.essentialCenter={isArray:!0,entryPrefixes:["essentialCenterX"],hasEssential:!0,defaultValueByArrayKey:()=>0,returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey:function({arrayKeys:n}){let i={};for(let s of n)i[s]=!0;return{useEssentialOrDefaultValue:{essentialCenter:i}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:n,stateValues:i,workspace:s}){let o=[];for(let l in n.essentialCenter)o.push({setEssentialValue:"essentialCenter",value:{[l]:n.essentialCenter[l]}});return{success:!0,instructions:o}}},e.numericalCenter={forRenderer:!0,isArray:!0,entryPrefixes:["numericalCenterX"],stateVariablesDeterminingDependencies:["nThroughPoints","havePrescribedCenter","havePrescribedRadius"],returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey({arrayKeys:n,stateValues:i}){let s={},o={};if(i.havePrescribedCenter){for(let l of n){let u=Number(l)+1;o[l]={numericalPrescribedCenterX:{dependencyType:"stateVariable",variableName:"numericalPrescribedCenterX"+u}}}i.havePrescribedRadius&&i.nThroughPoints>0&&(s.haveCenterRadiusPoints={dependencyType:"value",value:!0})}else{for(let l of n){let u=Number(l)+1;o[l]={essentialCenterX:{dependencyType:"stateVariable",variableName:"essentialCenterX"+u}}}s.nThroughPoints={dependencyType:"stateVariable",variableName:"nThroughPoints"},s.numericalThroughPoints={dependencyType:"stateVariable",variableName:"numericalThroughPoints"},s.haveNonNumericalThroughPoints={dependencyType:"stateVariable",variableName:"haveNonNumericalThroughPoints"},i.havePrescribedRadius?s.numericalRadius={dependencyType:"stateVariable",variableName:"numericalRadius"}:i.nThroughPoints==1?s.numericalRadius={dependencyType:"stateVariable",variableName:"numericalRadius"}:i.nThroughPoints>1&&(s.numericalCenterCalculatedWithRadius={dependencyType:"stateVariable",variableName:"numericalCenterCalculatedWithRadius"})}return{globalDependencies:s,dependenciesByKey:o}},arrayDefinitionByKey:function({globalDependencyValues:n,dependencyValuesByKey:i,arrayKeys:s}){let o={};for(let l of s)if(i[l].numericalPrescribedCenterX!==void 0){if(n.haveCenterRadiusPoints)return console.warn("Can't calculate circle with specified radius and center and through points"),{setValue:{numericalCenter:[NaN,NaN]}};o[l]=i[l].numericalPrescribedCenterX}if(Object.keys(o).length>0)return{setValue:{numericalCenter:o}};if(n.haveNonNumericalPrescribedRadius||n.haveNonNumericalThroughPoints)return{setValue:{numericalCenter:[NaN,NaN]}};if(n.numericalRadius!==void 0)if(n.nThroughPoints===0){for(let l of s){let u=i[l].essentialCenterX;if(u instanceof Ie.class){try{u=u.evaluate_to_constant()}catch(c){}Number.isFinite(u)||(u=NaN)}o[l]=u}return{setValue:{numericalCenter:o}}}else{if(n.nThroughPoints===1)return n.numericalThroughPoints.length<1?{setValue:{numericalCenter:[NaN,NaN]}}:{setValue:{numericalCenter:[n.numericalThroughPoints[0][0],n.numericalThroughPoints[0][1]-n.numericalRadius]}};if(n.nThroughPoints===2){if(n.numericalThroughPoints.length<2)return{setValue:{numericalCenter:[NaN,NaN]}};let l=n.numericalRadius,u=n.numericalThroughPoints[0][0],c=n.numericalThroughPoints[1][0],p=n.numericalThroughPoints[0][1],m=n.numericalThroughPoints[1][1],f=Math.pow(u-c,2)+Math.pow(p-m,2),d=l*l;if(l<0||4*d<f)return console.warn("Can't find circle through given radius and two points"),{setValue:{numericalCenter:[NaN,NaN]}};if(f===0)return{setValue:{numericalCenter:[u,p-l]}};let h=.5*(f*(u+c)+(p-m)*Math.sqrt((4*d-f)*f))/f,y=.5*(f*(p+m)+(c-u)*Math.sqrt((4*d-f)*f))/f;return{setValue:{numericalCenter:[h,y]}}}else return console.warn("Can't create circle through more than two points with given radius"),{setValue:{numericalCenter:[NaN,NaN]}}}if(n.nThroughPoints===0){for(let l of s){let u=i[l].essentialCenterX;if(u instanceof Ie.class){try{u=u.evaluate_to_constant()}catch(c){}Number.isFinite(u)||(u=NaN)}o[l]=u}return{setValue:{numericalCenter:o}}}else return n.numericalCenterCalculatedWithRadius===void 0?{setValue:{numericalCenter:[NaN,NaN]}}:{setValue:{numericalCenter:n.numericalCenterCalculatedWithRadius}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:n,globalDependencyValues:i,dependencyValuesByKey:s,dependencyNamesByKey:o,stateValues:l,workspace:u}){let c=[];for(let p in n.numericalCenter)s[p].numericalPrescribedCenterX!==void 0&&c.push({setDependency:o[p].numericalPrescribedCenterX,desiredValue:n.numericalCenter[p]});if(c.length>0)return{success:!0,instructions:c};if(i.nThroughPoints===0){for(let p in n.numericalCenter)c.push({setDependency:o[p].essentialCenterX,desiredValue:n.numericalCenter[p]});return{success:!0,instructions:c}}else{u.desiredCenter||(u.desiredCenter={});for(let d=0;d<2;d++)n.numericalCenter[d]!==void 0?u.desiredCenter[d]=n.numericalCenter[d]:u.desiredCenter[d]===void 0&&(u.desiredCenter[d]=l.numericalCenter[d]);let p=[],m=await l.throughAngles,f=await l.numericalRadius;for(let d=0;d<i.nThroughPoints;d++){let h=m[d];if(!Number.isFinite(h))return{success:!1};let y=[u.desiredCenter[0]+f*Math.cos(h),u.desiredCenter[1]+f*Math.sin(h)];p.push(y)}return{success:!0,instructions:[{setDependency:"numericalThroughPoints",desiredValue:p}]}}}},e.throughAngles={forRenderer:!0,defaultValue:[],hasEssential:!0,doNotShadowEssential:!0,returnDependencies:()=>({haveNumericalEntries:{dependencyType:"stateVariable",variableName:"haveNumericalEntries"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},numericalRadius:{dependencyType:"stateVariable",variableName:"numericalRadius"},numericalCenter:{dependencyType:"stateVariable",variableName:"numericalCenter"}}),definition:function({dependencyValues:n}){if(!(n.haveNumericalEntries&&n.nThroughPoints>0&&n.numericalRadius>0&&n.numericalCenter.every(s=>Number.isFinite(s))))return{useEssentialOrDefaultValue:{throughAngles:!0}};let i=[];for(let s of n.numericalThroughPoints)i.push(Math.atan2(s[1]-n.numericalCenter[1],s[0]-n.numericalCenter[0]));return{setValue:{throughAngles:i},setEssentialValue:{throughAngles:i}}}},e.radius={public:!0,componentType:"math",stateVariablesDeterminingDependencies:["nThroughPoints","havePrescribedCenter","havePrescribedRadius"],returnDependencies:function({stateValues:n}){let i={numericalRadius:{dependencyType:"stateVariable",variableName:"numericalRadius"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},essentialRadius:{dependencyType:"stateVariable",variableName:"essentialRadius"}};return n.havePrescribedRadius?(i.prescribedRadius={dependencyType:"stateVariable",variableName:"prescribedRadius"},n.havePrescribedCenter&&n.nThroughPoints>0&&(i.haveCenterRadiusPoints={dependencyType:"value",value:!0})):n.havePrescribedCenter&&n.nThroughPoints===1&&(i.prescribedCenter={dependencyType:"stateVariable",variableName:"prescribedCenter"},i.throughPoints={dependencyType:"stateVariable",variableName:"throughPoints"}),i},definition:function({dependencyValues:n}){if(Number.isFinite(n.numericalRadius))return{setValue:{radius:Ie.fromAst(n.numericalRadius)}};if(n.prescribedRadius!==void 0)return n.haveCenterRadiusPoints?(console.warn("Can't calculate circle with specified radius and center and through points"),{setValue:{radius:Ie.fromAst("\uFF3F")}}):{setValue:{radius:n.prescribedRadius}};if(n.prescribedCenter!==void 0)if(n.nThroughPoints===0){let i=n.essentialRadius;return i instanceof Ie.class||(Number.isFinite(i)?i=Ie.fromAst(i):i=Ie.fromAst("\uFF3F")),{setValue:{radius:i}}}else if(n.nThroughPoints===1)try{let i=n.throughPoints[0],s=i[0],o=i[1],l=n.prescribedCenter[0],u=n.prescribedCenter[1];return{setValue:{radius:s.subtract(l).pow(2).add(o.subtract(u).pow(2)).pow(.5).simplify()}}}catch(i){return console.warn("Invalid center or through points of circle"),{setValue:{radius:Ie.fromAst("\uFF3F")}}}else return console.warn("Can't calculate circle with specified center through more than 1 point"),{setValue:{radius:Ie.fromAst("\uFF3F")}};if(n.nThroughPoints<2){let i=n.essentialRadius;return i instanceof Ie.class||(Number.isFinite(i)?i=Ie.fromAst(i):i=Ie.fromAst("\uFF3F")),{setValue:{radius:i}}}else return console.warn(`Have not implemented circle through ${n.nThroughPoints} points when non-numerical values`),{setValue:{radius:Ie.fromAst("\uFF3F")}}},inverseDefinition:function({desiredStateVariableValues:n,dependencyValues:i}){let s=n.radius.evaluate_to_constant();if(Number.isFinite(s)&&Number.isFinite(i.numericalRadius))return{success:!0,instructions:[{setDependency:"numericalRadius",desiredValue:s}]};if(i.prescribedRadius!==void 0)return{success:!0,instructions:[{setDependency:"prescribedRadius",desiredValue:n.radius}]};if(i.nThroughPoints===0){let o=[{setDependency:"essentialRadius",desiredValue:n.radius}];return{success:!0,instructions:o}}else return console.warn("Can't change radius of circle with non-numerical values through points"),{success:!1}}},e.diameter={public:!0,componentType:"math",returnDependencies:()=>({radius:{dependencyType:"stateVariable",variableName:"radius"}}),definition({dependencyValues:n}){return{setValue:{diameter:n.radius.multiply(2).simplify()}}},inverseDefinition:function({desiredStateVariableValues:n,dependencyValues:i}){return{success:!0,instructions:[{setDependency:"radius",desiredValue:n.diameter.divide(2).simplify()}]}}},e.center={forRenderer:!0,public:!0,componentType:"math",isArray:!0,entryPrefixes:["centerX"],returnWrappingComponents(n){return n==="centerX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},stateVariablesDeterminingDependencies:["nThroughPoints","havePrescribedCenter","havePrescribedRadius"],returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey({arrayKeys:n,stateValues:i}){let s={},o={};if(i.havePrescribedCenter){s.havePrescribedCenter={dependencyType:"value",value:!0};for(let l of n){let u=Number(l)+1;o[l]={numericalCenterX:{dependencyType:"stateVariable",variableName:"numericalCenterX"+u},prescribedCenterX:{dependencyType:"stateVariable",variableName:"prescribedCenterX"+u}}}i.havePrescribedRadius&&i.nThroughPoints>0&&(s.haveCenterRadiusPoints={dependencyType:"value",value:!0})}else{for(let l of n){let u=Number(l)+1;o[l]={essentialCenterX:{dependencyType:"stateVariable",variableName:"essentialCenterX"+u}}}s.numericalCenter={dependencyType:"stateVariable",variableName:"numericalCenter"},s.nThroughPoints={dependencyType:"stateVariable",variableName:"nThroughPoints"},s.throughPoints={dependencyType:"stateVariable",variableName:"throughPoints"},i.havePrescribedRadius?s.radius={dependencyType:"stateVariable",variableName:"prescribedRadius"}:i.nThroughPoints==1&&(s.radius={dependencyType:"stateVariable",variableName:"radius"})}return{dependenciesByKey:o,globalDependencies:s}},arrayDefinitionByKey:function({globalDependencyValues:n,dependencyValuesByKey:i,arrayKeys:s}){if(n.havePrescribedCenter){if(n.haveCenterRadiusPoints)return console.warn("Can't calculate circle with specified radius and center and through points"),{setValue:{center:[Ie.fromAst("\uFF3F"),Ie.fromAst("\uFF3F")]}};let o={};for(let l of s)Number.isFinite(i[l].numericalCenterX)?o[l]=Ie.fromAst(i[l].numericalCenterX):o[l]=i[l].prescribedCenterX;return{setValue:{center:o}}}if(n.numericalCenter.every(o=>Number.isFinite(o)))return{setValue:{center:n.numericalCenter.map(o=>Ie.fromAst(o))}};if(n.radius!==void 0)if(n.nThroughPoints===0){let o={};for(let l of s){let u=i[l].essentialCenterX;u instanceof Ie.class||(Number.isFinite(u)?u=Ie.fromAst(u):u=Ie.fromAst("\uFF3F")),o[l]=u}return{setValue:{center:o}}}else if(n.nThroughPoints===1){let o;try{o=[n.throughPoints[0][0],n.throughPoints[0][1].subtract(n.radius).simplify()]}catch(l){o=[Ie.fromAst("\uFF3F"),Ie.fromAst("\uFF3F")]}return{setValue:{center:o}}}else return console.warn("Can't create circle through more than one point with given radius when don't have numerical values"),{setValue:{center:[Ie.fromAst("\uFF3F"),Ie.fromAst("\uFF3F")]}};if(n.nThroughPoints===0){let o={};for(let l of s){let u=i[l].essentialCenterX;u instanceof Ie.class||(Number.isFinite(u)?u=Ie.fromAst(u):u=Ie.fromAst("\uFF3F")),o[l]=u}return{setValue:{center:o}}}else return console.warn("Can't create circle through more than one point when don't have numerical values"),{setValue:{center:[Ie.fromAst("\uFF3F"),Ie.fromAst("\uFF3F")]}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:n,globalDependencyValues:i,stateValues:s,dependencyNamesByKey:o,workspace:l}){if(i.havePrescribedCenter){let p=[];for(let m in n.center)p.push({setDependency:o[m].prescribedCenterX,desiredValue:n.center[m],arrayKey:m});return{success:!0,instructions:p}}l.desiredCenter||(l.desiredCenter={});for(let p=0;p<2;p++)n.center[p]!==void 0?l.desiredCenter[p]=n.center[p]:l.desiredCenter[p]===void 0&&(l.desiredCenter[p]=(await s.center)[p]);let u=[],c=!0;for(let p=0;p<2;p++){let m=l.desiredCenter[p].evaluate_to_constant();if(!Number.isFinite(m)){c=!1;break}u.push(m)}if(c&&i.numericalCenter.every(p=>Number.isFinite(p)))return{success:!0,instructions:[{setDependency:"numericalCenter",desiredValue:u}]};if(i.nThroughPoints===0){let p=[];for(let m in n.center)p.push({setDependency:o[m].essentialCenterX,desiredValue:n.center[m],arrayKey:m});return{success:!0,instructions:p}}else return console.warn("Haven't implemented changing center of circle through points with non numerical values"),{success:!1}}},e.nearestPoint={returnDependencies:()=>({numericalCenter:{dependencyType:"stateVariable",variableName:"numericalCenter"},numericalRadius:{dependencyType:"stateVariable",variableName:"numericalRadius"}}),definition({dependencyValues:n}){let i=n.numericalRadius,s=n.numericalCenter[0],o=n.numericalCenter[1];return{setValue:{nearestPoint:function({variables:l,scales:u}){let c=l.x1.evaluate_to_constant(),p=l.x2.evaluate_to_constant();if(!(Number.isFinite(c)&&Number.isFinite(p)))return{};if(!(Number.isFinite(s)&&Number.isFinite(o)&&Number.isFinite(i)))return{};let m=Math.atan2(p-o,c-s),f={x1:s+i*Math.cos(m),x2:o+i*Math.sin(m)};return l.x3!==void 0&&(f.x3=0),f}}}}},e}async moveCircle({center:t,radius:e,throughAngles:r,transient:n,actionId:i}){let s=[],o=await this.stateValues.nThroughPoints,l=await this.stateValues.numericalPrescribedCenter;if((o<=1||l!==null)&&s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"numericalCenter",value:t}),o>=1){let u=[];r===void 0&&(r=await this.stateValues.throughAngles),e===void 0&&(e=await this.stateValues.numericalRadius);for(let c=0;c<o;c++){let p=r[c],m=[t[0]+e*Math.cos(p),t[1]+e*Math.sin(p)];u.push(m)}s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"numericalThroughPoints",value:u})}return n?await this.coreFunctions.performUpdate({updateInstructions:s,transient:n,actionId:i}):await this.coreFunctions.performUpdate({updateInstructions:s,actionId:i,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{center:t}}})}};T(wu,"componentType","circle"),T(wu,"rendererType","circle");function DT({point1:a,point2:t}){let e=(a[0]+t[0])/2,r=(a[1]+t[1])/2,n=[e,r],i=Math.sqrt(Math.pow(e-a[0],2)+Math.pow(r-a[1],2));return{numericalCenter:n,numericalRadius:i}}import Wa from"math-expressions";var Eu=class extends Rn{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.through={createComponentOfType:"_pointListComponent"},e.vertex={createComponentOfType:"point",createStateVariable:"prescribedVertex",defaultValue:null},delete e.parMin,delete e.parMax,delete e.variable,e}static returnChildGroups(){return[]}static returnStateVariableDefinitions(t){let e=Ge.returnStateVariableDefinitions(t),r=super.returnStateVariableDefinitions(t);return e.styleDescription=r.styleDescription,e.graphXmin=r.graphXmin,e.curveType={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{curveType:"function"}})},e.parMax={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{parMax:1/0}})},e.parMin={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{parMin:-1/0}})},e.aShadow={defaultValue:1,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{aShadow:!0}}),inverseDefinition:function({desiredStateVariableValues:n}){return{success:!0,instructions:[{setEssentialValue:"aShadow",value:n.aShadow}]}}},e.nThroughPoints={returnDependencies:()=>({throughAttr:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nPoints"]}}),definition:function({dependencyValues:n}){return n.throughAttr===null?{setValue:{nThroughPoints:0}}:{setValue:{nThroughPoints:n.throughAttr.stateValues.nPoints}}}},e.throughPoints={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["throughPointX","throughPoint"],returnWrappingComponents(n){return n==="throughPointX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:i,arraySize:s}){if(n==="throughPointX"){let o=i.split("_").map(l=>Number(l)-1);return o.length===2&&o.every((l,u)=>Number.isInteger(l)&&l>=0)?s?o.every((l,u)=>l<s[u])?[String(o)]:[]:[String(o)]:[]}else{let o=Number(i)-1;return Number.isInteger(o)&&o>=0?s?o<s[0]?Array.from(Array(s[1]),(l,u)=>o+","+u):[]:[o+",0"]:[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints,2]},returnArrayDependenciesByKey({arrayKeys:n}){let i={};for(let s of n){let[o,l]=s.split(","),u=Number(o)+1+"_"+(Number(l)+1);i[s]={throughAttr:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["pointX"+u]}}}return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i){let[l,u]=o.split(","),c=Number(l)+1+"_"+(Number(u)+1),p=n[o].throughAttr;if(p!==null&&p.stateValues["pointX"+c]){let m=p.stateValues["pointX"+c].evaluate_to_constant();Number.isFinite(m)?s[o]=Wa.fromAst(m):s[o]=Wa.fromAst("\uFF3F")}else s[o]=Wa.fromAst("\uFF3F")}return{setValue:{throughPoints:s}}},async inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyValuesByKey:i,dependencyNamesByKey:s,initialChange:o,stateValues:l}){if(o&&!await l.draggable)return{success:!1};let u=[];for(let c in n.throughPoints){let[p,m]=c.split(","),f=Number(p)+1+"_"+(Number(m)+1);if(i[c].throughAttr!==null&&i[c].throughAttr.stateValues["pointX"+f])u.push({setDependency:s[c].throughAttr,desiredValue:n.throughPoints[c],childIndex:0,variableIndex:0});else return{success:!1}}return{success:!0,instructions:u}}},e.numericalThroughPoints={isArray:!0,forRenderer:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints]},returnArrayDependenciesByKey({arrayKeys:n}){let i={};for(let s of n)i[s]={throughPoint:{dependencyType:"stateVariable",variableName:"throughPoint"+(Number(s)+1)}};return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:i}){let s={};for(let o of i){let l=n[o].throughPoint.map(u=>u.tree);l.every(u=>Number.isFinite(u))||(l=Array(l.length).fill(NaN)),s[o]=l}return{setValue:{numericalThroughPoints:s}}},inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyValuesByKey:i,dependencyNamesByKey:s}){let o=[];for(let l in n.numericalThroughPoints)if(i[l].throughPoint)o.push({setDependency:s[l].throughPoint,desiredValue:n.numericalThroughPoints[l].map(u=>Wa.fromAst(u))});else return{success:!1};return{success:!0,instructions:o}}},e.numericalPrescribedVertex={returnDependencies:()=>({prescribedVertex:{dependencyType:"stateVariable",variableName:"prescribedVertex"}}),definition({dependencyValues:n}){if(n.prescribedVertex===null)return{setValue:{numericalPrescribedVertex:null}};let i,s;try{i=n.prescribedVertex.get_component(0).evaluate_to_constant(),s=n.prescribedVertex.get_component(1).evaluate_to_constant(),Number.isFinite(i)&&Number.isFinite(s)||(i=NaN,s=NaN)}catch(o){i=NaN,s=NaN}return{setValue:{numericalPrescribedVertex:[i,s]}}}},e.pointsAreNumerical={returnDependencies:()=>({numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},numericalPrescribedVertex:{dependencyType:"stateVariable",variableName:"numericalPrescribedVertex"}}),definition:({dependencyValues:n})=>({setValue:{pointsAreNumerical:n.numericalThroughPoints.every(i=>Number.isFinite(i[0]))&&(!n.numericalPrescribedVertex||Number.isFinite(n.numericalPrescribedVertex[0]))},checkForActualChange:{pointsAreNumerical:!0}})},e.a={public:!0,componentType:"number",additionalStateVariablesDefined:[{variableName:"b",public:!0,componentType:"number",hasEssential:!0,defaultValue:0},{variableName:"c",public:!0,componentType:"number",hasEssential:!0,defaultValue:0},"realValued"],returnDependencies:()=>({numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},numericalPrescribedVertex:{dependencyType:"stateVariable",variableName:"numericalPrescribedVertex"},pointsAreNumerical:{dependencyType:"stateVariable",variableName:"pointsAreNumerical"},aShadow:{dependencyType:"stateVariable",variableName:"aShadow"}}),definition:function({dependencyValues:n,componentName:i}){if(!n.pointsAreNumerical)return{setValue:{a:NaN,b:NaN,c:NaN,realValued:!1}};let s,o,l,u=!0;if(n.numericalPrescribedVertex)if(n.numericalThroughPoints.length===0){let c=n.numericalPrescribedVertex,p=c[0],m=c[1];return s=n.aShadow,o=-2*s*p,l=s*p*p+m,{setValue:{a:s,b:o,c:l,realValued:!0}}}else{let c=n.numericalPrescribedVertex,p=c[0],m=c[1],f=n.numericalThroughPoints[0],d=f[0];return s=(f[1]-m)/(d-p)**2,o=-2*s*p,l=s*p*p+m,{setValue:{a:s,b:o,c:l,realValued:!0}}}if(n.numericalThroughPoints.length===0)return{setValue:{a:n.aShadow,realValued:!0},useEssentialOrDefaultValue:{b:!0,c:!0}};if(n.numericalThroughPoints.length===1){let c=n.numericalThroughPoints[0],p=c[0],m=c[1];return s=n.aShadow,o=-2*s*p,l=s*p*p+m,{setValue:{a:s,b:o,c:l,realValued:!0}}}else if(n.numericalThroughPoints.length===2){s=n.aShadow;let c=n.numericalThroughPoints[0],p=c[0],m=c[1],f=p*p,d=n.numericalThroughPoints[1],h=d[0],y=d[1],b=h*h;return p===h?m==y?(o=-2*s*p,l=s*f+m):(u=!1,s=NaN,o=NaN,l=NaN):(o=(m-y-s*(f-b))/(p-h),l=m-s*f-o*p),{setValue:{a:s,b:o,c:l,realValued:u}}}else if(n.numericalThroughPoints.length===3){let c=n.numericalThroughPoints[0],p=c[0],m=c[1],f=p*p,d=n.numericalThroughPoints[1],h=d[0],y=d[1],b=h*h,g=n.numericalThroughPoints[2],v=g[0],A=g[1],C=v*v,S=f-C,w=b-C,x=p-v,R=h-v,O=m-A,_=y-A,k=S*R-w*x;if(k===0){let B=!1,U,H,j;p===h?m===y?p===v?m==A?U=1:B=!0:(U=2,H=v,j=A):B=!0:p===v?m===A?(U=2,H=h,j=y):B=!0:h===v&&y===A?(U=2,H=h,j=y):B=!0,B?(u=!1,s=NaN,o=NaN,l=NaN):U===1?(s=n.aShadow,o=-2*s*p,l=s*p*p+m):(s=n.aShadow,o=(m-j-s*(f-H*H))/(p-H),l=m-s*f-o*p)}else s=(O*R-_*x)/k,o=(_*S-O*w)/k,l=m-o*p-s*f;return{setValue:{a:s,b:o,c:l,realValued:u}}}else return console.warn("Haven't implemented parabola through more than 3 points"),{setValue:{a:NaN,b:NaN,c:NaN,realValued:!1}}},inverseDefinition:async function({desiredStateVariableValues:n,dependencyValues:i,stateValues:s,workspace:o}){if(!i.pointsAreNumerical)return{success:!1};let l={},u=function(p){if(Number.isFinite(p))return{success:!0,value:p};if(p instanceof Wa.class){let m=p.evaluate_to_constant();if(Number.isFinite(m))return{success:!0,value:m}}return{success:!1}};if(n.a!==void 0){let p=u(n.a);if(p.success)l.a=p.value;else return{success:!1}}if(n.b!==void 0){let p=u(n.b);if(p.success)l.b=p.value;else return{success:!1}}if(n.c!==void 0){let p=u(n.c);if(p.success)l.c=p.value;else return{success:!1}}Object.assign(o,l);let c=async function(p){return o[p]!==void 0?o[p]:await s[p]};if(i.numericalThroughPoints.length===0){let p=[];return l.a!==void 0&&p.push({setDependency:"aShadow",desiredValue:l.a}),l.b!==void 0&&p.push({setEssentialValue:"b",value:l.b}),l.c!==void 0&&p.push({setEssentialValue:"c",value:l.c}),{success:!0,instructions:p}}else if(i.numericalThroughPoints.length===1){let p=await c("a"),m=await c("b"),f=await c("c"),d=-m/(2*p),h=f-m*m/(4*p),y=[{setDependency:"numericalThroughPoints",desiredValue:[[d,h]]}];return l.a!==void 0&&y.push({setDependency:"aShadow",desiredValue:l.a}),{success:!0,instructions:y}}else if(i.numericalThroughPoints.length===2){let p=await c("a"),m=await c("b"),f=await c("c"),h=i.numericalThroughPoints[0][0],b=i.numericalThroughPoints[1][0];if(h===b){h=-m/(2*p);let g=f-m*m/(4*p),v=[{setDependency:"numericalThroughPoints",desiredValue:[[h,g],[h,g]]}];return l.a!==void 0&&v.push({setDependency:"aShadow",desiredValue:l.a}),{success:!0,instructions:v}}else{let g=p*h*h+m*h+f,v=p*b*b+m*b+f,A=[{setDependency:"numericalThroughPoints",desiredValue:[[h,g],[b,v]]}];return l.a!==void 0&&A.push({setDependency:"aShadow",desiredValue:l.a}),{success:!0,instructions:A}}}else if(i.numericalThroughPoints.length===3){let p=await c("a"),m=await c("b"),f=await c("c"),h=i.numericalThroughPoints[0][0],b=i.numericalThroughPoints[1][0],v=i.numericalThroughPoints[2][0],A=3,C;if(h===b?h===v?A=1:(A=2,C=3):h===v?(A=2,C=2):b===v&&(A=2,C=1),A===3){let S=p*h*h+m*h+f,w=p*b*b+m*b+f,x=p*v*v+m*v+f,R=[{setDependency:"numericalThroughPoints",desiredValue:[[h,S],[b,w],[v,x]]}];return l.a!==void 0&&R.push({setDependency:"aShadow",desiredValue:l.a}),{success:!0,instructions:R}}else if(A===2)if(C===1){let S=h,w=b,x=p*S*S+m*S+f,R=p*w*w+m*w+f,O=[{setDependency:"numericalThroughPoints",desiredValue:[[S,x],[w,R],[w,R]]}];return l.a!==void 0&&O.push({setDependency:"aShadow",desiredValue:l.a}),{success:!0,instructions:O}}else if(C===2){let S=h,w=b,x=p*S*S+m*S+f,R=p*w*w+m*w+f,O=[{setDependency:"numericalThroughPoints",desiredValue:[[S,x],[w,R],[S,x]]}];return l.a!==void 0&&O.push({setDependency:"aShadow",desiredValue:l.a}),{success:!0,instructions:O}}else{let S=h,w=v,x=p*S*S+m*S+f,R=p*w*w+m*w+f,O=[{setDependency:"numericalThroughPoints",desiredValue:[[S,x],[S,x],[w,R]]}];return l.a!==void 0&&O.push({setDependency:"aShadow",desiredValue:l.a}),{success:!0,instructions:O}}else{h=-m/(2*p);let S=f-m*m/(4*p),w=[{setDependency:"numericalThroughPoints",desiredValue:[[h,S],[h,S],[h,S]]}];return l.a!==void 0&&w.push({setDependency:"aShadow",desiredValue:l.a}),{success:!0,instructions:w}}}else return{success:!1}}},e.vertex={public:!0,componentType:"math",isArray:!0,entryPrefixes:["vertexX"],returnWrappingComponents(n){return n==="vertexX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey(){return{globalDependencies:{a:{dependencyType:"stateVariable",variableName:"a"},b:{dependencyType:"stateVariable",variableName:"b"},c:{dependencyType:"stateVariable",variableName:"c"},realValued:{dependencyType:"stateVariable",variableName:"realValued"}}}},arrayDefinitionByKey:function({globalDependencyValues:n}){let i={};return n.realValued&&n.a!==0?(i[0]=Wa.fromAst(-n.b/(2*n.a)),i[1]=Wa.fromAst(n.c-n.b**2/(4*n.a))):(i[0]=Wa.fromAst("\uFF3F"),i[1]=Wa.fromAst("\uFF3F")),{setValue:{vertex:i}}},inverseArrayDefinitionByKey:async function({desiredStateVariableValues:n,globalDependencyValues:i,workspace:s,stateValues:o}){let l;if("0"in n.vertex?l=n.vertex[0].evaluate_to_constant():s.x!==void 0?l=s.x:l=(await o.vertex)[0].tree,Number.isFinite(l))s.x=l;else return{success:!1};let u;if("1"in n.vertex?u=n.vertex[1].evaluate_to_constant():s.y!==void 0?u=s.y:u=(await o.vertex)[1].tree,Number.isFinite(u))s.y=u;else return{success:!1};let c=i.a,p=-2*c*l,m=u+c*l*l;return{success:!0,instructions:[{setDependency:"b",desiredValue:p,additionalDependencyValues:{c:m}}]}}},e.equation={public:!0,componentType:"math",additionalProperties:{simplify:"numberspreserveorder",displaysmallaszero:!0},returnDependencies:()=>({a:{dependencyType:"stateVariable",variableName:"a"},b:{dependencyType:"stateVariable",variableName:"b"},c:{dependencyType:"stateVariable",variableName:"c"}}),definition:function({dependencyValues:n}){let i=["=","y",["+",["*",n.a,["^","x",2]],["*",n.b,"x"],n.c]];return{setValue:{equation:Wa.fromAst(i).evaluate_numbers({skip_ordering:!0})}}}},e.fs={forRenderer:!0,isArray:!0,entryPrefixes:["f"],additionalStateVariablesDefined:[{variableName:"fDefinitions",isArray:!0,forRenderer:!0}],returnArraySizeDependencies:()=>({}),returnArraySize:()=>[1],returnArrayDependenciesByKey(){return{globalDependencies:{a:{dependencyType:"stateVariable",variableName:"a"},b:{dependencyType:"stateVariable",variableName:"b"},c:{dependencyType:"stateVariable",variableName:"c"}}}},arrayDefinitionByKey({globalDependencyValues:n}){return{setValue:{fs:[function(s){return n.a*s*s+n.b*s+n.c}],fDefinitions:[{functionType:"formula",formula:["+",["*",n.a,"x","x"],["*",n.b,"x"],n.c],variables:["x"],nInputs:1,nOutputs:1,domain:null}]}}}},e.f={isAlias:!0,targetVariableName:"f1"},e.nearestPoint={returnDependencies:()=>({f:{dependencyType:"stateVariable",variableName:"f"},a:{dependencyType:"stateVariable",variableName:"a"},b:{dependencyType:"stateVariable",variableName:"b"},c:{dependencyType:"stateVariable",variableName:"c"}}),definition({dependencyValues:n,componentName:i}){let s=!(Number.isFinite(n.a)&&Number.isFinite(n.b)&&Number.isFinite(n.c));return{setValue:{nearestPoint:function({variables:o,scales:l}){if(s)return{};let u=l[0],c=l[1],p=o.x1.evaluate_to_constant(),m=o.x2.evaluate_to_constant();if(!(Number.isFinite(p)&&Number.isFinite(m)))return{};p/=u,m/=c;let f=n.a*u*u/c,d=n.b*u/c,h=n.c/c;if(f===0){let O=d*d+1,_={};return _.x1=(p+d*m-d*h)/O*u,_.x2=(d*(p+d*m)+h)/O*c,o.x3!==void 0&&(_.x3=0),_}let y=h-m,b=2*f**2,g=3*f*d/b,v=(2*f*y+d**2+1)/b,A=(d*y-p)/b,C=Sq(g,v,A,1e-14),S=C[0],w=n.f(S*u)/c,x=(p-S)**2+(m-w)**2;for(let O of C.slice(1)){let _=O,k=n.f(_*u)/c,B=(p-_)**2+(m-k)**2;B<x&&(S=_,w=k,x=B)}let R={x1:S*u,x2:w*c};return o.x3!==void 0&&(R.x3=0),R}}}}},e}};T(Eu,"componentType","parabola"),T(Eu,"rendererType","curve");function Sq(a,t,e,r=1e-10){let[n,i]=[-1/3*a*a+t,2/27*a*a*a-1/3*a*t+e];if(Math.abs(i)<=r){if(Math.abs(n)<=r)return[-a/3];let p=Math.sqrt(Math.abs(n));return n<0?[-p-a/3,-a/3,p-a/3]:[-a/3]}let s=-27*i*i-4*n*n*n;if(Math.abs(s)<=r){let p=Math.cbrt(-i/2);return[2*p-a/3,-p-a/3]}if(s>0){let p=Math.sqrt(s/108),m=Math.sqrt(Math.cbrt(i*i/4+s/108))*2,f=Math.atan2(p,-i/2);return[Math.cos(f/3),Math.cos(f/3+2*Math.PI/3),Math.cos(f/3-2*Math.PI/3)].sort((d,h)=>d-h).map(d=>m*d-a/3)}let o=Math.sqrt(-s/108),l=Math.cbrt(-i/2+o),u=Math.cbrt(-i/2-o);return[l+u-a/3]}import $a from"math-expressions";var Ru=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.alwaysVisible={createComponentOfType:"boolean",createStateVariable:"alwaysVisible",defaultValue:!1,public:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=Ia({componentList:r});return n.success!==!0?{success:!1}:{success:!0,newChildren:n.pieces.map(function(i){return i.length>1||typeof i[0]=="string"?{componentType:"controlVectors",children:[{componentType:"vector",children:i}]}:i[0]})}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"controlVectors",componentTypes:["controlVectors"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nControls={returnDependencies:()=>({nParentPoints:{dependencyType:"parentStateVariable",variableName:"nThroughPoints",skipComponentNames:!0}}),definition({dependencyValues:e}){let r=e.nParentPoints;return Number.isInteger(r)&&r>=0||(r=0),{setValue:{nControls:r}}}},t.pointIndMap={returnDependencies:()=>({controlChildren:{dependencyType:"child",childGroups:["controlVectors"],variableNames:["pointNumber"]}}),definition:function({dependencyValues:e}){let r=[],n=-1;for(let[i,s]of e.controlChildren.entries()){let o=s.stateValues.pointNumber;Number.isFinite(o)?n=Math.round(o)-1:n+=1,r[n]=i}return{setValue:{pointIndMap:r}}}},t.directions={isArray:!0,entryPrefixes:["direction"],hasEssential:!0,defaultValueByArrayKey:()=>"none",stateVariablesDeterminingDependencies:["pointIndMap"],returnArraySizeDependencies:()=>({nControls:{dependencyType:"stateVariable",variableName:"nControls"}}),returnArraySize({dependencyValues:e}){return[e.nControls]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={};for(let i of e){let s=r.pointIndMap[i];s!==void 0&&(n[i]={controlChild:{dependencyType:"child",childGroups:["controlVectors"],variableNames:["direction"],childIndices:[s]}})}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={},i={};for(let s of r){let o=e[s].controlChild;o&&o.length===1?n[s]=o[0].stateValues.direction:i[s]=!0}return{setValue:{directions:n},useEssentialOrDefaultValue:{directions:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,dependencyValuesByKey:n}){let i=[],s={};for(let o in e.directions){let l=n[o].controlChild;l&&l.length===1?i.push({setDependency:r[o].controlChild,desiredValue:e.directions[o],childIndex:0,variableIndex:0}):s[o]=e.directions[o]}return Object.keys(s).length>0&&i.push({setEssentialValue:"directions",value:s}),{success:!0,instructions:i}}},t.hiddenControls={isArray:!0,entryPrefixes:["hiddenControl"],hasEssential:!0,defaultValueByArrayKey:()=>!1,stateVariablesDeterminingDependencies:["pointIndMap"],returnArraySizeDependencies:()=>({nControls:{dependencyType:"stateVariable",variableName:"nControls"}}),returnArraySize({dependencyValues:e}){return[e.nControls]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={};for(let i of e){let s=r.pointIndMap[i];s!==void 0&&(n[i]={controlChild:{dependencyType:"child",childGroups:["controlVectors"],variableNames:["hide"],childIndices:[s]}})}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={},i={};for(let s of r){let o=e[s].controlChild;o&&o.length===1?n[s]=o[0].stateValues.hide:i[s]=!0}return{setValue:{hiddenControls:n},useEssentialOrDefaultValue:{hiddenControls:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,dependencyValuesByKey:n}){let i=[],s={};for(let o in e.hiddenControls){let l=n[o].controlChild;l&&l.length===1?i.push({setDependency:r[o].controlChild,desiredValue:e.hiddenControls[o],childIndex:0,variableIndex:0}):s[o]=e.hiddenControls[o]}return Object.keys(s).length>0&&i.push({setEssentialValue:"hiddenControls",value:s}),{success:!0,instructions:i}}},t.nDimensions={returnDependencies(){return{nParentDimensions:{dependencyType:"parentStateVariable",variableName:"nDimensions"}}},definition:function({dependencyValues:e}){let r=e.nParentDimensions;return Number.isInteger(r)&&r>=0||(r=0),{setValue:{nDimensions:r},checkForActualChange:{nDimensions:!0}}}},t.essentialSymmetricControls={isArray:!0,entryPrefixes:["essentialSymmetricControl"],nDimensions:2,hasEssential:!0,defaultValueByArrayKey:()=>$a.fromAst(1),returnArraySizeDependencies:()=>({nControls:{dependencyType:"stateVariable",variableName:"nControls"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nControls,e.nDimensions]},returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey({arrayKeys:e}){let r={};for(let n of e){let i=n.split(",").map(s=>Number(s));r[n]=!0}return{useEssentialOrDefaultValue:{essentialSymmetricControls:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let r=[],n={};for(let i in e.essentialSymmetricControls)n[i]=e.essentialSymmetricControls[i];return Object.keys(n).length>0&&r.push({setEssentialValue:"essentialSymmetricControls",value:n}),{success:!0,instructions:r}}},t.controls={isArray:!0,entryPrefixes:["control"],nDimensions:3,hasEssential:!0,shadowVariable:!0,defaultValueByArrayKey:()=>$a.fromAst(1),stateVariablesDeterminingDependencies:["pointIndMap","directions"],returnArraySizeDependencies:()=>({nControls:{dependencyType:"stateVariable",variableName:"nControls"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nControls,2,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={};for(let i of e){let s=i.split(",").map(u=>Number(u)),o=s.map(u=>u+1);n[i]={direction:{dependencyType:"stateVariable",variableName:"direction"+o[0]}};let l=r.directions[s[0]];if(l!=="none"&&(s[1]===0||s[1]===1)){let u=r.pointIndMap[s[0]];u!==void 0&&(l==="symmetric"||l==="previous"&&s[1]===0||l==="next"&&s[1]===1?n[i].controlChild={dependencyType:"child",childGroups:["controlVectors"],variableNames:["vectorX1_"+o[2]],childIndices:[u]}:l==="both"&&(n[i].controlChild={dependencyType:"child",childGroups:["controlVectors"],variableNames:["vectorX"+o[1]+"_"+o[2]],childIndices:[u]})),l==="symmetric"&&(n[i].essentialSymmetricControl={dependencyType:"stateVariable",variableName:"essentialSymmetricControl"+o[0]+"_"+o[2]})}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r,componentName:n}){let i={},s={};for(let o of r){let l=o.split(",").map(p=>Number(p)),u=l.map(p=>p+1),c=e[o].direction;if(l[1]===0)if(c==="none"||c==="next")i[o]=null;else{let p=e[o].controlChild,m=!0;if(p&&p.length===1){let f=p[0].stateValues["vectorX1_"+u[2]];f&&(m=!1,f=f.evaluate_to_constant(),Number.isFinite(f)||(f=NaN),i[o]=$a.fromAst(f))}m&&(c==="symmetric"?i[o]=e[o].essentialSymmetricControl:s[o]=!0)}else if(l[1]===1)if(c==="none"||c==="previous")i[o]=null;else{let p=e[o].controlChild,m=!0;if(p&&p.length===1)if(c==="both"){let f=p[0].stateValues["vectorX2_"+u[2]];f&&(m=!1,f=f.evaluate_to_constant(),Number.isFinite(f)||(f=NaN),i[o]=$a.fromAst(f))}else{let f=p[0].stateValues["vectorX1_"+u[2]];f&&(m=!1,f=f.evaluate_to_constant(),Number.isFinite(f)||(f=NaN),c==="symmetric"?i[o]=$a.fromAst(-f):i[o]=$a.fromAst(f))}m&&(c==="symmetric"?e[o].essentialSymmetricControl&&(i[o]=$a.fromAst(-e[o].essentialSymmetricControl.tree)):s[o]=!0)}}return{setValue:{controls:i},useEssentialOrDefaultValue:{controls:s}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r,dependencyValuesByKey:n}){let i=[],s={};for(let o in e.controls){let l=o.split(",").map(p=>Number(p)),u=l.map(p=>p+1),c=n[o].direction;if(c){if(l[1]===0){if(!(c==="none"||c==="next")){let p=n[o].controlChild,m=!0;if(p&&p.length===1&&p[0].stateValues["vectorX1_"+u[2]]&&(m=!1,i.push({setDependency:r[o].controlChild,desiredValue:e.controls[o],childIndex:0,variableIndex:0})),m){let f=e.controls[o].evaluate_to_constant();Number.isFinite(f)||(f=NaN),f=$a.fromAst(f),c==="symmetric"?i.push({setDependency:r[o].essentialSymmetricControl,desiredValue:f}):s[o]=f}}}else if(l[1]===1&&!(c==="none"||c==="previous")){let p=n[o].controlChild,m=!0;p&&p.length===1&&(c==="both"?p[0].stateValues["vectorX2_"+u[2]]&&(m=!1):p[0].stateValues["vectorX1_"+u[2]]&&(m=!1));let f;c==="symmetric"?f=$a.fromAst(["-",e.controls[o].tree]):f=e.controls[o],m?(f=f.evaluate_to_constant(),Number.isFinite(f)||(f=NaN),f=$a.fromAst(f),c==="symmetric"?i.push({setDependency:r[o].essentialSymmetricControl,desiredValue:f}):s[o]=f):i.push({setDependency:r[o].controlChild,desiredValue:f,childIndex:0,variableIndex:0})}}}return Object.keys(s).length>0&&i.push({setEssentialValue:"controls",value:s}),{success:!0,instructions:i}}},t}};T(Ru,"componentType","bezierControls"),T(Ru,"rendererType","container");var Ci=class extends J{static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=Ia({componentList:r});return n.success!==!0?{success:!1}:{success:!0,newChildren:n.pieces.map(function(i){return i.length>1||typeof i[0]=="string"?{componentType:"vector",children:i}:i[0]})}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"vectors",componentTypes:["vector"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nVectors={returnDependencies:()=>({vectorChildren:{dependencyType:"child",childGroups:["vectors"],skipComponentNames:!0}}),definition:({dependencyValues:e})=>({setValue:{nVectors:e.vectorChildren.length},checkForActualChange:{nVectors:!0}})},t.nDimensions={returnDependencies:()=>({vectorChildren:{dependencyType:"child",childGroups:["vectors"],variableNames:["nDimensions"],skipPlaceholders:!0}}),definition:function({dependencyValues:e}){let r;if(e.vectorChildren.length===0)r=2;else{r=1;for(let n of e.vectorChildren)Number.isFinite(n.stateValues.nDimensions)&&(r=Math.max(r,n.stateValues.nDimensions))}return{setValue:{nDimensions:r},checkForActualChange:{nDimensions:!0}}}},t.vectors={isArray:!0,nDimensions:2,entryPrefixes:["vectorX","vector"],getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="vectorX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},returnArraySizeDependencies:()=>({nVectors:{dependencyType:"stateVariable",variableName:"nVectors"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nVectors,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let[i,s]=n.split(",");r[n]={vectorChild:{dependencyType:"child",childGroups:["vectors"],variableNames:["x"+(Number(s)+1)],childIndices:[i]}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=i.split(",")[1],o=e[i].vectorChild[0];o&&(n[i]=o.stateValues["x"+(Number(s)+1)])}return{setValue:{vectors:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r}){let n=[];for(let i in e.vectors)n.push({setDependency:r[i].vectorChild,desiredValue:e.vectors[i],childIndex:0,variableIndex:0});return{success:!0,instructions:n}}},t}};T(Ci,"componentType","_vectorListComponent"),T(Ci,"rendererType","container"),T(Ci,"renderChildren",!0);var Nm=class extends Ci{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.direction={createComponentOfType:"text",createStateVariable:"direction",defaultValue:"symmetric",public:!0,toLowerCase:!0,validValues:["symmetric","previous","next","both","none"]},e.pointNumber={createComponentOfType:"number",createStateVariable:"pointNumber",defaultValue:null,public:!0},e}};T(Nm,"componentType","controlVectors");var Eo=class extends J{static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=Ia({componentList:r});return n.success!==!0?{success:!1}:{success:!0,newChildren:n.pieces.map(function(i){return i.length>1||typeof i[0]=="string"?{componentType:"point",children:i}:i[0]})}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"points",componentTypes:["point"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nPoints={returnDependencies:()=>({pointChildren:{dependencyType:"child",childGroups:["points"],skipComponentNames:!0}}),definition:function({dependencyValues:e}){return{setValue:{nPoints:e.pointChildren.length},checkForActualChange:{nPoints:!0}}}},t.nDimensions={returnDependencies:()=>({pointChildren:{dependencyType:"child",childGroups:["points"],variableNames:["nDimensions"],skipPlaceholders:!0}}),definition:function({dependencyValues:e}){let r;if(e.pointChildren.length===0)r=2;else{r=1;for(let n of e.pointChildren)Number.isFinite(n.stateValues.nDimensions)&&(r=Math.max(r,n.stateValues.nDimensions))}return{setValue:{nDimensions:r},checkForActualChange:{nDimensions:!0}}}},t.points={isArray:!0,nDimensions:2,entryPrefixes:["pointX","point"],getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="pointX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},returnArraySizeDependencies:()=>({nPoints:{dependencyType:"stateVariable",variableName:"nPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nPoints,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let[i,s]=n.split(",");r[n]={pointChild:{dependencyType:"child",childGroups:["points"],variableNames:["x"+(Number(s)+1)],childIndices:[i]}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=i.split(",")[1],o=e[i].pointChild[0];o&&(n[i]=o.stateValues["x"+(Number(s)+1)])}return{setValue:{points:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r}){let n=[];for(let i in e.points)n.push({setDependency:r[i].pointChild,desiredValue:e.points[i],childIndex:0,variableIndex:0});return{success:!0,instructions:n}}},t}};T(Eo,"componentType","_pointListComponent"),T(Eo,"rendererType","container"),T(Eo,"renderChildren",!0);var Ro=class extends J{static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=r.reduce(function(i,s){return typeof s=="string"?[...i,...s.split(/\s+/).filter(o=>o).map(o=>({componentType:"line",children:[o]}))]:[...i,s]},[]);return{success:!0,newChildren:n}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"lines",componentTypes:["line"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nLines={returnDependencies:()=>({lineChildren:{dependencyType:"child",childGroups:["lines"],skipComponentNames:!0}}),definition:function({dependencyValues:e}){return{setValue:{nLines:e.lineChildren.length},checkForActualChange:{nLines:!0}}}},t.lineNames={isArray:!0,entryPrefixes:["lineName"],returnArraySizeDependencies:()=>({nLines:{dependencyType:"stateVariable",variableName:"nLines"}}),returnArraySize({dependencyValues:e}){return[e.nLines]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={lineChild:{dependencyType:"child",childGroups:["lines"],childIndices:[n]}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=e[i].lineChild[0];s&&(n[i]=s.componentName)}return{setValue:{lineNames:n}}}},t}};T(Ro,"componentType","_lineListComponent"),T(Ro,"rendererType","container"),T(Ro,"renderChildren",!0);var Cm=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.hide={default:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t),r=e.newLeaf({name:"AtLeastZeroAngles",componentType:"angle",comparison:"atLeast",number:0}),n=nh(l=>({componentType:"angle",children:[{componentType:"math",children:l}]})),i=e.newLeaf({name:"AtLeastOneString",componentType:"string",comparison:"atLeast",number:1}),s=e.newLeaf({name:"AtLeastOneMath",componentType:"math",comparison:"atLeast",number:1}),o=e.newOperator({name:"StringsAndMaths",operator:"or",propositions:[i,s],requireConsecutive:!0,isSugar:!0,replacementFunction:n});return e.newOperator({name:"AnglesXorSugar",operator:"xor",propositions:[r,o],setAsBase:!0}),e}updateState(t={}){if(t.init&&(this._state.angles={trackChanges:!0}),super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.angles=!0,this.unresolvedState.nAngles=!0;return}if(this.currentTracker.trackChanges.childrenChanged(this.componentName)){delete this.unresolvedState.angles,delete this.unresolvedState.nAngles;let n=this.childLogic.returnMatches("AtLeastZeroAngles");this.state.nAngles=n.length,this.state.angles=n.map(i=>this.activeChildren[i])}}initializeRenderer(){this.renderer===void 0&&(this.renderer=new this.availableRenderers.container({key:this.componentName}))}updateChildrenWhoRender(){this.childrenWhoRender=this.state.angles.map(t=>t.componentName)}};T(Cm,"componentType","_angleListComponent");import mn from"math-expressions";var xo=class extends Ge{actions={moveVector:this.moveVector.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.headDraggable={createComponentOfType:"boolean",createStateVariable:"headDraggable",defaultValue:!0,public:!0,forRenderer:!0},e.tailDraggable={createComponentOfType:"boolean",createStateVariable:"tailDraggable",defaultValue:!0,public:!0,forRenderer:!0},e.x={createComponentOfType:"math"},e.y={createComponentOfType:"math"},e.z={createComponentOfType:"math"},e.xs={createComponentOfType:"mathList"},e.displacement={createComponentOfType:"vector"},e.head={createComponentOfType:"point"},e.tail={createComponentOfType:"point"},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let s=hs({childrenToComponentFunction:o=>({componentType:"math",children:o}),mustStripOffOuterParentheses:!0})({matchedChildren:r});return!s.success&&r.length===1?{success:!0,newAttributes:{x:{component:{componentType:"math",children:r}}}}:(s.success&&(s.newAttributes={xs:{component:{componentType:"mathList",children:s.newChildren,skipSugar:!0}}},delete s.newChildren),s)};return t.push({childrenRegex:/s+(.*s)?/,replacementFunction:e}),t}static returnChildGroups(){return[{group:"points",componentTypes:["point"]},{group:"vectors",componentTypes:["vector"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let r="";return e.selectedStyle.lineWidth>=4?r+="thick ":e.selectedStyle.lineWidth<=1&&(r+="thin "),e.selectedStyle.lineStyle==="dashed"?r+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=e.selectedStyle.lineColor,{setValue:{styleDescription:r}}}},t.displacementShadow={defaultValue:null,hasEssential:!0,essentialVarName:"displacement",set:se,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{displacementShadow:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"displacementShadow",value:se(e.displacementShadow)}]}}},t.headShadow={defaultValue:null,hasEssential:!0,essentialVarName:"head",set:se,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{headShadow:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"headShadow",value:se(e.headShadow)}]}}},t.tailShadow={defaultValue:null,hasEssential:!0,essentialVarName:"tail",set:se,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{tailShadow:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"tailShadow",value:se(e.tailShadow)}]}}},t.sourceOfDisplacement={returnDependencies:()=>({xAttr:{dependencyType:"attributeComponent",attributeName:"x"},yAttr:{dependencyType:"attributeComponent",attributeName:"y"},zAttr:{dependencyType:"attributeComponent",attributeName:"z"},xsAttr:{dependencyType:"attributeComponent",attributeName:"xs"},displacementAttr:{dependencyType:"attributeComponent",attributeName:"displacement"},pointChild:{dependencyType:"child",childGroups:["points"]},vectorChild:{dependencyType:"child",childGroups:["vectors"]}}),definition({dependencyValues:e}){let r=null;return e.vectorChild.length>0?r="vectorChild":e.pointChild.length>0?r="pointChild":e.displacementAttr!==null?r="displacementAttr":e.xsAttr!==null?r="xsAttr":(e.xAttr!==null||e.yAttr!==null||e.zAttr!==null)&&(r="componentAttrs"),{setValue:{sourceOfDisplacement:r}}}},t.basedOnHead={returnDependencies:()=>({headAttr:{dependencyType:"attributeComponent",attributeName:"head"},headShadow:{dependencyType:"stateVariable",variableName:"headShadow"},tailAttr:{dependencyType:"attributeComponent",attributeName:"tail"},sourceOfDisplacement:{dependencyType:"stateVariable",variableName:"sourceOfDisplacement"}}),definition:function({dependencyValues:e}){return e.tailAttr!==null&&e.sourceOfDisplacement!==null?(e.headAttr!==null&&console.warn("Vector is prescribed by head, tail, and displacement.  Ignoring specified head."),{setValue:{basedOnHead:!1},checkForActualChange:{basedOnHead:!0}}):e.headAttr!==null?{setValue:{basedOnHead:!0},checkForActualChange:{basedOnHead:!0}}:{setValue:{basedOnHead:e.headShadow!==null},checkForActualChange:{basedOnHead:!0}}}},t.basedOnTail={returnDependencies:()=>({tailAttr:{dependencyType:"attributeComponent",attributeName:"tail"},tailShadow:{dependencyType:"stateVariable",variableName:"tailShadow"}}),definition:function({dependencyValues:e}){return e.tailAttr!==null?{setValue:{basedOnTail:!0},checkForActualChange:{basedOnTail:!0}}:{setValue:{basedOnTail:e.tailShadow!==null},checkForActualChange:{basedOnTail:!0}}}},t.basedOnDisplacement={returnDependencies:()=>({sourceOfDisplacement:{dependencyType:"stateVariable",variableName:"sourceOfDisplacement"},displacementShadow:{dependencyType:"stateVariable",variableName:"displacementShadow"}}),definition:function({dependencyValues:e}){return e.sourceOfDisplacement!==null?{setValue:{basedOnDisplacement:!0},checkForActualChange:{basedOnDisplacement:!0}}:{setValue:{basedOnDisplacement:e.displacementShadow!==null},checkForActualChange:{basedOnDisplacement:!0}}}},t.nDimDisplacement={stateVariablesDeterminingDependencies:["basedOnDisplacement","basedOnHead","basedOnTail"],returnDependencies({stateValues:e}){let r={basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},sourceOfDisplacement:{dependencyType:"stateVariable",variableName:"sourceOfDisplacement"},displacementShadow:{dependencyType:"stateVariable",variableName:"displacementShadow"},displacementAttr:{dependencyType:"attributeComponent",attributeName:"displacement",variableNames:["nDimensions"]},vectorChild:{dependencyType:"child",childGroups:["vectors"],variableNames:["nDimensions"]},pointChild:{dependencyType:"child",childGroups:["points"],variableNames:["nDimensions"]},xAttr:{dependencyType:"attributeComponent",attributeName:"x"},yAttr:{dependencyType:"attributeComponent",attributeName:"y"},zAttr:{dependencyType:"attributeComponent",attributeName:"z"},xsAttr:{dependencyType:"attributeComponent",attributeName:"xs",variableNames:["nComponents"]}};return e.basedOnDisplacement||(e.basedOnHead&&(r.nDimHead={dependencyType:"stateVariable",variableName:"nDimHead"}),e.basedOnTail&&(r.nDimTail={dependencyType:"stateVariable",variableName:"nDimTail"})),r},definition:function({dependencyValues:e}){let r;if(e.basedOnDisplacement)switch(e.sourceOfDisplacement){case"vectorChild":r=e.vectorChild[0].stateValues.nDimensions;break;case"pointChild":r=e.pointChild[0].stateValues.nDimensions;break;case"displacementAttr":r=e.displacementAttr.stateValues.nDimensions;break;case"xsAttr":r=e.xsAttr.stateValues.nComponents;break;case"componentAttrs":e.zAttr!==null?r=3:e.yAttr!==null?r=2:r=1;break;default:let n=e.displacementShadow.tree;Array.isArray(n)&&["tuple","vector"].includes(n[0])?r=n.length-1:r=1}else e.basedOnHead?e.basedOnTail?e.nDimHead===e.nDimTail?r=e.nDimHead:r=NaN:r=e.nDimHead:e.basedOnTail?r=e.nDimTail:r=2;return{setValue:{nDimDisplacement:r},checkForActualChange:{nDimDisplacement:!0}}}},t.nDimHead={stateVariablesDeterminingDependencies:["basedOnDisplacement","basedOnHead","basedOnTail"],returnDependencies({stateValues:e}){let r={basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},headShadow:{dependencyType:"stateVariable",variableName:"headShadow"},headAttr:{dependencyType:"attributeComponent",attributeName:"head",variableNames:["nDimensions"]}};return e.basedOnHead||(e.basedOnTail&&(r.nDimTail={dependencyType:"stateVariable",variableName:"nDimTail"}),e.basedOnDisplacement&&(r.nDimDisplacement={dependencyType:"stateVariable",variableName:"nDimDisplacement"})),r},definition:function({dependencyValues:e}){let r;if(e.basedOnHead){if(e.headAttr!==null)r=e.headAttr.stateValues.nDimensions;else if(e.headShadow){let n=e.headShadow.tree;Array.isArray(n)&&["tuple","vector"].includes(n[0])?r=n.length-1:r=2}}else e.basedOnDisplacement?e.basedOnTail?e.nDimDisplacement===e.nDimTail?r=e.nDimDisplacement:r=NaN:r=e.nDimDisplacement:e.basedOnTail?r=e.nDimTail:r=2;return{setValue:{nDimHead:r},checkForActualChange:{nDimHead:!0}}}},t.nDimTail={stateVariablesDeterminingDependencies:["basedOnDisplacement","basedOnHead","basedOnTail"],returnDependencies({stateValues:e}){let r={basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},tailShadow:{dependencyType:"stateVariable",variableName:"tailShadow"},tailAttr:{dependencyType:"attributeComponent",attributeName:"tail",variableNames:["nDimensions"]}};return e.basedOnTail||(e.basedOnHead&&(r.nDimHead={dependencyType:"stateVariable",variableName:"nDimHead"}),e.basedOnDisplacement&&(r.nDimDisplacement={dependencyType:"stateVariable",variableName:"nDimDisplacement"})),r},definition:function({dependencyValues:e}){let r;if(e.basedOnTail){if(e.tailAttr!==null)r=e.tailAttr.stateValues.nDimensions;else if(e.tailShadow){let n=e.tailShadow.tree;Array.isArray(n)&&["tuple","vector"].includes(n[0])?r=n.length-1:r=2}}else e.basedOnDisplacement?e.basedOnHead?e.nDimDisplacement===e.nDimHead?r=e.nDimDisplacement:r=NaN:r=e.nDimDisplacement:e.basedOnHead?r=e.nDimHead:r=2;return{setValue:{nDimTail:r},checkForActualChange:{nDimTail:!0}}}},t.nDimensions={public:!0,componentType:"number",returnDependencies:()=>({basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},nDimDisplacement:{dependencyType:"stateVariable",variableName:"nDimDisplacement"},nDimHead:{dependencyType:"stateVariable",variableName:"nDimHead"},nDimTail:{dependencyType:"stateVariable",variableName:"nDimTail"}}),definition:function({dependencyValues:e}){let r;if(e.basedOnDisplacement){if(e.basedOnTail){if(e.nDimDisplacement!==e.nDimTail)return console.warn("nDimensions mismatch in vector"),{setValue:{nDimensions:NaN}}}else if(e.basedOnHead&&e.nDimDisplacement!==e.nDimHead)return console.warn("nDimensions mismatch in vector"),{setValue:{nDimensions:NaN}};r=e.nDimDisplacement}else if(e.basedOnTail){if(e.basedOnHead&&e.nDimTail!==e.nDimHead)return console.warn("nDimensions mismatch in vector"),{setValue:{nDimensions:NaN}};r=e.nDimTail}else e.basedOnHead?r=e.nDimHead:r=2;return{setValue:{nDimensions:r},checkForActualChange:{nDimensions:!0}}}},t.displacement={public:!0,componentType:"math",isArray:!0,entryPrefixes:["x"],hasEssential:!0,essentialVarName:"displacement2",set:se,returnWrappingComponents(e){return e==="x"?[]:[["vector",{componentType:"mathList",isAttribute:"xs"}]]},stateVariablesDeterminingDependencies:["basedOnDisplacement","basedOnHead","sourceOfDisplacement"],returnArraySizeDependencies:()=>({nDimDisplacement:{dependencyType:"stateVariable",variableName:"nDimDisplacement"}}),returnArraySize({dependencyValues:e}){return[e.nDimDisplacement]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},displacementShadow:{dependencyType:"stateVariable",variableName:"displacementShadow"},sourceOfDisplacement:{dependencyType:"stateVariable",variableName:"sourceOfDisplacement"}},i={};for(let s of e){let o=Number(s)+1;i[s]={xsAttr:{dependencyType:"attributeComponent",attributeName:"xs",variableNames:["math"+o]},displacementAttr:{dependencyType:"attributeComponent",attributeName:"displacement",variableNames:["x"+o]},pointChild:{dependencyType:"child",childGroups:["points"],variableNames:["x"+o]},vectorChild:{dependencyType:"child",childGroups:["vectors"],variableNames:["x"+o]}},s==="0"?i[s].componentAttr={dependencyType:"attributeComponent",attributeName:"x",variableNames:["value"]}:s==="1"?i[s].componentAttr={dependencyType:"attributeComponent",attributeName:"y",variableNames:["value"]}:s==="2"&&(i[s].componentAttr={dependencyType:"attributeComponent",attributeName:"z",variableNames:["value"]}),!r.basedOnDisplacement&&r.basedOnHead&&(i[s].tailX={dependencyType:"stateVariable",variableName:"tailX"+o},i[s].headX={dependencyType:"stateVariable",variableName:"headX"+o})}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={},s={};for(let l of n){let u=Number(l)+1;if(e.basedOnDisplacement)switch(e.sourceOfDisplacement){case"vectorChild":i[l]=r[l].vectorChild[0].stateValues["x"+u];break;case"pointChild":i[l]=r[l].pointChild[0].stateValues["x"+u];break;case"displacementAttr":i[l]=r[l].displacementAttr.stateValues["x"+u];break;case"xsAttr":i[l]=r[l].xsAttr.stateValues["math"+u].simplify();break;case"componentAttrs":let c=r[l].componentAttr;c===null?s[l]={defaultValue:mn.fromAst(0)}:i[l]=c.stateValues.value.simplify();break;default:let p=e.displacementShadow.tree;Array.isArray(p)&&["tuple","vector"].includes(p[0])?i[l]=e.displacementShadow.get_component(Number(l)):i[l]=e.displacementShadow}else e.basedOnHead?i[l]=r[l].headX.subtract(r[l].tailX).simplify():s[l]={defaultValue:mn.fromAst(l==="0"?1:0)}}let o={};return Object.keys(i).length>0&&(o.setValue={displacement:i}),Object.keys(s).length>0&&(o.useEssentialOrDefaultValue={displacement:s}),o},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[],l=!1;for(let u in e.displacement)if(r.basedOnDisplacement)switch(r.sourceOfDisplacement){case"vectorChild":o.push({setDependency:i[u].vectorChild,desiredValue:e.displacement[u],childIndex:0,variableIndex:0});break;case"pointChild":o.push({setDependency:i[u].pointChild,desiredValue:e.displacement[u],childIndex:0,variableIndex:0});break;case"displacementAttr":o.push({setDependency:i[u].displacementAttr,desiredValue:e.displacement[u],variableIndex:0});break;case"xsAttr":o.push({setDependency:i[u].xsAttr,desiredValue:e.displacement[u],variableIndex:0});break;case"componentAttrs":n[u].componentAttr===null?o.push({setEssentialValue:"displacement",value:{[u]:se(e.displacement[u])}}):o.push({setDependency:i[u].componentAttr,desiredValue:e.displacement[u],variableIndex:0});break;default:l=!0}else r.basedOnHead?o.push({setDependency:i[u].headX,desiredValue:n[u].tailX.add(e.displacement[u]).simplify()}):o.push({setEssentialValue:"displacement",value:{[u]:se(e.displacement[u])}});if(l)if(s[0]>1){let u=["vector"];for(let c in e.displacement)u[Number(c)+1]=e.displacement[c].tree;u.length=s[0]+1,o.push({setDependency:"displacementShadow",desiredValue:mn.fromAst(u)})}else s[0]===1&&"0"in e.displacement&&o.push({setDependency:"displacementShadow",desiredValue:e.displacement[0]});return{success:!0,instructions:o}}},t.x={isAlias:!0,targetVariableName:"x1"},t.y={isAlias:!0,targetVariableName:"x2"},t.z={isAlias:!0,targetVariableName:"x3"},t.head={public:!0,componentType:"math",isArray:!0,entryPrefixes:["headX"],set:se,returnWrappingComponents(e){return e==="headX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},stateVariablesDeterminingDependencies:["basedOnHead"],returnArraySizeDependencies:()=>({nDimHead:{dependencyType:"stateVariable",variableName:"nDimHead"}}),returnArraySize({dependencyValues:e}){return[e.nDimHead]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},headShadow:{dependencyType:"stateVariable",variableName:"headShadow"}},i={};for(let s of e){let o=Number(s)+1;i[s]={headAttr:{dependencyType:"attributeComponent",attributeName:"head",variableNames:["x"+o]}},r.basedOnHead||(i[s].tailX={dependencyType:"stateVariable",variableName:"tailX"+o},i[s].x={dependencyType:"stateVariable",variableName:"x"+o})}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n){let o=Number(s)+1;e.basedOnHead?r[s].headAttr!==null?i[s]=r[s].headAttr.stateValues["x"+o]:e.headShadow!==null&&(i[s]=e.headShadow.get_component(Number(s))):i[s]=r[s].tailX.add(r[s].x).simplify()}return{setValue:{head:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[],l=!1;for(let u in e.head)r.basedOnHead?n[u].headAttr&&n[u].headAttr!==null?o.push({setDependency:i[u].headAttr,desiredValue:e.head[u],variableIndex:0}):r.headShadow!==null&&(l=!0):o.push({setDependency:i[u].x,desiredValue:e.head[u].subtract(n[u].tailX).simplify()});if(l)if(s[0]>1){let u=["vector"];for(let c in e.head)u[Number(c)+1]=e.head[c].tree;u.length=s[0]+1,o.push({setDependency:"headShadow",desiredValue:mn.fromAst(u)})}else s[0]===1&&"0"in e.head&&o.push({setDependency:"headShadow",desiredValue:e.head[0]});return{success:!0,instructions:o}}},t.tail={public:!0,componentType:"math",isArray:!0,entryPrefixes:["tailX"],hasEssential:!0,defaultValueByArrayKey:()=>mn.fromAst(0),essentialVarName:"tail2",set:se,returnWrappingComponents(e){return e==="tailX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},stateVariablesDeterminingDependencies:["basedOnTail","basedOnHead","basedOnDisplacement"],returnArraySizeDependencies:()=>({nDimTail:{dependencyType:"stateVariable",variableName:"nDimTail"}}),returnArraySize({dependencyValues:e}){return[e.nDimTail]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},tailShadow:{dependencyType:"stateVariable",variableName:"tailShadow"}},i={};for(let s of e){let o=Number(s)+1;i[s]={tailAttr:{dependencyType:"attributeComponent",attributeName:"tail",variableNames:["x"+o]}},r.basedOnTail||r.basedOnHead&&r.basedOnDisplacement&&(i[s].headX={dependencyType:"stateVariable",variableName:"headX"+o},i[s].x={dependencyType:"stateVariable",variableName:"x"+o})}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){let i={},s={};for(let l of n){let u=Number(l)+1;r[l].tailAttr!==null?i[l]=r[l].tailAttr.stateValues["x"+u]:e.tailShadow!==null?i[l]=e.tailShadow.get_component(Number(l)):e.basedOnHead&&e.basedOnDisplacement?i[l]=r[l].headX.subtract(r[l].x).simplify():s[l]=!0}let o={};return Object.keys(i).length>0&&(o.setValue={tail:i}),Object.keys(s).length>0&&(o.useEssentialOrDefaultValue={tail:s}),o},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s}){let o=[],l=!1;for(let u in e.tail)n[u].tailAttr&&n[u].tailAttr!==null?o.push({setDependency:i[u].tailAttr,desiredValue:e.tail[u],variableIndex:0}):r.tailShadow!==null?l=!0:r.basedOnHead&&r.basedOnDisplacement?o.push({setDependency:i[u].x,desiredValue:n[u].headX.subtract(e.tail[u]).simplify()}):o.push({setEssentialValue:"tail",value:{[u]:se(e.tail[u])}});if(l)if(s[0]>1){let u=["vector"];for(let c in e.tail)u[Number(c)+1]=e.tail[c].tree;u.length=s[0]+1,o.push({setDependency:"tailShadow",desiredValue:mn.fromAst(u)})}else s[0]===1&&"0"in e.tail&&o.push({setDependency:"tailShadow",desiredValue:e.tail[0]});return{success:!0,instructions:o}}},t.numericalEndpoints={forRenderer:!0,returnDependencies:()=>({head:{dependencyType:"stateVariable",variableName:"head"},tail:{dependencyType:"stateVariable",variableName:"tail"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),definition:function({dependencyValues:e}){let r,n;if(e.nDimensions===1){let i=e.head[0].evaluate_to_constant();Number.isFinite(i)||(i=NaN),n=e.tail[0].evaluate_to_constant(),Number.isFinite(n)||(n=NaN)}else{r=[],n=[];for(let i=0;i<e.nDimensions;i++){let s=e.head[i].evaluate_to_constant();Number.isFinite(s)||(s=NaN),r.push(s);let o=e.tail[i].evaluate_to_constant();Number.isFinite(o)||(o=NaN),n.push(o)}}return{setValue:{numericalEndpoints:[n,r]}}}},t.displacementCoords={forRenderer:!0,returnDependencies:()=>({displacement:{dependencyType:"stateVariable",variableName:"displacement"}}),definition({dependencyValues:e}){let r=[];for(let n of e.displacement)n?r.push(n.tree):r.push("\uFF3F");return r.length>1?r=["vector",...r]:r.length===1?r=r[0]:r="\uFF3F",{setValue:{displacementCoords:mn.fromAst(r)}}},inverseDefinition({desiredStateVariableValues:e}){let r=e.displacementCoords.tree,n;return Array.isArray(r)&&(r[0]==="vector"||r[0]==="tuple")?n=r.slice(1).map(i=>mn.fromAst(i)):n=[e.displacementCoords],{success:!0,instructions:[{setDependency:"displacement",desiredValue:n}]}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalEndpoints:{dependencyType:"stateVariable",variableName:"numericalEndpoints"}}),definition({dependencyValues:e}){let r=e.numericalEndpoints[0]?.[0],n=e.numericalEndpoints[0]?.[1],i=e.numericalEndpoints[1]?.[0],s=e.numericalEndpoints[1]?.[1],o=Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(s),l=e.nDimensions!==2||!o||i===r&&s===n;return{setValue:{nearestPoint:function({variables:u,scales:c}){if(l)return{};let p=c[0],m=c[1],f=(i-r)/p,d=(s-n)/m,h=f*f+d*d,y=((u.x1-r)/p*f+(u.x2-n)/m*d)/h,b={};return y<=0?b={x1:r,x2:n}:y>=1?b={x1:i,x2:s}:b={x1:r+y*f*p,x2:n+y*d*m},u.x3!==void 0&&(b.x3=0),b}}}}},t}async moveVector({tailcoords:t,headcoords:e,transient:r,skippable:n,sourceInformation:i,actionId:s}){let o=[];if(t!==void 0){if(await this.stateValues.basedOnHead&&await this.stateValues.basedOnDisplacement){let l;if(e===void 0){let u=await this.stateValues.numericalEndpoints;l=t.map((c,p)=>u[1][p]-c)}else l=t.map((u,c)=>e[c]-u);o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"displacement",value:l.map(u=>mn.fromAst(u)),sourceInformation:i})}else o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"tail",value:t.map(l=>mn.fromAst(l)),sourceInformation:i});if(e===void 0&&!await this.stateValues.basedOnHead){let l=await this.stateValues.numericalEndpoints,u=t.map((c,p)=>l[1][p]-c);o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"displacement",value:u.map(c=>mn.fromAst(c)),sourceInformation:i})}}if(e!==void 0){if(await this.stateValues.basedOnHead)o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"head",value:e.map(l=>mn.fromAst(l)),sourceInformation:i});else{t==null&&(t=(await this.stateValues.numericalEndpoints)[0]);let l=t.map((u,c)=>e[c]-u);o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"displacement",value:l.map(u=>mn.fromAst(u)),sourceInformation:i})}if(t===void 0&&await this.stateValues.basedOnHead&&await this.stateValues.basedOnDisplacement){let l=await this.stateValues.numericalEndpoints,u=e.map((c,p)=>c-l[0][p]);o.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"displacement",value:u.map(c=>mn.fromAst(c)),sourceInformation:i})}}return r?await this.coreFunctions.performUpdate({updateInstructions:o,transient:r,skippable:n,actionId:s}):await this.coreFunctions.performUpdate({updateInstructions:o,actionId:s,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{head:e,tail:t}}})}};T(xo,"componentType","vector"),T(xo,"primaryStateVariableForDefinition","displacementShadow"),T(xo,"adapters",[{stateVariable:"displacementCoords",componentType:"coords"}]);import wr from"math-expressions";var xu=class extends Ge{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.radius={createComponentOfType:"math",createStateVariable:"radius",defaultValue:wr.fromAst(1),public:!0},e.renderAsAcuteAngle={createComponentOfType:"boolean",createStateVariable:"renderAsAcuteAngle",defaultValue:!1,public:!0,forRenderer:!0},e.inDegrees={createComponentOfType:"boolean",createStateVariable:"inDegrees",defaultValue:!1,public:!0,forRenderer:!0},e.radians={createComponentOfType:"math"},e.degrees={createComponentOfType:"math"},e.through={createComponentOfType:"_pointListComponent"},e.betweenLines={createComponentOfType:"_lineListComponent"},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){return r.length===0||!r.every(n=>typeof n=="string"||n.doenetAttributes&&n.doenetAttributes.createdFromMacro)?{success:!1}:{success:!0,newAttributes:{radians:{component:{componentType:"math",children:r}}}}};return t.push({replacementFunction:e}),t}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.lineNames={returnDependencies:()=>({betweenLines:{dependencyType:"attributeComponent",attributeName:"betweenLines",variableNames:["lineNames"]}}),definition({dependencyValues:e}){let r=[];return e.betweenLines!==null&&(r=e.betweenLines.stateValues.lineNames),{setValue:{lineNames:r}}}},t.betweenLinesName={returnDependencies:()=>({betweenLines:{dependencyType:"attributeComponent",attributeName:"betweenLines"}}),definition({dependencyValues:e}){let r=null;return e.betweenLines!==null&&(r=e.betweenLines.componentName),{setValue:{betweenLinesName:r}}}},t.nPointsSpecified={returnDependencies:()=>({through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["nPoints"]}}),definition({dependencyValues:e}){return e.through!==null?{setValue:{nPointsSpecified:e.through.stateValues.nPoints}}:{setValue:{nPointsSpecified:0}}}},t.points={isArray:!0,nDimensions:2,entryPrefixes:["pointX","point"],hasEssential:!0,defaultValueByArrayKey:e=>wr.fromAst(["0,1","2,0"].includes(e)?1:0),stateVariablesDeterminingDependencies:["nPointsSpecified","betweenLinesName"],returnArraySizeDependencies:()=>({radians:{dependencyType:"attributeComponent",attributeName:"radians",variableNames:["value"]},degrees:{dependencyType:"attributeComponent",attributeName:"degrees",variableNames:["value"]}}),returnArraySize({dependencyValues:e}){return e.radians!==null||e.degrees!==null?[0,0]:[3,2]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="pointX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={nPointsSpecified:{dependencyType:"value",value:r.nPointsSpecified}};r.betweenLinesName!==null&&(n.lineChildren={dependencyType:"child",parentName:r.betweenLinesName,childGroups:["lines"],variableNames:["points","nDimensions","coeff0","coeffvar1","coeffvar2"]});let i={};for(let s of e){let[o,l]=s.split(",");if(o==="0"||r.nPointsSpecified>2){let u=Number(o)+1+"_"+(Number(l)+1);i[s]={through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["pointX"+u]}}}else if(o==="2"&&r.nPointsSpecified===2){let u="2_"+(Number(l)+1);i[s]={through:{dependencyType:"attributeComponent",attributeName:"through",variableNames:["pointX"+u]}}}}return{globalDependencies:n,dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:e,globalDependencyValues:r,arrayKeys:n}){if(r.lineChildren)if(r.lineChildren.length!==2)console.warn(`Cannot define an angle between ${r.lineChildren.length} line(s)`);else{let u=r.lineChildren[0],c=r.lineChildren[1],p=wq(u,c);if(p===void 0){let v={};for(let A=0;A<3;A++)for(let C=0;C<2;C++)v[A+","+C]=wr.fromAst("\uFF3F");return{setValue:{points:v}}}let m=p,f=u.stateValues.points[0][0].evaluate_to_constant(),d=u.stateValues.points[0][1].evaluate_to_constant(),h=u.stateValues.points[1][0].evaluate_to_constant(),y=u.stateValues.points[1][1].evaluate_to_constant(),b=[wr.fromAst(m[0].tree+h-f),wr.fromAst(m[1].tree+y-d)];f=c.stateValues.points[0][0].evaluate_to_constant(),d=c.stateValues.points[0][1].evaluate_to_constant(),h=c.stateValues.points[1][0].evaluate_to_constant(),y=c.stateValues.points[1][1].evaluate_to_constant();let g=[wr.fromAst(m[0].tree+h-f),wr.fromAst(m[1].tree+y-d)];return{setValue:{points:{"0,0":b[0],"0,1":b[1],"1,0":m[0],"1,1":m[1],"2,0":g[0],"2,1":g[1]}}}}let i=r.nPointsSpecified,s={},o={};for(let u of n){let[c,p]=u.split(",");if(c==="0"||i>2){let m=Number(c)+1+"_"+(Number(p)+1),f;e[u].through!==null&&(f=e[u].through.stateValues["pointX"+m]),f===void 0?o[u]=!0:s[u]=f}else if(c==="2"&&i===2){let m="2_"+(Number(p)+1),f;e[u].through!==null&&(f=e[u].through.stateValues["pointX"+m]),f===void 0?o[u]=!0:s[u]=f}else o[u]=!0}let l={};return Object.keys(s).length>0&&(l.setValue={points:s}),Object.keys(o).length>0&&(l.useEssentialOrDefaultValue={points:o}),l}},t.radians={public:!0,componentType:"math",forRenderer:!0,returnDependencies:()=>({radians:{dependencyType:"attributeComponent",attributeName:"radians",variableNames:["value"]},degrees:{dependencyType:"attributeComponent",attributeName:"degrees",variableNames:["value"]},points:{dependencyType:"stateVariable",variableName:"points"}}),definition({dependencyValues:e}){if(e.radians!==null)return{setValue:{radians:e.radians.stateValues.value.simplify()}};if(e.degrees!==null)return{setValue:{radians:e.degrees.stateValues.value.multiply(wr.fromAst(["/","pi",180])).simplify()}};let r=[],n=!1;for(let s=0;s<3;s++)r.push([e.points[s][0].evaluate_to_constant(),e.points[s][1].evaluate_to_constant()]),(r[s][0]===null||r[s][1]===null)&&(n=!0);let i;return n?{setValue:{radians:wr.fromAst("\uFF3F")}}:(i=Math.atan2(r[2][1]-r[1][1],r[2][0]-r[1][0])-Math.atan2(r[0][1]-r[1][1],r[0][0]-r[1][0]),i<0&&(i+=2*Math.PI),{setValue:{radians:wr.fromAst(i)}})}},t.value={isAlias:!0,targetVariableName:"radians"},t.angle={isAlias:!0,targetVariableName:"radians"},t.degrees={public:!0,componentType:"math",forRenderer:!0,returnDependencies:()=>({radians:{dependencyType:"stateVariable",variableName:"radians"}}),definition({dependencyValues:e}){let r;return e.radians.tree==="\uFF3F"||Number.isNaN(e.radians.tree)?r=e.radians:r=e.radians.multiply(wr.fromAst(["/",180,"pi"])).simplify(),{setValue:{degrees:r}}}},t.numericalPoints={isArray:!0,entryPrefixes:["numericalPoint"],forRenderer:!0,returnArraySizeDependencies:()=>({radians:{dependencyType:"attributeComponent",attributeName:"radians",variableNames:["value"]},degrees:{dependencyType:"attributeComponent",attributeName:"degrees",variableNames:["value"]}}),returnArraySize({dependencyValues:e}){return e.radians!==null||e.degrees!==null?[0]:[3]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={point:{dependencyType:"stateVariable",variableName:"point"+(Number(n)+1)}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=e[i].point,o=[];for(let l=0;l<2;l++){let u=s[l].evaluate_to_constant();Number.isFinite(u)||(u=NaN),o.push(u)}n[i]=o}return{setValue:{numericalPoints:n}}}},t.numericalRadius={forRenderer:!0,returnDependencies:()=>({radius:{dependencyType:"stateVariable",variableName:"radius"}}),definition({dependencyValues:e}){let r=e.radius.evaluate_to_constant();return Number.isFinite(r)||(r=NaN),{setValue:{numericalRadius:r}}}},t}};T(xu,"componentType","angle"),T(xu,"adapters",["radians"]);function wq(a,t){if(a.stateValues.nDimensions!==2||t.stateValues.nDimensions!==2){console.log("Calculating angle between two lines implemented only in 2D");return}let e=a.stateValues.coeffvar1.evaluate_to_constant(),r=a.stateValues.coeffvar2.evaluate_to_constant(),n=a.stateValues.coeff0.evaluate_to_constant(),i=t.stateValues.coeffvar1.evaluate_to_constant(),s=t.stateValues.coeffvar2.evaluate_to_constant(),o=t.stateValues.coeff0.evaluate_to_constant();if(!(Number.isFinite(e)&&Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(s)&&Number.isFinite(o))){console.log("Calculating angle between two lines implemented only for constant coefficients");return}let l=e*s-i*r;if(Math.abs(l)<1e-14)if(Math.abs(o*e-n*i)>1e-14){console.log("Cannot calculate angle between two parallel lines");return}else return e===0&&r===0&&n===0||i===0&&s===0&&o===0?void 0:r!==0?[wr.fromAst(0),wr.fromAst(-n/r)]:[wr.fromAst(-n/e),wr.fromAst(0)];let u=(o*r-n*s)/l,c=(n*i-o*e)/l;return[wr.fromAst(u),wr.fromAst(c)]}var Qx=M(C0()),eV=M(A0()),tV=M(Jx()),Vo=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.weight={createComponentOfType:"number",createStateVariable:"weight",defaultValue:1,public:!0},e.inline={createComponentOfType:"boolean",createStateVariable:"inline",defaultValue:!1,public:!0},e.symbolicEquality={createComponentOfType:"boolean",createStateVariable:"symbolicEquality",defaultValue:!1,public:!0},e.matchPartial={createComponentOfType:"boolean",createStateVariable:"matchPartial",defaultValue:!1,public:!0},e.forceFullCheckworkButton={createComponentOfType:"boolean",createStateVariable:"forceFullCheckworkButton",defaultValue:!1,public:!0},e.simplifyOnCompare={createComponentOfType:"text",createStateVariable:"simplifyOnCompare",defaultValue:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numbersepreserveorder"],public:!0},e.expandOnCompare={createComponentOfType:"boolean",createStateVariable:"expandOnCompare",defaultValue:!1,public:!0},e.unorderedCompare={createComponentOfType:"boolean",createStateVariable:"unorderedCompare",defaultValue:!1,public:!0},e.matchByExactPositions={createComponentOfType:"boolean",createStateVariable:"matchByExactPositions",defaultValue:!1,public:!0},e.nAwardsCredited={createComponentOfType:"integer",createStateVariable:"nAwardsCredited",defaultValue:1,public:!0},e.maximumNumberOfAttempts={createComponentOfType:"integer",createStateVariable:"maximumNumberOfAttempts",defaultValue:1/0,public:!0},e.allowedErrorInNumbers={createComponentOfType:"number",createStateVariable:"allowedErrorInNumbers",defaultValue:0,public:!0},e.includeErrorInNumberExponents={createComponentOfType:"boolean",createStateVariable:"includeErrorInNumberExponents",defaultValue:!1,public:!0},e.allowedErrorIsAbsolute={createComponentOfType:"boolean",createStateVariable:"allowedErrorIsAbsolute",defaultValue:!1,public:!0},e.nSignErrorsMatched={createComponentOfType:"number",createStateVariable:"nSignErrorsMatched",defaultValue:0,public:!0},e.nPeriodicSetMatchesRequired={createComponentOfType:"integer",createStateVariable:"nPeriodicSetMatchesRequired",defaultValue:3,public:!0},e.showCorrectness={createComponentOfType:"boolean",createStateVariable:"showCorrectness",defaultValue:t.flags?t.flags.showCorrectness!==!1:!0,forRenderer:!0},e.type={createPrimitiveOfType:"string"},e.disableAfterCorrect={createComponentOfType:"boolean",createStateVariable:"disableAfterCorrect",defaultValue:!1,public:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n,componentAttributes:i}){if(!n.every(l=>typeof l=="string"||l.doenetAttributes&&l.doenetAttributes.createdFromMacro))return{success:!1};let s;return i.type?s=i.type:s="math",["math","text","boolean"].includes(s)||(console.warn(`Invalid type ${s}`),s="math"),{success:!0,newChildren:[{componentType:"award",children:[{componentType:s,children:n}]}]}};t.push({replacementFunction:e});function r({matchedChildren:n,componentAttributes:i,componentInfoObjects:s}){let o=!1;for(let p of n){if(s.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"_input"}))return{success:!1};if(s.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"considerAsResponses"}))return{success:!1};(s.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"_composite"})||s.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"award"})&&p.children&&!p.children.some(m=>s.isInheritedComponentType({inheritedComponentType:m.componentType,baseComponentType:"when"})))&&(o=!0)}if(!o)return{success:!1};let l;i.type?l=i.type:l="math",["math","text","boolean"].includes(l)||(console.warn(`Invalid type ${l}`),l="math");let c=[{componentType:l+"Input"},...n];return{success:!0,newChildren:c}}return t.push({replacementFunction:r}),t}static returnChildGroups(){return[{group:"awards",componentTypes:["award"]},{group:"numbers",componentTypes:["number"]},{group:"inputs",componentTypes:["_input"]},{group:"responses",componentTypes:["considerAsResponses"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return $r({stateVariableDefinitions:t,oldName:"disabled",newName:"disabledOriginal"}),t.haveAwardThatRequiresInput={returnDependencies:()=>({awardChildren:{dependencyType:"child",childGroups:["awards"],variableNames:["requireInputInAnswer"]}}),definition({dependencyValues:e}){return{setValue:{haveAwardThatRequiresInput:e.awardChildren.some(r=>r.stateValues.requireInputInAnswer)}}}},t.allInputChildrenIncludingSugared={returnDependencies:()=>({allInputChildrenIncludingSugared:{dependencyType:"child",childGroups:["inputs"]}}),definition({dependencyValues:e}){return{setValue:{allInputChildrenIncludingSugared:e.allInputChildrenIncludingSugared}}}},t.inputChildren={stateVariablesDeterminingDependencies:["allInputChildrenIncludingSugared"],additionalStateVariablesDefined:["inputChildIndices","skippedFirstInput"],forRenderer:!0,returnDependencies({stateValues:e}){let r={allInputChildrenIncludingSugared:{dependencyType:"stateVariable",variableName:"allInputChildrenIncludingSugared"},haveAwardThatRequiresInput:{dependencyType:"stateVariable",variableName:"haveAwardThatRequiresInput"}};return e.allInputChildrenIncludingSugared.length>0&&(r.firstInputFromSugar={dependencyType:"doenetAttribute",componentName:e.allInputChildrenIncludingSugared[0].componentName,attributeName:"createdFromSugar"}),r},definition({dependencyValues:e}){let r=[...e.allInputChildrenIncludingSugared],n=[...e.allInputChildrenIncludingSugared.keys()],i=!1;return(!e.haveAwardThatRequiresInput||e.allInputChildrenIncludingSugared.length>1)&&e.firstInputFromSugar&&(i=!0,r=r.slice(1),n=n.slice(1)),{setValue:{inputChildren:r,inputChildIndices:n,skippedFirstInput:i}}}},t.inputChildrenWithValues={stateVariablesDeterminingDependencies:["inputChildIndices"],forRenderer:!0,returnDependencies:({stateValues:e})=>({inputChildren:{dependencyType:"child",childGroups:["inputs"],variableNames:["valueToRecordOnSubmit","valueRecordedAtSubmit","value","immediateValue"],childIndices:e.inputChildIndices,variablesOptional:!0}}),definition:function({dependencyValues:e}){return{setValue:{inputChildrenWithValues:e.inputChildren}}}},t.inputChildWithValues={returnDependencies:()=>({inputChildrenWithValues:{dependencyType:"stateVariable",variableName:"inputChildrenWithValues"}}),definition({dependencyValues:e}){let r=null;return e.inputChildrenWithValues.length===1&&(r=e.inputChildrenWithValues[0]),{setValue:{inputChildWithValues:r}}}},t.awardInputResponseChildren={returnDependencies:()=>({awardInputResponseChildren:{dependencyType:"child",childGroups:["awards","inputs","responses"]},skippedFirstInput:{dependencyType:"stateVariable",variableName:"skippedFirstInput"}}),definition({dependencyValues:e}){let r=[...e.awardInputResponseChildren];return e.skippedFirstInput&&(r=r.slice(1)),{setValue:{awardInputResponseChildren:r}}}},t.nResponses={public:!0,componentType:"number",stateVariablesDeterminingDependencies:["awardInputResponseChildren"],returnDependencies({stateValues:e,componentInfoObjects:r}){let n={childTypes:{dependencyType:"value",value:e.awardInputResponseChildren.map(i=>i.componentType)}};for(let[i,s]of e.awardInputResponseChildren.entries())r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"award"})?n["child"+i]={dependencyType:"descendant",ancestorName:s.componentName,componentTypes:["_base"],variableNames:["isResponse","nValues"],variablesOptional:!0,recurseToMatchedChildren:!0,includeNonActiveChildren:!0,skipOverAdapters:!0}:r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"_input"})?n["childNValues"+i]={dependencyType:"stateVariable",componentName:s.componentName,variableName:"nValues",variablesOptional:!0}:n["child"+i]={dependencyType:"stateVariable",componentName:s.componentName,variableName:"childrenWithNValues"};return n},definition({dependencyValues:e,componentInfoObjects:r}){let n=0;for(let[i,s]of e.childTypes.entries())if(r.isInheritedComponentType({inheritedComponentType:s,baseComponentType:"award"}))for(let o of e["child"+i])!o.stateValues.isResponse||r.isInheritedComponentType({inheritedComponentType:o.componentType,baseComponentType:"_composite"})||(o.stateValues.nValues===void 0?n+=1:n+=o.stateValues.nValues);else if(r.isInheritedComponentType({inheritedComponentType:s,baseComponentType:"_input"})){let o=e["childNValues"+i];o===void 0?n+=1:n+=o}else for(let o of e["child"+i])o.stateValues.nValues===void 0?n+=1:n+=o.stateValues.nValues;return{setValue:{nResponses:n}}}},t.currentResponses={public:!0,isArray:!0,entryPrefixes:["currentResponse"],hasVariableComponentType:!0,stateVariablesDeterminingDependencies:["awardInputResponseChildren"],returnArraySizeDependencies:()=>({nResponses:{dependencyType:"stateVariable",variableName:"nResponses"}}),returnArraySize({dependencyValues:e}){return[e.nResponses]},returnArrayDependenciesByKey({stateValues:e,componentInfoObjects:r}){let n={childTypes:{dependencyType:"value",value:e.awardInputResponseChildren.map(i=>i.componentType)}};for(let[i,s]of e.awardInputResponseChildren.entries())r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"award"})?n["child"+i]={dependencyType:"descendant",ancestorName:s.componentName,componentTypes:["_base"],variableNames:["isResponse","value","values","componentType"],variablesOptional:!0,recurseToMatchedChildren:!0,includeAttributeChildren:!0,includeNonActiveChildren:!0,skipOverAdapters:!0}:r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"_input"})?(n["childValue"+i]={dependencyType:"stateVariable",componentName:s.componentName,variableName:"value",variablesOptional:!0},n["childValues"+i]={dependencyType:"stateVariable",componentName:s.componentName,variableName:"values",variablesOptional:!0},n["childComponentType"+i]={dependencyType:"stateVariable",componentName:s.componentName,variableName:"componentType",variablesOptional:!0}):n["child"+i]={dependencyType:"stateVariable",componentName:s.componentName,variableName:"childrenAsResponses"};return{globalDependencies:n}},arrayDefinitionByKey({globalDependencyValues:e,componentInfoObjects:r}){let n=[],i=[],s=[];for(let[o,l]of e.childTypes.entries())if(r.isInheritedComponentType({inheritedComponentType:l,baseComponentType:"award"}))for(let u of e["child"+o])!u.stateValues.isResponse||r.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"_composite"})||s.push(u);else if(r.isInheritedComponentType({inheritedComponentType:l,baseComponentType:"_input"})){let u={componentType:l,stateValues:{value:e["childValue"+o],values:e["childValues"+o],componentType:e["childComponentType"+o]}};s.push(u)}else s.push(...e["child"+o]);for(let o of s){let l=o.stateValues.componentType;l||(l=o.componentType),Array.isArray(o.stateValues.values)?(n.push(...o.stateValues.values),i.push(...Array(o.stateValues.values.length).fill(l))):(n.push(o.stateValues.value),i.push(l))}return{setValue:{currentResponses:n},setComponentType:{currentResponses:i}}}},t.currentResponse={isAlias:!0,targetVariableName:"currentResponse1"},t.nSubmittedResponses={public:!0,componentType:"number",hasEssential:!0,defaultValue:0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{nSubmittedResponses:!0}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"nSubmittedResponses",value:e.nSubmittedResponses}]}}},t.submittedResponsesComponentType={hasEssential:!0,defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{submittedResponsesComponentType:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return e.submittedResponsesComponentType?{success:!0,instructions:[{setEssentialValue:"submittedResponsesComponentType",value:[...e.submittedResponsesComponentType]}]}:{success:!0,instructions:[{setEssentialValue:"submittedResponsesComponentType",value:[]}]}}},t.submittedResponses={public:!0,isArray:!0,entryPrefixes:["submittedResponse"],defaultValueByArrayKey:()=>"\uFF3F",hasEssential:!0,componentType:"math",hasVariableComponentType:!0,inverseShadowToSetEntireArray:!0,doNotCombineInverseArrayInstructions:!0,returnArraySizeDependencies:()=>({nSubmittedResponses:{dependencyType:"stateVariable",variableName:"nSubmittedResponses"}}),returnArraySize({dependencyValues:e}){return[e.nSubmittedResponses]},returnArrayDependenciesByKey(){return{globalDependencies:{submittedResponsesComponentType:{dependencyType:"stateVariable",variableName:"submittedResponsesComponentType"},nSubmittedResponses:{dependencyType:"stateVariable",variableName:"nSubmittedResponses"}}}},arrayDefinitionByKey({globalDependencyValues:e}){let r=[];e.submittedResponsesComponentType&&r.push(...e.submittedResponsesComponentType.slice(0,e.nSubmittedResponses));let n={};for(let i=0;i<e.nSubmittedResponses;i++)n[i]=!0,r[i]||(r[i]="math");return{useEssentialOrDefaultValue:{submittedResponses:n},setComponentType:{submittedResponses:r}}},inverseArrayDefinitionByKey:function({desiredStateVariableValues:e,initialChange:r}){return r?{success:!0,instructions:[{setDependency:"nSubmittedResponses",desiredValue:e.submittedResponses.length},{setEssentialValue:"submittedResponses",value:[...e.submittedResponses]}]}:{success:!1}}},t.submittedResponse={isAlias:!0,targetVariableName:"submittedResponse1"},t.delegateCheckWork={additionalStateVariablesDefined:["delegateCheckWorkToInput","delegateCheckWorkToAncestor"],forRenderer:!0,returnDependencies:()=>({inputChildren:{dependencyType:"stateVariable",variableName:"inputChildren"},forceFullCheckworkButton:{dependencyType:"stateVariable",variableName:"forceFullCheckworkButton"},sectionAncestor:{dependencyType:"ancestor",componentType:"_sectioningComponent",variableNames:["suppressAnswerSubmitButtons"]},documentAncestor:{dependencyType:"ancestor",componentType:"document",variableNames:["suppressAnswerSubmitButtons"]}}),definition:function({dependencyValues:e,componentName:r}){let n=!1,i=!1,s=!1;return(e.documentAncestor.stateValues.suppressAnswerSubmitButtons||e.sectionAncestor&&e.sectionAncestor.stateValues.suppressAnswerSubmitButtons)&&(n=s=!0),!n&&e.inputChildren.length===1&&!e.forceFullCheckworkButton&&(i=s=!0),{setValue:{delegateCheckWork:s,delegateCheckWorkToAncestor:n,delegateCheckWorkToInput:i}}}},t.creditAchievedIfSubmit={additionalStateVariablesDefined:["awardsUsedIfSubmit","awardChildren","inputUsedIfSubmit"],stateVariablesDeterminingDependencies:["inputChildIndices"],returnDependencies:({stateValues:e})=>({awardChildren:{dependencyType:"child",childGroups:["awards"],variableNames:["credit","creditAchievedIfSubmit","fractionSatisfiedIfSubmit"]},inputChildren:{dependencyType:"child",childGroups:["inputs"],variableNames:["creditAchievedIfSubmit"],childIndices:e.inputChildIndices,variablesOptional:!0},nAwardsCredited:{dependencyType:"stateVariable",variableName:"nAwardsCredited"}}),definition:function({dependencyValues:e}){let r=0,n=e.nAwardsCredited,i=Array(n).fill(null),s=null;if(e.awardChildren.length===0){if(e.inputChildren.length===1){let o=e.inputChildren[0].stateValues.creditAchievedIfSubmit;o>=0&&(r=o,s=e.inputChildren[0].componentName)}}else{let o=Array(n).fill(null),l=0;for(let u of e.awardChildren){let c=u.stateValues.creditAchievedIfSubmit;if((c>l||i[n-1]===null)&&u.stateValues.fractionSatisfiedIfSubmit>0){if(i[0]===null)i[0]=u.componentName,o[0]=c,l=Math.min(...o);else for(let[p,m]of o.entries())if(c>m||m===null){i.splice(p,0,u.componentName),i=i.slice(0,n),o.splice(p,0,c),o=o.slice(0,n),l=Math.min(...o);break}}}r=Math.min(1,o.reduce((u,c)=>u+c,0))}return{setValue:{creditAchievedIfSubmit:r,awardsUsedIfSubmit:i,awardChildren:e.awardChildren,inputUsedIfSubmit:s}}}},t.creditAchieved={defaultValue:0,public:!0,componentType:"number",forRenderer:!0,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{creditAchieved:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"creditAchieved",value:e.creditAchieved}]}}},t.responseHasBeenSubmitted={public:!0,componentType:"boolean",defaultValue:!1,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{responseHasBeenSubmitted:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"responseHasBeenSubmitted",value:e.responseHasBeenSubmitted}]}}},t.creditAchievedDependencies={shadowVariable:!0,returnDependencies:()=>({currentCreditAchievedDependencies:{dependencyType:"recursiveDependencyValues",variableNames:["creditAchievedIfSubmit"],includeImmediateValueWithValue:!0,includeRawValueWithImmediateValue:!0,includeOnlyEssentialValues:!0}}),definition({dependencyValues:e}){let r=(0,tV.default)(e.currentCreditAchievedDependencies,{replacer:cn});return{setValue:{creditAchievedDependencies:eV.default.stringify((0,Qx.default)(r))}}}},t.creditAchievedDependenciesAtSubmit={defaultValue:null,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{creditAchievedDependenciesAtSubmit:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"creditAchievedDependenciesAtSubmit",value:e.creditAchievedDependenciesAtSubmit}]}}},t.justSubmitted={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,hasEssential:!0,shadowVariable:!0,returnDependencies:()=>({currentCreditAchievedDependencies:{dependencyType:"stateVariable",variableName:"creditAchievedDependencies"},creditAchievedDependenciesAtSubmit:{dependencyType:"stateVariable",variableName:"creditAchievedDependenciesAtSubmit"},disableAfterCorrect:{dependencyType:"stateVariable",variableName:"disableAfterCorrect"},hasBeenCorrect:{dependencyType:"stateVariable",variableName:"hasBeenCorrect"}}),definition:function({dependencyValues:e,justUpdatedForNewComponent:r,componentName:n}){return e.disableAfterCorrect&&e.hasBeenCorrect?{setValue:{justSubmitted:!0}}:e.creditAchievedDependenciesAtSubmit!==e.currentCreditAchievedDependencies&&!r?{setValue:{justSubmitted:!1},setEssentialValue:{justSubmitted:!1}}:{useEssentialOrDefaultValue:{justSubmitted:!0}}},inverseDefinition({desiredStateVariableValues:e,componentName:r}){return{success:!0,instructions:[{setEssentialValue:"justSubmitted",value:e.justSubmitted}]}}},t.allFeedbacks={returnDependencies:()=>({awardChildren:{dependencyType:"child",childGroups:["awards"],variableNames:["feedbacks"]},feedbackComponents:{dependencyType:"descendant",componentTypes:["_input"],variableNames:["feedbacks"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r=[];for(let n of e.awardChildren)r.push(...n.stateValues.feedbacks);for(let n of e.feedbackComponents)Array.isArray(n.stateValues.feedbacks)&&r.push(...n.stateValues.feedbacks);return{setValue:{allFeedbacks:r}}}},t.numberFeedbacks={public:!0,componentType:"number",returnDependencies:()=>({allFeedbacks:{dependencyType:"stateVariable",variableName:"allFeedbacks"}}),definition({dependencyValues:e}){return{setValue:{numberFeedbacks:e.allFeedbacks.length},checkForActualChange:{numberFeedbacks:!0}}}},t.feedbacks={public:!0,componentType:"feedback",isArray:!0,entryPrefixes:["feedback"],returnArraySizeDependencies:()=>({numberFeedbacks:{dependencyType:"stateVariable",variableName:"numberFeedbacks"}}),returnArraySize({dependencyValues:e}){return[e.numberFeedbacks]},returnArrayDependenciesByKey(){return{globalDependencies:{allFeedbacks:{dependencyType:"stateVariable",variableName:"allFeedbacks"}}}},arrayDefinitionByKey({globalDependencyValues:e}){let r={};for(let n=0;n<e.__array_size;n++)r[n]=e.allFeedbacks[n];return{setValue:{feedbacks:r}}}},t.nSubmissions={public:!0,componentType:"integer",defaultValue:0,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{nSubmissions:!0}}),inverseDefinition:({desiredStateVariableValues:e})=>({success:!0,instructions:[{setEssentialValue:"nSubmissions",value:e.nSubmissions}]})},t.numberOfAttemptsLeft={public:!0,componentType:"integer",forRenderer:!0,returnDependencies:()=>({nSubmissions:{dependencyType:"stateVariable",variableName:"nSubmissions"},maximumNumberOfAttempts:{dependencyType:"stateVariable",variableName:"maximumNumberOfAttempts"}}),definition({dependencyValues:e}){return{setValue:{numberOfAttemptsLeft:e.maximumNumberOfAttempts-e.nSubmissions}}}},t.hasBeenCorrect={defaultValue:!1,hasEssential:!0,shadowVariable:!0,returnDependencies:()=>({creditAchieved:{dependencyType:"stateVariable",variableName:"creditAchieved"}}),definition({dependencyValues:e}){return e.creditAchieved===1?{setValue:{hasBeenCorrect:!0},setEssentialValue:{hasBeenCorrect:!0}}:{useEssentialOrDefaultValue:{hasBeenCorrect:!0}}}},t.disabled={public:!0,componentType:"boolean",forRenderer:!0,stateVariablesDeterminingDependencies:["disableAfterCorrect"],returnDependencies({stateValues:e}){let r={disabledOriginal:{dependencyType:"stateVariable",variableName:"disabledOriginal"},numberOfAttemptsLeft:{dependencyType:"stateVariable",variableName:"numberOfAttemptsLeft"},disableAfterCorrect:{dependencyType:"stateVariable",variableName:"disableAfterCorrect"}};return e.disableAfterCorrect&&(r.hasBeenCorrect={dependencyType:"stateVariable",variableName:"hasBeenCorrect"}),r},definition({dependencyValues:e}){return{setValue:{disabled:e.disabledOriginal||e.numberOfAttemptsLeft<1||e.disableAfterCorrect&&e.hasBeenCorrect}}}},t.inItemNumber={returnDependencies:()=>({documentAncestor:{dependencyType:"ancestor",componentType:"document",variableNames:["itemNumberByAnswerName"]}}),definition({dependencyValues:e,componentName:r}){return{setValue:{inItemNumber:e.documentAncestor.stateValues.itemNumberByAnswerName[r]}}}},t}actions={submitAnswer:this.submitAnswer.bind(this)};async submitAnswer({actionId:t}){let e=await this.stateValues.numberOfAttemptsLeft;if(e<1){console.warn(`Cannot submit answer for ${this.componentName} as number of attempts left is ${e}`);return}let r=await this.stateValues.creditAchievedIfSubmit,n=await this.stateValues.awardsUsedIfSubmit,i=await this.stateValues.inputUsedIfSubmit,s=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"creditAchieved",value:r},{updateType:"updateValue",componentName:this.componentName,stateVariable:"responseHasBeenSubmitted",value:!0}],o=await this.stateValues.inputChildrenWithValues;if(o.length===1){let c=o[0];i===c.componentName&&"valueToRecordOnSubmit"in c.stateValues&&"valueRecordedAtSubmit"in c.stateValues&&s.push({updateType:"updateValue",componentName:c.componentName,stateVariable:"valueRecordedAtSubmit",value:c.stateValues.valueToRecordOnSubmit})}let l=await this.stateValues.currentResponses;s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"submittedResponses",value:l}),s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"submittedResponsesComponentType",value:this.state.currentResponses.componentType}),s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"justSubmitted",value:!0}),s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"creditAchievedDependenciesAtSubmit",value:await this.stateValues.creditAchievedDependencies}),s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"nSubmissions",value:await this.stateValues.nSubmissions+1});for(let c of await this.stateValues.awardChildren){let p=n.includes(c.componentName);s.push({updateType:"updateValue",componentName:c.componentName,stateVariable:"awarded",value:p}),s.push({updateType:"updateValue",componentName:c.componentName,stateVariable:"creditAchieved",value:c.stateValues.creditAchievedIfSubmit}),s.push({updateType:"updateValue",componentName:c.componentName,stateVariable:"fractionSatisfied",value:c.stateValues.fractionSatisfiedIfSubmit})}let u=[];for(let c of l)c.toString?u.push(c.toString()):u.push(c);return s.push({updateType:"recordItemSubmission",itemNumber:await this.stateValues.inItemNumber,submittedComponent:this.componentName,response:l,responseText:u,creditAchieved:r}),await this.coreFunctions.performUpdate({updateInstructions:s,actionId:t,event:{verb:"submitted",object:{componentName:this.componentName,componentType:this.componentType},result:{response:l,responseText:u,creditAchieved:r}}}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}};T(Vo,"componentType","answer"),T(Vo,"renderChildren",!0),T(Vo,"variableForPlainMacro","submittedResponses");import kq from"math-expressions";var Ns=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.credit={createComponentOfType:"number",createStateVariable:"credit",defaultValue:1,public:!0,attributesForCreatedComponent:{convertBoolean:!0}},e.matchPartial={createComponentOfType:"boolean",createStateVariable:"matchPartial",defaultValue:!1,public:!0,fallBackToParentStateVariable:"matchPartial"},e.symbolicEquality={createComponentOfType:"boolean",createStateVariable:"symbolicEquality",defaultValue:!1,public:!0,fallBackToParentStateVariable:"symbolicEquality"},e.expandOnCompare={createComponentOfType:"boolean",createStateVariable:"expandOnCompare",defaultValue:!1,public:!0,fallBackToParentStateVariable:"expandOnCompare"},e.simplifyOnCompare={createComponentOfType:"text",createStateVariable:"simplifyOnCompare",defaultValue:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numberspreserveorder"],public:!0,fallBackToParentStateVariable:"simplifyOnCompare"},e.unorderedCompare={createComponentOfType:"boolean",createStateVariable:"unorderedCompare",defaultValue:!1,public:!0,fallBackToParentStateVariable:"unorderedCompare"},e.matchByExactPositions={createComponentOfType:"boolean",createStateVariable:"matchByExactPositions",defaultValue:!1,public:!0,fallBackToParentStateVariable:"matchByExactPositions"},e.allowedErrorInNumbers={createComponentOfType:"number",createStateVariable:"allowedErrorInNumbers",defaultValue:0,public:!0,fallBackToParentStateVariable:"allowedErrorInNumbers"},e.includeErrorInNumberExponents={createComponentOfType:"boolean",createStateVariable:"includeErrorInNumberExponents",defaultValue:!1,public:!0,fallBackToParentStateVariable:"includeErrorInNumberExponents"},e.allowedErrorIsAbsolute={createComponentOfType:"boolean",createStateVariable:"allowedErrorIsAbsolute",defaultValue:!1,public:!0,fallBackToParentStateVariable:"allowedErrorIsAbsolute"},e.nSignErrorsMatched={createComponentOfType:"number",createStateVariable:"nSignErrorsMatched",defaultValue:0,public:!0,fallBackToParentStateVariable:"nSignErrorsMatched"},e.nPeriodicSetMatchesRequired={createComponentOfType:"integer",createStateVariable:"nPeriodicSetMatchesRequired",defaultValue:3,public:!0,fallBackToParentStateVariable:"nPeriodicSetMatchesRequired"},e.feedbackCodes={createComponentOfType:"textList",createStateVariable:"feedbackCodes",defaultValue:[],public:!0},e.feedbackText={createComponentOfType:"text",createStateVariable:"feedbackText",defaultValue:null,public:!0},e.targetsAreResponses={createPrimitiveOfType:"string"},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r,parentAttributes:n}){if(!r.every(s=>typeof s=="string"||s.doenetAttributes&&s.doenetAttributes.createdFromMacro))return{success:!1};let i;return n.type?i=n.type:i="math",["math","text","boolean"].includes(i)||(console.warn(`Invalid type ${i}`),i="math"),{success:!0,newChildren:[{componentType:i,children:r}]}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"whens",componentTypes:["when"]},{group:"maths",componentTypes:["math"]},{group:"texts",componentTypes:["text"]},{group:"booleans",componentTypes:["boolean"]},{group:"mathLists",componentTypes:["mathList"]},{group:"textLists",componentTypes:["textList"]},{group:"booleanLists",componentTypes:["booleanList"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.parsedExpression={additionalStateVariablesDefined:["requireInputInAnswer"],returnDependencies:()=>({whenChild:{dependencyType:"child",childGroups:["whens"],variableNames:["fractionSatisfied"]},typeChildren:{dependencyType:"child",childGroups:["maths","texts","booleans","mathLists","textLists","booleanLists"]}}),definition:function({dependencyValues:e}){let r=null,n=!1;return e.whenChild.length==0&&e.typeChildren.length>0&&(n=!0,r=kq.fromAst(["=","comp1","comp2"])),{setValue:{parsedExpression:r,requireInputInAnswer:n}}}},t.creditAchievedIfSubmit={public:!0,componentType:"number",additionalStateVariablesDefined:[{variableName:"fractionSatisfiedIfSubmit",public:!0,componentType:"number"}],returnDependencies:()=>({credit:{dependencyType:"stateVariable",variableName:"credit"},whenChild:{dependencyType:"child",childGroups:["whens"],variableNames:["fractionSatisfied"]},mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value","unordered"]},textChild:{dependencyType:"child",childGroups:["texts"],variableNames:["value"]},booleanChild:{dependencyType:"child",childGroups:["booleans"],variableNames:["value"]},mathListChild:{dependencyType:"child",childGroups:["mathLists"],variableNames:["maths","unordered"]},textListChild:{dependencyType:"child",childGroups:["textLists"],variableNames:["texts","unordered"]},booleanListChild:{dependencyType:"child",childGroups:["booleanLists"],variableNames:["booleans","unordered"]},answerInput:{dependencyType:"parentStateVariable",variableName:"inputChildWithValues"},parsedExpression:{dependencyType:"stateVariable",variableName:"parsedExpression"},matchPartial:{dependencyType:"stateVariable",variableName:"matchPartial"},symbolicEquality:{dependencyType:"stateVariable",variableName:"symbolicEquality"},expandOnCompare:{dependencyType:"stateVariable",variableName:"expandOnCompare"},simplifyOnCompare:{dependencyType:"stateVariable",variableName:"simplifyOnCompare"},unorderedCompare:{dependencyType:"stateVariable",variableName:"unorderedCompare"},matchByExactPositions:{dependencyType:"stateVariable",variableName:"matchByExactPositions"},allowedErrorInNumbers:{dependencyType:"stateVariable",variableName:"allowedErrorInNumbers"},includeErrorInNumberExponents:{dependencyType:"stateVariable",variableName:"includeErrorInNumberExponents"},allowedErrorIsAbsolute:{dependencyType:"stateVariable",variableName:"allowedErrorIsAbsolute"},nSignErrorsMatched:{dependencyType:"stateVariable",variableName:"nSignErrorsMatched"},nPeriodicSetMatchesRequired:{dependencyType:"stateVariable",variableName:"nPeriodicSetMatchesRequired"}}),definition:function({dependencyValues:e,usedDefault:r}){let n;if(e.whenChild.length>0)n=e.whenChild[0].stateValues.fractionSatisfied;else{if(!e.answerInput||!e.parsedExpression)return{setValue:{creditAchievedIfSubmit:0,fractionSatisfiedIfSubmit:0}};n=Fq({dependencyValues:e,usedDefault:r})}n=Math.max(0,Math.min(1,n));let i=0;return Number.isFinite(e.credit)&&(i=Math.max(0,Math.min(1,e.credit))*n),{setValue:{fractionSatisfiedIfSubmit:n,creditAchievedIfSubmit:i}}}},t.fractionSatisfied={public:!0,componentType:"number",defaultValue:0,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{fractionSatisfied:!0}}),inverseDefinition:function({desiredStateVariableValues:e,initialChange:r}){return r?{success:!0,instructions:[{setEssentialValue:"fractionSatisfied",value:e.fractionSatisfied}]}:{success:!1}}},t.creditAchieved={public:!0,componentType:"number",defaultValue:0,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{creditAchieved:!0}}),inverseDefinition:function({desiredStateVariableValues:e,initialChange:r}){return r?{success:!0,instructions:[{setEssentialValue:"creditAchieved",value:e.creditAchieved}]}:{success:!1}}},t.awarded={public:!0,componentType:"boolean",defaultValue:!1,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{awarded:!0}}),inverseDefinition:function({desiredStateVariableValues:e,initialChange:r}){return r?{success:!0,instructions:[{setEssentialValue:"awarded",value:e.awarded}]}:{success:!1}}},t.allFeedbacks={returnDependencies:()=>({feedbackText:{dependencyType:"stateVariable",variableName:"feedbackText"},feedbackCodes:{dependencyType:"stateVariable",variableName:"feedbackCodes"},feedbackDefinitionAncestor:{dependencyType:"ancestor",variableNames:["feedbackDefinitions"]},awarded:{dependencyType:"stateVariable",variableName:"awarded"}}),definition:function({dependencyValues:e}){if(!e.awarded)return{setValue:{allFeedbacks:[]}};let r=[],n=e.feedbackDefinitionAncestor.stateValues.feedbackDefinitions;for(let i of e.feedbackCodes){let s=i.toLowerCase(),o=n[s];o&&r.push(o)}return e.feedbackText!==null&&r.push(e.feedbackText),{setValue:{allFeedbacks:r}}}},t.numberFeedbacks={public:!0,componentType:"number",returnDependencies:()=>({allFeedbacks:{dependencyType:"stateVariable",variableName:"allFeedbacks"}}),definition({dependencyValues:e}){return{setValue:{numberFeedbacks:e.allFeedbacks.length},checkForActualChange:{numberFeedbacks:!0}}}},t.feedbacks={public:!0,componentType:"feedback",isArray:!0,entryPrefixes:["feedback"],returnArraySizeDependencies:()=>({numberFeedbacks:{dependencyType:"stateVariable",variableName:"numberFeedbacks"}}),returnArraySize({dependencyValues:e}){return[e.numberFeedbacks]},returnArrayDependenciesByKey(){return{globalDependencies:{allFeedbacks:{dependencyType:"stateVariable",variableName:"allFeedbacks"}}}},arrayDefinitionByKey({globalDependencyValues:e}){let r={};for(let n=0;n<e.__array_size;n++)r[n]=e.allFeedbacks[n];return{setValue:{feedbacks:r}}}},t.feedback={isAlias:!0,targetVariableName:"feedback1"},t}};T(Ns,"componentType","award"),T(Ns,"rendererType"),T(Ns,"adapters",["awarded"]),T(Ns,"standardizedFeedback",{numericalerror:"Credit reduced because numbers in your answer weren't quite right.  Did you round too much?",goodjob:"Good job!",onesignerror:"Credit reduced because it appears that you made a sign error.",twosignerrors:"Credit reduced because it appears that you made two sign errors."});function Fq({dependencyValues:a,usedDefault:t}){let e={mathChildrenByCode:{},mathListChildrenByCode:{},numberChildrenByCode:{},numberListChildrenByCode:{},textChildrenByCode:{},textListChildrenByCode:{},booleanChildrenByCode:{},booleanListChildrenByCode:{}};Object.assign(e,a);let r=t.unorderedCompare;a.textChild.length>0?e.textChildrenByCode.comp2=a.textChild[0]:a.mathChild.length>0?e.mathChildrenByCode.comp2=a.mathChild[0]:a.booleanChild.length>0?e.booleanChildrenByCode.comp2=a.booleanChild[0]:a.textListChild.length>0?e.textListChildrenByCode.comp2=a.textListChild[0]:a.mathListChild.length>0?e.mathListChildrenByCode.comp2=a.mathListChild[0]:a.booleanListChild.length>0&&(e.booleanListChildrenByCode.comp2=a.booleanListChild[0]);let n=a.answerInput.stateValues.immediateValue;n===void 0&&(n=a.answerInput.stateValues.value);let i={stateValues:{value:n}};return a.answerInput.componentType==="textInput"?e.textChildrenByCode.comp1=i:a.answerInput.componentType==="booleanInput"?e.booleanChildrenByCode.comp1=i:e.mathChildrenByCode.comp1=i,Ma({logicTree:a.parsedExpression.tree,canOverrideUnorderedCompare:r,dependencyValues:e})}var Oo=class extends Nr{static createAttributesObject(t){let e=super.createAttributesObject(t);e.matchPartial={createComponentOfType:"boolean",createStateVariable:"matchPartial",defaultValue:!1,public:!0,fallBackToParentStateVariable:"matchPartial"};for(let r of["symbolicEquality","expandOnCompare","simplifyOnCompare","unorderedCompare","matchByExactPositions","allowedErrorInNumbers","includeErrorInNumberExponents","allowedErrorIsAbsolute","nSignErrorsMatched","nPeriodicSetMatchesRequired"])e[r].fallBackToParentStateVariable=r;return e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:"boolean",additionalStateVariablesDefined:[{variableName:"fractionSatisfied",public:!0,componentType:"number"},{variableName:"conditionSatisfied",public:!0,componentType:"boolean"}],returnDependencies:()=>({matchPartial:{dependencyType:"stateVariable",variableName:"matchPartial"},symbolicEquality:{dependencyType:"stateVariable",variableName:"symbolicEquality"},expandOnCompare:{dependencyType:"stateVariable",variableName:"expandOnCompare"},simplifyOnCompare:{dependencyType:"stateVariable",variableName:"simplifyOnCompare"},unorderedCompare:{dependencyType:"stateVariable",variableName:"unorderedCompare"},matchByExactPositions:{dependencyType:"stateVariable",variableName:"matchByExactPositions"},allowedErrorInNumbers:{dependencyType:"stateVariable",variableName:"allowedErrorInNumbers"},includeErrorInNumberExponents:{dependencyType:"stateVariable",variableName:"includeErrorInNumberExponents"},allowedErrorIsAbsolute:{dependencyType:"stateVariable",variableName:"allowedErrorIsAbsolute"},nSignErrorsMatched:{dependencyType:"stateVariable",variableName:"nSignErrorsMatched"},nPeriodicSetMatchesRequired:{dependencyType:"stateVariable",variableName:"nPeriodicSetMatchesRequired"},parsedExpression:{dependencyType:"stateVariable",variableName:"parsedExpression"},booleanChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanChildrenByCode"},booleanListChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanListChildrenByCode"},textChildrenByCode:{dependencyType:"stateVariable",variableName:"textChildrenByCode"},textListChildrenByCode:{dependencyType:"stateVariable",variableName:"textListChildrenByCode"},mathChildrenByCode:{dependencyType:"stateVariable",variableName:"mathChildrenByCode"},mathListChildrenByCode:{dependencyType:"stateVariable",variableName:"mathListChildrenByCode"},numberChildrenByCode:{dependencyType:"stateVariable",variableName:"numberChildrenByCode"},numberListChildrenByCode:{dependencyType:"stateVariable",variableName:"numberListChildrenByCode"}}),definition({dependencyValues:e,usedDefault:r}){if(e.parsedExpression===null)return{setValue:{conditionSatisfied:!1,value:!1,fractionSatisfied:0}};let n=r.unorderedCompare,i=Ma({logicTree:e.parsedExpression.tree,canOverrideUnorderedCompare:n,dependencyValues:e}),s=i===1;return{setValue:{fractionSatisfied:i,conditionSatisfied:s,value:s}}}},t}};T(Oo,"componentType","when"),T(Oo,"rendererType"),T(Oo,"stateVariableForAttributeValue","conditionSatisfied");import Jh from"math-expressions";var Vu=class extends Xr{constructor(t){super(t);this.actions={updateRawValue:this.updateRawValue.bind(this),updateValue:this.updateValue.bind(this)},this.externalActions={},Object.defineProperty(this.externalActions,"submitAnswer",{enumerable:!0,get:async function(){let e=await this.stateValues.answerAncestor;if(e!==null)return{componentName:e.componentName,actionName:"submitAnswer"}}.bind(this)})}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.prefill={createComponentOfType:"math",createStateVariable:"prefill",defaultValue:Jh.fromAst("\uFF3F"),public:!0,copyComponentAttributesForCreatedComponent:["format","functionSymbols","splitSymbols"]},e.format={createComponentOfType:"text",createStateVariable:"format",defaultValue:"text",public:!0},e.functionSymbols={createComponentOfType:"textList",createStateVariable:"functionSymbols",defaultValue:["f","g"],public:!0},e.splitSymbols={createComponentOfType:"boolean",createStateVariable:"splitSymbols",defaultValue:!0,public:!0},e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:10,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e.bindValueTo={createComponentOfType:"math"},e.unionFromU={createComponentOfType:"boolean",createStateVariable:"unionFromU",defaultValue:!1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:"math",hasEssential:!0,shadowVariable:!0,stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigits",displayDecimals:"displayDecimals",displaySmallAsZero:"displaySmallAsZero"},returnDependencies:()=>({bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["value"]},prefill:{dependencyType:"stateVariable",variableName:"prefill"}}),set:se,definition:function({dependencyValues:e}){return e.bindValueTo?{setValue:{value:e.bindValueTo.stateValues.value}}:{useEssentialOrDefaultValue:{value:{defaultValue:e.prefill}}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){return r.bindValueTo?{success:!0,instructions:[{setDependency:"bindValueTo",desiredValue:e.value,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"value",value:e.value}]}}},t.immediateValue={public:!0,componentType:"math",hasEssential:!0,shadowVariable:!0,stateVariablesPrescribingAdditionalAttributes:{displayDigits:"displayDigits",displayDecimals:"displayDecimals",displaySmallAsZero:"displaySmallAsZero"},returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),set:se,definition:function({dependencyValues:e,changes:r,justUpdatedForNewComponent:n}){return r.value&&!n?{setValue:{immediateValue:e.value},setEssentialValue:{immediateValue:e.value}}:{useEssentialOrDefaultValue:{immediateValue:{defaultValue:e.value}}}},inverseDefinition:function({desiredStateVariableValues:e,initialChange:r,shadowedVariable:n}){let i=[{setEssentialValue:"immediateValue",value:e.immediateValue}];return r||n||i.push({setDependency:"value",desiredValue:e.immediateValue}),{success:!0,instructions:i}}},t.valueForDisplay={forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}}),set:se,definition:function({dependencyValues:e,usedDefault:r}){return{setValue:{valueForDisplay:Lt({value:e.value,dependencyValues:e,usedDefault:r})}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"}}),definition:function({dependencyValues:e}){return{setValue:{text:e.valueForDisplay.toString()}}}},t.rawRendererValue={forRenderer:!0,hasEssential:!0,shadowVariable:!0,defaultValue:"",provideEssentialValuesInDefinition:!0,public:!0,componentType:"text",additionalStateVariablesDefined:[{variableName:"lastValueForDisplay",hasEssential:!0,shadowVariable:!0,defaultValue:null,set:se}],returnDependencies:()=>({immediateValue:{dependencyType:"stateVariable",variableName:"immediateValue"},valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"}}),definition({dependencyValues:e,essentialValues:r,justUpdatedForNewComponent:n,componentName:i}){if(r.rawRendererValue===void 0||!(n||Ot(r.lastValueForDisplay.tree,e.valueForDisplay.tree))){let s=eu(e.valueForDisplay.toLatex());return s==="\uFF3F"&&(s=""),{setValue:{rawRendererValue:s,lastValueForDisplay:e.valueForDisplay},setEssentialValue:{rawRendererValue:s,lastValueForDisplay:e.valueForDisplay}}}else return{useEssentialOrDefaultValue:{rawRendererValue:!0,lastValueForDisplay:!0}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r,essentialValues:n,componentName:i}){let s=async l=>{let u;l=ph(l,{unionFromU:await r.unionFromU}),l=l.replace(/\^(\w)/g,"^{$1}");let c=Jl({functionSymbols:await r.functionSymbols,splitSymbols:await r.splitSymbols});try{u=c(l)}catch(p){u=Jh.fromAst("\uFF3F")}return u},o=[];if(typeof e.rawRendererValue=="string"){let l=n.rawRendererValue,u=e.rawRendererValue;l!==u&&o.push({setEssentialValue:"rawRendererValue",value:u});let c=await s(l),p=await s(u);Ot(p.tree,c.tree)||o.push({setDependency:"immediateValue",desiredValue:p,treatAsInitialChange:!0})}else if(e.rawRendererValue instanceof Jh.class){o.push({setEssentialValue:"lastValueForDisplay",value:e.rawRendererValue});let l=await s(n.rawRendererValue);if(!Ot(e.rawRendererValue.tree,l.tree)){let u=eu(e.rawRendererValue.toLatex());u==="\uFF3F"&&(u=""),o.push({setEssentialValue:"rawRendererValue",value:u})}}else e.lastValueForDisplay instanceof Jh.class&&o.push({setEssentialValue:"lastValueForDisplay",value:e.lastValueForDisplay});return{success:!0,instructions:o}}},t.componentType={returnDependencies:()=>({}),definition:()=>({setValue:{componentType:"math"}})},t}async updateRawValue({rawRendererValue:t,actionId:e}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:e});else return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rawRendererValue",value:t}],transient:!0,actionId:e})}async updateValue({actionId:t}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:t});else{let e=await this.stateValues.immediateValue;if(Ot((await this.stateValues.value).tree,e.tree))this.coreFunctions.resolveAction({actionId:t});else{let r=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:e},{updateType:"executeUpdate"},{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",valueOfStateVariable:"value"}];e.tree!=="\uFF3F"?r.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"rawRendererValue",valueOfStateVariable:"valueForDisplay"}):r.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"lastValueForDisplay",valueOfStateVariable:"valueForDisplay"});let n={verb:"answered",object:{componentName:this.componentName,componentType:this.componentType},result:{response:e,responseText:e.toString()}},i=await this.stateValues.answerAncestor;return i&&(n.context={answerAncestor:i.componentName}),await this.coreFunctions.performUpdate({updateInstructions:r,actionId:t,event:n}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}}}};T(Vu,"componentType","mathInput"),T(Vu,"variableForPlainMacro","value");var Ou=class extends Xr{constructor(t){super(t);this.actions={updateImmediateValue:this.updateImmediateValue.bind(this),updateValue:this.updateValue.bind(this)},this.externalActions={},Object.defineProperty(this.externalActions,"submitAnswer",{enumerable:!0,get:async function(){let e=await this.stateValues.answerAncestor;if(e!==null)return{componentName:e.componentName,actionName:"submitAnswer"}}.bind(this)})}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.prefill={createComponentOfType:"text",createStateVariable:"prefill",defaultValue:"",public:!0},e.size={createComponentOfType:"number",createStateVariable:"size",defaultValue:10,forRenderer:!0,public:!0},e.bindValueTo={createComponentOfType:"text"},e.expanded={createComponentOfType:"boolean",createStateVariable:"expanded",defaultValue:!1,forRenderer:!0,public:!0},e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:{size:600,isAbsolute:!0},forRenderer:!0,public:!0},e.height={createComponentOfType:"_componentSize",createStateVariable:"height",defaultValue:{size:120,isAbsolute:!0},forRenderer:!0,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:"text",hasEssential:!0,shadowVariable:!0,returnDependencies:()=>({bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["value"]},prefill:{dependencyType:"stateVariable",variableName:"prefill"}}),definition:function({dependencyValues:e}){return e.bindValueTo?{setValue:{value:e.bindValueTo.stateValues.value}}:{useEssentialOrDefaultValue:{value:{defaultValue:e.prefill}}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){return r.bindValueTo?{success:!0,instructions:[{setDependency:"bindValueTo",desiredValue:e.value,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"value",value:e.value}]}}},t.immediateValue={public:!0,componentType:"text",forRenderer:!0,hasEssential:!0,shadowVariable:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e,changes:r,justUpdatedForNewComponent:n}){return r.value&&!n?{setValue:{immediateValue:e.value},setEssentialValue:{immediateValue:e.value}}:{useEssentialOrDefaultValue:{immediateValue:{defaultValue:e.value}}}},inverseDefinition:function({desiredStateVariableValues:e,initialChange:r,shadowedVariable:n}){let i=[{setEssentialValue:"immediateValue",value:e.immediateValue}];return r||n||i.push({setDependency:"value",desiredValue:e.immediateValue}),{success:!0,instructions:i}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{setValue:{text:e.value}}}},t.componentType={returnDependencies:()=>({}),definition:()=>({setValue:{componentType:"text"}})},t}async updateImmediateValue({text:t,actionId:e}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:e});else return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",value:t}],transient:!0,actionId:e})}async updateValue({actionId:t}){if(!await this.stateValues.disabled){let e=await this.stateValues.immediateValue;if(await this.stateValues.value!==e){let r=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:e},{updateType:"executeUpdate"},{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",valueOfStateVariable:"value"}],n={verb:"answered",object:{componentName:this.componentName,componentType:this.componentType},result:{response:e,responseText:e}},i=await this.stateValues.answerAncestor;return i&&(n.context={answerAncestor:i.componentName}),await this.coreFunctions.performUpdate({updateInstructions:r,actionId:t,event:n}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}}this.coreFunctions.resolveAction({actionId:t})}};T(Ou,"componentType","textInput"),T(Ou,"variableForPlainMacro","value");var Du=class extends Xr{constructor(t){super(t);this.actions={updateBoolean:this.updateBoolean.bind(this)},this.externalActions={},Object.defineProperty(this.externalActions,"submitAnswer",{enumerable:!0,get:async function(){let e=await this.stateValues.answerAncestor;if(e!==null)return{componentName:e.componentName,actionName:"submitAnswer"}}.bind(this)})}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.prefill={createComponentOfType:"boolean",createStateVariable:"prefill",defaultValue:!1,public:!0},e.label={createComponentOfType:"text",createStateVariable:"label",defaultValue:"",forRenderer:!0,public:!0},e.bindValueTo={createComponentOfType:"boolean"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:"boolean",forRenderer:!0,hasEssential:!0,shadowVariable:!0,returnDependencies:()=>({bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["value"]},prefill:{dependencyType:"stateVariable",variableName:"prefill"}}),definition:function({dependencyValues:e}){return e.bindValueTo?{setValue:{value:e.bindValueTo.stateValues.value}}:{useEssentialOrDefaultValue:{value:{defaultValue:e.prefill}}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){return r.bindValueTo?{success:!0,instructions:[{setDependency:"bindValueTo",desiredValue:e.value,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"value",value:e.value}]}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{setValue:{text:e.value?"true":"false"}}}},t.componentType={returnDependencies:()=>({}),definition:()=>({setValue:{componentType:"boolean"}})},t}async updateBoolean({boolean:t,actionId:e}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:e});else{let r=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:t}],n={verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:t,responseText:t.toString()}},i=await this.stateValues.answerAncestor;return i&&(n.context={answerAncestor:i.componentName}),await this.coreFunctions.performUpdate({updateInstructions:r,event:n,actionId:e}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}}};T(Du,"componentType","booleanInput"),T(Du,"variableForPlainMacro","value");var Cs=class extends Xr{constructor(t){super(t);this.actions={updateSelectedIndices:this.updateSelectedIndices.bind(this)},this.externalActions={},Object.defineProperty(this.externalActions,"submitAnswer",{enumerable:!0,get:async function(){let e=await this.stateValues.answerAncestor;if(e!==null)return{componentName:e.componentName,actionName:"submitAnswer"}}.bind(this)})}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.selectMultiple={createComponentOfType:"boolean",createStateVariable:"selectMultiple",defaultValue:!1,public:!0,forRenderer:!0},e.matchPartial={createComponentOfType:"boolean",createStateVariable:"matchPartial",defaultValue:!1,public:!0},e.inline={createComponentOfType:"boolean"},e.randomizeOrder={createPrimitiveOfType:"boolean",createStateVariable:"randomizeOrder",defaultValue:!1,public:!0},e.preselectChoice={createComponentOfType:"number",createStateVariable:"preselectChoice",defaultValue:null},e.bindValueTo={createComponentOfType:"text"},e.placeHolder={createComponentOfType:"text",createStateVariable:"placeHolder",defaultValue:"",forRenderer:!0},e}static returnChildGroups(){return[{group:"choices",componentTypes:["choice"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.inline={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,hasEssential:!0,returnDependencies:()=>({inlineAttr:{dependencyType:"attributeComponent",attributeName:"inline",variableNames:["value"]},parentInline:{dependencyType:"parentStateVariable",variableName:"inline"}}),definition({dependencyValues:e}){return e.inlineAttr?{setValue:{inline:e.inlineAttr.stateValues.value}}:e.parentInline!==null?{setValue:{inline:e.parentInline}}:{useEssentialOrDefaultValue:{inline:{}}}}},t.numberChoices={public:!0,componentType:"number",returnDependencies:()=>({choiceChildren:{dependencyType:"child",childGroups:["choices"]}}),definition({dependencyValues:e}){return{setValue:{numberChoices:e.choiceChildren.length}}}},t.choiceOrder={forRenderer:!0,shadowVariable:!0,returnDependencies:({sharedParameters:e})=>({choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["text"]},randomizeOrder:{dependencyType:"stateVariable",variableName:"randomizeOrder"},variantRng:{dependencyType:"value",value:e.variantRng,doNotProxy:!0},variants:{dependencyType:"variants"}}),definition:function({dependencyValues:e}){let r=e.choiceChildren.length,n;if(!e.randomizeOrder)n=[...Array(r).keys()].map(i=>i+1);else{let i=e.variants?.desiredVariant?.indices;if(i!==void 0)if(i.length!==r)console.warn("Ignoring indices specified for choiceInput as number of indices doesn't match number of choice children.");else{if(i=i.map(Number),!i.every(Number.isInteger))throw Error("All indices specified for choiceInput must be integers");if(!i.every(s=>s>=1&&s<=r))console.warn("Ignoring indices specified for choiceInput as some indices out of range.");else return{setValue:{choiceOrder:i}}}n=[...Array(r).keys()].map(s=>s+1);for(let s=r-1;s>0;s--){let o=e.variantRng(),l=Math.floor(o*(s+1));[n[s],n[l]]=[n[l],n[s]]}}return{setValue:{choiceOrder:n}}}},t.generatedVariantInfo={additionalStateVariablesDefined:["isVariantComponent"],returnDependencies:({componentInfoObjects:e,sharedParameters:r})=>({variantSeed:{dependencyType:"value",value:r.variantSeed},choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},randomizeOrder:{dependencyType:"stateVariable",variableName:"randomizeOrder"},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(e.componentTypesCreatingVariants),variableNames:["isVariantComponent","generatedVariantInfo"],useReplacementsForComposites:!0,recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfEncounteredComposites:!0}}),definition({dependencyValues:e,componentName:r}){let n={seed:e.variantSeed,meta:{createdBy:r}};e.randomizeOrder&&(n.indices=e.choiceOrder);let i=n.subvariants=[];for(let s of e.variantDescendants)s.stateValues.isVariantComponent?i.push(s.stateValues.generatedVariantInfo):s.stateValues.generatedVariantInfo&&i.push(...s.stateValues.generatedVariantInfo.subvariants);return{setValue:{generatedVariantInfo:n,isVariantComponent:!0}}}},t.choiceChildrenOrdered={additionalStateVariablesDefined:[{variableName:"numberChoices",public:!0,componentType:"number"}],returnDependencies:()=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"]}}),definition:function({dependencyValues:e}){let r=e.choiceChildren.length;return{setValue:{choiceChildrenOrdered:e.choiceOrder.map(i=>e.choiceChildren[i-1]),numberChoices:r}}}},t.choiceTexts={public:!0,componentType:"text",isArray:!0,entryPrefixes:["choiceText"],forRenderer:!0,returnArraySizeDependencies:()=>({numberChoices:{dependencyType:"stateVariable",variableName:"numberChoices"}}),returnArraySize({dependencyValues:e}){return[e.numberChoices]},returnArrayDependenciesByKey(){return{globalDependencies:{choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["text"]}}}},arrayDefinitionByKey({globalDependencyValues:e}){return{setValue:{choiceTexts:e.choiceOrder.map(n=>e.choiceChildren[n-1]).map(n=>n.stateValues.text)}}}},t.choicePreselects={isArray:!0,returnArraySizeDependencies:()=>({numberChoices:{dependencyType:"stateVariable",variableName:"numberChoices"}}),returnArraySize({dependencyValues:e}){return[e.numberChoices]},returnArrayDependenciesByKey(){return{globalDependencies:{choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["preSelect"]}}}},arrayDefinitionByKey({globalDependencyValues:e}){return{setValue:{choicePreselects:e.choiceOrder.map(n=>e.choiceChildren[n-1]).map(n=>n.stateValues.preSelect)}}}},t.choicesDisabled={isArray:!0,forRenderer:!0,returnArraySizeDependencies:()=>({numberChoices:{dependencyType:"stateVariable",variableName:"numberChoices"}}),returnArraySize({dependencyValues:e}){return[e.numberChoices]},returnArrayDependenciesByKey(){return{globalDependencies:{choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["disabled"]}}}},arrayDefinitionByKey({globalDependencyValues:e}){return{setValue:{choicesDisabled:e.choiceOrder.map(n=>e.choiceChildren[n-1]).map(n=>n.stateValues.disabled)}}}},t.choicesHidden={isArray:!0,forRenderer:!0,returnArraySizeDependencies:()=>({numberChoices:{dependencyType:"stateVariable",variableName:"numberChoices"}}),returnArraySize({dependencyValues:e}){return[e.numberChoices]},returnArrayDependenciesByKey(){return{globalDependencies:{choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["hidden"]}}}},arrayDefinitionByKey({globalDependencyValues:e}){return{setValue:{choicesHidden:e.choiceOrder.map(n=>e.choiceChildren[n-1]).map(n=>n.stateValues.hidden)}}}},t.componentType={returnDependencies:()=>({}),definition:()=>({setValue:{componentType:"text"}})},t.indicesMatchedByBoundValue={returnDependencies:()=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["text"]},bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["value"]},selectMultiple:{dependencyType:"stateVariable",variableName:"selectMultiple"}}),definition({dependencyValues:e}){let r=e.choiceOrder.map(n=>e.choiceChildren[n-1]);if(e.bindValueTo!==null){let n=r.map(i=>i.stateValues.text.toLowerCase().trim());if(e.bindValueTo.stateValues.value)if(e.selectMultiple){let i=e.bindValueTo.stateValues.value.toLowerCase().split(",").map(o=>o.trim()),s=[];for(let o of i){let l=n.indexOf(o);l!==-1&&!s.includes(l+1)&&s.push(l+1)}return s.sort((o,l)=>o-l),{setValue:{indicesMatchedByBoundValue:s}}}else{let i=n.indexOf(e.bindValueTo.stateValues.value.toLowerCase().trim());if(i!==-1)return{setValue:{indicesMatchedByBoundValue:[i+1]}}}}return{setValue:{indicesMatchedByBoundValue:[]}}}},t.allSelectedIndices={hasEssential:!0,returnDependencies(){return{choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["text"]},indicesMatchedByBoundValue:{dependencyType:"stateVariable",variableName:"indicesMatchedByBoundValue"},preselectChoice:{dependencyType:"stateVariable",variableName:"preselectChoice"},choicePreselects:{dependencyType:"stateVariable",variableName:"choicePreselects"},bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["value"]}}},definition({dependencyValues:e}){return e.bindValueTo!==null?{setValue:{allSelectedIndices:e.indicesMatchedByBoundValue}}:{useEssentialOrDefaultValue:{allSelectedIndices:{get defaultValue(){let r=e.choicePreselects.indexOf(!0);return r!==-1?[r+1]:e.preselectChoice!==null?[e.preselectChoice]:[]}}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){if(r.bindValueTo===null)return{success:!0,instructions:[{setEssentialValue:"allSelectedIndices",value:e.allSelectedIndices}]};{let n="";if(e.allSelectedIndices.length>0){let i=r.choiceOrder.map(o=>r.choiceChildren[o-1]),s=[];for(let o of e.allSelectedIndices){let l=i[o-1];l&&s.push(l.stateValues.text)}n=s.join(", ")}return{success:!0,instructions:[{setDependency:"bindValueTo",desiredValue:n,variableIndex:0}]}}}},t.nSelectedIndices={returnDependencies:()=>({allSelectedIndices:{dependencyType:"stateVariable",variableName:"allSelectedIndices"}}),definition({dependencyValues:e}){return{setValue:{nSelectedIndices:e.allSelectedIndices.length}}}},t.selectedIndices={public:!0,componentType:"number",isArray:!0,entryPrefixes:["selectedIndex"],forRenderer:!0,returnArraySizeDependencies:()=>({nSelectedIndices:{dependencyType:"stateVariable",variableName:"nSelectedIndices"}}),returnArraySize({dependencyValues:e}){return[e.nSelectedIndices]},returnArrayDependenciesByKey(){return{globalDependencies:{allSelectedIndices:{dependencyType:"stateVariable",variableName:"allSelectedIndices"}}}},arrayDefinitionByKey({globalDependencyValues:e}){let r={};for(let n in e.allSelectedIndices)r[n]=e.allSelectedIndices[n];return{setValue:{selectedIndices:r}}}},t.selectedIndex={isAlias:!0,targetVariableName:"selectedIndex1"},t.selectedValues={public:!0,componentType:"text",isArray:!0,entryPrefixes:["selectedValue"],returnArraySizeDependencies:()=>({nSelectedIndices:{dependencyType:"stateVariable",variableName:"nSelectedIndices"}}),returnArraySize({dependencyValues:e}){return[e.nSelectedIndices]},returnArrayDependenciesByKey(){return{globalDependencies:{selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"},choiceTexts:{dependencyType:"stateVariable",variableName:"choiceTexts"}}}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:r}){let n={};for(let i of r)n[i]=e.choiceTexts[e.selectedIndices[i]-1];return{setValue:{selectedValues:n}}}},t.selectedValue={isAlias:!0,targetVariableName:"selectedValue1"},t.values={isAlias:!0,targetVariableName:"selectedValues"},t.nValues={isAlias:!0,targetVariableName:"nSelectedIndices"},t.childIndicesSelected={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"},choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"}}),definition({dependencyValues:e}){return{setValue:{childIndicesSelected:e.selectedIndices.map(n=>e.choiceOrder[n-1])}}}},t.creditAchievedIfSubmit={returnDependencies:()=>({choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["selected","credit"]},selectMultiple:{dependencyType:"stateVariable",variableName:"selectMultiple"},matchPartial:{dependencyType:"stateVariable",variableName:"matchPartial"}}),definition:function({dependencyValues:e}){let r=0;if(e.selectMultiple){let n=0,i=0,s=0;for(let o of e.choiceChildren)o.stateValues.selected?o.stateValues.credit===1?n++:i++:o.stateValues.credit===1&&s++;if(e.matchPartial){let o=n+i+s;o===0?r=1:r=n/o}else i+s===0&&(r=1)}else for(let n of e.choiceChildren)if(n.stateValues.selected){r=n.stateValues.credit;break}return{setValue:{creditAchievedIfSubmit:r}}}},t.valueToRecordOnSubmit={isAlias:!0,targetVariableName:"selectedIndices"},t.submittedIndices={returnDependencies:()=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["submitted"]}}),definition({dependencyValues:e}){let r=[],n=e.choiceOrder.map(i=>e.choiceChildren[i-1]);for(let[i,s]of n.entries())s.stateValues.submitted&&r.push(i+1);return{setValue:{submittedIndices:r}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){let n=[];for(let[i,s]of r.choiceOrder.entries())n.push({setDependency:"choiceChildren",desiredValue:e.submittedIndices.includes(i+1),variableIndex:0,childIndex:s-1});return{success:!0,instructions:n}}},t.valueRecordedAtSubmit={isAlias:!0,targetVariableName:"submittedIndices"},t.allFeedbacks={returnDependencies:()=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childGroups:["choices"],variableNames:["feedbacks"]}}),definition({dependencyValues:e}){let r=e.choiceOrder.map(i=>e.choiceChildren[i-1]),n=[];for(let i of r)n.push(...i.stateValues.feedbacks);return{setValue:{allFeedbacks:n}}}},t.numberFeedbacks={public:!0,componentType:"number",returnDependencies:()=>({allFeedbacks:{dependencyType:"stateVariable",variableName:"allFeedbacks"}}),definition({dependencyValues:e}){return{setValue:{numberFeedbacks:e.allFeedbacks.length},checkForActualChange:{numberFeedbacks:!0}}}},t.feedbacks={public:!0,componentType:"feedback",isArray:!0,entryPrefixes:["feedback"],returnArraySizeDependencies:()=>({numberFeedbacks:{dependencyType:"stateVariable",variableName:"numberFeedbacks"}}),returnArraySize({dependencyValues:e}){return[e.numberFeedbacks]},returnArrayDependenciesByKey(){return{globalDependencies:{allFeedbacks:{dependencyType:"stateVariable",variableName:"allFeedbacks"}}}},arrayDefinitionByKey({globalDependencyValues:e}){let r={};for(let n=0;n<e.__array_size;n++)r[n]=e.allFeedbacks[n];return{setValue:{feedbacks:r}}}},t}async updateSelectedIndices({selectedIndices:t,actionId:e}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:e});else{let r=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"allSelectedIndices",value:t}],n=await this.stateValues.choiceTexts,i={verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:t,responseText:t.map(o=>n[o-1])}},s=await this.stateValues.answerAncestor;return s&&(i.context={answerAncestor:s.componentName}),await this.coreFunctions.performUpdate({updateInstructions:r,actionId:e,event:i}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}}static async setUpVariant({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r}){kr({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r})}static determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e}){if(!t.attributes.randomizeOrder?.primitive)return super.determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e});let r=0;for(let o of t.children)if(o.componentType==="choice")r++;else if(e.isInheritedComponentType({inheritedComponentType:o.componentType,baseComponentType:"composite"})&&o.attributes.componentType?.primitive==="choice")if(o.attributes.nComponents?.primitive!==void 0){let l=Number(o.attributes.nComponents?.primitive);if(Number.isInteger(l)&&l>=0)r+=l;else return{success:!1}}else r++;else return{success:!1};let n=1;for(let o=2;o<=r;o++)n*=o;let s=super.determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e}).numberOfVariants*n;return t.variants.numberOfVariants=s,t.variants.uniqueVariantData={numberOfVariantsByDescendant:t.variants.uniqueVariantData.numberOfVariantsByDescendant,numberOfPermutations:n,numberOfChoices:r},{success:!0,numberOfVariants:s}}static getUniqueVariant({serializedComponent:t,variantIndex:e,componentInfoObjects:r}){let n=t.variants?.numberOfVariants;if(n===void 0)return{success:!1};if(!Number.isInteger(e)||e<1||e>n)return{success:!1};if(!t.attributes.randomizeOrder?.primitive)return super.getUniqueVariant({serializedComponent:t,variantIndex:e,componentInfoObjects:r});let i=t.variants.uniqueVariantData.numberOfVariantsByDescendant,s=t.variants.descendantVariantComponents,o=t.variants.uniqueVariantData.numberOfPermutations,l=t.variants.uniqueVariantData.numberOfChoices,u=[...i];u.push(o);let c=ka({numberOfOptionsByIndex:u,maxNumber:e})[e-1].map(g=>g+1),p=c.pop(),m=c,f=[...Array(l).keys()].map(g=>g+1),d=Px({values:f,maxNumber:p})[p-1],h=!1,y=[];for(let g=0;g<i.length;g++)if(i[g]>1){let v=s[g],C=r.allComponentClasses[v.componentType].getUniqueVariant({serializedComponent:v,variantIndex:m[g],componentInfoObjects:r});if(!C.success)return{success:!1};y.push(C.desiredVariant),h=!0}else y.push({});let b={indices:d};return h&&(b.subvariants=y),{success:!0,desiredVariant:b}}};T(Cs,"componentType","choiceInput"),T(Cs,"renderChildren",!0),T(Cs,"variableForPlainMacro","values"),T(Cs,"createsVariants",!0);var Ai=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.credit={createComponentOfType:"number",createStateVariable:"credit",defaultValue:0,public:!0,attributesForCreatedComponent:{convertBoolean:!0}},e.feedbackCodes={createComponentOfType:"textList",createStateVariable:"feedbackCodes",defaultValue:[],public:!0},e.feedbackText={createComponentOfType:"text",createStateVariable:"feedbackText",defaultValue:null,public:!0},e.preSelect={createComponentOfType:"boolean",createStateVariable:"preSelect",defaultValue:!1},e}static returnChildGroups(){return[{group:"children",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.text={public:!0,componentType:"text",returnDependencies:()=>({inlineChildren:{dependencyType:"child",childGroups:["children"],variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r="";for(let n of e.inlineChildren)typeof n!="object"?r+=n.toString():typeof n.stateValues.text=="string"&&(r+=n.stateValues.text);return{setValue:{text:r}}}},t.selected={defaultValue:!1,public:!0,componentType:"boolean",returnDependencies:()=>({countAmongSiblings:{dependencyType:"countAmongSiblingsOfSameType"},childIndicesSelected:{dependencyType:"parentStateVariable",variableName:"childIndicesSelected"}}),definition({dependencyValues:e}){let r;return e.childIndicesSelected?r=e.childIndicesSelected.includes(e.countAmongSiblings):r=!1,{setValue:{selected:r}}},inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"selected",value:e.selected}]}}},t.submitted={defaultValue:!1,hasEssential:!0,public:!0,componentType:"boolean",returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{submitted:!0}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"submitted",value:e.submitted}]}}},t.feedbacks={public:!0,componentType:"feedbacktext",returnDependencies:()=>({feedbackText:{dependencyType:"stateVariable",variableName:"feedbackText"},feedbackCodes:{dependencyType:"stateVariable",variableName:"feedbackCodes"},feedbackDefinitionAncestor:{dependencyType:"ancestor",variableNames:["feedbackDefinitions"]},submitted:{dependencyType:"stateVariable",variableName:"submitted"}}),definition({dependencyValues:e}){if(!e.submitted)return{setValue:{feedbacks:[]}};let r=[],n=e.feedbackDefinitionAncestor.stateValues.feedbackDefinitions;for(let i of e.feedbackCodes){let s=i.toLowerCase(),o=n[s];o&&r.push(o)}return e.feedbackText!==null&&r.push(e.feedbackText),{setValue:{feedbacks:r}}}},t}};T(Ai,"componentType","choice"),T(Ai,"rendererType","container"),T(Ai,"renderChildren",!0),T(Ai,"includeBlankStringChildren",!0),T(Ai,"adapters",["submitted"]);import Iu from"math-expressions";var Si=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:10,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.renderAsMath={createComponentOfType:"boolean",createStateVariable:"renderAsMath",defaultValue:!1,public:!0,forRenderer:!0},e.convertBoolean={createPrimitiveOfType:"boolean",createStateVariable:"convertBoolean",defaultValue:!1},e}static returnSugarInstructions(){let t=super.returnSugarInstructions();return t.push({childrenRegex:/..+/,replacementFunction:({matchedChildren:e,componentAttributes:r})=>({success:!r.convertBoolean,newChildren:[{componentType:"math",children:e}]})}),t}static returnChildGroups(){return[{group:"strings",componentTypes:["string"]},{group:"numbers",componentTypes:["number"]},{group:"maths",componentTypes:["math"]},{group:"texts",componentTypes:["text"]},{group:"booleans",componentTypes:["boolean"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.singleNumberOrStringChild={additionalStateVariablesDefined:["singleMathChild"],returnDependencies:()=>({numberChildren:{dependencyType:"child",childGroups:["numbers"]},stringChildren:{dependencyType:"child",childGroups:["strings"]},mathChildren:{dependencyType:"child",childGroups:["maths"]},booleanChildren:{dependencyType:"child",childGroups:["booleans"]},textChildren:{dependencyType:"child",childGroups:["texts"]}}),definition({dependencyValues:e}){let r=e.numberChildren.length+e.stringChildren.length,n=e.mathChildren.length,i=e.booleanChildren.length+e.textChildren.length,s=r<=1&&n+i===0,o=n===1&&r+i===0;return{setValue:{singleNumberOrStringChild:s,singleMathChild:o}}}},t.parsedExpression={additionalStateVariablesDefined:["codePre"],returnDependencies:()=>({allChildren:{dependencyType:"child",childGroups:["strings","numbers","maths","texts","booleans"]},stringChildren:{dependencyType:"child",childGroups:["strings"],variableNames:["value"]}}),definition:tm},t.mathChildrenByCode={additionalStateVariablesDefined:["textChildrenByCode","numberChildrenByCode","booleanChildrenByCode"],returnDependencies:()=>({allChildren:{dependencyType:"child",childGroups:["strings","numbers","maths","texts","booleans"],variableNames:["value","texts","maths","booleans"],variablesOptional:!0},codePre:{dependencyType:"stateVariable",variableName:"codePre"}}),definition({dependencyValues:e,componentInfoObjects:r}){let n={},i={},s={},o={},l=0,u=e.codePre;for(let c of e.allChildren)if(typeof c!="string"){let p=u+l;r.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"math"})?n[p]=c:r.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"number"})?i[p]=c:r.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"text"})?s[p]=c:o[p]=c,l+=1}return{setValue:{mathChildrenByCode:n,numberChildrenByCode:i,textChildrenByCode:s,booleanChildrenByCode:o}}}},t.value={public:!0,componentType:"number",hasEssential:!0,stateVariablesPrescribingAdditionalAttributes:{fixed:"fixed",displayDigits:"displayDigits",displayDecimals:"displayDecimals",displaySmallAsZero:"displaySmallAsZero"},stateVariablesDeterminingDependencies:["singleNumberOrStringChild"],returnDependencies({stateValues:e}){return e.singleNumberOrStringChild?{singleNumberOrStringChild:{dependencyType:"stateVariable",variableName:"singleNumberOrStringChild"},convertBoolean:{dependencyType:"stateVariable",variableName:"convertBoolean"},numberChild:{dependencyType:"child",childGroups:["numbers"],variableNames:["value"]},stringChild:{dependencyType:"child",childGroups:["strings"],variableNames:["value"]}}:{singleNumberOrStringChild:{dependencyType:"stateVariable",variableName:"singleNumberOrStringChild"},singleMathChild:{dependencyType:"stateVariable",variableName:"singleMathChild"},convertBoolean:{dependencyType:"stateVariable",variableName:"convertBoolean"},parsedExpression:{dependencyType:"stateVariable",variableName:"parsedExpression"},allChildren:{dependencyType:"child",childGroups:["strings","numbers","maths","texts","booleans"],variableNames:["value","texts","maths","unordered"],variablesOptional:!0},booleanChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanChildrenByCode"},textChildrenByCode:{dependencyType:"stateVariable",variableName:"textChildrenByCode"},mathChildrenByCode:{dependencyType:"stateVariable",variableName:"mathChildrenByCode"},numberChildrenByCode:{dependencyType:"stateVariable",variableName:"numberChildrenByCode"}}},defaultValue:NaN,definition({dependencyValues:e,componentInfoObjects:r}){if(e.singleNumberOrStringChild)if(e.numberChild.length===0){if(e.stringChild.length===0)return{useEssentialOrDefaultValue:{value:!0}};let n=Number(e.stringChild[0]);if(Number.isNaN(n))try{if(n=Iu.fromAst(pn.convert(e.stringChild[0])).evaluate_to_constant(),typeof n=="boolean")e.convertBoolean?n=n?1:0:n=NaN;else if(n===null||Number.isNaN(n))if(e.convertBoolean){let i=tm({dependencyValues:{stringChildren:e.stringChild,allChildren:e.stringChild},componentInfoObjects:r}).setValue.parsedExpression;n=Ma({logicTree:i.tree,dependencyValues:{booleanChildrenByCode:{},booleanListChildrenByCode:{},textChildrenByCode:{},textListChildrenByCode:{},mathChildrenByCode:{},mathListChildrenByCode:{},numberChildrenByCode:{},numberListChildrenByCode:{}},valueOnInvalid:NaN})}else n=NaN}catch(i){n=NaN}return{setValue:{value:n}}}else return{setValue:{value:e.numberChild[0].stateValues.value}};else{if(e.parsedExpression===null)return{setValue:{value:NaN}};if(Object.keys(e.textChildrenByCode).length===0&&Object.keys(e.booleanChildrenByCode).length===0){let i=function(o){if(typeof o=="string"){let l=e.mathChildrenByCode[o];return l!==void 0?l.stateValues.value.tree:(l=e.numberChildrenByCode[o],l!==void 0?l.stateValues.value:o)}return Array.isArray(o)?[o[0],...o.slice(1).map(i)]:o},s;try{s=Iu.fromAst(i(e.parsedExpression.tree)).evaluate_to_constant()}catch(o){s=NaN}if(Number.isFinite(s)||s===1/0||s===-1/0)return{setValue:{value:s}}}return e.convertBoolean?(e=Object.assign({},e),e.mathListChildrenByCode={},e.numberListChildrenByCode={},e.textListChildrenByCode={},e.booleanListChildrenByCode={},{setValue:{value:Ma({logicTree:e.parsedExpression.tree,dependencyValues:e,valueOnInvalid:NaN})}}):{setValue:{value:NaN}}}},set:function(e){let r=Number(e);if(Number.isNaN(r))try{r=Iu.fromAst(pn.convert(e)).evaluate_to_constant(),r===null&&(r=NaN)}catch(n){r=NaN}return r},inverseDefinition:async function({desiredStateVariableValues:e,dependencyValues:r,stateValues:n,overrideFixed:i}){if(!await n.canBeModified&&!i)return{success:!1};let s=e.value;if(s instanceof Iu.class?(s=s.evaluate_to_constant(),Number.isFinite(s)||(s=NaN)):s=Number(s),!r.singleNumberOrStringChild)return r.singleMathChild?{success:!0,instructions:[{setDependency:"allChildren",desiredValue:Iu.fromAst(s),childIndex:0,variableIndex:0}]}:{success:!1};let o;return r.numberChild.length===0?r.stringChild.length===0?o=[{setEssentialValue:"value",value:s}]:o=[{setDependency:"stringChild",desiredValue:s.toString(),childIndex:0,variableIndex:0}]:o=[{setDependency:"numberChild",desiredValue:s,childIndex:0,variableIndex:0}],{success:!0,instructions:o}}},t.valueForDisplay={forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"}}),definition:function({dependencyValues:e,usedDefault:r}){let n=Lt({value:e.value,dependencyValues:e,usedDefault:r});return n instanceof Iu.class&&(n=n.tree),{setValue:{valueForDisplay:n}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"},value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{setValue:{text:e.valueForDisplay.toString()}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r}){let n=Number(e.text);if(Number.isFinite(n))return{success:!0,instructions:[{setDependency:"value",desiredValue:n}]};{let i=la({functionSymbols:await r.functionSymbols,splitSymbols:await r.splitSymbols}),s;try{s=i(e.text)}catch(o){return{success:!1}}return n=s.evaluate_to_constant(),Number.isFinite(n)?{success:!0,instructions:[{setDependency:"value",desiredValue:n}]}:{success:!1}}}},t.math=fh({numberVariableName:"value",mathVariableName:"math",isPublic:!0}),t.canBeModified={returnDependencies:()=>({numberChildModifiable:{dependencyType:"child",childGroups:["numbers"],variableNames:["canBeModified"]},modifyIndirectly:{dependencyType:"stateVariable",variableName:"modifyIndirectly"},fixed:{dependencyType:"stateVariable",variableName:"fixed"},singleNumberOrStringChild:{dependencyType:"stateVariable",variableName:"singleNumberOrStringChild"},singleMathChild:{dependencyType:"stateVariable",variableName:"singleMathChild"}}),definition:function({dependencyValues:e}){return!e.modifyIndirectly||e.fixed||!(e.singleNumberOrStringChild||e.singleMathChild)?{setValue:{canBeModified:!1}}:e.numberChildModifiable.length===1&&!e.numberChildModifiable[0].stateValues.canBeModified?{setValue:{canBeModified:!1}}:{setValue:{canBeModified:!0}}}},t}};T(Si,"componentType","number"),T(Si,"variableForPlainMacro","value"),T(Si,"adapters",["math","text"]);import jq from"math-expressions";var Pu=class extends Si{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return $r({stateVariableDefinitions:t,oldName:"value",newName:"valuePreRound"}),t.value={public:!0,componentType:"number",returnDependencies:()=>({valuePreRound:{dependencyType:"stateVariable",variableName:"valuePreRound"}}),definition({dependencyValues:e}){return{setValue:{value:Math.round(e.valuePreRound)}}},inverseDefinition({desiredStateVariableValues:e}){let r=e.value;return r instanceof jq.class?(r=r.evaluate_to_constant(),Number.isFinite(r)||(r=NaN)):r=Number(r),r=Math.round(r),{success:!0,instructions:[{setDependency:"valuePreRound",desiredValue:r}]}}},t}};T(Pu,"componentType","integer"),T(Pu,"rendererType","number");var _u=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.xmin={createComponentOfType:"number",createStateVariable:"xminPrelim",defaultValue:-10},e.xmax={createComponentOfType:"number",createStateVariable:"xmaxPrelim",defaultValue:10},e.ymin={createComponentOfType:"number",createStateVariable:"yminPrelim",defaultValue:-10},e.ymax={createComponentOfType:"number",createStateVariable:"ymaxPrelim",defaultValue:10},e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:{size:300,isAbsolute:!0},public:!0,forRenderer:!0},e.height={createComponentOfType:"_componentSize",createStateVariable:"height",defaultValue:{size:300,isAbsolute:!0},public:!0,forRenderer:!0},e.identicalAxisScales={createComponentOfType:"boolean",createStateVariable:"identicalAxisScales",defaultValue:!1,public:!0,forRenderer:!0},e.displayXAxis={createComponentOfType:"boolean",createStateVariable:"displayXAxis",defaultValue:!0,public:!0,forRenderer:!0},e.displayYAxis={createComponentOfType:"boolean",createStateVariable:"displayYAxis",defaultValue:!0,public:!0,forRenderer:!0},e.xlabel={createComponentOfType:"text",createStateVariable:"xlabel",defaultValue:"",public:!0,forRenderer:!0},e.xlabelPosition={createComponentOfType:"text",createStateVariable:"xlabelPosition",defaultValue:"right",public:!0,forRenderer:!0,toLowerCase:!0,validValues:["right","left"]},e.ylabel={createComponentOfType:"text",createStateVariable:"ylabel",defaultValue:"",public:!0,forRenderer:!0},e.ylabelPosition={createComponentOfType:"text",createStateVariable:"ylabelPosition",defaultValue:"top",public:!0,forRenderer:!0,toLowerCase:!0,validValues:["top","bottom"]},e.ylabelAlignment={createComponentOfType:"text",createStateVariable:"ylabelAlignment",defaultValue:"left",public:!0,forRenderer:!0,toLowerCase:!0,validValues:["left","right"]},e.showNavigation={createComponentOfType:"boolean",createStateVariable:"showNavigation",defaultValue:!0,public:!0,forRenderer:!0},e.fixAxes={createComponentOfType:"boolean",createStateVariable:"fixAxes",defaultValue:!1,public:!0,forRenderer:!0},e.grid={createComponentOfType:"text",createStateVariable:"grid",defaultValue:"none",public:!0,forRenderer:!0,toLowerCase:!0,valueTransformations:{true:"medium",false:"none"},validValues:["none","medium","dense"]},e}static returnChildGroups(){return[{group:"graphical",componentTypes:["_graphical"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.graphicalDescendants={forRenderer:!0,returnDependencies:()=>({graphicalDescendants:{dependencyType:"descendant",componentTypes:["_graphical"]}}),definition:function({dependencyValues:e}){return{setValue:{graphicalDescendants:e.graphicalDescendants}}}},t.nChildrenAdded={defaultValue:0,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{nChildrenAdded:!0}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"nChildrenAdded",value:e.nChildrenAdded}]}}},t.xmin={stateVariablesDeterminingDependencies:["identicalAxisScales"],defaultValue:-10,public:!0,componentType:"number",forRenderer:!0,returnDependencies({stateValues:e}){let r={identicalAxisScales:{dependencyType:"stateVariable",variableName:"identicalAxisScales"},xminPrelim:{dependencyType:"stateVariable",variableName:"xminPrelim"}};return e.identicalAxisScales&&(r.xmaxPrelim={dependencyType:"stateVariable",variableName:"xmaxPrelim"},r.yminPrelim={dependencyType:"stateVariable",variableName:"yminPrelim"},r.ymaxPrelim={dependencyType:"stateVariable",variableName:"ymaxPrelim"},r.width={dependencyType:"stateVariable",variableName:"width"},r.height={dependencyType:"stateVariable",variableName:"height"}),r},definition({dependencyValues:e,usedDefault:r}){if(!e.identicalAxisScales)return{setValue:{xmin:e.xminPrelim}};if(!r.xminPrelim)return{setValue:{xmin:e.xminPrelim}};let i=!r.xmaxPrelim,s=!r.yminPrelim,o=!r.ymaxPrelim;if(s&&o){let u=e.width.size/e.height.size,c=(e.ymaxPrelim-e.yminPrelim)*u;return i?{setValue:{xmin:e.xmaxPrelim-c}}:{setValue:{xmin:-c/2}}}else return i?{setValue:{xmin:e.xmaxPrelim-20}}:{setValue:{xmin:-10}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r}){return await r.fixAxes?{success:!1}:{success:!0,instructions:[{setDependency:"xminPrelim",desiredValue:e.xmin}]}}},t.xmax={stateVariablesDeterminingDependencies:["identicalAxisScales"],defaultValue:-10,public:!0,componentType:"number",forRenderer:!0,returnDependencies({stateValues:e}){let r={identicalAxisScales:{dependencyType:"stateVariable",variableName:"identicalAxisScales"},xmaxPrelim:{dependencyType:"stateVariable",variableName:"xmaxPrelim"}};return e.identicalAxisScales&&(r.xminPrelim={dependencyType:"stateVariable",variableName:"xminPrelim"},r.yminPrelim={dependencyType:"stateVariable",variableName:"yminPrelim"},r.ymaxPrelim={dependencyType:"stateVariable",variableName:"ymaxPrelim"},r.width={dependencyType:"stateVariable",variableName:"width"},r.height={dependencyType:"stateVariable",variableName:"height"}),r},definition({dependencyValues:e,usedDefault:r}){if(!e.identicalAxisScales)return{setValue:{xmax:e.xmaxPrelim}};let n=!r.xminPrelim,i=!r.xmaxPrelim,s=!r.yminPrelim,o=!r.ymaxPrelim,l=s&&o,u=n&&i,c=e.xminPrelim;if(l){let p=e.width.size/e.height.size,m=(e.ymaxPrelim-e.yminPrelim)*p;if(u){let f=e.xmaxPrelim-c,d=Math.max(f,m);return{setValue:{xmax:c+d}}}else return n?{setValue:{xmax:c+m}}:i?{setValue:{xmax:e.xmaxPrelim}}:{setValue:{xmax:m/2}}}else return i?{setValue:{xmax:e.xmaxPrelim}}:n?{setValue:{xmax:c+20}}:{setValue:{xmax:10}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r}){return await r.fixAxes?{success:!1}:{success:!0,instructions:[{setDependency:"xmaxPrelim",desiredValue:e.xmax}]}}},t.ymin={stateVariablesDeterminingDependencies:["identicalAxisScales"],defaultValue:-10,public:!0,componentType:"number",forRenderer:!0,returnDependencies({stateValues:e}){let r={identicalAxisScales:{dependencyType:"stateVariable",variableName:"identicalAxisScales"},yminPrelim:{dependencyType:"stateVariable",variableName:"yminPrelim"}};return e.identicalAxisScales&&(r.xmaxPrelim={dependencyType:"stateVariable",variableName:"xmaxPrelim"},r.xminPrelim={dependencyType:"stateVariable",variableName:"xminPrelim"},r.ymaxPrelim={dependencyType:"stateVariable",variableName:"ymaxPrelim"},r.width={dependencyType:"stateVariable",variableName:"width"},r.height={dependencyType:"stateVariable",variableName:"height"}),r},definition({dependencyValues:e,usedDefault:r}){if(!e.identicalAxisScales)return{setValue:{ymin:e.yminPrelim}};if(!r.yminPrelim)return{setValue:{ymin:e.yminPrelim}};let i=!r.ymaxPrelim,s=!r.xminPrelim,o=!r.xmaxPrelim,l=s&&o,u=e.width.size/e.height.size;if(l){let c=(e.xmaxPrelim-e.xminPrelim)/u;return i?{setValue:{ymin:e.ymaxPrelim-c}}:{setValue:{ymin:-c/2}}}else return i?{setValue:{ymin:e.ymaxPrelim-20/u}}:{setValue:{ymin:-10/u}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r}){return await r.fixAxes?{success:!1}:{success:!0,instructions:[{setDependency:"yminPrelim",desiredValue:e.ymin}]}}},t.ymax={stateVariablesDeterminingDependencies:["identicalAxisScales"],defaultValue:-10,public:!0,componentType:"number",forRenderer:!0,returnDependencies({stateValues:e}){let r={identicalAxisScales:{dependencyType:"stateVariable",variableName:"identicalAxisScales"},ymaxPrelim:{dependencyType:"stateVariable",variableName:"ymaxPrelim"}};return e.identicalAxisScales&&(r.xminPrelim={dependencyType:"stateVariable",variableName:"xminPrelim"},r.yminPrelim={dependencyType:"stateVariable",variableName:"yminPrelim"},r.xmaxPrelim={dependencyType:"stateVariable",variableName:"xmaxPrelim"},r.width={dependencyType:"stateVariable",variableName:"width"},r.height={dependencyType:"stateVariable",variableName:"height"}),r},definition({dependencyValues:e,usedDefault:r}){if(!e.identicalAxisScales)return{setValue:{ymax:e.ymaxPrelim}};let n=!r.xminPrelim,i=!r.xmaxPrelim,s=!r.yminPrelim,o=!r.ymaxPrelim,l=s&&o,u=n&&i,c=e.yminPrelim,p=e.width.size/e.height.size;if(u){let m=(e.xmaxPrelim-e.xminPrelim)/p;if(l){let f=e.ymaxPrelim-c,d=Math.max(f,m);return{setValue:{ymax:c+d}}}else return s?{setValue:{ymax:c+m}}:o?{setValue:{ymax:e.ymaxPrelim}}:{setValue:{ymax:m/2}}}else return o?{setValue:{ymax:e.ymaxPrelim}}:s?{setValue:{ymax:c+20/p}}:{setValue:{ymax:10/p}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r}){return await r.fixAxes?{success:!1}:{success:!0,instructions:[{setDependency:"ymaxPrelim",desiredValue:e.ymax}]}}},t.xscale={public:!0,componentType:"number",returnDependencies:()=>({xmin:{dependencyType:"stateVariable",variableName:"xmin"},xmax:{dependencyType:"stateVariable",variableName:"xmax"}}),definition({dependencyValues:e}){return{setValue:{xscale:e.xmax-e.xmin}}}},t.yscale={public:!0,componentType:"number",returnDependencies:()=>({ymin:{dependencyType:"stateVariable",variableName:"ymin"},ymax:{dependencyType:"stateVariable",variableName:"ymax"}}),definition({dependencyValues:e}){return{setValue:{yscale:e.ymax-e.ymin}}}},t}async changeAxisLimits({xmin:t,xmax:e,ymin:r,ymax:n,actionId:i}){let s=[];return t!==void 0&&s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"xmin",value:t}),e!==void 0&&s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"xmax",value:e}),r!==void 0&&s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"ymin",value:r}),n!==void 0&&s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"ymax",value:n}),await this.coreFunctions.performUpdate({updateInstructions:s,actionId:i,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{xmin:t,xmax:e,ymin:r,ymax:n}}})}async addChildren({serializedComponents:t,actionId:e}){if(t&&t.length>0){let r=de({serializedComponents:t,parentName:this.componentName,parentCreatesNewNamespace:this.attributes.newNamespace&&this.attributes.newNamespace.primitive,componentInfoObjects:this.componentInfoObjects,indOffset:await this.stateValues.nChildrenAdded});return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"addComponents",serializedComponents:r.serializedComponents,parentName:this.componentName,assignNamesOffset:await this.stateValues.nChildrenAdded},{updateType:"updateValue",componentName:this.componentName,stateVariable:"nChildrenAdded",value:await this.stateValues.nChildrenAdded+r.serializedComponents.length}],actionId:e})}else this.coreFunctions.resolveAction({actionId:e})}async deleteChildren({number:t,actionId:e}){let r=Math.min(t,await this.stateValues.nChildrenAdded);if(r>0){let n=this.definingChildren.length,i=this.definingChildren.slice(n-r,n).map(s=>s.componentName);return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"deleteComponents",componentNames:i},{updateType:"updateValue",componentName:this.componentName,stateVariable:"nChildrenAdded",value:await this.stateValues.nChildrenAdded-r}],actionId:e})}else this.coreFunctions.resolveAction({actionId:e})}actions={changeAxisLimits:this.changeAxisLimits.bind(this),addChildren:this.addChildren.bind(this),deleteChildren:this.deleteChildren.bind(this)}};T(_u,"componentType","graph"),T(_u,"renderChildren",!0);import"math-expressions";var ku=class extends xn{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();t.variables={public:!0,componentType:"variable",isArray:!0,entryPrefixes:["var"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:r}){return[r.nComponents]},returnArrayDependenciesByKey({arrayKeys:r}){let n={};for(let i of r)n[i]={math:{dependencyType:"stateVariable",variableName:"math"+(Number(i)+1)}};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:n}){let i={};for(let s of n)i[s]=r[s].math;return{setValue:{variables:i}}}};let e=this.componentType;return t.validVariables={returnDependencies:()=>({variables:{dependencyType:"stateVariable",variableName:"variables"}}),definition:function({dependencyValues:r}){let n=[];for(let i of r.variables){let s=mh(i);s||(console.warn("Invalid value for "+e),s=!1),n.push(s)}return{setValue:{validVariables:n}}}},t}};T(ku,"componentType","variables"),T(ku,"stateVariableForAttributeValue","variables");var Fu=class extends ot{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.validVariable={returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){let r=mh(e.value);return r||console.warn("Invalid value of a "+this.componentType),{setValue:{validVariable:r}}}},t}};T(Fu,"componentType","variable"),T(Fu,"rendererType","math");var As=class extends Dt{};T(As,"componentType","group"),T(As,"renderedDefault",!0);var ju=class extends As{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.selectForVariantNames={createComponentOfType:"variantNames",createStateVariable:"selectForVariantNames",defaultValue:[],public:!0},e.selectWeight={createComponentOfType:"number",createStateVariable:"selectWeight",defaultValue:1,public:!0},e}};T(ju,"componentType","option"),T(ju,"renderedDefault",!1);var wi=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);e.fixed={leaveRaw:!0};let r=Dh();return Object.assign(e,r),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=Ih();return Object.assign(t,e),t.readyToExpandWhenResolved={returnDependencies:()=>({from:{dependencyType:"stateVariable",variableName:"from"},length:{dependencyType:"stateVariable",variableName:"length"},step:{dependencyType:"stateVariable",variableName:"step"},type:{dependencyType:"stateVariable",variableName:"type"},exclude:{dependencyType:"stateVariable",variableName:"exclude"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,workspace:e,componentInfoObjects:r,flags:n}){if(!await t.stateValues.validSequence)return e.lastReplacementParameters={from:null,length:null,step:null,type:null,exclude:null},{replacements:[]};let i=await t.stateValues.from,s=await t.stateValues.length,o=await t.stateValues.step,l=await t.stateValues.type,u=await t.stateValues.exclude;e.lastReplacementParameters={from:i,length:s,step:o,type:l,exclude:u};let c=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,p=cu({from:i,step:o,length:s,exclude:u,type:l,lowercase:await t.stateValues.lowercase}),m=l;l==="letters"&&(m="text");let f=[];for(let h of p){let y={};"fixed"in t.attributes&&(y=Ze({attributes:{fixed:t.attributes.fixed},componentType:m,componentInfoObjects:r,compositeCreatesNewNamespace:c,flags:n}));let b={componentType:m,attributes:y,state:{value:h,fixed:!0}};f.push(b)}return{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:f,parentName:t.componentName,parentCreatesNewNamespace:c,componentInfoObjects:r}).serializedComponents}}static async calculateReplacementChanges({component:t,workspace:e,componentInfoObjects:r,flags:n}){let i=e.lastReplacementParameters,s=[];if(!await t.stateValues.validSequence){let f=t.replacementsToWithhold;if(f||(f=0),t.replacements.length-f>0){let d=t.replacements.length,h={changeType:"changeReplacementsToWithhold",replacementsToWithhold:d};s.push(h)}return i.length=0,s}let o=await t.stateValues.from,l=await t.stateValues.length,u=await t.stateValues.step,c=await t.stateValues.type,p=await t.stateValues.exclude,m=await t.stateValues.lowercase;if(i.type!==c||i.exclude.length>0||p.length>0){let f=(await this.createSerializedReplacements({component:t,workspace:e,componentInfoObjects:r,flags:n})).replacements,d={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:f,replacementsToWithhold:0};s.push(d)}else{let f=!1;c==="math"?o.equals(i.from)&&u.equals(i.step)||(f=!0):(o!==i.from||u!==i.step)&&(f=!0);let d=i.length,h=0,y=0,b=d,g;if(l<d){g=t.replacements.length-l;let v={changeType:"changeReplacementsToWithhold",replacementsToWithhold:g};s.push(v)}else if(l>d&&(h=l-d,t.replacementsToWithhold>0))if(t.replacementsToWithhold>=h){g=t.replacementsToWithhold-h,y+=h,d+=h,h=0;let v={changeType:"changeReplacementsToWithhold",replacementsToWithhold:g};s.push(v)}else h-=t.replacementsToWithhold,y+=t.replacementsToWithhold,d+=t.replacementsToWithhold,g=0;if(f===!0&&(y=d,b=0),y>0)for(let v=b;v<b+y;v++){let A=Co({index:v,from:o,step:u,exclude:[],type:c,lowercase:m}),C={changeType:"updateStateVariables",component:t.replacements[v],stateChanges:{value:A}};s.push(C)}if(h>0){let v=[],A=t.attributes.newNamespace&&t.attributes.newNamespace.primitive;for(let w=d;w<await t.stateValues.length;w++){let x=Co({index:w,from:o,step:u,exclude:[],type:c,lowercase:m}),R=await t.stateValues.type;R==="letters"&&(R="text");let O={};"fixed"in t.attributes&&(O=Ze({attributes:{fixed:t.attributes.fixed},componentType:R,componentInfoObjects:r,compositeCreatesNewNamespace:A,flags:n}));let _={componentType:R,attributes:O,state:{value:x,fixed:!0}};v.push(_)}let C=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:v,parentName:t.componentName,parentCreatesNewNamespace:A,componentInfoObjects:r,indOffset:d}),S={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:d,serializedReplacements:C.serializedComponents,replacementsToWithhold:0,assignNamesOffset:d};s.push(S)}}return i.type=c,i.from=o,i.length=l,i.step=u,i.exclude=p,s}get allPotentialRendererTypes(){let t=super.allPotentialRendererTypes,e="number";this.attributes.type&&this.attributes.type.primitive&&(e=this.attributes.type.primitive);let r=this.componentInfoObjects.allComponentClasses[e==="letters"?"text":e].rendererType;return t.includes(r)||t.push(r),t}};T(wi,"componentType","sequence"),T(wi,"assignNamesToReplacements",!0),T(wi,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");var Ss=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.behavior={createComponentOfType:"text",createStateVariable:"behavior",defaultValue:"combination",public:!0,trim:!0},e.isResponse={leaveRaw:!0},e}static returnChildGroups(){return[{group:"templates",componentTypes:["template"]},{group:"sources",componentTypes:["sources"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nSources={additionalStateVariablesDefined:["sourcesNames","sourceAliases","sourceIndexAliases"],returnDependencies:()=>({sourcesChildren:{dependencyType:"child",childGroups:["sources"],variableNames:["alias","indexAlias"]}}),definition:function({dependencyValues:e}){return{setValue:{nSources:e.sourcesChildren.length,sourcesNames:e.sourcesChildren.map(r=>r.componentName),sourceAliases:e.sourcesChildren.map(r=>r.stateValues.alias),sourceIndexAliases:e.sourcesChildren.map(r=>r.stateValues.indexAlias)}}}},t.nIterates={additionalStateVariablesDefined:["minNIterates","sourcesChildNames"],returnDependencies:()=>({sourcesChildren:{dependencyType:"child",childGroups:["sources"],variableNames:["numberOfChildren","childComponentNames"]}}),definition:function({dependencyValues:e}){let r=e.sourcesChildren.map(s=>s.stateValues.numberOfChildren),n=Math.min(...r),i=e.sourcesChildren.map(s=>[...s.stateValues.childComponentNames]);return{setValue:{nIterates:r,minNIterates:n,sourcesChildNames:i}}}},t.template={returnDependencies:()=>({templateChild:{dependencyType:"child",childGroups:["templates"],variableNames:["serializedChildren","newNamespace"]}}),definition:function({dependencyValues:e}){let r=e.templateChild[0];if(!r)return{setValue:{template:null}};let n=r.stateValues.serializedChildren,i={componentType:"template",state:{rendered:!0},children:n,originalName:r.componentName};return r.stateValues.newNamespace&&(i.attributes={newNamespace:{primitive:!0}}),{setValue:{template:i}}}},t.validBehavior={returnDependencies:()=>({behavior:{dependencyType:"stateVariable",variableName:"behavior"},nIterates:{dependencyType:"stateVariable",variableName:"nIterates"}}),definition:function({dependencyValues:e}){let r=!0;return e.behavior==="parallel"?e.nIterates.slice(1).some(n=>n!=e.nIterates[0])&&console.warn("Warning: map with parallel behavior and different numbers of iterates in sources activeChildren. Extra iterates will be ignored."):e.behavior!=="combination"&&(console.warn("Invalid map behavior: "+e.behavior),r=!1),{setValue:{validBehavior:r}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({validBehavior:{dependencyType:"stateVariable",variableName:"validBehavior"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={returnDependencies:({sharedParameters:e,componentInfoObjects:r})=>({variantSeed:{dependencyType:"value",value:e.variantSeed},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(r.componentTypesCreatingVariants),variableNames:["isVariantComponent","generatedVariantInfo"],useReplacementsForComposites:!0,recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfEncounteredComposites:!0}}),definition({dependencyValues:e,componentName:r}){let n={seed:e.variantSeed,meta:{createdBy:r}},i=n.subvariants=[];for(let s of e.variantDescendants)s.stateValues.isVariantComponent?i.push(s.stateValues.generatedVariantInfo):s.stateValues.generatedVariantInfo&&i.push(...s.stateValues.generatedVariantInfo.subvariants);return{setValue:{generatedVariantInfo:n}}}},t}static async createSerializedReplacements({component:t,workspace:e,componentInfoObjects:r,flags:n}){if(!await t.stateValues.validBehavior)return e.lastReplacementParameters={sourcesNames:[],sourcesChildNames:[],behavior:void 0,nIterates:void 0,minNIterates:void 0},{replacements:[]};e.lastReplacementParameters={sourcesNames:await t.stateValues.sourcesNames,sourcesChildNames:await t.stateValues.sourcesChildNames,behavior:await t.stateValues.behavior,nIterates:await t.stateValues.nIterates,minNIterates:await t.stateValues.minNIterates,replacementsToWithhold:0,withheldSubstitutionChildNames:[]};let i=[];if(await t.stateValues.behavior==="parallel")for(let s=0;s<await t.stateValues.minNIterates;s++)i.push(...await this.parallelReplacement({component:t,iter:s,componentInfoObjects:r,flags:n}));else i=(await this.recurseThroughCombinations({component:t,sourcesNumber:0,iterateNumber:-1,componentInfoObjects:r,flags:n})).replacements;return{replacements:i}}static async parallelReplacement({component:t,iter:e,componentInfoObjects:r,flags:n}){let i=[Re(await t.stateValues.template)],s=t.attributes.newNamespace?.primitive;if("isResponse"in t.attributes){let l=Ze({attributes:{isResponse:t.attributes.isResponse},componentType:repl.componentType,componentInfoObjects:r,compositeCreatesNewNamespace:s,flags:n});i[0].attributes||(i[0].attributes={}),Object.assign(i[0].attributes,l)}return i=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:i,parentName:t.componentName,parentCreatesNewNamespace:s,componentInfoObjects:r,indOffset:e}).serializedComponents,await rV(i[0],t,Array(await t.stateValues.nSources).fill(e)),i}static async recurseThroughCombinations({component:t,sourcesNumber:e,childnumberArray:r=[],iterateNumber:n,componentInfoObjects:i,flags:s}){let o=[],l=[...r,0],u=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,c=await t.stateValues.nIterates,p=await t.stateValues.nSources,m=await t.stateValues.template,f=this.createAttributesObject({flags:s});for(let d=0;d<c[e];d++)if(l[e]=d,e>=p-1){n++;let h=[Re(m)],y={};y=Ze({attributes:t.attributes,componentType:h[0].componentType,componentInfoObjects:i,compositeAttributesObj:f,compositeCreatesNewNamespace:u,flags:s}),h[0].attributes||(h[0].attributes={}),Object.assign(h[0].attributes,y);let g=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:h,parentName:t.componentName,parentCreatesNewNamespace:u,componentInfoObjects:i,indOffset:n}).serializedComponents[0];await rV(g,t,l),o.push(g)}else{let h=await this.recurseThroughCombinations({component:t,sourcesNumber:e+1,childnumberArray:l,iterateNumber:n,componentInfoObjects:i,flags:s});o.push(...h.replacements),n=h.iterateNumber}return{replacements:o,iterateNumber:n}}static async calculateReplacementChanges({component:t,components:e,workspace:r,componentInfoObjects:n,flags:i}){let s=[];if(!await t.stateValues.validBehavior){if(r.lastReplacementParameters={sourcesNames:[],sourcesChildNames:[],behavior:void 0,nIterates:void 0,minNIterates:void 0,replacementsToWithhold:0,withheldSubstitutionChildNames:[]},t.replacements.length>0){let C={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToDelete:t.replacements.length,replacementsToWithhold:0};s.push(C)}return s}let o=r.lastReplacementParameters,l=!1,u=!0,c=await t.stateValues.nSources,p=await t.stateValues.sourcesNames;if(c!==o.sourcesNames.length)u=!1;else for(let C=0;C<c;C++)if(p[C]!==o.sourcesNames[C]){u=!1;break}let m=await t.stateValues.nIterates,f=await t.stateValues.sourcesChildNames,d=await t.stateValues.behavior;if(!u||o.behavior!==await d)l=!0;else{let C=!0;if(o.nIterates===void 0)l=!0;else for(let S=0;S<c;S++){let w=m[S],x=o.nIterates[S];w!==x&&(C=!1);let R=Math.min(w,x);for(let O=0;O<R;O++)if(f[S][O]!=o.sourcesChildNames[S][O]){l=!0,C=!1;break}if(l)break}if(C)return[];d==="combination"&&c>1&&(l=!0)}if(l){let C=await this.createSerializedReplacements({component:t,workspace:r,componentInfoObjects:n,flags:i}).replacements,S={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:C,replacementsToWithhold:0};return s.push(S),r.lastReplacementParameters={sourcesNames:p,sourcesChildNames:f,behavior:d,nIterates:m,minNIterates:await t.stateValues.minNIterates,replacementsToWithhold:0,withheldSubstitutionChildNames:[]},s}let h=await t.stateValues.minNIterates,y=o.minNIterates,b=0,g=t.replacementsToWithhold;g||(g=0);let v=o.withheldSubstitutionChildNames,A=!1;if(h<y){for(let C=0;C<c;C++)for(let S=h;S<y;S++)e[o.sourcesChildNames[C][S]]===void 0&&(A=!0);if(!A)for(let C of o.withheldSubstitutionChildNames)for(let S of C)e[S]===void 0&&(A=!0)}if(A){let C=Math.min(h,y),S=t.replacements.length-C,w={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:C,numberReplacementsToDelete:S,replacementsToWithhold:0};s.push(w),v=[],g=0}if(h<y){if(!A){b=t.replacements.length-h;let C={changeType:"changeReplacementsToWithhold",replacementsToWithhold:b};s.push(C);for(let S=0;S<c;S++){let w=o.withheldSubstitutionChildNames[S];w?w=[...w]:w=[],w=new Set([...o.sourcesChildNames[S].slice(h),...w]),v[S]=w}}}else if(h>y){let C=h-y;if(g>0)if(g>=C){b=g-C,C=0;let S={changeType:"changeReplacementsToWithhold",replacementsToWithhold:b};s.push(S)}else C-=g,y+=g,b=0;if(C>0){let S=[];for(let R=y;R<h;R++)S.push(...await this.parallelReplacement({component:t,iter:R,componentInfoObjects:n,flags:i}));let w=0;t.doenetAttributes.assignNames&&(w=t.doenetAttributes.assignNames.length);let x={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:y,serializedReplacements:S,replacementsToWithhold:0,assignNamesOffset:y};s.push(x)}}return r.lastReplacementParameters={sourcesNames:p,sourcesChildNames:f,behavior:d,nIterates:m,minNIterates:h,replacementsToWithhold:b,withheldSubstitutionChildNames:v},s}static async setUpVariant({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r}){kr({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r})}static determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e}){let r=t.variants?.numberOfVariants;if(r!==void 0)return{success:!0,numberOfVariants:r};let n=_a({serializedComponents:t.children,componentInfoObjects:e}),i=[];for(let s of n){let l=e.allComponentClasses[s.componentType].determineNumberOfUniqueVariants({serializedComponent:s,componentInfoObjects:e});if(!l.success)return{success:!1};i.push(l.numberOfVariants)}return i.length===1&&i[0]===1?(t.variants.numberOfVariants=1,{success:!0,numberOfVariants:1}):{success:!1}}static getUniqueVariant({serializedComponent:t,variantIndex:e,componentInfoObjects:r}){let n=t.variants?.numberOfVariants;return n===void 0?{success:!1}:!Number.isInteger(e)||e<1||e>n?{success:!1}:{success:!0,desiredVariant:{index:e}}}};T(Ss,"componentType","map"),T(Ss,"assignNamesToReplacements",!0),T(Ss,"createsVariants",!0),T(Ss,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");async function rV(a,t,e){let r=a.doenetAttributes.addToSharedParameters=[],n=await t.stateValues.sourcesNames;for(let[i,s]of(await t.stateValues.sourceAliases).entries())if(s){let o=n[i];r.push({parameterName:"sourceNameMappings",key:s,value:{name:o,childNumber:e[i]}})}for(let[i,s]of(await t.stateValues.sourceIndexAliases).entries())s&&r.push({parameterName:"sourceIndexMappings",key:s,value:e[i]+1})}var Do=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.alias={createPrimitiveOfType:"string",validationFunction:function(r){if(!/[a-zA-Z_]/.test(r.substring(0,1)))throw Error("All aliases must begin with a letter or an underscore");if(!/^[a-zA-Z0-9_\-]+$/.test(r))throw Error("Aliases can contain only letters, numbers, hyphens, and underscores");return r}},e.indexAlias={createPrimitiveOfType:"string",validationFunction:function(r){if(!/[a-zA-Z_]/.test(r.substring(0,1)))throw Error("All index aliases must begin with a letter or an underscore");if(!/^[a-zA-Z0-9_\-]+$/.test(r))throw Error("Index aliases can contain only letters, numbers, hyphens, and underscores");return r}},e}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.alias={returnDependencies:()=>({alias:{dependencyType:"attributePrimitive",attributeName:"alias"}}),definition({dependencyValues:e}){return{setValue:{alias:e.alias}}}},t.indexAlias={returnDependencies:()=>({indexAlias:{dependencyType:"attributePrimitive",attributeName:"indexAlias"}}),definition({dependencyValues:e}){return{setValue:{indexAlias:e.indexAlias}}}},t.numberOfChildren={additionalStateVariablesDefined:["childComponentNames","childIdentities"],returnDependencies:()=>({children:{dependencyType:"child",childGroups:["anything"]}}),definition:function({dependencyValues:e}){let r=e.children.length,n=e.children.map(i=>i.componentName);return{setValue:{numberOfChildren:r,childComponentNames:n,childIdentities:e.children}}}},t}};T(Do,"componentType","sources"),T(Do,"rendererType","container"),T(Do,"renderChildren",!0);import Mq from"math-expressions";var Mu=class extends J{constructor(t){super(t);this.changeValue=this.changeValue.bind(this),this.actions={changeValue:this.changeValue}}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.type={createPrimitiveOfType:"string",createStateVariable:"type",defaultValue:"number",toLowerCase:!0,validValues:["number","text"],forRenderer:!0},e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:{size:300,isAbsolute:!0},public:!0,forRenderer:!0},e.height={createComponentOfType:"_componentSize",createStateVariable:"height",defaultValue:{size:100,isAbsolute:!0},public:!0,forRenderer:!0},e.initialValue={createComponentOfType:"_componentWithSelectableType",createStateVariable:"initialValue",defaultValue:null},e.label={createComponentOfType:"text",createStateVariable:"label",defaultValue:null,public:!0,forRenderer:!0},e.showControls={createComponentOfType:"boolean",createStateVariable:"showControls",defaultValue:!1,public:!0,forRenderer:!0},e.showTicks={createComponentOfType:"boolean",createStateVariable:"showTicks",defaultValue:!0,public:!0,forRenderer:!0},e.showValue={createComponentOfType:"boolean",createStateVariable:"showValue",defaultValue:!0,public:!0,forRenderer:!0},e.from={createComponentOfType:"number",createStateVariable:"from",defaultValue:0,public:!0,forRenderer:!0},e.to={createComponentOfType:"number",createStateVariable:"to",defaultValue:10,public:!0,forRenderer:!0},e.step={createComponentOfType:"number",createStateVariable:"step",defaultValue:1,public:!0,forRenderer:!0},e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:10,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e.bindValueTo={createComponentOfType:"_componentWithSelectableType"},e}static returnChildGroups(){return[{group:"numbersTexts",componentTypes:["number","text"]},{group:"markers",componentTypes:["markers"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.items={forRenderer:!0,public:!0,hasVariableComponentType:!0,returnDependencies:()=>({numberAndTextChildren:{dependencyType:"child",childGroups:["numbersTexts"],variableNames:["value"]},type:{dependencyType:"stateVariable",variableName:"type"}}),definition:function({dependencyValues:e,componentInfoObjects:r}){let n=[];if(e.type==="text")for(let i of e.numberAndTextChildren)r.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"text"})?n.push(i.stateValues.value):n.push(i.stateValues.value.toString());else if(e.numberAndTextChildren.length>0){for(let i of e.numberAndTextChildren)if(r.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"number"}))n.push(i.stateValues.value);else{let s=Number(i.stateValues.value);Number.isFinite(s)&&n.push(s)}n.sort((i,s)=>i-s)}return{setValue:{items:n},setComponentType:{items:e.type}}}},t.nItems={forRenderer:!0,public:!0,componentType:"integer",returnDependencies:()=>({items:{dependencyType:"stateVariable",variableName:"items"},from:{dependencyType:"stateVariable",variableName:"from"},to:{dependencyType:"stateVariable",variableName:"to"},step:{dependencyType:"stateVariable",variableName:"step"},type:{dependencyType:"stateVariable",variableName:"type"}}),definition({dependencyValues:e}){let r=e.items.length;return r===0&&e.type==="number"&&(r=Math.floor((e.to-e.from)/e.step+1e-10)+1,r>=0&&Number.isFinite(r)||(r=0)),{setValue:{nItems:r}}}},t.firstItem={forRenderer:!0,returnDependencies:()=>({items:{dependencyType:"stateVariable",variableName:"items"},from:{dependencyType:"stateVariable",variableName:"from"},type:{dependencyType:"stateVariable",variableName:"type"}}),definition({dependencyValues:e}){let r;return e.items.length>0?r=e.items[0]:e.type==="number"?r=e.from:r=null,{setValue:{firstItem:r}}}},t.lastItem={forRenderer:!0,returnDependencies:()=>({items:{dependencyType:"stateVariable",variableName:"items"},from:{dependencyType:"stateVariable",variableName:"from"},nItems:{dependencyType:"stateVariable",variableName:"nItems"},step:{dependencyType:"stateVariable",variableName:"step"},type:{dependencyType:"stateVariable",variableName:"type"}}),definition({dependencyValues:e}){let r;return e.items.length>0?r=e.items[e.items.length-1]:e.type==="number"?r=e.from+(e.nItems-1)*e.step:r=null,{setValue:{lastItem:r}}}},t.valueToIndex={forRenderer:!0,returnDependencies:()=>({items:{dependencyType:"stateVariable",variableName:"items"}}),definition:function({dependencyValues:e}){let r={};for(let[n,i]of e.items.entries())r[i]=n;return{setValue:{valueToIndex:r}}}},t.preliminaryValue={hasEssential:!0,returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},initialValue:{dependencyType:"stateVariable",variableName:"initialValue"},bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["value"]}}),definition({dependencyValues:e}){return e.bindValueTo?{setValue:{preliminaryValue:e.bindValueTo.stateValues.value}}:{useEssentialOrDefaultValue:{preliminaryValue:{get defaultValue(){return e.initialValue}}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.bindValueTo?{success:!0,instructions:[{setDependency:"bindValueTo",desiredValue:e.preliminaryValue,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"preliminaryValue",value:e.preliminaryValue}]}}},t.index={forRenderer:!0,returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},valueToIndex:{dependencyType:"stateVariable",variableName:"valueToIndex"},items:{dependencyType:"stateVariable",variableName:"items"},preliminaryValue:{dependencyType:"stateVariable",variableName:"preliminaryValue"},from:{dependencyType:"stateVariable",variableName:"from"},step:{dependencyType:"stateVariable",variableName:"step"},nItems:{dependencyType:"stateVariable",variableName:"nItems"}}),definition:function({dependencyValues:e}){let r=nV(e);return r===void 0&&(r=0),{setValue:{index:r}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){if(r.items.length===0){let i=r.from,s=r.step,o=e.index;return Number.isInteger(o)?o>=0&&o<r.nItems?{success:!0,instructions:[{setDependency:"preliminaryValue",desiredValue:i+o*s}]}:{success:!1}:{success:!1}}let n=r.items[e.index];return n===void 0?{success:!1}:{success:!0,instructions:[{setDependency:"preliminaryValue",desiredValue:n}]}}},t.value={forRenderer:!0,public:!0,hasVariableComponentType:!0,returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},items:{dependencyType:"stateVariable",variableName:"items"},index:{dependencyType:"stateVariable",variableName:"index"},from:{dependencyType:"stateVariable",variableName:"from"},step:{dependencyType:"stateVariable",variableName:"step"}}),definition:function({dependencyValues:e}){let r;return e.items.length>0?r=e.items[e.index]:r=e.from+e.step*e.index,{setValue:{value:r},setComponentType:{value:e.type}}},inverseDefinition:Bq},t.valueForDisplay={forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}}),definition:function({dependencyValues:e,usedDefault:r}){return{setValue:{valueForDisplay:Lt({value:e.value,dependencyValues:e,usedDefault:r}).tree}}}},t.markers={forRenderer:!0,returnDependencies:()=>({markersChild:{dependencyType:"child",childGroups:["markers"],variableNames:["markerType","markers"]},type:{dependencyType:"stateVariable",variableName:"type"},items:{dependencyType:"stateVariable",variableName:"items"}}),definition:function({dependencyValues:e}){let r=[];if(e.markersChild.length>0){let n=e.markersChild[0].stateValues.markerType;n==="empty"?r=[...e.items]:n!==e.type?(console.warn("Markers type doesn't match slider type."),r=[]):r=e.markersChild[0].stateValues.markers}return{setValue:{markers:r}}}},t}async changeValue({value:t,transient:e,actionId:r}){if(await this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:r});else return e?await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:t}],transient:e,actionId:r}):await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:t}],actionId:r,event:{verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:t,responseText:t.toString()}}})}};T(Mu,"componentType","slider"),T(Mu,"variableForPlainMacro","value");function nV({preliminaryValue:a,valueToIndex:t,type:e,items:r,from:n,step:i,nItems:s}){let o=a;if(r.length===0){if(!Number.isFinite(o))return;let p=Math.round((o-n)/i);return p>=0?p<s?p:s-1:0}let l=t[o];if(l!==void 0)return l;if(e==="text")return;let u=function(p=0,m=r.length-1){if(m<=p+1)return o>r[p]?m:p;let f=Math.round((m+p)/2);return o>r[f]?u(f,m):u(p,f)},c=u();if(c!==0){let p=r[c-1],m=r[c],f=Math.abs(o-p),d=Math.abs(o-m);f<d&&c--}return c}async function Bq({desiredStateVariableValues:a,stateValues:t}){let e=a.value;if(await t.type==="text")e=e.toString();else if(e instanceof Mq.class){if(e=e.evaluate_to_constant(),e===null)return{success:!1}}else e=Number(e);let r=nV({preliminaryValue:e,valueToIndex:await t.valueToIndex,type:await t.type,items:await t.items,from:await t.from,step:await t.step,nItems:await t.nItems});return r===void 0?{success:!1}:{success:!0,instructions:[{setDependency:"index",desiredValue:r}]}}var Sm=class extends J{static returnChildGroups(){return[{group:"texts",componentTypes:["text"]},{group:"numbers",componentTypes:["number"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.markerType={public:!0,componentType:"text",returnDependencies:()=>({textChildren:{dependencyType:"child",childGroups:["texts"]},numberChildren:{dependencyType:"child",childGroups:["numbers"]}}),definition:function({dependencyValues:e}){let r;return e.textChildren.length>0?r="text":e.numberChildren.length>0?r="number":r="empty",{setValue:{markerType:r}}}},t.markers={public:!0,isArray:!0,entryPrefixes:["item"],hasVariableComponentType:!0,returnDependencies:()=>({markerType:{dependencyType:"stateVariable",variableName:"markerType"},textChildren:{dependencyType:"child",childGroups:["texts"],variableNames:["value"]},numberChildren:{dependencyType:"child",childGroups:["numbers"],variableNames:["value"]}}),definition:function({dependencyValues:e}){let r=[],n=e.markerType;return e.markerType==="text"?r=e.textChildren.map(i=>i.stateValues.value):e.markerType==="number"?(r=e.numberChildren.map(i=>i.stateValues.value),r.sort((i,s)=>i-s)):n="text",{setValue:{markers:r},setComponentType:{markers:n}}}},t}};T(Sm,"componentType","markers");function ws({variables:a,applyComponentConstraint:t,scales:e}){let r={},n=!1;for(let i in a){let s=t({variables:{[i]:a[i]},scales:e});s.constrained&&(n=!0,r[i]=s.variables[i])}return n?{constrained:n,variables:r}:{}}var Bu=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.baseOnGraph={createPrimitiveOfType:"string",createStateVariable:"baseOnGraph",defaultValue:null},e}static returnChildGroups(){return[{group:"constraints",componentTypes:["_constraint"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({constraintChildren:{dependencyType:"child",childGroups:["constraints"],variableNames:["independentComponentConstraints"]}}),definition:({dependencyValues:e})=>({setValue:{independentComponentConstraints:e.constraintChildren.every(r=>r.stateValues.independentComponentConstraints)}})},t.arrayEntryPrefixForConstraints={returnDependencies:()=>({arrayEntryPrefixForConstraints:{dependencyType:"parentStateVariable",variableName:"arrayEntryPrefixForConstraints"}}),definition:({dependencyValues:e})=>({setValue:{arrayEntryPrefixForConstraints:e.arrayEntryPrefixForConstraints}})},t.arrayVariableForConstraints={returnDependencies:()=>({arrayVariableForConstraints:{dependencyType:"parentStateVariable",variableName:"arrayVariableForConstraints"}}),definition:({dependencyValues:e})=>({setValue:{arrayVariableForConstraints:e.arrayVariableForConstraints}})},t.nDimensions={returnDependencies:()=>({nDimensions:{dependencyType:"parentStateVariable",variableName:"nDimensionsForConstraints"}}),definition({dependencyValues:e}){return{setValue:{nDimensions:e.nDimensions}}}},t.graphComponentName={stateVariablesDeterminingDependencies:["baseOnGraph"],returnDependencies({stateValues:e}){return e.baseOnGraph?{graphComponentName:{dependencyType:"expandTargetName",target:e.baseOnGraph}}:{}},definition({dependencyValues:e}){return e.graphComponentName?{setValue:{graphComponentName:e.graphComponentName}}:{setValue:{graphComponentName:null}}}},t.scales={public:!0,componentType:"number",stateVariablesDeterminingDependencies:["graphComponentName"],returnDependencies({stateValues:e}){return e.graphComponentName?{graph:{dependencyType:"multipleStateVariables",componentName:e.graphComponentName,variableNames:["xscale","yscale"],variablesOptional:!0}}:{}},definition({dependencyValues:e}){if(e.graph){let r=e.graph.stateValues,n=[r.xscale,r.yscale,1];if(n.every(i=>Number.isFinite(i)&&i>0))return{setValue:{scales:n}}}return{setValue:{scales:[1,1,1]}}}},t.graphXmin={additionalStateVariablesDefined:["graphXmax","graphYmin","graphYmax"],stateVariablesDeterminingDependencies:["graphComponentName"],returnDependencies({stateValues:e}){return e.graphComponentName?{graph:{dependencyType:"multipleStateVariables",componentName:e.graphComponentName,variableNames:["xmin","xmax","ymin","ymax"],variablesOptional:!0}}:{}},definition({dependencyValues:e}){if(!e.graph)return{setValue:{graphXmin:null,graphXmax:null,graphYmin:null,graphYmax:null}};let r=e.graph.stateValues.xmin,n=e.graph.stateValues.xmax,i=e.graph.stateValues.ymin,s=e.graph.stateValues.ymax;return[r,n,i,s].every(Number.isFinite)?{setValue:{graphXmin:r,graphXmax:n,graphYmin:i,graphYmax:s}}:{setValue:{graphXmin:null,graphXmax:null,graphYmin:null,graphYmax:null}}}},t.constraintResults={additionalStateVariablesDefined:[{variableName:"constraintUsedByComponent",isArray:!0,entryPrefixes:["constraintUsedByComponent"]}],isArray:!0,entryPrefixes:["constraintResult"],stateVariablesDeterminingDependencies:["independentComponentConstraints","arrayEntryPrefixForConstraints","arrayVariableForConstraints"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={constraintChildren:{dependencyType:"child",childGroups:["constraints"],variableNames:["applyConstraint","applyComponentConstraint"],variablesOptional:!0},independentComponentConstraints:{dependencyType:"stateVariable",variableName:"independentComponentConstraints"},scales:{dependencyType:"stateVariable",variableName:"scales"}},i=r.arrayEntryPrefixForConstraints,s={};if(r.independentComponentConstraints)for(let o of e)s[o]={x:{dependencyType:"parentStateVariable",variableName:i+(Number(o)+1)}};else{let o=r.arrayVariableForConstraints?r.arrayVariableForConstraints:"__null";n.xs={dependencyType:"parentStateVariable",variableName:o}}return{globalDependencies:n,dependenciesByKey:s}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n}){if(e.independentComponentConstraints){let i={},s={};for(let o of n){let l=Number(o)+1,u={["x"+l]:r[o].x},c=!1;for(let p of e.constraintChildren){let m=p.stateValues.applyComponentConstraint({variables:u,scales:e.scales});m.constrained&&(u["x"+l]=se(m.variables["x"+l]),c=!0)}i[o]=u["x"+l],s[o]=c}return{setValue:{constraintResults:i,constraintUsedByComponent:s}}}else{let i={},s=!1;for(let u in e.xs)i[`x${Number(u)+1}`]=e.xs[u];for(let u of e.constraintChildren){let c;if(u.stateValues.applyConstraint?c=u.stateValues.applyConstraint({variables:i,scales:e.scales}):c=ws({variables:i,applyComponentConstraint:u.stateValues.applyComponentConstraint,scales:e.scales}),c.constrained){for(let p in c.variables)i[p]=se(c.variables[p]);s=!0}}let o={},l={};for(let u in e.xs)o[u]=i[`x${Number(u)+1}`],l[u]=s;return{setValue:{constraintResults:o,constraintUsedByComponent:l}}}},inverseArrayDefinitionByKey:async function({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,stateValues:s,workspace:o}){if(r.independentComponentConstraints){let l=[];for(let u in e.constraintResults){let c=Number(u)+1,p={["x"+c]:se(e.constraintResults[u])};for(let m of r.constraintChildren){let f=m.stateValues.applyComponentConstraint({variables:p,scales:r.scales});f.constrained&&(p["x"+c]=se(f.variables["x"+c]))}l.push({setDependency:i[u].x,desiredValue:p["x"+c]})}return{success:!0,instructions:l}}else{let l={};o.desiredConstraintResults||(o.desiredConstraintResults={}),Object.assign(o.desiredConstraintResults,e.constraintResults);let u=await s.constraintResults;for(let p in u){let m=Number(p)+1;p in o.desiredConstraintResults?l["x"+m]=se(o.desiredConstraintResults[p]):l["x"+m]=se(u[p])}for(let p of r.constraintChildren){let m;if(p.stateValues.applyConstraint?m=p.stateValues.applyConstraint({variables:l,scales:r.scales}):m=ws({variables:l,applyComponentConstraint:p.stateValues.applyComponentConstraint,scales:r.scales}),m.constrained)for(let f in m.variables)l[f]=se(m.variables[f])}let c={};for(let p in o.desiredConstraintResults)c[p]=l[`x${Number(p)+1}`];return{success:!0,instructions:[{setDependency:"xs",desiredValue:c}]}}}},t.constraintUsed={public:!0,componentType:"boolean",returnDependencies:()=>({constraintUsedByComponent:{dependencyType:"stateVariable",variableName:"constraintUsedByComponent"}}),definition:function({dependencyValues:e}){return{setValue:{constraintUsed:Object.values(e.constraintUsedByComponent).some(n=>n)}}}},t}};T(Bu,"componentType","constraints"),T(Bu,"rendererType");var dt=class extends J{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({}),definition:()=>({setValue:{independentComponentConstraints:!1}})},t}};T(dt,"componentType","_constraint"),T(dt,"rendererType");var wm=class extends dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.dx={createComponentOfType:"number",createStateVariable:"dx",defaultValue:1,public:!0},e.dy={createComponentOfType:"number",createStateVariable:"dy",defaultValue:1,public:!0},e.dz={createComponentOfType:"number",createStateVariable:"dz",defaultValue:1,public:!0},e.xoffset={createComponentOfType:"number",createStateVariable:"xoffset",defaultValue:0,public:!0},e.yoffset={createComponentOfType:"number",createStateVariable:"yoffset",defaultValue:0,public:!0},e.zoffset={createComponentOfType:"number",createStateVariable:"zoffset",defaultValue:0,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({}),definition:()=>({setValue:{independentComponentConstraints:!0}})},t.applyComponentConstraint={returnDependencies:()=>({dx:{dependencyType:"stateVariable",variableName:"dx"},dy:{dependencyType:"stateVariable",variableName:"dy"},dz:{dependencyType:"stateVariable",variableName:"dz"},xoffset:{dependencyType:"stateVariable",variableName:"xoffset"},yoffset:{dependencyType:"stateVariable",variableName:"yoffset"},zoffset:{dependencyType:"stateVariable",variableName:"zoffset"}}),definition:({dependencyValues:e})=>({setValue:{applyComponentConstraint:function({variables:r,scales:n}){if("x1"in r){let i=lt(r.x1);if(!Number.isFinite(i))return{};let s=e.dx,o=e.xoffset,l=Math.round((i-o)/s)*s+o;return Number.isFinite(l)?{constrained:!0,variables:{x1:l}}:{}}if("x2"in r){let i=lt(r.x2);if(!Number.isFinite(i))return{};let s=e.dy,o=e.yoffset,l=Math.round((i-o)/s)*s+o;return Number.isFinite(l)?{constrained:!0,variables:{x2:l}}:{}}if("x3"in r){let i=lt(r.x3);if(!Number.isFinite(i))return{};let s=e.dz,o=e.zoffset,l=Math.round((i-o)/s)*s+o;return Number.isFinite(l)?{constrained:!0,variables:{x3:l}}:{}}return{}}}})},t}};T(wm,"componentType","constrainToGrid");var Em=class extends dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.buffer={createComponentOfType:"number",createStateVariable:"buffer",defaultValue:.01,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({}),definition:()=>({setValue:{independentComponentConstraints:!0}})},t.applyComponentConstraint={returnDependencies:()=>({constraintAncestor:{dependencyType:"ancestor",componentType:"constraints",variableNames:["graphXmin","graphXmax","graphYmin","graphYmax"]},buffer:{dependencyType:"stateVariable",variableName:"buffer"}}),definition:({dependencyValues:e})=>({setValue:{applyComponentConstraint:function({variables:r,scales:n}){if(e.constraintAncestor===null||e.constraintAncestor.stateValues.graphXmin===null)return{};if("x1"in r){let i=lt(r.x1);if(!Number.isFinite(i))return{};let s=e.constraintAncestor.stateValues.graphXmin,o=e.constraintAncestor.stateValues.graphXmax;if(!(Number.isFinite(s)&&Number.isFinite(o)))return{};let l=s,u=o,c=e.buffer;if(c>0){let m=c*(o-s);l+=m,u-=m}let p=Math.max(l,Math.min(u,i));return{constrained:!0,variables:{x1:p}}}if("x2"in r){let i=lt(r.x2);if(!Number.isFinite(i))return{};let s=e.constraintAncestor.stateValues.graphYmin,o=e.constraintAncestor.stateValues.graphYmax;if(!(Number.isFinite(s)&&Number.isFinite(o)))return{};let l=s,u=o,c=e.buffer;if(c>0){let m=c*(o-s);l+=m,u-=m}let p=Math.max(l,Math.min(u,i));return{constrained:!0,variables:{x2:p}}}return{}}}})},t}};T(Em,"componentType","constrainToGraph");var Rm=class extends dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.dx={createComponentOfType:"number",createStateVariable:"dx",defaultValue:1,public:!0},e.dy={createComponentOfType:"number",createStateVariable:"dy",defaultValue:1,public:!0},e.dz={createComponentOfType:"number",createStateVariable:"dz",defaultValue:1,public:!0},e.xoffset={createComponentOfType:"number",createStateVariable:"xoffset",defaultValue:0,public:!0},e.yoffset={createComponentOfType:"number",createStateVariable:"yoffset",defaultValue:0,public:!0},e.zoffset={createComponentOfType:"number",createStateVariable:"zoffset",defaultValue:0,public:!0},e.xthreshold={createComponentOfType:"number",createStateVariable:"xthreshold",defaultValue:.2,public:!0},e.ythreshold={createComponentOfType:"number",createStateVariable:"ythreshold",defaultValue:.2,public:!0},e.zthreshold={createComponentOfType:"number",createStateVariable:"zthreshold",defaultValue:.2,public:!0},e.includeGridlines={createComponentOfType:"boolean",createStateVariable:"includeGridlines",defaultValue:!1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({includeGridlines:{dependencyType:"stateVariable",variableName:"includeGridlines"}}),definition:({dependencyValues:e})=>({setValue:{independentComponentConstraints:e.includeGridlines}})},t.applyComponentConstraint={returnDependencies:()=>({dx:{dependencyType:"stateVariable",variableName:"dx"},dy:{dependencyType:"stateVariable",variableName:"dy"},dz:{dependencyType:"stateVariable",variableName:"dz"},xoffset:{dependencyType:"stateVariable",variableName:"xoffset"},yoffset:{dependencyType:"stateVariable",variableName:"yoffset"},zoffset:{dependencyType:"stateVariable",variableName:"zoffset"},xthreshold:{dependencyType:"stateVariable",variableName:"xthreshold"},ythreshold:{dependencyType:"stateVariable",variableName:"ythreshold"},zthreshold:{dependencyType:"stateVariable",variableName:"zthreshold"}}),definition:({dependencyValues:e})=>({setValue:{applyComponentConstraint:function({variables:r,scales:n}){if("x1"in r){let i=lt(r.x1);if(!Number.isFinite(i))return{};let s=e.dx,o=e.xoffset,l=Math.round((i-o)/s)*s+o;return Number.isFinite(l)&&Math.abs(i-l)<e.xthreshold?{constrained:!0,variables:{x1:l}}:{}}if("x2"in r){let i=lt(r.x2);if(!Number.isFinite(i))return{};let s=e.dy,o=e.yoffset,l=Math.round((i-o)/s)*s+o;return Number.isFinite(l)&&Math.abs(i-l)<e.ythreshold?{constrained:!0,variables:{x2:l}}:{}}if("x3"in r){let i=lt(r.x3);if(!Number.isFinite(i))return{};let s=e.dz,o=e.zoffset,l=Math.round((i-o)/s)*s+o;return Number.isFinite(l)&&Math.abs(i-l)<e.zthreshold?{constrained:!0,variables:{x3:l}}:{}}return{}}}})},t.applyConstraint={returnDependencies:()=>({dx:{dependencyType:"stateVariable",variableName:"dx"},dy:{dependencyType:"stateVariable",variableName:"dy"},dz:{dependencyType:"stateVariable",variableName:"dz"},xoffset:{dependencyType:"stateVariable",variableName:"xoffset"},yoffset:{dependencyType:"stateVariable",variableName:"yoffset"},zoffset:{dependencyType:"stateVariable",variableName:"zoffset"},xthreshold:{dependencyType:"stateVariable",variableName:"xthreshold"},ythreshold:{dependencyType:"stateVariable",variableName:"ythreshold"},zthreshold:{dependencyType:"stateVariable",variableName:"zthreshold"},includeGridlines:{dependencyType:"stateVariable",variableName:"includeGridlines"},applyComponentConstraint:{dependencyType:"stateVariable",variableName:"applyComponentConstraint"}}),definition:({dependencyValues:e})=>({setValue:{applyConstraint:function({variables:r,scales:n}){let i={},s=!1;for(let o in r){let l=e.applyComponentConstraint({variables:{[o]:r[o]},scales:n});l.constrained&&(s=!0,i[o]=l.variables[o])}if(!s)return{};if(!e.includeGridlines){if(r.x1!==void 0&&i.x1===void 0)return{};if(r.x2!==void 0&&i.x2===void 0)return{};if(r.x3!==void 0&&i.x3===void 0)return{}}return{constrained:s,variables:i}}}})},t}};T(Rm,"componentType","attractToGrid");var xm=class extends dt{static returnChildGroups(){return[{group:"graphical",componentTypes:["_graphical"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nearestPointFunctions={returnDependencies:()=>({graphicalChildren:{dependencyType:"child",childGroups:["graphical"],variableNames:["nearestPoint"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r=[];for(let n of e.graphicalChildren){if(!n.stateValues.nearestPoint){console.warn(`cannot attract to ${n.componentName} as it doesn't have a nearestPoint state variable`);continue}r.push(n.stateValues.nearestPoint)}return{setValue:{nearestPointFunctions:r}}}},t.applyConstraint={returnDependencies:()=>({nearestPointFunctions:{dependencyType:"stateVariable",variableName:"nearestPointFunctions"}}),definition:({dependencyValues:e})=>({setValue:{applyConstraint:function({variables:r,scales:n}){let i=1/0,s={},o=!1,l={};for(let u in r)l[u]=lt(r[u]);for(let u of e.nearestPointFunctions){let c=u({variables:r,scales:n});if(c===void 0)continue;let p={},m=0;if(l.x1!==void 0){if(c.x1===void 0)continue;p.x1=c.x1,m+=Math.pow(l.x1-c.x1,2)}if(l.x2!==void 0){if(c.x2===void 0)continue;p.x2=c.x2,m+=Math.pow(l.x2-c.x2,2)}if(l.x3!==void 0){if(c.x3===void 0)continue;p.x3=c.x3,m+=Math.pow(l.x3-c.x3,2)}m<i&&(s=p,i=m,o=!0)}return o?{constrained:o,variables:s}:{}}}})},t}};T(xm,"componentType","constrainTo");var Vm=class extends dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.threshold={createComponentOfType:"number"},e}static returnChildGroups(){return[{group:"graphical",componentTypes:["_graphical"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.threshold={public:!0,componentType:"number",hasEssential:!0,returnDependencies:()=>({thresholdAttr:{dependencyType:"attributeComponent",attributeName:"threshold",variableNames:["value"]},constraintsAncestor:{dependencyType:"ancestor",componentType:"constraints",variableNames:["graphXmin"]}}),definition({dependencyValues:e}){if(e.thresholdAttr)return{setValue:{threshold:e.thresholdAttr.stateValues.value}};{let r=.02;return(e.constraintsAncestor===null||e.constraintsAncestor.stateValues.graphXmin===null)&&(r=.5),{useEssentialOrDefaultValue:{threshold:{defaultValue:r}}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.thresholdAttr?{success:!0,instructions:[{setDependency:"thresholdAttr",desiredValue:e.threshold}]}:{success:!0,instructions:[{setEssentialValue:"threshold",value:e.threshold}]}}},t.nearestPointFunctions={returnDependencies:()=>({graphicalChildren:{dependencyType:"child",childGroups:["graphical"],variableNames:["nearestPoint"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r=[];for(let n of e.graphicalChildren){if(!n.stateValues.nearestPoint){console.warn(`cannot attract to ${n.componentName} as it doesn't have a nearestPoint state variable`);continue}r.push(n.stateValues.nearestPoint)}return{setValue:{nearestPointFunctions:r}}}},t.graphXscale={additionalStateVariablesDefined:["graphYscale"],returnDependencies:()=>({graphAncestor:{dependencyType:"ancestor",componentType:"constraints",variableNames:["scales"]}}),definition({dependencyValues:e}){if(!e.graphAncestor)return{setValue:{graphXscale:null,graphYscale:null}};let r=e.graphAncestor.stateValues.xscale,n=e.graphAncestor.stateValues.yscale;return{setValue:{graphXscale:r,graphYscale:n}}}},t.applyConstraint={returnDependencies(){return{nearestPointFunctions:{dependencyType:"stateVariable",variableName:"nearestPointFunctions"},threshold:{dependencyType:"stateVariable",variableName:"threshold"},constraintsAncestor:{dependencyType:"ancestor",componentType:"constraints",variableNames:["scales"]}}},definition({dependencyValues:e}){let r=1,n=1;return e.constraintsAncestor&&([r,n]=e.constraintsAncestor.stateValues.scales),{setValue:{applyConstraint:function({variables:i,scales:s}){let o=1/0,l={},u={};for(let c in i)u[c]=lt(i[c]);for(let c of e.nearestPointFunctions){let p=c({variables:i,scales:s});if(p===void 0)continue;let m={},f=0;if(u.x1!==void 0){if(p.x1===void 0)continue;m.x1=p.x1,f+=Math.pow((u.x1-p.x1)/r,2)}if(u.x2!==void 0){if(p.x2===void 0)continue;m.x2=p.x2,f+=Math.pow((u.x2-p.x2)/n,2)}if(u.x3!==void 0){if(p.x3===void 0)continue;m.x3=p.x3,f+=Math.pow(u.x3-p.x3,2)}f<o&&(l=m,o=f)}return o>e.threshold*e.threshold?{}:{constrained:!0,variables:l}}}}}},t}};T(Vm,"componentType","attractTo");var Om=class extends dt{static returnChildGroups(){return[{group:"constraints",componentTypes:["_constraint"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.applyConstraint={returnDependencies:()=>({constraintChildren:{dependencyType:"child",childGroups:["constraints"],variableNames:["applyConstraint","applyComponentConstraint"],variablesOptional:!0}}),definition:({dependencyValues:e})=>({setValue:{applyConstraint:function({variables:r,scales:n}){let i;if(e.constraintChildren.length===1){let u=e.constraintChildren[0];return u.stateValues.applyConstraint?i=u.stateValues.applyConstraint({variables:r,scales:n}):i=ws({variables:r,applyComponentConstraint:u.stateValues.applyComponentConstraint,scales:n}),i}let s=1/0,o={},l;for(let[u,c]of e.constraintChildren.entries()){if(c.stateValues.applyConstraint?i=c.stateValues.applyConstraint({variables:r,scales:n}):i=ws({variables:r,applyComponentConstraint:c.stateValues.applyComponentConstraint,scales:n}),!i.constrained)continue;let p=0;for(let m in i.variables){let f=lt(r[m]),d=lt(i.variables[m]);if(!Number.isFinite(f)||!Number.isFinite(d)){p=1/0;break}p+=Math.pow(f-d,2)}p<s&&(o=i,l=u+1,s=p)}return l===void 0?{}:(o.constraintIndices===void 0?o.constraintIndices=[l]:o.constraintIndices=[l,...o.constraintIndices],o)}}})},t}};T(Om,"componentType","constraintUnion");var Dm=class extends dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.threshold={createComponentOfType:"number",createStateVariable:"threshold",defaultValue:.5,public:!0},e}static returnChildGroups(){return[{group:"constraints",componentTypes:["_constraint"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.applyConstraint={returnDependencies:()=>({constraintChild:{dependencyType:"child",childGroups:["constraints"],variableNames:["applyConstraint","applyComponentConstraint"],variablesOptional:!0},independentComponentConstraints:{dependencyType:"stateVariable",variableName:"independentComponentConstraints"},threshold:{dependencyType:"stateVariable",variableName:"threshold"}}),definition:({dependencyValues:e})=>({setValue:{applyConstraint:function({variables:r,scales:n}){let i,s=e.constraintChild[0];if(!s)return{};s.stateValues.applyConstraint?i=s.stateValues.applyConstraint({variables:r,scales:n}):i=ws({variables:r,applyComponentConstraint:s.stateValues.applyComponentConstraint,scales:n});let o=0;for(let l in i.variables){let u=lt(r[l]),c=lt(i.variables[l]);if(!Number.isFinite(u)||!Number.isFinite(c))return{};o+=Math.pow(u-c,2)}return o>e.threshold*e.threshold?{}:i}}})},t}};T(Dm,"componentType","attractToConstraint");import Lq from"math-expressions";var Io=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e}static returnChildGroups(){return[{group:"lines",componentTypes:["line"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.lineChildren={returnDependencies:()=>({lineChildren:{dependencyType:"child",childGroups:["lines"],variableNames:["numericalCoeff0","numericalCoeffvar1","numericalCoeffvar2","nDimensions"]}}),definition:({dependencyValues:e})=>({setValue:{lineChildren:e.lineChildren}})},t.readyToExpandWhenResolved={returnDependencies:()=>({lineChildren:{dependencyType:"stateVariable",variableName:"lineChildren"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,components:e,componentInfoObjects:r}){let n=await t.stateValues.lineChildren,i=n.length;if(i===0)return{replacements:[]};if(i===1){let C=n[0].componentName,S=await e[C].serialize();S.state||(S.state={}),S.state.draggable=!1,S.state.fixed=!0;let w=_r({serializedComponents:[S],componentName:t.componentName}),x=t.attributes.newNamespace?.primitive;return w=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:w,parentName:t.componentName,parentCreatesNewNamespace:x,componentInfoObjects:r}).serializedComponents,{replacements:w}}if(i>2)return console.warn("Haven't implemented intersection for more than two objects"),{replacements:[]};let s=n[0],o=n[1];if(s.stateValues.nDimensions!==2||o.stateValues.nDimensions!==2)return console.log("Intersection of lines implemented only in 2D"),{replacements:[]};let l=s.stateValues.numericalCoeffvar1,u=s.stateValues.numericalCoeffvar2,c=s.stateValues.numericalCoeff0,p=o.stateValues.numericalCoeffvar1,m=o.stateValues.numericalCoeffvar2,f=o.stateValues.numericalCoeff0;if(!(Number.isFinite(l)&&Number.isFinite(u)&&Number.isFinite(c)&&Number.isFinite(p)&&Number.isFinite(m)&&Number.isFinite(f)))return console.log("Intersection of lines implemented only for constant coefficients"),{replacements:[]};let d=l*m-p*u;if(Math.abs(d)<1e-14){if(Math.abs(f*l-c*p)>1e-14)return{replacements:[]};if(l===0&&u===0&&c===0||p===0&&m===0&&f===0)return{replacements:[]};{let C=n[0].componentName,S=await e[C].serialize();S.state||(S.state={}),S.state.draggable=!1,S.state.fixed=!0;let w=_r({serializedComponents:[S],componentName:t.componentName}),x=t.attributes.newNamespace?.primitive;return w=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:w,parentName:t.componentName,parentCreatesNewNamespace:x,componentInfoObjects:r}).serializedComponents,{replacements:w}}}let h=(f*u-c*m)/d,y=(c*p-f*l)/d,b=Lq.fromAst(["vector",h,y]),g=[{componentType:"point",state:{coords:b,draggable:!1,fixed:!0}}],v=t.attributes.newNamespace?.primitive;return g=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:g,parentName:t.componentName,parentCreatesNewNamespace:v,componentInfoObjects:r}).serializedComponents,{replacements:g}}static async calculateReplacementChanges({component:t,components:e,componentInfoObjects:r}){let n=[],i=(await this.createSerializedReplacements({component:t,components:e,componentInfoObjects:r})).replacements,s=i.length,o=!0;if(s===t.replacements.length){o=!1;for(let u=0;u<s;u++){if(i[u].componentType!==t.replacements[u].componentType){o=!0;break}if(i[u].state===void 0){console.warn("No state by which to update intersection component, so recreating"),o=!0;break}if(i[u].componentType!=="point"){console.warn(`Have not implemented state changes for an intersection that results in a  ${i[u].componentType}, so recreating`),o=!0;break}let c={changeType:"updateStateVariables",component:t.replacements[u],stateChanges:{coords:i[u].state.coords}};n.push(c)}}return o===!1?n:[{changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:i}]}};T(Io,"componentType","intersection"),T(Io,"assignNamesToReplacements",!0),T(Io,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");var Po=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.columns={createComponentOfType:"text",createStateVariable:"columns",defaultValue:null,public:!0},e}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.breakpoints={returnDependencies:()=>({children:{dependencyType:"child",childGroups:["anything"],variableNames:["width"]},columns:{dependencyType:"stateVariable",variableName:"columns"}}),definition:function({dependencyValues:e}){let r=[],n=e.children.map(i=>i.stateValues.width);if(e.columns!==null){let i;if(e.columns.indexOf(",")!==-1)i=e.columns.split(",").map(Number);else if(e.columns.indexOf("-")!==-1){let[u,c]=e.columns.split("-");i=[];for(let p=Number(u);p<=c;p++)i.push(p)}else i=[Number(e.columns)];let s={},o={};for(let u of i){let c=[],p=0;for(let m=0;m<u;m++){let f=-1;for(let d=m;d<n.length;d=d+u)n[d]>f&&(f=n[d]);c.push(f),p=p+Number(f)}s[u]=c,o[u]=p}let l=-1;for(let u of i){let c=Number.POSITIVE_INFINITY,p=-1;for(let m of i)o[m]<=c&&m>l&&(c=o[m],p=m);c<Number.POSITIVE_INFINITY&&(r.push({breakpoint:c,possibleColumnNumbers:p,arrayOfWidths:s[p]}),l=p)}}return{setValue:{breakpoints:r}}}},t}};T(Po,"componentType","panel"),T(Po,"rendererType","container"),T(Po,"renderChildren",!0);var Im=class extends dt{static returnChildLogic(t){let e=super.returnChildLogic(t),r=function({activeChildrenMatched:p}){let m=[];for(let f of p)m.push({createdComponent:!0,componentName:f.componentName});return{success:!0,newChildren:[{componentType:"angles",children:m}]}},n=e.newLeaf({name:"AtLeastOneAngle",componentType:"angle",comparison:"atLeast",number:1,isSugar:!0,replacementFunction:r}),i=e.newLeaf({name:"AtLeastOneString",componentType:"string",comparison:"atLeast",number:1}),s=e.newLeaf({name:"AtLeastOneMath",componentType:"math",comparison:"atLeast",number:1}),o=e.newOperator({name:"StringsAndMaths",operator:"or",propositions:[i,s],requireConsecutive:!0,isSugar:!0,replacementFunction:r}),l=e.newLeaf({name:"AtMostOneAngles",componentType:"angles",comparison:"atMost",number:1}),u=e.newOperator({name:"Angles",operator:"xor",propositions:[n,o,l],setAsBase:!0}),c=e.newLeaf({name:"AtMostOnePoint",componentType:"point",comparison:"atMost",number:1});return e.newOperator({name:"AnglesAndPoint",operator:"and",propositions:[u,c],setAsBase:!0}),e}updateState(t={}){if(super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.angles=!0,this.unresolvedState.offset=!0;return}let e=this.currentTracker.trackChanges,r=e.childrenChanged(this.componentName);if(r){let n=this.childLogic.returnMatches("AtMostOneAngles");n.length===1?this.state.anglesChild=this.activeChildren[n[0]]:(delete this.state.anglesChild,this.state.angles=[],delete this.unresolvedState.angles);let i=this.childLogic.returnMatches("AtMostOnePoint");i.length===1?this.state.pointChild=this.activeChildren[i[0]]:(delete this.state.pointChild,this.state.offset=[0,0,0],delete this.unresolvedState.offset)}if(this.state.anglesChild){if(this.state.anglesChild.unresolvedState.angles){this.unresolvedState.angles=!0;return}(r||e.getVariableChanges({component:this.state.anglesChild,variable:"angles"}))&&(delete this.unresolvedState.angles,this.state.angles=this.state.anglesChild.state.angles)}if(this.state.pointChild){if(this.state.pointChild.unresolvedState.xs){this.unresolvedState.offset=!0;return}if(r||e.getVariableChanges({component:this.state.pointChild,variable:"xs"})){delete this.unresolvedState.offset,this.state.offset=[];for(let n=0;n<this.state.pointChild.state.ndimensions;n++){let i=this.state.pointChild.state.xs[n].evaluate_to_constant();if(!Number.isFinite(i)){this.state.offset=NaN;break}this.state.offset.push(i)}}}}applyTheConstraint({x1:t,x2:e,x3:r,offset:n}){if(this.unresolvedState.angles||this.unresolvedState.offset)return{};if(t===void 0||e===void 0||r!==void 0)return{};if(t=this.findFiniteNumericalValue(t),e=this.findFiniteNumericalValue(e),!Number.isFinite(t)||!Number.isFinite(e))return{};if(n===void 0&&(n=this.state.offset),Number.isNaN(n))return{};let i=t-n[0],s=e-n[1],o=Math.atan2(s,i),l=1/0,u,c;for(let[h,y]of this.state.angles.entries()){let b=y.state.angle.evaluate_to_constant();if(!Number.isFinite(b))continue;let g=Math.abs((b-o+Math.PI)%(2*Math.PI)-Math.PI);g<l&&(u=b,c=h,l=g)}if(u===void 0)return{};let p=Math.sqrt(i*i+s*s),m=n[0]+p*Math.cos(u),f=n[1]+p*Math.sin(u);return{variables:{x1:m,x2:f},constraintIndices:[c+1],constrained:!0}}};T(Im,"componentType","constrainToAngles");var Pm=class extends dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.threshold={createComponentOfType:"number",createStateVariable:"threshold",defaultValue:.3,public:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t),r=function({activeChildrenMatched:p}){let m=[];for(let f of p)m.push({createdComponent:!0,componentName:f.componentName});return{success:!0,newChildren:[{componentType:"angles",children:m}]}},n=e.newLeaf({name:"AtLeastOneAngle",componentType:"angle",comparison:"atLeast",number:1,isSugar:!0,replacementFunction:r}),i=e.newLeaf({name:"AtLeastOneString",componentType:"string",comparison:"atLeast",number:1}),s=e.newLeaf({name:"AtLeastOneMath",componentType:"math",comparison:"atLeast",number:1}),o=e.newOperator({name:"StringsAndMaths",operator:"or",propositions:[i,s],requireConsecutive:!0,isSugar:!0,replacementFunction:r}),l=e.newLeaf({name:"AtMostOneAngles",componentType:"angles",comparison:"atMost",number:1}),u=e.newOperator({name:"Angles",operator:"xor",propositions:[n,o,l],setAsBase:!0}),c=e.newLeaf({name:"AtMostOnePoint",componentType:"point",comparison:"atMost",number:1});return e.newOperator({name:"AnglesAndPoint",operator:"and",propositions:[u,c],setAsBase:!0}),e}updateState(t={}){if(super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.angles=!0,this.unresolvedState.offset=!0;return}let e=this.currentTracker.trackChanges,r=e.childrenChanged(this.componentName);if(r){let n=this.childLogic.returnMatches("AtMostOneAngles");n.length===1?this.state.anglesChild=this.activeChildren[n[0]]:(delete this.state.anglesChild,this.state.angles=[],delete this.unresolvedState.angles);let i=this.childLogic.returnMatches("AtMostOnePoint");i.length===1?this.state.pointChild=this.activeChildren[i[0]]:(delete this.state.pointChild,this.state.offset=[0,0,0],delete this.unresolvedState.offset)}if(this.state.anglesChild){if(this.state.anglesChild.unresolvedState.angles){this.unresolvedState.angles=!0;return}(r||e.getVariableChanges({component:this.state.anglesChild,variable:"angles"}))&&(delete this.unresolvedState.angles,this.state.angles=this.state.anglesChild.state.angles)}if(this.state.pointChild){if(this.state.pointChild.unresolvedState.xs){this.unresolvedState.offset=!0;return}if(r||e.getVariableChanges({component:this.state.pointChild,variable:"xs"})){delete this.unresolvedState.offset,this.state.offset=[];for(let n=0;n<this.state.pointChild.state.ndimensions;n++){let i=this.state.pointChild.state.xs[n].evaluate_to_constant();if(!Number.isFinite(i)){this.state.offset=NaN;break}this.state.offset.push(i)}}}}applyTheConstraint({x1:t,x2:e,x3:r,offset:n}){if(this.unresolvedState.angles||this.unresolvedState.offset)return{};if(t===void 0||e===void 0||r!==void 0)return{};if(t=this.findFiniteNumericalValue(t),e=this.findFiniteNumericalValue(e),!Number.isFinite(t)||!Number.isFinite(e))return{};if(n===void 0&&(n=this.state.offset),Number.isNaN(n))return{};let i=t-n[0],s=e-n[1],o=Math.atan2(s,i),l=1/0,u,c;for(let[y,b]of this.state.angles.entries()){let g=b.state.angle.evaluate_to_constant();if(!Number.isFinite(g))continue;let v=Math.abs((g-o+Math.PI)%(2*Math.PI)-Math.PI);v<l&&(u=g,c=y,l=v)}if(u===void 0)return{};let p=Math.sqrt(i*i+s*s),m=n[0]+p*Math.cos(u),f=n[1]+p*Math.sin(u);return Math.sqrt(Math.pow(m-t,2)+Math.pow(f-e,2))>=this.state.threshold?{}:{variables:{x1:m,x2:f},constraintIndices:[c+1],constrained:!0}}};T(Pm,"componentType","attractToAngles");var Ka=class extends Ae{static keepChildrenSerialized({serializedComponent:t}){if(t.children===void 0)return[];let e=[];for(let[r,n]of t.children.entries())["case","else"].includes(n.componentType)||n.attributes&&n.attributes.componentType&&["case","else"].includes(n.attributes.componentType.primitive)||e.push(r);return e}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.maximumNumberToShow={createComponentOfType:"number",createStateVariable:"maximumNumberToShow",defaultValue:null,public:!0},e.condition={createComponentOfType:"boolean"},e}static returnChildGroups(){return[{group:"cases",componentTypes:["case"]},{group:"elses",componentTypes:["else"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.baseConditionSatisfied={returnDependencies:()=>({conditionAttr:{dependencyType:"attributeComponent",attributeName:"condition",variableNames:["value"]}}),definition:function({dependencyValues:e}){let r=!0;return e.conditionAttr&&(r=e.conditionAttr.stateValues.value),{setValue:{baseConditionSatisfied:r}}}},t.nCases={additionalStateVariablesDefined:["caseChildren"],returnDependencies:()=>({caseChildren:{dependencyType:"child",childGroups:["cases"]}}),definition({dependencyValues:e}){return{setValue:{caseChildren:e.caseChildren,nCases:e.caseChildren.length}}}},t.elseChild={returnDependencies:()=>({elseChild:{dependencyType:"child",childGroups:["elses"]}}),definition({dependencyValues:e}){let r=null;return e.elseChild.length>0&&(r=e.elseChild[0]),{setValue:{elseChild:r}}}},t.haveCasesOrElse={returnDependencies:()=>({nCases:{dependencyType:"stateVariable",variableName:"nCases"},elseChild:{dependencyType:"stateVariable",variableName:"elseChild"}}),definition:({dependencyValues:e})=>({setValue:{haveCasesOrElse:e.nCases>0||e.elseChild!==null}})},t.selectedIndices={returnDependencies:()=>({caseChildren:{dependencyType:"child",childGroups:["cases"],variableNames:["conditionSatisfied"]},elseChild:{dependencyType:"stateVariable",variableName:"elseChild"},maximumNumberToShow:{dependencyType:"stateVariable",variableName:"maximumNumberToShow"}}),definition({dependencyValues:e}){let r=[];for(let[n,i]of e.caseChildren.entries())i.stateValues.conditionSatisfied&&r.push(n);if(r.length===0&&e.elseChild&&r.push(e.caseChildren.length),e.maximumNumberToShow!==null&&r.length>e.maximumNumberToShow){let n=Math.max(0,Math.floor(e.maximumNumberToShow));r=r.slice(0,n)}return{setValue:{selectedIndices:r}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({baseConditionSatisfied:{dependencyType:"stateVariable",variableName:"baseConditionSatisfied"},haveCasesOrElse:{dependencyType:"stateVariable",variableName:"haveCasesOrElse"},selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),markStale:()=>({updateReplacements:!0}),definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={returnDependencies:({sharedParameters:e,componentInfoObjects:r})=>({variantSeed:{dependencyType:"value",value:e.variantSeed},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(r.componentTypesCreatingVariants),variableNames:["isVariantComponent","generatedVariantInfo"],useReplacementsForComposites:!0,recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfEncounteredComposites:!0}}),definition({dependencyValues:e,componentName:r}){let n={seed:e.variantSeed,meta:{createdBy:r}},i=n.subvariants=[];for(let s of e.variantDescendants)s.stateValues.isVariantComponent?i.push(s.stateValues.generatedVariantInfo):s.stateValues.generatedVariantInfo&&i.push(...s.stateValues.generatedVariantInfo.subvariants);return{setValue:{generatedVariantInfo:n}}}},t}static async createSerializedReplacements({component:t,components:e,workspace:r,componentInfoObjects:n}){let i=await this.getReplacements(t,e,n);return r.previousSelectedIndices=[...await t.stateValues.selectedIndices],r.previousBaseConditionSatisfied=await t.stateValues.baseConditionSatisfied,{replacements:i}}static async getReplacements(t,e,r){if(!await t.stateValues.baseConditionSatisfied)return[];let n=[];if(!await t.stateValues.haveCasesOrElse)n=Re(t.serializedChildren);else{let o=await t.stateValues.caseChildren;for(let[l,u]of(await t.stateValues.selectedIndices).entries()){let c,p,m;u<await t.stateValues.nCases?(c=o[u].componentName,m=Va("case",`${t.componentName}|replacement|${u}`),p="case"):(c=(await t.stateValues.elseChild).componentName,m=Va("else",`${t.componentName}|replacement|${u}`),p="else");let f=c.lastIndexOf("/");m=c.substring(0,f)+"/"+m;let h=Re(await e[c].state.serializedChildren.value),y={componentType:p,state:{rendered:!0},doenetAttributes:Object.assign({},e[c].doenetAttributes),children:h,originalName:m,variants:{desiredVariant:{seed:t.sharedParameters.variantSeed+l.toString()+"|"+u.toString()}}};e[c].attributes.newNamespace&&(y.attributes={newNamespace:{primitive:!0}}),n.push(y)}}let i=t.attributes.newNamespace&&t.attributes.newNamespace.primitive;return de({assignNames:t.doenetAttributes.assignNames,serializedComponents:n,parentName:t.componentName,parentCreatesNewNamespace:i,componentInfoObjects:r,originalNamesAreConsistent:i||!t.doenetAttributes.assignNames}).serializedComponents}static async calculateReplacementChanges({component:t,componentChanges:e,components:r,workspace:n,componentInfoObjects:i}){let s=await t.stateValues.selectedIndices,o=await t.stateValues.baseConditionSatisfied;if(n.previousSelectedIndices.length===s.length&&n.previousSelectedIndices.every((p,m)=>p===s[m])){if(n.previousBaseConditionSatisfied===o)return[];if(o){if(t.replacements.length===t.serializedChildren.length){let p={changeType:"changeReplacementsToWithhold",replacementsToWithhold:0};return n.previousBaseConditionSatisfied=o,[p]}}else{let p=t.replacements.length,m={changeType:"changeReplacementsToWithhold",replacementsToWithhold:p};return n.previousBaseConditionSatisfied=o,[m]}}let l=[],u=await this.getReplacements(t,r,i),c={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:u,replacementsToWithhold:0};return l.push(c),n.previousSelectedIndices=[...s],n.previousBaseConditionSatisfied=o,l}static async setUpVariant({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r}){kr({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r})}get allPotentialRendererTypes(){let t=super.allPotentialRendererTypes;if(this.serializedChildren){let e=this.potentialRendererTypesFromSerializedComponents(this.serializedChildren);for(let r of e)t.includes(r)||t.push(r)}return t}};T(Ka,"componentType","conditionalContent"),T(Ka,"includeBlankStringChildren",!0),T(Ka,"assignNamesToReplacements",!0),T(Ka,"originalNamesAreConsistent",!0),T(Ka,"createsVariants",!0),T(Ka,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");var Lu=class extends re{static returnChildGroups(){return[{group:"inline",componentTypes:["_inline"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.text={public:!0,componentType:"text",returnDependencies:()=>({inlineChildren:{dependencyType:"child",childGroups:["inline"],variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r=[];for(let i of e.inlineChildren)typeof i!="object"?r.push(i.toString()):typeof i.stateValues.text=="string"?r.push(i.stateValues.text):r.push("");return{setValue:{text:r.join(", ")}}}},t}};T(Lu,"componentType","asList"),T(Lu,"renderChildren",!0);function Te(a){if(a!==null&&a!==""){if(Number.isFinite(Number(a)))return Number(a)-1;if(typeof a=="string")return Uq(a)}}function Uq(a){a=a.toUpperCase();let t=0,e=a.length,r=e;for(;(r-=1)>-1;){let n=a.charCodeAt(r)-64;if(n<1||n>26){console.warn("Cannot convert "+a+" to a number");return}t+=n*Math.pow(26,e-1-r)}return t--,t}import fTe from"math-expressions";var YK=he(),ZK=De(),JK=Yr(),eD=Hm(),QK=lN(),eX=ZK(function(){eD(1)});YK({target:"Object",stat:!0,forced:eX,sham:!QK},{getPrototypeOf:function(t){return eD(JK(t))}});var fX=he(),dX=De(),hX=fy().f,yX=dX(function(){return!Object.getOwnPropertyNames(1)});fX({target:"Object",stat:!0,forced:yX},{getOwnPropertyNames:hX});"use strict";var BX=he(),dD=Ne(),LX=Vi().f,UX=Mo(),hD=Rr(),zX=by(),GX=Gn(),HX=gy(),qX=Es(),yD=dD("".startsWith),WX=dD("".slice),$X=Math.min,bD=HX("startsWith"),KX=!qX&&!bD&&!!function(){var a=LX(String.prototype,"startsWith");return a&&!a.writable}();BX({target:"String",proto:!0,forced:!KX&&!bD},{startsWith:function(t){var e=hD(GX(this));zX(t);var r=UX($X(arguments.length>1?arguments[1]:void 0,e.length)),n=hD(t);return yD?yD(e,n,r):WX(e,r,r+n.length)===n}});var ZX=dy(),JX=qn(),QX=vD();ZX||JX(Object.prototype,"toString",QX,{unsafe:!0});var MY=he(),BY=Ri(),bN=Wm(),LY=VD(),$D=mN(),UY=Wt(),KD=zt(),zY=Vs(),XD=De(),gN=BY("Reflect","construct"),GY=Object.prototype,HY=[].push,YD=XD(function(){function a(){}return!(gN(function(){},[],a)instanceof a)}),ZD=!XD(function(){gN(function(){})}),JD=YD||ZD;MY({target:"Reflect",stat:!0,forced:JD,sham:JD},{construct:function(t,e){$D(t),UY(e);var r=arguments.length<3?t:$D(arguments[2]);if(ZD&&!YD)return gN(t,e,r);if(t==r){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return bN(HY,n,e),new(bN(LY,t,n))}var i=r.prototype,s=zY(KD(i)?i:GY),o=bN(t,s,e);return KD(o)?o:s}});"use strict";var YY=he(),ZY=pe(),t7=Ju(),JY=Km(),QY=zt(),r7=jo(),eZ=Wn(),tZ=Hn(),rZ=Yu(),nZ=ct(),aZ=Qu(),iZ=vy(),sZ=aZ("slice"),oZ=nZ("species"),vN=ZY.Array,lZ=Math.max;YY({target:"Array",proto:!0,forced:!sZ},{slice:function(t,e){var r=tZ(this),n=eZ(r),i=r7(t,n),s=r7(e===void 0?n:e,n),o,l,u;if(t7(r)&&(o=r.constructor,JY(o)&&(o===vN||t7(o.prototype))?o=void 0:QY(o)&&(o=o[oZ],o===null&&(o=void 0)),o===vN||o===void 0))return iZ(r,i,s);for(l=new(o===void 0?vN:o)(lZ(s-i,0)),u=0;i<s;i++,u++)i in r&&rZ(l,u,r[i]);return l.length=u,l}});var uZ=sr(),cZ=Xu().EXISTS,n7=Ne(),pZ=Er().f,a7=Function.prototype,mZ=n7(a7.toString),i7=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,fZ=n7(i7.exec),dZ="name";uZ&&!cZ&&pZ(a7,dZ,{configurable:!0,get:function(){try{return fZ(i7,mZ(this))[1]}catch(a){return""}}});var KZ=he(),XZ=T7(),YZ=SN(),ZZ=!YZ(function(a){Array.from(a)});KZ({target:"Array",stat:!0,forced:ZZ},{from:XZ});"use strict";var _J=Ay().charAt,kJ=Rr(),X7=Xa(),FJ=Ey(),Y7="String Iterator",jJ=X7.set,MJ=X7.getterFor(Y7);FJ(String,"String",function(a){jJ(this,{type:Y7,string:kJ(a),index:0})},function(){var t=MJ(this),e=t.string,r=t.index,n;return r>=e.length?{value:void 0,done:!0}:(n=_J(e,r),t.index+=n.length,{value:n,done:!1})});var Fvt=M(ie());"use strict";var rc=he(),GN=pe(),EQ=Ri(),RQ=Wm(),ef=Br(),xQ=Ne(),VQ=Es(),nc=sr(),Lo=ry(),HN=De(),$t=or(),OQ=Ju(),DQ=It(),IQ=zt(),PQ=xi(),qN=km(),WN=Wt(),_Q=Yr(),Iy=Hn(),$N=Bm(),yI=Rr(),KN=zu(),tf=Vs(),bI=Zu(),kQ=Bo(),gI=fy(),XN=py(),vI=Vi(),TI=Er(),FQ=fN(),NI=_m(),jQ=vy(),Py=qn(),rf=jm(),MQ=Lm(),CI=Ku(),AI=Mm(),SI=ct(),BQ=UN(),LQ=zN(),UQ=Ym(),wI=Xa(),_y=Ds().forEach,fn=MQ("hidden"),ky="Symbol",nf="prototype",EI=SI("toPrimitive"),zQ=wI.set,RI=wI.getterFor(ky),$n=Object[nf],Ii=GN.Symbol,Is=Ii&&Ii[nf],xI=GN.TypeError,YN=GN.QObject,af=EQ("JSON","stringify"),VI=vI.f,Ps=TI.f,OI=gI.f,GQ=NI.f,DI=xQ([].push),Pi=rf("symbols"),sf=rf("op-symbols"),ZN=rf("string-to-symbol-registry"),JN=rf("symbol-to-string-registry"),HQ=rf("wks"),QN=!YN||!YN[nf]||!YN[nf].findChild,eC=nc&&HN(function(){return tf(Ps({},"a",{get:function(){return Ps(this,"a",{value:7}).a}})).a!=7})?function(a,t,e){var r=VI($n,t);r&&delete $n[t],Ps(a,t,e),r&&a!==$n&&Ps($n,t,r)}:Ps,tC=function(a,t){var e=Pi[a]=tf(Is);return zQ(e,{type:ky,tag:a,description:t}),nc||(e.description=t),e},Fy=function(t,e,r){t===$n&&Fy(sf,e,r),WN(t);var n=$N(e);return WN(r),$t(Pi,n)?(r.enumerable?($t(t,fn)&&t[fn][n]&&(t[fn][n]=!1),r=tf(r,{enumerable:KN(0,!1)})):($t(t,fn)||Ps(t,fn,KN(1,{})),t[fn][n]=!0),eC(t,n,r)):Ps(t,n,r)},rC=function(t,e){WN(t);var r=Iy(e),n=bI(r).concat(aC(r));return _y(n,function(i){(!nc||ef(nC,r,i))&&Fy(t,i,r[i])}),t},qQ=function(t,e){return e===void 0?tf(t):rC(tf(t),e)},nC=function(t){var e=$N(t),r=ef(GQ,this,e);return this===$n&&$t(Pi,e)&&!$t(sf,e)?!1:r||!$t(this,e)||!$t(Pi,e)||$t(this,fn)&&this[fn][e]?r:!0},II=function(t,e){var r=Iy(t),n=$N(e);if(!(r===$n&&$t(Pi,n)&&!$t(sf,n))){var i=VI(r,n);return i&&$t(Pi,n)&&!($t(r,fn)&&r[fn][n])&&(i.enumerable=!0),i}},PI=function(t){var e=OI(Iy(t)),r=[];return _y(e,function(n){!$t(Pi,n)&&!$t(CI,n)&&DI(r,n)}),r},aC=function(t){var e=t===$n,r=OI(e?sf:Iy(t)),n=[];return _y(r,function(i){$t(Pi,i)&&(!e||$t($n,i))&&DI(n,Pi[i])}),n};Lo||(Ii=function(){if(PQ(Is,this))throw xI("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:yI(arguments[0]),e=AI(t),r=function(n){this===$n&&ef(r,sf,n),$t(this,fn)&&$t(this[fn],e)&&(this[fn][e]=!1),eC(this,e,KN(1,n))};return nc&&QN&&eC($n,e,{configurable:!0,set:r}),tC(e,t)},Is=Ii[nf],Py(Is,"toString",function(){return RI(this).tag}),Py(Ii,"withoutSetter",function(a){return tC(AI(a),a)}),NI.f=nC,TI.f=Fy,FQ.f=rC,vI.f=II,kQ.f=gI.f=PI,XN.f=aC,BQ.f=function(a){return tC(SI(a),a)},nc&&(Ps(Is,"description",{configurable:!0,get:function(){return RI(this).description}}),VQ||Py($n,"propertyIsEnumerable",nC,{unsafe:!0})));rc({global:!0,wrap:!0,forced:!Lo,sham:!Lo},{Symbol:Ii});_y(bI(HQ),function(a){LQ(a)});rc({target:ky,stat:!0,forced:!Lo},{for:function(a){var t=yI(a);if($t(ZN,t))return ZN[t];var e=Ii(t);return ZN[t]=e,JN[e]=t,e},keyFor:function(t){if(!qN(t))throw xI(t+" is not a symbol");if($t(JN,t))return JN[t]},useSetter:function(){QN=!0},useSimple:function(){QN=!1}});rc({target:"Object",stat:!0,forced:!Lo,sham:!nc},{create:qQ,defineProperty:Fy,defineProperties:rC,getOwnPropertyDescriptor:II});rc({target:"Object",stat:!0,forced:!Lo},{getOwnPropertyNames:PI,getOwnPropertySymbols:aC});rc({target:"Object",stat:!0,forced:HN(function(){XN.f(1)})},{getOwnPropertySymbols:function(t){return XN.f(_Q(t))}});af&&(_I=!Lo||HN(function(){var a=Ii();return af([a])!="[null]"||af({a})!="{}"||af(Object(a))!="{}"}),rc({target:"JSON",stat:!0,forced:_I},{stringify:function(t,e,r){var n=jQ(arguments),i=e;if(!(!IQ(e)&&t===void 0||qN(t)))return OQ(e)||(e=function(s,o){if(DQ(i)&&(o=ef(i,this,s,o)),!qN(o))return o}),n[1]=e,RQ(af,null,n)}}));var _I;Is[EI]||(kI=Is.valueOf,Py(Is,EI,function(a){return ef(kI,this)}));var kI;UQ(Ii,ky);CI[fn]=!0;"use strict";var WQ=he(),$Q=sr(),KQ=pe(),jy=Ne(),XQ=or(),YQ=It(),ZQ=xi(),JQ=Rr(),QQ=Er().f,eee=sN(),_i=KQ.Symbol,Uo=_i&&_i.prototype;$Q&&YQ(_i)&&(!("description"in Uo)||_i().description!==void 0)&&(iC={},of=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:JQ(arguments[0]),e=ZQ(Uo,this)?new _i(t):t===void 0?_i():_i(t);return t===""&&(iC[e]=!0),e},eee(of,_i),of.prototype=Uo,Uo.constructor=of,FI=String(_i("test"))=="Symbol(test)",jI=jy(Uo.toString),MI=jy(Uo.valueOf),BI=/^Symbol\((.*)\)[^)]+$/,LI=jy("".replace),UI=jy("".slice),QQ(Uo,"description",{configurable:!0,get:function(){var t=MI(this),e=jI(t);if(XQ(iC,t))return"";var r=FI?UI(e,7,-1):LI(e,BI,"$1");return r===""?void 0:r}}),WQ({global:!0,forced:!0},{Symbol:of}));var iC,of,FI,jI,MI,BI,LI,UI;var tee=zN();tee("iterator");var Lvt=M(q());var ZI=pe(),JI=uC(),fee=pC(),lf=q(),mC=Oi(),QI=ct(),fC=QI("iterator"),e3=QI("toStringTag"),dC=lf.values,t3=function(a,t){if(a){if(a[fC]!==dC)try{mC(a,fC,dC)}catch(r){a[fC]=dC}if(a[e3]||mC(a,e3,t),JI[t]){for(var e in lf)if(a[e]!==lf[e])try{mC(a,e,lf[e])}catch(r){a[e]=lf[e]}}}};for(My in JI)t3(ZI[My]&&ZI[My].prototype,My);var My;t3(fee,"DOMTokenList");var Cee=he(),s3=i3();Cee({target:"Object",stat:!0,forced:Object.assign!==s3},{assign:s3});"use strict";var Aee=he(),See=pe(),wee=De(),Eee=Ju(),Ree=zt(),xee=Yr(),Vee=Wn(),o3=Yu(),Oee=Dy(),Dee=Qu(),Iee=ct(),Pee=qu(),l3=Iee("isConcatSpreadable"),u3=9007199254740991,c3="Maximum allowed index exceeded",p3=See.TypeError,_ee=Pee>=51||!wee(function(){var a=[];return a[l3]=!1,a.concat()[0]!==a}),kee=Dee("concat"),Fee=function(a){if(!Ree(a))return!1;var t=a[l3];return t!==void 0?!!t:Eee(a)},jee=!_ee||!kee;Aee({target:"Array",proto:!0,forced:jee},{concat:function(t){var e=xee(this),r=Oee(e,0),n=0,i,s,o,l,u;for(i=-1,o=arguments.length;i<o;i++)if(u=i===-1?e:arguments[i],Fee(u)){if(l=Vee(u),n+l>u3)throw p3(c3);for(s=0;s<l;s++,n++)s in u&&o3(r,n,u[s])}else{if(n>=u3)throw p3(c3);o3(r,n++,u)}return r.length=n,r}});var NWe=M(q());var _He=M(xr());"use strict";var Mee=he(),Bee=Ds().map,Lee=Qu(),Uee=Lee("map");Mee({target:"Array",proto:!0,forced:!Uee},{map:function(t){return Bee(this,t,arguments.length>1?arguments[1]:void 0)}});var jHe=M(q());"use strict";var Wte=Hy(),$te=wC();Wte("Set",function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},$te);var z3=pe(),G3=uC(),Jte=pC(),EC=U3(),Qte=Oi(),H3=function(a){if(a&&a.forEach!==EC)try{Qte(a,"forEach",EC)}catch(t){a.forEach=EC}};for(Wy in G3)G3[Wy]&&H3(z3[Wy]&&z3[Wy].prototype);var Wy;H3(Jte);"use strict";var ere=he(),tre=Ds().filter,rre=Qu(),nre=rre("filter");ere({target:"Array",proto:!0,forced:!nre},{filter:function(t){return tre(this,t,arguments.length>1?arguments[1]:void 0)}});var YHe=M(ie());var hMe=M(xr());var sre=he(),ore=W3();sre({target:"Number",stat:!0},{isFinite:ore});"use strict";var hre=sr(),DC=pe(),Z3=Ne(),yre=Gm(),bre=qn(),J3=or(),gre=Gy(),vre=xi(),Tre=km(),Q3=LT(),Nre=De(),Cre=Bo().f,Are=Vi().f,Sre=Er().f,wre=RC(),Ere=OC().trim,IC="Number",_s=DC[IC],PC=_s.prototype,Rre=DC.TypeError,xre=Z3("".slice),Ky=Z3("".charCodeAt),Vre=function(a){var t=Q3(a,"number");return typeof t=="bigint"?t:Ore(t)},Ore=function(a){var t=Q3(a,"number"),e,r,n,i,s,o,l,u;if(Tre(t))throw Rre("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=Ere(t),e=Ky(t,0),e===43||e===45){if(r=Ky(t,2),r===88||r===120)return NaN}else if(e===48){switch(Ky(t,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(s=xre(t,2),o=s.length,l=0;l<o;l++)if(u=Ky(s,l),u<48||u>i)return NaN;return parseInt(s,n)}}return+t};if(yre(IC,!_s(" 0o1")||!_s("0b1")||_s("+0x1"))){for(zo=function(t){var e=arguments.length<1?0:_s(Vre(t)),r=this;return vre(PC,r)&&Nre(function(){wre(r)})?gre(Object(e),r,zo):e},_C=hre?Cre(_s):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Xy=0;_C.length>Xy;Xy++)J3(_s,mf=_C[Xy])&&!J3(zo,mf)&&Sre(zo,mf,Are(_s,mf));zo.prototype=PC,PC.constructor=zo,bre(DC,IC,zo)}var zo,_C,Xy,mf;var AMe=M(q());"use strict";var Dre=Ne(),Ire=Xu().PROPER,Pre=qn(),_re=Wt(),kre=xi(),e4=Rr(),Fre=De(),jre=Ry(),kC="toString",FC=RegExp.prototype,t4=FC[kC],Mre=Dre(jre),Bre=Fre(function(){return t4.call({source:"a",flags:"b"})!="/a/b"}),Lre=Ire&&t4.name!=kC;(Bre||Lre)&&Pre(RegExp.prototype,kC,function(){var t=_re(this),e=e4(t.source),r=t.flags,n=e4(r===void 0&&kre(FC,t)&&!("flags"in FC)?Mre(t):r);return"/"+e+"/"+n},{unsafe:!0});var Ure=sr(),jC=pe(),sc=Ne(),zre=Gm(),Gre=Gy(),Hre=Oi(),qre=Er().f,Wre=Bo().f,r4=xi(),$re=yy(),n4=Rr(),Kre=Ry(),a4=xy(),Xre=qn(),Yre=De(),Zre=or(),Jre=Xa().enforce,Qre=AC(),ene=ct(),i4=kN(),s4=FN(),tne=ene("match"),Fi=jC.RegExp,oc=Fi.prototype,rne=jC.SyntaxError,nne=sc(Kre),ane=sc(oc.exec),Yy=sc("".charAt),o4=sc("".replace),l4=sc("".indexOf),ine=sc("".slice),sne=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Go=/a/g,MC=/a/g,one=new Fi(Go)!==Go,u4=a4.MISSED_STICKY,lne=a4.UNSUPPORTED_Y,une=Ure&&(!one||u4||i4||s4||Yre(function(){return MC[tne]=!1,Fi(Go)!=Go||Fi(MC)==MC||Fi(Go,"i")!="/a/i"})),cne=function(a){for(var t=a.length,e=0,r="",n=!1,i;e<=t;e++){if(i=Yy(a,e),i==="\\"){r+=i+Yy(a,++e);continue}!n&&i==="."?r+="[\\s\\S]":(i==="["?n=!0:i==="]"&&(n=!1),r+=i)}return r},pne=function(a){for(var t=a.length,e=0,r="",n=[],i={},s=!1,o=!1,l=0,u="",c;e<=t;e++){if(c=Yy(a,e),c==="\\")c=c+Yy(a,++e);else if(c==="]")s=!1;else if(!s)switch(!0){case c==="[":s=!0;break;case c==="(":ane(sne,ine(a,e+1))&&(e+=2,o=!0),r+=c,l++;continue;case(c===">"&&o):if(u===""||Zre(i,u))throw new rne("Invalid capture group name");i[u]=!0,n[n.length]=[u,l],o=!1,u="";continue}o?u+=c:r+=c}return[r,n]};if(zre("RegExp",une)){for(ji=function(t,e){var r=r4(oc,this),n=$re(t),i=e===void 0,s=[],o=t,l,u,c,p,m,f;if(!r&&n&&i&&t.constructor===ji)return t;if((n||r4(oc,t))&&(t=t.source,i&&(e="flags"in o?o.flags:nne(o))),t=t===void 0?"":n4(t),e=e===void 0?"":n4(e),o=t,i4&&"dotAll"in Go&&(u=!!e&&l4(e,"s")>-1,u&&(e=o4(e,/s/g,""))),l=e,u4&&"sticky"in Go&&(c=!!e&&l4(e,"y")>-1,c&&lne&&(e=o4(e,/y/g,""))),s4&&(p=pne(t),t=p[0],s=p[1]),m=Gre(Fi(t,e),r?this:oc,ji),(u||c||s.length)&&(f=Jre(m),u&&(f.dotAll=!0,f.raw=ji(cne(t),l)),c&&(f.sticky=!0),s.length&&(f.groups=s)),t!==o)try{Hre(m,"source",o===""?"(?:)":o)}catch(d){}return m},c4=function(a){a in ji||qre(ji,a,{configurable:!0,get:function(){return Fi[a]},set:function(t){Fi[a]=t}})},BC=Wre(Fi),LC=0;BC.length>LC;)c4(BC[LC++]);oc.constructor=ji,ji.prototype=oc,Xre(jC,"RegExp",ji)}var ji,c4,BC,LC;Qre("RegExp");var s8e=M(ie());var u8e=M(q());"use strict";var mne=Hy(),fne=wC();mne("Map",function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},fne);function Zy(a){return Zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zy(a)}function p4(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function He(a,t,e){return t&&p4(a.prototype,t),e&&p4(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function qe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function We(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&ff(a,t)}function $e(a){var t=m4();return function(){var r=df(a),n;if(t){var i=df(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return dne(this,n)}}function dne(a,t){if(t&&(Zy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hne(a)}function hne(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Be(a){var t=typeof Map=="function"?new Map:void 0;return Be=function(r){if(r===null||!yne(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,n)}function n(){return Jy(r,arguments,df(this).constructor)}return n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ff(n,r)},Be(a)}function Jy(a,t,e){return m4()?Jy=Reflect.construct:Jy=function(n,i,s){var o=[null];o.push.apply(o,i);var l=Function.bind.apply(n,o),u=new l;return s&&ff(u,s.prototype),u},Jy.apply(null,arguments)}function m4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function yne(a){return Function.toString.call(a).indexOf("[native code]")!==-1}function ff(a,t){return ff=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},ff(a,t)}function df(a){return df=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},df(a)}var tt=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"There's no sheet with id = ".concat(r))}return He(e)}(Be(Error)),Qy=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"There's no sheet with name '".concat(r,"'"))}return He(e)}(Be(Error)),ks=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Sheet with name ".concat(r," already exists"))}return He(e)}(Be(Error)),Kn=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"Sheet size limit exceeded")}return He(e)}(Be(Error)),hf=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"This is not a formula")}return He(e)}(Be(Error)),eb=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Address (row = ".concat(r.row,", col = ").concat(r.col,") is invalid"))}return He(e)}(Be(Error)),pt=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Invalid arguments, expected ".concat(r))}return He(e)}(Be(Error)),lc=function(a){We(e,a);var t=$e(e);function e(r,n){return qe(this,e),t.call(this,"Sheets ".concat(r," and ").concat(n," are not equal."))}return He(e)}(Be(Error)),tb=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Name of Named Expression '".concat(r,"' is already present"))}return He(e)}(Be(Error)),rb=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Name of Named Expression '".concat(r,"' is invalid"))}return He(e)}(Be(Error)),Fs=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Named Expression '".concat(r,"' does not exist"))}return He(e)}(Be(Error)),nb=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"There is no operation to undo")}return He(e)}(Be(Error)),ab=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"There is no operation to redo")}return He(e)}(Be(Error)),ib=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"There is nothing to paste")}return He(e)}(Be(Error));function bne(a,t){switch(Zy(t)){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}var sb=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Unable to parse value: ".concat(JSON.stringify(r,bne,4)))}return He(e)}(Be(Error)),Pe=function(a){We(e,a);var t=$e(e);function e(r,n){return qe(this,e),t.call(this,"Expected value of type: ".concat(r," for config parameter: ").concat(n))}return He(e)}(Be(Error)),f4=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Config parameter ".concat(r," cannot be empty."))}return He(e)}(Be(Error)),ob=function(a){We(e,a);var t=$e(e);function e(r,n){return qe(this,e),t.call(this,"Config parameter ".concat(r," should be at least ").concat(n))}return He(e)}(Be(Error)),lb=function(a){We(e,a);var t=$e(e);function e(r,n){return qe(this,e),t.call(this,"Config parameter ".concat(r," should be at most ").concat(n))}return He(e)}(Be(Error)),ub=function(a){We(e,a);var t=$e(e);function e(r,n){return qe(this,e),t.call(this,"Expected one of ".concat(r," for config parameter: ").concat(n))}return He(e)}(Be(Error)),cb=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"Computations are suspended")}return He(e)}(Be(Error)),js=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Translation for ".concat(r," is missing in the translation package you're using."))}return He(e)}(Be(Error)),pb=function(a){We(e,a);var t=$e(e);function e(r){return qe(this,e),t.call(this,"Cannot register translation for function with id: ".concat(r))}return He(e)}(Be(Error)),yf=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"Language not registered.")}return He(e)}(Be(Error)),mb=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"Language already registered.")}return He(e)}(Be(Error)),bf=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.apply(this,arguments)}return He(e,null,[{key:"functionNotDeclaredInPlugin",value:function(n,i){return new e("Function with id ".concat(n," not declared in plugin ").concat(i))}},{key:"functionMethodNotFound",value:function(n,i){return new e("Function method ".concat(n," not found in plugin ").concat(i))}}]),e}(Be(Error)),fb=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.apply(this,arguments)}return He(e,null,[{key:"cannotRegisterFunctionWithId",value:function(n){return new e("Cannot register function with id ".concat(n))}},{key:"cannotUnregisterFunctionWithId",value:function(n){return new e("Cannot unregister function with id ".concat(n))}},{key:"cannotUnregisterProtectedPlugin",value:function(){return new e("Cannot unregister protected plugin")}}]),e}(Be(Error)),Mi=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"Cannot perform this operation, source location has an array inside.")}return He(e)}(Be(Error)),Ho=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"Cannot perform this operation, target location has an array inside.")}return He(e)}(Be(Error)),uc=function(a){We(e,a);var t=$e(e);function e(){return qe(this,e),t.call(this,"Relative addresses not allowed in named expressions.")}return He(e)}(Be(Error)),d4=function(a){We(e,a);var t=$e(e);function e(r,n){return qe(this,e),t.call(this,"Alias id ".concat(r," in plugin ").concat(n," already defined as a function or alias."))}return He(e)}(Be(Error));var Wke=M(ie());"use strict";var Dne=Wm(),gf=Br(),qC=Ne(),Ine=zC(),Pne=yy(),_ne=Wt(),E4=Gn(),kne=C4(),Fne=GC(),jne=Mo(),WC=Rr(),Mne=Wu(),R4=my(),x4=HC(),Bne=Qm(),Lne=xy(),Une=De(),cc=Lne.UNSUPPORTED_Y,V4=4294967295,zne=Math.min,O4=[].push,Gne=qC(/./.exec),pc=qC(O4),vf=qC("".slice),Hne=!Une(function(){var a=/(?:)/,t=a.exec;a.exec=function(){return t.apply(this,arguments)};var e="ab".split(a);return e.length!==2||e[0]!=="a"||e[1]!=="b"});Ine("split",function(a,t,e){var r;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?r=function(n,i){var s=WC(E4(this)),o=i===void 0?V4:i>>>0;if(o===0)return[];if(n===void 0)return[s];if(!Pne(n))return gf(t,s,n,o);for(var l=[],u=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(n.sticky?"y":""),c=0,p=new RegExp(n.source,u+"g"),m,f,d;(m=gf(Bne,p,s))&&(f=p.lastIndex,!(f>c&&(pc(l,vf(s,c,m.index)),m.length>1&&m.index<s.length&&Dne(O4,l,R4(m,1)),d=m[0].length,c=f,l.length>=o)));)p.lastIndex===m.index&&p.lastIndex++;return c===s.length?(d||!Gne(p,""))&&pc(l,""):pc(l,vf(s,c)),l.length>o?R4(l,0,o):l}:"0".split(void 0,0).length?r=function(n,i){return n===void 0&&i===0?[]:gf(t,this,n,i)}:r=t,[function(i,s){var o=E4(this),l=i==null?void 0:Mne(i,a);return l?gf(l,i,o,s):gf(r,WC(o),i,s)},function(n,i){var s=_ne(this),o=WC(n),l=e(r,s,o,i,r!==t);if(l.done)return l.value;var u=kne(s,RegExp),c=s.unicode,p=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(cc?"g":"y"),m=new u(cc?"^(?:"+s.source+")":s,p),f=i===void 0?V4:i>>>0;if(f===0)return[];if(o.length===0)return x4(m,o)===null?[o]:[];for(var d=0,h=0,y=[];h<o.length;){m.lastIndex=cc?0:h;var b=x4(m,cc?vf(o,h):o),g;if(b===null||(g=zne(jne(m.lastIndex+(cc?h:0)),o.length))===d)h=Fne(o,h,c);else{if(pc(y,vf(o,d,h)),y.length===f)return y;for(var v=1;v<=b.length-1;v++)if(pc(y,b[v]),y.length===f)return y;h=d=g}}return pc(y,vf(o,d)),y}]},!Hne,cc);"use strict";var Qne=he(),eae=P4().left,tae=pf(),F4=qu(),rae=k4(),nae=tae("reduce"),aae=!rae&&F4>79&&F4<83;Qne({target:"Array",proto:!0,forced:!nae||aae},{reduce:function(t){var e=arguments.length;return eae(this,t,e,e>1?arguments[1]:void 0)}});"use strict";var cae=Wm(),B4=Br(),db=Ne(),pae=zC(),mae=De(),fae=Wt(),dae=It(),hae=xs(),yae=Mo(),mc=Rr(),bae=Gn(),gae=GC(),vae=Wu(),Tae=M4(),Nae=HC(),Cae=ct(),YC=Cae("replace"),Aae=Math.max,Sae=Math.min,wae=db([].concat),ZC=db([].push),L4=db("".indexOf),U4=db("".slice),Eae=function(a){return a===void 0?a:String(a)},Rae=function(){return"a".replace(/./,"$0")==="$0"}(),z4=function(){return/./[YC]?/./[YC]("a","$0")==="":!1}(),xae=!mae(function(){var a=/./;return a.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(a,"$<a>")!=="7"});pae("replace",function(a,t,e){var r=z4?"$":"$0";return[function(i,s){var o=bae(this),l=i==null?void 0:vae(i,YC);return l?B4(l,i,o,s):B4(t,mc(o),i,s)},function(n,i){var s=fae(this),o=mc(n);if(typeof i=="string"&&L4(i,r)===-1&&L4(i,"$<")===-1){var l=e(t,s,o,i);if(l.done)return l.value}var u=dae(i);u||(i=mc(i));var c=s.global;if(c){var p=s.unicode;s.lastIndex=0}for(var m=[];;){var f=Nae(s,o);if(f===null||(ZC(m,f),!c))break;var d=mc(f[0]);d===""&&(s.lastIndex=gae(o,yae(s.lastIndex),p))}for(var h="",y=0,b=0;b<m.length;b++){f=m[b];for(var g=mc(f[0]),v=Aae(Sae(hae(f.index),o.length),0),A=[],C=1;C<f.length;C++)ZC(A,Eae(f[C]));var S=f.groups;if(u){var w=wae([g],A,v,o);S!==void 0&&ZC(w,S);var x=mc(cae(i,void 0,w))}else x=Tae(g,o,v,A,S,i);v>=y&&(h+=U4(o,y,v)+x,y=v+g.length)}return h+U4(o,y)}]},!xae||!Rae||z4);var nFe=M(q());function Vae(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function G4(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Oae(a,t,e){return t&&G4(a.prototype,t),e&&G4(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Ke;(function(a){a.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",a.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",a.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",a.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(Ke||(Ke={}));var Lr=function(){function a(t,e,r,n){Vae(this,a),this.col=t,this.row=e,this.type=r,this.sheet=n}return Oae(a,[{key:"toSimpleCellAddress",value:function(e){var r=mr(this,e);return this.type===Ke.CELL_REFERENCE_ABSOLUTE?$(r,this.col,this.row):this.type===Ke.CELL_REFERENCE_ABSOLUTE_ROW?$(r,e.col+this.col,this.row):this.type===Ke.CELL_REFERENCE_ABSOLUTE_COL?$(r,this.col,e.row+this.row):$(r,e.col+this.col,e.row+this.row)}},{key:"toSimpleColumnAddress",value:function(e){var r=mr(this,e),n=this.col;return this.isColumnRelative()&&(n+=e.col),yb(r,n)}},{key:"toSimpleRowAddress",value:function(e){var r=mr(this,e),n=this.row;return this.isRowRelative()&&(n+=e.row),hb(r,n)}},{key:"isRowAbsolute",value:function(){return this.type===Ke.CELL_REFERENCE_ABSOLUTE||this.type===Ke.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isColumnAbsolute",value:function(){return this.type===Ke.CELL_REFERENCE_ABSOLUTE||this.type===Ke.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isColumnRelative",value:function(){return this.type===Ke.CELL_REFERENCE_RELATIVE||this.type===Ke.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isRowRelative",value:function(){return this.type===Ke.CELL_REFERENCE_RELATIVE||this.type===Ke.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isAbsolute",value:function(){return this.type===Ke.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}},{key:"shiftedByRows",value:function(e){return new a(this.col,this.row+e,this.type,this.sheet)}},{key:"shiftedByColumns",value:function(e){return new a(this.col+e,this.row,this.type,this.sheet)}},{key:"moved",value:function(e,r,n){var i=this.sheet===void 0?void 0:e;return new a(this.col+r,this.row+n,this.type,i)}},{key:"withAbsoluteSheet",value:function(e){return new a(this.col,this.row,this.type,e)}},{key:"isInvalid",value:function(e){return Kt(this.toSimpleCellAddress(e))}},{key:"shiftRelativeDimensions",value:function(e,r){var n=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+r;return new a(n,i,this.type,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(e,r){var n=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+r;return new a(n,i,this.type,this.sheet)}},{key:"hash",value:function(e){var r=e&&this.sheet!==void 0?"#".concat(this.sheet):"";switch(this.type){case Ke.CELL_REFERENCE_RELATIVE:return"".concat(r,"#").concat(this.row,"R").concat(this.col);case Ke.CELL_REFERENCE_ABSOLUTE:return"".concat(r,"#").concat(this.row,"A").concat(this.col);case Ke.CELL_REFERENCE_ABSOLUTE_COL:return"".concat(r,"#").concat(this.row,"AC").concat(this.col);case Ke.CELL_REFERENCE_ABSOLUTE_ROW:return"".concat(r,"#").concat(this.row,"AR").concat(this.col)}}},{key:"unparse",value:function(e){var r=this.toSimpleCellAddress(e);if(!Kt(r)){var n=Tf(r.col),i=this.type===Ke.CELL_REFERENCE_ABSOLUTE||this.type===Ke.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",s=this.type===Ke.CELL_REFERENCE_ABSOLUTE||this.type===Ke.CELL_REFERENCE_ABSOLUTE_COL?"$":"";return"".concat(s).concat(n).concat(i).concat(r.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e,r){return this.row>=r||this.col>=e}}],[{key:"relative",value:function(e,r,n){return new a(r,e,Ke.CELL_REFERENCE_RELATIVE,n)}},{key:"absolute",value:function(e,r,n){return new a(e,r,Ke.CELL_REFERENCE_ABSOLUTE,n)}},{key:"absoluteCol",value:function(e,r,n){return new a(e,r,Ke.CELL_REFERENCE_ABSOLUTE_COL,n)}},{key:"absoluteRow",value:function(e,r,n){return new a(e,r,Ke.CELL_REFERENCE_ABSOLUTE_ROW,n)}}]),a}();function Dae(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function H4(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Iae(a,t,e){return t&&H4(a.prototype,t),e&&H4(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var lr;(function(a){a.RELATIVE="RELATIVE",a.ABSOLUTE="ABSOLUTE"})(lr||(lr={}));var JC=function(){function a(t,e,r){Dae(this,a),this.type=t,this.col=e,this.sheet=r}return Iae(a,[{key:"isColumnAbsolute",value:function(){return this.type===lr.ABSOLUTE}},{key:"isColumnRelative",value:function(){return this.type===lr.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===lr.ABSOLUTE&&this.sheet!==void 0}},{key:"moved",value:function(e,r,n){var i=this.sheet===void 0?void 0:e;return new a(this.type,this.col+r,i)}},{key:"shiftedByColumns",value:function(e){return new a(this.type,this.col+e,this.sheet)}},{key:"toSimpleColumnAddress",value:function(e){var r=mr(this,e),n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),yb(r,n)}},{key:"shiftRelativeDimensions",value:function(e,r){var n=this.isColumnRelative()?this.col+e:this.col;return new a(this.type,n,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(e,r){var n=this.isColumnAbsolute()?this.col+e:this.col;return new a(this.type,n,this.sheet)}},{key:"withAbsoluteSheet",value:function(e){return new a(this.type,this.col,e)}},{key:"isInvalid",value:function(e){return this.toSimpleColumnAddress(e).col<0}},{key:"hash",value:function(e){var r=e&&this.sheet!==void 0?"#".concat(this.sheet):"";switch(this.type){case lr.RELATIVE:return"".concat(r,"#COLR").concat(this.col);case lr.ABSOLUTE:return"".concat(r,"#COLA").concat(this.col)}}},{key:"unparse",value:function(e){var r=this.toSimpleColumnAddress(e);if(!q4(r)){var n=Tf(r.col),i=this.type===lr.ABSOLUTE?"$":"";return"".concat(i).concat(n)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.col>=e}}],[{key:"absolute",value:function(e,r){return new a(lr.ABSOLUTE,e,r)}},{key:"relative",value:function(e,r){return new a(lr.RELATIVE,e,r)}}]),a}();var Eke=M(ie());var Pke=M(q());Zb();function ese(a){return ase(a)||nse(a)||rse(a)||tse()}function tse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rse(a,t){if(!!a){if(typeof a=="string")return F6(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return F6(a,t)}}function nse(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function ase(a){if(Array.isArray(a))return F6(a)}function F6(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}var wc=":",Dr="$",Ec=Oe({name:"AdditionOp",pattern:Jt.NA}),Jb=Oe({name:"PlusOp",pattern:/\+/,categories:Ec}),Qb=Oe({name:"MinusOp",pattern:/-/,categories:Ec}),Ff=Oe({name:"MultiplicationOp",pattern:Jt.NA}),j6=Oe({name:"TimesOp",pattern:/\*/,categories:Ff}),M6=Oe({name:"DivOp",pattern:/\//,categories:Ff}),eg=Oe({name:"PowerOp",pattern:/\^/}),B6=Oe({name:"PercentOp",pattern:/%/}),Wi=Oe({name:"BooleanOp",pattern:Jt.NA}),tg=Oe({name:"EqualsOp",pattern:/=/,categories:Wi}),L6=Oe({name:"NotEqualOp",pattern:/<>/,categories:Wi}),U6=Oe({name:"GreaterThanOp",pattern:/>/,categories:Wi}),z6=Oe({name:"LessThanOp",pattern:/</,categories:Wi}),G6=Oe({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:Wi}),H6=Oe({name:"LessThanOrEqualOp",pattern:/<=/,categories:Wi}),q6=Oe({name:"ConcatenateOp",pattern:/&/}),W6="[A-Za-z0-9_\xC0-\u02AF]+",ise="'(((?!').|'')*)'",$i="(".concat(W6,"|").concat(ise,")!"),ei=Oe({name:"CellReference",pattern:new RegExp("(".concat($i,")?\\").concat(Dr,"?[A-Za-z]+\\").concat(Dr,"?[0-9]+"))}),jf=Oe({name:"ColumnRange",pattern:new RegExp("(".concat($i,")?\\").concat(Dr,"?[A-Za-z]+").concat(wc,"(").concat($i,")?\\").concat(Dr,"?[A-Za-z]+"))}),Mf=Oe({name:"RowRange",pattern:new RegExp("(".concat($i,")?\\").concat(Dr,"?[0-9]+").concat(wc,"(").concat($i,")?\\").concat(Dr,"?[0-9]+"))}),Rc=Oe({name:"RangeSeparator",pattern:"".concat(wc)}),rg=Oe({name:"LParen",pattern:/\(/}),Bf=Oe({name:"RParen",pattern:/\)/}),$6=Oe({name:"ArrayLParen",pattern:/{/}),K6=Oe({name:"ArrayRParen",pattern:/}/}),Lf=Oe({name:"ProcedureName",pattern:/([A-Za-z\u00C0-\u02AF][A-Za-z0-9\u00C0-\u02AF._]*)\(/}),X6=Oe({name:"NamedExpression",pattern:/[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*/}),Y6=Oe({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),Z6=Oe({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Ki=Oe({name:"WhiteSpace",pattern:/[ \t\n\r]+/}),rl=function(t){var e=t.translationPackage.getFunctionTranslation("OFFSET"),r=t.errorMapping,n=t.translationPackage.buildFunctionMapping(),i=Oe({name:"ArrayRowSep",pattern:t.arrayRowSeparator}),s=Oe({name:"ArrayColSep",pattern:t.arrayColumnSeparator}),o,l;t.functionArgSeparator===t.arrayColumnSeparator?(o=s,l=[]):t.functionArgSeparator===t.arrayRowSeparator?(o=i,l=[]):(o=Oe({name:"ArgSeparator",pattern:t.functionArgSeparator}),l=[o]);var u=Oe({name:"NumberLiteral",pattern:new RegExp("(([".concat(t.decimalSeparator,"]\\d+)|(\\d+([").concat(t.decimalSeparator,"]\\d*)?))(e[+-]?\\d+)?"))}),c=Oe({name:"OffsetProcedureName",pattern:new RegExp(e,"i")}),p=[Ki,Jb,Qb,j6,M6,eg,tg,L6,B6,G6,H6,U6,z6,rg,Bf,$6,K6,c,Lf,Rc].concat(ese(l),[jf,Mf,u,Y6,Z6,q6,Wi,Ec,Ff,ei,X6,i,s]);return{ArgSeparator:o,NumberLiteral:u,OffsetProcedureName:c,ArrayRowSeparator:i,ArrayColSeparator:s,allTokens:p,errorMapping:r,functionMapping:n,decimalSeparator:t.decimalSeparator,maxColumns:t.maxColumns,maxRows:t.maxRows}};function sse(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function H9(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function ose(a,t,e){return t&&H9(a.prototype,t),e&&H9(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Uf=function(){function a(t,e,r){sse(this,a),this.type=t,this.row=e,this.sheet=r}return ose(a,[{key:"isRowAbsolute",value:function(){return this.type===lr.ABSOLUTE}},{key:"isRowRelative",value:function(){return this.type===lr.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===lr.ABSOLUTE&&this.sheet!==void 0}},{key:"moved",value:function(e,r,n){var i=this.sheet===void 0?void 0:e;return new a(this.type,this.row+n,i)}},{key:"shiftedByRows",value:function(e){return new a(this.type,this.row+e,this.sheet)}},{key:"toSimpleRowAddress",value:function(e){var r=mr(this,e),n=this.row;return this.isRowRelative()&&(n=e.row+this.row),hb(r,n)}},{key:"shiftRelativeDimensions",value:function(e,r){var n=this.isRowRelative()?this.row+r:this.row;return new a(this.type,n,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(e,r){var n=this.isRowAbsolute()?this.row+r:this.row;return new a(this.type,n,this.sheet)}},{key:"withAbsoluteSheet",value:function(e){return new a(this.type,this.row,e)}},{key:"isInvalid",value:function(e){return this.toSimpleRowAddress(e).row<0}},{key:"hash",value:function(e){var r=e&&this.sheet!==void 0?"#".concat(this.sheet):"";switch(this.type){case lr.RELATIVE:return"".concat(r,"#ROWR").concat(this.row);case lr.ABSOLUTE:return"".concat(r,"#ROWA").concat(this.row)}}},{key:"unparse",value:function(e){var r=this.toSimpleRowAddress(e);if(!q9(r)){var n=this.type===lr.ABSOLUTE?"$":"";return"".concat(n).concat(r.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.row>=e}}],[{key:"absolute",value:function(e,r){return new a(lr.ABSOLUTE,e,r)}},{key:"relative",value:function(e,r){return new a(lr.RELATIVE,e,r)}}]),a}();function lse(a,t){return mse(a)||pse(a,t)||cse(a,t)||use()}function use(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cse(a,t){if(!!a){if(typeof a=="string")return W9(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return W9(a,t)}}function W9(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function pse(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function mse(a){if(Array.isArray(a))return a}var $9=new RegExp("^(".concat($i,")?(\\").concat(Dr,"?)([A-Za-z]+)(\\").concat(Dr,"?)([0-9]+)$")),fse=new RegExp("^(".concat($i,")?(\\").concat(Dr,"?)([A-Za-z]+)$")),dse=new RegExp("^(".concat($i,")?(\\").concat(Dr,"?)([0-9]+)$")),hse=new RegExp("^".concat(W6,"$")),Xi=function(t,e,r){var n=$9.exec(e),i=eA(n[6]),s=ng(n,t);if(s!==void 0){s===null&&(s=void 0);var o=Number(n[8])-1;return n[5]===Dr&&n[7]===Dr?Lr.absolute(i,o,s):n[5]===Dr?Lr.absoluteCol(i,o-r.row,s):n[7]===Dr?Lr.absoluteRow(i-r.col,o,s):Lr.relative(o-r.row,i-r.col,s)}},xc=function(t,e,r){var n=fse.exec(e),i=ng(n,t);if(i!==void 0){i===null&&(i=void 0);var s=eA(n[6]);return n[5]===Dr?JC.absolute(s,i):JC.relative(s-r.col,i)}},Vc=function(t,e,r){var n=dse.exec(e),i=ng(n,t);if(i!==void 0){i===null&&(i=void 0);var s=Number(n[6])-1;return n[5]===Dr?Uf.absolute(s,i):Uf.relative(s-r.row,i)}},zf=function(t,e,r){var n=$9.exec(e),i=eA(n[6]),s=ng(n,t);if(s!==void 0){s===null&&(s=r);var o=Number(n[8])-1;return $(s,i,o)}},J6=function(t,e,r){var n=e.split(wc);if(n.length===2){var i=lse(n,2),s=i[0],o=i[1],l=zf(t,s,r);if(l!==void 0){var u=zf(t,o,l.sheet);if(u!==void 0&&l.sheet===u.sheet)return Gf(l,u)}}},nl=function(t,e,r){var n=Tf(e.col),i=tA(e.sheet,t);if(i!==void 0)return r!==e.sheet?"".concat(i,"!").concat(n).concat(e.row+1):"".concat(n).concat(e.row+1)},Q6=function(t,e,r){var n=nl(t,e.start,r),i=nl(t,e.end,e.start.sheet);if(!(n===void 0||i===void 0))return"".concat(n).concat(wc).concat(i)};function eA(a){return a.length===1?a.toUpperCase().charCodeAt(0)-65:a.split("").reduce(function(t,e){return t*26+(e.toUpperCase().charCodeAt(0)-64)},0)-1}function Tf(a){for(var t="";a>=0;)t=String.fromCharCode(a%26+97)+t,a=Math.floor(a/26)-1;return t.toUpperCase()}function tA(a,t){var e=t(a);if(e!==void 0)return hse.test(e)?e:(e=e.replace(/'/g,"''"),"'".concat(e,"'"))}function ng(a,t){var e,r=(e=a[3])!==null&&e!==void 0?e:a[2];return r?(r=r.replace(/''/g,"'"),t(r)):null}var Rje=M(ie());"use strict";var yse=he(),bse=Ne(),gse=Gu(),vse=Hn(),Tse=pf(),Nse=bse([].join),Cse=gse!=Object,Ase=Tse("join",",");yse({target:"Array",proto:!0,forced:Cse||!Ase},{join:function(t){return Nse(vse(this),t===void 0?",":t)}});var _je=M(q());Zb();var rA=function(t,e){return{type:t,message:e}},bt;(function(a){a.LexingError="LexingError",a.ParserError="ParsingError",a.StaticOffsetError="StaticOffsetError",a.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",a.RangeOffsetNotAllowed="RangeOffsetNotAllowed"})(bt||(bt={}));var I;(function(a){a.EMPTY="EMPTY",a.NUMBER="NUMBER",a.STRING="STRING",a.MINUS_UNARY_OP="MINUS_UNARY_OP",a.PLUS_UNARY_OP="PLUS_UNARY_OP",a.PERCENT_OP="PERCENT_OP",a.CONCATENATE_OP="CONCATENATE_OP",a.EQUALS_OP="EQUALS_OP",a.NOT_EQUAL_OP="NOT_EQUAL_OP",a.GREATER_THAN_OP="GREATER_THAN_OP",a.LESS_THAN_OP="LESS_THAN_OP",a.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",a.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",a.PLUS_OP="PLUS_OP",a.MINUS_OP="MINUS_OP",a.TIMES_OP="TIMES_OP",a.DIV_OP="DIV_OP",a.POWER_OP="POWER_OP",a.FUNCTION_CALL="FUNCTION_CALL",a.NAMED_EXPRESSION="NAMED_EXPRESSION",a.PARENTHESIS="PARENTHESES",a.CELL_REFERENCE="CELL_REFERENCE",a.CELL_RANGE="CELL_RANGE",a.COLUMN_RANGE="COLUMN_RANGE",a.ROW_RANGE="ROW_RANGE",a.ERROR="ERROR",a.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",a.ARRAY="ARRAY"})(I||(I={}));var cr;(function(a){a[a.RELATIVE=0]="RELATIVE",a[a.START_ABSOLUTE=1]="START_ABSOLUTE",a[a.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(cr||(cr={}));var K9=function(t){return{type:I.EMPTY,leadingWhitespace:t==null?void 0:t.image}},X9=function(t,e){return{type:I.NUMBER,value:t,leadingWhitespace:e==null?void 0:e.image}},Y9=function(t){var e;return{type:I.STRING,value:t.image.slice(1,-1),leadingWhitespace:(e=t.leadingWhitespace)===null||e===void 0?void 0:e.image}},nA=function(t,e){return{type:I.CELL_REFERENCE,reference:t,leadingWhitespace:e==null?void 0:e.image}},Oc=function(t,e,r,n){return sA(t,e,r),{type:I.CELL_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n}},Z9=function(t,e,r,n){return sA(t,e,r),{type:I.COLUMN_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n==null?void 0:n.image}},J9=function(t,e,r,n){return sA(t,e,r),{type:I.ROW_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n==null?void 0:n.image}},Q9=function(t,e,r){return{type:I.CONCATENATE_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},eP=function(t,e,r){return{type:I.EQUALS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},tP=function(t,e,r){return{type:I.NOT_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},rP=function(t,e,r){return{type:I.GREATER_THAN_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},nP=function(t,e,r){return{type:I.LESS_THAN_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},aP=function(t,e,r){return{type:I.GREATER_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},iP=function(t,e,r){return{type:I.LESS_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},sP=function(t,e,r){return{type:I.PLUS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},oP=function(t,e,r){return{type:I.MINUS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},lP=function(t,e,r){return{type:I.TIMES_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},uP=function(t,e,r){return{type:I.DIV_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},cP=function(t,e,r){return{type:I.POWER_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}},pP=function(t,e){return{type:I.MINUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}},mP=function(t,e){return{type:I.PLUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}},fP=function(t,e){return{type:I.PERCENT_OP,value:t,leadingWhitespace:e==null?void 0:e.image}},aA=function(t,e,r,n){return{type:I.FUNCTION_CALL,procedureName:t,args:e,leadingWhitespace:r==null?void 0:r.image,internalWhitespace:n==null?void 0:n.image}},iA=function(t,e,r){return{type:I.ARRAY,args:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:r==null?void 0:r.image}},dP=function(t,e){return{type:I.NAMED_EXPRESSION,expressionName:t,leadingWhitespace:e==null?void 0:e.image}},hP=function(t,e,r){return{type:I.PARENTHESIS,expression:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:r==null?void 0:r.image}},In=function(t,e){return{type:I.ERROR,error:t,leadingWhitespace:e==null?void 0:e.image}},al=function(t,e,r){return{type:I.ERROR_WITH_RAW_INPUT,error:e,rawInput:t,leadingWhitespace:r==null?void 0:r.image}},Dc=function(){return{type:I.ERROR,error:E.parsingError()}};function sA(a,t,e){if(a.sheet!==void 0&&t.sheet===void 0||a.sheet===void 0&&t.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(a.sheet===void 0&&e!==cr.RELATIVE||a.sheet!==void 0&&e===cr.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function _e(a,t){return(t??"")+a}var hn;function Qn(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var ag=(hn={},Qn(hn,I.PLUS_OP,"+"),Qn(hn,I.MINUS_OP,"-"),Qn(hn,I.TIMES_OP,"*"),Qn(hn,I.DIV_OP,"/"),Qn(hn,I.CONCATENATE_OP,"&"),Qn(hn,I.POWER_OP,"^"),Qn(hn,I.EQUALS_OP,"="),Qn(hn,I.NOT_EQUAL_OP,"<>"),Qn(hn,I.GREATER_THAN_OP,">"),Qn(hn,I.GREATER_THAN_OR_EQUAL_OP,">="),Qn(hn,I.LESS_THAN_OP,"<"),Qn(hn,I.LESS_THAN_OR_EQUAL_OP,"<="),hn);var CFe=M(q());function Sse(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function yP(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function wse(a,t,e){return t&&yP(a.prototype,t),e&&yP(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Ese=function(t,e,r,n){return{ast:t,relativeDependencies:e,hasVolatileFunction:r,hasStructuralChangeFunction:n}},bP=function(){function a(t){Sse(this,a),this.functionRegistry=t,this.cache=new Map}return wse(a,[{key:"set",value:function(e,r){var n=il(r,this.functionRegistry),i=Ese(r,n,gP(r,this.functionRegistry.isFunctionVolatile),gP(r,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}},{key:"get",value:function(e){return this.cache.get(e)}},{key:"maybeSetAndThenGet",value:function(e,r){var n=this.cache.get(e);return n!==void 0?n.ast:(this.set(e,r),r)}}]),a}(),gP=function a(t,e){switch(t.type){case I.EMPTY:case I.NUMBER:case I.STRING:case I.ERROR:case I.ERROR_WITH_RAW_INPUT:case I.CELL_REFERENCE:case I.CELL_RANGE:case I.COLUMN_RANGE:case I.ROW_RANGE:case I.NAMED_EXPRESSION:return!1;case I.PERCENT_OP:case I.PLUS_UNARY_OP:case I.MINUS_UNARY_OP:return a(t.value,e);case I.CONCATENATE_OP:case I.EQUALS_OP:case I.NOT_EQUAL_OP:case I.LESS_THAN_OP:case I.GREATER_THAN_OP:case I.LESS_THAN_OR_EQUAL_OP:case I.GREATER_THAN_OR_EQUAL_OP:case I.MINUS_OP:case I.PLUS_OP:case I.TIMES_OP:case I.DIV_OP:case I.POWER_OP:return a(t.left,e)||a(t.right,e);case I.PARENTHESIS:return a(t.expression,e);case I.FUNCTION_CALL:return e(t.procedureName)?!0:t.args.some(function(r){return a(r,e)});case I.ARRAY:return t.args.some(function(r){return r.some(function(n){return a(n,e)})})}};var FFe=M(ie());var Vse=he(),Ose=TP();Vse({target:"Number",stat:!0},{isInteger:Ose});var Dse=he(),Ise=Br(),Pse=zt(),_se=Wt(),kse=AP(),Fse=Vi(),jse=Hm();function SP(a,t){var e=arguments.length<3?a:arguments[2],r,n;if(_se(a)===e)return a[t];if(r=Fse.f(a,t),r)return kse(r)?r.value:r.get===void 0?void 0:Ise(r.get,e);if(Pse(n=jse(a)))return SP(n,t,e)}Dse({target:"Reflect",stat:!0},{get:SP});var Mse=he(),Bse=De(),Lse=Hn(),wP=Vi().f,EP=sr(),Use=Bse(function(){wP(1)}),zse=!EP||Use;Mse({target:"Object",stat:!0,forced:zse,sham:!EP},{getOwnPropertyDescriptor:function(t,e){return wP(Lse(t),e)}});var ZFe=M(q());Zb();function RP(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Gse(a,t,e){return t&&RP(a.prototype,t),e&&RP(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Hse(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var D=Gse(function a(){Hse(this,a)});D.DistinctSigns="Distinct signs.";D.WrongArgNumber="Wrong number of arguments.";D.EmptyArg="Empty function argument.";D.EmptyArray="Empty array not allowed.";D.ArrayDimensions="Array dimensions are not compatible.";D.NoSpaceForArrayResult="No space for array result.";D.ValueSmall="Value too small.";D.ValueLarge="Value too large.";D.BadCriterion="Incorrect criterion.";D.RangeManySheets="Range spans more than one sheet.";D.CellRangeExpected="Cell range expected.";D.WrongDimension="Wrong range dimension.";D.ScalarExpected="Cell range not allowed.";D.NumberCoercion="Value cannot be coerced to number.";D.NumberExpected="Number argument expected.";D.IntegerExpected="Value needs to be an integer.";D.BadMode="Mode not recognized.";D.DateBounds="Date outside of bounds.";D.OutOfSheet="Resulting reference is out of the sheet.";D.WrongType="Wrong type of argument.";D.NaN="NaN or infinite value encountered.";D.EqualLength="Ranges need to be of equal length.";D.Negative="Value cannot be negative.";D.NotBinary="String does not represent a binary number.";D.NotOctal="String does not represent an octal number.";D.NotHex="String does not represent a hexadecimal number.";D.EndStartPeriod="End period needs to be at least start period.";D.CellRefExpected="Cell reference expected.";D.EmptyRange="Empty range not allowed.";D.BadRef="Address is not correct.";D.NumberRange="Number-only range expected.";D.ValueNotFound="Value not found.";D.ValueBaseLarge="Value in base too large.";D.ValueBaseSmall="Value in base too small.";D.ValueBaseLong="Value in base too long.";D.NegativeLength="Length cannot be negative.";D.PatternNotFound="Pattern not found.";D.OneValue="Needs at least one value.";D.TwoValues="Range needs to contain at least two elements.";D.ThreeValues="Range needs to contain at least three elements.";D.IndexBounds="Index out of bounds.";D.IndexLarge="Index too large.";D.Formula="Expected formula.";D.NegativeCount="Count cannot be negative.";D.ParseError="Parsing error.";D.SheetRef="Sheet does not exist.";D.PeriodLong="Period number cannot exceed life length.";D.InvalidDate="Invalid date.";D.BitshiftLong="Result of bitshift is too long.";D.EmptyString="Empty-string argument not allowed.";D.LengthBounds="Length out of bounds.";D.NegativeTime="Time cannot be negative.";D.NoDefault="No default option.";D.Selector="Selector cannot exceed the number of arguments.";D.StartEndDate="Start date needs to be earlier than end date.";D.IncorrectDateTime="String does not represent correct DateTime.";D.CharacterCodeBounds="Character code out of bounds.";D.NonZero="Argument cannot be 0.";D.LessThanOne="Argument cannot be less than 1.";D.WeekendString="Incorrect weekend bitmask string.";D.InvalidRoman="Invalid roman numeral.";D.WrongOrder="Wrong order of values.";D.ComplexNumberExpected="Complex number expected.";D.ShouldBeIorJ="Should be 'i' or 'j'.";D.SizeMismatch="Array dimensions mismatched.";D.FunctionName=function(a){return"Function name ".concat(a," not recognized.")};D.NamedExpressionName=function(a){return"Named expression ".concat(a," not recognized.")};D.LicenseKey=function(a){return"License key is ".concat(a,".")};function oA(a){return oA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oA(a)}function xP(a,t){return Kse(a)||$se(a,t)||Wse(a,t)||qse()}function qse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wse(a,t){if(!!a){if(typeof a=="string")return VP(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return VP(a,t)}}function VP(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function $se(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Kse(a){if(Array.isArray(a))return a}function OP(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function DP(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function IP(a,t,e){return t&&DP(a.prototype,t),e&&DP(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function ig(){return typeof Reflect!="undefined"&&Reflect.get?ig=Reflect.get:ig=function(t,e,r){var n=Xse(t,e);if(!!n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},ig.apply(this,arguments)}function Xse(a,t){for(;!Object.prototype.hasOwnProperty.call(a,t)&&(a=Ic(a),a!==null););return a}function Yse(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&lA(a,t)}function lA(a,t){return lA=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},lA(a,t)}function Zse(a){var t=eoe();return function(){var r=Ic(a),n;if(t){var i=Ic(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Jse(this,n)}}function Jse(a,t){if(t&&(oA(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qse(a)}function Qse(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function eoe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Ic(a){return Ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ic(a)}var PP=function(a){Yse(e,a);var t=Zse(e);function e(r,n){var i;return OP(this,e),i=t.call(this,r.allTokens,{outputCst:!1,maxLookahead:7}),i.booleanExpressionOrEmpty=i.RULE("booleanExpressionOrEmpty",function(){return i.OR([{ALT:function(){return i.SUBRULE(i.booleanExpression)}},{ALT:_6(K9())}])}),i.procedureExpression=i.RULE("procedureExpression",function(){var s,o=i.CONSUME(Lf),l=o.image.toUpperCase().slice(0,-1),u=(s=i.lexerConfig.functionMapping[l])!==null&&s!==void 0?s:l,c=[],p=i.SUBRULE(i.booleanExpressionOrEmpty);i.MANY(function(){var f,d=i.CONSUME(i.lexerConfig.ArgSeparator);p.type===I.EMPTY&&(p.leadingWhitespace=(f=d.leadingWhitespace)===null||f===void 0?void 0:f.image),c.push(p),p=i.SUBRULE2(i.booleanExpressionOrEmpty)}),c.push(p),c.length===1&&c[0].type===I.EMPTY&&(c.length=0);var m=i.CONSUME(Bf);return aA(u,c,o.leadingWhitespace,m.leadingWhitespace)}),i.namedExpressionExpression=i.RULE("namedExpressionExpression",function(){var s=i.CONSUME(X6);return dP(s.image,s.leadingWhitespace)}),i.offsetProcedureExpression=i.RULE("offsetProcedureExpression",function(){var s=[];return i.CONSUME(i.lexerConfig.OffsetProcedureName),i.CONSUME(rg),i.MANY_SEP({SEP:i.lexerConfig.ArgSeparator,DEF:function(){s.push(i.SUBRULE(i.booleanExpression))}}),i.CONSUME(Bf),i.handleOffsetHeuristic(s)}),i.columnRangeExpression=i.RULE("columnRangeExpression",function(){var s=i.CONSUME(jf),o=s.image.split(":"),l=xP(o,2),u=l[0],c=l[1],p=i.ACTION(function(){return xc(i.sheetMapping,u,i.formulaAddress)}),m=i.ACTION(function(){return xc(i.sheetMapping,c,i.formulaAddress)});if(p===void 0||m===void 0)return In(new E(V.REF));if(p.exceedsSheetSizeLimits(i.lexerConfig.maxColumns)||m.exceedsSheetSizeLimits(i.lexerConfig.maxColumns))return al(s.image,new E(V.NAME),s.leadingWhitespace);if(p.sheet===void 0&&m.sheet!==void 0)return i.parsingError(bt.ParserError,"Malformed range expression");var f=i.rangeSheetReferenceType(p.sheet,m.sheet);return p.sheet!==void 0&&m.sheet===void 0&&(m=m.withAbsoluteSheet(p.sheet)),Z9(p,m,f,s.leadingWhitespace)}),i.rowRangeExpression=i.RULE("rowRangeExpression",function(){var s=i.CONSUME(Mf),o=s.image.split(":"),l=xP(o,2),u=l[0],c=l[1],p=i.ACTION(function(){return Vc(i.sheetMapping,u,i.formulaAddress)}),m=i.ACTION(function(){return Vc(i.sheetMapping,c,i.formulaAddress)});if(p===void 0||m===void 0)return In(new E(V.REF));if(p.exceedsSheetSizeLimits(i.lexerConfig.maxRows)||m.exceedsSheetSizeLimits(i.lexerConfig.maxRows))return al(s.image,new E(V.NAME),s.leadingWhitespace);if(p.sheet===void 0&&m.sheet!==void 0)return i.parsingError(bt.ParserError,"Malformed range expression");var f=i.rangeSheetReferenceType(p.sheet,m.sheet);return p.sheet!==void 0&&m.sheet===void 0&&(m=m.withAbsoluteSheet(p.sheet)),J9(p,m,f,s.leadingWhitespace)}),i.cellReference=i.RULE("cellReference",function(){var s=i.CONSUME(ei),o=i.ACTION(function(){return Xi(i.sheetMapping,s.image,i.formulaAddress)});return o===void 0?al(s.image,new E(V.REF),s.leadingWhitespace):o.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)?al(s.image,new E(V.NAME),s.leadingWhitespace):nA(o,s.leadingWhitespace)}),i.endRangeReference=i.RULE("endRangeReference",function(s){var o,l=i.CONSUME(ei),u=i.ACTION(function(){return Xi(i.sheetMapping,s.image,i.formulaAddress)}),c=i.ACTION(function(){return Xi(i.sheetMapping,l.image,i.formulaAddress)});return u===void 0||c===void 0?i.ACTION(function(){return al("".concat(s.image,":").concat(l.image),new E(V.REF),s.leadingWhitespace)}):u.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)||c.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)?i.ACTION(function(){return al("".concat(s.image,":").concat(l.image),new E(V.NAME),s.leadingWhitespace)}):i.buildCellRange(u,c,(o=s.leadingWhitespace)===null||o===void 0?void 0:o.image)}),i.endOfRangeExpression=i.RULE("endOfRangeExpression",function(s){return i.OR([{ALT:function(){return i.SUBRULE(i.endRangeReference,{ARGS:[s]})}},{ALT:function(){var l,u=i.SUBRULE(i.offsetProcedureExpression),c=i.ACTION(function(){return Xi(i.sheetMapping,s.image,i.formulaAddress)});if(c===void 0)return In(new E(V.REF));if(u.type===I.CELL_REFERENCE){var p=u.reference,m=cr.RELATIVE;return c.sheet!==void 0&&(m=cr.START_ABSOLUTE,p=p.withAbsoluteSheet(c.sheet)),Oc(c,p,m,(l=s.leadingWhitespace)===null||l===void 0?void 0:l.image)}else return i.parsingError(bt.RangeOffsetNotAllowed,"Range offset not allowed here")}}])}),i.cellRangeExpression=i.RULE("cellRangeExpression",function(){var s=i.CONSUME(ei);return i.CONSUME2(Rc),i.SUBRULE(i.endOfRangeExpression,{ARGS:[s]})}),i.endRangeWithOffsetStartReference=i.RULE("endRangeWithOffsetStartReference",function(s){var o=i.CONSUME(ei),l=i.ACTION(function(){return Xi(i.sheetMapping,o.image,i.formulaAddress)});return l===void 0?i.ACTION(function(){return In(new E(V.REF))}):i.buildCellRange(s.reference,l,s.leadingWhitespace)}),i.endOfRangeWithOffsetStartExpression=i.RULE("endOfRangeWithOffsetStartExpression",function(s){return i.OR([{ALT:function(){return i.SUBRULE(i.endRangeWithOffsetStartReference,{ARGS:[s]})}},{ALT:function(){var l=i.SUBRULE(i.offsetProcedureExpression);if(l.type===I.CELL_REFERENCE){var u=l.reference,c=cr.RELATIVE;return s.reference.sheet!==void 0&&(c=cr.START_ABSOLUTE,u=u.withAbsoluteSheet(s.reference.sheet)),Oc(s.reference,u,c,s.leadingWhitespace)}else return i.parsingError(bt.RangeOffsetNotAllowed,"Range offset not allowed here")}}])}),i.offsetExpression=i.RULE("offsetExpression",function(){var s=i.SUBRULE(i.offsetProcedureExpression),o;return i.OPTION(function(){i.CONSUME(Rc),s.type===I.CELL_RANGE?o=i.parsingError(bt.RangeOffsetNotAllowed,"Range offset not allowed here"):o=i.SUBRULE(i.endOfRangeWithOffsetStartExpression,{ARGS:[s]})}),o!==void 0?o:s}),i.insideArrayExpression=i.RULE("insideArrayExpression",function(){var s=[[]];return s[s.length-1].push(i.SUBRULE(i.booleanExpression)),i.MANY(function(){i.OR([{ALT:function(){i.CONSUME(i.lexerConfig.ArrayColSeparator),s[s.length-1].push(i.SUBRULE2(i.booleanExpression))}},{ALT:function(){i.CONSUME(i.lexerConfig.ArrayRowSeparator),s.push([]),s[s.length-1].push(i.SUBRULE3(i.booleanExpression))}}])}),iA(s)}),i.parenthesisExpression=i.RULE("parenthesisExpression",function(){var s=i.CONSUME(rg),o=i.SUBRULE(i.booleanExpression),l=i.CONSUME(Bf);return hP(o,s.leadingWhitespace,l.leadingWhitespace)}),i.arrayExpression=i.RULE("arrayExpression",function(){return i.OR([{ALT:function(){var o=i.CONSUME($6),l=i.SUBRULE(i.insideArrayExpression),u=i.CONSUME(K6);return iA(l.args,o.leadingWhitespace,u.leadingWhitespace)}},{ALT:function(){return i.SUBRULE(i.parenthesisExpression)}}])}),i.numericStringToNumber=function(s){var o=s.replace(i.lexerConfig.decimalSeparator,".");return Number(o)},i.positiveAtomicExpression=i.RULE("positiveAtomicExpression",function(){var s;return i.OR((s=i.atomicExpCache)!==null&&s!==void 0?s:i.atomicExpCache=[{ALT:function(){return i.SUBRULE(i.arrayExpression)}},{ALT:function(){return i.SUBRULE(i.cellRangeExpression)}},{ALT:function(){return i.SUBRULE(i.columnRangeExpression)}},{ALT:function(){return i.SUBRULE(i.rowRangeExpression)}},{ALT:function(){return i.SUBRULE(i.offsetExpression)}},{ALT:function(){return i.SUBRULE(i.cellReference)}},{ALT:function(){return i.SUBRULE(i.procedureExpression)}},{ALT:function(){return i.SUBRULE(i.namedExpressionExpression)}},{ALT:function(){var l=i.CONSUME(i.lexerConfig.NumberLiteral);return X9(i.numericStringToNumber(l.image),l.leadingWhitespace)}},{ALT:function(){var l=i.CONSUME(Y6);return Y9(l)}},{ALT:function(){var l=i.CONSUME(Z6),u=l.image.toUpperCase(),c=i.lexerConfig.errorMapping[u];return c?In(new E(c),l.leadingWhitespace):i.parsingError(bt.ParserError,"Unknown error literal")}}])}),i.rightUnaryOpAtomicExpression=i.RULE("rightUnaryOpAtomicExpression",function(){var s=i.SUBRULE(i.positiveAtomicExpression),o=i.OPTION(function(){return i.CONSUME(B6)});return o?fP(s,o.leadingWhitespace):s}),i.atomicExpression=i.RULE("atomicExpression",function(){return i.OR([{ALT:function(){var o=i.CONSUME(Ec),l=i.SUBRULE(i.atomicExpression);return Ue(o,Jb)?mP(l,o.leadingWhitespace):Ue(o,Qb)?pP(l,o.leadingWhitespace):(i.customParsingError=rA(bt.ParserError,"Mismatched token type"),i.customParsingError)}},{ALT:function(){return i.SUBRULE2(i.rightUnaryOpAtomicExpression)}}])}),i.powerExpression=i.RULE("powerExpression",function(){var s=i.SUBRULE(i.atomicExpression);return i.MANY(function(){var o=i.CONSUME(eg),l=i.SUBRULE2(i.atomicExpression);Ue(o,eg)?s=cP(s,l,o.leadingWhitespace):i.ACTION(function(){throw Error("Operator not supported")})}),s}),i.multiplicationExpression=i.RULE("multiplicationExpression",function(){var s=i.SUBRULE(i.powerExpression);return i.MANY(function(){var o=i.CONSUME(Ff),l=i.SUBRULE2(i.powerExpression);Ue(o,j6)?s=lP(s,l,o.leadingWhitespace):Ue(o,M6)?s=uP(s,l,o.leadingWhitespace):i.ACTION(function(){throw Error("Operator not supported")})}),s}),i.additionExpression=i.RULE("additionExpression",function(){var s=i.SUBRULE(i.multiplicationExpression);return i.MANY(function(){var o=i.CONSUME(Ec),l=i.SUBRULE2(i.multiplicationExpression);Ue(o,Jb)?s=sP(s,l,o.leadingWhitespace):Ue(o,Qb)?s=oP(s,l,o.leadingWhitespace):i.ACTION(function(){throw Error("Operator not supported")})}),s}),i.concatenateExpression=i.RULE("concatenateExpression",function(){var s=i.SUBRULE(i.additionExpression);return i.MANY(function(){var o=i.CONSUME(q6),l=i.SUBRULE2(i.additionExpression);s=Q9(s,l,o.leadingWhitespace)}),s}),i.booleanExpression=i.RULE("booleanExpression",function(){var s=i.SUBRULE(i.concatenateExpression);return i.MANY(function(){var o=i.CONSUME(Wi),l=i.SUBRULE2(i.concatenateExpression);Ue(o,tg)?s=eP(s,l,o.leadingWhitespace):Ue(o,L6)?s=tP(s,l,o.leadingWhitespace):Ue(o,U6)?s=rP(s,l,o.leadingWhitespace):Ue(o,z6)?s=nP(s,l,o.leadingWhitespace):Ue(o,G6)?s=aP(s,l,o.leadingWhitespace):Ue(o,H6)?s=iP(s,l,o.leadingWhitespace):i.ACTION(function(){throw Error("Operator not supported")})}),s}),i.formula=i.RULE("formula",function(){return i.CONSUME(tg),i.SUBRULE(i.booleanExpression)}),i.lexerConfig=r,i.sheetMapping=n,i.formulaAddress=$(0,0,0),i.performSelfAnalysis(),i}return IP(e,[{key:"parseFromTokens",value:function(n,i){this.input=n;var s=this.formulaWithContext(i),o=[];return this.customParsingError&&o.push(this.customParsingError),o=o.concat(this.errors.map(function(l){return{type:bt.ParserError,message:l.message}})),o.length>0&&(s=Dc()),{ast:s,errors:o}}},{key:"reset",value:function(){ig(Ic(e.prototype),"reset",this).call(this),this.customParsingError=void 0}},{key:"formulaWithContext",value:function(n){return this.formulaAddress=n,this.formula()}},{key:"buildCellRange",value:function(n,i,s){if(n.sheet===void 0&&i.sheet!==void 0)return this.parsingError(bt.ParserError,"Malformed range expression");var o=this.rangeSheetReferenceType(n.sheet,i.sheet);return n.sheet!==void 0&&i.sheet===void 0&&(i=i.withAbsoluteSheet(n.sheet)),Oc(n,i,o,s)}},{key:"handleOffsetHeuristic",value:function(n){var i=n[0];if(i.type!==I.CELL_REFERENCE)return this.parsingError(bt.StaticOffsetError,"First argument to OFFSET is not a reference");var s=n[1],o;if(s.type===I.NUMBER&&Number.isInteger(s.value))o=s.value;else if(s.type===I.PLUS_UNARY_OP&&s.value.type===I.NUMBER&&Number.isInteger(s.value.value))o=s.value.value;else if(s.type===I.MINUS_UNARY_OP&&s.value.type===I.NUMBER&&Number.isInteger(s.value.value))o=-s.value.value;else return this.parsingError(bt.StaticOffsetError,"Second argument to OFFSET is not a static number");var l=n[2],u;if(l.type===I.NUMBER&&Number.isInteger(l.value))u=l.value;else if(l.type===I.PLUS_UNARY_OP&&l.value.type===I.NUMBER&&Number.isInteger(l.value.value))u=l.value.value;else if(l.type===I.MINUS_UNARY_OP&&l.value.type===I.NUMBER&&Number.isInteger(l.value.value))u=-l.value.value;else return this.parsingError(bt.StaticOffsetError,"Third argument to OFFSET is not a static number");var c=n[3],p;if(c===void 0)p=1;else if(c.type===I.NUMBER){if(p=c.value,p<1)return this.parsingError(bt.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(p))return this.parsingError(bt.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(bt.StaticOffsetError,"Fourth argument to OFFSET is not a static number");var m=n[4],f;if(m===void 0)f=1;else if(m.type===I.NUMBER){if(f=m.value,f<1)return this.parsingError(bt.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(f))return this.parsingError(bt.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(bt.StaticOffsetError,"Fifth argument to OFFSET is not a static number");var d=new Lr(i.reference.col+u,i.reference.row+o,i.reference.type),h=d.col,y=d.row;if((i.reference.type===Ke.CELL_REFERENCE_RELATIVE||i.reference.type===Ke.CELL_REFERENCE_ABSOLUTE_COL)&&(y=y+this.formulaAddress.row),(i.reference.type===Ke.CELL_REFERENCE_RELATIVE||i.reference.type===Ke.CELL_REFERENCE_ABSOLUTE_ROW)&&(h=h+this.formulaAddress.col),h<0||y<0)return In(new E(V.REF,D.OutOfSheet));if(f===1&&p===1)return nA(d);var b=new Lr(d.col+f-1,d.row+p-1,d.type);return Oc(d,b,cr.RELATIVE)}},{key:"parsingError",value:function(n,i){return this.customParsingError=rA(n,i),Dc()}},{key:"rangeSheetReferenceType",value:function(n,i){return n===void 0?cr.RELATIVE:i===void 0?cr.START_ABSOLUTE:cr.BOTH_ABSOLUTE}}]),e}(k6),uA=function(){function a(t){OP(this,a),this.lexerConfig=t,this.lexer=new Jt(t.allTokens,{ensureOptimizations:!0})}return IP(a,[{key:"tokenizeFormula",value:function(e){var r=this.lexer.tokenize(e),n=r.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),r.tokens=n,r}},{key:"skipWhitespacesInsideRanges",value:function(e){return this.filterTokensByNeighbors(e,function(r,n,i){return(Ue(r,ei)||Ue(r,Rc))&&Ue(n,Ki)&&(Ue(i,ei)||Ue(i,Rc))})}},{key:"skipWhitespacesBeforeArgSeparators",value:function(e){var r=this;return this.filterTokensByNeighbors(e,function(n,i,s){return!Ue(n,r.lexerConfig.ArgSeparator)&&Ue(i,Ki)&&Ue(s,r.lexerConfig.ArgSeparator)})}},{key:"filterTokensByNeighbors",value:function(e,r){if(e.length<3)return e;for(var n=0,i=[e[n++]];n<e.length-1;)r(e[n-1],e[n],e[n+1])||i.push(e[n]),++n;return i.push(e[n]),i}},{key:"trimTrailingWhitespaces",value:function(e){return e.length>0&&Ue(e[e.length-1],Ki)&&e.pop(),e}}]),a}();var hje=M(ie());function toe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function _P(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function roe(a,t,e){return t&&_P(a.prototype,t),e&&_P(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Hf=function(){function a(t,e,r,n){toe(this,a),this.config=t,this.lexerConfig=e,this.sheetMappingFn=r,this.namedExpressions=n}return roe(a,[{key:"unparse",value:function(e,r){return"="+this.unparseAst(e,r)}},{key:"unparseAst",value:function(e,r){var n=this,i,s;switch(e.type){case I.EMPTY:return _e("",e.leadingWhitespace);case I.NUMBER:return _e(cA(e.value,this.config.decimalSeparator),e.leadingWhitespace);case I.STRING:return _e('"'+e.value+'"',e.leadingWhitespace);case I.FUNCTION_CALL:{var o=e.args.map(function(A){return A!==void 0?n.unparseAst(A,r):""}).join(this.config.functionArgSeparator),l=this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName,u=l+"("+o+_e(")",e.internalWhitespace);return _e(u,e.leadingWhitespace)}case I.NAMED_EXPRESSION:{var c=(i=this.namedExpressions.nearestNamedExpression(e.expressionName,r.sheet))===null||i===void 0?void 0:i.displayName;return _e(c||e.expressionName,e.leadingWhitespace)}case I.CELL_REFERENCE:{var p;return e.reference.sheet!==void 0?p=this.unparseSheetName(e.reference.sheet)+"!":p="",p+=(s=e.reference.unparse(r))!==null&&s!==void 0?s:this.config.translationPackage.getErrorTranslation(V.REF),_e(p,e.leadingWhitespace)}case I.COLUMN_RANGE:case I.ROW_RANGE:case I.CELL_RANGE:return _e(this.formatRange(e,r),e.leadingWhitespace);case I.PLUS_UNARY_OP:{var m=this.unparseAst(e.value,r);return _e("+",e.leadingWhitespace)+m}case I.MINUS_UNARY_OP:{var f=this.unparseAst(e.value,r);return _e("-",e.leadingWhitespace)+f}case I.PERCENT_OP:return this.unparseAst(e.value,r)+_e("%",e.leadingWhitespace);case I.ERROR:{var d=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:V.ERROR);return _e(d,e.leadingWhitespace)}case I.ERROR_WITH_RAW_INPUT:return _e(e.rawInput,e.leadingWhitespace);case I.PARENTHESIS:{var h=this.unparseAst(e.expression,r),y="("+h+_e(")",e.internalWhitespace);return _e(y,e.leadingWhitespace)}case I.ARRAY:{var b="{"+e.args.map(function(A){return A.map(function(C){return n.unparseAst(C,r)}).join(n.config.arrayColumnSeparator)}).join(this.config.arrayRowSeparator)+_e("}",e.internalWhitespace);return _e(b,e.leadingWhitespace)}default:{var g=this.unparseAst(e.left,r),v=this.unparseAst(e.right,r);return g+_e(ag[e.type],e.leadingWhitespace)+v}}}},{key:"unparseSheetName",value:function(e){var r=tA(e,this.sheetMappingFn);if(r===void 0)throw new tt(e);return r}},{key:"formatRange",value:function(e,r){var n="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==cr.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===cr.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");var s=e.start.unparse(r),o=e.end.unparse(r);return s===void 0||o===void 0?this.config.translationPackage.getErrorTranslation(V.REF):"".concat(n).concat(s,":").concat(i).concat(o)}}]),a}();function cA(a,t){var e=a.toString();return e.replace(".",t)}function kP(a,t){return soe(a)||ioe(a,t)||aoe(a,t)||noe()}function noe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aoe(a,t){if(!!a){if(typeof a=="string")return FP(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return FP(a,t)}}function FP(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function ioe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function soe(a){if(Array.isArray(a))return a}function ooe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function jP(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function loe(a,t,e){return t&&jP(a.prototype,t),e&&jP(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var pA=function(){function a(t,e,r){ooe(this,a),this.config=t,this.functionRegistry=e,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=rl(t),this.lexer=new uA(this.lexerConfig),this.formulaParser=new PP(this.lexerConfig,this.sheetMapping),this.cache=new bP(this.functionRegistry)}return loe(a,[{key:"parse",value:function(e,r){var n=this.lexer.tokenizeFormula(e);if(n.errors.length>0){var i=n.errors.map(function(h){return{type:bt.LexingError,message:h.message}});return{ast:Dc(),errors:i,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}var s=this.computeHashFromTokens(n.tokens,r),o=this.cache.get(s);if(o!==void 0)++this.statsCacheUsed;else{var l=uoe(n.tokens),u=this.formulaParser.parseFromTokens(l,r);if(u.errors.length>0)return Object.assign(Object.assign({},u),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(s,u.ast)}var c=o,p=c.ast,m=c.hasVolatileFunction,f=c.hasStructuralChangeFunction,d=c.relativeDependencies;return{ast:p,errors:[],hasVolatileFunction:m,hasStructuralChangeFunction:f,dependencies:d}}},{key:"fetchCachedResultForAst",value:function(e){var r=this.computeHashFromAst(e);return this.fetchCachedResult(r)}},{key:"fetchCachedResult",value:function(e){var r=this.cache.get(e);if(r===void 0)throw new Error("There is no AST with such key in the cache");var n=r.ast,i=r.hasVolatileFunction,s=r.hasStructuralChangeFunction,o=r.relativeDependencies;return{ast:n,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}}},{key:"computeHashFromTokens",value:function(e,r){for(var n,i="",s=0;s<e.length;){var o=e[s];if(Ue(o,ei)){var l=Xi(this.sheetMapping,o.image,r);l===void 0?i=i.concat(o.image):i=i.concat(l.hash(!0))}else if(Ue(o,Lf)){var u=o.image.toUpperCase().slice(0,-1),c=(n=this.lexerConfig.functionMapping[u])!==null&&n!==void 0?n:u;i=i.concat(c,"(")}else if(Ue(o,jf)){var p=o.image.split(":"),m=kP(p,2),f=m[0],d=m[1],h=xc(this.sheetMapping,f,r),y=xc(this.sheetMapping,d,r);h===void 0||y===void 0?i=i.concat("!REF"):i=i.concat(h.hash(!0),":",y.hash(!0))}else if(Ue(o,Mf)){var b=o.image.split(":"),g=kP(b,2),v=g[0],A=g[1],C=Vc(this.sheetMapping,v,r),S=Vc(this.sheetMapping,A,r);C===void 0||S===void 0?i=i.concat("!REF"):i=i.concat(C.hash(!0),":",S.hash(!0))}else i=i.concat(o.image);s++}return i}},{key:"rememberNewAst",value:function(e){var r=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(r,e)}},{key:"computeHashFromAst",value:function(e){return"="+this.computeHashOfAstNode(e)}},{key:"computeHashOfAstNode",value:function(e){var r=this;switch(e.type){case I.EMPTY:return e.leadingWhitespace||"";case I.NUMBER:return _e(cA(e.value,this.config.decimalSeparator),e.leadingWhitespace);case I.STRING:return _e('"'+e.value+'"',e.leadingWhitespace);case I.NAMED_EXPRESSION:return _e(e.expressionName,e.leadingWhitespace);case I.FUNCTION_CALL:{var n=e.args.map(function(m){return r.computeHashOfAstNode(m)}).join(this.config.functionArgSeparator),i=e.procedureName+"("+n+_e(")",e.internalWhitespace);return _e(i,e.leadingWhitespace)}case I.CELL_REFERENCE:return _e(e.reference.hash(!0),e.leadingWhitespace);case I.COLUMN_RANGE:case I.ROW_RANGE:case I.CELL_RANGE:{var s=e.start.hash(e.sheetReferenceType!==cr.RELATIVE),o=e.end.hash(e.sheetReferenceType===cr.BOTH_ABSOLUTE);return _e(s+":"+o,e.leadingWhitespace)}case I.MINUS_UNARY_OP:return _e("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case I.PLUS_UNARY_OP:return _e("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case I.PERCENT_OP:return this.computeHashOfAstNode(e.value)+_e("%",e.leadingWhitespace);case I.ERROR:{var l=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:V.ERROR);return _e(l,e.leadingWhitespace)}case I.ERROR_WITH_RAW_INPUT:return _e(e.rawInput,e.leadingWhitespace);case I.ARRAY:{var u=e.args.map(function(m){return m.map(function(f){return r.computeHashOfAstNode(f)}).join(",")}).join(";");return _e("{"+u+_e("}",e.internalWhitespace),e.leadingWhitespace)}case I.PARENTHESIS:{var c=this.computeHashOfAstNode(e.expression),p="("+c+_e(")",e.internalWhitespace);return _e(p,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+_e(ag[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}}]),a}();function uoe(a){var t=[],e=a[0];Ue(e,Ki)||t.push(e);for(var r=1;r<a.length;++r){var n=a[r];if(!Ue(n,Ki)){var i=a[r-1];Ue(i,Ki)&&(n.leadingWhitespace=i),t.push(n)}}return t}var coe=function a(t,e,r,n){switch(t.type){case I.EMPTY:case I.NUMBER:case I.STRING:case I.ERROR:return;case I.NAMED_EXPRESSION:{n&&r.push(new Pn(t.expressionName));return}case I.CELL_REFERENCE:{n&&r.push(new qf(t.reference));return}case I.CELL_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new mA(t.start,t.end));return}case I.COLUMN_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new fA(t.start,t.end));return}case I.ROW_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new dA(t.start,t.end));return}case I.PERCENT_OP:case I.PLUS_UNARY_OP:case I.MINUS_UNARY_OP:{a(t.value,e,r,!0);return}case I.CONCATENATE_OP:case I.EQUALS_OP:case I.NOT_EQUAL_OP:case I.LESS_THAN_OP:case I.GREATER_THAN_OP:case I.LESS_THAN_OR_EQUAL_OP:case I.GREATER_THAN_OR_EQUAL_OP:case I.MINUS_OP:case I.PLUS_OP:case I.TIMES_OP:case I.DIV_OP:case I.POWER_OP:a(t.left,e,r,!0),a(t.right,e,r,!0);return;case I.PARENTHESIS:a(t.expression,e,r,n);return;case I.FUNCTION_CALL:{var i=!e.doesFunctionNeedArgumentToBeComputed(t.procedureName);t.args.forEach(function(s){return a(s,e,r,i)});return}}},il=function(t,e){var r=new Array;return coe(t,e,r,!0),r};function Wf(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function MP(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function $f(a,t,e){return t&&MP(a.prototype,t),e&&MP(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var qf=function(){function a(t){Wf(this,a),this.dependency=t}return $f(a,[{key:"absolutize",value:function(e){return this.dependency.toSimpleCellAddress(e)}}]),a}(),mA=function(){function a(t,e){Wf(this,a),this.start=t,this.end=e}return $f(a,[{key:"absolutize",value:function(e){return new oe(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}]),a}(),fA=function(){function a(t,e){Wf(this,a),this.start=t,this.end=e}return $f(a,[{key:"absolutize",value:function(e){var r=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new Pc(r.sheet,r.col,n.col)}}]),a}(),dA=function(){function a(t,e){Wf(this,a),this.start=t,this.end=e}return $f(a,[{key:"absolutize",value:function(e){var r=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new _c(r.sheet,r.row,n.row)}}]),a}(),Pn=function(){function a(t){Wf(this,a),this.name=t}return $f(a,[{key:"absolutize",value:function(e){return this}}]),a}();var fMe=M(xr());function BP(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function LP(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function UP(a,t,e){return t&&LP(a.prototype,t),e&&LP(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var yn=function(){function a(t,e,r){if(BP(this,a),this.sheet=t,this.rowStart=e,this.rowEnd=r,e<0)throw Error("Starting row cant be less than 0");if(r<e)throw Error("Row span cant end before start")}return UP(a,[{key:"numberOfRows",get:function(){return this.rowEnd-this.rowStart+1}},{key:"start",get:function(){return this.rowStart}},{key:"end",get:function(){return this.rowEnd}},{key:"rows",value:regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=this.rowStart;case 1:if(!(e<=this.rowEnd)){n.next=7;break}return n.next=4,e;case 4:++e,n.next=1;break;case 7:case"end":return n.stop()}},t,this)})},{key:"intersect",value:function(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");var r=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return r>n?null:new a(this.sheet,r,n)}},{key:"firstRow",value:function(){return new a(this.sheet,this.rowStart,this.rowStart)}}],[{key:"fromNumberOfRows",value:function(e,r,n){return new a(e,r,r+n-1)}},{key:"fromRowStartAndEnd",value:function(e,r,n){return new a(e,r,n)}}]),a}(),ea=function(){function a(t,e,r){if(BP(this,a),this.sheet=t,this.columnStart=e,this.columnEnd=r,e<0)throw Error("Starting column cant be less than 0");if(r<e)throw Error("Column span cant end before start")}return UP(a,[{key:"numberOfColumns",get:function(){return this.columnEnd-this.columnStart+1}},{key:"start",get:function(){return this.columnStart}},{key:"end",get:function(){return this.columnEnd}},{key:"columns",value:regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=this.columnStart;case 1:if(!(e<=this.columnEnd)){n.next=7;break}return n.next=4,e;case 4:++e,n.next=1;break;case 7:case"end":return n.stop()}},t,this)})},{key:"intersect",value:function(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");var r=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return r>n?null:new a(this.sheet,r,n)}},{key:"firstColumn",value:function(){return new a(this.sheet,this.columnStart,this.columnStart)}}],[{key:"fromNumberOfColumns",value:function(e,r,n){return new a(e,r,r+n-1)}},{key:"fromColumnStartAndEnd",value:function(e,r,n){return new a(e,r,n)}}]),a}();function zP(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&hA(a,t)}function hA(a,t){return hA=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},hA(a,t)}function GP(a){var t=foe();return function(){var r=sg(a),n;if(t){var i=sg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return poe(this,n)}}function poe(a,t){if(t&&(og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return moe(a)}function moe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function foe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function sg(a){return sg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sg(a)}function yA(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function HP(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function bA(a,t,e){return t&&HP(a.prototype,t),e&&HP(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function og(a){return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},og(a)}var doe="AbsoluteCellRange: Wrong range size";function bn(a){return a&&(og(a)==="object"||typeof a=="function")?"start"in a&&gt(a.start)&&"end"in a&&gt(a.end):!1}var Gf=function(t,e){return{start:t,end:e}},oe=function(){function a(t,e){if(yA(this,a),t.sheet!==e.sheet)throw new lc(t.sheet,e.sheet);this.start=$(t.sheet,t.col,t.row),this.end=$(e.sheet,e.col,e.row)}return bA(a,[{key:"sheet",get:function(){return this.start.sheet}},{key:"isFinite",value:function(){return Number.isFinite(this.size())}},{key:"doesOverlap",value:function(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}},{key:"addressInRange",value:function(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}},{key:"columnInRange",value:function(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}},{key:"rowInRange",value:function(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}},{key:"containsRange",value:function(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}},{key:"intersectionWith",value:function(e){if(this.sheet===e.start.sheet){var r=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),s=Math.min(this.end.col,e.end.col);if(!(r>n||i>s))return new a($(this.sheet,i,r),$(this.sheet,s,n))}}},{key:"includesRow",value:function(e){return this.start.row<e&&this.end.row>=e}},{key:"includesColumn",value:function(e){return this.start.col<e&&this.end.col>=e}},{key:"shiftByRows",value:function(e){this.start.row+=e,this.end.row+=e}},{key:"expandByRows",value:function(e){this.end.row+=e}},{key:"shiftByColumns",value:function(e){this.start.col+=e,this.end.col+=e}},{key:"shifted",value:function(e,r){return a.spanFrom($(this.sheet,this.start.col+e,this.start.row+r),this.width(),this.height())}},{key:"expandByColumns",value:function(e){this.end.col+=e}},{key:"moveToSheet",value:function(e){this.start.sheet=e,this.end.sheet=e}},{key:"removeSpan",value:function(e){e instanceof yn?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}},{key:"shouldBeRemoved",value:function(){return this.width()<=0||this.height()<=0}},{key:"rangeWithSameWidth",value:function(e,r){return a.spanFrom($(this.sheet,this.start.col,e),this.width(),r)}},{key:"rangeWithSameHeight",value:function(e,r){return a.spanFrom($(this.sheet,e,this.start.row),r,this.height())}},{key:"toString",value:function(){return"".concat(this.start.sheet,",").concat(this.start.col,",").concat(this.start.row,",").concat(this.end.col,",").concat(this.end.row)}},{key:"width",value:function(){return this.end.col-this.start.col+1}},{key:"height",value:function(){return this.end.row-this.start.row+1}},{key:"size",value:function(){return this.height()*this.width()}},{key:"arrayOfAddressesInRange",value:function(){for(var e=[],r=0;r<this.height();++r){e[r]=[];for(var n=0;n<this.width();++n){var i=$(this.sheet,this.start.col+n,this.start.row+r);e[r].push(i)}}return e}},{key:"withStart",value:function(e){return new a(e,this.end)}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"sameAs",value:function(e){return Yi(this.start,e.start)&&Yi(this.end,e.end)}},{key:"addressesArrayMap",value:function(e,r){for(var n=[],i=this.start.row;i<=this.effectiveEndRow(e);){for(var s=this.start.col,o=[];s<=this.effectiveEndColumn(e);)o.push(r($(this.start.sheet,s,i))),s++;n.push(o),i++}return n}},{key:"addresses",value:function(e){for(var r=[],n=this.start.row,i=this.effectiveEndRow(e),s=this.effectiveEndColumn(e);n<=i;){for(var o=this.start.col;o<=s;)r.push($(this.start.sheet,o,n)),o++;n++}return r}},{key:"addressesWithDirection",value:regeneratorRuntime.mark(function t(e,r,n){var i,s,o,l,u,c,p,m;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(e>0)){d.next=30;break}if(!(r>0)){d.next=16;break}i=this.effectiveEndRow(n);case 3:if(!(i>=this.start.row)){d.next=14;break}s=this.effectiveEndColumn(n);case 5:if(!(s>=this.start.col)){d.next=11;break}return d.next=8,$(this.start.sheet,s,i);case 8:s-=1,d.next=5;break;case 11:i-=1,d.next=3;break;case 14:d.next=28;break;case 16:o=this.start.row;case 17:if(!(o<=this.effectiveEndRow(n))){d.next=28;break}l=this.effectiveEndColumn(n);case 19:if(!(l>=this.start.col)){d.next=25;break}return d.next=22,$(this.start.sheet,l,o);case 22:l-=1,d.next=19;break;case 25:o+=1,d.next=17;break;case 28:d.next=57;break;case 30:if(!(r>0)){d.next=45;break}u=this.effectiveEndRow(n);case 32:if(!(u>=this.start.row)){d.next=43;break}c=this.start.col;case 34:if(!(c<=this.effectiveEndColumn(n))){d.next=40;break}return d.next=37,$(this.start.sheet,c,u);case 37:c+=1,d.next=34;break;case 40:u-=1,d.next=32;break;case 43:d.next=57;break;case 45:p=this.start.row;case 46:if(!(p<=this.effectiveEndRow(n))){d.next=57;break}m=this.start.col;case 48:if(!(m<=this.effectiveEndColumn(n))){d.next=54;break}return d.next=51,$(this.start.sheet,m,p);case 51:m+=1,d.next=48;break;case 54:p+=1,d.next=46;break;case 57:case"end":return d.stop()}},t,this)})},{key:"getAddress",value:function(e,r){if(e<0||r<0||r>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return $(this.start.sheet,this.start.col+e,this.start.row+r)}},{key:"exceedsSheetSizeLimits",value:function(e,r){return this.end.col>=e||this.end.row>=r}},{key:"effectiveEndColumn",value:function(e){return this.end.col}},{key:"effectiveEndRow",value:function(e){return this.end.row}},{key:"effectiveWidth",value:function(e){return this.width()}},{key:"effectiveHeight",value:function(e){return this.height()}},{key:"removeRows",value:function(e,r){if(!(e>this.end.row)){if(r<this.start.row){var n=r-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(r,this.end.row)-e+1}}},{key:"removeColumns",value:function(e,r){if(!(e>this.end.col)){if(r<this.start.col){var n=r-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(r,this.end.col)-e+1}}}],[{key:"fromAst",value:function(e,r){return e.type===I.CELL_RANGE?a.fromCellRange(e,r):e.type===I.COLUMN_RANGE?Pc.fromColumnRange(e,r):_c.fromRowRangeAst(e,r)}},{key:"fromAstOrUndef",value:function(e,r){try{return a.fromAst(e,r)}catch(n){return}}},{key:"fromCellRange",value:function(e,r){return new a(e.start.toSimpleCellAddress(r),e.end.toSimpleCellAddress(r))}},{key:"spanFrom",value:function(e,r,n){var i=a.spanFromOrUndef(e,r,n);if(i===void 0)throw new Error(doe);return i}},{key:"spanFromOrUndef",value:function(e,r,n){if(!Number.isFinite(r)&&Number.isFinite(n))return e.col!==0?void 0:new _c(e.sheet,e.row,e.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(r))return e.row!==0?void 0:new Pc(e.sheet,e.col,e.col+r-1);if(Number.isFinite(n)&&Number.isFinite(r))return new a(e,$(e.sheet,e.col+r-1,e.row+n-1))}},{key:"fromCoordinates",value:function(e,r,n,i,s){return new a($(e,r,n),$(e,i,s))}}]),a}(),Pc=function(a){zP(e,a);var t=GP(e);function e(r,n,i){return yA(this,e),t.call(this,$(r,n,0),$(r,i,Number.POSITIVE_INFINITY))}return bA(e,[{key:"shouldBeRemoved",value:function(){return this.width()<=0}},{key:"shiftByRows",value:function(n){}},{key:"expandByRows",value:function(n){}},{key:"shifted",value:function(n,i){return new e(this.sheet,this.start.col+n,this.end.col+n)}},{key:"rangeWithSameHeight",value:function(n,i){return new e(this.sheet,n,n+i-1)}},{key:"exceedsSheetSizeLimits",value:function(n,i){return this.end.col>=n}},{key:"effectiveEndRow",value:function(n){return this.effectiveHeight(n)-1}},{key:"effectiveHeight",value:function(n){return n.getSheetHeight(this.sheet)}},{key:"removeRows",value:function(n,i){}}],[{key:"fromColumnRange",value:function(n,i){var s=n.start.toSimpleColumnAddress(i),o=n.end.toSimpleColumnAddress(i);if(s.sheet!==o.sheet)throw new lc(s.sheet,o.sheet);return new e(s.sheet,s.col,o.col)}}]),e}(oe),_c=function(a){zP(e,a);var t=GP(e);function e(r,n,i){return yA(this,e),t.call(this,$(r,0,n),$(r,Number.POSITIVE_INFINITY,i))}return bA(e,[{key:"shouldBeRemoved",value:function(){return this.height()<=0}},{key:"shiftByColumns",value:function(n){}},{key:"expandByColumns",value:function(n){}},{key:"shifted",value:function(n,i){return new e(this.sheet,this.start.row+i,this.end.row+i)}},{key:"rangeWithSameWidth",value:function(n,i){return new e(this.sheet,n,n+i-1)}},{key:"exceedsSheetSizeLimits",value:function(n,i){return this.end.row>=i}},{key:"effectiveEndColumn",value:function(n){return this.effectiveWidth(n)-1}},{key:"effectiveWidth",value:function(n){return n.getSheetWidth(this.sheet)}},{key:"removeColumns",value:function(n,i){}}],[{key:"fromRowRangeAst",value:function(n,i){var s=n.start.toSimpleRowAddress(i),o=n.end.toSimpleRowAddress(i);if(s.sheet!==o.sheet)throw new lc(s.sheet,o.sheet);return new e(s.sheet,s.row,o.row)}}]),e}(oe);var gn=function(t,e){return t.map(function(r){return r.absolutize(e)})},qP=function(t){return t.filter(function(e){return e instanceof Pn?!0:e instanceof oe?!(Kt(e.start)||Kt(e.end)):!Kt(e)})};var xLe=M(q());var MLe=M(ie());var mLe=M(q());var gLe=M(ie());var CLe=M(xr());var eLe=M(ie());var aLe=M(q());function WP(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function hoe(a,t,e){return t&&WP(a.prototype,t),e&&WP(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function yoe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var Jr=hoe(function a(t,e,r){yoe(this,a),this.formulaAddress=t,this.arraysFlag=e,this.formulaVertex=r});var PBe=M(q());var MBe=M(ie());var rBe=M(ie());"use strict";var voe=he(),Toe=OC().trim,Noe=YP();voe({target:"String",proto:!0,forced:Noe("trim")},{trim:function(){return Toe(this)}});"use strict";var Coe=he(),Aoe=nN().includes,Soe=ac();Coe({target:"Array",proto:!0},{includes:function(t){return Aoe(this,t,arguments.length>1?arguments[1]:void 0)}});Soe("includes");var bBe=M(q());var i_=M(JP());function QP(a){var t=a.caseSensitive?a.accentSensitive?"variant":"case":a.accentSensitive?"accent":"base",e=a.caseFirst,r=a.ignorePunctuation;return new Intl.Collator(a.localeLang,{sensitivity:t,caseFirst:e,ignorePunctuation:r})}var ZMe=M(q());function vA(a){return vA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vA(a)}function Kf(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&TA(a,t)}function TA(a,t){return TA=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},TA(a,t)}function Xf(a){var t=Roe();return function(){var r=lg(a),n;if(t){var i=lg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return woe(this,n)}}function woe(a,t){if(t&&(vA(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eoe(a)}function Eoe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Roe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function lg(a){return lg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lg(a)}function kc(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function e_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Fc(a,t,e){return t&&e_(a.prototype,t),e&&e_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var le=Symbol("Empty value");function W(a){return a instanceof ti?a.val:a}var ti=function(){function a(t,e){kc(this,a),this.val=t,this.format=e}return Fc(a,[{key:"fromNumber",value:function(e){return new this.constructor(e)}}]),a}();function jc(a,t){if(typeof a=="number")return t;var e=a.fromNumber(t);return e.format=a.format,e}var Mc=function(a){Kf(e,a);var t=Xf(e);function e(){return kc(this,e),t.apply(this,arguments)}return Fc(e,[{key:"getDetailedType",value:function(){return te.NUMBER_DATE}}]),e}(ti),ug=function(a){Kf(e,a);var t=Xf(e);function e(){return kc(this,e),t.apply(this,arguments)}return Fc(e,[{key:"getDetailedType",value:function(){return te.NUMBER_CURRENCY}}]),e}(ti),Bc=function(a){Kf(e,a);var t=Xf(e);function e(){return kc(this,e),t.apply(this,arguments)}return Fc(e,[{key:"getDetailedType",value:function(){return te.NUMBER_TIME}}]),e}(ti),Lc=function(a){Kf(e,a);var t=Xf(e);function e(){return kc(this,e),t.apply(this,arguments)}return Fc(e,[{key:"getDetailedType",value:function(){return te.NUMBER_DATETIME}}]),e}(ti),Yf=function(a){Kf(e,a);var t=Xf(e);function e(){return kc(this,e),t.apply(this,arguments)}return Fc(e,[{key:"getDetailedType",value:function(){return te.NUMBER_PERCENT}}]),e}(ti);function Ce(a){return typeof a=="number"||a instanceof ti}var te;(function(a){a.NUMBER_RAW="NUMBER_RAW",a.NUMBER_DATE="NUMBER_DATE",a.NUMBER_TIME="NUMBER_TIME",a.NUMBER_DATETIME="NUMBER_DATETIME",a.NUMBER_CURRENCY="NUMBER_CURRENCY",a.NUMBER_PERCENT="NUMBER_PERCENT"})(te||(te={}));function t_(a){return a instanceof ti?a.getDetailedType():te.NUMBER_RAW}function r_(a){if(a instanceof ti)return a.format}function Zf(a){return a instanceof ti?{type:a.getDetailedType(),format:a.format}:{type:te.NUMBER_RAW}}function xoe(a,t){return Doe(a)||Ooe(a,t)||NA(a,t)||Voe()}function Voe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ooe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Doe(a){if(Array.isArray(a))return a}function n_(a){return _oe(a)||Poe(a)||NA(a)||Ioe()}function Ioe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Poe(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function _oe(a){if(Array.isArray(a))return CA(a)}function Uc(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=NA(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function NA(a,t){if(!!a){if(typeof a=="string")return CA(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return CA(a,t)}}function CA(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function koe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function a_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Foe(a,t,e){return t&&a_(a.prototype,t),e&&a_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var joe="i",Moe=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/,s_=function(){function a(t,e,r){var n=this;koe(this,a),this.config=t,this.dateTimeHelper=e,this.numberLiteralsHelper=r,this.lt=function(i,s){return n.compare(i,s)<0},this.leq=function(i,s){return n.compare(i,s)<=0},this.gt=function(i,s){return n.compare(i,s)>0},this.geq=function(i,s){return n.compare(i,s)>=0},this.eq=function(i,s){return n.compare(i,s)===0},this.neq=function(i,s){return n.compare(i,s)!==0},this.pow=function(i,s){return Math.pow(W(i),W(s))},this.addWithEpsilonRaw=function(i,s){var o=i+s;return Math.abs(o)<n.actualEps*Math.abs(i)?0:o},this.addWithEpsilon=function(i,s){var o=u_(i,s);return n.ExtendedNumberFactory(n.addWithEpsilonRaw(W(i),W(s)),o)},this.unaryMinus=function(i){return jc(i,-W(i))},this.unaryPlus=function(i){return i},this.unaryPercent=function(i){return new Yf(W(i)/100)},this.concat=function(i,s){return i.concat(s)},this.nonstrictadd=function(i,s){return i instanceof E?i:s instanceof E?s:typeof i=="number"?typeof s=="number"?n.addWithEpsilonRaw(i,s):i:typeof s=="number"?s:0},this.subtract=function(i,s){var o=u_(i,s),l=W(i),u=W(s),c=l-u;return Math.abs(c)<n.actualEps*Math.abs(l)&&(c=0),n.ExtendedNumberFactory(c,o)},this.divide=function(i,s){var o=W(i),l=W(s);if(l===0)return new E(V.DIV_BY_ZERO);var u=c_(i,s);return n.ExtendedNumberFactory(o/l,u)},this.multiply=function(i,s){var o=c_(i,s);return n.ExtendedNumberFactory(W(i)*W(s),o)},this.manyToExactComplex=function(i){var s=[],o=Uc(i),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;if(u instanceof E)return u;if(Ce(u)||typeof u=="string"){var c=n.coerceScalarToComplex(u);c instanceof E||s.push(c)}}}catch(p){o.e(p)}finally{o.f()}return s},this.coerceNumbersExactRanges=function(i){return n.manyToNumbers(i,n.manyToExactNumbers)},this.coerceNumbersCoerceRangesDropNulls=function(i){return n.manyToNumbers(i,n.manyToCoercedNumbersDropNulls)},this.manyToExactNumbers=function(i){var s=[],o=Uc(i),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;if(u instanceof E)return u;Ce(u)&&s.push(W(u))}}catch(c){o.e(c)}finally{o.f()}return s},this.manyToOnlyNumbersDropNulls=function(i){var s=[],o=Uc(i),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;if(u instanceof E)return u;if(Ce(u))s.push(W(u));else if(u!==le)return new E(V.VALUE,D.NumberExpected)}}catch(c){o.e(c)}finally{o.f()}return s},this.manyToCoercedNumbersDropNulls=function(i){var s=[],o=Uc(i),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;if(u instanceof E)return u;if(u!==le){var c=n.coerceScalarToNumberOrError(u);Ce(c)&&s.push(W(c))}}}catch(p){o.e(p)}finally{o.f()}return s},this.collator=QP(t),this.actualEps=t.smartRounding?t.precisionEpsilon:0}return Foe(a,[{key:"eqMatcherFunction",value:function(e){var r=this,n=this.buildRegex(e);return function(i){return typeof i=="string"&&n.test(r.normalizeString(i))}}},{key:"neqMatcherFunction",value:function(e){var r=this,n=this.buildRegex(e);return function(i){return typeof i!="string"||!n.test(r.normalizeString(i))}}},{key:"searchString",value:function(e,r){var n,i=this.buildRegex(e,!1),s=i.exec(r);return(n=s==null?void 0:s.index)!==null&&n!==void 0?n:-1}},{key:"requiresRegex",value:function(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(var r=0;r<e.length;r++){var n=e.charAt(r);if(Qf(n)||this.config.useRegularExpressions&&ed(n))return!0}return!1}},{key:"floatCmp",value:function(e,r){var n=W(e),i=W(r),s=1+this.actualEps;return i>=0&&n*s>=i&&n<=i*s||i<=0&&n*s<=i&&n>=i*s?0:n>i?1:-1}},{key:"coerceScalarToNumberOrError",value:function(e){var r;return e instanceof E?e:(r=this.coerceToMaybeNumber(e))!==null&&r!==void 0?r:new E(V.VALUE,D.NumberCoercion)}},{key:"coerceToMaybeNumber",value:function(e){var r;return(r=this.coerceNonDateScalarToMaybeNumber(e))!==null&&r!==void 0?r:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}},{key:"coerceNonDateScalarToMaybeNumber",value:function(e){return e===le?0:typeof e=="string"?e===""?0:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim()):Ce(e)?e:typeof e=="boolean"?Number(e):void 0}},{key:"coerceComplexExactRanges",value:function(e){var r=[],n=Uc(e),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s instanceof Q)r.push(s);else if(s!==le){var o=this.coerceScalarToComplex(s);if(o instanceof E)return o;r.push(o)}}}catch(f){n.e(f)}finally{n.f()}for(var l=[],u=0,c=r;u<c.length;u++){var p=c[u];if(p instanceof Q){var m=this.manyToExactComplex(p.valuesFromTopLeftCorner());if(m instanceof E)return m;l.push.apply(l,n_(m))}else l.push(p)}return l}},{key:"coerceScalarToComplex",value:function(e){return e instanceof E?e:e===le?[0,0]:Ce(e)?[W(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new E(V.NUM,D.ComplexNumberExpected)}},{key:"ExtendedNumberFactory",value:function(e,r){var n=r.type,i=r.format;switch(n){case te.NUMBER_RAW:return e;case te.NUMBER_CURRENCY:return new ug(e,i??this.config.currencySymbol[0]);case te.NUMBER_DATE:return new Mc(e,i);case te.NUMBER_DATETIME:return new Lc(e,i);case te.NUMBER_TIME:return new Bc(e,i);case te.NUMBER_PERCENT:return new Yf(e,i)}}},{key:"buildRegex",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e=this.normalizeString(e);var n,i=this.config.useWildcards,s=this.config.useRegularExpressions;if(s)try{RegExp(e)}catch(o){s=!1,i=!1}return s?n=zoe(e,this.config.caseSensitive):i?n=Loe(e,this.config.caseSensitive):n=Uoe(e,this.config.caseSensitive),this.config.matchWholeCell&&r?RegExp("^("+n+")$"):RegExp(n)}},{key:"normalizeString",value:function(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=p_(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}},{key:"compare",value:function(e,r){if(typeof e=="string"||typeof r=="string"){var n=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof r=="string"?this.dateTimeHelper.dateStringToDateNumber(r):r;if(Ce(n)&&Ce(i))return this.floatCmp(n,i)}return e===le?e=o_(r):r===le&&(r=o_(e)),typeof e=="string"&&typeof r=="string"?this.stringCmp(e,r):typeof e=="boolean"&&typeof r=="boolean"?l_(pg(e),pg(r)):Ce(e)&&Ce(r)?this.floatCmp(e,r):e===le&&r===le?0:l_(AA(Gc(e)),AA(Gc(r)))}},{key:"stringCmp",value:function(e,r){return this.collator.compare(e,r)}},{key:"manyToNumbers",value:function(e,r){var n=[],i=Uc(e),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;if(o instanceof Q)n.push(o);else{var l=W(this.coerceScalarToNumberOrError(o));if(l instanceof E)return l;n.push(l)}}}catch(d){i.e(d)}finally{i.f()}for(var u=[],c=0,p=n;c<p.length;c++){var m=p[c];if(m instanceof Q){var f=r(m.valuesFromTopLeftCorner());if(f instanceof E)return f;u.push.apply(u,n_(f))}else u.push(m)}return u}},{key:"coerceStringToComplex",value:function(e){var r=Moe.exec(e);if(r===null)return new E(V.NUM,D.ComplexNumberExpected);var n;if(r[6]!==void 0?n=r[1]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(r[1]+r[3],r[5]),n instanceof E||r[8]===void 0)return n;var i;return r[14]!==void 0?i=r[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(r[9]+r[11],r[13]),i instanceof E?i:r[5]!==""||r[13]===""?new E(V.NUM,D.ComplexNumberExpected):r[8]==="+"?[n[0]+i[0],n[1]+i[1]]:[n[0]-i[0],n[1]-i[1]]}},{key:"parseComplexToken",value:function(e,r){var n=W(this.coerceNonDateScalarToMaybeNumber(e));return n===void 0?new E(V.NUM,D.ComplexNumberExpected):r===""?[n,0]:[0,n]}}]),a}();function Rt(a,t){var e=xoe(a,2),r=e[0],n=e[1];if(!isFinite(r)||!isFinite(n))return new E(V.NUM,D.NaN);if(t=t??joe,n===0)return"".concat(r);var i="".concat(n===-1||n===1?"":Math.abs(n)).concat(t);return r===0?"".concat(n<0?"-":"").concat(i):"".concat(r).concat(n<0?"-":"+").concat(i)}function cg(a){return a instanceof Q?a:Q.fromScalar(a)}function pg(a){return Number(a)}function o_(a){return typeof a=="string"?"":Ce(a)?0:typeof a=="boolean"?!1:le}function mg(a){if(a instanceof E||typeof a=="boolean")return a;if(a===le)return!1;if(Ce(a))return W(a)!==0;var t=a.toUpperCase();return t==="TRUE"?!0:t==="FALSE"||t===""?!1:void 0}function Jf(a){return a instanceof E||typeof a=="string"?a:a===le?"":Ce(a)?W(a).toString():a?"TRUE":"FALSE"}function fg(a){return a===le?0:a}function l_(a,t){var e=W(a),r=W(t);return e>r?1:e<r?-1:0}function dg(a){return isNaN(a)||a===1/0||a===-1/0}function hg(a){return a===0?0:a}function Qf(a){return["*","?"].includes(a)}var Boe=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function ed(a){return Boe.includes(a)}function Loe(a,t){for(var e="",r=0;r<a.length;r++){var n=a.charAt(r);if(n==="~"){if(r==a.length-1){e+="~";continue}var i=a.charAt(r+1);Qf(i)||ed(i)?(e+="\\"+i,r++):(e+=i,r++)}else Qf(n)?e+="."+n:ed(n)?e+="\\"+n:t?e+=n:e+=n.toLowerCase()}return e}function Uoe(a,t){for(var e="",r=0;r<a.length;r++){var n=a.charAt(r);Qf(n)||ed(n)?e+="\\"+n:t?e+=n:e+=n.toLowerCase()}return e}function zoe(a,t){for(var e="",r=0;r<a.length;r++){var n=a.charAt(r);Qf(n)||ed(n)||t?e+=n:e+=n.toLowerCase()}return e}function u_(a,t){var e=Zf(a),r=e.type,n=e.format,i=Zf(t),s=i.type,o=i.format;if(r===te.NUMBER_RAW)return{type:s,format:o};if(s===te.NUMBER_RAW)return{type:r,format:n};if((r===te.NUMBER_DATETIME||r===te.NUMBER_DATE)&&(s===te.NUMBER_DATETIME||s===te.NUMBER_DATE))return{type:te.NUMBER_RAW};if(r===te.NUMBER_TIME){if(s===te.NUMBER_DATE)return{type:te.NUMBER_DATETIME,format:o+" "+n};if(s===te.NUMBER_DATETIME)return{type:te.NUMBER_DATETIME,format:o}}if(s===te.NUMBER_TIME){if(r===te.NUMBER_DATE)return{type:te.NUMBER_DATETIME,format:n+" "+o};if(r===te.NUMBER_DATETIME)return{type:te.NUMBER_DATETIME,format:n}}return{type:r,format:n}}function c_(a,t){var e=Zf(a),r=e.type,n=e.format,i=Zf(t),s=i.type,o=i.format;return r===te.NUMBER_PERCENT&&(r=te.NUMBER_RAW,n=void 0),s===te.NUMBER_PERCENT&&(s=te.NUMBER_RAW,o=void 0),r===te.NUMBER_RAW?{type:s,format:o}:s===te.NUMBER_RAW?{type:r,format:n}:{type:te.NUMBER_RAW}}function va(a){return p_(a.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function zc(a,t){var e;if(a.isAdHoc())return(e=a.data[0])===null||e===void 0?void 0:e[0];var r=a.range;if(t.formulaAddress.sheet===r.sheet){if(r.width()===1){var n=t.formulaAddress.row-r.start.row;if(n>=0&&n<r.height())return a.data[n][0]}else if(r.height()===1){var i=t.formulaAddress.col-r.start.col;if(i>=0&&i<r.width())return a.data[0][i]}}}function p_(a,t){return typeof a.normalize=="function"?a.normalize(t.toUpperCase()):i_.default[t](a)}function m_(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=SA(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function f_(a,t){return qoe(a)||Hoe(a,t)||SA(a,t)||Goe()}function Goe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hoe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function qoe(a){if(Array.isArray(a))return a}function d_(a){return Koe(a)||$oe(a)||SA(a)||Woe()}function Woe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SA(a,t){if(!!a){if(typeof a=="string")return wA(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return wA(a,t)}}function $oe(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Koe(a){if(Array.isArray(a))return wA(a)}function wA(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Xoe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function h_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Yoe(a,t,e){return t&&h_(a.prototype,t),e&&h_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var N;(function(a){a.STRING="STRING",a.NUMBER="NUMBER",a.BOOLEAN="BOOLEAN",a.SCALAR="SCALAR",a.NOERROR="NOERROR",a.RANGE="RANGE",a.INTEGER="INTEGER",a.COMPLEX="COMPLEX",a.ANY="ANY"})(N||(N={}));var X=function(){function a(t){var e=this;Xoe(this,a),this.coerceScalarToNumberOrError=function(r){return e.arithmeticHelper.coerceScalarToNumberOrError(r)},this.runFunction=function(r,n,i,s){var o,l,u,c,p,m=i.parameters,f;if(i.expandRanges?f=e.listOfScalarValues(r,n):f=r.map(function(G){return[e.evaluateAst(G,n),!1]}),i.repeatLastArgs===void 0&&m.length<f.length)return new E(V.NA,D.WrongArgNumber);if(i.repeatLastArgs!==void 0&&m.length<f.length&&(f.length-m.length)%i.repeatLastArgs!=0)return new E(V.NA,D.WrongArgNumber);for(m=d_(m);m.length<f.length;){var d;(d=m).push.apply(d,d_(m.slice(m.length-i.repeatLastArgs)))}var h=1,y=1;if(!i.vectorizationForbidden&&n.arraysFlag)for(var b=0;b<f.length;b++){var g=f_(f[b],1),v=g[0];v instanceof Q&&m[b].argumentType!==N.RANGE&&m[b].argumentType!==N.ANY&&(y=Math.max(y,v.height()),h=Math.max(h,v.width()))}for(var A=f.length;A<m.length;A++)if(((o=m[A])===null||o===void 0?void 0:o.defaultValue)===void 0&&!((l=m[A])===null||l===void 0?void 0:l.optionalArg))return new E(V.NA,D.WrongArgNumber);for(var C=[],S=0;S<y;S++){for(var w=[],x=0;x<h;x++){for(var R=void 0,O=[],_=0;_<m.length;_++){var k=(u=f[_])!==null&&u!==void 0?u:[void 0,void 0],B=f_(k,2),U=B[0],H=B[1];U instanceof Q&&m[_].argumentType!==N.RANGE&&m[_].argumentType!==N.ANY&&!i.vectorizationForbidden&&n.arraysFlag&&(U=(c=U.data[U.height()!==1?S:0])===null||c===void 0?void 0:c[U.width()!==1?x:0]);var j=U??((p=m[_])===null||p===void 0?void 0:p.defaultValue);if(j===void 0)O.push(void 0);else{var P=U!==void 0?e.coerceToType(j,m[_],n):j;P!==void 0?(P instanceof E&&m[_].argumentType!==N.SCALAR&&(R=R??P),O.push(P)):H||(R=R??new E(V.VALUE,D.WrongType))}}var F=R??e.returnNumberWrapper(s.apply(void 0,O),i.returnNumberType);if(y===1&&h===1)return F;if(F instanceof Q)throw"Function returning array cannot be vectorized.";w.push(F)}C.push(w)}return Q.onlyValues(C)},this.runFunctionWithReferenceArgument=function(r,n,i,s,o){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:function(){return new E(V.NA,D.CellRefExpected)};if(r.length===0)return e.returnNumberWrapper(s(),i.returnNumberType);if(r.length>1)return new E(V.NA,D.WrongArgNumber);for(var u=r[0];u.type===I.PARENTHESIS;)u=u.expression;var c;if(u.type===I.CELL_REFERENCE)c=u.reference.toSimpleCellAddress(n.formulaAddress);else if(u.type===I.CELL_RANGE||u.type===I.COLUMN_RANGE||u.type===I.ROW_RANGE)try{c=oe.fromAst(u,n.formulaAddress).start}catch(p){return new E(V.REF,D.CellRefExpected)}return c!==void 0?e.returnNumberWrapper(o(c),i.returnNumberType):e.runFunction(r,n,i,l)},this.interpreter=t,this.dependencyGraph=t.dependencyGraph,this.columnSearch=t.columnSearch,this.config=t.config,this.serialization=t.serialization,this.arraySizePredictor=t.arraySizePredictor,this.dateTimeHelper=t.dateTimeHelper,this.arithmeticHelper=t.arithmeticHelper}return Yoe(a,[{key:"evaluateAst",value:function(e,r){return this.interpreter.evaluateAst(e,r)}},{key:"arraySizeForAst",value:function(e,r){return this.arraySizePredictor.checkArraySizeForAst(e,r)}},{key:"listOfScalarValues",value:function(e,r){var n=[],i=m_(e),s;try{for(i.s();!(s=i.n()).done;){var o=s.value,l=this.evaluateAst(o,r);if(l instanceof Q){var u=m_(l.valuesFromTopLeftCorner()),c;try{for(u.s();!(c=u.n()).done;){var p=c.value;n.push([p,!0])}}catch(m){u.e(m)}finally{u.f()}}else n.push([l,!1])}}catch(m){i.e(m)}finally{i.f()}return n}},{key:"coerceToType",value:function(e,r,n){var i;if(e instanceof Q)switch(r.argumentType){case N.RANGE:case N.ANY:i=e;break;default:{var s=zc(e,n);if(s===void 0)return;e=s}}if(!(e instanceof Q))switch(r.argumentType){case N.INTEGER:case N.NUMBER:var o=this.coerceScalarToNumberOrError(e);if(!Ce(o)){i=o;break}var l=W(o);if(r.maxValue!==void 0&&l>r.maxValue)return new E(V.NUM,D.ValueLarge);if(r.minValue!==void 0&&l<r.minValue)return new E(V.NUM,D.ValueSmall);if(r.lessThan!==void 0&&l>=r.lessThan)return new E(V.NUM,D.ValueLarge);if(r.greaterThan!==void 0&&l<=r.greaterThan)return new E(V.NUM,D.ValueSmall);if(r.argumentType===N.INTEGER&&!Number.isInteger(l))return new E(V.NUM,D.IntegerExpected);i=o;break;case N.STRING:i=Jf(e);break;case N.BOOLEAN:i=mg(e);break;case N.SCALAR:case N.NOERROR:case N.ANY:i=e;break;case N.RANGE:if(e instanceof E)return e;i=cg(e);break;case N.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(W(e))}return r.passSubtype||i===void 0?i:W(i)}},{key:"metadata",value:function(e){var r=this.constructor.implementedFunctions[e];if(r!==void 0)return r;throw new Error("No metadata for function ".concat(e,"."))}},{key:"returnNumberWrapper",value:function(e,r,n){return r!==void 0&&Ce(e)?this.arithmeticHelper.ExtendedNumberFactory(W(e),{type:r,format:n}):e}}]),a}();function EA(a){return Qoe(a)||Joe(a)||y_(a)||Zoe()}function Zoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Joe(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Qoe(a){if(Array.isArray(a))return RA(a)}function ele(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=y_(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function y_(a,t){if(!!a){if(typeof a=="string")return RA(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return RA(a,t)}}function RA(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function b_(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function g_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function v_(a,t,e){return t&&g_(a.prototype,t),e&&g_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Se=function(){function a(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(b_(this,a),this.width=t,this.height=e,this.isRef=r,t<=0||e<=0)throw Error("Incorrect array size")}return v_(a,[{key:"isScalar",value:function(){return this.width<=1&&this.height<=1||this.isRef}}],[{key:"fromArray",value:function(e){return new a(e.length>0?e[0].length:0,e.length)}},{key:"error",value:function(){return new a(1,1,!0)}},{key:"scalar",value:function(){return new a(1,1,!1)}}]),a}();function tle(a,t){return new Se(Math.max(a.width,t.width),Math.max(a.height,t.height))}function rle(a){return new Se(a.width,a.height)}var T_=function(){function a(t,e){b_(this,a),this.config=t,this.functionRegistry=e}return v_(a,[{key:"checkArraySize",value:function(e,r){return this.checkArraySizeForAst(e,{formulaAddress:r,arraysFlag:this.config.useArrayArithmetic})}},{key:"checkArraySizeForAst",value:function(e,r){var n=this;switch(e.type){case I.FUNCTION_CALL:return this.checkArraySizeForFunction(e,r);case I.COLUMN_RANGE:case I.ROW_RANGE:case I.CELL_RANGE:{var i=oe.fromAstOrUndef(e,r.formulaAddress);return i===void 0?Se.error():new Se(i.width(),i.height(),!0)}case I.ARRAY:{var s=[],o=[],l=ele(e.args),u;try{for(l.s();!(u=l.n()).done;){var c=u.value,p=c.map(function(v){return n.checkArraySizeForAst(v,r)}),m=Math.min.apply(Math,EA(p.map(function(v){return v.height}))),f=p.reduce(function(v,A){return v+A.width},0);s.push(m),o.push(f)}}catch(v){l.e(v)}finally{l.f()}var d=s.reduce(function(v,A){return v+A},0),h=Math.min.apply(Math,o);return new Se(h,d)}case I.STRING:case I.NUMBER:return Se.scalar();case I.CELL_REFERENCE:return new Se(1,1,!0);case I.DIV_OP:case I.CONCATENATE_OP:case I.EQUALS_OP:case I.GREATER_THAN_OP:case I.GREATER_THAN_OR_EQUAL_OP:case I.LESS_THAN_OP:case I.LESS_THAN_OR_EQUAL_OP:case I.MINUS_OP:case I.NOT_EQUAL_OP:case I.PLUS_OP:case I.POWER_OP:case I.TIMES_OP:{var y=this.checkArraySizeForAst(e.left,r),b=this.checkArraySizeForAst(e.right,r);return!r.arraysFlag&&(y.height>1||y.width>1||b.height>1||b.width>1)?Se.error():tle(y,b)}case I.MINUS_UNARY_OP:case I.PLUS_UNARY_OP:case I.PERCENT_OP:{var g=this.checkArraySizeForAst(e.value,r);return!r.arraysFlag&&(g.height>1||g.width>1)?Se.error():rle(g)}case I.PARENTHESIS:return this.checkArraySizeForAst(e.expression,r);case I.EMPTY:return Se.error();default:return Se.error()}}},{key:"checkArraySizeForFunction",value:function(e,r){var n=this,i=this.functionRegistry.getMetadata(e.procedureName),s=this.functionRegistry.getArraySizeFunction(e.procedureName);if(s!==void 0)return s(e,r);var o=e.args.map(function(m){var f;return n.checkArraySizeForAst(m,new Jr(r.formulaAddress,r.arraysFlag||((f=i==null?void 0:i.arrayFunction)!==null&&f!==void 0?f:!1)))});if(i===void 0||i.expandRanges||!r.arraysFlag||i.vectorizationForbidden||i.parameters===void 0)return new Se(1,1);var l=EA(i.parameters);if(i.repeatLastArgs===void 0&&l.length<o.length||i.repeatLastArgs!==void 0&&l.length<o.length&&(o.length-l.length)%i.repeatLastArgs!=0)return Se.error();for(;l.length<o.length;)l.push.apply(l,EA(l.slice(l.length-i.repeatLastArgs)));for(var u=1,c=1,p=0;p<o.length;p++)l[p].argumentType!==N.RANGE&&l[p].argumentType!==N.ANY&&(c=Math.max(c,o[p].height),u=Math.max(u,o[p].width));return new Se(u,c)}}]),a}();function N_(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=nle(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function nle(a,t){if(!!a){if(typeof a=="string")return C_(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return C_(a,t)}}function C_(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function ale(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function A_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function ile(a,t,e){return t&&A_(a.prototype,t),e&&A_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Q=function(){function a(t,e,r,n){ale(this,a),this._data=t,this.range=e,this.dependencyGraph=r,this._hasOnlyNumbers=n,t===void 0?this.size=new Se(e.effectiveWidth(r),e.effectiveHeight(r)):this.size=new Se(t[0].length,t.length)}return ile(a,[{key:"data",get:function(){return this.ensureThatComputed(),this._data}},{key:"isAdHoc",value:function(){return this.range===void 0}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"valuesFromTopLeftCorner",value:function(){this.ensureThatComputed();for(var e=[],r=0;r<this._data.length;r++)for(var n=0;n<this._data[0].length;n++)e.push(this._data[r][n]);return e}},{key:"effectiveAddressesFromData",value:regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=0;case 1:if(!(r<this.data.length)){o.next=13;break}n=this.data[r],i=0;case 4:if(!(i<n.length)){o.next=10;break}return o.next=7,$(e.sheet,e.col+i,e.row+r);case 7:++i,o.next=4;break;case 10:++r,o.next=1;break;case 13:case"end":return o.stop()}},t,this)})},{key:"entriesFromTopLeftCorner",value:regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:this.ensureThatComputed(),r=0;case 2:if(!(r<this.size.height)){s.next=13;break}n=0;case 4:if(!(n<this.size.width)){s.next=10;break}return s.next=7,[this._data[r][n],$(e.sheet,e.col+n,e.row+r)];case 7:++n,s.next=4;break;case 10:++r,s.next=2;break;case 13:case"end":return s.stop()}},t,this)})},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(this.valuesFromTopLeftCorner(),"t0",1);case 1:case"end":return r.stop()}},t,this)})},{key:"numberOfElements",value:function(){return this.size.width*this.size.height}},{key:"hasOnlyNumbers",value:function(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;var e=N_(this.data),r;try{for(e.s();!(r=e.n()).done;){var n=r.value,i=N_(n),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;if(typeof o!="number")return this._hasOnlyNumbers=!1,!1}}catch(l){i.e(l)}finally{i.f()}}}catch(l){e.e(l)}finally{e.f()}}return this._hasOnlyNumbers}},{key:"rawNumbers",value:function(){return this._data}},{key:"rawData",value:function(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"ensureThatComputed",value:function(){var e=this;this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,function(r){var n=e.dependencyGraph.getCellValue(r);return n instanceof a?(e._hasOnlyNumbers=!1,new E(V.VALUE,D.ScalarExpected)):(Ce(n)||(e._hasOnlyNumbers=!1),n)}))}}],[{key:"fromRange",value:function(e,r,n){return new a(e,r,n,!0)}},{key:"onlyNumbers",value:function(e){return new a(e,void 0,void 0,!0)}},{key:"onlyValues",value:function(e){return new a(e,void 0,void 0,void 0)}},{key:"onlyRange",value:function(e,r){return new a(void 0,e,r,void 0)}},{key:"fromScalar",value:function(e){return new a([[e]],void 0,void 0,void 0)}}]),a}();function S_(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=sle(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function sle(a,t){if(!!a){if(typeof a=="string")return w_(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return w_(a,t)}}function w_(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function ole(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function E_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function lle(a,t,e){return t&&E_(a.prototype,t),e&&E_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Zi=function(){function a(){ole(this,a),this.changes=new Map}return lle(a,[{key:"addAll",value:function(e){var r=S_(e.changes.values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.add(i.address,i)}}catch(s){r.e(s)}finally{r.f()}return this}},{key:"addChange",value:function(e,r,n){this.addInterpreterValue(e,r,n)}},{key:"exportChanges",value:function(e){var r=[];return this.changes.forEach(function(n){var i=e.exportChange(n);Array.isArray(i)?r=r.concat(i):r.push(i)}),r}},{key:"getChanges",value:function(){return Array.from(this.changes.values())}},{key:"isEmpty",value:function(){return this.changes.size===0}},{key:"add",value:function(e,r){var n=r.value;if(n instanceof Q){var i=S_(n.effectiveAddressesFromData(e)),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;this.changes.delete("".concat(o.sheet,",").concat(o.col,",").concat(o.row))}}catch(l){i.e(l)}finally{i.f()}}this.changes.set(Hc(e),r)}},{key:"addInterpreterValue",value:function(e,r,n){this.add(r,{address:r,value:e,oldValue:n})}}],[{key:"empty",value:function(){return new a}}]),a}();var iUe=M(q());var WLe=M(q());var ue;(function(a){a.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",a.PARSER="PARSER",a.GRAPH_BUILD="GRAPH_BUILD",a.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",a.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",a.TOP_SORT="TOP_SORT",a.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",a.EVALUATION="EVALUATION",a.VLOOKUP="VLOOKUP",a.TRANSFORM_ASTS="TRANSFORM_ASTS",a.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",a.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",a.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",a.ADJUSTING_RANGES="ADJUSTING_RANGES",a.ADJUSTING_GRAPH="ADJUSTING_GRAPH",a.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",a.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(ue||(ue={}));function ule(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function R_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function cle(a,t,e){return t&&R_(a.prototype,t),e&&R_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var td=function(){function a(){ule(this,a),this.stats=new Map([[ue.CRITERION_FUNCTION_FULL_CACHE_USED,0],[ue.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}return cle(a,[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){var e,r=((e=this.stats.get(ue.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(ue.CRITERION_FUNCTION_FULL_CACHE_USED,r)}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){var e,r=((e=this.stats.get(ue.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(ue.CRITERION_FUNCTION_PARTIAL_CACHE_USED,r)}},{key:"reset",value:function(){this.stats.clear(),this.startTimes.clear(),this.stats.set(ue.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(ue.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}},{key:"start",value:function(e){if(this.startTimes.get(e))throw Error("Statistics ".concat(e," already started"));this.startTimes.set(e,Date.now())}},{key:"end",value:function(e){var r,n=Date.now(),i=this.startTimes.get(e);if(i){var s=(r=this.stats.get(e))!==null&&r!==void 0?r:0;s+=n-i,this.stats.set(e,s),this.startTimes.delete(e)}else throw Error("Statistics ".concat(e," not started"))}},{key:"measure",value:function(e,r){this.start(e);var n=r();return this.end(e),n}},{key:"snapshot",value:function(){return new Map(this.stats)}}]),a}();function xA(a){return xA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xA(a)}function ple(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function x_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function mle(a,t,e){return t&&x_(a.prototype,t),e&&x_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function fle(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&VA(a,t)}function VA(a,t){return VA=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},VA(a,t)}function dle(a){var t=ble();return function(){var r=yg(a),n;if(t){var i=yg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return hle(this,n)}}function hle(a,t){if(t&&(xA(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yle(a)}function yle(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function ble(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function yg(a){return yg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yg(a)}var OA=function(a){fle(e,a);var t=dle(e);function e(){return ple(this,e),t.apply(this,arguments)}return mle(e,[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){}},{key:"start",value:function(n){}},{key:"end",value:function(n){}}]),e}(td);var yUe=M(xr()),bUe=M(q());var Tle=he(),Nle=D_(),Cle=ac();Tle({target:"Array",proto:!0},{fill:Nle});Cle("fill");var EUe=M(ie());function Ale(a,t){return Ele(a)||wle(a,t)||I_(a,t)||Sle()}function Sle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wle(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Ele(a){if(Array.isArray(a))return a}function Rle(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=I_(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function I_(a,t){if(!!a){if(typeof a=="string")return P_(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return P_(a,t)}}function P_(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function xle(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function __(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Vle(a,t,e){return t&&__(a.prototype,t),e&&__(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var DA=function(){function a(t){xle(this,a),this.policy=t,this.mapping=new Map}return Vle(a,[{key:"getCell",value:function(e){var r=this.mapping.get(e.sheet);if(r===void 0)throw new tt(e.sheet);return r.getCell(e)}},{key:"fetchCell",value:function(e){var r=this.mapping.get(e.sheet);if(r===void 0)throw new tt(e.sheet);var n=r.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}},{key:"strategyFor",value:function(e){var r=this.mapping.get(e);if(r===void 0)throw new tt(e);return r}},{key:"addSheet",value:function(e,r){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,r)}},{key:"autoAddSheet",value:function(e,r,n){var i=n.height,s=n.width,o=n.fill,l=this.policy.call(o);this.addSheet(e,new l(s,i))}},{key:"getCellValue",value:function(e){var r=this.getCell(e);return r===void 0?le:r instanceof Ye?r.getArrayCellValue(e):r.getCellValue()}},{key:"getRawValue",value:function(e){var r=this.getCell(e);return r instanceof vn?r.getValues().rawValue:r instanceof Ye?r.getArrayCellRawValue(e):null}},{key:"setCell",value:function(e,r){var n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,r)}},{key:"moveCell",value:function(e,r){var n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==r.sheet)throw Error("Cannot move cells between sheets.");if(n.has(r))throw new Error("Cannot move cell. Destination already occupied.");var i=n.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(r,i),this.removeCell(e)}},{key:"removeCell",value:function(e){var r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.removeCell(e)}},{key:"has",value:function(e){var r=this.mapping.get(e.sheet);return r===void 0?!1:r.has(e)}},{key:"getHeight",value:function(e){var r=this.mapping.get(e);if(r===void 0)throw new tt(e);return r.getHeight()}},{key:"getWidth",value:function(e){var r=this.mapping.get(e);if(!r)throw new tt(e);return r.getWidth()}},{key:"addRows",value:function(e,r,n){var i=this.mapping.get(e);if(i===void 0)throw new tt(e);i.addRows(r,n)}},{key:"removeRows",value:function(e){var r=this.mapping.get(e.sheet);if(r===void 0)throw new tt(e.sheet);r.removeRows(e)}},{key:"removeSheet",value:function(e){this.mapping.delete(e)}},{key:"addColumns",value:function(e,r,n){var i=this.mapping.get(e);if(i===void 0)throw new tt(e);i.addColumns(r,n)}},{key:"removeColumns",value:function(e){var r=this.mapping.get(e.sheet);if(r===void 0)throw new tt(e.sheet);r.removeColumns(e)}},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(this.mapping.get(e.sheet).verticesFromRowsSpan(e),"t0",1);case 1:case"end":return n.stop()}},t,this)})},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(this.mapping.get(e.sheet).verticesFromColumnsSpan(e),"t0",1);case 1:case"end":return n.stop()}},t,this)})},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(this.mapping.get(e.sheet).entriesFromRowsSpan(e),"t0",1);case 1:case"end":return n.stop()}},t,this)})},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(this.mapping.get(e.sheet).entriesFromColumnsSpan(e),"t0",1);case 1:case"end":return n.stop()}},t,this)})},{key:"entries",value:regeneratorRuntime.mark(function t(){var e,r,n,i,s;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:e=Rle(this.mapping.entries()),l.prev=1,e.s();case 3:if((r=e.n()).done){l.next=8;break}return n=Ale(r.value,2),i=n[0],s=n[1],l.delegateYield(s.getEntries(i),"t0",6);case 6:l.next=3;break;case 8:l.next=13;break;case 10:l.prev=10,l.t1=l.catch(1),e.e(l.t1);case 13:return l.prev=13,e.f(),l.finish(13);case 16:case"end":return l.stop()}},t,this,[[1,10,13,16]])})},{key:"sheetEntries",value:regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(r=this.mapping.get(e),r===void 0){i.next=5;break}return i.delegateYield(r.getEntries(e),"t0",3);case 3:i.next=6;break;case 5:throw new tt(e);case 6:case"end":return i.stop()}},t,this)})}]),a}();var _Ue=M(xr()),kUe=M(q());var HUe=M(ie());function bg(a,t){return Ile(a)||Dle(a,t)||k_(a,t)||Ole()}function Ole(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dle(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Ile(a){if(Array.isArray(a))return a}function Ji(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=k_(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function k_(a,t){if(!!a){if(typeof a=="string")return F_(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return F_(a,t)}}function F_(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Ple(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function j_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function _le(a,t,e){return t&&j_(a.prototype,t),e&&j_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var IA=function(){function a(){Ple(this,a),this.arrayMapping=new Map}return _le(a,[{key:"getArray",value:function(e){var r=this.getArrayByCorner(e.start);if(r==null?void 0:r.getRange().sameAs(e))return r}},{key:"getArrayByCorner",value:function(e){return this.arrayMapping.get(Hc(e))}},{key:"setArray",value:function(e,r){this.arrayMapping.set(Hc(e.start),r)}},{key:"removeArray",value:function(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(Hc(e.start))}},{key:"count",value:function(){return this.arrayMapping.size}},{key:"arraysInRows",value:regeneratorRuntime.mark(function t(e){var r,n,i,s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=Ji(this.arrayMapping.entries()),u.prev=1,r.s();case 3:if((n=r.n()).done){u.next=10;break}if(i=bg(n.value,2),s=i[0],o=i[1],!o.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)){u.next=8;break}return u.next=8,[s,o];case 8:u.next=3;break;case 10:u.next=15;break;case 12:u.prev=12,u.t0=u.catch(1),r.e(u.t0);case 15:return u.prev=15,r.f(),u.finish(15);case 18:case"end":return u.stop()}},t,this,[[1,12,15,18]])})},{key:"arraysInCols",value:regeneratorRuntime.mark(function t(e){var r,n,i,s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=Ji(this.arrayMapping.entries()),u.prev=1,r.s();case 3:if((n=r.n()).done){u.next=10;break}if(i=bg(n.value,2),s=i[0],o=i[1],!o.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)){u.next=8;break}return u.next=8,[s,o];case 8:u.next=3;break;case 10:u.next=15;break;case 12:u.prev=12,u.t0=u.catch(1),r.e(u.t0);case 15:return u.prev=15,r.f(),u.finish(15);case 18:case"end":return u.stop()}},t,this,[[1,12,15,18]])})},{key:"isFormulaArrayInRow",value:function(e,r){var n=Ji(this.arrayMapping.values()),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s.spansThroughSheetRows(e,r))return!0}}catch(o){n.e(o)}finally{n.f()}return!1}},{key:"isFormulaArrayInAllRows",value:function(e){var r=!0,n=Ji(e.rows()),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;this.isFormulaArrayInRow(e.sheet,s)||(r=!1)}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"isFormulaArrayInColumn",value:function(e,r){var n=Ji(this.arrayMapping.values()),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s.spansThroughSheetColumn(e,r))return!0}}catch(o){n.e(o)}finally{n.f()}return!1}},{key:"isFormulaArrayInAllColumns",value:function(e){var r=!0,n=Ji(e.columns()),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;this.isFormulaArrayInColumn(e.sheet,s)||(r=!1)}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"isFormulaArrayInRange",value:function(e){var r=Ji(this.arrayMapping.values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.getRange().doesOverlap(e))return!0}}catch(s){r.e(s)}finally{r.f()}return!1}},{key:"isFormulaArrayAtAddress",value:function(e){var r=Ji(this.arrayMapping.values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.getRange().addressInRange(e))return!0}}catch(s){r.e(s)}finally{r.f()}return!1}},{key:"moveArrayVerticesAfterRowByRows",value:function(e,r,n){this.updateArrayVerticesInSheet(e,function(i,s){var o=s.getRange();return r<=o.start.row?[o.shifted(0,n),s]:void 0})}},{key:"moveArrayVerticesAfterColumnByColumns",value:function(e,r,n){this.updateArrayVerticesInSheet(e,function(i,s){var o=s.getRange();return r<=o.start.col?[o.shifted(n,0),s]:void 0})}},{key:"updateArrayVerticesInSheet",value:function(e,r){var n=this,i=Array(),s=Ji(this.arrayMapping.entries()),o;try{for(s.s();!(o=s.n()).done;){var l=bg(o.value,2),u=l[0],c=l[1];if(c.sheet===e){var p=r(u,c);p!==void 0&&(this.removeArray(u),i.push(p))}}}catch(m){s.e(m)}finally{s.f()}i.forEach(function(m){var f=bg(m,2),d=f[0],h=f[1];n.setArray(d,h)})}}]),a}();var vze=M(q());var wze=M(ie());"use strict";var kle=he(),Fle=pe(),jle=jo(),Mle=xs(),Ble=Wn(),Lle=Yr(),Ule=Dy(),zle=Yu(),Gle=Qu(),Hle=Gle("splice"),qle=Fle.TypeError,Wle=Math.max,$le=Math.min,Kle=9007199254740991,Xle="Maximum allowed length exceeded";kle({target:"Array",proto:!0,forced:!Hle},{splice:function(t,e){var r=Lle(this),n=Ble(r),i=jle(t,n),s=arguments.length,o,l,u,c,p,m;if(s===0?o=l=0:s===1?(o=0,l=n-i):(o=s-2,l=$le(Wle(Mle(e),0),n-i)),n+o-l>Kle)throw qle(Xle);for(u=Ule(r,l),c=0;c<l;c++)p=i+c,p in r&&zle(u,c,r[p]);if(u.length=l,o<l){for(c=i;c<n-l;c++)p=c+l,m=c+o,p in r?r[m]=r[p]:delete r[m];for(c=n;c>n-l+o;c--)delete r[c-1]}else if(o>l)for(c=n-l;c>i;c--)p=c+l-1,m=c+o-1,p in r?r[m]=r[p]:delete r[m];for(c=0;c<o;c++)r[c+i]=arguments[c+2];return r.length=n-l+o,u}});var aze=M(q());var cze=M(ie());function Yle(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=B_(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function M_(a){return Qle(a)||Jle(a)||B_(a)||Zle()}function Zle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B_(a,t){if(!!a){if(typeof a=="string")return PA(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return PA(a,t)}}function Jle(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Qle(a){if(Array.isArray(a))return PA(a)}function PA(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function _A(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function L_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function kA(a,t,e){return t&&L_(a.prototype,t),e&&L_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var sl=function(){function a(t){_A(this,a),this.size=t}return kA(a,[{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"get",value:function(e,r){throw Error("Array not computed yet.")}},{key:"simpleRangeValue",value:function(){throw Error("Array not computed yet.")}}]),a}(),rd=function(){function a(t){_A(this,a),this.size=new Se(t.length>0?t[0].length:0,t.length),this.array=t}return kA(a,[{key:"simpleRangeValue",value:function(){return Q.onlyValues(this.array)}},{key:"addRows",value:function(e,r){var n;(n=this.array).splice.apply(n,[e,0].concat(M_(this.nullArrays(r,this.width())))),this.size.height+=r}},{key:"addColumns",value:function(e,r){for(var n=0;n<this.height();n++){var i;(i=this.array[n]).splice.apply(i,[e,0].concat(M_(new Array(r).fill(le))))}this.size.width+=r}},{key:"removeRows",value:function(e,r){if(this.outOfBound(0,e)||this.outOfBound(0,r))throw Error("Array index out of bound");var n=r-e+1;this.array.splice(e,n),this.size.height-=n}},{key:"removeColumns",value:function(e,r){if(this.outOfBound(e,0)||this.outOfBound(r,0))throw Error("Array index out of bound");var n=r-e+1,i=Yle(this.array),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;o.splice(e,n)}}catch(l){i.e(l)}finally{i.f()}this.size.width-=n}},{key:"nullArrays",value:function(e,r){for(var n=[],i=0;i<e;++i)n.push(new Array(r).fill(le));return n}},{key:"get",value:function(e,r){if(this.outOfBound(e,r))throw Error("Array index out of bound");return this.array[r][e]}},{key:"set",value:function(e,r,n){if(this.outOfBound(e,r))throw Error("Array index out of bound");this.array[r][e]=n}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"raw",value:function(){return this.array}},{key:"resize",value:function(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw"Resizing to smaller array"}},{key:"outOfBound",value:function(e,r){return e<0||r<0||r>this.size.height-1||e>this.size.width-1}}],[{key:"fromInterpreterValue",value:function(e){return e instanceof Q?new a(e.data):new a([[e]])}}]),a}(),gg=function(){function a(t,e){_A(this,a),this.error=t,this.size=e}return kA(a,[{key:"get",value:function(e,r){return this.error}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"simpleRangeValue",value:function(){return this.error}}]),a}();function FA(a){return FA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FA(a)}function U_(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&jA(a,t)}function jA(a,t){return jA=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},jA(a,t)}function z_(a){var t=rue();return function(){var r=vg(a),n;if(t){var i=vg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return eue(this,n)}}function eue(a,t){if(t&&(FA(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tue(a)}function tue(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function rue(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function vg(a){return vg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vg(a)}function nue(a,t){return oue(a)||sue(a,t)||iue(a,t)||aue()}function aue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iue(a,t){if(!!a){if(typeof a=="string")return G_(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return G_(a,t)}}function G_(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function sue(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function oue(a){if(Array.isArray(a))return a}function MA(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function H_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function BA(a,t,e){return t&&H_(a.prototype,t),e&&H_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var dr=function(){function a(t,e,r){MA(this,a),this.formula=t,this.cellAddress=e,this.version=r}return BA(a,[{key:"width",get:function(){return 1}},{key:"height",get:function(){return 1}},{key:"getFormula",value:function(e){return this.ensureRecentData(e),this.formula}},{key:"ensureRecentData",value:function(e){if(this.version!=e.version()){var r=e.applyTransformations(this.formula,this.cellAddress,this.version),n=nue(r,3),i=n[0],s=n[1],o=n[2];this.formula=i,this.cellAddress=s,this.version=o}}},{key:"getAddress",value:function(e){return this.ensureRecentData(e),this.cellAddress}}],[{key:"fromAst",value:function(e,r,n,i){return n.isScalar()?new Qr(e,r,i):new Ye(e,r,n,i)}}]),a}(),Ye=function(a){U_(e,a);var t=z_(e);function e(r,n,i){var s,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return MA(this,e),s=t.call(this,r,n,o),i.isRef?s.array=new gg(new E(V.REF,D.NoSpaceForArrayResult),Se.error()):s.array=new sl(i),s}return BA(e,[{key:"width",get:function(){return this.array.width()}},{key:"height",get:function(){return this.array.height()}},{key:"sheet",get:function(){return this.cellAddress.sheet}},{key:"leftCorner",get:function(){return this.cellAddress}},{key:"setCellValue",value:function(n){if(n instanceof E)return this.setErrorValue(n),n;var i=rd.fromInterpreterValue(n);return i.resize(this.array.size),this.array=i,n}},{key:"getCellValue",value:function(){if(this.array instanceof sl)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}},{key:"valueOrUndef",value:function(){if(!(this.array instanceof sl))return this.array.simpleRangeValue()}},{key:"getArrayCellValue",value:function(n){var i=n.col-this.cellAddress.col,s=n.row-this.cellAddress.row;try{return this.array.get(i,s)}catch(o){return new E(V.REF)}}},{key:"getArrayCellRawValue",value:function(n){var i=this.getArrayCellValue(n);if(!(i instanceof E||i===le))return W(i)}},{key:"setArrayCellValue",value:function(n,i){var s=n.col-this.cellAddress.col,o=n.row-this.cellAddress.row;this.array instanceof rd&&this.array.set(s,o,i)}},{key:"setNoSpace",value:function(){return this.array=new gg(new E(V.SPILL,D.NoSpaceForArrayResult),Se.error()),this.getCellValue()}},{key:"getRange",value:function(){return oe.spanFrom(this.cellAddress,this.width,this.height)}},{key:"getRangeOrUndef",value:function(){return oe.spanFromOrUndef(this.cellAddress,this.width,this.height)}},{key:"setAddress",value:function(n){this.cellAddress=n}},{key:"setFormula",value:function(n){this.formula=n}},{key:"spansThroughSheetRows",value:function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i;return this.cellAddress.sheet===n&&this.cellAddress.row<=s&&i<this.cellAddress.row+this.height}},{key:"spansThroughSheetColumn",value:function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i;return this.cellAddress.sheet===n&&this.cellAddress.col<=s&&i<this.cellAddress.col+this.width}},{key:"isComputed",value:function(){return!(this.array instanceof sl)}},{key:"columnsFromArray",value:function(){return ea.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}},{key:"rowsFromArray",value:function(){return yn.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}},{key:"ensureRecentData",value:function(n){}},{key:"isLeftCorner",value:function(n){return Yi(this.cellAddress,n)}},{key:"setErrorValue",value:function(n){this.array=new gg(n,this.array.size)}}]),e}(dr),Qr=function(a){U_(e,a);var t=z_(e);function e(r,n,i){return MA(this,e),t.call(this,r,n,i)}return BA(e,[{key:"valueOrUndef",value:function(){return this.cachedCellValue}},{key:"setCellValue",value:function(n){return this.cachedCellValue=n,this.cachedCellValue}},{key:"getCellValue",value:function(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}},{key:"isComputed",value:function(){return this.cachedCellValue!==void 0}}]),e}(dr);var Fze=M(q());function lue(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function q_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function uue(a,t,e){return t&&q_(a.prototype,t),e&&q_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Qt=function(){function a(t){lue(this,a),this.range=t,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}return uue(a,[{key:"start",get:function(){return this.range.start}},{key:"end",get:function(){return this.range.end}},{key:"sheet",get:function(){return this.range.start.sheet}},{key:"getFunctionValue",value:function(e){return this.functionCache.get(e)}},{key:"setFunctionValue",value:function(e,r){this.functionCache.set(e,r)}},{key:"getCriterionFunctionValue",value:function(e,r){var n;return(n=this.getCriterionFunctionValues(e).get(r))===null||n===void 0?void 0:n[0]}},{key:"getCriterionFunctionValues",value:function(e){var r;return(r=this.criterionFunctionCache.get(e))!==null&&r!==void 0?r:new Map}},{key:"setCriterionFunctionValues",value:function(e,r){this.criterionFunctionCache.set(e,r)}},{key:"addDependentCacheRange",value:function(e){e!==this&&this.dependentCacheRanges.add(e)}},{key:"clearCache",value:function(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(function(e){return e.criterionFunctionCache.clear()}),this.dependentCacheRanges.clear()}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}}]),a}();var W_=function(t,e,r,n,i){if(e instanceof Qt){var s=e.range.intersectionWith(r);return s!==void 0?Array.from(s.addresses(i)):[]}var o,l;if(e instanceof dr)o=e.getFormula(n),l=e.getAddress(n);else return[];return il(o,t).filter(function(u){return u instanceof qf}).map(function(u){return u.dependency.toSimpleCellAddress(l)}).filter(function(u){return r.addressInRange(u)})};var eGe=M(q());"use strict";var cue=he(),pue=Ne(),mue=Ju(),fue=pue([].reverse),$_=[1,2];cue({target:"Array",proto:!0,forced:String($_)===String($_.reverse())},{reverse:function(){return mue(this)&&(this.length=this.length),fue(this)}});var pGe=M(ie());function K_(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=due(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function due(a,t){if(!!a){if(typeof a=="string")return X_(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return X_(a,t)}}function X_(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function hue(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Y_(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function yue(a,t,e){return t&&Y_(a.prototype,t),e&&Y_(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Qi;(function(a){a[a.ON_STACK=0]="ON_STACK",a[a.PROCESSED=1]="PROCESSED",a[a.POPPED=2]="POPPED"})(Qi||(Qi={}));var LA=function(){function a(t){hue(this,a),this.dependencyQuery=t,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}return yue(a,[{key:"addNode",value:function(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}},{key:"addEdge",value:function(e,r){if(!this.nodes.has(e))throw new Error("Unknown node ".concat(e));if(!this.nodes.has(r))throw new Error("Unknown node ".concat(r));this.edges.get(e).add(r)}},{key:"removeEdge",value:function(e,r){if(this.existsEdge(e,r))this.edges.get(e).delete(r);else throw new Error("Edge does not exist")}},{key:"softRemoveEdge",value:function(e,r){var n;(n=this.edges.get(e))===null||n===void 0||n.delete(r)}},{key:"removeIncomingEdges",value:function(e){this.edges.forEach(function(r){r.delete(e)})}},{key:"adjacentNodes",value:function(e){return this.edges.get(e)}},{key:"adjacentNodesCount",value:function(e){return this.adjacentNodes(e).size}},{key:"hasNode",value:function(e){return this.nodes.has(e)}},{key:"nodesCount",value:function(){return this.nodes.size}},{key:"edgesCount",value:function(){var e=0;return this.edges.forEach(function(r){return e+=r.size}),e}},{key:"removeNode",value:function(e){var r=K_(this.adjacentNodes(e).values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.markNodeAsSpecialRecentlyChanged(i)}}catch(s){r.e(s)}finally{r.f()}return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}},{key:"markNodeAsSpecial",value:function(e){this.specialNodes.add(e)}},{key:"markNodeAsSpecialRecentlyChanged",value:function(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}},{key:"markNodeAsChangingWithStructure",value:function(e){this.specialNodesStructuralChanges.add(e)}},{key:"clearSpecialNodesRecentlyChanged",value:function(){this.specialNodesRecentlyChanged.clear()}},{key:"markNodeAsInfiniteRange",value:function(e){this.infiniteRanges.add(e)}},{key:"existsEdge",value:function(e,r){var n,i;return(i=(n=this.edges.get(e))===null||n===void 0?void 0:n.has(r))!==null&&i!==void 0?i:!1}},{key:"topSortWithScc",value:function(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),function(){return!0},function(){})}},{key:"getTopSortedWithSccSubgraphFrom",value:function(e,r,n){var i=this,s=new Map,o=new Map,l=new Map,u=new Set,c=new Map,p=[],m=0,f=new Set;e.reverse(),e.forEach(function(b){if(c.get(b)===void 0){var g=[b],v=[];c.set(b,Qi.ON_STACK);for(var A=function(){var S=g[g.length-1];switch(c.get(S)){case Qi.ON_STACK:{s.set(S,m),o.set(S,m),v.push(S),m++,i.adjacentNodes(S).forEach(function(R){s.get(R)===void 0&&(g.push(R),l.set(R,S),c.set(R,Qi.ON_STACK))}),c.set(S,Qi.PROCESSED);break}case Qi.PROCESSED:{var w;if(w=s.get(S),i.adjacentNodes(S).forEach(function(R){u.has(R)||(l.get(R)===S?w=Math.min(w,o.get(R)):w=Math.min(w,s.get(R)))}),o.set(S,w),w===s.get(S)){var x=[];do x.push(v[v.length-1]),v.pop();while(x[x.length-1]!==S);x.forEach(function(R){u.add(R)}),p.push.apply(p,x),x.length>1&&x.forEach(function(R){f.add(R)})}g.pop(),c.set(S,Qi.POPPED);break}case Qi.POPPED:{g.pop();break}}};g.length>0;)A()}});var d=new Set(e),h=[],y=[];return p.reverse(),p.forEach(function(b){f.has(b)||i.adjacentNodes(b).has(b)?(y.push(b),n(b),i.adjacentNodes(b).forEach(function(g){return d.add(g)})):(h.push(b),d.has(b)&&r(b)&&i.adjacentNodes(b).forEach(function(g){return d.add(g)}))}),{sorted:h,cycled:y}}},{key:"getDependencies",value:function(e){var r=[];return this.edges.forEach(function(n,i){n.has(e)&&r.push(i)}),r}},{key:"removeDependencies",value:function(e){var r=this.dependencyQuery(e),n=K_(r),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;this.softRemoveEdge(s,e)}}catch(o){n.e(o)}finally{n.f()}return r}}]),a}();var NGe=M(xr()),CGe=M(q());"use strict";var Aue=he(),lk=Ne(),Sue=_o(),wue=Yr(),Eue=Wn(),uk=Rr(),zA=De(),Rue=Q_(),xue=pf(),ck=rk(),Vue=ak(),pk=qu(),mk=ok(),$s=[],fk=lk($s.sort),Oue=lk($s.push),Due=zA(function(){$s.sort(void 0)}),Iue=zA(function(){$s.sort(null)}),Pue=xue("sort"),dk=!zA(function(){if(pk)return pk<70;if(!(ck&&ck>3)){if(Vue)return!0;if(mk)return mk<603;var a="",t,e,r,n;for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)$s.push({k:e+n,v:r})}for($s.sort(function(i,s){return s.v-i.v}),n=0;n<$s.length;n++)e=$s[n].k.charAt(0),a.charAt(a.length-1)!==e&&(a+=e);return a!=="DGBEFHACIJK"}}),_ue=Due||!Iue||!Pue||!dk,kue=function(a){return function(t,e){return e===void 0?-1:t===void 0?1:a!==void 0?+a(t,e)||0:uk(t)>uk(e)?1:-1}};Aue({target:"Array",proto:!0,forced:_ue},{sort:function(t){t!==void 0&&Sue(t);var e=wue(this);if(dk)return t===void 0?fk(e):fk(e,t);var r=[],n=Eue(e),i,s;for(s=0;s<n;s++)s in e&&Oue(r,e[s]);for(Rue(r,kue(t)),i=r.length,s=0;s<i;)e[s]=r[s++];for(;s<n;)delete e[s++];return e}});var LGe=M(ie());function GA(a,t){return Mue(a)||jue(a,t)||hk(a,t)||Fue()}function Fue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jue(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Mue(a){if(Array.isArray(a))return a}function HA(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=hk(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function hk(a,t){if(!!a){if(typeof a=="string")return yk(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return yk(a,t)}}function yk(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Bue(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function bk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Lue(a,t,e){return t&&bk(a.prototype,t),e&&bk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var qA=function(){function a(){Bue(this,a),this.rangeMapping=new Map}return Lue(a,[{key:"getMappingSize",value:function(e){var r,n;return(n=(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.size)!==null&&n!==void 0?n:0}},{key:"setRange",value:function(e){var r=this.rangeMapping.get(e.getStart().sheet);r===void 0&&(r=new Map,this.rangeMapping.set(e.getStart().sheet,r));var n=Tg(e.getStart(),e.getEnd());r.set(n,e)}},{key:"removeRange",value:function(e){var r=e.getStart().sheet,n=this.rangeMapping.get(r);if(n!==void 0){var i=Tg(e.getStart(),e.getEnd());n.delete(i),n.size===0&&this.rangeMapping.delete(r)}}},{key:"getRange",value:function(e,r){var n=this.rangeMapping.get(e.sheet),i=Tg(e,r);return n==null?void 0:n.get(i)}},{key:"fetchRange",value:function(e,r){var n=this.getRange(e,r);if(!n)throw Error("Range does not exist");return n}},{key:"truncateRanges",value:function(e,r){var n=Array(),i=Array(),s=Array(),o=e.sheet,l=HA(this.entriesFromSheet(e.sheet)),u;try{for(l.s();!(u=l.n()).done;){var c=GA(u.value,2),p=c[0],m=c[1],f=m.range;e.start<=r(m.range.end)&&(f.removeSpan(e),f.shouldBeRemoved()?(this.removeByKey(o,p),n.push(m)):i.push([p,m]),s.push(m))}}catch(S){l.e(S)}finally{l.f()}var d=[];i.sort(function(S,w){return zue(S[1],w[1],r)});for(var h=0,y=i;h<y.length;h++){var b=GA(y[h],2),g=b[0],v=b[1],A=Uue(v.range);if(A!==g){var C=this.getByKey(o,A);this.removeByKey(o,g),C!==void 0&&v!=C?d.push([C,v]):this.setRange(v)}}return{verticesToRemove:n,verticesToMerge:d,verticesWithChangedSize:s}}},{key:"moveAllRangesInSheetAfterRowByRows",value:function(e,r,n){return this.updateVerticesFromSheet(e,function(i,s){return r<=s.start.row?(s.range.shiftByRows(n),{changedSize:!1,vertex:s}):r>s.start.row&&r<=s.end.row?(s.range.expandByRows(n),{changedSize:!0,vertex:s}):void 0})}},{key:"moveAllRangesInSheetAfterColumnByColumns",value:function(e,r,n){return this.updateVerticesFromSheet(e,function(i,s){return r<=s.start.col?(s.range.shiftByColumns(n),{changedSize:!1,vertex:s}):r>s.start.col&&r<=s.end.col?(s.range.expandByColumns(n),{changedSize:!0,vertex:s}):void 0})}},{key:"moveRangesInsideSourceRange",value:function(e,r,n,i){this.updateVerticesFromSheet(e.sheet,function(s,o){if(e.containsRange(o.range))return o.range.shiftByColumns(r),o.range.shiftByRows(n),o.range.moveToSheet(i),{changedSize:!1,vertex:o}})}},{key:"removeRangesInSheet",value:function(e){if(this.rangeMapping.has(e)){var r=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),r}return[][Symbol.iterator]()}},{key:"rangesInSheet",value:regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(r=this.rangeMapping.get(e),r){i.next=3;break}return i.abrupt("return");case 3:return i.delegateYield(r.values(),"t0",4);case 4:case"end":return i.stop()}},t,this)})},{key:"rangeVerticesContainedInRange",value:regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=HA(this.rangesInSheet(e.sheet)),o.prev=1,r.s();case 3:if((n=r.n()).done){o.next=10;break}if(i=n.value,!e.containsRange(i.range)){o.next=8;break}return o.next=8,i;case 8:o.next=3;break;case 10:o.next=15;break;case 12:o.prev=12,o.t0=o.catch(1),r.e(o.t0);case 15:return o.prev=15,r.f(),o.finish(15);case 18:case"end":return o.stop()}},t,this,[[1,12,15,18]])})},{key:"findSmallerRange",value:function(e){if(e.height()>1&&Number.isFinite(e.height())){var r=$(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,r);if(n!==void 0){var i=new oe($(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:n,restRange:i}}}return{restRange:e}}},{key:"entriesFromSheet",value:regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(r=this.rangeMapping.get(e),r){i.next=3;break}return i.abrupt("return");case 3:return i.delegateYield(r.entries(),"t0",4);case 4:case"end":return i.stop()}},t,this)})},{key:"removeByKey",value:function(e,r){this.rangeMapping.get(e).delete(r)}},{key:"getByKey",value:function(e,r){var n;return(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.get(r)}},{key:"updateVerticesFromSheet",value:function(e,r){var n=this,i=Array(),s=HA(this.entriesFromSheet(e)),o;try{for(s.s();!(o=s.n()).done;){var l=GA(o.value,2),u=l[0],c=l[1],p=r(u,c);p!==void 0&&(this.removeByKey(e,u),i.push(p))}}catch(m){s.e(m)}finally{s.f()}return i.forEach(function(m){n.setRange(m.vertex)}),{verticesWithChangedSize:i.filter(function(m){return m.changedSize}).map(function(m){return m.vertex})}}}]),a}();function Tg(a,t){return"".concat(a.col,",").concat(a.row,",").concat(t.col,",").concat(t.row)}function Uue(a){return Tg(a.start,a.end)}var zue=function(t,e,r){var n=r(t.range.start),i=r(t.range.start);if(n===i){var s=r(t.range.end),o=r(e.range.end);return s-o}else return n-i};var yHe=M(xr()),bHe=M(q());var RHe=M(ie());var Gue=he(),Hue=Yr(),gk=Zu(),que=De(),Wue=que(function(){gk(1)});Gue({target:"Object",stat:!0,forced:Wue},{keys:function(t){return gk(Hue(t))}});var Que=he(),ece=WA().values;Que({target:"Object",stat:!0},{values:function(t){return ece(t)}});var JGe=M(q());var sHe=M(ie());function Ck(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=tce(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function tce(a,t){if(!!a){if(typeof a=="string")return Ak(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ak(a,t)}}function Ak(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function rce(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Sk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function nce(a,t,e){return t&&Sk(a.prototype,t),e&&Sk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var wk=function(){function a(t,e,r){rce(this,a),this.functions=t,this.errors=e,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}return nce(a,[{key:"extendFunctions",value:function(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}},{key:"buildFunctionMapping",value:function(){var e=this;return Object.keys(this.functions).reduce(function(r,n){return r[e.functions[n]]=n,r},{})}},{key:"buildErrorMapping",value:function(){var e=this;return Object.keys(this.errors).reduce(function(r,n){return r[e.errors[n]]=n,r},{})}},{key:"isFunctionTranslated",value:function(e){return this.functions[e]!==void 0}},{key:"getFunctionTranslations",value:function(e){var r=[],n=Ck(e),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;this.isFunctionTranslated(s)&&r.push(this.functions[s])}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"getFunctionTranslation",value:function(e){var r=this.functions[e];if(r===void 0)throw new js("functions.".concat(e));return r}},{key:"getMaybeFunctionTranslation",value:function(e){return this.functions[e]}},{key:"getErrorTranslation",value:function(e){if(e===V.LIC)return"#".concat(V.LIC,"!");var r=this.errors[e];if(r===void 0)throw new js("errors.".concat(e));return r}},{key:"getUITranslation",value:function(e){var r=this.ui[e];if(r===void 0)throw new js("ui.".concat(e));return r}},{key:"checkUI",value:function(){for(var e=0,r=Object.values(Ks);e<r.length;e++){var n=r[e];if(!(n in this.ui))throw new js("ui.".concat(n))}}},{key:"checkErrors",value:function(){for(var e=0,r=Object.values(V);e<r.length;e++){var n=r[e];if(!(n in this.errors)&&n!==V.LIC)throw new js("errors.".concat(n))}}},{key:"checkFunctionTranslations",value:function(e){var r=new Set(Object.getOwnPropertyNames(e)),n=Ck(Object.getOwnPropertyNames(this._protectedTranslations)),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;if(r.has(s))throw new pb(s)}}catch(o){n.e(o)}finally{n.f()}}}]),a}();function $A(a){return new wk(Object.assign({},a.functions),Object.assign({},a.errors),Object.assign({},a.ui))}var Ks;(function(a){a.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(Ks||(Ks={}));function ace(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=ice(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function ice(a,t){if(!!a){if(typeof a=="string")return Ek(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ek(a,t)}}function Ek(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Rk(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function xk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Vk(a,t,e){return t&&xk(a.prototype,t),e&&xk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function qc(a){return a.toLowerCase()}var sce=function(){function a(t,e){Rk(this,a),this.id=t,this.displayName=e}return Vk(a,[{key:"canonicalName",get:function(){return qc(this.displayName)}}]),a}(),KA=function(){function a(t){var e=this;Rk(this,a),this.languages=t,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=function(r){var n=e.mappingFromCanonicalName.get(qc(r));if(n===void 0)throw new Qy(r);return n.id},this.get=function(r){var n;return(n=e.mappingFromCanonicalName.get(qc(r)))===null||n===void 0?void 0:n.id},this.fetchDisplayName=function(r){return e.fetchSheetById(r).displayName},this.sheetNamePrefix=t.getUITranslation(Ks.NEW_SHEET_PREFIX)}return Vk(a,[{key:"addSheet",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"".concat(this.sheetNamePrefix).concat(this.lastSheetId+2),r=qc(e);if(this.mappingFromCanonicalName.has(r))throw new ks(e);this.lastSheetId++;var n=new sce(this.lastSheetId,e);return this.store(n),n.id}},{key:"removeSheet",value:function(e){var r=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(r.canonicalName),this.mappingFromId.delete(r.id)}},{key:"getDisplayName",value:function(e){var r;return(r=this.mappingFromId.get(e))===null||r===void 0?void 0:r.displayName}},{key:"displayNames",value:regeneratorRuntime.mark(function t(){var e,r,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=ace(this.mappingFromCanonicalName.values()),s.prev=1,e.s();case 3:if((r=e.n()).done){s.next=9;break}return n=r.value,s.next=7,n.displayName;case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),e.e(s.t0);case 14:return s.prev=14,e.f(),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])})},{key:"numberOfSheets",value:function(){return this.mappingFromCanonicalName.size}},{key:"hasSheetWithId",value:function(e){return this.mappingFromId.has(e)}},{key:"hasSheetWithName",value:function(e){return this.mappingFromCanonicalName.has(qc(e))}},{key:"renameSheet",value:function(e,r){var n=this.fetchSheetById(e),i=n.displayName;if(i!==r){var s=this.mappingFromCanonicalName.get(qc(r));if(s!==void 0&&s.id!==n.id)throw new ks(r);var o=n.canonicalName;return this.mappingFromCanonicalName.delete(o),n.displayName=r,this.store(n),i}}},{key:"sheetNames",value:function(){return Array.from(this.mappingFromId.values()).map(function(e){return e.displayName})}},{key:"store",value:function(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}},{key:"fetchSheetById",value:function(e){var r=this.mappingFromId.get(e);if(r===void 0)throw new tt(e);return r}}]),a}();function Ng(a,t,e){return oce()?Ng=Reflect.construct:Ng=function(n,i,s){var o=[null];o.push.apply(o,i);var l=Function.bind.apply(n,o),u=new l;return s&&XA(u,s.prototype),u},Ng.apply(null,arguments)}function oce(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function XA(a,t){return XA=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},XA(a,t)}function YA(a){return cce(a)||uce(a)||ZA(a)||lce()}function lce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uce(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function cce(a){if(Array.isArray(a))return JA(a)}function fe(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=ZA(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function en(a,t){return fce(a)||mce(a,t)||ZA(a,t)||pce()}function pce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZA(a,t){if(!!a){if(typeof a=="string")return JA(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return JA(a,t)}}function JA(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function mce(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function fce(a){if(Array.isArray(a))return a}function dce(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Ok(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function hce(a,t,e){return t&&Ok(a.prototype,t),e&&Ok(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var QA=function(){function a(t,e,r,n,i,s,o,l){var u=this;dce(this,a),this.addressMapping=t,this.rangeMapping=e,this.sheetMapping=r,this.arrayMapping=n,this.stats=i,this.lazilyTransformingAstService=s,this.functionRegistry=o,this.namedExpressions=l,this.changes=Zi.empty(),this.dependencyQueryAddresses=function(c){if(c instanceof Qt)return u.rangeDependencyQuery(c).map(function(h){var y=en(h,2),b=y[0],g=y[1];return b});var p=u.formulaDependencyQuery(c);if(p!==void 0){var m=en(p,2),f=m[0],d=m[1];return d.map(function(h){return h instanceof Pn?u.namedExpressions.namedExpressionOrPlaceholder(h.name,f.sheet).address:gt(h)?h:Gf(h.start,h.end)})}else return[]},this.dependencyQueryVertices=function(c){if(c instanceof Qt)return u.rangeDependencyQuery(c).map(function(h){var y=en(h,2),b=y[0],g=y[1];return g});var p=u.formulaDependencyQuery(c);if(p!==void 0){var m=en(p,2),f=m[0],d=m[1];return d.map(function(h){if(h instanceof oe)return u.rangeMapping.fetchRange(h.start,h.end);if(h instanceof Pn){var y=u.namedExpressions.namedExpressionOrPlaceholder(h.name,f.sheet);return u.addressMapping.fetchCell(y.address)}else return u.addressMapping.fetchCell(h)})}else return[]},this.rangeDependencyQuery=function(c){var p=[],m=u.rangeMapping.findSmallerRange(c.range),f=m.smallerRangeVertex,d=m.restRange,h;f!==void 0&&u.graph.adjacentNodes(f).has(c)?(h=d,p.push([new oe(f.start,f.end),f])):h=c.range;var y=fe(h.addresses(u)),b;try{for(y.s();!(b=y.n()).done;){var g=b.value,v=u.addressMapping.getCell(g);v instanceof ta&&(v.address=g),v!==void 0&&p.push([g,v])}}catch(A){y.e(A)}finally{y.f()}return p},this.formulaDependencyQuery=function(c){var p,m;if(c instanceof dr)m=c.getAddress(u.lazilyTransformingAstService),p=c.getFormula(u.lazilyTransformingAstService);else return;var f=il(p,u.functionRegistry);return[m,gn(f,m)]},this.graph=new LA(this.dependencyQueryVertices)}return hce(a,[{key:"setFormulaToCell",value:function(e,r,n,i,s,o){var l=dr.fromAst(r,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(l),this.processCellDependencies(n,l),this.graph.markNodeAsSpecialRecentlyChanged(l),s&&this.markAsVolatile(l),o&&this.markAsDependentOnStructureChange(l),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setParsingErrorToCell",value:function(e,r){var n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,r),this.addressMapping.setCell(e,r),this.graph.markNodeAsSpecialRecentlyChanged(r),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setValueToCell",value:function(e,r){var n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof Ye&&this.arrayMapping.removeArray(n.getRange()),n instanceof vn){var i=n.getValues();i.rawValue!==r.rawValue&&(n.setValues(r),this.graph.markNodeAsSpecialRecentlyChanged(n))}else{var s=new vn(r.parsedValue,r.rawValue);this.exchangeOrAddGraphNode(n,s),this.addressMapping.setCell(e,s),this.graph.markNodeAsSpecialRecentlyChanged(s)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setCellEmpty",value:function(e){var r=this.shrinkPossibleArrayAndGetCell(e);if(r===void 0)return Zi.empty();if(this.graph.adjacentNodes(r).size>0){var n=new ta(e);this.exchangeGraphNode(r,n),this.graph.adjacentNodesCount(n)===0?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(n),this.addressMapping.setCell(e,n))}else this.removeVertex(r),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}},{key:"ensureThatVertexIsNonArrayCellVertex",value:function(e){if(e instanceof Ye)throw new Error("Illegal operation")}},{key:"clearRecentlyChangedVertices",value:function(){this.graph.clearSpecialNodesRecentlyChanged()}},{key:"verticesToRecompute",value:function(){return new Set([].concat(YA(this.graph.specialNodesRecentlyChanged),YA(this.volatileVertices())))}},{key:"processCellDependencies",value:function(e,r){var n=this;e.forEach(function(i){if(i instanceof oe){var s=i,o=n.getRange(s.start,s.end);o===void 0&&(o=new Qt(s),n.rangeMapping.setRange(o)),n.graph.addNode(o),s.isFinite()||n.graph.markNodeAsInfiniteRange(o);var l=n.rangeMapping.findSmallerRange(s),u=l.smallerRangeVertex,c=l.restRange;if(u!==void 0){if(n.graph.addEdge(u,o),o.bruteForce){o.bruteForce=!1;var p=fe(s.addresses(n)),m;try{for(p.s();!(m=p.n()).done;){var f=m.value;n.graph.removeEdge(n.fetchCell(f),o)}}catch(A){p.e(A)}finally{p.f()}}}else o.bruteForce=!0;var d=n.arrayMapping.getArray(c);if(d!==void 0)n.graph.addEdge(d,o);else{var h=fe(c.addresses(n)),y;try{for(h.s();!(y=h.n()).done;){var b=y.value;n.graph.addEdge(n.fetchCellOrCreateEmpty(b),o)}}catch(A){h.e(A)}finally{h.f()}}n.graph.addEdge(o,r),s.isFinite()&&n.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(i instanceof Pn){var g=r.getAddress(n.lazilyTransformingAstService).sheet,v=n.fetchNamedExpressionVertex(i.name,g);n.graph.addEdge(v,r)}else n.graph.addEdge(n.fetchCellOrCreateEmpty(i),r)})}},{key:"fetchNamedExpressionVertex",value:function(e,r){var n=this.namedExpressions.namedExpressionOrPlaceholder(e,r);return this.fetchCellOrCreateEmpty(n.address)}},{key:"exchangeNode",value:function(e,r){var n=this.fetchCellOrCreateEmpty(e),i=this.fetchCellOrCreateEmpty(r);this.addressMapping.removeCell(e),this.exchangeGraphNode(n,i)}},{key:"correctInfiniteRangesDependency",value:function(e){var r=void 0,n=fe(this.graph.infiniteRanges),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=s;o.range.addressInRange(e)&&(r=r??this.fetchCellOrCreateEmpty(e),this.graph.addEdge(r,o))}}catch(l){n.e(l)}finally{n.f()}}},{key:"fetchCellOrCreateEmpty",value:function(e){var r=this.addressMapping.getCell(e);return r===void 0&&(r=new ta(e),this.graph.addNode(r),this.addressMapping.setCell(e,r)),r}},{key:"removeRows",value:function(e){var r=this;this.stats.measure(ue.ADJUSTING_GRAPH,function(){var i=fe(r.addressMapping.entriesFromRowsSpan(e)),s;try{for(i.s();!(s=i.n()).done;){var o=en(s.value,2),l=o[0],u=o[1],c=fe(r.graph.adjacentNodes(u)),p;try{for(c.s();!(p=c.n()).done;){var m=p.value;r.graph.markNodeAsSpecialRecentlyChanged(m)}}catch(f){c.e(f)}finally{c.f()}if(u instanceof Ye)if(u.isLeftCorner(l))r.shrinkArrayToCorner(u),r.arrayMapping.removeArray(u.getRange());else continue;r.removeVertex(u)}}catch(f){i.e(f)}finally{i.f()}}),this.stats.measure(ue.ADJUSTING_ADDRESS_MAPPING,function(){r.addressMapping.removeRows(e)});var n=this.stats.measure(ue.ADJUSTING_RANGES,function(){var i=r.truncateRanges(e,function(s){return s.row});return r.getArrayVerticesRelatedToRanges(i)});return this.stats.measure(ue.ADJUSTING_ARRAY_MAPPING,function(){r.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:n,contentChanges:this.getAndClearContentChanges()}}},{key:"removeSheet",value:function(e){var r=this,n=new Set,i=fe(this.addressMapping.sheetEntries(e)),s;try{for(i.s();!(s=i.n()).done;){var o=en(s.value,2),l=o[0],u=o[1];if(u instanceof Ye){if(n.has(u))continue;n.add(u)}var c=fe(this.graph.adjacentNodes(u)),p;try{for(c.s();!(p=c.n()).done;){var m=p.value;this.graph.markNodeAsSpecialRecentlyChanged(m)}}catch(f){c.e(f)}finally{c.f()}this.removeVertex(u),this.addressMapping.removeCell(l)}}catch(f){i.e(f)}finally{i.f()}this.stats.measure(ue.ADJUSTING_ARRAY_MAPPING,function(){var f=fe(n.values()),d;try{for(f.s();!(d=f.n()).done;){var h=d.value;r.arrayMapping.removeArray(h.getRange())}}catch(y){f.e(y)}finally{f.f()}}),this.stats.measure(ue.ADJUSTING_RANGES,function(){var f=r.rangeMapping.removeRangesInSheet(e),d=fe(f),h;try{for(d.s();!(h=d.n()).done;){var y=h.value;r.removeVertex(y)}}catch(b){d.e(b)}finally{d.f()}r.stats.measure(ue.ADJUSTING_ADDRESS_MAPPING,function(){r.addressMapping.removeSheet(e)})}),this.addStructuralNodesToChangeSet()}},{key:"clearSheet",value:function(e){var r=new Set,n=fe(this.addressMapping.sheetEntries(e)),i;try{for(n.s();!(i=n.n()).done;){var s=en(i.value,2),o=s[0],l=s[1];l instanceof Ye?r.add(l):this.setCellEmpty(o)}}catch(m){n.e(m)}finally{n.f()}var u=fe(r.values()),c;try{for(u.s();!(c=u.n()).done;){var p=c.value;this.setArrayEmpty(p)}}catch(m){u.e(m)}finally{u.f()}this.addStructuralNodesToChangeSet()}},{key:"removeColumns",value:function(e){var r=this;this.stats.measure(ue.ADJUSTING_GRAPH,function(){var i=fe(r.addressMapping.entriesFromColumnsSpan(e)),s;try{for(i.s();!(s=i.n()).done;){var o=en(s.value,2),l=o[0],u=o[1],c=fe(r.graph.adjacentNodes(u)),p;try{for(c.s();!(p=c.n()).done;){var m=p.value;r.graph.markNodeAsSpecialRecentlyChanged(m)}}catch(f){c.e(f)}finally{c.f()}if(u instanceof Ye)if(u.isLeftCorner(l))r.shrinkArrayToCorner(u),r.arrayMapping.removeArray(u.getRange());else continue;r.removeVertex(u)}}catch(f){i.e(f)}finally{i.f()}}),this.stats.measure(ue.ADJUSTING_ADDRESS_MAPPING,function(){r.addressMapping.removeColumns(e)});var n=this.stats.measure(ue.ADJUSTING_RANGES,function(){var i=r.truncateRanges(e,function(s){return s.col});return r.getArrayVerticesRelatedToRanges(i)});return this.stats.measure(ue.ADJUSTING_ARRAY_MAPPING,function(){return r.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)}),this.addStructuralNodesToChangeSet(),{affectedArrays:n,contentChanges:this.getAndClearContentChanges()}}},{key:"addRows",value:function(e){var r=this;this.stats.measure(ue.ADJUSTING_ADDRESS_MAPPING,function(){r.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});var n=this.stats.measure(ue.ADJUSTING_RANGES,function(){var l=r.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return r.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),r.getArrayVerticesRelatedToRanges(l.verticesWithChangedSize)});this.stats.measure(ue.ADJUSTING_ARRAY_MAPPING,function(){r.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});var i=fe(this.addressMapping.verticesFromRowsSpan(e)),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;this.graph.markNodeAsSpecialRecentlyChanged(o)}}catch(l){i.e(l)}finally{i.f()}return this.addStructuralNodesToChangeSet(),{affectedArrays:n}}},{key:"addColumns",value:function(e){var r=this;this.stats.measure(ue.ADJUSTING_ADDRESS_MAPPING,function(){r.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});var n=this.stats.measure(ue.ADJUSTING_RANGES,function(){var l=r.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return r.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),r.getArrayVerticesRelatedToRanges(l.verticesWithChangedSize)});this.stats.measure(ue.ADJUSTING_ARRAY_MAPPING,function(){return r.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns)});var i=fe(this.addressMapping.verticesFromColumnsSpan(e)),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;this.graph.markNodeAsSpecialRecentlyChanged(o)}}catch(l){i.e(l)}finally{i.f()}return this.addStructuralNodesToChangeSet(),{affectedArrays:n,contentChanges:this.getAndClearContentChanges()}}},{key:"ensureNoArrayInRange",value:function(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}},{key:"isThereSpaceForArray",value:function(e){var r=e.getRangeOrUndef();if(r===void 0)return!1;var n=fe(r.addresses(this)),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=this.addressMapping.getCell(s);if(o!==void 0&&!(o instanceof ta)&&o!==e)return!1}}catch(l){n.e(l)}finally{n.f()}return!0}},{key:"moveCells",value:function(e,r,n,i){var s=fe(e.addressesWithDirection(r,n,this)),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,u=$(i,l.col+r,l.row+n),c=this.addressMapping.getCell(l),p=this.addressMapping.getCell(u);if(this.addressMapping.removeCell(l),c!==void 0){this.graph.markNodeAsSpecialRecentlyChanged(c),this.addressMapping.setCell(u,c);var m=void 0,f=fe(this.graph.adjacentNodes(c)),d;try{for(f.s();!(d=f.n()).done;){var h=d.value;h instanceof Qt&&!e.containsRange(h.range)&&(m=m??this.fetchCellOrCreateEmpty(l),this.graph.addEdge(m,h),this.graph.removeEdge(c,h))}}catch(B){f.e(B)}finally{f.f()}m&&(this.graph.markNodeAsSpecialRecentlyChanged(m),this.addressMapping.setCell(l,m))}if(p!==void 0){c===void 0&&this.addressMapping.removeCell(u);var y=fe(this.graph.adjacentNodes(p)),b;try{for(y.s();!(b=y.n()).done;){var g=b.value;c=c??this.fetchCellOrCreateEmpty(u),this.graph.addEdge(c,g),this.graph.markNodeAsSpecialRecentlyChanged(c)}}catch(B){y.e(B)}finally{y.f()}this.removeVertex(p)}}}catch(B){s.e(B)}finally{s.f()}var v=fe(this.rangeMapping.rangeVerticesContainedInRange(e)),A;try{for(v.s();!(A=v.n()).done;){var C=A.value,S=fe(this.graph.adjacentNodes(C)),w;try{for(S.s();!(w=S.n()).done;){var x=w.value;if(x instanceof Qt&&!e.containsRange(x.range)){this.graph.removeEdge(C,x);var R=fe(C.range.addresses(this)),O;try{for(R.s();!(O=R.n()).done;){var _=O.value,k=this.fetchCellOrCreateEmpty(_);this.graph.addEdge(k,x),this.addressMapping.setCell(_,k),this.graph.markNodeAsSpecialRecentlyChanged(k)}}catch(B){R.e(B)}finally{R.f()}}}}catch(B){S.e(B)}finally{S.f()}}}catch(B){v.e(B)}finally{v.f()}this.rangeMapping.moveRangesInsideSourceRange(e,r,n,i)}},{key:"setArrayEmpty",value:function(e){var r=oe.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e),i=fe(r.addresses(this)),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;this.addressMapping.removeCell(o)}}catch(y){i.e(y)}finally{i.f()}var l=fe(n.values()),u;try{for(l.s();!(u=l.n()).done;){var c=u.value,p=W_(this.functionRegistry,c,e.getRange(),this.lazilyTransformingAstService,this),m=fe(p),f;try{for(m.s();!(f=m.n()).done;){var d=f.value,h=this.fetchCellOrCreateEmpty(d);this.graph.addEdge(h,c)}}catch(y){m.e(y)}finally{m.f()}p.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(c)}}catch(y){l.e(y)}finally{l.f()}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}},{key:"addVertex",value:function(e,r){this.graph.addNode(r),this.addressMapping.setCell(e,r)}},{key:"addArrayVertex",value:function(e,r){this.graph.addNode(r),this.setAddressMappingForArrayVertex(r,e)}},{key:"arrayFormulaNodes",value:regeneratorRuntime.mark(function t(){var e,r,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=fe(this.graph.nodes),s.prev=1,e.s();case 3:if((r=e.n()).done){s.next=10;break}if(n=r.value,!(n instanceof Ye)){s.next=8;break}return s.next=8,n;case 8:s.next=3;break;case 10:s.next=15;break;case 12:s.prev=12,s.t0=s.catch(1),e.e(s.t0);case 15:return s.prev=15,e.f(),s.finish(15);case 18:case"end":return s.stop()}},t,this,[[1,12,15,18]])})},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(this.addressMapping.entriesFromRowsSpan(e),"t0",1);case 1:case"end":return n.stop()}},t,this)})},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(this.addressMapping.entriesFromColumnsSpan(e),"t0",1);case 1:case"end":return n.stop()}},t,this)})},{key:"existsVertex",value:function(e){return this.addressMapping.has(e)}},{key:"fetchCell",value:function(e){return this.addressMapping.fetchCell(e)}},{key:"getCell",value:function(e){return this.addressMapping.getCell(e)}},{key:"getCellValue",value:function(e){return this.addressMapping.getCellValue(e)}},{key:"getRawValue",value:function(e){return this.addressMapping.getRawValue(e)}},{key:"getScalarValue",value:function(e){var r=this.addressMapping.getCellValue(e);return r instanceof Q?new E(V.VALUE,D.ScalarExpected):r}},{key:"existsEdge",value:function(e,r){return this.graph.existsEdge(e,r)}},{key:"getSheetId",value:function(e){return this.sheetMapping.fetch(e)}},{key:"getSheetHeight",value:function(e){return this.addressMapping.getHeight(e)}},{key:"getSheetWidth",value:function(e){return this.addressMapping.getWidth(e)}},{key:"getArray",value:function(e){return this.arrayMapping.getArray(e)}},{key:"setArray",value:function(e,r){this.arrayMapping.setArray(e,r)}},{key:"getRange",value:function(e,r){return this.rangeMapping.getRange(e,r)}},{key:"topSortWithScc",value:function(){return this.graph.topSortWithScc()}},{key:"markAsVolatile",value:function(e){this.graph.markNodeAsSpecial(e)}},{key:"markAsDependentOnStructureChange",value:function(e){this.graph.markNodeAsChangingWithStructure(e)}},{key:"forceApplyPostponedTransformations",value:function(){var e=fe(this.graph.nodes.values()),r;try{for(e.s();!(r=e.n()).done;){var n=r.value;n instanceof Qr&&n.ensureRecentData(this.lazilyTransformingAstService)}}catch(i){e.e(i)}finally{e.f()}}},{key:"volatileVertices",value:function(){return this.graph.specialNodes}},{key:"getArrayVerticesRelatedToRanges",value:function(e){var r=this,n=e.map(function(i){return r.graph.hasNode(i)?Array.from(r.graph.adjacentNodes(i)).filter(function(s){return s instanceof Ye}):[]});return Ng(Set,YA(n))}},{key:"rawValuesFromRange",value:regeneratorRuntime.mark(function t(e){var r,n,i,s;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:r=fe(e.addresses(this)),l.prev=1,r.s();case 3:if((n=r.n()).done){l.next=11;break}if(i=n.value,s=this.getScalarValue(i),s===le){l.next=9;break}return l.next=9,[W(s),i];case 9:l.next=3;break;case 11:l.next=16;break;case 13:l.prev=13,l.t0=l.catch(1),r.e(l.t0);case 16:return l.prev=16,r.f(),l.finish(16);case 19:case"end":return l.stop()}},t,this,[[1,13,16,19]])})},{key:"entriesFromRange",value:regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=fe(e.addresses(this)),o.prev=1,r.s();case 3:if((n=r.n()).done){o.next=9;break}return i=n.value,o.next=7,[i,this.getCell(i)];case 7:o.next=3;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(1),r.e(o.t0);case 14:return o.prev=14,r.f(),o.finish(14);case 17:case"end":return o.stop()}},t,this,[[1,11,14,17]])})},{key:"exchangeGraphNode",value:function(e,r){var n=this;this.graph.addNode(r);var i=this.graph.adjacentNodes(e);this.removeVertex(e),i.forEach(function(s){n.graph.hasNode(s)&&n.graph.addEdge(r,s)})}},{key:"exchangeOrAddGraphNode",value:function(e,r){e?this.exchangeGraphNode(e,r):this.graph.addNode(r)}},{key:"computeListOfValuesInRange",value:function(e){var r=[],n=fe(e.addresses(this)),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=this.getScalarValue(s);r.push(o)}}catch(l){n.e(l)}finally{n.f()}return r}},{key:"shrinkArrayToCorner",value:function(e){this.cleanAddressMappingUnderArray(e);var r=fe(this.adjacentArrayVertices(e)),n;try{for(r.s();!(n=r.n()).done;){var i=n.value,s=void 0;i instanceof dr?s=this.formulaDirectDependenciesToArray(i,e):s=this.rangeDirectDependenciesToArray(i,e);var o=!1,l=fe(s),u;try{for(l.s();!(u=l.n()).done;){var c=en(u.value,2),p=c[0],m=c[1];e.isLeftCorner(p)&&(o=!0),this.graph.addEdge(m,i),this.graph.markNodeAsSpecialRecentlyChanged(m)}}catch(f){l.e(f)}finally{l.f()}o||this.graph.removeEdge(e,i)}}catch(f){r.e(f)}finally{r.f()}this.graph.markNodeAsSpecialRecentlyChanged(e)}},{key:"isArrayInternalCell",value:function(e){var r=this.getCell(e);return r instanceof Ye&&!r.isLeftCorner(e)}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=Zi.empty(),e}},{key:"getAdjacentNodesAddresses",value:function(e){var r=this,n=this.graph.adjacentNodes(e),i=[];return n.forEach(function(s){var o=s;o instanceof Qt?i.push(Gf(o.start,o.end)):i.push(o.getAddress(r.lazilyTransformingAstService))}),i}},{key:"correctInfiniteRangesDependenciesByRangeVertex",value:function(e){var r=fe(this.graph.infiniteRanges),n;try{for(r.s();!(n=r.n()).done;){var i=n.value,s=i,o=e.range.intersectionWith(s.range);if(o!==void 0){var l=fe(o.addresses(this)),u;try{for(l.s();!(u=l.n()).done;){var c=u.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(c),i)}}catch(p){l.e(p)}finally{l.f()}}}}catch(p){r.e(p)}finally{r.f()}}},{key:"cleanAddressMappingUnderArray",value:function(e){var r=e.getRange(),n=fe(r.addresses(this)),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=e.getArrayCellValue(s);this.getCell(s)===e?e.isLeftCorner(s)?this.changes.addChange(new E(V.REF),s,o):(this.addressMapping.removeCell(s),this.changes.addChange(le,s,o)):this.changes.addChange(le,s,o)}}catch(l){n.e(l)}finally{n.f()}}},{key:"formulaDirectDependenciesToArray",value:regeneratorRuntime.mark(function t(e,r){var n,i,s,o,l,u,c,p;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(i=(n=this.formulaDependencyQuery(e))!==null&&n!==void 0?n:[],s=en(i,2),o=s[1],o!==void 0){f.next=3;break}return f.abrupt("return");case 3:l=fe(o),f.prev=4,l.s();case 6:if((u=l.n()).done){f.next=16;break}if(c=u.value,!(c instanceof Pn||c instanceof oe)){f.next=10;break}return f.abrupt("continue",14);case 10:if(!r.getRange().addressInRange(c)){f.next=14;break}return p=this.fetchCellOrCreateEmpty(c),f.next=14,[c,p];case 14:f.next=6;break;case 16:f.next=21;break;case 18:f.prev=18,f.t0=f.catch(4),l.e(f.t0);case 21:return f.prev=21,l.f(),f.finish(21);case 24:case"end":return f.stop()}},t,this,[[4,18,21,24]])})},{key:"rangeDirectDependenciesToArray",value:regeneratorRuntime.mark(function t(e,r){var n,i,s,o,l,u;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:n=this.rangeMapping.findSmallerRange(e.range),i=n.restRange,s=fe(i.addresses(this)),p.prev=2,s.s();case 4:if((o=s.n()).done){p.next=12;break}if(l=o.value,!r.getRange().addressInRange(l)){p.next=10;break}return u=this.fetchCellOrCreateEmpty(l),p.next=10,[l,u];case 10:p.next=4;break;case 12:p.next=17;break;case 14:p.prev=14,p.t0=p.catch(2),s.e(p.t0);case 17:return p.prev=17,s.f(),p.finish(17);case 20:case"end":return p.stop()}},t,this,[[2,14,17,20]])})},{key:"adjacentArrayVertices",value:regeneratorRuntime.mark(function t(e){var r,n,i,s;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:r=this.graph.adjacentNodes(e),n=fe(r),l.prev=2,n.s();case 4:if((i=n.n()).done){l.next=11;break}if(s=i.value,!(s instanceof dr||s instanceof Qt)){l.next=9;break}return l.next=9,s;case 9:l.next=4;break;case 11:l.next=16;break;case 13:l.prev=13,l.t0=l.catch(2),n.e(l.t0);case 16:return l.prev=16,n.f(),l.finish(16);case 19:case"end":return l.stop()}},t,this,[[2,13,16,19]])})},{key:"addStructuralNodesToChangeSet",value:function(){var e=fe(this.graph.specialNodesStructuralChanges),r;try{for(e.s();!(r=e.n()).done;){var n=r.value;this.graph.markNodeAsSpecialRecentlyChanged(n)}}catch(i){e.e(i)}finally{e.f()}}},{key:"fixRangesWhenAddingRows",value:function(e,r,n){for(var i=Array.from(this.rangeMapping.rangesInSheet(e)),s=0,o=i;s<o.length;s++){var l=o[s];if(l.range.includesRow(r+n))if(l.bruteForce){var u=l.range.rangeWithSameWidth(r,n),c=fe(u.addresses(this)),p;try{for(c.s();!(p=c.n()).done;){var m=p.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(m),l)}}catch(b){c.e(b)}finally{c.f()}}else{var f=l,d=this.rangeMapping.findSmallerRange(f.range);if(d.smallerRangeVertex!==void 0)continue;for(;d.smallerRangeVertex===void 0;){var h=new Qt(oe.spanFrom(f.range.start,f.range.width(),f.range.height()-1));this.rangeMapping.setRange(h),this.graph.addNode(h);var y=new oe($(f.range.start.sheet,f.range.start.col,f.range.end.row),f.range.end);this.addAllFromRange(y,f),this.graph.addEdge(h,f),f=h,d=this.rangeMapping.findSmallerRange(f.range)}this.graph.addEdge(d.smallerRangeVertex,f),this.addAllFromRange(d.restRange,f),this.graph.removeEdge(d.smallerRangeVertex,l)}}}},{key:"addAllFromRange",value:function(e,r){var n=fe(e.addresses(this)),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(s),r)}}catch(o){n.e(o)}finally{n.f()}}},{key:"fixRangesWhenAddingColumns",value:function(e,r,n){var i=fe(this.rangeMapping.rangesInSheet(e)),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;if(o.range.includesColumn(r+n)){var l=void 0;o.bruteForce?l=o.range.rangeWithSameHeight(r,n):l=oe.spanFrom($(e,r,o.range.end.row),n,1);var u=fe(l.addresses(this)),c;try{for(u.s();!(c=u.n()).done;){var p=c.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(p),o)}}catch(m){u.e(m)}finally{u.f()}}}}catch(m){i.e(m)}finally{i.f()}}},{key:"exchangeOrAddFormulaVertex",value:function(e){var r=e.getAddress(this.lazilyTransformingAstService),n=oe.spanFrom(r,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(r);if(e instanceof Ye&&this.setArray(n,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(r,e),e instanceof Ye){if(!this.isThereSpaceForArray(e))return;var s=fe(n.addresses(this)),o;try{for(s.s();!(o=s.n()).done;){var l=o.value;if(!e.isLeftCorner(l)){var u=this.getCell(l);this.exchangeOrAddGraphNode(u,e)}}}catch(f){s.e(f)}finally{s.f()}}var c=fe(n.addresses(this)),p;try{for(c.s();!(p=c.n()).done;){var m=p.value;this.addressMapping.setCell(m,e)}}catch(f){c.e(f)}finally{c.f()}}},{key:"setAddressMappingForArrayVertex",value:function(e,r){if(this.addressMapping.setCell(r,e),e instanceof Ye){var n=oe.spanFromOrUndef(r,e.width,e.height);if(n!==void 0&&(this.setArray(n,e),!!this.isThereSpaceForArray(e))){var i=fe(n.addresses(this)),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;this.addressMapping.setCell(o,e)}}catch(l){i.e(l)}finally{i.f()}}}}},{key:"truncateRanges",value:function(e,r){var n=this.rangeMapping.truncateRanges(e,r),i=n.verticesToRemove,s=n.verticesToMerge,o=n.verticesWithChangedSize,l=fe(s),u;try{for(l.s();!(u=l.n()).done;){var c=en(u.value,2),p=c[0],m=c[1];this.mergeRangeVertices(p,m)}}catch(y){l.e(y)}finally{l.f()}var f=fe(i),d;try{for(f.s();!(d=f.n()).done;){var h=d.value;this.removeVertexAndCleanupDependencies(h)}}catch(y){f.e(y)}finally{f.f()}return o}},{key:"fixArraysAfterAddingRow",value:function(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,r,n),!(r<=0)){var i=fe(this.arrayMapping.arraysInRows(yn.fromRowStartAndEnd(e,r-1,r-1))),s;try{for(i.s();!(s=i.n()).done;)for(var o=en(s.value,2),l=o[1],u=l.getRange(),c=u.start.col;c<=u.end.col;++c)for(var p=r;p<=u.end.row;++p){var m=$(e,c,p),f=$(e,c,p+n),d=l.getArrayCellValue(m);this.addressMapping.moveCell(f,m),this.changes.addChange(le,f,d)}}catch(h){i.e(h)}finally{i.f()}}}},{key:"fixArraysAfterRemovingRows",value:function(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,r,-n),!(r<=0)){var i=fe(this.arrayMapping.arraysInRows(yn.fromRowStartAndEnd(e,r-1,r-1))),s;try{for(i.s();!(s=i.n()).done;){var o=en(s.value,2),l=o[1];if(this.isThereSpaceForArray(l)){var u=fe(l.getRange().addresses(this)),c;try{for(u.s();!(c=u.n()).done;){var p=c.value;this.addressMapping.setCell(p,l)}}catch(m){u.e(m)}finally{u.f()}}else this.setNoSpaceIfArray(l)}}catch(m){i.e(m)}finally{i.f()}}}},{key:"fixArraysAfterAddingColumn",value:function(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,r,n),!(r<=0)){var i=fe(this.arrayMapping.arraysInCols(ea.fromColumnStartAndEnd(e,r-1,r-1))),s;try{for(i.s();!(s=i.n()).done;)for(var o=en(s.value,2),l=o[1],u=l.getRange(),c=u.start.row;c<=u.end.row;++c)for(var p=r;p<=u.end.col;++p){var m=$(e,p,c),f=$(e,p+n,c),d=l.getArrayCellValue(m);this.addressMapping.moveCell(f,m),this.changes.addChange(le,f,d)}}catch(h){i.e(h)}finally{i.f()}}}},{key:"fixArraysAfterRemovingColumns",value:function(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,r,-n),!(r<=0)){var i=fe(this.arrayMapping.arraysInCols(ea.fromColumnStartAndEnd(e,r-1,r-1))),s;try{for(i.s();!(s=i.n()).done;){var o=en(s.value,2),l=o[1];if(this.isThereSpaceForArray(l)){var u=fe(l.getRange().addresses(this)),c;try{for(u.s();!(c=u.n()).done;){var p=c.value;this.addressMapping.setCell(p,l)}}catch(m){u.e(m)}finally{u.f()}}else this.setNoSpaceIfArray(l)}}catch(m){i.e(m)}finally{i.f()}}}},{key:"shrinkPossibleArrayAndGetCell",value:function(e){var r=this.getCell(e);return r instanceof Ye?(this.setNoSpaceIfArray(r),this.getCell(e)):r}},{key:"setNoSpaceIfArray",value:function(e){e instanceof Ye&&(this.shrinkArrayToCorner(e),e.setNoSpace())}},{key:"removeVertex",value:function(e){this.removeVertexAndCleanupDependencies(e),e instanceof Qt&&this.rangeMapping.removeRange(e)}},{key:"mergeRangeVertices",value:function(e,r){var n=this,i=this.graph.adjacentNodes(r);this.removeVertexAndCleanupDependencies(r),this.graph.softRemoveEdge(e,r),i.forEach(function(s){n.graph.hasNode(s)&&n.graph.addEdge(e,s)})}},{key:"removeVertexAndCleanupDependencies",value:function(e){for(var r=new Set(this.graph.removeNode(e));r.size>0;){var n=r.values().next().value;r.delete(n),this.graph.hasNode(n)&&this.graph.adjacentNodesCount(n)===0&&((n instanceof Qt||n instanceof ta)&&this.graph.removeNode(n).forEach(function(i){return r.add(i)}),n instanceof Qt?this.rangeMapping.removeRange(n):n instanceof ta&&this.addressMapping.removeCell(n.address))}}}],[{key:"buildEmpty",value:function(e,r,n,i,s){return new a(new DA(r.chooseAddressMappingPolicy),new qA,new KA(r.translationPackage),new IA,s,e,n,i)}}]),a}();function yce(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Dk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function bce(a,t,e){return t&&Dk(a.prototype,t),e&&Dk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var ta=function(){function a(t){yce(this,a),this.address=t}return bce(a,[{key:"getCellValue",value:function(){return le}}]),a}();function gce(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Ik(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function vce(a,t,e){return t&&Ik(a.prototype,t),e&&Ik(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var vn=function(){function a(t,e){gce(this,a),this.parsedValue=t,this.rawValue=e}return vce(a,[{key:"getValues",value:function(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}},{key:"setValues",value:function(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}},{key:"getCellValue",value:function(){return this.parsedValue}},{key:"setCellValue",value:function(e){throw"SetCellValue is deprecated for ValueCellVertex"}}]),a}();function Tce(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Pk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Nce(a,t,e){return t&&Pk(a.prototype,t),e&&Pk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Ta=function(){function a(t,e){Tce(this,a),this.errors=t,this.rawInput=e}return Nce(a,[{key:"getCellValue",value:function(){return E.parsingError()}},{key:"getFormula",value:function(){return this.rawInput}}]),a}();var Cqe=M(xr()),Aqe=M(q());var Iqe=M(ie());function Xs(a,t){return Sce(a)||Ace(a,t)||_k(a,t)||Cce()}function Cce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ace(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Sce(a){if(Array.isArray(a))return a}function Tn(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=_k(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function _k(a,t){if(!!a){if(typeof a=="string")return kk(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return kk(a,t)}}function kk(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function wce(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Fk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Ece(a,t,e){return t&&Fk(a.prototype,t),e&&Fk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Cg=function(){function a(t,e){wce(this,a),this.width=t,this.height=e,this.mapping=new Map}return Ece(a,[{key:"getCell",value:function(e){var r;return(r=this.mapping.get(e.col))===null||r===void 0?void 0:r.get(e.row)}},{key:"setCell",value:function(e,r){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);var n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,r)}},{key:"has",value:function(e){var r;return!!((r=this.mapping.get(e.col))===null||r===void 0?void 0:r.get(e.row))}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){var r;(r=this.mapping.get(e.col))===null||r===void 0||r.delete(e.row)}},{key:"addRows",value:function(e,r){this.mapping.forEach(function(n){var i=new Map;n.forEach(function(s,o){o>=e&&(i.set(o+r,s),n.delete(o))}),i.forEach(function(s,o){n.set(o,s)})}),this.height+=r}},{key:"addColumns",value:function(e,r){var n=this,i=new Map;this.mapping.forEach(function(s,o){o>=e&&(i.set(o+r,s),n.mapping.delete(o))}),i.forEach(function(s,o){n.mapping.set(o,s)}),this.width+=r}},{key:"removeRows",value:function(e){this.mapping.forEach(function(i){var s=new Map;i.forEach(function(o,l){l>=e.rowStart&&(i.delete(l),l>e.rowEnd&&s.set(l-e.numberOfRows,o))}),s.forEach(function(o,l){i.set(l,o)})});var r=Math.min(this.height-1,e.rowEnd),n=Math.max(0,r-e.rowStart+1);this.height=Math.max(0,this.height-n)}},{key:"removeColumns",value:function(e){var r=this,n=new Map;this.mapping.forEach(function(o,l){l>=e.columnStart&&(r.mapping.delete(l),l>e.columnEnd&&n.set(l-e.numberOfColumns,o))}),n.forEach(function(o,l){r.mapping.set(l,o)});var i=Math.min(this.width-1,e.columnEnd),s=Math.max(0,i-e.columnStart+1);this.width=Math.max(0,this.width-s)}},{key:"getEntries",value:regeneratorRuntime.mark(function t(e){var r,n,i,s,o,l,u,c,p,m;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:r=Tn(this.mapping),d.prev=1,r.s();case 3:if((n=r.n()).done){d.next=24;break}i=Xs(n.value,2),s=i[0],o=i[1],l=Tn(o),d.prev=6,l.s();case 8:if((u=l.n()).done){d.next=14;break}return c=Xs(u.value,2),p=c[0],m=c[1],d.next=12,[$(e,s,p),m];case 12:d.next=8;break;case 14:d.next=19;break;case 16:d.prev=16,d.t0=d.catch(6),l.e(d.t0);case 19:return d.prev=19,l.f(),d.finish(19);case 22:d.next=3;break;case 24:d.next=29;break;case 26:d.prev=26,d.t1=d.catch(1),r.e(d.t1);case 29:return d.prev=29,r.f(),d.finish(29);case 32:case"end":return d.stop()}},t,this,[[1,26,29,32],[6,16,19,22]])})},{key:"verticesFromColumn",value:regeneratorRuntime.mark(function t(e){var r,n,i,s,o,l;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(r=this.mapping.get(e),r!==void 0){c.next=3;break}return c.abrupt("return");case 3:n=Tn(r),c.prev=4,n.s();case 6:if((i=n.n()).done){c.next=12;break}return s=Xs(i.value,2),o=s[0],l=s[1],c.next=10,l;case 10:c.next=6;break;case 12:c.next=17;break;case 14:c.prev=14,c.t0=c.catch(4),n.e(c.t0);case 17:return c.prev=17,n.f(),c.finish(17);case 20:case"end":return c.stop()}},t,this,[[4,14,17,20]])})},{key:"verticesFromRow",value:regeneratorRuntime.mark(function t(e){var r,n,i,s;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:r=Tn(this.mapping.values()),l.prev=1,r.s();case 3:if((n=r.n()).done){l.next=11;break}if(i=n.value,s=i.get(e),s===void 0){l.next=9;break}return l.next=9,s;case 9:l.next=3;break;case 11:l.next=16;break;case 13:l.prev=13,l.t0=l.catch(1),r.e(l.t0);case 16:return l.prev=16,r.f(),l.finish(16);case 19:case"end":return l.stop()}},t,this,[[1,13,16,19]])})},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){var r,n,i,s,o,l,u,c,p;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:r=Tn(e.columns()),f.prev=1,r.s();case 3:if((n=r.n()).done){f.next=27;break}if(i=n.value,s=this.mapping.get(i),s!==void 0){f.next=8;break}return f.abrupt("continue",25);case 8:o=Tn(s),f.prev=9,o.s();case 11:if((l=o.n()).done){f.next=17;break}return u=Xs(l.value,2),c=u[0],p=u[1],f.next=15,p;case 15:f.next=11;break;case 17:f.next=22;break;case 19:f.prev=19,f.t0=f.catch(9),o.e(f.t0);case 22:return f.prev=22,o.f(),f.finish(22);case 25:f.next=3;break;case 27:f.next=32;break;case 29:f.prev=29,f.t1=f.catch(1),r.e(f.t1);case 32:return f.prev=32,r.f(),f.finish(32);case 35:case"end":return f.stop()}},t,this,[[1,29,32,35],[9,19,22,25]])})},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){var r,n,i,s,o,l,u;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:r=Tn(this.mapping.values()),p.prev=1,r.s();case 3:if((n=r.n()).done){p.next=26;break}i=n.value,s=Tn(e.rows()),p.prev=6,s.s();case 8:if((o=s.n()).done){p.next=16;break}if(l=o.value,u=i.get(l),u===void 0){p.next=14;break}return p.next=14,u;case 14:p.next=8;break;case 16:p.next=21;break;case 18:p.prev=18,p.t0=p.catch(6),s.e(p.t0);case 21:return p.prev=21,s.f(),p.finish(21);case 24:p.next=3;break;case 26:p.next=31;break;case 28:p.prev=28,p.t1=p.catch(1),r.e(p.t1);case 31:return p.prev=31,r.f(),p.finish(31);case 34:case"end":return p.stop()}},t,this,[[1,28,31,34],[6,18,21,24]])})},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){var r,n,i,s,o,l,u,c,p;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:r=Tn(this.mapping.entries()),f.prev=1,r.s();case 3:if((n=r.n()).done){f.next=26;break}i=Xs(n.value,2),s=i[0],o=i[1],l=Tn(e.rows()),f.prev=6,l.s();case 8:if((u=l.n()).done){f.next=16;break}if(c=u.value,p=o.get(c),p===void 0){f.next=14;break}return f.next=14,[$(e.sheet,s,c),p];case 14:f.next=8;break;case 16:f.next=21;break;case 18:f.prev=18,f.t0=f.catch(6),l.e(f.t0);case 21:return f.prev=21,l.f(),f.finish(21);case 24:f.next=3;break;case 26:f.next=31;break;case 28:f.prev=28,f.t1=f.catch(1),r.e(f.t1);case 31:return f.prev=31,r.f(),f.finish(31);case 34:case"end":return f.stop()}},t,this,[[1,28,31,34],[6,18,21,24]])})},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){var r,n,i,s,o,l,u,c,p;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:r=Tn(e.columns()),f.prev=1,r.s();case 3:if((n=r.n()).done){f.next=26;break}if(i=n.value,s=this.mapping.get(i),s===void 0){f.next=24;break}o=Tn(s.entries()),f.prev=8,o.s();case 10:if((l=o.n()).done){f.next=16;break}return u=Xs(l.value,2),c=u[0],p=u[1],f.next=14,[$(e.sheet,i,c),p];case 14:f.next=10;break;case 16:f.next=21;break;case 18:f.prev=18,f.t0=f.catch(8),o.e(f.t0);case 21:return f.prev=21,o.f(),f.finish(21);case 24:f.next=3;break;case 26:f.next=31;break;case 28:f.prev=28,f.t1=f.catch(1),r.e(f.t1);case 31:return f.prev=31,r.f(),f.finish(31);case 34:case"end":return f.stop()}},t,this,[[1,28,31,34],[8,18,21,24]])})},{key:"vertices",value:regeneratorRuntime.mark(function t(){var e,r,n,i,s,o,l,u,c,p;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:e=Tn(this.mapping),f.prev=1,e.s();case 3:if((r=e.n()).done){f.next=25;break}n=Xs(r.value,2),i=n[0],s=n[1],o=Tn(s),f.prev=6,o.s();case 8:if((l=o.n()).done){f.next=15;break}if(u=Xs(l.value,2),c=u[0],p=u[1],p===void 0){f.next=13;break}return f.next=13,p;case 13:f.next=8;break;case 15:f.next=20;break;case 17:f.prev=17,f.t0=f.catch(6),o.e(f.t0);case 20:return f.prev=20,o.f(),f.finish(20);case 23:f.next=3;break;case 25:f.next=30;break;case 27:f.prev=27,f.t1=f.catch(1),e.e(f.t1);case 30:return f.prev=30,e.f(),f.finish(30);case 33:case"end":return f.stop()}},t,this,[[1,27,30,33],[6,17,20,23]])})}]),a}();var Mqe=M(xr());var qqe=M(q());var Zqe=M(ie());function Rce(a){return Dce(a)||Oce(a)||Vce(a)||xce()}function xce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vce(a,t){if(!!a){if(typeof a=="string")return eS(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return eS(a,t)}}function Oce(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Dce(a){if(Array.isArray(a))return eS(a)}function eS(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Ice(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function jk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Pce(a,t,e){return t&&jk(a.prototype,t),e&&jk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var tS=function(){function a(t,e){Ice(this,a),this.width=t,this.height=e,this.mapping=new Array(e);for(var r=0;r<e;r++)this.mapping[r]=new Array(t)}return Pce(a,[{key:"getCell",value:function(e){return this.getCellVertex(e.col,e.row)}},{key:"setCell",value:function(e,r){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);var n=this.mapping[e.row];n||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=r}},{key:"has",value:function(e){var r=this.mapping[e.row];return r?!!r[e.col]:!1}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}},{key:"addRows",value:function(e,r){for(var n,i=[],s=0;s<r;s++)i.push(new Array(this.width));(n=this.mapping).splice.apply(n,[e,0].concat(i)),this.height+=r}},{key:"addColumns",value:function(e,r){for(var n=0;n<this.height;n++){var i;(i=this.mapping[n]).splice.apply(i,[e,0].concat(Rce(new Array(r))))}this.width+=r}},{key:"removeRows",value:function(e){this.mapping.splice(e.rowStart,e.numberOfRows);var r=Math.min(this.height-1,e.rowEnd),n=Math.max(0,r-e.rowStart+1);this.height=Math.max(0,this.height-n)}},{key:"removeColumns",value:function(e){for(var r=0;r<this.height;r++)this.mapping[r].splice(e.columnStart,e.numberOfColumns);var n=Math.min(this.width-1,e.columnEnd),i=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-i)}},{key:"getEntries",value:regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=0;case 1:if(!(r<this.height)){o.next=14;break}n=0;case 3:if(!(n<this.width)){o.next=11;break}if(i=this.getCellVertex(n,r),!i){o.next=8;break}return o.next=8,[$(e,n,r),i];case 8:++n,o.next=3;break;case 11:++r,o.next=1;break;case 14:case"end":return o.stop()}},t,this)})},{key:"verticesFromColumn",value:regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=0;case 1:if(!(r<this.height)){s.next=9;break}if(n=this.getCellVertex(e,r),!n){s.next=6;break}return s.next=6,n;case 6:++r,s.next=1;break;case 9:case"end":return s.stop()}},t,this)})},{key:"verticesFromRow",value:regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=0;case 1:if(!(r<this.width)){s.next=9;break}if(n=this.getCellVertex(r,e),!n){s.next=6;break}return s.next=6,n;case 6:++r,s.next=1;break;case 9:case"end":return s.stop()}},t,this)})},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=e.columnStart;case 1:if(!(r<=e.columnEnd)){o.next=14;break}n=0;case 3:if(!(n<this.height)){o.next=11;break}if(i=this.getCellVertex(r,n),!i){o.next=8;break}return o.next=8,i;case 8:++n,o.next=3;break;case 11:++r,o.next=1;break;case 14:case"end":return o.stop()}},t,this)})},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=0;case 1:if(!(r<this.width)){o.next=14;break}n=e.rowStart;case 3:if(!(n<=e.rowEnd)){o.next=11;break}if(i=this.getCellVertex(r,n),!i){o.next=8;break}return o.next=8,i;case 8:++n,o.next=3;break;case 11:++r,o.next=1;break;case 14:case"end":return o.stop()}},t,this)})},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=0;case 1:if(!(r<this.width)){o.next=14;break}n=e.rowStart;case 3:if(!(n<=e.rowEnd)){o.next=11;break}if(i=this.getCellVertex(r,n),!i){o.next=8;break}return o.next=8,[$(e.sheet,r,n),i];case 8:++n,o.next=3;break;case 11:++r,o.next=1;break;case 14:case"end":return o.stop()}},t,this)})},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=0;case 1:if(!(r<this.height)){o.next=14;break}n=e.columnStart;case 3:if(!(n<=e.columnEnd)){o.next=11;break}if(i=this.getCellVertex(n,r),!i){o.next=8;break}return o.next=8,[$(e.sheet,n,r),i];case 8:++n,o.next=3;break;case 11:++r,o.next=1;break;case 14:case"end":return o.stop()}},t,this)})},{key:"vertices",value:regeneratorRuntime.mark(function t(){var e,r,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=0;case 1:if(!(e<this.height)){s.next=14;break}r=0;case 3:if(!(r<this.width)){s.next=11;break}if(n=this.getCellVertex(r,e),!n){s.next=8;break}return s.next=8,n;case 8:++r,s.next=3;break;case 11:++e,s.next=1;break;case 14:case"end":return s.stop()}},t,this)})},{key:"getCellVertex",value:function(e,r){var n;return(n=this.mapping[r])===null||n===void 0?void 0:n[e]}}]),a}();function rS(a){return rS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rS(a)}function _ce(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Mk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function kce(a,t,e){return t&&Mk(a.prototype,t),e&&Mk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var V;(function(a){a.DIV_BY_ZERO="DIV_BY_ZERO",a.NAME="NAME",a.VALUE="VALUE",a.NUM="NUM",a.NA="NA",a.CYCLE="CYCLE",a.REF="REF",a.SPILL="SPILL",a.LIC="LIC",a.ERROR="ERROR"})(V||(V={}));var zr;(function(a){a.FORMULA="FORMULA",a.VALUE="VALUE",a.ARRAY="ARRAY",a.EMPTY="EMPTY",a.ARRAYFORMULA="ARRAYFORMULA"})(zr||(zr={}));var Bk=function(t,e){return t instanceof Ye?t.isLeftCorner(e)?zr.ARRAYFORMULA:zr.ARRAY:t instanceof Qr||t instanceof Ta?zr.FORMULA:t instanceof vn?zr.VALUE:zr.EMPTY},Ag;(function(a){a.EMPTY="EMPTY",a.NUMBER="NUMBER",a.STRING="STRING",a.BOOLEAN="BOOLEAN",a.ERROR="ERROR"})(Ag||(Ag={}));var nS;(function(a){a.NUMBER="NUMBER"})(nS||(nS={}));var ra=Object.assign(Object.assign({},Ag),nS),Lk=Object.assign(Object.assign({},Ag),te),AA=function(t){switch(t){case ra.EMPTY:return 0;case ra.NUMBER:return 1;case ra.STRING:return 2;case ra.BOOLEAN:return 3;case ra.ERROR:return 4}throw new Error("Cell value not computed")},Gc=function(t){if(t===le)return ra.EMPTY;if(t instanceof E||t instanceof Q)return ra.ERROR;if(typeof t=="string")return ra.STRING;if(Ce(t))return ra.NUMBER;if(typeof t=="boolean")return ra.BOOLEAN;throw new Error("Cell value not computed")},Uk=function(t){return Ce(t)?t_(t):Gc(t)},zk=function(t){if(Ce(t))return r_(t)},E=function(){function a(t,e,r){_ce(this,a),this.type=t,this.message=e,this.root=r}return kce(a,[{key:"attachRootVertex",value:function(e){return this.root===void 0?new a(this.type,this.message,e):this}}],[{key:"parsingError",value:function(){return new a(V.ERROR,D.ParseError)}}]),a}(),hb=function(t,e){return{sheet:t,row:e}},q9=function(t){return t.row<0},yb=function(t,e){return{sheet:t,col:e}},q4=function(t){return t.col<0},$=function(t,e,r){return{sheet:t,col:e,row:r}},Kt=function(t){return t.col<0||t.row<0},Gk=function(t,e,r,n){return $(e,t.col+r,t.row+n)},Hc=function(t){return"".concat(t.sheet,",").concat(t.row,",").concat(t.col)};function gt(a){return a&&(rS(a)==="object"||typeof a=="function")?"col"in a&&typeof a.col=="number"&&"row"in a&&typeof a.row=="number"&&"sheet"in a&&typeof a.sheet=="number":!1}var mr=function(t,e){var r;return(r=t.sheet)!==null&&r!==void 0?r:e.sheet},Yi=function(t,e){return t.sheet===e.sheet&&t.col===e.col&&t.row===e.row};function Fce(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Hk(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function jce(a,t,e){return t&&Hk(a.prototype,t),e&&Hk(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Sg=function(){function a(t,e,r){Fce(this,a);var n;this.value=e,this.address=r,this.type=t.type,this.message=(n=t.message)!==null&&n!==void 0?n:""}return jce(a,[{key:"toString",value:function(){return this.value}},{key:"valueOf",value:function(){return this.value}}]),a}();var ait=M(q());"use strict";var Jk=pe(),Rg=Ne(),Kce=qy(),Xce=uf(),Yce=Hy(),Qk=Zk(),xg=zt(),Vg=bC(),Og=Xa().enforce,Zce=XT(),Jce=!Jk.ActiveXObject&&"ActiveXObject"in Jk,nd,eF=function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},Qce=Yce("WeakMap",eF,Qk);Zce&&Jce&&(nd=Qk.getConstructor(eF,"WeakMap",!0),Xce.enable(),Wc=Qce.prototype,sS=Rg(Wc.delete),ad=Rg(Wc.has),oS=Rg(Wc.get),lS=Rg(Wc.set),Kce(Wc,{delete:function(a){if(xg(a)&&!Vg(a)){var t=Og(this);return t.frozen||(t.frozen=new nd),sS(this,a)||t.frozen.delete(a)}return sS(this,a)},has:function(t){if(xg(t)&&!Vg(t)){var e=Og(this);return e.frozen||(e.frozen=new nd),ad(this,t)||e.frozen.has(t)}return ad(this,t)},get:function(t){if(xg(t)&&!Vg(t)){var e=Og(this);return e.frozen||(e.frozen=new nd),ad(this,t)?oS(this,t):e.frozen.get(t)}return oS(this,t)},set:function(t,e){if(xg(t)&&!Vg(t)){var r=Og(this);r.frozen||(r.frozen=new nd),ad(this,t)?lS(this,t,e):r.frozen.set(t,e)}else lS(this,t,e);return this}}));var Wc,sS,ad,oS,lS;var git=M(ie());"use strict";var epe=he(),tpe=Ne(),rpe=by(),npe=Gn(),tF=Rr(),ape=gy(),ipe=tpe("".indexOf);epe({target:"String",proto:!0,forced:!ape("includes")},{includes:function(t){return!!~ipe(tF(npe(this)),tF(rpe(t)),arguments.length>1?arguments[1]:void 0)}});var jWe=M(q());var YWe=M(ie());function spe(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=ope(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function ope(a,t){if(!!a){if(typeof a=="string")return rF(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return rF(a,t)}}function rF(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Dg(a){return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dg(a)}function ze(a,t,e){if(typeof a=="undefined")return na.defaultConfig[e];if(typeof t=="string"){if(Dg(a)===t)return a;throw new Pe(t,e)}else{if(t.includes(a))return a;throw new ub(t.map(function(r){return"'".concat(r,"'")}).join(" "),e)}}function ol(a,t,e){if(a<e)throw new ob(t,e)}function nF(a,t,e){if(a>e)throw new lb(t,e)}function id(a,t,e,r){if(t(a))return a;if(typeof a=="undefined")return na.defaultConfig[r];throw new Pe(e,r)}function uS(){for(var a=new Map,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e.forEach(function(u){var c=a.get(u.value)||[];c.push(u.name),a.set(u.value,c)});var n=[],i=spe(a.values()),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;o.length>1&&n.push(o)}}catch(u){i.e(u)}finally{i.f()}if(n.length>0){n.forEach(function(u){return u.sort()});var l=n.map(function(u){return"[".concat(u,"]")}).join("; ");throw new Error("Config initialization failed. Parameters in conflict: ".concat(l))}}function K(a,t,e){if(Dg(a)!==t)throw new Pe(t,e)}var r$e=M(ie());"use strict";var lpe=he(),aF=Ne(),upe=Vi().f,cpe=Mo(),iF=Rr(),ppe=by(),mpe=Gn(),fpe=gy(),dpe=Es(),sF=aF("".endsWith),hpe=aF("".slice),ype=Math.min,oF=fpe("endsWith"),bpe=!dpe&&!oF&&!!function(){var a=upe(String.prototype,"endsWith");return a&&!a.writable}();lpe({target:"String",proto:!0,forced:!bpe&&!oF},{endsWith:function(t){var e=iF(mpe(this));ppe(t);var r=arguments.length>1?arguments[1]:void 0,n=e.length,i=r===void 0?n:ype(cpe(r),n),s=iF(t);return sF?sF(e,s,i):hpe(e,i-s.length,i)===s}});function lF(a,t,e){a=a.replace(/\s\s+/g," ").trim().toLowerCase();var r=a.substring(a.length-2);r==="am"||r==="pm"?a=a.substring(0,a.length-2).trim():(r=a.substring(a.length-1),r==="a"||r==="p"?a=a.substring(0,a.length-1).trim():r=void 0);var n=a.split(/[ /.-]/g);n.length>=2&&n[n.length-2].includes(":")&&(n[n.length-2]=n[n.length-2]+"."+n[n.length-1],n.pop());var i=n[n.length-1].split(":");if(r!==void 0&&i.push(r),n.length===1)return uF(i,e);if(i.length===1)return cF(n,t);var s=cF(n.slice(0,n.length-1),t),o=uF(i,e);if(s!==void 0)return o===void 0?void 0:Object.assign(Object.assign({},s),o)}var Ig=/^ss\.(s+|0+)$/;function uF(a,t){if(t!==void 0){t=t.toLowerCase(),t.endsWith("am/pm")?t=t.substring(0,t.length-5).trim():t.endsWith("a/p")&&(t=t.substring(0,t.length-3).trim());var e=t.split(":"),r=void 0;a[a.length-1]==="am"||a[a.length-1]==="a"?(r=!1,a.pop()):(a[a.length-1]==="pm"||a[a.length-1]==="p")&&(r=!0,a.pop());var n=0;if(e.length>=1&&Ig.test(e[e.length-1])&&(n=e[e.length-1].length-3,e[e.length-1]="ss"),a.length===e.length){var i=e.indexOf("hh"),s=e.indexOf("mm"),o=e.indexOf("ss"),l=i!==-1?a[i]:"0";if(!!/^\d+$/.test(l)){var u=Number(l);if(r!==void 0){if(u<0||u>12)return;u=u%12,r&&(u=u+12)}var c=s!==-1?a[s]:"0";if(!!/^\d+$/.test(c)){var p=Number(c),m=o!==-1?a[o]:"0";if(!!/^\d+(\.\d+)?$/.test(m)){var f=Number(m);return f=Math.round(f*Math.pow(10,n))/Math.pow(10,n),{hours:u,minutes:p,seconds:f}}}}}}}function cF(a,t){if(t!==void 0){var e=t.toLowerCase().split(/[ /.-]/g);if(a.length===e.length){var r=e.indexOf("mm"),n=e.indexOf("dd"),i=e.indexOf("yyyy"),s=e.indexOf("yy");if(!(!(r in a)||!(n in a)||!(i in a)&&!(s in a))&&!(i in a&&s in a)){var o;if(i in a){var l=a[i];if(/^\d+$/.test(l)){if(o=Number(l),o<1e3||o>9999)return}else return}else{var u=a[s];if(/^\d+$/.test(u)){if(o=Number(u),o<0||o>99)return}else return}var c=a[r];if(!!/^\d+$/.test(c)){var p=Number(c),m=a[n];if(!!/^\d+$/.test(m)){var f=Number(m);return{year:o,month:p,day:f}}}}}}}var b$e=M(q());var A$e=M(ie());function pF(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=gpe(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function gpe(a,t){if(!!a){if(typeof a=="string")return mF(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mF(a,t)}}function mF(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function vpe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function fF(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Tpe(a,t,e){return t&&fF(a.prototype,t),e&&fF(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Pg(a){return Pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pg(a)}var cS=[31,28,31,30,31,30,31,31,30,31,30,31],$c=[0,31,59,90,120,151,181,212,243,273,304,334];function ll(a){return a&&(Pg(a)==="object"||typeof a=="function")?"year"in a&&typeof a.year=="number"&&"month"in a&&typeof a.month=="number"&&"day"in a&&typeof a.day=="number":!1}function pS(a){return a&&(Pg(a)==="object"||typeof a=="function")?"hours"in a&&typeof a.hours=="number"&&"minutes"in a&&typeof a.minutes=="number"&&"seconds"in a&&typeof a.seconds=="number":!1}var Npe={year:9999,month:12,day:31},dF=function(){function a(t){vpe(this,a),this.config=t,this.minDateAboluteValue=this.dateToNumberFromZero(t.nullDate),this.maxDateValue=this.dateToNumber(Npe),this.leapYear1900=t.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=t.parseDateTime}return Tpe(a,[{key:"getWithinBounds",value:function(e){return e<=this.maxDateValue&&e>=0?e:void 0}},{key:"dateStringToDateNumber",value:function(e){var r=this.parseDateTimeFromConfigFormats(e),n=r.dateTime,i=r.dateFormat,s=i===void 0?"":i,o=r.timeFormat,l=o===void 0?"":o;if(n!==void 0)return pS(n)?ll(n)?new Lc(Ys(n)+this.dateToNumber(n),s+" "+l):new Bc(Ys(n),l):ll(n)?new Mc(this.dateToNumber(n),s):0}},{key:"parseDateTimeFromConfigFormats",value:function(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}},{key:"getNullYear",value:function(){return this.config.nullYear}},{key:"getEpochYearZero",value:function(){return this.epochYearZero}},{key:"isValidDate",value:function(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=cS[e.month-1]}},{key:"dateToNumber",value:function(e){return this.dateToNumberFromZero(e)-this.minDateAboluteValue}},{key:"relativeNumberToAbsoluteNumber",value:function(e){return e+this.minDateAboluteValue-(this.leapYear1900?1:0)}},{key:"numberToSimpleDate",value:function(e){var r=Math.floor(e)+this.minDateAboluteValue,n=Math.floor(r/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=r?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>r&&n--;var i=r-this.dateToNumberFromZero({year:n,month:1,day:1}),s=Cpe(i-(this.isLeapYear(n)&&i>=59?1:0)),o=i-$c[s]-(this.isLeapYear(n)&&s>1?1:0);return{year:n,month:s+1,day:o+1}}},{key:"numberToSimpleDateTime",value:function(e){return Object.assign(Object.assign({},this.numberToSimpleDate(Math.floor(e))),es(e%1))}},{key:"leapYearsCount",value:function(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}},{key:"daysInMonth",value:function(e,r){return this.isLeapYear(e)&&r===2?29:cS[r-1]}},{key:"endOfMonth",value:function(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}},{key:"toBasisUS",value:function(e,r){return e.day===31&&(e.day=30),e.day===30&&r.day===31&&(r.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,r.month===2&&r.day===this.daysInMonth(r.year,r.month)&&(r.day=30)),[e,r]}},{key:"yearLengthForBasis",value:function(e,r){return e.year!==r.year?e.year+1!==r.year||e.month<r.month||e.month===r.month&&e.day<r.day?(this.leapYearsCount(r.year)-this.leapYearsCount(e.year-1))/(r.year-e.year+1)+365:this.countLeapDays(r)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}},{key:"parseSingleFormat",value:function(e,r,n){var i=this.parseDateTime(e,r,n);if(!(ll(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}},{key:"parseDateTimeFromFormats",value:function(e,r,n){var i=r.length===0?[void 0]:r,s=n.length===0?[void 0]:n,o=pF(i),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=pF(s),p;try{for(c.s();!(p=c.n()).done;){var m=p.value,f=this.parseSingleFormat(e,u,m);if(f!==void 0)return{dateTime:f,timeFormat:m,dateFormat:u}}}catch(d){c.e(d)}finally{c.f()}}}catch(d){o.e(d)}finally{o.f()}return{}}},{key:"countLeapDays",value:function(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}},{key:"dateToNumberFromZero",value:function(e){return 365*e.year+$c[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}},{key:"isLeapYear",value:function(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}]),a}();function Cpe(a){var t=0;return $c[t+6]<=a&&(t+=6),$c[t+3]<=a&&(t+=3),$c[t+2]<=a?t+=2:$c[t+1]<=a&&(t+=1),t}function mS(a,t){var e=12*a.year+a.month-1+t;return{year:Math.floor(e/12),month:e%12+1,day:a.day}}function hF(a){return{year:a.year,month:a.month,day:Math.min(a.day,cS[a.month-1])}}function _g(a){return Math.round(a*3600*24)/(3600*24)}function es(a){a=Math.round(a*24*60*60*1e5)/(24*60*60*1e5),a*=24;var t=Math.floor(a);a-=t,a*=60;var e=Math.floor(a);a-=e,a*=60;var r=Math.round(a*1e5)/1e5;return{hours:t,minutes:e,seconds:r}}function Ys(a){return((a.seconds/60+a.minutes)/60+a.hours)/24}function fS(a){return{year:a.year,month:a.month,day:Math.min(30,a.day)}}function Ape(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function yF(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Spe(a,t,e){return t&&yF(a.prototype,t),e&&yF(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var dS=function(){function a(){Ape(this,a)}return Spe(a,[{key:"call",value:function(){return tS}}]),a}();var k$e=M(ie());"use strict";var Ope=he(),gF=pe(),hS=Ne(),Dpe=xs(),Ipe=RC(),Ppe=kg(),vF=De(),_pe=gF.RangeError,TF=gF.String,NF=Math.floor,yS=hS(Ppe),CF=hS("".slice),sd=hS(1 .toFixed),Kc=function(a,t,e){return t===0?e:t%2==1?Kc(a,t-1,e*a):Kc(a*a,t/2,e)},kpe=function(a){for(var t=0,e=a;e>=4096;)t+=12,e/=4096;for(;e>=2;)t+=1,e/=2;return t},Xc=function(a,t,e){for(var r=-1,n=e;++r<6;)n+=t*a[r],a[r]=n%1e7,n=NF(n/1e7)},bS=function(a,t){for(var e=6,r=0;--e>=0;)r+=a[e],a[e]=NF(r/t),r=r%t*1e7},AF=function(a){for(var t=6,e="";--t>=0;)if(e!==""||t===0||a[t]!==0){var r=TF(a[t]);e=e===""?r:e+yS("0",7-r.length)+r}return e},Fpe=vF(function(){return sd(8e-5,3)!=="0.000"||sd(.9,0)!=="1"||sd(1.255,2)!=="1.25"||sd(1000000000000000100,0)!=="1000000000000000128"})||!vF(function(){sd({})});Ope({target:"Number",proto:!0,forced:Fpe},{toFixed:function(t){var e=Ipe(this),r=Dpe(t),n=[0,0,0,0,0,0],i="",s="0",o,l,u,c;if(r<0||r>20)throw _pe("Incorrect fraction digits");if(e!=e)return"NaN";if(e<=-1e21||e>=1e21)return TF(e);if(e<0&&(i="-",e=-e),e>1e-21)if(o=kpe(e*Kc(2,69,1))-69,l=o<0?e*Kc(2,-o,1):e/Kc(2,o,1),l*=4503599627370496,o=52-o,o>0){for(Xc(n,0,l),u=r;u>=7;)Xc(n,1e7,0),u-=7;for(Xc(n,Kc(10,u,1),0),u=o-1;u>=23;)bS(n,1<<23),u-=23;bS(n,1<<u),Xc(n,1,1),bS(n,2),s=AF(n)}else Xc(n,0,l),Xc(n,1<<-o,0),s=AF(n)+yS("0",r);return r>0?(c=s.length,s=i+(c<=r?"0."+yS("0",r-c)+s:CF(s,0,c-r)+"."+CF(s,c-r))):s=i+s,s}});var X$e=M(q());var D$e=M(ie());var SF=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,wF=/(\\.|[#0]+(\.[#0]*)?)/g,Na;(function(a){a.FORMAT="FORMAT",a.FREE_TEXT="FREE_TEXT"})(Na||(Na={}));function Fg(a,t){return{type:a,value:t}}var jg;(function(a){a.DATE="DATE",a.NUMBER="NUMBER",a.STRING="STRING"})(jg||(jg={}));function jpe(a){SF.lastIndex=0;var t=[],e;do e=SF.exec(a),e!==null&&t.push(e);while(e);return t}function Mpe(a){wF.lastIndex=0;var t=wF.exec(a);return t!==null?[t]:[]}function EF(a,t){for(var e=[],r=0,n=0;n<a.length;++n){var i=a[n];if(i.index!==r){var s=t.substr(r,i.index-r);e.push(Fg(Na.FREE_TEXT,s))}i[0].startsWith("\\")?e.push(Fg(Na.FREE_TEXT,i[0])):e.push(Fg(Na.FORMAT,i[0])),r=i.index+i[0].length}var o=a[a.length-1];if(o.index+o[0].length<t.length){var l=t.substr(o.index+o[0].length,t.length);e.push(Fg(Na.FREE_TEXT,l))}return e}function gS(a){var t=jpe(a);if(!t.every(function(e){return xF(e)}))return{type:jg.DATE,tokens:EF(t,a)}}function RF(a){var t=Mpe(a);if(!t.every(function(e){return xF(e)}))return{type:jg.NUMBER,tokens:EF(t,a)}}function xF(a){return a[0].startsWith("\\")}function Bpe(a,t){return zpe(a)||Upe(a,t)||VF(a,t)||Lpe()}function Lpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Upe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function zpe(a){if(Array.isArray(a))return a}function Gpe(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=VF(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function VF(a,t){if(!!a){if(typeof a=="string")return OF(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return OF(a,t)}}function OF(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function DF(a,t,e,r){var n=e.stringifyDateTime(r.numberToSimpleDateTime(a),t);if(n!==void 0)return n;var i=e.stringifyDuration(es(a),t);if(i!==void 0)return i;var s=RF(t);return s!==void 0?qpe(s.tokens,a):t}function tn(a,t){for(var e=a+"";e.length<t;)e="0"+e;return e}function Hpe(a,t){for(var e=a+"";e.length<t;)e=e+"0";return e}function IF(a,t){return a.split(t).length-1}function qpe(a,t){for(var e="",r=0;r<a.length;++r){var n=a[r];if(n.type===Na.FREE_TEXT){e+=n.value;continue}var i=n.value.split("."),s=i[0],o=i[1]||"",l=i[1]?".":"",u=Number(t.toFixed(o.length)).toString().split("."),c=u[0]||"",p=u[1]||"";if(s.length>c.length){var m=IF(s.substr(0,s.length-c.length),"0");c=tn(c,m+c.length)}var f=IF(o.substr(p.length,o.length-p.length),"0");p=Hpe(p,f+p.length),e+=c+l+p}return e}function PF(a,t){var e=gS(t);if(e!==void 0){var r=e.tokens,n="",i=Gpe(r),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;if(o.type===Na.FREE_TEXT){n+=o.value;continue}if(Ig.test(o.value)){var l=o.value.length-3;n+=(a.seconds<10?"0":"")+Math.round(a.seconds*Math.pow(10,l))/Math.pow(10,l);continue}switch(o.value.toLowerCase()){case"h":case"hh":{n+=tn(a.hours,o.value.length),a.hours=0;break}case"[hh]":{n+=tn(a.hours,o.value.length-2),a.hours=0;break}case"m":case"mm":{n+=tn(a.minutes,o.value.length),a.minutes=0;break}case"[mm]":{n+=tn(a.minutes+60*a.hours,o.value.length-2),a.minutes=0,a.hours=0;break}case"s":case"ss":{n+=tn(a.seconds,o.value.length);break}default:return}}}catch(u){i.e(u)}finally{i.f()}return n}}function _F(a,t){var e=gS(t);if(e!==void 0){for(var r=e.tokens,n="",i=!1,s=r.some(function(d){return d.type===Na.FORMAT&&(d.value==="a/p"||d.value==="A/P"||d.value==="am/pm"||d.value==="AM/PM")}),o=0;o<r.length;o++){var l=r[o];if(l.type===Na.FREE_TEXT){n+=l.value;continue}if(Ig.test(l.value)){var u=l.value.length-3;n+=(a.seconds<10?"0":"")+Math.round(a.seconds*Math.pow(10,u))/Math.pow(10,u);continue}switch(l.value.toLowerCase()){case"h":case"hh":{i=!0,n+=tn(s?(a.hours+11)%12+1:a.hours,l.value.length);break}case"d":case"dd":{n+=tn(a.day,l.value.length);break}case"s":case"ss":{n+=tn(Math.round(a.seconds),l.value.length);break}case"m":case"mm":{o+1<r.length&&r[o+1].value.startsWith(":")&&(i=!0),i?n+=tn(a.minutes,l.value.length):n+=tn(a.month,l.value.length),i=!0;break}case"yy":{n+=tn(a.year%100,l.value.length);break}case"yyyy":{n+=a.year;break}case"am/pm":case"a/p":{var c=l.value.split("/"),p=Bpe(c,2),m=p[0],f=p[1];n+=a.hours<12?m:f;break}default:return}}return n}}var CKe=M(ie());var VKe=M(q());var iKe=M(ie());"use strict";var Wpe=he(),$pe=Ay().codeAt;Wpe({target:"String",proto:!0},{codePointAt:function(t){return $pe(this,t)}});"use strict";var tme=he(),rme=BF().start,nme=UF();tme({target:"String",proto:!0,forced:nme},{padStart:function(t){return rme(this,t,arguments.length>1?arguments[1]:void 0)}});var hKe=M(q());function ame(a,t){return lme(a)||ome(a,t)||sme(a,t)||ime()}function ime(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sme(a,t){if(!!a){if(typeof a=="string")return zF(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return zF(a,t)}}function zF(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function ome(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function lme(a){if(Array.isArray(a))return a}var vS="length",od=function(t){return parseInt(t,16)},GF=function(t){return parseInt(t,10)},TS=function(t){return(t+"").replace(/\-/g,"")},Mg=function(t,e,r){return t.substr(e,r)},Ca=function(t){return t.codePointAt(0)-65};function HF(a){return TS(a)[vS]===50>>1?od(Mg(TS(a),od("12"),Ca("F")))/(od(Mg(TS(a),Ca("C"),Ca("Y")>>4))||(~~![][vS]<<3)+1):0}function qF(a){if(a=(a+"").replace(/\-/g,""),a[vS]!==Ca("Z"))return!1;var t=0;return[[0,Ca("G")+1],[Ca("H"),Ca("H")-1],[Ca("G")+Ca("H"),Ca("G")]].reduce(function(e,r,n){var i=ame(r,2),s=i[0],o=i[1];return e|=(GF("".concat(GF(od(Mg.apply(void 0,[a].concat([t+s-(n===3>>2?0:2),o+(n?2:0)])))+(od(Mg.apply(void 0,[a].concat([t+s+o,2])))+[]).padStart(2,"0"))))%97||2)>>1,t+=2,e},Ca("A"))===[]+1>>1}function ume(a,t){return fme(a)||mme(a,t)||pme(a,t)||cme()}function cme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pme(a,t){if(!!a){if(typeof a=="string")return WF(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return WF(a,t)}}function WF(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function mme(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function fme(a){if(Array.isArray(a))return a}var dme={invalid:function(){return"The license key for HyperFormula is invalid."},expired:function(t){var e=t.keyValidityDate;return"The license key for HyperFormula expired"+" on ".concat(e,", and is not valid for the installed version.")},missing:function(){return"The license key for HyperFormula is missing."}},$F=!1;function KF(a){var t={template:"missing",vars:{}};if(a==="gpl-v3"||a==="internal-use-in-handsontable")t.template="valid";else if(typeof a=="string"&&qF(a)){var e="11/01/2022".split("/"),r=ume(e,3),n=r[0],i=r[1],s=r[2],o=Math.floor(new Date("".concat(i,"/").concat(n,"/").concat(s)).getTime()/864e5),l=HF(a);t.vars.keyValidityDate=hme(new Date((l+1)*864e5)),o>l?t.template="expired":t.template="valid"}else a!==""&&(t.template="invalid");return!$F&&t.template!=="valid"&&(console.warn(dme[t.template](t.vars)),$F=!0),t.template}function hme(a){var t=["January","February","March","April","May","June","July","August","September","October","November","December"],e=t[a.getMonth()],r=a.getDate(),n=a.getFullYear();return"".concat(e," ").concat(r,", ").concat(n)}var Pat=M(q());var Bat=M(ie());var MKe=M(ie());var WKe=M(q());function yme(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=XF(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function bme(a,t){return Tme(a)||vme(a,t)||XF(a,t)||gme()}function gme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XF(a,t){if(!!a){if(typeof a=="string")return YF(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return YF(a,t)}}function YF(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function vme(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Tme(a){if(Array.isArray(a))return a}function ZF(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function ul(a,t,e){return t&&ZF(a.prototype,t),e&&ZF(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function cl(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var rt;(function(a){var t=ul(function o(l){cl(this,o),this.value=l,this.value=jc(this.value,hg(W(this.value)))});a.Number=t;var e=ul(function o(l){cl(this,o),this.value=l});a.String=e;var r=ul(function o(l){cl(this,o),this.value=l});a.Boolean=r;var n=function(){function o(){cl(this,o)}return ul(o,null,[{key:"getSingletonInstance",value:function(){return o.instance||(o.instance=new o),o.instance}}]),o}();a.Empty=n;var i=ul(function o(l){cl(this,o),this.formula=l});a.Formula=i;var s=ul(function o(l,u){cl(this,o),this.value=new E(l,u)});a.Error=s})(rt||(rt={}));function Nme(a){return a.startsWith("=")}function Cme(a){var t=a.toLowerCase();return t==="true"||t==="false"}function Ame(a,t){var e=a.toUpperCase(),r=/#[A-Za-z0-9\/]+[?!]?/;return r.test(e)&&Object.prototype.hasOwnProperty.call(t,e)}var JF=function(){function a(t,e,r){cl(this,a),this.config=t,this.dateHelper=e,this.numberLiteralsHelper=r}return ul(a,[{key:"parse",value:function(e){if(e==null)return rt.Empty.getSingletonInstance();if(typeof e=="number")return dg(e)?new rt.Error(V.NUM,D.ValueLarge):new rt.Number(e);if(typeof e=="boolean")return new rt.Boolean(e);if(e instanceof Date){var r=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),n=Ys({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=r+n;return i<0?new rt.Error(V.NUM,D.DateBounds):i%1==0?new rt.Number(new Mc(i,"Date()")):i<1?new rt.Number(new Bc(i,"Date()")):new rt.Number(new Lc(i,"Date()"))}else if(typeof e=="string"){if(Cme(e))return new rt.Boolean(e.toLowerCase()==="true");if(Nme(e))return new rt.Formula(e);if(Ame(e,this.config.errorMapping))return new rt.Error(this.config.errorMapping[e.toUpperCase()]);var s=e.trim(),o=0,l;if(s.endsWith("%"))o=1,s=s.slice(0,s.length-1);else{var u=this.currencyMatcher(s);if(u!==void 0){o=2;var c=bme(u,2);l=c[0],s=c[1]}}var p=this.numberLiteralsHelper.numericStringToMaybeNumber(s);if(p!==void 0){var m;return o===1?m=new Yf(p/100):o===2?m=new ug(p,l):m=p,new rt.Number(m)}var f=this.dateHelper.dateStringToDateNumber(s);return f!==void 0?new rt.Number(f):new rt.String(e.startsWith("'")?e.slice(1):e)}else throw new sb(e)}},{key:"currencyMatcher",value:function(e){var r=yme(this.config.currencySymbol),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;if(e.startsWith(i))return[i,e.slice(i.length)];if(e.endsWith(i))return[i,e.slice(0,e.length-i.length)]}}catch(s){r.e(s)}finally{r.f()}}}]),a}();var aXe=M(xr());function QF(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function ej(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function tj(a,t,e){return t&&ej(a.prototype,t),e&&ej(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var pl;(function(a){a[a.COPY=0]="COPY",a[a.CUT=1]="CUT"})(pl||(pl={}));var hr;(function(a){a[a.VALUE=0]="VALUE",a[a.EMPTY=1]="EMPTY",a[a.FORMULA=2]="FORMULA",a[a.PARSING_ERROR=3]="PARSING_ERROR"})(hr||(hr={}));var rj=function(){function a(t,e,r,n,i){QF(this,a),this.sourceLeftCorner=t,this.width=e,this.height=r,this.type=n,this.content=i}return tj(a,[{key:"getContent",value:regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.content!==void 0){s.next=4;break}return s.abrupt("return");case 4:r=0;case 5:if(!(r<this.height)){s.next=16;break}n=0;case 7:if(!(n<this.width)){s.next=13;break}return s.next=10,[$(e.sheet,e.col+n,e.row+r),this.content[r][n]];case 10:++n,s.next=7;break;case 13:++r,s.next=5;break;case 16:case"end":return s.stop()}},t,this)})}]),a}(),nj=function(){function a(t,e,r){QF(this,a),this.dependencyGraph=e,this.operations=r,this.maxRows=t.maxRows,this.maxColumns=t.maxColumns}return tj(a,[{key:"cut",value:function(e,r,n){this.clipboard=new rj(e,r,n,pl.CUT)}},{key:"copy",value:function(e,r,n){for(var i=[],s=0;s<n;++s){i[s]=[];for(var o=0;o<r;++o){var l=this.operations.getClipboardCell($(e.sheet,e.col+o,e.row+s));i[s].push(l)}}this.clipboard=new rj(e,r,n,pl.COPY,i)}},{key:"abortCut",value:function(){this.clipboard&&this.clipboard.type===pl.CUT&&this.clear()}},{key:"clear",value:function(){this.clipboard=void 0}},{key:"ensureItIsPossibleToCopyPaste",value:function(e){if(this.clipboard!==void 0){if(Kt(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new pt("a valid target address.");var r=oe.spanFrom(e,this.clipboard.width,this.clipboard.height);if(r.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Kn;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(r))throw new Error("It is not possible to paste onto an array")}}},{key:"isCutClipboard",value:function(){return this.clipboard!==void 0&&this.clipboard.type===pl.CUT}},{key:"isCopyClipboard",value:function(){return this.clipboard!==void 0&&this.clipboard.type===pl.COPY}}]),a}();var qJe=M(ie());var XJe=M(q());var uXe=M(q());var yXe=M(ie());function Bg(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function aj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Lg(a,t,e){return t&&aj(a.prototype,t),e&&aj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var ij=function(){function a(t,e,r,n){Bg(this,a),this.displayName=t,this.address=e,this.added=r,this.options=n}return Lg(a,[{key:"normalizeExpressionName",value:function(){return this.displayName.toLowerCase()}},{key:"copy",value:function(){return new a(this.displayName,this.address,this.added,this.options)}}]),a}(),Sme=function(){function a(){Bg(this,a),this.mapping=new Map}return Lg(a,[{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"isNameAvailable",value:function(e){var r=this.normalizeExpressionName(e),n=this.mapping.get(r);return!(n&&n.added)}},{key:"add",value:function(e){this.mapping.set(e.normalizeExpressionName(),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"getExisting",value:function(e){var r=this.mapping.get(this.normalizeExpressionName(e));if(r&&r.added)return r}},{key:"remove",value:function(e){var r=this.normalizeExpressionName(e),n=this.mapping.get(r);n&&(n.added=!1)}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter(function(e){return e.added})}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}}]),a}(),sj=function(){function a(){Bg(this,a),this.mapping=new Map}return Lg(a,[{key:"add",value:function(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter(function(e){return e.added})}},{key:"isNameAvailable",value:function(e){var r=this.normalizeExpressionName(e);return!this.mapping.has(r)}},{key:"remove",value:function(e){var r=this.normalizeExpressionName(e),n=this.mapping.get(r);n&&this.mapping.delete(r)}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}}]),a}(),Yc=function(){function a(){Bg(this,a),this.nextNamedExpressionRow=0,this.workbookStore=new Sme,this.worksheetStores=new Map,this.addressCache=new Map}return Lg(a,[{key:"isNameAvailable",value:function(e,r){var n,i;return r===void 0?this.workbookStore.isNameAvailable(e):(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.isNameAvailable(e))!==null&&i!==void 0?i:!0}},{key:"namedExpressionInAddress",value:function(e){var r=this.addressCache.get(e);if(r&&r.added)return r}},{key:"namedExpressionForScope",value:function(e,r){var n;return r===void 0?this.workbookStore.getExisting(e):(n=this.worksheetStore(r))===null||n===void 0?void 0:n.get(e)}},{key:"nearestNamedExpression",value:function(e,r){var n,i;return(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}},{key:"isExpressionInScope",value:function(e,r){var n,i;return(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.has(e))!==null&&i!==void 0?i:!1}},{key:"isNameValid",value:function(e){return/^[A-Za-z]+[0-9]+$/.test(e)?!1:/^[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*$/.test(e)}},{key:"addNamedExpression",value:function(e,r,n){var i=r===void 0?this.workbookStore:this.worksheetStoreOrCreate(r),s=i.get(e);return s!==void 0?(s.added=!0,s.displayName=e,s.options=n):(s=new ij(e,this.nextAddress(),!0,n),i.add(s)),this.addressCache.set(s.address.row,s),s}},{key:"restoreNamedExpression",value:function(e,r){var n=r===void 0?this.workbookStore:this.worksheetStoreOrCreate(r);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}},{key:"namedExpressionOrPlaceholder",value:function(e,r){var n;return(n=this.worksheetStoreOrCreate(r).get(e))!==null&&n!==void 0?n:this.workbookNamedExpressionOrPlaceholder(e)}},{key:"workbookNamedExpressionOrPlaceholder",value:function(e){var r=this.workbookStore.get(e);return r===void 0&&(r=new ij(e,this.nextAddress(),!1),this.workbookStore.add(r)),r}},{key:"remove",value:function(e,r){var n;r===void 0?n=this.workbookStore:n=this.worksheetStore(r);var i=n==null?void 0:n.get(e);if(n===void 0||i===void 0||!i.added)throw"Named expression does not exist";n.remove(e),n instanceof sj&&n.mapping.size===0&&this.worksheetStores.delete(r),this.addressCache.delete(i.address.row)}},{key:"getAllNamedExpressionsNamesInScope",value:function(e){return this.getAllNamedExpressions().filter(function(r){var n=r.scope;return n===e}).map(function(r){return r.expression.displayName})}},{key:"getAllNamedExpressionsNames",value:function(){return this.getAllNamedExpressions().map(function(e){return e.expression.displayName})}},{key:"getAllNamedExpressions",value:function(){var e=[];return this.workbookStore.getAllNamedExpressions().forEach(function(r){e.push({expression:r,scope:void 0})}),this.worksheetStores.forEach(function(r,n){r.getAllNamedExpressions().forEach(function(i){e.push({expression:i,scope:n})})}),e}},{key:"getAllNamedExpressionsForScope",value:function(e){var r,n;return e===void 0?this.workbookStore.getAllNamedExpressions():(n=(r=this.worksheetStores.get(e))===null||r===void 0?void 0:r.getAllNamedExpressions())!==null&&n!==void 0?n:[]}},{key:"worksheetStoreOrCreate",value:function(e){var r=this.worksheetStores.get(e);return r||(r=new sj,this.worksheetStores.set(e,r)),r}},{key:"worksheetStore",value:function(e){return this.worksheetStores.get(e)}},{key:"nextAddress",value:function(){return $(a.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}]),a}();Yc.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;var Ug=function a(t){switch(t.type){case I.EMPTY:case I.NUMBER:case I.STRING:case I.ERROR:case I.ERROR_WITH_RAW_INPUT:return!1;case I.CELL_REFERENCE:return!t.reference.isAbsolute();case I.CELL_RANGE:case I.COLUMN_RANGE:case I.ROW_RANGE:return!t.start.isAbsolute();case I.NAMED_EXPRESSION:return!1;case I.PERCENT_OP:case I.PLUS_UNARY_OP:case I.MINUS_UNARY_OP:return a(t.value);case I.CONCATENATE_OP:case I.EQUALS_OP:case I.NOT_EQUAL_OP:case I.LESS_THAN_OP:case I.GREATER_THAN_OP:case I.LESS_THAN_OR_EQUAL_OP:case I.GREATER_THAN_OR_EQUAL_OP:case I.MINUS_OP:case I.PLUS_OP:case I.TIMES_OP:case I.DIV_OP:case I.POWER_OP:return a(t.left)||a(t.right);case I.PARENTHESIS:return a(t.expression);case I.FUNCTION_CALL:return t.args.some(function(e){return a(e)});case I.ARRAY:return t.args.some(function(e){return e.some(function(r){return a(r)})})}};var VZe=M(q());var UZe=M(ie());var qXe=M(q());var VXe=M(ie());var PXe=M(q());function wme(a,t){return xme(a)||Rme(a,t)||oj(a,t)||Eme()}function Eme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rme(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function xme(a){if(Array.isArray(a))return a}function Vme(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=oj(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function oj(a,t){if(!!a){if(typeof a=="string")return lj(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return lj(a,t)}}function lj(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Ome(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function uj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Dme(a,t,e){return t&&uj(a.prototype,t),e&&uj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var rn=function(){function a(){Ome(this,a)}return Dme(a,[{key:"performEagerTransformations",value:function(e,r){var n=Vme(e.arrayFormulaNodes()),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=this.transformSingleAst(s.getFormula(e.lazilyTransformingAstService),s.getAddress(e.lazilyTransformingAstService)),l=wme(o,2),u=l[0],c=l[1],p=r.rememberNewAst(u);s.setFormula(p),s.setAddress(c)}}catch(m){n.e(m)}finally{n.f()}}},{key:"transformSingleAst",value:function(e,r){var n=this.transformAst(e,r),i=this.fixNodeAddress(r);return[n,i]}},{key:"transformAst",value:function(e,r){var n=this;switch(e.type){case I.CELL_REFERENCE:return this.transformCellReferenceAst(e,r);case I.CELL_RANGE:return this.transformCellRangeAst(e,r);case I.COLUMN_RANGE:return this.transformColumnRangeAst(e,r);case I.ROW_RANGE:return this.transformRowRangeAst(e,r);case I.EMPTY:case I.ERROR:case I.NUMBER:case I.NAMED_EXPRESSION:case I.ERROR_WITH_RAW_INPUT:case I.STRING:return e;case I.PERCENT_OP:case I.MINUS_UNARY_OP:case I.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,r)});case I.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(function(i){return n.transformAst(i,r)})});case I.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,r)});case I.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(function(i){return i.map(function(s){return n.transformAst(s,r)})})});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,r),right:this.transformAst(e.right,r)})}}},{key:"transformCellReferenceAst",value:function(e,r){var n=this.transformCellAddress(e.reference,r);return n instanceof Lr?Object.assign(Object.assign({},e),{reference:n}):n===V.REF?In(new E(V.REF)):e}},{key:"transformCellRangeAst",value:function(e,r){var n=this.transformCellRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===V.REF?In(new E(V.REF)):e}},{key:"transformColumnRangeAst",value:function(e,r){var n=this.transformColumnRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===V.REF?In(new E(V.REF)):e}},{key:"transformRowRangeAst",value:function(e,r){var n=this.transformRowRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===V.REF?In(new E(V.REF)):e}}]),a}();function NS(a){return NS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NS(a)}function Ime(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function cj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Pme(a,t,e){return t&&cj(a.prototype,t),e&&cj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function _me(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&CS(a,t)}function CS(a,t){return CS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},CS(a,t)}function kme(a){var t=Mme();return function(){var r=zg(a),n;if(t){var i=zg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fme(this,n)}}function Fme(a,t){if(t&&(NS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jme(a)}function jme(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Mme(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function zg(a){return zg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zg(a)}var pj=function(a){_me(e,a);var t=kme(e);function e(r){var n;return Ime(this,e),n=t.call(this),n.columnsSpan=r,n}return Pme(e,[{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformRowRangeAst",value:function(n,i){return n}},{key:"transformCellRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformRowRange",value:function(n,i,s){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformCellAddress",value:function(n,i){var s=mr(n,i);if(s!==this.columnsSpan.sheet&&i.sheet!==this.columnsSpan.sheet)return!1;var o=n.toSimpleColumnAddress(i);if(s===this.columnsSpan.sheet&&i.sheet!==this.columnsSpan.sheet)return this.columnsSpan.columnStart<=o.col?n.shiftedByColumns(this.columnsSpan.numberOfColumns):!1;if(i.sheet===this.columnsSpan.sheet&&s!==this.columnsSpan.sheet)return n.isColumnAbsolute()||i.col<this.columnsSpan.columnStart?!1:n.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(n.isColumnAbsolute())return n.col<this.columnsSpan.columnStart?!1:n.shiftedByColumns(this.columnsSpan.numberOfColumns);var l=n.toSimpleColumnAddress(i);return l.col<this.columnsSpan.columnStart?i.col<this.columnsSpan.columnStart?!1:n.shiftedByColumns(-this.columnsSpan.numberOfColumns):i.col<this.columnsSpan.columnStart?n.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}},{key:"fixNodeAddress",value:function(n){return this.columnsSpan.sheet===n.sheet&&this.columnsSpan.columnStart<=n.col?Object.assign(Object.assign({},n),{col:n.col+this.columnsSpan.numberOfColumns}):n}},{key:"transformRange",value:function(n,i,s){var o=this.transformCellAddress(n,s),l=this.transformCellAddress(i,s);return o===V.REF||l===V.REF?V.REF:o||l?[o||n,l||i]:!1}}]),e}(rn);var aYe=M(q());function AS(a){return AS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AS(a)}function Bme(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function mj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Lme(a,t,e){return t&&mj(a.prototype,t),e&&mj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ume(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&SS(a,t)}function SS(a,t){return SS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},SS(a,t)}function zme(a){var t=qme();return function(){var r=Gg(a),n;if(t){var i=Gg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Gme(this,n)}}function Gme(a,t){if(t&&(AS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hme(a)}function Hme(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function qme(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Gg(a){return Gg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gg(a)}var ld=function(a){Ume(e,a);var t=zme(e);function e(r){var n;return Bme(this,e),n=t.call(this),n.rowsSpan=r,n}return Lme(e,[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformColumnRangeAst",value:function(n,i){return n}},{key:"transformCellRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformRowRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformColumnRange",value:function(n,i,s){throw Error("Not implemented")}},{key:"transformCellAddress",value:function(n,i){var s=mr(n,i);if(s!==this.rowsSpan.sheet&&i.sheet!==this.rowsSpan.sheet)return!1;var o=n.toSimpleRowAddress(i);return s===this.rowsSpan.sheet&&i.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=o.row?n.shiftedByRows(this.rowsSpan.numberOfRows):!1:i.sheet===this.rowsSpan.sheet&&s!==this.rowsSpan.sheet?n.isRowAbsolute()||i.row<this.rowsSpan.rowStart?!1:n.shiftedByRows(-this.rowsSpan.numberOfRows):n.isRowAbsolute()?n.row<this.rowsSpan.rowStart?!1:n.shiftedByRows(this.rowsSpan.numberOfRows):o.row<this.rowsSpan.rowStart?i.row<this.rowsSpan.rowStart?!1:n.shiftedByRows(-this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?n.shiftedByRows(this.rowsSpan.numberOfRows):!1}},{key:"fixNodeAddress",value:function(n){return this.rowsSpan.sheet===n.sheet&&this.rowsSpan.rowStart<=n.row?Object.assign(Object.assign({},n),{row:n.row+this.rowsSpan.numberOfRows}):n}},{key:"transformRange",value:function(n,i,s){var o=this.transformCellAddress(n,s),l=this.transformCellAddress(i,s);return o===V.REF||l===V.REF?V.REF:o||l?[o||n,l||i]:!1}}]),e}(rn);var yYe=M(q());function wS(a){return wS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wS(a)}function Wme(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function fj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function $me(a,t,e){return t&&fj(a.prototype,t),e&&fj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Kme(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&ES(a,t)}function ES(a,t){return ES=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},ES(a,t)}function Xme(a){var t=Jme();return function(){var r=Hg(a),n;if(t){var i=Hg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yme(this,n)}}function Yme(a,t){if(t&&(wS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zme(a)}function Zme(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Jme(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Hg(a){return Hg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Hg(a)}var dj=function(a){Kme(e,a);var t=Xme(e);function e(r){var n;return Wme(this,e),n=t.call(this),n.sheet=r,n}return $me(e,[{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(n){return n}},{key:"transformCellAddress",value:function(n,i){return n.isInvalid(i)?V.REF:!1}},{key:"transformCellRange",value:function(n,i,s){return n.isInvalid(s)||i.isInvalid(s)?V.REF:!1}},{key:"transformColumnRange",value:function(n,i,s){return n.isInvalid(s)||i.isInvalid(s)?V.REF:!1}},{key:"transformRowRange",value:function(n,i,s){return n.isInvalid(s)||i.isInvalid(s)?V.REF:!1}}]),e}(rn);var xYe=M(q());function RS(a){return RS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RS(a)}function hj(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function yj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function bj(a,t,e){return t&&yj(a.prototype,t),e&&yj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function gj(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&xS(a,t)}function xS(a,t){return xS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},xS(a,t)}function vj(a){var t=tfe();return function(){var r=qg(a),n;if(t){var i=qg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Qme(this,n)}}function Qme(a,t){if(t&&(RS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return efe(a)}function efe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function tfe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function qg(a){return qg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qg(a)}var Tj=function(a){gj(e,a);var t=vj(e);function e(r,n,i,s){var o;return hj(this,e),o=t.call(this),o.sourceRange=r,o.toRight=n,o.toBottom=i,o.toSheet=s,o.dependentFormulaTransformer=new rfe(r,n,i,s),o}return bj(e,[{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformSingleAst",value:function(n,i){if(this.sourceRange.addressInRange(i)){var s=this.transformAst(n,i);return[s,this.fixNodeAddress(i)]}else return this.dependentFormulaTransformer.transformSingleAst(n,i)}},{key:"fixNodeAddress",value:function(n){return $(this.toSheet,n.col+this.toRight,n.row+this.toBottom)}},{key:"transformCellAddress",value:function(n,i){return this.transformAddress(n,i)}},{key:"transformCellRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformColumnRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformRowRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformAddress",value:function(n,i){var s=this.sourceRange;if(n instanceof Lr){var o=n.toSimpleCellAddress(i);if(s.addressInRange(o))return n.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return n.shiftRelativeDimensions(-this.toRight,-this.toBottom)}},{key:"transformRange",value:function(n,i,s){var o=this.sourceRange;if(n instanceof Lr&&i instanceof Lr){var l=n.toSimpleCellAddress(s),u=i.toSimpleCellAddress(s);if(o.addressInRange(l)&&o.addressInRange(u))return[n.shiftAbsoluteDimensions(this.toRight,this.toBottom),i.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[n.shiftRelativeDimensions(-this.toRight,-this.toBottom),i.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}]),e}(rn),rfe=function(a){gj(e,a);var t=vj(e);function e(r,n,i,s){var o;return hj(this,e),o=t.call(this),o.sourceRange=r,o.toRight=n,o.toBottom=i,o.toSheet=s,o}return bj(e,[{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(n){return n}},{key:"transformCellAddress",value:function(n,i){return this.shouldMove(n,i)?n.moved(this.toSheet,this.toRight,this.toBottom):!1}},{key:"transformCellRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformColumnRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformRowRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"shouldMove",value:function(n,i){return n instanceof Lr?this.sourceRange.addressInRange(n.toSimpleCellAddress(i)):n instanceof Uf?this.sourceRange.rowInRange(n.toSimpleRowAddress(i))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(n.toSimpleColumnAddress(i))&&!this.sourceRange.isFinite()}},{key:"transformRange",value:function(n,i,s){var o=this.transformCellAddress(n,s),l=this.transformCellAddress(i,s);return o&&l?[o,l]:!1}}]),e}(rn);var GYe=M(q());function VS(a){return VS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VS(a)}function nfe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Nj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function afe(a,t,e){return t&&Nj(a.prototype,t),e&&Nj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function ife(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&OS(a,t)}function OS(a,t){return OS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},OS(a,t)}function sfe(a){var t=ufe();return function(){var r=Wg(a),n;if(t){var i=Wg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ofe(this,n)}}function ofe(a,t){if(t&&(VS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lfe(a)}function lfe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function ufe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Wg(a){return Wg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wg(a)}var Cj=function(a){ife(e,a);var t=sfe(e);function e(r){var n;return nfe(this,e),n=t.call(this),n.columnsSpan=r,n}return afe(e,[{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformRowRangeAst",value:function(n,i){return n}},{key:"transformCellRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformRowRange",value:function(n,i,s){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformCellAddress",value:function(n,i){var s=mr(n,i);if(this.columnsSpan.sheet!==i.sheet&&this.columnsSpan.sheet!==s)return!1;if(this.columnsSpan.sheet!==i.sheet&&this.columnsSpan.sheet===s){var o=n.toSimpleColumnAddress(i);if(o.col<this.columnsSpan.columnStart)return!1;if(o.col>this.columnsSpan.columnEnd)return n.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===i.sheet&&this.columnsSpan.sheet!==s){if(n.isColumnAbsolute())return!1;if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return n.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===i.sheet&&this.columnsSpan.sheet===s)if(n.isColumnAbsolute()){if(n.col<this.columnsSpan.columnStart)return!1;if(n.col>this.columnsSpan.columnEnd)return n.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{var l=n.toSimpleColumnAddress(i);if(l.col<this.columnsSpan.columnStart){if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return n.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(l.col>this.columnsSpan.columnEnd){if(i.col<this.columnsSpan.columnStart)return n.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(i.col>this.columnsSpan.columnEnd)return!1}}return V.REF}},{key:"fixNodeAddress",value:function(n){return this.columnsSpan.sheet===n.sheet&&this.columnsSpan.columnStart<=n.col?Object.assign(Object.assign({},n),{col:n.col-this.columnsSpan.numberOfColumns}):n}},{key:"transformRange",value:function(n,i,s){var o=mr(n,s),l=n,u=i;if(this.columnsSpan.sheet===o){var c=n.toSimpleColumnAddress(s),p=i.toSimpleColumnAddress(s);if(this.columnsSpan.columnStart<=c.col&&this.columnsSpan.columnEnd>=p.col)return V.REF;c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(l=n.shiftedByColumns(this.columnsSpan.columnEnd-c.col+1)),p.col>=this.columnsSpan.columnStart&&p.col<=this.columnsSpan.columnEnd&&(u=i.shiftedByColumns(-(p.col-this.columnsSpan.columnStart+1)))}var m=this.transformCellAddress(l,s),f=this.transformCellAddress(u,s);if(m===!1&&f===!1)return[l,u];if(m===V.REF||f===V.REF)throw Error("Cannot happen");return[m||l,f||u]}}]),e}(rn);var rZe=M(q());function DS(a){return DS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DS(a)}function cfe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Aj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function pfe(a,t,e){return t&&Aj(a.prototype,t),e&&Aj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function mfe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&IS(a,t)}function IS(a,t){return IS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},IS(a,t)}function ffe(a){var t=yfe();return function(){var r=$g(a),n;if(t){var i=$g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return dfe(this,n)}}function dfe(a,t){if(t&&(DS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hfe(a)}function hfe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function yfe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function $g(a){return $g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$g(a)}var ud=function(a){mfe(e,a);var t=ffe(e);function e(r){var n;return cfe(this,e),n=t.call(this),n.rowsSpan=r,n}return pfe(e,[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformColumnRangeAst",value:function(n,i){return n}},{key:"transformCellAddress",value:function(n,i){var s=mr(n,i);if(this.rowsSpan.sheet!==i.sheet&&this.rowsSpan.sheet!==s)return!1;if(this.rowsSpan.sheet!==i.sheet&&this.rowsSpan.sheet===s){var o=n.toSimpleRowAddress(i);if(o.row<this.rowsSpan.rowStart)return!1;if(o.row>this.rowsSpan.rowEnd)return n.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===i.sheet&&this.rowsSpan.sheet!==s){if(n.isRowAbsolute())return!1;if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return n.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===i.sheet&&this.rowsSpan.sheet===s)if(n.isRowAbsolute()){if(n.row<this.rowsSpan.rowStart)return!1;if(n.row>this.rowsSpan.rowEnd)return n.shiftedByRows(-this.rowsSpan.numberOfRows)}else{var l=n.toSimpleRowAddress(i);if(l.row<this.rowsSpan.rowStart){if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return n.shiftedByRows(this.rowsSpan.numberOfRows)}else if(l.row>this.rowsSpan.rowEnd){if(i.row<this.rowsSpan.rowStart)return n.shiftedByRows(-this.rowsSpan.numberOfRows);if(i.row>this.rowsSpan.rowEnd)return!1}}return V.REF}},{key:"transformCellRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformRowRange",value:function(n,i,s){return this.transformRange(n,i,s)}},{key:"transformColumnRange",value:function(n,i,s){throw Error("Not implemented")}},{key:"fixNodeAddress",value:function(n){return this.rowsSpan.sheet===n.sheet&&this.rowsSpan.rowStart<=n.row?Object.assign(Object.assign({},n),{row:n.row-this.rowsSpan.numberOfRows}):n}},{key:"transformRange",value:function(n,i,s){var o=mr(n,s),l=n,u=i;if(this.rowsSpan.sheet===o){var c=n.toSimpleRowAddress(s),p=i.toSimpleRowAddress(s);if(this.rowsSpan.rowStart<=c.row&&this.rowsSpan.rowEnd>=p.row)return V.REF;c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(l=n.shiftedByRows(this.rowsSpan.rowEnd-c.row+1)),p.row>=this.rowsSpan.rowStart&&p.row<=this.rowsSpan.rowEnd&&(u=i.shiftedByRows(-(p.row-this.rowsSpan.rowStart+1)))}var m=this.transformCellAddress(l,s),f=this.transformCellAddress(u,s);return m===!1&&f===!1?[l,u]:m===V.REF||f===V.REF?V.REF:[m||l,f||u]}}]),e}(rn);var hZe=M(ie());var vZe=M(q());function PS(a){return PS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PS(a)}function bfe(a,t){return Tfe(a)||vfe(a,t)||Sj(a,t)||gfe()}function gfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vfe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Tfe(a){if(Array.isArray(a))return a}function Nfe(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=Sj(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function Sj(a,t){if(!!a){if(typeof a=="string")return wj(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return wj(a,t)}}function wj(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Cfe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Ej(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Afe(a,t,e){return t&&Ej(a.prototype,t),e&&Ej(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Sfe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&_S(a,t)}function _S(a,t){return _S=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},_S(a,t)}function wfe(a){var t=xfe();return function(){var r=Kg(a),n;if(t){var i=Kg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Efe(this,n)}}function Efe(a,t){if(t&&(PS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rfe(a)}function Rfe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function xfe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Kg(a){return Kg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kg(a)}var Rj=function(a){Sfe(e,a);var t=wfe(e);function e(r){var n;return Cfe(this,e),n=t.call(this),n.sheet=r,n}return Afe(e,[{key:"isIrreversible",value:function(){return!0}},{key:"performEagerTransformations",value:function(n,i){var s=Nfe(n.arrayFormulaNodes()),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,u=this.transformSingleAst(l.getFormula(n.lazilyTransformingAstService),l.getAddress(n.lazilyTransformingAstService)),c=bfe(u,1),p=c[0];l.setFormula(p)}}catch(m){s.e(m)}finally{s.f()}}},{key:"fixNodeAddress",value:function(n){return n}},{key:"transformCellAddress",value:function(n,i){return this.transformAddress(n)}},{key:"transformCellRange",value:function(n,i,s){return this.transformAddress(n)}},{key:"transformColumnRange",value:function(n,i,s){return this.transformAddress(n)}},{key:"transformRowRange",value:function(n,i,s){return this.transformAddress(n)}},{key:"transformAddress",value:function(n){return n.sheet===this.sheet?V.REF:!1}}]),e}(rn);function Xg(a){if(!Array.isArray(a))throw new pt("an array of arrays.");for(var t=0;t<a.length;t++)if(!Array.isArray(a[t]))throw new pt("an array of arrays.")}function ml(a){for(var t=0,e=0,r=0,n=0;n<a.length;n++){for(var i=0,s=0;s<a[n].length;s++){var o=a[n][s];o!=null&&(i=s+1,++r)}t=Math.max(t,i),i>0&&(e=n+1)}var l=t*e;return{height:e,width:t,fill:l===0?0:r/l}}function Yg(a){return Dfe(a)||Ofe(a)||kS(a)||Vfe()}function Vfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ofe(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Dfe(a){if(Array.isArray(a))return FS(a)}function Nn(a,t){return _fe(a)||Pfe(a,t)||kS(a,t)||Ife()}function Ife(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pfe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function _fe(a){if(Array.isArray(a))return a}function nn(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=kS(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function kS(a,t){if(!!a){if(typeof a=="string")return FS(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return FS(a,t)}}function FS(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function cd(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function xj(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function pd(a,t,e){return t&&xj(a.prototype,t),e&&xj(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var Zg=function(){function a(t,e){cd(this,a),this.sheet=t,this.indexes=e}return pd(a,[{key:"normalizedIndexes",value:function(){return md(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map(function(r){return yn.fromNumberOfRows(e.sheet,r[0],r[1])})}}]),a}(),Jg=function(){function a(t,e){cd(this,a),this.sheet=t,this.indexes=e}return pd(a,[{key:"normalizedIndexes",value:function(){return fd(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map(function(r){return yn.fromNumberOfRows(e.sheet,r[0],r[1])})}}]),a}(),Qg=function(){function a(t,e){cd(this,a),this.sheet=t,this.indexes=e}return pd(a,[{key:"normalizedIndexes",value:function(){return fd(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map(function(r){return ea.fromNumberOfColumns(e.sheet,r[0],r[1])})}}]),a}(),ev=function(){function a(t,e){cd(this,a),this.sheet=t,this.indexes=e}return pd(a,[{key:"normalizedIndexes",value:function(){return md(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map(function(r){return ea.fromNumberOfColumns(e.sheet,r[0],r[1])})}}]),a}(),Vj=function(){function a(t,e,r,n,i,s,o,l,u){cd(this,a),this.dependencyGraph=e,this.columnSearch=r,this.cellContentParser=n,this.parser=i,this.stats=s,this.lazilyTransformingAstService=o,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=Zi.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=t.maxColumns,this.maxRows=t.maxRows}return pd(a,[{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"removeRows",value:function(e){var r=[],n=nn(e.rowsSpans()),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=this.doRemoveRows(s);o&&r.push(o)}}catch(l){n.e(l)}finally{n.f()}return r}},{key:"addRows",value:function(e){var r=nn(e.rowsSpans()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.doAddRows(i)}}catch(s){r.e(s)}finally{r.f()}}},{key:"addColumns",value:function(e){var r=nn(e.columnsSpans()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.doAddColumns(i)}}catch(s){r.e(s)}finally{r.f()}}},{key:"removeColumns",value:function(e){var r=[],n=nn(e.columnsSpans()),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=this.doRemoveColumns(s);o&&r.push(o)}}catch(l){n.e(l)}finally{n.f()}return r}},{key:"removeSheet",value:function(e){var r=this;this.dependencyGraph.removeSheet(e);var n;this.stats.measure(ue.TRANSFORM_ASTS,function(){var s=new Rj(e);s.performEagerTransformations(r.dependencyGraph,r.parser),n=r.lazilyTransformingAstService.addTransformation(s)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);var i=this.namedExpressions.getAllNamedExpressionsForScope(e).map(function(s){return r.removeNamedExpression(s.normalizeExpressionName(),e)});return{version:n,scopedNamedExpressions:i}}},{key:"removeSheetByName",value:function(e){var r=this.sheetMapping.fetch(e);return this.removeSheet(r)}},{key:"clearSheet",value:function(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}},{key:"addSheet",value:function(e){var r=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(r,n,ml(n)),this.sheetMapping.fetchDisplayName(r)}},{key:"renameSheet",value:function(e,r){return this.sheetMapping.renameSheet(e,r)}},{key:"moveRows",value:function(e,r,n,i){var s=yn.fromNumberOfRows(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(s),i<r&&(r+=n);var o=$(e,0,r),l=$(e,0,i);this.moveCells(o,Number.POSITIVE_INFINITY,n,l);var u=yn.fromNumberOfRows(e,r,n);return this.doRemoveRows(u),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveColumns",value:function(e,r,n,i){var s=ea.fromNumberOfColumns(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(s),i<r&&(r+=n);var o=$(e,r,0),l=$(e,i,0);this.moveCells(o,n,Number.POSITIVE_INFINITY,l);var u=ea.fromNumberOfColumns(e,r,n);return this.doRemoveColumns(u),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveCells",value:function(e,r,n,i){var s=this;this.ensureItIsPossibleToMoveCells(e,r,n,i);var o=oe.spanFrom(e,r,n),l=oe.spanFrom(i,r,n),u=i.col-e.col,c=i.row-e.row,p=i.sheet,m=this.getRangeClipboardCells(l),f=this.dependencyGraph.rawValuesFromRange(l);this.columnSearch.removeValues(f);var d=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.moveValues(d,u,c,p);var h;this.stats.measure(ue.TRANSFORM_ASTS,function(){var b=new Tj(o,u,c,p);b.performEagerTransformations(s.dependencyGraph,s.parser),h=s.lazilyTransformingAstService.addTransformation(b)}),this.dependencyGraph.moveCells(o,u,c,p);var y=this.updateNamedExpressionsForMovedCells(e,r,n,i);return{version:h,overwrittenCellsData:m,addedGlobalNamedExpressions:y}}},{key:"setRowOrder",value:function(e,r){var n=this,i=[],s=[],o=nn(r),l;try{var u=function(){var p=Nn(l.value,2),m=p[0],f=p[1];if(m!==f){var d=oe.spanFrom({sheet:e,col:0,row:m},1/0,1),h=n.getRangeClipboardCells(d);s=s.concat(h),i.push(h.map(function(y){var b=Nn(y,2),g=b[0],v=g.sheet,A=g.col,C=b[1];return[{sheet:v,col:A,row:f},C]}))}};for(o.s();!(l=o.n()).done;)u()}catch(c){o.e(c)}finally{o.f()}return i.forEach(function(c){return n.restoreClipboardCells(e,c.values())}),s}},{key:"setColumnOrder",value:function(e,r){var n=this,i=[],s=[],o=nn(r),l;try{var u=function(){var p=Nn(l.value,2),m=p[0],f=p[1];if(m!==f){var d=oe.spanFrom({sheet:e,col:m,row:0},1,1/0),h=n.getRangeClipboardCells(d);s=s.concat(h),i.push(h.map(function(y){var b=Nn(y,2),g=b[0],v=g.sheet,A=g.col,C=g.row,S=b[1];return[{sheet:v,col:f,row:C},S]}))}};for(o.s();!(l=o.n()).done;)u()}catch(c){o.e(c)}finally{o.f()}return i.forEach(function(c){return n.restoreClipboardCells(e,c.values())}),s}},{key:"addNamedExpression",value:function(e,r,n,i){var s=this.namedExpressions.addNamedExpression(e,n,i);this.storeNamedExpressionInCell(s.address,r),this.adjustNamedExpressionEdges(s,e,n)}},{key:"restoreNamedExpression",value:function(e,r,n){var i=e.displayName;this.restoreCell(e.address,r);var s=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(s,i,n)}},{key:"changeNamedExpressionExpression",value:function(e,r,n,i){var s=this.namedExpressions.namedExpressionForScope(e,n);if(!s)throw new Fs(e);var o=s.copy();s.options=i;var l=this.getClipboardCell(s.address);return this.storeNamedExpressionInCell(s.address,r),[o,l]}},{key:"removeNamedExpression",value:function(e,r){var n=this.namedExpressions.namedExpressionForScope(e,r);if(!n)throw new Fs(e);this.namedExpressions.remove(n.displayName,r);var i=this.getClipboardCell(n.address);if(r!==void 0){var s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,s.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,i]}},{key:"ensureItIsPossibleToMoveCells",value:function(e,r,n,i){if(Kt(e)||!(tv(r)&&tv(n)||kfe(e,r,n))||Kt(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new pt("a valid range of cells to move.");var s=oe.spanFrom(e,r,n),o=oe.spanFrom(i,r,n);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Kn;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Mi;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Ho}},{key:"restoreClipboardCells",value:function(e,r){var n=[],i=nn(r),s;try{for(i.s();!(s=i.n()).done;){var o=Nn(s.value,2),l=o[0],u=o[1];if(this.restoreCell(l,u),u.type===hr.FORMULA){var c=this.parser.fetchCachedResult(u.hash),p=c.dependencies;n.push.apply(n,Yg(this.updateNamedExpressionsForTargetAddress(e,l,p)))}}}catch(m){i.e(m)}finally{i.f()}return n}},{key:"restoreCell",value:function(e,r){switch(r.type){case hr.VALUE:{this.setValueToCell(r,e);break}case hr.FORMULA:{this.setFormulaToCellFromCache(r.hash,e);break}case hr.EMPTY:{this.setCellEmpty(e);break}case hr.PARSING_ERROR:{this.setParsingErrorToCell(r.rawInput,r.errors,e);break}}}},{key:"getOldContent",value:function(e){var r=this.dependencyGraph.getCell(e);if(r===void 0||r instanceof ta)return[e,{type:hr.EMPTY}];if(r instanceof vn)return[e,Object.assign({type:hr.VALUE},r.getValues())];if(r instanceof dr)return[r.getAddress(this.lazilyTransformingAstService),{type:hr.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))}];if(r instanceof Ta)return[e,{type:hr.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors}];throw Error("Trying to copy unsupported type")}},{key:"getClipboardCell",value:function(e){var r=this.dependencyGraph.getCell(e);if(r===void 0||r instanceof ta)return{type:hr.EMPTY};if(r instanceof vn)return Object.assign({type:hr.VALUE},r.getValues());if(r instanceof Ye){var n=r.getArrayCellValue(e);return n===le?{type:hr.EMPTY}:{type:hr.VALUE,parsedValue:n,rawValue:r.getArrayCellRawValue(e)}}else{if(r instanceof Qr)return{type:hr.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))};if(r instanceof Ta)return{type:hr.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors}}throw Error("Trying to copy unsupported type")}},{key:"getSheetClipboardCells",value:function(e){for(var r=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),i=new Array(r),s=0;s<r;s++){i[s]=new Array(n);for(var o=0;o<n;o++){var l=$(e,o,s);i[s][o]=this.getClipboardCell(l)}}return i}},{key:"getRangeClipboardCells",value:function(e){var r=[],n=nn(e.addresses(this.dependencyGraph)),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;r.push([s,this.getClipboardCell(s)])}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"setCellContent",value:function(e,r){var n=this.cellContentParser.parse(r),i=this.getOldContent(e);if(n instanceof rt.Formula){var s=this.parser.parse(n.formula,e),o=s.ast,l=s.errors;if(l.length>0)this.setParsingErrorToCell(n.formula,l,e);else{var u=this.arraySizePredictor.checkArraySize(o,e);this.setFormulaToCell(e,u,s)}}else n instanceof rt.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:r},e);return i}},{key:"setSheetContent",value:function(e,r){this.clearSheet(e);for(var n=0;n<r.length;n++)for(var i=0;i<r[n].length;i++){var s=$(e,i,n);this.setCellContent(s,r[n][i])}}},{key:"setParsingErrorToCell",value:function(e,r,n){var i=this.dependencyGraph.getCellValue(n),s=new Ta(r,e),o=this.dependencyGraph.setParsingErrorToCell(n,s);this.columnSearch.remove(W(i),n),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(s.getCellValue(),n)}},{key:"setFormulaToCell",value:function(e,r,n){var i=n.ast,s=n.hasVolatileFunction,o=n.hasStructuralChangeFunction,l=n.dependencies,u=this.dependencyGraph.getCellValue(e),c=this.dependencyGraph.setFormulaToCell(e,i,gn(l,e),r,s,o);this.columnSearch.remove(W(u),e),this.columnSearch.applyChanges(c.getChanges()),this.changes.addAll(c)}},{key:"setValueToCell",value:function(e,r){var n=this.dependencyGraph.getCellValue(r),i=this.dependencyGraph.setValueToCell(r,e);this.columnSearch.change(W(n),W(e.parsedValue),r),this.columnSearch.applyChanges(i.getChanges().filter(function(s){return!Yi(s.address,r)})),this.changes.addAll(i),this.changes.addChange(e.parsedValue,r)}},{key:"setCellEmpty",value:function(e){if(!this.dependencyGraph.isArrayInternalCell(e)){var r=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(W(r),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(le,e)}}},{key:"setFormulaToCellFromCache",value:function(e,r){var n=this.parser.fetchCachedResult(e),i=n.ast,s=n.hasVolatileFunction,o=n.hasStructuralChangeFunction,l=n.dependencies,u=gn(l,r),c=new dj(r.sheet).transformSingleAst(i,r),p=Nn(c,1),m=p[0];this.parser.rememberNewAst(m);var f=qP(u),d=this.arraySizePredictor.checkArraySize(i,r);this.dependencyGraph.setFormulaToCell(r,m,f,d,s,o)}},{key:"rowEffectivelyNotInSheet",value:function(e,r){var n=this.dependencyGraph.addressMapping.getHeight(r);return e>=n}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=Zi.empty(),e}},{key:"forceApplyPostponedTransformations",value:function(){this.dependencyGraph.forceApplyPostponedTransformations()}},{key:"doRemoveRows",value:function(e){var r=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var n=[],i=nn(this.dependencyGraph.entriesFromRowsSpan(e)),s;try{for(i.s();!(s=i.n()).done;){var o=Nn(s.value,1),l=o[0];n.push({address:l,cellType:this.getClipboardCell(l)})}}catch(f){i.e(f)}finally{i.f()}var u=this.dependencyGraph.removeRows(e),c=u.affectedArrays,p=u.contentChanges;this.columnSearch.applyChanges(p.getChanges());var m;return this.stats.measure(ue.TRANSFORM_ASTS,function(){var f=new ud(e);f.performEagerTransformations(r.dependencyGraph,r.parser),m=r.lazilyTransformingAstService.addTransformation(f)}),this.rewriteAffectedArrays(c),{version:m,removedCells:n,rowFrom:e.rowStart,rowCount:e.numberOfRows}}}},{key:"doRemoveColumns",value:function(e){var r=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var n=[],i=nn(this.dependencyGraph.entriesFromColumnsSpan(e)),s;try{for(i.s();!(s=i.n()).done;){var o=Nn(s.value,1),l=o[0];n.push({address:l,cellType:this.getClipboardCell(l)})}}catch(f){i.e(f)}finally{i.f()}var u=this.dependencyGraph.removeColumns(e),c=u.affectedArrays,p=u.contentChanges;this.columnSearch.applyChanges(p.getChanges()),this.columnSearch.removeColumns(e);var m;return this.stats.measure(ue.TRANSFORM_ASTS,function(){var f=new Cj(e);f.performEagerTransformations(r.dependencyGraph,r.parser),m=r.lazilyTransformingAstService.addTransformation(f)}),this.rewriteAffectedArrays(c),{version:m,removedCells:n,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}}},{key:"doAddRows",value:function(e){var r=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var n=this.dependencyGraph.addRows(e),i=n.affectedArrays;this.stats.measure(ue.TRANSFORM_ASTS,function(){var s=new ld(e);s.performEagerTransformations(r.dependencyGraph,r.parser),r.lazilyTransformingAstService.addTransformation(s)}),this.rewriteAffectedArrays(i)}}},{key:"rewriteAffectedArrays",value:function(e){var r=nn(e.values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.array.size.isRef){var s=i.getFormula(this.lazilyTransformingAstService),o=i.getAddress(this.lazilyTransformingAstService),l=this.parser.computeHashFromAst(s);this.setFormulaToCellFromCache(l,o)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"doAddColumns",value:function(e){var r=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var n=this.dependencyGraph.addColumns(e),i=n.affectedArrays,s=n.contentChanges;this.columnSearch.addColumns(e),this.columnSearch.applyChanges(s.getChanges()),this.stats.measure(ue.TRANSFORM_ASTS,function(){var o=new pj(e);o.performEagerTransformations(r.dependencyGraph,r.parser),r.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(i)}}},{key:"columnEffectivelyNotInSheet",value:function(e,r){var n=this.dependencyGraph.addressMapping.getWidth(r);return e>=n}},{key:"adjustNamedExpressionEdges",value:function(e,r,n){if(n!==void 0){var i=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(r),o=this.dependencyGraph.fetchCellOrCreateEmpty(s.address),l=nn(this.dependencyGraph.graph.adjacentNodes(o)),u;try{for(l.s();!(u=l.n()).done;){var c=u.value;if(c instanceof Qr&&c.getAddress(this.lazilyTransformingAstService).sheet===n){var p=c.getFormula(this.lazilyTransformingAstService),m=c.getAddress(this.lazilyTransformingAstService),f=this.parser.fetchCachedResultForAst(p),d=f.dependencies,h=nn(gn(d,m)),y;try{for(h.s();!(y=h.n()).done;){var b=y.value;b instanceof Pn&&b.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(o,c),this.dependencyGraph.graph.addEdge(i,c))}}catch(g){h.e(g)}finally{h.f()}}}}catch(g){l.e(g)}finally{l.f()}}}},{key:"storeNamedExpressionInCell",value:function(e,r){var n=this.cellContentParser.parse(r);if(n instanceof rt.Formula){var i=this.parser.parse(n.formula,$(-1,0,0));if(Ug(i.ast))throw new uc;var s=i.ast,o=i.hasVolatileFunction,l=i.hasStructuralChangeFunction,u=i.dependencies;this.dependencyGraph.setFormulaToCell(e,s,gn(u,e),Se.scalar(),o,l)}else n instanceof rt.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:r},e)}},{key:"updateNamedExpressionsForMovedCells",value:function(e,r,n,i){if(e.sheet===i.sheet)return[];var s=[],o=oe.spanFrom(i,r,n),l=nn(o.addresses(this.dependencyGraph)),u;try{for(l.s();!(u=l.n()).done;){var c=u.value,p=this.addressMapping.fetchCell(c);if(p instanceof Qr&&c.sheet!==e.sheet){var m=p.getFormula(this.lazilyTransformingAstService),f=this.parser.fetchCachedResultForAst(m),d=f.dependencies;s.push.apply(s,Yg(this.updateNamedExpressionsForTargetAddress(e.sheet,c,d)))}}}catch(h){l.e(h)}finally{l.f()}return s}},{key:"updateNamedExpressionsForTargetAddress",value:function(e,r,n){if(e===r.sheet)return[];var i=[],s=this.addressMapping.fetchCell(r),o=nn(gn(n,r)),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;if(u instanceof Pn){var c=u.name,p=this.dependencyGraph.fetchNamedExpressionVertex(c,e),m=this.namedExpressions.isExpressionInScope(c,r.sheet),f=m?this.dependencyGraph.fetchNamedExpressionVertex(c,r.sheet):this.copyOrFetchGlobalNamedExpressionVertex(c,p,i);f!==p&&(this.dependencyGraph.graph.softRemoveEdge(p,s),this.dependencyGraph.graph.addEdge(f,s))}}}catch(d){o.e(d)}finally{o.f()}return i}},{key:"allocateNamedExpressionAddressSpace",value:function(){this.dependencyGraph.addressMapping.addSheet(-1,new Cg(0,0))}},{key:"copyOrFetchGlobalNamedExpressionVertex",value:function(e,r,n){var i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),n.push(i.normalizeExpressionName()),r instanceof Qr){var s=this.parser.fetchCachedResultForAst(r.getFormula(this.lazilyTransformingAstService)),o=s.ast,l=s.hasVolatileFunction,u=s.hasStructuralChangeFunction,c=s.dependencies;this.dependencyGraph.setFormulaToCell(i.address,o,gn(c,i.address),Se.scalar(),l,u)}else r instanceof ta?this.setCellEmpty(i.address):r instanceof vn&&this.setValueToCell(r.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address)}}]),a}();function md(a){if(a.length<=1)return a;for(var t=Yg(a).sort(function(i,s){var o=Nn(i,1),l=o[0],u=Nn(s,1),c=u[0];return l-c}),e=t.reduce(function(i,s){var o=Nn(s,2),l=o[0],u=o[1],c=i[i.length-1],p=c[0]+c[1];return l<=p?c[1]+=Math.max(0,u-(p-l)):i.push([l,u]),i},[t[0]]),r=0,n=0;n<e.length;++n)e[n][0]-=r,r+=e[n][1];return e}function fd(a){if(a.length<=1)return a;for(var t=Yg(a).sort(function(i,s){var o=Nn(i,1),l=o[0],u=Nn(s,1),c=u[0];return l-c}),e=t.reduce(function(i,s){var o=Nn(s,2),l=o[0],u=o[1],c=i[i.length-1];return l===c[0]?c[1]=Math.max(c[1],u):i.push([l,u]),i},[t[0]]),r=0,n=0;n<e.length;++n)e[n][0]+=r,r+=e[n][1];return e}function tv(a){return Number.isInteger(a)&&a>0}function kfe(a,t,e){return a.row===0&&tv(t)&&e===Number.POSITIVE_INFINITY||a.col===0&&tv(e)&&t===Number.POSITIVE_INFINITY}var hJe=M(xr());var bJe=M(q());var RJe=M(ie());function jS(a){return jS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jS(a)}function rv(a,t){return Mfe(a)||jfe(a,t)||Oj(a,t)||Ffe()}function Ffe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jfe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Mfe(a){if(Array.isArray(a))return a}function Aa(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=Oj(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function Oj(a,t){if(!!a){if(typeof a=="string")return Dj(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Dj(a,t)}}function Dj(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function er(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&MS(a,t)}function MS(a,t){return MS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},MS(a,t)}function tr(a){var t=Ufe();return function(){var r=nv(a),n;if(t){var i=nv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Bfe(this,n)}}function Bfe(a,t){if(t&&(jS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lfe(a)}function Lfe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Ufe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function nv(a){return nv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nv(a)}function Ij(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Mt(a,t,e){return t&&Ij(a.prototype,t),e&&Ij(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Bt(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var rr=Mt(function a(){Bt(this,a)}),Pj=function(a){er(e,a);var t=tr(e);function e(r,n){var i;return Bt(this,e),i=t.call(this),i.command=r,i.rowsRemovals=n,i}return Mt(e,[{key:"doUndo",value:function(n){n.undoRemoveRows(this)}},{key:"doRedo",value:function(n){n.redoRemoveRows(this)}}]),e}(rr),_j=function(a){er(e,a);var t=tr(e);function e(r,n,i,s,o,l,u){var c;return Bt(this,e),c=t.call(this),c.sourceLeftCorner=r,c.width=n,c.height=i,c.destinationLeftCorner=s,c.overwrittenCellsData=o,c.addedGlobalNamedExpressions=l,c.version=u,c}return Mt(e,[{key:"doUndo",value:function(n){n.undoMoveCells(this)}},{key:"doRedo",value:function(n){n.redoMoveCells(this)}}]),e}(rr),kj=function(a){er(e,a);var t=tr(e);function e(r){var n;return Bt(this,e),n=t.call(this),n.command=r,n}return Mt(e,[{key:"doUndo",value:function(n){n.undoAddRows(this)}},{key:"doRedo",value:function(n){n.redoAddRows(this)}}]),e}(rr),Fj=function(a){er(e,a);var t=tr(e);function e(r,n,i){var s;return Bt(this,e),s=t.call(this),s.sheetId=r,s.rowMapping=n,s.oldContent=i,s}return Mt(e,[{key:"doUndo",value:function(n){n.undoSetRowOrder(this)}},{key:"doRedo",value:function(n){n.redoSetRowOrder(this)}}]),e}(rr),jj=function(a){er(e,a);var t=tr(e);function e(r,n,i){var s;return Bt(this,e),s=t.call(this),s.sheetId=r,s.columnMapping=n,s.oldContent=i,s}return Mt(e,[{key:"doUndo",value:function(n){n.undoSetColumnOrder(this)}},{key:"doRedo",value:function(n){n.redoSetColumnOrder(this)}}]),e}(rr),Mj=function(a){er(e,a);var t=tr(e);function e(r,n,i){var s;return Bt(this,e),s=t.call(this),s.sheetId=r,s.oldSheetContent=n,s.newSheetContent=i,s}return Mt(e,[{key:"doUndo",value:function(n){n.undoSetSheetContent(this)}},{key:"doRedo",value:function(n){n.redoSetSheetContent(this)}}]),e}(rr),Bj=function(a){er(e,a);var t=tr(e);function e(r,n,i,s,o){var l;return Bt(this,e),l=t.call(this),l.sheet=r,l.startRow=n,l.numberOfRows=i,l.targetRow=s,l.version=o,l.undoStart=l.startRow<l.targetRow?l.targetRow-l.numberOfRows:l.targetRow,l.undoEnd=l.startRow>l.targetRow?l.startRow+l.numberOfRows:l.startRow,l}return Mt(e,[{key:"doUndo",value:function(n){n.undoMoveRows(this)}},{key:"doRedo",value:function(n){n.redoMoveRows(this)}}]),e}(rr),Lj=function(a){er(e,a);var t=tr(e);function e(r,n,i,s,o){var l;return Bt(this,e),l=t.call(this),l.sheet=r,l.startColumn=n,l.numberOfColumns=i,l.targetColumn=s,l.version=o,l.undoStart=l.startColumn<l.targetColumn?l.targetColumn-l.numberOfColumns:l.targetColumn,l.undoEnd=l.startColumn>l.targetColumn?l.startColumn+l.numberOfColumns:l.startColumn,l}return Mt(e,[{key:"doUndo",value:function(n){n.undoMoveColumns(this)}},{key:"doRedo",value:function(n){n.redoMoveColumns(this)}}]),e}(rr),Uj=function(a){er(e,a);var t=tr(e);function e(r){var n;return Bt(this,e),n=t.call(this),n.command=r,n}return Mt(e,[{key:"doUndo",value:function(n){n.undoAddColumns(this)}},{key:"doRedo",value:function(n){n.redoAddColumns(this)}}]),e}(rr),zj=function(a){er(e,a);var t=tr(e);function e(r,n){var i;return Bt(this,e),i=t.call(this),i.command=r,i.columnsRemovals=n,i}return Mt(e,[{key:"doUndo",value:function(n){n.undoRemoveColumns(this)}},{key:"doRedo",value:function(n){n.redoRemoveColumns(this)}}]),e}(rr),Gj=function(a){er(e,a);var t=tr(e);function e(r){var n;return Bt(this,e),n=t.call(this),n.sheetName=r,n}return Mt(e,[{key:"doUndo",value:function(n){n.undoAddSheet(this)}},{key:"doRedo",value:function(n){n.redoAddSheet(this)}}]),e}(rr),Hj=function(a){er(e,a);var t=tr(e);function e(r,n,i,s,o){var l;return Bt(this,e),l=t.call(this),l.sheetName=r,l.sheetId=n,l.oldSheetContent=i,l.scopedNamedExpressions=s,l.version=o,l}return Mt(e,[{key:"doUndo",value:function(n){n.undoRemoveSheet(this)}},{key:"doRedo",value:function(n){n.redoRemoveSheet(this)}}]),e}(rr),qj=function(a){er(e,a);var t=tr(e);function e(r,n,i){var s;return Bt(this,e),s=t.call(this),s.sheetId=r,s.oldName=n,s.newName=i,s}return Mt(e,[{key:"doUndo",value:function(n){n.undoRenameSheet(this)}},{key:"doRedo",value:function(n){n.redoRenameSheet(this)}}]),e}(rr),Wj=function(a){er(e,a);var t=tr(e);function e(r,n){var i;return Bt(this,e),i=t.call(this),i.sheetId=r,i.oldSheetContent=n,i}return Mt(e,[{key:"doUndo",value:function(n){n.undoClearSheet(this)}},{key:"doRedo",value:function(n){n.redoClearSheet(this)}}]),e}(rr),$j=function(a){er(e,a);var t=tr(e);function e(r){var n;return Bt(this,e),n=t.call(this),n.cellContents=r,n}return Mt(e,[{key:"doUndo",value:function(n){n.undoSetCellContents(this)}},{key:"doRedo",value:function(n){n.redoSetCellContents(this)}}]),e}(rr),Kj=function(a){er(e,a);var t=tr(e);function e(r,n,i,s){var o;return Bt(this,e),o=t.call(this),o.targetLeftCorner=r,o.oldContent=n,o.newContent=i,o.addedGlobalNamedExpressions=s,o}return Mt(e,[{key:"doUndo",value:function(n){n.undoPaste(this)}},{key:"doRedo",value:function(n){n.redoPaste(this)}}]),e}(rr),Xj=function(a){er(e,a);var t=tr(e);function e(r,n,i,s){var o;return Bt(this,e),o=t.call(this),o.name=r,o.newContent=n,o.scope=i,o.options=s,o}return Mt(e,[{key:"doUndo",value:function(n){n.undoAddNamedExpression(this)}},{key:"doRedo",value:function(n){n.redoAddNamedExpression(this)}}]),e}(rr),Yj=function(a){er(e,a);var t=tr(e);function e(r,n,i){var s;return Bt(this,e),s=t.call(this),s.namedExpression=r,s.content=n,s.scope=i,s}return Mt(e,[{key:"doUndo",value:function(n){n.undoRemoveNamedExpression(this)}},{key:"doRedo",value:function(n){n.redoRemoveNamedExpression(this)}}]),e}(rr),Zj=function(a){er(e,a);var t=tr(e);function e(r,n,i,s,o){var l;return Bt(this,e),l=t.call(this),l.namedExpression=r,l.newContent=n,l.oldContent=i,l.scope=s,l.options=o,l}return Mt(e,[{key:"doUndo",value:function(n){n.undoChangeNamedExpression(this)}},{key:"doRedo",value:function(n){n.redoChangeNamedExpression(this)}}]),e}(rr),zfe=function(a){er(e,a);var t=tr(e);function e(){var r;return Bt(this,e),r=t.apply(this,arguments),r.operations=[],r}return Mt(e,[{key:"add",value:function(n){this.operations.push(n)}},{key:"reversedOperations",value:regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n=this.operations.length-1;case 1:if(!(n>=0)){s.next=7;break}return s.next=4,this.operations[n];case 4:n--,s.next=1;break;case 7:case"end":return s.stop()}},r,this)})},{key:"doUndo",value:function(n){n.undoBatch(this)}},{key:"doRedo",value:function(n){n.redoBatch(this)}}]),e}(rr),Jj=function(){function a(t,e){Bt(this,a),this.operations=e,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=t.undoLimit}return Mt(a,[{key:"saveOperation",value:function(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}},{key:"beginBatchMode",value:function(){this.batchUndoEntry=new zfe}},{key:"commitBatchMode",value:function(){if(this.batchUndoEntry===void 0)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}},{key:"storeDataForVersion",value:function(e,r,n){this.oldData.has(e)||this.oldData.set(e,[]);var i=this.oldData.get(e);i.push([r,n])}},{key:"clearRedoStack",value:function(){this.redoStack=[]}},{key:"clearUndoStack",value:function(){this.undoStack=[]}},{key:"isUndoStackEmpty",value:function(){return this.undoStack.length===0}},{key:"isRedoStackEmpty",value:function(){return this.redoStack.length===0}},{key:"undo",value:function(){var e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}},{key:"undoBatch",value:function(e){var r=Aa(e.reversedOperations()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.undoEntry(i)}}catch(s){r.e(s)}finally{r.f()}}},{key:"undoRemoveRows",value:function(e){this.operations.forceApplyPostponedTransformations();for(var r=e.command.sheet,n=e.rowsRemovals,i=n.length-1;i>=0;--i){var s=n[i];this.operations.addRows(new Jg(r,[[s.rowFrom,s.rowCount]]));var o=Aa(s.removedCells),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=u.address,p=u.cellType;this.operations.restoreCell(c,p)}}catch(m){o.e(m)}finally{o.f()}this.restoreOldDataFromVersion(s.version-1)}}},{key:"undoRemoveColumns",value:function(e){this.operations.forceApplyPostponedTransformations();for(var r=e.command.sheet,n=e.columnsRemovals,i=n.length-1;i>=0;--i){var s=n[i];this.operations.addColumns(new Qg(r,[[s.columnFrom,s.columnCount]]));var o=Aa(s.removedCells),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=u.address,p=u.cellType;this.operations.restoreCell(c,p)}}catch(m){o.e(m)}finally{o.f()}this.restoreOldDataFromVersion(s.version-1)}}},{key:"undoAddRows",value:function(e){for(var r=e.command.rowsSpans(),n=r.length-1;n>=0;--n){var i=r[n];this.operations.removeRows(new Zg(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}},{key:"undoAddColumns",value:function(e){for(var r=e.command.columnsSpans(),n=r.length-1;n>=0;--n){var i=r[n];this.operations.removeColumns(new ev(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}},{key:"undoSetCellContents",value:function(e){var r=Aa(e.cellContents),n;try{for(r.s();!(n=r.n()).done;){var i=n.value,s=i.address,o=rv(i.oldContent,2),l=o[0],u=o[1];Yi(s,l)||this.operations.setCellEmpty(s),this.operations.restoreCell(l,u)}}catch(c){r.e(c)}finally{r.f()}}},{key:"undoPaste",value:function(e){this.restoreOperationOldContent(e.oldContent);var r=Aa(e.addedGlobalNamedExpressions),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.operations.removeNamedExpression(i)}}catch(s){r.e(s)}finally{r.f()}}},{key:"undoMoveRows",value:function(e){var r=e.sheet;this.operations.moveRows(r,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveColumns",value:function(e){var r=e.sheet;this.operations.moveColumns(r,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveCells",value:function(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);var r=Aa(e.addedGlobalNamedExpressions),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.operations.removeNamedExpression(i)}}catch(s){r.e(s)}finally{r.f()}}},{key:"undoAddSheet",value:function(e){var r=e.sheetName;this.operations.removeSheetByName(r)}},{key:"undoRemoveSheet",value:function(e){this.operations.forceApplyPostponedTransformations();var r=e.oldSheetContent,n=e.sheetId;this.operations.addSheet(e.sheetName);for(var i=0;i<r.length;i++)for(var s=r[i],o=0;o<s.length;o++){var l=s[o],u=$(n,o,i);this.operations.restoreCell(u,l)}var c=Aa(e.scopedNamedExpressions),p;try{for(c.s();!(p=c.n()).done;){var m=rv(p.value,2),f=m[0],d=m[1];this.operations.restoreNamedExpression(f,d,n)}}catch(h){c.e(h)}finally{c.f()}this.restoreOldDataFromVersion(e.version-1)}},{key:"undoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.oldName)}},{key:"undoClearSheet",value:function(e){for(var r=e.oldSheetContent,n=e.sheetId,i=0;i<r.length;i++)for(var s=r[i],o=0;o<s.length;o++){var l=s[o],u=$(n,o,i);this.operations.restoreCell(u,l)}}},{key:"undoSetSheetContent",value:function(e){var r=e.oldSheetContent,n=e.sheetId;this.operations.clearSheet(n);for(var i=0;i<r.length;i++)for(var s=r[i],o=0;o<s.length;o++){var l=s[o],u=$(n,o,i);this.operations.restoreCell(u,l)}}},{key:"undoAddNamedExpression",value:function(e){this.operations.removeNamedExpression(e.name,e.scope)}},{key:"undoRemoveNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}},{key:"undoChangeNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}},{key:"undoSetRowOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"undoSetColumnOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"redo",value:function(){var e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}},{key:"redoBatch",value:function(e){var r=Aa(e.operations),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.redoEntry(i)}}catch(s){r.e(s)}finally{r.f()}}},{key:"redoRemoveRows",value:function(e){this.operations.removeRows(e.command)}},{key:"redoMoveCells",value:function(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}},{key:"redoRemoveColumns",value:function(e){this.operations.removeColumns(e.command)}},{key:"redoPaste",value:function(e){for(var r=e.targetLeftCorner,n=e.newContent,i=n.length,s=n[0].length,o=0;o<i;++o)for(var l=0;l<s;++l){var u=$(r.sheet,r.col+l,r.row+o);this.operations.restoreCell(u,n[o][l])}}},{key:"redoSetCellContents",value:function(e){var r=Aa(e.cellContents),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.operations.setCellContent(i.address,i.newContent)}}catch(s){r.e(s)}finally{r.f()}}},{key:"redoAddRows",value:function(e){this.operations.addRows(e.command)}},{key:"redoAddColumns",value:function(e){this.operations.addColumns(e.command)}},{key:"redoRemoveSheet",value:function(e){this.operations.removeSheetByName(e.sheetName)}},{key:"redoAddSheet",value:function(e){this.operations.addSheet(e.sheetName)}},{key:"redoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.newName)}},{key:"redoMoveRows",value:function(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}},{key:"redoMoveColumns",value:function(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}},{key:"redoClearSheet",value:function(e){this.operations.clearSheet(e.sheetId)}},{key:"redoSetSheetContent",value:function(e){var r=e.sheetId,n=e.newSheetContent;this.operations.setSheetContent(r,n)}},{key:"redoAddNamedExpression",value:function(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}},{key:"redoRemoveNamedExpression",value:function(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}},{key:"redoChangeNamedExpression",value:function(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}},{key:"redoSetRowOrder",value:function(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}},{key:"redoSetColumnOrder",value:function(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}},{key:"addUndoEntry",value:function(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}},{key:"undoEntry",value:function(e){e.doUndo(this)}},{key:"restoreOperationOldContent",value:function(e){var r=Aa(e),n;try{for(r.s();!(n=r.n()).done;){var i=rv(n.value,2),s=i[0],o=i[1];this.operations.restoreCell(s,o)}}catch(l){r.e(l)}finally{r.f()}}},{key:"redoEntry",value:function(e){e.doRedo(this)}},{key:"restoreOldDataFromVersion",value:function(e){var r=this.oldData.get(e)||[],n=Aa(r),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=rv(s,2),l=o[0],u=o[1];this.operations.setFormulaToCellFromCache(u,l)}}catch(c){n.e(c)}finally{n.f()}}}]),a}();function ri(a,t){return qfe(a)||Hfe(a,t)||Qj(a,t)||Gfe()}function Gfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hfe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function qfe(a){if(Array.isArray(a))return a}function BS(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=Qj(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function Qj(a,t){if(!!a){if(typeof a=="string")return eM(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return eM(a,t)}}function eM(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Wfe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function tM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function $fe(a,t,e){return t&&tM(a.prototype,t),e&&tM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var rM=function(){function a(t,e,r,n,i,s,o,l,u,c){Wfe(this,a),this.operations=e,this.undoRedo=r,this.clipboardOperations=n,this.dependencyGraph=i,this.columnSearch=s,this.parser=o,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=t.maxRows,this.maxColumns=t.maxColumns}return $fe(a,[{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addRows",value:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=new Jg(e,n);this.ensureItIsPossibleToAddRows.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(s),this.undoRedo.saveOperation(new kj(s))}},{key:"removeRows",value:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=new Zg(e,n);this.ensureItIsPossibleToRemoveRows.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.removeRows(s);this.undoRedo.saveOperation(new Pj(s,o))}},{key:"addColumns",value:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=new Qg(e,n);this.ensureItIsPossibleToAddColumns.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(s),this.undoRedo.saveOperation(new Uj(s))}},{key:"removeColumns",value:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=new ev(e,n);this.ensureItIsPossibleToRemoveColumns.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.removeColumns(s);this.undoRedo.saveOperation(new zj(s,o))}},{key:"moveCells",value:function(e,r,n,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var s=this.operations.moveCells(e,r,n,i),o=s.version,l=s.overwrittenCellsData,u=s.addedGlobalNamedExpressions;this.undoRedo.saveOperation(new _j(e,r,n,i,l,u,o))}},{key:"moveRows",value:function(e,r,n,i){this.ensureItIsPossibleToMoveRows(e,r,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var s=this.operations.moveRows(e,r,n,i);this.undoRedo.saveOperation(new Bj(e,r,n,i,s))}},{key:"moveColumns",value:function(e,r,n,i){this.ensureItIsPossibleToMoveColumns(e,r,n,i),this.undoRedo.clearRedoStack();var s=this.operations.moveColumns(e,r,n,i);this.undoRedo.saveOperation(new Lj(e,r,n,i,s))}},{key:"cut",value:function(e,r,n){this.clipboardOperations.cut(e,r,n)}},{key:"ensureItIsPossibleToCopy",value:function(e,r,n){if(!Zc(r))throw new pt("width to be positive integer.");if(!Zc(n))throw new pt("height to be positive integer.")}},{key:"copy",value:function(e,r,n){this.ensureItIsPossibleToCopy(e,r,n),this.clipboardOperations.copy(e,r,n)}},{key:"paste",value:function(e){var r=this.clipboardOperations.clipboard;if(r===void 0)throw new ib;if(this.clipboardOperations.isCutClipboard())this.moveCells(r.sourceLeftCorner,r.width,r.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);var n=oe.spanFrom(e,r.width,r.height),i=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();var s=this.operations.restoreClipboardCells(r.sourceLeftCorner.sheet,r.getContent(e));this.undoRedo.saveOperation(new Kj(e,i,r.content,s))}}},{key:"beginUndoRedoBatchMode",value:function(){this.undoRedo.beginBatchMode()}},{key:"commitUndoRedoBatchMode",value:function(){this.undoRedo.commitBatchMode()}},{key:"isClipboardEmpty",value:function(){return this.clipboardOperations.clipboard===void 0}},{key:"clearClipboard",value:function(){this.clipboardOperations.clear()}},{key:"addSheet",value:function(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();var r=this.operations.addSheet(e);return this.undoRedo.saveOperation(new Gj(r)),r}},{key:"removeSheet",value:function(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var r=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),i=this.operations.removeSheet(e),s=i.version,o=i.scopedNamedExpressions;this.undoRedo.saveOperation(new Hj(r,e,n,o,s))}},{key:"renameSheet",value:function(e,r){this.ensureItIsPossibleToRenameSheet(e,r);var n=this.operations.renameSheet(e,r);return n!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new qj(e,n,r))),n}},{key:"clearSheet",value:function(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var r=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new Wj(e,r))}},{key:"setCellContents",value:function(e,r){if(!(r instanceof Array))r=[[r]];else for(var n=0;n<r.length;n++)if(!(r[n]instanceof Array))throw new pt("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,r),this.undoRedo.clearRedoStack();for(var i=[],s=0;s<r.length;s++)for(var o=0;o<r[s].length;o++){var l={sheet:e.sheet,row:e.row+s,col:e.col+o},u=r[s][o];this.clipboardOperations.abortCut();var c=this.operations.setCellContent(l,u);i.push({address:l,newContent:u,oldContent:c})}this.undoRedo.saveOperation(new $j(i))}},{key:"setSheetContent",value:function(e,r){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,r),Xg(r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,r),this.undoRedo.saveOperation(new Mj(e,n,r))}},{key:"setRowOrder",value:function(e,r){this.validateSwapRowIndexes(e,r),this.testRowOrderForArrays(e,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.setRowOrder(e,r);this.undoRedo.saveOperation(new Fj(e,r,n))}},{key:"validateSwapRowIndexes",value:function(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new tt(e);this.validateRowOrColumnMapping(e,r,"row")}},{key:"testColumnOrderForArrays",value:function(e,r){var n=BS(r),i;try{for(n.s();!(i=n.n()).done;){var s=ri(i.value,2),o=s[0],l=s[1];if(o!==l){var u=oe.spanFrom({sheet:e,col:o,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new Mi}}}catch(c){n.e(c)}finally{n.f()}}},{key:"setColumnOrder",value:function(e,r){this.validateSwapColumnIndexes(e,r),this.testColumnOrderForArrays(e,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.setColumnOrder(e,r);this.undoRedo.saveOperation(new jj(e,r,n))}},{key:"validateSwapColumnIndexes",value:function(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new tt(e);this.validateRowOrColumnMapping(e,r,"column")}},{key:"testRowOrderForArrays",value:function(e,r){var n=BS(r),i;try{for(n.s();!(i=n.n()).done;){var s=ri(i.value,2),o=s[0],l=s[1];if(o!==l){var u=oe.spanFrom({sheet:e,col:0,row:o},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new Mi}}}catch(c){n.e(c)}finally{n.f()}}},{key:"mappingFromOrder",value:function(e,r,n){if(!this.sheetMapping.hasSheetWithId(e))throw new tt(e);var i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(r.length!==i)throw new pt("number of ".concat(n,"s provided to be sheet ").concat(n==="row"?"height":"width","."));for(var s=[],o=0;o<i;o++)r[o]!==o&&s.push([o,r[o]]);return s}},{key:"undo",value:function(){if(this.undoRedo.isUndoStackEmpty())throw new nb;this.clipboardOperations.abortCut(),this.undoRedo.undo()}},{key:"redo",value:function(){if(this.undoRedo.isRedoStackEmpty())throw new ab;this.clipboardOperations.abortCut(),this.undoRedo.redo()}},{key:"addNamedExpression",value:function(e,r,n,i){this.ensureItIsPossibleToAddNamedExpression(e,r,n),this.operations.addNamedExpression(e,r,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Xj(e,r,n,i))}},{key:"changeNamedExpressionExpression",value:function(e,r,n,i){this.ensureItIsPossibleToChangeNamedExpression(e,n,r);var s=this.operations.changeNamedExpressionExpression(e,n,r,i),o=ri(s,2),l=o[0],u=o[1];this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Zj(l,n,u,r,i))}},{key:"removeNamedExpression",value:function(e,r){this.ensureScopeIdIsValid(r);var n=this.operations.removeNamedExpression(e,r),i=ri(n,2),s=i[0],o=i[1];return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Yj(s,o,r)),s}},{key:"ensureItIsPossibleToAddNamedExpression",value:function(e,r,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(r)}},{key:"ensureItIsPossibleToChangeNamedExpression",value:function(e,r,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new Fs(e);this.ensureNamedExpressionIsValid(r)}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new Fs(e)}},{key:"ensureItIsPossibleToAddRows",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new tt(e);for(var r=this.dependencyGraph.getSheetHeight(e),n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var o=i.map(function(f){return f[1]}).reduce(function(f,d){return f+d},0);if(r+o>this.maxRows)throw new Kn;for(var l=0,u=i;l<u.length;l++){var c=ri(u[l],2),p=c[0],m=c[1];if(!fl(p)||!Zc(m))throw new pt("row number to be nonnegative and number of rows to add to be positive.")}}},{key:"ensureItIsPossibleToRemoveRows",value:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var s=0,o=n;s<o.length;s++){var l=ri(o[s],2),u=l[0],c=l[1],p=u+c-1;if(!fl(u)||!fl(p))throw new pt("starting and ending row to be nonnegative.");if(p<u)throw new pt("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new tt(e)}}},{key:"ensureItIsPossibleToAddColumns",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new tt(e);for(var r=this.dependencyGraph.getSheetWidth(e),n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var o=i.map(function(f){return f[1]}).reduce(function(f,d){return f+d},0);if(r+o>this.maxColumns)throw new Kn;for(var l=0,u=i;l<u.length;l++){var c=ri(u[l],2),p=c[0],m=c[1];if(!fl(p)||!Zc(m))throw new pt("column number to be nonnegative and number of columns to add to be positive.")}}},{key:"ensureItIsPossibleToRemoveColumns",value:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var s=0,o=n;s<o.length;s++){var l=ri(o[s],2),u=l[0],c=l[1],p=u+c-1;if(!fl(u)||!fl(p))throw new pt("starting and ending column to be nonnegative.");if(p<u)throw new pt("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new tt(e)}}},{key:"ensureItIsPossibleToMoveRows",value:function(e,r,n,i){this.ensureItIsPossibleToAddRows(e,[i,n]);var s=$(e,0,r),o=$(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||Kt(s)||Kt(o)||!Zc(n)||i<=r+n&&i>=r)throw new pt("a valid range of rows to move.");var l=this.dependencyGraph.getSheetWidth(e),u=oe.spanFrom(s,l,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new Mi;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(yn.fromNumberOfRows(e,i-1,2)))throw new Ho}},{key:"ensureItIsPossibleToMoveColumns",value:function(e,r,n,i){this.ensureItIsPossibleToAddColumns(e,[i,n]);var s=$(e,r,0),o=$(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||Kt(s)||Kt(o)||!Zc(n)||i<=r+n&&i>=r)throw new pt("a valid range of columns to move.");var l=this.dependencyGraph.getSheetHeight(e),u=oe.spanFrom(s,n,l);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new Mi;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(ea.fromNumberOfColumns(e,i-1,2)))throw new Ho}},{key:"ensureItIsPossibleToAddSheet",value:function(e){if(this.sheetMapping.hasSheetWithName(e))throw new ks(e)}},{key:"ensureItIsPossibleToRenameSheet",value:function(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new tt(e);var n=this.sheetMapping.get(r);if(n!==void 0&&n!==e)throw new ks(r)}},{key:"ensureItIsPossibleToChangeContent",value:function(e){if(Kt(e))throw new eb(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new tt(e.sheet)}},{key:"ensureItIsPossibleToChangeCellContents",value:function(e,r){var n=ml(r),i=oe.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(i);var s=BS(i.addresses(this.dependencyGraph)),o;try{for(s.s();!(o=s.n()).done;){var l=o.value;this.ensureItIsPossibleToChangeContent(l)}}catch(u){s.e(u)}finally{s.f()}}},{key:"ensureItIsPossibleToChangeSheetContents",value:function(e,r){var n=ml(r),i=oe.spanFrom($(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(i)}},{key:"ensureRangeInSizeLimits",value:function(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Kn}},{key:"isThereSomethingToUndo",value:function(){return!this.undoRedo.isUndoStackEmpty()}},{key:"isThereSomethingToRedo",value:function(){return!this.undoRedo.isRedoStackEmpty()}},{key:"getAndClearContentChanges",value:function(){return this.operations.getAndClearContentChanges()}},{key:"ensureScopeIdIsValid",value:function(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new tt(e)}},{key:"validateRowOrColumnMapping",value:function(e,r,n){for(var i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),s=r.map(function(u){var c=ri(u,2),p=c[0],m=c[1];return p}).sort(function(u,c){return u-c}),o=r.map(function(u){var c=ri(u,2),p=c[0],m=c[1];return m}).sort(function(u,c){return u-c}),l=0;l<s.length;l++){if(!fl(s[l])||s[l]>=i)throw new pt("".concat(n," numbers to be nonnegative integers and less than sheet ").concat(n==="row"?"height":"width","."));if(s[l]===s[l+1])throw new pt("source ".concat(n," numbers to be unique."));if(s[l]!==o[l])throw new pt("target ".concat(n," numbers to be permutation of source ").concat(n," numbers."))}}},{key:"ensureNamedExpressionNameIsValid",value:function(e,r){if(!this.namedExpressions.isNameValid(e))throw new rb(e);if(!this.namedExpressions.isNameAvailable(e,r))throw new tb(e)}},{key:"ensureNamedExpressionIsValid",value:function(e){var r=this.cellContentParser.parse(e);if(r instanceof rt.Formula){var n=this.parser.parse(r.formula,$(-1,0,0));if(Ug(n.ast))throw new uc}}}]),a}();function Zc(a){return Number.isInteger(a)&&a>0}function fl(a){return Number.isInteger(a)&&a>=0}var fQe=M(ie());var bQe=M(q());function Kfe(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=Xfe(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function Xfe(a,t){if(!!a){if(typeof a=="string")return nM(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return nM(a,t)}}function nM(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Yfe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Zfe(a,t,e){return t&&aM(a.prototype,t),e&&aM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var iM=function(){function a(t,e,r,n,i,s){Yfe(this,a),this.config=t,this.stats=e,this.interpreter=r,this.lazilyTransformingAstService=n,this.dependencyGraph=i,this.columnSearch=s}return Zfe(a,[{key:"run",value:function(){var e=this;this.stats.start(ue.TOP_SORT);var r=this.dependencyGraph.topSortWithScc(),n=r.sorted,i=r.cycled;this.stats.end(ue.TOP_SORT),this.stats.measure(ue.EVALUATION,function(){e.recomputeFormulas(i,n)})}},{key:"partialRun",value:function(e){var r=this,n=Zi.empty();return this.stats.measure(ue.EVALUATION,function(){r.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,function(i){if(i instanceof dr){var s=i.isComputed()?i.getCellValue():void 0,o=r.recomputeFormulaVertexValue(i);if(o!==s){var l=i.getAddress(r.lazilyTransformingAstService);return n.addChange(o,l),r.columnSearch.change(W(s),W(o),l),!0}return!1}else return i instanceof Qt&&i.clearCache(),!0},function(i){if(i instanceof Qt)i.clearCache();else if(i instanceof dr){var s=i.getAddress(r.lazilyTransformingAstService);r.columnSearch.remove(W(i.valueOrUndef()),s);var o=new E(V.CYCLE,void 0,i);i.setCellValue(o),n.addChange(o,s)}})}),n}},{key:"runAndForget",value:function(e,r,n){var i=this,s=[],o=Kfe(gn(n,r)),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;if(u instanceof oe){var c=u;if(this.dependencyGraph.getRange(c.start,c.end)===void 0){var p=new Qt(c);this.dependencyGraph.rangeMapping.setRange(p),s.push(p)}}}}catch(f){o.e(f)}finally{o.f()}var m=this.evaluateAstToCellValue(e,new Jr(r,this.config.useArrayArithmetic));return s.forEach(function(f){i.dependencyGraph.rangeMapping.removeRange(f)}),m}},{key:"recomputeFormulas",value:function(e,r){var n=this;e.forEach(function(i){i instanceof dr&&i.setCellValue(new E(V.CYCLE,void 0,i))}),r.forEach(function(i){if(i instanceof dr){var s=n.recomputeFormulaVertexValue(i),o=i.getAddress(n.lazilyTransformingAstService);n.columnSearch.add(W(s),o)}else i instanceof Qt&&i.clearCache()})}},{key:"recomputeFormulaVertexValue",value:function(e){var r=e.getAddress(this.lazilyTransformingAstService);if(e instanceof Ye&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();var n=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(n,new Jr(r,this.config.useArrayArithmetic,e));return e.setCellValue(i)}},{key:"evaluateAstToCellValue",value:function(e,r){var n=this.interpreter.evaluateAst(e,r);return n instanceof Q?n:n===le&&this.config.evaluateNullToZero?0:n}}]),a}();var ede=he(),tde=oM();ede({target:"Math",stat:!0},{log10:tde});var BQe=M(ie());var GQe=M(q());function rde(a,t){return ide(a)||ade(a,t)||lM(a,t)||nde()}function nde(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ade(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function ide(a){if(Array.isArray(a))return a}function sde(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=lM(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function lM(a,t){if(!!a){if(typeof a=="string")return uM(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return uM(a,t)}}function uM(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function LS(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function cM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function US(a,t,e){return t&&cM(a.prototype,t),e&&cM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var av=function(){function a(t,e){LS(this,a),this.address=t,this.newValue=e}return US(a,[{key:"col",get:function(){return this.address.col}},{key:"row",get:function(){return this.address.row}},{key:"sheet",get:function(){return this.address.sheet}},{key:"value",get:function(){return this.newValue}}]),a}(),zS=US(function a(t,e){LS(this,a),this.name=t,this.newValue=e}),pM=function(){function a(t,e,r,n){LS(this,a),this.config=t,this.namedExpressions=e,this.sheetIndexMapping=r,this.lazilyTransformingService=n}return US(a,[{key:"exportChange",value:function(e){var r=e.value,n=e.address;if(n.sheet===Yc.SHEET_FOR_WORKBOOK_EXPRESSIONS){var i=this.namedExpressions.namedExpressionInAddress(n.row);if(!i)throw new Error("Missing named expression");return new zS(i.displayName,this.exportScalarOrRange(r))}else if(r instanceof Q){var s=[],o=sde(r.entriesFromTopLeftCorner(n)),l;try{for(o.s();!(l=o.n()).done;){var u=rde(l.value,2),c=u[0],p=u[1];s.push(new av(p,this.exportValue(c)))}}catch(m){o.e(m)}finally{o.f()}return s}else return new av(n,this.exportValue(r))}},{key:"exportValue",value:function(e){return e instanceof Q?this.detailedError(new E(V.VALUE,D.ScalarExpected)):this.config.smartRounding&&Ce(e)?this.cellValueRounding(W(e)):e instanceof E?this.detailedError(e):e===le?null:W(e)}},{key:"exportScalarOrRange",value:function(e){var r=this;return e instanceof Q?e.rawData().map(function(n){return n.map(function(i){return r.exportValue(i)})}):this.exportValue(e)}},{key:"detailedError",value:function(e){var r,n,i=void 0,s=(r=e.root)===null||r===void 0?void 0:r.getAddress(this.lazilyTransformingService);return s!==void 0&&(s.sheet===Yc.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(n=this.namedExpressions.namedExpressionInAddress(s.row))===null||n===void 0?void 0:n.displayName:i=nl(this.sheetIndexMapping,s,-1)),new Sg(e,this.config.translationPackage.getErrorTranslation(e.type),i)}},{key:"cellValueRounding",value:function(e){if(e===0)return e;var r=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-r);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}]),a}();var tet=M(q());function mM(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function fM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function dM(a,t,e){return t&&fM(a.prototype,t),e&&fM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var hM=function(){function a(t,e,r,n,i,s){mM(this,a),this.dependencyGraph=t,this.columnSearch=e,this.parser=r,this.cellContentParser=n,this.stats=i,this.arraySizePredictor=s,this.buildStrategy=new ode(t,e,r,i,n,s)}return dM(a,[{key:"buildGraph",value:function(e,r){var n=this,i=r.measure(ue.COLLECT_DEPENDENCIES,function(){return n.buildStrategy.run(e)});this.dependencyGraph.getAndClearContentChanges(),r.measure(ue.PROCESS_DEPENDENCIES,function(){return n.processDependencies(i)})}},{key:"processDependencies",value:function(e){var r=this;e.forEach(function(n,i){r.dependencyGraph.processCellDependencies(n,i)})}}]),a}(),ode=function(){function a(t,e,r,n,i,s){mM(this,a),this.dependencyGraph=t,this.columnIndex=e,this.parser=r,this.stats=n,this.cellContentParser=i,this.arraySizePredictor=s}return dM(a,[{key:"run",value:function(e){var r=this,n=new Map;for(var i in e)for(var s=this.dependencyGraph.getSheetId(i),o=e[i],l=0;l<o.length;++l)for(var u=o[l],c=function(f){var d=u[f],h=$(s,f,l),y=r.cellContentParser.parse(d);if(y instanceof rt.Formula){var b=r.stats.measure(ue.PARSER,function(){return r.parser.parse(y.formula,h)});if(b.errors.length>0){r.shrinkArrayIfNeeded(h);var g=new Ta(b.errors,y.formula);r.dependencyGraph.addVertex(h,g)}else{r.shrinkArrayIfNeeded(h);var v=r.arraySizePredictor.checkArraySize(b.ast,h);if(v.isScalar()){var A=new Qr(b.ast,h,0);n.set(A,gn(b.dependencies,h)),r.dependencyGraph.addVertex(h,A),b.hasVolatileFunction&&r.dependencyGraph.markAsVolatile(A),b.hasStructuralChangeFunction&&r.dependencyGraph.markAsDependentOnStructureChange(A)}else{var C=new Ye(b.ast,h,new Se(v.width,v.height));n.set(C,gn(b.dependencies,h)),r.dependencyGraph.addArrayVertex(h,C)}}}else if(!(y instanceof rt.Empty)){r.shrinkArrayIfNeeded(h);var S=new vn(y.value,d);r.columnIndex.add(W(y.value),h),r.dependencyGraph.addVertex(h,S)}},p=0;p<u.length;++p)c(p);return n}},{key:"shrinkArrayIfNeeded",value:function(e){var r=this.dependencyGraph.getCell(e);r instanceof Ye&&this.dependencyGraph.shrinkArrayToCorner(r)}}]),a}();var Det=M(xr());var Pet=M(q());"use strict";var lde=he(),ude=Ds().find,cde=ac(),GS="find",yM=!0;GS in[]&&Array(1)[GS](function(){yM=!1});lde({target:"Array",proto:!0,forced:yM},{find:function(t){return ude(this,t,arguments.length>1?arguments[1]:void 0)}});cde(GS);var qet=M(ie());var het=M(q());function HS(a){return HS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HS(a)}function pde(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function bM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function mde(a,t,e){return t&&bM(a.prototype,t),e&&bM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function fde(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&qS(a,t)}function qS(a,t){return qS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},qS(a,t)}function dde(a){var t=bde();return function(){var r=iv(a),n;if(t){var i=iv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return hde(this,n)}}function hde(a,t){if(t&&(HS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yde(a)}function yde(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function bde(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function iv(a){return iv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},iv(a)}var sv=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]),WS=function(a){fde(e,a);var t=dde(e);function e(){return pde(this,e),t.apply(this,arguments)}return mde(e,[{key:"version",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("VERSION"),function(){var o=s.config,l=o.licenseKeyValidityState,u=o.licenseKey,c;return sv.has(u)?c=sv.get(u):sv.has(l)?c=sv.get(l):l==="valid"&&(c=u.slice(-5)),"HyperFormula v".concat(nr.version,", ").concat(c)})}}]),e}(X);WS.implementedFunctions={VERSION:{method:"version",parameters:[]}};function gM(a){return Tde(a)||vde(a)||$S(a)||gde()}function gde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vde(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Tde(a){if(Array.isArray(a))return KS(a)}function ts(a,t){return Ade(a)||Cde(a,t)||$S(a,t)||Nde()}function Nde(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cde(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Ade(a){if(Array.isArray(a))return a}function rs(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=$S(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function $S(a,t){if(!!a){if(typeof a=="string")return KS(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return KS(a,t)}}function KS(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Sde(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function vM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function wde(a,t,e){return t&&vM(a.prototype,t),e&&vM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function XS(a,t){var e,r=t.implementedFunctions[a],n=(e=t.aliases)===null||e===void 0?void 0:e[a];if(n!==void 0){if(r!==void 0)throw new d4(a,t.name);r=t.implementedFunctions[n]}if(r===void 0)throw bf.functionNotDeclaredInPlugin(a,t.name);return r}var an=function(){function a(t){var e=this;if(Sde(this,a),this.config=t,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=function(y){return e.functionsWhichDoesNotNeedArgumentsToBeComputed.has(y)},this.isFunctionVolatile=function(y){return e.volatileFunctions.has(y)},this.isArrayFunction=function(y){return e.arrayFunctions.has(y)},this.isFunctionDependentOnSheetStructureChange=function(y){return e.structuralChangeFunctions.has(y)},t.functionPlugins.length>0){this.instancePlugins=new Map;var r=rs(t.functionPlugins),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;a.loadPluginFunctions(i,this.instancePlugins)}}catch(y){r.e(y)}finally{r.f()}}else this.instancePlugins=new Map(a.plugins);var s=rs(a.protectedFunctions()),o;try{for(s.s();!(o=s.n()).done;){var l=ts(o.value,2),u=l[0],c=l[1];a.loadFunctionUnprotected(c,u,this.instancePlugins)}}catch(y){s.e(y)}finally{s.f()}var p=rs(this.instancePlugins.entries()),m;try{for(p.s();!(m=p.n()).done;){var f=ts(m.value,2),d=f[0],h=f[1];this.categorizeFunction(d,XS(d,h))}}catch(y){p.e(y)}finally{p.f()}}return wde(a,[{key:"initializePlugins",value:function(e){var r=this,n=[],i=rs(this.instancePlugins.entries()),s;try{var o=function(){var u=ts(s.value,2),c=u[0],p=u[1],m=n.find(function(y){return y instanceof p});m===void 0&&(m=new p(e),n.push(m));var f=XS(c,p),d=f.method;r.functions.set(c,[d,m]);var h=f.arraySizeMethod;h!==void 0&&r.arraySizeFunctions.set(c,[h,m])};for(i.s();!(s=i.n()).done;)o()}catch(l){i.e(l)}finally{i.f()}}},{key:"getFunctionPlugin",value:function(e){if(!a.functionIsProtected(e))return this.instancePlugins.get(e)}},{key:"getFunction",value:function(e){var r=this.functions.get(e);if(r!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){var n=ts(r,2),i=n[0],s=n[1];return function(o,l){return s[i](o,l)}}else return}},{key:"getArraySizeFunction",value:function(e){var r=this.arraySizeFunctions.get(e);if(r!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){var n=ts(r,2),i=n[0],s=n[1];return function(o,l){return s[i](o,l)}}else return}},{key:"getMetadata",value:function(e){return this.functionsMetadata.get(e)}},{key:"getPlugins",value:function(){var e=new Set,r=rs(this.instancePlugins),n;try{for(r.s();!(n=r.n()).done;){var i=ts(n.value,2),s=i[0],o=i[1];a.functionIsProtected(s)||e.add(o)}}catch(l){r.e(l)}finally{r.f()}return Array.from(e)}},{key:"getRegisteredFunctionIds",value:function(){return Array.from(this.functions.keys())}},{key:"categorizeFunction",value:function(e,r){r.isVolatile&&this.volatileFunctions.add(e),r.arrayFunction&&this.arrayFunctions.add(e),r.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),r.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,r)}}],[{key:"registerFunctionPlugin",value:function(e,r){this.loadPluginFunctions(e,this.plugins),r!==void 0&&this.loadTranslations(r)}},{key:"registerFunction",value:function(e,r,n){this.loadPluginFunction(r,e,this.plugins),n!==void 0&&this.loadTranslations(n)}},{key:"unregisterFunction",value:function(e){if(this.functionIsProtected(e))throw fb.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}},{key:"unregisterFunctionPlugin",value:function(e){var r=rs(this.protectedPlugins()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i===e)throw fb.cannotUnregisterProtectedPlugin()}}catch(p){r.e(p)}finally{r.f()}var s=rs(this.plugins.entries()),o;try{for(s.s();!(o=s.n()).done;){var l=ts(o.value,2),u=l[0],c=l[1];c===e&&this.plugins.delete(u)}}catch(p){s.e(p)}finally{s.f()}}},{key:"unregisterAll",value:function(){this.plugins.clear()}},{key:"getRegisteredFunctionIds",value:function(){return[].concat(gM(Array.from(this.plugins.keys())),gM(Array.from(this._protectedPlugins.keys())))}},{key:"getPlugins",value:function(){return Array.from(new Set(this.plugins.values()).values())}},{key:"getFunctionPlugin",value:function(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}},{key:"functionIsProtected",value:function(e){return this._protectedPlugins.has(e)}},{key:"loadTranslations",value:function(e){var r=new Set(nr.getRegisteredLanguagesCodes());Object.keys(e).forEach(function(n){r.has(n)&&nr.getLanguage(n).extendFunctions(e[n])})}},{key:"loadPluginFunctions",value:function(e,r){var n=this;Object.keys(e.implementedFunctions).forEach(function(i){n.loadPluginFunction(e,i,r)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(function(i){n.loadPluginFunction(e,i,r)})}},{key:"loadPluginFunction",value:function(e,r,n){if(this.functionIsProtected(r))throw fb.cannotRegisterFunctionWithId(r);this.loadFunctionUnprotected(e,r,n)}},{key:"loadFunctionUnprotected",value:function(e,r,n){var i=XS(r,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))n.set(r,e);else throw bf.functionMethodNotFound(i,e.name)}},{key:"protectedFunctions",value:regeneratorRuntime.mark(function t(){var e,r,n,i,s;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:e=rs(this._protectedPlugins),l.prev=1,e.s();case 3:if((r=e.n()).done){l.next=10;break}if(n=ts(r.value,2),i=n[0],s=n[1],s===void 0){l.next=8;break}return l.next=8,[i,s];case 8:l.next=3;break;case 10:l.next=15;break;case 12:l.prev=12,l.t0=l.catch(1),e.e(l.t0);case 15:return l.prev=15,e.f(),l.finish(15);case 18:case"end":return l.stop()}},t,this,[[1,12,15,18]])})},{key:"protectedPlugins",value:regeneratorRuntime.mark(function t(){var e,r,n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e=rs(this._protectedPlugins),o.prev=1,e.s();case 3:if((r=e.n()).done){o.next=10;break}if(n=ts(r.value,2),i=n[1],i===void 0){o.next=8;break}return o.next=8,i;case 8:o.next=3;break;case 10:o.next=15;break;case 12:o.prev=12,o.t0=o.catch(1),e.e(o.t0);case 15:return o.prev=15,e.f(),o.finish(15);case 18:case"end":return o.stop()}},t,this,[[1,12,15,18]])})}]),a}();an.plugins=new Map;an._protectedPlugins=new Map([["VERSION",WS],["OFFSET",void 0]]);var ltt=M(q());var dtt=M(ie());var Qet=M(ie());function Ede(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function TM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Rde(a,t,e){return t&&TM(a.prototype,t),e&&TM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var yr;(function(a){a.GREATER_THAN="GREATER_THAN",a.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",a.LESS_THAN="LESS_THAN",a.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",a.NOT_EQUAL="NOT_EQUAL",a.EQUAL="EQUAL"})(yr||(yr={}));var ov=function(t,e){return{operator:t,value:e}},NM=function(){function a(t){Ede(this,a);var e,r,n,i;this.trueString=(r=(e=t.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||e===void 0?void 0:e.toLowerCase())!==null&&r!==void 0?r:"true",this.falseString=(i=(n=t.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||n===void 0?void 0:n.toLowerCase())!==null&&i!==void 0?i:"false"}return Rde(a,[{key:"fromCellValue",value:function(e,r){if(!(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")){var n=this.parseCriterion(e,r);if(n!==void 0)return{raw:e,lambda:Ode(n,r)}}}},{key:"parseCriterion",value:function(e,r){if(typeof e=="number"||typeof e=="boolean")return ov(yr.EQUAL,e);if(typeof e=="string"){var n=xde.exec(e),i,s;n?(s=Vde(n[1]),i=n[2]):(s=yr.EQUAL,i=e);var o=r.coerceToMaybeNumber(i),l=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(s===void 0)return;if(i==="")return ov(s,null);if(o===void 0){if(s===yr.EQUAL||s===yr.NOT_EQUAL)return ov(s,l??i)}else return ov(s,W(o))}}}]),a}(),xde=/([<>=]+)(.*)/;function Vde(a){switch(a){case">":return yr.GREATER_THAN;case">=":return yr.GREATER_THAN_OR_EQUAL;case"<":return yr.LESS_THAN;case"<=":return yr.LESS_THAN_OR_EQUAL;case"<>":return yr.NOT_EQUAL;case"=":return yr.EQUAL;default:return}}var Ode=function(t,e){switch(t.operator){case yr.GREATER_THAN:return typeof t.value=="number"?function(r){return typeof r=="number"&&e.floatCmp(r,t.value)>0}:function(r){return!1};case yr.GREATER_THAN_OR_EQUAL:return typeof t.value=="number"?function(r){return typeof r=="number"&&e.floatCmp(r,t.value)>=0}:function(r){return!1};case yr.LESS_THAN:return typeof t.value=="number"?function(r){return typeof r=="number"&&e.floatCmp(r,t.value)<0}:function(r){return!1};case yr.LESS_THAN_OR_EQUAL:return typeof t.value=="number"?function(r){return typeof r=="number"&&e.floatCmp(r,t.value)<=0}:function(r){return!1};case yr.EQUAL:return typeof t.value=="number"?function(r){if(typeof r=="number")return e.floatCmp(r,t.value)===0;if(typeof r=="string"){if(r==="")return!1;var n=e.coerceToMaybeNumber(r);return n===void 0?!1:e.floatCmp(n,t.value)===0}else return!1}:typeof t.value=="string"?e.eqMatcherFunction(t.value):typeof t.value=="boolean"?function(r){return typeof r=="boolean"&&r===t.value}:function(r){return r===le};case yr.NOT_EQUAL:return typeof t.value=="number"?function(r){if(typeof r=="number")return e.floatCmp(r,t.value)!==0;if(typeof r=="string"){if(r==="")return!0;var n=e.coerceToMaybeNumber(r);return n===void 0?!0:e.floatCmp(n,t.value)!==0}else return!0}:typeof t.value=="string"?e.neqMatcherFunction(t.value):typeof t.value=="boolean"?function(r){return typeof r!="boolean"||r!==t.value}:function(r){return r!==le}}};function CM(a){return Pde(a)||Ide(a)||YS(a)||Dde()}function Dde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ide(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Pde(a){if(Array.isArray(a))return ZS(a)}function AM(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=YS(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function SM(a,t){return Fde(a)||kde(a,t)||YS(a,t)||_de()}function _de(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YS(a,t){if(!!a){if(typeof a=="string")return ZS(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ZS(a,t)}}function ZS(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function kde(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Fde(a){if(Array.isArray(a))return a}function jde(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function wM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Mde(a,t,e){return t&&wM(a.prototype,t),e&&wM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var EM=function(){function a(t,e,r,n,i,s,o,l,u,c){var p=this;jde(this,a),this.config=t,this.dependencyGraph=e,this.columnSearch=r,this.stats=n,this.arithmeticHelper=i,this.functionRegistry=s,this.namedExpressions=o,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=c,this.equalOp=function(m,f){return aa(p.arithmeticHelper.eq,m,f)},this.notEqualOp=function(m,f){return aa(p.arithmeticHelper.neq,m,f)},this.greaterThanOp=function(m,f){return aa(p.arithmeticHelper.gt,m,f)},this.lessThanOp=function(m,f){return aa(p.arithmeticHelper.lt,m,f)},this.greaterThanOrEqualOp=function(m,f){return aa(p.arithmeticHelper.geq,m,f)},this.lessThanOrEqualOp=function(m,f){return aa(p.arithmeticHelper.leq,m,f)},this.concatOp=function(m,f){return aa(p.arithmeticHelper.concat,Jf(m),Jf(f))},this.plusOp=function(m,f){return aa(p.arithmeticHelper.addWithEpsilon,p.arithmeticHelper.coerceScalarToNumberOrError(m),p.arithmeticHelper.coerceScalarToNumberOrError(f))},this.minusOp=function(m,f){return aa(p.arithmeticHelper.subtract,p.arithmeticHelper.coerceScalarToNumberOrError(m),p.arithmeticHelper.coerceScalarToNumberOrError(f))},this.timesOp=function(m,f){return aa(p.arithmeticHelper.multiply,p.arithmeticHelper.coerceScalarToNumberOrError(m),p.arithmeticHelper.coerceScalarToNumberOrError(f))},this.powerOp=function(m,f){return aa(p.arithmeticHelper.pow,p.arithmeticHelper.coerceScalarToNumberOrError(m),p.arithmeticHelper.coerceScalarToNumberOrError(f))},this.divOp=function(m,f){return aa(p.arithmeticHelper.divide,p.arithmeticHelper.coerceScalarToNumberOrError(m),p.arithmeticHelper.coerceScalarToNumberOrError(f))},this.unaryMinusOp=function(m){return RM(p.arithmeticHelper.unaryMinus,p.arithmeticHelper.coerceScalarToNumberOrError(m))},this.percentOp=function(m){return RM(p.arithmeticHelper.unaryPercent,p.arithmeticHelper.coerceScalarToNumberOrError(m))},this.unaryPlusOp=function(m){return p.arithmeticHelper.unaryPlus(m)},this.functionRegistry.initializePlugins(this),this.criterionBuilder=new NM(t)}return Mde(a,[{key:"evaluateAst",value:function(e,r){var n=this.evaluateAstWithoutPostprocessing(e,r);if(Ce(n)){if(dg(W(n)))return new E(V.NUM,D.NaN);n=jc(n,hg(W(n)))}if(n instanceof Q&&n.height()===1&&n.width()===1){var i=SM(n.data,1),s=SM(i[0],1);n=s[0]}return Bde(n,r.formulaVertex)}},{key:"getGpuInstance",value:function(){var e=this.config.gpuMode,r=this.config.gpujs;if(r===void 0)throw Error("Cannot instantiate GPU.js. Constructor not provided.");return this.gpu||(this.gpu=new r({mode:e})),this.gpu}},{key:"destroyGpu",value:function(){var e;(e=this.gpu)===null||e===void 0||e.destroy()}},{key:"evaluateAstWithoutPostprocessing",value:function(e,r){switch(e.type){case I.EMPTY:return le;case I.CELL_REFERENCE:{var n=e.reference.toSimpleCellAddress(r.formulaAddress);return Kt(n)?new E(V.REF,D.BadRef):this.dependencyGraph.getCellValue(n)}case I.NUMBER:case I.STRING:return e.value;case I.CONCATENATE_OP:{var i=this.evaluateAst(e.left,r),s=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.concatOp,i,s,r)}case I.EQUALS_OP:{var o=this.evaluateAst(e.left,r),l=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.equalOp,o,l,r)}case I.NOT_EQUAL_OP:{var u=this.evaluateAst(e.left,r),c=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.notEqualOp,u,c,r)}case I.GREATER_THAN_OP:{var p=this.evaluateAst(e.left,r),m=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOp,p,m,r)}case I.LESS_THAN_OP:{var f=this.evaluateAst(e.left,r),d=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOp,f,d,r)}case I.GREATER_THAN_OR_EQUAL_OP:{var h=this.evaluateAst(e.left,r),y=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,h,y,r)}case I.LESS_THAN_OR_EQUAL_OP:{var b=this.evaluateAst(e.left,r),g=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOrEqualOp,b,g,r)}case I.PLUS_OP:{var v=this.evaluateAst(e.left,r),A=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.plusOp,v,A,r)}case I.MINUS_OP:{var C=this.evaluateAst(e.left,r),S=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.minusOp,C,S,r)}case I.TIMES_OP:{var w=this.evaluateAst(e.left,r),x=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.timesOp,w,x,r)}case I.POWER_OP:{var R=this.evaluateAst(e.left,r),O=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.powerOp,R,O,r)}case I.DIV_OP:{var _=this.evaluateAst(e.left,r),k=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.divOp,_,k,r)}case I.PLUS_UNARY_OP:{var B=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryPlusOp,B,r)}case I.MINUS_UNARY_OP:{var U=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryMinusOp,U,r)}case I.PERCENT_OP:{var H=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.percentOp,H,r)}case I.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!an.functionIsProtected(e.procedureName))return new E(V.LIC,D.LicenseKey(this.config.licenseKeyValidityState));var j=this.functionRegistry.getFunction(e.procedureName);return j!==void 0?j(e,new Jr(r.formulaAddress,r.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),r.formulaVertex)):new E(V.NAME,D.FunctionName(e.procedureName))}case I.NAMED_EXPRESSION:{var P=this.namedExpressions.nearestNamedExpression(e.expressionName,r.formulaAddress.sheet);return P?this.dependencyGraph.getCellValue(P.address):new E(V.NAME,D.NamedExpressionName(e.expressionName))}case I.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(V.REF,D.RangeManySheets);var F=oe.fromCellRange(e,r.formulaAddress),G=this.dependencyGraph.getArray(F);if(G){var z=G.array;if(z instanceof sl)throw new Error("Array should be already computed");if(z instanceof E)return z;if(z instanceof rd)return Q.fromRange(z.raw(),F,this.dependencyGraph);throw new Error("Unknown array")}else return Q.onlyRange(F,this.dependencyGraph)}case I.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(V.REF,D.RangeManySheets);var Z=Pc.fromColumnRange(e,r.formulaAddress);return Q.onlyRange(Z,this.dependencyGraph)}case I.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(V.REF,D.RangeManySheets);var ne=_c.fromRowRangeAst(e,r.formulaAddress);return Q.onlyRange(ne,this.dependencyGraph)}case I.PARENTHESIS:return this.evaluateAst(e.expression,r);case I.ARRAY:{var ve=void 0,xe=[],ye=AM(e.args),it;try{for(ye.s();!(it=ye.n()).done;){var gr=it.value,ar=void 0,mt=[],jn=AM(gr),pi;try{for(jn.s();!(pi=jn.n()).done;){var fs=pi.value,Mn=cg(this.evaluateAst(fs,r)),oa=Mn.height();if(ar===void 0)ar=oa,mt.push.apply(mt,CM(Mn.data));else if(ar===oa)for(var ds=0;ds<oa;ds++){var Gl;(Gl=mt[ds]).push.apply(Gl,CM(Mn.data[ds]))}else return new E(V.REF,D.SizeMismatch)}}catch(Hl){jn.e(Hl)}finally{jn.f()}var qp=mt[0].length;if(ve===void 0)ve=qp,xe.push.apply(xe,mt);else if(ve===qp)xe.push.apply(xe,mt);else return new E(V.REF,D.SizeMismatch)}}catch(Hl){ye.e(Hl)}finally{ye.f()}return Q.onlyValues(xe)}case I.ERROR_WITH_RAW_INPUT:case I.ERROR:return e.error}}},{key:"rangeSpansOneSheet",value:function(e){return e.start.sheet===e.end.sheet}},{key:"unaryRangeWrapper",value:function(e,r,n){var i;if(r instanceof Q&&!n.arraysFlag&&(r=(i=zc(r,n))!==null&&i!==void 0?i:new E(V.VALUE,D.ScalarExpected)),r instanceof E)return r;if(r instanceof Q){var s=r.data.map(function(o){return o.map(e)});return Q.onlyValues(s)}return e(r)}},{key:"binaryRangeWrapper",value:function(e,r,n,i){var s,o;if(r instanceof Q&&!i.arraysFlag&&(r=(s=zc(r,i))!==null&&s!==void 0?s:new E(V.VALUE,D.ScalarExpected)),r instanceof E)return r;if(n instanceof Q&&!i.arraysFlag&&(n=(o=zc(n,i))!==null&&o!==void 0?o:new E(V.VALUE,D.ScalarExpected)),n instanceof E)return n;if(r instanceof Q||n instanceof Q){if(!(r instanceof Q))if(n.isAdHoc()){for(var l=n.data,u=0;u<l.length;u++)for(var c=0;c<l[0].length;c++)l[u][c]=e(r,l[u][c]);return Q.onlyValues(l)}else r=Q.fromScalar(r);if(!(n instanceof Q))if(r.isAdHoc()){for(var p=r.data,m=0;m<p.length;m++)for(var f=0;f<p[0].length;f++)p[m][f]=e(p[m][f],n);return Q.onlyValues(p)}else n=Q.fromScalar(n);if(r.width()===n.width()&&r.height()===n.height()){if(r.isAdHoc()){for(var d=r.data,h=n.data,y=0;y<d.length;y++)for(var b=0;b<d[0].length;b++)d[y][b]=e(d[y][b],h[y][b]);return Q.onlyValues(d)}if(n.isAdHoc()){for(var g=r.data,v=n.data,A=0;A<g.length;A++)for(var C=0;C<g[0].length;C++)v[A][C]=e(g[A][C],v[A][C]);return Q.onlyValues(v)}}for(var S=Math.max(r.width(),n.width()),w=Math.max(r.height(),n.height()),x=Array(w),R=0;R<w;R++)x[R]=Array(S);for(var O=0;O<w;O++)for(var _=r.height()!==1?O:0,k=n.height()!==1?O:0,B=0;B<S;B++){var U=r.width()!==1?B:0,H=n.width()!==1?B:0;_<r.height()&&k<n.height()&&U<r.width()&&H<n.width()?x[O][B]=e(r.data[_][U],n.data[k][H]):x[O][B]=new E(V.NA)}return Q.onlyValues(x)}return e(r,n)}}]),a}();function RM(a,t){return t instanceof E?t:a(t)}function aa(a,t,e){return t instanceof E?t:e instanceof E?e:a(t,e)}function Bde(a,t){return a instanceof E&&t!==void 0?a.attachRootVertex(t):a}var Htt=M(q());var Ytt=M(ie()),Ztt=M(xr());var Itt=M(q());var Mtt=M(ie());function Lde(a,t){return Hde(a)||Gde(a,t)||zde(a,t)||Ude()}function Ude(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zde(a,t){if(!!a){if(typeof a=="string")return xM(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return xM(a,t)}}function xM(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Gde(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Hde(a){if(Array.isArray(a))return a}function qde(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function VM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Wde(a,t,e){return t&&VM(a.prototype,t),e&&VM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var OM=function(){function a(t){qde(this,a),this.sheet=t,this.transformations=[]}return Wde(a,[{key:"add",value:function(e){this.transformations.push(e)}},{key:"performEagerTransformations",value:function(e,r){this.transformations.forEach(function(n){return n.performEagerTransformations(e,r)})}},{key:"transformSingleAst",value:function(e,r){var n=e,i=r;return this.transformations.forEach(function(s){var o=s.transformSingleAst(n,i),l=Lde(o,2);n=l[0],i=l[1]}),[n,i]}},{key:"isIrreversible",value:function(){return!0}}]),a}();function $de(a,t){return Zde(a)||Yde(a,t)||Xde(a,t)||Kde()}function Kde(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xde(a,t){if(!!a){if(typeof a=="string")return DM(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return DM(a,t)}}function DM(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Yde(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Zde(a){if(Array.isArray(a))return a}function Jde(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Qde(a,t,e){return t&&IM(a.prototype,t),e&&IM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var PM=function(){function a(t){Jde(this,a),this.stats=t,this.transformations=[]}return Qde(a,[{key:"version",value:function(){return this.transformations.length}},{key:"addTransformation",value:function(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}},{key:"beginCombinedMode",value:function(e){this.combinedTransformer=new OM(e)}},{key:"commitCombinedMode",value:function(){if(this.combinedTransformer===void 0)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}},{key:"applyTransformations",value:function(e,r,n){this.stats.start(ue.TRANSFORM_ASTS_POSTPONED);for(var i=n;i<this.transformations.length;i++){var s=this.transformations[i];s.isIrreversible()&&(this.undoRedo.storeDataForVersion(i,r,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));var o=s.transformSingleAst(e,r),l=$de(o,2),u=l[0],c=l[1];e=u,r=c}var p=this.parser.rememberNewAst(e);return this.stats.end(ue.TRANSFORM_ASTS_POSTPONED),[p,r,this.transformations.length]}},{key:"getTransformationsFrom",value:regeneratorRuntime.mark(function t(e,r){var n,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n=e;case 1:if(!(n<this.transformations.length)){o.next=9;break}if(i=this.transformations[n],!(!r||r(i))){o.next=6;break}return o.next=6,i;case 6:n++,o.next=1;break;case 9:case"end":return o.stop()}},t,this)})}]),a}();"use strict";var ehe=he(),the=Ds().findIndex,rhe=ac(),JS="findIndex",_M=!0;JS in[]&&Array(1)[JS](function(){_M=!1});ehe({target:"Array",proto:!0,forced:_M},{findIndex:function(t){return the(this,t,arguments.length>1?arguments[1]:void 0)}});rhe(JS);var Crt=M(q());var srt=M(q());function Jc(a){return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(a)}function lv(a,t,e,r){var n;r==="col"?n=a.effectiveEndColumn(e):n=a.effectiveEndRow(e);var i=a.start[r],s;r==="row"?s=function(u){return W(e.getCellValue($(a.sheet,a.start.col,u)))}:s=function(u){return W(e.getCellValue($(a.sheet,u,a.start.row)))};var o=nhe(s,t,i,n);return Jc(s(o))!==Jc(t)?-1:o-i}function nhe(a,t,e,r){for(;e<=r;){var n=Math.floor((e+r)/2),i=ahe(t,a(n));if(i>0)e=n+1;else if(i<0)r=n-1;else if(e!=n)r=n;else return n}return r}function ahe(a,t){return Jc(a)===Jc(t)?a===le?0:a<t?-1:a>t?1:0:a===le?-1:t===le?1:t instanceof E||typeof a=="number"&&typeof t=="string"||typeof a=="number"&&typeof t=="boolean"?-1:typeof a=="string"&&typeof t=="number"?1:typeof a=="string"&&typeof t=="boolean"?-1:1}function ihe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function kM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function she(a,t,e){return t&&kM(a.prototype,t),e&&kM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var uv=function(){function a(t){ihe(this,a),this.dependencyGraph=t}return she(a,[{key:"advancedFind",value:function(e,r){var n,i=r.range;i===void 0?n=r.valuesFromTopLeftCorner():n=this.dependencyGraph.computeListOfValuesInRange(i);for(var s=0;s<n.length;s++)if(e(W(n[s])))return s;return-1}}]),a}();function QS(a){return QS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QS(a)}function ohe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function FM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function lhe(a,t,e){return t&&FM(a.prototype,t),e&&FM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function uhe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&e5(a,t)}function e5(a,t){return e5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},e5(a,t)}function che(a){var t=fhe();return function(){var r=cv(a),n;if(t){var i=cv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return phe(this,n)}}function phe(a,t){if(t&&(QS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mhe(a)}function mhe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function fhe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function cv(a){return cv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cv(a)}var pv=function(a){uhe(e,a);var t=che(e);function e(r,n){var i;return ohe(this,e),i=t.call(this,r),i.dependencyGraph=r,i.config=n,i}return lhe(e,[{key:"add",value:function(n,i){}},{key:"remove",value:function(n,i){}},{key:"change",value:function(n,i,s){}},{key:"applyChanges",value:function(n){}},{key:"addColumns",value:function(n){}},{key:"removeColumns",value:function(n){}},{key:"removeSheet",value:function(n){}},{key:"moveValues",value:function(n,i,s,o){}},{key:"removeValues",value:function(n){}},{key:"find",value:function(n,i,s){typeof n=="string"&&(n=va(n));var o=i.range;return o===void 0?i.valuesFromTopLeftCorner().map(W).map(function(l){return typeof l=="string"?va(l):l}).indexOf(n):s?lv(o,n,this.dependencyGraph,"row"):this.dependencyGraph.computeListOfValuesInRange(o).findIndex(function(l){return l=W(l),l=typeof l=="string"?va(l):l,l===n})}}]),e}(uv);var Ort=M(q());var Urt=M(ie());function dhe(a){return bhe(a)||yhe(a)||t5(a)||hhe()}function hhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yhe(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function bhe(a){if(Array.isArray(a))return r5(a)}function mv(a,t){return The(a)||vhe(a,t)||t5(a,t)||ghe()}function ghe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vhe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function The(a){if(Array.isArray(a))return a}function Qc(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=t5(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function t5(a,t){if(!!a){if(typeof a=="string")return r5(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return r5(a,t)}}function r5(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Nhe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function jM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Che(a,t,e){return t&&jM(a.prototype,t),e&&jM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var MM=function(){function a(t,e,r){Nhe(this,a),this.dependencyGraph=t,this.config=e,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new pv(t,e)}return Che(a,[{key:"add",value:function(e,r){if(!(e===le||e instanceof E))if(e instanceof Q){var n=Qc(e.entriesFromTopLeftCorner(r)),i;try{for(n.s();!(i=n.n()).done;){var s=mv(i.value,2),o=s[0],l=s[1];this.addSingleCellValue(W(o),l)}}catch(u){n.e(u)}finally{n.f()}}else this.addSingleCellValue(e,r)}},{key:"remove",value:function(e,r){if(e!==void 0)if(e instanceof Q){var n=Qc(e.entriesFromTopLeftCorner(r)),i;try{for(n.s();!(i=n.n()).done;){var s=mv(i.value,2),o=s[0],l=s[1];this.removeSingleValue(W(o),l)}}catch(u){n.e(u)}finally{n.f()}}else this.removeSingleValue(e,r)}},{key:"change",value:function(e,r,n){e!==r&&(this.remove(e,n),this.add(r,n))}},{key:"applyChanges",value:function(e){var r=Qc(e),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;i.oldValue!==void 0&&this.change(W(i.oldValue),W(i.value),i.address)}}catch(s){r.e(s)}finally{r.f()}}},{key:"moveValues",value:function(e,r,n,i){var s=Qc(e),o;try{for(s.s();!(o=s.n()).done;){var l=mv(o.value,2),u=l[0],c=l[1],p=Gk(c,i,r,n);this.remove(u,c),this.add(u,p)}}catch(m){s.e(m)}finally{s.f()}}},{key:"removeValues",value:function(e){var r=Qc(e),n;try{for(r.s();!(n=r.n()).done;){var i=mv(n.value,2),s=i[0],o=i[1];this.remove(s,o)}}catch(l){r.e(l)}finally{r.f()}}},{key:"find",value:function(e,r,n){var i=r.range;if(i===void 0)return this.binarySearchStrategy.find(e,r,n);this.ensureRecentData(i.sheet,i.start.col,e);var s=this.getColumnMap(i.sheet,i.start.col);if(!s)return-1;typeof e=="string"&&(e=va(e));var o=s.get(e);if(!o)return this.binarySearchStrategy.find(e,r,n);var l=fv(o.index,i.start.row),u=o.index[l];return u<=i.end.row?u-i.start.row:this.binarySearchStrategy.find(e,r,n)}},{key:"advancedFind",value:function(e,r){return this.binarySearchStrategy.advancedFind(e,r)}},{key:"addColumns",value:function(e){var r=this.index.get(e.sheet);!r||r.splice.apply(r,[e.columnStart,0].concat(dhe(Array(e.numberOfColumns))))}},{key:"removeColumns",value:function(e){var r=this.index.get(e.sheet);!r||r.splice(e.columnStart,e.numberOfColumns)}},{key:"removeSheet",value:function(e){this.index.delete(e)}},{key:"getColumnMap",value:function(e,r){this.index.has(e)||this.index.set(e,[]);var n=this.index.get(e),i=n[r];return i||(i=new Map,n[r]=i),i}},{key:"getValueIndex",value:function(e,r,n){var i=this.getColumnMap(e,r),s=this.getColumnMap(e,r).get(n);return s||(s={version:this.transformingService.version(),index:[]},i.set(n,s)),s}},{key:"ensureRecentData",value:function(e,r,n){var i=this.getValueIndex(e,r,n),s=this.transformingService.version();if(i.version!==s){var o=this.transformingService.getTransformationsFrom(i.version,function(p){return p.sheet===e&&(p instanceof ld||p instanceof ud)}),l=Qc(o),u;try{for(l.s();!(u=l.n()).done;){var c=u.value;c instanceof ld?this.addRows(r,c.rowsSpan,n):c instanceof ud&&this.removeRows(r,c.rowsSpan,n)}}catch(p){l.e(p)}finally{l.f()}i.version=s}}},{key:"addSingleCellValue",value:function(e,r){var n=this;this.stats.measure(ue.BUILD_COLUMN_INDEX,function(){n.ensureRecentData(r.sheet,r.col,e),typeof e=="string"&&(e=va(e));var i=n.getValueIndex(r.sheet,r.col,e);n.addValue(i,r.row)})}},{key:"removeSingleValue",value:function(e,r){var n=this;this.stats.measure(ue.BUILD_COLUMN_INDEX,function(){n.ensureRecentData(r.sheet,r.col,e);var i=n.getColumnMap(r.sheet,r.col);typeof e=="string"&&(e=va(e));var s=i.get(e);if(!!s){var o=fv(s.index,r.row);s.index.splice(o,1),s.index.length===0&&i.delete(e),i.size===0&&delete n.index.get(r.sheet)[r.col]}})}},{key:"addRows",value:function(e,r,n){var i=this.getValueIndex(r.sheet,e,n);this.shiftRows(i,r.rowStart,r.numberOfRows)}},{key:"removeRows",value:function(e,r,n){var i=this.getValueIndex(r.sheet,e,n);this.removeRowsFromValues(i,r),this.shiftRows(i,r.rowEnd+1,-r.numberOfRows)}},{key:"addValue",value:function(e,r){var n=BM(e.index,r),i=e.index[n];i!==r&&(n===e.index.length-1?e.index.push(r):e.index.splice(n+1,0,r))}},{key:"removeRowsFromValues",value:function(e,r){var n=fv(e.index,r.rowStart),i=BM(e.index,r.rowEnd);e.index[n]<=r.rowEnd&&e.index.splice(n,i-n+1)}},{key:"shiftRows",value:function(e,r,n){for(var i=fv(e.index,r),s=i;s<e.index.length;++s)e.index[s]+=n}}]),a}();function fv(a,t){for(var e=0,r=a.length-1;e<=r;){var n=Math.floor((e+r)/2);if(t>a[n])e=n+1;else if(t<a[n])r=n-1;else return n}return e}function BM(a,t){for(var e=0,r=a.length-1;e<=r;){var n=Math.floor((e+r)/2);if(t>a[n])e=n+1;else if(t<a[n])r=n-1;else return n}return r}function LM(a,t,e){return t.useColumnIndex?new MM(a,t,e):new pv(a,t)}var ant=M(ie());function Ahe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function UM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function She(a,t,e){return t&&UM(a.prototype,t),e&&UM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var zM=function(){function a(t){Ahe(this,a),this.config=t;var e=this.config.thousandSeparator==="."?"\\".concat(this.config.thousandSeparator):this.config.thousandSeparator,r=this.config.decimalSeparator==="."?"\\".concat(this.config.decimalSeparator):this.config.decimalSeparator;this.numberPattern=new RegExp("^([+-]?((".concat(r,"\\d+)|(\\d+(").concat(e,"\\d{3,})*(").concat(r,"\\d*)?)))(e[+-]?\\d+)?$")),this.allThousandSeparatorsRegex=new RegExp("".concat(e),"g")}return She(a,[{key:"numericStringToMaybeNumber",value:function(e){if(this.numberPattern.test(e)){var r=this.numericStringToNumber(e);return isNaN(r)?void 0:r}}},{key:"numericStringToNumber",value:function(e){var r=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(r)}}]),a}();var ynt=M(ie());var Tnt=M(q());function GM(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=whe(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function whe(a,t){if(!!a){if(typeof a=="string")return HM(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return HM(a,t)}}function HM(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Ehe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function qM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Rhe(a,t,e){return t&&qM(a.prototype,t),e&&qM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var WM=function(){function a(t,e,r){Ehe(this,a),this.dependencyGraph=t,this.unparser=e,this.exporter=r}return Rhe(a,[{key:"getCellFormula",value:function(e,r){var n=this.dependencyGraph.getCell(e);if(n instanceof Qr){var i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return r=r??e,this.unparser.unparse(i,r)}else if(n instanceof Ye){var s=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(s.row!==e.row||s.col!==e.col||s.sheet!==e.sheet)return;r=r??e;var o=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(o!==void 0)return this.unparser.unparse(o,r)}else if(n instanceof Ta)return n.getFormula()}},{key:"getCellSerialized",value:function(e,r){var n;return(n=this.getCellFormula(e,r))!==null&&n!==void 0?n:this.getRawValue(e)}},{key:"getCellValue",value:function(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}},{key:"getRawValue",value:function(e){return this.dependencyGraph.getRawValue(e)}},{key:"getSheetValues",value:function(e){var r=this;return this.genericSheetGetter(e,function(n){return r.getCellValue(n)})}},{key:"getSheetFormulas",value:function(e){var r=this;return this.genericSheetGetter(e,function(n){return r.getCellFormula(n)})}},{key:"genericSheetGetter",value:function(e,r){for(var n=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),s=new Array(n),o=0;o<n;o++){s[o]=new Array(i);for(var l=0;l<i;l++){var u=$(e,l,o);s[o][l]=r(u)}for(var c=i-1;c>=0&&(s[o][c]===null||s[o][c]===void 0);c--)s[o].pop()}for(var p=n-1;p>=0&&s[p].length===0;p--)s.pop();return s}},{key:"genericAllSheetsGetter",value:function(e){var r={},n=GM(this.dependencyGraph.sheetMapping.displayNames()),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,o=this.dependencyGraph.sheetMapping.fetch(s);r[s]=e(o)}}catch(l){n.e(l)}finally{n.f()}return r}},{key:"getSheetSerialized",value:function(e){var r=this;return this.genericSheetGetter(e,function(n){return r.getCellSerialized(n)})}},{key:"getAllSheetsValues",value:function(){var e=this;return this.genericAllSheetsGetter(function(r){return e.getSheetValues(r)})}},{key:"getAllSheetsFormulas",value:function(){var e=this;return this.genericAllSheetsGetter(function(r){return e.getSheetFormulas(r)})}},{key:"getAllSheetsSerialized",value:function(){var e=this;return this.genericAllSheetsGetter(function(r){return e.getSheetSerialized(r)})}},{key:"getAllNamedExpressionsSerialized",value:function(){var e=this,r=[],n=0,i=GM(this.dependencyGraph.sheetMapping.displayNames()),s;try{for(i.s();!(s=i.n()).done;){var o=s.value,l=this.dependencyGraph.sheetMapping.fetch(o);r[l]=n,n++}}catch(u){i.e(u)}finally{i.f()}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(function(u){return{name:u.expression.displayName,expression:e.getCellSerialized(u.expression.address),scope:u.scope!==void 0?r[u.scope]:void 0,options:u.expression.options}})}},{key:"withNewConfig",value:function(e,r){var n=new Hf(e,rl(e),this.dependencyGraph.sheetMapping.fetchDisplayName,r);return new a(this.dependencyGraph,n,this.exporter)}}]),a}();function xhe(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function Vhe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function $M(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Ohe(a,t,e){return t&&$M(a.prototype,t),e&&$M(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var dd=function(){function a(){Vhe(this,a)}return Ohe(a,null,[{key:"buildFromSheets",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=new na(r);return this.buildEngine(i,e,n)}},{key:"buildFromSheet",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=new na(r),s=i.translationPackage.getUITranslation(Ks.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,xhe({},s,e),n)}},{key:"buildEmpty",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return this.buildEngine(new na(e),{},r)}},{key:"rebuildWithConfig",value:function(e,r,n,i){return this.buildEngine(e,r,n,i)}},{key:"buildEngine",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.useStats?new td:new OA;i.start(ue.BUILD_ENGINE_TOTAL);var s=new Yc,o=new an(e),l=new PM(i),u=QA.buildEmpty(l,e,o,s,i),c=LM(u,e,i),p=u.sheetMapping,m=u.addressMapping;for(var f in r)if(Object.prototype.hasOwnProperty.call(r,f)){var d=r[f];Xg(d);var h=ml(d);if(h.height>e.maxRows||h.width>e.maxColumns)throw new Kn;var y=p.addSheet(f);m.autoAddSheet(y,d,h)}var b=new pA(e,o,p.get);l.parser=b;var g=new Hf(e,rl(e),p.fetchDisplayName,s),v=new dF(e),A=new zM(e),C=new s_(e,v,A),S=new JF(e,v,A),w=new T_(e,o),x=new Vj(e,u,c,S,b,i,l,s,w),R=new Jj(e,x);l.undoRedo=R;var O=new nj(e,u,x),_=new rM(e,x,R,O,u,c,b,S,l,s);n.forEach(function(j){_.ensureItIsPossibleToAddNamedExpression(j.name,j.expression,j.scope),_.operations.addNamedExpression(j.name,j.expression,j.scope,j.options)});var k=new pM(e,s,p.fetchDisplayName,l),B=new WM(u,g,k),U=new EM(e,u,c,i,C,o,s,B,w,v);i.measure(ue.GRAPH_BUILD,function(){var j=new hM(u,c,b,S,i,w);j.buildGraph(r,i)});var H=new iM(e,i,U,l,u,c);return H.run(),i.end(ue.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:u,columnSearch:c,parser:b,unparser:g,cellContentParser:S,evaluator:H,lazilyTransformingAstService:l,crudOperations:_,exporter:k,namedExpressions:s,serialization:B,functionRegistry:o}}}]),a}();var Dhe=he(),Ihe=WA().entries;Dhe({target:"Object",stat:!0},{entries:function(t){return Ihe(t)}});var oat=M(q());var fat=M(ie());function Phe(a,t){return jhe(a)||Fhe(a,t)||khe(a,t)||_he()}function _he(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function khe(a,t){if(!!a){if(typeof a=="string")return KM(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return KM(a,t)}}function KM(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Fhe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function jhe(a){if(Array.isArray(a))return a}function XM(a){for(var t=0,e=Object.entries(a);t<e.length;t++){var r=Phe(e[t],2),n=r[0],i=r[1];i instanceof Function?a[n]=Mhe(i):delete a[n]}}function Mhe(a){return function(){throw new Error('The "'.concat(a,'" method cannot be called because this HyperFormula instance has been destroyed'))}}var wat=M(q());var JM=M(YM());function i5(a){return i5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i5(a)}function Bhe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function ZM(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Lhe(a,t,e){return t&&ZM(a.prototype,t),e&&ZM(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function dv(){return typeof Reflect!="undefined"&&Reflect.get?dv=Reflect.get:dv=function(t,e,r){var n=Uhe(t,e);if(!!n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},dv.apply(this,arguments)}function Uhe(a,t){for(;!Object.prototype.hasOwnProperty.call(a,t)&&(a=ep(a),a!==null););return a}function zhe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&s5(a,t)}function s5(a,t){return s5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},s5(a,t)}function Ghe(a){var t=Whe();return function(){var r=ep(a),n;if(t){var i=ep(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Hhe(this,n)}}function Hhe(a,t){if(t&&(i5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qhe(a)}function qhe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Whe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function ep(a){return ep=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ep(a)}var Sa;(function(a){a.SheetAdded="sheetAdded",a.SheetRemoved="sheetRemoved",a.SheetRenamed="sheetRenamed",a.NamedExpressionAdded="namedExpressionAdded",a.NamedExpressionRemoved="namedExpressionRemoved",a.ValuesUpdated="valuesUpdated",a.EvaluationSuspended="evaluationSuspended",a.EvaluationResumed="evaluationResumed"})(Sa||(Sa={}));var QM=function(a){zhe(e,a);var t=Ghe(e);function e(){return Bhe(this,e),t.apply(this,arguments)}return Lhe(e,[{key:"emit",value:function(n){for(var i,s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return(i=dv(ep(e.prototype),"emit",this)).call.apply(i,[this,n].concat(o)),this}}]),e}(JM.TinyEmitter);function hv(a){return Xhe(a)||Khe(a)||eB(a)||$he()}function $he(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Khe(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Xhe(a){if(Array.isArray(a))return o5(a)}function Yhe(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=eB(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function eB(a,t){if(!!a){if(typeof a=="string")return o5(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return o5(a,t)}}function o5(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Zhe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function tB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Jhe(a,t,e){return t&&tB(a.prototype,t),e&&tB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var nr=function(){function a(t,e,r,n,i,s,o,l,u,c,p,m,f,d){Zhe(this,a),this._config=t,this._stats=e,this._dependencyGraph=r,this._columnSearch=n,this._parser=i,this._unparser=s,this._cellContentParser=o,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=p,this._namedExpressions=m,this._serialization=f,this._functionRegistry=d,this._emitter=new QM,this._evaluationSuspended=!1}return Jhe(a,[{key:"graph",get:function(){return this.dependencyGraph.graph}},{key:"rangeMapping",get:function(){return this.dependencyGraph.rangeMapping}},{key:"arrayMapping",get:function(){return this.dependencyGraph.arrayMapping}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"dependencyGraph",get:function(){return this._dependencyGraph}},{key:"evaluator",get:function(){return this._evaluator}},{key:"columnSearch",get:function(){return this._columnSearch}},{key:"lazilyTransformingAstService",get:function(){return this._lazilyTransformingAstService}},{key:"licenseKeyValidityState",get:function(){return this._config.licenseKeyValidityState}},{key:"getCellValue",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}},{key:"getCellFormula",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}},{key:"getCellSerialized",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}},{key:"getSheetValues",value:function(e){return K(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}},{key:"getSheetFormulas",value:function(e){return K(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}},{key:"getSheetSerialized",value:function(e){return K(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}},{key:"getAllSheetsDimensions",value:function(){var e=this;return this._serialization.genericAllSheetsGetter(function(r){return e.getSheetDimensions(r)})}},{key:"getSheetDimensions",value:function(e){return K(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}},{key:"getAllSheetsValues",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}},{key:"getAllSheetsFormulas",value:function(){return this._serialization.getAllSheetsFormulas()}},{key:"getAllSheetsSerialized",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}},{key:"updateConfig",value:function(e){var r=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),s=this._serialization.getAllNamedExpressionsSerialized(),o=dd.rebuildWithConfig(r,i,s,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}},{key:"getConfig",value:function(){return this._config.getConfig()}},{key:"rebuildAndRecalculate",value:function(){this.updateConfig({})}},{key:"getStats",value:function(){return this._stats.snapshot()}},{key:"undo",value:function(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"redo",value:function(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isThereSomethingToUndo",value:function(){return this._crudOperations.isThereSomethingToUndo()}},{key:"isThereSomethingToRedo",value:function(){return this._crudOperations.isThereSomethingToRedo()}},{key:"isItPossibleToSetCellContents",value:function(e){var r;if(gt(e))r=new oe(e,e);else if(bn(e))r=new oe(e.start,e.end);else throw new Pe("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(r);var n=Yhe(r.addresses(this._dependencyGraph)),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;this._crudOperations.ensureItIsPossibleToChangeContent(s)}}catch(o){n.e(o)}finally{n.f()}}catch(o){return!1}return!0}},{key:"setCellContents",value:function(e,r){return this._crudOperations.setCellContents(e,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"swapRowIndexes",value:function(e,r){return K(e,"number","sheetId"),this._crudOperations.setRowOrder(e,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapRowIndexes",value:function(e,r){K(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch(n){return!1}}},{key:"setRowOrder",value:function(e,r){K(e,"number","sheetId");var n=this._crudOperations.mappingFromOrder(e,r,"row");return this.swapRowIndexes(e,n)}},{key:"isItPossibleToSetRowOrder",value:function(e,r){K(e,"number","sheetId");try{var n=this._crudOperations.mappingFromOrder(e,r,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch(i){return!1}}},{key:"swapColumnIndexes",value:function(e,r){return K(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapColumnIndexes",value:function(e,r){K(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch(n){return!1}}},{key:"setColumnOrder",value:function(e,r){K(e,"number","sheetId");var n=this._crudOperations.mappingFromOrder(e,r,"column");return this.swapColumnIndexes(e,n)}},{key:"isItPossibleToSetColumnOrder",value:function(e,r){K(e,"number","sheetId");try{var n=this._crudOperations.mappingFromOrder(e,r,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch(i){return!1}}},{key:"isItPossibleToAddRows",value:function(e){K(e,"number","sheetId");for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=fd(n);try{var o;return(o=this._crudOperations).ensureItIsPossibleToAddRows.apply(o,[e].concat(hv(s))),!0}catch(l){return!1}}},{key:"addRows",value:function(e){var r;K(e,"number","sheetId");for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return(r=this._crudOperations).addRows.apply(r,[e].concat(i)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveRows",value:function(e){K(e,"number","sheetId");for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=md(n);try{var o;return(o=this._crudOperations).ensureItIsPossibleToRemoveRows.apply(o,[e].concat(hv(s))),!0}catch(l){return!1}}},{key:"removeRows",value:function(e){var r;K(e,"number","sheetId");for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return(r=this._crudOperations).removeRows.apply(r,[e].concat(i)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddColumns",value:function(e){K(e,"number","sheetId");for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=fd(n);try{var o;return(o=this._crudOperations).ensureItIsPossibleToAddColumns.apply(o,[e].concat(hv(s))),!0}catch(l){return!1}}},{key:"addColumns",value:function(e){var r;K(e,"number","sheetId");for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return(r=this._crudOperations).addColumns.apply(r,[e].concat(i)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveColumns",value:function(e){K(e,"number","sheetId");for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=md(n);try{var o;return(o=this._crudOperations).ensureItIsPossibleToRemoveColumns.apply(o,[e].concat(hv(s))),!0}catch(l){return!1}}},{key:"removeColumns",value:function(e){var r;K(e,"number","sheetId");for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return(r=this._crudOperations).removeColumns.apply(r,[e].concat(i)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveCells",value:function(e,r){if(!gt(r))throw new Pe("SimpleCellAddress","destinationLeftCorner");if(!bn(e))throw new Pe("SimpleCellRange","source");try{var n=new oe(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),r),!0}catch(i){return!1}}},{key:"moveCells",value:function(e,r){if(!gt(r))throw new Pe("SimpleCellAddress","destinationLeftCorner");if(!bn(e))throw new Pe("SimpleCellRange","source");var n=new oe(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveRows",value:function(e,r,n,i){K(e,"number","sheetId"),K(r,"number","startRow"),K(n,"number","numberOfRows"),K(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,r,n,i),!0}catch(s){return!1}}},{key:"moveRows",value:function(e,r,n,i){return K(e,"number","sheetId"),K(r,"number","startRow"),K(n,"number","numberOfRows"),K(i,"number","targetRow"),this._crudOperations.moveRows(e,r,n,i),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveColumns",value:function(e,r,n,i){K(e,"number","sheetId"),K(r,"number","startColumn"),K(n,"number","numberOfColumns"),K(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,r,n,i),!0}catch(s){return!1}}},{key:"moveColumns",value:function(e,r,n,i){return K(e,"number","sheetId"),K(r,"number","startColumn"),K(n,"number","numberOfColumns"),K(i,"number","targetColumn"),this._crudOperations.moveColumns(e,r,n,i),this.recomputeIfDependencyGraphNeedsIt()}},{key:"copy",value:function(e){if(!bn(e))throw new Pe("SimpleCellRange","source");var r=new oe(e.start,e.end);return this._crudOperations.copy(r.start,r.width(),r.height()),this.getRangeValues(e)}},{key:"cut",value:function(e){if(!bn(e))throw new Pe("SimpleCellRange","source");var r=new oe(e.start,e.end);return this._crudOperations.cut(r.start,r.width(),r.height()),this.getRangeValues(e)}},{key:"paste",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isClipboardEmpty",value:function(){return this._crudOperations.isClipboardEmpty()}},{key:"clearClipboard",value:function(){this._crudOperations.clearClipboard()}},{key:"clearRedoStack",value:function(){this._crudOperations.undoRedo.clearRedoStack()}},{key:"clearUndoStack",value:function(){this._crudOperations.undoRedo.clearUndoStack()}},{key:"getRangeValues",value:function(e){var r=this;if(!bn(e))throw new Pe("SimpleCellRange","source");var n=new oe(e.start,e.end);return n.arrayOfAddressesInRange().map(function(i){return i.map(function(s){return r.getCellValue(s)})})}},{key:"getRangeFormulas",value:function(e){var r=this;if(!bn(e))throw new Pe("SimpleCellRange","source");var n=new oe(e.start,e.end);return n.arrayOfAddressesInRange().map(function(i){return i.map(function(s){return r.getCellFormula(s)})})}},{key:"getRangeSerialized",value:function(e){var r=this;if(!bn(e))throw new Pe("SimpleCellRange","source");var n=new oe(e.start,e.end);return n.arrayOfAddressesInRange().map(function(i){return i.map(function(s){return r.getCellSerialized(s)})})}},{key:"getFillRangeData",value:function(e,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!bn(e))throw new Pe("SimpleCellRange","source");if(!bn(r))throw new Pe("SimpleCellRange","target");var s=new oe(e.start,e.end),o=new oe(r.start,r.end);return this.ensureEvaluationIsNotSuspended(),o.arrayOfAddressesInRange().map(function(l){return l.map(function(u){var c=((u.row-(i?r:e).start.row)%s.height()+s.height())%s.height()+e.start.row,p=((u.col-(i?r:e).start.col)%s.width()+s.width())%s.width()+e.start.col;return n._serialization.getCellSerialized({row:c,col:p,sheet:s.sheet},u)})})}},{key:"isItPossibleToAddSheet",value:function(e){K(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(r){return!1}}},{key:"addSheet",value:function(e){e!==void 0&&K(e,"string","sheetName");var r=this._crudOperations.addSheet(e);return this._emitter.emit(Sa.SheetAdded,r),r}},{key:"isItPossibleToRemoveSheet",value:function(e){K(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(r){return!1}}},{key:"removeSheet",value:function(e){K(e,"number","sheetId");var r=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);var n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Sa.SheetRemoved,r,n),n}},{key:"isItPossibleToClearSheet",value:function(e){K(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(r){return!1}}},{key:"clearSheet",value:function(e){return K(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToReplaceSheetContent",value:function(e,r){K(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,r),!0}catch(n){return!1}}},{key:"setSheetContent",value:function(e,r){return K(e,"number","sheetId"),this._crudOperations.setSheetContent(e,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"simpleCellAddressFromString",value:function(e,r){return K(e,"string","cellAddress"),K(r,"number","sheetId"),zf(this.sheetMapping.get,e,r)}},{key:"simpleCellRangeFromString",value:function(e,r){return K(e,"string","cellRange"),K(r,"number","sheetId"),J6(this.sheetMapping.get,e,r)}},{key:"simpleCellAddressToString",value:function(e,r){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");return K(r,"number","sheetId"),nl(this.sheetMapping.fetchDisplayName,e,r)}},{key:"simpleCellRangeToString",value:function(e,r){if(!bn(e))throw new Pe("SimpleCellRange","cellRange");return K(r,"number","sheetId"),Q6(this.sheetMapping.fetchDisplayName,e,r)}},{key:"getCellDependents",value:function(e){var r;if(gt(e))r=this._dependencyGraph.addressMapping.getCell(e);else if(bn(e))r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Pe("SimpleCellAddress | SimpleCellRange",e);return r===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(r)}},{key:"getCellPrecedents",value:function(e){var r;if(gt(e))r=this._dependencyGraph.addressMapping.getCell(e);else if(bn(e))r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Pe("SimpleCellAddress | SimpleCellRange",e);return r===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(r)}},{key:"getSheetName",value:function(e){return K(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}},{key:"getSheetNames",value:function(){return this.sheetMapping.sheetNames()}},{key:"getSheetId",value:function(e){return K(e,"string","sheetName"),this.sheetMapping.get(e)}},{key:"doesSheetExist",value:function(e){return K(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}},{key:"getCellType",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");var r=this.dependencyGraph.getCell(e);return Bk(r,e)}},{key:"doesCellHaveSimpleValue",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");return this.getCellType(e)===zr.VALUE}},{key:"doesCellHaveFormula",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");var r=this.getCellType(e);return r===zr.FORMULA||r===zr.ARRAYFORMULA}},{key:"isCellEmpty",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");return this.getCellType(e)===zr.EMPTY}},{key:"isCellPartOfArray",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");var r=this.getCellType(e);return r===zr.ARRAY||r===zr.ARRAYFORMULA}},{key:"getCellValueType",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var r=this.dependencyGraph.getCellValue(e);return Gc(r)}},{key:"getCellValueDetailedType",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var r=this.dependencyGraph.getCellValue(e);return Uk(r)}},{key:"getCellValueFormat",value:function(e){if(!gt(e))throw new Pe("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var r=this.dependencyGraph.getCellValue(e);return zk(r)}},{key:"countSheets",value:function(){return this.sheetMapping.numberOfSheets()}},{key:"isItPossibleToRenameSheet",value:function(e,r){K(e,"number","sheetId"),K(r,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,r),!0}catch(n){return!1}}},{key:"renameSheet",value:function(e,r){K(e,"number","sheetId"),K(r,"string","newName");var n=this._crudOperations.renameSheet(e,r);n!==void 0&&this._emitter.emit(Sa.SheetRenamed,n,r)}},{key:"batch",value:function(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(r){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),r}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}},{key:"suspendEvaluation",value:function(){this._evaluationSuspended=!0,this._emitter.emit(Sa.EvaluationSuspended)}},{key:"resumeEvaluation",value:function(){this._evaluationSuspended=!1;var e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Sa.EvaluationResumed,e),e}},{key:"isEvaluationSuspended",value:function(){return this._evaluationSuspended}},{key:"isItPossibleToAddNamedExpression",value:function(e,r,n){K(e,"string","expressionName"),n!==void 0&&K(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,r,n),!0}catch(i){return!1}}},{key:"addNamedExpression",value:function(e,r,n,i){K(e,"string","expressionName"),n!==void 0&&K(n,"number","scope"),this._crudOperations.addNamedExpression(e,r,n,i);var s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Sa.NamedExpressionAdded,e,s),s}},{key:"getNamedExpressionValue",value:function(e,r){K(e,"string","expressionName"),r!==void 0&&K(r,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(r);var n=this._namedExpressions.namedExpressionForScope(e,r);if(n)return this._serialization.getCellValue(n.address)}},{key:"getNamedExpressionFormula",value:function(e,r){K(e,"string","expressionName"),r!==void 0&&K(r,"number","scope"),this._crudOperations.ensureScopeIdIsValid(r);var n=this._namedExpressions.namedExpressionForScope(e,r);if(n!==void 0)return this._serialization.getCellFormula(n.address)}},{key:"getNamedExpression",value:function(e,r){K(e,"string","expressionName"),r!==void 0&&K(r,"number","scope");var n=this._namedExpressions.namedExpressionForScope(e,r);if(n!==void 0){var i=this._serialization.getCellFormula(n.address);return{name:e,scope:r,expression:i,options:n.options}}}},{key:"isItPossibleToChangeNamedExpression",value:function(e,r,n){K(e,"string","expressionName"),n!==void 0&&K(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,r,n),!0}catch(i){return!1}}},{key:"changeNamedExpression",value:function(e,r,n,i){return K(e,"string","expressionName"),n!==void 0&&K(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,r,i),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,r){K(e,"string","expressionName"),r!==void 0&&K(r,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,r),!0}catch(n){return!1}}},{key:"removeNamedExpression",value:function(e,r){K(e,"string","expressionName"),r!==void 0&&K(r,"number","scope");var n=this._crudOperations.removeNamedExpression(e,r);if(n){var i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Sa.NamedExpressionRemoved,n.displayName,i),i}else return[]}},{key:"listNamedExpressions",value:function(e){return e!==void 0&&K(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}},{key:"getAllNamedExpressionsSerialized",value:function(){return this._serialization.getAllNamedExpressionsSerialized()}},{key:"normalizeFormula",value:function(e){K(e,"string","formulaString");var r=this.extractTemporaryFormula(e),n=r.ast,i=r.address;if(n===void 0)throw new hf;return this._unparser.unparse(n,i)}},{key:"calculateFormula",value:function(e,r){K(e,"string","formulaString"),K(r,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(r);var n=this.extractTemporaryFormula(e,r),i=n.ast,s=n.address,o=n.dependencies;if(i===void 0)throw new hf;var l=this.evaluator.runAndForget(i,s,o);return this._exporter.exportScalarOrRange(l)}},{key:"validateFormula",value:function(e){K(e,"string","formulaString");var r=this.extractTemporaryFormula(e),n=r.ast;return!(n===void 0||n.type===I.ERROR&&!n.error)}},{key:"getRegisteredFunctionNames",value:function(){var e=a.getLanguage(this._config.language);return e.getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}},{key:"getFunctionPlugin",value:function(e){return K(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return this._functionRegistry.getPlugins()}},{key:"numberToDateTime",value:function(e){return K(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}},{key:"numberToDate",value:function(e){return K(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}},{key:"numberToTime",value:function(e){return K(e,"number","val"),es(e)}},{key:"on",value:function(e,r){this._emitter.on(e,r)}},{key:"once",value:function(e,r){this._emitter.once(e,r)}},{key:"off",value:function(e,r){this._emitter.off(e,r)}},{key:"destroy",value:function(){this._evaluator.interpreter.destroyGpu(),XM(this)}},{key:"ensureEvaluationIsNotSuspended",value:function(){if(this._evaluationSuspended)throw new cb}},{key:"extractTemporaryFormula",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=this._cellContentParser.parse(e),i={sheet:r,col:0,row:0};if(!(n instanceof rt.Formula))return{address:i,dependencies:[]};var s=this._parser.parse(n.formula,i),o=s.ast,l=s.errors,u=s.dependencies;return l.length>0?{address:i,dependencies:[]}:{ast:o,address:i,dependencies:u}}},{key:"recomputeIfDependencyGraphNeedsIt",value:function(){if(this._evaluationSuspended)return[];var e=this._crudOperations.getAndClearContentChanges(),r=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),r.length>0&&e.addAll(this.evaluator.partialRun(r));var n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Sa.ValuesUpdated,n),n}}],[{key:"defaultConfig",get:function(){return rB()}},{key:"buildFromArray",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return this.buildFromEngineState(dd.buildFromSheet(e,r,n))}},{key:"buildFromSheets",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return this.buildFromEngineState(dd.buildFromSheets(e,r,n))}},{key:"buildEmpty",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return this.buildFromEngineState(dd.buildEmpty(e,r))}},{key:"getLanguage",value:function(e){K(e,"string","languageCode");var r=this.registeredLanguages.get(e);if(r===void 0)throw new yf;return r}},{key:"registerLanguage",value:function(e,r){if(K(e,"string","languageCode"),this.registeredLanguages.has(e))throw new mb;this.registeredLanguages.set(e,$A(r))}},{key:"unregisterLanguage",value:function(e){if(K(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new yf}},{key:"getRegisteredLanguagesCodes",value:function(){return Array.from(this.registeredLanguages.keys())}},{key:"registerFunctionPlugin",value:function(e,r){an.registerFunctionPlugin(e,r)}},{key:"unregisterFunctionPlugin",value:function(e){an.unregisterFunctionPlugin(e)}},{key:"registerFunction",value:function(e,r,n){K(e,"string","functionId"),an.registerFunction(e,r,n)}},{key:"unregisterFunction",value:function(e){K(e,"string","functionId"),an.unregisterFunction(e)}},{key:"unregisterAllFunctions",value:function(){an.unregisterAll()}},{key:"getRegisteredFunctionNames",value:function(e){K(e,"string","code");var r=an.getRegisteredFunctionIds(),n=this.getLanguage(e);return n.getFunctionTranslations(r)}},{key:"getFunctionPlugin",value:function(e){return K(e,"string","functionId"),an.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return an.getPlugins()}},{key:"buildFromEngineState",value:function(e){return new a(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}}]),a}();nr.version="1.3.1";nr.buildDate="11/01/2022 10:43:03";nr.releaseDate="11/01/2022";nr.languages={};nr.registeredLanguages=new Map;function hd(a){return rye(a)||tye(a)||eye(a)||Qhe()}function Qhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eye(a,t){if(!!a){if(typeof a=="string")return l5(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return l5(a,t)}}function tye(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function rye(a){if(Array.isArray(a))return l5(a)}function l5(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function nye(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function nB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function aye(a,t,e){return t&&nB(a.prototype,t),e&&nB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var iye=["gpu","cpu","dev"],aB=new WeakMap,na=function(){function a(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;nye(this,a);var r=t.accentSensitive,n=t.binarySearchThreshold,i=t.caseSensitive,s=t.caseFirst,o=t.chooseAddressMappingPolicy,l=t.currencySymbol,u=t.dateFormats,c=t.decimalSeparator,p=t.evaluateNullToZero,m=t.functionArgSeparator,f=t.functionPlugins,d=t.gpujs,h=t.gpuMode,y=t.ignorePunctuation,b=t.leapYear1900,g=t.localeLang,v=t.language,A=t.licenseKey,C=t.matchWholeCell,S=t.arrayColumnSeparator,w=t.arrayRowSeparator,x=t.maxRows,R=t.maxColumns,O=t.nullYear,_=t.nullDate,k=t.parseDateTime,B=t.precisionEpsilon,U=t.precisionRounding,H=t.stringifyDateTime,j=t.stringifyDuration,P=t.smartRounding,F=t.timeFormats,G=t.thousandSeparator,z=t.useArrayArithmetic,Z=t.useStats,ne=t.undoLimit,ve=t.useColumnIndex,xe=t.useRegularExpressions,ye=t.useWildcards;e&&this.warnDeprecatedOptions(t),this.useArrayArithmetic=ze(z,"boolean","useArrayArithmetic"),this.accentSensitive=ze(r,"boolean","accentSensitive"),this.caseSensitive=ze(i,"boolean","caseSensitive"),this.caseFirst=ze(s,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=ze(y,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=o??a.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=hd(id(u,Array.isArray,"array","dateFormats")),this.timeFormats=hd(id(F,Array.isArray,"array","timeFormats")),this.functionArgSeparator=ze(m,"string","functionArgSeparator"),this.decimalSeparator=ze(c,[".",","],"decimalSeparator"),this.language=ze(v,"string","language"),this.licenseKey=ze(A,"string","licenseKey"),this.thousandSeparator=ze(G,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=ze(S,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=ze(w,[";","|"],"arrayRowSeparator"),this.localeLang=ze(g,"string","localeLang"),this.functionPlugins=hd(f??a.defaultConfig.functionPlugins),this.gpujs=d??a.defaultConfig.gpujs,this.gpuMode=ze(h,iye,"gpuMode"),this.smartRounding=ze(P,"boolean","smartRounding"),this.evaluateNullToZero=ze(p,"boolean","evaluateNullToZero"),this.nullYear=ze(O,"number","nullYear"),ol(this.nullYear,"nullYear",0),nF(this.nullYear,"nullYear",100),this.precisionRounding=ze(U,"number","precisionRounding"),ol(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=ze(B,"number","precisionEpsilon"),ol(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=ze(ve,"boolean","useColumnIndex"),this.useStats=ze(Z,"boolean","useStats"),this.binarySearchThreshold=n??a.defaultConfig.binarySearchThreshold,this.parseDateTime=ze(k,"function","parseDateTime"),this.stringifyDateTime=ze(H,"function","stringifyDateTime"),this.stringifyDuration=ze(j,"function","stringifyDuration"),this.translationPackage=nr.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=id(_,ll,"IDate","nullDate"),this.leapYear1900=ze(b,"boolean","leapYear1900"),this.undoLimit=ze(ne,"number","undoLimit"),this.useRegularExpressions=ze(xe,"boolean","useRegularExpressions"),this.useWildcards=ze(ye,"boolean","useWildcards"),this.matchWholeCell=ze(C,"boolean","matchWholeCell"),ol(this.undoLimit,"undoLimit",0),this.maxRows=ze(x,"number","maxRows"),ol(this.maxRows,"maxRows",1),this.maxColumns=ze(R,"number","maxColumns"),this.currencySymbol=hd(id(l,Array.isArray,"array","currencySymbol")),this.currencySymbol.forEach(function(it){if(typeof it!="string")throw new Pe("string[]","currencySymbol");if(it==="")throw new f4("currencySymbol")}),ol(this.maxColumns,"maxColumns",1),aB.set(this,{licenseKeyValidityState:KF(this.licenseKey)}),uS({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),uS({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}return aye(a,[{key:"licenseKeyValidityState",get:function(){return aB.get(this).licenseKeyValidityState}},{key:"getConfig",value:function(){return iB(this)}},{key:"mergeConfig",value:function(e){var r=Object.assign({},this.getConfig(),e);return this.warnDeprecatedOptions(e),new a(r,!1)}},{key:"warnDeprecatedOptions",value:function(e){this.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1"),this.warnDeprecatedIfUsed(e.gpujs,"gpujs","1.2"),e.gpuMode!==a.defaultConfig.gpuMode&&this.warnDeprecatedIfUsed(e.gpuMode,"gpuMode","1.2")}},{key:"warnDeprecatedIfUsed",value:function(e,r,n,i){e!==void 0&&console.warn(i===void 0?"".concat(r," option is deprecated since ").concat(n):"".concat(r," option is deprecated since ").concat(n,", please use ").concat(i))}}]),a}();na.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new dS,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],gpujs:void 0,gpuMode:"gpu",ignorePunctuation:!1,language:"enGB",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:lF,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:_F,stringifyDuration:PF,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function iB(a){var t,e={};for(var r in na.defaultConfig){var n=(t=a[r])!==null&&t!==void 0?t:na.defaultConfig[r];Array.isArray(n)?e[r]=hd(n):e[r]=n}return e}function rB(){return iB({})}var sye={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}},yv=sye;var E1={};st(E1,{AbsPlugin:()=>h5,ArrayPlugin:()=>m5,BitShiftPlugin:()=>g5,BitwiseLogicOperationsPlugin:()=>N5,BooleanPlugin:()=>S5,CharPlugin:()=>R5,CodePlugin:()=>O5,ComplexPlugin:()=>zE,CountBlankPlugin:()=>P5,CountUniquePlugin:()=>F5,DateTimePlugin:()=>U5,DegreesPlugin:()=>H5,DeltaPlugin:()=>$5,ExpPlugin:()=>Y5,FinancialPlugin:()=>Q5,FormulaTextPlugin:()=>sw,InformationPlugin:()=>uw,IsEvenPlugin:()=>mw,IsOddPlugin:()=>hw,LogarithmPlugin:()=>gw,LookupPlugin:()=>vE,MathConstantsPlugin:()=>Nw,MathPlugin:()=>BE,MatrixPlugin:()=>ww,MedianPlugin:()=>xw,ModuloPlugin:()=>Dw,NumericAggregationPlugin:()=>Gv,PowerPlugin:()=>Fw,RadiansPlugin:()=>Bw,RadixConversionPlugin:()=>zw,RandomPlugin:()=>qw,RomanPlugin:()=>CE,RoundingPlugin:()=>Yv,SimpleArithmerticPlugin:()=>wE,SqrtPlugin:()=>Yw,StatisticalAggregationPlugin:()=>w1,StatisticalPlugin:()=>g1,SumifPlugin:()=>nE,SumprodPlugin:()=>sE,TextPlugin:()=>uE,TrigonometryPlugin:()=>dE});var Uit=M(ie());var qit=M(q());function u5(a){return u5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u5(a)}function sB(a){return uye(a)||lye(a)||oB(a)||oye()}function oye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lye(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function uye(a){if(Array.isArray(a))return c5(a)}function cye(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=oB(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function oB(a,t){if(!!a){if(typeof a=="string")return c5(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return c5(a,t)}}function c5(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function pye(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function lB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function mye(a,t,e){return t&&lB(a.prototype,t),e&&lB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function fye(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&p5(a,t)}function p5(a,t){return p5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},p5(a,t)}function dye(a){var t=bye();return function(){var r=bv(a),n;if(t){var i=bv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return hye(this,n)}}function hye(a,t){if(t&&(u5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yye(a)}function yye(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function bye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function bv(a){return bv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bv(a)}var m5=function(a){fye(e,a);var t=dye(e);function e(){return pye(this,e),t.apply(this,arguments)}return mye(e,[{key:"arrayformula",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ARRAYFORMULA"),function(s){return s})}},{key:"arrayformulaArraySize",value:function(n,i){var s=this;if(n.args.length!==1)return Se.error();var o=this.metadata("ARRAYFORMULA"),l=n.args.map(function(u){var c;return s.arraySizeForAst(u,new Jr(i.formulaAddress,i.arraysFlag||((c=o==null?void 0:o.arrayFunction)!==null&&c!==void 0?c:!1)))});return l[0]}},{key:"arrayconstrain",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ARRAY_CONSTRAIN"),function(s,o,l){o=Math.min(o,s.height()),l=Math.min(l,s.width());for(var u=s.data,c=[],p=0;p<o;p++)c.push(u[p].slice(0,l));return Q.onlyValues(c)})}},{key:"arrayconstrainArraySize",value:function(n,i){var s=this;if(n.args.length!==3)return Se.error();var o=this.metadata("ARRAY_CONSTRAIN"),l=n.args.map(function(m){var f;return s.arraySizeForAst(m,new Jr(i.formulaAddress,i.arraysFlag||((f=o==null?void 0:o.arrayFunction)!==null&&f!==void 0?f:!1)))}),u=l[0],c=u.height,p=u.width;return n.args[1].type===I.NUMBER&&(c=Math.min(c,n.args[1].value)),n.args[2].type===I.NUMBER&&(p=Math.min(p,n.args[2].value)),c<1||p<1||!Number.isInteger(c)||!Number.isInteger(p)?Se.error():new Se(p,c)}},{key:"filter",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FILTER"),function(s){for(var o=arguments.length,l=new Array(o>1?o-1:0),u=1;u<o;u++)l[u-1]=arguments[u];for(var c=0,p=l;c<p.length;c++){var m=p[c];if(s.width()!==m.width()||s.height()!==m.height())return new E(V.NA,D.EqualLength)}if(s.width()>1&&s.height()>1)return new E(V.NA,D.WrongDimension);for(var f=s.data,d=[],h=0;h<s.height();h++){for(var y=[],b=0;b<s.width();b++){var g=!0,v=cye(l),A;try{for(v.s();!(A=v.n()).done;){var C=A.value,S=mg(C.data[h][b]);if(S!==!0){g=!1;break}}}catch(w){v.e(w)}finally{v.f()}g&&y.push(f[h][b])}y.length>0&&d.push(y)}return d.length>0?Q.onlyValues(d):new E(V.NA,D.EmptyRange)})}},{key:"filterArraySize",value:function(n,i){var s=this;if(n.args.length<=1)return Se.error();var o=this.metadata("FILTER"),l=n.args.map(function(p){var m;return s.arraySizeForAst(p,new Jr(i.formulaAddress,i.arraysFlag||((m=o==null?void 0:o.arrayFunction)!==null&&m!==void 0?m:!1)))}),u=Math.max.apply(Math,sB(l.map(function(p){return p.width}))),c=Math.max.apply(Math,sB(l.map(function(p){return p.height})));return new Se(u,c)}}]),e}(X);m5.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:N.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:N.RANGE},{argumentType:N.INTEGER,minValue:1},{argumentType:N.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}],repeatLastArgs:1}};var lst=M(q());function f5(a){return f5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f5(a)}function gye(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function uB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function vye(a,t,e){return t&&uB(a.prototype,t),e&&uB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Tye(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&d5(a,t)}function d5(a,t){return d5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},d5(a,t)}function Nye(a){var t=Sye();return function(){var r=gv(a),n;if(t){var i=gv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Cye(this,n)}}function Cye(a,t){if(t&&(f5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aye(a)}function Aye(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Sye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function gv(a){return gv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gv(a)}var h5=function(a){Tye(e,a);var t=Nye(e);function e(){return gye(this,e),t.apply(this,arguments)}return vye(e,[{key:"abs",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ABS"),Math.abs)}}]),e}(X);h5.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:N.NUMBER}]}};var vst=M(q());function y5(a){return y5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y5(a)}function wye(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function cB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Eye(a,t,e){return t&&cB(a.prototype,t),e&&cB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Rye(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&b5(a,t)}function b5(a,t){return b5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},b5(a,t)}function xye(a){var t=Dye();return function(){var r=vv(a),n;if(t){var i=vv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Vye(this,n)}}function Vye(a,t){if(t&&(y5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oye(a)}function Oye(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Dye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function vv(a){return vv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vv(a)}var Iye=281474976710655,pB=-53,mB=53,g5=function(a){Rye(e,a);var t=xye(e);function e(){return wye(this,e),t.apply(this,arguments)}return Eye(e,[{key:"bitlshift",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BITLSHIFT"),fB)}},{key:"bitrshift",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BITRSHIFT"),dB)}}]),e}(X);g5.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:N.INTEGER,minValue:0},{argumentType:N.INTEGER,minValue:pB,maxValue:mB}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:N.INTEGER,minValue:0},{argumentType:N.INTEGER,minValue:pB,maxValue:mB}]}};function fB(a,t){return t<0?dB(a,-t):hB(a*Math.pow(2,t))}function dB(a,t){return t<0?fB(a,-t):hB(Math.floor(a/Math.pow(2,t)))}function hB(a){return a>Iye?new E(V.NUM,D.BitshiftLong):a}var Ist=M(q());function v5(a){return v5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v5(a)}function Pye(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function yB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function _ye(a,t,e){return t&&yB(a.prototype,t),e&&yB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function kye(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&T5(a,t)}function T5(a,t){return T5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},T5(a,t)}function Fye(a){var t=Bye();return function(){var r=Tv(a),n;if(t){var i=Tv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jye(this,n)}}function jye(a,t){if(t&&(v5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mye(a)}function Mye(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Bye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Tv(a){return Tv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tv(a)}var N5=function(a){kye(e,a);var t=Fye(e);function e(){return Pye(this,e),t.apply(this,arguments)}return _ye(e,[{key:"bitand",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BITAND"),function(s,o){return s&o})}},{key:"bitor",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BITOR"),function(s,o){return s|o})}},{key:"bitxor",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BITXOR"),function(s,o){return s^o})}}]),e}(X);N5.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:N.INTEGER,minValue:0},{argumentType:N.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:N.INTEGER,minValue:0},{argumentType:N.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:N.INTEGER,minValue:0},{argumentType:N.INTEGER,minValue:0}]}};var Hst=M(q());function C5(a){return C5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C5(a)}function Lye(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function bB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Uye(a,t,e){return t&&bB(a.prototype,t),e&&bB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function zye(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&A5(a,t)}function A5(a,t){return A5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},A5(a,t)}function Gye(a){var t=Wye();return function(){var r=Nv(a),n;if(t){var i=Nv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Hye(this,n)}}function Hye(a,t){if(t&&(C5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qye(a)}function qye(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Wye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Nv(a){return Nv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Nv(a)}var S5=function(a){zye(e,a);var t=Gye(e);function e(){return Lye(this,e),t.apply(this,arguments)}return Uye(e,[{key:"literalTrue",value:function(n,i){return this.runFunction(n.args,i,this.metadata("TRUE"),function(){return!0})}},{key:"literalFalse",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FALSE"),function(){return!1})}},{key:"conditionalIf",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IF"),function(s,o,l){return s?o:l})}},{key:"and",value:function(n,i){return this.runFunction(n.args,i,this.metadata("AND"),function(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return!o.some(function(u){return!u})})}},{key:"or",value:function(n,i){return this.runFunction(n.args,i,this.metadata("OR"),function(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return o.some(function(u){return u})})}},{key:"not",value:function(n,i){return this.runFunction(n.args,i,this.metadata("NOT"),function(s){return!s})}},{key:"xor",value:function(n,i){return this.runFunction(n.args,i,this.metadata("XOR"),function(){for(var s=0,o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return l.forEach(function(c){c&&s++}),s%2==1})}},{key:"switch",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SWITCH"),function(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(var p=u.length,m=0;m+1<p;m+=2)if(!(u[m]instanceof E)&&s.arithmeticHelper.eq(o,u[m]))return u[m+1];return m<p?u[m]:new E(V.NA,D.NoDefault)})}},{key:"iferror",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IFERROR"),function(s,o){return s instanceof E?o:s})}},{key:"ifna",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IFNA"),function(s,o){return s instanceof E&&s.type===V.NA?o:s})}},{key:"choose",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CHOOSE"),function(s){return s>(arguments.length<=1?0:arguments.length-1)?new E(V.NUM,D.Selector):s-1+1<1||arguments.length<=s-1+1?void 0:arguments[s-1+1]})}}]),e}(X);S5.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:N.BOOLEAN},{argumentType:N.SCALAR,passSubtype:!0},{argumentType:N.SCALAR,defaultValue:!1,passSubtype:!0}]},AND:{method:"and",parameters:[{argumentType:N.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:N.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:N.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:N.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:N.NOERROR},{argumentType:N.SCALAR,passSubtype:!0},{argumentType:N.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:N.SCALAR,passSubtype:!0},{argumentType:N.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:N.SCALAR,passSubtype:!0},{argumentType:N.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:N.INTEGER,minValue:1},{argumentType:N.SCALAR,passSubtype:!0}],repeatLastArgs:1}};var $ye=he(),Kye=Math.ceil,Xye=Math.floor;$ye({target:"Math",stat:!0},{trunc:function(t){return(t>0?Xye:Kye)(t)}});var Yye=he(),Zye=pe(),Jye=Ne(),Qye=jo(),ebe=Zye.RangeError,gB=String.fromCharCode,vB=String.fromCodePoint,tbe=Jye([].join),rbe=!!vB&&vB.length!=1;Yye({target:"String",stat:!0,forced:rbe},{fromCodePoint:function(t){for(var e=[],r=arguments.length,n=0,i;r>n;){if(i=+arguments[n++],Qye(i,1114111)!==i)throw ebe(i+" is not a valid code point");e[n]=i<65536?gB(i):gB(((i-=65536)>>10)+55296,i%1024+56320)}return tbe(e,"")}});var oot=M(q());function w5(a){return w5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w5(a)}function nbe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function TB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function abe(a,t,e){return t&&TB(a.prototype,t),e&&TB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function ibe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&E5(a,t)}function E5(a,t){return E5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},E5(a,t)}function sbe(a){var t=ube();return function(){var r=Cv(a),n;if(t){var i=Cv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return obe(this,n)}}function obe(a,t){if(t&&(w5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lbe(a)}function lbe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function ube(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Cv(a){return Cv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Cv(a)}var R5=function(a){ibe(e,a);var t=sbe(e);function e(){return nbe(this,e),t.apply(this,arguments)}return abe(e,[{key:"char",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CHAR"),function(s){return s<1||s>=256?new E(V.VALUE,D.CharacterCodeBounds):String.fromCharCode(Math.trunc(s))})}},{key:"unichar",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CHAR"),function(s){return s<1||s>=1114112?new E(V.VALUE,D.CharacterCodeBounds):String.fromCodePoint(Math.trunc(s))})}}]),e}(X);R5.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:N.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:N.NUMBER}]}};var Not=M(q());function x5(a){return x5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x5(a)}function cbe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function NB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function pbe(a,t,e){return t&&NB(a.prototype,t),e&&NB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function mbe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&V5(a,t)}function V5(a,t){return V5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},V5(a,t)}function fbe(a){var t=ybe();return function(){var r=Av(a),n;if(t){var i=Av(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return dbe(this,n)}}function dbe(a,t){if(t&&(x5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hbe(a)}function hbe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function ybe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Av(a){return Av=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Av(a)}var O5=function(a){mbe(e,a);var t=fbe(e);function e(){return cbe(this,e),t.apply(this,arguments)}return pbe(e,[{key:"code",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CODE"),function(s){return s.length===0?new E(V.VALUE,D.EmptyString):s.charCodeAt(0)})}},{key:"unicode",value:function(n,i){return this.runFunction(n.args,i,this.metadata("UNICODE"),function(s){var o;return(o=s.codePointAt(0))!==null&&o!==void 0?o:new E(V.VALUE,D.EmptyString)})}}]),e}(X);O5.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:N.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:N.STRING}]}};var kot=M(q());function D5(a){return D5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D5(a)}function bbe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function CB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function gbe(a,t,e){return t&&CB(a.prototype,t),e&&CB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function vbe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&I5(a,t)}function I5(a,t){return I5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},I5(a,t)}function Tbe(a){var t=Abe();return function(){var r=Sv(a),n;if(t){var i=Sv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Nbe(this,n)}}function Nbe(a,t){if(t&&(D5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cbe(a)}function Cbe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Abe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Sv(a){return Sv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sv(a)}var P5=function(a){vbe(e,a);var t=Tbe(e);function e(){return bbe(this,e),t.apply(this,arguments)}return gbe(e,[{key:"countblank",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COUNTBLANK"),function(){for(var s=0,o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return l.forEach(function(c){c===le&&s++}),s})}}]),e}(X);P5.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:N.SCALAR}],repeatLastArgs:1,expandRanges:!0}};var Uot=M(q());function _5(a){return _5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_5(a)}function Sbe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function AB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function wbe(a,t,e){return t&&AB(a.prototype,t),e&&AB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ebe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&k5(a,t)}function k5(a,t){return k5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},k5(a,t)}function Rbe(a){var t=Obe();return function(){var r=wv(a),n;if(t){var i=wv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xbe(this,n)}}function xbe(a,t){if(t&&(_5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vbe(a)}function Vbe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Obe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function wv(a){return wv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wv(a)}var F5=function(a){Ebe(e,a);var t=Rbe(e);function e(){return Sbe(this,e),t.apply(this,arguments)}return wbe(e,[{key:"countunique",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COUNTUNIQUE"),function(){for(var s=new Set,o=new Set,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];for(var p=0,m=u;p<m.length;p++){var f=m[p];f instanceof E?o.add(f.type):f!==""&&s.add(f)}return s.size+o.size})}}]),e}(X);F5.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:N.SCALAR}],repeatLastArgs:1,expandRanges:!0}};var alt=M(q());var llt=M(ie());function j5(a){return j5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j5(a)}function Dbe(a){return _be(a)||Pbe(a)||M5(a)||Ibe()}function Ibe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pbe(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function _be(a){if(Array.isArray(a))return B5(a)}function SB(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=M5(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function kbe(a,t){return Mbe(a)||jbe(a,t)||M5(a,t)||Fbe()}function Fbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M5(a,t){if(!!a){if(typeof a=="string")return B5(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return B5(a,t)}}function B5(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function jbe(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function Mbe(a){if(Array.isArray(a))return a}function Bbe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function wB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Lbe(a,t,e){return t&&wB(a.prototype,t),e&&wB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ube(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&L5(a,t)}function L5(a,t){return L5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},L5(a,t)}function zbe(a){var t=qbe();return function(){var r=Ev(a),n;if(t){var i=Ev(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Gbe(this,n)}}function Gbe(a,t){if(t&&(j5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hbe(a)}function Hbe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function qbe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Ev(a){return Ev=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ev(a)}var U5=function(a){Ube(e,a);var t=zbe(e);function e(){var r;return Bbe(this,e),r=t.apply(this,arguments),r.isoweeknumCore=function(n){var i=Math.floor(r.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),s=r.dateTimeHelper.numberToSimpleDate(n),o=r.dateTimeHelper.dateToNumber({year:s.year,month:1,day:1}),l=r.dateTimeHelper.relativeNumberToAbsoluteNumber(o),u=l+((4-l)%7+7)%7,c=Math.floor((i-1)/7)-Math.floor((u-1)/7)+1;return c===0?r.isoweeknumCore(n-7)+1:c},r.days360Core=function(n,i,s){var o=r.dateTimeHelper.numberToSimpleDate(n),l=r.dateTimeHelper.numberToSimpleDate(i),u,c;if(s)u=fS(o),c=fS(l);else{var p=r.dateTimeHelper.toBasisUS(o,l),m=kbe(p,2);u=m[0],c=m[1]}return 360*(c.year-u.year)+30*(c.month-u.month)+c.day-u.day},r}return Lbe(e,[{key:"date",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("DATE"),function(o,l,u){var c=Math.trunc(u),p=Math.trunc(l),m=Math.trunc(o);m<s.dateTimeHelper.getEpochYearZero()&&(m+=s.dateTimeHelper.getEpochYearZero());var f=Math.floor((p-1)/12);m+=f,p-=f*12;var d={year:m,month:p,day:1};if(s.dateTimeHelper.isValidDate(d)){var h=s.dateTimeHelper.dateToNumber(d)+(c-1);return h=s.dateTimeHelper.getWithinBounds(h),h===void 0?new E(V.NUM,D.DateBounds):h}return new E(V.VALUE,D.InvalidDate)})}},{key:"time",value:function(n,i){return this.runFunction(n.args,i,this.metadata("TIME"),function(s,o,l){var u=Ys({hours:Math.trunc(s),minutes:Math.trunc(o),seconds:Math.trunc(l)});return u<0?new E(V.NUM,D.NegativeTime):u%1})}},{key:"eomonth",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("EOMONTH"),function(o,l){var u=s.dateTimeHelper.numberToSimpleDate(o),c=s.dateTimeHelper.dateToNumber(s.dateTimeHelper.endOfMonth(mS(u,l)));return c=s.dateTimeHelper.getWithinBounds(c),c===void 0?new E(V.NUM,D.DateBounds):c})}},{key:"day",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("DAY"),function(o){return s.dateTimeHelper.numberToSimpleDate(o).day})}},{key:"days",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DAYS"),function(s,o){return Math.trunc(s)-Math.trunc(o)})}},{key:"month",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("MONTH"),function(o){return s.dateTimeHelper.numberToSimpleDate(o).month})}},{key:"year",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("YEAR"),function(o){return s.dateTimeHelper.numberToSimpleDate(o).year})}},{key:"hour",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HOUR"),function(s){return es(_g(s)%1).hours})}},{key:"minute",value:function(n,i){return this.runFunction(n.args,i,this.metadata("MINUTE"),function(s){return es(_g(s)%1).minutes})}},{key:"second",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SECOND"),function(s){return es(_g(s)%1).seconds})}},{key:"text",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("TEXT"),function(o,l){return DF(o,l,s.config,s.dateTimeHelper)})}},{key:"weekday",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("WEEKDAY"),function(o,l){var u=Math.floor(s.dateTimeHelper.relativeNumberToAbsoluteNumber(o));if(l===3)return(u-1)%7;var c=xB.get(l);return c===void 0?new E(V.NUM,D.BadMode):(u-c)%7+1})}},{key:"weeknum",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("WEEKNUM"),function(o,l){var u=Math.floor(s.dateTimeHelper.relativeNumberToAbsoluteNumber(o)),c=s.dateTimeHelper.numberToSimpleDate(o),p=s.dateTimeHelper.dateToNumber({year:c.year,month:1,day:1}),m=s.dateTimeHelper.relativeNumberToAbsoluteNumber(p);if(l===21)return s.isoweeknumCore(o);var f=xB.get(l);return f===void 0?new E(V.NUM,D.BadMode):Math.floor((u-f)/7)-Math.floor((m-f)/7)+1})}},{key:"isoweeknum",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}},{key:"datevalue",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("DATEVALUE"),function(o){var l=s.dateTimeHelper.parseDateTimeFromConfigFormats(o),u=l.dateTime;return u===void 0?new E(V.VALUE,D.IncorrectDateTime):ll(u)?(pS(u)?Math.trunc(Ys(u)):0)+s.dateTimeHelper.dateToNumber(u):0})}},{key:"timevalue",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("TIMEVALUE"),function(o){var l=s.dateTimeHelper.dateStringToDateNumber(o);return l===void 0?new E(V.VALUE,D.IncorrectDateTime):W(l)%1})}},{key:"now",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("NOW"),function(){var o=new Date(Date.now());return Ys({hours:o.getHours(),minutes:o.getMinutes(),seconds:o.getSeconds()})+s.dateTimeHelper.dateToNumber({year:o.getFullYear(),month:o.getMonth()+1,day:o.getDate()})})}},{key:"today",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("TODAY"),function(){var o=new Date(Date.now());return s.dateTimeHelper.dateToNumber({year:o.getFullYear(),month:o.getMonth()+1,day:o.getDate()})})}},{key:"edate",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("EDATE"),function(o,l){var u=s.dateTimeHelper.numberToSimpleDate(o),c=hF(mS(u,l)),p=s.dateTimeHelper.dateToNumber(c);return p=s.dateTimeHelper.getWithinBounds(p),p===void 0?new E(V.NUM,D.DateBounds):p})}},{key:"datedif",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("DATEDIF"),function(o,l,u){if(o>l)return new E(V.NUM,D.StartEndDate);if(u==="D")return Math.floor(l)-Math.floor(o);var c=s.dateTimeHelper.numberToSimpleDate(o),p=s.dateTimeHelper.numberToSimpleDate(l);switch(u){case"M":return(p.year-c.year)*12+(p.month-c.month)-(p.day<c.day?1:0);case"YM":return(12+(p.month-c.month)-(p.day<c.day?1:0))%12;case"Y":return p.month>c.month||p.month===c.month&&p.day>=c.day?p.year-c.year:p.year-c.year-1;case"MD":if(p.day>=c.day)return p.day-c.day;var m=p.month===1?12:p.month-1,f=p.month===1?p.year-1:p.year;return s.dateTimeHelper.daysInMonth(f,m)+p.day-c.day;case"YD":return p.month>c.month||p.month===c.month&&p.day>=c.day?Math.floor(l)-s.dateTimeHelper.dateToNumber({year:p.year,month:c.month,day:c.day}):Math.floor(l)-Math.floor(o)-365*(p.year-c.year-1)-s.dateTimeHelper.leapYearsCount(p.year-1)+s.dateTimeHelper.leapYearsCount(c.year);default:return new E(V.NUM,D.BadMode)}})}},{key:"days360",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DAYS360"),this.days360Core)}},{key:"yearfrac",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("YEARFRAC"),function(o,l,u){if(o=Math.trunc(o),l=Math.trunc(l),o>l){var c=[l,o];o=c[0],l=c[1]}switch(u){case 0:return s.days360Core(o,l,!1)/360;case 1:return(l-o)/s.dateTimeHelper.yearLengthForBasis(s.dateTimeHelper.numberToSimpleDate(o),s.dateTimeHelper.numberToSimpleDate(l));case 2:return(l-o)/360;case 3:return(l-o)/365;case 4:return s.days360Core(o,l,!0)/360}throw new Error("Should not be reachable.")})}},{key:"interval",value:function(n,i){return this.runFunction(n.args,i,this.metadata("INTERVAL"),function(s){s=Math.trunc(s);var o=s%60;s=Math.trunc(s/60);var l=s%60;s=Math.trunc(s/60);var u=s%24;s=Math.trunc(s/24);var c=s%30;s=Math.trunc(s/30);var p=s%12,m=Math.trunc(s/12);return"P"+(m>0?m+"Y":"")+(p>0?p+"M":"")+(c>0?c+"D":"")+"T"+(u>0?u+"H":"")+(l>0?l+"M":"")+(o>0?o+"S":"")})}},{key:"networkdays",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("NETWORKDAYS"),function(o,l,u){return s.networkdayscore(o,l,1,u)})}},{key:"networkdaysintl",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("NETWORKDAYS.INTL"),function(o,l,u,c){return s.networkdayscore(o,l,u,c)})}},{key:"workday",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("WORKDAY"),function(o,l,u){return s.workdaycore(o,l,1,u)})}},{key:"workdayintl",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("WORKDAY.INTL"),function(o,l,u,c){return s.workdaycore(o,l,u,c)})}},{key:"networkdayscore",value:function(n,i,s,o){n=Math.trunc(n),i=Math.trunc(i);var l=1;if(n>i){var u=[i,n];n=u[0],i=u[1],l=-1}var c=RB(s);if(c instanceof E)return c;var p=this.simpleRangeToFilteredHolidays(c,o);return p instanceof E?p:l*this.countWorkdays(n,i,c,p)}},{key:"workdaycore",value:function(n,i,s,o){n=Math.trunc(n),i=Math.trunc(i);var l=RB(s);if(l instanceof E)return l;var u=this.simpleRangeToFilteredHolidays(l,o);if(u instanceof E)return u;if(i>0){for(var c=1;this.countWorkdays(n+1,n+c,l,u)<i;)c*=2;for(var p=1;p+1<c;){var m=Math.trunc((p+c)/2);this.countWorkdays(n+1,n+m,l,u)<i?p=m:c=m}return n+c}else if(i<0){i*=-1;for(var f=1;this.countWorkdays(n-f,n-1,l,u)<i;)f*=2;for(var d=1;d+1<f;){var h=Math.trunc((d+f)/2);this.countWorkdays(n-h,n-1,l,u)<i?d=h:f=h}return n-f}else return n}},{key:"countWorkdays",value:function(n,i,s,o){for(var l=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(i)),u=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),c=0,p=0;p<7;p++)s.charAt(p)==="0"&&(c+=Math.floor((l+6-p)/7),c-=Math.floor((u-1+6-p)/7));return c-=EB(i+1,o)-EB(n,o),c}},{key:"simpleRangeToFilteredHolidays",value:function(n,i){var s=this,o,l=(o=i==null?void 0:i.valuesFromTopLeftCorner())!==null&&o!==void 0?o:[],u=SB(l),c;try{for(u.s();!(c=u.n()).done;){var p=c.value;if(p instanceof E)return p}}catch(y){u.e(y)}finally{u.f()}var m=[],f=SB(l),d;try{for(f.s();!(d=f.n()).done;){var h=d.value;if(h!==le)if(Ce(h))m.push(Math.trunc(W(h)));else return new E(V.VALUE,D.WrongType)}}catch(y){f.e(y)}finally{f.f()}return Dbe(new Set(m)).sort(function(y,b){return y-b}).filter(function(y){var b=s.dateTimeHelper.relativeNumberToAbsoluteNumber(y),g=(b-1)%7;return n.charAt(g)==="0"})}}]),e}(X);U5.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER}],returnNumberType:te.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER}],returnNumberType:te.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:N.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:N.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:N.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:N.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:N.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:N.NUMBER},{argumentType:N.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER}],returnNumberType:te.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:N.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:N.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:N.STRING}],returnNumberType:te.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:N.STRING}],returnNumberType:te.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:te.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:te.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER}],returnNumberType:te.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:N.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.NOERROR,defaultValue:1},{argumentType:N.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER},{argumentType:N.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER},{argumentType:N.NOERROR,defaultValue:1},{argumentType:N.RANGE,optionalArg:!0}]}};function EB(a,t){if(t.length===0||a<=t[0])return 0;if(t[t.length-1]<a)return t.length;for(var e=0,r=t.length-1;e+1<r;){var n=Math.floor((r+e)/2);t[n]>=a?r=n:e=n}return r}function RB(a){var t;return typeof a!="number"&&typeof a!="string"?new E(V.VALUE,D.WrongType):typeof a=="string"?a.length!==7||!/^(0|1)*$/.test(a)||a==="1111111"?new E(V.NUM,D.WeekendString):a:(t=Wbe.get(a))!==null&&t!==void 0?t:new E(V.NUM,D.BadMode)}var xB=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),Wbe=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);var Dlt=M(q());function z5(a){return z5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z5(a)}function $be(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function VB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Kbe(a,t,e){return t&&VB(a.prototype,t),e&&VB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Xbe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&G5(a,t)}function G5(a,t){return G5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},G5(a,t)}function Ybe(a){var t=Qbe();return function(){var r=Rv(a),n;if(t){var i=Rv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Zbe(this,n)}}function Zbe(a,t){if(t&&(z5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jbe(a)}function Jbe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Qbe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Rv(a){return Rv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Rv(a)}var H5=function(a){Xbe(e,a);var t=Ybe(e);function e(){return $be(this,e),t.apply(this,arguments)}return Kbe(e,[{key:"degrees",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DEGREES"),function(s){return s*(180/Math.PI)})}}]),e}(X);H5.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:N.NUMBER}]}};var zlt=M(q());function q5(a){return q5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q5(a)}function ege(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function OB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function tge(a,t,e){return t&&OB(a.prototype,t),e&&OB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function rge(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&W5(a,t)}function W5(a,t){return W5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},W5(a,t)}function nge(a){var t=sge();return function(){var r=xv(a),n;if(t){var i=xv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return age(this,n)}}function age(a,t){if(t&&(q5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ige(a)}function ige(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function sge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function xv(a){return xv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xv(a)}var $5=function(a){rge(e,a);var t=nge(e);function e(){return ege(this,e),t.apply(this,arguments)}return tge(e,[{key:"delta",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DELTA"),function(s,o){return s===o?1:0})}}]),e}(X);$5.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0}]}};var Qlt=M(q());function K5(a){return K5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K5(a)}function oge(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function DB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function lge(a,t,e){return t&&DB(a.prototype,t),e&&DB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function uge(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&X5(a,t)}function X5(a,t){return X5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},X5(a,t)}function cge(a){var t=fge();return function(){var r=Vv(a),n;if(t){var i=Vv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return pge(this,n)}}function pge(a,t){if(t&&(K5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mge(a)}function mge(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function fge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Vv(a){return Vv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vv(a)}var Y5=function(a){uge(e,a);var t=cge(e);function e(){return oge(this,e),t.apply(this,arguments)}return lge(e,[{key:"exp",value:function(n,i){return this.runFunction(n.args,i,this.metadata("EXP"),Math.exp)}}]),e}(X);Y5.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:N.NUMBER}]}};var mut=M(ie());var yut=M(q());function Z5(a){return Z5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z5(a)}function yd(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=dge(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function dge(a,t){if(!!a){if(typeof a=="string")return IB(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return IB(a,t)}}function IB(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function hge(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function PB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function yge(a,t,e){return t&&PB(a.prototype,t),e&&PB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function bge(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&J5(a,t)}function J5(a,t){return J5=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},J5(a,t)}function gge(a){var t=Nge();return function(){var r=Ov(a),n;if(t){var i=Ov(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return vge(this,n)}}function vge(a,t){if(t&&(Z5(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tge(a)}function Tge(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Nge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Ov(a){return Ov=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ov(a)}var Q5=function(a){bge(e,a);var t=gge(e);function e(){return hge(this,e),t.apply(this,arguments)}return yge(e,[{key:"pmt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("PMT"),ew)}},{key:"ipmt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IPMT"),tw)}},{key:"ppmt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("PPMT"),_B)}},{key:"fv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FV"),rw)}},{key:"cumipmt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CUMIPMT"),function(s,o,l,u,c,p){if(u>c)return new E(V.NUM,D.EndStartPeriod);for(var m=0,f=u;f<=c;f++)m+=tw(s,f,o,l,0,p);return m})}},{key:"cumprinc",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CUMPRINC"),function(s,o,l,u,c,p){if(u>c)return new E(V.NUM,D.EndStartPeriod);for(var m=0,f=u;f<=c;f++)m+=_B(s,f,o,l,0,p);return m})}},{key:"db",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DB"),function(s,o,l,u,c){if(c===12&&u>l||u>l+1)return new E(V.NUM,D.PeriodLong);if(o>=s)return 0;var p=Math.round((1-Math.pow(o/s,1/l))*1e3)/1e3,m=s*p*c/12;if(u===1)return m;for(var f=m,d=0;d<u-2;d++)f+=(s-f)*p;return u===l+1?(s-f)*p*(12-c)/12:(s-f)*p})}},{key:"ddb",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DDB"),function(s,o,l,u,c){if(u>l)return new E(V.NUM);var p=c/l,m;p>=1?(p=1,u===1?m=s:m=0):m=s*Math.pow(1-p,u-1);var f=s*Math.pow(1-p,u);return Math.max(m-Math.max(o,f),0)})}},{key:"dollarde",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DOLLARDE"),function(s,o){if(o<1)return new E(V.DIV_BY_ZERO);for(o=Math.trunc(o);o>10;)o/=10;return Math.trunc(s)+(s-Math.trunc(s))*10/o})}},{key:"dollarfr",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DOLLARFR"),function(s,o){if(o<1)return new E(V.DIV_BY_ZERO);for(o=Math.trunc(o);o>10;)o/=10;return Math.trunc(s)+(s-Math.trunc(s))*o/10})}},{key:"effect",value:function(n,i){return this.runFunction(n.args,i,this.metadata("EFFECT"),function(s,o){return o=Math.trunc(o),Math.pow(1+s/o,o)-1})}},{key:"ispmt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISPMT"),function(s,o,l,u){return l===0?new E(V.DIV_BY_ZERO):u*s*(o/l-1)})}},{key:"nominal",value:function(n,i){return this.runFunction(n.args,i,this.metadata("NOMINAL"),function(s,o){return o=Math.trunc(o),(Math.pow(s+1,1/o)-1)*o})}},{key:"nper",value:function(n,i){return this.runFunction(n.args,i,this.metadata("NPER"),function(s,o,l,u,c){return s===0?o===0?new E(V.DIV_BY_ZERO):(-l-u)/o:(c&&(o*=1+s),Math.log((o-u*s)/(l*s+o))/Math.log(1+s))})}},{key:"rate",value:function(n,i){return this.runFunction(n.args,i,this.metadata("RATE"),function(s,o,l,u,c,p){if(p<=-1)return new E(V.VALUE);var m=1e-10,f=20,d=p;c=c?1:0;for(var h=0;h<f;h++){if(d<=-1)return new E(V.NUM);var y=void 0;if(Math.abs(d)<m)y=l*(1+s*d)+o*(1+d*c)*s+u;else{var b=Math.pow(1+d,s);y=l*b+o*(1/d+c)*(b-1)+u}if(Math.abs(y)<m)return d;var g=void 0;if(Math.abs(d)<m)g=l*s+o*c*s;else{var v=Math.pow(1+d,s),A=s*Math.pow(1+d,s-1);g=l*A+o*(1/d+c)*A+o*(-1/(d*d))*(v-1)}d-=y/g}return new E(V.NUM)})}},{key:"pv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("PV"),function(s,o,l,u,c){return c=c?1:0,s===-1?o===0?new E(V.NUM):new E(V.DIV_BY_ZERO):s===0?-l*o-u:((1-Math.pow(1+s,o))*l*(1+s*c)/s-u)/Math.pow(1+s,o)})}},{key:"rri",value:function(n,i){return this.runFunction(n.args,i,this.metadata("RRI"),function(s,o,l){return o===0||l<0&&o>0||l>0&&o<0?new E(V.NUM):Math.pow(l/o,1/s)-1})}},{key:"sln",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SLN"),function(s,o,l){return l===0?new E(V.DIV_BY_ZERO):(s-o)/l})}},{key:"syd",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SYD"),function(s,o,l,u){return u>l?new E(V.NUM):(s-o)*(l-u+1)*2/(l*(l+1))})}},{key:"tbilleq",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("TBILLEQ"),function(o,l,u){if(o=Math.round(o),l=Math.round(l),o>=l)return new E(V.NUM);var c=s.dateTimeHelper.numberToSimpleDate(o),p=s.dateTimeHelper.numberToSimpleDate(l);if(p.year>c.year+1||p.year===c.year+1&&(p.month>c.month||p.month===c.month&&p.day>c.day))return new E(V.NUM);var m=360-u*(l-o);return m===0?0:m<0?new E(V.NUM):365*u/m})}},{key:"tbillprice",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("TBILLPRICE"),function(o,l,u){if(o=Math.round(o),l=Math.round(l),o>=l)return new E(V.NUM);var c=s.dateTimeHelper.numberToSimpleDate(o),p=s.dateTimeHelper.numberToSimpleDate(l);if(p.year>c.year+1||p.year===c.year+1&&(p.month>c.month||p.month===c.month&&p.day>c.day))return new E(V.NUM);var m=360-u*(l-o);return m===0?0:m<0?new E(V.NUM):100*(1-u*(l-o)/360)})}},{key:"tbillyield",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("TBILLYIELD"),function(o,l,u){if(o=Math.round(o),l=Math.round(l),o>=l)return new E(V.NUM);var c=s.dateTimeHelper.numberToSimpleDate(o),p=s.dateTimeHelper.numberToSimpleDate(l);return p.year>c.year+1||p.year===c.year+1&&(p.month>c.month||p.month===c.month&&p.day>c.day)?new E(V.NUM):(100-u)*360/(u*(l-o))})}},{key:"fvschedule",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FVSCHEDULE"),function(s,o){var l=o.valuesFromTopLeftCorner(),u=yd(l),c;try{for(u.s();!(c=u.n()).done;){var p=c.value;if(p instanceof E)return p}}catch(h){u.e(h)}finally{u.f()}var m=yd(l),f;try{for(m.s();!(f=m.n()).done;){var d=f.value;if(Ce(d))s*=1+W(d);else if(d!==le)return new E(V.VALUE,D.NumberExpected)}}catch(h){m.e(h)}finally{m.f()}return s})}},{key:"npv",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("NPV"),function(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];var p=s.arithmeticHelper.coerceNumbersExactRanges(u);return p instanceof E?p:nw(o,p)})}},{key:"mirr",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("MIRR"),function(o,l,u){var c=s.arithmeticHelper.manyToExactNumbers(o.valuesFromTopLeftCorner());if(c instanceof E)return c;var p=!1,m=!1,f=[],d=[],h=yd(c),y;try{for(h.s();!(y=h.n()).done;){var b=y.value;b>0?(p=!0,f.push(b),d.push(0)):b<0?(m=!0,d.push(b),f.push(0)):(d.push(0),f.push(0))}}catch(C){h.e(C)}finally{h.f()}if(!p||!m)return new E(V.DIV_BY_ZERO);var g=c.length,v=nw(u,f);if(v instanceof E)return v;var A=nw(l,d);return A instanceof E?A:Math.pow(-v*Math.pow(1+u,g)/A/(1+l),1/(g-1))-1})}},{key:"pduration",value:function(n,i){return this.runFunction(n.args,i,this.metadata("PDURATION"),function(s,o,l){return(Math.log(l)-Math.log(o))/Math.log(1+s)})}},{key:"xnpv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("XNPV"),function(s,o,l){var u=o.valuesFromTopLeftCorner(),c=yd(u),p;try{for(c.s();!(p=c.n()).done;){var m=p.value;if(typeof m!="number")return new E(V.VALUE,D.NumberExpected)}}catch(S){c.e(S)}finally{c.f()}var f=u,d=l.valuesFromTopLeftCorner(),h=yd(d),y;try{for(h.s();!(y=h.n()).done;){var b=y.value;if(typeof b!="number")return new E(V.VALUE,D.NumberExpected)}}catch(S){h.e(S)}finally{h.f()}var g=d;if(g.length!==f.length)return new E(V.NUM,D.EqualLength);var v=g.length,A=0;if(g[0]<0)return new E(V.NUM,D.ValueSmall);for(var C=0;C<v;C++){if(g[C]=Math.floor(g[C]),g[C]<g[0])return new E(V.NUM,D.ValueSmall);A+=f[C]/Math.pow(1+s,(g[C]-g[0])/365)}return A})}}]),e}(X);Q5.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:0}],returnNumberType:te.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:0}],returnNumberType:te.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:0}],returnNumberType:te.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:0}],returnNumberType:te.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.INTEGER,minValue:1},{argumentType:N.INTEGER,minValue:1},{argumentType:N.INTEGER,minValue:0,maxValue:1}],returnNumberType:te.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.INTEGER,minValue:1},{argumentType:N.INTEGER,minValue:1},{argumentType:N.INTEGER,minValue:0,maxValue:1}],returnNumberType:te.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.INTEGER,minValue:0},{argumentType:N.INTEGER,minValue:0},{argumentType:N.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:te.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.INTEGER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:te.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:1}],returnNumberType:te.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:1}],returnNumberType:te.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:0}],returnNumberType:te.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:.1}],returnNumberType:te.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER},{argumentType:N.NUMBER}],returnNumberType:te.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER}],returnNumberType:te.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0}],returnNumberType:te.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,greaterThan:0}],returnNumberType:te.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,greaterThan:0}],returnNumberType:te.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,greaterThan:0}],returnNumberType:te.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:N.NUMBER},{argumentType:N.RANGE}],returnNumberType:te.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:N.NUMBER},{argumentType:N.ANY}],repeatLastArgs:1,returnNumberType:te.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:N.RANGE},{argumentType:N.NUMBER},{argumentType:N.NUMBER}],returnNumberType:te.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:N.NUMBER,greaterThan:-1},{argumentType:N.RANGE},{argumentType:N.RANGE}]}};function ew(a,t,e,r,n){if(a===0)return(-e-r)/t;var i=Math.pow(1+a,t);return(r*a+e*a*i)*(n?1/(1+a):1)/(1-i)}function tw(a,t,e,r,n,i){var s=ew(a,e,r,n,i);return t===1?a*(i?0:-r):a*(i?rw(a,t-2,s,r,i)-s:rw(a,t-1,s,r,i))}function rw(a,t,e,r,n){if(a===0)return-r-e*t;var i=Math.pow(1+a,t);return e*(n?1+a:1)*(1-i)/a-r*i}function _B(a,t,e,r,n,i){return ew(a,e,r,n,i)-tw(a,t,e,r,n,i)}function nw(a,t){for(var e=0,r=t.length-1;r>=0;r--){if(e+=t[r],a===-1){if(e===0)continue;return new E(V.DIV_BY_ZERO)}e/=1+a}return e}var Vut=M(q());function aw(a){return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(a)}function Cge(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function kB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Age(a,t,e){return t&&kB(a.prototype,t),e&&kB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Sge(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&iw(a,t)}function iw(a,t){return iw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},iw(a,t)}function wge(a){var t=xge();return function(){var r=Dv(a),n;if(t){var i=Dv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ege(this,n)}}function Ege(a,t){if(t&&(aw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rge(a)}function Rge(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function xge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Dv(a){return Dv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Dv(a)}var sw=function(a){Sge(e,a);var t=wge(e);function e(){return Cge(this,e),t.apply(this,arguments)}return Age(e,[{key:"formulatext",value:function(n,i){var s=this;return this.runFunctionWithReferenceArgument(n.args,i,this.metadata("FORMULATEXT"),function(){return new E(V.NA,D.WrongArgNumber)},function(o){var l;return(l=s.serialization.getCellFormula(o))!==null&&l!==void 0?l:new E(V.NA,D.Formula)})}}]),e}(X);sw.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:N.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};var jut=M(ie());var Hut=M(q());function ow(a){return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(a)}function Vge(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function FB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Oge(a,t,e){return t&&FB(a.prototype,t),e&&FB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Dge(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&lw(a,t)}function lw(a,t){return lw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},lw(a,t)}function Ige(a){var t=kge();return function(){var r=Iv(a),n;if(t){var i=Iv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Pge(this,n)}}function Pge(a,t){if(t&&(ow(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _ge(a)}function _ge(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function kge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Iv(a){return Iv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Iv(a)}var uw=function(a){Dge(e,a);var t=Ige(e);function e(){return Vge(this,e),t.apply(this,arguments)}return Oge(e,[{key:"isbinary",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISBINARY"),function(s){return/^[01]{1,10}$/.test(s)})}},{key:"iserr",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISERR"),function(s){return s instanceof E&&s.type!==V.NA})}},{key:"iserror",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISERROR"),function(s){return s instanceof E})}},{key:"isformula",value:function(n,i){var s=this;return this.runFunctionWithReferenceArgument(n.args,i,this.metadata("ISFORMULA"),function(){return new E(V.NA,D.WrongArgNumber)},function(o){var l=s.dependencyGraph.addressMapping.getCell(o);return l instanceof dr})}},{key:"isblank",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISBLANK"),function(s){return s===le})}},{key:"isna",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISNA"),function(s){return s instanceof E&&s.type==V.NA})}},{key:"isnumber",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISNUMBER"),Ce)}},{key:"islogical",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISLOGICAL"),function(s){return typeof s=="boolean"})}},{key:"isref",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISREF"),function(s){return s instanceof E&&(s.type==V.REF||s.type==V.CYCLE)})}},{key:"istext",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISTEXT"),function(s){return typeof s=="string"})}},{key:"isnontext",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISNONTEXT"),function(s){return typeof s!="string"})}},{key:"column",value:function(n,i){return this.runFunctionWithReferenceArgument(n.args,i,this.metadata("COLUMN"),function(){return i.formulaAddress.col+1},function(s){return s.col+1})}},{key:"columns",value:function(n,i){if(n.args.length!==1)return new E(V.NA,D.WrongArgNumber);if(n.args.some(function(l){return l.type===I.EMPTY}))return new E(V.NUM,D.EmptyArg);for(var s=n.args[0];s.type===I.PARENTHESIS;)s=s.expression;if(s.type===I.CELL_RANGE||s.type===I.COLUMN_RANGE)return s.end.col-s.start.col+1;if(s.type===I.CELL_REFERENCE)return 1;if(s.type===I.ROW_RANGE)return this.config.maxColumns;var o=this.evaluateAst(s,i);return o instanceof Q?o.width():o instanceof E?o:1}},{key:"row",value:function(n,i){return this.runFunctionWithReferenceArgument(n.args,i,this.metadata("ROW"),function(){return i.formulaAddress.row+1},function(s){return s.row+1})}},{key:"rows",value:function(n,i){if(n.args.length!==1)return new E(V.NA,D.WrongArgNumber);if(n.args.some(function(l){return l.type===I.EMPTY}))return new E(V.NUM,D.EmptyArg);for(var s=n.args[0];s.type===I.PARENTHESIS;)s=s.expression;if(s.type===I.CELL_RANGE||s.type===I.ROW_RANGE)return s.end.row-s.start.row+1;if(s.type===I.CELL_REFERENCE)return 1;if(s.type===I.COLUMN_RANGE)return this.config.maxRows;var o=this.evaluateAst(s,i);return o instanceof Q?o.height():o instanceof E?o:1}},{key:"index",value:function(n,i){return this.runFunction(n.args,i,this.metadata("INDEX"),function(s,o,l){var u,c,p,m,f,d;return l<1||o<1?new E(V.VALUE,D.LessThanOne):l>s.width()||o>s.height()?new E(V.NUM,D.ValueLarge):(d=(p=(c=(u=s==null?void 0:s.data)===null||u===void 0?void 0:u[o-1])===null||c===void 0?void 0:c[l-1])!==null&&p!==void 0?p:(f=(m=s==null?void 0:s.data)===null||m===void 0?void 0:m[0])===null||f===void 0?void 0:f[0])!==null&&d!==void 0?d:new E(V.VALUE,D.CellRangeExpected)})}},{key:"na",value:function(n,i){return new E(V.NA)}},{key:"sheet",value:function(n,i){var s=this;return this.runFunctionWithReferenceArgument(n.args,i,this.metadata("SHEET"),function(){return i.formulaAddress.sheet+1},function(o){return o.sheet+1},function(o){var l=s.dependencyGraph.sheetMapping.get(o);return l!==void 0?l+1:new E(V.NA,D.SheetRef)})}},{key:"sheets",value:function(n,i){var s=this;return this.runFunctionWithReferenceArgument(n.args,i,this.metadata("SHEETS"),function(){return s.dependencyGraph.sheetMapping.numberOfSheets()},function(){return 1},function(){return new E(V.VALUE,D.CellRefExpected)})}}]),e}(X);uw.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:N.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:N.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:N.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:N.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:N.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:N.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:N.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:N.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:N.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:N.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:N.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:N.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:N.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:N.RANGE},{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:N.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:N.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:N.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:N.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};var oct=M(q());function cw(a){return cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cw(a)}function Fge(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function jB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function jge(a,t,e){return t&&jB(a.prototype,t),e&&jB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Mge(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&pw(a,t)}function pw(a,t){return pw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},pw(a,t)}function Bge(a){var t=zge();return function(){var r=Pv(a),n;if(t){var i=Pv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Lge(this,n)}}function Lge(a,t){if(t&&(cw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uge(a)}function Uge(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function zge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Pv(a){return Pv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pv(a)}var mw=function(a){Mge(e,a);var t=Bge(e);function e(){return Fge(this,e),t.apply(this,arguments)}return jge(e,[{key:"iseven",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISEVEN"),function(s){return s%2==0})}}]),e}(X);mw.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:N.NUMBER}]}};var gct=M(q());function fw(a){return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(a)}function Gge(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function MB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Hge(a,t,e){return t&&MB(a.prototype,t),e&&MB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function qge(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&dw(a,t)}function dw(a,t){return dw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},dw(a,t)}function Wge(a){var t=Xge();return function(){var r=_v(a),n;if(t){var i=_v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $ge(this,n)}}function $ge(a,t){if(t&&(fw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kge(a)}function Kge(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Xge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function _v(a){return _v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_v(a)}var hw=function(a){qge(e,a);var t=Wge(e);function e(){return Gge(this,e),t.apply(this,arguments)}return Hge(e,[{key:"isodd",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ISODD"),function(s){return s%2==1})}}]),e}(X);hw.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:N.NUMBER}]}};var Oct=M(q());function yw(a){return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(a)}function Yge(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function BB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Zge(a,t,e){return t&&BB(a.prototype,t),e&&BB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Jge(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&bw(a,t)}function bw(a,t){return bw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},bw(a,t)}function Qge(a){var t=rve();return function(){var r=kv(a),n;if(t){var i=kv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return eve(this,n)}}function eve(a,t){if(t&&(yw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tve(a)}function tve(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function rve(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function kv(a){return kv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kv(a)}var gw=function(a){Jge(e,a);var t=Qge(e);function e(){return Yge(this,e),t.apply(this,arguments)}return Zge(e,[{key:"log10",value:function(n,i){return this.runFunction(n.args,i,this.metadata("LOG10"),Math.log10)}},{key:"log",value:function(n,i){return this.runFunction(n.args,i,this.metadata("LOG"),function(s,o){return Math.log(s)/Math.log(o)})}},{key:"ln",value:function(n,i){return this.runFunction(n.args,i,this.metadata("LN"),Math.log)}}]),e}(X);gw.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:N.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:N.NUMBER}]}};var zct=M(q());function vw(a){return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(a)}function nve(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function LB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function ave(a,t,e){return t&&LB(a.prototype,t),e&&LB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function ive(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Tw(a,t)}function Tw(a,t){return Tw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Tw(a,t)}function sve(a){var t=uve();return function(){var r=Fv(a),n;if(t){var i=Fv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ove(this,n)}}function ove(a,t){if(t&&(vw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lve(a)}function lve(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function uve(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Fv(a){return Fv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fv(a)}var jv=parseFloat(Math.PI.toFixed(14)),Nw=function(a){ive(e,a);var t=sve(e);function e(){return nve(this,e),t.apply(this,arguments)}return ave(e,[{key:"pi",value:function(n,i){return this.runFunction(n.args,i,this.metadata("PI"),function(){return jv})}},{key:"sqrtpi",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SQRTPI"),function(s){return Math.sqrt(jv*s)})}}]),e}(X);Nw.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:N.NUMBER,minValue:0}]}};var ept=M(q());var spt=M(ie());function Cw(a){return Cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cw(a)}function UB(a,t){return fve(a)||mve(a,t)||pve(a,t)||cve()}function cve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pve(a,t){if(!!a){if(typeof a=="string")return zB(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return zB(a,t)}}function zB(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function mve(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function fve(a){if(Array.isArray(a))return a}function dve(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function GB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function hve(a,t,e){return t&&GB(a.prototype,t),e&&GB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function yve(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Aw(a,t)}function Aw(a,t){return Aw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Aw(a,t)}function bve(a){var t=Tve();return function(){var r=Mv(a),n;if(t){var i=Mv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gve(this,n)}}function gve(a,t){if(t&&(Cw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vve(a)}function vve(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Tve(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Mv(a){return Mv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Mv(a)}function HB(a,t){return new Se(t.width,a.height)}function Sw(a,t,e){return new Se(1+(a.width-t)/e,1+(a.height-t)/e)}var ww=function(a){yve(e,a);var t=bve(e);function e(r){var n;return dve(this,e),n=t.call(this,r),n.createCpuKernel=function(i,s){return function(){for(var o=[],l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];for(var p=0;p<s.height;++p){o.push([]);for(var m=0;m<s.width;++m)o[p][m]=i.apply({thread:{x:m,y:p}},u)}return o}},n.createGpuJsKernel=function(i,s){return n.interpreter.getGpuInstance().createKernel(i).setPrecision("unsigned").setOutput([s.width,s.height])},n.config.gpujs===void 0?n.createKernel=n.createCpuKernel:n.createKernel=n.createGpuJsKernel,n}return hve(e,[{key:"mmult",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("MMULT"),function(o,l){if(!o.hasOnlyNumbers()||!l.hasOnlyNumbers())return new E(V.VALUE,D.NumberRange);if(l.height()!==o.width())return new E(V.VALUE,D.ArrayDimensions);var u=HB(o.size,l.size),c=s.createKernel(function(p,m,f){for(var d=0,h=0;h<f;++h)d+=p[this.thread.y][h]*m[h][this.thread.x];return d},u)(o.rawNumbers(),l.rawNumbers(),o.width());return Q.onlyNumbers(c)})}},{key:"mmultArraySize",value:function(n,i){var s=this;if(n.args.length!==2)return Se.error();var o=this.metadata("MMULT"),l=n.args.map(function(m){var f;return s.arraySizeForAst(m,new Jr(i.formulaAddress,i.arraysFlag||((f=o==null?void 0:o.arrayFunction)!==null&&f!==void 0?f:!1)))}),u=UB(l,2),c=u[0],p=u[1];return HB(c,p)}},{key:"maxpool",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("MAXPOOL"),function(o,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l;if(!o.hasOnlyNumbers())return new E(V.VALUE,D.NumberRange);var c=Sw(o.size,l,u),p=s.createKernel(function(m,f,d){for(var h=this.thread.x*d,y=this.thread.y*d,b=m[y][h],g=0;g<f;g++)for(var v=0;v<f;v++)b=Math.max(b,m[y+g][h+v]);return b},c)(o.rawNumbers(),l,u);return Q.onlyNumbers(p)})}},{key:"medianpool",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("MEDIANPOOL"),function(o,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l;if(!o.hasOnlyNumbers())return new E(V.VALUE,D.NumberRange);var c=Sw(o.size,l,u),p=s.createKernel(function(m,f,d){for(var h=this.thread.x*d,y=this.thread.y*d,b=m[y][h],g=0;g<f;g++)for(var v=0;v<f;v++)b=Math.max(b,m[y+g][h+v]);for(var A=m[y][h],C=0;C<f;C++)for(var S=0;S<f;S++)A=Math.min(A,m[y+C][h+S]);for(var w=f*f,x=A,R=b,O=42,_=0;_<32;_++){for(var k=(x+R)/2,B=0,U=0;U<f;U++)for(var H=0;H<f;H++)m[y+U][h+H]>k&&B++;if(f%2==0)if(B===w/2){O=k;break}else B>w/2?x=k:R=k;else if(B===(w-1)/2){O=k;break}else B>(w-1)/2?x=k:R=k}return O},c)(o.rawNumbers(),l,u);return Q.onlyNumbers(p)})}},{key:"maxpoolArraySize",value:function(n,i){var s=this;if(n.args.length<2||n.args.length>3)return Se.error();var o=this.metadata("MAXPOOL"),l=n.args.map(function(d){var h;return s.arraySizeForAst(d,new Jr(i.formulaAddress,i.arraysFlag||((h=o==null?void 0:o.arrayFunction)!==null&&h!==void 0?h:!1)))}),u=l[0],c=n.args[1],p;c.type===I.NUMBER?p=c.value:p=1;var m=p;if(n.args.length===3){var f=n.args[2];f.type===I.NUMBER?m=f.value:m=1}return p>u.width||p>u.height||m>p||(u.width-p)%m!=0||(u.height-p)%m!=0?Se.error():Sw(u,p,m)}},{key:"medianpoolArraySize",value:function(n,i){return this.maxpoolArraySize(n,i)}},{key:"transpose",value:function(n,i){return this.runFunction(n.args,i,this.metadata("TRANSPOSE"),function(s){for(var o=s.rawData(),l=s.size,u=[],c=0;c<l.width;++c){u[c]=[];for(var p=0;p<l.height;++p)u[c][p]=o[p][c]}return Q.onlyValues(u)})}},{key:"transposeArraySize",value:function(n,i){var s=this;if(n.args.length!==1)return Se.error();var o=this.metadata("MMULT"),l=n.args.map(function(p){var m;return s.arraySizeForAst(p,new Jr(i.formulaAddress,i.arraysFlag||((m=o==null?void 0:o.arrayFunction)!==null&&m!==void 0?m:!1)))}),u=UB(l,1),c=u[0];return new Se(c.height,c.width)}}]),e}(X);ww.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:N.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:N.RANGE},{argumentType:N.NUMBER},{argumentType:N.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:N.RANGE},{argumentType:N.NUMBER},{argumentType:N.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};var Apt=M(q());function Ew(a){return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(a)}function Nve(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function qB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Cve(a,t,e){return t&&qB(a.prototype,t),e&&qB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ave(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Rw(a,t)}function Rw(a,t){return Rw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Rw(a,t)}function Sve(a){var t=Rve();return function(){var r=Bv(a),n;if(t){var i=Bv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return wve(this,n)}}function wve(a,t){if(t&&(Ew(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eve(a)}function Eve(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Rve(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Bv(a){return Bv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bv(a)}var xw=function(a){Ave(e,a);var t=Sve(e);function e(){return Nve(this,e),t.apply(this,arguments)}return Cve(e,[{key:"median",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("MEDIAN"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersExactRanges(l);return c instanceof E?c:c.length===0?new E(V.NUM,D.OneValue):(c.sort(function(p,m){return p-m}),c.length%2==0?(c[c.length/2-1]+c[c.length/2])/2:c[Math.floor(c.length/2)])})}},{key:"large",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("LARGE"),function(o,l){var u=s.arithmeticHelper.manyToExactNumbers(o.valuesFromTopLeftCorner());return u instanceof E?u:(u.sort(function(c,p){return c-p}),l=Math.trunc(l),l>u.length?new E(V.NUM,D.ValueLarge):u[u.length-l])})}},{key:"small",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SMALL"),function(o,l){var u=s.arithmeticHelper.manyToExactNumbers(o.valuesFromTopLeftCorner());return u instanceof E?u:(u.sort(function(c,p){return c-p}),l=Math.trunc(l),l>u.length?new E(V.NUM,D.ValueLarge):u[l-1])})}}]),e}(X);xw.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:N.RANGE},{argumentType:N.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:N.RANGE},{argumentType:N.NUMBER,minValue:1}]}};var Fpt=M(q());function Vw(a){return Vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vw(a)}function xve(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function WB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Vve(a,t,e){return t&&WB(a.prototype,t),e&&WB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ove(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Ow(a,t)}function Ow(a,t){return Ow=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Ow(a,t)}function Dve(a){var t=_ve();return function(){var r=Lv(a),n;if(t){var i=Lv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ive(this,n)}}function Ive(a,t){if(t&&(Vw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pve(a)}function Pve(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _ve(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Lv(a){return Lv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lv(a)}var Dw=function(a){Ove(e,a);var t=Dve(e);function e(){return xve(this,e),t.apply(this,arguments)}return Vve(e,[{key:"mod",value:function(n,i){return this.runFunction(n.args,i,this.metadata("MOD"),function(s,o){return o===0?new E(V.DIV_BY_ZERO):s%o})}}]),e}(X);Dw.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER}]}};var emt=M(ie());var amt=M(q());function Iw(a){return Iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iw(a)}function $B(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=kve(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function kve(a,t){if(!!a){if(typeof a=="string")return KB(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return KB(a,t)}}function KB(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Fve(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Pw(a,t)}function Pw(a,t){return Pw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Pw(a,t)}function jve(a){var t=Lve();return function(){var r=Uv(a),n;if(t){var i=Uv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Mve(this,n)}}function Mve(a,t){if(t&&(Iw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bve(a)}function Bve(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Lve(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Uv(a){return Uv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Uv(a)}function XB(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function YB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function ZB(a,t,e){return t&&YB(a.prototype,t),e&&YB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function zv(a){return Ce(a)&&!Number.isFinite(W(a))?0:a}var Zs=function(){function a(t,e,r){XB(this,a),this.sumsq=t,this.sum=e,this.count=r}return ZB(a,[{key:"compose",value:function(e){return new a(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}},{key:"averageValue",value:function(){if(this.count>0)return this.sum/this.count}},{key:"varSValue",value:function(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}},{key:"varPValue",value:function(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}],[{key:"single",value:function(e){return new a(e*e,e,1)}}]),a}();Zs.empty=new Zs(0,0,0);var Gv=function(a){Fve(e,a);var t=jve(e);function e(){var r;return XB(this,e),r=t.apply(this,arguments),r.addWithEpsilonRaw=function(n,i){return r.arithmeticHelper.addWithEpsilonRaw(n,i)},r}return ZB(e,[{key:"sum",value:function(n,i){return this.doSum(n.args,i)}},{key:"sumsq",value:function(n,i){return this.reduce(n.args,i,0,"SUMSQ",this.addWithEpsilonRaw,function(s){return Math.pow(W(s),2)},tp)}},{key:"max",value:function(n,i){return this.doMax(n.args,i)}},{key:"maxa",value:function(n,i){var s=this.reduce(n.args,i,Number.NEGATIVE_INFINITY,"MAXA",function(o,l){return Math.max(o,l)},W,Hv);return zv(s)}},{key:"min",value:function(n,i){return this.doMin(n.args,i)}},{key:"mina",value:function(n,i){var s=this.reduce(n.args,i,Number.POSITIVE_INFINITY,"MINA",function(o,l){return Math.min(o,l)},W,Hv);return zv(s)}},{key:"count",value:function(n,i){return this.doCount(n.args,i)}},{key:"counta",value:function(n,i){return this.doCounta(n.args,i)}},{key:"average",value:function(n,i){return this.doAverage(n.args,i)}},{key:"averagea",value:function(n,i){var s,o=this.reduce(n.args,i,Zs.empty,"_AGGREGATE_A",function(l,u){return l.compose(u)},function(l){return Zs.single(W(l))},Hv);return o instanceof E?o:(s=o.averageValue())!==null&&s!==void 0?s:new E(V.DIV_BY_ZERO)}},{key:"vars",value:function(n,i){return this.doVarS(n.args,i)}},{key:"varp",value:function(n,i){return this.doVarP(n.args,i)}},{key:"vara",value:function(n,i){var s,o=this.reduceAggregateA(n.args,i);return o instanceof E?o:(s=o.varSValue())!==null&&s!==void 0?s:new E(V.DIV_BY_ZERO)}},{key:"varpa",value:function(n,i){var s,o=this.reduceAggregateA(n.args,i);return o instanceof E?o:(s=o.varPValue())!==null&&s!==void 0?s:new E(V.DIV_BY_ZERO)}},{key:"stdevs",value:function(n,i){return this.doStdevS(n.args,i)}},{key:"stdevp",value:function(n,i){return this.doStdevP(n.args,i)}},{key:"stdeva",value:function(n,i){var s=this.reduceAggregateA(n.args,i);if(s instanceof E)return s;var o=s.varSValue();return o===void 0?new E(V.DIV_BY_ZERO):Math.sqrt(o)}},{key:"stdevpa",value:function(n,i){var s=this.reduceAggregateA(n.args,i);if(s instanceof E)return s;var o=s.varPValue();return o===void 0?new E(V.DIV_BY_ZERO):Math.sqrt(o)}},{key:"product",value:function(n,i){return this.doProduct(n.args,i)}},{key:"subtotal",value:function(n,i){if(n.args.length<2)return new E(V.NA,D.WrongArgNumber);var s=this.coerceToType(this.evaluateAst(n.args[0],i),{argumentType:N.NUMBER},i),o=n.args.slice(1);switch(s){case 1:case 101:return this.doAverage(o,i);case 2:case 102:return this.doCount(o,i);case 3:case 103:return this.doCounta(o,i);case 4:case 104:return this.doMax(o,i);case 5:case 105:return this.doMin(o,i);case 6:case 106:return this.doProduct(o,i);case 7:case 107:return this.doStdevS(o,i);case 8:case 108:return this.doStdevP(o,i);case 9:case 109:return this.doSum(o,i);case 10:case 110:return this.doVarS(o,i);case 11:case 111:return this.doVarP(o,i);default:return new E(V.VALUE,D.BadMode)}}},{key:"reduceAggregate",value:function(n,i){return this.reduce(n,i,Zs.empty,"_AGGREGATE",function(s,o){return s.compose(o)},function(s){return Zs.single(W(s))},tp)}},{key:"reduceAggregateA",value:function(n,i){return this.reduce(n,i,Zs.empty,"_AGGREGATE_A",function(s,o){return s.compose(o)},function(s){return Zs.single(W(s))},Hv)}},{key:"doAverage",value:function(n,i){var s,o=this.reduceAggregate(n,i);return o instanceof E?o:(s=o.averageValue())!==null&&s!==void 0?s:new E(V.DIV_BY_ZERO)}},{key:"doVarS",value:function(n,i){var s,o=this.reduceAggregate(n,i);return o instanceof E?o:(s=o.varSValue())!==null&&s!==void 0?s:new E(V.DIV_BY_ZERO)}},{key:"doVarP",value:function(n,i){var s,o=this.reduceAggregate(n,i);return o instanceof E?o:(s=o.varPValue())!==null&&s!==void 0?s:new E(V.DIV_BY_ZERO)}},{key:"doStdevS",value:function(n,i){var s=this.reduceAggregate(n,i);if(s instanceof E)return s;var o=s.varSValue();return o===void 0?new E(V.DIV_BY_ZERO):Math.sqrt(o)}},{key:"doStdevP",value:function(n,i){var s=this.reduceAggregate(n,i);if(s instanceof E)return s;var o=s.varPValue();return o===void 0?new E(V.DIV_BY_ZERO):Math.sqrt(o)}},{key:"doCount",value:function(n,i){return this.reduce(n,i,0,"COUNT",function(s,o){return s+o},W,function(s){return Ce(s)?1:0})}},{key:"doCounta",value:function(n,i){return this.reduce(n,i,0,"COUNTA",function(s,o){return s+o},W,function(s){return s===le?0:1})}},{key:"doMax",value:function(n,i){var s=this.reduce(n,i,Number.NEGATIVE_INFINITY,"MAX",function(o,l){return Math.max(o,l)},W,tp);return zv(s)}},{key:"doMin",value:function(n,i){var s=this.reduce(n,i,Number.POSITIVE_INFINITY,"MIN",function(o,l){return Math.min(o,l)},W,tp);return zv(s)}},{key:"doSum",value:function(n,i){return this.reduce(n,i,0,"SUM",this.addWithEpsilonRaw,W,tp)}},{key:"doProduct",value:function(n,i){return this.reduce(n,i,1,"PRODUCT",function(s,o){return s*o},W,tp)}},{key:"reduce",value:function(n,i,s,o,l,u,c){var p=this;return n.length<1?new E(V.NA,D.WrongArgNumber):n.reduce(function(m,f){if(m instanceof E)return m;if(f.type===I.CELL_RANGE||f.type===I.COLUMN_RANGE||f.type===I.ROW_RANGE){var d=p.evaluateRange(f,i,s,o,l,u,c);return d instanceof E?d:l(d,m)}var h;if(h=p.evaluateAst(f,i),h instanceof Q){var y=Array.from(h.valuesFromTopLeftCorner()).map(c).filter(function(b){return b!==void 0});return y.map(function(b){return b instanceof E?b:u(b)}).reduce(function(b,g){return b instanceof E?b:g instanceof E?g:l(b,g)},m)}else if(f.type===I.CELL_REFERENCE){if(h=c(h),h===void 0)return m}else if(h=p.coerceScalarToNumberOrError(h),h=c(h),h===void 0)return m;return h instanceof E?h:l(m,u(h))},s)}},{key:"evaluateRange",value:function(n,i,s,o,l,u,c){var p;try{p=oe.fromAst(n,i.formulaAddress)}catch(b){if(b instanceof lc)return new E(V.REF,D.RangeManySheets);throw b}var m=p.start,f=p.end,d=this.dependencyGraph.getRange(m,f);if(d===void 0)throw new Error("Range does not exists in graph");var h=d.getFunctionValue(o);if(h===void 0){var y=this.getRangeValues(o,p,u,c);h=y.reduce(function(b,g){return b instanceof E?b:g instanceof E?g:l(b,g)},s),d.setFunctionValue(o,h)}return h}},{key:"getRangeValues",value:function(n,i,s,o){var l=[],u=this.dependencyGraph.rangeMapping.findSmallerRange(i),c=u.smallerRangeVertex,p=u.restRange,m=this.dependencyGraph.getRange(i.start,i.end),f;if(c!==void 0&&this.dependencyGraph.existsEdge(c,m)){var d=c.getFunctionValue(n);if(d!==void 0)l.push(d);else{var h=$B(c.range.addresses(this.dependencyGraph)),y;try{for(h.s();!(y=h.n()).done;){var b=y.value,g=o(this.dependencyGraph.getScalarValue(b));g instanceof E?l.push(g):g!==void 0&&l.push(s(g))}}catch(w){h.e(w)}finally{h.f()}}f=p}else f=i;var v=$B(f.addresses(this.dependencyGraph)),A;try{for(v.s();!(A=v.n()).done;){var C=A.value,S=o(this.dependencyGraph.getScalarValue(C));S instanceof E?l.push(S):S!==void 0&&l.push(s(S))}}catch(w){v.e(w)}finally{v.f()}return l}}]),e}(X);Gv.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:N.NUMBER},{argumentType:N.ANY}],repeatLastArgs:1}};Gv.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function tp(a){if(Ce(a)||a instanceof E)return a}function Hv(a){return typeof a=="boolean"?pg(a):Ce(a)||a instanceof E?a:typeof a=="string"?0:void 0}var Cmt=M(q());function _w(a){return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(a)}function Uve(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function JB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function zve(a,t,e){return t&&JB(a.prototype,t),e&&JB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Gve(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&kw(a,t)}function kw(a,t){return kw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},kw(a,t)}function Hve(a){var t=$ve();return function(){var r=qv(a),n;if(t){var i=qv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return qve(this,n)}}function qve(a,t){if(t&&(_w(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wve(a)}function Wve(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function $ve(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function qv(a){return qv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qv(a)}var Fw=function(a){Gve(e,a);var t=Hve(e);function e(){return Uve(this,e),t.apply(this,arguments)}return zve(e,[{key:"power",value:function(n,i){return this.runFunction(n.args,i,this.metadata("POWER"),Math.pow)}}]),e}(X);Fw.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER}]}};var Pmt=M(q());function jw(a){return jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jw(a)}function Kve(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function QB(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Xve(a,t,e){return t&&QB(a.prototype,t),e&&QB(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Yve(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Mw(a,t)}function Mw(a,t){return Mw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Mw(a,t)}function Zve(a){var t=e1e();return function(){var r=Wv(a),n;if(t){var i=Wv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Jve(this,n)}}function Jve(a,t){if(t&&(jw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qve(a)}function Qve(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function e1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Wv(a){return Wv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wv(a)}var Bw=function(a){Yve(e,a);var t=Zve(e);function e(){return Kve(this,e),t.apply(this,arguments)}return Xve(e,[{key:"radians",value:function(n,i){return this.runFunction(n.args,i,this.metadata("RADIANS"),function(s){return s*(Math.PI/180)})}}]),e}(X);Bw.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:N.NUMBER}]}};var Bmt=M(ie());var $mt=M(q());function Lw(a){return Lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lw(a)}function t1e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function eL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function r1e(a,t,e){return t&&eL(a.prototype,t),e&&eL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function n1e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Uw(a,t)}function Uw(a,t){return Uw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Uw(a,t)}function a1e(a){var t=o1e();return function(){var r=$v(a),n;if(t){var i=$v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return i1e(this,n)}}function i1e(a,t){if(t&&(Lw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s1e(a)}function s1e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function o1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function $v(a){return $v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$v(a)}var br=10,tL=255,rL=2,nL=36,l1e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",zw=function(a){n1e(e,a);var t=a1e(e);function e(){return t1e(this,e),t.apply(this,arguments)}return r1e(e,[{key:"dec2bin",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DEC2BIN"),function(s,o){return ns(s,2,o)})}},{key:"dec2oct",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DEC2OCT"),function(s,o){return ns(s,8,o)})}},{key:"dec2hex",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DEC2HEX"),function(s,o){return ns(s,16,o)})}},{key:"bin2dec",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BIN2DEC"),function(s){var o=ni(s,2,br);return o===void 0?new E(V.NUM,D.NotBinary):as(o,2)})}},{key:"bin2oct",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BIN2OCT"),function(s,o){var l=ni(s,2,br);return l===void 0?new E(V.NUM,D.NotBinary):ns(as(l,2),8,o)})}},{key:"bin2hex",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BIN2HEX"),function(s,o){var l=ni(s,2,br);return l===void 0?new E(V.NUM,D.NotBinary):ns(as(l,2),16,o)})}},{key:"oct2dec",value:function(n,i){return this.runFunction(n.args,i,this.metadata("OCT2DEC"),function(s){var o=ni(s,8,br);return o===void 0?new E(V.NUM,D.NotOctal):as(o,8)})}},{key:"oct2bin",value:function(n,i){return this.runFunction(n.args,i,this.metadata("OCT2BIN"),function(s,o){var l=ni(s,8,br);return l===void 0?new E(V.NUM,D.NotOctal):ns(as(l,8),2,o)})}},{key:"oct2hex",value:function(n,i){return this.runFunction(n.args,i,this.metadata("OCT2HEX"),function(s,o){var l=ni(s,8,br);return l===void 0?new E(V.NUM,D.NotOctal):ns(as(l,8),16,o)})}},{key:"hex2dec",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HEX2DEC"),function(s){var o=ni(s,16,br);return o===void 0?new E(V.NUM,D.NotHex):as(o,16)})}},{key:"hex2bin",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HEX2BIN"),function(s,o){var l=ni(s,16,br);return l===void 0?new E(V.NUM,D.NotHex):ns(as(l,16),2,o)})}},{key:"hex2oct",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HEX2OCT"),function(s,o){var l=ni(s,16,br);return l===void 0?new E(V.NUM,D.NotHex):ns(as(l,16),8,o)})}},{key:"base",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BASE"),c1e)}},{key:"decimal",value:function(n,i){return this.runFunction(n.args,i,this.metadata("DECIMAL"),function(s,o){var l=ni(s,o,tL);return l===void 0?new E(V.NUM,D.NotHex):parseInt(l,o)})}}]),e}(X);zw.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:N.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,optionalArg:!0,minValue:0,maxValue:br}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,optionalArg:!0,minValue:0,maxValue:br}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:N.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,optionalArg:!0,minValue:0,maxValue:br}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,optionalArg:!0,minValue:0,maxValue:br}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:N.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,optionalArg:!0,minValue:0,maxValue:br}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,optionalArg:!0,minValue:0,maxValue:br}]},DECIMAL:{method:"decimal",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,minValue:rL,maxValue:nL}]},BASE:{method:"base",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:rL,maxValue:nL},{argumentType:N.NUMBER,optionalArg:!0,minValue:0,maxValue:tL}]}};function ni(a,t,e){var r=l1e.substr(0,t),n=new RegExp("^[".concat(r,"]+$"));if(!(a.length>e||!n.test(a)))return a}function ns(a,t,e){if(a>u1e(t))return new E(V.NUM,D.ValueBaseLarge);if(a<aL(t))return new E(V.NUM,D.ValueBaseSmall);var r=iL(a,t);return e===void 0||a<0?r:r.length>e?new E(V.NUM,D.ValueBaseLong):tn(r,e)}function aL(a){return-Math.pow(a,br)/2}function u1e(a){return-aL(a)-1}function c1e(a,t,e){var r=iL(a,t);return e!==void 0&&e>r.length?tn(r,e):r}function iL(a,t){var e=a<0?Math.pow(t,br):0;return(a+e).toString(t).toUpperCase()}function as(a,t){var e=parseInt(a,t),r=Math.pow(t,br);return e>=r/2?e-r:e}var oft=M(q());function Gw(a){return Gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gw(a)}function p1e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function sL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function m1e(a,t,e){return t&&sL(a.prototype,t),e&&sL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function f1e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Hw(a,t)}function Hw(a,t){return Hw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Hw(a,t)}function d1e(a){var t=b1e();return function(){var r=Kv(a),n;if(t){var i=Kv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h1e(this,n)}}function h1e(a,t){if(t&&(Gw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y1e(a)}function y1e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function b1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Kv(a){return Kv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kv(a)}var qw=function(a){f1e(e,a);var t=d1e(e);function e(){return p1e(this,e),t.apply(this,arguments)}return m1e(e,[{key:"rand",value:function(n,i){return this.runFunction(n.args,i,this.metadata("RAND"),Math.random)}},{key:"randbetween",value:function(n,i){return this.runFunction(n.args,i,this.metadata("RANDBETWEEN"),function(s,o){return o<s?new E(V.NUM,D.WrongOrder):(s=Math.ceil(s),o=Math.floor(o)+1,s===o&&(o+=1),s+Math.floor(Math.random()*(o-s)))})}}]),e}(X);qw.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER}],isVolatile:!0}};var Tft=M(q());function Ww(a){return Ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ww(a)}function g1e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function oL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function v1e(a,t,e){return t&&oL(a.prototype,t),e&&oL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function T1e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&$w(a,t)}function $w(a,t){return $w=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},$w(a,t)}function N1e(a){var t=S1e();return function(){var r=Xv(a),n;if(t){var i=Xv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C1e(this,n)}}function C1e(a,t){if(t&&(Ww(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A1e(a)}function A1e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function S1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Xv(a){return Xv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xv(a)}function lL(a){var t=Math.ceil(a);return t%2==1?t:t+1}function uL(a){var t=Math.ceil(a);return t%2==0?t:t+1}var Yv=function(a){T1e(e,a);var t=N1e(e);function e(){return g1e(this,e),t.apply(this,arguments)}return v1e(e,[{key:"roundup",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ROUNDDOWN"),function(s,o){var l=Math.pow(10,o);return s<0?-Math.ceil(-s*l)/l:Math.ceil(s*l)/l})}},{key:"rounddown",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ROUNDDOWN"),function(s,o){var l=Math.pow(10,o);return s<0?-Math.floor(-s*l)/l:Math.floor(s*l)/l})}},{key:"round",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ROUND"),function(s,o){var l=Math.pow(10,o);return s<0?-Math.round(-s*l)/l:Math.round(s*l)/l})}},{key:"intFunc",value:function(n,i){return this.runFunction(n.args,i,this.metadata("INT"),function(s){return s<0?-Math.floor(-s):Math.floor(s)})}},{key:"even",value:function(n,i){return this.runFunction(n.args,i,this.metadata("EVEN"),function(s){return s<0?-uL(-s):uL(s)})}},{key:"odd",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ODD"),function(s){return s<0?-lL(-s):lL(s)})}},{key:"ceilingmath",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CEILING.MATH"),function(s,o,l){return o===0||s===0?0:(o=Math.abs(o),l===1&&s<0&&(o=-o),Math.ceil(s/o)*o)})}},{key:"ceiling",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CEILING"),function(s,o){return s===0?0:o===0?new E(V.DIV_BY_ZERO):s>0&&o<0?new E(V.NUM,D.DistinctSigns):Math.ceil(s/o)*o})}},{key:"ceilingprecise",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CEILING.PRECISE"),function(s,o){return o===0||s===0?0:(o=Math.abs(o),Math.ceil(s/o)*o)})}},{key:"floormath",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FLOOR.MATH"),function(s,o,l){return o===0||s===0?0:(o=Math.abs(o),l===1&&s<0&&(o*=-1),Math.floor(s/o)*o)})}},{key:"floor",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FLOOR"),function(s,o){return s===0?0:o===0?new E(V.DIV_BY_ZERO):s>0&&o<0?new E(V.NUM,D.DistinctSigns):Math.floor(s/o)*o})}},{key:"floorprecise",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FLOOR.PRECISE"),function(s,o){return o===0||s===0?0:(o=Math.abs(o),Math.floor(s/o)*o)})}}]),e}(X);Yv.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:N.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:N.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:N.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:1},{argumentType:N.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:1},{argumentType:N.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,defaultValue:1}]}};Yv.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};var Pft=M(q());function Kw(a){return Kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kw(a)}function w1e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function cL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function E1e(a,t,e){return t&&cL(a.prototype,t),e&&cL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function R1e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Xw(a,t)}function Xw(a,t){return Xw=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Xw(a,t)}function x1e(a){var t=D1e();return function(){var r=Zv(a),n;if(t){var i=Zv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return V1e(this,n)}}function V1e(a,t){if(t&&(Kw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O1e(a)}function O1e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function D1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Zv(a){return Zv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zv(a)}var Yw=function(a){R1e(e,a);var t=x1e(e);function e(){return w1e(this,e),t.apply(this,arguments)}return E1e(e,[{key:"sqrt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SQRT"),Math.sqrt)}}]),e}(X);Yw.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:N.NUMBER}]}};var Ndt=M(q());var Rdt=M(ie());var $ft=M(xr());var tdt=M(q());var ldt=M(ie());var Bft=M(q());var qft=M(xr()),I1e=regeneratorRuntime.mark(pL);function pL(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},I1e)}function mL(a){var t=a[Symbol.iterator](),e=t.next(),r=e.done,n=e.value;return r?{rest:pL()}:{value:n,rest:t}}var P1e=regeneratorRuntime.mark(Zw),_1e=regeneratorRuntime.mark(Jw);function fL(a,t){return j1e(a)||F1e(a,t)||dL(a,t)||k1e()}function k1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F1e(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function j1e(a){if(Array.isArray(a))return a}function Jv(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=dL(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function dL(a,t){if(!!a){if(typeof a=="string")return hL(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return hL(a,t)}}function hL(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function yL(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function bL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function gL(a,t,e){return t&&bL(a.prototype,t),e&&bL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var M1e=function(t,e,r){if(r.end.row>r.start.row){var n=$(r.end.sheet,r.end.col,r.end.row-1),i=t.getRange(r.start,n);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:r.withStart($(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:e.map(function(s){return s.withStart($(s.start.sheet,s.start.col,s.end.row))})}}return{restValuesRange:r,restConditionRanges:e}},rp=function(){function a(t,e,r,n,i){yL(this,a),this.interpreter=t,this.cacheKey=e,this.reduceInitialValue=r,this.composeFunction=n,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}return gL(a,[{key:"compute",value:function(e,r){var n=this,i=Jv(r),s;try{for(i.s();!(s=i.n()).done;){var o=s.value;if(!o.conditionRange.sameDimensionsAs(e))return new E(V.VALUE,D.EqualLength)}}catch(f){i.e(f)}finally{i.f()}var l=this.tryToGetRangeVertexForRangeValue(e),u=r.map(function(f){return n.tryToGetRangeVertexForRangeValue(f.conditionRange)});if(l&&u.every(function(f){return f!==void 0})){var c=r.map(function(f){return f.criterionPackage.raw}).join(","),p=this.findAlreadyComputedValueInCache(l,this.cacheKey(r),c);if(p!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),p;var m=this.buildNewCriterionCache(this.cacheKey(r),r.map(function(f){return f.conditionRange.range}),e.range);return m.has(c)||m.set(c,[this.evaluateRangeValue(e,r),r.map(function(f){return f.criterionPackage.lambda})]),l.setCriterionFunctionValues(this.cacheKey(r),m),u.forEach(function(f){f!==void 0&&f.addDependentCacheRange(l)}),m.get(c)[0]}else return this.evaluateRangeValue(e,r)}},{key:"tryToGetRangeVertexForRangeValue",value:function(e){var r=e.range;if(r!==void 0)return this.dependencyGraph.getRange(r.start,r.end)}},{key:"reduceFunction",value:function(e){var r=this.reduceInitialValue,n=Jv(e),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;r=this.composeFunction(r,s)}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"findAlreadyComputedValueInCache",value:function(e,r,n){return e.getCriterionFunctionValue(r,n)}},{key:"evaluateRangeValue",value:function(e,r){var n=r.map(function(l){return l.criterionPackage.lambda}),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),s=r.map(function(l){return l.conditionRange.iterateValuesFromTopLeftCorner()}),o=Jw(n,s,i);return this.reduceFunction(o)}},{key:"buildNewCriterionCache",value:function(e,r,n){var i=this,s=this.dependencyGraph.getRange(n.start,n.end),o=M1e(this.dependencyGraph,r,n),l=o.smallerRangeVertex,u=o.restConditionRanges,c=o.restValuesRange,p;l!==void 0&&this.dependencyGraph.existsEdge(l,s)?p=l.getCriterionFunctionValues(e):p=new Map;var m=new Map;return p.forEach(function(f,d){var h=fL(f,2),y=h[0],b=h[1],g=Jw(b,u.map(function(A){return Zw(i.dependencyGraph,A)}),Array.from(Zw(i.dependencyGraph,c)).map(i.mapFunction)[Symbol.iterator]()),v=i.composeFunction(y,i.reduceFunction(g));i.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),m.set(d,[v,b])}),m}}]),a}(),np=gL(function a(t,e){yL(this,a),this.conditionRange=t,this.criterionPackage=e});function Zw(a,t){var e,r,n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=Jv(t.addresses(a)),s.prev=1,e.s();case 3:if((r=e.n()).done){s.next=9;break}return n=r.value,s.next=7,W(a.getScalarValue(n));case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),e.e(s.t0);case 14:return s.prev=14,e.f(),s.finish(14);case 17:case"end":return s.stop()}},P1e,null,[[1,11,14,17]])}function Jw(a,t,e){var r,n,i,s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=Jv(e),u.prev=1,r.s();case 3:if((n=r.n()).done){u.next=15;break}if(i=n.value,s=t.map(function(c){return mL(c)}),s.every(function(c){return Object.prototype.hasOwnProperty.call(c,"value")})){u.next=8;break}return u.abrupt("return");case 8:if(o=s.map(function(c){return c.value}),!B1e(o,a).every(function(c){var p=fL(c,2),m=p[0],f=p[1];return f(m)})){u.next=12;break}return u.next=12,i;case 12:t=s.map(function(c){return c.rest});case 13:u.next=3;break;case 15:u.next=20;break;case 17:u.prev=17,u.t0=u.catch(1),r.e(u.t0);case 20:return u.prev=20,r.f(),u.finish(20);case 23:case"end":return u.stop()}},_1e,null,[[1,17,20,23]])}function B1e(a,t){for(var e=[],r=0;r<Math.min(a.length,t.length);r++)e.push([a[r],t[r]]);return e}function Qw(a){return Qw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qw(a)}function L1e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&eE(a,t)}function eE(a,t){return eE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},eE(a,t)}function U1e(a){var t=H1e();return function(){var r=Qv(a),n;if(t){var i=Qv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z1e(this,n)}}function z1e(a,t){if(t&&(Qw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G1e(a)}function G1e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function H1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function Qv(a){return Qv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qv(a)}function tE(a){return K1e(a)||$1e(a)||W1e(a)||q1e()}function q1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W1e(a,t){if(!!a){if(typeof a=="string")return rE(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return rE(a,t)}}function $1e(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function K1e(a){if(Array.isArray(a))return rE(a)}function rE(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function vL(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function TL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function NL(a,t,e){return t&&TL(a.prototype,t),e&&TL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}var bd=function(){function a(t,e){vL(this,a),this.sum=t,this.count=e}return NL(a,[{key:"compose",value:function(e){return new a(this.sum+e.sum,this.count+e.count)}},{key:"averageValue",value:function(){if(this.count>0)return this.sum/this.count}}],[{key:"single",value:function(e){return new a(e,1)}}]),a}();bd.empty=new bd(0,0);function CL(a){var t=a.map(function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)});return["SUMIF"].concat(tE(t)).join(",")}function X1e(a){var t=a.map(function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)});return["AVERAGEIF"].concat(tE(t)).join(",")}function Y1e(a){var t=a.map(function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)});return["COUNTIFS"].concat(tE(t)).join(",")}var nE=function(a){L1e(e,a);var t=U1e(e);function e(){return vL(this,e),t.apply(this,arguments)}return NL(e,[{key:"sumif",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SUMIF"),function(o,l,u){var c=s.interpreter.criterionBuilder.fromCellValue(l,s.arithmeticHelper);return c===void 0?new E(V.VALUE,D.BadCriterion):(u=u??o,new rp(s.interpreter,CL,0,function(p,m){return s.arithmeticHelper.nonstrictadd(p,m)},function(p){return W(p)}).compute(u,[new np(o,c)]))})}},{key:"sumifs",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SUMIFS"),function(o){for(var l=[],u=0;u<(arguments.length<=1?0:arguments.length-1);u+=2){var c=u+1<1||arguments.length<=u+1?void 0:arguments[u+1],p=s.interpreter.criterionBuilder.fromCellValue(u+1+1<1||arguments.length<=u+1+1?void 0:arguments[u+1+1],s.arithmeticHelper);if(p===void 0)return new E(V.VALUE,D.BadCriterion);l.push(new np(c,p))}return new rp(s.interpreter,CL,0,function(m,f){return s.arithmeticHelper.nonstrictadd(m,f)},function(m){return W(m)}).compute(o,l)})}},{key:"averageif",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("AVERAGEIF"),function(o,l,u){var c=s.interpreter.criterionBuilder.fromCellValue(l,s.arithmeticHelper);if(c===void 0)return new E(V.VALUE,D.BadCriterion);u=u??o;var p=new rp(s.interpreter,X1e,bd.empty,function(m,f){return m.compose(f)},function(m){return Ce(m)?bd.single(W(m)):bd.empty}).compute(u,[new np(o,c)]);return p instanceof E?p:p.averageValue()||new E(V.DIV_BY_ZERO)})}},{key:"countif",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("COUNTIF"),function(o,l){var u=s.interpreter.criterionBuilder.fromCellValue(l,s.arithmeticHelper);return u===void 0?new E(V.VALUE,D.BadCriterion):new rp(s.interpreter,function(){return"COUNTIF"},0,function(c,p){return c+p},function(){return 1}).compute(o,[new np(o,u)])})}},{key:"countifs",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("COUNTIFS"),function(){for(var o=[],l=0;l<arguments.length;l+=2){var u=l<0||arguments.length<=l?void 0:arguments[l],c=s.interpreter.criterionBuilder.fromCellValue(l+1<0||arguments.length<=l+1?void 0:arguments[l+1],s.arithmeticHelper);if(c===void 0)return new E(V.VALUE,D.BadCriterion);o.push(new np(u,c))}return new rp(s.interpreter,Y1e,0,function(p,m){return p+m},function(){return 1}).compute(o[0].conditionRange,o)})}}]),e}(X);nE.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:N.RANGE},{argumentType:N.NOERROR},{argumentType:N.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:N.RANGE},{argumentType:N.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:N.RANGE},{argumentType:N.NOERROR},{argumentType:N.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE},{argumentType:N.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:N.RANGE},{argumentType:N.NOERROR}],repeatLastArgs:2}};var Hdt=M(ie());var Kdt=M(q());function aE(a){return aE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aE(a)}function Z1e(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=J1e(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function J1e(a,t){if(!!a){if(typeof a=="string")return AL(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return AL(a,t)}}function AL(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Q1e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function SL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function e0e(a,t,e){return t&&SL(a.prototype,t),e&&SL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function t0e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&iE(a,t)}function iE(a,t){return iE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},iE(a,t)}function r0e(a){var t=i0e();return function(){var r=e1(a),n;if(t){var i=e1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return n0e(this,n)}}function n0e(a,t){if(t&&(aE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a0e(a)}function a0e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function i0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function e1(a){return e1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e1(a)}var sE=function(a){t0e(e,a);var t=r0e(e);function e(){return Q1e(this,e),t.apply(this,arguments)}return e0e(e,[{key:"sumproduct",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SUMPRODUCT"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];for(var c=l[0].width(),p=l[0].height(),m=0,f=l;m<f.length;m++){var d=f[m];if(d.width()!==c||d.height()!==p)return new E(V.VALUE,D.EqualLength)}for(var h=0,y=l.map(function(x){return x.iterateValuesFromTopLeftCorner()}),b=0;b<c*p;b++){var g=1,v=Z1e(y),A;try{for(v.s();!(A=v.n()).done;){var C=A.value,S=C.next().value;if(S instanceof E)return S;var w=s.coerceScalarToNumberOrError(S);Ce(w)?g*=W(w):g=0}}catch(x){v.e(x)}finally{v.f()}h+=g}return h})}}]),e}(X);sE.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:N.RANGE}],repeatLastArgs:1}};var nht=M(ie());var s0e=he(),o0e=kg();s0e({target:"String",proto:!0},{repeat:o0e});var yht=M(q());function oE(a){return oE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oE(a)}function l0e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function wL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function u0e(a,t,e){return t&&wL(a.prototype,t),e&&wL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function c0e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&lE(a,t)}function lE(a,t){return lE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},lE(a,t)}function p0e(a){var t=d0e();return function(){var r=t1(a),n;if(t){var i=t1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m0e(this,n)}}function m0e(a,t){if(t&&(oE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f0e(a)}function f0e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function d0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function t1(a){return t1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t1(a)}var uE=function(a){c0e(e,a);var t=p0e(e);function e(){return l0e(this,e),t.apply(this,arguments)}return u0e(e,[{key:"concatenate",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CONCATENATE"),function(){var s;return(s="").concat.apply(s,arguments)})}},{key:"split",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SPLIT"),function(s,o){var l=s.split(" ");return o>=l.length||o<0?new E(V.VALUE,D.IndexBounds):l[o]})}},{key:"len",value:function(n,i){return this.runFunction(n.args,i,this.metadata("LEN"),function(s){return s.length})}},{key:"lower",value:function(n,i){return this.runFunction(n.args,i,this.metadata("LOWER"),function(s){return s.toLowerCase()})}},{key:"trim",value:function(n,i){return this.runFunction(n.args,i,this.metadata("TRIM"),function(s){return s.replace(/^ +| +$/g,"").replace(/ +/g," ")})}},{key:"proper",value:function(n,i){return this.runFunction(n.args,i,this.metadata("PROPER"),function(s){return s.replace(/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])+/g,function(o){return o.charAt(0).toUpperCase()+o.substring(1).toLowerCase()})})}},{key:"clean",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CLEAN"),function(s){return s.replace(/[\u0000-\u001F]/g,"")})}},{key:"exact",value:function(n,i){return this.runFunction(n.args,i,this.metadata("EXACT"),function(s,o){return s===o})}},{key:"rept",value:function(n,i){return this.runFunction(n.args,i,this.metadata("REPT"),function(s,o){return o<0?new E(V.VALUE,D.NegativeCount):s.repeat(o)})}},{key:"right",value:function(n,i){return this.runFunction(n.args,i,this.metadata("RIGHT"),function(s,o){return o<0?new E(V.VALUE,D.NegativeLength):o===0?"":s.slice(-o)})}},{key:"left",value:function(n,i){return this.runFunction(n.args,i,this.metadata("LEFT"),function(s,o){return o<0?new E(V.VALUE,D.NegativeLength):s.slice(0,o)})}},{key:"mid",value:function(n,i){return this.runFunction(n.args,i,this.metadata("MID"),function(s,o,l){return o<1?new E(V.VALUE,D.LessThanOne):l<0?new E(V.VALUE,D.NegativeLength):s.substring(o-1,o+l-1)})}},{key:"replace",value:function(n,i){return this.runFunction(n.args,i,this.metadata("REPLACE"),function(s,o,l,u){return o<1?new E(V.VALUE,D.LessThanOne):l<0?new E(V.VALUE,D.NegativeLength):s.substring(0,o-1)+u+s.substring(o+l-1)})}},{key:"search",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SEARCH"),function(o,l,u){if(u<1||u>l.length)return new E(V.VALUE,D.LengthBounds);var c=l.substring(u-1).toLowerCase(),p;return s.arithmeticHelper.requiresRegex(o)?p=s.arithmeticHelper.searchString(o,c):p=c.indexOf(o.toLowerCase()),p=p+u,p>0?p:new E(V.VALUE,D.PatternNotFound)})}},{key:"substitute",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SUBSTITUTE"),function(s,o,l,u){var c=new RegExp(o,"g");if(u===void 0)return s.replace(c,l);if(u<1)return new E(V.VALUE,D.LessThanOne);for(var p,m=0;(p=c.exec(s))!==null;)if(u===++m)return s.substring(0,p.index)+l+s.substring(c.lastIndex);return s})}},{key:"find",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FIND"),function(s,o,l){if(l<1||l>o.length)return new E(V.VALUE,D.IndexBounds);var u=o.substring(l-1),c=u.indexOf(s)+l;return c>0?c:new E(V.VALUE,D.PatternNotFound)})}},{key:"t",value:function(n,i){return this.runFunction(n.args,i,this.metadata("T"),function(s){return s instanceof E||typeof s=="string"?s:""})}},{key:"upper",value:function(n,i){return this.runFunction(n.args,i,this.metadata("UPPER"),function(s){return s.toUpperCase()})}}]),e}(X);uE.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:N.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:N.STRING},{argumentType:N.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:N.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:N.STRING}]},MID:{method:"mid",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER},{argumentType:N.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:N.STRING}]},T:{method:"t",parameters:[{argumentType:N.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:N.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:N.STRING}]},REPT:{method:"rept",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:N.STRING},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:N.STRING},{argumentType:N.STRING},{argumentType:N.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:N.STRING},{argumentType:N.STRING},{argumentType:N.STRING},{argumentType:N.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:N.STRING},{argumentType:N.STRING},{argumentType:N.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:N.STRING}]}};var y0e=he(),b0e=De(),RL=r1(),g0e=Math.abs,xL=Math.exp,v0e=Math.E,T0e=b0e(function(){return Math.sinh(-2e-17)!=-2e-17});y0e({target:"Math",stat:!0,forced:T0e},{sinh:function(t){return g0e(t=+t)<1?(RL(t)-RL(-t))/2:(xL(t-1)-xL(-t-1))*(v0e/2)}});var N0e=he(),VL=Math.asinh,C0e=Math.log,A0e=Math.sqrt;function OL(a){return!isFinite(a=+a)||a==0?a:a<0?-OL(-a):C0e(a+A0e(a*a+1))}N0e({target:"Math",stat:!0,forced:!(VL&&1/VL(0)>0)},{asinh:OL});var S0e=he(),w0e=r1(),DL=Math.cosh,E0e=Math.abs,cE=Math.E;S0e({target:"Math",stat:!0,forced:!DL||DL(710)===1/0},{cosh:function(t){var e=w0e(E0e(t)-1)+1;return(e+1/(e*cE*cE))*(cE/2)}});var x0e=he(),V0e=PL(),pE=Math.acosh,O0e=Math.log,_L=Math.sqrt,D0e=Math.LN2,I0e=!pE||Math.floor(pE(Number.MAX_VALUE))!=710||pE(1/0)!=1/0;x0e({target:"Math",stat:!0,forced:I0e},{acosh:function(t){return(t=+t)<1?NaN:t>9490626562425156e-8?O0e(t)+D0e:V0e(t-1+_L(t-1)*_L(t+1))}});var P0e=he(),kL=r1(),FL=Math.exp;P0e({target:"Math",stat:!0},{tanh:function(t){var e=kL(t=+t),r=kL(-t);return e==1/0?1:r==1/0?-1:(e-r)/(FL(t)+FL(-t))}});var _0e=he(),jL=Math.atanh,k0e=Math.log;_0e({target:"Math",stat:!0,forced:!(jL&&1/jL(-0)<0)},{atanh:function(t){return(t=+t)==0?t:k0e((1+t)/(1-t))/2}});var Ght=M(q());function mE(a){return mE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mE(a)}function F0e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function ML(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function j0e(a,t,e){return t&&ML(a.prototype,t),e&&ML(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function M0e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&fE(a,t)}function fE(a,t){return fE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},fE(a,t)}function B0e(a){var t=z0e();return function(){var r=n1(a),n;if(t){var i=n1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return L0e(this,n)}}function L0e(a,t){if(t&&(mE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U0e(a)}function U0e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function z0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function n1(a){return n1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n1(a)}var dE=function(a){M0e(e,a);var t=B0e(e);function e(){return F0e(this,e),t.apply(this,arguments)}return j0e(e,[{key:"acos",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ACOS"),Math.acos)}},{key:"asin",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ASIN"),Math.asin)}},{key:"cos",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COS"),Math.cos)}},{key:"sin",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SIN"),Math.sin)}},{key:"tan",value:function(n,i){return this.runFunction(n.args,i,this.metadata("TAN"),Math.tan)}},{key:"atan",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ATAN"),Math.atan)}},{key:"atan2",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ATAN2"),function(s,o){return s===0&&o===0?new E(V.DIV_BY_ZERO):Math.atan2(o,s)})}},{key:"cot",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COT"),function(s){return s===0?new E(V.DIV_BY_ZERO):1/Math.tan(s)})}},{key:"acot",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ACOT"),function(s){return s===0?jv/2:Math.atan(1/s)})}},{key:"sec",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SEC"),function(s){return 1/Math.cos(s)})}},{key:"csc",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CSC"),function(s){return s===0?new E(V.DIV_BY_ZERO):1/Math.sin(s)})}},{key:"sinh",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SINH"),Math.sinh)}},{key:"asinh",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ASINH"),Math.asinh)}},{key:"cosh",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COSH"),Math.cosh)}},{key:"acosh",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ACOSH"),Math.acosh)}},{key:"tanh",value:function(n,i){return this.runFunction(n.args,i,this.metadata("TANH"),Math.tanh)}},{key:"atanh",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ATANH"),Math.atanh)}},{key:"coth",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COTH"),function(s){return s===0?new E(V.DIV_BY_ZERO):1/Math.tanh(s)})}},{key:"acoth",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ACOTH"),function(s){return s===0?new E(V.NUM,D.NonZero):Math.atanh(1/s)})}},{key:"sech",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SECH"),function(s){return 1/Math.cosh(s)})}},{key:"csch",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CSCH"),function(s){return s===0?new E(V.DIV_BY_ZERO):1/Math.sinh(s)})}}]),e}(X);dE.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:N.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:N.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:N.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:N.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:N.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:N.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:N.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:N.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:N.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:N.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:N.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:N.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:N.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:N.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:N.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:N.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:N.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:N.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:N.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:N.NUMBER}]}};var Nyt=M(q());var iyt=M(q());function hE(a){return hE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hE(a)}function G0e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function BL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function H0e(a,t,e){return t&&BL(a.prototype,t),e&&BL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function q0e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&yE(a,t)}function yE(a,t){return yE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},yE(a,t)}function W0e(a){var t=X0e();return function(){var r=a1(a),n;if(t){var i=a1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $0e(this,n)}}function $0e(a,t){if(t&&(hE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K0e(a)}function K0e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function X0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function a1(a){return a1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a1(a)}var LL=function(a){q0e(e,a);var t=W0e(e);function e(r,n){var i;return G0e(this,e),i=t.call(this,n),i.config=r,i.dependencyGraph=n,i}return H0e(e,[{key:"find",value:function(n,i,s){typeof n=="string"&&(n=va(n));var o=i.range;return o===void 0?i.valuesFromTopLeftCorner().map(W).indexOf(n):s?lv(o,n,this.dependencyGraph,"col"):this.dependencyGraph.computeListOfValuesInRange(o).findIndex(function(l){return l=W(l),l=typeof l=="string"?va(l):l,l===n})}}]),e}(uv);function bE(a){return bE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bE(a)}function Y0e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function UL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Z0e(a,t,e){return t&&UL(a.prototype,t),e&&UL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function J0e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&gE(a,t)}function gE(a,t){return gE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},gE(a,t)}function Q0e(a){var t=r2e();return function(){var r=i1(a),n;if(t){var i=i1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return e2e(this,n)}}function e2e(a,t){if(t&&(bE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t2e(a)}function t2e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function r2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function i1(a){return i1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i1(a)}var vE=function(a){J0e(e,a);var t=Q0e(e);function e(){var r;return Y0e(this,e),r=t.apply(this,arguments),r.rowSearch=new LL(r.config,r.dependencyGraph),r}return Z0e(e,[{key:"vlookup",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("VLOOKUP"),function(o,l,u,c){var p=l.range;return p===void 0?new E(V.VALUE,D.WrongType):u<1?new E(V.VALUE,D.LessThanOne):u>p.width()?new E(V.REF,D.IndexLarge):s.doVlookup(fg(o),l,u-1,c)})}},{key:"hlookup",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("HLOOKUP"),function(o,l,u,c){var p=l.range;return p===void 0?new E(V.VALUE,D.WrongType):u<1?new E(V.VALUE,D.LessThanOne):u>p.height()?new E(V.REF,D.IndexLarge):s.doHlookup(fg(o),l,u-1,c)})}},{key:"match",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("MATCH"),function(o,l,u){return s.doMatch(fg(o),l,u)})}},{key:"searchInRange",value:function(n,i,s,o){return!s&&typeof n=="string"&&this.arithmeticHelper.requiresRegex(n)?o.advancedFind(this.arithmeticHelper.eqMatcherFunction(n),i):o.find(n,i,s)}},{key:"doVlookup",value:function(n,i,s,o){this.dependencyGraph.stats.start(ue.VLOOKUP);var l=i.range,u;l===void 0?u=Q.onlyValues(i.data.map(function(f){return[f[0]]})):u=Q.onlyRange(oe.spanFrom(l.start,1,l.height()),this.dependencyGraph);var c=this.searchInRange(n,u,o,this.columnSearch);if(this.dependencyGraph.stats.end(ue.VLOOKUP),c===-1)return new E(V.NA,D.ValueNotFound);var p;if(l===void 0)p=i.data[c][s];else{var m=$(l.sheet,l.start.col+s,l.start.row+c);p=this.dependencyGraph.getCellValue(m)}return p instanceof Q?new E(V.VALUE,D.WrongType):p}},{key:"doHlookup",value:function(n,i,s,o){var l=i.range,u;l===void 0?u=Q.onlyValues([i.data[0]]):u=Q.onlyRange(oe.spanFrom(l.start,l.width(),1),this.dependencyGraph);var c=this.searchInRange(n,u,o,this.rowSearch);if(c===-1)return new E(V.NA,D.ValueNotFound);var p;if(l===void 0)p=i.data[s][c];else{var m=$(l.sheet,l.start.col+c,l.start.row+s);p=this.dependencyGraph.getCellValue(m)}return p instanceof Q?new E(V.VALUE,D.WrongType):p}},{key:"doMatch",value:function(n,i,s){if(i.width()>1&&i.height()>1)return new E(V.NA);if(i.width()===1){var o=this.columnSearch.find(n,i,s!==0);return o===-1?new E(V.NA,D.ValueNotFound):o+1}else{var l=this.rowSearch.find(n,i,s!==0);return l===-1?new E(V.NA,D.ValueNotFound):l+1}}}]),e}(X);vE.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:N.NOERROR},{argumentType:N.RANGE},{argumentType:N.NUMBER},{argumentType:N.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:N.NOERROR},{argumentType:N.RANGE},{argumentType:N.NUMBER},{argumentType:N.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:N.NOERROR},{argumentType:N.RANGE},{argumentType:N.NUMBER,defaultValue:1}]}};var Hyt=M(q());function TE(a){return TE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TE(a)}function n2e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function zL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function a2e(a,t,e){return t&&zL(a.prototype,t),e&&zL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function i2e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&NE(a,t)}function NE(a,t){return NE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},NE(a,t)}function s2e(a){var t=u2e();return function(){var r=s1(a),n;if(t){var i=s1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o2e(this,n)}}function o2e(a,t){if(t&&(TE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l2e(a)}function l2e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function u2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function s1(a){return s1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s1(a)}var CE=function(a){i2e(e,a);var t=s2e(e);function e(){return n2e(this,e),t.apply(this,arguments)}return a2e(e,[{key:"roman",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("ROMAN"),function(o,l){return o=Math.trunc(o),l===!1?l=4:l===!0&&(l=0),l=W(s.coerceScalarToNumberOrError(l)),l instanceof E?l:(l=Math.trunc(l),l<0?new E(V.VALUE,D.ValueSmall):l>4?new E(V.VALUE,D.ValueLarge):c2e(o,l))})}},{key:"arabic",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ARABIC"),function(s){s=s.trim().toUpperCase();var o=!1;if(s.startsWith("-")&&(s=s.slice(1),o=!0,s===""))return new E(V.VALUE,D.InvalidRoman);var l={input:s,acc:0};return ai(l,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),ai(l,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),ai(l,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),ai(l,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),ai(l,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),ai(l,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),ai(l,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),ai(l,{token:"IX",val:9}),ai(l,{token:"V",val:5},{token:"IV",val:4}),ai(l,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),l.input!==""?new E(V.VALUE,D.InvalidRoman):o?-l.acc:l.acc})}}]),e}(X);CE.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:N.NUMBER,minValue:1,lessThan:4e3},{argumentType:N.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:N.STRING}]}};function ai(a){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];for(var n=0,i=e;n<i.length;n++){var s=i[n];if(a.input.startsWith(s.token)){a.input=a.input.slice(s.token.length),a.acc+=s.val;break}}}function c2e(a,t){var e={val:a%1e3,acc:"M".repeat(Math.floor(a/1e3))};return t===4&&(Gt(e,"IM",999,1e3),Gt(e,"ID",499,500)),t>=3&&(Gt(e,"VM",995,1e3),Gt(e,"VD",495,500)),t>=2&&(Gt(e,"XM",990,1e3),Gt(e,"XD",490,500)),t>=1&&(Gt(e,"LM",950,1e3),Gt(e,"LD",450,500)),Gt(e,"CM",900,1e3),Gt(e,"CD",400,500),Gt(e,"D",500,900),e.acc+="C".repeat(Math.floor(e.val/100)),e.val%=100,t>=2&&(Gt(e,"IC",99,100),Gt(e,"IL",49,50)),t>=1&&(Gt(e,"VC",95,100),Gt(e,"VL",45,50)),Gt(e,"XC",90,100),Gt(e,"XL",40,50),Gt(e,"L",50,90),e.acc+="X".repeat(Math.floor(e.val/10)),e.val%=10,Gt(e,"IX",9,10),Gt(e,"IV",4,5),Gt(e,"V",5,9),e.acc+="I".repeat(e.val),e.acc}function Gt(a,t,e,r){a.val>=e&&a.val<r&&(a.val-=e,a.acc+=t)}var ibt=M(q());function AE(a){return AE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AE(a)}function p2e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function GL(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function m2e(a,t,e){return t&&GL(a.prototype,t),e&&GL(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function f2e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&SE(a,t)}function SE(a,t){return SE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},SE(a,t)}function d2e(a){var t=b2e();return function(){var r=o1(a),n;if(t){var i=o1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h2e(this,n)}}function h2e(a,t){if(t&&(AE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y2e(a)}function y2e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function b2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function o1(a){return o1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o1(a)}var wE=function(a){f2e(e,a);var t=d2e(e);function e(){return p2e(this,e),t.apply(this,arguments)}return m2e(e,[{key:"add",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}},{key:"concat",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}},{key:"divide",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}},{key:"eq",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}},{key:"gt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.GT"),this.arithmeticHelper.gt)}},{key:"gte",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}},{key:"lt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.LT"),this.arithmeticHelper.lt)}},{key:"lte",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}},{key:"minus",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}},{key:"multiply",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}},{key:"ne",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.NE"),this.arithmeticHelper.neq)}},{key:"pow",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.POW"),this.arithmeticHelper.pow)}},{key:"uminus",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}},{key:"upercent",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}},{key:"uplus",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}]),e}(X);wE.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:N.NUMBER,passSubtype:!0},{argumentType:N.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:N.STRING,passSubtype:!0},{argumentType:N.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:N.NUMBER,passSubtype:!0},{argumentType:N.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:N.NOERROR,passSubtype:!0},{argumentType:N.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:N.NOERROR,passSubtype:!0},{argumentType:N.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:N.NOERROR,passSubtype:!0},{argumentType:N.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:N.NOERROR,passSubtype:!0},{argumentType:N.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:N.NOERROR,passSubtype:!0},{argumentType:N.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:N.NUMBER,passSubtype:!0},{argumentType:N.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:N.NUMBER,passSubtype:!0},{argumentType:N.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:N.NOERROR,passSubtype:!0},{argumentType:N.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:N.NUMBER,passSubtype:!0},{argumentType:N.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:N.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:N.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:N.NUMBER,passSubtype:!0}]}};var Nbt=M(q());var we=Math;function vt(a,t){for(var e=0,r=0;e<a.length;++e)r=t*r+a[e];return r}function HL(a,t,e,r,n){if(t===0)return e;if(t===1)return r;for(var i=2/a,s=r,o=1;o<t;++o)s=r*o*i+n*e,e=r,r=s;return s}function qL(a,t,e,r,n){return function(s,o){if(r){if(s===0)return r==1?-1/0:1/0;if(s<0)return NaN}if(o===0)return a(s);if(o===1)return t(s);if(o<0)return NaN;o|=0;var l=a(s),u=t(s);return HL(s,o,l,u,n)}}var l1=function(){var a=.636619772,t=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),e=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),n=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function i(p){var m=0,f=0,d=0,h=p*p;if(p<8)f=vt(t,h),d=vt(e,h),m=f/d;else{var y=p-.785398164;h=64/h,f=vt(r,h),d=vt(n,h),m=we.sqrt(a/p)*(we.cos(y)*f-we.sin(y)*d*8/p)}return m}var s=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),o=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(p){var m=0,f=0,d=0,h=p*p,y=we.abs(p)-2.356194491;return Math.abs(p)<8?(f=p*vt(s,h),d=vt(o,h),m=f/d):(h=64/h,f=vt(l,h),d=vt(u,h),m=we.sqrt(a/we.abs(p))*(we.cos(y)*f-we.sin(y)*d*8/we.abs(p)),p<0&&(m=-m)),m}return function p(m,f){if(f=Math.round(f),!isFinite(m))return isNaN(m)?m:0;if(f<0)return(f%2?-1:1)*p(m,-f);if(m<0)return(f%2?-1:1)*p(-m,f);if(f===0)return i(m);if(f===1)return c(m);if(m===0)return 0;var d=0;if(m>f)d=HL(m,f,i(m),c(m),-1);else{for(var h=2*we.floor((f+we.floor(we.sqrt(40*f)))/2),y=!1,b=0,g=0,v=1,A=0,C=2/m,S=h;S>0;S--)A=S*C*v-b,b=v,v=A,we.abs(v)>1e10&&(v*=1e-10,b*=1e-10,d*=1e-10,g*=1e-10),y&&(g+=v),y=!y,S==f&&(d=b);g=2*g-v,d/=g}return d}}(),WL=function(){var a=.636619772,t=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),e=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),n=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function i(p){var m=0,f=0,d=0,h=p*p,y=p-.785398164;return p<8?(f=vt(t,h),d=vt(e,h),m=f/d+a*l1(p,0)*we.log(p)):(h=64/h,f=vt(r,h),d=vt(n,h),m=we.sqrt(a/p)*(we.sin(y)*f+we.cos(y)*d*8/p)),m}var s=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),o=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(p){var m=0,f=0,d=0,h=p*p,y=p-2.356194491;return p<8?(f=p*vt(s,h),d=vt(o,h),m=f/d+a*(l1(p,1)*we.log(p)-1/p)):(h=64/h,f=vt(l,h),d=vt(u,h),m=we.sqrt(a/p)*(we.sin(y)*f+we.cos(y)*d*8/p)),m}return qL(i,c,"BESSELY",1,-1)}(),u1=function(){var a=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),t=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function e(s){return s<=3.75?vt(a,s*s/(3.75*3.75)):we.exp(we.abs(s))/we.sqrt(we.abs(s))*vt(t,3.75/we.abs(s))}var r=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),n=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function i(s){return s<3.75?s*vt(r,s*s/(3.75*3.75)):(s<0?-1:1)*we.exp(we.abs(s))/we.sqrt(we.abs(s))*vt(n,3.75/we.abs(s))}return function s(o,l){if(l=Math.round(l),l===0)return e(o);if(l===1)return i(o);if(l<0)return NaN;if(we.abs(o)===0)return 0;if(o==1/0)return 1/0;var u=0,c,p=2/we.abs(o),m=0,f=1,d=0,h=2*we.round((l+we.round(we.sqrt(40*l)))/2);for(c=h;c>0;c--)d=c*p*f+m,m=f,f=d,we.abs(f)>1e10&&(f*=1e-10,m*=1e-10,u*=1e-10),c==l&&(u=m);return u*=s(o,0)/f,o<0&&l%2?-u:u}}(),$L=function(){var a=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function e(s){return s<=2?-we.log(s/2)*u1(s,0)+vt(a,s*s/4):we.exp(-s)/we.sqrt(s)*vt(t,2/s)}var r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),n=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function i(s){return s<=2?we.log(s/2)*u1(s,1)+1/s*vt(r,s*s/4):we.exp(-s)/we.sqrt(s)*vt(n,2/s)}return qL(e,i,"BESSELK",2,1)}();function dl(a){var t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],e=t.length-1,r=!1,n=0,i=0,s,o,l,u;if(a===0)return 0;for(a<0&&(a=-a,r=!0),s=2/(2+a),o=4*s-2;e>0;e--)l=n,n=o*n-i+t[e],i=l;return u=s*Math.exp(-a*a+.5*(t[0]+o*n)-i),r?u-1:1-u}function EE(a){return 1-dl(a)}function KL(a){var t=0,e,r,n,i;if(a>=2)return-100;if(a<=0)return 100;for(i=a<1?a:2-a,n=Math.sqrt(-2*Math.log(i/2)),e=-.70711*((2.30753+n*.27061)/(1+n*(.99229+n*.04481))-n);t<2;t++)r=EE(e)-i,e+=r/(1.1283791670955126*Math.exp(-e*e)-e*r);return a<1?e:-e}var RE={pdf:function(t,e){return t<0?0:e*Math.exp(-e*t)},cdf:function(t,e){return t<0?0:1-Math.exp(-e*t)}};function ap(a){var t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],e=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],r=!1,n=0,i=0,s=0,o=a,l,u,c,p;if(a>171.6243769536076)return 1/0;if(o<=0)if(p=o%1,p)r=(o&1?-1:1)*Math.PI/Math.sin(Math.PI*p),o=1-o;else return 1/0;for(c=o,o<1?u=o++:u=(o-=n=(o|0)-1)-1,l=0;l<8;++l)s=(s+t[l])*u,i=i*u+e[l];if(p=s/i+1,c<o)p/=c;else if(c>o)for(l=0;l<n;++l)p*=o,o++;return r&&(p=r/p),p}var c1={pdf:function(t,e,r){return t<0?0:t===0&&e===1?1/r:Math.exp((e-1)*Math.log(t)-t/r-pr(e)-e*Math.log(r))},cdf:function(t,e,r){return t<0?0:xE(e,t/r)},inv:function(t,e,r){return XL(t,e)*r}};function pr(a){var t=0,e=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,n,i,s;for(s=(i=n=a)+5.5,s-=(n+.5)*Math.log(s);t<6;t++)r+=e[t]/++i;return Math.log(2.5066282746310007*r/n)-s}function xE(a,t){var e=pr(a),r=a,n=1/a,i=n,s=t+1-a,o=1/1e-30,l=1/s,u=l,c=1,p=-~(Math.log(a>=1?a:1/a)*8.5+a*.4+17),m;if(t<0||a<=0)return NaN;if(t<a+1){for(;c<=p;c++)n+=i*=t/++r;return n*Math.exp(-t+a*Math.log(t)-e)}for(;c<=p;c++)m=-c*(c-a),s+=2,l=m*l+s,o=s+m/o,l=1/l,u*=l*o;return 1-u*Math.exp(-t+a*Math.log(t)-e)}function XL(a,t){var e=0,r=t-1,n=1e-8,i=pr(t),s,o,l,u,c,p,m;if(a>=1)return Math.max(100,t+100*Math.sqrt(t));if(a<=0)return 0;for(t>1?(p=Math.log(r),m=Math.exp(r*(p-1)-i),c=a<.5?a:1-a,l=Math.sqrt(-2*Math.log(c)),s=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,a<.5&&(s=-s),s=Math.max(.001,t*Math.pow(1-1/(9*t)-s/(3*Math.sqrt(t)),3))):(l=1-t*(.253+t*.12),a<l?s=Math.pow(a/l,1/t):s=1-Math.log(1-(a-l)/(1-l)));e<12;e++){if(s<=0)return 0;if(o=xE(t,s)-a,t>1?l=m*Math.exp(-(s-r)+r*(Math.log(s)-p)):l=Math.exp(-s+r*Math.log(s)-i),u=o/l,s-=l=u/(1-.5*Math.min(1,u*((t-1)/s-1))),s<=0&&(s=.5*(s+l)),Math.abs(l)<n*s)break}return s}var _n={pdf:function(t,e,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(t-e,2)/(2*r*r))},cdf:function(t,e,r){return .5*(1+dl((t-e)/Math.sqrt(2*r*r)))},inv:function(t,e,r){return-1.4142135623730951*r*KL(2*t)+e}},p1={pdf:function(t,e,r){return t>1||t<0?0:e==1&&r==1?1:e<512&&r<512?Math.pow(t,e-1)*Math.pow(1-t,r-1)/VE(e,r):Math.exp((e-1)*Math.log(t)+(r-1)*Math.log(1-t)-YL(e,r))},cdf:function(t,e,r){return t>1||t<0?+(t>1):m1(t,e,r)},inv:function(t,e,r){return OE(t,e,r)}};function VE(a,t){if(!(a<=0||t<=0))return a+t>170?Math.exp(YL(a,t)):ap(a)*ap(t)/ap(a+t)}function YL(a,t){return pr(a)+pr(t)-pr(a+t)}function OE(a,t,e){var r=1e-8,n=t-1,i=e-1,s=0,o,l,u,c,p,m,f,d,h,y,b;if(a<=0)return 0;if(a>=1)return 1;for(t>=1&&e>=1?(u=a<.5?a:1-a,c=Math.sqrt(-2*Math.log(u)),f=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,a<.5&&(f=-f),d=(f*f-3)/6,h=2/(1/(2*t-1)+1/(2*e-1)),y=f*Math.sqrt(d+h)/h-(1/(2*e-1)-1/(2*t-1))*(d+5/6-2/(3*h)),f=t/(t+e*Math.exp(2*y))):(o=Math.log(t/(t+e)),l=Math.log(e/(t+e)),c=Math.exp(t*o)/t,p=Math.exp(e*l)/e,y=c+p,a<c/y?f=Math.pow(t*y*a,1/t):f=1-Math.pow(e*y*(1-a),1/e)),b=-pr(t)-pr(e)+pr(t+e);s<10;s++){if(f===0||f===1)return f;if(m=m1(f,t,e)-a,c=Math.exp(n*Math.log(f)+i*Math.log(1-f)+b),p=m/c,f-=c=p/(1-.5*Math.min(1,p*(n/f-i/(1-f)))),f<=0&&(f=.5*(f+c)),f>=1&&(f=.5*(f+c+1)),Math.abs(c)<r*f&&s>0)break}return f}function m1(a,t,e){var r=a===0||a===1?0:Math.exp(pr(t+e)-pr(t)-pr(e)+t*Math.log(a)+e*Math.log(1-a));return a<0||a>1?!1:a<(t+1)/(t+e+2)?r*ZL(a,t,e)/t:1-r*ZL(1-a,e,t)/e}function ZL(a,t,e){var r=1e-30,n=1,i=t+e,s=t+1,o=t-1,l=1,u=1-i*a/s,c,p,m,f;for(Math.abs(u)<r&&(u=r),u=1/u,f=u;n<=100&&(c=2*n,p=n*(e-n)*a/((o+c)*(t+c)),u=1+p*u,Math.abs(u)<r&&(u=r),l=1+p/l,Math.abs(l)<r&&(l=r),u=1/u,f*=u*l,p=-(t+n)*(i+n)*a/((t+c)*(s+c)),u=1+p*u,Math.abs(u)<r&&(u=r),l=1+p/l,Math.abs(l)<r&&(l=r),u=1/u,m=u*l,f*=m,!(Math.abs(m-1)<3e-7));n++);return f}var vd={pdf:function(t,e,r){return r===0||r===1?e*r===t?1:0:QL(e,t)*Math.pow(r,t)*Math.pow(1-r,e-t)},cdf:function(t,e,r){var n,i=1e-10;if(t<0)return 0;if(t>=e)return 1;if(r<0||r>1||e<=0)return NaN;t=Math.floor(t);var s=r,o=t+1,l=e-t,u=o+l,c=Math.exp(pr(u)-pr(l)-pr(o)+o*Math.log(s)+l*Math.log(1-s));return s<(o+1)/(u+2)?n=c*JL(s,o,l,i):n=1-c*JL(1-s,l,o,i),Math.round((1-n)*(1/i))/(1/i)}};function JL(a,t,e,r){for(var n=0,i=1,s=1,o=1,l=0,u=0,c;Math.abs((s-u)/s)>r;)u=s,c=-(t+l)*(t+e+l)*a/(t+2*l)/(t+2*l+1),n=s+c*n,i=o+c*i,l=l+1,c=l*(e-l)*a/(t+2*l-1)/(t+2*l),s=n+c*s,o=i+c*o,n=n/o,i=i/o,s=s/o,o=1;return s/t}function QL(a,t){return a>170||t>170?Math.exp(g2e(a,t)):f1(a)/f1(t)/f1(a-t)}function g2e(a,t){return DE(a)-DE(t)-DE(a-t)}function DE(a){return a<0?NaN:pr(a+1)}function f1(a){return a<0?NaN:ap(a+1)}var Js={pdf:function(t,e){return t<0?0:t===0&&e===2?.5:Math.exp((e/2-1)*Math.log(t)-t/2-e/2*Math.log(2)-pr(e/2))},cdf:function(t,e){return t<0?0:xE(e/2,t/2)},inv:function(t,e){return 2*XL(t,.5*e)}},Qs={pdf:function(t,e,r){var n,i,s;return t<0?0:e<=2?t===0&&e<2?1/0:t===0&&e===2?1:1/VE(e/2,r/2)*Math.pow(e/r,e/2)*Math.pow(t,e/2-1)*Math.pow(1+e/r*t,-(e+r)/2):(n=e*t/(r+t*e),i=r/(r+t*e),s=e*i/2,s*vd.pdf((e-2)/2,(e+r-2)/2,n))},cdf:function(t,e,r){return t<0?0:m1(e*t/(e*t+r),e/2,r/2)},inv:function(t,e,r){return r/(e*(1/OE(t,e/2,r/2)-1))}},IE={pdf:function(t,e,r){return t<0||e<0||r<0?0:r/e*Math.pow(t/e,r-1)*Math.exp(-Math.pow(t/e,r))},cdf:function(t,e,r){return t<0?0:1-Math.exp(-Math.pow(t/e,r))}},d1={pdf:function(t,e){return e<0||t%1!=0||t<0?0:Math.pow(e,t)*Math.exp(-e)/f1(t)},cdf:function(t,e){var r=0;if(t<0)return 0;for(var n=0;r<=t;r++)n+=d1.pdf(r,e);return n}},ii={pdf:function(t,e,r,n){if(t<0||t<r-(e-n))return 0;if(t>n||t>r)return 0;if(r*2>e)return n*2>e?ii.pdf(e-r-n+t,e,e-r,e-n):ii.pdf(n-t,e,e-r,n);if(n*2>e)return ii.pdf(r-t,e,r,e-n);if(r<n)return ii.pdf(t,e,n,r);for(var i=1,s=0,o=0;o<t;o++){for(;i>1&&s<n;)i*=1-r/(e-s),s++;i*=(n-o)*(r-o)/((o+1)*(e-r-n+o+1))}for(;s<n;s++)i*=1-r/(e-s);return Math.min(1,Math.max(0,i))},cdf:function a(t,e,r,n){if(t<0||t<r-(e-n))return 0;if(t>=n||t>=r)return 1;if(r*2>e)return n*2>e?a(e-r-n+t,e,e-r,e-n):1-ii.cdf(n-t-1,e,e-r,n);if(n*2>e)return 1-ii.cdf(r-t-1,e,r,e-n);if(r<n)return ii.cdf(t,e,n,r);for(var i=1,s=1,o=0,l=0;l<t;l++){for(;i>1&&o<n;){var u=1-r/(e-o);s*=u,i*=u,o++}s*=(n-l)*(r-l)/((l+1)*(e-r-n+l+1)),i+=s}for(;o<n;o++)i*=1-r/(e-o);return Math.min(1,Math.max(0,i))}},Cn={pdf:function(t,e){return e=e>1e100?1e100:e,1/(Math.sqrt(e)*VE(.5,e/2))*Math.pow(1+t*t/e,-((e+1)/2))},cdf:function(t,e){var r=e/2;return m1((t+Math.sqrt(t*t+e))/(2*Math.sqrt(t*t+e)),r,r)},inv:function(t,e){var r=OE(2*Math.min(t,1-t),.5*e,.5);return r=Math.sqrt(e*(1-r)/r),t>.5?r:-r}},h1={pdf:function(t,e,r){return t<=0?0:Math.exp(-Math.log(t)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(t)-e,2)/(2*r*r))},cdf:function(t,e,r){return t<0?0:.5+.5*dl((Math.log(t)-e)/Math.sqrt(2*r*r))},inv:function(t,e,r){return Math.exp(-1.4142135623730951*r*KL(2*t)+e)}},y1={pdf:function(t,e,r){return t!==t>>>0?!1:t<0?0:QL(t+e-1,e-1)*Math.pow(1-r,t)*Math.pow(r,e)},cdf:function(t,e,r){var n=0,i=0;if(t<0)return 0;for(;i<=t;i++)n+=y1.pdf(i,e,r);return n}};function eU(a){for(var t=0,e=a.length;--e>=0;)t+=a[e];return t}function kn(a){return eU(a)/a.length}function eo(a){for(var t=kn(a),e=0,r=a.length,n;--r>=0;)n=a[r]-t,e+=n*n;return e}function ip(a,t){return eo(a)/(a.length-(t?1:0))}function is(a,t){return Math.sqrt(ip(a,t))}function tU(){var a=[].slice.call(arguments),t=new Array(2),e;return a.length===4?e=Math.abs(_n.inv(a[1]/2,0,1)*a[2]/Math.sqrt(a[3])):e=Math.abs(_n.inv(a[1]/2,0,1)*is(a[2])/Math.sqrt(a[2].length)),t[0]=a[0]-e,t[1]=a[0]+e,t}function rU(){var a=[].slice.call(arguments),t=new Array(2),e;return a.length===4?e=Math.abs(Cn.inv(a[1]/2,a[3]-1)*a[2]/Math.sqrt(a[3])):e=Math.abs(Cn.inv(a[1]/2,a[2].length-1)*is(a[2],!0)/Math.sqrt(a[2].length)),t[0]=a[0]-e,t[1]=a[0]+e,t}function v2e(a){for(var t=1,e=a.length;--e>=0;)t*=a[e];return t}function nU(a){return Math.pow(v2e(a),1/a.length)}function sp(a,t){var e=kn(a),r=kn(t),n=a.length,i=new Array(n),s;for(s=0;s<n;s++)i[s]=(a[s]-e)*(t[s]-r);return eU(i)/(n-1)}function PE(a,t){return sp(a,t)/is(a,1)/is(t,1)}function _E(a){return _E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_E(a)}function T2e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function aU(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function N2e(a,t,e){return t&&aU(a.prototype,t),e&&aU(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function C2e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&kE(a,t)}function kE(a,t){return kE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},kE(a,t)}function A2e(a){var t=E2e();return function(){var r=b1(a),n;if(t){var i=b1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S2e(this,n)}}function S2e(a,t){if(t&&(_E(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w2e(a)}function w2e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function E2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function b1(a){return b1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b1(a)}var g1=function(a){C2e(e,a);var t=A2e(e);function e(){return T2e(this,e),t.apply(this,arguments)}return N2e(e,[{key:"erf",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ERF"),function(s,o){return o===void 0?dl(s):dl(o)-dl(s)})}},{key:"erfc",value:function(n,i){return this.runFunction(n.args,i,this.metadata("ERFC"),EE)}},{key:"expondist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("EXPON.DIST"),function(s,o,l){return l?RE.cdf(s,o):RE.pdf(s,o)})}},{key:"fisher",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FISHER"),function(s){return Math.log((1+s)/(1-s))/2})}},{key:"fisherinv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FISHERINV"),function(s){return 1-2/(Math.exp(2*s)+1)})}},{key:"gamma",value:function(n,i){return this.runFunction(n.args,i,this.metadata("GAMMA"),ap)}},{key:"gammadist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("GAMMA.DIST"),function(s,o,l,u){return u?c1.cdf(s,o,l):c1.pdf(s,o,l)})}},{key:"gammaln",value:function(n,i){return this.runFunction(n.args,i,this.metadata("GAMMALN"),pr)}},{key:"gammainv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("GAMMA.INV"),c1.inv)}},{key:"gauss",value:function(n,i){return this.runFunction(n.args,i,this.metadata("GAUSS"),function(s){return _n.cdf(s,0,1)-.5})}},{key:"betadist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BETA.DIST"),function(s,o,l,u,c,p){return s<=c?new E(V.NUM,D.ValueSmall):s>=p?new E(V.NUM,D.ValueLarge):(s=(s-c)/(p-c),u?p1.cdf(s,o,l):p1.pdf(s,o,l))})}},{key:"betainv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BETA.INV"),function(s,o,l,u,c){return u>=c?new E(V.NUM,D.WrongOrder):p1.inv(s,o,l)*(c-u)+u})}},{key:"binomialdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BINOM.DIST"),function(s,o,l,u){return s>o?new E(V.NUM,D.WrongOrder):(s=Math.trunc(s),o=Math.trunc(o),u?vd.cdf(s,o,l):vd.pdf(s,o,l))})}},{key:"binomialinv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BINOM.INV"),function(s,o,l){s=Math.trunc(s);for(var u=-1,c=s;c>u+1;){var p=Math.trunc((u+c)/2);vd.cdf(p,s,o)>=l?c=p:u=p}return c})}},{key:"besselifn",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BESSELI"),function(s,o){return u1(s,Math.trunc(o))})}},{key:"besseljfn",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BESSELJ"),function(s,o){return l1(s,Math.trunc(o))})}},{key:"besselkfn",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BESSELK"),function(s,o){return $L(s,Math.trunc(o))})}},{key:"besselyfn",value:function(n,i){return this.runFunction(n.args,i,this.metadata("BESSELY"),function(s,o){return WL(s,Math.trunc(o))})}},{key:"chisqdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CHISQ.DIST"),function(s,o,l){return o=Math.trunc(o),l?Js.cdf(s,o):Js.pdf(s,o)})}},{key:"chisqdistrt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CHISQ.DIST.RT"),function(s,o){return 1-Js.cdf(s,Math.trunc(o))})}},{key:"chisqinv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CHISQ.INV"),function(s,o){return Js.inv(s,Math.trunc(o))})}},{key:"chisqinvrt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CHISQ.INV.RT"),function(s,o){return Js.inv(1-s,Math.trunc(o))})}},{key:"fdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("F.DIST"),function(s,o,l,u){return o=Math.trunc(o),l=Math.trunc(l),u?Qs.cdf(s,o,l):Qs.pdf(s,o,l)})}},{key:"fdistrt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("F.DIST.RT"),function(s,o,l){return 1-Qs.cdf(s,Math.trunc(o),Math.trunc(l))})}},{key:"finv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("F.INV"),function(s,o,l){return Qs.inv(s,Math.trunc(o),Math.trunc(l))})}},{key:"finvrt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("F.INV.RT"),function(s,o,l){return Qs.inv(1-s,Math.trunc(o),Math.trunc(l))})}},{key:"weibulldist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("WEIBULL.DIST"),function(s,o,l,u){return u?IE.cdf(s,l,o):IE.pdf(s,l,o)})}},{key:"poissondist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("POISSON.DIST"),function(s,o,l){return s=Math.trunc(s),l?d1.cdf(s,o):d1.pdf(s,o)})}},{key:"hypgeomdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("HYPGEOM.DIST"),function(s,o,l,u,c){return s>o||s>l||o>u||l>u?new E(V.NUM,D.ValueLarge):s+u<l+o?new E(V.NUM,D.ValueLarge):(s=Math.trunc(s),o=Math.trunc(o),l=Math.trunc(l),u=Math.trunc(u),c?ii.cdf(s,u,l,o):ii.pdf(s,u,l,o))})}},{key:"tdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("T.DIST"),function(s,o,l){return o=Math.trunc(o),l?Cn.cdf(s,o):Cn.pdf(s,o)})}},{key:"tdist2t",value:function(n,i){return this.runFunction(n.args,i,this.metadata("T.DIST.2T"),function(s,o){return(1-Cn.cdf(s,Math.trunc(o)))*2})}},{key:"tdistrt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("T.DIST.RT"),function(s,o){return 1-Cn.cdf(s,Math.trunc(o))})}},{key:"tdistold",value:function(n,i){return this.runFunction(n.args,i,this.metadata("TDIST"),function(s,o,l){return l*(1-Cn.cdf(s,Math.trunc(o)))})}},{key:"tinv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("T.INV"),function(s,o){return Cn.inv(s,Math.trunc(o))})}},{key:"tinv2t",value:function(n,i){return this.runFunction(n.args,i,this.metadata("T.INV.2T"),function(s,o){return Cn.inv(1-s/2,Math.trunc(o))})}},{key:"lognormdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("LOGNORM.DIST"),function(s,o,l,u){return u?h1.cdf(s,o,l):h1.pdf(s,o,l)})}},{key:"lognorminv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("LOGNORM.INV"),function(s,o,l){return h1.inv(s,o,l)})}},{key:"normdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("NORM.DIST"),function(s,o,l,u){return u?_n.cdf(s,o,l):_n.pdf(s,o,l)})}},{key:"norminv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("NORM.INV"),function(s,o,l){return _n.inv(s,o,l)})}},{key:"normsdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("NORM.S.DIST"),function(s,o){return o?_n.cdf(s,0,1):_n.pdf(s,0,1)})}},{key:"normsinv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("NORM.S.INV"),function(s){return _n.inv(s,0,1)})}},{key:"phi",value:function(n,i){return this.runFunction(n.args,i,this.metadata("PHI"),function(s){return _n.pdf(s,0,1)})}},{key:"negbinomdist",value:function(n,i){return this.runFunction(n.args,i,this.metadata("NEGBINOM.DIST"),function(s,o,l,u){return s=Math.trunc(s),o=Math.trunc(o),u?y1.cdf(s,o,l):y1.pdf(s,o,l)})}},{key:"confidencenorm",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CONFIDENCE.NORM"),function(s,o,l){return tU(1,s,o,Math.trunc(l))[1]-1})}},{key:"confidencet",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CONFIDENCE.T"),function(s,o,l){return l=Math.trunc(l),l===1?new E(V.DIV_BY_ZERO):rU(1,s,o,l)[1]-1})}},{key:"standardize",value:function(n,i){return this.runFunction(n.args,i,this.metadata("STANDARDIZE"),function(s,o,l){return(s-o)/l})}}]),e}(X);g1.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:N.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:N.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:N.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:N.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:N.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:N.NUMBER,minValue:0,lessThan:1},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:N.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.BOOLEAN},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:N.NUMBER,greaterThan:0,maxValue:1},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,defaultValue:0},{argumentType:N.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0,maxValue:1},{argumentType:N.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0,maxValue:1},{argumentType:N.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:1,maxValue:1e10},{argumentType:N.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:N.NUMBER,minValue:0,maxValue:1},{argumentType:N.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:N.NUMBER,minValue:0,maxValue:1},{argumentType:N.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:1},{argumentType:N.NUMBER,minValue:1},{argumentType:N.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:1},{argumentType:N.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:N.NUMBER,minValue:0,maxValue:1},{argumentType:N.NUMBER,minValue:1},{argumentType:N.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:N.NUMBER,minValue:0,maxValue:1},{argumentType:N.NUMBER,minValue:1},{argumentType:N.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0},{argumentType:N.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:1},{argumentType:N.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:1},{argumentType:N.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:N.NUMBER,greaterThan:0,lessThan:1},{argumentType:N.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:N.NUMBER,greaterThan:0,maxValue:1},{argumentType:N.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:N.NUMBER,greaterThan:0,lessThan:1},{argumentType:N.NUMBER},{argumentType:N.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:N.NUMBER,greaterThan:0,lessThan:1},{argumentType:N.NUMBER},{argumentType:N.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:N.NUMBER},{argumentType:N.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:N.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:N.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:1},{argumentType:N.NUMBER,minValue:0,maxValue:1},{argumentType:N.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:N.NUMBER,greaterThan:0,lessThan:1},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:N.NUMBER,greaterThan:0,lessThan:1},{argumentType:N.NUMBER,greaterThan:0},{argumentType:N.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER,greaterThan:0}]}};g1.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};var R2e=he();R2e({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991});var zbt=M(ie());var Wbt=M(q());function FE(a){return FE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FE(a)}function jE(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=x2e(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function x2e(a,t){if(!!a){if(typeof a=="string")return iU(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return iU(a,t)}}function iU(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function V2e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function sU(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function O2e(a,t,e){return t&&sU(a.prototype,t),e&&sU(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function D2e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&ME(a,t)}function ME(a,t){return ME=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},ME(a,t)}function I2e(a){var t=k2e();return function(){var r=v1(a),n;if(t){var i=v1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P2e(this,n)}}function P2e(a,t){if(t&&(FE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _2e(a)}function _2e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function k2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function v1(a){return v1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v1(a)}var BE=function(a){D2e(e,a);var t=I2e(e);function e(){return V2e(this,e),t.apply(this,arguments)}return O2e(e,[{key:"fact",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FACT"),function(s){s=Math.trunc(s);for(var o=1,l=1;l<=s;l++)o*=l;return o})}},{key:"factdouble",value:function(n,i){return this.runFunction(n.args,i,this.metadata("FACTDOUBLE"),function(s){s=Math.trunc(s);for(var o=1,l=s;l>=1;l-=2)o*=l;return o})}},{key:"combin",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COMBIN"),function(s,o){return o>s?new E(V.NUM,D.WrongOrder):(s=Math.trunc(s),o=Math.trunc(o),oU(s,o))})}},{key:"combina",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COMBINA"),function(s,o){return s=Math.trunc(s),o=Math.trunc(o),s+o-1>=1030?new E(V.NUM,D.ValueLarge):s===0&&o===0?1:oU(s+o-1,o)})}},{key:"gcd",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("GCD"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(l);if(c instanceof E)return c;var p=0,m=jE(c),f;try{for(m.s();!(f=m.n()).done;){var d=f.value;if(d<0)return new E(V.NUM,D.ValueSmall);p=lU(p,Math.trunc(d))}}catch(h){m.e(h)}finally{m.f()}return p>Number.MAX_SAFE_INTEGER?new E(V.NUM,D.ValueLarge):p})}},{key:"lcm",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("LCM"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(l);if(c instanceof E)return c;var p=1,m=jE(c),f;try{for(m.s();!(f=m.n()).done;){var d=f.value;if(d<0)return new E(V.NUM,D.ValueSmall);p=F2e(p,Math.trunc(d))}}catch(h){m.e(h)}finally{m.f()}return p>Number.MAX_SAFE_INTEGER?new E(V.NUM,D.ValueLarge):p})}},{key:"mround",value:function(n,i){return this.runFunction(n.args,i,this.metadata("MROUND"),function(s,o){return o===0?0:s>0&&o<0||s<0&&o>0?new E(V.NUM,D.DistinctSigns):Math.round(s/o)*o})}},{key:"multinomial",value:function(n,i){return this.runFunction(n.args,i,this.metadata("MULTINOMIAL"),function(){for(var s=0,o=1,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];for(var p=0,m=u;p<m.length;p++){var f=m[p];if(f<0)return new E(V.NUM,D.ValueSmall);f=Math.trunc(f);for(var d=1;d<=f;d++)o*=(s+d)/d;s+=f}return Math.round(o)})}},{key:"quotient",value:function(n,i){return this.runFunction(n.args,i,this.metadata("QUOTIENT"),function(s,o){return o===0?new E(V.DIV_BY_ZERO):Math.trunc(s/o)})}},{key:"seriessum",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SERIESSUM"),function(o,l,u,c){var p=s.arithmeticHelper.manyToOnlyNumbersDropNulls(c.valuesFromTopLeftCorner());if(p instanceof E)return p;var m=0;p.reverse();var f=jE(p),d;try{for(f.s();!(d=f.n()).done;){var h=d.value;m*=Math.pow(o,u),m+=h}}catch(y){f.e(y)}finally{f.f()}return m*Math.pow(o,l)})}},{key:"sign",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SIGN"),function(s){return s>0?1:s<0?-1:0})}},{key:"sumx2my2",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SUMX2MY2"),function(s,o){var l=s.valuesFromTopLeftCorner(),u=o.valuesFromTopLeftCorner();if(l.length!==u.length)return new E(V.NA,D.EqualLength);for(var c=l.length,p=0,m=0;m<c;m++){var f=l[m],d=u[m];if(f instanceof E)return f;if(d instanceof E)return d;typeof f=="number"&&typeof d=="number"&&(p+=Math.pow(f,2)-Math.pow(d,2))}return p})}},{key:"sumx2py2",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SUMX2PY2"),function(s,o){var l=s.valuesFromTopLeftCorner(),u=o.valuesFromTopLeftCorner();if(l.length!==u.length)return new E(V.NA,D.EqualLength);for(var c=l.length,p=0,m=0;m<c;m++){var f=l[m],d=u[m];if(f instanceof E)return f;if(d instanceof E)return d;typeof f=="number"&&typeof d=="number"&&(p+=Math.pow(f,2)+Math.pow(d,2))}return p})}},{key:"sumxmy2",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SUMXMY2"),function(s,o){var l=s.valuesFromTopLeftCorner(),u=o.valuesFromTopLeftCorner();if(l.length!==u.length)return new E(V.NA,D.EqualLength);for(var c=l.length,p=0,m=0;m<c;m++){var f=l[m],d=u[m];if(f instanceof E)return f;if(d instanceof E)return d;typeof f=="number"&&typeof d=="number"&&(p+=Math.pow(f-d,2))}return p})}}]),e}(X);BE.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:N.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:N.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:N.NUMBER,minValue:0,lessThan:1030},{argumentType:N.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:N.NUMBER,minValue:0},{argumentType:N.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:N.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:N.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]}};function oU(a,t){2*t>a&&(t=a-t);for(var e=1,r=1;r<=t;r++)e*=(a-t+r)/r;return Math.round(e)}function lU(a,t){if(a<t){var e=[t,a];a=e[0],t=e[1]}for(;t>0;){var r=[t,a%t];a=r[0],t=r[1]}return a}function F2e(a,t){return a===0||t===0?0:a*(t/lU(a,t))}var sgt=M(q());var mgt=M(ie());function LE(a){return LE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LE(a)}function uU(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=cU(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function xt(a,t){return B2e(a)||M2e(a,t)||cU(a,t)||j2e()}function j2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cU(a,t){if(!!a){if(typeof a=="string")return pU(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return pU(a,t)}}function pU(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function M2e(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r=[],n=!0,i=!1,s,o;try{for(e=e.call(a);!(n=(s=e.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&e.return!=null&&e.return()}finally{if(i)throw o}}return r}}function B2e(a){if(Array.isArray(a))return a}function L2e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function mU(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function U2e(a,t,e){return t&&mU(a.prototype,t),e&&mU(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function z2e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&UE(a,t)}function UE(a,t){return UE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},UE(a,t)}function G2e(a){var t=W2e();return function(){var r=T1(a),n;if(t){var i=T1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return H2e(this,n)}}function H2e(a,t){if(t&&(LE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q2e(a)}function q2e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function W2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function T1(a){return T1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},T1(a)}var zE=function(a){z2e(e,a);var t=G2e(e);function e(){return L2e(this,e),t.apply(this,arguments)}return U2e(e,[{key:"complex",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COMPLEX"),function(s,o,l){return l!=="i"&&l!=="j"?new E(V.VALUE,D.ShouldBeIorJ):Rt([s,o],l)})}},{key:"imabs",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMABS"),bU)}},{key:"imaginary",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMAGINARY"),function(s){var o=xt(s,2),l=o[0],u=o[1];return u})}},{key:"imreal",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMREAL"),function(s){var o=xt(s,2),l=o[0],u=o[1];return l})}},{key:"imargument",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMARGUMENT"),function(s){var o=xt(s,2),l=o[0],u=o[1];return l===0&&u===0?new E(V.DIV_BY_ZERO):Math.atan2(u,l)})}},{key:"imconjugate",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMCONJUGATE"),function(s){var o=xt(s,2),l=o[0],u=o[1];return Rt([l,-u])})}},{key:"imcos",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMCOS"),function(s){return Rt(N1(s))})}},{key:"imcosh",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMCOSH"),function(s){return Rt(dU(s))})}},{key:"imcot",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMCOT"),function(s){return Rt(hl(N1(s),C1(s)))})}},{key:"imcsc",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMCSC"),function(s){return Rt(hl([1,0],C1(s)))})}},{key:"imcsch",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMCSCH"),function(s){return Rt(hl([1,0],hU(s)))})}},{key:"imsec",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMSEC"),function(s){return Rt(hl([1,0],N1(s)))})}},{key:"imsech",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMSECH"),function(s){return Rt(hl([1,0],dU(s)))})}},{key:"imsin",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMSIN"),function(s){return Rt(C1(s))})}},{key:"imsinh",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMSINH"),function(s){return Rt(hU(s))})}},{key:"imtan",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMTAN"),function(s){return Rt(hl(C1(s),N1(s)))})}},{key:"imdiv",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMDIV"),function(s,o){return Rt(hl(s,o))})}},{key:"improduct",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("IMPRODUCT"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceComplexExactRanges(l);if(c instanceof E)return c;var p=[1,0],m=uU(c),f;try{for(m.s();!(f=m.n()).done;){var d=f.value;p=fU(p,d)}}catch(h){m.e(h)}finally{m.f()}return Rt(p)})}},{key:"imsum",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("IMSUM"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceComplexExactRanges(l);if(c instanceof E)return c;var p=[0,0],m=uU(c),f;try{for(m.s();!(f=m.n()).done;){var d=f.value;p=$2e(p,d)}}catch(h){m.e(h)}finally{m.f()}return Rt(p)})}},{key:"imsub",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMSUB"),function(s,o){return Rt(K2e(s,o))})}},{key:"imexp",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMEXP"),function(s){return Rt(yU(s))})}},{key:"imln",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMLN"),function(s){return Rt(A1(s))})}},{key:"imlog10",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMLOG10"),function(s){var o=A1(s),l=xt(o,2),u=l[0],c=l[1],p=Math.log(10);return Rt([u/p,c/p])})}},{key:"imlog2",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMLOG2"),function(s){var o=A1(s),l=xt(o,2),u=l[0],c=l[1],p=Math.log(2);return Rt([u/p,c/p])})}},{key:"impower",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMPOWER"),function(s,o){return Rt(gU(s,o))})}},{key:"imsqrt",value:function(n,i){return this.runFunction(n.args,i,this.metadata("IMSQRT"),function(s){return Rt(gU(s,.5))})}}]),e}(X);zE.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:N.NUMBER},{argumentType:N.NUMBER},{argumentType:N.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:N.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:N.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:N.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:N.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:N.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:N.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:N.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:N.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:N.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:N.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:N.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:N.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:N.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:N.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:N.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:N.COMPLEX},{argumentType:N.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:N.COMPLEX},{argumentType:N.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:N.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:N.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:N.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:N.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:N.COMPLEX},{argumentType:N.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:N.COMPLEX}]}};function $2e(a,t){var e=xt(a,2),r=e[0],n=e[1],i=xt(t,2),s=i[0],o=i[1];return[r+s,n+o]}function K2e(a,t){var e=xt(a,2),r=e[0],n=e[1],i=xt(t,2),s=i[0],o=i[1];return[r-s,n-o]}function fU(a,t){var e=xt(a,2),r=e[0],n=e[1],i=xt(t,2),s=i[0],o=i[1];return[r*s-n*o,r*o+s*n]}function hl(a,t){var e=xt(a,2),r=e[0],n=e[1],i=xt(t,2),s=i[0],o=i[1],l=Math.pow(s,2)+Math.pow(o,2),u=fU([r,n],[s,-o]),c=xt(u,2),p=c[0],m=c[1];return[p/l,m/l]}function N1(a){var t=xt(a,2),e=t[0],r=t[1];return[Math.cos(e)*Math.cosh(r),-Math.sin(e)*Math.sinh(r)]}function dU(a){var t=xt(a,2),e=t[0],r=t[1];return[Math.cosh(e)*Math.cos(r),Math.sinh(e)*Math.sin(r)]}function C1(a){var t=xt(a,2),e=t[0],r=t[1];return[Math.sin(e)*Math.cosh(r),Math.cos(e)*Math.sinh(r)]}function hU(a){var t=xt(a,2),e=t[0],r=t[1];return[Math.sinh(e)*Math.cos(r),Math.cosh(e)*Math.sin(r)]}function yU(a){var t=xt(a,2),e=t[0],r=t[1];return[Math.exp(e)*Math.cos(r),Math.exp(e)*Math.sin(r)]}function bU(a){var t=xt(a,2),e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function A1(a){var t=xt(a,2),e=t[0],r=t[1];return[Math.log(bU([e,r])),Math.atan2(r,e)]}function gU(a,t){var e=A1(a),r=xt(e,2),n=r[0],i=r[1];return yU([t*n,t*i])}var Egt=M(ie());var Ogt=M(q());function GE(a){return GE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GE(a)}function vU(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=X2e(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function X2e(a,t){if(!!a){if(typeof a=="string")return TU(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return TU(a,t)}}function TU(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Y2e(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function NU(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Z2e(a,t,e){return t&&NU(a.prototype,t),e&&NU(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function J2e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&HE(a,t)}function HE(a,t){return HE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},HE(a,t)}function Q2e(a){var t=rTe();return function(){var r=S1(a),n;if(t){var i=S1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return eTe(this,n)}}function eTe(a,t){if(t&&(GE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tTe(a)}function tTe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function rTe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function S1(a){return S1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S1(a)}var w1=function(a){J2e(e,a);var t=Q2e(e);function e(){return Y2e(this,e),t.apply(this,arguments)}return Z2e(e,[{key:"avedev",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("AVEDEV"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersExactRanges(l);if(c instanceof E)return c;if(c.length===0)return new E(V.DIV_BY_ZERO);var p=kn(c);return c.reduce(function(m,f){return m+Math.abs(f-p)},0)/c.length})}},{key:"devsq",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("DEVSQ"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersExactRanges(l);return c instanceof E?c:c.length===0?0:eo(c)})}},{key:"geomean",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("GEOMEAN"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersExactRanges(l);if(c instanceof E)return c;if(c.length===0)return new E(V.NUM,D.OneValue);var p=vU(c),m;try{for(p.s();!(m=p.n()).done;){var f=m.value;if(f<=0)return new E(V.NUM,D.ValueSmall)}}catch(d){p.e(d)}finally{p.f()}return nU(c)})}},{key:"harmean",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("HARMEAN"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersExactRanges(l);if(c instanceof E)return c;if(c.length===0)return new E(V.NUM,D.OneValue);var p=vU(c),m;try{for(p.s();!(m=p.n()).done;){var f=m.value;if(f<=0)return new E(V.NUM,D.ValueSmall)}}catch(d){p.e(d)}finally{p.f()}return c.length/c.reduce(function(d,h){return d+1/h},0)})}},{key:"correl",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CORREL"),function(s,o){if(s.numberOfElements()!==o.numberOfElements())return new E(V.NA,D.EqualLength);var l=yl(s,o);if(l instanceof E)return l;var u=l[0].length;return u<=1?new E(V.DIV_BY_ZERO,D.TwoValues):PE(l[0],l[1])})}},{key:"rsq",value:function(n,i){return this.runFunction(n.args,i,this.metadata("RSQ"),function(s,o){if(s.numberOfElements()!==o.numberOfElements())return new E(V.NA,D.EqualLength);var l=yl(s,o);if(l instanceof E)return l;var u=l[0].length;return u<=1?new E(V.DIV_BY_ZERO,D.TwoValues):Math.pow(PE(l[0],l[1]),2)})}},{key:"covariancep",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COVARIANCE.P"),function(s,o){if(s.numberOfElements()!==o.numberOfElements())return new E(V.NA,D.EqualLength);var l=yl(s,o);if(l instanceof E)return l;var u=l[0].length;return u<1?new E(V.DIV_BY_ZERO,D.OneValue):u===1?0:sp(l[0],l[1])*(u-1)/u})}},{key:"covariances",value:function(n,i){return this.runFunction(n.args,i,this.metadata("COVARIANCE.S"),function(s,o){if(s.numberOfElements()!==o.numberOfElements())return new E(V.NA,D.EqualLength);var l=yl(s,o);if(l instanceof E)return l;var u=l[0].length;return u<=1?new E(V.DIV_BY_ZERO,D.TwoValues):sp(l[0],l[1])})}},{key:"ztest",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("Z.TEST"),function(o,l,u){var c=s.arithmeticHelper.manyToExactNumbers(o.valuesFromTopLeftCorner());if(c instanceof E)return c;var p=c.length;if(u===void 0){if(p<2)return new E(V.DIV_BY_ZERO,D.TwoValues);u=is(c,!0)}return p<1?new E(V.NA,D.OneValue):u===0?new E(V.DIV_BY_ZERO):1-_n.cdf((kn(c)-l)/(u/Math.sqrt(p)),0,1)})}},{key:"ftest",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("F.TEST"),function(o,l){var u=s.arithmeticHelper.manyToExactNumbers(o.valuesFromTopLeftCorner()),c=s.arithmeticHelper.manyToExactNumbers(l.valuesFromTopLeftCorner());if(u instanceof E)return u;if(c instanceof E)return c;if(u.length<=1||c.length<=1)return new E(V.DIV_BY_ZERO);var p=ip(u,!0),m=ip(c,!0);if(p===0||m===0)return new E(V.DIV_BY_ZERO);var f=p/m,d=Qs.cdf(f,u.length-1,c.length-1);return 2*Math.min(d,1-d)})}},{key:"steyx",value:function(n,i){return this.runFunction(n.args,i,this.metadata("STEYX"),function(s,o){if(s.numberOfElements()!==o.numberOfElements())return new E(V.NA,D.EqualLength);var l=yl(s,o);if(l instanceof E)return l;var u=l[0].length;return u<=2?new E(V.DIV_BY_ZERO,D.ThreeValues):Math.sqrt((eo(l[0])-Math.pow(sp(l[0],l[1])*(u-1),2)/eo(l[1]))/(u-2))})}},{key:"slope",value:function(n,i){return this.runFunction(n.args,i,this.metadata("SLOPE"),function(s,o){if(s.numberOfElements()!==o.numberOfElements())return new E(V.NA,D.EqualLength);var l=yl(s,o);if(l instanceof E)return l;var u=l[0].length;return u<=1?new E(V.DIV_BY_ZERO,D.TwoValues):sp(l[0],l[1])*(u-1)/eo(l[1])})}},{key:"chisqtest",value:function(n,i){return this.runFunction(n.args,i,this.metadata("CHISQ.TEST"),function(s,o){var l=s.height(),u=s.width();if(o.height()!==l||o.width()!==u)return new E(V.NA,D.EqualLength);var c=yl(s,o);if(c instanceof E)return c;if(c[0].length<=1)return new E(V.DIV_BY_ZERO,D.TwoValues);for(var p=0,m=0;m<c[0].length;m++){if(c[1][m]===0)return new E(V.DIV_BY_ZERO);p+=Math.pow(c[0][m]-c[1][m],2)/c[1][m]}return p<0?new E(V.NUM,D.NaN):1-Js.cdf(p,l>1&&u>1?(l-1)*(u-1):l*u-1)})}},{key:"ttest",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("T.TEST"),function(o,l,u,c){var p=s.arithmeticHelper.manyToExactNumbers(o.valuesFromTopLeftCorner()),m=s.arithmeticHelper.manyToExactNumbers(l.valuesFromTopLeftCorner());if(p instanceof E)return p;if(m instanceof E)return m;var f=p.length,d=m.length;if(c===1){if(d!==f)return new E(V.NA,D.EqualLength);if(f<=1)return new E(V.DIV_BY_ZERO,D.TwoValues);for(var h=Array(f),y=0;y<f;y++)h[y]=p[y]-m[y];var b=is(h,!0);if(b===0)return new E(V.DIV_BY_ZERO);var g=Math.abs(Math.sqrt(f)*kn(h)/b);return u*(1-Cn.cdf(g,f-1))}else if(c===2){if(f<=1||d<=1)return new E(V.DIV_BY_ZERO,D.TwoValues);var v=(eo(p)+eo(m))/(f+d-2);if(v===0)return new E(V.DIV_BY_ZERO);var A=Math.abs((kn(p)-kn(m))/Math.sqrt(v*(1/f+1/d)));return u*(1-Cn.cdf(A,f+d-2))}else{if(f<=1||d<=1)return new E(V.DIV_BY_ZERO,D.TwoValues);var C=ip(p,!0),S=ip(m,!0);if(C===0&&S===0)return new E(V.DIV_BY_ZERO);var w=Math.abs((kn(p)-kn(m))/Math.sqrt(C/f+S/d)),x=Math.pow(C/f+S/d,2)/(Math.pow(C/f,2)/(f-1)+Math.pow(S/d,2)/(d-1));return u*(1-Cn.cdf(w,x))}})}},{key:"skew",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SKEW"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersExactRanges(l);if(c instanceof E)return c;var p=c.length;if(p<3)return new E(V.DIV_BY_ZERO,D.ThreeValues);var m=kn(c),f=is(c,!0);return f===0?new E(V.DIV_BY_ZERO):c.reduce(function(d,h){return d+Math.pow((h-m)/f,3)},0)*p/(p-1)/(p-2)})}},{key:"skewp",value:function(n,i){var s=this;return this.runFunction(n.args,i,this.metadata("SKEW.P"),function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=s.arithmeticHelper.coerceNumbersExactRanges(l);if(c instanceof E)return c;var p=c.length;if(p<3)return new E(V.DIV_BY_ZERO,D.ThreeValues);var m=kn(c),f=is(c,!1);return f===0?new E(V.DIV_BY_ZERO):c.reduce(function(d,h){return d+Math.pow((h-m)/f,3)},0)/p})}}]),e}(X);w1.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:N.RANGE},{argumentType:N.NUMBER},{argumentType:N.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:N.RANGE},{argumentType:N.RANGE},{argumentType:N.INTEGER,minValue:1,maxValue:2},{argumentType:N.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:N.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:N.ANY}],repeatLastArgs:1}};w1.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function yl(a,t){for(var e=a.iterateValuesFromTopLeftCorner(),r=t.iterateValuesFromTopLeftCorner(),n,i,s=[],o=[];n=e.next(),i=r.next(),!n.done&&!i.done;){var l=n.value,u=i.value;if(l instanceof E)return l;if(u instanceof E)return u;Ce(l)&&Ce(u)&&(s.push(W(l)),o.push(W(u)))}return[s,o]}function qE(a){return qE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qE(a)}function nTe(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=aTe(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return i=u.done,u},e:function(u){s=!0,o=u},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(s)throw o}}}}function aTe(a,t){if(!!a){if(typeof a=="string")return CU(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return CU(a,t)}}function CU(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function AU(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function iTe(a,t,e){return t&&AU(a.prototype,t),e&&AU(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function sTe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function oTe(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&WE(a,t)}function WE(a,t){return WE=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},WE(a,t)}function lTe(a){var t=pTe();return function(){var r=R1(a),n;if(t){var i=R1(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return uTe(this,n)}}function uTe(a,t){if(t&&(qE(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cTe(a)}function cTe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function pTe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function R1(a){return R1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R1(a)}var ke=function(a){oTe(e,a);var t=lTe(e);function e(){return sTe(this,e),t.apply(this,arguments)}return iTe(e)}(nr);ke.HyperFormula=nr;ke.ErrorType=V;ke.CellType=zr;ke.CellValueType=ra;ke.CellValueDetailedType=Lk;ke.DetailedCellError=Sg;ke.ExportedCellChange=av;ke.ExportedNamedExpressionChange=zS;ke.ConfigValueTooBigError=lb;ke.ConfigValueTooSmallError=ob;ke.EvaluationSuspendedError=cb;ke.ExpectedOneOfValuesError=ub;ke.ExpectedValueOfTypeError=Pe;ke.FunctionPlugin=X;ke.FunctionPluginValidationError=bf;ke.InvalidAddressError=eb;ke.InvalidArgumentsError=pt;ke.LanguageNotRegisteredError=yf;ke.LanguageAlreadyRegisteredError=mb;ke.MissingTranslationError=js;ke.NamedExpressionDoesNotExistError=Fs;ke.NamedExpressionNameIsAlreadyTakenError=tb;ke.NamedExpressionNameIsInvalidError=rb;ke.NoOperationToRedoError=ab;ke.NoOperationToUndoError=nb;ke.NoRelativeAddressesAllowedError=uc;ke.NoSheetWithIdError=tt;ke.NoSheetWithNameError=Qy;ke.NotAFormulaError=hf;ke.NothingToPasteError=ib;ke.ProtectedFunctionTranslationError=pb;ke.SheetNameAlreadyTakenError=ks;ke.SheetSizeLimitExceededError=Kn;ke.SourceLocationHasArrayError=Mi;ke.TargetLocationHasArrayError=Ho;ke.UnableToParseError=sb;var mTe=na.defaultConfig.language;nr.registerLanguage(mTe,yv);nr.languages[yv.langCode]=yv;var x1=nTe(Object.getOwnPropertyNames(E1)),SU;try{for(x1.s();!(SU=x1.n()).done;)$E=SU.value,$E.startsWith("_")||nr.registerFunctionPlugin(E1[$E])}catch(a){x1.e(a)}finally{x1.f()}var $E;var Td=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:{size:100,isAbsolute:!1},public:!0,forRenderer:!0},e.minNumRows={createComponentOfType:"number",createStateVariable:"minNumRows",defaultValue:4,public:!0,forRenderer:!0},e.minNumColumns={createComponentOfType:"number",createStateVariable:"minNumColumns",defaultValue:4,public:!0,forRenderer:!0},e.height={createComponentOfType:"_componentSize"},e.columnHeaders={createComponentOfType:"boolean",createStateVariable:"columnHeaders",defaultValue:!0,public:!0,forRenderer:!0},e.rowHeaders={createComponentOfType:"boolean",createStateVariable:"rowHeaders",defaultValue:!0,public:!0,forRenderer:!0},e.fixedRowsTop={createComponentOfType:"integer",createStateVariable:"fixedRowsTop",defaultValue:0,clamp:[0,1/0],public:!0,forRenderer:!0},e.fixedColumnsLeft={createComponentOfType:"integer",createStateVariable:"fixedColumnsLeft",defaultValue:0,clamp:[0,1/0],public:!0,forRenderer:!0},e.hiddenColumns={createComponentOfType:"numberList",createStateVariable:"hiddenColumns",defaultValue:[],public:!0,forRenderer:!0},e.hiddenRows={createComponentOfType:"numberList",createStateVariable:"hiddenRows",defaultValue:[],public:!0,forRenderer:!0},e}static returnChildGroups(){return[{group:"cells",componentTypes:["cell"]},{group:"rows",componentTypes:["row"]},{group:"columns",componentTypes:["column"]},{group:"cellBlocks",componentTypes:["cellBlock"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.cellNameToRowCol={additionalStateVariablesDefined:["cellNamesByRowCol"],returnDependencies:()=>({cellRelatedChildren:{dependencyType:"child",childGroups:["cells","rows","columns","cellBlocks"],variableNames:["rowNum","colNum","prescribedCellsWithColNum","prescribedCellsWithRowNum","prescribedCellsRowsColumnsBlocks"],variablesOptional:!0}}),definition({dependencyValues:e,componentInfoObjects:r}){let n=wU({cellRelatedChildren:e.cellRelatedChildren,componentInfoObjects:r});return{setValue:{cellNameToRowCol:n.cellNameToRowCol,cellNamesByRowCol:n.cellNamesByRowCol}}}},t.numRows={public:!0,componentType:"number",returnDependencies:()=>({minNumRows:{dependencyType:"stateVariable",variableName:"minNumRows"},cellNamesByRowCol:{dependencyType:"stateVariable",variableName:"cellNamesByRowCol"}}),definition({dependencyValues:e}){let r=e.minNumRows;return Number.isFinite(r)||(r=4),r=Math.max(r,e.cellNamesByRowCol.length),{setValue:{numRows:r}}}},t.numColumns={public:!0,componentType:"number",returnDependencies:()=>({minNumColumns:{dependencyType:"stateVariable",variableName:"minNumColumns"},cellNamesByRowCol:{dependencyType:"stateVariable",variableName:"cellNamesByRowCol"}}),definition({dependencyValues:e}){let r=e.minNumColumns;Number.isFinite(r)||(r=4);for(let n of e.cellNamesByRowCol)n&&(r=Math.max(r,n.length));return{setValue:{numColumns:r}}}},t.height={public:!0,componentType:"_componentSize",forRenderer:!0,returnDependencies:()=>({heightAttr:{dependencyType:"attributeComponent",attributeName:"height",variableNames:["componentSize"]},numRows:{dependencyType:"stateVariable",variableName:"numRows"}}),definition({dependencyValues:e}){if(e.heightAttr===null){let r;return Number.isFinite(e.numRows)&&e.numRows>=0?r=40+e.numRows*23:r=132,{setValue:{height:{size:r,isAbsolute:!0}}}}return{setValue:{height:e.heightAttr.stateValues.componentSize}}}},t.cells={public:!0,componentType:"cell",forRenderer:!0,isArray:!0,entryPrefixes:["cell","row","column","range"],nDimensions:2,defaultValueByArrayKey:()=>"",hasEssential:!0,shadowVariable:!0,stateVariablesDeterminingDependencies:["cellNamesByRowCol"],returnArraySizeDependencies:()=>({numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),returnArraySize({dependencyValues:e}){return[e.numRows,e.numColumns]},returnEntryDimensions:e=>e==="range"?2:1,returnWrappingComponents(e){return e==="cell"?[]:e==="row"?[["row"]]:e==="column"?[["column"]]:[["row"],["cellBlock"]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="cell"){let i,s,o=/^([a-zA-Z]+)([1-9]\d*)$/,l=r.match(o);if(l)s=l[1],i=l[2];else{let p=/^\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\)$/;if(l=r.match(p),l)i=l[1],s=l[2];else return[]}let u=Te(i),c=Te(s);return u>=0&&c>=0?n&&!(u<n[0]&&c<n[1])?[]:[String(u)+","+String(c)]:[]}else if(e==="row"){let i=Te(r);if(!(i>=0))return[];if(!n)return[String(i)+",0"];if(!(i<n[0]))return[];let s=[],o=String(i)+",";for(let l=0;l<n[1];l++)s.push(o+l);return s}else if(e==="column"){let i=Te(r);if(!(i>=0))return[];if(!n)return["0,"+String(i)];if(!(i<n[1]))return[];let s=[],o=","+String(i);for(let l=0;l<n[0];l++)s.push(l+o);return s}else{let i,s,o,l,u=/^([a-zA-Z]+)([1-9]\d*)([a-zA-Z]+)([1-9]\d*)$/,c=r.match(u);if(c)s=Te(c[1]),i=Te(c[2]),l=Te(c[3]),o=Te(c[4]);else{let y=/^\(\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\),\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\)\)$/;if(c=r.match(y),c)i=Te(c[1]),s=Te(c[2]),o=Te(c[3]),l=Te(c[4]);else return[]}if(!(i>=0&&o>=0&&s>=0&&l>=0))return[];if(!n)return[String(i)+","+String(s)];let p=Math.min(Math.min(i,o),n[0]-1),m=Math.min(Math.max(i,o),n[0]-1),f=Math.min(Math.min(s,l),n[1]-1),d=Math.min(Math.max(s,l),n[1]-1),h=[];for(let y=p;y<=m;y++){let b=[],g=String(y)+",";for(let v=f;v<=d;v++)b.push(g+v);h.push(b)}return h}},arrayVarNameFromArrayKey(e){return"cell("+e.split(",").map(r=>Number(r)+1).join(",")+")"},returnArrayDependenciesByKey({stateValues:e,arrayKeys:r}){let n={},i=e.cellNamesByRowCol;for(let s of r){let[o,l]=s.split(",");i[o]&&i[o][l]&&(n[s]={cellText:{dependencyType:"stateVariable",componentName:i[o][l],variableName:"text",variablesOptional:!0}})}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={},i={};for(let o of r)e[o].cellText!==void 0?n[o]=e[o].cellText:i[o]=!0;let s={};return Object.keys(n).length>0&&(s.setValue={cells:n}),Object.keys(i).length>0&&(s.useEssentialOrDefaultValue={cells:i}),s},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:r}){let n=[];for(let i in e.cells)if(r[i].cellText!==void 0)n.push({setDependency:r[i].cellText,desiredValue:e.cells[i]});else{let s=e.cells[i];n.push({setEssentialValue:"cells",value:{[i]:s===null?"":String(s)}})}return{success:!0,instructions:n}}},t.evaluatedCells={isArray:!0,public:!0,componentType:"cell",entryPrefixes:["evaluatedCell","evaluatedRow","evaluatedColumn","evaluatedRange"],nDimensions:2,stateVariablesDeterminingDependencies:["cellNamesByRowCol"],returnArraySizeDependencies:()=>({numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),returnArraySize({dependencyValues:e}){return[e.numRows,e.numColumns]},returnArrayDependenciesByKey:()=>({globalDependencies:{cells:{dependencyType:"stateVariable",variableName:"cells"}}}),getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="evaluatedCell"){let i,s,o=/^([a-zA-Z]+)([1-9]\d*)$/,l=r.match(o);if(l)s=l[1],i=l[2];else{let p=/^\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\)$/;if(l=r.match(p),l)i=l[1],s=l[2];else return[]}let u=Te(i),c=Te(s);return u>=0&&c>=0?n&&!(u<n[0]&&c<n[1])?[]:[String(u)+","+String(c)]:[]}else if(e==="evaluatedRow"){let i=Te(r);if(!(i>=0))return[];if(!n)return[String(i)+",0"];if(!(i<n[0]))return[];let s=[],o=String(i)+",";for(let l=0;l<n[1];l++)s.push(o+l);return s}else if(e==="evaluatedColumn"){let i=Te(r);if(!(i>=0))return[];if(!n)return["0,"+String(i)];if(!(i<n[1]))return[];let s=[],o=","+String(i);for(let l=0;l<n[0];l++)s.push(l+o);return s}else{let i,s,o,l,u=/^([a-zA-Z]+)([1-9]\d*)([a-zA-Z]+)([1-9]\d*)$/,c=r.match(u);if(c)s=Te(c[1]),i=Te(c[2]),l=Te(c[3]),o=Te(c[4]);else{let y=/^\(\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\),\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\)\)$/;if(c=r.match(y),c)i=Te(c[1]),s=Te(c[2]),o=Te(c[3]),l=Te(c[4]);else return[]}if(!(i>=0&&o>=0&&s>=0&&l>=0))return[];if(!n)return[String(i)+","+String(s)];let p=Math.min(Math.min(i,o),n[0]-1),m=Math.min(Math.max(i,o),n[0]-1),f=Math.min(Math.min(s,l),n[1]-1),d=Math.min(Math.max(s,l),n[1]-1),h=[];for(let y=p;y<=m;y++){let b=[],g=String(y)+",";for(let v=f;v<=d;v++)b.push(g+v);h.push(b)}return h}},arrayVarNameFromArrayKey(e){return"evaluatedCell("+e.split(",").map(r=>Number(r)+1).join(",")+")"},arrayDefinitionByKey({globalDependencyValues:e}){let n=nr.buildFromArray(e.cells,{licenseKey:"gpl-v3"}).getSheetValues(0),i={};for(let s in n){let o=n[s];for(let l in o)i[[s,l]]=o[l]}return{setValue:{evaluatedCells:i}}}},t.pointsInCells={isArray:!0,nDimensions:2,public:!0,componentType:"point",entryPrefixes:["pointsInCell","pointsInRow","pointsInColumn","pointsInRange"],returnArraySizeDependencies:()=>({numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),returnArraySize({dependencyValues:e}){return[e.numRows,e.numColumns]},returnEntryDimensions:e=>e==="pointsInRange"?2:1,getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="pointsInCell"){let i,s,o=/^([a-zA-Z]+)([1-9]\d*)$/,l=r.match(o);if(l)s=l[1],i=l[2];else{let p=/^\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\)$/;if(l=r.match(p),l)i=l[1],s=l[2];else return[]}let u=Te(i),c=Te(s);return u>=0&&c>=0?n&&!(u<n[0]&&c<n[1])?[]:[String(u)+","+String(c)]:[]}else if(e==="pointsInRow"){let i=Te(r);if(!(i>=0))return[];if(!n)return[String(i),",0"];if(!(i>=0&&i<n[0]))return[];let s=[],o=String(i)+",";for(let l=0;l<n[1];l++)s.push(o+l);return s}else if(e==="pointsInColumn"){let i=Te(r);if(!(i>=0))return[];if(!n)return["0,"+String(i)];if(!(i<n[1]))return[];let s=[],o=","+String(i);for(let l=0;l<n[0];l++)s.push(l+o);return s}else{let i,s,o,l,u=/^([a-zA-Z]+)([1-9]\d*)([a-zA-Z]+)([1-9]\d*)$/,c=r.match(u);if(c)s=Te(c[1]),i=Te(c[2]),l=Te(c[3]),o=Te(c[4]);else{let y=/^\(\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\),\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\)\)$/;if(c=r.match(y),c)i=Te(c[1]),s=Te(c[2]),o=Te(c[3]),l=Te(c[4]);else return[]}if(!(i>=0&&o>=0&&s>=0&&l>=0))return[];if(!n)return[String(i)+","+String(s)];let p=Math.min(Math.min(i,o),n[0]-1),m=Math.min(Math.max(i,o),n[0]-1),f=Math.min(Math.min(s,l),n[1]-1),d=Math.min(Math.max(s,l),n[1]-1),h=[];for(let y=p;y<=m;y++){let b=[],g=String(y)+",";for(let v=f;v<=d;v++)b.push(g+v);h.push(b)}return h}},arrayVarNameFromArrayKey(e){return"pointsInCell("+e.split(",").map(r=>Number(r)+1).join(",")+")"},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e){let i=n.split(",").map(s=>Number(s)+1).join(",");r[n]={cellText:{dependencyType:"stateVariable",variableName:`evaluatedCell(${i})`,variablesOptional:!0}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=e[i].cellText;if(!s){n[i]=null;continue}let o;try{o=fTe.fromAst(pn.convert(s))}catch(l){n[i]=null;continue}Array.isArray(o.tree)&&(o.tree[0]==="tuple"||o.tree[0]==="vector")?n[i]=o:n[i]=null}return{setValue:{pointsInCells:n}}}},t}async onChange({changes:t,source:e,actionId:r}){if(e!=="loadData"){let n={};for(let i of t){let[s,o,l,u]=i;n[[s,o]]=u===null?"":u}return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"cells",value:n}],actionId:r,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:n}})}else this.coreFunctions.resolveAction({actionId:r})}actions={onChange:this.onChange.bind(this)}};T(Td,"componentType","spreadsheet");function wU({cellRelatedChildren:a,rowOffset:t=0,colOffset:e=0,cellNameToRowCol:r={},cellNamesByRowCol:n=[],componentInfoObjects:i}){var s=t,o=e,l=e,u=t,c=e,p=t,m=e;for(let f of a)if(i.isInheritedComponentType({inheritedComponentType:f.componentType,baseComponentType:"cell"})){let d=f,h=Te(d.stateValues.rowNum),y=Te(d.stateValues.colNum);h===void 0?(h=s,y===void 0?y=l:y=y+e):(h=h+t,y===void 0?y=o:y=y+e),KE({cell:d,rowIndex:h,colIndex:y,cellNameToRowCol:r,cellNamesByRowCol:n}),p=Math.max(h,p),m=Math.max(y,m),s=h,o=y,l=y+1}else if(i.isInheritedComponentType({inheritedComponentType:f.componentType,baseComponentType:"row"})){let d=f,h=Te(d.stateValues.rowNum);h===void 0?h=u:h=h+t;let y=d.stateValues.prescribedCellsWithColNum,b=e;for(let g of y){let v=Te(g.stateValues.colNum);v===void 0?v=b:v=v+e,KE({cell:g,rowIndex:h,colIndex:v,cellNameToRowCol:r,cellNamesByRowCol:n}),b=v+1,p=Math.max(h,p),m=Math.max(v,m)}u=h+1,s=h+1,o=e,l=o}else if(i.isInheritedComponentType({inheritedComponentType:f.componentType,baseComponentType:"column"})){let d=f,h=Te(d.stateValues.colNum);h===void 0?h=c:h=h+e;let y=d.stateValues.prescribedCellsWithRowNum,b=t;for(let g of y){let v=Te(g.stateValues.rowNum);v===void 0?v=b:v=v+t,KE({cell:g,rowIndex:v,colIndex:h,cellNameToRowCol:r,cellNamesByRowCol:n}),b=v+1,p=Math.max(v,p),m=Math.max(h,m)}c=h+1,s=t,o=h+1,l=o}else if(i.isInheritedComponentType({inheritedComponentType:f.componentType,baseComponentType:"cellBlock"})){let d=f,h=Te(d.stateValues.rowNum),y=Te(d.stateValues.colNum);h===void 0?(h=s,y===void 0?y=l:y=y+e):(h=h+t,y===void 0?y=o:y=y+e);let b=wU({cellRelatedChildren:d.stateValues.prescribedCellsRowsColumnsBlocks,rowOffset:h,colOffset:y,cellNameToRowCol:r,cellNamesByRowCol:n,componentInfoObjects:i});p=Math.max(b.maxRowIndex,p),m=Math.max(b.maxColIndex,m),s=h,o=y,l=b.maxColIndex+1}return{maxRowIndex:p,maxColIndex:m,cellNameToRowCol:r,cellNamesByRowCol:n}}function KE({cell:a,rowIndex:t,colIndex:e,cellNameToRowCol:r,cellNamesByRowCol:n}){if(r[a.componentName]=[t,e],n[t]===void 0&&(n[t]=[]),n[t][e]!==void 0){console.warn(`Cell is overwriting previous cell at rowNum=${t+1}, colNum=${e+1}`);let i=n[t][e];r[i]=null}n[t][e]=a.componentName}var op=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:{size:100,isAbsolute:!1},public:!0,forRenderer:!0},e.minNumRows={createComponentOfType:"number",createStateVariable:"minNumRows",defaultValue:1,public:!0,forRenderer:!0},e.minNumColumns={createComponentOfType:"number",createStateVariable:"minNumColumns",defaultValue:1,public:!0,forRenderer:!0},e.height={createComponentOfType:"_componentSize"},e.columnHeaders={createComponentOfType:"boolean",createStateVariable:"columnHeaders",defaultValue:!0,public:!0,forRenderer:!0},e.rowHeaders={createComponentOfType:"boolean",createStateVariable:"rowHeaders",defaultValue:!0,public:!0,forRenderer:!0},e.fixedRowsTop={createComponentOfType:"integer",createStateVariable:"fixedRowsTop",defaultValue:0,clamp:[0,1/0],public:!0,forRenderer:!0},e.fixedColumnsLeft={createComponentOfType:"integer",createStateVariable:"fixedColumnsLeft",defaultValue:0,clamp:[0,1/0],public:!0,forRenderer:!0},e.hiddenColumns={createComponentOfType:"numberList",createStateVariable:"hiddenColumns",defaultValue:[],public:!0,forRenderer:!0},e.hiddenRows={createComponentOfType:"numberList",createStateVariable:"hiddenRows",defaultValue:[],public:!0,forRenderer:!0},e.allIterates={createComponentOfType:"mathList",createStateVariable:"allIterates",defaultValue:[]},e.headerRow={createComponentOfType:"textList",createStateVariable:"headerRow",defaultValue:null},e.displayDigits={createComponentOfType:"integer",createStateVariable:"displayDigits",defaultValue:10,public:!0},e.displayDecimals={createComponentOfType:"integer",createStateVariable:"displayDecimals",defaultValue:null,public:!0},e.displaySmallAsZero={createComponentOfType:"number",createStateVariable:"displaySmallAsZero",valueForTrue:1e-14,valueForFalse:0,defaultValue:0,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.cells={forRenderer:!0,shadowVariable:!0,returnDependencies:()=>({allIterates:{dependencyType:"stateVariable",variableName:"allIterates"},headerRow:{dependencyType:"stateVariable",variableName:"headerRow"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}}),definition({dependencyValues:e,usedDefault:r}){let n=[],i=1,s=!1;if(e.allIterates.length>0&&Array.isArray(e.allIterates[0].tree)&&["vector","tuple"].includes(e.allIterates[0].tree[0])&&(i=e.allIterates[0].tree.length-1,s=!0),e.headerRow){let o=[],l=Math.min(e.headerRow.length,i+1);for(let u=0;u<l;u++)o.push(e.headerRow[u]);n.push(o)}for(let[o,l]of e.allIterates.entries()){let u=[o.toString()];for(let c=0;c<i;c++){let p=l;s&&(p=p.get_component(c));let m=Lt({value:p,dependencyValues:e,usedDefault:r});try{u.push(m.toString())}catch(f){u.push("")}}n.push(u)}return{setValue:{cells:n}}}},t.numRows={public:!0,componentType:"number",returnDependencies:()=>({minNumRows:{dependencyType:"stateVariable",variableName:"minNumRows"},cells:{dependencyType:"stateVariable",variableName:"cells"}}),definition({dependencyValues:e}){let r=e.minNumRows;return Number.isFinite(r)||(r=4),r=Math.max(r,e.cells.length),{setValue:{numRows:r}}}},t.numColumns={public:!0,componentType:"number",returnDependencies:()=>({minNumColumns:{dependencyType:"stateVariable",variableName:"minNumColumns"},cells:{dependencyType:"stateVariable",variableName:"cells"}}),definition({dependencyValues:e}){let r=e.minNumColumns;Number.isFinite(r)||(r=4);for(let n of e.cells)n&&(r=Math.max(r,n.length));return{setValue:{numColumns:r}}}},t.height={public:!0,componentType:"_componentSize",forRenderer:!0,returnDependencies:()=>({heightAttr:{dependencyType:"attributeComponent",attributeName:"height",variableNames:["componentSize"]},numRows:{dependencyType:"stateVariable",variableName:"numRows"}}),definition({dependencyValues:e}){if(e.heightAttr===null){let r;return Number.isFinite(e.numRows)&&e.numRows>=0?r=50+e.numRows*20:r=130,{setValue:{height:{size:r,isAbsolute:!0}}}}return{setValue:{height:e.heightAttr.stateValues.componentSize}}}},t}async onChange({changes:t,source:e,actionId:r}){if(e!=="loadData"){let n={};for(let i of t){let[s,o,l,u]=i;n[[s,o]]=u===null?"":u}return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"cells",value:n}],actionId:r,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:n}})}else this.coreFunctions.resolveAction({actionId:r})}actions={onChange:this.onChange.bind(this)}};T(op,"componentType","DiscreteSimulationResultList"),T(op,"rendererType","spreadsheet");import XE from"math-expressions";var lp=class extends Ge{actions={movePolyline:this.movePolyline.bind(this),finalizePolylinePosition:this.finalizePolylinePosition.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.draggable={createComponentOfType:"boolean",createStateVariable:"draggable",defaultValue:!0,public:!0,forRenderer:!0},e.allIterates={createComponentOfType:"mathList",createStateVariable:"allIterates",defaultValue:[]},e.seriesNumber={createComponentOfType:"number",createStateVariable:"seriesNumber",defaultValue:null},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let r="";return e.selectedStyle.lineWidth>=4?r+="thick ":e.selectedStyle.lineWidth<=1&&(r+="thin "),e.selectedStyle.lineStyle==="dashed"?r+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=e.selectedStyle.lineColor,{setValue:{styleDescription:r}}}},t.nVertices={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({allIterates:{dependencyType:"stateVariable",variableName:"allIterates"}}),definition:function({dependencyValues:e}){return{setValue:{nVertices:e.allIterates.length}}}},t.nDimensions={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:function({dependencyValues:e}){return{setValue:{nDimensions:2}}}},t.vertices={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["vertexX","vertex"],returnWrappingComponents(e){return e==="vertexX"?[]:[["point",{componentType:"mathList",isAttribute:"xs"}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:r,arraySize:n}){if(e==="vertexX"){let i=r.split("_").map(s=>Number(s)-1);return i.length===2&&i.every((s,o)=>Number.isInteger(s)&&s>=0)?n?i.every((s,o)=>s<n[o])?[String(i)]:[]:[String(i)]:[]}else{let i=Number(r)-1;return Number.isInteger(i)&&i>=0?n?i<n[0]?Array.from(Array(n[1]),(s,o)=>i+","+o):[]:[i+",0"]:[]}},getAllArrayKeys(e,r=!0,n){function i(s){if(s.length===1)return Array.from(Array(s[0]),(o,l)=>String(l));{let o=s[0],l=i(s.slice(1)),u=[];for(let c=0;c<o;c++)r?u.push(...l.map(p=>c+","+p)):u.push(l.map(p=>c+","+p));return u}}if(n){if(n.length===0||!e)return[];{let s=[...e];return s[0]=n[0],i(s)}}else return!e||e.length===0?[]:i(e)},returnArraySizeDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),returnArraySize({dependencyValues:e}){return[e.nVertices,2]},returnArrayDependenciesByKey(){return{globalDependencies:{seriesNumber:{dependencyType:"stateVariable",variableName:"seriesNumber"},allIterates:{dependencyType:"stateVariable",variableName:"allIterates"}}}},arrayDefinitionByKey({globalDependencyValues:e,arraySize:r}){let n={};for(let i=0;i<r[0];i++){n[`${i},0`]=XE.fromAst(i);let s=e.allIterates[i];e.seriesNumber!==null&&(s=s.get_component(e.seriesNumber-1)),n[`${i},1`]=s}return{setValue:{vertices:n}}}},t.numericalVertices={isArray:!0,entryPrefixes:["numericalVertex"],forRenderer:!0,returnArraySizeDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),returnArraySize({dependencyValues:e}){return[e.nVertices]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={vertex:{dependencyType:"stateVariable",variableName:"vertex"+(Number(n)+1)}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r){let s=e[i].vertex.map(o=>o.evaluate_to_constant());s.every(o=>Number.isFinite(o))||(s=Array(s.length).fill(NaN)),n[i]=s}return{setValue:{numericalVertices:n}}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalVertices:{dependencyType:"stateVariable",variableName:"numericalVertices"},nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition({dependencyValues:e}){let r=e.nDimensions,n=e.nVertices,i=e.numericalVertices,s=[],o,l,u=i[0][0],c=i[0][1];for(let p=1;p<n;p++)if(o=u,l=c,u=i[p][0],c=i[p][1],!(Number.isFinite(o)&&Number.isFinite(l)&&Number.isFinite(u)&&Number.isFinite(c)))s.push(null);else{let m=(u-o)/xscale,f=(c-l)/yscale,d=m*m+f*f;d===0?s.push(null):s.push([m,f,d])}return{setValue:{nearestPoint:function({variables:p,scales:m}){let f=m[0],d=m[1];if(r!==2||n===0)return{};let h=1/0,y={},b=p.x1.evaluate_to_constant(),g=p.x2.evaluate_to_constant(),v,A,C=i[0][0],S=i[0][1];for(let w=1;w<n;w++){v=C,A=S,C=i[w][0],S=i[w][1];let x=s[w-1];if(x===null)continue;let[R,O,_]=x,k=((b-v)/f*R+(g-A)/d*O)/_,B;k<=0?B={x1:v,x2:A}:k>=1?B={x1:C,x2:S}:B={x1:v+k*R*f,x2:A+k*O*d};let U=Math.pow((b-B.x1)/f,2)+Math.pow((g-B.x2)/d,2);U<h&&(h=U,y=B)}return p.x3!==void 0&&Object.keys(y).length>0&&(y.x3=0),y}}}}},t}async movePolyline({pointCoords:t,transient:e,sourceInformation:r,actionId:n}){let i={};for(let s in t)i[s+",0"]=XE.fromAst(t[s][0]),i[s+",1"]=XE.fromAst(t[s][1]);return e?await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"vertices",value:i,sourceInformation:r}],transient:!0,actionId:n}):await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"vertices",value:i,sourceInformation:r}],actionId:n,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{pointCoordinates:t}}})}async finalizePolylinePosition(){return await this.actions.movePolyline({pointCoords:await this.stateValues.numericalVertices,transient:!1})}};T(lp,"componentType","discreteSimulationResultPolyline"),T(lp,"rendererType","polyline");import YE from"math-expressions";var si=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.rowNum={createComponentOfType:"text",createStateVariable:"rowNum",defaultValue:null,public:!0},e.colNum={createComponentOfType:"text",createStateVariable:"colNum",defaultValue:null,public:!0},e.colSpan={createComponentOfType:"integer",createStateVariable:"colSpan",defaultValue:1,public:!0,forRenderer:!0},e.halign={createComponentOfType:"text"},e.bottom={createComponentOfType:"text"},e.right={createComponentOfType:"text"},e.prefill={createComponentOfType:"text",createStateVariable:"prefill",defaultValue:"",public:!0},e}static returnChildGroups(){return[{group:"maths",componentTypes:["math"]},{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.halign={public:!0,componentType:"text",forRenderer:!0,hasEssential:!0,defaultValue:"left",returnDependencies:()=>({halignAttr:{dependencyType:"attributeComponent",attributeName:"halign",variableNames:["value"]},parentHalign:{dependencyType:"parentStateVariable",variableName:"halign"},tabularHalign:{dependencyType:"ancestor",componentType:"tabular",variableNames:["halign"]}}),definition({dependencyValues:e,usedDefault:r}){if(e.halignAttr!==null){let n=e.halignAttr.stateValues.value;return["left","center","right","justify"].includes(n)||(n="left"),{setValue:{halign:n}}}else return!r.parentHalign&&e.parentHalign?{setValue:{halign:e.parentHalign}}:!r.tabularHalign&&e.tabularHalign?{setValue:{halign:e.tabularHalign.stateValues.halign}}:{useEssentialOrDefaultValue:{halign:!0}}}},t.bottom={public:!0,componentType:"text",forRenderer:!0,hasEssential:!0,defaultValue:"none",returnDependencies:()=>({bottomAttr:{dependencyType:"attributeComponent",attributeName:"bottom",variableNames:["value"]},parentBottom:{dependencyType:"parentStateVariable",variableName:"bottom"},tabularBottom:{dependencyType:"ancestor",componentType:"tabular",variableNames:["bottom"]}}),definition({dependencyValues:e,usedDefault:r}){if(e.bottomAttr!==null){let n=e.bottomAttr.stateValues.value;return["none","minor","medium","major"].includes(n)||(n="none"),{setValue:{bottom:n}}}else return!r.parentBottom&&e.parentBottom?{setValue:{bottom:e.parentBottom}}:!r.tabularBottom&&e.tabularBottom?{setValue:{bottom:e.tabularBottom.stateValues.bottom}}:{useEssentialOrDefaultValue:{bottom:!0}}}},t.right={public:!0,componentType:"text",forRenderer:!0,hasEssential:!0,defaultValue:"none",returnDependencies:()=>({rightAttr:{dependencyType:"attributeComponent",attributeName:"right",variableNames:["value"]},tabularRight:{dependencyType:"ancestor",componentType:"tabular",variableNames:["right"]}}),definition({dependencyValues:e,usedDefault:r}){if(e.rightAttr!==null){let n=e.rightAttr.stateValues.value;return["none","minor","medium","major"].includes(n)||(n="none"),{setValue:{right:n}}}else return!r.tabularRight&&e.tabularRight?{setValue:{right:e.tabularRight.stateValues.right}}:{useEssentialOrDefaultValue:{right:!0}}}},t.inHeader={public:!0,componentType:"booloean",forRenderer:!0,defaultValue:!1,returnDependencies:()=>({parentHeader:{dependencyType:"parentStateVariable",variableName:"header"}}),definition({dependencyValues:e}){return{setValue:{inHeader:e.parentHeader===!0}}}},t.onlyMathChild={returnDependencies:()=>({mathChild:{dependencyType:"child",childGroups:["maths"]},otherChildren:{dependencyType:"child",childGroups:["anything"]}}),definition:({dependencyValues:e})=>({setValue:{onlyMathChild:e.mathChild.length===1&&e.otherChildren.length===0}})},t.text={public:!0,componentType:"text",hasEssential:!0,forRenderer:!0,returnDependencies:()=>({children:{dependencyType:"child",childGroups:["maths","anything"],variableNames:["text"],variablesOptional:!0},prefill:{dependencyType:"stateVariable",variableName:"prefill"}}),definition({dependencyValues:e}){if(e.children.length===0)return{useEssentialOrDefaultValue:{text:{defaultValue:e.prefill}}};let r="";for(let n of e.children)typeof n=="object"?n.stateValues.text&&(r+=n.stateValues.text):r+=n.toString();return{setValue:{text:r}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.children.length===0?{success:!0,instructions:[{setEssentialValue:"text",value:e.text===null?"":String(e.text)}]}:r.children.length===1?typeof r.children[0]=="object"&&r.children[0].stateValues.text===void 0?{success:!1}:{success:!0,instructions:[{setDependency:"children",desiredValue:e.text,childIndex:0,variableIndex:0}]}:{success:!1}}},t.math={public:!0,componentType:"math",stateVariablesDeterminingDependencies:["onlyMathChild"],returnDependencies({stateValues:e}){return e.onlyMathChild?{mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]}}:{text:{dependencyType:"stateVariable",variableName:"text"}}},definition({dependencyValues:e}){if(e.mathChild)return{setValue:{math:e.mathChild[0].stateValues.value}};{let r;try{r=YE.fromAst(pn.convert(e.text))}catch(n){r=YE.fromAst("\uFF3F")}return{setValue:{math:r}}}},async inverseDefinition({desiredStateVariableValues:e,dependencyValues:r,stateValues:n,workspace:i}){if(r.mathChild)return{success:!0,instructions:[{setDependency:"mathChild",desiredValue:e.math,childIndex:0,variableIndex:0}]};{let s=await Ql({desiredValue:e.math,stateValues:n,variableName:"math",workspace:i});return{success:!0,instructions:[{setDependency:"text",desiredValue:s.desiredValue.toString()}]}}}},t.number={public:!0,componentType:"number",returnDependencies:()=>({math:{dependencyType:"stateVariable",variableName:"math"}}),definition({dependencyValues:e}){let r=e.math.evaluate_to_constant();return Number.isFinite(r)||(r=NaN),{setValue:{number:r}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"math",desiredValue:YE.fromAst(e.number)}]}}},t}};T(si,"componentType","cell"),T(si,"rendererType","cell"),T(si,"renderChildren",!0),T(si,"includeBlankStringChildren",!0),T(si,"primaryStateVariableForDefinition","text"),T(si,"adapters",["text","math","number"]);var bl=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.rowNum={createComponentOfType:"text",createStateVariable:"rowNum",defaultValue:null,public:!0},e.header={createComponentOfType:"boolean",createStateVariable:"header",defaultValue:!1,public:!0,forRenderer:!0},e.halign={createComponentOfType:"text"},e.valign={createComponentOfType:"text"},e.left={createComponentOfType:"text"},e.bottom={createComponentOfType:"text"},e}static returnChildGroups(){return[{group:"cells",componentTypes:["cell"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.halign={public:!0,componentType:"text",defaultValue:"left",hasEssential:!0,returnDependencies:()=>({halignAttr:{dependencyType:"attributeComponent",attributeName:"halign",variableNames:["value"]},parentHalign:{dependencyType:"parentStateVariable",variableName:"halign"}}),definition({dependencyValues:e,usedDefault:r}){if(e.halignAttr!==null){let n=e.halignAttr.stateValues.value;return["left","center","right","justify"].includes(n)||(n="left"),{setValue:{halign:n}}}else return e.parentHalign!==null&&!r.parentHalign?{setValue:{halign:e.parentHalign}}:{useEssentialOrDefaultValue:{halign:!0}}}},t.valign={public:!0,componentType:"text",forRenderer:!0,defaultValue:"middle",hasEssential:!0,returnDependencies:()=>({valignAttr:{dependencyType:"attributeComponent",attributeName:"valign",variableNames:["value"]},parentValign:{dependencyType:"parentStateVariable",variableName:"valign"}}),definition({dependencyValues:e,usedDefault:r}){if(e.valignAttr!==null){let n=e.valignAttr.stateValues.value;return["top","middle","bottom"].includes(n)||(n="middle"),{setValue:{valign:n}}}else return e.parentValign!==null&&!r.parentValign?{setValue:{valign:e.parentValign}}:{useEssentialOrDefaultValue:{valign:!0}}}},t.left={public:!0,componentType:"text",forRenderer:!0,defaultValue:"none",hasEssential:!0,returnDependencies:()=>({leftAttr:{dependencyType:"attributeComponent",attributeName:"left",variableNames:["value"]},parentLeft:{dependencyType:"parentStateVariable",variableName:"left"}}),definition({dependencyValues:e,usedDefault:r}){if(e.leftAttr!==null){let n=e.leftAttr.stateValues.value;return["none","minor","medium","major"].includes(n)||(n="none"),{setValue:{left:n}}}else return e.parentLeft!==null&&!r.parentLeft?{setValue:{left:e.parentLeft}}:{useEssentialOrDefaultValue:{left:!0}}}},t.bottom={public:!0,componentType:"text",defaultValue:"none",hasEssential:!0,returnDependencies:()=>({bottomAttr:{dependencyType:"attributeComponent",attributeName:"bottom",variableNames:["value"]},parentBottom:{dependencyType:"parentStateVariable",variableName:"bottom"}}),definition({dependencyValues:e,usedDefault:r}){if(e.bottomAttr!==null){let n=e.bottomAttr.stateValues.value;return["none","minor","medium","major"].includes(n)||(n="none"),{setValue:{bottom:n}}}else return e.parentBottom!==null&&!r.parentBottom?{setValue:{bottom:e.parentBottom}}:{useEssentialOrDefaultValue:{bottom:!0}}}},t.prescribedCellsWithColNum={returnDependencies:()=>({cellChildren:{dependencyType:"child",childGroups:["cells"],variableNames:["colNum"]}}),definition({dependencyValues:e}){return{setValue:{prescribedCellsWithColNum:e.cellChildren}}}},t}};T(bl,"componentType","row"),T(bl,"rendererType","row"),T(bl,"renderChildren",!0);var gl=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.colNum={createComponentOfType:"text",createStateVariable:"colNum",defaultValue:null,public:!0},e}static returnChildGroups(){return[{group:"cells",componentTypes:["cell"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.prescribedCellsWithRowNum={returnDependencies:()=>({cellChildren:{dependencyType:"child",childGroups:["cells"],variableNames:["rowNum"]}}),definition({dependencyValues:e}){return{setValue:{prescribedCellsWithRowNum:e.cellChildren}}}},t}};T(gl,"componentType","column"),T(gl,"rendererType","container"),T(gl,"renderChildren",!0);var up=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.rowNum={createComponentOfType:"text",createStateVariable:"rowNum",defaultValue:null,public:!0},e.colNum={createComponentOfType:"text",createStateVariable:"colNum",defaultValue:null,public:!0},e}static returnChildGroups(){return[{group:"children",componentTypes:["cell","row","column","cellblock"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.prescribedCellsRowsColumnsBlocks={returnDependencies:()=>({cellRelatedChildren:{dependencyType:"child",childGroups:["children"],variableNames:["rowNum","colNum","prescribedCellsWithColNum","prescribedCellsWithRowNum","prescribedCellsRowsColumnsBlocks"],variablesOptional:!0}}),definition({dependencyValues:e}){return{setValue:{prescribedCellsRowsColumnsBlocks:e.cellRelatedChildren}}}},t}};T(up,"componentType","cellBlock"),T(up,"rendererType","container");var vl=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:{size:100,isAbsolute:!1},public:!0,forRenderer:!0},e.height={createComponentOfType:"_componentSize",createStateVariable:"height",defaultValue:null,public:!0,forRenderer:!0},e.halign={createComponentOfType:"text",createStateVariable:"halign",defaultValue:"left",public:!0,validValues:["left","center","right","justify"]},e.valign={createComponentOfType:"text",createStateVariable:"valign",defaultValue:"middle",public:!0,validValues:["top","middle","bottom"]},e.top={createComponentOfType:"text",createStateVariable:"top",defaultValue:"none",public:!0,validValues:["none","minor","medium","major"],forRenderer:!0},e.left={createComponentOfType:"text",createStateVariable:"left",defaultValue:"none",public:!0,validValues:["none","minor","medium","major"]},e.bottom={createComponentOfType:"text",createStateVariable:"bottom",defaultValue:"none",public:!0,validValues:["none","minor","medium","major"]},e.right={createComponentOfType:"text",createStateVariable:"right",defaultValue:"none",public:!0,validValues:["none","minor","medium","major"]},e}static returnChildGroups(){return[{group:"rows",componentTypes:["row"]}]}static returnStateVariableDefinitions(){return super.returnStateVariableDefinitions()}};T(vl,"componentType","tabular"),T(vl,"rendererType","tabular"),T(vl,"renderChildren",!0);var cp=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.suppressTableNameInTitle={createComponentOfType:"boolean",createStateVariable:"suppressTableNameInTitle",defaultValue:!1,forRenderer:!0},e.number={createComponentOfType:"boolean",createStateVariable:"number",defaultValue:!0,forRenderer:!0},e}static returnChildGroups(){return[{group:"titles",componentTypes:["title"]},{group:"inlinesBlocks",componentTypes:["_inline","_block"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.tableEnumeration={public:!0,componentType:"text",forRenderer:!0,stateVariablesDeterminingDependencies:["number"],additionalStateVariablesDefined:[{variableName:"tableName",public:!0,componentType:"text",forRenderer:!0}],returnDependencies({stateValues:e}){let r={};return e.number&&(r.tableCounter={dependencyType:"counter",counterName:"table"}),r},definition({dependencyValues:e}){if(e.tableCounter===void 0)return{setValue:{tableEnumeration:null,tableName:"Table"}};let r=String(e.tableCounter),n="Table "+r;return{setValue:{tableEnumeration:r,tableName:n}}}},t.titleChildName={forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childGroups:["titles"]}}),definition({dependencyValues:e}){let r=null;return e.titleChild.length>0&&(r=e.titleChild[0].componentName),{setValue:{titleChildName:r}}}},t.title={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childGroups:["titles"],variableNames:["text"]}}),definition({dependencyValues:e}){let r=null;return e.titleChild.length>0&&(r=e.titleChild[0].stateValues.text),{setValue:{title:r}}}},t}};T(cp,"componentType","table"),T(cp,"renderChildren",!0);var pp=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.suppressFigureNameInCaption={createComponentOfType:"boolean",createStateVariable:"suppressFigureNameInCaption",defaultValue:!1,forRenderer:!0},e.number={createComponentOfType:"boolean",createStateVariable:"number",defaultValue:!0,forRenderer:!0},e}static returnChildGroups(){return[{group:"captions",componentTypes:["caption"]},{group:"inlinesBlocks",componentTypes:["_inline","_block"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.figureEnumeration={public:!0,componentType:"text",forRenderer:!0,stateVariablesDeterminingDependencies:["number"],additionalStateVariablesDefined:[{variableName:"figureName",public:!0,componentType:"text",forRenderer:!0}],returnDependencies({stateValues:e}){let r={};return e.number&&(r.figureCounter={dependencyType:"counter",counterName:"figure"}),r},definition({dependencyValues:e}){if(e.figureCounter===void 0)return{setValue:{figureEnumeration:null,figureName:"Figure"}};let r=String(e.figureCounter),n="Figure "+r;return{setValue:{figureEnumeration:r,figureName:n}}}},t.captionChildName={forRenderer:!0,returnDependencies:()=>({captionChild:{dependencyType:"child",childGroups:["captions"]}}),definition({dependencyValues:e}){let r=null;return e.captionChild.length>0&&(r=e.captionChild[0].componentName),{setValue:{captionChildName:r}}}},t.caption={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({captionChild:{dependencyType:"child",childGroups:["captions"],variableNames:["text"]}}),definition({dependencyValues:e}){let r=null;return e.captionChild.length>0&&(r=e.captionChild[0].stateValues.text),{setValue:{caption:r}}}},t}};T(pp,"componentType","figure"),T(pp,"renderChildren",!0);var Tl=class extends J{static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=r.reduce(function(i,s){return typeof s=="string"?[...i,...s.split(/\s+/).filter(o=>o)]:[...i,s]},[]);return{success:!0,newChildren:n}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"strings",componentTypes:["string"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nVariants={public:!0,componentType:"number",returnDependencies:()=>({stringChildren:{dependencyType:"child",childGroups:["strings"]}}),definition:function({dependencyValues:e}){return{setValue:{nVariants:e.stringChildren.length}}}},t.variantNames={public:!0,componentType:"variantName",isArray:!0,entryPrefixes:["variantName"],returnArraySizeDependencies:()=>({nVariants:{dependencyType:"stateVariable",variableName:"nVariants"}}),returnArraySize({dependencyValues:e}){return[e.nVariants]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={stringChild:{dependencyType:"child",childGroups:["strings"],variableNames:["value"],childIndices:[n]}};return{dependenciesByKey:r}},arrayDefinitionByKey:function({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r)e[i].stringChild.length===1&&(n[i]=e[i].stringChild[0].toLowerCase().substring(0,1e3));return{setValue:{variantNames:n}}}},t}};T(Tl,"componentType","variantNames"),T(Tl,"rendererType"),T(Tl,"stateVariableForAttributeValue","variantNames");var mp=class extends re{static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=r.reduce(function(i,s){return typeof s=="string"?[...i,...s.split(/\s+/).filter(o=>o)]:[...i,s]},[]);return{success:!0,newChildren:n}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"strings",componentTypes:["string"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nSeeds={public:!0,componentType:"number",returnDependencies:()=>({stringChildren:{dependencyType:"child",childGroups:["strings"]}}),definition:function({dependencyValues:e}){return{setValue:{nSeeds:e.stringChildren.length}}}},t.seeds={public:!0,componentType:"seed",isArray:!0,entryPrefixes:["seed"],returnArraySizeDependencies:()=>({nSeeds:{dependencyType:"stateVariable",variableName:"nSeeds"}}),returnArraySize({dependencyValues:e}){return[e.nSeeds]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={stringChild:{dependencyType:"child",childGroups:["strings"],variableNames:["value"],childIndices:[n]}};return{dependenciesByKey:r}},arrayDefinitionByKey:function({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r)e[i].stringChild.length===1&&(n[i]=e[i].stringChild[0]);return{setValue:{seeds:n}}}},t}};T(mp,"componentType","seeds"),T(mp,"rendererType");var fp=class extends J{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.nVariants={createPrimitiveOfType:"integer",createStateVariable:"nVariants",defaultValue:100,clamp:[1,999],public:!0},e.uniqueVariants={createPrimitiveOfType:"boolean",createStateVariable:"uniqueVariants",defaultValue:!1,public:!0},e.variantNames={createComponentOfType:"variantNames"},e.seeds={createComponentOfType:"seeds"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nVariantsSpecified={returnDependencies:({sharedParameters:e})=>({uniqueVariants:{dependencyType:"stateVariable",variableName:"uniqueVariants"},numberOfVariantsFromSharedParameters:{dependencyType:"value",value:e.numberOfVariants},nVariants:{dependencyType:"stateVariable",variableName:"nVariants"}}),definition:function({dependencyValues:e}){let r=e.nVariants;return r<1&&(r=1),e.uniqueVariants&&(e.numberOfVariantsFromSharedParameters!==void 0?r=e.numberOfVariantsFromSharedParameters:console.log("Restricting to unique variants was not successful")),{setValue:{nVariantsSpecified:r}}}},t.nSeeds={public:!0,componentType:"number",returnDependencies:()=>({seedsAttr:{dependencyType:"attributeComponent",attributeName:"seeds",variableNames:["nSeeds"]}}),definition:function({dependencyValues:e}){return e.seedsAttr!==null?{setValue:{nSeeds:e.seedsAttr.stateValues.nSeeds}}:{setValue:{nSeeds:0}}}},t.seeds={public:!0,componentType:"seed",isArray:!0,entryPrefixes:["seed"],returnArraySizeDependencies:()=>({nSeeds:{dependencyType:"stateVariable",variableName:"nSeeds"}}),returnArraySize({dependencyValues:e}){return[e.nSeeds]},returnArrayDependenciesByKey({arrayKeys:e}){let r={};for(let n of e)r[n]={seedsAttr:{dependencyType:"attributeComponent",attributeName:"seeds",variableNames:["seed"+(Number(n)+1)]}};return{dependenciesByKey:r}},arrayDefinitionByKey:function({dependencyValuesByKey:e,arrayKeys:r}){let n={};for(let i of r)e[i].seedsAttr!==null&&(n[i]=e[i].seedsAttr.stateValues["seed"+(Number(i)+1)]);return{setValue:{seeds:n}}}},t.originalVariantNames={returnDependencies:()=>({variantNamesAttr:{dependencyType:"attributeComponent",attributeName:"variantNames",variableNames:["variantNames"]}}),definition:function({dependencyValues:e}){let r=[];return e.variantNamesAttr!==null&&(r=e.variantNamesAttr.stateValues.variantNames),{setValue:{originalVariantNames:r}}}},t.variantNames={public:!0,componentType:"variantName",isArray:!0,entryPrefixes:["variantName"],returnArraySizeDependencies:()=>({nVariantsSpecified:{dependencyType:"stateVariable",variableName:"nVariantsSpecified"}}),returnArraySize({dependencyValues:e}){return[e.nVariantsSpecified]},returnArrayDependenciesByKey({arrayKeys:e}){return{globalDependencies:{originalVariantNames:{dependencyType:"stateVariable",variableName:"originalVariantNames"},nVariantsSpecified:{dependencyType:"stateVariable",variableName:"nVariantsSpecified"}}}},arrayDefinitionByKey:function({globalDependencyValues:e,arrayKeys:r}){let n=[...e.originalVariantNames],i=n.length,s=i,o;for(;i<e.nVariantsSpecified;){for(i++,s++,o=EU(s);e.originalVariantNames.includes(o);)s++,o=EU(s);n.push(o)}return{setValue:{variantNames:n}}}},t.selectedVariantIndex={public:!0,componentType:"number",immutable:!0,hasEssential:!0,shadowVariable:!0,returnDependencies:({sharedParameters:e})=>({variantsObject:{dependencyType:"variants"},originalVariantNames:{dependencyType:"stateVariable",variableName:"originalVariantNames"},variantNames:{dependencyType:"stateVariable",variableName:"variantNames"},nVariantsSpecified:{dependencyType:"stateVariable",variableName:"nVariantsSpecified"},variantRng:{dependencyType:"value",value:e.variantRng,doNotProxy:!0}}),definition:function({dependencyValues:e}){if(e.variantsObject!==void 0){if(e.variantsObject.desiredVariantIndex!==void 0){let n=Number(e.variantsObject.desiredVariantIndex);if(Number.isFinite(n)){Number.isInteger(n)||(console.warn("Variant index "+e.variantsObject.desiredVariantIndex+" must be an integer"),n=Math.round(n));let i=(n-1)%e.nVariantsSpecified;i<0&&(i+=e.nVariantsSpecified);let s=i+1;return{setEssentialValue:{selectedVariantIndex:s},setValue:{selectedVariantIndex:s}}}else return console.warn("Variant index "+e.variantsObject.desiredVariantIndex+" must be a number"),{setEssentialValue:{selectedVariantIndex:!0},setValue:{selectedVariantIndex:1}}}if(e.variantsObject.desiredVariantName!==void 0){if(typeof e.variantsObject.desiredVariantName=="string"){let n=e.originalVariantNames.map(o=>o.toLowerCase()),s=[...n,...e.variantNames.slice(n.length)].indexOf(e.variantsObject.desiredVariantName.toLowerCase());if(s!==-1)return{setEssentialValue:{selectedVariantIndex:s+1},setValue:{selectedVariantIndex:s+1}}}return console.warn("Variant name "+e.variantsObject.desiredVariantName+" is not valid"),{setEssentialValue:{selectedVariantIndex:1},setValue:{selectedVariantIndex:1}}}}let r;if(e.variantRng){let n=e.variantRng();r=Math.floor(n*e.nVariantsSpecified)+1}else r=1;return{setEssentialValue:{selectedVariantIndex:r},setValue:{selectedVariantIndex:r}}}},t.selectedVariantName={public:!0,componentType:"text",returnDependencies:()=>({variantNames:{dependencyType:"stateVariable",variableName:"variantNames"},selectedVariantIndex:{dependencyType:"stateVariable",variableName:"selectedVariantIndex"}}),definition:function({dependencyValues:e}){return{setValue:{selectedVariantName:e.variantNames[e.selectedVariantIndex-1]}}}},t.selectedSeed={returnDependencies:()=>({selectedVariantIndex:{dependencyType:"stateVariable",variableName:"selectedVariantIndex"},seeds:{dependencyType:"stateVariable",variableName:"seeds"}}),definition:function({dependencyValues:e}){if(e.selectedVariantIndex<=e.seeds.length)return{setValue:{selectedSeed:e.seeds[e.selectedVariantIndex-1]}};let r=e.seeds.length,n=r,i;for(;r<e.selectedVariantIndex;)for(r++,n++,i=n.toString();e.seeds.includes(i);)n++,i=n.toString();return{setValue:{selectedSeed:i}}}},t.variantRng={returnDependencies:({sharedParameters:e})=>({selectedSeed:{dependencyType:"stateVariable",variableName:"selectedSeed"},rngClass:{dependencyType:"value",value:e.rngClass,doNotProxy:!0}}),definition:({dependencyValues:e})=>({setValue:{variantRng:new e.rngClass(e.selectedSeed)}})},t}};T(fp,"componentType","variantControl"),T(fp,"rendererType");function EU(a){return pu(a,!0)}import"math-expressions";var Nl=class extends wi{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.numberToSelect={createComponentOfType:"integer",createStateVariable:"numberToSelect",defaultValue:1,public:!0},e.withReplacement={createComponentOfType:"boolean",createStateVariable:"withReplacement",defaultValue:!1,public:!0},e.sortResults={createComponentOfType:"boolean",createStateVariable:"sortResults",defaultValue:!1,public:!0},e.excludeCombinations={createComponentOfType:"_componentListOfListsWithSelectableType"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();t.excludedCombinations={returnDependencies:()=>({excludeCombinations:{dependencyType:"attributeComponent",attributeName:"excludeCombinations",variableNames:["lists"]}}),definition:function({dependencyValues:r}){return r.excludeCombinations!==null?{setValue:{excludedCombinations:r.excludeCombinations.stateValues.lists}}:{setValue:{excludedCombinations:[]}}}},t.variants={returnDependencies:()=>({variants:{dependencyType:"variants"}}),definition:function({dependencyValues:r}){return{setValue:{variants:r.variants}}}},t.selectedValues={immutable:!0,hasEssential:!0,shadowVariable:!0,additionalStateVariablesDefined:[{variableName:"selectedIndices",hasEssential:!0,shadowVariable:!0,immutable:!0}],returnDependencies:({sharedParameters:r})=>({numberToSelect:{dependencyType:"stateVariable",variableName:"numberToSelect"},withReplacement:{dependencyType:"stateVariable",variableName:"withReplacement"},length:{dependencyType:"stateVariable",variableName:"length"},from:{dependencyType:"stateVariable",variableName:"from"},step:{dependencyType:"stateVariable",variableName:"step"},exclude:{dependencyType:"stateVariable",variableName:"exclude"},excludedCombinations:{dependencyType:"stateVariable",variableName:"excludedCombinations"},type:{dependencyType:"stateVariable",variableName:"type"},lowercase:{dependencyType:"stateVariable",variableName:"lowercase"},sortResults:{dependencyType:"stateVariable",variableName:"sortResults"},variants:{dependencyType:"stateVariable",variableName:"variants"},variantRng:{dependencyType:"value",value:r.variantRng,doNotProxy:!0}}),definition:dTe},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),definition({dependencyValues:r,componentName:n}){return{setValue:{generatedVariantInfo:{indices:r.selectedIndices,meta:{createdBy:n}}}}}};let e=t.readyToExpandWhenResolved.returnDependencies;return t.readyToExpandWhenResolved.returnDependencies=function(){let r=e();return r.selectedValues={dependencyType:"stateVariable",variableName:"selectedValues"},r},t}static async createSerializedReplacements({component:t,componentInfoObjects:e,flags:r}){let n=await t.stateValues.type;n==="letters"&&(n="text");let i=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,s={};"fixed"in t.attributes&&(s=Ze({attributes:{fixed:t.attributes.fixed},componentType:n,componentInfoObjects:e,compositeCreatesNewNamespace:i,flags:r}));let o=[];for(let u of await t.stateValues.selectedValues)o.push({componentType:n,attributes:s,state:{value:u,fixed:!0}});return{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:o,parentName:t.componentName,parentCreatesNewNamespace:i,componentInfoObjects:e}).serializedComponents}}static calculateReplacementChanges(){return[]}static determineNumberOfUniqueVariants({serializedComponent:t}){let e=1,r=!1,n=t.attributes.type.primitive,i=t.attributes.numberToSelect?.component;if(i)if(i.componentType==="integer"&&i.children?.length===1&&typeof i.children[0]=="string"){if(e=Number(i.children[0]),!(Number.isInteger(e)&&e>=0))return console.log("cannot determine unique variants of selectFromSequence as numberToSelect isn't a non-negative integer."),{success:!1}}else return console.log("cannot determine unique variants of selectFromSequence as numberToSelect isn't constant number."),{success:!1};let s=t.attributes.withReplacement?.component;if(s)if(s.componentType==="boolean")if(s.children?.length===1&&typeof s.children[0]=="string")r=s.children[0].toLowerCase()==="true";else if((s.children===void 0||s.children.length===0)&&typeof s.state?.value=="boolean")r=s.state.value;else return console.log("cannot determine unique variants of selectFromSequence as withReplacement isn't constant boolean."),{success:!1};else return console.log("cannot determine unique variants of selectFromSequence as withReplacement isn't constant boolean."),{success:!1};let o={from:null,to:null,step:null,length:null},l=t.attributes.from?.component;if(l){let g=l.children[0];if(g.children?.length===1&&typeof g.children[0]=="string"){let v;if(n==="number"){if(v=Number(g.children[0]),!Number.isFinite(v))return console.log("cannot determine unique variants of selectFromSequence of number type as from isn't a number."),{success:!1}}else if(n==="letters"){if(v=di(g.children[0]),!Number.isFinite(v))return console.log("cannot determine unique variants of selectFromSequence of letters type as from isn't a combination of letters."),{success:!1}}else{let A=la({functionSymbols:["f","g"]});try{v=A(g.children[0])}catch(C){return console.log("cannot determine unique variants of selectFromSequence of math type as from isn't a valid math expression."),{success:!1}}}o.from=v}else return console.log("cannot determine unique variants of selectFromSequence as from isn't a constant."),{success:!1}}let u=t.attributes.to?.component;if(u){let g=u.children[0];if(g.children?.length===1&&typeof g.children[0]=="string"){let v;if(n==="number"){if(v=Number(g.children[0]),!Number.isFinite(v))return console.log("cannot determine unique variants of selectFromSequence of number type as to isn't a number."),{success:!1}}else if(n==="letters"){if(v=di(g.children[0]),!Number.isFinite(v))return console.log("cannot determine unique variants of selectFromSequence of letters type as to isn't a combination of letters."),{success:!1}}else{let A=la({functionSymbols:["f","g"]});try{v=A(g.children[0])}catch(C){return console.log("cannot determine unique variants of selectFromSequence of math type as to isn't a valid math expression."),{success:!1}}}o.to=v}else return console.log("cannot determine unique variants of selectFromSequence as to isn't a constant."),{success:!1}}let c=t.attributes.step?.component;if(c)if(c.children?.length===1&&typeof c.children[0]=="string"){let g;if(n==="number"){if(g=Number(c.children[0]),!Number.isFinite(g))return console.log("cannot determine unique variants of selectFromSequence of number type as step isn't a number."),{success:!1}}else if(n==="letters"){if(g=Number(c.children[0]),!Number.isInteger(g))return console.log("cannot determine unique variants of selectFromSequence of letters type as step isn't an integer."),{success:!1}}else{let v=la({functionSymbols:["f","g"]});try{g=v(c.children[0])}catch(A){return console.log("cannot determine unique variants of selectFromSequence of math type as step isn't a valid math expression."),{success:!1}}}o.step=g}else return console.log("cannot determine unique variants of selectFromSequence as step isn't a constant."),{success:!1};let p=t.attributes.length?.component;if(p)if(p.children?.length===1&&typeof p.children[0]=="string"){let g=Number(p.children[0]);if(!Number.isInteger(g))return console.log("cannot determine unique variants of selectFromSequence as length isn't an integer."),{success:!1};o.length=g}else return console.log("cannot determine unique variants of selectFromSequence as length isn't a constant."),{success:!1};if(t.attributes.excludeCombinations)return console.log("have not implemented unique variants of a selectFromSequence with excludeCombinations"),{success:!0};let m=[],f=t.attributes.exclude?.component;if(f){if(n==="math"&&console.log("have not implemented unique variants of a selectFromSequence of type math with exclude"),!f.children.every(g=>g.children.length===1&&typeof g.children[0]=="string"))return console.log("have not implemented unique variants of a selectFromSequence with non-constant exclude"),{success:!0};if(n==="letters"?m=f.children.map(g=>di(g.children[0])):m=f.children.map(g=>Number(g.children[0])),!m.every(Number.isFinite))return console.log("have not implemented unique variants of a selectFromSequence with non-constant exclude"),{success:!0}}o=mT(o);let d=o.length,h=[];if(m.length>0&&n!=="math"){m.sort((g,v)=>g-v),m=m.filter((g,v,A)=>g!=A[v-1]);for(let g of m){if(g<o.from)continue;let v=(g-o.from)/o.step;if(v>o.length-1+1e-10)break;Math.abs(v-Math.round(v))<1e-10&&(d--,h.push(v))}}if(d<=0)return{success:!1};let y={excludeIndices:h,nOptions:d,numberToSelect:e,withReplacement:r};t.variants.uniqueVariantData=y;let b;if(r||e===1)b=Math.pow(d,e);else{b=d;for(let g=d-1;g>d-e;g--)b*=g}return t.variants.numberOfVariants=b,{success:!0,numberOfVariants:b}}static getUniqueVariant({serializedComponent:t,variantIndex:e}){let r=t.variants?.numberOfVariants;if(r===void 0)return{success:!1};if(!Number.isInteger(e)||e<1||e>r)return{success:!1};let n=t.variants.uniqueVariantData,i=n.excludeIndices,s=n.nOptions,o=n.numberToSelect,l=n.withReplacement,u=function(m){let f=m;for(let d of i)f>=d&&f++;return f};if(o===1)return{success:!0,desiredVariant:{indices:[u(e-1)+1]}};let p=em({numberOfIndices:o,numberOfOptions:s,maxNumber:e,withReplacement:l})[e-1].map(u).map(m=>m+1);return{success:!0,desiredVariant:{indices:p}}}};T(Nl,"componentType","selectFromSequence"),T(Nl,"assignNamesToReplacements",!0),T(Nl,"createsVariants",!0);function dTe({dependencyValues:a}){if(a.numberToSelect<1)return{setEssentialValue:{selectedValues:[],selectedIndices:[]},setValue:{selectedValues:[],selectedIndices:[]}};let t=1;if(a.withReplacement||(t=a.numberToSelect),t>a.length)throw Error("Cannot select "+t+" values from a sequence of length "+a.length);if(a.variants&&a.variants.desiredVariant!==void 0){let i=a.variants.desiredVariant.indices;if(i!==void 0){if(i.length!==a.numberToSelect)throw Error("Number of indices specified for select must match number to select");if(i=i.map(Number),!i.every(Number.isInteger))throw Error("All indices specified for select must be integers");let s=a.length;i=i.map(l=>((l-1)%s+s)%s+1);let o=[];for(let l of i){let u=Co({index:l-1,from:a.from,step:a.step,length:a.length,exclude:a.exclude,type:a.type,lowercase:a.lowercase});if(u===null)throw Error("Specified index of selectfromsequence that was excluded");o.push(u)}if(xU({type:a.type,excludedCombinations:a.excludedCombinations,values:o}))throw Error("Specified indices of selectfromsequence that was an excluded combination");return{setEssentialValue:{selectedValues:o,selectedIndices:i},setValue:{selectedValues:o,selectedIndices:i}}}}let e=a.excludedCombinations.length,r,n;if(e===0){let i=RU({stateValues:a,numberUniqueRequired:t,numberToSelect:a.numberToSelect,withReplacement:a.withReplacement,rng:a.variantRng});r=i.selectedValues,n=i.selectedIndices}else{let i=a.length-a.exclude.length;if(a.withReplacement)i=Math.pow(i,a.numberToSelect);else{let o=i;for(let l=1;l<a.numberToSelect;l++)i*=o-l}if(e>.7*i){let o=0;for(let l=0;l<a.length;l++)Co({index:l,from:a.from,step:a.step,length:a.length,exclude:a.exclude,type:a.type})!==null&&o++;if(a.withReplacement)o=Math.pow(o,a.numberToSelect);else{let l=o;for(let u=1;u<a.numberToSelect;u++)o*=l-u}if(e>.7*o)throw Error("Excluded over 70% of combinations in selectFromSequence")}let s=!1;for(let o=0;o<200;o++){let l=RU({stateValues:a,numberUniqueRequired:t,numberToSelect:a.numberToSelect,withReplacement:a.withReplacement,rng:a.variantRng});if(r=l.selectedValues,n=l.selectedIndices,!xU({type:a.type,excludedCombinations:a.excludedCombinations,values:r})){s=!0;break}}if(!s)throw Error("By extremely unlikely fluke, couldn't select combination of random values")}if(a.sortResults){let i=[];for(let[s,o]of r.entries())i.push({value:o,index:n[s]});a.type==="number"?i.sort((s,o)=>s.value-o.value):a.type==="letters"&&i.sort((s,o)=>di(s.value)-di(o.value)),r=i.map(s=>s.value),n=i.map(s=>s.index)}return{setEssentialValue:{selectedValues:r,selectedIndices:n},setValue:{selectedValues:r,selectedIndices:n}}}function RU({stateValues:a,numberUniqueRequired:t=1,numberToSelect:e=1,withReplacement:r=!1,rng:n}){let i=[],s=[];if(a.exclude.length+t<.5*a.length){for(let c=0;c<e;c++){let p=!1,m,f;for(let d=0;d<100;d++){let h=n();if(f=Math.floor(h*a.length)+1,!(!r&&s.includes(f))&&(m=Co({index:f-1,from:a.from,step:a.step,exclude:a.exclude,type:a.type,lowercase:a.lowercase}),m!==null)){p=!0;break}}if(!p)throw Error("By extremely unlikely fluke, couldn't select random value");i.push(m),s.push(f)}return{selectedValues:i,selectedIndices:s}}let o=cu(a,!0),l=o.length;if(t>l)throw Error("Cannot select "+t+" unique values from sequence of length "+l);if(t===1){for(let c=0;c<e;c++){let p=n(),m=Math.floor(p*l);s.push(o[m].originalIndex+1),i.push(o[m].value)}return{selectedValues:i,selectedIndices:s}}for(let c=o.length-1;c>0;c--){let p=n(),m=Math.floor(p*(c+1));[o[c],o[m]]=[o[m],o[c]]}let u=o.slice(0,e);return i=u.map(c=>c.value),s=u.map(c=>c.originalIndex+1),{selectedValues:i,selectedIndices:s}}function xU({type:a,excludedCombinations:t,values:e}){return a==="math"?t.some(r=>r.every((n,i)=>n.equals(e[i]))):a==="number"?t.some(r=>r.every((n,i)=>Math.abs(n-e[i])<=1e-14*Math.max(Math.abs(n),Math.abs(e[i])))):t.some(r=>r.every((n,i)=>n===e[i]))}import"math-expressions";var ss=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.numberToSelect={createComponentOfType:"integer",createStateVariable:"numberToSelect",defaultValue:1,public:!0},e.withReplacement={createComponentOfType:"boolean",createStateVariable:"withReplacement",defaultValue:!1,public:!0},e.type={createPrimitiveOfType:"string"},e.skipOptionsInAssignNames={createPrimitiveOfType:"boolean",createStateVariable:"skipOptionsInAssignNames",defaultValue:!1},e}static returnSugarInstructions(){let t=super.returnSugarInstructions();function e({matchedChildren:r,componentAttributes:n,componentInfoObjects:i}){if(!r.every(u=>typeof u=="string"||u.doenetAttributes&&u.doenetAttributes.createdFromMacro))return{success:!1};let s;n.type?s=n.type:s="math",["math","text","number","boolean"].includes(s)||(console.warn(`Invalid type ${s}`),s="math");let l=Un({componentType:s,forceComponentType:!0})({matchedChildren:r,componentInfoObjects:i});if(l.success){let u=l.newChildren.map(p=>({componentType:"option",children:[p]}));return{success:!0,newChildren:u,newAttributes:{skipOptionsInAssignNames:{primitive:!0}}}}else return{success:!1}}return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"options",componentTypes:["option"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.variants={returnDependencies:()=>({variants:{dependencyType:"variants"}}),definition:function({dependencyValues:e}){return{setValue:{variants:e.variants}}}},t.currentVariantName={returnDependencies:({sharedParameters:e})=>({variantName:{dependencyType:"value",value:e.variantName}}),definition:({dependencyValues:e})=>({setValue:{currentVariantName:e.variantName}})},t.allPossibleVariants={returnDependencies:({sharedParameters:e})=>({allPossibleVariants:{dependencyType:"value",value:e.allPossibleVariants}}),definition:({dependencyValues:e})=>({setValue:{allPossibleVariants:e.allPossibleVariants}})},t.nOptions={additionalStateVariablesDefined:["optionChildren"],returnDependencies:()=>({optionChildren:{dependencyType:"child",childGroups:["options"],variableNames:["selectForVariantNames","selectWeight"]}}),definition({dependencyValues:e}){return{setValue:{optionChildren:e.optionChildren,nOptions:e.optionChildren.length}}}},t.availableVariants={returnDependencies:()=>({optionChildren:{dependencyType:"stateVariable",variableName:"optionChildren"},numberToSelect:{dependencyType:"stateVariable",variableName:"numberToSelect"},allPossibleVariants:{dependencyType:"stateVariable",variableName:"allPossibleVariants"}}),definition:function({dependencyValues:e}){let r={};for(let[n,i]of e.optionChildren.entries())for(let s of i.stateValues.selectForVariantNames){let o=s.toLowerCase();r[o]===void 0&&(r[o]=[]),r[o].push(n+1)}for(let n in r)if(r[n].length!==e.numberToSelect)throw Error("Invalid variant name for select.  Variant name "+n+" appears in "+r[n].length+" options but number to select is "+numberToSelect);if(Object.keys(r).length>0){for(let n of e.allPossibleVariants)if(!(n in r))throw Error("Some variants are specified for select but no options are specified for possible variant name: "+n);for(let n in r)if(!e.allPossibleVariants.includes(n))throw Error("Variant name "+n+" that is specified for select is not a possible variant name.")}return{setValue:{availableVariants:r}}}},t.selectedIndices={immutable:!0,hasEssential:!0,shadowVariable:!0,returnDependencies:({sharedParameters:e})=>({numberToSelect:{dependencyType:"stateVariable",variableName:"numberToSelect"},withReplacement:{dependencyType:"stateVariable",variableName:"withReplacement"},optionChildren:{dependencyType:"stateVariable",variableName:"optionChildren"},nOptions:{dependencyType:"stateVariable",variableName:"nOptions"},currentVariantName:{dependencyType:"stateVariable",variableName:"currentVariantName"},variants:{dependencyType:"stateVariable",variableName:"variants"},availableVariants:{dependencyType:"stateVariable",variableName:"availableVariants"},variantRng:{dependencyType:"value",value:e.variantRng,doNotProxy:!0}}),definition:function({dependencyValues:e}){if(!(e.numberToSelect>=1)||e.nOptions===0)return{setEssentialValue:{selectedIndices:[]},setValue:{selectedIndices:[]}};if(e.variants&&e.variants.desiredVariant!==void 0){let c=e.variants.desiredVariant.indices;if(c!==void 0){if(c.length!==e.numberToSelect)throw Error("Number of indices specified for select must match number to select");if(c=c.map(Number),!c.every(Number.isInteger))throw Error("All indices specified for select must be integers");let p=e.nOptions;return c=c.map(m=>((m-1)%p+p)%p+1),{setEssentialValue:{selectedIndices:c},setValue:{selectedIndices:c}}}}let r=e.availableVariants[e.currentVariantName];if(r!==void 0){if(e.numberToSelect>1){r=[...r];for(let c=e.numberToSelect-1;c>0;c--){let p=e.variantRng(),m=Math.floor(p*(c+1));[r[c],r[m]]=[r[m],r[c]]}}return{setEssentialValue:{selectedIndices:r},setValue:{selectedIndices:r}}}let n=[],i=1;if(e.withReplacement||(i=e.numberToSelect),i>e.nOptions)throw Error("Cannot select "+i+" components from only "+e.nOptions);let s=e.optionChildren.map(c=>c.stateValues.selectWeight),o=s.reduce((c,p)=>c+p);s=s.map(c=>c/o);let l=s.reduce((c,p,m)=>[...c,p+(c[m-1]||0)],[]),u=[...Array(l.length).keys()].map(c=>c+1);for(let c=0;c<e.numberToSelect;c++){let p=e.variantRng(),m=-1,f=l.length-1;for(;m<f-1;){let h=Math.floor((m+f)/2);l[h]>p?f=h:m=h}let d=u[f];n.push(d),!e.withReplacement&&c<e.numberToSelect-1&&(s.splice(f,1),u.splice(f,1),o=s.reduce((h,y)=>h+y),s=s.map(h=>h/o),l=s.reduce((h,y,b)=>[...h,y+(h[b-1]||0)],[]))}return{setEssentialValue:{selectedIndices:n},setValue:{selectedIndices:n}}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={providePreviousValuesInDefinition:!0,returnDependencies:({componentInfoObjects:e})=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(e.componentTypesCreatingVariants),variableNames:["isVariantComponent","generatedVariantInfo"],useReplacementsForComposites:!0,recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfEncounteredComposites:!0}}),definition({dependencyValues:e,componentName:r,previousValues:n}){let i={indices:e.selectedIndices,meta:{createdBy:r}},s=i.subvariants=[];for(let o of e.variantDescendants)o.stateValues.isVariantComponent?s.push(o.stateValues.generatedVariantInfo):o.stateValues.generatedVariantInfo&&s.push(...o.stateValues.generatedVariantInfo.subvariants);for(let[o,l]of s.entries())if(!l.subvariants&&n.generatedVariantInfo){let u=n.generatedVariantInfo.subvariants;u[o].subvariants&&(s[o]=Object.assign({},s[o]),s[o].subvariants=u[o].subvariants)}return{setValue:{generatedVariantInfo:i}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,components:e,componentInfoObjects:r}){let n=[],i=await t.stateValues.optionChildren;for(let c of await t.stateValues.selectedIndices){let p=i[c-1].componentName,m=e[p],f=Re(await m.stateValues.serializedChildren),d={componentType:"option",state:{rendered:!0},doenetAttributes:Object.assign({},m.doenetAttributes),children:f,originalName:p};m.attributes.newNamespace&&(d.attributes={newNamespace:{primitive:!0}}),n.push(d)}let s=_a({serializedComponents:n,componentInfoObjects:r});if(t.variants&&t.variants.desiredVariant!==void 0){let c=t.variants.desiredVariant;if(c!==void 0&&c.subvariants!==void 0)for(let p in c.subvariants){let m=c.subvariants[p],f=s[p];if(f===void 0)break;f.variants.desiredVariant=m}}let o=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,l=t.doenetAttributes.assignNames;return l&&await t.stateValues.skipOptionsInAssignNames&&(l=l.map(c=>[c])),{replacements:de({assignNames:l,serializedComponents:n,parentName:t.componentName,parentCreatesNewNamespace:o,componentInfoObjects:r}).serializedComponents}}static calculateReplacementChanges(){return[]}static determineNumberOfUniqueVariants({serializedComponent:t,componentInfoObjects:e}){let r=t.variants?.numberOfVariants;if(r!==void 0)return{success:!0,numberOfVariants:r};let n=1,i=!1,s=t.attributes.numberToSelect?.component;if(s)if(s.componentType==="integer"&&s.children?.length===1&&typeof s.children[0]=="string"){if(n=Number(s.children[0]),!(Number.isInteger(n)&&n>=0))return console.log("cannot determine unique variants of selectFromSequence as numberToSelect isn't a non-negative integer."),{success:!1}}else return console.log("cannot determine unique variants of selectFromSequence as numberToSelect isn't constant number."),{success:!1};let o=t.attributes.withReplacement?.component;if(o)if(o.componentType==="boolean")if(o.children?.length===1&&typeof o.children[0]=="string")i=o.children[0].toLowerCase()==="true";else if((o.children===void 0||o.children.length===0)&&typeof o.state?.value=="boolean")i=o.state.value;else return console.log("cannot determine unique variants of selectFromSequence as withReplacement isn't constant boolean."),{success:!1};else return console.log("cannot determine unique variants of selectFromSequence as withReplacement isn't constant boolean."),{success:!1};for(let p of t.children)if(p.attributes.selectWeight||p.attributes.selectForVariantNames)return console.log("Unique variants for select disabled if have an option with selectWeight or selectForVariantNames specified"),{success:!1};t.variants===void 0&&(t.variants={});let l=_a({serializedComponents:t.children,componentInfoObjects:e});t.variants.descendantVariantComponents=l;let u=[];for(let p of l){let f=e.allComponentClasses[p.componentType].determineNumberOfUniqueVariants({serializedComponent:p,componentInfoObjects:e});if(!f.success)return{success:!1};u.push(f.numberOfVariants)}let c={numberOfVariantsByChild:u,numberToSelect:n,withReplacement:i};if(i||n===1){let p=u.reduce((m,f)=>m+f);r=Math.pow(p,n)}else{let p=u.length;if(n>p)return{success:!1};let m=u[0];if(u.slice(1).every(d=>d===m)){let d=p;for(let h=p-1;h>p-n;h--)d*=h;r=d*Math.pow(m,n)}else r=VU(u,n)}return t.variants.numberOfVariants=r,t.variants.uniqueVariants=!0,t.variants.uniqueVariantData=c,{success:!0,numberOfVariants:r}}static getUniqueVariant({serializedComponent:t,variantIndex:e,componentInfoObjects:r}){let n=t.variants?.numberOfVariants;if(n===void 0)return{success:!1};if(!Number.isInteger(e)||e<1||e>n)return{success:!1};let i=t.variants.uniqueVariantData,s=i.numberOfVariantsByChild,o=i.numberToSelect,l=i.withReplacement,u=t.children.length,c=t.children,p;o===1?p=[...Array(u).keys()].map(R=>[R]):p=em({numberOfIndices:o,numberOfOptions:u,withReplacement:l});let m=p.length,f=p.map(R=>({combination:R,numberOfPossibilities:R.reduce((O,_)=>O*s[_],1)})),d=[...Array(m).keys()],h=0,y=d.length,b,g,v=e-1;for(;y>0;){let O=d.map(_=>f[_]).reduce((_,k)=>Math.min(_,k.numberOfPossibilities),1/0)-h;if(v<O*y){b=d[v%y],g=h+Math.floor(v/y)+1;break}else h+=O,v-=O*y,d=d.filter(_=>f[_].numberOfPossibilities>h),y=d.length}let A=p[b],C=ka({numberOfOptionsByIndex:A.map(R=>s[R]),maxNumber:g})[g-1].map(R=>R+1),S=[],w=!1;for(let[R,O]of A.entries())if(s[O]>1){let _=c[O],B=r.allComponentClasses[_.componentType].getUniqueVariant({serializedComponent:_,variantIndex:C[R],componentInfoObjects:r});if(!B.success)return{success:!1};S.push(B.desiredVariant),w=!0}else S.push({});let x={indices:A.map(R=>R+1)};return w&&(x.subvariants=S),{success:!0,desiredVariant:x}}};T(ss,"componentType","select"),T(ss,"assignNamesToReplacements",!0),T(ss,"createsVariants",!0),T(ss,"includeBlankStringChildren",!0),T(ss,"removeBlankStringChildrenPostSugar",!0);var VU=function(a,t){if(t===0)return 0;if(t===1)return a.reduce((r,n)=>r+n);let e=0;for(let r in a){let n=a[r],i=[...a];i.splice(r,1),e+=n*VU(i,t-1)}return e};import Nd from"math-expressions";var Cl=class extends J{constructor(t){super(t);this.advanceAnimation=this.advanceAnimation.bind(this)}static createAttributesObject(t){let e=super.createAttributesObject(t),r=Dh();return Object.assign(e,r),e.prop={createPrimitiveOfType:"string"},e.componentIndex={createComponentOfType:"number",createStateVariable:"componentIndex",defaultValue:null,public:!0},e.animationOn={createComponentOfType:"boolean",createStateVariable:"animationOn",defaultValue:!1,public:!0,triggerActionOnChange:"changedAnimationOn"},e.animationMode={createComponentOfType:"text",createStateVariable:"animationMode",defaultValue:"increase",validValues:["increase","decrease","increase once","decrease once","oscillate"],toLowerCase:!0,public:!0},e.animationInterval={createComponentOfType:"number",createStateVariable:"animationInterval",defaultValue:1e3,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=Ih();return Object.assign(t,e),t.possibleValues={additionalStateVariablesDefined:["numberValues"],returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},length:{dependencyType:"stateVariable",variableName:"length"},from:{dependencyType:"stateVariable",variableName:"from"},step:{dependencyType:"stateVariable",variableName:"step"},exclude:{dependencyType:"stateVariable",variableName:"exclude"},lowercase:{dependencyType:"stateVariable",variableName:"lowercase"}}),definition({dependencyValues:r}){let n=cu(r);return{setValue:{possibleValues:n,numberValues:n.length}}}},t.selectedIndex={public:!0,componentType:"number",defaultValue:1,hasEssential:!0,returnDependencies:()=>({}),definition(){return{useEssentialOrDefaultValue:{selectedIndex:!0}}},async inverseDefinition({desiredStateVariableValues:r,stateValues:n}){return{success:!0,instructions:[{setEssentialValue:"selectedIndex",value:Nd.math.mod(r.selectedIndex-1,await n.numberValues)+1}]}}},t.value={public:!0,hasVariableComponentType:!0,returnDependencies:()=>({possibleValues:{dependencyType:"stateVariable",variableName:"possibleValues"},selectedIndex:{dependencyType:"stateVariable",variableName:"selectedIndex"},type:{dependencyType:"stateVariable",variableName:"type"}}),definition({dependencyValues:r}){return{setValue:{value:r.possibleValues[r.selectedIndex-1]},setComponentType:{value:r.type}}},async inverseDefinition({desiredStateVariableValues:r,dependencyValues:n,stateValues:i}){if(n.type==="number"){let s=r.value;if(s instanceof Nd.class&&(s=s.evaluate_to_constant()),!Number.isFinite(s))return{success:!1};let o=-1,l=n.possibleValues.length-1;for(;o<l-1;){let c=Math.floor((o+l)/2);await i.step*(n.possibleValues[c]-s)>0?l=c:o=c}let u=l;return o!==-1&&Math.abs(s-n.possibleValues[o])<Math.abs(s-n.possibleValues[l])&&(u=o),{success:!0,instructions:[{setDependency:"selectedIndex",desiredValue:u+1}]}}else{let s=stateVariablesToUpdate.value,o=n.possibleValues.indexOf(s);return o===-1?{success:!1}:{success:!0,instructions:[{setDependency:"selectedIndex",desiredValue:o+1}]}}}},t.currentAnimationDirection={public:!0,componentType:"text",hasEssential:!0,returnDependencies:()=>({animationMode:{dependencyType:"stateVariable",variableName:"animationMode"}}),definition({dependencyValues:r}){return{useEssentialOrDefaultValue:{currentAnimationDirection:{get defaultValue(){return r.animationMode.substring(0,8)==="decrease"?"decrease":"increase"}}}}},inverseDefinition({desiredStateVariableValues:r}){let n=r.currentAnimationDirection.toLowerCase();return["increase","decrease"].includes(n)||(n="increase"),{success:!0,instructions:[{setEssentialValue:"currentAnimationDirection",value:n}]}}},t.target={returnDependencies:()=>({target:{dependencyType:"doenetAttribute",attributeName:"target"}}),definition:({dependencyValues:r})=>({setValue:{target:r.target}})},t.targetComponent={returnDependencies(){return{targetComponent:{dependencyType:"targetComponent"}}},definition:function({dependencyValues:r}){let n=null;return r.targetComponent&&(n=r.targetComponent),{setValue:{targetComponent:n}}}},t.propName={returnDependencies:()=>({propName:{dependencyType:"attributePrimitive",attributeName:"prop"}}),definition:function({dependencyValues:r}){return{setValue:{propName:r.propName}}}},t.targetIdentities={stateVariablesDeterminingDependencies:["targetComponent","componentIndex"],returnDependencies:function({stateValues:r,componentInfoObjects:n}){let i={};return r.targetComponent!==null&&(n.isCompositeComponent({componentType:r.targetComponent.componentType,includeNonStandard:!1})?i.targets={dependencyType:"replacement",compositeName:r.targetComponent.componentName,recursive:!0,componentIndex:r.componentIndex}:(r.componentIndex===null||r.componentIndex===1)&&(i.targets={dependencyType:"stateVariable",variableName:"targetComponent"})),i},definition({dependencyValues:r}){let n=null;return r.targets&&(n=r.targets,Array.isArray(n)||(n=[n])),{setValue:{targetIdentities:n}}}},t.targets={stateVariablesDeterminingDependencies:["targetIdentities","propName"],returnDependencies:function({stateValues:r}){let n={targetIdentities:{dependencyType:"stateVariable",variableName:"targetIdentities"}};if(r.targetIdentities!==null)for(let[i,s]of r.targetIdentities.entries()){let o;r.propName?o={dependencyType:"stateVariable",componentName:s.componentName,variableName:r.propName,returnAsComponentObject:!0,variablesOptional:!0,propIndex:r.propIndex,caseInsensitiveVariableMatch:!0,publicStateVariablesOnly:!0,useMappedVariableNames:!0}:o={dependencyType:"stateVariable",componentName:s.componentName,variableName:"value",returnAsComponentObject:!0,variablesOptional:!0},n["target"+i]=o}return n},definition({dependencyValues:r}){let n=null;if(r.targetIdentities!==null){n=[];for(let i in r.targetIdentities)r["target"+i]&&n.push(r["target"+i])}return{setValue:{targets:n}}}},t.valueToIndex={returnDependencies:()=>({possibleValues:{dependencyType:"stateVariable",variableName:"possibleValues"}}),definition:function({dependencyValues:r}){let n={};for(let[i,s]of r.possibleValues.entries())n[s]=i;return{setValue:{valueToIndex:n}}}},t}async changedAnimationOn({stateValues:t,previousValues:e,actionId:r}){let n=[];if(t.animationOn)if(e.animationOn)this.coreFunctions.resolveAction({actionId:r});else{let i=await this.stateValues.currentAnimationDirection,s=await this.stateValues.animationMode,o=await this.stateValues.numberValues,l=await this.stateValues.selectedIndex,u=await this.findIndexFromTarget();i==="increase"?u===o&&(s==="increase once"?u=1:s==="oscillate"&&(i="decrease",n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"currentAnimationDirection",value:i}))):i==="decrease"&&u===1&&(s==="decrease once"?u=o:s==="oscillate"&&(i="increase",n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"currentAnimationDirection",value:i}))),u!==l&&n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedIndex",value:u});let c=await this.getUpdateInstructionsToSetTargetsToValue((await this.stateValues.possibleValues)[Nd.math.mod(u-1,o)]);n.push(...c),await this.coreFunctions.performUpdate({updateInstructions:n,actionId:r,event:{verb:"played",object:{componentName:this.componentName,componentType:this.componentType},context:{startIndex:u,animationDirection:i,animationMode:s}}}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName}),this.animationId=Qp(),await this.coreFunctions.requestAnimationFrame({action:{actionName:"advanceAnimation",componentName:this.componentName},delay:await this.stateValues.animationInterval,animationId:this.animationId,actionArgs:{previousAnimationId:this.animationId}})}else e.animationOn?(await this.coreFunctions.cancelAnimationFrame(this.animationId),this.canceledAnimationId=this.animationId,await this.coreFunctions.triggerChainedActions({componentName:this.componentName}),this.coreFunctions.requestRecordEvent({verb:"paused",object:{componentName:this.componentName,componentType:this.componentType},context:{endIndex:await this.stateValues.selectedIndex}})):this.coreFunctions.resolveAction({actionId:r})}async findIndexFromTarget(){let t=await this.stateValues.targets,e=await this.stateValues.selectedIndex;if(t===null)return e;let r=t[0],n=Object.keys(r.stateValues)[0];if(!n)return e;let i=r.stateValues[n],s=await this.stateValues.type;if(s==="number"&&i instanceof Nd.class&&(i=i.evaluate_to_constant(),!Number.isFinite(i)))return e;let o=(await this.stateValues.valueToIndex)[i];if(o!==void 0)return o+1;if(s!=="number")return e;let l=await this.stateValues.possibleValues,u=function(p=0,m=l.length-1){if(m<=p+1)return i>l[p]?m:p;let f=Math.round((m+p)/2);return i>l[f]?u(f,m):u(p,f)},c=u();if(c!==0){let p=l[c-1],m=l[c],f=Math.abs(i-p),d=Math.abs(i-m);f<d&&c--}return c+1}async advanceAnimation({previousAnimationId:t,actionId:e}){if(t===this.canceledAnimationId){this.coreFunctions.resolveAction({actionId:e});return}let r,n=!0,i,s=await this.stateValues.animationMode,o=await this.findIndexFromTarget();await this.stateValues.currentAnimationDirection==="decrease"?(r=o-1,r<=1&&(s==="decrease once"?n=!1:s==="oscillate"&&(i="increase"))):(r=o+1,r>=await this.stateValues.numberValues&&(s==="increase once"?n=!1:s==="oscillate"&&(i="decrease")));let l=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedIndex",value:r}],u=await this.getUpdateInstructionsToSetTargetsToValue((await this.stateValues.possibleValues)[Nd.math.mod(r-1,await this.stateValues.numberValues)]);l.push(...u),n||l.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"animationOn",value:!1}),i&&l.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"currentAnimationDirection",value:i}),await this.coreFunctions.performUpdate({updateInstructions:l,actionId:e}),n&&(this.animationId=Qp(),await this.coreFunctions.requestAnimationFrame({action:{actionName:"advanceAnimation",componentName:this.componentName},delay:await this.stateValues.animationInterval,animationId:this.animationId,actionArgs:{previousAnimationId:this.animationId}}))}startAnimation({actionId:t}){this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"animationOn",value:!0}],actionId:t})}stopAnimation({actionId:t}){this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"animationOn",value:!1}],actionId:t})}async toggleAnimation({actionId:t}){this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"animationOn",value:!await this.stateValues.animationOn}],actionId:t})}actions={changedAnimationOn:this.changedAnimationOn.bind(this),advanceAnimation:this.advanceAnimation.bind(this),startAnimation:this.startAnimation.bind(this),stopAnimation:this.stopAnimation.bind(this),toggleAnimation:this.toggleAnimation.bind(this)};async getUpdateInstructionsToSetTargetsToValue(t){let e=await this.stateValues.targets;if(e==null)return[];let r=[];for(let n of e){let i=Object.keys(n.stateValues)[0];if(i===void 0){await this.stateValues.propName?console.warn(`Cannot animate prop="${await this.stateValues.propName}" of ${await this.stateValues.target} as could not find prop ${await this.stateValues.propName} on a component of type ${n.componentType}`):console.warn(`Cannot animate ${await this.stateValues.target} as could not find a value state variable on a component of type ${n.componentType}`);continue}r.push({updateType:"updateValue",componentName:n.componentName,stateVariable:i,value:t})}return r}};T(Cl,"componentType","animateFromSequence"),T(Cl,"rendererType"),T(Cl,"acceptTarget",!0);import Cd from"math-expressions";var dp=class extends ot{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.forceSymbolic={createComponentOfType:"boolean",createStateVariable:"forceSymbolic",defaultValue:!1,public:!0},e.forceNumeric={createComponentOfType:"boolean",createStateVariable:"forceNumeric",defaultValue:!1,public:!0},e.function={createComponentOfType:"function"},e.input={createComponentOfType:"mathList"},e.displayDigits={createComponentOfType:"integer"},e.displayDecimals={createComponentOfType:"integer"},e.displaySmallAsZero={createComponentOfType:"number",valueForTrue:1e-14,valueForFalse:0},e.unordered={createComponentOfType:"boolean",createStateVariable:"unordered",defaultValue:!1,public:!0},e}static returnChildGroups(){return[]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return delete t.codePre,delete t.expressionWithCodes,delete t.mathChildrenFunctionSymbols,delete t.codesAdjacentToStrings,delete t.mathChildrenByVectorComponent,delete t.mathChildrenWithCanBeModified,delete t.unordered,t.canBeModified={returnDependencies:()=>({}),definition:()=>({setValue:{canBeModified:!1}})},t.displayDigits={public:!0,componentType:"integer",defaultValue:10,hasEssential:!0,returnDependencies:()=>({displayDigitsAttr:{dependencyType:"attributeComponent",attributeName:"displayDigits",variableNames:["value"]},functionAttr:{dependencyType:"attributeComponent",attributeName:"function",variableNames:["displayDigits"]}}),definition({dependencyValues:e,usedDefault:r}){return e.displayDigitsAttr!==null?{setValue:{displayDigits:e.displayDigitsAttr.stateValues.value}}:e.functionAttr&&!r.functionAttr?{setValue:{displayDigits:e.functionAttr.stateValues.displayDigits}}:{useEssentialOrDefaultValue:{displayDigits:!0}}}},t.displayDecimals={public:!0,componentType:"integer",defaultValue:10,hasEssential:!0,returnDependencies:()=>({displayDecimalsAttr:{dependencyType:"attributeComponent",attributeName:"displayDecimals",variableNames:["value"]},functionAttr:{dependencyType:"attributeComponent",attributeName:"function",variableNames:["displayDecimals"]}}),definition({dependencyValues:e,usedDefault:r}){return e.displayDecimalsAttr!==null?{setValue:{displayDecimals:e.displayDecimalsAttr.stateValues.value}}:e.functionAttr&&!r.functionAttr?{setValue:{displayDecimals:e.functionAttr.stateValues.displayDecimals}}:{useEssentialOrDefaultValue:{displayDecimals:!0}}}},t.displaySmallAsZero={public:!0,componentType:"number",defaultValue:0,hasEssential:!0,returnDependencies:()=>({displayDecimalsAttr:{dependencyType:"attributeComponent",attributeName:"displaySmallAsZero",variableNames:["value"]},functionAttr:{dependencyType:"attributeComponent",attributeName:"function",variableNames:["displaySmallAsZero"]}}),definition({dependencyValues:e,usedDefault:r}){return e.displayDecimalsAttr!==null?{setValue:{displaySmallAsZero:e.displayDecimalsAttr.stateValues.value}}:e.functionAttr&&!r.functionAttr?{setValue:{displaySmallAsZero:e.functionAttr.stateValues.displaySmallAsZero}}:{useEssentialOrDefaultValue:{displaySmallAsZero:!0}}}},t.unnormalizedValue={public:!0,componentType:"math",returnDependencies(){return{inputAttr:{dependencyType:"attributeComponent",attributeName:"input",variableNames:["nComponents","maths"]},functionAttr:{dependencyType:"attributeComponent",attributeName:"function",variableNames:["symbolicfs","numericalfs","symbolic","nInputs","nOutputs"]},forceSymbolic:{dependencyType:"stateVariable",variableName:"forceSymbolic"},forceNumeric:{dependencyType:"stateVariable",variableName:"forceNumeric"}}},definition({dependencyValues:e}){if(!(e.functionAttr&&e.inputAttr))return{setValue:{unnormalizedValue:Cd.fromAst("\uFF3F")}};let r=e.inputAttr.stateValues.maths;if(r.length===1){let l=r[0].tree;Array.isArray(l)&&["vector","tuple"].includes(l[0])&&(r=l.slice(1).map(u=>Cd.fromAst(u)))}if(r.length!==e.functionAttr.stateValues.nInputs)return{setValue:{unnormalizedValue:Cd.fromAst("\uFF3F")}};let n=[],i=e.functionAttr,s=i.stateValues.nOutputs;if(!e.forceNumeric&&(i.stateValues.symbolic||e.forceSymbolic))for(let l=0;l<s;l++)n.push(i.stateValues.symbolicfs[l](...r).tree);else{let l=r.map(u=>u.evaluate_to_constant()).map(u=>u===null?NaN:u);for(let u=0;u<s;u++)n.push(i.stateValues.numericalfs[u](...l))}let o;return s===1?o=Cd.fromAst(n[0]):o=Cd.fromAst(["vector",...n]),{setValue:{unnormalizedValue:o}}}},t}};T(dp,"componentType","evaluate"),T(dp,"rendererType","math");function Ad({type:a,numberOfSamples:t,standardDeviation:e,mean:r,to:n,from:i,step:s,nDiscreteValues:o,rng:l}){if(a==="gaussian"){if(!(e>=0)||!Number.isFinite(r)){let c="Invalid mean ("+r+") or standard deviation ("+e+") for a gaussian random variable.";return console.warn(c),Array(t).fill(NaN)}let u=[];for(let c=0;c<t;c++){let p=0,m=0;for(;p===0;)p=l();for(;m===0;)m=l();let f=Math.sqrt(-2*Math.log(p))*Math.cos(2*Math.PI*m);u.push(r+e*f)}return u}else if(a==="uniform"){let u=[],c=n-i;for(let p=0;p<t;p++)u.push(i+l()*c);return u}else{let u=[];if(o>0)for(let c=0;c<t;c++){let p=Math.floor(l()*o);u.push(i+s*p)}return u}}var oi=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.numberOfSamples={createComponentOfType:"number",createStateVariable:"numberOfSamples",defaultValue:1,public:!0},e.type={createComponentOfType:"text",createStateVariable:"type",defaultValue:"uniform",public:!0,toLowerCase:!0,validValues:["uniform","discreteuniform","gaussian"]},e.mean={createComponentOfType:"number",createStateVariable:"specifiedMean",defaultValue:0},e.standardDeviation={createComponentOfType:"number",createStateVariable:"specifiedStandardDeviation",defaultValue:1},e.variance={createComponentOfType:"number",createStateVariable:"specifiedVariance",defaultValue:1},e.from={createComponentOfType:"number",createStateVariable:"specifiedFrom",defaultValue:null},e.to={createComponentOfType:"number",createStateVariable:"specifiedTo",defaultValue:null},e.step={createComponentOfType:"number",createStateVariable:"specifiedStep",defaultValue:1},e.displayDigits={leaveRaw:!0},e.displayDecimals={leaveRaw:!0},e.displaySmallAsZero={leaveRaw:!0},e.variantDeterminesSeed={createComponentOfType:"boolean",createStateVariable:"variantDeterminesSeed",defaultValue:!1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.step={public:!0,componentType:"number",returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},specifiedStep:{dependencyType:"stateVariable",variableName:"specifiedStep"}}),definition({dependencyValues:e}){let r;return e.type==="discreteuniform"?r=e.specifiedStep:r=null,{setValue:{step:r}}}},t.from={public:!0,componentType:"number",additionalStateVariablesDefined:[{variableName:"to",public:!0,componentType:"number"},{variableName:"nDiscreteValues"}],returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},specifiedFrom:{dependencyType:"stateVariable",variableName:"specifiedFrom"},specifiedTo:{dependencyType:"stateVariable",variableName:"specifiedTo"},step:{dependencyType:"stateVariable",variableName:"step"}}),definition({dependencyValues:e}){if(!["discreteuniform","uniform"].includes(e.type))return{setValue:{from:null,to:null,nDiscreteValues:null}};let r=e.step,n=e.specifiedFrom,i=e.specifiedTo,s=null;return i===null?(n===null&&(n=0),e.type==="uniform"?i=n+1:(i=n+r,s=2)):n===null?e.type==="uniform"?n=0:(s=Math.floor((i-0)/r+1),s<1?(s=0,n=null):n=i-(s-1)*r):e.type==="discreteuniform"&&(s=Math.floor((i-n)/r+1),s<1?s=0:i=n+(s-1)*r),{setValue:{from:n,to:i,nDiscreteValues:s}}}},t.mean={stateVariablesDeterminingDependencies:["type"],public:!0,componentType:"number",returnDependencies({stateValues:e}){let r={type:{dependencyType:"stateVariable",variableName:"type"}};return e.type==="gaussian"?r.specifiedMean={dependencyType:"stateVariable",variableName:"specifiedMean"}:(r.from={dependencyType:"stateVariable",variableName:"from"},r.to={dependencyType:"stateVariable",variableName:"to"}),r},definition({dependencyValues:e}){let r;return e.type==="gaussian"?r=e.specifiedMean:r=(e.from+e.to)/2,{setValue:{mean:r}}}},t.variance={stateVariablesDeterminingDependencies:["type"],public:!0,componentType:"number",returnDependencies({stateValues:e}){let r={type:{dependencyType:"stateVariable",variableName:"type"}};return e.type==="gaussian"?(r.specifiedVariance={dependencyType:"stateVariable",variableName:"specifiedVariance"},r.specifiedStandardDeviation={dependencyType:"stateVariable",variableName:"specifiedStandardDeviation"}):(r.from={dependencyType:"stateVariable",variableName:"from"},r.to={dependencyType:"stateVariable",variableName:"to"},e.type==="discreteuniform"&&(r.step={dependencyType:"stateVariable",variableName:"step"},r.nDiscreteValues={dependencyType:"stateVariable",variableName:"nDiscreteValues"})),r},definition({dependencyValues:e,usedDefault:r}){let n;return e.type==="gaussian"?r.specifiedVariance&&!r.specifiedStandardDeviation?n=e.specifiedStandardDeviation**2:n=e.specifiedVariance:e.type==="discreteuniform"?n=(e.nDiscreteValues**2-1)*e.step**2/12:n=(e.to-e.from)**2/12,{setValue:{variance:n}}}},t.standardDeviation={public:!0,componentType:"number",returnDependencies:()=>({variance:{dependencyType:"stateVariable",variableName:"variance"}}),definition:({dependencyValues:e})=>({setValue:{standardDeviation:Math.sqrt(e.variance)}})},t.sampledValues={shadowVariable:!0,hasEssential:!0,stateVariablesDeterminingDependencies:["variantDeterminesSeed"],returnDependencies({stateValues:e,sharedParameters:r}){let n={numberOfSamples:{dependencyType:"stateVariable",variableName:"numberOfSamples"},type:{dependencyType:"stateVariable",variableName:"type"},from:{dependencyType:"stateVariable",variableName:"from"},to:{dependencyType:"stateVariable",variableName:"to"},step:{dependencyType:"stateVariable",variableName:"step"},nDiscreteValues:{dependencyType:"stateVariable",variableName:"nDiscreteValues"},mean:{dependencyType:"stateVariable",variableName:"mean"},standardDeviation:{dependencyType:"stateVariable",variableName:"standardDeviation"}};return e.variantDeterminesSeed?n.rng={dependencyType:"value",value:r.variantRng,doNotProxy:!0}:n.rng={dependencyType:"value",value:r.rngWithDateSeed,doNotProxy:!0},n},definition({dependencyValues:e}){if(e.numberOfSamples<1)return{setEssentialValue:{sampledValues:[]},setValue:{sampledValues:[]}};let r=Ad(e);return{setEssentialValue:{sampledValues:r},setValue:{sampledValues:r}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"sampledValues",value:e.sampledValues}]}}},t.readyToExpandWhenResolved={returnDependencies:()=>({sampledValues:{dependencyType:"stateVariable",variableName:"sampledValues"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={returnDependencies:({sharedParameters:e})=>({variantSeed:{dependencyType:"value",value:e.variantSeed}}),definition({dependencyValues:e,componentName:r}){return{setValue:{generatedVariantInfo:{seed:e.variantSeed,meta:{createdBy:r}}}}}},t}static async createSerializedReplacements({component:t,componentInfoObjects:e,startNum:r=0,flags:n}){let i=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,s={};for(let u of["displayDigits","displaySmallAsZero","displayDecimals"])u in t.attributes&&(s[u]=t.attributes[u]);let o=[];for(let u of(await t.stateValues.sampledValues).slice(r)){let c={};Object.keys(s).length>0&&(c=Ze({attributes:s,componentType:"number",componentInfoObjects:e,compositeCreatesNewNamespace:i,flags:n})),o.push({componentType:"number",attributes:c,state:{value:u}})}return{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:o,parentName:t.componentName,parentCreatesNewNamespace:i,indOffset:r,componentInfoObjects:e}).serializedComponents}}static async calculateReplacementChanges({component:t,componentInfoObjects:e,flags:r}){let n=[],i=await t.stateValues.sampledValues;if(i.length<t.replacements.length){let o=t.replacements.length-i.length;if(o!==t.replacementsToWithhold){let l={changeType:"changeReplacementsToWithhold",replacementsToWithhold:o};n.push(l)}}else{if(t.replacementsToWithhold>0){let o={changeType:"changeReplacementsToWithhold",replacementsToWithhold:0};n.push(o)}if(i.length>t.replacements.length){let o=await this.createSerializedReplacements({component:t,componentInfoObjects:e,startNum:t.replacements.length,flags:r}),l={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:t.replacements.length,numberReplacementsToReplace:0,serializedReplacements:o.replacements,assignNamesOffset:t.replacements.length};n.push(l)}}let s=Math.min(t.replacements.length,i.length);for(let o=0;o<s;o++){let l={changeType:"updateStateVariables",component:t.replacements[o],stateChanges:{value:i[o]}};n.push(l)}return n}static async setUpVariant({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r}){kr({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r});let n=e.variantRng().toString().slice(2,8)+ +new Date;e.rngWithDateSeed=new e.rngClass(n)}async resample({actionId:t}){let e=Ad({type:await this.stateValues.type,numberOfSamples:await this.stateValues.numberOfSamples,standardDeviation:await this.stateValues.standardDeviation,mean:await this.stateValues.mean,to:await this.stateValues.to,from:await this.stateValues.from,step:await this.stateValues.step,nDiscreteValues:await this.stateValues.nDiscreteValues,rng:await this.stateValues.variantDeterminesSeed?this.sharedParameters.variantRng:this.sharedParameters.rngWithDateSeed});return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"sampledValues",value:e}],actionId:t})}actions={resample:this.resample.bind(this)}};T(oi,"componentType","sampleRandomNumbers"),T(oi,"assignNamesToReplacements",!0),T(oi,"createsVariants",!0),T(oi,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");var to=class extends oi{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.numberOfSamples,e.assignNamesSkip={createPrimitiveOfType:"number"},e.numberToSelect={createComponentOfType:"integer",createStateVariable:"numberToSelect",defaultValue:1,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.variants={returnDependencies:()=>({variants:{dependencyType:"variants"}}),definition:function({dependencyValues:e}){return{setValue:{variants:e.variants}}}},t.step.immutable=!0,t.from.immutable=!0,t.from.additionalStateVariablesDefined[0].immutable=!0,t.from.additionalStateVariablesDefined[1].immutable=!0,t.mean.immutable=!0,t.variance.immutable=!0,t.standardDeviation.immutable=!0,delete t.sampledValues,t.selectedValues={immutable:!0,hasEssential:!0,shadowVariable:!0,returnDependencies:({sharedParameters:e})=>({numberOfSamples:{dependencyType:"stateVariable",variableName:"numberToSelect"},type:{dependencyType:"stateVariable",variableName:"type"},from:{dependencyType:"stateVariable",variableName:"from"},to:{dependencyType:"stateVariable",variableName:"to"},step:{dependencyType:"stateVariable",variableName:"step"},nDiscreteValues:{dependencyType:"stateVariable",variableName:"nDiscreteValues"},mean:{dependencyType:"stateVariable",variableName:"mean"},standardDeviation:{dependencyType:"stateVariable",variableName:"standardDeviation"},variants:{dependencyType:"stateVariable",variableName:"variants"},rng:{dependencyType:"value",value:e.variantRng,doNotProxy:!0}}),definition({dependencyValues:e}){if(e.numberOfSamples<1)return{setEssentialValue:{selectedValues:[]},setValue:{selectedValues:[]}};if(e.variants&&e.variants.desiredVariant){let n=e.variants.desiredVariant.values;if(n){if(n.length!==e.numberOfSamples)throw Error("Number of values specified for selectRandomNumber must match number to select");return{setEssentialValue:{selectedValues:n},setValue:{selectedValues:n}}}}let r=Ad(e);return{setEssentialValue:{selectedValues:r},setValue:{selectedValues:r}}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={returnDependencies:()=>({selectedValues:{dependencyType:"stateVariable",variableName:"selectedValues"}}),definition({dependencyValues:e,componentName:r}){return{setValue:{generatedVariantInfo:{values:e.selectedValues,meta:{createdBy:r}}}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({selectedValues:{dependencyType:"stateVariable",variableName:"selectedValues"}}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,componentInfoObjects:e,flags:r}){let n=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,i={};for(let l of["displayDigits","displaySmallAsZero","displayDecimals"])l in t.attributes&&(i[l]=t.attributes[l]);let s=[];for(let l of await t.stateValues.selectedValues){let u={};Object.keys(i).length>0&&(u=Ze({attributes:i,componentType:"number",componentInfoObjects:e,compositeCreatesNewNamespace:n,flags:r})),s.push({componentType:"number",attributes:u,state:{value:l}})}return{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:s,parentName:t.componentName,parentCreatesNewNamespace:n,componentInfoObjects:e}).serializedComponents}}};T(to,"componentType","selectRandomNumbers"),T(to,"createsVariants",!0);delete to.stateVariableToEvaluateAfterReplacements;delete to.calculateReplacementChanges;var Al=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.type={createPrimitiveOfType:"string",createStateVariable:"type",defaultPrimitiveValue:"math",toLowerCase:!0,validValues:["math","text"]},e.match={createComponentOfType:"_componentWithSelectableType",createStateVariable:"match",defaultValue:null},e.replacement={createComponentOfType:"_componentWithSelectableType",createStateVariable:"replacement",defaultValue:null},e.simplify={createComponentOfType:"text",createStateVariable:"simplify",defaultValue:"none",public:!0,toLowerCase:!0,valueTransformations:{true:"full"},validValues:["none","full","numbers","numberspreserveorder"]},e.displayDigits={leaveRaw:!0},e.displayDecimals={leaveRaw:!0},e.displaySmallAsZero={leaveRaw:!0},e.matchWholeWord={createComponentOfType:"boolean",createStateVariable:"matchWholeWord",defaultValue:!1,public:!0},e.matchCase={createComponentOfType:"boolean",createStateVariable:"matchCase",defaultValue:!1,public:!0},e.preserveCase={createComponentOfType:"boolean",createStateVariable:"preserveCase",defaultValue:!1,public:!0},e}static returnSugarInstructions(){let t=[];function e({matchedChildren:r,componentAttributes:n}){let i=n.type;return["math","text"].includes(i)||(i="math"),{success:!0,newChildren:[{componentType:i,children:r}]}}return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.originalValue={returnDependencies:()=>({child:{dependencyType:"child",childGroups:["anything"],variableNames:["value"]}}),definition({dependencyValues:e}){return e.child.length>0?{setValue:{originalValue:e.child[0].stateValues.value}}:{setValue:{originalValue:null}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.child.length>0?{success:!0,instructions:[{setDependency:"child",desiredValue:e.originalValue,childIndex:0,variableIndex:0}]}:{success:!1}}},t.value={returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},originalValue:{dependencyType:"stateVariable",variableName:"originalValue"},match:{dependencyType:"stateVariable",variableName:"match"},replacement:{dependencyType:"stateVariable",variableName:"replacement"},simplify:{dependencyType:"stateVariable",variableName:"simplify"},matchWholeWord:{dependencyType:"stateVariable",variableName:"matchWholeWord"},matchCase:{dependencyType:"stateVariable",variableName:"matchCase"},preserveCase:{dependencyType:"stateVariable",variableName:"preserveCase"}}),definition({dependencyValues:e}){if(e.originalValue===null)return{setValue:{value:null}};if(e.match===null||e.replacement===null)return{setValue:{value:e.originalValue}};if(e.type==="text"){let r=e.originalValue,n,i="g";e.matchCase||(i="gi"),e.matchWholeWord?n=new RegExp("\\b"+ro(e.match)+"\\b",i):n=new RegExp(ro(e.match),i);let s=e.replacement;if(e.preserveCase){let o=ZE(s);r=r.replace(n,o)}else r=r.replace(n,s);return{setValue:{value:r}}}else{let r=e.originalValue.subscripts_to_strings();return r=r.substitute({[e.match.subscripts_to_strings().tree]:e.replacement.subscripts_to_strings()}),r=r.strings_to_subscripts(),r=Wr({value:r,simplify:e.simplify}),{setValue:{value:r}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){if(r.type==="text"){let n=e.value,i,s,o="g";r.matchCase||(o="gi");let l=r.match,u=r.replacement;if(r.matchWholeWord)if(i=new RegExp("\\b"+ro(l)+"\\b",o),r.matchCase&&r.preserveCase){let c=ZE(u);s=new RegExp("\\b"+ro(c(l))+"\\b",o)}else s=new RegExp("\\b"+ro(u)+"\\b",o);else if(i=new RegExp(ro(l),o),r.matchCase&&r.preserveCase){let c=ZE(u);s=new RegExp(ro(c(l)),o)}else s=new RegExp(ro(u),o);return r.originalValue.search(s)!==-1||n.search(i)!==-1?{success:!1}:(n=n.replace(s,l),{success:!0,instructions:[{setDependency:"originalValue",desiredValue:n}]})}else{let n=e.value.subscripts_to_strings(),i=r.match.subscripts_to_strings(),s=r.replacement.subscripts_to_strings();return typeof i.tree=="string"&&typeof s.tree=="string"?r.originalValue.variables(!0).includes(s.tree)?{success:!1}:n.variables().includes(i.tree)?{success:!1}:(n=n.substitute({[s.tree]:i}),n=n.strings_to_subscripts(),{success:!0,instructions:[{setDependency:"originalValue",desiredValue:n}]}):{success:!1}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,componentInfoObjects:e,flags:r}){let n=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,i=await t.stateValues.type,s={componentType:i,state:{value:await t.stateValues.value},downstreamDependencies:{[t.componentName]:[{dependencyType:"referenceShadow",compositeName:t.componentName,propVariable:"value"}]}};if(i==="math"){let l={},u=!1;for(let c of["displayDigits","displaySmallAsZero","displayDecimals"])c in t.attributes&&(l[c]=t.attributes[c],u=!0);u&&(s.attributes=convertAttributesForComponentType({attributes:l,componentType:"math",componentInfoObjects:e,compositeCreatesNewNamespace:n,flags:r}))}return{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:[s],parentName:t.componentName,parentCreatesNewNamespace:n,componentInfoObjects:e}).serializedComponents}}};T(Al,"componentType","substitute"),T(Al,"assignNamesToReplacements",!0),T(Al,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");function ro(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ZE(a){return function(t){return t.toUpperCase()===t?a.toUpperCase():t.toLowerCase()===t?a.toLowerCase():t[0].match(/[a-z]/)?a[0].toLowerCase()+a.substring(1):t[0].match(/[A-Z]/)?a[0].toUpperCase()+a.substring(1):a}}import V1 from"math-expressions";var hp=class extends ot{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.minIndex={createComponentOfType:"integer",createStateVariable:"minIndex",defaultValue:-1/0,public:!0},e.maxIndex={createComponentOfType:"integer",createStateVariable:"maxIndex",defaultValue:1/0,public:!0},e.offsets={createComponentOfType:"mathList",createStateVariable:"offsets",defaultValue:null,public:!0},e.period={createComponentOfType:"math",createStateVariable:"period",defaultValue:null,public:!0},e.minIndexAsList={createComponentOfType:"integer",createStateVariable:"minIndexAsList",defaultValue:-1,public:!0},e.maxIndexAsList={createComponentOfType:"integer",createStateVariable:"maxIndexAsList",defaultValue:1,public:!0},e}static returnChildGroups(){return[]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return delete t.codePre,delete t.expressionWithCodes,delete t.mathChildrenFunctionSymbols,delete t.codesAdjacentToStrings,delete t.mathChildrenByVectorComponent,delete t.mathChildrenWithCanBeModified,delete t.unordered,t.canBeModified={returnDependencies:()=>({}),definition:()=>({setValue:{canBeModified:!1}})},t.nOffsets={public:!0,componentType:"integer",returnDependencies:()=>({offsets:{dependencyType:"stateVariable",variableName:"offsets"}}),definition({dependencyValues:e}){let r=0;return e.offsets!==null&&(r=e.offsets.length),{setValue:{nOffsets:r}}}},t.unnormalizedValue={returnDependencies:()=>({offsets:{dependencyType:"stateVariable",variableName:"offsets"},period:{dependencyType:"stateVariable",variableName:"period"},minIndex:{dependencyType:"stateVariable",variableName:"minIndex"},maxIndex:{dependencyType:"stateVariable",variableName:"maxIndex"}}),definition({dependencyValues:e}){if(e.offsets===null||e.offsets.length===0||e.offsets.length===1&&e.offsets[0].tree==="\uFF3F"||e.period===null||e.period.tree==="\uFF3F")return{setValue:{unnormalizedValue:V1.fromAst("\uFF3F")}};let r=[],n=e.period.tree,i=e.minIndex,s=e.maxIndex;for(let l of e.offsets)r.push(["tuple",l.tree,n,i,s]);return{setValue:{unnormalizedValue:V1.fromAst(["periodic_set",...r])}}}},t.redundantOffsets={additionalStateVariablesDefined:["uniqueOffsets"],public:!0,componentType:"boolean",returnDependencies:()=>({nOffsets:{dependencyType:"stateVariable",variableName:"nOffsets"},offsets:{dependencyType:"stateVariable",variableName:"offsets"},period:{dependencyType:"stateVariable",variableName:"period"}}),definition({dependencyValues:e}){let r=!1,n=[];if(e.period!==null){let i=e.period.evaluate_to_constant();if(i!==null)for(let s=0;s<e.nOffsets;s++){let o=!0;for(let l=0;l<s;l++){let u=e.offsets[s].subtract(e.offsets[l]).evaluate_to_constant();if(u!==null&&Math.abs(u%i)<1e-10*i){r=!0,o=!1;break}}o&&n.push(e.offsets[s])}}return{setValue:{redundantOffsets:r,uniqueOffsets:n}}}},t.asList={public:!0,componentType:"mathList",returnDependencies:()=>({uniqueOffsets:{dependencyType:"stateVariable",variableName:"uniqueOffsets"},period:{dependencyType:"stateVariable",variableName:"period"},minIndexAsList:{dependencyType:"stateVariable",variableName:"minIndexAsList"},maxIndexAsList:{dependencyType:"stateVariable",variableName:"maxIndexAsList"}}),definition({dependencyValues:e}){let r=[];if(e.period!==null){let n=e.period.evaluate_to_constant();if(n!==null){let i=e.period.simplify(),s=!0,o=[];for(let l of e.uniqueOffsets){let u=l.evaluate_to_constant();if(u===null){s=!1;break}else{let c=l.subtract(i.multiply(Math.floor(u/n))).simplify(),p=c.evaluate_to_constant();o.push({num:p,offset:c})}}if(s){r.push(V1.fromAst(["ldots"])),o.sort((c,p)=>c.num-p.num);let l=-1,u=1;Number.isFinite(e.minIndexAsList)&&(l=e.minIndexAsList),Number.isFinite(e.maxIndexAsList)&&(u=e.maxIndexAsList);for(let c=l;c<=u;c++)for(let p of o)r.push(p.offset.add(i.multiply(c)).simplify());r.push(V1.fromAst(["ldots"]))}}}return{setValue:{asList:r}}}},t}};T(hp,"componentType","periodicSet"),T(hp,"rendererType");var Sd=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:null,public:!0,forRenderer:!0},e.height={createComponentOfType:"_componentSize",createStateVariable:"height",defaultValue:null,public:!0,forRenderer:!0},e.description={createComponentOfType:"text",createStateVariable:"description",defaultValue:null,public:!0,forRenderer:!0},e.source={createComponentOfType:"text",createStateVariable:"source",required:!0,public:!0,forRenderer:!0},e.asFileName={createComponentOfType:"text",createStateVariable:"asFileName",defaultValue:null,public:!0,forRenderer:!0},e.mimeType={createComponentOfType:"text",createStateVariable:"mimeType",defaultValue:null,public:!0,forRenderer:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.cid={forRenderer:!0,returnDependencies:()=>({source:{dependencyType:"stateVariable",variableName:"source"}}),definition:function({dependencyValues:e}){if(!e.source||e.source.substring(0,7).toLowerCase()!=="doenet:")return{setValue:{cid:null}};let r=null,n=e.source.match(/[:&]cid=([^&]+)/i);return n&&(r=n[1]),{setValue:{cid:r}}}},t}};T(Sd,"componentType","image");var wd=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.width={createComponentOfType:"_componentSize"},e.height={createComponentOfType:"_componentSize"},e.aspectRatio={createComponentOfType:"number"},e.youtube={createComponentOfType:"text",createStateVariable:"youtube",defaultValue:null,public:!0,forRenderer:!0},e.source={createComponentOfType:"text",createStateVariable:"source",defaultValue:null,public:!0,forRenderer:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.width={defaultValue:{size:720,isAbsolute:!0},public:!0,hasEssential:!0,componentType:"_componentSize",forRenderer:!0,additionalStateVariablesDefined:[{variableName:"height",componentType:"_componentSize",defaultValue:{size:405,isAbsolute:!0},public:!0,forRenderer:!0,hasEssential:!0},{variableName:"aspectRatio",componentType:"number",defaultValue:16/9,public:!0,forRenderer:!0,hasEssential:!0}],returnDependencies:()=>({widthAttr:{dependencyType:"attributeComponent",attributeName:"width",variableNames:["componentSize"]},heightAttr:{dependencyType:"attributeComponent",attributeName:"height",variableNames:["componentSize"]},aspectRatioAttr:{dependencyType:"attributeComponent",attributeName:"aspectRatio",variableNames:["value"]}}),definition:({dependencyValues:e})=>{if(console.log("dependencyValues",e),e.widthAttr){let r=e.widthAttr.stateValues.componentSize;if(!r.isAbsolute)throw Error("Have not implemented relative width for video");if(e.heightAttr){let n=e.heightAttr.stateValues.componentSize;if(!n.isAbsolute)throw Error("Have not implemented relative height for video");let i=r.size/n.size;return{setValue:{width:r,height:n,aspectRatio:i}}}else if(e.aspectRatioAttr){let n=e.aspectRatioAttr.stateValues.value,i={isAbsolute:!0,size:r.size/n};return{setValue:{width:r,height:i,aspectRatio:n}}}else{let n={isAbsolute:!0,size:r.size/(16/9)};return{setValue:{width:r,height:n},useEssentialOrDefaultValue:{aspectRatio:!0}}}}else if(e.heightAttr){let r=e.heightAttr.stateValues.componentSize;if(!r.isAbsolute)throw Error("Have not implemented relative height for video");if(e.aspectRatioAttr){let n=e.aspectRatioAttr.stateValues.value;return{setValue:{width:{isAbsolute:!0,size:r.size*n},height:r,aspectRatio:n}}}else return{setValue:{width:{isAbsolute:!0,size:r.size*(16/9)},height:r},useEssentialOrDefaultValue:{aspectRatio:!0}}}else if(e.aspectRatioAttr){let r=e.aspectRatioAttr.stateValues.value,n={isAbsolute:!0,size:720/r};return{setValue:{aspectRatio:r,height:n},useEssentialOrDefaultValue:{width:!0}}}else return{useEssentialOrDefaultValue:{width:!0,height:!0,aspectRatio:!0}}}},t}actions={recordVideoStarted:this.recordVideoStarted.bind(this),recordVideoWatched:this.recordVideoWatched.bind(this),recordVideoPaused:this.recordVideoPaused.bind(this),recordVideoSkipped:this.recordVideoSkipped.bind(this),recordVideoCompleted:this.recordVideoCompleted.bind(this)};recordVideoStarted({beginTime:t,duration:e,rate:r}){this.coreFunctions.requestRecordEvent({verb:"played",object:{componentName:this.componentName,componentType:this.componentType,duration:e},context:{startingPoint:t,rate:r}})}recordVideoWatched({beginTime:t,endTime:e,duration:r,rates:n}){this.coreFunctions.requestRecordEvent({verb:"watched",object:{componentName:this.componentName,componentType:this.componentType,duration:r},context:{startingPoint:t,endingPoint:e,rates:n}})}recordVideoPaused({endTime:t,duration:e}){this.coreFunctions.requestRecordEvent({verb:"paused",object:{componentName:this.componentName,componentType:this.componentType,duration:e},context:{endingPoint:t}})}recordVideoSkipped({beginTime:t,endTime:e,duration:r}){this.coreFunctions.requestRecordEvent({verb:"skipped",object:{componentName:this.componentName,componentType:this.componentType,duration:r},context:{startingPoint:t,endingPoint:e}})}recordVideoCompleted({duration:t}){this.coreFunctions.requestRecordEvent({verb:"completed",object:{componentName:this.componentName,componentType:this.componentType,duration:t}})}};T(wd,"componentType","video");var Ed=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:{size:500,isAbsolute:!0},public:!0,forRenderer:!0},e.height={createComponentOfType:"_componentSize",createStateVariable:"height",defaultValue:{size:500,isAbsolute:!0},public:!0,forRenderer:!0},e.geogebra={createComponentOfType:"text",createStateVariable:"geogebra",defaultValue:null,public:!0,forRenderer:!0},e.encodedGeogebraContent={createComponentOfType:"text",createStateVariable:"encodedGeogebraContent",defaultValue:null,public:!0,forRenderer:!0},e.fromMathInsight={createComponentOfType:"text",createStateVariable:"fromMathInsight",defaultValue:null,public:!0,forRenderer:!0},e}};T(Ed,"componentType","embed");var Sl=class extends ce{static returnChildGroups(){return[{group:"titles",componentTypes:["title"]},{group:"inlinesBlocks",componentTypes:["_inline","_block"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.showHints={forRenderer:!0,returnDependencies:()=>({hide:{dependencyType:"stateVariable",variableName:"hide"},showHintsFlag:{dependencyType:"flag",flagName:"showHints"}}),definition({dependencyValues:e}){return{setValue:{showHints:e.showHintsFlag&&!e.hide}}}},t.open={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,hasEssential:!0,returnDependencies:()=>({}),definition(){return{useEssentialOrDefaultValue:{open:!0}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"open",value:e.open}]}}},t.titleDefinedByChildren={forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childGroups:["titles"]}}),definition({dependencyValues:e}){return{setValue:{titleDefinedByChildren:e.titleChild.length>0}}}},t.title={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childGroups:["titles"],variableNames:["text"]}}),definition({dependencyValues:e}){return e.titleChild.length===0?{setValue:{title:"Hint"}}:{setValue:{title:e.titleChild[0].stateValues.text}}}},t}async revealHint({actionId:t}){return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!0}],actionId:t,event:{verb:"viewed",object:{componentName:this.componentName,componentType:this.componentType}}})}async closeHint({actionId:t}){return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!1}],actionId:t,event:{verb:"closed",object:{componentName:this.componentName,componentType:this.componentType}}})}actions={revealHint:this.revealHint.bind(this),closeHint:this.closeHint.bind(this)}};T(Sl,"componentType","hint"),T(Sl,"renderChildren",!0),T(Sl,"includeBlankStringChildren",!0);var wl=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.hide={createComponentOfType:"boolean"},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){return{success:!0,newChildren:[{componentType:"_solutionContainer",children:r}]}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"inlinesBlocks",componentTypes:["_inline","_block"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.hide={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,hasEssential:!0,returnDependencies:()=>({hideAttr:{dependencyType:"attributeComponent",attributeName:"hide",variableNames:["value"]},displayMode:{dependencyType:"flag",flagName:"solutionDisplayMode"}}),definition({dependencyValues:e}){return e.displayMode==="none"?{setValue:{hide:!0}}:e.hideAttr!==null?{setValue:{hide:e.hideAttr.stateValues.value}}:{useEssentialOrDefaultValue:{hide:!0}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.displayMode==="none"?{success:!1}:r.hideAttr!==null?{success:!0,instructions:[{setDependency:"hideAttr",desiredValue:e.hide,variableIndex:0}]}:{success:!0,instructions:[{setSetVariable:"hide",value:e.hide}]}}},t.open={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,hasEssential:!0,returnDependencies:()=>({displayMode:{dependencyType:"flag",flagName:"solutionDisplayMode"}}),definition({dependencyValues:e}){return e.displayMode==="displayed"?{setValue:{open:!0}}:e.displayMode==="none"?{setValue:{open:!1}}:{useEssentialOrDefaultValue:{open:!0}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.displayMode==="displayed"||r.displayMode==="none"?{success:!1}:{success:!0,instructions:[{setEssentialValue:"open",value:e.open}]}}},t.canBeClosed={forRenderer:!0,returnDependencies:()=>({displayMode:{dependencyType:"flag",flagName:"solutionDisplayMode"}}),definition({dependencyValues:e}){return e.displayMode==="button"?{setValue:{canBeClosed:!0}}:{setValue:{canBeClosed:!1}}}},t.message={public:!0,componentType:"text",forRenderer:!0,defaultValue:"",hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{message:!0}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"message",value:e.message}]}}},t}async revealSolution({actionId:t}){let{scoredItemNumber:e,scoredComponent:r}=await this.coreFunctions.calculateScoredItemNumberOfContainer(this.componentName),{allowView:n,message:i}=await this.coreFunctions.recordSolutionView({itemNumber:e,scoredComponent:r}),s=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:n},{updateType:"updateValue",componentName:this.componentName,stateVariable:"message",value:i}],o;return n&&(s.push({updateType:"updateValue",componentName:r,stateVariable:"viewedSolution",value:!0}),o={verb:"viewed",object:{componentName:this.componentName,componentType:this.componentType}}),await this.coreFunctions.performUpdate({updateInstructions:s,actionId:t,event:o,overrideReadOnly:!0})}async closeSolution({actionId:t}){return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!1}],actionId:t,event:{verb:"closed",object:{componentName:this.componentName,componentType:this.componentType}}})}actions={revealSolution:this.revealSolution.bind(this),closeSolution:this.closeSolution.bind(this)}};T(wl,"componentType","solution"),T(wl,"renderChildren",!0),T(wl,"includeBlankStringChildren",!0);var yp=class extends Tr{static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return $r({stateVariableDefinitions:t,oldName:"value",newName:"originalValue"}),t.value={public:!0,componentType:this.componentType,returnDependencies:()=>({originalValue:{dependencyType:"stateVariable",variableName:"originalValue"}}),definition:function({dependencyValues:e}){let r=e.originalValue,n=/^(-?\d+)(\d{3})/,i=r.match(n);for(;i!==null;)r=r.replace(n,"$1,$2"),i=r.match(n);return{setValue:{value:r}}}},t.text={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:({dependencyValues:e})=>({setValue:{text:e.value}})},t}};T(yp,"componentType","intcomma"),T(yp,"rendererType","text");var OU="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),DU=function(a){let t=(a=a||"_")+"-";for(let e=0;e<7;e++)t+=OU[Math.floor(Math.random()*OU.length)];return t},IU={"!":"\xA1","?":"\xBF\u0241",'"':'\u201C\u201D"\u275D\u275E',"'":"\u2018\u201B\u275B\u275C","-":"\u2014\u2013",a:"\xAA\xC0\xC1\xC2\xC3\xC4\xC5\xE0\xE1\xE2\xE3\xE4\xE5\u0100\u0101\u0102\u0103\u0104\u0105\u01CD\u01CE\u01DE\u01DF\u01E0\u01E1\u01FA\u01FB\u0200\u0201\u0202\u0203\u0226\u0227\u023A\u0386\u0391\u0394\u039B\u03AC\u03B1\u03BB\u0410\u0430\u0434\u0466\u0467\u04D0\u04D1\u04D2\u04D3\u019B\u0245\xE6",b:"\xDF\xFE\u0180\u0181\u0182\u0183\u0184\u0185\u0243\u0392\u03B2\u03D0\u03E6\u0411\u0412\u042A\u042C\u0432\u044A\u044C\u0462\u0463\u048C\u048D",c:"\xA2\xA9\xC7\xE7\u0106\u0107\u0108\u0109\u010A\u010B\u010C\u010D\u0186\u0187\u0188\u023B\u023C\u037B\u037C\u037D\u03F2\u03F9\u03FD\u03FE\u0421\u0441\u0454\u0480\u0481\u04AA\u04AB",d:"\xD0\u010E\u010F\u0110\u0111\u0189\u018A\u0221\u018B\u018C\u01F7",e:"\xC8\xC9\xCA\xCB\xE8\xE9\xEA\xEB\u0112\u0113\u0114\u0115\u0116\u0117\u0118\u0119\u011A\u011B\u018E\u018F\u0190\u01DD\u0204\u0205\u0206\u0207\u0228\u0229\u0246\u0247\u0388\u0395\u039E\u03A3\u03AD\u03B5\u03BE\u03F1\u03F5\u03F6\u0400\u0401\u0415\u042D\u0435\u0450\u0451\u04BC\u04BD\u04BE\u04BF\u04D6\u04D7\u04D8\u04D9\u04DA\u04DB\u04EC\u04ED",f:"\u0191\u0192\u03DC\u03DD\u04FA\u04FB\u0492\u0493\u017F",g:"\u011C\u011D\u011E\u011F\u0120\u0121\u0122\u0123\u0193\u01E4\u01E5\u01E6\u01E7\u01F4\u01F5",h:"\u0124\u0125\u0126\u0127\u0195\u01F6\u021E\u021F\u0389\u0397\u0402\u040A\u040B\u041D\u043D\u0452\u045B\u04A2\u04A3\u04A4\u04A5\u04BA\u04BB\u04C9\u04CA",I:"\xCC\xCD\xCE\xCF",i:"\xEC\xED\xEE\xEF\u0128\u0129\u012A\u012B\u012C\u012D\u012E\u012F\u0130\u0131\u0196\u0197\u0208\u0209\u020A\u020B\u038A\u0390\u03AA\u03AF\u03B9\u03CA\u0406\u0407\u0456\u0457",j:"\u0134\u0135\u01F0\u0237\u0248\u0249\u03F3\u0408\u0458",k:"\u0136\u0137\u0138\u0198\u0199\u01E8\u01E9\u039A\u03BA\u040C\u0416\u041A\u0436\u043A\u045C\u049A\u049B\u049C\u049D\u049E\u049F\u04A0\u04A1",l:"\u0139\u013A\u013B\u013C\u013D\u013E\u013F\u0140\u0141\u0142\u019A\u01AA\u01C0\u01CF\u01D0\u0234\u023D\u0399\u04C0\u04CF",m:"\u039C\u03FA\u03FB\u041C\u043C\u04CD\u04CE",n:"\xD1\xF1\u0143\u0144\u0145\u0146\u0147\u0148\u0149\u014A\u014B\u019D\u019E\u01F8\u01F9\u0220\u0235\u039D\u03A0\u03AE\u03B7\u03DE\u040D\u0418\u0419\u041B\u041F\u0438\u0439\u043B\u043F\u045D\u048A\u048B\u04C5\u04C6\u04E2\u04E3\u04E4\u04E5\u03C0",o:"\xD2\xD3\xD4\xD5\xD6\xD8\xF0\xF2\xF3\xF4\xF5\xF6\xF8\u014C\u014D\u014E\u014F\u0150\u0151\u019F\u01A0\u01A1\u01D1\u01D2\u01EA\u01EB\u01EC\u01ED\u01FE\u01FF\u020C\u020D\u020E\u020F\u022A\u022B\u022C\u022D\u022E\u022F\u0230\u0231\u038C\u0398\u039F\u03B8\u03BF\u03C3\u03CC\u03D5\u03D8\u03D9\u03EC\u03ED\u03F4\u041E\u0424\u043E\u0472\u0473\u04E6\u04E7\u04E8\u04E9\u04EA\u04EB",p:"\u01A4\u01BF\u03A1\u03C1\u03F7\u03F8\u03FC\u0420\u0440\u048E\u048F\xDE",q:"\u024A\u024B",r:"\u0154\u0155\u0156\u0157\u0158\u0159\u01A6\u0210\u0211\u0212\u0213\u024C\u024D\u0403\u0413\u042F\u0433\u044F\u0453\u0490\u0491",s:"\u015A\u015B\u015C\u015D\u015E\u015F\u0160\u0161\u01A7\u01A8\u0218\u0219\u023F\u0405\u0455",t:"\u0162\u0163\u0164\u0165\u0166\u0167\u01AB\u01AC\u01AD\u01AE\u021A\u021B\u0236\u023E\u0393\u03A4\u03C4\u03EE\u0422\u0442",u:"\xB5\xD9\xDA\xDB\xDC\xF9\xFA\xFB\xFC\u0168\u0169\u016A\u016B\u016C\u016D\u016E\u016F\u0170\u0171\u0172\u0173\u01AF\u01B0\u01B1\u01B2\u01D3\u01D4\u01D5\u01D6\u01D7\u01D8\u01D9\u01DA\u01DB\u01DC\u0214\u0215\u0216\u0217\u0244\u03B0\u03BC\u03C5\u03CB\u03CD",v:"\u03BD\u0474\u0475\u0476\u0477",w:"\u0174\u0175\u019C\u03C9\u03CE\u03D6\u03E2\u03E3\u0428\u0429\u0448\u0449\u0461\u047F",x:"\xD7\u03A7\u03C7\u03D7\u03F0\u0425\u0445\u04B2\u04B3\u04FC\u04FD\u04FE\u04FF",y:"\xDD\xFD\xFF\u0176\u0177\u0178\u01B3\u01B4\u0232\u0233\u024E\u024F\u038E\u03A5\u03AB\u03B3\u03C8\u03D2\u03D3\u03D4\u040E\u0423\u0443\u0447\u045E\u0470\u0471\u04AE\u04AF\u04B0\u04B1\u04EE\u04EF\u04F0\u04F1\u04F2\u04F3",z:"\u0179\u017A\u017B\u017C\u017D\u017E\u01A9\u01B5\u01B6\u0224\u0225\u0240\u0396\u03B6"},JE={};Object.keys(IU).forEach(function(a){IU[a].split("").forEach(function(t){JE[t]=a})});var QE=a=>{let t=a.split("");return t.forEach((e,r)=>{JE[e]&&(t[r]=JE[e])}),t.join("")},hTe=/([A-Z]\.)+[A-Z]?,?$/,yTe=/^[A-Z]\.,?$/,bTe=/[A-Z]{2,}('s|,)?$/,gTe=/([a-z]\.)+[a-z]\.?$/,PU=function(a){return hTe.test(a)===!0||gTe.test(a)===!0||yTe.test(a)===!0||bTe.test(a)===!0},vTe=QE,TTe=PU,NTe=/[a-z\u00C0-\u00FF] ?\/ ?[a-z\u00C0-\u00FF]/,CTe=function(a){let t=a=(a=(a=a||"").toLowerCase()).trim();return a=vTe(a),NTe.test(a)===!0&&(a=a.replace(/\/.*/,"")),a=(a=(a=(a=(a=(a=(a=a.replace(/^[#@]/,"")).replace(/[,;.!?]+$/,"")).replace(/[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]+/g,"'")).replace(/[\u0022\u00AB\u00BB\u201C\u201D\u201E\u201F\u2033\u2034\u2036\u2037\u2E42\u301D\u301E\u301F\uFF02]+/g,'"')).replace(/\u2026/g,"...")).replace(/\u2013/g,"-")).replace(/([aeiou][ktrp])in$/,"$1ing"),/^(re|un)-?[^aeiou]./.test(a)===!0&&(a=a.replace("-","")),TTe(a)&&(a=a.replace(/\./g,"")),/^[:;]/.test(a)===!1&&(a=(a=(a=a.replace(/\.{3,}$/g,"")).replace(/[",\.!:;\?\)]+$/g,"")).replace(/^['"\(]+/g,"")),(a=(a=a.replace(/[\u200B-\u200D\uFEFF]/g,"")).trim())===""&&(a=t),a=a.replace(/([0-9]),([0-9])/g,"$1$2")},ATe=function(a){return a=(a=a.replace(/[']s$/,"")).replace(/s[']$/,"s")},STe=/^[ \n\t\.\[\](){}:,!\-?;\/&*^%+=~\|\u0022\uFF02\u0027\u201C\u201F\u201B\u201E\u2E42\u201A\u2035\u2036\u2037\u301D\u0060\u301F]+/,wTe=/[ \n\t\.'\[\](){}:,!\-?;\/&*@^#+=~\|\u0022\uFF02\u201D\u00B4\u301E]+$/,_U=/\//,eR=/[']/,ETe=/^[a-z]\.([a-z]\.)+/i,RTe=/^[-+\.][0-9]/,xTe=/^'[0-9]{2}/,VTe=a=>{let t=a,e="",r="";(a=(a=a.replace(STe,s=>(e=s,e!=="-"&&e!=="+"&&e!=="."||!RTe.test(a)?e==="'"&&xTe.test(a)?(e="",s):"":(e="",s)))).replace(wTe,s=>(r=s,eR.test(s)&&/[sn][']$/.test(t)&&eR.test(e)===!1?(r=r.replace(eR,""),"'"):ETe.test(a)===!0?(r=r.replace(/\./,""),"."):"")))===""&&(t=t.replace(/ *$/,s=>(r=s||"","")),a=t,e="",r=r);let n=CTe(a),i={text:a,clean:n,reduced:ATe(n),pre:e,post:r};return _U.test(a)&&a.split(_U).forEach(s=>{i.alias=i.alias||{},i.alias[s.trim()]=!0}),i},kU={};(function(a){let t=/^[A-Z][a-z'\u00C0-\u00FF]/,e=/^[A-Z]+s?$/;a.toUpperCase=function(){return this.text=this.text.toUpperCase(),this},a.toLowerCase=function(){return this.text=this.text.toLowerCase(),this},a.toTitleCase=function(){return this.text=this.text.replace(/^ *[a-z\u00C0-\u00FF]/,r=>r.toUpperCase()),this},a.isUpperCase=function(){return e.test(this.text)},a.isTitleCase=function(){return t.test(this.text)},a.titleCase=a.isTitleCase})(kU);var FU={};(function(a){let t=/(\u0022|\uFF02|\u0027|\u201C|\u2018|\u201F|\u201B|\u201E|\u2E42|\u201A|\u00AB|\u2039|\u2035|\u2036|\u2037|\u301D|\u0060|\u301F)/,e=/(\u0022|\uFF02|\u0027|\u201D|\u2019|\u201D|\u2019|\u201D|\u201D|\u2019|\u00BB|\u203A|\u2032|\u2033|\u2034|\u301E|\u00B4|\u301E)/;a.hasPost=function(r){return this.post.indexOf(r)!==-1},a.hasPre=function(r){return this.pre.indexOf(r)!==-1},a.hasQuote=function(){return t.test(this.pre)||e.test(this.post)},a.hasQuotation=a.hasQuote,a.hasComma=function(){return this.hasPost(",")},a.hasPeriod=function(){return this.hasPost(".")===!0&&this.hasPost("...")===!1},a.hasExclamation=function(){return this.hasPost("!")},a.hasQuestionMark=function(){return this.hasPost("?")||this.hasPost("\xBF")},a.hasEllipses=function(){return this.hasPost("..")||this.hasPost("\u2026")||this.hasPre("..")||this.hasPre("\u2026")},a.hasSemicolon=function(){return this.hasPost(";")},a.hasSlash=function(){return/\//.test(this.text)},a.hasHyphen=function(){let r=/^(-||)$/;return r.test(this.post)||r.test(this.pre)},a.hasDash=function(){let r=/ (-||) /;return r.test(this.post)||r.test(this.pre)},a.hasContraction=function(){return Boolean(this.implicit)},a.addPunctuation=function(r){return r!==","&&r!==";"||(this.post=this.post.replace(r,"")),this.post=r+this.post,this}})(FU);var bp={},jU=function(a,t,e=3){if(a===t)return 1;if(a.length<e||t.length<e)return 0;let r=function(i,s){let o=i.length,l=s.length;if(o===0)return l;if(l===0)return o;let u=(l>o?l:o)+1;if(Math.abs(o-l)>(u||100))return u||100;let c,p,m,f,d,h,y=[];for(let b=0;b<u;b++)y[b]=[b],y[b].length=u;for(let b=0;b<u;b++)y[0][b]=b;for(let b=1;b<=o;++b)for(p=i[b-1],c=1;c<=l;++c){if(b===c&&y[b][c]>4)return o;m=s[c-1],f=p===m?0:1,d=y[b-1][c]+1,(h=y[b][c-1]+1)<d&&(d=h),(h=y[b-1][c-1]+f)<d&&(d=h);let g=b>1&&c>1&&p===s[c-2]&&i[b-2]===m&&(h=y[b-2][c-2]+f)<d;y[b][c]=g?h:d}return y[o][l]}(a,t),n=Math.max(a.length,t.length);return 1-(n===0?0:r/n)},O1=function(){};O1=function(a,t,e,r){let n=function(i,s,o,l){if(s.id===i.id||s.anything===!0)return!0;if(s.start===!0&&o!==0||s.end===!0&&o!==l-1)return!1;if(s.word!==void 0){if(i.implicit!==null&&i.implicit===s.word||i.alias!==void 0&&i.alias.hasOwnProperty(s.word)||s.soft===!0&&s.word===i.root)return!0;if(s.fuzzy!==void 0){let u=jU(s.word,i.reduced);if(u>s.fuzzy||s.soft===!0&&(u=jU(s.word,i.root),u>s.fuzzy))return!0}return s.word===i.clean||s.word===i.text||s.word===i.reduced}return s.tag!==void 0?i.tags[s.tag]===!0:s.method!==void 0?typeof i[s.method]=="function"&&i[s.method]()===!0:s.regex!==void 0?s.regex.test(i.clean):s.fastOr!==void 0?!(!i.implicit||s.fastOr.hasOwnProperty(i.implicit)!==!0)||s.fastOr.hasOwnProperty(i.reduced)||s.fastOr.hasOwnProperty(i.text):s.choices!==void 0&&(s.operator==="and"?s.choices.every(u=>O1(i,u,o,l)):s.choices.some(u=>O1(i,u,o,l)))}(a,t,e,r);return t.negative===!0?!n:n};var OTe=O1,DTe=PU,ITe={};bp.doesMatch=function(a,t,e){return OTe(this,a,t,e)},bp.isAcronym=function(){return DTe(this.text)},bp.isImplicit=function(){return this.text===""&&Boolean(this.implicit)},bp.isKnown=function(){return Object.keys(this.tags).some(a=>ITe[a]!==!0)},bp.setRoot=function(a){let t=a.transforms,e=this.implicit||this.clean;if(this.tags.Plural&&(e=t.toSingular(e,a)),this.tags.Verb&&!this.tags.Negative&&!this.tags.Infinitive){let r=null;this.tags.PastTense?r="PastTense":this.tags.Gerund?r="Gerund":this.tags.PresentTense?r="PresentTense":this.tags.Participle?r="Participle":this.tags.Actor&&(r="Actor"),e=t.toInfinitive(e,a,r)}this.root=e};var MU={},PTe=QE,_Te=/[\s-]/,kTe=/^[A-Z-]+$/;MU.textOut=function(a,t,e){a=a||{};let r=this.text,n=this.pre,i=this.post;return a.reduced===!0&&(r=this.reduced||""),a.root===!0&&(r=this.root||""),a.implicit===!0&&this.implicit&&(r=this.implicit||""),a.normal===!0&&(r=this.clean||this.text||""),a.root===!0&&(r=this.root||this.reduced||""),a.unicode===!0&&(r=PTe(r)),a.titlecase===!0&&(this.tags.ProperNoun&&!this.titleCase()||(this.tags.Acronym?r=r.toUpperCase():kTe.test(r)&&!this.tags.Acronym&&(r=r.toLowerCase()))),a.lowercase===!0&&(r=r.toLowerCase()),a.acronyms===!0&&this.tags.Acronym&&(r=r.replace(/\./g,"")),a.whitespace!==!0&&a.root!==!0||(n="",i=" ",_Te.test(this.post)!==!1&&!a.last||this.implicit||(i="")),a.punctuation!==!0||a.root||(this.hasPost(".")===!0?i="."+i:this.hasPost("?")===!0?i="?"+i:this.hasPost("!")===!0?i="!"+i:this.hasPost(",")===!0?i=","+i:this.hasEllipses()===!0&&(i="..."+i)),t!==!0&&(n=""),e!==!0&&(i=""),a.abbreviations===!0&&this.tags.Abbreviation&&(i=i.replace(/^\./,"")),n+r+i};var BU={},FTe={Auxiliary:1,Possessive:1},jTe=function(a,t){let e=Object.keys(a.tags),r=t.tags;return e=e.sort((n,i)=>FTe[i]||!r[i]?-1:r[i]?r[n]?r[n].lineage.length>r[i].lineage.length?1:r[n].isA.length>r[i].isA.length?-1:0:0:1),e},MTe={text:!0,tags:!0,implicit:!0,whitespace:!0,clean:!1,id:!1,index:!1,offset:!1,bestTag:!1};BU.json=function(a,t){a=a||{};let e={};return(a=Object.assign({},MTe,a)).text&&(e.text=this.text),a.normal&&(e.normal=this.clean),a.tags&&(e.tags=Object.keys(this.tags)),a.clean&&(e.clean=this.clean),(a.id||a.offset)&&(e.id=this.id),a.implicit&&this.implicit!==null&&(e.implicit=this.implicit),a.whitespace&&(e.pre=this.pre,e.post=this.post),a.bestTag&&(e.bestTag=jTe(this,t)[0]),e};var BTe=Object.assign({},kU,FU,bp,MU,BU),Rd={},gp={};function LU(){return typeof window!="undefined"&&window.document}var vp=function(a,t){for(a=a.toString();a.length<t;)a+=" ";return a};gp.logTag=function(a,t,e){if(LU())return void console.log("%c"+vp(a.clean,3)+"  + "+t+" ","color: #6accb2;");let r="[33m"+vp(a.clean,15)+"[0m + [32m"+t+"[0m ";e&&(r=vp(r,35)+" "+e),console.log(r)},gp.logUntag=function(a,t,e){if(LU())return void console.log("%c"+vp(a.clean,3)+"  - "+t+" ","color: #AB5850;");let r="[33m"+vp(a.clean,3)+" [31m - #"+t+"[0m ";e&&(r=vp(r,35)+" "+e),console.log(r)},gp.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"},gp.titleCase=a=>a.charAt(0).toUpperCase()+a.substr(1);var tR=gp,UU=function(a,t,e,r){let n=r.tags;if(t===""||t==="."||t==="-"||(t[0]==="#"&&(t=t.replace(/^#/,"")),t=tR.titleCase(t),a.tags[t]===!0))return;let i=r.isVerbose();i===!0&&tR.logTag(a,t,e),a.tags[t]=!0,n.hasOwnProperty(t)===!0&&(n[t].isA.forEach(s=>{a.tags[s]=!0,i===!0&&tR.logTag(a,"\u2192 "+s)}),a.unTag(n[t].notA,"\u2190",r))},zU=gp,LTe=/^[a-z]/,GU=function(a,t,e,r){let n=r.isVerbose();if(t==="*")return a.tags={},a;var i;t=t.replace(/^#/,""),LTe.test(t)===!0&&(t=(i=t).charAt(0).toUpperCase()+i.substr(1)),a.tags[t]===!0&&(delete a.tags[t],n===!0&&zU.logUntag(a,t,e));let s=r.tags;if(s[t]){let o=s[t].lineage;for(let l=0;l<o.length;l++)a.tags[o[l]]===!0&&(delete a.tags[o[l]],n===!0&&zU.logUntag(a," - "+o[l]))}return a},HU=function(a,t,e){let r=e.tags;if(t[0]==="#"&&(t=t.replace(/^#/,"")),r[t]===void 0)return!0;let n=r[t].notA||[];for(let i=0;i<n.length;i++)if(a.tags[n[i]]===!0)return!1;return r[t].isA===void 0||HU(a,r[t].isA,e)},qU=function(a,t,e,r){if(typeof t!="string")for(let n=0;n<t.length;n++)UU(a,t[n],e,r);else UU(a,t,e,r)},UTe=function(a,t,e,r){if(typeof t!="string"&&t)for(let n=0;n<t.length;n++)GU(a,t[n],e,r);else GU(a,t,e,r)},WU=HU;Rd.tag=function(a,t,e){return qU(this,a,t,e),this},Rd.tagSafe=function(a,t,e){return WU(this,a,e)&&qU(this,a,t,e),this},Rd.unTag=function(a,t,e){return UTe(this,a,t,e),this},Rd.canBe=function(a,t){return WU(this,a,t)};var zTe=DU,$U=VTe,GTe=BTe,HTe=Rd,Tp=class{constructor(t=""){t=String(t);let e=$U(t);this.text=e.text||"",this.clean=e.clean,this.reduced=e.reduced,this.root=null,this.implicit=null,this.pre=e.pre||"",this.post=e.post||"",this.tags={},this.prev=null,this.next=null,this.id=zTe(e.clean),this.isA="Term",e.alias&&(this.alias=e.alias)}set(t){let e=$U(t);return this.text=e.text,this.clean=e.clean,this.reduced=e.reduced,this.root=null,this.implicit=null,this}};Tp.prototype.clone=function(){let a=new Tp(this.text);return a.pre=this.pre,a.post=this.post,a.clean=this.clean,a.reduced=this.reduced,a.root=this.root,a.implicit=this.implicit,a.tags=Object.assign({},this.tags),a},Object.assign(Tp.prototype,GTe),Object.assign(Tp.prototype,HTe);var rR=Tp,qTe={terms:function(a){if(this.length===0)return[];if(this.cache.terms)return a!==void 0?this.cache.terms[a]:this.cache.terms;let t=[this.pool.get(this.start)];for(let e=0;e<this.length-1;e+=1){let r=t[t.length-1].next;if(r===null){console.error("Compromise error: Linked list broken in phrase '"+this.start+"'");break}let n=this.pool.get(r);if(t.push(n),a!==void 0&&a===e)return t[a]}return a===void 0&&(this.cache.terms=t),a!==void 0?t[a]:t},clone:function(a){if(a){let e=this.buildFrom(this.start,this.length);return e.cache=this.cache,e}let t=this.terms().map(e=>e.clone());return t.forEach((e,r)=>{this.pool.add(e),t[r+1]&&(e.next=t[r+1].id),t[r-1]&&(e.prev=t[r-1].id)}),this.buildFrom(t[0].id,t.length)},lastTerm:function(){let a=this.terms();return a[a.length-1]},hasId:function(a){if(this.length===0||!a)return!1;if(this.start===a)return!0;if(this.cache.terms){let e=this.cache.terms;for(let r=0;r<e.length;r++)if(e[r].id===a)return!0;return!1}let t=this.start;for(let e=0;e<this.length-1;e+=1){let r=this.pool.get(t);if(r===void 0)return console.error(`Compromise error: Linked list broken. Missing term '${t}' in phrase '${this.start}'
`),!1;if(r.next===a)return!0;t=r.next}return!1},wordCount:function(){return this.terms().filter(a=>a.text!=="").length},fullSentence:function(){let a=this.terms(0);for(;a.prev;)a=this.pool.get(a.prev);let t=a.id,e=1;for(;a.next;)a=this.pool.get(a.next),e+=1;return this.buildFrom(t,e)}},KU={};KU.text=function(a={},t,e){typeof a=="string"&&(a=a==="normal"?{whitespace:!0,unicode:!0,lowercase:!0,punctuation:!0,acronyms:!0,abbreviations:!0,implicit:!0,normal:!0}:a==="clean"?{titlecase:!1,lowercase:!0,punctuation:!0,whitespace:!0,unicode:!0,implicit:!0,normal:!0}:a==="reduced"?{punctuation:!1,titlecase:!1,lowercase:!0,whitespace:!0,unicode:!0,implicit:!0,reduced:!0}:a==="implicit"?{punctuation:!0,implicit:!0,whitespace:!0,trim:!0}:a==="root"?{titlecase:!1,lowercase:!0,punctuation:!0,whitespace:!0,unicode:!0,implicit:!0,root:!0}:{});let r=this.terms(),n=!1;r[0]&&r[0].prev===null&&r[r.length-1].next===null&&(n=!0);let i=r.reduce((s,o,l)=>{if(l===0&&o.text===""&&o.implicit!==null&&!a.implicit)return s;a.last=e&&l===r.length-1;let u=!0,c=!0;return n===!1&&(l===0&&t&&(u=!1),l===r.length-1&&e&&(c=!1)),s+o.textOut(a,u,c)},"");return n===!0&&e&&(i=i.replace(/ +$/,"")),a.trim===!0&&(i=i.trim()),i};var WTe={trim:function(){let a=this.terms();if(a.length>0){a[0].pre=a[0].pre.replace(/^\s+/,"");let t=a[a.length-1];t.post=t.post.replace(/\s+$/,"")}return this}},Np={},$Te=/[.?!]\s*$/,KTe=function(a,t){t[0].pre=a[0].pre;let e=a[a.length-1],r=t[t.length-1];r.post=function(n,i){return $Te.test(i)?i+n.match(/\s*$/):n}(e.post,r.post),e.post="",e.post===""&&(e.post+=" ")},XTe=/ /,XU=function(a,t,e){let r=a.terms(),n=t.terms();KTe(r,n),function(l,u,c){let p=l[l.length-1],m=u[u.length-1],f=p.next;p.next=u[0].id,m.next=f,f&&(c.get(f).prev=m.id);let d=l[0].id;d&&(u[0].prev=d)}(r,n,a.pool);let i=[a],s=a.start,o=[e];return o=o.concat(e.parents()),o.forEach(l=>{let u=l.list.filter(c=>c.hasId(s));i=i.concat(u)}),i=function(l){return l.filter((u,c)=>l.indexOf(u)===c)}(i),i.forEach(l=>{l.length+=t.length}),a.cache={},a},YTe=function(a,t,e){let r=a.start,n=t.terms();(function(o){let l=o[o.length-1];XTe.test(l.post)===!1&&(l.post+=" ")})(n),function(o,l,u){let c=u[u.length-1];c.next=o.start;let p=o.pool,m=p.get(o.start);m.prev&&(p.get(m.prev).next=l.start),u[0].prev=o.terms(0).prev,o.terms(0).prev=c.id}(a,t,n);let i=[a],s=[e];return s=s.concat(e.parents()),s.forEach(o=>{let l=o.list.filter(u=>u.hasId(r)||u.hasId(t.start));i=i.concat(l)}),i=function(o){return o.filter((l,u)=>o.indexOf(l)===u)}(i),i.forEach(o=>{o.length+=t.length,o.start===r&&(o.start=t.start),o.cache={}}),a},YU=function(a,t){let e=t.pool(),r=a.terms(),n=e.get(r[0].prev)||{},i=e.get(r[r.length-1].next)||{};r[0].implicit&&n.implicit&&(n.set(n.implicit),n.post+=" "),function(s,o,l,u){let c=s.parents();c.push(s),c.forEach(p=>{let m=p.list.find(f=>f.hasId(o));m&&(m.length-=l,m.start===o&&(m.start=u.id),m.cache={})}),s.list=s.list.filter(p=>!(!p.start||!p.length))}(t,a.start,a.length,i),n&&(n.next=i.id),i&&(i.prev=n.id)};Np.append=function(a,t){return XU(this,a,t),this},Np.prepend=function(a,t){return YTe(this,a,t),this},Np.delete=function(a){return YU(this,a),this},Np.replace=function(a,t){let e=this.length;XU(this,a,t);let r=this.buildFrom(this.start,this.length);r.length=e,YU(r,t)},Np.splitOn=function(a){let t=this.terms(),e={before:null,match:null,after:null},r=t.findIndex(o=>o.id===a.start);if(r===-1)return e;let n=t.slice(0,r);n.length>0&&(e.before=this.buildFrom(n[0].id,n.length));let i=t.slice(r,r+a.length);i.length>0&&(e.match=this.buildFrom(i[0].id,i.length));let s=t.slice(r+a.length,t.length);return s.length>0&&(e.after=this.buildFrom(s[0].id,s.length,this.pool)),e};var ZTe={json:function(a={},t){let e={};return a.text&&(e.text=this.text()),a.normal&&(e.normal=this.text("normal")),a.clean&&(e.clean=this.text("clean")),a.reduced&&(e.reduced=this.text("reduced")),a.implicit&&(e.implicit=this.text("implicit")),a.root&&(e.root=this.text("root")),a.trim&&(e.text&&(e.text=e.text.trim()),e.normal&&(e.normal=e.normal.trim()),e.reduced&&(e.reduced=e.reduced.trim())),a.terms&&(a.terms===!0&&(a.terms={}),e.terms=this.terms().map(r=>r.json(a.terms,t))),e}},JTe={lookAhead:function(a){a||(a=".*");let t=this.pool,e=[],r=function(s){let o=t.get(s);o&&(e.push(o),o.prev&&r(o.next))},n=this.terms(),i=n[n.length-1];return r(i.next),e.length===0?[]:this.buildFrom(e[0].id,e.length).match(a)},lookBehind:function(a){a||(a=".*");let t=this.pool,e=[],r=function(i){let s=t.get(i);s&&(e.push(s),s.prev&&r(s.prev))},n=t.get(this.start);return r(n.prev),e.length===0?[]:this.buildFrom(e[e.length-1].id,e.length).match(a)}},QTe=Object.assign({},qTe,KU,WTe,Np,ZTe,JTe),xd={},El,eNe=function(a,t){if(t.length===0)return!0;for(let e=0;e<t.length;e+=1){let r=t[e];if(r.optional!==!0&&r.negative!==!0&&r.start===!0&&e>0||r.anything===!0&&r.negative===!0)return!0}return!1},ZU={};(El=ZU).getGreedy=function(a,t){let e=Object.assign({},a.regs[a.r],{start:!1,end:!1}),r=a.t;for(;a.t<a.terms.length;a.t+=1){if(t&&a.terms[a.t].doesMatch(t,a.start_i+a.t,a.phrase_length))return a.t;let n=a.t-r+1;if(e.max!==void 0&&n===e.max)return a.t;if(a.terms[a.t].doesMatch(e,a.start_i+a.t,a.phrase_length)===!1)return e.min!==void 0&&n<e.min?null:a.t}return a.t},El.greedyTo=function(a,t){let e=a.t;if(!t)return a.terms.length;for(;e<a.terms.length;e+=1)if(a.terms[e].doesMatch(t,a.start_i+e,a.phrase_length)===!0)return e;return null},El.isEndGreedy=function(a,t){if(a.end===!0&&a.greedy===!0&&t.start_i+t.t<t.phrase_length-1){let e=Object.assign({},a,{end:!1});if(t.terms[t.t].doesMatch(e,t.start_i+t.t,t.phrase_length)===!0)return!0}return!1},El.doOrBlock=function(a,t=0){let e=a.regs[a.r],r=!1;for(let n=0;n<e.choices.length;n+=1){let i=e.choices[n];if(r=i.every((s,o)=>{let l=0,u=a.t+o+t+l;if(a.terms[u]===void 0)return!1;let c=a.terms[u].doesMatch(s,u+a.start_i,a.phrase_length);if(c===!0&&s.greedy===!0)for(let p=1;p<a.terms.length;p+=1){let m=a.terms[u+p];if(m){if(m.doesMatch(s,a.start_i+p,a.phrase_length)!==!0)break;l+=1}}return t+=l,c}),r){t+=i.length;break}}return r&&e.greedy===!0?El.doOrBlock(a,t):t},El.doAndBlock=function(a){let t=0;return a.regs[a.r].choices.every(e=>{let r=e.every((n,i)=>{let s=a.t+i;return a.terms[s]!==void 0&&a.terms[s].doesMatch(n,s,a.phrase_length)});return r===!0&&e.length>t&&(t=e.length),r})===!0&&t},El.getGroup=function(a,t,e){if(a.groups[a.groupId])return a.groups[a.groupId];let r=a.terms[t].id;return a.groups[a.groupId]={group:String(e),start:r,length:0},a.groups[a.groupId]};var tNe=DU,os=ZU,rNe=function(a,t,e,r){let n={t:0,terms:a,r:0,regs:t,groups:{},start_i:e,phrase_length:r,hasGroup:!1,groupId:null,previousGroup:null};for(;n.r<t.length;n.r+=1){let i=t[n.r];if(n.hasGroup=typeof i.named=="string"||typeof i.named=="number",n.hasGroup===!0){let l=t[n.r-1];l&&l.named===i.named&&n.previousGroup?n.groupId=n.previousGroup:(n.groupId=tNe(i.named),n.previousGroup=n.groupId)}if(!n.terms[n.t]){if(t.slice(n.r).some(l=>!l.optional)===!1)break;return null}if(i.anything===!0&&i.greedy===!0){let l=os.greedyTo(n,t[n.r+1]);if(l===null||l===0||i.min!==void 0&&l-n.t<i.min)return null;if(i.max!==void 0&&l-n.t>i.max){n.t=n.t+i.max;continue}n.hasGroup===!0&&(os.getGroup(n,n.t,i.named).length=l-n.t),n.t=l;continue}if(i.choices!==void 0&&i.operator==="or"){let l=os.doOrBlock(n);if(l){if(i.negative===!0)return null;n.hasGroup===!0&&(os.getGroup(n,n.t,i.named).length+=l),n.t+=l;continue}if(!i.optional)return null}if(i.choices!==void 0&&i.operator==="and"){let l=os.doAndBlock(n);if(l){if(i.negative===!0)return null;n.hasGroup===!0&&(os.getGroup(n,n.t,i.named).length+=l),n.t+=l;continue}if(!i.optional)return null}let s=n.terms[n.t],o=s.doesMatch(i,n.start_i+n.t,n.phrase_length);if(i.anything===!0||o===!0||os.isEndGreedy(i,n)){let l=n.t;if(i.optional&&t[n.r+1]&&i.negative)continue;if(i.optional&&t[n.r+1]){let u=s.doesMatch(t[n.r+1],n.start_i+n.t,n.phrase_length);if(i.negative||u){let c=n.terms[n.t+1];c&&c.doesMatch(t[n.r+1],n.start_i+n.t,n.phrase_length)||(n.r+=1)}}if(n.t+=1,i.end===!0&&n.t!==n.terms.length&&i.greedy!==!0||i.greedy===!0&&(n.t=os.getGreedy(n,t[n.r+1]),n.t===null||i.min&&i.min>n.t||i.end===!0&&n.start_i+n.t!==r))return null;if(n.hasGroup===!0){let u=os.getGroup(n,l,i.named);n.t>1&&i.greedy?u.length+=n.t-l:u.length++}}else{if(i.negative){let l=Object.assign({},i);if(l.negative=!1,n.terms[n.t].doesMatch(l,n.start_i+n.t,n.phrase_length)===!0)return null}if(i.optional!==!0){if(n.terms[n.t].isImplicit()&&t[n.r-1]&&n.terms[n.t+1]){if(n.terms[n.t-1]&&n.terms[n.t-1].implicit===t[n.r-1].word)return null;if(n.terms[n.t+1].doesMatch(i,n.start_i+n.t,n.phrase_length)){n.t+=2;continue}}return null}}}return{match:n.terms.slice(0,n.t),groups:n.groups}},nNe=function(a,t,e){if(!e||e.length===0)return e;if(t.some(r=>r.end)){let r=a[a.length-1];e=e.filter(({match:n})=>n.indexOf(r)!==-1)}return e},aNe=/(?:^|\s)([\!\[\^]*(?:<[^<]*>)?\/.*?[^\\\/]\/[\?\]\+\*\$~]*)(?:\s|$)/,iNe=/([\!\[\^]*(?:<[^<]*>)?\([^\)]+[^\\\)]\)[\?\]\+\*\$~]*)(?:\s|$)/,sNe=/ /g,JU=a=>/^[\!\[\^]*(<[^<]*>)?\//.test(a)&&/\/[\?\]\+\*\$~]*$/.test(a),QU=function(a){return a=(a=a.map(t=>t.trim())).filter(t=>t)},oNe=function(a){let t=a.split(aNe),e=[];t.forEach(n=>{JU(n)?e.push(n):e=e.concat(n.split(iNe))}),e=QU(e);let r=[];return e.forEach(n=>{(i=>/^[\!\[\^]*(<[^<]*>)?\(/.test(i)&&/\)[\?\]\+\*\$~]*$/.test(i))(n)||JU(n)?r.push(n):r=r.concat(n.split(sNe))}),r=QU(r),r},ez=/\{([0-9]+,?[0-9]*)\}/,tz=/&&/,lNe=new RegExp(/^<\s*?(\S+)\s*?>/),ls=function(a){return a[a.length-1]},li=function(a){return a[0]},Cp=function(a){return a.substr(1)},Ap=function(a){return a.substr(0,a.length-1)},rz=function(a){return a=Cp(a),a=Ap(a)},nz=function(a){let t={};for(let r=0;r<2;r+=1){if(ls(a)==="$"&&(t.end=!0,a=Ap(a)),li(a)==="^"&&(t.start=!0,a=Cp(a)),(li(a)==="["||ls(a)==="]")&&(t.named=!0,li(a)==="["?t.groupType=ls(a)==="]"?"single":"start":t.groupType="end",a=(a=a.replace(/^\[/,"")).replace(/\]$/,""),li(a)==="<")){let n=lNe.exec(a);n.length>=2&&(t.named=n[1],a=a.replace(n[0],""))}if(ls(a)==="+"&&(t.greedy=!0,a=Ap(a)),a!=="*"&&ls(a)==="*"&&a!=="\\*"&&(t.greedy=!0,a=Ap(a)),ls(a)==="?"&&(t.optional=!0,a=Ap(a)),li(a)==="!"&&(t.negative=!0,a=Cp(a)),li(a)==="("&&ls(a)===")"){tz.test(a)?(t.choices=a.split(tz),t.operator="and"):(t.choices=a.split("|"),t.operator="or"),t.choices[0]=Cp(t.choices[0]);let n=t.choices.length-1;t.choices[n]=Ap(t.choices[n]),t.choices=t.choices.map(i=>i.trim()),t.choices=t.choices.filter(i=>i),t.choices=t.choices.map(i=>i.split(/ /g).map(nz)),a=""}if(li(a)==="/"&&ls(a)==="/")return a=rz(a),t.regex=new RegExp(a),t;if(li(a)==="~"&&ls(a)==="~")return a=rz(a),t.soft=!0,t.word=a,t}return ez.test(a)===!0&&(a=a.replace(ez,(r,n)=>{let i=n.split(/,/g);return i.length===1?(t.min=Number(i[0]),t.max=Number(i[0])):(t.min=Number(i[0]),t.max=Number(i[1]||999)),t.greedy=!0,t.optional=!0,""})),li(a)==="#"?(t.tag=Cp(a),t.tag=(e=t.tag).charAt(0).toUpperCase()+e.substr(1),t):li(a)==="@"?(t.method=Cp(a),t):a==="."?(t.anything=!0,t):a==="*"?(t.anything=!0,t.greedy=!0,t.optional=!0,t):(a&&(a=(a=a.replace("\\*","*")).replace("\\.","."),t.word=a.toLowerCase()),t);var e},uNe=oNe,cNe=nz,pNe=function(a,t={}){return a.filter(e=>e.groupType).length>0&&(a=function(e){let r,n=!1,i=-1;for(let s=0;s<e.length;s++){let o=e[s];o.groupType!=="single"||o.named!==!0?(o.groupType==="start"&&(n=!0,typeof o.named=="string"||typeof o.named=="number"?r=o.named:(i+=1,r=i)),n&&(o.named=r),o.groupType==="end"&&(n=!1)):(i+=1,o.named=i)}return e}(a)),t.fuzzy||(a=function(e){return e.map(r=>{if(r.choices!==void 0&&r.choices.every(n=>{if(n.length!==1)return!1;let i=n[0];return i.word!==void 0&&i.negative!==!0&&i.optional!==!0&&i.method!==!0})===!0){let n={};r.choices.forEach(i=>{n[i[0].word]=!0}),r.fastOr=n,delete r.choices}return r})}(a)),a},Vd=function(a,t={}){if(a==null||a==="")return[];if(typeof a=="object"){if(function(r){return Object.prototype.toString.call(r)==="[object Array]"}(a)){if(a.length===0||!a[0])return[];if(typeof a[0]=="object")return a;if(typeof a[0]=="string")return function(r){return[{choices:r.map(n=>[{word:n}]),operator:"or"}]}(a)}return a&&a.isA==="Doc"?function(r){if(!r||!r.list||!r.list[0])return[];let n=[];return r.list.forEach(i=>{let s=[];i.terms().forEach(o=>{s.push(o.id)}),n.push(s)}),[{idBlocks:n}]}(a):[]}typeof a=="number"&&(a=String(a));let e=uNe(a);return e=e.map(r=>cNe(r)),e=pNe(e,t),e=function(r,n){return n.fuzzy===!0&&(n.fuzzy=.85),typeof n.fuzzy=="number"&&(r=r.map(i=>(n.fuzzy>0&&i.word&&(i.fuzzy=n.fuzzy),i.choices&&i.choices.forEach(s=>{s.forEach(o=>{o.fuzzy=n.fuzzy})}),i))),r}(e,t),e},mNe=eNe,az=rNe,D1=nNe,fNe=Vd,dNe=function(a,t){let e=[],r=t[0].idBlocks;for(let n=0;n<a.length;n+=1)r.forEach(i=>{i.length!==0&&i.every((s,o)=>a[n+o].id===s)&&(e.push({match:a.slice(n,n+i.length)}),n+=i.length-1)});return e},iz=function(a,t,e=!1){if(typeof t=="string"&&(t=fNe(t)),mNe(a,t)===!0)return[];let r=t.filter(s=>s.optional!==!0&&s.negative!==!0).length,n=a.terms(),i=[];if(t[0].idBlocks){let s=dNe(n,t);if(s&&s.length>0)return D1(n,t,s)}if(t[0].start===!0){let s=az(n,t,0,n.length);return s&&s.match&&s.match.length>0&&(s.match=s.match.filter(o=>o),i.push(s)),D1(n,t,i)}for(let s=0;s<n.length&&!(s+r>n.length);s+=1){let o=az(n.slice(s),t,s,n.length);if(o&&o.match&&o.match.length>0&&(s+=o.match.length-1,o.match=o.match.filter(l=>l),i.push(o),e===!0))return D1(n,t,i)}return D1(n,t,i)},hNe=iz,sz=iz,yNe=function(a,t){let e={};hNe(a,t).forEach(({match:s})=>{s.forEach(o=>{e[o.id]=!0})});let r=a.terms(),n=[],i=[];return r.forEach(s=>{e[s.id]!==!0?i.push(s):i.length>0&&(n.push(i),i=[])}),i.length>0&&n.push(i),n};xd.match=function(a,t=!1){let e=sz(this,a,t);return e=e.map(({match:r,groups:n})=>{let i=this.buildFrom(r[0].id,r.length,n);return i.cache.terms=r,i}),e},xd.has=function(a){return sz(this,a,!0).length>0},xd.not=function(a){let t=yNe(this,a);return t=t.map(e=>this.buildFrom(e[0].id,e.length)),t},xd.canBe=function(a,t){let e=[],r=this.terms(),n=!1;for(let i=0;i<r.length;i+=1){let s=r[i].canBe(a,t);s===!0&&(n===!0?e[e.length-1].push(r[i]):e.push([r[i]]),n=s)}return e=e.filter(i=>i.length>0).map(i=>this.buildFrom(i[0].id,i.length)),e};var bNe=QTe,gNe=xd,no=class{constructor(t,e,r){this.start=t,this.length=e,this.isA="Phrase",Object.defineProperty(this,"pool",{enumerable:!1,writable:!0,value:r}),Object.defineProperty(this,"cache",{enumerable:!1,writable:!0,value:{}}),Object.defineProperty(this,"groups",{enumerable:!1,writable:!0,value:{}})}};no.prototype.buildFrom=function(a,t,e){let r=new no(a,t,this.pool);return e&&Object.keys(e).length>0?r.groups=e:r.groups=this.groups,r},Object.assign(no.prototype,gNe),Object.assign(no.prototype,bNe);var oz={term:"terms"};Object.keys(oz).forEach(a=>no.prototype[a]=no.prototype[oz[a]]);var nR=no,I1=class{constructor(t={}){Object.defineProperty(this,"words",{enumerable:!1,value:t})}add(t){return this.words[t.id]=t,this}get(t){return this.words[t]}remove(t){delete this.words[t]}merge(t){return Object.assign(this.words,t.words),this}stats(){return{words:Object.keys(this.words).length}}};I1.prototype.clone=function(){let a=Object.keys(this.words).reduce((t,e)=>{let r=this.words[e].clone();return t[r.id]=r,t},{});return new I1(a)};var aR=I1,lz=a=>{a.forEach((t,e)=>{e>0&&(t.prev=a[e-1].id),a[e+1]&&(t.next=a[e+1].id)})},vNe=/(\S.+?[.!?\u203D\u2E18\u203C\u2047-\u2049])(?=\s+|$)/g,uz=/\S/,TNe=/[ .][A-Z]\.? *$/i,NNe=/(?:\u2026|\.{2,}) *$/,CNe=/((?:\r?\n|\r)+)/,ANe=/[a-z0-9\u00C0-\u00FF\u00a9\u00ae\u2000-\u3300\ud000-\udfff]/i,cz=/^\s+/,SNe=function(a,t,e,r){if(r.hasLetter=function(s,o){return o||ANe.test(s)}(t,r.hasLetter),!r.hasLetter||function(s,o){return o.indexOf(".")!==-1&&TNe.test(s)}(a,t)||function(s,o){return o.indexOf(".")!==-1&&NNe.test(s)}(a,t))return!1;let n=a.replace(/[.!?\u203D\u2E18\u203C\u2047-\u2049] *$/,"").split(" "),i=n[n.length-1].toLowerCase();return!e.hasOwnProperty(i)},wNe=function(a,t){let e=t.cache.abbreviations;a=a||"";let r=[],n=[];if(!(a=String(a))||typeof a!="string"||uz.test(a)===!1)return r;let i=function(l){let u=[],c=l.split(CNe);for(let p=0;p<c.length;p++){let m=c[p].split(vNe);for(let f=0;f<m.length;f++)u.push(m[f])}return u}(a=a.replace("\xA0"," "));for(let l=0;l<i.length;l++){let u=i[l];if(u!==void 0&&u!==""){if(uz.test(u)===!1){if(n[n.length-1]){n[n.length-1]+=u;continue}if(i[l+1]){i[l+1]=u+i[l+1];continue}}n.push(u)}}let s=n[0]||"",o={hasLetter:!1};for(let l=0;l<n.length;l++){let u=n[l];n[l+1]&&SNe(u,s,e,o)===!1?(s=n[l+1]||"",n[l+1]=u+s):u&&u.length>0&&(r.push(u),s=n[l+1]||"",o.hasLetter=!1),n[l]=""}if(r.length===0)return[a];for(let l=1;l<r.length;l+=1){let u=r[l].match(cz);u!==null&&(r[l-1]+=u[0],r[l]=r[l].replace(cz,""))}return r},ENe=/\S/,RNe=/^[!?.]+$/,xNe=/(\S+)/,VNe=/[a-z] ?\/ ?[a-z]*$/,iR=[".","?","!",":",";","-","\u2013","\u2014","--","...","(",")","[","]",'"',"'","`"];iR=iR.reduce((a,t)=>(a[t]=!0,a),{});var ONe=function(a){return/^(re|un|micro|macro|trans|bi|mono|over)-?[^aeiou]./.test(a)===!0||/^([a-z\u00C0-\u00FF/]+)(-||)(like|ish|less|able)/i.test(a)===!0?!1:/^([a-z\u00C0-\u00FF`"'/]+)(-||)([a-z0-9\u00C0-\u00FF].*)/i.test(a)===!0?!0:/^([0-9]{1,4})(-||)([a-z\u00C0-\u00FF`"'/-]+$)/i.test(a)===!0},DNe=function(a){let t=[],e=a.split(/[-]/),r="-",n=a.match(/[-]/);n&&n[0]&&(r=n);for(let i=0;i<e.length;i++)i===e.length-1?t.push(e[i]):t.push(e[i]+r);return t},INe=rR,PNe=nR,_Ne=aR,kNe=lz,FNe=wNe,jNe=function(a){let t=[],e=[];if(typeof(a=a||"")=="number"&&(a=String(a)),function(i){return Object.prototype.toString.call(i)==="[object Array]"}(a))return a;let r=a.split(xNe);for(let i=0;i<r.length;i++)ONe(r[i])!==!0?e.push(r[i]):e=e.concat(DNe(r[i]));let n="";for(let i=0;i<e.length;i++){let s=e[i];ENe.test(s)===!0&&iR.hasOwnProperty(s)===!1&&RNe.test(s)===!1?(t.length>0?(t[t.length-1]+=n,t.push(s)):t.push(n+s),n=""):n+=s}return n&&(t.length===0&&(t[0]=""),t[t.length-1]+=n),t=function(i){for(let s=1;s<i.length-1;s++)VNe.test(i[s])&&(i[s-1]+=i[s]+i[s+1],i[s]=null,i[s+1]=null);return i}(t),t=function(i){let s=/^[0-9]{1,4}(:[0-9][0-9])?([a-z]{1,2})? ?(-||) ?$/,o=/^[0-9]{1,4}([a-z]{1,2})? ?$/;for(let l=0;l<i.length-1;l+=1)i[l+1]&&s.test(i[l])&&o.test(i[l+1])&&(i[l]=i[l]+i[l+1],i[l+1]=null);return i}(t),t=t.filter(i=>i),t},Od=function(a="",t,e){let r=null;return typeof a!="string"&&(typeof a=="number"?a=String(a):function(n){return Object.prototype.toString.call(n)==="[object Array]"}(a)&&(r=a)),r=r||FNe(a,t),r=r.map(n=>jNe(n)),e=e||new _Ne,r.map(n=>{n=n.map(s=>{let o=new INe(s);return e.add(o),o}),kNe(n);let i=new PNe(n[0].id,n.length,e);return i.cache.terms=n,i})},MNe=rR,BNe=nR,LNe=aR,UNe=lz,zNe=function(a,t){let e=new LNe;return a.map((r,n)=>{let i=r.terms.map((s,o)=>{let l=new MNe(s.text);return l.pre=s.pre!==void 0?s.pre:"",s.post===void 0&&(s.post=" ",o>=r.terms.length-1&&(s.post=". ",n>=r.terms.length-1&&(s.post="."))),l.post=s.post!==void 0?s.post:" ",s.tags&&s.tags.forEach(u=>l.tag(u,"",t)),e.add(l),l});return UNe(i),new BNe(i[0].id,i.length,e)})},P1=["Person","Place","Organization"],sR=["Noun","Verb","Adjective","Adverb","Value","QuestionWord"],_1={Noun:"blue",Verb:"green",Negative:"green",Date:"red",Value:"red",Adjective:"magenta",Preposition:"cyan",Conjunction:"cyan",Determiner:"cyan",Adverb:"cyan"},GNe=function(a){return Object.keys(a).forEach(t=>{a[t].color?a[t].color=a[t].color:_1[t]?a[t].color=_1[t]:a[t].isA.some(e=>!!_1[e]&&(a[t].color=_1[e],!0))}),a},HNe=function(a){return Object.keys(a).forEach(t=>{let e=a[t],r=e.isA.length;for(let n=0;n<r;n++){let i=e.isA[n];a[i]&&(e.isA=e.isA.concat(a[i].isA))}e.isA=function(n){return n.filter((i,s,o)=>o.indexOf(i)===s)}(e.isA)}),a},qNe=function(a){let t=Object.keys(a);return t.forEach(e=>{let r=a[e];r.notA=r.notA||[],r.isA.forEach(n=>{if(a[n]&&a[n].notA){let i=typeof a[n].notA=="string"?[a[n].isA]:a[n].notA||[];r.notA=r.notA.concat(i)}});for(let n=0;n<t.length;n++){let i=t[n];a[i].notA.indexOf(e)!==-1&&r.notA.push(i)}r.notA=function(n){return n.filter((i,s,o)=>o.indexOf(i)===s)}(r.notA)}),a},WNe=function(a){let t=Object.keys(a);return t.forEach(e=>{let r=a[e];r.lineage=[];for(let n=0;n<t.length;n++)a[t[n]].isA.indexOf(e)!==-1&&r.lineage.push(t[n])}),a},pz=function(a){return a=function(t){return Object.keys(t).forEach(e=>{let r=t[e];r.isA=r.isA||[],typeof r.isA=="string"&&(r.isA=[r.isA]),r.notA=r.notA||[],typeof r.notA=="string"&&(r.notA=[r.notA])}),t}(a),a=HNe(a),a=qNe(a),a=GNe(a),a=WNe(a)},$Ne={Noun:{notA:["Verb","Adjective","Adverb"]},Singular:{isA:"Noun",notA:"Plural"},ProperNoun:{isA:"Noun"},Person:{isA:["ProperNoun","Singular"],notA:["Place","Organization","Date"]},FirstName:{isA:"Person"},MaleName:{isA:"FirstName",notA:["FemaleName","LastName"]},FemaleName:{isA:"FirstName",notA:["MaleName","LastName"]},LastName:{isA:"Person",notA:["FirstName"]},NickName:{isA:"Person",notA:["FirstName","LastName"]},Honorific:{isA:"Noun",notA:["FirstName","LastName","Value"]},Place:{isA:"Singular",notA:["Person","Organization"]},Country:{isA:["Place","ProperNoun"],notA:["City"]},City:{isA:["Place","ProperNoun"],notA:["Country"]},Region:{isA:["Place","ProperNoun"]},Address:{isA:"Place"},Organization:{isA:["Singular","ProperNoun"],notA:["Person","Place"]},SportsTeam:{isA:"Organization"},School:{isA:"Organization"},Company:{isA:"Organization"},Plural:{isA:"Noun",notA:["Singular"]},Uncountable:{isA:"Noun"},Pronoun:{isA:"Noun",notA:P1},Actor:{isA:"Noun",notA:P1},Activity:{isA:"Noun",notA:["Person","Place"]},Unit:{isA:"Noun",notA:P1},Demonym:{isA:["Noun","ProperNoun"],notA:P1},Possessive:{isA:"Noun"}},KNe={Verb:{notA:["Noun","Adjective","Adverb","Value","Expression"]},PresentTense:{isA:"Verb",notA:["PastTense","FutureTense"]},Infinitive:{isA:"PresentTense",notA:["PastTense","Gerund"]},Imperative:{isA:"Infinitive"},Gerund:{isA:"PresentTense",notA:["PastTense","Copula","FutureTense"]},PastTense:{isA:"Verb",notA:["FutureTense"]},FutureTense:{isA:"Verb"},Copula:{isA:"Verb"},Modal:{isA:"Verb",notA:["Infinitive"]},PerfectTense:{isA:"Verb",notA:"Gerund"},Pluperfect:{isA:"Verb"},Participle:{isA:"PastTense"},PhrasalVerb:{isA:"Verb"},Particle:{isA:"PhrasalVerb"},Auxiliary:{notA:["Noun","Adjective","Value"]}},XNe={Value:{notA:["Verb","Adjective","Adverb"]},Ordinal:{isA:"Value",notA:["Cardinal"]},Cardinal:{isA:"Value",notA:["Ordinal"]},Fraction:{isA:"Value",notA:["Noun"]},RomanNumeral:{isA:"Cardinal",notA:["Ordinal","TextValue"]},TextValue:{isA:"Value",notA:["NumericValue"]},NumericValue:{isA:"Value",notA:["TextValue"]},Money:{isA:"Cardinal"},Percent:{isA:"Value"}},YNe={Adjective:{notA:["Noun","Verb","Adverb","Value"]},Comparable:{isA:["Adjective"]},Comparative:{isA:["Adjective"]},Superlative:{isA:["Adjective"],notA:["Comparative"]},NumberRange:{},Adverb:{notA:["Noun","Verb","Adjective","Value"]},Date:{notA:["Verb","Adverb","Preposition","Adjective"]},Month:{isA:["Date","Singular"],notA:["Year","WeekDay","Time"]},WeekDay:{isA:["Date","Noun"]},Timezone:{isA:["Date","Noun"],notA:["Adjective","ProperNoun"]},Time:{isA:["Date"],notA:["AtMention"]},Determiner:{notA:sR},Conjunction:{notA:sR},Preposition:{notA:sR},QuestionWord:{notA:["Determiner"]},Currency:{isA:["Noun"]},Expression:{notA:["Noun","Adjective","Verb","Adverb"]},Abbreviation:{},Url:{notA:["HashTag","PhoneNumber","Verb","Adjective","Value","AtMention","Email"]},PhoneNumber:{notA:["HashTag","Verb","Adjective","Value","AtMention","Email"]},HashTag:{},AtMention:{isA:["Noun"],notA:["HashTag","Verb","Adjective","Value","Email"]},Emoji:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Emoticon:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Email:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Acronym:{notA:["Plural","RomanNumeral"]},Negative:{notA:["Noun","Adjective","Value"]},Condition:{notA:["Verb","Adjective","Noun","Value"]}},ZNe=pz,k1=function(a,t){Object.keys(a).forEach(e=>{t[e]=a[e]})},JNe=(()=>{let a={};return k1($Ne,a),k1(KNe,a),k1(XNe,a),k1(YNe,a),a=ZNe(a),a})(),QNe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",mz=QNe.split("").reduce(function(a,t,e){return a[t]=e,a},{}),oR=function(a){if(mz[a]!==void 0)return mz[a];let t=0,e=1,r=36,n=1;for(;e<a.length;t+=r,e++,r*=36);for(let i=a.length-1;i>=0;i--,n*=36){let s=a.charCodeAt(i)-48;s>10&&(s-=7),t+=s*n}return t},eCe=function(a,t,e){let r=oR(t);return r<a.symCount?a.syms[r]:e+r+1-a.symCount},tCe=function(a){let t={nodes:a.split(";"),syms:[],symCount:0};return a.match(":")&&function(e){let r=new RegExp("([0-9A-Z]+):([0-9A-Z]+)");for(let n=0;n<e.nodes.length;n++){let i=r.exec(e.nodes[n]);if(!i){e.symCount=n;break}e.syms[oR(i[1])]=oR(i[2])}e.nodes=e.nodes.slice(e.symCount,e.nodes.length)}(t),function(e){let r=[],n=(i,s)=>{let o=e.nodes[i];o[0]==="!"&&(r.push(s),o=o.slice(1));let l=o.split(/([A-Z0-9,]+)/g);for(let u=0;u<l.length;u+=2){let c=l[u],p=l[u+1];if(!c)continue;let m=s+c;if(p===","||p===void 0){r.push(m);continue}let f=eCe(e,p,i);n(f,m)}};return n(0,""),r}(t)},fz={Comparative:"true\xA6better",Superlative:"true\xA6earlier",PresentTense:"true\xA6is,sounds",Value:"true\xA6a few",Noun:"true\xA6a5b4c2f1here,ie,lit,m0no doubt,pd,tce;a,d;t,y;a,ca,o0;l,rp;a,l;d,l,rc",Copula:"true\xA6a1is,w0;as,ere;m,re",PastTense:"true\xA6be3came,d2had,lied,meant,sa2taken,w0;as,e0;nt,re;id;en,gan",Condition:"true\xA6if,lest,unless",Preposition:"true\xA6'o,-,aLbIcHdGexcept,fFiDmidQnotwithstandiRoBpSqua,sAt6u3vi2w0;/o,hereNith0;!in,oR;a,s-a-vis;n1p0;!on;like,til;h0ill,owards;an,r0;ough0u;!oJ;ans,ince,o that;',f0n2ut;!f;f,n0;!to;or,rom;espite,own,u3;hez,irca;ar1e0oAy;sides,tween;ri6;',bo7cross,ft6lo5m3propos,round,s1t0;!op;! long 0;as;id0ong0;!st;ng;er;ut",Gerund:"true\xA6accord0be0develop0go0result0stain0;ing",Negative:"true\xA6n0;ever,o0;!n,t",QuestionWord:"true\xA6how3wh0;at,e1ich,o0y;!m,se;n,re; come,'s",Plural:"true\xA6records",Conjunction:"true\xA6&,aFbBcuz,how9in caEno8o7p5supposing,t2v1wh0yet;eth9ile;ers4s;h0o;eref9o0;!uC;l0rovided that;us;r,therwi6; matt1r;!ev0;er;e0ut;cau1f0;ore;se;lthou1nd,s 0;far as,if;gh",Abbreviation:"true\xA6a0Jb0Gc0Ad08e05f02g01h00iYjWkanVlTmNnKoJpFque,rDs8t6u5v2w0;is0r,y0B;!c;a,b,e1i0ol,s,t;tro,vo;r,t;niv,safa,t;ce,e0;l,mp,nn,x;ask,e2fc,gt,i1q,r,s,t,u0;pt,rg;r,tu;c,nJp0;!t;b,d,e0;pGs,v;a,d,ennNhd,l,p,r1s0vt;!eud;ef,o0;b,f,n;ct,kla,nt;e0ov;b0e;!r;a4d,essrs,i1lle,me,r7s0t;!tr;n1s0;c,ter;!n;!j,r,sc;at,it,lb,ng,t0;!d;!s;an,d,r,u0;l,n;a,da,e,n0;c,f;on,wy;a,en,ov;e1ig,l0m,r,t,y;!a;b,m;a,g,ng,s1tc,x0;!p;p,q,t;ak,e0ist,r;c,f,pt,t;a3ca,l,m2o0pl,res,yn;!l0m1nn,rp;!o;dr;!l0pt;!if;a,c,l1r0;ig,os;!dg,vd;d4l3p2r1ss0tty,ug,ve;n,t;c,iz;prox,r,t;!ta;!j,m,v",Pronoun:"true\xA6'em,elle,h4i3me,ourselves,she5th1us,we,you0;!rself;e0ou;m,y;!l,t;e0im;!'s",Singular:"true\xA60:16;1:13;2:19;a16b0Tc0Kd0De0Af05g00hWiVjel0kitty,lTmPnOoNpHquestionGrEs9t6u4w3;ay,om03;nc10s 3;doll0Lst0N; rex,a4h3ic,ragedy,v show;ere,i2;l0x return;i6ky,omeoNt3uper bowl,yst15;ep4ri2u3;de0Yff;faTmoT;st1ze;al0i2o3;om,se;! mark;a7i1la6r4u3;dQrpoI;e3ie0Hobl0V;roga00ss releaG;te,y1;rt,te0N;bjWceJthers,verview;othi2umb1;a5ee08o3;del,m3nopo0rni2th1;!my;n,yf0;i3unch;ne;ci2nsect;ead start,o3uman right;l0me4u3;se;! run;adf0entlem6irl02laci1od,rand4u3;l0y; slam,fa3mo3;th1;an;a6ella,ly,ol0r4un3;di2;ee market,iWo3;nti1sP;mi0th1;conomy,gg,ner7ven4x3;ampTecu9;i2t;ad8e5inn1o3ragonf0ude;cumentGg3i0l0or;gy;ath,t3;ec3;tive;!dy;a9eili2h7i5o3redit card;ttage,u3;ri1sin;ty,vil w3;ar;andeli1ocol3;ate;n3rF;ary;aCel0lesJo8r5u3;n3tterf0;ti2;eakfa4o3;!th1;st;dy,tt5y3;!fri3;end;le;nki2r3;ri1;er;d5l0noma0u3;nt;ly; homin5verti3;si2;ng;em",FemaleName:"true\xA60:J3;1:J7;2:IG;3:IF;4:IX;5:IK;6:JO;7:H0;8:JG;9:JK;A:HN;B:HY;C:IT;D:IP;E:JD;F:HC;G:I0;aGRbFLcDPdCYeBOfB4gADh9Ti9Gj8Gk7Gl60m49n3No3Jp37qu36r2Ds16t0Eu0Cv02wVxiTyOzH;aLeIineb,oHsof2;e3Uf2la,ra;h3iKlIna,ynH;ab,ep;da,ma;da,h3iHra;nab;aKeJi0Fol5BuIvH;etAonDO;i0na;le0sen2;el,gm3Jn,rGJs8W;aoHme0nyi;m62yAE;aMendDYhiDFiH;dele8lJnH;if48niHo0;e,f47;a,helmi0lHma;a,ow;ka0nB;aNeKiHusa5;cIktoriBMlAole7viH;anC3enJ0;kF9tor2;da,lA9nus,rHs0;a,nHoniH4;a,iFQ;leHnesH4;nIHrH;i1y;g8rHxH5;su5te;aYeUhRiNoLrIuHy3;i,la;acIZiHu0L;c2na,sH;hBPta;nHr0H;iBNya;aJffaEOnHs6;a,gtiH;ng;!nFQra;aIeHomasi0;a,l9Po8Ares1;l2ndolwethu;g9Go88rIssH;!a,ie;eHi,ri9;sa,za;bPlNmLnJrIs6tHwa0;ia0um;a63yn;iHya;a,ka,s6;arB6e3iHmEDra;!ka;a,iH;a,t6;at6it6;a0Fcarlet3We0BhXiTkye,neza0oRtNuIyH;bIBlvi1;e,ha,mayIEni7sIzH;an3MetAie,y;anHi9;!a,e,nH;aDe;aJeH;fHl5GphH;an4;cHZr5;b2fiA8m0OnHphi1;d3ia,ja,ya;er3lJmon1nIobh8PtH;a,i;dy;lEPv2;aMeIirHo0risF7y5;a,lDK;ba,e0i5lJrH;iHrDOyl;!d8Hfa;ia,lDX;hd,iMki3nJrIu0w0yH;la,ma,na;i,le8on,ron;aIda,ia,nHon;a,on;!ya;k6mH;!aa;lJrItaye81vH;da,inj;e0ife;en1i0ma;anA5bNd3Nh1RiBkMlLmJndIrHs6vannaD;aDi0;ra,y;aHi3;nt6ra;lDKma,ome;ee0in8Ru3;in1ri0;a05e00hYiVoIuH;by,thDH;bScRghQl2KnPsJwIxH;anAXie,y;an,e0;aIeHie,lE; merBLann9ll1marDBt7;!lHnn1;iHyn;e,nH;a,d9K;da,i,na;ayy8D;hel62io;bDKer7yn;a,cIkHmas,n9Fta,ya;ki,o;helGki;ea,iannGDoH;da,n1K;an0bJem9Agi0iInHta,y0;a88ee;han83na;a,eH;cEAkaD;bi0chIe,i0mo0nHquEKvCy0;di,ia;aEIelHiB;!e,le;een4ia0;aNeMhKipaluk,oJrHute66;iHudenCQ;scil3LyamvaB;lly,rt2;ilome0oebe,ylH;is,lis;arl,ggy,nelope,r5t3;ige,m0TnKo5rvaDGtIulH;a,etAin1;ricHsy,tBY;a,e,ia;do3i06;ctav2dIfCZis6lHphCZumC3yunbileg;a,ga,iv2;eHvAC;l2tA;aWeUiMoIurHy5;!ay,ul;a,eJor,rIuH;f,r;aDeCma;ll1mi;aNcLhariBOkKlaJna,sHta,vi;anHha;ur;!y;a,iDTki;hoGk9VolH;a,eDJ;!mh;hir,lHna,risFsreC;!a,lBT;asuLdKh2i6CnJomi9rgEPtHzanin zah3;aHhal4;li1s6;cy,etA;a,e8iEV;nngu30;a09ckenz4e01iMoJrignayani,uriDDyH;a,rH;a,lNna,tG;bi0i3llBInH;a,iH;ca,ka,qD3;a,cTkaSlNmi,nLrItzi,yH;ar;aIiam,lH;anEO;!l,nB;dy,eHh,n4;nhGrva;aKdJiCPlH;iHy;cent,e;red;!gros;!e5;ae5hH;ae5el3Z;ag5EgNi,lKrH;edi79iIjem,on,yH;em,l;em,sF;an4iHliF;nHsCE;a,da;!an,han;b0DcASd0Be,g09ha,i08ja,l06n04rLsoum60tKuIv82x9IyHz4;a,bell,ra,soB9;de,rH;a,eC;h8Fild1t4;a,cYgUiKjor4l7Sn4s6tJwa,yH;!aHbe6Wja8lAE;m,nBH;a,ha,in1;!aJbCBeIja,lEna,sHt64;!a,ol,sa;!l1H;! Jh,mInH;!a,e,n1;!awit,i;aliAHcJeduarBfernIjHlui5Y;o6Ful2;anB;ecil2la3;arJeIie,oHr44ueriA;!t;!ry;et42i37;el4Ui76y;dHon,ue5;akran7y;ak,en,iHk,lo3O;a,ka,nB;a,re,s4te;daHg4;!l3A;alEd4elHge,isDBon0;ei8in1yn;el,le;a0Ne0CiYoQuLyH;d2la,nH;!a,dIeBGnHsCL;!a,eBF;a,sCJ;aCWcJel0PiFlIna,pHz;e,i7;a,u,wa;iHy;a0Se,ja,l2JnB;is,l1SrJttIuHvel4;el5is1;e,ie;aKeIi9na,rH;a86i9;lHn1t7;ei;!in1;aSbb9CdRepa,lMnJsIv2zH;!a,be5LetAz4;a,etA;!a,dH;a,sHy;ay,ey,i,y;a,iJja,lHy;iHy;aA0e;!aH;!n5F;ia,ya;!nH;!a,ne;aPda,e0iNjYla,nMoKsJtHx4y5;iHt4;c2t2;e2LlCG;la,nHra;a,ie,o3;a,or1;a,gh,laH;!ni;!h,nH;a,d3e,n5P;cOdon97iNkes6mi9Ana,rMtJurIvHxmi,y5;ern1in2;a,e54ie,yn;as6iIoH;nya,ya;fa,s6;a,isF;a,la;ey,ie,y;a04eZhXiOlAKoNrJyH;lHra;a,ee,ie;istHy6D;a,en,iIyH;!na;!e,n59;nul,ri,urtnB0;aOerNlAZmJrHzzy;a,stH;en,in;!berlImernH;aq;eHi,y;e,y;a,stC;!na,ra;aHei3ongordzol;dij1w5;el7QiKjsi,lJnIrH;a,i,ri;d3na,za;ey,i,lBDs4y;ra,s6;bi7cAJdiat7IeB2iRlQmPnyakuma19rNss6KtKvi7yH;!e,lH;a,eH;e,i8L;a6DeIhHi4NlEri0y;ar6Ber6Bie,leCrB2y;!lyn8Gri0;a,en,iHl5Soli0yn;!ma,n3VsF;a5il1;ei8Ei,l4;a,tl6L;a07eYiVoNuH;anLdKliHst63;a8HeHsF;!n8tH;!a,te;e5Ji3Jy;a,i7;!anNcelEd6RelGhan7RlLni,sIva0yH;a,ce;eHie;fHlEph5U;a,in1;eHie;en,n1;!a,e,n41;lHng;!i1ClH;!i1B;anMle0nJrIsH;i8Csi8C;i,ri;!a,elGif2CnH;a,etAiHy;!e,f2A;a,e8EiInH;a,e8DiH;e,n1;cMd1mi,nIque4Xsmin3Ovie3y8zH;min9;a9eIiH;ce,e,n1s;!lHsFt0F;e,le;inIk4lEquelH;in1yn;da,ta;lRmPnOo0rNsIvaHzaro;!a0lu,na;aJiIlaHob84;!n9N;do3;!belHdo3;!a,e,l39;a77en1i0ma;a,di3es,gr6Yji;a8elBogH;en1;a,e8iHo0se;a0na;aSeOiJoHusFyacin2B;da,ll4rten23snH;a,i9Q;lImaH;ri;aIdHlaI;a,egard;ry;ath1CiJlInriet7rmi8sH;sa,t1B;en2Sga,mi;di;bi2Dil8IlNnMrJsItHwa,yl8Iz7H;i5St4;n5Yti;iHmo51ri52;etH;!te;aDnaD;a,ey,l4;a03eXiSlQoOrKunJwH;enHyne1Q;!dolE;ay,el;acIetHiselB;a,chC;e,ieH;!la;ld1AogooH;sh;adys,enHor2yn2H;a,da,na;aKgi,lIna,ov89selHta;a,e,le;da,liH;an;!n0;mLnJorgIrH;ald3Pi,m3Ctru8B;etAi4W;a,eHna;s26vieve;ma;bIil,le,mHrnet,yG;al5Ni5;i5FrielH;a,l1;aVeSiRloOoz2rH;anJeIiH;da,eB;da,ja;!cH;esIiHoi0O;n1s61;!ca;!rH;a,encH;e,ia;en,o0;lIn0rnH;!anB;ec2ic2;jr,n7rKtHy9;emIiHma,ouma7;ha,ma,n;eh;ah,iBrah,za0;cr4Nd0Ne0Mi0Lk7l04mWn4YrTsNtMuLvH;aJelIiH;!e,ta;in0Gyn;!ngel2S;geni1la,ni45;h5Sta;mLperanKtH;eIhHrel5;er;l30r9;za;a,eralB;iHma,nest2Jyn;cHka,n;a,ka;a,eMiJmH;aHie,y;!li8;lHn1;ee,iHy;a,e,ja;lHrald;da,y;aWeUiNlMma,no3oKsJvH;a,iH;na,ra;a,ie;iHuiH;se;a,en,ie,y;a0c2da,f,nMsJzaH;!betHve7;e,h;aHe,ka;!beH;th;!a,or;anor,nH;!a;!in1na;leCs6;vi;eIiHna,wi0;e,th;l,n;aYeMh2iLjeneKoHul30;lor5Tminiq4In3FrHtt4;a,eCis,la,othHthy;ea,y;ba;an0AnaDon8x4ya;anQbPde,eOiMja,lJmetr2nHsir5K;a,iH;ce,se;a,iIla,orHphi8;es,is;a,l6D;dHrdH;re;!d5Cna;!b2HoraDra;a,d3nH;!a,e;hl2i0l0HmNnLphn1rIvi1XyH;le,na;a,by,cIia,lH;a,en1;ey,ie;a,etAiH;!ca,el1Cka,z;arHia;is;a0Se0Oh05i03lVoKrIynH;di,th2;istHy05;al,i0;lPnMrIurH;tn1E;aJd2NiHn2Nri8;!nH;a,e,n1;!l1X;cepci59n4sH;tanHuelo;ce,za;eHleC;en,tA;aJeoIotH;il51;!pat3;ir9rJudH;etAiH;a,ne;a,e,iH;ce,sZ;a3er3ndH;i,y;aReNloe,rH;isJyH;stH;al;sy,tH;a1Ren,iHy;!an1e,n1;deJlseIrH;!i9yl;a,y;li8;nMrH;isKlImH;ai8;a,eHotA;n1tA;!sa;d3elGtH;al,elG;cIlH;esAi44;el2ilH;e,ia,y;itlZlYmilXndWrOsMtHy5;aKeJhHri0;erHleCrEy;in1;ri0;li0ri0;a33sH;a32ie;a,iNlLmeJolIrH;ie,ol;!e,in1yn;lHn;!a,la;a,eHie,o7y;ne,y;na,sF;a0Hi0H;a,e,l1;is7l4;in,yn;a0Ie02iZlXoUrH;andSeQiJoIyH;an0nn;nwEok9;an3DdgLg0XtH;n2XtH;!aInH;ey,i,y;ny;etH;!t9;an0e,nH;da,na;i9y;bbi9glarIlo05nH;i7n4;ka;ancHossom,ythe;a,he;an17lja0nHsm3I;i7tH;ou;aUcky,linTni7rPssOtJulaDvH;!erlH;ey,y;hJsy,tH;e,iHy9;e,na;!anH;ie,y;!ie;nHt6yl;adIiH;ce;etAi8;ay,da;!triH;ce,z;rbJyaH;rmH;aa;a3ie,o3ra;a2Sb2Md23g1Zi1Qj5l16m0Xn09oi,r04sUtTuPvOwa,yIzH;ra,u0;aKes6gJlIseH;!l;in;un;!nH;a,na;a,i2Ir2J;drJgus1RrIsteH;ja;el2;a,ey,i,y;aahua,he0;hIi2Gja,mi7s2DtrH;id;aMlIraqHt21;at;eIi9yH;!n;e,iHy;gh;!nH;ti;iJleIo6pi7;ta;en,n1tA;aHelG;!n1J;a00dje5eYgUiSjQnJohito,toHya;inetAnH;el5ia;!aKeIiHmJ;e,ka;!mHtA;ar4;!belIliFmU;sa;!le;a,eliH;ca;ka,sHta;a,sa;elHie;a,iH;a,ca,n1qH;ue;!tA;te;! JbImHstasiNya;ar2;el;cla3jul2pau5;aLberKeliJiHy;e,l2naH;!ta;a,ja;!ly;hGiIl2nB;da;a,ra;le;aWba,ePiMlKma,thJyH;a,c2sH;a,on,sa;ea;iHys0N;e,s0M;a,cIn1sHza;a,e,ha,on,sa;e,ia,ja;c2is6jaKksaKna,sJxH;aHia;!nd3;ia,saH;nd3;ra;ia;i0nIyH;ah,na;a,is,naDoud;la;c6da,leCmNnLsH;haDlH;inHyY;g,n;!h;a,o,slH;ey;ee;en;at6g4nIusH;ti0;es;ie;aWdiTelMrH;eJiH;anMenH;a,e,ne;an0;na;!aLeKiIyH;nn;a,n1;a,e;!ne;!iH;de;e,lEsH;on;yn;!lH;i8yn;ne;aKbIiHrL;!gaK;ey,i9y;!e;gaH;il;dKliyJradhIs6;ha;ya;ah;a,ya",Actor:"true\xA6aJbGcFdCengineIfAgardenIh9instructPjournalLlawyIm8nurse,opeOp5r3s1t0;echnCherapK;ailNcientJecretary,oldiGu0;pervKrgeon;e0oofE;ceptionGsearC;hotographClumbColi1r0sychologF;actitionBogrammB;cem6t5;echanic,inist9us4;airdress8ousekeep8;arm7ire0;fight6m2;eputy,iet0;ici0;an;arpent2lerk;ricklay1ut0;ch0;er;ccoun6d2ge7r0ssis6ttenda7;chitect,t0;ist;minist1v0;is1;rat0;or;ta0;nt",Honorific:"true\xA6a01bYcQdPeOfiJgIhon,jr,king,lHmCoffic00p7queen,r3s0taoiseach,vice6;e1fc,gt,ir,r,u0;ltRpt,rg;cond liInBrgeaJ;abbi,e0;ar1p9s,v0;!erend; admirX;astOhd,r0vt;esideDi1of0;!essM;me mini4nce0;!ss;a3essrs,i2lle,me,r1s0;!tr;!s;stK;gistrate,j,r6yF;i3lb,t;en,ov;eld mar3rst l0;ady,i0;eutena0;nt;shG;sq,xcellency;et,oct6r,utchess;apt6hance4mdr,o0pl;lonel,m2ngress0unci3;m0wom0;an;dr,mand5;ll0;or;!ain;ldg,rig0;!adi0;er;d0sst,tty,yatullah;j,m0v;!ir0;al",SportsTeam:"true\xA60:1A;1:1H;2:1G;a1Eb16c0Td0Kfc dallas,g0Ihouston 0Hindiana0Gjacksonville jagua0k0El0Bm01newToQpJqueens parkIreal salt lake,sAt5utah jazz,vancouver whitecaps,w3yW;ashington 3est ham0Rh10;natio1Oredski2wizar0W;ampa bay 6e5o3;ronto 3ttenham hotspur;blue ja0Mrapto0;nnessee tita2xasC;buccanee0ra0K;a7eattle 5heffield0Kporting kansas0Wt3;. louis 3oke0V;c1Frams;marine0s3;eah15ounG;cramento Rn 3;antonio spu0diego 3francisco gJjose earthquak1;char08paA; ran07;a8h5ittsburgh 4ortland t3;imbe0rail blaze0;pirat1steele0;il3oenix su2;adelphia 3li1;eagl1philNunE;dr1;akland 3klahoma city thunder,rlando magic;athle0Mrai3;de0; 3castle01;england 7orleans 6york 3;city fc,g4je0FknXme0Fred bul0Yy3;anke1;ian0D;pelica2sain0C;patrio0Brevolut3;ion;anchester Be9i3ontreal impact;ami 7lwaukee b6nnesota 3;t4u0Fvi3;kings;imberwolv1wi2;rewe0uc0K;dolphi2heat,marli2;mphis grizz3ts;li1;cXu08;a4eicesterVos angeles 3;clippe0dodDla9; galaxy,ke0;ansas city 3nE;chiefs,roya0E; pace0polis colU;astr06dynamo,rockeTtexa2;olden state warrio0reen bay pac3;ke0;.c.Aallas 7e3i05od5;nver 5troit 3;lio2pisto2ti3;ge0;broncZnuggeM;cowbo4maver3;ic00;ys; uQ;arCelKh8incinnati 6leveland 5ol3;orado r3umbus crew sc;api5ocki1;brow2cavalie0india2;bengaWre3;ds;arlotte horAicago 3;b4cubs,fire,wh3;iteB;ea0ulR;diff3olina panthe0; c3;ity;altimore 9lackburn rove0oston 5rooklyn 3uffalo bilN;ne3;ts;cel4red3; sox;tics;rs;oriol1rave2;rizona Ast8tlanta 3;brav1falco2h4u3;nited;aw9;ns;es;on villa,r3;os;c5di3;amondbac3;ks;ardi3;na3;ls",Uncountable:"true\xA60:1J;a1Qb1Ic19d16e0Zf0Tg0Mh0Hi0Dj0Cknowled1Pl07mXnWoVpRrMsBt6vi5w1;a3ea0Ai2oo1;d,l;ldlife,ne;rmth,t0;neg16ol0Btae;e4h3oothpaste,r1una;affSou1;ble,sers,t;ermod1Lund0;a,nnis;a9cene09eri0Wh8il7kittl0Wnow,o6p4t2u1;g0Znshi0P;ati1Ke1;am,el;ace1De1;ci0Red;ap,cc0;k,v0;eep,ingl0O;d0Cfe17l1nd,tish;m10t;a4e2ic1;e,ke0L;c1laxa0Hsearch;ogni0Grea0G;bi0Hin;aOe3hys17last8o1ress03;l1rk,w0;it15y9;a11trY;bstetr13il,xygen;ational securi0Vews;a8e6ilk,o3u1;mps,s1;ic;n1o0G;ey,o1;gamy;a1chan0V;sl03t;chine1il,themat0T; learn09ry;aught0e3i2ogi0Qu1;ck,g0G;ce,ghtn06ngui0OteratL;a1isK;th0;ewel8usti0J;ce,mp1nformaStself;a1ortan0H;ti1;en0F;a4isto3o1;ck1mework,n1spitali09;ey;ry;ir,libut,ppiB;ene4o2r1um,ymna0B;aAound;l1ssip;d,f; 1t08;editOpo1;ol;i5lour,o2urnit1;ure;od,rgive1uri0wl;ne1;ss;c7sh;conomZduca6lectr5n3quip4thZvery1;body,o1thF;ne;joy1tertain1;ment;iciNonU;tiG;ar2iabet1raugh2;es;ts;a8elcius,h4ivPl3o1urrency;al,ld w1nfusiBttB;ar;assMoth3;aos,e1;e2w1;ing;se;r5sh;a5eef,i2lood,owls,read,utt0;er;lliar2s1;on;ds;g1ss;ga1;ge;c6dvi5ero3ir2mnes1rt,thlet8;ty;craft;b5d1naut5;ynam4;ce;id,ou1;st1;ics",Infinitive:"true\xA60:6S;1:76;2:5C;3:74;4:73;5:67;6:6F;7:6Y;8:6Q;9:72;A:70;B:5X;C:6X;D:6L;E:77;F:5B;a6Kb66c57d4De3Xf3Jg3Dh37i2Uj2Sk2Ql2Hm26n23o1Yp1Jr0Rs06tYuTvOwHyG;awn,e31ield;aJe1Zhist6iIoGre6D;nd0rG;k,ry;pe,sh,th0;lk,nHrGsh,tDve;n,raE;d0t;aJiHoG;te,w;eGsC;!w;l6Jry;nHpGr4se;gra4Pli41;dGi9lo5Zpub3Q;erGo;mi5Cw1I;aMeLhKig5SoJrHuGwi7;ne,rn;aGe0Mi5Uu7y;de,in,nsf0p,v5J;r2ZuD;ank,reatB;nd,st;ke pa53lk,rg1Qs9;aZcWeVhTi4Dkip,lSmRnee3Lo52pQtJuGwitD;bmCck,ff0gge7ppHrGspe5;ge,pri1rou4Zvi3;ly,o36;aLeKoJrHuG;dy,mb6;aFeGi3;ngthBss,tD;p,re;m,p;in,ke,r0Qy;la58oil,rink6;e1Zi6o3J;am,ip;a2iv0oG;ck,rtBut;arDem,le5n1r3tt6;aHo2rG;atDew;le,re;il,ve;a05eIisk,oHuG;in,le,sh;am,ll;a01cZdu8fYgXje5lUmTnt,pQquPsKtJvGwa5V;eGiew,o36;al,l,rG;se,t;aFi2u44;eJi7oItG;!o2rG;i5uc20;l3rt;mb6nt,r3;e7i2;air,eHlGo43r0K;a8y;at;aFemb0i3Zo3;aHeGi3y;a1nt;te,x;a5Dr0J;act1Yer,le5u1;a13ei3k5PoGyc6;gni2Cnci6rd;ch,li2Bs5N;i1nG;ge,k;aTerSiRlOoMrIuG;b21ll,mp,rGsh;cha1s4Q;ai1eIiEoG;cGdu8greAhibCmi1te7vi2W;eAlaim;di5pa2ss,veE;iEp,rtr46sGur;e,t;aHead,uG;g,n4;n,y;ck,le;fo34mCsi7;ck,iErt4Mss,u1;bJccur,ff0pera9utweIverGwe;co47lap,ta22u1wG;helm;igh;ser3taF;eHotG;e,i8;ed,gle5;aMeLiIoHuG;ltip3Grd0;nit13ve;nHrr12sreprG;eseE;d,g6us;asu2lt,n0Nr4;intaFna4rHtG;ch,t0;ch,kGry;et;aMeLiJoGu1C;aHck,oGve;k,sB;d,n;ft,g35ke,mCnk,st2YveG;!n;a2Fc0Et;b0Nck,uG;gh,nD;iGno34;ck,ll,ss;am,oFuG;d4mp;gno2mQnGss3H;cOdica9flu0MhNsKtIvG;eGol3;nt,st;erGrodu8;a5fe2;i7tG;aGru5;ll;abCibC;lu1Fr1D;agi24pG;lemeEo22ro3;aKeIi2oHuG;nt,rry;n02pe,st;aGlp;d,t;nd6ppBrm,te;aKloAove1PrIuG;arGeAi15;ant39d;aGip,ow,umb6;b,sp;in,th0ze;aReaQiOlMoJrHuncG;ti3J;acGeshB;tu2;cus,lHrG;ce,eca7m,s30;d,l24;a1ZoG;at,od,w;gu2lGni1Xt,x;e,l;r,tu2;il,stBvG;or;a15cho,le5mSnPstNvalua9xG;a0AcLerKi7pGte19;a18eHi2laFoGreA;rt,se;ct,riG;en8;ci1t;el,han4;abGima9;li1J;ab6couXdHfor8ga4han8j03riDsu2t0vG;isi2Vy;!u2;body,er4pG;hasiGow0;ze;a07eUiLoKrHuG;mp;aHeAiG;ft;g,in;d4ubt;ff0p,re5sHvG;iZor8;aKcHliGmiApl1Btingui14;ke;oGuA;uGv0;ra4;gr1YppG;ear,ro3;cOeNfLliv0ma0Fny,pKsHterG;mi0G;cribe,er3iHtrG;oy;gn,re;a0Be0Ai5osC;eGi0By;at,ct;m,pB;iIlHrG;ea1;a2i06;de;ma4n8rGte;e,kB;a0Ae09h06i9l04oJrG;aHeGoAu0Hy;a9dC;ck,ve;llZmSnHok,py,uGv0;gh,nt;cePdu5fMsKtIvG;eGin8;rt,y;aFin0VrG;a7ibu9ol;iGtitu9;d0st;iHoGroE;rm;gu2rm;rn;biLfoKmaJpG;a2laF;in;re;nd;rt;ne;ap1e5;aGip,o1;im,w;aHeG;at,ck,w;llen4n4r4se;a1nt0;ll,ncIrGt0u1;eGry;!en;el;aSePloOoMrIuG;lGry;ly;igHuG;sh;htB;en;a7mb,o7rrGth0un8;ow;ck;ar,lHnefCtrG;ay;ie3ong;ng,se;band0Jc0Bd06ffo05gr04id,l01mu1nYppTrQsKttGvoid,waC;acIeHra5;ct;m0Fnd;h,k;k,sG;eIiHocia9uG;me;gn,st;mb6rt;le;chHgGri3;ue;!i3;eaJlIroG;aDve;ch;aud,y;l,r;noun8sw0tG;icipa9;ce;lHt0;er;e4ow;ee;rd;aRdIju7mCoR;it;st;!reA;ss;cJhie3knowled4tiva9;te;ge;ve;eIouEu1;se;nt;pt;on",Unit:"true\xA60:19;a14b12c0Od0Ne0Lf0Gg0Ch09in0Hjoule0k02l00mNnMoLpIqHsqCt7volts,w6y4z3\xB02\xB51;g,s;c,f,n;b,e2;a0Nb,d0Dears old,o1;tt0H;att0b;able4b3d,e2on1sp;!ne0;a2r0D;!l,sp;spo04; ft,uare 1;c0Id0Hf3i0Fkilo0Jm1ya0E;e0Mil1;e0li0H;eet0o0D;t,uart0;ascals,e2i1ou0Pt;c0Mnt0;rcent,t02;hms,uYz;an0JewtT;/s,b,e9g,i3l,m2p1\xB2,\xB3;h,s;!\xB2;!/h,cro5l1;e1li08;! pFs1\xB2;! 1;anEpD;g06s0B;gQter1;! 2s1;! 1;per second;b,i00m,u1x;men0x0;b,elvin0g,ilo2m1nR;!/h,ph,\xB2;byZgXmeter1;! p2s1;! p1;er1; hour;e1g,r0z;ct1rtz0;aXogQ;al2b,igAra1;in0m0;!l1;on0;a4emtPl2t1;\xB2,\xB3; oz,uid ou1;nce0;hrenheit0rad0;b,x1;abyH;eciCg,l,mA;arat0eAg,m9oulomb0u1;bic 1p0;c5d4fo3i2meAya1;rd0;nch0;ot0;eci2;enti1;me4;!\xB2,\xB3;lsius0nti1;g2li1me1;ter0;ram0;bl,y1;te0;c4tt1;os1;eco1;nd0;re0;!s",Organization:"true\xA60:46;a3Ab2Qc2Ad21e1Xf1Tg1Lh1Gi1Dj19k17l13m0Sn0Go0Dp07qu06rZsStFuBv8w3y1;amaha,m0Xou1w0X;gov,tu2S;a3e1orld trade organizati41;lls fargo,st1;fie22inghou16;l1rner br3D;-m11gree31l street journ25m11;an halNeriz3Wisa,o1;dafo2Gl1;kswagLvo;bs,kip,n2ps,s1;a tod2Rps;es35i1;lev2Xted natio2Uv; mobi2Kaco bePd bMeAgi frida9h3im horto2Tmz,o1witt2W;shiba,y1;ota,s r Y;e 1in lizzy;b3carpen33daily ma2Xguess w2holli0rolling st1Ms1w2;mashing pumpki2Ouprem0;ho;ea1lack eyed pe3Fyrds;ch bo1tl0;ys;l2s1;co,la m12;efoni07us;a6e4ieme2Gnp,o2pice gir5ta1ubaru;rbucks,to2N;ny,undgard1;en;a2Rx pisto1;ls;few25insbu26msu1X;.e.m.,adiohead,b6e3oyal 1yan2X;b1dutch she4;ank;/max,aders dige1Ed 1vl32;bu1c1Uhot chili peppe2Klobst28;ll;c,s;ant2Vizno2F;an5bs,e3fiz24hilip morrBi2r1;emier27octer & gamb1Rudenti14;nk floyd,zza hut;psi28tro1uge08;br2Qchina,n2Q; 2ason1Xda2G;ld navy,pec,range juli2xf1;am;us;a9b8e5fl,h4i3o1sa,wa;kia,tre dame,vart1;is;ke,ntendo,ss0K;l,s;c,st1Etflix,w1; 1sweek;kids on the block,york08;a,c;nd1Us2t1;ional aca2Fo,we0Q;a,cYd0O;aAcdonald9e5i3lb,o1tv,yspace;b1Nnsanto,ody blu0t1;ley crue,or0O;crosoft,t1;as,subisO;dica3rcedes2talli1;ca;!-benz;id,re;'s,s;c's milk,tt13z1Y;'ore09a3e1g,ittle caesa1Ktd;novo,x1;is,mark; pres5-z-boy,bour party;atv,fc,kk,m1od1K;art;iffy lu0Lo3pmorgan1sa;! cha1;se;hnson & johns1Sy d1R;bm,hop,n1tv;c,g,te1;l,rpol; & m,asbro,ewlett-packaTi3o1sbc,yundai;me dep1n1J;ot;tac1zbollah;hi;eneral 6hq,l5mb,o2reen d0Iu1;cci,ns n ros0;ldman sachs,o1;dye1g0B;ar;axo smith kliZencore;electr0Im1;oto0V;a3bi,da,edex,i1leetwood mac,oGrito-l0A;at,nancial1restoV; tim0;cebook,nnie mae;b06sa,u3xxon1; m1m1;ob0H;!rosceptics;aiml0Ae5isney,o3u1;nkin donuts,po0Wran dur1;an;j,w j1;on0;a,f leppa3ll,p2r spiegZstiny's chi1;ld;eche mode,t;rd;aEbc,hBi9nn,o3r1;aigsli5eedence clearwater reviv1ossra05;al;!ca c5l4m1o0Ast05;ca2p1;aq;st;dplMgate;ola;a,sco1tigroup;! systems;ev2i1;ck fil-a,na daily;r0Hy;dbury,pital o1rl's jr;ne;aGbc,eCfAl6mw,ni,o2p,r1;exiteeWos;ei3mbardiJston 1;glo1pizza;be;ng;ack & deckFo2ue c1;roX;ckbuster video,omingda1;le; g1g1;oodriN;cht3e ge0n & jer2rkshire hathaw1;ay;ryH;el;nana republ3s1xt5y5;f,kin robbi1;ns;ic;bXcSdidRerosmith,ig,lLmFnheuser-busEol,ppleAr7s3t&t,v2y1;er;is,on;hland2s1;n,ociated F; o1;il;by4g2m1;co;os; compu2bee1;'s;te1;rs;ch;c,d,erican3t1;!r1;ak; ex1;pre1;ss; 4catel2t1;air;!-luce1;nt;jazeera,qae1;da;as;/dc,a3er,t1;ivisi1;on;demy of scienc0;es;ba,c",Demonym:"true\xA60:16;1:13;a0Wb0Nc0Cd0Ae09f07g04h02iYjVkTlPmLnIomHpDqatari,rBs7t5u4v3wel0Rz2;am0Fimbabwe0;enezuel0ietnam0H;g9krai1;aiwThai,rinida0Iu2;ni0Qrkmen;a4cot0Ke3ingapoOlovak,oma0Tpa05udRw2y0X;edi0Kiss;negal0Br08;mo0uU;o6us0Lw2;and0;a3eru0Hhilipp0Po2;li0Ertugu06;kist3lesti1na2raguay0;ma1;ani;amiZi2orweP;caragu0geri2;an,en;a3ex0Mo2;ngo0Erocc0;cedo1la2;gasy,y08;a4eb9i2;b2thua1;e0Dy0;o,t02;azakh,eny0o2uwaiti;re0;a2orda1;ma0Bp2;anN;celandic,nd4r2sraeli,ta02vo06;a2iT;ni0qi;i0oneV;aiDin2ondur0unN;di;amDe2hanai0reek,uatemal0;or2rm0;gi0;i2ren7;lipino,n4;cuadoVgyp6ngliJsto1thiopi0urope0;a2ominXut4;niH;a9h6o4roa3ub0ze2;ch;ti0;lom2ngol5;bi0;a6i2;le0n2;ese;lifor1m2na3;bo2eroo1;di0;angladeshi,el8o6r3ul2;gaG;aziBi2;ti2;sh;li2s1;vi0;aru2gi0;si0;fAl7merBngol0r5si0us2;sie,tr2;a2i0;li0;gent2me1;ine;ba1ge2;ri0;ni0;gh0r2;ic0;an",Possessive:"true\xA6anyAh5its,m3noCo1sometBthe0yo1;ir1mselves;ur0;!s;i8y0;!se4;er1i0;mse2s;!s0;!e0;lf;o1t0;hing;ne",Currency:"true\xA6$,aud,bScQdLeurKfJgbp,hkd,iIjpy,kGlEp8r7s3usd,x2y1z0\xA2,\xA3,\xA5,\u0434\u0435\u043D,\u043B\u0432,\u0440\u0443\u0431,\u0E3F,\u20A1,\u20A8,\u20AC,\u20AD,\uFDFC;lotyS\u0142;en,uanR;af,of;h0t5;e0il5;k0q0;elM;iel,oubleLp,upeeL;e2ound st0;er0;lingI;n0soH;ceGn0;ies,y;e0i8;i,mpi7;n,r0wanzaCyatC;!onaBw;ls,nr;ori7ranc9;!o8;en3i2kk,o0;b0ll2;ra5;me4n0rham4;ar3;ad,e0ny;nt1;aht,itcoin0;!s",City:"true\xA60:73;1:61;2:6G;3:5U;4:5R;a68b54c4Id4Ae46f3Yg3Jh38i2Zj2Uk2Dl22m1Kn19o16p0Uq0Sr0Ls01tPuOvLwDxiBy9z5;a7h5i4Muri4O;a5e5ongsh0;ng3J;greb,nzib5G;ang2e5okoha3Uunfu;katerin3Jrev0;a5n0O;m5Hn;arsBeAi6roclBu5;h0xi,zh5P;c7n5;d5nipeg,terth4;hoek,s1K;hi5Zkl3C;l63xford;aw;a6ern2i5ladivost5Molgogr6K;en3lni6R;lenc6Dncouv2Yr3ughn;lan bat1Drumqi,trecht;aDbilisi,eCheBi9o8r7u5;l21n63r5;in,ku;ipoli,ondh62;kyo,m34ron1QulouS;an5jua3l2Zmisoa6Era3;j4Xshui; hag65ssaloni2L;gucigal28hr0l av1W;briz,i6llinn,mpe5Ang5rtu,shk2X;i2Msh0;an,chu1n0p2Iyu0;aEeDh8kopje,owe1It7u5ydney;ra5zh51;ba0Jt;aten is59ockholm,rasbou6Auttga31;an8e6i5;jiazhua1llo1m60y0;f54n5;ya1zh4L;gh3Ot4U;att4Ao1Yv49;cramen18int DlBn5o paulo,ppo3Wrajevo; 7aa,t5;a 5ia3Io domin3I;a3fe,m1O;antonCdie3Gfrancisco,j5ped3Ssalv8;o5u0;se;em,v5z2B;ad0I;lou59peters29;aAe9i7o5;me,sar5t5A;io;ga,o5yadh;! de janei3I;cife,ykjavik;b4Uip4lei2Mnc2Swalpindi;ingdao,u5;ez2i0Q;aEeDhCiBo8r7u6yong5;ya1;eb5Aya1;ag54etor53;rt5zn0; 5la4Fo;au prin0Nelizabe29sa05;ls3Srae5Ctts2B;iladelph4Ynom pe1Doenix;r26tah tik3I;ler00naji,r4Pt5;na,r36;ak47des0Lm1Rr6s5ttawa;a3Ylo;an,d07;a8ew6i5ovosibir1Oyc;ng2Hs; 5cast39;del27orlea46taip16york;g8iro4Xn5pl2Zshv36v0;ch6ji1t5;es,o1;a1o1;a6o5p4;ya;no,sa0Y;aFeCi9o6u5;mb2Cni28sc40;gadishu,nt6s5;c17ul;evideo,re31;ami,l6n18s5;kolc,sissauga;an,waukee;cca,d5lbour2Pmph41;an,ell5i3;in,\xEDn;cau,drAkass2Tl9n8r5shh4A;aca6ib5rakesh,se2N;or;i1Ty;a4EchEdal12i47;mo;id;aCeiAi8o6u5vRy2;anLckn0Rdhia3;n5s angel28;d2g bea1O;brev2De3Kma5nz,sb2verpo2A;!ss29;c5pzig;est0C; p6g5ho2Yn0Gusan27;os;az,la35;aHharFiClaipeBo9rak0Hu7y5;iv,o5;to;ala lump4n5;mi1sh0;be,hi0Llka2Zpavog4si5wlo2;ce;da;ev,n5rkuk;gSsha5;sa;k5toum;iv;bIdu3llakuric0Tmpa3Gn6ohsiu1ra5un1Lwaguc0T;c0Sj;d5o,p4;ah1Vy;a7e6i5ohannesZ;l1Xn0;dd37rusalem;ip4k5;ar2J;bad0mph1QnBrkutYs8ta01z5\u0307zm7;m6tapala5;pa;ir;fah0l6tanb5;ul;am2Zi2I;che2d5;ianap2Lo21;aBe8o5yder2W; chi mi6ms,nolulu,u5;st2;nh;f6lsin5rakli2;ki;ei;ifa,lifax,m7n5rb1Dva3;gAnov5oi;er;bu2Wilt2;aFdanEenDhCiPlasgBo9raz,u5;a5jr21;dal6ng5yaquil;zh1H;aja2Lupe;ld coa18then5;bu2P;ow;ent;e0Toa;sk;lw7n5za;dhi5gt1C;nag0S;ay;aisal26es,o8r6ukuya5;ma;ankfu5esno;rt;rt5sh0; wor6ale5;za;th;d5indhov0Nl paso;in5mont2;bur5;gh;aAe8ha0Visp4o7resd0Ju5;b5esseldorf,rb0shanbe;ai,l0G;ha,nggu0rtmu11;hradRl5troit;hi;donghHe5k08li0masc1Xr es sala1HugavpiY;gu,je2;aKebu,hAo5raio03uriti1P;lo7n6penhag0Ar5;do1Nk;akLst0V;gVm5;bo;aBen8i6ongqi1ristchur5;ch;ang m7ca5ttago1;go;g6n5;ai;du,zho1;n5ttogr12;digarh,g5;ch8sha,zh06;i9lga8mayenJn6pe town,r5;acCdiff;ber18c5;un;ry;ro;aUeMhJirmingh0ToIr9u5;chareRdapeRenos air7r5s0tu0;g5sa;as;es;a9is6usse5;ls;ba6t5;ol;ne;sil0Mtisla7zzav5;il5;le;va;goZst2;op6ubaneshw5;ar;al;iBl9ng8r5;g6l5n;in;en;aluru,hazi;fa5grade,o horizonte;st;ji1rut;ghd0BkGnAot9r7s6yan n4;ur;el,r07;celo3ranquil09;na;ou;du1g6ja lu5;ka;alo6k5;ok;re;ng;ers5u;field;a04b01cc00ddis abaZgartaYhmedWizawl,lQmNnHqaZrEsBt7uck5;la5;nd;he7l5;an5;ta;ns;h5unci2;dod,gab5;at;li5;ngt2;on;a6chora5kaNtwerp;ge;h7p5;ol5;is;eim;aravati,m0s5;terd5;am; 8buquerq7e5giers,maty;ppo,xandr5;ia;ue;basrah al qadim5mawsil al jadid5;ah;ab5;ad;la;ba;ra;idj0u dha5;bi;an;lbo6rh5;us;rg",Country:"true\xA60:39;1:2M;a2Xb2Ec22d1Ye1Sf1Mg1Ch1Ai14j12k0Zl0Um0Gn05om3DpZqat1KrXsKtCu6v4wal3yemTz2;a25imbabwe;es,lis and futu2Y;a2enezue32ietnam;nuatu,tican city;.5gTkraiZnited 3ruXs2zbeE;a,sr;arab emirat0Kkingdom,states2;! of am2Y;k.,s.2; 28a.;a7haBimor-les0Bo6rinidad4u2;nis0rk2valu;ey,me2Ys and caic1U; and 2-2;toba1K;go,kel0Znga;iw2Wji2nz2S;ki2U;aCcotl1eBi8lov7o5pa2Cri lanka,u4w2yr0;az2ed9itzerl1;il1;d2Rriname;lomon1Wmal0uth 2;afr2JkLsud2P;ak0en0;erra leoEn2;gapo1Xt maart2;en;negKrb0ychellY;int 2moa,n marino,udi arab0;hele25luc0mart20;epublic of ir0Dom2Duss0w2;an26;a3eHhilippinTitcairn1Lo2uerto riM;l1rtugE;ki2Cl3nama,pua new0Ura2;gu6;au,esti2;ne;aAe8i6or2;folk1Hth3w2;ay; k2ern mariana1C;or0N;caragua,ger2ue;!ia;p2ther19w zeal1;al;mib0u2;ru;a6exi5icro0Ao2yanm05;ldova,n2roc4zamb9;a3gol0t2;enegro,serrat;co;c9dagasc00l6r4urit3yot2;te;an0i15;shall0Wtin2;ique;a3div2i,ta;es;wi,ys0;ao,ed01;a5e4i2uxembourg;b2echtenste11thu1F;er0ya;ban0Hsotho;os,tv0;azakh1Ee3iriba03o2uwait,yrgyz1E;rWsovo;eling0Jnya;a2erF;ma15p1B;c6nd5r3s2taly,vory coast;le of m19rael;a2el1;n,q;ia,oI;el1;aiSon2ungary;dur0Mg kong;aAermany,ha0Pibralt9re7u2;a5ern4inea2ya0O;!-biss2;au;sey;deloupe,m,tema0P;e2na0M;ce,nl1;ar;bTmb0;a6i5r2;ance,ench 2;guia0Dpoly2;nes0;ji,nl1;lklandTroeT;ast tim6cu5gypt,l salv5ngl1quatorial3ritr4st2thiop0;on0; guin2;ea;ad2;or;enmark,jibou4ominica3r con2;go;!n B;ti;aAentral african 9h7o4roat0u3yprQzech2; 8ia;ba,racao;c3lo2morPngo-brazzaville,okFsta r03te d'ivoiK;mb0;osD;i2ristmasF;le,na;republic;m2naTpe verde,yman9;bod0ero2;on;aFeChut00o8r4u2;lgar0r2;kina faso,ma,undi;azil,itish 2unei;virgin2; is2;lands;liv0nai4snia and herzegoviGtswaGuvet2; isl1;and;re;l2n7rmuF;ar2gium,ize;us;h3ngladesh,rbad2;os;am3ra2;in;as;fghaFlCmAn5r3ustr2zerbaijH;al0ia;genti2men0uba;na;dorra,g4t2;arct6igua and barbu2;da;o2uil2;la;er2;ica;b2ger0;an0;ia;ni2;st2;an",Region:"true\xA60:2M;1:2S;2:2J;a2Pb2Cc1Yd1Tes1Sf1Qg1Kh1Gi1Bj17k12l0Zm0On07o05pZqWrTsKtFuCv9w5y3zacatec2T;akut0o0Du3;cat2k07;a4est 3isconsin,yomi1L;bengal,vi6;rwick2Ashington3;! dc;er4i3;rgin0;acruz,mont;dmurt0t3;ah,tar3; 2Ka0W;a5e4laxca1Qripu1Wu3;scaDva;langa1nnessee,x2E;bas0Um3smNtar24;aulip2Cil nadu;a8i6o4taf10u3ylh1E;ffYrr03s19;me1Bno1Puth 3;cVdU;ber0c3kkim,naloa;hu2ily;n4skatchew2xo3;ny; luis potosi,ta catari1;a3hode9;j3ngp06;asth2shahi;ingh24u3;e3intana roo;bec,en5reta0Q;ara7e5rince edward3unjab; i3;sl0A;i,nnsylv3rnambu0A;an0;!na;axa0Xdisha,h3klaho1Zntar3reg6ss0Ax0F;io;aIeDo5u3;evo le3nav0V;on;r3tt16va scot0;f8mandy,th3; 3ampton15;c5d4yo3;rk13;ako1M;aroli1;olk;bras1Lva0Bw3; 4foundland3;! and labrador;brunswick,hamp0Wjers3mexiRyork state;ey;galOyarit;a9eghala0Mi5o3;nta1r3;dov0elos;ch5dlanCn4ss3zor11;issippi,ouri;as geraOneso18;ig2oac2;dhy12harasht0Gine,ni4r3ssachusetts;anhao,i el,ylF;p3toba;ur;anca0Ie3incoln0IouisH;e3iR;ds;a5e4h3omi;aka06ul1;ntucky,ra01;bardino,lmyk0ns0Qr3;achay,el0nata0X;alis5har3iangxi;kh3;and;co;daho,llino6n3owa;d4gush3;et0;ia1;is;a5ert4i3un2;dalFm0D;fordZ;mpYrya1waii;ansu,eorg0lou7oa,u3;an4erre3izhou,jarat;ro;ajuato,gdo3;ng;cesterS;lori3uji2;da;sex;ageTe6o4uran3;go;rs3;et;lawaLrbyK;aEeaDh8o3rimea ,umbr0;ahui6l5nnectic4rsi3ventry;ca;ut;i02orado;la;e4hattisgarh,i3uvash0;apQhuahua;chn4rke3;ss0;ya;ra;lFm3;bridge6peche;a8ihar,r7u3;ck3ryat0;ingham3;shi3;re;emen,itish columb0;h0ja cal7lk6s3v6;hkorto3que;st2;an;ar0;iforn0;ia;dygea,guascalientes,lAndhr8r4ss3;am;izo1kans4un3;achal 6;as;na;a 3;pradesh;a5ber4t3;ai;ta;ba4s3;ka;ma",Place:"true\xA6a0Eb0Bc04d03e02f00gVhUiRjfk,kOlMmJneGoFpBque,rd,s9t6u5v4w1y0;akutOyz;ake isFis1y0;!o;!c;a,ostok,t;laanbaatar,p02safa,t;ahiti,e1he 0;bronx,hamptons;nn,x;a0fo,oho,t,under7yd;khalNsk;a2e1h0itcairn;l,x;k,nnN;!cif04;kla,nt,rd;b1w eng0;land;!r;a1co,i0t,uc;dNnn;gadZlibu,nhattZ;a0gw,hr;s,x;an1osrae,rasnoyar0ul;sk;!s;a1cn,da,nd0st;ianRochina;!x;arlem,kg,nd,oHwy;a3re0;at 0enwich;brita0lakH;in;!y village;co,l0ra;!a;urope,vergladC;ak,en,fw,ist,own4xb;al5dg,gk,h2l1o0rA;lo,nn;!t;a1ina0uuk;town;morro,tham;!if;cn,e1kk,l0rooklyn;vd;l air,verly hills;frica,lta,m7n3r2sia,tl1ve,zor0;es;!ant2;ct1iz;adyr,tarct0;ic0; oce0;an;ericas,s",MaleName:"true\xA60:E4;1:D5;2:DN;3:AX;4:D1;5:CF;6:B5;7:CV;8:C7;9:DJ;A:DK;B:A5;C:C1;aCNbBKcAId9Ge8Mf84g7Hh6Ti6Dj5Dk51l4Cm34n2So2Mp2Equ2Cr1Ls11t0Eu0Dv07wTxSyIzD;aDor0;cDh9Skaria,n5V;hEkD;!aCL;ar5VeCK;aLoFuD;sDu2JvBX;if,uf;nFsEusD;ouf,sD;ef;aDg;s,tD;an,h0;hli,nBLssX;avi3ho4;aMeKiFoDyaC1;jcie8Blfgang,odrow,utD;!er;lDnst1;bFey,frD0lD;aBCiD;am,e,s;e9Eur;i,nde6sD;!l8t1;de,lErrAyD;l1ne;lDt3;aA9y;aGiDladimir,ojte7Y;cEha0kt68nceDrgAIva0;!nt;e3Ut66;lentDnA4;in4X;ghBUlyss5Bnax,sm0;aXeShOiMoHrFuEyD;!l3ro7s1;n9r5B;avAVeDist0oy,um0;ntANv5Yy;bGdFmDny;!as,mDoharu;aCSie,y;!d;iBy;mDt5;!my,othy;adFeoEia8FomD;!as;!do8O;!de5;dGrD;en9KrD;an9JeDy;ll,n9I;!dy;dgh,ha,iDnn3req,tsu4S;cB4ka;aTcotRePhLiJoHpenc3tDur1Uylve9Jzym1;anFeDua8C;f0phBSvDwa8B;e61ie;!islaw,l8;lom1nBEuD;leyma7ta;dDlBm1yabonga;!dhart7An8;aFeD;lDrm0;d1t1;h7Tne,qu0Zun,wn,y7;aDbasti0k29l4Qrg4Nth,ymoAT;m5n;!tD;!ie,y;lEmDnti2Dq5Aul;!ke5LmCu4;ik,vato7W;aXeTheA9iPoHuEyD;an,ou;b7MdEf5pe7RssD;!elBY;ol3Ey;an,bJc66dIel,geHh0landBPmGnFry,sEyD;!ce;coe,s;!aAGnC;an,eo;l46r;e5Ng3n8olfo,ri79;bCeB7;cDl8;ar6Pc6OhEkDo;!ey,ie,y;a99ie;gEid,ubAx,yDza;an1InY;gA8iD;naA4s;ch70fa4lHmGndFpha4sEul,wi2HyD;an,mo82;h7Vm5;alBDol2Uy;iATon;f,ph;ent2inD;cy,t1;aIeGhilFier72ol,rD;aka16eD;m,st1;!ip,lip;dALrcy,tD;ar,e3Gr1X;b4Kdra7Ft4ZulD;!o17;ctav3Fi3liv3mAFndrej,rHsEtDum9wA;is,to;aEc9k9m0vD;al5Z;ma;i,l53vL;aLeJiFoDu3A;aDel,j5l0ma0r3K;h,m;cEg4i49kD;!au,h7Uola;holBkDolB;!olB;al,d,il,ls1vD;il8Y;hom,thD;anDy;!a4i4;aZeWiMoHuEyD;l2Jr1;hamEr6XstaD;fa,p5C;ed,mH;di0We,hamFis2FntEsDussa;es,he;e,y;ad,ed,mD;ad,ed;cIgu4hai,kGlFnEtchD;!e6;a8Aik;house,o0Bt1;ae5YeA4olD;aj;ah,hDk8;aEeD;al,l;el,l;hElv2rD;le,ri6v2;di,met;ay0ck,hTjd,ks2DlRmadWnQrKs1tFuricExD;!imilian9Nwe6;e,io;eGhEiBtDus,yB;!eo,hew,ia;eDis;us,w;j,o;cHio,kGlFqu7Dsha6tDv2;iDy;!m,n;in,on;!el,oPus;!el9IoOus;iGu4;achDcolm,ik;ai,y;amEdi,eDmoud;sh;adDm5T;ou;aXeQiOlo3EoKuEyD;le,nd1;cGiFkDth3uk;aDe;!s;gi,s,z;as,iaD;no;g0nn7SrenFuDv8Jwe6;!iD;e,s;!zo;am,oD;n4r;a8Cevi,la5JnIoGst3thaFvD;eDi;nte;bo;!nD;!a6Sel;!ny;mFnErDur5Hwr5H;ry,s;ce,d1;ar,o5A;aLeGhaled,iDrist5Iu4Vy6X;er0p,rD;by,k,ollD;os;en0iGnDrmit,v44;!dEnDt5Z;e1Ay;a6ri59;r,th;cp3j5m66na73rEsp9them,uD;ri;im,l;a02eUiSoGuD;an,lDst2;en,iD;an,en,o,us;aNeLhnKkubBnIrGsD;eEhDi8Bue;!ua;!ph;dDge;an,i,on;!aDny;h,s,th5I;!ath5Hie,nC;!l,sDy;ph;o,qu2;an,mD;!mC;d,ffIrFsD;sDus;!e;a6BemEmai7oDry;me,ni0Y;i7Ty;!e60rD;ey,y;cKdAkImHrFsEvi3yD;!dAs1;on,p3;ed,od,rDv56;e5Nod;al,es4Xis1;a,e,oDub;b,v;k,ob,quD;es;aWbQchiPgNkeMlija,nuLonut,rJsFtDv0;ai,suD;ki;aEha0i7DmaDsac;el,il;ac,iaD;h,s;a,vinDw2;!g;k,nngu5S;!r;nacDor;io;ka;ai,rahD;im;aPeJoIuDyd9;be2KgGmber4WsD;eyEsD;a2e2;in,n;h,o;m3ra3Gsse2wa4B;aHctGitGnrErD;be2Dm0;iDy;!q11;or;th;bMlLmza,nKo,rFsEyD;a4JdA;an,s0;lGo50rFuDv8;hi4Gki,tD;a,o;is1y;an,ey;k,s;!im;ib;aVeRiPlenOoLrHuD;ilEsD;!tavo;herme,lerD;mo;aFegDov3;!g,orD;io,y;dy,h5Wnt;nzaErD;an,d1;lo;!n;lbe5Ano,oD;rg3Hvan5A;ne,oFrD;aDry;ld,rd5H;ffr8rge;brElArDv2;la28r3Sth,y;e3EielD;!i5;aTePiNlLorr0NrD;anFedDitz;!dCeDri2B;ri2A;cFkD;!ie,lD;in,yn;esLisD;!co,z36;etch3oD;yd;d4lDnn,onn;ip;deriFliEng,rnD;an06;pe,x;co;bi0di,hd;ar04dZfrYit0lSmKnHo2rFsteb0th0uge7vDymAzra;an,eD;ns,re36;gi,i0DnDrol,v2w2;est4Pie;oEriqDzo;ue;ch;aJerIiEmD;aIe2Z;lErD;!h0;!iD;o,s;s1y;nu4;be0Cd1iGliFmEt1viDwood;n,s;er,o;ot1Ys;!as,j4NsD;ha;a2en;!dCg9mGoEuEwD;a2Din;arD;do;o0Wu0W;l,nD;est;a01eRiOoHrGuFwEylD;an,l0;ay7ight;a7dl8nc0st2;ag0ew;minGnEri0ugDvydBy2D;!lB;!a2MnDov0;e6ie,y;go,iDykB;cDk;!k;armuEeDll1on,rk;go;id;anKj0lbeJmetri5nHon,rGsFvEwDxt3;ay7ey;en,in;hawn,mo0B;ek,ri0I;is,nDv3;is,y;rt;!dD;re;an,lNmLnKrGvD;e,iD;! lucDd;as,ca;en,iFne6rDyl;eDin,yl;l3Bn;n,o,us;!e,i4ny;iDon;an,en,on;e,lB;as;a09e07hYiar0lNoIrGuEyrD;il,us;rtD;!is;aDistob0U;ig;dy,lGnErD;ey,neli5y;or,rD;ad;by,e,in,l2t1;aIeFiDyK;fDnt;fo0Ft1;meEt5velaD;nd;nt;rFuEyD;!t1;de;enD;ce;aIeGrisEuD;ck;!tD;i0oph3;st3;er;d,rDs;b4leD;s,y;cDdric,s9;il;lGmer1rD;ey,lEro6y;ll;!os,t1;eb,v2;a07eZiVlaUoRrEuDyr1;ddy,rtK;aLeGiFuEyD;an,ce,on;ce,no;an,ce;nEtD;!t;dEtD;!on;an,on;dEndD;en,on;!foDl8y;rd;bErDyd;is;!by;i7ke;bFlEshD;al;al,lC;ek;nHrDshoi;at,nEtD;!r1C;aDie;rd14;!edict,iEjam2nC;ie,y;to;kaMlazs,nHrD;n8rDt;eDy;tt;ey;dDeE;ar,iD;le;ar17b0Vd0Rf0Pgust2hm0Mi0Jja0Il04m00nSputsiRrIsaHuFveEyDziz;a0kh0;ry;gust5st2;us;hi;aKchJiIjun,maHnFon,tDy0;hDu09;ur;av,oD;ld;an,nd0H;!el,ki;ie;ta;aq;as,dIgel0CtD;hoGoD;i7nD;!i09y;ne;ny;er,reDy;!as,i,s,w;iFmaDos;nu4r;el;ne,r,t;an,bePdAeJfHi,lGonFphXt1vD;aNin;on;so,zo;an,en;onTrD;edU;c,jaGksandFssaGxD;!andD;er,ru;ar,er;ndD;ro;rtN;ni;dAm9;ar;en;ad,eD;d,t;in;onD;so;aEi,olfDri0vik;!o;mDn;!a;dHeGraEuD;!bakr,lfazl;hDm;am;!l;allIelFoulaye,ulD;!lDrF;ah,o;! rD;ahm0;an;ah;av,on",LastName:"true\xA60:9F;1:9V;2:9H;3:9X;4:9N;5:8J;6:9K;7:A0;8:9E;9:88;A:6E;B:77;C:6J;a9Ub8Lc7Kd6Xe6Rf6Dg5Vh58i54j4Pk45l3Nm2Rn2Eo26p1Nquispe,r17s0Ft05vVwOxNyGzD;aytsADhD;aDou,u;ng,o;aGeun7ZiDoshiA9un;!lD;diDmaz;rim,z;maDng;da,guc97mo6UsDzaB;aBhiA7;iao,u;aHeGiEoDright,u;jc8Sng;lDmm0nkl0sniewsB;liA1s3;b0iss,lt0;a5Rgn0lDng,tanabe;k0sh;aHeGiEoDukA;lk5roby5;dAllalDnogr2Zr0Zss0val37;ba,obos;lasEsel7N;lGn dFrg8EsEzD;qu7;ily9Oqu7silj9O;en b35ijk,yk;enzue95verde;aLeix1JhHi4j6ka3IoGrFsui,uD;om4ZrD;c4n0un1;an,embl8TynisB;dor95lst31m2rr9th;at5Mi7LoD;mErD;are6Ylaci64;ps3s0Y;hirAkah8Dnaka;a00chWeThPiNmKoItFuEvDzabo;en8Aobod34;ar7bot2lliv4zuB;aEein0oD;i67j3Lyan8V;l6rm0;kol5lovy5re6Psa,to,uD;ng,sa;iDy5Z;rn5tD;!h;l5YmDngh,rbu;mo6Do6J;aFeDimizu;hu,vchD;en7Cuk;la,r17;gu8mDoh,pulve8Trra4R;jDyD;on5;evi6Filtz,miDneid0roed0ulz,warz;dEtD;!z;!t;ar42h6ito,lFnDr2saBto,v2;ch7d0AtDz;a4Pe,os;as,ihAm3Zo0Q;aOeNiKoGuEyD;a66oo,u;bio,iz,sD;so,u;bEc7Bdrigue57g03j73mDosevelt,ssi,ta7Nux,w3Z;a4Be0O;ertsDins3;!on;bei0LcEes,vDzzo;as,e8;ci,hards3;ag4es,it0ut0y9;dFmEnDsmu7Zv5F;tan1;ir7os;ic,u;aSeLhJiGoErDut6;asad,if5Zochazk1W;lishc24pDrti62u55we66;e2Tov48;cEe09nD;as,to;as60hl0;aDillips;k,m,n5K;de3AetIna,rGtD;ersErovDtersC;!a,ic;en,on;eDic,ry,ss3;i8ra,tz,z;ers;h71k,rk0tEvD;ic,l3T;el,t2O;bJconnor,g2ClGnei5PrEzD;demir,turk;ella3MtDwe5N;ega,iz;iDof6GsC;vDyn1F;ei8;aPri1;aLeJguy1iFoDune44ym4;rodahl,vDwak;ak3Uik5otn56;eEkolDlsCx3;ic,ov6X;ls1miD;!n1;ils3mD;co42ec;gy,kaEray4varD;ro;jiDmu8shiD;ma;aXcVeQiPoIuD;lGnFrDssoli5T;atDpUr68;i,ov2;oz,te4B;d0l0;h4lIo0HrEsDza0Z;er,s;aFeEiDoz5r3Ete4B;!n6F;au,i8no,t4M;!l9;i2Rl0;crac5Ohhail5kke3Qll0;hmeGij0j2ElFndErci0ssiDyer19;!er;e3Bo2Z;n0Io;dAti;cartDlaughl6;hy;dMe6Dgnu5Ei0jer34kLmJnci59rFtEyD;er,r;ei,ic,su1N;iEkAqu9roqu6tinD;ez,s;a54c,nD;!o;a52mD;ad5;e5Oin1;rig4Ns1;aSeMiIoGuEyD;!nch;k2nDo;d,gu;mbarDpe2Rvr2;di;!nDu,yana1R;coln,dD;bDholm;erg;bed5TfeGhtFitn0kaEn6rDw2G;oy;!j;in1on1;bvDvD;re;iDmmy,rsCu,voie;ne,t11;aTennedy,h4iSlQnez46oJrGuEvar4woD;k,n;cerDmar58znets5;a,o2G;aDem0i2Zyeziu;sni3PvD;ch3U;bay4Frh0Jsk0TvaFwalDzl5;czDsB;yk;cFlD;!cDen3Q;huk;!ev2ic,s;e6uiveD;rt;eff0l2mu8nnun1;hn,lloe,minsBrEstra31to,ur,yDzl5;a,s0;j0GlsC;aMenLha2Pim0QoEuD;ng,r2;e2JhFnErge2Ju2NvD;anA;es,ss3;anEnsD;en,on,t3;nesDsC;en,s1;ki26s1;cGkob3RnsDrv06;en,sD;enDon;!s;ks3obs1;brahimAglesi3Ake4Ll0CnoZoneFshikEto,vanoD;u,v4A;awa;scu;aPeIitchcock,jaltal6oFrist46uD;!aDb0gh9ynh;m4ng;a23dz2fEjga2Sk,rDx3B;ak0Yvat;er,fm3B;iGmingw3NnErD;nand7re8;dDriks1;ers3;kkiEnD;on1;la,n1;dz2g1lvoLmJnsCqIrr0SsFuEyD;as36es;g1ng;anEhiD;mo0Q;i,ov08;ue;alaD;in1;rs1;aMeorgLheorghe,iJjonIoGrEuDw3;o,staf2Utierr7zm4;ayDg2iffitUub0;li1G;lub3Rme0JnD;calv9zale0I;aj,i;l,mDordaL;en7;iev3B;gnJlGmaFnd2No,rDs2Nuthi0;cDza;ia;ge;eaElD;agh0i,o;no;e,on;ab0erMiIjeldsted,lor9oGrFuD;cDent9ji3F;hs;an1Wiedm4;ntaDrt6st0urni0;na;lipEsD;ch0;ovD;!ic;hatAnandeVrD;arDei8;a,i;ov2;dHinste6riksCsDva0D;cob2ZpDtra2X;inoDosiM;za;en,s3;er,is3wards;aUeMiKjurhuJoHrisco0YuEvorakD;!oQ;arte,boEmitru,rDt2U;and,ic;is;g4he0Hmingu7n2Ord19tD;to;us;aDmitr29ssanayake;s,z; GbnaFlEmirDrvis1Lvi,w4;!ov2;gado,ic;th;bo0groot,jo03lEsilDvri9;va;a cruz,e3uD;ca;hl,mcevsBnErw6t2EviD;d5es,s;ieDku1S;ls1;ki;a05e00hNiobMlarkLoFrD;ivDuz;elli;h1lGntFop0rDs26x;byn,reD;a,ia;i,rer0O;em4liD;ns;!e;anu;aLeIiu,oGriDuJwe;stD;eDiaD;ns1;i,ng,uFwDy;!dhury;!n,onEuD;ng;!g;kEnDtterjee,v7;!d,g;ma,raboD;rty;bGl09ng2rD;eghetEnD;a,y;ti;an,ota0M;cer9lder3mpbeIrFstDvadi08;iDro;llo;doEt0uDvalho;so;so,zo;ll;es;a09eXhUiSlNoGrFyD;rne,tyD;qi;ank5iem,ooks,yant;gdan5nFruya,su,uchEyHziD;c,n5;ard;darDik;enD;ko;ov;aEondD;al;nEzD;ev2;co;ancRshwD;as;a01oDuiy4;umDwmD;ik;ckNethov1gu,ktLnJrD;gGisFnD;ascoDds1;ni;ha;er,mD;ann;gtDit7nett;ss3;asD;hi;er,ham;b2ch,ez,hMiley,kk0nHrDu0;bEnDua;es,i0;ieDosa;ri;dDik;a8yopadhyD;ay;ra;er;k,ng;ic;cosZdYguilXkhtXlSnJrGsl4yD;aEd6;in;la;aEsl4;an;ujo,ya;dFgelD;ovD;!a;ersGov,reD;aDjL;ss1;en;en,on,s3;on;eksejGiyGmeiFvD;ar7es;ez;da;ev;ar;ams;ta",WeekDay:"true\xA6fri2mon2s1t0wednesd3;hurs1ues1;aturd1und1;!d0;ay0;!s",Month:"true\xA6aBdec9feb7j2mar,nov9oct1sep0;!t8;!o8;an3u0;l1n0;!e;!y;!u1;!ru0;ary;!em0;ber;pr1ug0;!ust;!il",Date:"true\xA6ago,t2week0yesterd4; e0e0;nd;mr2o0;d0morrow;ay;!w",FirstName:"true\xA6aLblair,cHdevGgabrieFhinaEjCk9l8m4nelly,quinn,re3s0;h0umit;ay,e0iloh;a,lby;g6ne;a1el0ina,org5;!okuh9;naia,r0;ion,lo;ashawn,uca;asCe1ir0rE;an;lsAnyat2rry;am0ess6ie,ude;ie,m5;ta;le;an,on;as2h0;arl0eyenne;ie;ey,sidy;lex2ndr1ubr0;ey;a,ea;is",Person:"true\xA6ashton kutchTbScNdLeJgastOhHinez,jFkEleDmCnettKoBp9r4s3t2v0;a0irgin maH;lentino rossi,n go3;aylor,heresa may,iger woods,yra banks;addam hussain,carlett johanssKlobodan milosevic,uC;ay romano,e3o1ush limbau0;gh;d stewart,nald0;inho,o;ese witherspoFilly;a0ipJ;lmIris hiltD;prah winfrFra;essiaen,itt romnEubarek;bron james,e;anye west,iefer sutherland,obe bryant;aime,effers8k rowli0;ng;alle ber0itlBulk hogan;ry;ff0meril lagasse,zekiel;ie;a0enzel washingt2ick wolf;lt1nte;ar1lint0;on;dinal wols1son0;! palm2;ey;arack obama,rock;er",Verb:"true\xA6awak9born,cannot,fr8g7h5k3le2m1s0wors9;e8h3;ake sure,sg;ngth6ss6;eep tabs,n0;own;as0e2;!t2;iv1onna;ight0;en",PhrasalVerb:"true\xA60:7L;1:79;2:7X;3:7N;4:72;5:80;6:7P;7:6V;8:78;9:7J;A:6W;B:5Z;C:7S;D:7K;a81b6Lc5Rd5Me5Lf4Kg41h3Kiron0j3Gk3Bl2Vm2Jn2Ho2Fp1Wquiet7Ar1Js0CtSuQvacuum 1wHyammer9zE;eroBip FonE;e0k0;by,up;aLeHhGiForErit5G;d 1k33;mp0n2Vpe0r7s7;eel Dip 85;aFiEn2J;gh 09rd0;n Dr E;d2in,o5J;it 61k7lk6rm 6Csh 7Nt6Qv51;rge9sE;e AherB;aTeRhPiLoJrGuEype 69;ckBrn E;d2in,o3Sup;aFiEot0y 2I;ckle6Rp 7T;ck6Qde Y;ne6Pp Es4O;d2o73up;ck GdFe Egh6Bme0p o0Gre0;aw3ba4d2in,up;e 61y 1;by,o7D;ink Erow 6D;ba4ov8up;aEe 5Zll53;m 1r X;ck9ke Flk E;ov8u54;aEba4d2in,o3Cup;ba4ft8p59w3;a0Jc0Ie0Ch08i05l01m00nZoYpTquare StKuIwE;earGiE;ngFtch E;aw3ba4o77; by;ck Eit 1m 1ss0;in,up;aJe0WiIoGrEuc3G;aigh1WiE;ke 6Gn3A;p Erm1Z;by,in,o6T;n3Br 1tc3T;c3Amp0nd Er6Zve6y 1;ba4d2up;d2o6Pup;ar37eHiGlFrEur9;ing9uc7;a3Fit 5B;l13n 1;e5Sll0;be2Wrt0;ap 4Sow D;ash 5Foke0;eep FiEow A;c3Wp 1;in,oE;ff,v8;gn 4XngFt Ez7;d2o5up; al54le0;aGoEu4T;ot Eut0w 6D;aw3ba4f3Go67;c2PdeBk58ve6;e Ill1And HtE; Etl4H;d2in,o5upE;!on;aw3ba4d2in,o27up;o5Mto;al51out0rap51;il6v7;aPeMiLoHuE;b 4Ule0n Estl7;aEba4d2in5Jo3Ut39u3S;c26w3;ll Got FuE;g2Tnd6;a27f30o5;arCin,o5;ng 53p6;aEel6inBnt0;c5Dd E;o31u0I;c24t0;aSeRiPlNoLrIsyc2HuE;ll Gt E;aEba4d2in,o1Ot3Gup;p3Lw3;ap3Kd2in,o5t3Eup;attle9ess FiHoE;p 1;ah1Oon;iEp 5Hr3Yur4Jwer 5H;nt0;ay4DuE;gBmp A;ck Eg0le9n Ap4A;o2Yup;el 4KncilB;c42ir 3Un0ss GtFy E;ba4o54; d2c24;aw3ba4o18;pEw3X;e3Wt D;arrow46erd0oE;d6te45;aMeJiIoGuE;ddl7lE;l 3I;c1Dp 1uth6ve E;al3Nd2in,o5up;ss0x 1;asur7lFss E;a1Gup;t A;ke Fn ArEs1Px0;k Ary6;do,o48up;aRePiKoEuck0;aIc3Hg HoEse0;k Ese3F;aft8ba4d2forw2Jin46ov8uE;nd8p;in,o0M;d A;e HghtGnFsEv1V;ten 4M;e 1k 1; 1e37;arCd2;av1Jt 37velE; o3U;c7p 1sh Etch9ugh6y20;in3Uo5;eFick6nock E;d2o3Q;eEyB;l 2Pp E;aw3ba4d2fTin,o07to,up;aGoFuE;ic7mpB;ke31t35;c3Azz 1;aQeLiIoFuE;nker32rry 1s0W;lEneBrse2X;d Ee 1;ba4d2fast,o01up;de Ft E;ba4on,up;aw3o5;aElp0;d Gl 2Ar Et 1;fEof;rom;in,oTu1H;c02m 1nFve Ez25;it,to;d Eg 2FkerG;d2in,o5;aTeMive Kloss 22oGrFunE; f0N;in3How 2B; Eof 21;aFb1Dit,oErCt0Pu18;ff,n,v8;bo5ft8hKw3;aw3ba4d2in,oEup,w3;ff,n,ut;aJek0t E;aFb17d2oErCup;ff,n,ut,v8;cFhEl1XrCt,w3;ead;ross;r 1;d aFnE;g 1;bo5;a08e01iSlOoKrGuE;cEel 1;k 1;eFighten Eown9y 1;aw3o2S;eEshe1N; 1z7;lGol E;aEwi1G;bo5rC;d Alow 1;aFeEip0;sh0;g Ake0mErE;e 2R;gLlJnHrFsEzzle0;h 2P;e Em 1;aw3ba4up;d0isE;h 1;e El 19;aw3fJ;ht ba4ure0;eJnFsE;s 1;cGd E;fEo25;or;e D;dVl 1;cIll Erm0t0W;ap04bGd2in,oFtE;hrough;ff,ut,v8;a4ehi20;e 0L;at0dge0nd 0Ky7;oHrE;aFess Aop E;aw3bUin,o1E;g9w9; 0Dubl7;aXhUlean AoHrEut 10;ack9eep Eoss D;by,d2oEup;n,ut;me HoFuntE; o1Q;k 1l E;d2o1I;aKbJforHin,oGtFuE;nd8;ogeth8;ut,v8;th,wE;ard;a4y;pErCw3;art;eEipB;ck Der E;on,up;lKncel0rHsGtch FveB; in;o19up;h Dt6;ry FvE;e Y;aw3o15;l Em05;aEba4d2o13up;rCw3;a0Ke0Bl04oVrJuE;bblGcklWil02lk AndlWrn 08st FtEy 13zz6;t D;in,o5up;e E;ov8;anOeaMiFush E;o0Oup;ghIng E;aFba4d2forEin,o5up;th;bo5lErCw3;ong;teE;n 1;k E;d2in,o5up;ch0;arLgKil An7oHssGttlFunce Ex D;aw3ba4;e A; arC;k Dt 1;e 1;d2up; d2;d 1;aJeed0oEurt0;cGw E;aw3ba4d2o5up;ck;k E;in,oL;ck0nk0st6; oKaHef 1nd E;d2ov8up;er;up;r0t E;d2in,oEup;ff,ut;ff,nE;to;ck Kil0nGrgFsE;h D;ain9e D;g Dk9; on;in,o5; o5;aw3d2o5up;ay;cNdJsk Guction6; oE;ff;arCo5;ouE;nd;d E;d2oEup;ff,n;own;t E;o5up;ut",Modal:"true\xA6c5lets,m4ought3sh1w0;ill,o5;a0o4;ll,nt;! to,a;ay,ight,ust;an,o0;uld",Adjective:"true\xA60:7P;1:84;2:83;3:8A;4:7W;5:5S;6:4N;7:4O;8:58;9:6I;A:81;a6Wb6Gc63d5Je54f4Hg49h3Wi39j37k36l2Vm2Ln2Bo1Wp1Dquack,r12s0Ft07uMvJwByear5;arp0eFholeEiDoB;man5oBu6P;d6Rzy;despr7Ls5S;!sa7;eClBste2A;co1Nl o4W;!k5;aCiBola4M;b89ce versa,ol5H;ca3gabo6Gnilla;ltUnHpCrb5Msu4tterB;!mo7G; Eb1SpDsBti1M;ca7etBide dKtairs;!ti2;er,i3U;f36to da1;aLbeco75convin29deIeHfair,ivers4knGprecedVrEsCwB;iel3Nritt6A;i1XuB;pervis0spec3Y;eBu5;cognHgul6Tl6T;own;ndi2v64xpect0;cid0rB;!grou5ZsB;iz0tood;b7pp0Dssu6UuthorB;iz0;i26ra;aGeEhDi6AoCrB;i1oubl0us3M;geth8p,rp6Vuc67;ough4Wril33;en60l32mpBrr2X;o6Ati2;boo,lBn;ent0;aWcVeThSiQmug,nobbi3LoOpNqueami3LtFuBymb6H;bDi gener5DpBrpri6D;erBre0N;! dup8b,i2C;du0seq52;anda77eGiFrBunni2y3F;aightCiB;ki2p0; fBfB;or5K;ll,r5S;aBreotyp0;dfa6Cmi2;a55ec2Gir1Hlend6Cot on; call0le,mb8phist1XrBu0Vvi48;d6Ary;gnifica3nB;ce51g7;am2Re8ocki2ut;cBda1em5lfi32ni1Wpa6Jre6;o1Er42;at5Gient28reec5G;cr0me;aJeEiCoB;bu60tt51uQy4;ghtBv4;!-2Bf9;ar,bel,condi1du6Dfres5AlEpublic42sCtard0vB;ea26;is4CoB;lu1na3;aQe1Cuc4A;b5TciBllyi2;al,st;aOeLicayu6lac5Ropuli5QrCuB;bl5Jmp0n51;eGiDoB;!b07fu5RmiBp8;ne3si2;mCor,sBva1;ti6;a53e;ci5MmB;a0EiB;er,um;ac20rBti1;feAma2XpleBv38;xi2;rBst;allelDtB;-tiBi4;me;!ed;bLffJkIld fashion0nHpGrg1Eth8utFvB;al,erB;!all,niCt,wB;eiBrouB;ght;do0Ter,g2Qsi4B;en,posi1; boa5Og2Oli6;!ay; gua5MbBli6;eat;eDsB;cBer0Eole1;e6u3O;d2Xse;aJeIiHoBua4X;nFrCtB;ab7;thB;!eB;rn;chala3descri58stop;ght5;arby,cessa44ighbor5xt;k0usia1A;aIeGiDoBultip7;bi7derBl0Vnth5ot,st;a1n;nBx0;dblo0RiaBor;tu37;ande3Qdi4NnaBre;ci2;cBgenta,in,j01keshift,le,mmoth,ny,sculi6;ab33ho;aKeFiCoBu15;uti14vi2;mCteraB;l,te;it0;ftEgBth4;al,eCitiB;ma1;nda3K;!-0C;ngu3Zst,tt8;ap1Xind5no0A;agg0uB;niMstifi0veni7;de4gno4Klleg4mQnEpso 20rB;a1rB;eleBita0J;va3; KaJbr0corIdGfluenQiQnFsEtCviB;go0Fti2;aAen3SoxB;ic3B;a6i2Vul0D;a1er,oce3;iCoB;or;reA;deq3Qppr33;fBsitu,vitro;ro3;mFpB;arDerfeAoBrop8;li1rtB;a3ed;ti4;eBi0S;d2Vn3C;aIeFiDoBumdr3I;ne36ok0rrBs08ur5;if2Z;ghfalut1QspB;an2X;aClB;liYpf9;li2;lEnDrB;d04roB;wi2;dy;f,low0;ainf9ener2Oiga24lHoGraDuB;ilBng ho;ty;cCtB;ef9is;ef9;ne,od;ea2Iob4;aTeNinMlKoFrB;a1VeDoz1MustB;raB;ti2;e2Gq10tf9;oDrB; keeps,eBm8tuna1;g03ign;liB;sh;aBue3;g31tte1P;al,i1;dFmCrB;ti7;a7ini6;ne;le; up;bl0i3l27r Cux,voB;ri1uri1;oBreac1E;ff;aLfficie3lKmHnFreAthere4veExB;aAcess,pe1QtraCuB;be2Nl0E;!va1E;n,ryday; BcouraEti0O;rou1sui1;erCiB;ne3;gi2;abo23dMe17i1;g8sB;t,ygB;oi2;er;aReJiDoBrea14ue;mina3ne,ubB;le,tf9;dact1Bfficu1OsCvB;er1K;creDeas0gruntl0hone1FordCtB;a3ressM;er5;et; HadpGfFgene1PliDrang0spe1PtCvoB;ut;ail0ermin0;be1Mca1ghB;tf9;ia3;an;facto;i5magBngeroUs0G;ed,i2;ly;ertaMhief,ivil,oDrB;aBowd0u0G;mp0vZz0;loImGnCrrBve0P;eAu1I;cre1fu0LgrDsCtB;empo0Dra0E;ta3;ue3;mer08pleB;te,x;ni4ss4;in;aNeIizarHlFoCrB;and new,isk,okN;gCna fiUttom,urgeoB;is;us;ank,indB;!i2;re;autif9hiDloCnBst,yoD;eUt;v0w;nd;ul;ckCnkru0WrrB;en;!wards; priori,b0Mc0Jd09fra08g04h03lYmWntiquVppSrMsIttracti06utheHvEwB;aCkB;wa0T;ke,re;ant garCerB;age;de;ntU;leep,piDsuDtonB;isB;hi2;ri2;ab,bitEroDtiB;fiB;ci4;ga3;raB;ry;are3etiNrB;oprB;ia1;at0;aJuB;si2;arEcohCeBiIl,oof;rt;olB;ic;mi2;ead;ainDgressiConiB;zi2;ve;st;id; IeGuFvB;aCerB;se;nc0;ed;lt;pt,qB;ua1;hoc,infinitB;um;cuCtu4u1;al;ra1;erLlKoIruHsCuB;nda3;e3oCtraA;ct;lu1rbi2;ng;te;pt;aBve;rd;aze,e;ra3;nt",Comparable:"true\xA60:41;1:4I;2:45;3:2Y;4:4B;5:3X;a4Ob44c3Od3De35f2Rg2Fh24i1Vj1Uk1Rl1Jm1Dn17o15p0Vqu0Tr0KsTtMuIvFw7y6za13;ell27ou4;aBe9hi1Yi7r6;o4y;ck0Ode,l6n1ry,se;d,y;a6i4Mt;k,ry;n1Tr6sK;m,y;a7e6ulgar;nge5rda2xi4;g9in,st;g0n6pco3Mse5;like0t6;i1r6;ue;aAen9hi8i7ough,r6;anqu2Oen1ue;dy,g3Sme0ny,r09;ck,n,rs2P;d40se;ll,me,rt,s6wd45;te5;aVcarUeThRiQkin0FlMmKoHpGqua1FtAu7w6;eet,ift;b7dd13per0Gr6;e,re2H;sta2Ft3;aAe9iff,r7u6;pXr1;a6ict,o4;ig3Fn0U;a1ep,rn;le,rk;e22i3Fright0;ci28ft,l7o6re,ur;n,thi4;emn,id;a6el0ooth;ll,rt;e8i6ow,y;ck,g35m6;!y;ek,nd3D;ck,l0mp3;a6iTort,rill,y;dy,ll0Xrp;cu0Rve0Rxy;ce,ed,y;d,fe,int0l1Vv14;aBe9i8o6ude;mantic,o1Isy,u6;gh,nd;ch,pe,tzy;a6d,mo0H;dy,l;gg7ndom,p6re,w;id;ed;ai2i6;ck,et;aEhoDi1QlCoBr8u6;ny,r6;e,p3;egna2ic7o6;fouYud;ey,k0;li04or,te1B;ain,easa2;ny;in5le;dd,f6i0ld,ranQ;fi10;aAe8i7o6;b3isy,rm15sy;ce,mb3;a6w;r,t;ive,rr01;aAe8ild,o7u6;nda19te;ist,o1;a6ek,llX;n,s0ty;d,tuQ;aBeAi9o6ucky;f0Un7o1Du6ve0w17y0T;d,sy;e0g;g1Tke0tt3ve0;an,wd;me,r6te;ge;e7i6;nd;en;ol0ui1P;cy,ll,n6;sBt6;e6ima8;llege2r6;es7media6;te;ti4;ecu6ta2;re;aEeBiAo8u6;ge,m6ng1R;b3id;ll6me0t;ow;gh,l0;a6f04sita2;dy,v6;en0y;nd1Hppy,r6te5;d,sh;aGenFhDiClBoofy,r6;a9e8is0o6ue1E;o6ss;vy;at,en,y;nd,y;ad,ib,ooI;a2d1;a6o6;st0;t3uiY;u1y;aIeeb3iDlat,oAr8u6;ll,n6r14;!ny;aHe6iend0;e,sh;a7r6ul;get5mG;my;erce8n6rm;an6e;ciC;! ;le;ir,ke,n0Fr,st,t,ulA;aAerie,mp9sse7v6xtre0Q;il;nti6;al;ty;r7s6;tern,y;ly,th0;aFeCi9r7u6;ll,mb;u6y;nk;r7vi6;ne;e,ty;a6ep,nD;d6f,r;!ly;mp,pp03rk;aHhDlAo8r7u6;dd0r0te;isp,uel;ar6ld,mmon,ol,st0ward0zy;se;e6ou1;a6vW;n,r;ar8e6il0;ap,e6;sy;mi4;gey,lm8r6;e5i4;ful;!i4;aNiLlIoEr8u6;r0sy;ly;aAi7o6;ad,wn;ef,g7llia2;nt;ht;sh,ve;ld,r7un6;cy;ed,i4;ng;a7o6ue;nd,o1;ck,nd;g,tt6;er;d,ld,w1;dy;bsu9ng8we6;so6;me;ry;rd",TextOrdinal:"true\xA6bGeDf9hundredHmGnin7qu6s4t0zeroH;enGh1rFwe0;lfFn9;ir0ousandE;d,t4;e0ixt9;cond,ptAvent8xtA;adr9int9;et0th;e6ie8;i2o0;r0urt3;tie5;ft1rst;ight0lev1;e0h,ie2;en1;illion0;th",Cardinal:"true\xA6bHeEf8hundred,mHnineAone,qu6s4t0zero;en,h2rGw0;e0o;lve,n8;irt9ousandEree;e0ix5;pt1ven4xt1;adr0int0;illion;i3o0;r1ur0;!t2;ty;ft0ve;e2y;ight0lev1;!e0y;en;illion0;!s",Expression:"true\xA6a02b01dXeVfuck,gShLlImHnGoDpBshAtsk,u7voi04w3y0;a1eLu0;ck,p;!a,hoo,y;h1ow,t0;af,f;e0oa;e,w;gh,h0;! 0h,m;huh,oh;eesh,hh,it;ff,hew,l0sst;ease,z;h1o0w,y;h,o,ps;!h;ah,ope;eh,mm;m1ol0;!s;ao,fao;a4e2i,mm,oly1urr0;ah;! mo6;e,ll0y;!o;ha0i;!ha;ah,ee,o0rr;l0odbye;ly;e0h,t cetera,ww;k,p;'oh,a0uh;m0ng;mit,n0;!it;ah,oo,ye; 1h0rgh;!em;la",Adverb:"true\xA6a08by 06d02eYfShQinPjustOkinda,mMnJoEpCquite,r9s5t2up1very,well,ye0;p,s; to,wards5;h1iny bit,o0wiO;o,t6ward;en,us;eldom,o0uch;!me1rt0; of;hYtimes,w09;a1e0;alT;ndomSthN;ar excellDer0oint blank; Nhaps;f3n0;ce0ly;! 0;ag02moW; courIten;ewKo0; longEt 0;onIwithstanding;aybe,eanwhiAore0;!ovB;! aboU;deed,steV;en0;ce;or2u0;lArther0;!moJ; 0ev3;examp0good,suH;le;n1v0;er; mas0ough;se;e0irect1; 1finite0;ly;ju8trop;far,n0;ow; DbroCd nauseam,gBl6ny3part,s2t 0w4;be6l0mo6wor6;arge,ea5; soon,ide;mo1w0;ay;re;l 1mo0one,ready,so,ways;st;b1t0;hat;ut;ain;ad;lot,posteriori",Determiner:"true\xA6aBboth,d9e6few,l4mu8neiDown,plenty,s3th2various,wh0;at0ich0;evC;at,e4is,ose;everal,ome;a,e0;!ast,s;a1i6l0very;!se;ch;e0u;!s;!n0;!o0y;th0;er"},rCe=function(a){let t=a.split("|").reduce((r,n)=>{let i=n.split("\xA6");return r[i[0]]=i[1],r},{}),e={};return Object.keys(t).forEach(function(r){let n=tCe(t[r]);r==="true"&&(r=!0);for(let i=0;i<n.length;i++){let s=n[i];e.hasOwnProperty(s)===!0?Array.isArray(e[s])===!1?e[s]=[e[s],r]:e[s].push(r):e[s]=r}}),e},nCe={"20th century fox":"Organization","7 eleven":"Organization","motel 6":"Organization",g8:"Organization",vh1:"Organization",q1:"Date",q2:"Date",q3:"Date",q4:"Date",her:["Possessive","Pronoun"],his:["Possessive","Pronoun"],their:["Possessive","Pronoun"],themselves:["Possessive","Pronoun"],your:["Possessive","Pronoun"],our:["Possessive","Pronoun"],my:["Possessive","Pronoun"],its:["Possessive","Pronoun"]},dz={Unit:(a,t)=>{a[t]=["Abbreviation","Unit"]},Cardinal:(a,t)=>{a[t]=["TextValue","Cardinal"]},TextOrdinal:(a,t)=>{a[t]=["Ordinal","TextValue"],a[t+"s"]=["TextValue","Fraction"]},Singular:(a,t,e)=>{a[t]="Singular";let r=e.transforms.toPlural(t,e);a[r]=a[r]||"Plural"},Infinitive:(a,t,e)=>{a[t]="Infinitive";let r=e.transforms.conjugate(t,e),n=Object.keys(r);for(let i=0;i<n.length;i++){let s=r[n[i]];a[s]=a[s]||n[i]}},Comparable:(a,t,e)=>{a[t]="Comparable";let r=e.transforms.adjectives(t),n=Object.keys(r);for(let i=0;i<n.length;i++){let s=r[n[i]];a[s]=a[s]||n[i]}},PhrasalVerb:(a,t,e)=>{a[t]=["PhrasalVerb","Infinitive"];let r=t.split(" "),n=e.transforms.conjugate(r[0],e),i=Object.keys(n);for(let s=0;s<i.length;s++){let o=n[i[s]]+" "+r[1];a[o]=a[o]||["PhrasalVerb",i[s]],e.hasCompound[n[i[s]]]=!0}},Demonym:(a,t,e)=>{a[t]="Demonym";let r=e.transforms.toPlural(t,e);a[r]=a[r]||["Demonym","Plural"]}},hz=function(a,t,e){Object.keys(a).forEach(r=>{let n=a[r];n!=="Abbreviation"&&n!=="Unit"||(e.cache.abbreviations[r]=!0);let i=r.split(" ");i.length>1&&(e.hasCompound[i[0]]=!0),dz[n]===void 0?t[r]!==void 0?(typeof t[r]=="string"&&(t[r]=[t[r]]),typeof n=="string"?t[r].push(n):t[r]=t[r].concat(n)):t[r]=n:dz[n](t,r,e)})},aCe={buildOut:function(a){let t=Object.assign({},nCe);return Object.keys(fz).forEach(e=>{let r=rCe(fz[e]);Object.keys(r).forEach(n=>{r[n]=e}),hz(r,t,a)}),t},addWords:hz},iCe=function(a){let t=a.irregulars.nouns,e=Object.keys(t);for(let i=0;i<e.length;i++){let s=e[i];a.words[s]="Singular",a.words[t[s]]="Plural"}let r=a.irregulars.verbs,n=Object.keys(r);for(let i=0;i<n.length;i++){let s=n[i];a.words[s]=a.words[s]||"Infinitive";let o=a.transforms.conjugate(s,a);o=Object.assign(o,r[s]),Object.keys(o).forEach(l=>{a.words[o[l]]=a.words[o[l]]||l,a.words[o[l]]==="Participle"&&(a.words[o[l]]=l)})}},sCe={g:"Gerund",prt:"Participle",perf:"PerfectTense",pst:"PastTense",fut:"FuturePerfect",pres:"PresentTense",pluperf:"Pluperfect",a:"Actor"},Dd={act:{a:"_or"},ache:{pst:"ached",g:"aching"},age:{g:"ageing",pst:"aged",pres:"ages"},aim:{a:"_er",g:"_ing",pst:"_ed"},arise:{prt:"_n",pst:"arose"},babysit:{a:"_ter",pst:"babysat"},ban:{a:"",g:"_ning",pst:"_ned"},be:{a:"",g:"am",prt:"been",pst:"was",pres:"is"},beat:{a:"_er",g:"_ing",prt:"_en"},become:{prt:"_"},begin:{g:"_ning",prt:"begun",pst:"began"},being:{g:"are",pst:"were",pres:"are"},bend:{prt:"bent"},bet:{a:"_ter",prt:"_"},bind:{pst:"bound"},bite:{g:"biting",prt:"bitten",pst:"bit"},bleed:{pst:"bled",prt:"bled"},blow:{prt:"_n",pst:"blew"},boil:{a:"_er"},brake:{prt:"broken"},break:{pst:"broke"},breed:{pst:"bred"},bring:{pst:"brought",prt:"brought"},broadcast:{pst:"_"},budget:{pst:"_ed"},build:{pst:"built",prt:"built"},burn:{prt:"_ed"},burst:{prt:"_"},buy:{pst:"bought",prt:"bought"},can:{a:"",fut:"_",g:"",pst:"could",perf:"could",pluperf:"could",pres:"_"},catch:{pst:"caught"},choose:{g:"choosing",prt:"chosen",pst:"chose"},cling:{prt:"clung"},come:{prt:"_",pst:"came",g:"coming"},compete:{a:"competitor",g:"competing",pst:"_d"},cost:{pst:"_"},creep:{prt:"crept"},cut:{prt:"_"},deal:{pst:"_t",prt:"_t"},develop:{a:"_er",g:"_ing",pst:"_ed"},die:{g:"dying",pst:"_d"},dig:{g:"_ging",pst:"dug",prt:"dug"},dive:{prt:"_d"},do:{pst:"did",pres:"_es"},draw:{prt:"_n",pst:"drew"},dream:{prt:"_t"},drink:{prt:"drunk",pst:"drank"},drive:{g:"driving",prt:"_n",pst:"drove"},drop:{g:"_ping",pst:"_ped"},eat:{a:"_er",g:"_ing",prt:"_en",pst:"ate"},edit:{pst:"_ed",g:"_ing"},egg:{pst:"_ed"},fall:{prt:"_en",pst:"fell"},feed:{prt:"fed",pst:"fed"},feel:{a:"_er",pst:"felt"},fight:{pst:"fought",prt:"fought"},find:{pst:"found"},flee:{g:"_ing",prt:"fled"},fling:{prt:"flung"},fly:{prt:"flown",pst:"flew"},forbid:{pst:"forbade"},forget:{g:"_ing",prt:"forgotten",pst:"forgot"},forgive:{g:"forgiving",prt:"_n",pst:"forgave"},free:{a:"",g:"_ing"},freeze:{g:"freezing",prt:"frozen",pst:"froze"},get:{pst:"got",prt:"gotten"},give:{g:"giving",prt:"_n",pst:"gave"},go:{prt:"_ne",pst:"went",pres:"goes"},grow:{prt:"_n"},guide:{pst:"_d"},hang:{pst:"hung",prt:"hung"},have:{g:"having",pst:"had",prt:"had",pres:"has"},hear:{pst:"_d",prt:"_d"},hide:{prt:"hidden",pst:"hid"},hit:{prt:"_"},hold:{pst:"held",prt:"held"},hurt:{pst:"_",prt:"_"},ice:{g:"icing",pst:"_d"},imply:{pst:"implied",pres:"implies"},is:{a:"",g:"being",pst:"was",pres:"_"},keep:{prt:"kept"},kneel:{prt:"knelt"},know:{prt:"_n"},lay:{pst:"laid",prt:"laid"},lead:{pst:"led",prt:"led"},leap:{prt:"_t"},leave:{pst:"left",prt:"left"},lend:{prt:"lent"},lie:{g:"lying",pst:"lay"},light:{pst:"lit",prt:"lit"},log:{g:"_ging",pst:"_ged"},loose:{prt:"lost"},lose:{g:"losing",pst:"lost"},make:{pst:"made",prt:"made"},mean:{pst:"_t",prt:"_t"},meet:{a:"_er",g:"_ing",pst:"met",prt:"met"},miss:{pres:"_"},name:{g:"naming"},patrol:{g:"_ling",pst:"_led"},pay:{pst:"paid",prt:"paid"},prove:{prt:"_n"},puke:{g:"puking"},put:{prt:"_"},quit:{prt:"_"},read:{pst:"_",prt:"_"},ride:{prt:"ridden"},reside:{pst:"_d"},ring:{pst:"rang",prt:"rung"},rise:{fut:"will have _n",g:"rising",prt:"_n",pst:"rose",pluperf:"had _n"},rub:{g:"_bing",pst:"_bed"},run:{g:"_ning",prt:"_",pst:"ran"},say:{pst:"said",prt:"said",pres:"_s"},seat:{pst:"sat",prt:"sat"},see:{g:"_ing",prt:"_n",pst:"saw"},seek:{prt:"sought"},sell:{pst:"sold",prt:"sold"},send:{prt:"sent"},set:{prt:"_"},sew:{prt:"_n"},shake:{prt:"_n"},shave:{prt:"_d"},shed:{g:"_ding",pst:"_",pres:"_s"},shine:{pst:"shone",prt:"shone"},shoot:{pst:"shot",prt:"shot"},show:{pst:"_ed"},shut:{prt:"_"},sing:{prt:"sung",pst:"sang"},sink:{pst:"sank",pluperf:"had sunk"},sit:{pst:"sat"},ski:{pst:"_ied"},slay:{prt:"slain"},sleep:{prt:"slept"},slide:{pst:"slid",prt:"slid"},smash:{pres:"_es"},sneak:{prt:"snuck"},speak:{fut:"will have spoken",prt:"spoken",pst:"spoke",perf:"have spoken",pluperf:"had spoken"},speed:{prt:"sped"},spend:{prt:"spent"},spill:{prt:"_ed",pst:"spilt"},spin:{g:"_ning",pst:"spun",prt:"spun"},spit:{prt:"spat"},split:{prt:"_"},spread:{pst:"_"},spring:{prt:"sprung"},stand:{pst:"stood"},steal:{a:"_er",pst:"stole"},stick:{pst:"stuck"},sting:{pst:"stung"},stink:{pst:"stunk",prt:"stunk"},stream:{a:"_er"},strew:{prt:"_n"},strike:{g:"striking",pst:"struck"},suit:{a:"_er",g:"_ing",pst:"_ed"},sware:{prt:"sworn"},swear:{pst:"swore"},sweep:{prt:"swept"},swim:{g:"_ming",pst:"swam"},swing:{pst:"swung"},take:{fut:"will have _n",pst:"took",perf:"have _n",pluperf:"had _n"},teach:{pst:"taught",pres:"_es"},tear:{pst:"tore"},tell:{pst:"told"},think:{pst:"thought"},thrive:{prt:"_d"},tie:{g:"tying",pst:"_d"},undergo:{prt:"_ne"},understand:{pst:"understood"},upset:{prt:"_"},wait:{a:"_er",g:"_ing",pst:"_ed"},wake:{pst:"woke"},wear:{pst:"wore"},weave:{prt:"woven"},wed:{pst:"wed"},weep:{prt:"wept"},win:{g:"_ning",pst:"won"},wind:{prt:"wound"},withdraw:{pst:"withdrew"},wring:{prt:"wrung"},write:{g:"writing",prt:"written",pst:"wrote"}},yz=Object.keys(Dd);for(let a=0;a<yz.length;a++){let t=yz[a],e={};Object.keys(Dd[t]).forEach(r=>{let n=Dd[t][r];n=n.replace("_",t),e[sCe[r]]=n}),Dd[t]=e}var oCe=Dd,F1={b:[{reg:/([^aeiou][aeiou])b$/i,repl:{pr:"$1bs",pa:"$1bbed",gr:"$1bbing"}}],d:[{reg:/(end)$/i,repl:{pr:"$1s",pa:"ent",gr:"$1ing",ar:"$1er"}},{reg:/(eed)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing",ar:"$1er"}},{reg:/(ed)$/i,repl:{pr:"$1s",pa:"$1ded",ar:"$1der",gr:"$1ding"}},{reg:/([^aeiou][ou])d$/i,repl:{pr:"$1ds",pa:"$1dded",gr:"$1dding"}}],e:[{reg:/(eave)$/i,repl:{pr:"$1s",pa:"$1d",gr:"eaving",ar:"$1r"}},{reg:/(ide)$/i,repl:{pr:"$1s",pa:"ode",gr:"iding",ar:"ider"}},{reg:/(t|sh?)(ake)$/i,repl:{pr:"$1$2s",pa:"$1ook",gr:"$1aking",ar:"$1$2r"}},{reg:/w(ake)$/i,repl:{pr:"w$1s",pa:"woke",gr:"waking",ar:"w$1r"}},{reg:/m(ake)$/i,repl:{pr:"m$1s",pa:"made",gr:"making",ar:"m$1r"}},{reg:/(a[tg]|i[zn]|ur|nc|gl|is)e$/i,repl:{pr:"$1es",pa:"$1ed",gr:"$1ing"}},{reg:/([bd]l)e$/i,repl:{pr:"$1es",pa:"$1ed",gr:"$1ing"}},{reg:/(om)e$/i,repl:{pr:"$1es",pa:"ame",gr:"$1ing"}}],g:[{reg:/([^aeiou][aou])g$/i,repl:{pr:"$1gs",pa:"$1gged",gr:"$1gging"}}],h:[{reg:/(..)([cs]h)$/i,repl:{pr:"$1$2es",pa:"$1$2ed",gr:"$1$2ing"}}],k:[{reg:/(ink)$/i,repl:{pr:"$1s",pa:"unk",gr:"$1ing",ar:"$1er"}}],m:[{reg:/([^aeiou][aeiou])m$/i,repl:{pr:"$1ms",pa:"$1mmed",gr:"$1mming"}}],n:[{reg:/(en)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}}],p:[{reg:/(e)(ep)$/i,repl:{pr:"$1$2s",pa:"$1pt",gr:"$1$2ing",ar:"$1$2er"}},{reg:/([^aeiou][aeiou])p$/i,repl:{pr:"$1ps",pa:"$1pped",gr:"$1pping"}},{reg:/([aeiu])p$/i,repl:{pr:"$1ps",pa:"$1p",gr:"$1pping"}}],r:[{reg:/([td]er)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}},{reg:/(er)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}}],s:[{reg:/(ish|tch|ess)$/i,repl:{pr:"$1es",pa:"$1ed",gr:"$1ing"}}],t:[{reg:/(ion|end|e[nc]t)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}},{reg:/(.eat)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}},{reg:/([aeiu])t$/i,repl:{pr:"$1ts",pa:"$1t",gr:"$1tting"}},{reg:/([^aeiou][aeiou])t$/i,repl:{pr:"$1ts",pa:"$1tted",gr:"$1tting"}}],w:[{reg:/(.llow)$/i,repl:{pr:"$1s",pa:"$1ed"}},{reg:/(..)(ow)$/i,repl:{pr:"$1$2s",pa:"$1ew",gr:"$1$2ing",prt:"$1$2n"}}],y:[{reg:/(i|f|rr)y$/i,repl:{pr:"$1ies",pa:"$1ied",gr:"$1ying"}}],z:[{reg:/([aeiou]zz)$/i,repl:{pr:"$1es",pa:"$1ed",gr:"$1ing"}}]},lCe={pr:"PresentTense",pa:"PastTense",gr:"Gerund",prt:"Participle",ar:"Actor"},uCe=function(a,t){let e={},r=Object.keys(t.repl);for(let n=0;n<r.length;n+=1){let i=r[n];e[lCe[i]]=a.replace(t.reg,t.repl[i])}return e},bz=/[bcdfghjklmnpqrstvwxz]y$/,cCe=function(a=""){let t=a[a.length-1];if(F1.hasOwnProperty(t)===!0){for(let e=0;e<F1[t].length;e+=1)if(F1[t][e].reg.test(a)===!0)return uCe(a,F1[t][e])}return{}},lR={Gerund:a=>a.charAt(a.length-1)==="e"?a.replace(/e$/,"ing"):a+"ing",PresentTense:a=>a.charAt(a.length-1)==="s"?a+"es":bz.test(a)===!0?a.slice(0,-1)+"ies":a+"s",PastTense:a=>a.charAt(a.length-1)==="e"?a+"d":a.substr(-2)==="ed"?a:bz.test(a)===!0?a.slice(0,-1)+"ied":a+"ed"},pCe=function(a="",t){let e={};return t&&t.irregulars&&t.irregulars.verbs.hasOwnProperty(a)===!0&&(e=Object.assign({},t.irregulars.verbs[a])),e=Object.assign({},cCe(a),e),e.Gerund===void 0&&(e.Gerund=lR.Gerund(a)),e.PastTense===void 0&&(e.PastTense=lR.PastTense(a)),e.PresentTense===void 0&&(e.PresentTense=lR.PresentTense(a)),e},gz=[/ght$/,/nge$/,/ough$/,/ain$/,/uel$/,/[au]ll$/,/ow$/,/oud$/,/...p$/],vz=[/ary$/],Tz={nice:"nicest",late:"latest",hard:"hardest",inner:"innermost",outer:"outermost",far:"furthest",worse:"worst",bad:"worst",good:"best",big:"biggest",large:"largest"},j1=[{reg:/y$/i,repl:"iest"},{reg:/([aeiou])t$/i,repl:"$1ttest"},{reg:/([aeou])de$/i,repl:"$1dest"},{reg:/nge$/i,repl:"ngest"},{reg:/([aeiou])te$/i,repl:"$1test"}],Nz=[/ght$/,/nge$/,/ough$/,/ain$/,/uel$/,/[au]ll$/,/ow$/,/old$/,/oud$/,/e[ae]p$/],Cz=[/ary$/,/ous$/],Az={grey:"greyer",gray:"grayer",green:"greener",yellow:"yellower",red:"redder",good:"better",well:"better",bad:"worse",sad:"sadder",big:"bigger"},M1=[{reg:/y$/i,repl:"ier"},{reg:/([aeiou])t$/i,repl:"$1tter"},{reg:/([aeou])de$/i,repl:"$1der"},{reg:/nge$/i,repl:"nger"}],Sz={toSuperlative:function(a){if(Tz.hasOwnProperty(a))return Tz[a];for(let t=0;t<j1.length;t++)if(j1[t].reg.test(a))return a.replace(j1[t].reg,j1[t].repl);for(let t=0;t<vz.length;t++)if(vz[t].test(a)===!0)return null;for(let t=0;t<gz.length;t++)if(gz[t].test(a)===!0)return a.charAt(a.length-1)==="e"?a+"st":a+"est";return a+"est"},toComparative:function(a){if(Az.hasOwnProperty(a))return Az[a];for(let t=0;t<M1.length;t++)if(M1[t].reg.test(a)===!0)return a.replace(M1[t].reg,M1[t].repl);for(let t=0;t<Cz.length;t++)if(Cz[t].test(a)===!0)return null;for(let t=0;t<Nz.length;t++)if(Nz[t].test(a)===!0)return a+"er";return/e$/.test(a)===!0?a+"r":a+"er"}},mCe=function(a){let t={},e=Sz.toSuperlative(a);e&&(t.Superlative=e);let r=Sz.toComparative(a);return r&&(t.Comparative=r),t},B1={a:[[/(antenn|formul|nebul|vertebr|vit)a$/i,"$1ae"],[/([ti])a$/i,"$1a"]],e:[[/(kn|l|w)ife$/i,"$1ives"],[/(hive)$/i,"$1s"],[/([m|l])ouse$/i,"$1ice"],[/([m|l])ice$/i,"$1ice"]],f:[[/^(dwar|handkerchie|hoo|scar|whar)f$/i,"$1ves"],[/^((?:ca|e|ha|(?:our|them|your)?se|she|wo)l|lea|loa|shea|thie)f$/i,"$1ves"]],i:[[/(octop|vir)i$/i,"$1i"]],m:[[/([ti])um$/i,"$1a"]],n:[[/^(oxen)$/i,"$1"]],o:[[/(al|ad|at|er|et|ed|ad)o$/i,"$1oes"]],s:[[/(ax|test)is$/i,"$1es"],[/(alias|status)$/i,"$1es"],[/sis$/i,"ses"],[/(bu)s$/i,"$1ses"],[/(sis)$/i,"ses"],[/^(?!talis|.*hu)(.*)man$/i,"$1men"],[/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,"$1i"]],x:[[/(matr|vert|ind|cort)(ix|ex)$/i,"$1ices"],[/^(ox)$/i,"$1en"]],y:[[/([^aeiouy]|qu)y$/i,"$1ies"]],z:[[/(quiz)$/i,"$1zes"]]},fCe=/(x|ch|sh|s|z)$/,dCe=function(a="",t){let e=t.irregulars.nouns;if(e.hasOwnProperty(a))return e[a];let r=function(n){let i=n[n.length-1];if(B1.hasOwnProperty(i)===!0)for(let s=0;s<B1[i].length;s+=1){let o=B1[i][s][0];if(o.test(n)===!0)return n.replace(o,B1[i][s][1])}return null}(a);return r!==null?r:fCe.test(a)?a+"es":a+"s"},L1=[[/([^v])ies$/i,"$1y"],[/ises$/i,"isis"],[/(kn|[^o]l|w)ives$/i,"$1ife"],[/^((?:ca|e|ha|(?:our|them|your)?se|she|wo)l|lea|loa|shea|thie)ves$/i,"$1f"],[/^(dwar|handkerchie|hoo|scar|whar)ves$/i,"$1f"],[/(antenn|formul|nebul|vertebr|vit)ae$/i,"$1a"],[/(octop|vir|radi|nucle|fung|cact|stimul)(i)$/i,"$1us"],[/(buffal|tomat|tornad)(oes)$/i,"$1o"],[/(eas)es$/i,"$1e"],[/(..[aeiou]s)es$/i,"$1"],[/(vert|ind|cort)(ices)$/i,"$1ex"],[/(matr|append)(ices)$/i,"$1ix"],[/(x|ch|ss|sh|z|o)es$/i,"$1"],[/men$/i,"man"],[/(n)ews$/i,"$1ews"],[/([ti])a$/i,"$1um"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/(s)eries$/i,"$1eries"],[/(m)ovies$/i,"$1ovie"],[/([m|l])ice$/i,"$1ouse"],[/(cris|ax|test)es$/i,"$1is"],[/(alias|status)es$/i,"$1"],[/(ss)$/i,"$1"],[/(ics)$/i,"$1"],[/s$/i,""]],hCe=function(a,t){let e=t.irregulars.nouns,r=(n=e,Object.keys(n).reduce((i,s)=>(i[n[s]]=s,i),{}));var n;if(r.hasOwnProperty(a))return r[a];for(let i=0;i<L1.length;i++)if(L1[i][0].test(a)===!0)return a=a.replace(L1[i][0],L1[i][1]);return a},yCe={Participle:[{reg:/own$/i,to:"ow"},{reg:/(.)un([g|k])$/i,to:"$1in$2"}],Actor:[{reg:/(er)er$/i,to:"$1"}],PresentTense:[{reg:/(..)(ies)$/i,to:"$1y"},{reg:/(tch|sh)es$/i,to:"$1"},{reg:/(ss|zz)es$/i,to:"$1"},{reg:/([tzlshicgrvdnkmu])es$/i,to:"$1e"},{reg:/(n[dtk]|c[kt]|[eo]n|i[nl]|er|a[ytrl])s$/i,to:"$1"},{reg:/(ow)s$/i,to:"$1"},{reg:/(op)s$/i,to:"$1"},{reg:/([eirs])ts$/i,to:"$1t"},{reg:/(ll)s$/i,to:"$1"},{reg:/(el)s$/i,to:"$1"},{reg:/(ip)es$/i,to:"$1e"},{reg:/ss$/i,to:"ss"},{reg:/s$/i,to:""}],Gerund:[{reg:/(..)(p|d|t|g){2}ing$/i,to:"$1$2"},{reg:/(ll|ss|zz)ing$/i,to:"$1"},{reg:/([^aeiou])ying$/i,to:"$1y"},{reg:/([^ae]i.)ing$/i,to:"$1e"},{reg:/(ea[dklnrtv])ing$/i,to:"$1"},{reg:/(ch|sh)ing$/i,to:"$1"},{reg:/(z)ing$/i,to:"$1e"},{reg:/(a[gdkvtc])ing$/i,to:"$1e"},{reg:/(u[rtcbn])ing$/i,to:"$1e"},{reg:/([^o]o[bdknprv])ing$/i,to:"$1e"},{reg:/([tbckg]l)ing$/i,to:"$1e"},{reg:/(c|s)ing$/i,to:"$1e"},{reg:/(..)ing$/i,to:"$1"}],PastTense:[{reg:/(ued)$/i,to:"ue"},{reg:/ea(rn|l|m)ed$/i,to:"ea$1"},{reg:/a([^aeiouy])ed$/i,to:"a$1e"},{reg:/([aeiou]zz)ed$/i,to:"$1"},{reg:/(e|i)lled$/i,to:"$1ll"},{reg:/(.)(sh|ch)ed$/i,to:"$1$2"},{reg:/(tl|gl)ed$/i,to:"$1e"},{reg:/(um?pt?)ed$/i,to:"$1"},{reg:/(ss)ed$/i,to:"$1"},{reg:/pped$/i,to:"p"},{reg:/tted$/i,to:"t"},{reg:/(..)gged$/i,to:"$1g"},{reg:/(..)lked$/i,to:"$1lk"},{reg:/([^aeiouy][aeiou])ked$/i,to:"$1ke"},{reg:/(.[aeiou])led$/i,to:"$1l"},{reg:/(..)(h|ion|n[dt]|ai.|[cs]t|pp|all|ss|tt|int|ail|ld|en|oo.|er|k|pp|w|ou.|rt|ght|rm)ed$/i,to:"$1$2"},{reg:/(.ut)ed$/i,to:"$1e"},{reg:/(.pt)ed$/i,to:"$1"},{reg:/(us)ed$/i,to:"$1e"},{reg:/(dd)ed$/i,to:"$1"},{reg:/(..[^aeiouy])ed$/i,to:"$1e"},{reg:/(..)ied$/i,to:"$1y"},{reg:/(.o)ed$/i,to:"$1o"},{reg:/(..i)ed$/i,to:"$1"},{reg:/(.a[^aeiou])ed$/i,to:"$1"},{reg:/([aeiou][^aeiou])ed$/i,to:"$1e"},{reg:/([rl])ew$/i,to:"$1ow"},{reg:/([pl])t$/i,to:"$1t"}]},U1={Gerund:["ing"],Actor:["erer"],Infinitive:["ate","ize","tion","rify","then","ress","ify","age","nce","ect","ise","ine","ish","ace","ash","ure","tch","end","ack","and","ute","ade","ock","ite","ase","ose","use","ive","int","nge","lay","est","ain","ant","ent","eed","er","le","own","unk","ung","en"],PastTense:["ed","lt","nt","pt","ew","ld"],PresentTense:["rks","cks","nks","ngs","mps","tes","zes","ers","les","acks","ends","ands","ocks","lays","eads","lls","els","ils","ows","nds","ays","ams","ars","ops","ffs","als","urs","lds","ews","ips","es","ts","ns"]};U1=Object.keys(U1).reduce((a,t)=>(U1[t].forEach(e=>a[e]=t),a),{});var uR=yCe,z1=U1,bCe=JNe,wz=aCe,gCe=iCe,vCe=pz,TCe={nouns:{addendum:"addenda",alga:"algae",alumna:"alumnae",alumnus:"alumni",analysis:"analyses",antenna:"antennae",appendix:"appendices",avocado:"avocados",axis:"axes",bacillus:"bacilli",barracks:"barracks",beau:"beaux",bus:"buses",cactus:"cacti",chateau:"chateaux",child:"children",circus:"circuses",clothes:"clothes",corpus:"corpora",criterion:"criteria",curriculum:"curricula",database:"databases",deer:"deer",diagnosis:"diagnoses",echo:"echoes",embargo:"embargoes",epoch:"epochs",foot:"feet",formula:"formulae",fungus:"fungi",genus:"genera",goose:"geese",halo:"halos",hippopotamus:"hippopotami",index:"indices",larva:"larvae",leaf:"leaves",libretto:"libretti",loaf:"loaves",man:"men",matrix:"matrices",memorandum:"memoranda",modulus:"moduli",mosquito:"mosquitoes",mouse:"mice",nebula:"nebulae",nucleus:"nuclei",octopus:"octopi",opus:"opera",ovum:"ova",ox:"oxen",parenthesis:"parentheses",person:"people",phenomenon:"phenomena",prognosis:"prognoses",quiz:"quizzes",radius:"radii",referendum:"referenda",rodeo:"rodeos",sex:"sexes",shoe:"shoes",sombrero:"sombreros",stimulus:"stimuli",stomach:"stomachs",syllabus:"syllabi",synopsis:"synopses",tableau:"tableaux",thesis:"theses",thief:"thieves",tooth:"teeth",tornado:"tornados",tuxedo:"tuxedos",vertebra:"vertebrae"},verbs:oCe},NCe={conjugate:pCe,adjectives:mCe,toPlural:dCe,toSingular:hCe,toInfinitive:function(a,t,e){if(!a)return"";if(t.words.hasOwnProperty(a)===!0){let r=t.irregulars.verbs,n=Object.keys(r);for(let i=0;i<n.length;i++){let s=Object.keys(r[n[i]]);for(let o=0;o<s.length;o++)if(a===r[n[i]][s[o]])return n[i]}}if((e=e||function(r){let n=r.substr(r.length-3);if(z1.hasOwnProperty(n)===!0)return z1[n];let i=r.substr(r.length-2);return z1.hasOwnProperty(i)===!0?z1[i]:r.substr(r.length-1)==="s"?"PresentTense":null}(a))&&uR[e])for(let r=0;r<uR[e].length;r++){let n=uR[e][r];if(n.reg.test(a)===!0)return a.replace(n.reg,n.to)}return a}},Ez=!1,G1=class{constructor(){Object.defineProperty(this,"words",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(this,"hasCompound",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(this,"irregulars",{enumerable:!1,value:TCe,writable:!0}),Object.defineProperty(this,"tags",{enumerable:!1,value:Object.assign({},bCe),writable:!0}),Object.defineProperty(this,"transforms",{enumerable:!1,value:NCe,writable:!0}),Object.defineProperty(this,"taggers",{enumerable:!1,value:[],writable:!0}),Object.defineProperty(this,"cache",{enumerable:!1,value:{abbreviations:{}}}),this.words=wz.buildOut(this),gCe(this)}verbose(t){return Ez=t,this}isVerbose(){return Ez}addWords(t){let e={};Object.keys(t).forEach(r=>{let n=t[r];r=r.toLowerCase().trim(),e[r]=n}),wz.addWords(e,this.words,this)}addConjugations(t){return Object.assign(this.irregulars.verbs,t),this}addPlurals(t){return Object.assign(this.irregulars.nouns,t),this}addTags(t){return t=Object.assign({},t),this.tags=Object.assign(this.tags,t),this.tags=vCe(this.tags),this}postProcess(t){return this.taggers.push(t),this}stats(){return{words:Object.keys(this.words).length,plurals:Object.keys(this.irregulars.nouns).length,conjugations:Object.keys(this.irregulars.verbs).length,compounds:Object.keys(this.hasCompound).length,postProcessors:this.taggers.length}}},Rz=function(a){return JSON.parse(JSON.stringify(a))};G1.prototype.clone=function(){let a=new G1;return a.words=Object.assign({},this.words),a.hasCompound=Object.assign({},this.hasCompound),a.irregulars=Rz(this.irregulars),a.tags=Rz(this.tags),a.transforms=this.transforms,a.taggers=this.taggers,a};var CCe=G1,xz={};(function(a){a.all=function(){return this.parents()[0]||this},a.parent=function(){return this.from?this.from:this},a.parents=function(t){let e=[],r=function(n){n.from&&(e.push(n.from),r(n.from))};return r(this),e=e.reverse(),typeof t=="number"?e[t]:e},a.clone=function(t){let e=this.list.map(r=>r.clone(t));return this.buildFrom(e)},a.wordCount=function(){return this.list.reduce((t,e)=>t+=e.wordCount(),0)},a.wordcount=a.wordCount})(xz);var Vz={};(function(a){a.first=function(t){return t===void 0?this.get(0):this.slice(0,t)},a.last=function(t){if(t===void 0)return this.get(this.list.length-1);let e=this.list.length;return this.slice(e-t,e)},a.slice=function(t,e){let r=this.list.slice(t,e);return this.buildFrom(r)},a.eq=function(t){let e=this.list[t];return e===void 0?this.buildFrom([]):this.buildFrom([e])},a.get=a.eq,a.firstTerms=function(){return this.match("^.")},a.firstTerm=a.firstTerms,a.lastTerms=function(){return this.match(".$")},a.lastTerm=a.lastTerms,a.termList=function(t){let e=[];for(let r=0;r<this.list.length;r++){let n=this.list[r].terms();for(let i=0;i<n.length;i++)if(e.push(n[i]),t!==void 0&&e[t]!==void 0)return e[t]}return e},a.groups=function(t){return t===void 0?function(e){let r={},n={};for(let s=0;s<e.list.length;s++){let o=e.list[s],l=Object.keys(o.groups).map(u=>o.groups[u]);for(let u=0;u<l.length;u++){let{group:c,start:p,length:m}=l[u];n[c]||(n[c]=[]),n[c].push(o.buildFrom(p,m))}}let i=Object.keys(n);for(let s=0;s<i.length;s++){let o=i[s];r[o]=e.buildFrom(n[o])}return r}(this):(typeof t=="number"&&(t=String(t)),function(e,r){let n=[];for(let i=0;i<e.list.length;i++){let s=e.list[i],o=Object.keys(s.groups);o=o.filter(l=>s.groups[l].group===r),o.forEach(l=>{n.push(s.buildFrom(s.groups[l].start,s.groups[l].length))})}return e.buildFrom(n)}(this,t)||this.buildFrom([]))},a.group=a.groups,a.sentences=function(t){let e=[];return this.list.forEach(r=>{e.push(r.fullSentence())}),typeof t=="number"?this.buildFrom([e[t]]):this.buildFrom(e)},a.sentence=a.sentences})(Vz);var Oz={},ACe=function(a,t){if(a._cache&&a._cache.set===!0){let{words:e,tags:r}=function(n){let i=[],s=[];return n.forEach(o=>{o.optional!==!0&&o.negative!==!0&&(o.tag!==void 0&&i.push(o.tag),o.word!==void 0&&s.push(o.word))}),{tags:i,words:s}}(t);for(let n=0;n<e.length;n++)if(a._cache.words[e[n]]===void 0)return!1;for(let n=0;n<r.length;n++)if(a._cache.tags[r[n]]===void 0)return!1}return!0};(function(a){let t=Vd,e=ACe;a.match=function(r,n={}){typeof n!="string"&&typeof n!="number"&&n!==null||(n={group:n});let i=t(r,n);if(i.length===0)return this.buildFrom([]);if(e(this,i)===!1)return this.buildFrom([]);let s=this.list.reduce((o,l)=>o.concat(l.match(i)),[]);return n.group!==void 0&&n.group!==null&&n.group!==""?this.buildFrom(s).groups(n.group):this.buildFrom(s)},a.not=function(r,n={}){let i=t(r,n);if(i.length===0||e(this,i)===!1)return this;let s=this.list.reduce((o,l)=>o.concat(l.not(i)),[]);return this.buildFrom(s)},a.matchOne=function(r,n={}){let i=t(r,n);if(e(this,i)===!1)return this.buildFrom([]);for(let s=0;s<this.list.length;s++){let o=this.list[s].match(i,!0);return this.buildFrom(o)}return this.buildFrom([])},a.if=function(r,n={}){let i=t(r,n);if(e(this,i)===!1)return this.buildFrom([]);let s=this.list.filter(o=>o.has(i)===!0);return this.buildFrom(s)},a.ifNo=function(r,n={}){let i=t(r,n),s=this.list.filter(o=>o.has(i)===!1);return this.buildFrom(s)},a.has=function(r,n={}){let i=t(r,n);return e(this,i)!==!1&&this.list.some(s=>s.has(i)===!0)},a.lookAhead=function(r,n={}){r||(r=".*");let i=t(r,n),s=[];return this.list.forEach(o=>{s=s.concat(o.lookAhead(i))}),s=s.filter(o=>o),this.buildFrom(s)},a.lookAfter=a.lookAhead,a.lookBehind=function(r,n={}){r||(r=".*");let i=t(r,n),s=[];return this.list.forEach(o=>{s=s.concat(o.lookBehind(i))}),s=s.filter(o=>o),this.buildFrom(s)},a.lookBefore=a.lookBehind,a.before=function(r,n={}){let i=t(r,n),s=this.if(i).list.map(o=>{let l=o.terms().map(p=>p.id),u=o.match(i)[0],c=l.indexOf(u.start);return c===0||c===-1?null:o.buildFrom(o.start,c)});return s=s.filter(o=>o!==null),this.buildFrom(s)},a.after=function(r,n={}){let i=t(r,n),s=this.if(i).list.map(o=>{let l=o.terms(),u=l.map(d=>d.id),c=o.match(i)[0],p=u.indexOf(c.start);if(p===-1||!l[p+c.length])return null;let m=l[p+c.length].id,f=o.length-p-c.length;return o.buildFrom(m,f)});return s=s.filter(o=>o!==null),this.buildFrom(s)},a.hasAfter=function(r,n={}){return this.filter(i=>i.lookAfter(r,n).found)},a.hasBefore=function(r,n={}){return this.filter(i=>i.lookBefore(r,n).found)}})(Oz);var Id={},Dz=function(a,t,e,r){let n=[];typeof a=="string"&&(n=a.split(" ")),t.list.forEach(i=>{let s=i.terms();e===!0&&(s=s.filter(o=>o.canBe(a,t.world))),s.forEach((o,l)=>{n.length>1?n[l]&&n[l]!=="."&&o.tag(n[l],r,t.world):o.tag(a,r,t.world)})})};Id.tag=function(a,t){return a?(Dz(a,this,!1,t),this):this},Id.tagSafe=function(a,t){return a?(Dz(a,this,!0,t),this):this},Id.unTag=function(a,t){return this.list.forEach(e=>{e.terms().forEach(r=>r.unTag(a,t,this.world))}),this},Id.canBe=function(a){if(!a)return this;let t=this.world,e=this.list.reduce((r,n)=>r.concat(n.canBe(a,t)),[]);return this.buildFrom(e)};var SCe={map:function(a){if(!a)return this;let t=this.list.map((e,r)=>{let n=this.buildFrom([e]);n.from=null;let i=a(n,r);return i&&i.list&&i.list[0]?i.list[0]:i});return t=t.filter(e=>e),t.length===0?this.buildFrom(t):typeof t[0]!="object"||t[0].isA!=="Phrase"?t:this.buildFrom(t)},forEach:function(a,t){return a?(this.list.forEach((e,r)=>{let n=this.buildFrom([e]);t===!0&&(n.from=null),a(n,r)}),this):this},filter:function(a){if(!a)return this;let t=this.list.filter((e,r)=>{let n=this.buildFrom([e]);return n.from=null,a(n,r)});return this.buildFrom(t)},find:function(a){if(!a)return this;let t=this.list.find((e,r)=>{let n=this.buildFrom([e]);return n.from=null,a(n,r)});return t?this.buildFrom([t]):void 0},some:function(a){return a?this.list.some((t,e)=>{let r=this.buildFrom([t]);return r.from=null,a(r,e)}):this},random:function(a){if(!this.found)return this;let t=Math.floor(Math.random()*this.list.length);if(a===void 0){let e=[this.list[t]];return this.buildFrom(e)}return t+a>this.length&&(t=this.length-a,t=t<0?0:t),this.slice(t,t+a)}},Iz={},wCe=function(a,t,e){let r=function(i,s=[]){let o={};return i.forEach((l,u)=>{let c=!0;s[u]!==void 0&&(c=s[u]);let p=function(m){return m.split(/[ -]/g)}(l=(l=(l||"").toLowerCase()).replace(/[,;.!?]+$/,"")).map(m=>m.trim());o[p[0]]=o[p[0]]||{},p.length===1?o[p[0]].value=c:(o[p[0]].more=o[p[0]].more||[],o[p[0]].more.push({rest:p.slice(1),value:c}))}),o}(a,t),n=[];for(let i=0;i<e.list.length;i++){let s=e.list[i],o=s.terms().map(l=>l.reduced);for(let l=0;l<o.length;l++)r[o[l]]!==void 0&&(r[o[l]].more!==void 0&&r[o[l]].more.forEach(u=>{o[l+u.rest.length]!==void 0&&u.rest.every((c,p)=>c===o[l+p+1])===!0&&n.push({id:s.terms()[l].id,value:u.value,length:u.rest.length+1})}),r[o[l]].value!==void 0&&n.push({id:s.terms()[l].id,value:r[o[l]].value,length:1}))}return n};(function(a){let t=wCe;a.lookup=function(e){let r=[],n=(i=e)&&Object.prototype.toString.call(i)==="[object Object]";var i;n===!0&&(e=Object.keys(e).map(l=>(r.push(e[l]),l))),typeof e=="string"&&(e=[e]),this._cache.set!==!0&&this.cache();let s=t(e,r,this),o=this.list[0];if(n===!0){let l={};return s.forEach(u=>{l[u.value]=l[u.value]||[],l[u.value].push(o.buildFrom(u.id,u.length))}),Object.keys(l).forEach(u=>{l[u]=this.buildFrom(l[u])}),l}return s=s.map(l=>o.buildFrom(l.id,l.length)),this.buildFrom(s)},a.lookUp=a.lookup})(Iz);var ECe={cache:function(a){a=a||{};let t={},e={};return this._cache.words=t,this._cache.tags=e,this._cache.set=!0,this.list.forEach((r,n)=>{r.cache=r.cache||{},r.terms().forEach(i=>{t[i.reduced]&&!t.hasOwnProperty(i.reduced)||(t[i.reduced]=t[i.reduced]||[],t[i.reduced].push(n),Object.keys(i.tags).forEach(s=>{e[s]=e[s]||[],e[s].push(n)}),a.root&&(i.setRoot(this.world),t[i.root]=[n]))})}),this},uncache:function(){return this._cache={},this.list.forEach(a=>{a.cache={}}),this.parents().forEach(a=>{a._cache={},a.list.forEach(t=>{t.cache={}})}),this}},cR={},RCe=Od;cR.replaceWith=function(a,t={}){return a?(t===!0&&(t={keepTags:!0}),t===!1&&(t={keepTags:!1}),t=t||{},this.uncache(),this.list.forEach(e=>{let r,n=a;if(typeof a=="function"&&(n=a(e)),n&&typeof n=="object"&&n.isA==="Doc")r=n.list,this.pool().merge(n.pool());else{if(typeof n!="string")return;{t.keepCase!==!1&&e.terms(0).isTitleCase()&&(n=(i=n).charAt(0).toUpperCase()+i.substr(1)),r=RCe(n,this.world,this.pool());let s=this.buildFrom(r);s.tagger(),r=s.list}}var i;if(t.keepTags===!0){let s=e.json({terms:{tags:!0}}).terms;r[0].terms().forEach((o,l)=>{s[l]&&o.tagSafe(s[l].tags,"keptTag",this.world)})}e.replace(r[0],this)}),this):this.delete()},cR.replace=function(a,t,e){return t===void 0?this.replaceWith(a,e):(this.match(a).replaceWith(t,e),this)};var Pz={};(function(a){let t=Od,e=function(n){return n&&Object.prototype.toString.call(n)==="[object Object]"},r=function(n,i){let s=t(n,i.world)[0],o=i.buildFrom([s]);return o.tagger(),i.list=o.list,i};a.append=function(n=""){return n?this.found?(this.uncache(),this.list.forEach(i=>{let s;e(n)&&n.isA==="Doc"?s=n.list[0].clone():typeof n=="string"&&(s=t(n,this.world,this.pool())[0]),this.buildFrom([s]).tagger(),i.append(s,this)}),this):r(n,this):this},a.insertAfter=a.append,a.insertAt=a.append,a.prepend=function(n){return n?this.found?(this.uncache(),this.list.forEach(i=>{let s;e(n)&&n.isA==="Doc"?s=n.list[0].clone():typeof n=="string"&&(s=t(n,this.world,this.pool())[0]),this.buildFrom([s]).tagger(),i.prepend(s,this)}),this):r(n,this):this},a.insertBefore=a.prepend,a.concat=function(){this.uncache();let n=this.list.slice(0);for(let i=0;i<arguments.length;i++){let s=arguments[i];if(typeof s=="string"){let o=t(s,this.world);n=n.concat(o)}else s.isA==="Doc"?n=n.concat(s.list):s.isA==="Phrase"&&n.push(s)}return this.buildFrom(n)},a.delete=function(n){this.uncache();let i=this;return n&&(i=this.match(n)),i.list.forEach(s=>s.delete(this)),this},a.remove=a.delete})(Pz);var _z={},xCe={clean:!0,reduced:!0,root:!0};_z.text=function(a){a=a||{};let t=!1;this.parents().length===0&&(t=!0),(a==="root"||typeof a=="object"&&a.root)&&this.list.forEach(r=>{r.terms().forEach(n=>{n.root===null&&n.setRoot(this.world)})});let e=this.list.reduce((r,n,i)=>{let s=!t&&i===0,o=!t&&i===this.list.length-1;return r+n.text(a,s,o)},"");return xCe[a]!==!0&&a.reduced!==!0&&a.clean!==!0&&a.root!==!0||(e=e.trim()),e};var kz={},VCe=function(a,t,e){let r=function(n){let i=0,s=0,o={};return n.termList().forEach(l=>{o[l.id]={index:s,start:i+l.pre.length,length:l.text.length},i+=l.pre.length+l.text.length+l.post.length,s+=1}),o}(a.all());(e.terms.index||e.index)&&t.forEach(n=>{n.terms.forEach(i=>{i.index=r[i.id].index}),n.index=n.terms[0].index}),(e.terms.offset||e.offset)&&t.forEach(n=>{n.terms.forEach(i=>{i.offset=r[i.id]||{}}),n.offset={index:n.terms[0].offset.index,start:n.terms[0].offset.start-n.text.indexOf(n.terms[0].text),length:n.text.length}})};(function(a){let t=VCe,e={text:!0,terms:!0,trim:!0};a.json=function(r={}){if(typeof r=="number"&&this.list[r])return this.list[r].json(e);(r=function(i){return(i=Object.assign({},e,i)).unique&&(i.reduced=!0),i.offset&&(i.text=!0,i.terms&&i.terms!==!0||(i.terms={}),i.terms.offset=!0),(i.index||i.terms.index)&&(i.terms=i.terms===!0?{}:i.terms,i.terms.id=!0),i}(r)).root===!0&&this.list.forEach(i=>{i.terms().forEach(s=>{s.root===null&&s.setRoot(this.world)})});let n=this.list.map(i=>i.json(r,this.world));if((r.terms.offset||r.offset||r.terms.index||r.index)&&t(this,n,r),r.frequency||r.freq||r.count){let i={};this.list.forEach(s=>{let o=s.text("reduced");i[o]=i[o]||0,i[o]+=1}),this.list.forEach((s,o)=>{n[o].count=i[s.text("reduced")]})}if(r.unique){let i={};n=n.filter(s=>i[s.reduced]!==!0&&(i[s.reduced]=!0,!0))}return n},a.data=a.json})(kz);var pR={},Fz={exports:{}};(function(a){let t="[0m",e=function(i,s){for(i=i.toString();i.length<s;)i+=" ";return i},r={green:"#7f9c6c",red:"#914045",blue:"#6699cc",magenta:"#6D5685",cyan:"#2D85A8",yellow:"#e6d7b3",black:"#303b50"},n={green:function(i){return"[32m"+i+t},red:function(i){return"[31m"+i+t},blue:function(i){return"[34m"+i+t},magenta:function(i){return"[35m"+i+t},cyan:function(i){return"[36m"+i+t},yellow:function(i){return"[33m"+i+t},black:function(i){return"[30m"+i+t}};Fz.exports=function(i){return typeof window!="undefined"&&window.document?(function(s){let o=s.world.tags;s.list.forEach(l=>{console.log(`
%c"`+l.text()+'"',"color: #e6d7b3;"),l.terms().forEach(u=>{let c=Object.keys(u.tags),p=u.text||"-";u.implicit&&(p="["+u.implicit+"]");let m="'"+p+"'";m=e(m,8);let f=c.find(h=>o[h]&&o[h].color),d="steelblue";o[f]&&(d=o[f].color,d=r[d]),console.log(`   ${m}  -  %c${c.join(", ")}`,`color: ${d||"steelblue"};`)})})}(i),i):(console.log(n.blue("=====")),i.list.forEach(s=>{console.log(n.blue("  -----")),s.terms().forEach(o=>{let l=Object.keys(o.tags),u=o.text||"-";o.implicit&&(u="["+o.implicit+"]"),u=n.yellow(u);let c="'"+u+"'";c=e(c,18);let p=n.blue("  \uFF5C ")+c+"  - "+function(m,f){return(m=m.map(d=>{if(!f.tags.hasOwnProperty(d))return d;let h=f.tags[d].color||"blue";return n[h](d)})).join(", ")}(l,i.world);console.log(p)})}),console.log(""),i)}})();var jz=Fz.exports,OCe=function(a){let t=a.json({text:!1,terms:!1,reduced:!0}),e={};t.forEach(n=>{e[n.reduced]||(n.count=0,e[n.reduced]=n),e[n.reduced].count+=1});let r=Object.keys(e).map(n=>e[n]);return r.sort((n,i)=>n.count>i.count?-1:n.count<i.count?1:0),r};pR.debug=function(){return jz(this),this},pR.out=function(a){if(a==="text")return this.text();if(a==="normal")return this.text("normal");if(a==="json")return this.json();if(a==="offset"||a==="offsets")return this.json({offset:!0});if(a==="array")return this.json({terms:!1}).map(t=>t.text).filter(t=>t);if(a==="freq"||a==="frequency")return OCe(this);if(a==="terms"){let t=[];return this.json({text:!1,terms:{text:!0}}).forEach(e=>{let r=e.terms.map(n=>n.text);r=r.filter(n=>n),t=t.concat(r)}),t}return a==="tags"?this.list.map(t=>t.terms().reduce((e,r)=>(e[r.clean||r.implicit]=Object.keys(r.tags),e),{})):a==="debug"?(jz(this),this):this.text()};var H1={},Pd={alpha:(a,t)=>{let e=a.text("clean"),r=t.text("clean");return e<r?-1:e>r?1:0},length:(a,t)=>{let e=a.text().trim().length,r=t.text().trim().length;return e<r?1:e>r?-1:0},wordCount:(a,t)=>{let e=a.wordCount(),r=t.wordCount();return e<r?1:e>r?-1:0}};Pd.alphabetical=Pd.alpha,Pd.wordcount=Pd.wordCount;var DCe={index:!0,sequence:!0,seq:!0,sequential:!0,chron:!0,chronological:!0};H1.sort=function(a){return(a=a||"alpha")==="freq"||a==="frequency"||a==="topk"?function(t){let e={},r={case:!0,punctuation:!1,whitespace:!0,unicode:!0};return t.list.forEach(n=>{let i=n.text(r);e[i]=e[i]||0,e[i]+=1}),t.list.sort((n,i)=>{let s=e[n.text(r)],o=e[i.text(r)];return s<o?1:s>o?-1:0}),t}(this):DCe.hasOwnProperty(a)?function(t){let e={};return t.json({terms:{offset:!0}}).forEach(r=>{e[r.terms[0].id]=r.terms[0].offset.start}),t.list=t.list.sort((r,n)=>e[r.start]>e[n.start]?1:e[r.start]<e[n.start]?-1:0),t}(this):typeof(a=Pd[a]||a)=="function"?(this.list=this.list.sort(a),this):this},H1.reverse=function(){let a=[].concat(this.list);return a=a.reverse(),this.buildFrom(a)},H1.unique=function(){let a=[].concat(this.list),t={};return a=a.filter(e=>{let r=e.text("reduced").trim()||e.text("implicit").trim();return t.hasOwnProperty(r)!==!0&&(t[r]=!0,!0)}),this.buildFrom(a)};var Mz={},ICe=QE,Bz=/[\[\]{}:,\-;\/*\^%=~|]/g,Lz=/['"]+/g,Sp={whitespace:function(a){let t=a.list.map(e=>e.terms());t.forEach((e,r)=>{e.forEach((n,i)=>{n.hasDash()!==!0?(n.pre=n.pre.replace(/\s/g,""),n.post=n.post.replace(/\s/g,""),(e.length-1!==i||t[r+1])&&(n.implicit&&Boolean(n.text)===!0||n.hasHyphen()!==!0&&(n.post+=" "))):n.post=" - "})})},punctuation:function(a){a.forEach(t=>{t.hasHyphen()===!0&&(t.post=" "),t.pre=t.pre.replace(Bz,""),t.post=t.post.replace(Bz,""),t.post=t.post.replace(/\.\.\./,""),/!/.test(t.post)===!0&&(t.post=t.post.replace(/!/g,""),t.post="!"+t.post),/\?/.test(t.post)===!0&&(t.post=t.post.replace(/[\?!]*/,""),t.post="?"+t.post)})},unicode:function(a){a.forEach(t=>{t.isImplicit()!==!0&&(t.text=ICe(t.text))})},quotations:function(a){a.forEach(t=>{t.post=t.post.replace(Lz,""),t.pre=t.pre.replace(Lz,"")})},adverbs:function(a){a.match("#Adverb").not("(not|nary|seldom|never|barely|almost|basically|so)").remove()},abbreviations:function(a){a.list.forEach(t=>{let e=t.terms();e.forEach((r,n)=>{r.tags.Abbreviation===!0&&e[n+1]&&(r.post=r.post.replace(/^\./,""))})})}},PCe={whitespace:!0,unicode:!0,punctuation:!0,emoji:!0,acronyms:!0,abbreviations:!0,case:!1,contractions:!1,parentheses:!1,quotations:!1,adverbs:!1,possessives:!1,verbs:!1,nouns:!1,honorifics:!1},mR={light:{},medium:{case:!0,contractions:!0,parentheses:!0,quotations:!0,adverbs:!0}};mR.heavy=Object.assign({},mR.medium,{possessives:!0,verbs:!0,nouns:!0,honorifics:!0}),Mz.normalize=function(a){typeof(a=a||{})=="string"&&(a=mR[a]||{}),a=Object.assign({},PCe,a),this.uncache();let t=this.termList();return a.case&&this.toLowerCase(),a.whitespace&&Sp.whitespace(this),a.unicode&&Sp.unicode(t),a.punctuation&&Sp.punctuation(t),a.emoji&&this.remove("(#Emoji|#Emoticon)"),a.acronyms&&this.acronyms().strip(),a.abbreviations&&Sp.abbreviations(this),(a.contraction||a.contractions)&&this.contractions().expand(),a.parentheses&&this.parentheses().unwrap(),(a.quotations||a.quotes)&&Sp.quotations(t),a.adverbs&&Sp.adverbs(this),(a.possessive||a.possessives)&&this.possessives().strip(),a.verbs&&this.verbs().toInfinitive(),(a.nouns||a.plurals)&&this.nouns().toSingular(),a.honorifics&&this.remove("#Honorific"),this};var Uz={};(function(a){let t=Vd;a.splitOn=function(e){if(!e)return this.parent().splitOn(this);let r=t(e),n=[];return this.list.forEach(i=>{let s=i.match(r);if(s.length===0)return void n.push(i);let o=i;s.forEach(l=>{let u=o.splitOn(l);u.before&&n.push(u.before),u.match&&n.push(u.match),o=u.after}),o&&n.push(o)}),this.buildFrom(n)},a.splitAfter=function(e){if(!e)return this.parent().splitAfter(this);let r=t(e),n=[];return this.list.forEach(i=>{let s=i.match(r);if(s.length===0)return void n.push(i);let o=i;s.forEach(l=>{let u=o.splitOn(l);u.before&&u.match?(u.before.length+=u.match.length,n.push(u.before)):u.match&&n.push(u.match),o=u.after}),o&&n.push(o)}),this.buildFrom(n)},a.split=a.splitAfter,a.splitBefore=function(e){if(!e)return this.parent().splitBefore(this);let r=t(e),n=[];return this.list.forEach(i=>{let s=i.match(r);if(s.length===0)return void n.push(i);let o=i;s.forEach(l=>{let u=o.splitOn(l);u.before&&n.push(u.before),u.match&&u.after&&(u.match.length+=u.after.length),o=u.match}),o&&n.push(o)}),this.buildFrom(n)},a.segment=function(e,r){e=e||{},r=r||{text:!0};let n=this,i=Object.keys(e);return i.forEach(s=>{n=n.splitOn(s)}),n.list.forEach(s=>{for(let o=0;o<i.length;o+=1)if(s.has(i[o]))return void(s.segment=e[i[o]])}),n.list.map(s=>{let o=s.json(r);return o.segment=s.segment||null,o})}})(Uz);var _d={},fR=function(a,t){let e=a.world;return a.list.forEach(r=>{r.terms().forEach(n=>n[t](e))}),a};_d.toLowerCase=function(){return fR(this,"toLowerCase")},_d.toUpperCase=function(){return fR(this,"toUpperCase")},_d.toTitleCase=function(){return fR(this,"toTitleCase")},_d.toCamelCase=function(){return this.list.forEach(a=>{let t=a.terms();t.forEach((e,r)=>{r!==0&&e.toTitleCase(),r!==t.length-1&&(e.post="")})}),this};var zz={};(function(a){a.pre=function(t,e){return t===void 0?this.list[0].terms(0).pre:(this.list.forEach(r=>{let n=r.terms(0);e===!0?n.pre+=t:n.pre=t}),this)},a.post=function(t,e){return t===void 0?this.list.map(r=>{let n=r.terms();return n[n.length-1].post}):(this.list.forEach(r=>{let n=r.terms(),i=n[n.length-1];e===!0?i.post+=t:i.post=t}),this)},a.trim=function(){return this.list=this.list.map(t=>t.trim()),this},a.hyphenate=function(){return this.list.forEach(t=>{let e=t.terms();e.forEach((r,n)=>{n!==0&&(r.pre=""),e[n+1]&&(r.post="-")})}),this},a.dehyphenate=function(){let t=/(-||)/;return this.list.forEach(e=>{e.terms().forEach(r=>{t.test(r.post)&&(r.post=" ")})}),this},a.deHyphenate=a.dehyphenate,a.toQuotations=function(t,e){return t=t||'"',e=e||'"',this.list.forEach(r=>{let n=r.terms();n[0].pre=t+n[0].pre;let i=n[n.length-1];i.post=e+i.post}),this},a.toQuotation=a.toQuotations,a.toParentheses=function(t,e){return t=t||"(",e=e||")",this.list.forEach(r=>{let n=r.terms();n[0].pre=t+n[0].pre;let i=n[n.length-1];i.post=e+i.post}),this}})(zz);var _Ce={join:function(a){this.uncache();let t=this.list[0],e=t.length,r={};for(let i=1;i<this.list.length;i++){let s=this.list[i];r[s.start]=!0;let o=t.lastTerm();a&&(o.post+=a),o.next=s.start,s.terms(0).prev=o.id,t.length+=s.length,t.cache={}}let n=t.length-e;return this.parents().forEach(i=>{i.list.forEach(s=>{let o=s.terms();for(let l=0;l<o.length;l++)if(o[l].id===t.start){s.length+=n;break}s.cache={}}),i.list=i.list.filter(s=>r[s.start]!==!0)}),this.buildFrom([t])}},Gz={},kCe=/[,\)"';:\-\.]/,us=function(a,t){if(!a.found)return;let e=a.termList();for(let r=0;r<e.length-1;r++){let n=e[r];if(kCe.test(n.post))return}e.forEach(r=>{r.implicit=r.clean}),e[0].text+=t,e.slice(1).forEach(r=>{r.text=""});for(let r=0;r<e.length-1;r++){let n=e[r];n.post=n.post.replace(/ /,"")}};Gz.contract=function(){let a=this.not("@hasContraction"),t=a.match("(we|they|you) are");return us(t,"'re"),t=a.match("(he|she|they|it|we|you) will"),us(t,"'ll"),t=a.match("(he|she|they|it|we) is"),us(t,"'s"),t=a.match("#Person is"),us(t,"'s"),t=a.match("#Person would"),us(t,"'d"),t=a.match("(is|was|had|would|should|could|do|does|have|has|can) not"),us(t,"n't"),t=a.match("(i|we|they) have"),us(t,"'ve"),t=a.match("(would|should|could) have"),us(t,"'ve"),t=a.match("i am"),us(t,"'m"),t=a.match("going to"),this};var FCe=Object.assign({},xz,Vz,Oz,Id,SCe,Iz,ECe,cR,Pz,_z,kz,pR,H1,Mz,Uz,_d,zz,_Ce,Gz),Ir={};[["terms","."],["hyphenated","@hasHyphen ."],["adjectives","#Adjective"],["hashTags","#HashTag"],["emails","#Email"],["emoji","#Emoji"],["emoticons","#Emoticon"],["atMentions","#AtMention"],["urls","#Url"],["adverbs","#Adverb"],["pronouns","#Pronoun"],["conjunctions","#Conjunction"],["prepositions","#Preposition"]].forEach(a=>{Ir[a[0]]=function(t){let e=this.match(a[1]);return typeof t=="number"&&(e=e.get(t)),e}}),Ir.emojis=Ir.emoji,Ir.atmentions=Ir.atMentions,Ir.words=Ir.terms,Ir.phoneNumbers=function(a){let t=this.splitAfter("@hasComma");return t=t.match("#PhoneNumber+"),typeof a=="number"&&(t=t.get(a)),t},Ir.money=function(a){let t=this.match("#Money #Currency?");return typeof a=="number"&&(t=t.get(a)),t},Ir.places=function(a){let t=this.match("(#City && @hasComma) (#Region|#Country)"),e=this.not(t).splitAfter("@hasComma");return e=e.concat(t),e.sort("index"),e=e.match("#Place+"),typeof a=="number"&&(e=e.get(a)),e},Ir.organizations=function(a){let t=this.clauses();return t=t.match("#Organization+"),typeof a=="number"&&(t=t.get(a)),t},Ir.entities=function(a){let t=this.clauses(),e=t.people();return e=e.concat(t.places()),e=e.concat(t.organizations()),e=e.not(["someone","man","woman","mother","brother","sister","father"]),e.sort("sequence"),typeof a=="number"&&(e=e.get(a)),e},Ir.things=Ir.entities,Ir.topics=Ir.entities;var Hz=Ir,jCe=/^(under|over)-?.{3}/,MCe=function(a,t,e){let r=e.words,n=a[t].reduced+" "+a[t+1].reduced;return r[n]!==void 0&&r.hasOwnProperty(n)===!0?(a[t].tag(r[n],"lexicon-two",e),a[t+1].tag(r[n],"lexicon-two",e),1):t+2<a.length&&(n+=" "+a[t+2].reduced,r[n]!==void 0&&r.hasOwnProperty(n)===!0)?(a[t].tag(r[n],"lexicon-three",e),a[t+1].tag(r[n],"lexicon-three",e),a[t+2].tag(r[n],"lexicon-three",e),2):t+3<a.length&&(n+=" "+a[t+3].reduced,r[n]!==void 0&&r.hasOwnProperty(n)===!0)?(a[t].tag(r[n],"lexicon-four",e),a[t+1].tag(r[n],"lexicon-four",e),a[t+2].tag(r[n],"lexicon-four",e),a[t+3].tag(r[n],"lexicon-four",e),3):0},dR=function(a,t){let e=t.words,r=t.hasCompound;for(let n=0;n<a.length;n+=1){let i=a[n].clean;if(r[i]===!0&&n+1<a.length){let s=MCe(a,n,t);if(s>0){n+=s;continue}}if(e[i]===void 0||e.hasOwnProperty(i)!==!0)if(i===a[n].reduced||e.hasOwnProperty(a[n].reduced)!==!0){if(jCe.test(i)===!0){let s=i.replace(/^(under|over)-?/,"");e.hasOwnProperty(s)===!0&&a[n].tag(e[s],"noprefix-lexicon",t)}}else a[n].tag(e[a[n].reduced],"lexicon",t);else a[n].tag(e[i],"lexicon",t)}return a},hR=/[\'`]$/,BCe=/^(m|k|cm|km|m)\/(s|h|hr)$/,yR=[[/^[\w\.]+@[\w\.]+\.[a-z]{2,3}$/,"Email"],[/^#[a-z0-9_\u00C0-\u00FF]{2,}$/,"HashTag"],[/^@1?[0-9](am|pm)$/i,"Time"],[/^@1?[0-9]:[0-9]{2}(am|pm)?$/i,"Time"],[/^@\w{2,}$/,"AtMention"],[/^(https?:\/\/|www\.)+\w+\.[a-z]{2,3}/,"Url"],[/^[a-z0-9./].+\.(com|net|gov|org|ly|edu|info|biz|dev|ru|jp|de|in|uk|br|io|ai)/,"Url"],[/^'[0-9]{2}$/,"Year"],[/^[012]?[0-9](:[0-5][0-9])(:[0-5][0-9])$/,"Time"],[/^[012]?[0-9](:[0-5][0-9])?(:[0-5][0-9])? ?(am|pm)$/i,"Time"],[/^[012]?[0-9](:[0-5][0-9])(:[0-5][0-9])? ?(am|pm)?$/i,"Time"],[/^[PMCE]ST$/,"Time"],[/^utc ?[+-]?[0-9]+?$/,"Time"],[/^[a-z0-9]*? o\'?clock$/,"Time"],[/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}/i,"Date"],[/^[0-9]{1,4}-[0-9]{1,2}-[0-9]{1,4}$/,"Date"],[/^[0-9]{1,4}\/[0-9]{1,2}\/[0-9]{1,4}$/,"Date"],[/^[0-9]{1,4}-[a-z]{2,9}-[0-9]{1,4}$/i,"Date"],[/^gmt[+-][0-9][0-9]?$/i,"Timezone"],[/^utc[+-][0-9][0-9]?$/i,"Timezone"],[/^ma?c\'.*/,"LastName"],[/^o\'[drlkn].*/,"LastName"],[/^ma?cd[aeiou]/,"LastName"],[/^(lol)+[sz]$/,"Expression"],[/^woo+a*?h?$/,"Expression"],[/^(un|de|re)\\-[a-z\u00C0-\u00FF]{2}/,"Verb"],[/^[0-9]{1,4}\.[0-9]{1,2}\.[0-9]{1,4}$/,"Date"],[/^[0-9]{3}-[0-9]{4}$/,"PhoneNumber"],[/^(\+?[0-9][ -])?[0-9]{3}[ -]?[0-9]{3}-[0-9]{4}$/,"PhoneNumber"],[/^[-+]?[\$\xA2-\xA5\u058F\u060B\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u20A0-\u20BD\uA838\uFDFC\uFE69\uFF04\uFFE0\uFFE1\uFFE5\uFFE6][-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?(k|m|b|bn)?\+?$/,["Money","Value"]],[/^[-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?[\$\xA2-\xA5\u058F\u060B\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u20A0-\u20BD\uA838\uFDFC\uFE69\uFF04\uFFE0\uFFE1\uFFE5\uFFE6]\+?$/,["Money","Value"]],[/^[-+]?[\$]?[0-9]([0-9,.])+?(usd|eur|jpy|gbp|cad|aud|chf|cny|hkd|nzd|kr|rub)$/i,["Money","Value"]],[/^[-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?\+?$/,["Cardinal","NumericValue"]],[/^[-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?(st|nd|rd|r?th)$/,["Ordinal","NumericValue"]],[/^\.[0-9]+\+?$/,["Cardinal","NumericValue"]],[/^[-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?%\+?$/,["Percent","Cardinal","NumericValue"]],[/^\.[0-9]+%$/,["Percent","Cardinal","NumericValue"]],[/^[0-9]{1,4}\/[0-9]{1,4}(st|nd|rd|th)?s?$/,["Fraction","NumericValue"]],[/^[0-9.]{1,3}[a-z]{0,2}[-][0-9]{1,3}[a-z]{0,2}$/,["Value","NumberRange"]],[/^[0-9][0-9]?(:[0-9][0-9])?(am|pm)? ?[-] ?[0-9][0-9]?(:[0-9][0-9])?(am|pm)?$/,["Time","NumberRange"]],[/^[0-9.]+([a-z]{1,4})$/,"Value"]],LCe=/^[IVXLCDM]{2,}$/,UCe=/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,Tt="Adjective",q1="Infinitive",W1="PresentTense",cs="Singular",sn="PastTense",ps="Expression",Gr="Adjective",kd="Infinitive",Rl="PresentTense",wp="Singular",An="PastTense",xl="Adverb",ms="Plural",$1="Verb",wa="LastName",qz={a:[[/.[aeiou]na$/,"Noun"],[/.[oau][wvl]ska$/,"LastName"],[/.[^aeiou]ica$/,cs],[/^([hyj]a)+$/,ps]],c:[[/.[^aeiou]ic$/,Tt]],d:[[/[aeiou](pp|ll|ss|ff|gg|tt|rr|bb|nn|mm)ed$/,sn],[/.[aeo]{2}[bdgmnprvz]ed$/,sn],[/.[aeiou][sg]hed$/,sn],[/.[aeiou]red$/,sn],[/.[aeiou]r?ried$/,sn],[/.[bcdgtr]led$/,sn],[/.[aoui]f?led$/,sn],[/.[iao]sed$/,sn],[/[aeiou]n?[cs]ed$/,sn],[/[aeiou][rl]?[mnf]ed$/,sn],[/[aeiou][ns]?c?ked$/,sn],[/[aeiou][nl]?ged$/,sn],[/.[tdbwxz]ed$/,sn],[/[^aeiou][aeiou][tvx]ed$/,sn],[/.[cdlmnprstv]ied$/,sn],[/[^aeiou]ard$/,cs],[/[aeiou][^aeiou]id$/,Tt],[/.[vrl]id$/,Tt]],e:[[/.[lnr]ize$/,q1],[/.[^aeiou]ise$/,q1],[/.[aeiou]te$/,q1],[/.[^aeiou][ai]ble$/,Tt],[/.[^aeiou]eable$/,Tt],[/.[ts]ive$/,Tt],[/[a-z]-like$/,Tt]],h:[[/.[^aeiouf]ish$/,Tt],[/.v[iy]ch$/,"LastName"],[/^ug?h+$/,ps],[/^uh[ -]?oh$/,ps],[/[a-z]-ish$/,Tt]],i:[[/.[oau][wvl]ski$/,"LastName"]],k:[[/^(k){2}$/,ps]],l:[[/.[gl]ial$/,Tt],[/.[^aeiou]ful$/,Tt],[/.[nrtumcd]al$/,Tt],[/.[^aeiou][ei]al$/,Tt]],m:[[/.[^aeiou]ium$/,cs],[/[^aeiou]ism$/,cs],[/^h*u*m+$/,ps],[/^\d+ ?[ap]m$/,"Date"]],n:[[/.[lsrnpb]ian$/,Tt],[/[^aeiou]ician$/,"Actor"],[/[aeiou][ktrp]in$/,"Gerund"]],o:[[/^no+$/,ps],[/^(yo)+$/,ps],[/^woo+[pt]?$/,ps]],r:[[/.[bdfklmst]ler$/,"Noun"],[/[aeiou][pns]er$/,cs],[/[^i]fer$/,q1],[/.[^aeiou][ao]pher$/,"Actor"],[/.[lk]er$/,"Noun"],[/.ier$/,"Comparative"]],t:[[/.[di]est$/,"Superlative"],[/.[icldtgrv]ent$/,Tt],[/[aeiou].*ist$/,Tt],[/^[a-z]et$/,"Verb"]],s:[[/.[^aeiou]ises$/,W1],[/.[rln]ates$/,W1],[/.[^z]ens$/,"Verb"],[/.[lstrn]us$/,cs],[/.[aeiou]sks$/,W1],[/.[aeiou]kes$/,W1],[/[aeiou][^aeiou]is$/,cs],[/[a-z]\'s$/,"Noun"],[/^yes+$/,ps]],v:[[/.[^aeiou][ai][kln]ov$/,"LastName"]],y:[[/.[cts]hy$/,Tt],[/.[st]ty$/,Tt],[/.[gk]y$/,Tt],[/.[tnl]ary$/,Tt],[/.[oe]ry$/,cs],[/[rdntkbhs]ly$/,"Adverb"],[/...lly$/,"Adverb"],[/[bszmp]{2}y$/,Tt],[/.(gg|bb|zz)ly$/,Tt],[/.[ai]my$/,Tt],[/[ea]{2}zy$/,Tt],[/.[^aeiou]ity$/,cs]]},Wz=[null,null,{ea:wp,ia:"Noun",ic:Gr,ly:xl,"'n":$1,"'t":$1},{oed:An,ued:An,xed:An," so":xl,"'ll":"Modal","'re":"Copula",azy:Gr,eer:"Noun",end:$1,ped:An,ffy:Gr,ify:kd,ing:"Gerund",ize:kd,lar:Gr,mum:Gr,nes:Rl,nny:Gr,oid:Gr,ous:Gr,que:Gr,rol:wp,sis:wp,zes:Rl},{amed:An,aped:An,ched:An,lked:An,nded:An,cted:An,dged:An,akis:wa,cede:kd,chuk:wa,czyk:wa,ects:Rl,ends:$1,enko:wa,ette:wp,fies:Rl,fore:xl,gate:kd,gone:Gr,ices:ms,ints:ms,ines:ms,ions:ms,less:xl,llen:Gr,made:Gr,nsen:wa,oses:Rl,ould:"Modal",some:Gr,sson:wa,tage:kd,teen:"Value",tion:wp,tive:Gr,tors:"Noun",vice:wp},{tized:An,urned:An,eased:An,ances:ms,bound:Gr,ettes:ms,fully:xl,ishes:Rl,ities:ms,marek:wa,nssen:wa,ology:"Noun",ports:ms,rough:Gr,tches:Rl,tieth:"Ordinal",tures:ms,wards:xl,where:xl},{auskas:wa,keeper:"Actor",logist:"Actor",teenth:"Value"},{opoulos:wa,borough:"Place",sdottir:wa}],zCe=/^(\u00a9|\u00ae|[\u2319-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/,GCe={":(":!0,":)":!0,":P":!0,":p":!0,":O":!0,":3":!0,":|":!0,":/":!0,":\\":!0,":$":!0,":*":!0,":@":!0,":-(":!0,":-)":!0,":-P":!0,":-p":!0,":-O":!0,":-3":!0,":-|":!0,":-/":!0,":-\\":!0,":-$":!0,":-*":!0,":-@":!0,":^(":!0,":^)":!0,":^P":!0,":^p":!0,":^O":!0,":^3":!0,":^|":!0,":^/":!0,":^\\":!0,":^$":!0,":^*":!0,":^@":!0,"):":!0,"(:":!0,"$:":!0,"*:":!0,")-:":!0,"(-:":!0,"$-:":!0,"*-:":!0,")^:":!0,"(^:":!0,"$^:":!0,"*^:":!0,"<3":!0,"</3":!0,"<\\3":!0},Fd={lexicon:dR,punctuation:function(a,t,e){let r=a[t];if(hR.test(r.text)&&!hR.test(r.pre)&&!hR.test(r.post)&&r.clean.length>2){let n=r.clean[r.clean.length-2];if(n==="s")return void r.tag(["Possessive","Noun"],"end-tick",e);n==="n"&&r.tag(["Gerund"],"chillin",e)}BCe.test(r.text)&&r.tag("Unit","per-sec",e)},regex:function(a,t){let e=a.text;for(let r=0;r<yR.length;r+=1)if(yR[r][0].test(e)===!0){a.tagSafe(yR[r][1],"prefix #"+r,t);break}a.text.length>=2&&LCe.test(e)&&UCe.test(e)&&a.tag("RomanNumeral","xvii",t)},suffix:function(a,t){(function(e,r){let n=e.clean.length,i=7;n<=i&&(i=n-1);for(let s=i;s>1;s-=1){let o=e.clean.substr(n-s,n);if(Wz[o.length].hasOwnProperty(o)===!0){let l=Wz[o.length][o];e.tagSafe(l,"suffix -"+o,r);break}}})(a,t),function(e,r){let n=e.clean,i=n[n.length-1];if(qz.hasOwnProperty(i)===!0){let s=qz[i];for(let o=0;o<s.length;o+=1)if(s[o][0].test(n)===!0){e.tagSafe(s[o][1],`endReg ${i} #${o}`,r);break}}}(a,t)},emoji:(a,t)=>{let e=a.pre+a.text+a.post;var r;e=e.trim(),e=e.replace(/[.!?,]$/,""),(n=>!(n.charAt(0)!==":"||n.match(/:.?$/)===null||n.match(" ")||n.length>35))(e)===!0&&(a.tag("Emoji","comma-emoji",t),a.text=e,a.pre=a.pre.replace(":",""),a.post=a.post.replace(":","")),a.text.match(zCe)&&(a.tag("Emoji","unicode-emoji",t),a.text=e),r=(r=e).replace(/^[:;]/,":"),GCe.hasOwnProperty(r)===!0&&(a.tag("Emoticon","emoticon-emoji",t),a.text=e)}},HCe=function(a,t){let e=a.world;Fd.lexicon(t,e);for(let r=0;r<t.length;r+=1){let n=t[r];Fd.punctuation(t,r,e),Fd.regex(n,e),Fd.suffix(n,e),Fd.emoji(n,e)}return a},ao={beforeThisWord:{there:"Verb",me:"Verb",man:"Adjective",only:"Verb",him:"Verb",were:"Noun",took:"Noun",himself:"Verb",went:"Noun",who:"Noun",jr:"Person"},afterThisWord:{i:"Verb",first:"Noun",it:"Verb",there:"Verb",not:"Verb",because:"Noun",if:"Noun",but:"Noun",who:"Verb",this:"Noun",his:"Noun",when:"Noun",you:"Verb",very:"Adjective",old:"Noun",never:"Verb",before:"Noun"},beforeThisPos:{Copula:"Noun",PastTense:"Noun",Conjunction:"Noun",Modal:"Noun",Pluperfect:"Noun",PerfectTense:"Verb"},afterThisPos:{Adjective:"Noun",Possessive:"Noun",Determiner:"Noun",Adverb:"Verb",Pronoun:"Verb",Value:"Noun",Ordinal:"Noun",Modal:"Verb",Superlative:"Noun",Demonym:"Noun",Honorific:"Person"}},qCe=Object.keys(ao.afterThisPos),WCe=Object.keys(ao.beforeThisPos),$Ce=function(a,t){for(let e=0;e<a.length;e+=1){let r=a[e];if(r.isKnown()===!0)continue;let n=a[e-1];if(n){if(ao.afterThisWord.hasOwnProperty(n.clean)===!0){let o=ao.afterThisWord[n.clean];r.tag(o,"after-"+n.clean,t);continue}let s=qCe.find(o=>n.tags[o]);if(s!==void 0){let o=ao.afterThisPos[s];r.tag(o,"after-"+s,t);continue}}let i=a[e+1];if(i){if(ao.beforeThisWord.hasOwnProperty(i.clean)===!0){let o=ao.beforeThisWord[i.clean];r.tag(o,"before-"+i.clean,t);continue}let s=WCe.find(o=>i.tags[o]);if(s!==void 0){let o=ao.beforeThisPos[s];r.tag(o,"before-"+s,t);continue}}}},KCe=/^[A-Z][a-z'\u00C0-\u00FF]/,XCe=/[0-9]/,YCe=function(a){let t=a.world;a.list.forEach(e=>{let r=e.terms();for(let n=1;n<r.length;n++){let i=r[n];KCe.test(i.text)===!0&&XCe.test(i.text)===!1&&i.tags.Date===void 0&&i.tag("ProperNoun","titlecase-noun",t)}})},ZCe=/^(re|un)-?[a-z\u00C0-\u00FF]/,JCe=/^(re|un)-?/,QCe=function(a,t){let e=t.words;a.forEach(r=>{if(r.isKnown()!==!0&&ZCe.test(r.clean)===!0){let n=r.clean.replace(JCe,"");n&&n.length>3&&e[n]!==void 0&&e.hasOwnProperty(n)===!0&&r.tag(e[n],"stem-"+n,t)}})},e6e=["Uncountable","Pronoun","Place","Value","Person","Month","WeekDay","Holiday"],$z={isSingular:[/(ax|test)is$/i,/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,/(octop|vir)i$/i,/(rl)f$/i,/(alias|status)$/i,/(bu)s$/i,/(al|ad|at|er|et|ed|ad)o$/i,/(ti)um$/i,/(ti)a$/i,/sis$/i,/(?:(^f)fe|(lr)f)$/i,/hive$/i,/s[aeiou]+ns$/i,/(^aeiouy|qu)y$/i,/(x|ch|ss|sh|z)$/i,/(matr|vert|ind|cort)(ix|ex)$/i,/(m|l)ouse$/i,/(m|l)ice$/i,/(antenn|formul|nebul|vertebr|vit)a$/i,/.sis$/i,/^(?!talis|.*hu)(.*)man$/i],isPlural:[/(^v)ies$/i,/ises$/i,/ives$/i,/(antenn|formul|nebul|vertebr|vit)ae$/i,/(octop|vir|radi|nucle|fung|cact|stimul)i$/i,/(buffal|tomat|tornad)oes$/i,/(analy|ba|diagno|parenthe|progno|synop|the)ses$/i,/(vert|ind|cort)ices$/i,/(matr|append)ices$/i,/(x|ch|ss|sh|s|z|o)es$/i,/is$/i,/men$/i,/news$/i,/.tia$/i,/(^f)ves$/i,/(lr)ves$/i,/(^aeiouy|qu)ies$/i,/(m|l)ice$/i,/(cris|ax|test)es$/i,/(alias|status)es$/i,/ics$/i]},t6e=[/ss$/,/sis$/,/[^aeiou][uo]s$/,/'s$/],r6e=[/i$/,/ae$/],n6e=function(a,t){if(a.tags.Noun&&!a.tags.Acronym){let e=a.clean;if(a.tags.Singular||a.tags.Plural)return;if(e.length<=3)return void a.tag("Singular","short-singular",t);if(e6e.find(r=>a.tags[r]))return;if($z.isPlural.find(r=>r.test(e)))return void a.tag("Plural","plural-rules",t);if($z.isSingular.find(r=>r.test(e)))return void a.tag("Singular","singular-rules",t);if(/s$/.test(e)===!0)return t6e.find(r=>r.test(e))?void 0:void a.tag("Plural","plural-fallback",t);if(r6e.find(r=>r.test(e)))return;a.tag("Singular","singular-fallback",t)}},Kz=["academy","administration","agence","agences","agencies","agency","airlines","airways","army","assoc","associates","association","assurance","authority","autorite","aviation","bank","banque","board","boys","brands","brewery","brotherhood","brothers","building society","bureau","cafe","caisse","capital","care","cathedral","center","central bank","centre","chemicals","choir","chronicle","church","circus","clinic","clinique","club","co","coalition","coffee","collective","college","commission","committee","communications","community","company","comprehensive","computers","confederation","conference","conseil","consulting","containers","corporation","corps","corp","council","crew","daily news","data","departement","department","department store","departments","design","development","directorate","division","drilling","education","eglise","electric","electricity","energy","ensemble","enterprise","enterprises","entertainment","estate","etat","evening news","faculty","federation","financial","fm","foundation","fund","gas","gazette","girls","government","group","guild","health authority","herald","holdings","hospital","hotel","hotels","inc","industries","institut","institute","institute of technology","institutes","insurance","international","interstate","investment","investments","investors","journal","laboratory","labs","liberation army","limited","local authority","local health authority","machines","magazine","management","marine","marketing","markets","media","memorial","mercantile exchange","ministere","ministry","military","mobile","motor","motors","musee","museum","news","news service","observatory","office","oil","optical","orchestra","organization","partners","partnership","people's party","petrol","petroleum","pharmacare","pharmaceutical","pharmaceuticals","pizza","plc","police","polytechnic","post","power","press","productions","quartet","radio","regional authority","regional health authority","reserve","resources","restaurant","restaurants","savings","school","securities","service","services","social club","societe","society","sons","standard","state police","state university","stock exchange","subcommittee","syndicat","systems","telecommunications","telegraph","television","times","tribunal","tv","union","university","utilities","workers"].reduce(function(a,t){return a[t]="Noun",a},{}),Xz=function(a){return!!a.tags.Noun&&!(a.tags.Pronoun||a.tags.Comma||a.tags.Possessive)&&!!(a.tags.Organization||a.tags.Acronym||a.tags.Place||a.titleCase())},a6e=/^[A-Z]('s|,)?$/,i6e=/([A-Z]\.){2}[A-Z]?/i,s6e={I:!0,A:!0},Ep={neighbours:$Ce,case:YCe,stem:QCe,plural:n6e,organizations:function(a,t){for(let e=0;e<a.length;e+=1){let r=a[e];if(Kz[r.clean]!==void 0&&Kz.hasOwnProperty(r.clean)===!0){let n=a[e-1];if(n!==void 0&&Xz(n)===!0){n.tagSafe("Organization","org-word-1",t),r.tagSafe("Organization","org-word-2",t);continue}let i=a[e+1];if(i!==void 0&&i.clean==="of"&&a[e+2]&&Xz(a[e+2])){r.tagSafe("Organization","org-of-word-1",t),i.tagSafe("Organization","org-of-word-2",t),a[e+2].tagSafe("Organization","org-of-word-3",t);continue}}}},acronyms:function(a,t){a.forEach(e=>{e.tags.RomanNumeral!==!0&&(i6e.test(e.text)===!0&&e.tag("Acronym","period-acronym",t),e.isUpperCase()&&function(r,n){let i=r.reduced;return!!r.tags.Acronym||!n.words[i]&&!(i.length>5)&&r.isAcronym()}(e,t)?(e.tag("Acronym","acronym-step",t),e.tag("Noun","acronym-infer",t)):!s6e.hasOwnProperty(e.text)&&a6e.test(e.text)&&(e.tag("Acronym","one-letter-acronym",t),e.tag("Noun","one-letter-infer",t)),e.tags.Organization&&e.text.length<=3&&e.tag("Acronym","acronym-org",t),e.tags.Organization&&e.isUpperCase()&&e.text.length<=6&&e.tag("Acronym","acronym-org-case",t))})}},o6e=function(a,t){let e=a.world;return Ep.neighbours(t,e),Ep.case(a),Ep.stem(t,e),t.forEach(r=>{r.isKnown()===!1&&r.tag("Noun","noun-fallback",a.world)}),Ep.organizations(t,e),Ep.acronyms(t,e),t.forEach(r=>{Ep.plural(r,a.world)}),a},Yz=/n't$/,Zz={"won't":["will","not"],wont:["will","not"],"can't":["can","not"],cant:["can","not"],cannot:["can","not"],"shan't":["should","not"],dont:["do","not"],dun:["do","not"]},l6e=/([a-z\u00C0-\u00FF]+)[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]([a-z]{1,2})$/i,Jz={ll:"will",ve:"have",re:"are",m:"am","n't":"not"},Qz={wanna:["want","to"],gonna:["going","to"],im:["i","am"],alot:["a","lot"],ive:["i","have"],imma:["I","will"],"where'd":["where","did"],whered:["where","did"],"when'd":["when","did"],whend:["when","did"],howd:["how","did"],whatd:["what","did"],dunno:["do","not","know"],brb:["be","right","back"],gtg:["got","to","go"],irl:["in","real","life"],tbh:["to","be","honest"],imo:["in","my","opinion"],til:["today","i","learned"],rn:["right","now"],twas:["it","was"],"@":["at"]},u6e=/([a-z\u00C0-\u00FF]+)[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]s$/i,c6e={that:!0,there:!0},p6e={here:!0,there:!0,everywhere:!0},m6e=/[a-z\u00C0-\u00FF]'d$/,f6e={how:!0,what:!0},d6e=/^([0-9.]{1,3}[a-z]{0,2}) ?[-] ?([0-9]{1,3}[a-z]{0,2})$/i,h6e=/^([0-9][0-9]?(:[0-9][0-9])?(am|pm)?) ?[-] ?([0-9][0-9]?(:[0-9][0-9])?(am|pm)?)$/i,y6e=/^(l|c|d|j|m|n|qu|s|t)[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]([a-z\u00C0-\u00FF]+)$/i,eG={l:"le",c:"ce",d:"de",j:"je",m:"me",n:"ne",qu:"que",s:"se",t:"tu"},b6e=dR,g6e=Od,v6e=function(a,t){return Zz.hasOwnProperty(a.clean)===!0?Zz[a.clean]:a.clean==="ain't"||a.clean==="aint"?function(e,r){let n=r.terms(),i=n.indexOf(e),s=n.slice(0,i).find(o=>o.tags.Noun);return s&&s.tags.Plural?["are","not"]:["is","not"]}(a,t):Yz.test(a.clean)===!0?[a.clean.replace(Yz,""),"not"]:null},T6e=function(a){let t=a.text.match(l6e);return t===null?null:Jz.hasOwnProperty(t[2])?[t[1],Jz[t[2]]]:null},N6e=function(a){return Qz.hasOwnProperty(a.clean)?Qz[a.clean]:null},C6e=function(a,t,e){let r=a.text.match(u6e);if(r!==null){if(((n,i)=>{if(n.tags.Possessive)return!0;if(n.tags.Pronoun||n.tags.QuestionWord||c6e.hasOwnProperty(n.reduced))return!1;let s=i.get(n.next);if(!s)return!0;if(s.tags.Verb)return!!s.tags.Infinitive||!!s.tags.PresentTense;if(s.tags.Noun)return p6e.hasOwnProperty(s.reduced)!==!0;let o=i.get(s.next);return!(!o||!o.tags.Noun||o.tags.Pronoun)||(s.tags.Adjective||s.tags.Adverb||s.tags.Verb,!1)})(a,t.pool)===!0)return a.tag("#Possessive","isPossessive",e),null;if(r!==null)return((n,i)=>{let s=i.terms(),o=s.indexOf(n);return s.slice(o+1,o+3).find(l=>l.tags.PastTense)})(a,t)?[r[1],"has"]:[r[1],"is"]}return null},A6e=function(a,t){if(m6e.test(a.clean)){let e=a.clean.replace(/'d$/,""),r=t.terms(),n=r.indexOf(a),i=r.slice(n+1,n+4);for(let s=0;s<i.length;s++){let o=i[s];if(o.tags.Verb)return o.tags.PastTense?[e,"had"]:f6e[e]===!0?[e,"did"]:[e,"would"]}return[e,"would"]}return null},S6e=function(a){if(a.tags.PhoneNumber===!0)return null;let t=a.text.match(d6e);return t!==null?[t[1],"to",t[2]]:(t=a.text.match(h6e),t!==null?[t[1],"to",t[4]]:null)},w6e=function(a){let t=a.text.match(y6e);if(t===null||eG.hasOwnProperty(t[1])===!1)return null;let e=[eG[t[1]],t[2]];return e[0]&&e[1]?e:null},E6e=/^[0-9]+$/,R6e=/^[0-9]+(st|nd|rd|th)$/,x6e=/^[0-9:]+(am|pm)?$/,V6e=function(a,t){let e=g6e(a.join(" "),t.world,t.pool())[0],r=e.terms();b6e(r,t.world);let n=r[0];return R6e.test(n.text)&&r[2]?(r[0].tag("Ordinal","ord-range",t.world),r[2].tag("Ordinal","ord-range",t.world)):E6e.test(n.text)&&r[2]?(r[0].tag("Cardinal","num-range",t.world),r[2].tag("Cardinal","num-range",t.world)):x6e.test(n.text)&&r[1]&&r[2]&&(r[0].tag("Time","time-range",t.world),r[1].tag("Date","time-range",t.world),r[2].tag("Time","time-range",t.world)),r.forEach(i=>{i.implicit=i.text,i.text="",i.clean="",i.pre="",i.post="",Object.keys(i.tags).length===0&&(i.tags.Noun=!0)}),e},O6e=function(a){let t=a.world;return a.list.forEach(e=>{let r=e.terms();for(let n=0;n<r.length;n+=1){let i=r[n],s=v6e(i,e);if(s=s||T6e(i),s=s||N6e(i),s=s||C6e(i,e,t),s=s||A6e(i,e),s=s||S6e(i),s=s||w6e(i),s!==null){let o=V6e(s,a);e.has("#NumberRange")===!0&&a.buildFrom([o]).tag("NumberRange"),o.terms(0).text=i.text,e.buildFrom(i.id,1,a.pool()).replace(o,a,!0)}}}),a},Rp=function(a,t){let e=a._cache.tags[t]||[];return e=e.map(r=>a.list[r]),a.buildFrom(e)},D6e=function(a){let t=Rp(a,"Infinitive");return t.found&&(t=t.ifNo("@hasQuestionMark"),t=t.ifNo("(i|we|they)"),t.not("will be").match("[#Infinitive] (#Determiner|#Possessive) #Noun").notIf("(our|their)").match("#Infinitive").tag("Imperative","shut-the"),t.match("^[#Infinitive] #Adverb?$",0).tag("Imperative","go-fast"),t.match("[(do && #Infinitive)] not? #Verb",0).tag("Imperative","do-not"),t.match("[#Infinitive] (it|some) (#Comparative|#Preposition|please|now|again)",0).tag("Imperative","do-it")),t=function(e,r){let n=e._cache.words[r]||[];return n=n.map(i=>e.list[i]),e.buildFrom(n)}(a,"like"),t.match("#Adverb like").notIf("(really|generally|typically|usually|sometimes|often|just) [like]").tag("Adverb","adverb-like"),t=Rp(a,"Adjective"),t.match("#Determiner #Adjective$").notIf("(#Comparative|#Superlative)").terms(1).tag("Noun","the-adj-1"),t=Rp(a,"FirstName"),t.match("#FirstName (#Noun|@titleCase)").ifNo("^#Possessive").ifNo("(#Pronoun|#Plural)").ifNo("@hasComma .").lastTerm().tag("#LastName","firstname-noun"),t=Rp(a,"Value"),t=t.match("#Value #PresentTense").ifNo("#Copula"),t.found&&(t.has("(one|1)")===!0?t.terms(1).tag("Singular","one-presentTense"):t.terms(1).tag("Plural","value-presentTense")),a.match("^(well|so|okay)").tag("Expression","well-"),a.match("#Value [of a second]",0).unTag("Value","of-a-second"),a.match("#Value [seconds]",0).unTag("Value","30-seconds").tag(["Unit","Plural"]),t=Rp(a,"Gerund"),t.match("(be|been) (#Adverb|not)+? #Gerund").not("#Verb$").tag("Auxiliary","be-walking"),a.match("(try|use|attempt|build|make) #Verb").ifNo("(@hasComma|#Negative|#PhrasalVerb|#Copula|will|be)").lastTerm().tag("#Noun","do-verb"),t=Rp(a,"Possessive"),t=t.match("#Possessive [#Infinitive]",0),t.lookBehind("(let|made|make|force|ask)").found||t.tag("Noun","her-match"),a},tG=function(a){let t={};for(let e=0;e<a.length;e++)t[a[e]]=!0;return Object.keys(t)},I6e=[{match:"too much",tag:"Adverb Adjective",reason:"bit-4"},{match:"u r",tag:"Pronoun Copula",reason:"u r"},{match:"#Copula (pretty|dead|full|well|sure) (#Adjective|#Noun)",tag:"#Copula #Adverb #Adjective",reason:"sometimes-adverb"},{match:"(#Pronoun|#Person) (had|#Adverb)? [better] #PresentTense",group:0,tag:"Modal",reason:"i-better"},{match:"[#Gerund] #Adverb? not? #Copula",group:0,tag:"Activity",reason:"gerund-copula"},{match:"[#Gerund] #Modal",group:0,tag:"Activity",reason:"gerund-modal"},{match:"holy (shit|fuck|hell)",tag:"Expression",reason:"swears-expression"},{match:"#Noun #Actor",tag:"Actor",reason:"thing-doer"},{match:"#Conjunction [u]",group:0,tag:"Pronoun",reason:"u-pronoun-2"},{match:"[u] #Verb",group:0,tag:"Pronoun",reason:"u-pronoun-1"},{match:"#Noun [(who|whom)]",group:0,tag:"Determiner",reason:"captain-who"},{match:"a bit much",tag:"Determiner Adverb Adjective",reason:"bit-3"},{match:"#Verb #Adverb? #Noun [(that|which)]",group:0,tag:"Preposition",reason:"that-prep"},{match:"@hasComma [which] (#Pronoun|#Verb)",group:0,tag:"Preposition",reason:"which-copula"},{match:"#Copula just [like]",group:0,tag:"Preposition",reason:"like-preposition"},{match:"#Noun [like] #Noun",group:0,tag:"Preposition",reason:"noun-like"},{match:"[had] #Noun+ #PastTense",group:0,tag:"Condition",reason:"had-he"},{match:"[were] #Noun+ to #Infinitive",group:0,tag:"Condition",reason:"were-he"},{match:"^how",tag:"QuestionWord",reason:"how-question"},{match:"[how] (#Determiner|#Copula|#Modal|#PastTense)",group:0,tag:"QuestionWord",reason:"how-is"},{match:"^which",tag:"QuestionWord",reason:"which-question"},{match:"[so] #Noun",group:0,tag:"Conjunction",reason:"so-conj"},{match:"[(who|what|where|why|how|when)] #Noun #Copula #Adverb? (#Verb|#Adjective)",group:0,tag:"Conjunction",reason:"how-he-is-x"}],jd={adverbAdjective:["dark","bright","flat","light","soft","pale","dead","dim","faux","little","wee","sheer","most","near","good","extra","all"],personDate:["april","june","may","jan","august","eve"],personMonth:["january","april","may","june","jan","sep"],personAdjective:["misty","rusty","dusty","rich","randy","young"],personVerb:["pat","wade","ollie","will","rob","buck","bob","mark","jack"],personPlace:["darwin","hamilton","paris","alexandria","houston","kobe","santiago","salvador","sydney","victoria"],personNoun:["art","baker","berg","bill","brown","charity","chin","christian","cliff","daisy","dawn","dick","dolly","faith","franco","gene","green","hall","hill","holly","hope","jean","jewel","joy","kelvin","king","kitty","lane","lily","melody","mercedes","miles","olive","penny","ray","reed","robin","rod","rose","sky","summer","trinity","van","viola","violet","wang","white"]},ui=`(${jd.personDate.join("|")})`,P6e=[{match:"#Holiday (day|eve)",tag:"Holiday",reason:"holiday-day"},{match:"[sun] the #Ordinal",tag:"WeekDay",reason:"sun-the-5th"},{match:"[sun] #Date",group:0,tag:"WeekDay",reason:"sun-feb"},{match:"#Date (on|this|next|last|during)? [sun]",group:0,tag:"WeekDay",reason:"1pm-sun"},{match:"(in|by|before|during|on|until|after|of|within|all) [sat]",group:0,tag:"WeekDay",reason:"sat"},{match:"(in|by|before|during|on|until|after|of|within|all) [wed]",group:0,tag:"WeekDay",reason:"wed"},{match:"(in|by|before|during|on|until|after|of|within|all) [march]",group:0,tag:"Month",reason:"march"},{match:"[sat] #Date",group:0,tag:"WeekDay",reason:"sat-feb"},{match:"#Preposition [(march|may)]",group:0,tag:"Month",reason:"in-month"},{match:"this [(march|may)]",group:0,tag:"Month",reason:"this-month"},{match:"next [(march|may)]",group:0,tag:"Month",reason:"this-month"},{match:"last [(march|may)]",group:0,tag:"Month",reason:"this-month"},{match:"[(march|may)] the? #Value",group:0,tag:"Month",reason:"march-5th"},{match:"#Value of? [(march|may)]",group:0,tag:"Month",reason:"5th-of-march"},{match:"[(march|may)] .? #Date",group:0,tag:"Month",reason:"march-and-feb"},{match:"#Date .? [(march|may)]",group:0,tag:"Month",reason:"feb-and-march"},{match:"#Adverb [(march|may)]",group:0,tag:"Verb",reason:"quickly-march"},{match:"[(march|may)] #Adverb",group:0,tag:"Verb",reason:"march-quickly"},{match:"#Value of #Month",tag:"Date",reason:"value-of-month"},{match:"#Cardinal #Month",tag:"Date",reason:"cardinal-month"},{match:"#Month #Value to #Value",tag:"Date",reason:"value-to-value"},{match:"#Month the #Value",tag:"Date",reason:"month-the-value"},{match:"(#WeekDay|#Month) #Value",tag:"Date",reason:"date-value"},{match:"#Value (#WeekDay|#Month)",tag:"Date",reason:"value-date"},{match:"(#TextValue && #Date) #TextValue",tag:"Date",reason:"textvalue-date"},{match:`in [${ui}]`,group:0,tag:"Date",reason:"in-june"},{match:`during [${ui}]`,group:0,tag:"Date",reason:"in-june"},{match:`on [${ui}]`,group:0,tag:"Date",reason:"in-june"},{match:`by [${ui}]`,group:0,tag:"Date",reason:"by-june"},{match:`after [${ui}]`,group:0,tag:"Date",reason:"after-june"},{match:`#Date [${ui}]`,group:0,tag:"Date",reason:"in-june"},{match:ui+" #Value",tag:"Date",reason:"june-5th"},{match:ui+" #Date",tag:"Date",reason:"june-5th"},{match:ui+" #ProperNoun",tag:"Person",reason:"june-smith",safe:!0},{match:ui+" #Acronym? (#ProperNoun && !#Month)",tag:"Person",reason:"june-smith-jr"},{match:"#Cardinal [second]",tag:"Unit",reason:"one-second"},{match:"#Month #NumberRange",tag:"Date",reason:"aug 20-21"},{match:"(#Place|#Demonmym|#Time) (standard|daylight|central|mountain)? time",tag:"Timezone",reason:"std-time"},{match:"(eastern|mountain|pacific|central|atlantic) (standard|daylight|summer)? time",tag:"Timezone",reason:"eastern-time"},{match:"#Time [(eastern|mountain|pacific|central|est|pst|gmt)]",group:0,tag:"Timezone",reason:"5pm-central"},{match:"(central|western|eastern) european time",tag:"Timezone",reason:"cet"}],bR=`(${jd.personAdjective.join("|")})`,_6e=[{match:"[all] #Determiner? #Noun",group:0,tag:"Adjective",reason:"all-noun"},{match:`#Adverb [${bR}]`,group:0,tag:"Adjective",reason:"really-rich"},{match:bR+" #Person",tag:"Person",reason:"randy-smith"},{match:bR+" #Acronym? #ProperNoun",tag:"Person",reason:"rusty-smith"},{match:"#Copula [(just|alone)]$",group:0,tag:"Adjective",reason:"not-adverb"},{match:"#Singular is #Adverb? [#PastTense$]",group:0,tag:"Adjective",reason:"is-filled"},{match:"[#PastTense] #Singular is",group:0,tag:"Adjective",reason:"smoked-poutine"},{match:"[#PastTense] #Plural are",group:0,tag:"Adjective",reason:"baked-onions"},{match:"well [#PastTense]",group:0,tag:"Adjective",reason:"well-made"},{match:"#Copula [fucked up?]",tag:"Adjective",reason:"swears-adjective"},{match:"#Singular (seems|appears) #Adverb? [#PastTense$]",group:0,tag:"Adjective",reason:"seems-filled"},{match:"(a|an) [#Gerund]",group:0,tag:"Adjective",reason:"a|an"},{match:"as [#Gerund] as",group:0,tag:"Adjective",reason:"as-gerund-as"},{match:"more [#Gerund] than",group:0,tag:"Adjective",reason:"more-gerund-than"},{match:"(so|very|extremely) [#Gerund]",group:0,tag:"Adjective",reason:"so-gerund"},{match:"(it|he|she|everything|something) #Adverb? was #Adverb? [#Gerund]",group:0,tag:"Adjective",reason:"it-was-gerund"},{match:"(found|found) it #Adverb? [#Gerund]",group:0,tag:"Adjective",reason:"found-it-gerund"},{match:"a (little|bit|wee) bit? [#Gerund]",group:0,tag:"Adjective",reason:"a-bit-gerund"},{match:"#Copula #Adjective? [(out|in|through)]$",group:0,tag:"Adjective",reason:"still-out"},{match:"^[#Adjective] (the|your) #Noun",group:0,tag:"Infinitive",reason:"shut-the"},{match:"the [said] #Noun",group:0,tag:"Adjective",reason:"the-said-card"},{match:"#Noun (that|which|whose) [#PastTense && !#Copula] #Noun",group:0,tag:"Adjective",reason:"that-past-noun"}],k6e=[{match:"there (are|were) #Adjective? [#PresentTense]",group:0,tag:"Plural",reason:"there-are"},{match:"#Determiner [sun]",group:0,tag:"Singular",reason:"the-sun"},{match:"#Verb (a|an) [#Value]",group:0,tag:"Singular",reason:"did-a-value"},{match:"the [(can|will|may)]",group:0,tag:"Singular",reason:"the can"},{match:"#FirstName #Acronym? (#Possessive && #LastName)",tag:"Possessive",reason:"name-poss"},{match:"#Organization+ #Possessive",tag:"Possessive",reason:"org-possessive"},{match:"#Place+ #Possessive",tag:"Possessive",reason:"place-possessive"},{match:"(#Verb && !#Modal) (all|every|each|most|some|no) [#PresentTense]",group:0,tag:"Noun",reason:"all-presentTense"},{match:"#Determiner [#Adjective] #Copula",group:0,tag:"Noun",reason:"the-adj-is"},{match:"#Adjective [#Adjective] #Copula",group:0,tag:"Noun",reason:"adj-adj-is"},{match:"(had|have|#PastTense) #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"adj-presentTense"},{match:"^#Adjective [#PresentTense]",group:0,tag:"Noun",reason:"start adj-presentTense"},{match:"#Value #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"one-big-reason"},{match:"#PastTense #Adjective+ [#PresentTense]",group:0,tag:"Noun",reason:"won-wide-support"},{match:"(many|few|several|couple) [#PresentTense]",group:0,tag:"Noun",reason:"many-poses"},{match:"#Adverb #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"very-big-dream"},{match:"#Adjective [#Infinitive] #Noun",group:0,tag:"Noun",reason:"good-wait-staff"},{match:"#Adjective #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"adorable-little-store"},{match:"#Preposition #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"of-basic-training"},{match:"#Adjective [#Gerund]",group:0,tag:"Noun",reason:"early-warning"},{match:"#Gerund #Adverb? #Comparative [#PresentTense]",group:0,tag:"Noun",reason:"higher-costs"},{match:"#Infinitive (this|that|the) [#Infinitive]",group:0,tag:"Noun",reason:"do-this-dance"},{match:"(his|her|its) [#Adjective]",group:0,tag:"Noun",reason:"his-fine"},{match:"some [#Verb] #Plural",group:0,tag:"Noun",reason:"determiner6"},{match:"more #Noun",tag:"Noun",reason:"more-noun"},{match:"(#Noun && @hasComma) #Noun (and|or) [#PresentTense]",group:0,tag:"Noun",reason:"noun-list"},{match:"(right|rights) of .",tag:"Noun",reason:"right-of"},{match:"a [bit]",group:0,tag:"Noun",reason:"bit-2"},{match:"#Possessive #Ordinal [#PastTense]",group:0,tag:"Noun",reason:"first-thought"},{match:"#Gerund #Determiner [#Infinitive]",group:0,tag:"Noun",reason:"running-a-show"},{match:"#Determiner #Adverb [#Infinitive]",group:0,tag:"Noun",reason:"the-reason"},{match:"(the|this|those|these) #Adjective [#Verb]",group:0,tag:"Noun",reason:"the-adj-verb"},{match:"(the|this|those|these) #Adverb #Adjective [#Verb]",group:0,tag:"Noun",reason:"determiner4"},{match:"#Determiner [#Adjective] (#Copula|#PastTense|#Auxiliary)",group:0,tag:"Noun",reason:"the-adj-2"},{match:"(the|this|a|an) [#Infinitive] #Adverb? #Verb",group:0,tag:"Noun",reason:"determiner5"},{match:"#Determiner [#Infinitive] #Noun",group:0,tag:"Noun",reason:"determiner7"},{match:"#Determiner #Adjective #Adjective? [#Infinitive]",group:0,tag:"Noun",reason:"a-nice-inf"},{match:"the [#Verb] #Preposition .",group:0,tag:"Noun",reason:"determiner1"},{match:"#Determiner [#Verb] of",group:0,tag:"Noun",reason:"the-verb-of"},{match:"#Adjective #Noun+ [#Infinitive] #Copula",group:0,tag:"Noun",reason:"career-move"},{match:"#Determiner #Noun of [#Verb]",group:0,tag:"Noun",reason:"noun-of-noun"},{match:"#Determiner [(western|eastern|northern|southern|central)] #Noun",group:0,tag:"Noun",reason:"western-line"},{match:"#Possessive [#Gerund]",group:0,tag:"Noun",reason:"her-polling"},{match:"(his|her|its) [#PresentTense]",group:0,tag:"Noun",reason:"its-polling"},{match:"(#Determiner|#Value) [(linear|binary|mobile|lexical|technical|computer|scientific|formal)] #Noun",group:0,tag:"Noun",reason:"technical-noun"},{match:"(the|those|these|a|an) [#Participle] #Noun",group:0,tag:"Adjective",reason:"blown-motor"},{match:"(the|those|these|a|an) #Adjective? [#Infinitive]",group:0,tag:"Noun",reason:"det-inf"},{match:"(the|those|these|a|an) #Adjective? [#PresentTense]",group:0,tag:"Noun",reason:"det-pres"},{match:"(the|those|these|a|an) #Adjective? [#PastTense]",group:0,tag:"Noun",reason:"det-past"},{match:"(this|that) [#Gerund]",group:0,tag:"Noun",reason:"this-gerund"},{match:"at some [#Infinitive]",group:0,tag:"Noun",reason:"at-some-inf"},{match:"(#Noun && @hasHyphen) #Verb",tag:"Noun",reason:"hyphen-verb"},{match:"is no [#Verb]",group:0,tag:"Noun",reason:"is-no-verb"},{match:"[#Verb] than",group:0,tag:"Noun",reason:"correction"},{match:"(go|goes|went) to [#Infinitive]",group:0,tag:"Noun",reason:"goes-to-verb"},{match:"(a|an) #Noun [#Infinitive] (#Preposition|#Noun)",group:0,tag:"Noun",reason:"a-noun-inf"},{match:"(a|an) #Noun [#Infinitive]$",group:0,tag:"Noun",reason:"a-noun-inf2"},{match:"do [so]",group:0,tag:"Noun",reason:"so-noun"},{match:"#Copula [#Infinitive] #Noun",group:0,tag:"Noun",reason:"is-pres-noun"},{match:"#Determiner #Adverb? [close]",group:0,tag:"Adjective",reason:"a-close"},{match:"#Determiner [(shit|damn|hell)]",group:0,tag:"Noun",reason:"swears-noun"},{match:"(the|these) [#Singular] (were|are)",group:0,tag:"Plural",reason:"singular-were"},{match:"#Gerund #Adjective? for [#Infinitive]",group:0,tag:"Noun",reason:"running-for"},{match:"#Gerund #Adjective to [#Infinitive]",group:0,tag:"Noun",reason:"running-to"},{match:"(many|any|some|several) [#PresentTense] for",group:0,tag:"Noun",reason:"any-verbs-for"},{match:"(have|had) [#Adjective] #Preposition .",group:0,tag:"Noun",reason:"have-fun"},{match:"co #Noun",tag:"Actor",reason:"co-noun"},{match:"to #PresentTense #Noun [#PresentTense] #Preposition",group:0,tag:"Noun",reason:"gas-exchange"},{match:"a #Noun+ or #Adverb+? [#Verb]",group:0,tag:"Noun",reason:"noun-or-noun"},{match:"[#Gerund] system",group:0,tag:"Noun",reason:"operating-system"},{match:"#PastTense (until|as|through|without) [#PresentTense]",group:0,tag:"Noun",reason:"waited-until-release"},{match:"#Gerund like #Adjective? [#PresentTense]",group:0,tag:"Plural",reason:"like-hot-cakes"},{match:"some #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"some-reason"},{match:"for some [#PresentTense]",group:0,tag:"Noun",reason:"for-some-reason"},{match:"(same|some|the|that|a) kind of [#PresentTense]",group:0,tag:"Noun",reason:"some-kind-of"},{match:"(same|some|the|that|a) type of [#PresentTense]",group:0,tag:"Noun",reason:"some-type-of"},{match:"#Gerund #Adjective #Preposition [#PresentTense]",group:0,tag:"Noun",reason:"doing-better-for-x"},{match:"(get|got|have|had) #Comparative [#PresentTense]",group:0,tag:"Noun",reason:"got-better-aim"},{match:"#Pronoun #Infinitive [#Gerund] #PresentTense",group:0,tag:"Noun",reason:"tipping-sucks"}],F6e=[{match:"[still] #Adjective",group:0,tag:"Adverb",reason:"still-advb"},{match:"[still] #Verb",group:0,tag:"Adverb",reason:"still-verb"},{match:"[so] #Adjective",group:0,tag:"Adverb",reason:"so-adv"},{match:"[way] #Comparative",group:0,tag:"Adverb",reason:"way-adj"},{match:"[way] #Adverb #Adjective",group:0,tag:"Adverb",reason:"way-too-adj"},{match:"[all] #Verb",group:0,tag:"Adverb",reason:"all-verb"},{match:"(#Verb && !#Modal) [like]",group:0,tag:"Adverb",reason:"verb-like"},{match:"(barely|hardly) even",tag:"Adverb",reason:"barely-even"},{match:"[even] #Verb",group:0,tag:"Adverb",reason:"even-walk"},{match:"even left",tag:"#Adverb #Verb",reason:"even-left"},{match:"(#PresentTense && !#Copula) [(hard|quick|long|bright|slow|fast|backwards|forwards)]",group:0,tag:"Adverb",reason:"lazy-ly"},{match:"[much] #Adjective",group:0,tag:"Adverb",reason:"bit-1"},{match:"#Copula [#Adverb]$",group:0,tag:"Adjective",reason:"is-well"},{match:"a [(little|bit|wee) bit?] #Adjective",group:0,tag:"Adverb",reason:"a-bit-cold"},{match:`[${`(${jd.adverbAdjective.join("|")})`}] #Adjective`,group:0,tag:"Adverb",reason:"dark-green"},{match:"#Adverb [#Adverb]$",group:0,tag:"Adjective",reason:"kinda-sparkly"},{match:"#Adverb [#Adverb] (and|or|then)",group:0,tag:"Adjective",reason:"kinda-sparkly-and"},{match:"[super] #Adjective #Noun",group:0,tag:"Adverb",reason:"super-strong"}],j6e=[{match:"1 #Value #PhoneNumber",tag:"PhoneNumber",reason:"1-800-Value"},{match:"#NumericValue #PhoneNumber",tag:"PhoneNumber",reason:"(800) PhoneNumber"},{match:"#Demonym #Currency",tag:"Currency",reason:"demonym-currency"},{match:"[second] #Noun",group:0,tag:"Ordinal",reason:"second-noun"},{match:"#Value+ [#Currency]",group:0,tag:"Unit",reason:"5-yan"},{match:"#Value [(foot|feet)]",group:0,tag:"Unit",reason:"foot-unit"},{match:"(minus|negative) #Value",tag:"Value",reason:"minus-value"},{match:"#Value [#Abbreviation]",group:0,tag:"Unit",reason:"value-abbr"},{match:"#Value [k]",group:0,tag:"Unit",reason:"value-k"},{match:"#Unit an hour",tag:"Unit",reason:"unit-an-hour"},{match:"#Value (point|decimal) #Value",tag:"Value",reason:"value-point-value"},{match:"(#Value|a) [(buck|bucks|grand)]",group:0,tag:"Currency",reason:"value-bucks"},{match:"#Determiner [(half|quarter)] #Ordinal",group:0,tag:"Value",reason:"half-ordinal"},{match:"a #Value",tag:"Value",reason:"a-value"},{match:"[#Value+] #Currency",group:0,tag:"Money",reason:"15 usd"},{match:"(hundred|thousand|million|billion|trillion|quadrillion)+ and #Value",tag:"Value",reason:"magnitude-and-value"},{match:"!once [(a|an)] (#Duration|hundred|thousand|million|billion|trillion)",group:0,tag:"Value",reason:"a-is-one"}],K1=`(${jd.personVerb.join("|")})`,M6e=[{match:"[#Adjective] #Possessive #Noun",group:0,tag:"Verb",reason:"gerund-his-noun"},{match:"[#Adjective] (us|you)",group:0,tag:"Gerund",reason:"loving-you"},{match:"(slowly|quickly) [#Adjective]",group:0,tag:"Gerund",reason:"slowly-adj"},{match:"(#Modal|i|they|we|do) not? [like]",group:0,tag:"PresentTense",reason:"modal-like"},{match:"do (simply|just|really|not)+ [(#Adjective|like)]",group:0,tag:"Verb",reason:"do-simply-like"},{match:"does (#Adverb|not)? [#Adjective]",group:0,tag:"PresentTense",reason:"does-mean"},{match:"i (#Adverb|do)? not? [mean]",group:0,tag:"PresentTense",reason:"i-mean"},{match:"#Noun #Adverb? [left]",group:0,tag:"PastTense",reason:"left-verb"},{match:"(this|that) [#Plural]",group:0,tag:"PresentTense",reason:"this-verbs"},{match:"[#Copula (#Adverb|not)+?] (#Gerund|#PastTense)",group:0,tag:"Auxiliary",reason:"copula-walking"},{match:"[(has|had) (#Adverb|not)+?] #PastTense",group:0,tag:"Auxiliary",reason:"had-walked"},{match:"#Adverb+? [(#Modal|did)+ (#Adverb|not)+?] #Verb",group:0,tag:"Auxiliary",reason:"modal-verb"},{match:"[#Modal (#Adverb|not)+? have (#Adverb|not)+? had (#Adverb|not)+?] #Verb",group:0,tag:"Auxiliary",reason:"would-have"},{match:"[(has|had) (#Adverb|not)+?] #PastTense",group:0,tag:"Auxiliary",reason:"had-walked"},{match:"[(do|does|will|have|had)] (not|#Adverb)+? #Verb",group:0,tag:"Auxiliary",reason:"have-had"},{match:"[about to] #Adverb? #Verb",group:0,tag:["Auxiliary","Verb"],reason:"about-to"},{match:"#Modal (#Adverb|not)+? be (#Adverb|not)+? #Verb",group:0,tag:"Auxiliary",reason:"would-be"},{match:"(were|was) being [#PresentTense]",group:0,tag:"PastTense",reason:"was-being"},{match:"[#Modal (#Adverb|not)+? have (#Adverb|not)+? had (#Adverb|not)+?] #Verb",group:0,tag:"Auxiliary",reason:"would-have"},{match:"(#Modal|had|has) (#Adverb|not)+? been (#Adverb|not)+? #Verb",group:0,tag:"Auxiliary",reason:"had-been"},{match:"[(be|being|been)] #Participle",group:0,tag:"Auxiliary",reason:"being-foo"},{match:"(#Verb && @hasHyphen) up",tag:"PhrasalVerb",reason:"foo-up"},{match:"(#Verb && @hasHyphen) off",tag:"PhrasalVerb",reason:"foo-off"},{match:"(#Verb && @hasHyphen) over",tag:"PhrasalVerb",reason:"foo-over"},{match:"(#Verb && @hasHyphen) out",tag:"PhrasalVerb",reason:"foo-out"},{match:"#PhrasalVerb [#PhrasalVerb]",group:0,tag:"Particle",reason:"phrasal-particle"},{match:"(lived|went|crept|go) [on] for",group:0,tag:"PhrasalVerb",reason:"went-on"},{match:"#Verb (him|her|it|us|himself|herself|itself|everything|something) [(up|down)]",group:0,tag:"Adverb",reason:"phrasal-pronoun-advb"},{match:"[will #Adverb? not? #Adverb? be] #Gerund",group:0,tag:"Copula",reason:"will-be-copula"},{match:"will #Adverb? not? #Adverb? [be] #Adjective",group:0,tag:"Copula",reason:"be-copula"},{match:"[march] (up|down|back|to|toward)",group:0,tag:"Infinitive",reason:"march-to"},{match:"#Modal [march]",group:0,tag:"Infinitive",reason:"must-march"},{match:"(let|make|made) (him|her|it|#Person|#Place|#Organization)+ [#Singular] (a|an|the|it)",group:0,tag:"Infinitive",reason:"let-him-glue"},{match:"will [#Adjective]",group:0,tag:"Verb",reason:"will-adj"},{match:"#Pronoun [#Adjective] #Determiner #Adjective? #Noun",group:0,tag:"Verb",reason:"he-adj-the"},{match:"#Copula [#Adjective] to #Verb",group:0,tag:"Verb",reason:"adj-to"},{match:"[open] #Determiner",group:0,tag:"Infinitive",reason:"open-the"},{match:"[#PresentTense] (are|were|was) #Adjective",group:0,tag:"Plural",reason:"compromises-are-possible"},{match:`#Modal [${K1}]`,group:0,tag:"Verb",reason:"would-mark"},{match:`#Adverb [${K1}]`,group:0,tag:"Verb",reason:"really-mark"},{match:"(to|#Modal) [mark]",group:0,tag:"PresentTense",reason:"to-mark"},{match:"^[#Infinitive] (is|was)",group:0,tag:"Noun",reason:"checkmate-is"},{match:K1+" #Person",tag:"Person",reason:"rob-smith"},{match:K1+" #Acronym #ProperNoun",tag:"Person",reason:"rob-a-smith"},{match:"[shit] (#Determiner|#Possessive|them)",group:0,tag:"Verb",reason:"swear1-verb"},{match:"[damn] (#Determiner|#Possessive|them)",group:0,tag:"Verb",reason:"swear2-verb"},{match:"[fuck] (#Determiner|#Possessive|them)",group:0,tag:"Verb",reason:"swear3-verb"},{match:"(become|fall|grow) #Adverb? [#PastTense]",group:0,tag:"Adjective",reason:"overly-weakened"},{match:"(a|an) #Adverb [#Participle] #Noun",group:0,tag:"Adjective",reason:"completely-beaten"},{match:"whose [#PresentTense] #Copula",group:0,tag:"Noun",reason:"whos-name-was"},{match:"#PhrasalVerb #PhrasalVerb #Preposition [#PresentTense]",group:0,tag:"Noun",reason:"given-up-on-x"}],B6e=[{match:"(west|north|south|east|western|northern|southern|eastern)+ #Place",tag:"Region",reason:"west-norfolk"},{match:"#City [(al|ak|az|ar|ca|ct|dc|fl|ga|id|il|nv|nh|nj|ny|oh|pa|sc|tn|tx|ut|vt|pr)]",group:0,tag:"Region",reason:"us-state"},{match:"portland [or]",group:0,tag:"Region",reason:"portland-or"},{match:"#ProperNoun+ (district|region|province|county|prefecture|municipality|territory|burough|reservation)",tag:"Region",reason:"foo-district"},{match:"(district|region|province|municipality|territory|burough|state) of #ProperNoun",tag:"Region",reason:"district-of-Foo"},{match:"in [#ProperNoun] #Place",group:0,tag:"Place",reason:"propernoun-place"},{match:"#Value #Noun (st|street|rd|road|crescent|cr|way|tr|terrace|avenue|ave)",tag:"Address",reason:"address-st"}],gR=jd,rG=`(${gR.personNoun.join("|")})`,on=`(${gR.personMonth.join("|")})`,L6e=[{match:"[(1st|2nd|first|second)] #Honorific",group:0,tag:"Honorific",reason:"ordinal-honorific"},{match:"[(private|general|major|corporal|lord|lady|secretary|premier)] #Honorific? #Person",group:0,tag:"Honorific",reason:"ambg-honorifics"},{match:"#Copula [(#Noun|#PresentTense)] #LastName",group:0,tag:"FirstName",reason:"copula-noun-lastname"},{match:"(lady|queen|sister) #ProperNoun",tag:"FemaleName",reason:"lady-titlecase",safe:!0},{match:"(king|pope|father) #ProperNoun",tag:"MaleName",reason:"pope-titlecase",safe:!0},{match:"[(will|may|april|june|said|rob|wade|ray|rusty|drew|miles|jack|chuck|randy|jan|pat|cliff|bill)] #LastName",group:0,tag:"FirstName",reason:"maybe-lastname"},{match:"#FirstName [#Determiner #Noun] #LastName",group:0,tag:"NickName",reason:"first-noun-last"},{match:"#Possessive [#FirstName]",group:0,tag:"Person",reason:"possessive-name"},{match:"#ProperNoun (b|c|d|e|f|g|h|j|k|l|m|n|o|p|q|r|s|t|u|v|w|x|y|z) #ProperNoun",tag:"Person",reason:"titlecase-acronym-titlecase",safe:!0},{match:"#Acronym #LastName",tag:"Person",reason:"acronym-latname",safe:!0},{match:"#Person (jr|sr|md)",tag:"Person",reason:"person-honorific"},{match:"#Person #Person the? #RomanNumeral",tag:"Person",reason:"roman-numeral"},{match:"#FirstName [/^[^aiurck]$/]",group:0,tag:["Acronym","Person"],reason:"john-e"},{match:"#Honorific #Person",tag:"Person",reason:"honorific-person"},{match:"#Honorific #Acronym",tag:"Person",reason:"Honorific-TitleCase"},{match:"#Noun van der? #Noun",tag:"Person",reason:"van der noun",safe:!0},{match:"(king|queen|prince|saint|lady) of #Noun",tag:"Person",reason:"king-of-noun",safe:!0},{match:"(prince|lady) #Place",tag:"Person",reason:"lady-place"},{match:"(king|queen|prince|saint) #ProperNoun",tag:"Person",reason:"saint-foo"},{match:"[#ProperNoun] #Person",group:0,tag:"Person",reason:"proper-person",safe:!0},{match:"al (#Person|#ProperNoun)",tag:"Person",reason:"al-borlen",safe:!0},{match:"#FirstName de #Noun",tag:"Person",reason:"bill-de-noun"},{match:"#FirstName (bin|al) #Noun",tag:"Person",reason:"bill-al-noun"},{match:"#FirstName #Acronym #ProperNoun",tag:"Person",reason:"bill-acronym-title"},{match:"#FirstName #FirstName #ProperNoun",tag:"Person",reason:"bill-firstname-title"},{match:"#Honorific #FirstName? #ProperNoun",tag:"Person",reason:"dr-john-Title"},{match:"#FirstName the #Adjective",tag:"Person",reason:"name-the-great"},{match:"#FirstName (green|white|brown|hall|young|king|hill|cook|gray|price)",tag:"Person",reason:"bill-green"},{match:rG+" #Person",tag:"Person",reason:"ray-smith",safe:!0},{match:rG+" #Acronym? #ProperNoun",tag:"Person",reason:"ray-a-smith",safe:!0},{match:`#Infinitive #Determiner? #Adjective? #Noun? (to|for) [${on}]`,group:0,tag:"Person",reason:"ambig-person"},{match:`#Infinitive [${on}]`,group:0,tag:"Person",reason:"infinitive-person"},{match:`[${on}] #Modal`,group:0,tag:"Person",reason:"ambig-modal"},{match:"[may] be",group:0,tag:"Verb",reason:"may-be"},{match:`#Modal [${on}]`,group:0,tag:"Person",reason:"modal-ambig"},{match:`#Copula [${on}]`,group:0,tag:"Person",reason:"is-may"},{match:`[${on}] #Copula`,group:0,tag:"Person",reason:"may-is"},{match:`that [${on}]`,group:0,tag:"Person",reason:"that-month"},{match:`with [${on}]`,group:0,tag:"Person",reason:"with-month"},{match:`for [${on}]`,group:0,tag:"Person",reason:"for-month"},{match:`this [${on}]`,group:0,tag:"Month",reason:"this-may"},{match:`next [${on}]`,group:0,tag:"Month",reason:"next-may"},{match:`last [${on}]`,group:0,tag:"Month",reason:"last-may"},{match:`#Date [${on}]`,group:0,tag:"Month",reason:"date-may"},{match:`[${on}] the? #Value`,group:0,tag:"Month",reason:"may-5th"},{match:`#Value of [${on}]`,group:0,tag:"Month",reason:"5th-of-may"},{match:"#ProperNoun (van|al|bin) #ProperNoun",tag:"Person",reason:"title-van-title",safe:!0},{match:"#ProperNoun (de|du) la? #ProperNoun",tag:"Person",reason:"title-de-title",safe:!0},{match:"#Singular #Acronym #LastName",tag:"#Person",reason:"title-acro-noun",safe:!0},{match:"#FirstName (#Noun && #ProperNoun) #ProperNoun?",tag:"Person",reason:"firstname-titlecase"},{match:"#FirstName #Acronym #Noun",tag:"Person",reason:"n-acro-noun",safe:!0},{match:"#FirstName [(de|di|du|van|von) #Person]",group:0,tag:"LastName",reason:"de-firstname"},{match:`[${`(${gR.personPlace.join("|")})`}] (#ProperNoun && !#Place)`,group:0,tag:"FirstName",reason:"place-firstname"}],U6e=Vd,nG=tG,Ht=[];Ht=Ht.concat(I6e),Ht=Ht.concat(P6e),Ht=Ht.concat(_6e),Ht=Ht.concat(k6e),Ht=Ht.concat(F6e),Ht=Ht.concat(j6e),Ht=Ht.concat(M6e),Ht=Ht.concat(B6e),Ht=Ht.concat([{match:"#Noun (&|n) #Noun",tag:"Organization",reason:"Noun-&-Noun"},{match:"#Organization of the? #ProperNoun",tag:"Organization",reason:"org-of-place",safe:!0},{match:"#Organization #Country",tag:"Organization",reason:"org-country"},{match:"#ProperNoun #Organization",tag:"Organization",reason:"titlecase-org"},{match:"#ProperNoun (ltd|co|inc|dept|assn|bros)",tag:"Organization",reason:"org-abbrv"},{match:"the [#Acronym]",group:0,tag:"Organization",reason:"the-acronym",safe:!0},{match:"(world|global|international|national|#Demonym) #Organization",tag:"Organization",reason:"global-org"},{match:"#Noun+ (public|private) school",tag:"School",reason:"noun-public-school"}]),Ht=Ht.concat(L6e);var Md=[];Ht.forEach(a=>{a.reg=U6e(a.match);let t=function(e){let r=[];if(e.reg.filter(n=>n.fastOr!==void 0).length===1){let n=e.reg.findIndex(i=>i.fastOr!==void 0);Object.keys(e.reg[n].fastOr).forEach(i=>{let s=Object.assign({},e);s.reg=s.reg.slice(0),s.reg[n]=Object.assign({},s.reg[n]),s.reg[n].word=i,delete s.reg[n].operator,delete s.reg[n].fastOr,r.push(s)})}return r}(a);t.length>0?Md=Md.concat(t):Md.push(a)}),Md.forEach(a=>(a.required=function(t){let e=[],r=[];return t.forEach(n=>{n.optional!==!0&&n.negative!==!0&&(n.tag!==void 0&&e.push(n.tag),n.word!==void 0&&r.push(n.word))}),{tags:nG(e),words:nG(r)}}(a.reg),a));var z6e=Md,G6e=tG,H6e=D6e,q6e=function(a){z6e.forEach(t=>{let e=[];t.required.words.forEach(s=>{e.push(a._cache.words[s]||[])}),t.required.tags.forEach(s=>{e.push(a._cache.tags[s]||[])});let r=function(s){if(s.length===0)return[];let o={};s.forEach(u=>{u=G6e(u);for(let c=0;c<u.length;c++)o[u[c]]=o[u[c]]||0,o[u[c]]+=1});let l=Object.keys(o);return l=l.filter(u=>o[u]===s.length),l=l.map(u=>Number(u)),l}(e);if(r.length===0)return;let n=r.map(s=>a.list[s]),i=a.buildFrom(n).match(t.reg,t.group);i.found&&(t.safe===!0?i.tagSafe(t.tag,t.reason):i.tag(t.tag,t.reason))})},W6e=HCe,$6e=o6e,K6e=O6e,X6e=function(a){return q6e(a),H6e(a),a},Y6e=function(a){let t=a.termList();return a=W6e(a,t),a=$6e(a,t),(a=K6e(a)).cache(),(a=X6e(a)).uncache(),a.world.taggers.forEach(e=>{e(a)}),a},Z6e=function(a){class t extends a{stripPeriods(){return this.termList().forEach(r=>{r.tags.Abbreviation===!0&&r.next&&(r.post=r.post.replace(/^\./,""));let n=r.text.replace(/\./,"");r.set(n)}),this}addPeriods(){return this.termList().forEach(r=>{r.post=r.post.replace(/^\./,""),r.post="."+r.post}),this}}return t.prototype.unwrap=t.prototype.stripPeriods,a.prototype.abbreviations=function(e){let r=this.match("#Abbreviation");return typeof e=="number"&&(r=r.get(e)),new t(r.list,this,this.world)},a},J6e=/\./,Q6e=function(a){class t extends a{stripPeriods(){return this.termList().forEach(r=>{let n=r.text.replace(/\./g,"");r.set(n)}),this}addPeriods(){return this.termList().forEach(r=>{let n=r.text.replace(/\./g,"");n=n.split("").join("."),J6e.test(r.post)===!1&&(n+="."),r.set(n)}),this}}return t.prototype.unwrap=t.prototype.stripPeriods,t.prototype.strip=t.prototype.stripPeriods,a.prototype.acronyms=function(e){let r=this.match("#Acronym");return typeof e=="number"&&(r=r.get(e)),new t(r.list,this,this.world)},a},eAe=function(a){return a.prototype.clauses=function(t){let e=this.if("@hasComma").notIf("@hasComma @hasComma").notIf("@hasComma . .? (and|or) .").notIf("(#City && @hasComma) #Country").notIf("(#WeekDay && @hasComma) #Date").notIf("(#Date && @hasComma) #Year").notIf("@hasComma (too|also)$").match("@hasComma"),r=this.splitAfter(e),n=r.quotations();r=r.splitOn(n);let i=r.parentheses();r=r.splitOn(i);let s=r.if("#Copula #Adjective #Conjunction (#Pronoun|#Determiner) #Verb").match("#Conjunction");r=r.splitBefore(s);let o=r.if("if .{2,9} then .").match("then");r=r.splitBefore(o),r=r.splitBefore("as well as ."),r=r.splitBefore("such as ."),r=r.splitBefore("in addition to ."),r=r.splitAfter("@hasSemicolon"),r=r.splitAfter("@hasDash");let l=r.filter(u=>u.wordCount()>5&&u.match("#Verb+").length>=2);if(l.found){let u=l.splitAfter("#Noun .* #Verb .* #Noun+");r=r.splitOn(u.eq(0))}return typeof t=="number"&&(r=r.get(t)),new a(r.list,this,this.world)},a},tAe=function(a){class t extends a{constructor(r,n,i){super(r,n,i),this.contracted=null}expand(){return this.list.forEach(r=>{let n=r.terms(),i=n[0].isTitleCase();n.forEach((s,o)=>{s.set(s.implicit||s.text),s.implicit=void 0,o<n.length-1&&s.post===""&&(s.post+=" ")}),i&&n[0].toTitleCase()}),this}}return a.prototype.contractions=function(e){let r=this.match("@hasContraction+");return typeof e=="number"&&(r=r.get(e)),new t(r.list,this,this.world)},a.prototype.expanded=a.prototype.isExpanded,a.prototype.contracted=a.prototype.isContracted,a},rAe=function(a){let t=function(r){let n=r.splitAfter("@hasComma").splitOn("(and|or) not?").not("(and|or) not?"),i=r.match("[.] (and|or)",0);return{things:n,conjunction:r.match("(and|or) not?"),beforeLast:i,hasOxford:i.has("@hasComma")}};class e extends a{conjunctions(){return this.match("(and|or)")}parts(){return this.splitAfter("@hasComma").splitOn("(and|or) not?")}items(){return t(this).things}add(n){return this.forEach(i=>{let s=t(i).beforeLast;s.append(n),s.termList(0).addPunctuation(",")}),this}remove(n){return this.items().if(n).remove()}hasOxfordComma(){return this.filter(n=>t(n).hasOxford)}addOxfordComma(){let n=this.items(),i=n.eq(n.length-2);return i.found&&i.has("@hasComma")===!1&&i.post(", "),this}removeOxfordComma(){let n=this.items(),i=n.eq(n.length-2);return i.found&&i.has("@hasComma")===!0&&i.post(" "),this}}return e.prototype.things=e.prototype.items,a.prototype.lists=function(r){let n=this.if("@hasComma+ .? (and|or) not? ."),i=n.match("(#Noun|#Adjective|#Determiner|#Article)+ #Conjunction not? (#Article|#Determiner)? #Adjective? #Noun+").if("#Noun"),s=n.match("(#Adjective|#Adverb)+ #Conjunction not? #Adverb? #Adjective+"),o=n.match("(#Verb|#Adverb)+ #Conjunction not? #Adverb? #Verb+"),l=i.concat(s);return l=l.concat(o),l=l.if("@hasComma"),typeof r=="number"&&(l=n.get(r)),new e(l.list,this,this.world)},a},aG={hour:"an",heir:"an",heirloom:"an",honest:"an",honour:"an",honor:"an",uber:"an"},nAe={a:!0,e:!0,f:!0,h:!0,i:!0,l:!0,m:!0,n:!0,o:!0,r:!0,s:!0,x:!0},iG=[/^onc?e/i,/^u[bcfhjkqrstn][aeiou]/i,/^eul/i],sG={isSingular:[/(ax|test)is$/i,/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,/(octop|vir)i$/i,/(rl)f$/i,/(alias|status)$/i,/(bu)s$/i,/(al|ad|at|er|et|ed|ad)o$/i,/(ti)um$/i,/(ti)a$/i,/sis$/i,/(?:(^f)fe|(lr)f)$/i,/hive$/i,/(^aeiouy|qu)y$/i,/(x|ch|ss|sh|z)$/i,/(matr|vert|ind|cort)(ix|ex)$/i,/(m|l)ouse$/i,/(m|l)ice$/i,/(antenn|formul|nebul|vertebr|vit)a$/i,/.sis$/i,/^(?!talis|.*hu)(.*)man$/i],isPlural:[/(antenn|formul|nebul|vertebr|vit)ae$/i,/(octop|vir|radi|nucle|fung|cact|stimul)i$/i,/men$/i,/.tia$/i,/(m|l)ice$/i]},aAe=/s$/,oG={he:"his",she:"hers",they:"theirs",we:"ours",i:"mine",you:"yours",her:"hers",their:"theirs",our:"ours",my:"mine",your:"yours"},vR=function(a){return a.has("#Plural")===!0||a.has("(#Pronoun|#Place|#Value|#Person|#Uncountable|#Month|#WeekDay|#Holiday|#Possessive)")!==!0},lG=function(a){if(a.has("#Person")||a.has("#Place"))return"";if(a.has("#Plural"))return"the";let t=a.text("normal").trim();if(aG.hasOwnProperty(t))return aG[t];let e=t.substr(0,1);if(a.has("^@isAcronym")&&nAe.hasOwnProperty(e))return"an";for(let r=0;r<iG.length;r++)if(iG[r].test(t))return"a";return/^[aeiou]/i.test(t)?"an":"a"},uG=function(a){return!sG.isSingular.find(t=>t.test(a))&&(aAe.test(a)===!0||!!sG.isPlural.find(t=>t.test(a))||null)},iAe=function(a){let t=a.text("text").trim();return oG.hasOwnProperty(t)?(a.replaceWith(oG[t],!0),void a.tag("Possessive","toPossessive")):/s$/.test(t)?(t+="'",a.replaceWith(t,!0),void a.tag("Possessive","toPossessive")):(t+="'s",a.replaceWith(t,!0),void a.tag("Possessive","toPossessive"))},cG=function(a){let t={main:a};if(a.has("#Noun (of|by|for) .")){let e=a.splitAfter("[#Noun+]",0);t.main=e.eq(0),t.post=e.eq(1)}return t},sAe={json:function(a){let t=null;typeof a=="number"&&(t=a,a=null),a=a||{text:!0,normal:!0,trim:!0,terms:!0};let e=[];return this.forEach(r=>{let n=r.json(a)[0];n.article=lG(r),e.push(n)}),t!==null?e[t]:e},adjectives:function(){let a=this.lookAhead("^(that|who|which)? (was|is|will)? be? #Adverb? #Adjective+");return a=a.concat(this.lookBehind("#Adjective+ #Adverb?$")),a=a.match("#Adjective"),a.sort("index")},isPlural:function(){return this.if("#Plural")},hasPlural:function(){return this.filter(a=>vR(a))},toPlural:function(a){let t=this.world.transforms.toPlural;return this.forEach(e=>{if(e.has("#Plural")||vR(e)===!1)return;let r=cG(e).main,n=r.text("reduced");if((r.has("#Singular")||uG(n)!==!0)&&(n=t(n,this.world),r.replace(n).tag("#Plural"),a)){let i=r.lookBefore("(an|a) #Adjective?$").not("#Adjective");i.found===!0&&i.remove()}}),this},toSingular:function(a){let t=this.world.transforms.toSingular;return this.forEach(e=>{if(e.has("^#Singular+$")||vR(e)===!1)return;let r=cG(e).main,n=r.text("reduced");if((r.has("#Plural")||uG(n)===!0)&&(n=t(n,this.world),r.replace(n).tag("#Singular"),a)){let i=e,s=e.lookBefore("#Adjective");s.found&&(i=s);let o=lG(i);i.insertBefore(o)}}),this},toPossessive:function(){return this.forEach(a=>{iAe(a)}),this}},oAe=function(a){class t extends a{}return Object.assign(t.prototype,sAe),a.prototype.nouns=function(e,r={}){let n=this.match("(#City && @hasComma) (#Region|#Country)"),i=this.not(n).splitAfter("@hasComma");i=i.concat(n);let s=i.quotations();return s.found&&(i=i.splitOn(s.eq(0))),i=i.match("#Noun+ (of|by)? the? #Noun+?"),r.keep_anaphora!==!0&&(i=i.not("#Pronoun"),i=i.not("(there|these)"),i=i.not("(#Month|#WeekDay)"),i=i.not("(my|our|your|their|her|his)")),i=i.not("(of|for|by|the)$"),typeof e=="number"&&(i=i.get(e)),new t(i.list,this,this.world)},a},pG=/\(/,mG=/\)/,lAe=function(a){class t extends a{unwrap(){return this.list.forEach(r=>{let n=r.terms(0);n.pre=n.pre.replace(pG,"");let i=r.lastTerm();i.post=i.post.replace(mG,"")}),this}}return a.prototype.parentheses=function(e){let r=[];return this.list.forEach(n=>{let i=n.terms();for(let s=0;s<i.length;s+=1){let o=i[s];if(pG.test(o.pre)){for(let l=s;l<i.length;l+=1)if(mG.test(i[l].post)){let u=l-s+1;r.push(n.buildFrom(o.id,u)),s=l;break}}}}),typeof e=="number"?(r=r[e]?[r[e]]:[],new t(r,this,this.world)):new t(r,this,this.world)},a},uAe=function(a){class t extends a{constructor(r,n,i){super(r,n,i),this.contracted=null}strip(){return this.list.forEach(r=>{r.terms().forEach(n=>{let i=n.text.replace(/'s$/,"");n.set(i||n.text)})}),this}}return a.prototype.possessives=function(e){let r=this.match("#Noun+? #Possessive");return typeof e=="number"&&(r=r.get(e)),new t(r.list,this,this.world)},a},fG={'"':'"',"\uFF02":"\uFF02","'":"'","\u201C":"\u201D","\u2018":"\u2019","\u201F":"\u201D","\u201B":"\u2019","\u201E":"\u201D","\u2E42":"\u201D","\u201A":"\u2019","\xAB":"\xBB","\u2039":"\u203A","\u2035":"\u2032","\u2036":"\u2033","\u2037":"\u2034","\u301D":"\u301E","`":"\xB4","\u301F":"\u301E"},dG=RegExp("("+Object.keys(fG).join("|")+")"),cAe=function(a){class t extends a{unwrap(){return this}}return a.prototype.quotations=function(e){let r=[];return this.list.forEach(n=>{let i=n.terms();for(let s=0;s<i.length;s+=1){let o=i[s];if(dG.test(o.pre)){let l=(o.pre.match(dG)||[])[0],u=fG[l];for(let c=s;c<i.length;c+=1)if(i[c].post.indexOf(u)!==-1){let p=c-s+1;r.push(n.buildFrom(o.id,p)),s=c;break}}}}),typeof e=="number"?(r=r[e]?[r[e]]:[],new t(r,this,this.world)):new t(r,this,this.world)},a.prototype.quotes=a.prototype.quotations,a},hG=function(a,t){let e=a.verb,r=e.text("reduced");if(e.has("#Infinitive"))return r;let n=null;return e.has("#PastTense")?n="PastTense":e.has("#Gerund")?n="Gerund":e.has("#PresentTense")?n="PresentTense":e.has("#Participle")?n="Participle":e.has("#Actor")&&(n="Actor"),t.transforms.toInfinitive(r,t,n)},X1=function(a){let t=a.verb;if(t.has("(are|were|does)")||a.auxiliary.has("(are|were|does)"))return!0;let e=function(r){return r.lookBehind("#Noun+").last()}(t);return!e.has("(he|she|many|both)")&&(!!e.has("(we|they|you|i)")||!e.has("#Person")&&(!!e.has("#Plural")||!e.has("#Singular")&&!t.has("(is|am|do|was)")&&!(a.auxiliary.has("(is|am|do|was)")&&!a.negative.found)&&null))},TR=hG,yG=X1,bG=function(a){let t=a.lookBehind(),e=t.nouns(null,{keep_anaphora:!0}).last();return e.found||(e=t.match("(that|this|each)").last(),e=e.tag("#Noun").nouns()),e},pAe=bG,mAe=X1,gG=hG,fAe=a=>{let t=!1,e=mAe(a),r=a.negative.found;a.verb.lookBehind("i (#Adverb|#Verb)?$").found&&(t=!0);let n={PastTense:"was",PresentTense:"is",FutureTense:"will be",Infinitive:"is",Gerund:"being",Actor:"",PerfectTense:"been",Pluperfect:"been"};return e&&(n.PastTense="were",n.PresentTense="are",n.Infinitive="are"),t===!0&&(n.PastTense="was",n.PresentTense="am",n.Infinitive="am"),r&&(n.PastTense+=" not",n.PresentTense+=" not",n.FutureTense="will not be",n.Infinitive+=" not",n.PerfectTense="not "+n.PerfectTense,n.Pluperfect="not "+n.Pluperfect,n.Gerund="not "+n.Gerund),n},dAe=function(a){let t=a.verb.text();return{PastTense:t+" have",PresentTense:t,FutureTense:t,Infinitive:t}},hAe=X1,vG=function(a,t){let e=a.verb;if(e.has("#Copula")||e.out("normal")==="be"&&a.auxiliary.has("will"))return fAe(a);if(a.auxiliary.has("are")&&e.has("#Gerund")){let l=a.original.clone(),u=l.clone().replace("are","were"),c=l.clone().replace("are","will be"),p=gG(a,t);return{PastTense:u.text(),PresentTense:l.text(),FutureTense:c.text(),Infinitive:p}}if(e.has("#Modal"))return dAe(a);let r=gG(a,t);if(!r)return{};let n=t.transforms.conjugate(r,t);n.Infinitive=r;let i=hAe(a);i===!0&&(n.PresentTense=n.Infinitive);let s=a.verb.termList(0).hasHyphen();if(a.particle.found){let l=a.particle.text(),u=s===!0?"-":" ";Object.keys(n).forEach(c=>n[c]+=u+l)}let o=a.negative.found;return n.FutureTense=n.FutureTense||"will "+n.Infinitive,o&&(n.PastTense="did not "+n.Infinitive,n.FutureTense="will not "+n.Infinitive,i?(n.PresentTense="do not "+n.Infinitive,n.Infinitive="do not "+n.Infinitive):(n.PresentTense="does not "+n.Infinitive,n.Infinitive="does not "+n.Infinitive),n.Gerund="not "+n.Gerund),n},yAe=vG,bAe={useParticiple:function(a){return!!a.auxiliary.has("(could|should|would|may|can|must)")||!!a.auxiliary.has("am .+? being")||!!a.auxiliary.has("had .+? been")},toParticiple:function(a,t){if(a.auxiliary.has("(have|had)")&&a.verb.has("#Participle"))return;let e=yAe(a,t),r=e.Participle||e.PastTense;r&&a.verb.replaceWith(r,!1),a.auxiliary.has("am .+? being")&&(a.auxiliary.remove("am"),a.auxiliary.replace("being","have been")),a.auxiliary.has("have")||a.auxiliary.append("have"),a.verb.tag("Participle","toParticiple"),a.auxiliary.replace("can","could"),a.auxiliary.replace("be have","have been"),a.auxiliary.replace("not have","have not"),a.auxiliary.tag("Auxiliary")}},gAe=function(a,t){let e=a.verb;if(!a.negative.found){if(a.auxiliary.found)return a.auxiliary.eq(0).append("not"),void(a.auxiliary.has("#Modal have not")&&a.auxiliary.replace("have not","not have"));if(e.has("(#Copula|will|has|had|do)"))e.append("not");else{if(e.has("#PastTense")){let r=TR(a,t);return e.replaceWith(r,!0),void e.prepend("did not")}if(e.has("#PresentTense")){let r=TR(a,t);return e.replaceWith(r,!0),void(yG(a)?e.prepend("do not"):e.prepend("does not"))}if(e.has("#Gerund")){let r=TR(a,t);return e.replaceWith(r,!0),void e.prepend("not")}yG(a)?e.prepend("does not"):e.prepend("do not")}}},ia=function(a){let t={adverb:a.match("#Adverb+"),negative:a.match("#Negative"),auxiliary:a.match("#Auxiliary+").not("(#Negative|#Adverb)"),particle:a.match("#Particle"),verb:a.match("#Verb+").not("(#Adverb|#Negative|#Auxiliary|#Particle)"),original:a,subject:pAe(a)};if(t.verb.has("(#PresentTense|#PastTense|#Infinitive) #Gerund$")&&(t.verb=t.verb.not("#Gerund$")),!t.verb.found)return Object.keys(t).forEach(e=>{t[e]=t[e].not(".")}),t.verb=a,t;if(t.adverb&&t.adverb.found){let e=t.adverb.text("reduced")+"$";a.has(e)&&(t.adverbAfter=!0)}return t},TG=X1,vAe=bG,Vl=vG,{toParticiple:NG,useParticiple:CG}=bAe,NR=function(a){return a.auxiliary.remove("(will|are|am|being)"),a.auxiliary.remove("(did|does)"),a.auxiliary.remove("(had|has|have)"),a.particle.remove(),a.negative.remove(),a},TAe={json:function(a){let t=null;typeof a=="number"&&(t=a,a=null),a=a||{text:!0,normal:!0,trim:!0,terms:!0};let e=[];return this.forEach(r=>{let n=r.json(a)[0],i=ia(r);n.parts={},Object.keys(i).forEach(s=>{i[s]&&i[s].isA==="Doc"?n.parts[s]=i[s].text("normal"):n.parts[s]=i[s]}),n.isNegative=r.has("#Negative"),n.conjugations=Vl(i,this.world),e.push(n)}),t!==null?e[t]:e},adverbs:function(){let a=[];this.forEach(e=>{let r=ia(e).adverb;r.found&&(a=a.concat(r.list))});let t=this.lookBehind("#Adverb+$");return t.found&&(a=t.list.concat(a)),t=this.lookAhead("^#Adverb+"),t.found&&(a=a.concat(t.list)),this.buildFrom(a)},isPlural:function(){let a=[];return this.forEach(t=>{let e=ia(t);TG(e,this.world)===!0&&a.push(t.list[0])}),this.buildFrom(a)},isSingular:function(){let a=[];return this.forEach(t=>{let e=ia(t);TG(e,this.world)===!1&&a.push(t.list[0])}),this.buildFrom(a)},conjugate:function(){let a=[];return this.forEach(t=>{let e=ia(t),r=Vl(e,this.world);a.push(r)}),a},toPastTense:function(){return this.forEach(a=>{let t=ia(a);if(CG(t))return void NG(t,this.world);if(a.has("#Imperative")||a.has("be")&&a.lookBehind("to$").found)return;if(t.verb.has("#Gerund")&&t.auxiliary.has("(is|will|was)"))return void a.replace("is","was");let e=Vl(t,this.world).PastTense;e&&(t=NR(t),t.verb.replaceWith(e,!1),t.auxiliary.remove("(do|did|will)"))}),this},toPresentTense:function(){return this.forEach(a=>{if(a.has("#Imperative"))return;let t=ia(a),e=Vl(t,this.world),r=e.PresentTense;if(a.lookBehind("(i|we) (#Adverb|#Verb)?$").found&&(r=e.Infinitive),r){if(t.auxiliary.has("(have|had) been"))return t.auxiliary.replace("(have|had) been","am being"),void(e.Particle&&(r=e.Particle||e.PastTense));t.verb.replaceWith(r,!1),t.verb.tag("PresentTense"),t=NR(t),t.auxiliary.remove("#Modal"),t.auxiliary.remove("(do|did|will)")}}),this},toFutureTense:function(){return this.forEach(a=>{let t=ia(a);if(CG(t)||a.has("#Imperative"))return;let e=Vl(t,this.world).FutureTense;e&&(t=NR(t),t.auxiliary.remove("#Modal"),t.verb.replaceWith(e,!1),t.verb.tag("FutureTense"),t.auxiliary.remove("(do|did|will)"))}),this},toInfinitive:function(){return this.forEach(a=>{let t=ia(a),e=Vl(t,this.world).Infinitive;e&&(a.replaceWith(e,!1),a.tag("Infinitive"))}),this},toGerund:function(){return this.forEach(a=>{let t=ia(a),e=Vl(t,this.world).Gerund;e&&(a.replaceWith(e,!1),a.tag("Gerund"))}),this},toParticiple:function(){return this.forEach(a=>{let t=ia(a),e=!t.auxiliary.found;NG(t,this.world),e&&(t.verb.prepend(t.auxiliary.text()),t.auxiliary.remove())}),this},isNegative:function(){return this.if("#Negative")},isPositive:function(){return this.ifNo("#Negative")},isImperative:function(){return this.if("#Imperative")},toNegative:function(){return this.list.forEach(a=>{let t=this.buildFrom([a]),e=ia(t);gAe(e,t.world)}),this},toPositive:function(){let a=this.match("do not #Verb");return a.found&&a.remove("do not"),this.remove("#Negative")},subject:function(){let a=[];return this.forEach(t=>{let e=vAe(t);e.list[0]&&a.push(e.list[0])}),this.buildFrom(a)}},AG=Hz,NAe=[Z6e,Q6e,eAe,tAe,rAe,oAe,lAe,uAe,cAe,function(a){class t extends a{}return Object.assign(t.prototype,TAe),t.prototype.negate=t.prototype.toNegative,a.prototype.verbs=function(e){let r=this.match("(#Adverb|#Auxiliary|#Verb|#Negative|#Particle)+");r=r.not("^#Adverb+"),r=r.not("#Adverb+$");let n=r.match("(#Adverb && @hasComma) #Adverb"),i=r.not(n).splitAfter("@hasComma");return i=i.concat(n),i.sort("index"),i=i.if("#Verb"),i.has("(is|was)$")&&(i=i.splitBefore("(is|was)$")),i.has("#PresentTense #Adverb #PresentTense")&&(i=i.splitBefore("#Adverb #PresentTense")),typeof e=="number"&&(i=i.get(e)),new t(i.list,this,this.world)},a},function(a){class t extends a{}return a.prototype.people=function(e){let r=this.splitAfter("@hasComma");return r=r.match("#Person+"),typeof e=="number"&&(r=r.get(e)),new t(r.list,this,this.world)},a}],SG={misc:FCe,selections:Hz},CAe=Y6e,AAe=Od,SAe=function(a){return Object.keys(AG).forEach(t=>a.prototype[t]=AG[t]),NAe.forEach(t=>t(a)),a},ci=class{constructor(t,e,r){this.list=t,Object.defineProperty(this,"from",{enumerable:!1,value:e,writable:!0}),r===void 0&&e!==void 0&&(r=e.world),Object.defineProperty(this,"world",{enumerable:!1,value:r,writable:!0}),Object.defineProperty(this,"_cache",{enumerable:!1,writable:!0,value:{}}),Object.defineProperty(this,"found",{get:()=>this.list.length>0}),Object.defineProperty(this,"length",{get:()=>this.list.length}),Object.defineProperty(this,"isA",{get:()=>"Doc"})}tagger(){return CAe(this)}pool(){return this.list.length>0?this.list[0].pool:this.all().list[0].pool}};ci.prototype.buildFrom=function(a){return a=a.map(t=>t.clone(!0)),new ci(a,this,this.world)},ci.prototype.fromText=function(a){let t=AAe(a,this.world,this.pool());return this.buildFrom(t)},Object.assign(ci.prototype,SG.misc),Object.assign(ci.prototype,SG.selections),SAe(ci);var wG={untag:"unTag",and:"match",notIf:"ifNo",only:"if",onlyIf:"if"};Object.keys(wG).forEach(a=>ci.prototype[a]=ci.prototype[wG[a]]);var wAe=dR,EG=Od,EAe=zNe,Y1=ci,RAe=nR,xAe=rR,VAe=aR,OAe=function(a){let t=a.termList();return wAe(t,a.world),a.world.taggers.forEach(e=>{e(a)}),a},DAe=Vd,IAe=function a(t){let e=t,r=function(n="",i){i&&e.addWords(i);let s=EG(n,e),o=new Y1(s,null,e);return o.tagger(),o};return r.tokenize=function(n="",i){let s=e;i&&(s=s.clone(),s.words={},s.addWords(i));let o=EG(n,s),l=new Y1(o,null,s);return(i||l.world.taggers.length>0)&&OAe(l),l},r.extend=function(n){return n(Y1,e,this,RAe,xAe,VAe),this},r.fromJSON=function(n){let i=EAe(n,e);return new Y1(i,null,e)},r.clone=function(){return a(e.clone())},r.verbose=function(n=!0){return e.verbose(n),this},r.world=function(){return e},r.parseMatch=function(n,i){return DAe(n,i)},r.version="13.11.4",r.import=r.load,r.plugin=r.extend,r}(new CCe),Z1=IAe;var PAe=function(a,t){let e=a.match("#Value+? #Money+ #Currency+ (and #Money+ #Currency+)+?");return a.match("#Money").forEach(r=>{r.lookAfter("#Currency").found||(e=e.concat(r))}),typeof t=="number"&&(e=e.get(t)),e},io="twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety|fourty",_Ae=function(a,t){let e=a.match("#Value+");if(e.has("#NumericValue #NumericValue")&&(e.has("#Value @hasComma #Value")?e.splitAfter("@hasComma"):e.has("#NumericValue #Fraction")?e.splitAfter("#NumericValue #Fraction"):e=e.splitAfter("#NumericValue")),e.has("#Value #Value #Value")&&!e.has("#Multiple")&&e.has("("+io+") #Cardinal #Cardinal")&&(e=e.splitAfter("("+io+") #Cardinal")),e.has("#Value #Value")){e.has("#NumericValue #NumericValue")&&(e=e.splitOn("#Year")),e.has("("+io+") (eleven|twelve|thirteen|fourteen|fifteen|sixteen|seventeen|eighteen|nineteen)")&&(e=e.splitAfter("("+io+")"));let r=e.match("#Cardinal #Cardinal");if(r.found&&!e.has("(point|decimal|#Fraction)")&&!r.has("#Cardinal (#Multiple|point|decimal)")){let n=e.has(`(one|two|three|four|five|six|seven|eight|nine) (${io})`),i=r.has("("+io+") #Cardinal"),s=r.has("#Multiple #Value");n||i||s||r.terms().forEach(o=>{e=e.splitOn(o)})}e.match("#Ordinal #Ordinal").match("#TextValue").found&&!e.has("#Multiple")&&(e.has("("+io+") #Ordinal")||(e=e.splitAfter("#Ordinal"))),e.has("#Ordinal #Cardinal")&&(e=e.splitBefore("#Cardinal+")),e.has("#TextValue #NumericValue")&&!e.has("("+io+"|#Multiple)")&&(e=e.splitBefore("#NumericValue+"))}return e.has("#NumberRange")&&(e=e.splitAfter("#NumberRange")),typeof t=="number"&&(e=e.get(t)),e},kAe=function(a,t){let e=a.match("#Fraction+");return e=e.filter(r=>!r.lookBehind("#Value and$").found),typeof t=="number"&&(e=e.eq(t)),e},FAe=function(a,t){let e=a.match("#Percent+");return e=e.concat(a.match("[#Cardinal] percent",0)),typeof t=="number"&&(e=e.eq(t)),e},CR={ones:{zeroth:0,first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9,zero:0,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9},teens:{tenth:10,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19},tens:{twentieth:20,thirtieth:30,fortieth:40,fourtieth:40,fiftieth:50,sixtieth:60,seventieth:70,eightieth:80,ninetieth:90,twenty:20,thirty:30,forty:40,fourty:40,fifty:50,sixty:60,seventy:70,eighty:80,ninety:90},multiples:{hundredth:100,thousandth:1e3,millionth:1e6,billionth:1e9,trillionth:1e12,quadrillionth:1e15,quintillionth:1e18,sextillionth:1e21,septillionth:1e24,hundred:100,thousand:1e3,million:1e6,billion:1e9,trillion:1e12,quadrillion:1e15,quintillion:1e18,sextillion:1e21,septillion:1e24,grand:1e3}},AR=CR,xp=CR,jAe=a=>{let t=[{reg:/^(minus|negative)[\s\-]/i,mult:-1},{reg:/^(a\s)?half[\s\-](of\s)?/i,mult:.5}];for(let e=0;e<t.length;e++)if(t[e].reg.test(a)===!0)return{amount:t[e].mult,str:a.replace(t[e].reg,"")};return{amount:1,str:a}},Ea=CR,MAe=(a,t)=>{if(AR.ones.hasOwnProperty(a)){if(t.ones||t.teens)return!1}else if(AR.teens.hasOwnProperty(a)){if(t.ones||t.teens||t.tens)return!1}else if(AR.tens.hasOwnProperty(a)&&(t.ones||t.teens||t.tens))return!1;return!0},BAe=function(a){let t="0.";for(let e=0;e<a.length;e++){let r=a[e];if(xp.ones.hasOwnProperty(r)===!0)t+=xp.ones[r];else if(xp.teens.hasOwnProperty(r)===!0)t+=xp.teens[r];else if(xp.tens.hasOwnProperty(r)===!0)t+=xp.tens[r];else{if(/^[0-9]$/.test(r)!==!0)return 0;t+=r}}return parseFloat(t)},LAe=a=>a=(a=(a=(a=(a=(a=(a=(a=a.replace(/1st$/,"1")).replace(/2nd$/,"2")).replace(/3rd$/,"3")).replace(/([4567890])r?th$/,"$1")).replace(/^[$]/,"")).replace(/[%$]$/,"")).replace(/,/g,"")).replace(/([0-9])([a-z\u00C0-\u00FF]{1,2})$/,"$1"),UAe=/^([0-9,\. ]+)\/([0-9,\. ]+)$/,RG={"a few":3,"a couple":2,"a dozen":12,"two dozen":24,zero:0},J1=a=>Object.keys(a).reduce((t,e)=>t+=a[e],0),SR=function(a){if(RG.hasOwnProperty(a)===!0)return RG[a];if(a==="a"||a==="an")return 1;let t=jAe(a),e=null,r={},n=0,i=!1,s=(a=t.str).split(/[ -]/);for(let o=0;o<s.length;o++){let l=s[o];if(l=LAe(l),!l||l==="and")continue;if(l==="-"||l==="negative"){i=!0;continue}if(l.charAt(0)==="-"&&(i=!0,l=l.substr(1)),l==="point")return n+=J1(r),n+=BAe(s.slice(o+1,s.length)),n*=t.amount,n;let u=l.match(UAe);if(u){let c=parseFloat(u[1].replace(/[, ]/g,"")),p=parseFloat(u[2].replace(/[, ]/g,""));p&&(n+=c/p||0)}else{if(Ea.tens.hasOwnProperty(l)&&r.ones&&Object.keys(r).length===1&&(n=100*r.ones,r={}),MAe(l,r)===!1)return null;if(/^[0-9\.]+$/.test(l))r.ones=parseFloat(l);else if(Ea.ones.hasOwnProperty(l)===!0)r.ones=Ea.ones[l];else if(Ea.teens.hasOwnProperty(l)===!0)r.teens=Ea.teens[l];else if(Ea.tens.hasOwnProperty(l)===!0)r.tens=Ea.tens[l];else if(Ea.multiples.hasOwnProperty(l)===!0){let c=Ea.multiples[l];if(c===e)return null;if(c===100&&s[o+1]!==void 0){let p=s[o+1];Ea.multiples[p]&&(c*=Ea.multiples[p],o+=1)}e===null||c<e?(n+=(J1(r)||1)*c,e=c,r={}):(n+=J1(r),e=c,n=(n||1)*c,r={})}}}return n+=J1(r),n*=t.amount,n*=i?-1:1,n===0&&Object.keys(r).length===0?null:n},xG=/s$/,zAe=SR,Bd=function(a){let t=a.text("reduced");return zAe(t)},Q1={half:2,halve:2,quarter:4},VG=function(a){let t=function(e){let r=e.text("reduced");return Q1.hasOwnProperty(r)?{numerator:1,denominator:Q1[r]}:null}(a=a.clone())||function(e){let r=e.text("reduced").match(/^([-+]?[0-9]+)\/([-+]?[0-9]+)(st|nd|rd|th)?s?$/);return r&&r[1]&&r[0]?{numerator:Number(r[1]),denominator:Number(r[2])}:null}(a)||function(e){let r=e.match("[<num>#Value+] out of every? [<den>#Value+]");if(r.found!==!0)return null;let{num:n,den:i}=r.groups();return n&&i?(n=Bd(n),i=Bd(i),typeof n=="number"&&typeof i=="number"?{numerator:n,denominator:i}:null):null}(a)||function(e){let r=e.match("[<num>(#Cardinal|a)+] [<dem>#Fraction+]");if(r.found!==!0)return null;let{num:n,dem:i}=r.groups();n=n.has("a")?1:Bd(n);let s=i.text("reduced");return xG.test(s)&&(s=s.replace(xG,""),i.replaceWith(s)),i=Q1.hasOwnProperty(s)?Q1[s]:Bd(i),typeof n=="number"&&typeof i=="number"?{numerator:n,denominator:i}:null}(a)||function(e){let r=e.match("^#Ordinal$");return r.found!==!0?null:e.lookAhead("^of .")?{numerator:1,denominator:Bd(r)}:null}(a)||null;return t!==null&&t.numerator&&t.denominator&&(t.decimal=t.numerator/t.denominator,t.decimal=(e=>{let r=Math.round(1e3*e)/1e3;return r===0&&e!==0?e:r})(t.decimal)),t},GAe=SR,HAe=VG,wR=function(a){let t=a.text("reduced"),e=/[0-9],[0-9]/.test(a.text("text")),r=function(o,l,u){let c=(o=o.replace(/,/g,"")).split(/^([^0-9]*)([0-9.,]*)([^0-9]*)$/);if(c&&c[2]&&l.terms().length<2){let p=parseFloat(c[2]||o);typeof p!="number"&&(p=null);let m=c[3]||"";return m!=="st"&&m!=="nd"&&m!=="rd"&&m!=="th"||(m=""),m!=="m"&&m!=="M"||(p*=1e6,m=""),m!=="k"&&m!=="k"||(p*=1e3,m=""),p=u?1/p:p,{prefix:c[1]||"",num:p,suffix:m}}return null}(t,a);if(r!==null)return r.hasComma=e,r;let n=a.match("#Fraction #Fraction+$");n=n.found===!1?a.match("^#Fraction$"):n;let i=null;n.found&&(i=HAe(n),t=(a=(a=a.not(n)).not("and$")).text("reduced"));let s=0;return t&&(s=GAe(t)||0),i&&i.decimal&&(s+=i.decimal),{hasComma:e,prefix:"",num:s,suffix:""}},ER=function(a){if(a<1e6)return String(a);let t;return t=typeof a=="number"?a.toFixed(0):a,t.indexOf("e+")===-1?t:t.replace(".","").split("e+").reduce(function(e,r){return e+Array(r-e.length+2).join(0)})},OG=ER,e0=[["ninety",90],["eighty",80],["seventy",70],["sixty",60],["fifty",50],["forty",40],["thirty",30],["twenty",20]],DG=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],qAe=[[1e24,"septillion"],[1e20,"hundred sextillion"],[1e21,"sextillion"],[1e20,"hundred quintillion"],[1e18,"quintillion"],[1e17,"hundred quadrillion"],[1e15,"quadrillion"],[1e14,"hundred trillion"],[1e12,"trillion"],[1e11,"hundred billion"],[1e9,"billion"],[1e8,"hundred million"],[1e6,"million"],[1e5,"hundred thousand"],[1e3,"thousand"],[100,"hundred"],[1,"one"]],WAe=function(a){let t=[];if(a>100)return t;for(let e=0;e<e0.length;e++)a>=e0[e][1]&&(a-=e0[e][1],t.push(e0[e][0]));return DG[a]&&t.push(DG[a]),t},RR=function(a){if(a===0||a==="0")return"zero";a>1e21&&(a=OG(a));let t=[];a<0&&(t.push("minus"),a=Math.abs(a));let e=function(r){let n=r,i=[];return qAe.forEach(s=>{if(r>=s[0]){let o=Math.floor(n/s[0]);n-=o*s[0],o&&i.push({unit:s[1],count:o})}}),i}(a);for(let r=0;r<e.length;r++){let n=e[r].unit;n==="one"&&(n="",t.length>1&&t.push("and")),t=t.concat(WAe(e[r].count)),t.push(n)}return t=t.concat((r=>{let n=["zero","one","two","three","four","five","six","seven","eight","nine"],i=[],s=OG(r).match(/\.([0-9]+)/);if(!s||!s[0])return i;i.push("point");let o=s[0].split("");for(let l=0;l<o.length;l++)i.push(n[o[l]]);return i})(a)),t=t.filter(r=>r),t.length===0&&(t[0]=""),t.join(" ")},$Ae=ER,KAe=RR,IG={one:"first",two:"second",three:"third",five:"fifth",eight:"eighth",nine:"ninth",twelve:"twelfth",twenty:"twentieth",thirty:"thirtieth",forty:"fortieth",fourty:"fourtieth",fifty:"fiftieth",sixty:"sixtieth",seventy:"seventieth",eighty:"eightieth",ninety:"ninetieth"},PG=a=>{let t=KAe(a).split(" "),e=t[t.length-1];return IG.hasOwnProperty(e)?t[t.length-1]=IG[e]:t[t.length-1]=e.replace(/y$/,"i")+"th",t.join(" ")},_G={prefixes:{"\xA2":"cents",$:"dollars","\xA3":"pounds","\xA5":"yen","\u20AC":"euros","\u20A1":"col\xF3n","\u0E3F":"baht","\u20AD":"kip","\u20A9":"won","\u20B9":"rupees","\u20BD":"ruble","\u20BA":"liras"},suffixes:{"%":"percent",s:"seconds",cm:"centimetres",km:"kilometres"}},XAe=ER,YAe=RR,ZAe=function(a){if(!a&&a!==0)return null;let t=a%100;if(t>10&&t<20)return String(a)+"th";let e={0:"th",1:"st",2:"nd",3:"rd"},r=$Ae(a),n=r.slice(r.length-1,r.length);return r+=e[n]?e[n]:"th",r},JAe=PG,kG=_G.prefixes,FG=_G.suffixes,QAe={usd:!0,eur:!0,jpy:!0,gbp:!0,cad:!0,aud:!0,chf:!0,cny:!0,hkd:!0,nzd:!0,kr:!0,rub:!0},jG=function(a){return kG.hasOwnProperty(a.prefix)&&(a.suffix+=kG[a.prefix],a.prefix=""),FG.hasOwnProperty(a.suffix)&&(a.suffix=FG[a.suffix]),QAe.hasOwnProperty(a.suffix)&&(a.suffix=a.suffix.toUpperCase()),a.suffix&&(a.suffix=" "+a.suffix),a},MG=function(a,t,e){let r=String(a.num);return t?(a=jG(a),e?(r=JAe(r),`${a.prefix||""}${r}${a.suffix||""}`):(r=YAe(r),`${a.prefix||""}${r}${a.suffix||""}`)):e?(r=ZAe(r),`${(a=jG(a)).prefix||""}${r}${a.suffix||""}`):(a.hasComma===!0&&(r=a.num.toLocaleString()),r=XAe(r),`${a.prefix||""}${r}${a.suffix||""}`)},Sn=wR,xR=function(a,t,e){if(a===!1)return;let r=t.lookAhead("^(#Unit|#Noun)");r.has("(#Address|#Money|#Percent)")||t.has("#Ordinal")||(e.num===1?r.nouns().toSingular():r.has("#Singular")&&r.nouns().toPlural())},Ra=MG,BG=SR,xa={json:function(a){let t=null;typeof a=="number"&&(t=a,a=null),a=a||{text:!0,normal:!0,trim:!0,terms:!0};let e=[];return this.forEach(r=>{let n=r.json(a)[0],i=Sn(r);n.prefix=i.prefix,n.number=i.num,n.suffix=i.suffix,n.cardinal=Ra(i,!1,!1),n.ordinal=Ra(i,!1,!0),n.textCardinal=Ra(i,!0,!1),n.textOrdinal=Ra(i,!0,!0),e.push(n)}),t!==null?e[t]:e},units:function(){let a=this.lookAhead("(#Unit|#Noun)+");return a=a.splitAfter("@hasComma").first(),a=a.not("#Pronoun"),a.first()},isOrdinal:function(){return this.if("#Ordinal")},isCardinal:function(){return this.if("#Cardinal")},toNumber:function(){return this.forEach(a=>{let t=Sn(a);if(t.num===null)return;let e=Ra(t,!1,a.has("#Ordinal"));a.replaceWith(e,!0),a.tag("NumericValue")}),this},toLocaleString:function(){return this.forEach(a=>{let t=Sn(a);if(t.num===null)return;t.num=t.num.toLocaleString();let e=Ra(t,!1,a.has("#Ordinal"));a.replaceWith(e,!0)}),this},toText:function(){return this.forEach(a=>{let t=Sn(a);if(t.num===null)return;let e=Ra(t,!0,a.has("#Ordinal"));a.replaceWith(e,!0),a.tag("TextValue")}),this},toCardinal:function(a){return this.if("#Ordinal").forEach(t=>{let e=Sn(t);if(e.num===null)return;let r=Ra(e,t.has("#TextValue"),!1);if(t.has("#NumberRange")){let n=t.termList()[0];n.text&&n.post===""&&(n.post=" ")}t.replaceWith(r,!0),t.tag("Cardinal"),xR(a,t,e)}),this},toOrdinal:function(){return this.if("#Cardinal").forEach(a=>{let t=Sn(a);if(t.num===null)return;let e=Ra(t,a.has("#TextValue"),!0);if(a.has("#NumberRange")){let n=a.termList()[0];n.text&&n.post===""&&(n.post=" ")}a.replaceWith(e,!0),a.tag("Ordinal");let r=this.lookAhead("^#Plural");r.found&&r.nouns().toSingular()}),this},isEqual:function(a){return this.filter(t=>Sn(t).num===a)},greaterThan:function(a){return this.filter(t=>Sn(t).num>a)},lessThan:function(a){return this.filter(t=>Sn(t).num<a)},between:function(a,t){return this.filter(e=>{let r=Sn(e).num;return r>a&&r<t})},set:function(a,t){return a===void 0||(typeof a=="string"&&(a=BG(a)),this.forEach(e=>{let r=Sn(e);if(r.num=a,r.num===null)return;let n=Ra(r,e.has("#TextValue"),e.has("#Ordinal"));(e=e.not("#Currency")).replaceWith(n,!0),xR(t,e,r)})),this},add:function(a,t){return a?(typeof a=="string"&&(a=BG(a)),this.forEach(e=>{let r=Sn(e);if(r.num===null)return;r.num+=a;let n=Ra(r,e.has("#TextValue"),e.has("#Ordinal"));(e=e.not("#Currency")).replaceWith(n,!0),xR(t,e,r)}),this):this},subtract:function(a,t){return this.add(-1*a,t)},increment:function(a){return this.add(1,a),this},decrement:function(a){return this.add(-1,a),this},romanNumerals:function(a){let t=this.match("#RomanNumeral").numbers();return typeof a=="number"&&(t=t.get(a)),t},normalize:function(){let a={"%":!0};return this.forEach(t=>{let e=Sn(t);if(e.num!==null&&e.suffix&&a[e.suffix]!==!0){let r=e.prefix||"";t=t.replaceWith(r+e.num+" "+e.suffix)}}),this},get:function(a){let t=[];return this.forEach(e=>{t.push(Sn(e).num)}),a!==void 0?t[a]||null:t||null}};xa.toNice=xa.toLocaleString,xa.isBetween=xa.between,xa.minus=xa.subtract,xa.plus=xa.add,xa.equals=xa.isEqual;var eSe=xa,tSe=wR,VR=function(a){let t=tSe(a).num;return typeof t=="number"?t/100:null},rSe={get:function(a){let t=[];return this.forEach(e=>{let r=VR(e);r!==null&&t.push(r)}),a!==void 0?t[a]||null:t||null},json:function(a){let t=null;typeof a=="number"&&(t=a,a=null),a=a||{text:!0,normal:!0,trim:!0,terms:!0};let e=[];return this.forEach(r=>{let n=r.json(a)[0],i=VR(r);if(n.number=i,i!==null){let s=100*i;n.textNumber=`${s} percent`,n.cardinal=`${s}%`}e.push(n)}),t!==null?e[t]||{}:e},toFraction:function(){return this.forEach(a=>{let t=VR(a);if(t!==null){t*=100,t=Math.round(100*t)/100;let e=`${t}/100`;this.replace(a,e)}}),this}},LG=[{dem:"american",name:"dollar",iso:"usd",sub:"cent",sym:["$","US$","U$"]},{name:"euro",iso:"eur",sub:"cent",sym:["\u20AC"]},{dem:"british",name:"pound",iso:"gbp",sub:"penny",alias:{sterling:!0},sym:["\xA3"]},{name:"renminbi",iso:"cny",plural:"yu\xE1n",alias:{yuan:!0},sym:["\u5143"]},{dem:"japanese",name:"yen",iso:"jpy",sub:"sen",sym:["\xA5","\u5186","\u5713"]},{dem:"swedish",name:"krona",iso:"sek",sub:"\xF6re",alias:{ore:!0,kronor:!0},sym:["kr"]},{dem:"estonian",name:"kroon",iso:"eek",sub:"sent",sym:["kr"]},{dem:"norwegian",name:"krone",iso:"nok",sub:"\xF8re",sym:["kr"]},{dem:"icelandic",name:"kr\xF3na",iso:"isk",sym:["kr"]},{dem:"danish",name:"krone",iso:"dkk",sub:"\xF8re",sym:["kr."]},{dem:"zambian",name:"kwacha",iso:"zmw",sub:"ngwee",sym:["K"]},{dem:"malawian",name:"kwacha",iso:"mwk",sub:"tambala",sym:["K"]},{dem:"greek",name:"drachma",iso:"grd",sub:"lept\u03BFn",sym:["\u0394\u03C1\u03C7.","\u0394\u03C1.","\u20AF"]},{dem:"eastern caribbean",name:"dollar",iso:"xcd",sub:"cent",sym:["$"]},{dem:"finnish",name:"markka",iso:"fim",sub:"penni",sym:["mk"]},{dem:"polish",name:"z\u0142oty",iso:"pln",sub:"grosz",sym:["z\u0142"]},{dem:"slovenian",name:"tolar",iso:"sit",sub:"stotin",sym:[]},{dem:"australian",name:"dollar",iso:"aud",sub:"cent",sym:["$","A$","AU$"]},{dem:"deutsche",name:"mark",iso:"dem",sub:"pfennig",sym:["DM"]},{dem:"thai",name:"baht",iso:"thb",sub:"satang",sym:["\u0E3F"]},{dem:"canadian",name:"dollar",iso:"cad",sub:"cent",sym:["$","Can$","C$","CA$","CAD"]},{dem:"mexican",name:"peso",iso:"mxn",sub:"centavo",sym:["$","Mex$"]},{dem:"spanish",name:"peseta",iso:"esp",sub:"c\xE9ntimo",sym:["Pta"]},{dem:"new zealand",name:"dollar",iso:"nzd",sub:"cent",sym:["$","NZ$"]},{dem:"chilean",name:"peso",iso:"clp",sub:"centavo",sym:["Cifr\xE3o","$"]},{dem:"nigerian",name:"naira",iso:"ngn",sub:"kobo",sym:["\u20A6"]},{dem:"austrian",name:"schilling",iso:"ats",sub:"groschen",sym:["S","\xF6S"]},{dem:"guatemalan",name:"quetzal",iso:"gtq",sub:"centavo",sym:["Q"]},{dem:"philippine",name:"peso",iso:"php",sub:"sentimo",sym:["\u20B1"]},{dem:"hungarian",name:"forint",iso:"huf",sym:["Ft"]},{dem:"russian",name:"ruble",iso:"rub",sub:"kopeyka",sym:["\u20BD","\u0440\u0443\u0431","\u0440."]},{dem:"kuwaiti",name:"dinar",iso:"kwd",sub:"fils",sym:["\u062F.\u0643","KD"]},{dem:"israeli",name:"new shekel",iso:"ils",sub:"agora",sym:["\u20AA"]},{dem:"latvian",name:"lats",iso:"lvl",sub:"sant\u012Bms",sym:["Ls"]},{dem:"kazakhstani",name:"tenge",iso:"kzt",sub:"t\u0131yn",sym:["\u20B8"]},{dem:"iraqi",name:"dinar",iso:"iqd",sub:"fils",sym:["\u062F.\u0639"]},{dem:"bahamian",name:"dollar",iso:"bsd",sub:"cent",sym:["$","B$"]},{dem:"seychellois",name:"rupee",iso:"scr",sub:"cent",sym:["SCR","SR"]},{dem:"albanian",name:"lek",iso:"all",sub:"qindark\xEB",sym:["L"]},{dem:"bulgarian",name:"lev",iso:"bgn",sub:"stotinka",sym:["\u043B\u0432."]},{dem:"irish",name:"pound",iso:"iep",sym:["\xA3","IR\xA3"]},{name:"cfp franc",iso:"xpf",sym:["f"]},{dem:"south african",name:"rand",iso:"zar",sub:"cent",sym:["R"]},{dem:"south korean",name:"won",iso:"krw",sub:"jeon",plural:"won",sym:["\u20A9"]},{dem:"north korean",name:"won",iso:"kpw",sub:"chon",plural:"won",sym:["\u20A9"]},{dem:"portuguese",name:"escudo",iso:"pte",sub:"centavo",sym:[]},{dem:"ghanaian",name:"cedi",iso:"ghs",sub:"pesewa",sym:["GH\u20B5"]},{dem:"hong kong",name:"dollar",iso:"hkd",sub:"\u6BEB",sym:["$"]},{dem:"new taiwan",name:"dollar",iso:"twd",sub:"dime",sym:["NT$"]},{dem:"east german",name:"mark",iso:"ddm",sub:"pfennig",sym:["M"]},{dem:"namibian",name:"dollar",iso:"nad",sub:"cent",sym:["$"]},{dem:"malaysian",name:"ringgit",iso:"myr",sub:"sen",sym:["RM"]},{dem:"swiss",name:"franc",iso:"chf",sym:["Rp."]},{dem:"panamanian",name:"balboa",iso:"pab",sub:"cent\xE9simo",sym:["B/."]},{dem:"indonesian",name:"rupiah",iso:"idr",sub:"sen",sym:["Rp"]},{dem:"brunei",name:"dollar",iso:"bnd",sub:"sen",sym:["$","B$"]},{dem:"venezuelan",name:"bol\xEDvar",iso:"vef",sub:"c\xE9ntimo",sym:["Bs.F","Bs."]},{dem:"macedonian",name:"denar",iso:"mkd",sub:"deni",sym:["den"]},{dem:"mauritanian",name:"ouguiya",iso:"mru",sub:"khoums",sym:["UM"]},{dem:"argentine",name:"peso",iso:"ars",sub:"centavo",sym:["$"]},{dem:"libyan",name:"dinar",iso:"lyd",sub:"dirham",sym:["LD","\u0644.\u062F"]},{dem:"jordanian",name:"dinar",iso:"jod",sub:"dirham",sym:["\u062F.\u0623"]},{dem:"french",name:"franc",iso:"frf",sub:"centime",sym:["F","Fr","FF","\u20A3"]},{dem:"syrian",name:"pound",iso:"syp",sub:"piastre",sym:["LS","\xA3S"]},{dem:"belize",name:"dollar",iso:"bzd",sub:"cent",sym:["$"]},{dem:"saudi",name:"riyal",iso:"sar",sub:"halalah",sym:["SAR","\u0631.\u0633"," \uFDFC"]},{dem:"surinamese",name:"dollar",iso:"srd",sub:"cent",sym:["$"]},{dem:"singapore",name:"dollar",iso:"sgd",sub:"cent",sym:["S$","$"]},{dem:"nepalese",name:"rupee",iso:"npr",sub:"paisa",sym:["\u0930\u0941 \u20A8","Re"]},{dem:"nicaraguan",name:"c\xF3rdoba",iso:"nio",sub:"centavo",sym:["C$"]},{dem:"bangladeshi",name:"taka",iso:"bdt",sub:"poysha",sym:["\u09F3"]},{dem:"indian",name:"rupee",iso:"inr",sub:"paisa",sym:["\u20B9"]},{dem:"maldivian",name:"rufiyaa",iso:"mvr",sub:"laari",sym:["Rf","MRf","MVR",".\u0783 "]},{dem:"sri lankan",name:"rupee",iso:"lkr",sub:"cents",sym:["Rs","\u0DBB\u0DD4","\u0BB0\u0BC2"]},{dem:"bhutanese",name:"ngultrum",iso:"btn",sub:"chhertum",sym:["Nu."]},{dem:"turkish",name:"lira",iso:"try",sub:"kuru\u015F",sym:["YTL"]},{dem:"serbian",name:"dinar",iso:"rsd",sub:"para",sym:["din","\u0434\u0438\u043D"]},{dem:"bosnia and herzegovina",name:"convertible mark",iso:"bam",sub:"fening",sym:["KM"]},{dem:"botswana",name:"pula",iso:"bwp",sub:"thebe",sym:["p"]},{dem:"swazi",name:"lilangeni",iso:"szl",sub:"cent",sym:["L","E"]},{dem:"lithuanian",name:"litas",iso:"ltl",sub:"centas",sym:["Lt","ct"]},{dem:"mauritian",name:"rupee",iso:"mur",sub:"cent",sym:["\u20A8"]},{dem:"pakistani",name:"rupee",iso:"pkr",sub:"paisa",sym:["\u20A8"]},{dem:"maltese",name:"lira",iso:"mtl",sub:"cent",sym:["\u20A4","Lm"]},{dem:"cypriot",name:"pound",iso:"cyp",sub:"cent",sym:["\xA3"]},{dem:"moldovan",name:"leu",iso:"mdl",sym:["l"]},{dem:"croatian",name:"kuna",iso:"hrk",sub:"lipa",sym:["kn"]},{dem:"afghan",name:"afghani",iso:"afn",sub:"pul",sym:["\u060B","Af","Afs"]},{dem:"ecuadorian",name:"sucre",iso:"ecs",sub:"centavo",sym:["S/."]},{dem:"sierra leonean",name:"leone",iso:"sll",sub:"cent",sym:["Le"]}],t0=LG,UG=wR,so={},zG={};t0.forEach(a=>{a.sym.forEach(t=>{so[t]=so[t]||a.iso}),so[a.iso]=so[a.iso]||a.iso,a.sub&&(zG[a.sub]=!0)});var GG=`(${Object.keys(zG).join("|")})`,nSe=MG,OR=function(a){let t=0,e=a.match(`and #Money+ ${GG}`);if(e.found){a=a.not(e);let l=UG(e.match("#Value+"));l&&l.num&&(t=l.num/100)}let r=UG(a),n=r.num||0;n+=t;let i=((s=r).suffix&&so.hasOwnProperty(s.suffix)?t0.find(l=>l.iso===so[s.suffix]):s.prefix&&so.hasOwnProperty(s.prefix)?t0.find(l=>l.iso===so[s.prefix]):null)||function(l){let u=l.match("#Currency+");u.nouns().toSingular();let c=u.text("reduced");return t0.find(p=>(c===`${p.dem} ${p.name}`||c===p.iso||c===p.sub||c===p.name||!(!p.alias||p.alias[c]!==!0))&&p)}(a)||{};var s;let o="";return i&&i.sym&&(o=i.sym[0],n&&a.has(`${GG}`)&&(n/=100)),{num:n,iso:i.iso,demonym:i.dem,currency:i.name,plural:i.plural,symbol:o}},HG=function(a=""){return a.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},aSe={get:function(a){let t=[];return this.forEach(e=>{t.push(OR(e))}),a!==void 0?t[a]||null:t||null},currency:function(a){let t=[];return this.forEach(e=>{let r=OR(e);r&&t.push(r)}),typeof a=="number"?t[a]||null:t||null},json:function(a){let t=null;typeof a=="number"&&(t=a,a=null),a=a||{text:!0,normal:!0,trim:!0,terms:!0};let e=[];return this.forEach(r=>{let n=r.json(a)[0],i=OR(r);if(n.number=i.num,i.iso&&(n.iso=i.iso.toUpperCase(),n.symbol=i.symbol,n.currency=HG(i.demonym)+" "+HG(i.currency)),n.textFmt=nSe(i,!0,!1),i.currency){let s=i.currency;i.num!==1&&(s=i.plural||s+"s"),n.textFmt+=" "+s}e.push(n)}),t!==null?e[t]||{}:e}},r0={},DR=RR,iSe=PG;r0.toText=function(a){if(!a.numerator||!a.denominator)return"";let t=DR(a.numerator),e=iSe(a.denominator);return a.denominator===2&&(e="half"),t&&e?(a.numerator!==1&&(e+="s"),`${t} ${e}`):""},r0.textCardinal=function(a){return!a.numerator||!a.denominator?"":`${DR(a.numerator)} out of ${DR(a.denominator)}`},r0.toDecimal=function(a){return a.decimal};var Vp=VG,Ld=r0,IR={get:function(a){let t=[];return this.forEach(e=>{t.push(Vp(e))}),a!==void 0?t[a]||null:t||null},toDecimal(){return this.forEach(a=>{let t=Vp(a);if(t){let e=Ld.toDecimal(t);a.replaceWith(String(e),!0),a.tag("NumericValue"),a.unTag("Fraction")}}),this},json:function(a){let t=null;typeof a=="number"&&(t=a,a=null),a=a||{text:!0,normal:!0,trim:!0,terms:!0};let e=[];return this.forEach(r=>{let n=r.json(a)[0],i=Vp(r)||{},s=Ld.toDecimal(i);n.numerator=i.numerator,n.denominator=i.denominator,n.number=s,n.textOrdinal=Ld.toText(i),n.textCardinal=Ld.textCardinal(i),e.push(n)}),t!==null?e[t]||{}:e},normalize:function(){return this.forEach(a=>{let t=Vp(a);if(t&&typeof t.numerator=="number"&&typeof t.denominator=="number"){let e=`${t.numerator}/${t.denominator}`;this.replace(a,e)}}),this},toText:function(a){let t=[];return this.forEach(e=>{let r=Vp(e)||{},n=Ld.toText(r);e.replaceWith(n,!0),e.tag("Fraction")}),a!==void 0?t[a]:t},toPercentage:function(){return this.forEach(a=>{let t=Vp(a);if(t.decimal||t.decimal===0){let e=100*t.decimal;e=Math.round(100*e)/100,this.replace(a,`${e}%`)}}),this}};IR.toNumber=IR.toDecimal;var sSe=IR,oSe=function(a){return a.match("(hundred|thousand|million|billion|trillion|quadrillion|quintillion|sextillion|septillion)").tag("#Multiple","fraction-tagger"),a.match("[(half|quarter)] of? (a|an)",0).tag("Fraction","millionth"),a.match("#Adverb [half]",0).tag("Fraction","nearly-half"),a.match("[half] the",0).tag("Fraction","half-the"),a.match("#Value (halves|halfs|quarters)").tag("Fraction","two-halves"),a.match("a #Ordinal").tag("Fraction","a-quarter"),a.match("(#Fraction && /s$/)").lookBefore("#Cardinal+$").tag("Fraction"),a.match("[#Cardinal+ #Ordinal] of .",0).tag("Fraction","ordinal-of"),a.match("[(#NumericValue && #Ordinal)] of .",0).tag("Fraction","num-ordinal-of"),a.match("(a|one) #Cardinal?+ #Ordinal").tag("Fraction","a-ordinal"),a.match("#Cardinal+ out? of every? #Cardinal").tag("Fraction","fraction-tagger"),a},lSe=function(a){let t="money-tagger";a.match("#Money and #Money #Currency?").tag("Money","money-and-money"),a.match("#Money").not("#TextValue").match("/\\.[0-9]{3}$/").unTag("#Money","three-decimal money"),a.ifNo("#Value").match("#Currency #Verb").unTag("Currency","no-currency"),a.match("#Value #Currency [and] #Value (cents|ore|centavos|sens)",0).tag("Money",t);let e=a.match("[<num>#Value] [<currency>(mark|rand|won|rub|ore)]");return e.group("num").tag("Money",t),e.group("currency").tag("Currency",t),a},uSe=function(a){(a=lSe(a)).match("the [/[0-9]+s$/]").tag("#Plural","number-tag"),a.match("half a? #Value").tag("Value","half-a-value"),a.match("#Value [and a (half|quarter)]",0).tag(["TextValue","#Fraction"],"value-and-a-half"),(a=oSe(a)).match("#Cardinal and #Fraction #Fraction").tag("Value","number-tag")},qG={mark:!0,sucre:!0,leone:!0,afghani:!0,rand:!0,try:!0,mop:!0,won:!0,all:!0,rub:!0,eek:!0,sit:!0,bam:!0,npr:!0,leu:!0},Ol={kronor:"Currency"};LG.forEach(a=>{a.iso&&!qG[a.iso]&&(Ol[a.iso]=["Acronym","Currency"]);let t=a.name;if(t&&!qG[t]&&(Ol[t]="Currency",Ol[t+"s"]="Currency"),a.dem){let e=a.dem;Ol[`${e} ${t}`]="Currency",Ol[`${e} ${t}s`]="Currency"}a.sub&&(Ol[a.sub]="Currency")});var cSe=PAe,pSe=_Ae,mSe=kAe,fSe=FAe,dSe=eSe,hSe=rSe,ySe=aSe,bSe=sSe,gSe=uSe,vSe={Fraction:{isA:["Value"]},Multiple:{isA:"Value"}},TSe=Ol,NSe=function(a,t){t.addWords(TSe),t.addTags(vSe),t.postProcess(gSe);class e extends a{}Object.assign(e.prototype,dSe);class r extends e{}Object.assign(r.prototype,ySe);class n extends e{}Object.assign(n.prototype,bSe);class i extends e{}Object.assign(i.prototype,hSe);let s={numbers:function(o){let l=pSe(this,o);return new e(l.list,this,this.world)},percentages:function(o){let l=fSe(this,o);return new i(l.list,this,this.world)},fractions:function(o){let l=mSe(this,o);return new n(l.list,this,this.world)},money:function(o){let l=cSe(this,o);return new r(l.list,this,this.world)}};return s.values=s.numbers,s.percents=s.percentages,Object.assign(a.prototype,s),a},WG=NSe;Z1.extend(WG);var Op=class extends Tr{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.pluralForm={createComponentOfType:"text",createStateVariable:"pluralForm",defaultValue:null,public:!0},e.basedOnNumber={createComponentOfType:"number",createStateVariable:"basedOnNumber",defaultValue:null,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return $r({stateVariableDefinitions:t,oldName:"value",newName:"valuePrePluralize"}),t.value={public:!0,componentType:"text",returnDependencies:()=>({valuePrePluralize:{dependencyType:"stateVariable",variableName:"valuePrePluralize"},pluralForm:{dependencyType:"stateVariable",variableName:"pluralForm"},basedOnNumber:{dependencyType:"stateVariable",variableName:"basedOnNumber"}}),definition:function({dependencyValues:e}){let r=Z1(e.valuePrePluralize),n=r.values().toNumber().all().terms().json();if(n.length===0)return{setValue:{value:e.valuePrePluralize}};let i;if(e.basedOnNumber!==null&&(i=$G(e.basedOnNumber)),n.length===1)return i===void 0&&(i=!0),i?e.pluralForm!==null?{setValue:{value:e.pluralForm}}:{setValue:{value:r.nouns().toPlural().all().out("text")}}:{setValue:{value:e.valuePrePluralize}};if(i===void 0){let o=[],l=[],u=r.nouns().json();for(let[m,f]of n.entries()){let d=u[o.length];f.terms[0].tags.includes("Value")&&l.push(m),d!==void 0&&d.text===f.text&&o.push(m)}i=[];let c=r.values().numbers().json(),p=-1;for(let m of o){for(;Number(l[p+1])<Number(m);)p++;c[p]&&$G(Number(c[p].normal))?i.push(!0):i.push(!1)}}if(i===!1)return{setValue:{value:e.valuePrePluralize}};let s=Z1(e.valuePrePluralize);if(e.pluralForm!==null)for(let[o,l]of r.nouns().data().entries())(i===!0||i[o]===!0)&&s.replace(l.text,e.pluralForm);else{let o=r.nouns().json().length;for(let l=0;l<o;l++)(i===!0||i[l]===!0)&&s.nouns(l).toPlural().all()}return{setValue:{value:s.out("text")}}}},t.text={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:({dependencyValues:e})=>({setValue:{text:e.value}})},t}};T(Op,"componentType","pluralize"),T(Op,"rendererType","text");function $G(a){return a!==1}var Dl=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.hide,e.condition={createComponentOfType:"boolean"},e.updateWithTarget={createPrimitiveOfType:"string"},e}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.updateWithTarget={returnDependencies:()=>({updateWithTargetAttr:{dependencyType:"attributePrimitive",attributeName:"updateWithTarget"}}),definition({dependencyValues:e}){return{setValue:{updateWithTarget:e.updateWithTargetAttr}}}},t.updateWithTargetComponentNames={chainActionOnActionOfStateVariableTargets:{triggeredAction:"updateHide"},stateVariablesDeterminingDependencies:["updateWithTarget"],returnDependencies({stateValues:e}){return e.updateWithTarget?{updateWithTargetComponentName:{dependencyType:"expandTargetName",target:e.updateWithTarget}}:{}},definition({dependencyValues:e}){return e.updateWithTargetComponentName?{setValue:{updateWithTargetComponentNames:[e.updateWithTargetComponentName]}}:{setValue:{updateWithTargetComponentNames:[]}}}},t.hideWhenUpdated={returnDependencies:()=>({condition:{dependencyType:"attributeComponent",attributeName:"condition",variableNames:["value"]},showFeedback:{dependencyType:"flag",flagName:"showFeedback"}}),definition:function({dependencyValues:e}){let r;return e.condition===null?r=!1:r=!(e.showFeedback&&e.condition.stateValues.value),{setValue:{hideWhenUpdated:r}}}},t.hide={forRenderer:!0,defaultValue:!0,hasEssential:!0,stateVariablesDeterminingDependencies:["updateWithTarget"],returnDependencies({stateValues:e}){return e.updateWithTarget?{}:{condition:{dependencyType:"attributeComponent",attributeName:"condition",variableNames:["value"]},showFeedback:{dependencyType:"flag",flagName:"showFeedback"}}},definition:function({dependencyValues:e}){if(!("condition"in e))return{useEssentialOrDefaultValue:{hide:!0}};let r;return e.condition===null?r=!1:r=!(e.showFeedback&&e.condition.stateValues.value),{setValue:{hide:r}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return"condition"in r?{success:!1}:{success:!0,instructions:[{setEssentialValue:"hide",value:e.hide}]}}},t.feedbackText={forRenderer:!0,defaultValue:null,hasEssential:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{feedbackText:!0}})},t}async updateHide({actionId:t}){let e=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"hide",value:await this.stateValues.hideWhenUpdated}];return await this.coreFunctions.performUpdate({updateInstructions:e,actionId:t})}actions={updateHide:this.updateHide.bind(this)}};T(Dl,"componentType","feedback"),T(Dl,"renderChildren",!0),T(Dl,"primaryStateVariableForDefinition","feedbackText");var Il=class extends J{static returnChildLogic(t){let e=super.returnChildLogic(t),r=e.newLeaf({name:"atLeastZeroPoints",componentType:"point",comparison:"atLeast",number:0}),n=nh(s=>({componentType:"point",children:[{componentType:"coords",children:s}]})),i=e.newLeaf({name:"exactlyOneString",componentType:"string",number:1,isSugar:!0,logicToWaitOnSugar:["atLeastZeroPoints"],replacementFunction:n});return e.newOperator({name:"pointsXorSugar",operator:"xor",propositions:[i,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.collaborateGroups={returnDependencies:()=>({pointChildren:{dependencyType:"child",childLogicName:"atLeastZeroPoints",variableNames:["xs","coords","nDimensions"]}}),definition:function({dependencyValues:e}){let r={};for(let i of e.pointChildren)if(i.stateValues.nDimensions!==2)console.warn(`invalid collaborate group: ${i.stateValues.coords.toString()}`);else{let s=i.stateValues.xs[0].evaluate_to_constant(),o=i.stateValues.xs[1].evaluate_to_constant();Number.isInteger(s)&&s>0&&Number.isInteger(o)&&o>0?(r[s]===void 0&&(r[s]=[]),r[s].push(o)):console.warn(`invalid collaborate group: ${i.stateValues.coords.toString()}`)}return{setValue:{collaborateGroups:{groups:r,matchGroup:function({groupNumber:i,numberOfGroups:s}={}){if(s>1){let o=r[s];return o===void 0?!1:o.includes(i)}else return!0}}}}}},t}};T(Il,"componentType","collaborateGroups"),T(Il,"rendererType"),T(Il,"stateVariableForAttributeValue","collaborateGroups");var Ud=class extends J{static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOnePossibleNumberOfGroups",componentType:"possibleNumberOfGroups",comparison:"atMost",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.possibleNumberOfGroups={returnDependencies:()=>({pngChild:{dependencyType:"child",childLogicName:"atMostOnePossibleNumberOfGroups",variableNames:["numbers"]}}),definition:function({dependencyValues:e}){return e.pngChild.length===0?{setValue:{possibleNumberOfGroups:[1]}}:{setValue:{possibleNumberOfGroups:e.pngChild[0].stateValues.numbers}}}},t}};T(Ud,"componentType","collaborateGroupSetup");var Dp=class extends ce{static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.childrenWithNValues={returnDependencies:()=>({children:{dependencyType:"child",childGroups:["anything"],variableNames:["nValues"],variablesOptional:!0}}),definition:({dependencyValues:e})=>({setValue:{childrenWithNValues:e.children}})},t.childrenAsResponses={returnDependencies:()=>({children:{dependencyType:"child",childGroups:["anything"],variableNames:["value","values","componentType"],variablesOptional:!0}}),definition:({dependencyValues:e})=>({setValue:{childrenAsResponses:e.children}})},t}};T(Dp,"componentType","considerAsResponses"),T(Dp,"rendererType");var zd=class extends Dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.condition={createComponentOfType:"boolean"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.conditionSatisfied={public:!0,componentType:"boolean",returnDependencies:()=>({condition:{dependencyType:"attributeComponent",attributeName:"condition",variableNames:["value"]}}),definition:function({dependencyValues:e}){let r;return e.condition===null?r=!0:r=e.condition.stateValues.value,{setValue:{conditionSatisfied:r}}}},t}static createSerializedReplacements({component:t,componentInfoObjects:e}){return t.stateValues.conditionSatisfied?super.createSerializedReplacements({component:t,componentInfoObjects:e}):{replacements:[]}}};T(zd,"componentType","case");var gH=M(bH());var uo=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.minSentencesPerParagraph={createComponentOfType:"number",createStateVariable:"minSentencesPerParagraph",defaultValue:4,public:!0},e.maxSentencesPerParagraph={createComponentOfType:"number",createStateVariable:"maxSentencesPerParagraph",defaultValue:8,public:!0},e.minWordsPerSentence={createComponentOfType:"number",createStateVariable:"minWordsPerSentence",defaultValue:4,public:!0},e.maxWordsPerSentence={createComponentOfType:"number",createStateVariable:"maxWordsPerSentence",defaultValue:8,public:!0},e.generateWords={createComponentOfType:"number",createStateVariable:"generateWords",defaultValue:null},e.generateSentences={createComponentOfType:"number",createStateVariable:"generateSentences",defaultValue:null},e.generateParagraphs={createComponentOfType:"number",createStateVariable:"generateParagraphs",defaultValue:null},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.readyToExpandWhenResolved={returnDependencies:()=>({minSentencesPerParagraph:{dependencyType:"stateVariable",variableName:"minSentencesPerParagraph"},maxSentencesPerParagraph:{dependencyType:"stateVariable",variableName:"maxSentencesPerParagraph"},minWordsPerSentence:{dependencyType:"stateVariable",variableName:"minWordsPerSentence"},maxWordsPerSentence:{dependencyType:"stateVariable",variableName:"maxWordsPerSentence"},generateWords:{dependencyType:"stateVariable",variableName:"generateWords"},generateSentences:{dependencyType:"stateVariable",variableName:"generateSentences"},generateParagraphs:{dependencyType:"stateVariable",variableName:"generateParagraphs"}}),markStale:()=>({updateReplacements:!0}),definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={returnDependencies:({sharedParameters:e,componentInfoObjects:r})=>({variantSeed:{dependencyType:"value",value:e.variantSeed}}),definition({dependencyValues:e,componentName:r}){return{setValue:{generatedVariantInfo:{seed:e.variantSeed,meta:{createdBy:r}}}}}},t}static async createSerializedReplacements({component:t,componentInfoObjects:e}){let r=new gH.LoremIpsum({sentencesPerParagraph:{max:await t.stateValues.maxSentencesPerParagraph,min:await t.stateValues.minSentencesPerParagraph},wordsPerSentence:{max:await t.stateValues.maxWordsPerSentence,min:await t.stateValues.minWordsPerSentence},random:t.sharedParameters.variantRng}),n=[];if(await t.stateValues.generateParagraphs!==null){let o=await t.stateValues.generateParagraphs;Number.isInteger(o)&&o>0&&(n=r.generateParagraphs(o).split(`
`).map(u=>({componentType:"p",children:[u]})))}else if(await t.stateValues.generateSentences!==null){let o=await t.stateValues.generateSentences;if(Number.isInteger(o)&&o>0){let l=r.generateSentences(o).split(". ");for(let u of l.slice(0,l.length-1))n.push({componentType:"text",children:[u+"."]}),n.push(" ");n.push({componentType:"text",children:[l[l.length-1]]})}}else if(await t.stateValues.generateWords!==null){let o=await t.stateValues.generateWords;if(Number.isInteger(o)&&o>0){let l=r.generateWords(o).split(" ").map(u=>({componentType:"text",children:[u]}));n.push(l[0]);for(let u of l.slice(1))n.push(" "),n.push(u)}}let i=t.attributes.newNamespace&&t.attributes.newNamespace.primitive;return{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:n,parentName:t.componentName,parentCreatesNewNamespace:i,componentInfoObjects:e}).serializedComponents}}static async calculateReplacementChanges({component:t,componentInfoObjects:e}){let r=await this.createSerializedReplacements({component:t,componentInfoObjects:e});return[{changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:r.replacements}]}static async setUpVariant({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r}){kr({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r})}};T(uo,"componentType","lorem"),T(uo,"assignNamesToReplacements",!0),T(uo,"createsVariants",!0),T(uo,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");var Pp=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.label={createComponentOfType:"text",createStateVariable:"label",defaultValue:"update value",public:!0,forRenderer:!0},e.type={createPrimitiveOfType:"string",createStateVariable:"type",defaultPrimitiveValue:"math",toLowerCase:!0,validValues:["math","number","boolean","text"]},e.prop={createPrimitiveOfType:"string"},e.newValue={createComponentOfType:"_componentWithSelectableType"},e.componentIndex={createComponentOfType:"number",createStateVariable:"componentIndex",defaultValue:null,public:!0},e.triggerWhen={createComponentOfType:"boolean",createStateVariable:"triggerWhen",defaultValue:!1,triggerActionOnChange:"updateValueIfTriggerNewlyTrue"},e.triggerWithTargets={createPrimitiveOfType:"string"},e.simplify={createComponentOfType:"text",createStateVariable:"simplify",defaultValue:"none",public:!0,toLowerCase:!0,valueTransformations:{true:"full"},validValues:["none","full","numbers","numberspreserveorder"]},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();t.target={returnDependencies:()=>({target:{dependencyType:"doenetAttribute",attributeName:"target"}}),definition:({dependencyValues:n})=>({setValue:{target:n.target}})},t.targetComponent={returnDependencies(){return{targetComponent:{dependencyType:"targetComponent"}}},definition:function({dependencyValues:n}){let i=null;return n.targetComponent&&(i=n.targetComponent),{setValue:{targetComponent:i}}}},t.propName={returnDependencies:()=>({propName:{dependencyType:"attributePrimitive",attributeName:"prop"}}),definition:function({dependencyValues:n}){return{setValue:{propName:n.propName}}}},t.targetIdentities={stateVariablesDeterminingDependencies:["targetComponent","componentIndex"],returnDependencies:function({stateValues:n,componentInfoObjects:i}){let s={};return n.targetComponent!==null&&(i.isCompositeComponent({componentType:n.targetComponent.componentType,includeNonStandard:!1})?s.targets={dependencyType:"replacement",compositeName:n.targetComponent.componentName,recursive:!0,componentIndex:n.componentIndex}:(n.componentIndex===null||n.componentIndex===1)&&(s.targets={dependencyType:"stateVariable",variableName:"targetComponent"})),s},definition({dependencyValues:n}){let i=null;return n.targets&&(i=n.targets,Array.isArray(i)||(i=[i])),{setValue:{targetIdentities:i}}}},t.targets={stateVariablesDeterminingDependencies:["targetIdentities","propName"],returnDependencies:function({stateValues:n}){let i={targetIdentities:{dependencyType:"stateVariable",variableName:"targetIdentities"}};if(n.targetIdentities!==null)for(let[s,o]of n.targetIdentities.entries()){let l;n.propName?l={dependencyType:"stateVariable",componentName:o.componentName,variableName:n.propName,returnAsComponentObject:!0,variablesOptional:!0,propIndex:n.propIndex,caseInsensitiveVariableMatch:!0,publicStateVariablesOnly:!0,useMappedVariableNames:!0}:l={dependencyType:"componentIdentity",componentName:o.componentName},i["target"+s]=l}return i},definition({dependencyValues:n}){let i=null;if(n.targetIdentities!==null){i=[];for(let s in n.targetIdentities)n["target"+s]&&i.push(n["target"+s])}return{setValue:{targets:i}}}},t.newValue={returnDependencies:()=>({newValueAttr:{dependencyType:"attributeComponent",attributeName:"newValue",variableNames:["value"]},type:{dependencyType:"stateVariable",variableName:"type"},simplify:{dependencyType:"stateVariable",variableName:"simplify"}}),definition:function({dependencyValues:n}){if(n.newValueAttr===null)return{setValue:{newValue:null}};let i=n.newValueAttr.stateValues.value;return n.type==="math"&&(i=Wr({value:i,simplify:n.simplify})),{setValue:{newValue:i}}}},t.insideTriggerSet={returnDependencies:()=>({parentTriggerSet:{dependencyType:"parentStateVariable",parentComponentType:"triggerSet",variableName:"updateValueAndActionsToTrigger"}}),definition({dependencyValues:n}){return{setValue:{insideTriggerSet:n.parentTriggerSet!==null}}}},t.triggerWithTargets={returnDependencies:()=>({triggerWithTargets:{dependencyType:"attributePrimitive",attributeName:"triggerWithTargets"},triggerWhen:{dependencyType:"attributeComponent",attributeName:"triggerWhen"},insideTriggerSet:{dependencyType:"stateVariable",variableName:"insideTriggerSet"}}),definition({dependencyValues:n}){return n.triggerWhen||n.insideTriggerSet||n.triggerWithTargets===null?{setValue:{triggerWithTargets:null}}:{setValue:{triggerWithTargets:n.triggerWithTargets.split(/\s+/).filter(i=>i)}}}},t.triggerWithTargetComponentNames={chainActionOnActionOfStateVariableTargets:{triggeredAction:"updateValue"},stateVariablesDeterminingDependencies:["triggerWithTargets"],returnDependencies({stateValues:n}){let i={};if(n.triggerWithTargets)for(let[s,o]of n.triggerWithTargets.entries())i[`triggerWithTargetComponentName${s}`]={dependencyType:"expandTargetName",target:o};return i},definition({dependencyValues:n}){let i=[],s=Object.keys(n).length-1;for(let o=0;o<s;o++)i.push(n[`triggerWithTargetComponentName${o}`]);return{setValue:{triggerWithTargetComponentNames:i}}},markStale(){return{updateActionChaining:!0}}};let e=t.hidden.returnDependencies,r=t.hidden.definition;return t.hidden.returnDependencies=function(n){let i=e(n);return i.triggerWhen={dependencyType:"attributeComponent",attributeName:"triggerWhen"},i.triggerWithTargets={dependencyType:"stateVariable",variableName:"triggerWithTargets"},i.insideTriggerSet={dependencyType:"stateVariable",variableName:"insideTriggerSet"},i},t.hidden.definition=function(n){return n.dependencyValues.triggerWhen||n.dependencyValues.triggerWithTargets||n.dependencyValues.insideTriggerSet?{setValue:{hidden:!0}}:r(n)},t}async updateValue({actionId:t}){let e=await this.stateValues.targets,r=await this.stateValues.newValue;if(e===null||r===null)return;let n=[];for(let i of e){let s="value";if(i.stateValues&&(s=Object.keys(i.stateValues)[0],s===void 0)){console.warn(`Cannot update prop="${await this.stateValues.propName}" of ${await this.stateValues.target} as could not find prop ${await this.stateValues.propName} on a component of type ${i.componentType}`);continue}n.push({updateType:"updateValue",componentName:i.componentName,stateVariable:s,value:r})}return await this.coreFunctions.performUpdate({updateInstructions:n,actionId:t,event:{verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:r,responseText:r.toString()}}}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}async updateValueIfTriggerNewlyTrue({stateValues:t,previousValues:e,actionId:r}){if(await t.triggerWhen&&e.triggerWhen===!1&&!await this.stateValues.insideTriggerSet)return await this.updateValue({actionId:r});this.coreFunctions.resolveAction({actionId:r})}actions={updateValue:this.updateValue.bind(this),updateValueIfTriggerNewlyTrue:this.updateValueIfTriggerNewlyTrue.bind(this)}};T(Pp,"componentType","updateValue"),T(Pp,"acceptTarget",!0);var _p=class extends re{static keepChildrenSerialized({serializedComponent:t}){return t.children===void 0?[]:Object.keys(t.children)}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.label={createComponentOfType:"text",createStateVariable:"label",defaultValue:"call action",public:!0,forRenderer:!0},e.actionName={createComponentOfType:"text",createStateVariable:"actionName",defaultValue:null,public:!0},e.triggerWhen={createComponentOfType:"boolean",createStateVariable:"triggerWhen",defaultValue:!1,triggerActionOnChange:"callActionIfTriggerNewlyTrue"},e.triggerWithTargets={createPrimitiveOfType:"string"},e.numbers={createComponentOfType:"numberList"},e.number={createComponentOfType:"number"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();t.target={returnDependencies:()=>({target:{dependencyType:"doenetAttribute",attributeName:"target"}}),definition:({dependencyValues:n})=>({setValue:{target:n.target}})},t.targetComponent={returnDependencies(){return{targetComponent:{dependencyType:"targetComponent"}}},definition:function({dependencyValues:n}){let i=null;return n.targetComponent&&(i=n.targetComponent),{setValue:{targetComponent:i}}}},t.targetName={returnDependencies:()=>({targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"}}),definition({dependencyValues:n}){let i=null;return n.targetComponent&&(i=n.targetComponent.componentName),{setValue:{targetName:i}}}},t.insideTriggerSet={returnDependencies:()=>({parentTriggerSet:{dependencyType:"parentStateVariable",parentComponentType:"triggerSet",variableName:"updateValueAndActionsToTrigger"}}),definition({dependencyValues:n}){return{setValue:{insideTriggerSet:n.parentTriggerSet!==null}}}},t.triggerWithTargets={returnDependencies:()=>({triggerWithTargets:{dependencyType:"attributePrimitive",attributeName:"triggerWithTargets"},triggerWhen:{dependencyType:"attributeComponent",attributeName:"triggerWhen"},insideTriggerSet:{dependencyType:"stateVariable",variableName:"insideTriggerSet"}}),definition({dependencyValues:n}){return n.triggerWhen||n.insideTriggerSet||n.triggerWithTargets===null?{setValue:{triggerWithTargets:null}}:{setValue:{triggerWithTargets:n.triggerWithTargets.split(/\s+/).filter(i=>i)}}}},t.triggerWithTargetComponentNames={chainActionOnActionOfStateVariableTargets:{triggeredAction:"callAction"},stateVariablesDeterminingDependencies:["triggerWithTargets"],returnDependencies({stateValues:n}){let i={};if(n.triggerWithTargets)for(let[s,o]of n.triggerWithTargets.entries())i[`triggerWithTargetComponentName${s}`]={dependencyType:"expandTargetName",target:o};return i},definition({dependencyValues:n}){let i=[],s=Object.keys(n).length-1;for(let o=0;o<s;o++)i.push(n[`triggerWithTargetComponentName${o}`]);return{setValue:{triggerWithTargetComponentNames:i}}},markStale(){return{updateActionChaining:!0}}};let e=t.hidden.returnDependencies,r=t.hidden.definition;return t.hidden.returnDependencies=function(n){let i=e(n);return i.triggerWhen={dependencyType:"attributeComponent",attributeName:"triggerWhen"},i.triggerWithTargets={dependencyType:"stateVariable",variableName:"triggerWithTargets"},i.insideTriggerSet={dependencyType:"stateVariable",variableName:"insideTriggerSet"},i},t.hidden.definition=function(n){return n.dependencyValues.triggerWhen||n.dependencyValues.triggerWithTargets||n.dependencyValues.insideTriggerSet?{setValue:{hidden:!0}}:r(n)},t}async callAction({actionId:t}){let e=await this.stateValues.targetName,r=await this.stateValues.actionName;if(e!==null&&r!==null){let n={};this.serializedChildren.length>0&&(n.serializedComponents=Re(this.serializedChildren)),this.attributes.number&&(n.number=await this.attributes.number.component.stateValues.value),this.attributes.numbers&&(n.numbers=await this.attributes.numbers.component.stateValues.numbers),t&&(n.actionId=t),await this.coreFunctions.performAction({componentName:e,actionName:r,args:n,event:{verb:"selected",object:{componentName:this.componentName,componentType:this.componentType}}}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}else this.coreFunctions.resolveAction({actionId:t})}async callActionIfTriggerNewlyTrue({stateValues:t,previousValues:e,actionId:r}){if(t.triggerWhen&&e.triggerWhen===!1&&!await this.stateValues.insideTriggerSet)return await this.callAction({actionId:r});this.coreFunctions.resolveAction({actionId:r})}actions={callAction:this.callAction.bind(this),callActionIfTriggerNewlyTrue:this.callActionIfTriggerNewlyTrue.bind(this)}};T(_p,"componentType","callAction"),T(_p,"acceptTarget",!0);var Hd=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.label={createComponentOfType:"text",createStateVariable:"label",defaultValue:"update value",public:!0,forRenderer:!0},e.triggerWhen={createComponentOfType:"boolean",createStateVariable:"triggerWhen",defaultValue:!1,triggerActionOnChange:"triggerActionsIfTriggerNewlyTrue"},e.triggerWithTargets={createPrimitiveOfType:"string"},e}static returnChildGroups(){return[{group:"updateValuesCallActions",componentTypes:["updateValue","callAction"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();t.updateValueAndActionsToTrigger={returnDependencies:()=>({updateValueAndCallActionChildren:{dependencyType:"child",childGroups:["updateValuesCallActions"]}}),definition({dependencyValues:n}){return{setValue:{updateValueAndActionsToTrigger:n.updateValueAndCallActionChildren}}}},t.triggerWithTargets={returnDependencies:()=>({triggerWithTargets:{dependencyType:"attributePrimitive",attributeName:"triggerWithTargets"},triggerWhen:{dependencyType:"attributeComponent",attributeName:"triggerWhen"}}),definition({dependencyValues:n}){return n.triggerWhen||n.triggerWithTargets===null?{setValue:{triggerWithTargets:null}}:{setValue:{triggerWithTargets:n.triggerWithTargets.split(/\s+/).filter(i=>i)}}}},t.triggerWithTargetComponentNames={chainActionOnActionOfStateVariableTargets:{triggeredAction:"triggerActions"},stateVariablesDeterminingDependencies:["triggerWithTargets"],returnDependencies({stateValues:n}){let i={};if(n.triggerWithTargets)for(let[s,o]of n.triggerWithTargets.entries())i[`triggerWithTargetComponentName${s}`]={dependencyType:"expandTargetName",target:o};return i},definition({dependencyValues:n}){let i=[],s=Object.keys(n).length-1;for(let o=0;o<s;o++)i.push(n[`triggerWithTargetComponentName${o}`]);return{setValue:{triggerWithTargetComponentNames:i}}},markStale(){return{updateActionChaining:!0}}};let e=t.hidden.returnDependencies,r=t.hidden.definition;return t.hidden.returnDependencies=function(n){let i=e(n);return i.triggerWhen={dependencyType:"attributeComponent",attributeName:"triggerWhen"},i.triggerWithTargets={dependencyType:"stateVariable",variableName:"triggerWithTargets"},i},t.hidden.definition=function(n){return n.dependencyValues.triggerWhen||n.dependencyValues.triggerWithTargets?{setValue:{hidden:!0}}:r(n)},t}async triggerActions({actionId:t}){for(let e of await this.stateValues.updateValueAndActionsToTrigger)this.componentInfoObjects.isInheritedComponentType({inheritedComponentType:e.componentType,baseComponentType:"updateValue"})?await this.coreFunctions.performAction({componentName:e.componentName,actionName:"updateValue"}):this.componentInfoObjects.isInheritedComponentType({inheritedComponentType:e.componentType,baseComponentType:"callAction"})&&await this.coreFunctions.performAction({componentName:e.componentName,actionName:"callAction"});return this.coreFunctions.resolveAction({actionId:t}),await this.coreFunctions.triggerChainedActions({componentName:this.componentName})}async triggerActionsIfTriggerNewlyTrue({stateValues:t,previousValues:e,actionId:r}){if(t.triggerWhen&&e.triggerWhen===!1)return await this.triggerActions({actionId:r});this.coreFunctions.resolveAction({actionId:r})}actions={triggerActions:this.triggerActions.bind(this),triggerActionsIfTriggerNewlyTrue:this.triggerActionsIfTriggerNewlyTrue.bind(this)}};T(Hd,"componentType","triggerSet");import _l from"math-expressions";var kp=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.nIterates={createComponentOfType:"integer",createStateVariable:"nIterates",defaultValue:0,public:!0},e.forceSymbolic={createComponentOfType:"boolean",createStateVariable:"forceSymbolic",defaultValue:!1,public:!0},e.forceNumeric={createComponentOfType:"boolean",createStateVariable:"forceNumeric",defaultValue:!1,public:!0},e.initialValue={createComponentOfType:"math",createStateVariable:"initialValue",defaultValue:_l.fromAst("\uFF3F")},e.function={createComponentOfType:"function"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nDimensions={public:!0,componentType:"integer",returnDependencies:()=>({functionAttr:{dependencyType:"attributeComponent",attributeName:"function",variableNames:["nInputs","nOutputs"]}}),definition({dependencyValues:e}){return e.functionAttr?e.functionAttr.stateValues.nInputs!==e.functionAttr.stateValues.nOutputs?(console.warn("Function iterates are possible only if the number of inputs is equal to the number of outputs"),{setValue:{nDimensions:0}}):{setValue:{nDimensions:e.functionAttr.stateValues.nInputs}}:{setValue:{nDimensions:0}}}},t.allIterates={public:!0,componentType:"mathList",returnDependencies:()=>({functionAttr:{dependencyType:"attributeComponent",attributeName:"function",variableNames:["symbolicfs","numericalfs","symbolic"]},forceSymbolic:{dependencyType:"stateVariable",variableName:"forceSymbolic"},forceNumeric:{dependencyType:"stateVariable",variableName:"forceNumeric"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},initialValue:{dependencyType:"stateVariable",variableName:"initialValue"},nIterates:{dependencyType:"stateVariable",variableName:"nIterates"}}),definition({dependencyValues:e}){let r=[],n=e.functionAttr,i=e.initialValue,s=!e.forceNumeric&&(n.stateValues.symbolic||e.forceSymbolic),o=e.nIterates;if(!n||e.nDimensions===0||!(e.nDimensions===1||Array.isArray(i.tree)&&["vector","tuple"].includes(i.tree[0])&&i.tree.length===e.nDimensions+1))return r=Array(o).fill(_l.fromAst("\uFF3F")),{setValue:{allIterates:r}};if(s)if(e.nDimensions===1){let l=n.stateValues.symbolicfs[0],u=i;for(let c=0;c<o;c++)u=l(u),r.push(u)}else{let l=n.stateValues.symbolicfs,u=i.tree.slice(1);for(let c=0;c<o;c++){let p=[];for(let m=0;m<e.nDimensions;m++)p.push(l[m](...u).tree);r.push(_l.fromAst(["vector",...p])),u=p}}else if(e.nDimensions===1){let l=n.stateValues.numericalfs[0],u=i.evaluate_to_constant();if(u===null)r=Array(o).fill(_l.fromAst("\uFF3F"));else for(let c=0;c<o;c++)u=l(u),r.push(_l.fromAst(u))}else{let l=n.stateValues.numericalfs,u=i.tree.slice(1).map(c=>_l.fromAst(c).evaluate_to_constant()).map(c=>c??NaN);for(let c=0;c<o;c++){let p=[];for(let m=0;m<e.nDimensions;m++)p.push(l[m](...u));r.push(_l.fromAst(["vector",...p])),u=p}}return{setValue:{allIterates:r}}}},t.allIteratesWithInitial={public:!0,componentType:"mathList",returnDependencies:()=>({initialValue:{dependencyType:"stateVariable",variableName:"initialValue"},allIterates:{dependencyType:"stateVariable",variableName:"allIterates"}}),definition({dependencyValues:e}){return{setValue:{allIteratesWithInitial:[e.initialValue,...e.allIterates]}}}},t.iterates={isArray:!0,public:!0,componentType:"math",entryPrefixes:["iterate"],returnArraySizeDependencies:()=>({nIterates:{dependencyType:"stateVariable",variableName:"nIterates"}}),returnArraySize({dependencyValues:e}){return[e.nIterates]},returnArrayDependenciesByKey(){return{globalDependencies:{allIterates:{dependencyType:"stateVariable",variableName:"allIterates"}}}},arrayDefinitionByKey({globalDependencyValues:e,arraySize:r}){let n={};for(let i=0;i<r[0];i++)n[i]=e.allIterates[i];return{setValue:{iterates:n}}}},t.finalIterate={public:!0,componentType:"math",stateVariablesDeterminingDependencies:["nIterates"],returnDependencies({stateValues:e}){return!Number.isFinite(e.nIterates)||e.nIterates<0?{}:e.nIterates>0?{finalIterate:{dependencyType:"stateVariable",variableName:`iterate${e.nIterates}`}}:{finalIterate:{dependencyType:"stateVariable",variableName:"initialValue"}}},definition({dependencyValues:e}){return{setValue:{finalIterate:e.finalIterate}}}},t}};T(kp,"componentType","functionIterates"),T(kp,"rendererType");var kl=class extends Dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.styleNumber,e}};T(kl,"componentType","module"),T(kl,"renderedDefault",!0),T(kl,"acceptAnyAttribute",!0);var Fp=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.componentType={createPrimitiveOfType:"string"},e.attribute={createPrimitiveOfType:"string"},e.defaultValue={leaveRaw:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.componentNameForAttributes={returnDependencies:()=>({parentVariableContainingName:{dependencyType:"parentStateVariable",variableName:"componentNameForAttributes"}}),definition({dependencyValues:e}){return{setValue:{componentNameForAttributes:e.parentVariableContainingName}}}},t.attributeName={returnDependencies:()=>({attribute:{dependencyType:"attributePrimitive",attributeName:"attribute"}}),definition({dependencyValues:e}){return{setValue:{attributeName:e.attribute}}}},t.readyToExpandWhenResolved={stateVariablesDeterminingDependencies:["componentNameForAttributes"],returnDependencies:({stateValues:e})=>({componentIdentity:{dependencyType:"componentIdentity",componentName:e.componentNameForAttributes}}),definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,components:e,workspace:r,componentInfoObjects:n,flags:i}){let s=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,o=n.componentTypeLowerCaseMapping[t.attributes.componentType.primitive.toLowerCase()];if(!n.allComponentClasses[o])return console.warn(`Could not find component type ${o}`),{replacements:[]};let u=e[await t.stateValues.componentNameForAttributes],c={};for(let v in u.attributes)c[v.toLowerCase()]=v;let p=await t.stateValues.attributeName,m=c[p.toLowerCase()],f=u.attributes[m];if(f===void 0){if(t.attributes.defaultValue===void 0)return console.warn("Cannot create component from attribute if neither attribute nor default value specified"),{replacements:[]};f=t.attributes.defaultValue}let d=u.constructor,h=Object.keys(d.createAttributesObject({flags:i})).map(v=>v.toLowerCase());if(h.push("name","target","assignnames"),h.includes(p.toLowerCase()))return console.warn(`Cannot add attribute ${p} of a ${d.componentType} as it already exists in ${d.componentType} class`),{replacements:[]};let b=bo({attrObj:{createComponentOfType:o},value:f,componentInfoObjects:n}).component;if(b.children&&(Pa(b.children,n),s)){for(let v of b.children)if(v.componentType==="copy"){let A=v.doenetAttributes.target;/[a-zA-Z_]/.test(A[0])&&(v.doenetAttributes.target="../"+A)}}return go({serializedComponents:[b],isAttributeComponent:!0,componentInfoObjects:n}),ys([b]),{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:[b],parentName:t.componentName,parentCreatesNewNamespace:s,componentInfoObjects:n}).serializedComponents}}};T(Fp,"componentType","customAttribute"),T(Fp,"assignNamesToReplacements",!0);var qd=class extends Ae{static returnChildGroups(){return[{group:"styleDefinitions",componentTypes:["styleDefinitions"]},{group:"feedbackDefinitions",componentTypes:["feedbackDefinitions"]},{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.componentNameForAttributes={returnDependencies:()=>({sourceCompositeIdentity:{dependencyType:"sourceCompositeIdentity"}}),definition({dependencyValues:e}){let r=null;return e.sourceCompositeIdentity&&(r=e.sourceCompositeIdentity.componentName),{setValue:{componentNameForAttributes:r}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({}),definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}};T(qd,"componentType","setup");var Fl=class extends re{static returnChildGroups(){return[{group:"inlines",componentTypes:["_inline"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.text={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({inlineChildren:{dependencyType:"child",childGroups:["inlines"],variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r="";for(let n of e.inlineChildren)typeof n!="object"?r+=n.toString():typeof n.stateValues.text=="string"?r+=n.stateValues.text:r+=" ";return{setValue:{text:r}}}},t.footnoteTag={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({footnoteCounter:{dependencyType:"counter",counterName:"footnote"}}),definition({dependencyValues:e}){return{setValue:{footnoteTag:String(e.footnoteCounter)}}}},t}};T(Fl,"componentType","footnote"),T(Fl,"renderChildren",!0),T(Fl,"includeBlankStringChildren",!0);var co=class extends ce{static returnChildGroups(){return[{group:"inlinesBlocks",componentTypes:["_inline","_block"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.text={public:!0,componentType:"text",returnDependencies:()=>({inlineChildren:{dependencyType:"child",childGroups:["inlinesBlocks"],variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let r="";for(let n of e.inlineChildren)typeof n!="object"?r+=n.toString():typeof n.stateValues.text=="string"?r+=n.stateValues.text:r+=" ";return{setValue:{text:r}}}},t}};T(co,"componentType","caption"),T(co,"rendererType","container"),T(co,"renderChildren",!0),T(co,"includeBlankStringChildren",!0);var jp=class extends Ln{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.open={createComponentOfType:"boolean",createStateVariable:"open",defaultValue:!1,public:!0,forRenderer:!0},e.switchable={createComponentOfType:"boolean",createStateVariable:"switchable",defaultValue:!1,public:!0,forRenderer:!0},e}async switchPoint({actionId:t}){if(await this.stateValues.switchable)return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!await this.stateValues.open}],actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{open:!await this.stateValues.open}}});this.coreFunctions.resolveAction({actionId:t})}};T(jp,"componentType","endpoint"),T(jp,"rendererType","point");import"math-expressions";var jl=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.sortVectorsBy={createComponentOfType:"text",createStateVariable:"sortVectorsBy",defaultValue:"displacement",public:!0,toLowerCase:!0,validValues:["displacement","tail"]},e.sortByComponent={createComponentOfType:"integer",createStateVariable:"sortByComponent",defaultValue:"1",public:!0},e}static returnChildGroups(){return[{group:"mathNumbers",componentTypes:["number","math","numberList","mathList","point","vector"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.componentNamesForValues={returnDependencies:()=>({children:{dependencyType:"child",childGroups:["mathNumbers"],variableNames:["componentNamesInList"],variablesOptional:!0}}),definition({dependencyValues:e}){let r=[];for(let n of e.children)n.stateValues.componentNamesInList?r.push(...n.stateValues.componentNamesInList):r.push(n.componentName);return{setValue:{componentNamesForValues:r}}}},t.sortedValues={stateVariablesDeterminingDependencies:["componentNamesForValues","sortByComponent"],returnDependencies({stateValues:e}){let r={sortVectorsBy:{dependencyType:"stateVariable",variableName:"sortVectorsBy"},sortByComponent:{dependencyType:"stateVariable",variableName:"sortByComponent"}};for(let[n,i]of e.componentNamesForValues.entries())r[`component${n}`]={dependencyType:"multipleStateVariables",componentName:i,variableNames:["value",`x${e.sortByComponent}`,`tailX${e.sortByComponent}`],variablesOptional:!0};return r},definition({dependencyValues:e,componentInfoObjects:r}){let n=[];for(let i in e){if(i.substring(0,9)!=="component")continue;let s=e[i];if(r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"number"}))n.push({componentName:s.componentName,numericalValue:s.stateValues.value});else if(r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"math"})){let o=s.stateValues.value.evaluate_to_constant();o===null&&(o=NaN),n.push({componentName:s.componentName,numericalValue:o})}else if(r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"point"})){let o=s.stateValues[`x${e.sortByComponent}`],l=NaN;o&&(l=o.evaluate_to_constant(),l===null&&(l=NaN)),n.push({componentName:s.componentName,numericalValue:l})}else if(r.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"vector"})){let o=NaN,l=s.stateValues[`x${e.sortByComponent}`];e.sortVectorsBy==="displacement"?l=s.stateValues[`x${e.sortByComponent}`]:l=s.stateValues[`tailX${e.sortByComponent}`],l&&(o=l.evaluate_to_constant(),o===null&&(o=NaN)),n.push({componentName:s.componentName,numericalValue:o})}}return n.sort((i,s)=>i.numericalValue-s.numericalValue),{setValue:{sortedValues:n}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({sortedValues:{dependencyType:"stateVariable",variableName:"sortedValues"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,components:e,componentInfoObjects:r,workspace:n}){let i=[],s=[];for(let l of await t.stateValues.sortedValues){let u;l.listInd===void 0?u=e[l.componentName]:u=e[l.componentName].activeChildren[l.listInd],u&&(s.push(u.componentName),i.push(await u.serialize()))}n.uniqueIdentifiersUsed=[],i=_r({serializedComponents:i,componentName:t.componentName,uniqueIdentifiersUsed:n.uniqueIdentifiersUsed});let o=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:i,parentName:t.componentName,parentCreatesNewNamespace:await t.stateValues.newNamespace,componentInfoObjects:r});return n.componentsCopied=s,{replacements:o.serializedComponents}}static async calculateReplacementChanges({component:t,components:e,componentInfoObjects:r,workspace:n}){let i=[];for(let l of await t.stateValues.sortedValues){let u;l.listInd===void 0?u=e[l.componentName]:u=e[l.componentName].activeChildren[l.listInd],u&&i.push(u.componentName)}if(i.length==n.componentsCopied.length&&n.componentsCopied.every((l,u)=>l===i[u]))return[];let s=(await this.createSerializedReplacements({component:t,components:e,componentInfoObjects:r,workspace:n})).replacements;return[{changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:s}]}};T(jl,"componentType","sort"),T(jl,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved"),T(jl,"assignNamesToReplacements",!0);import vH from"math-expressions";var Mp=class extends re{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.variables={createComponentOfType:"variables"},e.nDiscretizationPoints={createComponentOfType:"number",createStateVariable:"nDiscretizationPoints",defaultValue:100,public:!0},e.minVar={createComponentOfType:"number",createStateVariable:"minVar",defaultValue:null},e.maxVar={createComponentOfType:"number",createStateVariable:"maxVar",defaultValue:null},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){return r.every(n=>typeof n=="string"||n.doenetAttributes&&n.doenetAttributes.createdFromMacro)?r.length===1&&typeof r[0]!="string"?{success:!1}:{success:!0,newChildren:[{componentType:"math",children:r}]}:{success:!1}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"maths",componentTypes:["math"]},{group:"strings",componentTypes:["string"]}]}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.variables={isArray:!0,public:!0,componentType:"variable",entryPrefixes:["variable"],returnArraySizeDependencies:()=>({}),returnArraySize({dependencyValues:r}){return[1]},returnArrayDependenciesByKey({arrayKeys:r}){return{globalDependencies:{variablesAttr:{dependencyType:"attributeComponent",attributeName:"variables",variableNames:["variables"]}}}},arrayDefinitionByKey({globalDependencyValues:r,arraySize:n,arrayKeys:i,usedDefault:s}){let o=[];return r.variablesAttr!==null&&(o=r.variablesAttr.stateValues.variables),{setValue:{variables:En(n[0],o)}}}},e.variable={isAlias:!0,targetVariableName:"variable1"},e.allSolutions={returnDependencies:()=>({mathChild:{dependencyType:"child",childGroups:["maths"],variableNames:["value"]},variables:{dependencyType:"stateVariable",variableName:"variables"},minVar:{dependencyType:"stateVariable",variableName:"minVar"},maxVar:{dependencyType:"stateVariable",variableName:"maxVar"},nDiscretizationPoints:{dependencyType:"stateVariable",variableName:"nDiscretizationPoints"}}),definition({dependencyValues:r}){if(r.mathChild.length===0)return{setValue:{allSolutions:[]}};let n=r.mathChild[0].stateValues.value;if(!(Array.isArray(n.tree)&&n.tree.length===3&&n.tree[0]==="="))return{setValue:{allSolutions:[]}};let i=r.minVar,s=r.maxVar,o=[],l=r.variables[0].subscripts_to_strings().tree,u=vH.fromAst(["+",n.tree[1],["-",n.tree[2]]]).subscripts_to_strings(),c=u.f(),p=w=>c({[l]:w}),m=w=>Wr({value:u.substitute({[l]:w}).strings_to_subscripts(),simplify:!0,expand:!0}).evaluate_to_constant(),f=function(w){try{return p(w)}catch(x){return NaN}},d=function(w){try{return p(w)}catch(x){let R=m(w);return R!==null?R:NaN}};if(Number.isFinite(i)||(i=-10),Number.isFinite(s)||(s=10),i>s)return{setValue:{allSolutions:[]}};let h=[i,s],y=[i];for(let w=0;w<h.length-1;w++){let x=h[w],R=h[w+1],O=r.nDiscretizationPoints,_=(R-x)/O;for(let k=1;k<O;k++)y.push(x+k*_);y.push(R)}let b=2*y[0]-y[1],g=2*y[y.length-1]-y[y.length-2];y=[b,...y,g];let v=y.map(d),A=y[0],C=v[0];for(let w=0;w<y.length;w++){let x=y[w],R=v[w];if(!Number.isFinite(R)||!Number.isFinite(C)){let O,_;if(Number.isFinite(R)?(O=x,_=A):Number.isFinite(C)&&(O=A,_=x),O!==void 0){for(;;){let k=(O+_)/2;if(k===O||k===_)break;Number.isFinite(f(k))?O=k:_=k}[x,A].includes(O)||(y.splice(w,0,O),v.splice(w,0,f(O)))}}A=x,C=R}o=[],A=y[0],C=v[0],C===0&&o.push(A);for(let w=1;w<y.length;w++){let x=y[w],R=v[w];if(R===0){let O=!1;if(w<y.length-1){let _=y[w+1],k=v[w+1],B=A,U=C;if(C*k>0){for(let H=0;H<10;H++)if(A=.1*A+.9*x,_=.1*_+.9*x,C=f(A),k=f(_),C*k<0){C*U<0?(o.push(t.fzero(f,[B,A])),o.push(x)):(o.includes(x)||o.push(x),x=_,R=k),O=!0;break}}}!O&&!o.includes(x)&&o.push(x)}else if(R*C<0)o.push(t.fzero(f,[A,x]));else if(C!==0&&w<y.length-1){let O=y[w+1],_=v[w+1];if((C-R)*(_-R)>0&&(R>0&&C>R||R<0&&C<R)){let k;C>R?k=f:k=U=>-f(U);let B=t.fminbr(k,[A,O],void 0,1e-10);if(B.success){let U=B.x,H=f(U);H*C<0?(o.push(t.fzero(f,[A,U])),x=U,R=H):H===0&&o.push(U)}}}A=x,C=R}return o=o.filter(w=>w>=i&&w<=s),{setValue:{allSolutions:o.map(w=>vH.fromAst(w))}}}},e.numberSolutions={public:!0,componentType:"integer",returnDependencies:()=>({allSolutions:{dependencyType:"stateVariable",variableName:"allSolutions"}}),definition({dependencyValues:r}){return{setValue:{numberSolutions:r.allSolutions.length}}}},e.solutions={public:!0,componentType:"math",isArray:!0,entryPrefixes:["solution"],returnArraySizeDependencies:()=>({numberSolutions:{dependencyType:"stateVariable",variableName:"numberSolutions"}}),returnArraySize({dependencyValues:r}){return[r.numberSolutions]},returnArrayDependenciesByKey(){return{globalDependencies:{allSolutions:{dependencyType:"stateVariable",variableName:"allSolutions"}}}},arrayDefinitionByKey({globalDependencyValues:r}){let n={};for(let i=0;i<r.__array_size[0];i++)n[i]=r.allSolutions[i];return{setValue:{solutions:n}}}},e}};T(Mp,"componentType","solveEquations"),T(Mp,"rendererType");var Bp=class extends Dt{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.rendered,e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.rendered={returnDependencies:()=>({parentOpen:{dependencyType:"parentStateVariable",variableName:"open"}}),markStale:()=>({updateReplacements:!0}),definition({dependencyValues:e}){return{setValue:{rendered:Boolean(e.parentOpen)}}}},t}static async calculateReplacementChanges({component:t,componentInfoObjects:e}){if(await t.stateValues.rendered&&t.replacements.length===0){let r=(await this.createSerializedReplacements({component:t,componentInfoObjects:e})).replacements;return[{changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:0,serializedReplacements:r}]}else return[]}};T(Bp,"componentType","_solutionContainer"),T(Bp,"stateVariableToEvaluateAfterReplacements","open");import jR from"math-expressions";var Lp=class extends ce{actions={addPoint:this.addPoint.bind(this),deletePoint:this.deletePoint.bind(this),movePoint:this.movePoint.bind(this),togglePoint:this.togglePoint.bind(this),toggleInterval:this.toggleInterval.bind(this),clear:this.clear.bind(this),setToR:this.setToR.bind(this)};static createAttributesObject(t){let e=super.createAttributesObject(t);return e.xmin={createComponentOfType:"number",createStateVariable:"xmin",defaultValue:-10,public:!0,forRenderer:!0},e.xmax={createComponentOfType:"number",createStateVariable:"xmax",defaultValue:10,public:!0,forRenderer:!0},e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:800,public:!0,forRenderer:!0},e.height={createComponentOfType:"_componentSize",createStateVariable:"height",defaultValue:300,public:!0,forRenderer:!0},e.xlabel={createComponentOfType:"text",createStateVariable:"xlabel",defaultValue:"",public:!0,forRenderer:!0},e.dx={createComponentOfType:"number",createStateVariable:"dx",defaultValue:.5,public:!0},e.variable={createComponentOfType:"variable",createStateVariable:"variable",defaultValue:jR.fromAst("x")},e.format={createComponentOfType:"text",createStateVariable:"format",defaultValue:"text",public:!0},e.prefill={createComponentOfType:"text",createStateVariable:"prefill",defaultValue:"",public:!0},e.bindValueTo={createComponentOfType:"subsetOfReals"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.subsetValue={public:!0,componentType:"subsetOfReals",hasEssential:!0,returnDependencies:()=>({bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["subsetValue"]},prefill:{dependencyType:"stateVariable",variableName:"prefill"},variable:{dependencyType:"stateVariable",variableName:"variable"},format:{dependencyType:"stateVariable",variableName:"format"}}),definition:function({dependencyValues:e}){return e.bindValueTo?{setValue:{subsetValue:e.bindValueTo.stateValues.subsetValue}}:{useEssentialOrDefaultValue:{subsetValue:{get defaultValue(){return u5e({inputString:e.prefill,format:e.format,variable:e.variable})}}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.bindValueTo?{success:!0,instructions:[{setDependency:"bindValueTo",desiredValue:e.subsetValue,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"subsetValue",value:e.subsetValue}]}}},t.pointsFromSubset={additionalStateVariablesDefined:["intervalsFromSubset"],returnDependencies:()=>({subsetValue:{dependencyType:"stateVariable",variableName:"subsetValue"}}),definition({dependencyValues:e}){function r(u,c){let p=[],m=[];if(u.points&&(p=u.points),u.intervals&&(m=u.intervals),c.points){let f=p.map(d=>d.value);for(let d of c.points){let h=f.indexOf(d.value);h===-1?p.push(d):p[h].inSubset||=d.inSubset}}return c.intervals&&m.push(...c.intervals),{points:p,intervals:m}}function n(u){if(u===null||u.isEmpty())return{};if(u instanceof Nt.Union){let c=[],p=[];for(let m of u.subsets){let f=n(m);({points:c,intervals:p}=r({points:c,intervals:p},f))}return{points:c,intervals:p}}else{if(u instanceof Nt.RealLine)return{intervals:[[-1/0,1/0]]};if(u instanceof Nt.Singleton)return{points:[{value:u.element,inSubset:!0}]};if(u instanceof Nt.OpenInterval){let c=[[u.left,u.right]],p=[];return Number.isFinite(u.left)&&p.push({value:u.left,inSubset:!1}),Number.isFinite(u.right)&&p.push({value:u.right,inSubset:!1}),{intervals:c,points:p}}}return{}}let{points:i,intervals:s}=n(e.subsetValue),o=i||[],l=s||[];return o.sort((u,c)=>u.value-c.value),l.sort((u,c)=>u[0]-c[0]),{setValue:{pointsFromSubset:o,intervalsFromSubset:l}}}},t.additionalPoints={defaultValue:[],hasEssential:!0,returnDependencies:()=>({}),definition(){return{useEssentialOrDefaultValue:{additionalPoints:!0}}},inverseDefinition({desiredStateVariableValues:e}){return e.additionalPoints.every(Number.isFinite)?{success:!0,instructions:[{setEssentialValue:"additionalPoints",value:[...e.additionalPoints].sort((r,n)=>r-n)}]}:{success:!1}}},t.points={additionalStateVariablesDefined:[{variableName:"intervals",forRenderer:!0}],forRenderer:!0,returnDependencies:()=>({pointsFromSubset:{dependencyType:"stateVariable",variableName:"pointsFromSubset"},intervalsFromSubset:{dependencyType:"stateVariable",variableName:"intervalsFromSubset"},additionalPoints:{dependencyType:"stateVariable",variableName:"additionalPoints"}}),definition({dependencyValues:e}){let r=[...e.pointsFromSubset],n=[...e.intervalsFromSubset],i=[...e.additionalPoints].sort((f,d)=>f-d),s=[],o=[],l=0,u=1/0,c=0;i.length>0&&(u=i[0]);let p=n[0],m=-1/0;r.push({value:1/0,inSubset:!1});for(let f of r){let d=!1;for(p&&p[0]<f.value&&(d=!0);u<f.value;)u!==m&&(s.push({value:u,inSubset:d,isAdditional:!0,additionalPointInd:c}),o.push({left:m,right:u,inSubset:d}),m=u),c++,u=i[c],u===void 0&&(u=1/0);s.push(f),o.push({left:m,right:f.value,inSubset:d}),m=f.value,d&&(l++,p=n[l])}return s=s.slice(0,s.length-1),{setValue:{points:s,intervals:o}}}},t}async addPoint({value:t,actionId:e}){let r=await this.stateValues.dx,n=Math.round(Math.max(await this.stateValues.xmin,Math.min(await this.stateValues.xmax,t))/r)*r,i=[...await this.stateValues.pointsFromSubset],s=[...await this.stateValues.intervalsFromSubset],o=[...await this.stateValues.additionalPoints];if(!o.includes(n)&&!i.map(u=>u.value).includes(n)){let u=!1;for(let c of s)if(c[0]<n&&c[1]>n){u=!0;break}if(u)return o.push(n),await this.coreFunctions.performUpdate({updateInstructions:[{componentName:this.componentName,updateType:"updateValue",stateVariable:"additionalPoints",value:o}],actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{addedPoint:n,intervalsFromSubset:s,pointsFromSubset:i,additionalPoints:o}}});{i.push({value:n,inSubset:!0});let c=await this.createUpdateInstructions({intervalsFromSubset:s,pointsFromSubset:i,modifiedAdditionalPoints:!1,additionalPoints:o});return await this.coreFunctions.performUpdate({updateInstructions:c,actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{addedPoint:n,intervalsFromSubset:s,pointsFromSubset:i,additionalPoints:o}}})}}this.coreFunctions.resolveAction({actionId:e})}async deletePoint({pointInd:t,actionId:e}){let r=await this.stateValues.points[t],n=[...await this.stateValues.additionalPoints],i=[...await this.stateValues.pointsFromSubset],s=[...await this.stateValues.intervalsFromSubset];if(r.isAdditional)return n.splice(r.additionalPointInd,1),await this.coreFunctions.performUpdate({updateInstructions:[{componentName:this.componentName,updateType:"updateValue",stateVariable:"additionalPoints",value:n}],actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{deletedPoint:r.value,intervalsFromSubset:s,pointsFromSubset:i,additionalPoints:n}}});{let o=!1,l=i.map(m=>m.value).indexOf(r.value),u=s.map(m=>m[1]).indexOf(r.value),c=s.map(m=>m[0]).indexOf(r.value);if(u!==-1)if(c!==-1)s[u]=[s[u][0],s[c][1]],s.splice(c,1),i.splice(l,1);else{let m=(await this.stateValues.points)[t-1];m&&m.isAdditional?(s[u]=[s[u][0],m.value],n.splice(r.additionalPointInd,1),o=!0,i.splice(l,1,m)):(s.splice(u,1),i.splice(l,1),m&&!m.inSubset&&s.map(d=>d[1]).indexOf(m.value)===-1&&(n.push(m.value),o=!0))}else if(c!==-1){let m=(await this.stateValues.points)[t+1];m&&m.isAdditional?(s[c]=[m.value,s[c][1]],n.splice(r.additionalPointInd,1),o=!0,i.splice(l,1,m)):(s.splice(c,1),i.splice(l,1),m&&!m.inSubset&&s.map(d=>d[0]).indexOf(m.value)===-1&&(n.push(m.value),o=!0))}else i.splice(l,1);let p=await this.createUpdateInstructions({intervalsFromSubset:s,pointsFromSubset:i,modifiedAdditionalPoints:o,additionalPoints:n});return await this.coreFunctions.performUpdate({updateInstructions:p,actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{deletedPoint:r.value,intervalsFromSubset:s,pointsFromSubset:i,additionalPoints:n}}})}}async createUpdateInstructions({intervalsFromSubset:t,pointsFromSubset:e,modifiedAdditionalPoints:r,additionalPoints:n}){let i=await this.stateValues.dx,s=c=>Math.round(c/i)*i,o=[];for(let c of t)o.push(new Nt.OpenInterval(s(c[0]),s(c[1])));for(let c of e)c.inSubset&&o.push(new Nt.Singleton(s(c.value)));let l;o.length===0?l=new Nt.EmptySet:o.length===1?l=o[0]:l=new Nt.Union(o);let u=[{componentName:this.componentName,updateType:"updateValue",stateVariable:"subsetValue",value:l}];return r&&u.push({componentName:this.componentName,updateType:"updateValue",stateVariable:"additionalPoints",value:n.map(s)}),u}async movePoint({pointInd:t,value:e,transient:r,actionId:n}){let i=await this.stateValues.dx,s=Math.round(Math.max(await this.stateValues.xmin,Math.min(await this.stateValues.xmax,e))/i)*i,o=await this.stateValues.points,l=o[t],u=o[t-1];u&&(s=Math.max(s,u.value+i));let c=o[t+1];c&&(s=Math.min(s,c.value-i));let p=[...await this.stateValues.additionalPoints],m=[...await this.stateValues.pointsFromSubset],f=[...await this.stateValues.intervalsFromSubset];if(l.isAdditional)return p[l.additionalPointInd]=s,r?await this.coreFunctions.performUpdate({updateInstructions:[{componentName:this.componentName,updateType:"updateValue",stateVariable:"additionalPoints",value:p}],transient:!0,actionId:n}):await this.coreFunctions.performUpdate({updateInstructions:[{componentName:this.componentName,updateType:"updateValue",stateVariable:"additionalPoints",value:p}],actionId:n,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{movedPoint:s,intervalsFromSubset:f,pointsFromSubset:m,additionalPoints:p}}});{let d=m.map(g=>g.value).indexOf(l.value),h=f.map(g=>g[1]).indexOf(l.value),y=f.map(g=>g[0]).indexOf(l.value);m[d]={value:s,inSubset:m[d].inSubset},h!==-1&&(f[h]=[f[h][0],s]),y!==-1&&(f[y]=[s,f[y][1]]);let b=await this.createUpdateInstructions({intervalsFromSubset:f,pointsFromSubset:m,modifiedAdditionalPoints:!1});return r?await this.coreFunctions.performUpdate({updateInstructions:b,transient:!0,actionId:n}):await this.coreFunctions.performUpdate({updateInstructions:b,actionId:n,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{movedPoint:s,intervalsFromSubset:f,pointsFromSubset:m,additionalPoints:p}}})}}async togglePoint({pointInd:t,actionId:e}){let r=(await this.stateValues.points)[t],n=[...await this.stateValues.pointsFromSubset],i=[...await this.stateValues.intervalsFromSubset],s=[...await this.stateValues.additionalPoints],o=!1;if(r.isAdditional)if(s.splice(r.additionalPointInd,1),o=!0,r.inSubset){for(let[u,c]of i.entries())if(c[0]<r.value&&c[1]>r.value){let p=[[c[0],r.value],[r.value,c[1]]];i.splice(u,1,...p);break}}else n.push({value:r.value,inSubset:!0});else{let u=n.map(m=>m.value).indexOf(r.value),c=i.map(m=>m[1]).indexOf(r.value),p=i.map(m=>m[0]).indexOf(r.value);c!==-1?p!==-1?(i[c]=[i[c][0],i[p][1]],i.splice(p,1),n.splice(u,1),s.push(r.value),o=!0):n[u]={value:r.value,inSubset:!r.inSubset}:p!==-1?n[u]={value:r.value,inSubset:!r.inSubset}:(n.splice(u,1),s.push(r.value),o=!0)}let l=await this.createUpdateInstructions({intervalsFromSubset:i,pointsFromSubset:n,modifiedAdditionalPoints:o,additionalPoints:s});return await this.coreFunctions.performUpdate({updateInstructions:l,actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{toggledPoint:r.value,intervalsFromSubset:i,pointsFromSubset:n,additionalPoints:s}}})}async toggleInterval({intervalInd:t,actionId:e}){let r=(await this.stateValues.intervals)[t],n=await this.stateValues.points,i=n[t-1],s=n[t],o=[...await this.stateValues.pointsFromSubset],l=[...await this.stateValues.intervalsFromSubset],u=[...await this.stateValues.additionalPoints],c=!1;if(r.inSubset){let m,f;for(let[d,h]of l.entries())if(h[0]<=r.left&&h[1]>=r.right){f=h,m=d;break}if(r.left===f[0])if(r.right===f[1]){if(l.splice(m,1),i&&!i.inSubset&&l.map(h=>h[1]).indexOf(i.value)===-1){let h=o.map(y=>y.value).indexOf(i.value);o.splice(h,1),u.push(i.value),c=!0}if(s&&!s.inSubset&&l.map(h=>h[0]).indexOf(s.value)===-1){let h=o.map(y=>y.value).indexOf(s.value);o.splice(h,1),u.push(s.value),c=!0}}else{if(l[m]=[r.right,f[1]],i&&!i.inSubset&&l.map(h=>h[1]).indexOf(i.value)===-1){let h=o.map(y=>y.value).indexOf(i.value);o.splice(h,1),u.push(i.value),c=!0}o.push({value:s.value,inSubset:!0}),u.splice(s.additionalPointInd,1),c=!0}else if(r.right===f[1]){if(l[m]=[f[0],r.left],s&&!s.inSubset&&l.map(h=>h[0]).indexOf(s.value)===-1){let h=o.map(y=>y.value).indexOf(s.value);o.splice(h,1),u.push(s.value),c=!0}o.push({value:i.value,inSubset:!0}),u.splice(i.additionalPointInd,1),c=!0}else{let d=[[f[0],r.left],[r.right,f[1]]];l.splice(m,1,...d),o.push({value:i.value,inSubset:!0}),o.push({value:s.value,inSubset:!0}),u.splice(s.additionalPointInd,1),u.splice(i.additionalPointInd,1),c=!0}}else{let m=l.map(d=>d[1]).indexOf(r.left),f=l.map(d=>d[0]).indexOf(r.right);if(m===-1)f===-1?(l.push([r.left,r.right]),s&&s.isAdditional&&(u.splice(s.additionalPointInd,1),c=!0),i&&i.isAdditional&&(u.splice(i.additionalPointInd,1),c=!0)):(s.inSubset?(l[f]=[r.left,l[f][1]],u.push(s.value),c=!0):l.push([r.left,r.right]),i&&i.isAdditional&&(u.splice(i.additionalPointInd,1),c=!0));else if(f===-1)i.inSubset?(l[m]=[l[m][0],r.right],u.push(i.value),c=!0):l.push([r.left,r.right]),s&&s.isAdditional&&(u.splice(s.additionalPointInd,1),c=!0);else if(i.inSubset)if(s.inSubset){let d=[l[m][0],l[f][1]];l.splice(m,2,d),u.push(i.value),u.push(s.value),c=!0}else l[m]=[l[m][0],r.right],u.push(i.value),c=!0;else s.inSubset?(l[f]=[r.left,l[f][1]],u.push(s.value),c=!0):l.push([r.left,r.right])}let p=await this.createUpdateInstructions({intervalsFromSubset:l,pointsFromSubset:o,modifiedAdditionalPoints:c,additionalPoints:u});return await this.coreFunctions.performUpdate({updateInstructions:p,actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{toggledInterval:[r.left,r.right],intervalsFromSubset:l,pointsFromSubset:o,additionalPoints:u}}})}async clear({actionId:t}){let e=await this.createUpdateInstructions({intervalsFromSubset:[],pointsFromSubset:[],modifiedAdditionalPoints:!0,additionalPoints:[]});return await this.coreFunctions.performUpdate({updateInstructions:e,actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{cleared:!0,intervalsFromSubset:[],pointsFromSubset:[],additionalPoints:[]}}})}async setToR({actionId:t}){let e=await this.createUpdateInstructions({intervalsFromSubset:[[-1/0,1/0]],pointsFromSubset:[],modifiedAdditionalPoints:!0,additionalPoints:[]});return await this.coreFunctions.performUpdate({updateInstructions:e,actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{setToR:!0,intervalsFromSubset:[[-1/0,1/0]],pointsFromSubset:[],additionalPoints:[]}}})}};T(Lp,"componentType","subsetOfRealsInput"),T(Lp,"variableForPlainMacro","subsetValue");function u5e({inputString:a,format:t,variable:e}){if(!a)return new Nt.EmptySet;let r;if(t==="latex")try{r=jR.fromLatex(a)}catch(n){return console.warn(`Invalid latex for subsetOfRealsInput: ${a}`),new Nt.EmptySet}else if(t==="text")try{r=jR.fromText(a)}catch(n){return console.warn(`Invalid text for subsetOfRealsInput: ${a}`),new Nt.EmptySet}return Xp(r,e)}import Wd from"math-expressions";var Ml=class extends ot{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.createIntervals.defaultValue=!0,e.variable={createComponentOfType:"variable",createStateVariable:"variable",defaultValue:Wd.fromAst("x")},e.displayMode={createComponentOfType:"text",createStateVariable:"displayMode",defaultValue:"intervals",public:!0,toLowerCase:!0,validValues:["intervals","inequalities"]},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return $r({stateVariableDefinitions:t,oldName:"unnormalizedValue",newName:"unnormalizedValuePreliminary"}),t.value.componentType="math",t.haveSingleSubsetChild={returnDependencies:()=>({mathChildren:{dependencyType:"child",childGroups:["maths"]}}),definition({dependencyValues:e,componentInfoObjects:r}){return{setValue:{haveSingleSubsetChild:e.mathChildren.length===1&&e.mathChildren.filter(i=>r.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"subsetOfReals"})).length===1}}}},t.subsetValue={stateVariablesDeterminingDependencies:["haveSingleSubsetChild"],returnDependencies({stateValues:e}){let r={haveSingleSubsetChild:{dependencyType:"stateVariable",variableName:"haveSingleSubsetChild"}};return e.haveSingleSubsetChild?r.subsetChild={dependencyType:"child",childGroups:["maths"],variableNames:["subsetValue"]}:(r.unnormalizedValuePreliminary={dependencyType:"stateVariable",variableName:"unnormalizedValuePreliminary"},r.variable={dependencyType:"stateVariable",variableName:"variable"}),r},definition({dependencyValues:e}){let r;return e.haveSingleSubsetChild?r=e.subsetChild[0].stateValues.subsetValue:r=Xp(e.unnormalizedValuePreliminary,e.variable),{setValue:{subsetValue:r}}},async inverseDefinition({desiredStateVariableValues:e,dependencyValues:r,stateValues:n}){if(r.haveSingleSubsetChild)return{success:!0,instructions:[{setDependency:"subsetChild",desiredValue:e.subsetValue,childIndex:0,variableIndex:0}]};{let i=TH({subsetValue:e.subsetValue,variable:r.variable,displayMode:await n.displayMode});return{success:!0,instructions:[{setDependency:"unnormalizedValuePreliminary",desiredValue:i}]}}}},t.unnormalizedValue={returnDependencies:()=>({subsetValue:{dependencyType:"stateVariable",variableName:"subsetValue"},displayMode:{dependencyType:"stateVariable",variableName:"displayMode"},variable:{dependencyType:"stateVariable",variableName:"variable"}}),definition({dependencyValues:e}){return{setValue:{unnormalizedValue:TH(e)}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){let n=Xp(e.unnormalizedValue,r.variable);return{success:!0,instructions:[{setDependency:"subsetValue",desiredValue:n}]}}},t}};T(Ml,"componentType","subsetOfReals"),T(Ml,"rendererType","math"),T(Ml,"primaryStateVariableForDefinition","subsetValue");function TH({subsetValue:a,variable:t,displayMode:e="intervals"}){function r(i){return i===null?"\uFF3F":e==="intervals"?i.closedInterval?["interval",["tuple",i.left,i.right],["tuple",!0,!0]]:i.openClosedInterval?["interval",["tuple",i.left,i.right],["tuple",!1,!0]]:i.closedOpenInterval?["interval",["tuple",i.left,i.right],["tuple",!0,!1]]:i.toMathExpression().tree:i.closedInterval?["lts",["tuple",i.left,t,i.right],["tuple",!1,!1]]:i.openClosedInterval?i.left===-1/0?["le",t,i.right]:["lts",["tuple",i.left,t,i.right],["tuple",!0,!1]]:i.closedOpenInterval?i.right===1/0?["ge",t,i.left]:["lts",["tuple",i.left,t,i.right],["tuple",!1,!0]]:i instanceof Nt.OpenInterval?i.left===-1/0?["<",t,i.right]:i.right===1/0?[">",t,i.left]:["lts",["tuple",i.left,t,i.right],["tuple",!0,!0]]:i instanceof Nt.Singleton?["=",t,i.element]:i.isEmpty()?["in",t,"\u2205"]:i instanceof Nt.RealLine?["in",t,"R"]:null}let n;if(a instanceof Nt.Union){let i=a.subsets.filter(l=>l instanceof Nt.Singleton),s=a.subsets.filter(l=>l instanceof Nt.OpenInterval);for(let l=0;l<i.length;l++){let u=i[l].element;for(let c=0;c<s.length;c++){let p=s[c];u===p.left?(p.openClosedInterval?(p.closedInterval=!0,delete p.openClosedInterval):(p={left:p.left,right:p.right,closedOpenInterval:!0},s.splice(c,1,p)),i.splice(l,1),l--):u===p.right&&(p.closedOpenInterval?(p.closedInterval=!0,delete p.closedOpenInterval):(p={left:p.left,right:p.right,openClosedInterval:!0},s.splice(c,1,p)),i.splice(l,1),l--)}}let o=[...s,...i].sort((l,u)=>(l.left===void 0?l.element:l.left)-(u.left===void 0?u.element:u.left)).map(l=>r(l));o.length>1?e==="intervals"?n=Wd.fromAst(["union",...o]):n=Wd.fromAst(["or",...o]):n=Wd.fromAst(o[0])}else n=Wd.fromAst(r(a));return n}var Bl=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.type={createPrimitiveOfType:"string",createStateVariable:"type",defaultPrimitiveValue:"text",toLowerCase:!0,validValues:["text"]},e.splitBy={createComponentOfType:"text",createStateVariable:"splitBy",defaultValue:"letter",toLowerCase:!0,validValues:["letter","word","comma"]},e}static returnSugarInstructions(){let t=[];function e({matchedChildren:r,componentAttributes:n}){let i=n.type;return["text"].includes(i)||(i="text"),{success:!0,newChildren:[{componentType:i,children:r}]}}return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"anything",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.originalValue={returnDependencies:()=>({child:{dependencyType:"child",childGroups:["anything"],variableNames:["value"]}}),definition({dependencyValues:e}){return e.child.length>0?{setValue:{originalValue:e.child[0].stateValues.value}}:{setValue:{originalValue:null}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){return r.child.length>0?{success:!0,instructions:[{setDependency:"child",desiredValue:e.originalValue,childIndex:0,variableIndex:0}]}:{success:!1}}},t.splitValues={returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},originalValue:{dependencyType:"stateVariable",variableName:"originalValue"},splitBy:{dependencyType:"stateVariable",variableName:"splitBy"}}),definition({dependencyValues:e}){if(e.originalValue===null)return{setValue:{splitValues:[]}};let r=[];return e.splitBy==="letter"?r=[...e.originalValue]:e.splitBy==="word"?r=e.originalValue.split(/\s+/):e.splitBy==="comma"?r=e.originalValue.split(/\s*,\s*/):r=[e.originalValue],{setValue:{splitValues:r}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({splitValues:{dependencyType:"stateVariable",variableName:"splitValues"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{setValue:{readyToExpandWhenResolved:!0}}}},t}static async createSerializedReplacements({component:t,componentInfoObjects:e}){let r=t.attributes.newNamespace&&t.attributes.newNamespace.primitive,n={componentType:"textList",state:{textsShadow:await t.stateValues.splitValues},downstreamDependencies:{[t.componentName]:[{dependencyType:"referenceShadow",compositeName:t.componentName,propVariable:"splitValues"}]}};return{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:[n],parentName:t.componentName,parentCreatesNewNamespace:r,componentInfoObjects:e}).serializedComponents}}};T(Bl,"componentType","split"),T(Bl,"assignNamesToReplacements",!0),T(Bl,"stateVariableToEvaluateAfterReplacements","readyToExpandWhenResolved");import Pr from"math-expressions";var Up=class extends za{static createAttributesObject(t){let e=super.createAttributesObject(t);return delete e.draggable,delete e.equation,delete e.through,delete e.slope,e.points={createComponentOfType:"_pointListComponent"},e}static returnSugarInstructions(){return[]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.draggable={componentType:"boolean",public:!0,forRenderer:!0,returnDependencies:()=>({}),definition:()=>({setValue:{draggable:!1}})},t.nDimensions={public:!0,componentType:"number",returnDependencies:()=>({}),definition:()=>({setValue:{nDimensions:2}})},delete t.nPointsPrescribed,delete t.basedOnSlope,delete t.dForSlope,delete t.essentialPoint1x,delete t.essentialPoint1y,delete t.equationIdentity,delete t.equation.stateVariablesDeterminingDependencies,t.equation.returnDependencies=()=>({points:{dependencyType:"attributeComponent",attributeName:"points",variableNames:["points","nDimensions"]},variables:{dependencyType:"stateVariable",variableName:"variables"}}),t.equation.definition=function({dependencyValues:e}){if(!e.points||e.points.stateValues.nDimensions<2||e.points.stateValues.points.length<1){let h=Pr.fromAst("\uFF3F");return{setValue:{equation:h,coeff0:h,coeffvar1:h,coeffvar2:h}}}let r=[],n=[];for(let h of e.points.stateValues.points){let y=h.slice(0,2).map(b=>b&&b.evaluate_to_constant());y.every(Number.isFinite)&&(r.push([1,y[0]]),n.push([y[1]]))}if(r.length===0){let h=Pr.fromAst("\uFF3F");return{setValue:{equation:h,coeff0:h,coeffvar1:h,coeffvar2:h}}}r=Pr.math.matrix(r),n=Pr.math.matrix(n);let i=Pr.math.transpose(r),s=Pr.math.multiply(i,n),o=Pr.math.multiply(i,r),l=Pr.math.lusolve(o,s),u=Pr.fromAst(Pr.math.subset(l,Pr.math.index(0,0))),c=Pr.fromAst(Pr.math.subset(l,Pr.math.index(1,0))),p=Pr.fromAst(-1),m=e.variables,f=Pr.fromAst(["+",["*","a","x"],"c"]).substitute({a:c,c:u,x:m[0],y:m[1]}).simplify();return{setValue:{equation:Pr.fromAst(["=","y","r"]).substitute({r:f}),coeff0:u,coeffvar1:c,coeffvar2:p}}},delete t.equation.inverseDefinition,delete t.points.stateVariablesDeterminingDependencies,t.points.returnArrayDependenciesByKey=function(){return{globalDependencies:{coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"},variables:{dependencyType:"stateVariable",variableName:"variables"},lastPointsFromInverting:{dependencyType:"stateVariable",variableName:"lastPointsFromInverting"}}}},t}};T(Up,"componentType","bestFitLine"),T(Up,"rendererType","line");var $d=class extends Ge{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.boundaryValues={createComponentOfType:"numberList",createStateVariable:"boundaryValues",defaultValue:[0,1],forRenderer:!0,public:!0},e.function={createComponentOfType:"function"},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let r="";return e.selectedStyle.lineWidth>=4?r+="thick ":e.selectedStyle.lineWidth<=1&&(r+="thin "),e.selectedStyle.lineStyle==="dashed"?r+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=e.selectedStyle.lineColor,{setValue:{styleDescription:r}}}},t.function={additionalStateVariablesDefined:[{variableName:"haveFunction",forRenderer:!0},{variableName:"fDefinition",forRenderer:!0}],returnDependencies:()=>({functionAttr:{dependencyType:"attributeComponent",attributeName:"function",variableNames:["numericalfs","nInputs","nOutputs","fDefinition"]}}),definition({dependencyValues:e}){return e.functionAttr===null||e.functionAttr.stateValues.nInputs!==1||e.functionAttr.stateValues.nOutputs!==1?{setValue:{function:()=>NaN,haveFunction:!1,fDefinition:{}}}:{setValue:{function:e.functionAttr.stateValues.numericalfs[0],haveFunction:!0,fDefinition:e.functionAttr.stateValues.fDefinition}}}},t}};T($d,"componentType","regionBetweenCurveXAxis");var zp=class extends Ge{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.horizontal={createComponentOfType:"boolean",createStateVariable:"horizontal",defaultValue:!0,public:!0},e.boundaryValue={createComponentOfType:"number",createStateVariable:"boundaryValue",defaultValue:0,public:!0},e.greaterThan={createComponentOfType:"boolean",createStateVariable:"greaterThan",defaultValue:!0,public:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nearestPoint={returnDependencies:()=>({horizontal:{dependencyType:"stateVariable",variableName:"horizontal"},boundaryValue:{dependencyType:"stateVariable",variableName:"boundaryValue"},greaterThan:{dependencyType:"stateVariable",variableName:"greaterThan"}}),definition({dependencyValues:e}){let r=e.boundaryValue;return{setValue:{nearestPoint:function({variables:n,scales:i}){if(!Number.isFinite(r))return{};if(e.horizontal)if(e.greaterThan)if(n.x1<r){let s=Object.assign({},n);return s.x1=r,s}else return{};else if(n.x1>r){let s=Object.assign({},n);return s.x1=r,s}else return{};else if(e.greaterThan)if(n.x2<r){let s=Object.assign({},n);return s.x2=r,s}else return{};else if(n.x2>r){let s=Object.assign({},n);return s.x2=r,s}else return{}}}}}},t}};T(zp,"componentType","regionHalfPlane"),T(zp,"rendererType");var Ll=class extends ce{static get stateVariablesShadowedForReference(){return["value"]}static createAttributesObject(t){let e=super.createAttributesObject(t);return e.prefill={createComponentOfType:"text",createStateVariable:"prefill",defaultValue:"",public:!0},e.bindValueTo={createComponentOfType:"text"},e.width={createComponentOfType:"_componentSize",createStateVariable:"width",defaultValue:{size:600,isAbsolute:!0},forRenderer:!0,public:!0},e.height={createComponentOfType:"_componentSize",createStateVariable:"height",defaultValue:{size:400,isAbsolute:!0},forRenderer:!0,public:!0},e.viewerRatio={createComponentOfType:"number",createStateVariable:"viewerRatio",defaultValue:.5,forRenderer:!0,public:!0},e.showResults={createComponentOfType:"boolean",createStateVariable:"showResults",defaultValue:!1,forRenderer:!0,public:!0},e.renderedName={createPrimitiveOfType:"string"},e.staticName={createPrimitiveOfType:"string"},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r,componentAttributes:n}){if(r.length>0)return{success:!1};let i={componentType:"codeViewer",children:[{componentType:"renderDoenetML"}]},s=[i];if(n.renderedName&&(i.attributes={renderedName:{primitive:n.renderedName}},i.children[0].props={name:n.renderedName}),n.staticName){let o={componentType:"codeViewer",attributes:{hide:{component:{componentType:"boolean",state:{value:!0}}}},children:[{componentType:"renderDoenetML",props:{name:n.staticName}}]};s.push(o)}return{success:!0,newChildren:s}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"codeViewers",componentTypes:["codeViewer"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.viewerHeight={returnDependencies:()=>({height:{dependencyType:"stateVariable",variableName:"height"},viewerRatio:{dependencyType:"stateVariable",variableName:"viewerRatio"}}),definition:function({dependencyValues:e}){if(!e.height.isAbsolute)throw Error("Codeeditor relative height not implemented");return{setValue:{viewerHeight:{size:e.height.size*e.viewerRatio,isAbsolute:!0}}}}},t.value={public:!0,componentType:"text",hasEssential:!0,forRenderer:!0,returnDependencies:()=>({bindValueTo:{dependencyType:"attributeComponent",attributeName:"bindValueTo",variableNames:["value"]},prefill:{dependencyType:"stateVariable",variableName:"prefill"}}),definition:function({dependencyValues:e}){return e.bindValueTo?{setValue:{value:e.bindValueTo.stateValues.value}}:{useEssentialOrDefaultValue:{value:{variablesToCheck:"value",defaultValue:e.prefill}}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:r}){return r.bindValueTo?{success:!0,instructions:[{setDependency:"bindValueTo",desiredValue:e.value,variableIndex:0}]}:{success:!0,instructions:[{setEssentialValue:"value",value:e.value}]}}},t.immediateValue={public:!0,componentType:"text",hasEssential:!0,forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e,changes:r,justUpdatedForNewComponent:n}){return r.value&&!n?{setValue:{immediateValue:e.value},makeEssential:{immediateValue:!0}}:{useEssentialOrDefaultValue:{immediateValue:{variablesToCheck:"immediateValue",defaultValue:e.value}}}},inverseDefinition:function({desiredStateVariableValues:e,initialChange:r,shadowedVariable:n}){let i=[{setEssentialValue:"immediateValue",value:e.immediateValue}];return r||n||i.push({setDependency:"value",desiredValue:e.immediateValue}),{success:!0,instructions:i}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{setValue:{text:e.value}}}},t.componentType={returnDependencies:()=>({}),definition:()=>({setValue:{componentType:"text"}})},t}updateImmediateValue({text:t,actionId:e}){if(this.stateValues.disabled)this.coreFunctions.resolveAction({actionId:e});else return this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",value:t}],actionId:e})}updateValue({actionId:t}){if(!this.stateValues.disabled&&this.stateValues.immediateValue!==this.stateValues.value){let e=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:this.stateValues.immediateValue},{updateType:"executeUpdate"},{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",valueOfStateVariable:"value"}],r={verb:"answered",object:{componentName:this.componentName,componentType:this.componentType},result:{response:this.stateValues.immediateValue,responseText:this.stateValues.immediateValue}};return this.stateValues.answerAncestor&&(r.context={answerAncestor:this.stateValues.answerAncestor.componentName}),this.coreFunctions.performUpdate({updateInstructions:e,actionId:t,event:r}).then(()=>{this.coreFunctions.triggerChainedActions({componentName:this.componentName}),this.attributes.staticName&&this.definingChildren.length===2&&this.definingChildren[1].componentType==="codeViewer"&&this.coreFunctions.performAction({componentName:this.definingChildren[1].componentName,actionName:"updateComponents"})})}else this.coreFunctions.resolveAction({actionId:t})}async updateComponents(){this.definingChildren.length===1&&this.definingChildren[0].componentType==="codeViewer"&&await this.coreFunctions.performAction({componentName:this.definingChildren[0].componentName,actionName:"updateComponents"})}actions={updateImmediateValue:this.updateImmediateValue.bind(this),updateValue:this.updateValue.bind(this),updateComponents:this.updateComponents.bind(this)}};T(Ll,"componentType","codeEditor"),T(Ll,"variableForPlainMacro","value"),T(Ll,"renderChildren",!0);var Gp=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.codeSource={createPrimitiveOfType:"string",createStateVariable:"rawCodeSource",defaultValue:null},e.width={createComponentOfType:"_componentSize"},e.height={createComponentOfType:"_componentSize"},e.hasCodeEditorParent={createComponentOfType:"boolean"},e.renderedName={createPrimitiveOfType:"string"},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r,componentAttributes:n}){if(r.length>0)return{success:!1};let i={componentType:"renderDoenetML"};return n.codeSource&&(i.attributes={codeSource:{primitive:n.codeSource}}),n.renderedName&&(i.props={name:n.renderedName}),{success:!0,newChildren:[i]}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"children",componentTypes:["_base"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.hasCodeEditorParent={public:!0,componentType:"boolean",forRenderer:!0,returnDependencies:()=>({codeEditorParent:{dependencyType:"parentIdentity",parentComponentType:"codeEditor"}}),definition:function({dependencyValues:e}){return e.codeEditorParent?{setValue:{hasCodeEditorParent:!0}}:{setValue:{hasCodeEditorParent:!1}}}},t.width={public:!0,componentType:"_componentSize",hasEssential:!0,forRenderer:!0,defaultValue:{size:600,isAbsolute:!0},returnDependencies:()=>({widthAttr:{dependencyType:"attributeComponent",attributeName:"width",variableNames:["componentSize"]},parentWidth:{dependencyType:"parentStateVariable",variableName:"width",parentComponentType:"codeEditor"}}),definition:function({dependencyValues:e}){return e.widthAttr?{setValue:{width:e.widthAttr.stateValues.componentSize}}:e.parentWidth?{setValue:{width:e.parentWidth}}:{useEssentialOrDefaultValue:{width:!0}}}},t.height={public:!0,componentType:"_componentSize",hasEssential:!0,forRenderer:!0,defaultValue:{size:400,isAbsolute:!0},returnDependencies:()=>({heightAttr:{dependencyType:"attributeComponent",attributeName:"height",variableNames:["componentSize"]},parentViewerHeight:{dependencyType:"parentStateVariable",variableName:"viewerHeight",parentComponentType:"codeEditor"}}),definition:function({dependencyValues:e}){return e.heightAttr?{setValue:{height:e.heightAttr.stateValues.componentSize}}:e.parentViewerHeight?{setValue:{height:e.parentViewerHeight}}:{useEssentialOrDefaultValue:{height:!0}}}},t.codeSourceComponentName={stateVariablesDeterminingDependencies:["rawCodeSource"],returnDependencies({stateValues:e}){return e.rawCodeSource?{codeSourceComponentName:{dependencyType:"expandTargetName",target:e.rawCodeSource}}:{}},definition({dependencyValues:e}){return{setValue:{codeSourceComponentName:e.codeSourceComponentName}}}},t.codeSource={returnDependencies:()=>({codeSourceComponentName:{dependencyType:"stateVariable",variableName:"codeSourceComponentName"},codeEditorParent:{dependencyType:"parentIdentity",parentComponentType:"codeEditor"}}),definition:function({dependencyValues:e}){return e.codeSourceComponentName?{setValue:{codeSource:e.codeSourceComponentName}}:e.codeEditorParent?{setValue:{codeSource:e.codeEditorParent.componentName}}:{setValue:{codeSource:null}}}},t}async updateComponents(){this.definingChildren.length===1&&this.definingChildren[0].componentType==="renderDoenetML"&&await this.coreFunctions.performAction({componentName:this.definingChildren[0].componentName,actionName:"updateComponents"})}actions={updateComponents:this.updateComponents.bind(this)}};T(Gp,"componentType","codeViewer"),T(Gp,"renderChildren",!0);var po=class extends Ae{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.assignNamesSkip={createPrimitiveOfType:"number"},e.codeSource={createPrimitiveOfType:"string",createStateVariable:"rawCodeSource",defaultValue:null},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.codeSourceComponentName={stateVariablesDeterminingDependencies:["rawCodeSource"],returnDependencies({stateValues:e}){return e.rawCodeSource?{codeSourceComponentName:{dependencyType:"expandTargetName",target:e.rawCodeSource}}:{}},definition({dependencyValues:e}){return{setValue:{codeSourceComponentName:e.codeSourceComponentName}}}},t.codeSource={returnDependencies:()=>({codeSourceComponentName:{dependencyType:"stateVariable",variableName:"codeSourceComponentName"},parentCodeSource:{dependencyType:"parentStateVariable",parentComponentType:"codeViewer",variableName:"codeSource"}}),definition:function({dependencyValues:e}){return e.codeSourceComponentName?{setValue:{codeSource:e.codeSourceComponentName}}:e.parentCodeSource?{setValue:{codeSource:e.parentCodeSource}}:{setValue:{codeSource:null}}}},t.doenetML={stateVariablesDeterminingDependencies:["codeSource"],returnDependencies:({stateValues:e})=>({doenetML:{dependencyType:"stateVariable",componentName:e.codeSource,variableName:"text",variablesOptional:!0}}),definition({dependencyValues:e}){let r="";return e.doenetML&&(r=e.doenetML,typeof r!="string"&&(r="")),{setValue:{doenetML:r}}}},t.readyToExpandWhenResolved={returnDependencies:()=>({doenetML:{dependencyType:"stateVariable",variableName:"doenetML"}}),definition(){return{setValue:{readyToExpandWhenResolved:!0}}}},t.triggerUpdates={defaultValue:!0,hasEssential:!0,returnDependencies:()=>({}),markStale(){return{updateReplacements:!0}},definition(){return{useEssentialOrDefaultValue:{triggerUpdates:{}}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"triggerUpdates",value:e.triggerUpdates}]}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({setValue:{isVariantComponent:!0}})},t.generatedVariantInfo={returnDependencies:({sharedParameters:e,componentInfoObjects:r})=>({variantSeed:{dependencyType:"value",value:e.variantSeed},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(r.componentTypesCreatingVariants),variableNames:["isVariantComponent","generatedVariantInfo"],useReplacementsForComposites:!0,recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfEncounteredComposites:!0}}),definition({dependencyValues:e,componentName:r}){let n={seed:e.variantSeed,meta:{createdBy:r}},i=n.subvariants=[];for(let s of e.variantDescendants)s.stateValues.isVariantComponent?i.push(s.stateValues.generatedVariantInfo):s.stateValues.generatedVariantInfo&&i.push(...s.stateValues.generatedVariantInfo.subvariants);return{setValue:{generatedVariantInfo:n}}}},t}static async createSerializedReplacements({component:t,componentInfoObjects:e,flags:r,workspace:n}){let i=[],s=(await t.stateValues.doenetML).trim();n.previousDoenetML=s;try{i=(await Zp({cids:[],doenetMLs:[s],componentInfoObjects:e,flags:r})).fullSerializedComponents[0]}catch(u){return console.warn("error in user entered doenetML"),console.warn(u.message),{replacements:[]}}let o=t.componentName.split("/").map(u=>({namespace:u,componentCounts:{},namesUsed:{}}));return mi({serializedComponents:i,componentInfoObjects:e,namespaceStack:o}),vo({components:i,namespace:`${t.componentName}/`}),{replacements:de({assignNames:t.doenetAttributes.assignNames,serializedComponents:i,parentName:t.componentName,parentCreatesNewNamespace:!0,componentInfoObjects:e,originalNamesAreConsistent:!0}).serializedComponents}}static async calculateReplacementChanges({component:t,componentChanges:e,componentInfoObjects:r,flags:n,workspace:i}){let s=(await t.stateValues.doenetML).trim();if(i.previousDoenetML===s)return[];i.previousDoenetML=s;let o=(await this.createSerializedReplacements({component:t,componentInfoObjects:r,flags:n,workspace:i})).replacements;return[{changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:o}]}static async setUpVariant({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r}){kr({serializedComponent:t,sharedParameters:e,descendantVariantComponents:r})}async updateComponents({actionId:t}){let e=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"triggerUpdates",value:!0}];await this.coreFunctions.performUpdate({updateInstructions:e,actionId:t})}actions={updateComponents:this.updateComponents.bind(this)}};T(po,"componentType","renderDoenetML"),T(po,"assignNamesToReplacements",!0),T(po,"createsVariants",!0),T(po,"stateVariableToEvaluateAfterReplacements","triggerUpdates");var Kd=class extends ce{static createAttributesObject(t){let e=super.createAttributesObject(t);return e.prefill={createComponentOfType:"mathList",createStateVariable:"prefill",defaultValue:[]},e.prefillLabel={createComponentOfType:"textList",createStateVariable:"prefillLabel",defaultValue:[]},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.rows={defaultValue:[{orbitalText:"",boxes:[]}],hasEssential:!0,forRenderer:!0,returnDependencies:()=>({prefill:{dependencyType:"stateVariable",variableName:"prefill"},prefillLabel:{dependencyType:"stateVariable",variableName:"prefillLabel"}}),definition:function({dependencyValues:e}){function r(){function n(s){if(s==="u"||s==="U")return"U";if(s==="d"||s==="D")return"D";if(s==="e"||s==="E")return"";if(Array.isArray(s)&&s[0]==="*"){let o="";for(let l of s.slice(1))if(l==="u"||l==="U")o+="U";else if(l==="d"||l==="D")o+="D";else return"";return o}else return""}let i=[];if(e.prefill.length>0){for(let s=e.prefill.length-1;s>=0;s--){let o=e.prefill[s],l="";e.prefillLabel[s]&&(l=e.prefillLabel[s]);let u=[];if(Array.isArray(o.tree)&&o.tree[0]==="tuple")for(let c of o.tree.slice(1))u.push(n(c));else u.push(n(o.tree));i.push({orbitalText:l,boxes:u})}return i}else return[{orbitalText:"",boxes:[]}]}return{useEssentialOrDefaultValue:{rows:{get defaultValue(){return r()}}}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setEssentialValue:"rows",value:e.rows}]}}},t.numRows={public:!0,componentType:"integer",returnDependencies:()=>({rows:{dependencyType:"stateVariable",variableName:"rows"}}),definition:function({dependencyValues:e}){return{setValue:{numRows:e.rows.length}}}},t.selectedRowIndex={defaultValue:0,hasEssential:!0,forRenderer:!0,public:!0,componentType:"integer",returnDependencies:()=>({}),definition:function(){return{useEssentialOrDefaultValue:{selectedRowIndex:!0}}},async inverseDefinition({desiredStateVariableValues:e,stateValues:r}){let n=await r.numRows,i=e.selectedRowIndex;return Number.isFinite(i)?i=Math.min(n,Math.max(0,Math.round(i))):i=0,{success:!0,instructions:[{setEssentialValue:"selectedRowIndex",value:i}]}}},t.selectedBoxIndex={defaultValue:0,hasEssential:!0,forRenderer:!0,public:!0,componentType:"integer",returnDependencies:()=>({}),definition:function(){return{useEssentialOrDefaultValue:{selectedBoxIndex:!0}}},async inverseDefinition({desiredStateVariableValues:e}){let r=e.selectedBoxIndex;return Number.isFinite(r)?r=Math.max(0,Math.round(r)):r=0,{success:!0,instructions:[{setEssentialValue:"selectedBoxIndex",value:r}]}}},t}async addRow({actionId:t}){let e=await this.stateValues.rows,r=e;e.length<20&&(r=[{orbitalText:"",boxes:[]},...e]);let n=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rows",value:r}];return await this.stateValues.selectedRowIndex-1!==-1&&n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedRowIndex",value:0}),await this.stateValues.selectedBoxIndex-1!==-1&&n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedBoxIndex",value:0}),await this.coreFunctions.performUpdate({updateInstructions:n,actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{rows:r}}})}async removeRow({actionId:t}){let e=await this.stateValues.rows,r=await this.stateValues.selectedRowIndex-1,n=e;if(e.length>1){let i=e.length-1-r;r===-1&&(i=0),n.splice(i,1)}return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rows",value:n},{updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedRowIndex",value:0},{updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedBoxIndex",value:0}],actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{rows:n}}})}async addBox({actionId:t}){let e=await this.stateValues.rows,r=e,n=await this.stateValues.selectedRowIndex-1,i=e.length-n-1;n===-1&&(i=0),r[i].boxes.length<17&&r[i].boxes.push("");let s=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rows",value:r}];if(n!==-1){let o=0;s.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedBoxIndex",value:o})}return await this.coreFunctions.performUpdate({updateInstructions:s,actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{rows:r}}})}async removeBox({actionId:t}){let e=await this.stateValues.rows,r=e,n=await this.stateValues.selectedRowIndex-1,i=e.length-n-1;n===-1&&(i=0);let s=await this.stateValues.selectedBoxIndex-1,o=s;s===-1&&(o=r[i].boxes.length-1),r[i].boxes.splice(o,1);let l=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rows",value:r}];return s!==-1&&l.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedBoxIndex",value:0}),await this.coreFunctions.performUpdate({updateInstructions:l,actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{rows:r}}})}async addUpArrow({actionId:t}){let e=await this.stateValues.rows,r=e,n=await this.stateValues.selectedRowIndex-1,i=e.length-n-1;n===-1&&(i=0);let s=await this.stateValues.selectedBoxIndex-1,o=s;s===-1&&(o=r[i].boxes.length-1),r[i].boxes.length>0&&r[i].boxes[o].length<3&&(r[i].boxes[o]=r[i].boxes[o]+"U");let l=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rows",value:r}];return await this.coreFunctions.performUpdate({updateInstructions:l,actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{rows:r}}})}async addDownArrow({actionId:t}){let e=await this.stateValues.rows,r=e,n=await this.stateValues.selectedRowIndex-1,i=e.length-n-1;n===-1&&(i=0);let s=await this.stateValues.selectedBoxIndex-1,o=s;s===-1&&(o=r[i].boxes.length-1),r[i].boxes.length>0&&r[i].boxes[o].length<3&&(r[i].boxes[o]=r[i].boxes[o]+"D");let l=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rows",value:r}];return await this.coreFunctions.performUpdate({updateInstructions:l,actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{rows:r}}})}async removeArrow({actionId:t}){let e=await this.stateValues.rows,r=e,n=await this.stateValues.selectedRowIndex-1,i=e.length-n-1;n===-1&&(i=0);let s=await this.stateValues.selectedBoxIndex-1,o=s;s===-1&&(o=r[i].boxes.length-1),r[i].boxes.length>0&&r[i].boxes[o].length>0&&(r[i].boxes[o]=r[i].boxes[o].slice(0,-1));let l=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rows",value:r}];return await this.coreFunctions.performUpdate({updateInstructions:l,actionId:t,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{rows:r}}})}async updateRowText({newValue:t,actionId:e}){let r=await this.stateValues.rows,n=r,i=await this.stateValues.selectedRowIndex-1,s=r.length-i-1;i===-1&&(s=0),n[s].orbitalText=t;let o=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"rows",value:n}];return await this.coreFunctions.performUpdate({updateInstructions:o,actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{rows:n}}})}async selectRow({index:t,actionId:e}){return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedRowIndex",value:t}],actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{selectedRowIndex:t}}})}async selectBox({index:t,actionId:e}){return await this.coreFunctions.performUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"selectedBoxIndex",value:t}],actionId:e,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{selectedBoxIndex:t}}})}actions={addRow:this.addRow.bind(this),removeRow:this.removeRow.bind(this),addBox:this.addBox.bind(this),removeBox:this.removeBox.bind(this),addUpArrow:this.addUpArrow.bind(this),addDownArrow:this.addDownArrow.bind(this),removeArrow:this.removeArrow.bind(this),updateRowText:this.updateRowText.bind(this),selectRow:this.selectRow.bind(this),selectBox:this.selectBox.bind(this)}};T(Kd,"componentType","orbitalDiagramInput");var BR={};st(BR,{ComponentSize:()=>Ul,ComponentSizeList:()=>Hp});var MR={"":1,px:1,pixel:1,pixels:1,"%":1,em:100,in:96,inch:96,inches:96,pt:1.333333333333,mm:3.7795296,millimeter:3.7795296,millimeters:3.7795296,cm:37.795296,centimeter:37.795296,centimeters:37.795296},Ul=class extends re{static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=r[r.length-1];if(typeof n=="string"){let i=/([a-zA-z]+|%)$/,s=n.trim(),o=s.match(i);if(o){let l=o[1];if(l in MR){let u=s.slice(0,o.index),c=r.slice(0,r.length-1);return u.length>0&&c.push(u),{success:!0,newChildren:[{componentType:"number",children:c},l]}}}}return{success:!0,newChildren:[{componentType:"number",children:r}]}};return t.push({childrenRegex:/..+/,replacementFunction:e}),t}static returnChildGroups(){return[{group:"strings",componentTypes:["string"]},{group:"numbers",componentTypes:["number"]},{group:"componentSizes",componentTypes:["_componentSize"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.componentSize={public:!0,componentType:"_componentSize",hasEssential:!0,returnDependencies:()=>({componentSizeChild:{dependencyType:"child",childGroups:["componentSizes"],variableNames:["componentSize"]},numberChild:{dependencyType:"child",childGroups:["numbers"],variableNames:["value"]},stringChild:{dependencyType:"child",childGroups:["strings"],variableNames:["value"]},parentDefaultAbsoluteSize:{dependencyType:"parentStateVariable",variableName:"defaultAbsoluteSize"}}),definition({dependencyValues:e}){let r=e.parentDefaultAbsoluteSize===void 0?!1:e.parentDefaultAbsoluteSize;if(e.stringChild.length===0)return e.numberChild.length===0?e.componentSizeChild.length===0?{useEssentialOrDefaultValue:{componentSize:{defaultValue:{size:100,isAbsolute:r}}}}:{setValue:{componentSize:e.componentSizeChild[0].stateValues.componentSize}}:{setValue:{componentSize:{size:e.numberChild[0].stateValues.value,isAbsolute:!0}}};{let n,i;if(e.numberChild.length>0)n=e.numberChild[0].stateValues.value,i=e.stringChild[0].trim();else{let u=e.stringChild[0].trim().match(/^(-?[\d.]+)\s*(.*)$/);if(u===null)return{setValue:{componentSize:null}};n=u[1],i=u[2].trim()}if(n=Number(n),!Number.isFinite(n))return{setValue:{componentSize:null}};let s=!(i==="%"||i==="em"),o=MR[i];return o===void 0&&(o=1),{setValue:{componentSize:{size:o*n,isAbsolute:s}}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){if(r.stringChild.length===0)return r.numberChild.length===0?r.componentSizeChild.length===0?{success:!0,instructions:[{setEssentialValue:"componentSize",value:e.componentSize}]}:{success:!0,instructions:[{setDependency:"componentSizeChild",desiredValue:e.componentSize,childIndex:0,variableIndex:0}]}:e.componentSize.isAbsolute?{success:!0,instructions:[{setDependency:"numberChild",desiredValue:e.componentSize.size,childIndex:0,variableIndex:0}]}:{success:!1};if(r.numberChild.length>0){let n=r.stringChild[0].trim(),i=!(n==="%"||n==="em");if(e.componentSize.isAbsolute!==i)return{success:!1};let s=MR[n];s===void 0&&(s=1);let o=e.componentSize.size/s;return{success:!0,instructions:[{setDependency:"numberChild",desiredValue:o,childIndex:0,variableIndex:0}]}}else{let n=e.componentSize.size;return e.componentSize.isAbsolute?n+="px":n+="%",{success:!0,instructions:[{setDependency:"stringChild",desiredValue:n,childIndex:0,variableIndex:0}]}}}},t.number={public:!0,componentType:"number",returnDependencies:()=>({componentSize:{dependencyType:"stateVariable",variableName:"componentSize"}}),definition({dependencyValues:e}){let r=null;return e.componentSize&&(r=e.componentSize.size),{setValue:{number:r}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:r}){if(!r.componentSize)return{success:!1};let n={size:e.number,isAbsolute:r.componentSize.isAbsolute};return{success:!0,instructions:[{setDependency:"componentSize",desiredValue:n}]}}},t.math=fh({numberVariableName:"number",mathVariableName:"math",isPublic:!0}),t.isAbsolute={public:!0,componentType:"boolean",returnDependencies:()=>({componentSize:{dependencyType:"stateVariable",variableName:"componentSize"}}),definition({dependencyValues:e}){let r=null;return e.componentSize&&(r=e.componentSize.isAbsolute),{setValue:{isAbsolute:r}}}},t.text={forRenderer:!0,returnDependencies:()=>({componentSize:{dependencyType:"stateVariable",variableName:"componentSize"}}),definition({dependencyValues:e}){let r="";return e.componentSize&&(r=e.componentSize.size,e.componentSize.isAbsolute?r+="px":r+="%"),{setValue:{text:r}}}},t}};T(Ul,"componentType","_componentSize"),T(Ul,"rendererType","text"),T(Ul,"primaryStateVariableForDefinition","componentSize"),T(Ul,"stateVariableForAttributeValue","componentSize"),T(Ul,"adapters",["number","math"]);var Hp=class extends J{static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r}){let n=[],i=[],s=function(){i.length>0&&(n.push({componentType:"_componentSize",children:i}),i=[])};for(let o of r)if(typeof o=="string"){let l=o.split(/\s+/);l[0].length===0&&(s(),l=l.slice(1));for(let[u,c]of l.entries())c.length>0?(i.push(c),u<l.length-1&&s()):s()}else i.push(o);return s(),{success:!0,newChildren:n}};return t.push({replacementFunction:e}),t}static returnChildGroups(){return[{group:"componentSizes",componentTypes:["_componentSize"]},{group:"componentSizeLists",componentTypes:["_componentSizeList"]}]}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({setValue:{overrideChildHide:!0}})},t.nComponents={public:!0,componentType:"number",additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies(){return{componentSizeListChildren:{dependencyType:"child",childGroups:["componentSizeLists"],variableNames:["nComponents"]},componentSizeAndComponentSizeListChildren:{dependencyType:"child",childGroups:["componentSizes","componentSizeLists"],skipComponentNames:!0}}},definition:function({dependencyValues:e,componentInfoObjects:r}){let n=0,i=[],s=0;for(let[o,l]of e.componentSizeAndComponentSizeListChildren.entries())if(r.isInheritedComponentType({inheritedComponentType:l.componentType,baseComponentType:"_componentSizeList"})){let u=e.componentSizeListChildren[s];s++;for(let c=0;c<u.stateValues.nComponents;c++)i[n+c]=[o,c];n+=u.stateValues.nComponents}else i[n]=[o,0],n+=1;return{setValue:{nComponents:n,childIndexByArrayKey:i},checkForActualChange:{nComponents:!0}}}},t.componentSizes={public:!0,componentType:"_componentSize",isArray:!0,entryPrefixes:["componentSize"],stateVariablesDeterminingDependencies:["childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:r}){let n={},i={childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"}};for(let s of e){let o=[],l="1";r.childIndexByArrayKey[s]&&(o=[r.childIndexByArrayKey[s][0]],l=r.childIndexByArrayKey[s][1]+1),n[s]={componentSizeAndComponentSizeListChildren:{dependencyType:"child",childGroups:["componentSizes","componentSizeLists"],variableNames:["componentSize","componentSize"+l],variablesOptional:!0,childIndices:o}}}return{globalDependencies:i,dependenciesByKey:n}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:r,arrayKeys:n,componentInfoObjects:i}){let s={};for(let o of n){let l=r[o].componentSizeAndComponentSizeListChildren[0];if(l)if(i.isInheritedComponentType({inheritedComponentType:l.componentType,baseComponentType:"_componentSizeList"})){let u=e.childIndexByArrayKey[o][1]+1;s[o]=l.stateValues["componentSize"+u]}else s[o]=l.stateValues.componentSize}return{setValue:{componentSizes:s}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:r,dependencyValuesByKey:n,dependencyNamesByKey:i,arraySize:s,componentInfoObjects:o}){let l=[];for(let u in e.componentSizes){if(!n[u])continue;let c=n[u].componentSizeAndComponentSizeListChildren[0];c&&(o.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"_componentSizeList"})?l.push({setDependency:i[u].componentSizeAndComponentSizeListChildren,desiredValue:e.componentSizes[u],childIndex:0,variableIndex:1}):l.push({setDependency:i[u].componentSizeAndComponentSizeListChildren,desiredValue:e.componentSizes[u],childIndex:0,variableIndex:0}))}return{success:!0,instructions:l}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"componentSizes"},t}};T(Hp,"componentType","_componentSizeList"),T(Hp,"rendererType","asList"),T(Hp,"renderChildren",!0),T(Hp,"stateVariableForAttributeValue","componentSizes");var NH=[...Object.values(f2),...Object.values(y2),...Object.values(v2),...Object.values(w2),...Object.values(V2),...Object.values(X2),...Object.values(nT),...Object.values(iT),...Object.values(sT),...Object.values(cT),...Object.values(pT),...Object.values(dT),...Object.values(hT),...Object.values(bT),...Object.values(gT),...Object.values(TT),...Object.values(NT),...Object.values(wT),...Object.values(ST),...Object.values(ET),...Object.values(RT),...Object.values(xT),...Object.values(VT),...Object.values(OT),gi,Tr,pa,Nu,So,Nr,ma,ot,xn,qa,vi,vs,Ti,wo,Ln,Cu,za,vm,Tm,hi,Ni,Au,Su,wu,Eu,Rn,Ru,Nm,xo,xu,Vo,Ns,Oo,Vu,Ou,Du,Cs,Ai,Si,Pu,_u,ku,Fu,Ua,Dt,ju,wi,Mu,Td,op,lp,si,bl,gl,up,vl,cp,pp,Sm,Po,Ss,Do,Bu,wm,Em,Rm,xm,Vm,Om,Dm,Io,Im,Pm,Ka,Lu,mp,Tl,fp,Nl,ss,As,Cl,dp,to,oi,Al,hp,Sd,wd,Ed,Sl,wl,yp,Op,Dl,Il,Ud,Dp,zd,uo,Pp,_p,Hd,kp,kl,Fp,qd,Fl,co,jp,jl,Mp,Bp,Lp,Ml,Bl,Up,$d,zp,Ll,Gp,po,Kd,J,re,ce,Ge,dt,Xr,Ae,Eo,Ro,Ci,Cm,ua,Ba,jr,Mr,fi,...Object.values(BR),Ar,ir,Fa,ca];function CH(){let a={},t=new Set;for(let e of NH){let r=e.componentType;if(r===void 0)throw Error("Cannot create component as componentType is undefined for class "+e);let n=r.toLowerCase();if(t.has(n))throw Error("component type "+r+" defined in two classes");a[r]=e,t.add(n)}return a}function AH(){let a={},t=new Set;for(let e of NH)if(e.createsVariants){let r=e.componentType;if(r===void 0)throw Error("Cannot create component as componentType is undefined for class "+e);let n=r.toLowerCase();if(t.has(n))throw Error("component type "+r+" defined in two classes");a[r]=e,t.add(n)}return a}function LR(a){let t=CH(),e=AH(),r={};for(let l in t)r[l.toLowerCase()]=l;let n={};for(let l in t)Object.defineProperty(n,l,{get:function(){let u=t[l].returnStateVariableInfo({flags:a});return delete n[l],n[l]=u}.bind(this),configurable:!0});let i={};for(let l in t)Object.defineProperty(i,l,{get:function(){let u=t[l].returnStateVariableInfo({onlyPublic:!0,flags:a});return delete i[l],i[l]=u}.bind(this),configurable:!0});function s({inheritedComponentType:l,baseComponentType:u}){if(l===u)return!0;if(l==="string")return u==="_base"||u==="_inline";if(u==="string")return!1;let c=t[u];return c?c.isPrototypeOf(t[l]):!1}function o({componentType:l,includeNonStandard:u=!0}){let c=t[l];return c?s({inheritedComponentType:l,baseComponentType:"_composite"})&&(u||!c.treatAsComponentForRecursiveReplacements):!1}return{allComponentClasses:t,componentTypesCreatingVariants:e,componentTypeLowerCaseMapping:r,isInheritedComponentType:s,isCompositeComponent:o,stateVariableInfo:n,publicStateVariableInfo:i}}import{set as UR}from"idb-keyval";import{toastType as Fn}from"@Toast";import g0 from"axios";var v0=class{constructor({doenetML:t,doenetId:e,pageId:r,attemptNumber:n,itemNumber:i,serverSaveId:s,requestedVariant:o,requestedVariantIndex:l,flags:u={},stateVariableChanges:c={},coreId:p,updateDataOnContentChange:m}){this.coreId=p,this.doenetId=e,this.pageId=r,this.attemptNumber=n,this.itemNumber=i,this.serverSaveId=s,this.updateDataOnContentChange=m,this.numerics=new Zd,this.flags=u,this.finishCoreConstruction=this.finishCoreConstruction.bind(this),this.getStateVariableValue=this.getStateVariableValue.bind(this),this.componentInfoObjects=LR(u),this.coreFunctions={requestUpdate:this.requestUpdate.bind(this),performUpdate:this.performUpdate.bind(this),requestAction:this.requestAction.bind(this),performAction:this.performAction.bind(this),resolveAction:this.resolveAction.bind(this),triggerChainedActions:this.triggerChainedActions.bind(this),requestRecordEvent:this.requestRecordEvent.bind(this),requestAnimationFrame:this.requestAnimationFrame.bind(this),cancelAnimationFrame:this.cancelAnimationFrame.bind(this),calculateScoredItemNumberOfContainer:this.calculateScoredItemNumberOfContainer.bind(this),recordSolutionView:this.recordSolutionView.bind(this)},this.updateInfo={componentsToUpdateRenderers:[],compositesToExpand:new Set([]),compositesToUpdateReplacements:[],inactiveCompositesToUpdateReplacements:[],componentsToUpdateActionChaining:{},unresolvedDependencies:{},unresolvedByDependent:{},deletedStateVariables:{},deletedComponents:{},compositesBeingExpanded:[],stateVariableUpdatesForMissingComponents:JSON.parse(JSON.stringify(c,cn),Kl)},this.cumulativeStateVariableChanges=JSON.parse(JSON.stringify(c,cn),Kl),this.requestedVariantIndex=l,this.requestedVariant=o,this.parameterStack=new Yd,this.parameterStack.parameters.rngClass=HR,this.initialized=!1,this.initializedPromiseResolves=[],this.resolveInitialized=()=>{this.initializedPromiseResolves.forEach(f=>f(!0)),this.initialized=!0},this.getInitializedPromise=()=>this.initialized?Promise.resolve(!0):new Promise((f,d)=>{this.initializedPromiseResolves.push(f)}),Yp(t).then(f=>Zp({cids:[f],doenetMLs:[t],componentInfoObjects:this.componentInfoObjects,flags:this.flags})).then(this.finishCoreConstruction)}async finishCoreConstruction({cids:t,fullSerializedComponents:e}){this.cid=t[0];let r=e[0];Nx(r),mi({serializedComponents:r,componentInfoObjects:this.componentInfoObjects}),this.documentName=r[0].componentName,r[0].doenetAttributes.cid=this.cid,this._components={},this.componentsToRender={},this.componentsWithChangedChildrenToRender=new Set([]),this.stateVariableChangeTriggers={},this.actionsChangedToActions={},this.originsOfActionsChangedToActions={},this.essentialValuesSavedInDefinition={},this.saveStateToDBTimerId=null,this.rendererState={},this.rendererVariablesByComponentType={};for(let i in this.componentInfoObjects.allComponentClasses)Object.defineProperty(this.rendererVariablesByComponentType,i,{get:function(){let s=this.componentInfoObjects.allComponentClasses[i].returnStateVariableInfo({onlyForRenderer:!0,flags:this.flags}).stateVariableDescriptions;return delete this.rendererVariablesByComponentType[i],this.rendererVariablesByComponentType[i]=s}.bind(this),configurable:!0});this.processQueue=[],this.dependencies=new j0({_components:this._components,componentInfoObjects:this.componentInfoObjects,core:this}),this.unmatchedChildren={};let n=Vx({serializedComponent:r[0],componentInfoObjects:this.componentInfoObjects});if(!this.requestedVariant){if(this.requestedVariantIndex=((this.requestedVariantIndex-1)%n+n)%n+1,r[0].variants.uniqueVariants){let s=this.componentInfoObjects.allComponentClasses[r[0].componentType].getUniqueVariant({serializedComponent:r[0],variantIndex:this.requestedVariantIndex,componentInfoObjects:this.componentInfoObjects});s.success&&(this.requestedVariant=s.desiredVariant)}this.requestedVariant||(this.requestedVariant={index:this.requestedVariantIndex})}this.parameterStack.parameters.variant=this.requestedVariant,r[0].variants.desiredVariant=this.parameterStack.parameters.variant,await this.addComponents({serializedComponents:r,initialAdd:!0}),this.updateInfo.componentsToUpdateRenderers=[],await this.document.stateValues.itemCreditAchieved,this.canonicalGeneratedVariantString=JSON.stringify(await this.document.stateValues.generatedVariantInfo,cn),this.canonicalItemVariantStrings=(await this.document.stateValues.itemVariantInfo).map(i=>JSON.stringify(i,cn)),this.coreInfo={generatedVariantString:this.canonicalGeneratedVariantString,allPossibleVariants:Re(await this.document.sharedParameters.allPossibleVariants),rendererTypesInDocument:Re(this.rendererTypesInDocument),documentToRender:this.documentRendererInstructions},this.coreInfoString=JSON.stringify(this.coreInfo,cn),this.messageViewerReady(),this.requestRecordEvent({verb:"experienced",object:{componentName:this.document.componentName,componentType:"document"}}),this.resolveInitialized()}async messageViewerReady(){postMessage({messageType:"initializeRenderers",args:{coreInfo:this.coreInfo}}),postMessage({messageType:"coreCreated"})}async postUpdateRenderers(t,e=!1){postMessage({messageType:"updateRenderers",args:t,init:e})}async addComponents({serializedComponents:t,parentName:e,indexOfDefiningChildren:r,initialAdd:n=!1,assignNamesOffset:i}){Array.isArray(t)||(t=[t]);let s,o=[],l="";if(!n){if(s=this._components[e],!s)return console.warn(`Cannot add children to parent ${e} as ${e} does not exist`),[];if(s.isShadow)return console.warn(`Cannot add children to parent ${e} as it is a shadow component.`),[];o=[{componentName:e,componentClass:s.constructor},...s.ancestors],this.parameterStack.push(s.sharedParameters,!1),this.nTimesAddedComponents?this.nTimesAddedComponents++:this.nTimesAddedComponents=1,l=`addComponents${this.nTimesAddedComponents}`}let u=await this.createIsolatedComponents({serializedComponents:t,ancestors:o,createNameContext:l});if(n||this.parameterStack.pop(),u.success!==!0)throw Error(u.message);let c=u.components,p={},m={};if(c.forEach(f=>m[f.componentName]=f),n){if(c.length!==1)throw Error("Initial components need to be an array of just one component.");this.document=c[0],await this.expandAllComposites(this.document),await this.expandAllComposites(this.document,!0),await this.replacementChangesFromCompositesToUpdate();let f=await this.initializeRenderedComponentInstruction(this.document);if(this.updateInfo.compositesToUpdateReplacements.length>0){await this.replacementChangesFromCompositesToUpdate();let h=[...new Set(this.updateInfo.componentsToUpdateRenderers)];this.updateInfo.componentsToUpdateRenderers=[],await this.updateRendererInstructions({componentNamesToUpdate:h})}this.documentRendererInstructions=f.componentToRender;let d=[{instructionType:"updateRendererStates",rendererStatesToUpdate:f.rendererStatesToUpdate}];this.postUpdateRenderers({updateInstructions:d},!0),await this.processStateVariableTriggers()}else{if(s===void 0)throw Error("Must specify parent when adding components.");r===void 0&&(r=s.definingChildren.length);let f=await this.addChildrenAndRecurseToShadows({parent:s,indexOfDefiningChildren:r,newChildren:c,assignNamesOffset:i});if(!f.success)throw Error("Couldn't satisfy child logic result.  Need informative error message");if(Object.assign(m,f.addedComponents),Object.assign(p,f.deletedComponents),await this.expandAllComposites(this.document),await this.expandAllComposites(this.document,!0),await this.replacementChangesFromCompositesToUpdate(),await this.updateRendererInstructions({componentNamesToUpdate:await this.componentAndRenderedDescendants(s)}),this.updateInfo.compositesToUpdateReplacements.length>0){await this.replacementChangesFromCompositesToUpdate();let d=[...new Set(this.updateInfo.componentsToUpdateRenderers)];this.updateInfo.componentsToUpdateRenderers=[],await this.updateRendererInstructions({componentNamesToUpdate:d})}await this.processStateVariableTriggers()}return c}async updateRendererInstructions({componentNamesToUpdate:t,sourceOfUpdate:e={},actionId:r}){let n=[],i=[],s=[],o={};for(let l of this.componentsWithChangedChildrenToRender)if(l in this.componentsToRender){let u=[],c=this._components[l],p=[];if(c&&c.constructor.renderChildren){c.childrenMatched||await this.deriveChildResultsFromDefiningChildren({parent:c,expandComposites:!0,forceExpandComposites:!0}),p=await this.returnActiveChildrenIndicesToRender(c);let d=0;for(let[h,y]of c.activeChildren.entries())p.includes(h)&&(y.rendererType?(u.push(`nameType:${y.componentName};${y.componentType}`),d++):typeof y=="string"?(u.push(`string${d}:${y}`),d++):typeof y=="number"&&(u.push(`number${d}:${y.toString()}`),d++))}let m=this.componentsToRender[l].children,f=[];for(let[d,h]of m.entries())h.componentName?f.push(`nameType:${h.componentName};${h.componentType}`):typeof h=="string"?f.push(`string${d}:${h}`):typeof h=="number"&&f.push(`number${d}:${h.toString()}`);if(u.length!==f.length||u.some((d,h)=>d!==f[h])){for(let h of m)if(h.componentName){let y=this.deleteFromComponentsToRender({componentName:h.componentName,recurseToChildren:!0});n.push(...y)}let d=[];if(p.length>0){for(let[h,y]of c.activeChildren.entries())if(p.includes(h))if(y.rendererType){let b=await this.initializeRenderedComponentInstruction(y);d.push(b.componentToRender),s.push(...b.rendererStatesToUpdate)}else typeof y=="string"?d.push(y):typeof y=="number"&&d.push(y.toString())}this.componentsToRender[l].children=d,o[l]=d,this.componentsWithChangedChildrenToRender.delete(l),t.includes(l)||t.push(l)}}this.componentsWithChangedChildrenToRender=new Set([]);for(let l of t)if(l in this.componentsToRender){let u=this._components[l];if(u){let c={};for(let m in u.state)if(u.state[m].forRenderer){let f=sa(await u.state[m].value);c[m]=f}let p={componentName:l,stateValues:c,rendererType:u.rendererType};this.rendererState[l]||(this.rendererState[l]={}),this.rendererState[l].stateValues=c,o[l]&&(p.childrenInstructions=o[l],this.rendererState[l].childrenInstructions=o[l]),s.push(p)}}if(s.length>0){let l={instructionType:"updateRendererStates",rendererStatesToUpdate:s,sourceOfUpdate:e};i.splice(0,0,l)}this.postUpdateRenderers({updateInstructions:i,actionId:r})}async initializeRenderedComponentInstruction(t){if(t.rendererType===void 0)return;t.childrenMatched||await this.deriveChildResultsFromDefiningChildren({parent:t,expandComposites:!0});let e=[],r={};for(let l in t.state)t.state[l].forRenderer&&(r[l]=sa(await t.state[l].value));let n=t.componentName,i=[];if(t.constructor.renderChildren){let l=await this.returnActiveChildrenIndicesToRender(t);for(let[u,c]of t.activeChildren.entries())if(l.includes(u))if(c.rendererType){let p=await this.initializeRenderedComponentInstruction(c);i.push(p.componentToRender),e.push(...p.rendererStatesToUpdate)}else typeof c=="string"?i.push(c):typeof c=="number"&&i.push(c.toString())}e.push({componentName:n,stateValues:r,childrenInstructions:i}),this.rendererState[n]={stateValues:r,childrenInstructions:i},this.componentsWithChangedChildrenToRender.delete(n);let s={};for(let l in t.actions)s[l]={actionName:l,componentName:t.componentName};for(let l in t.externalActions){let u=await t.externalActions[l];u&&(s[l]={actionName:l,componentName:u.componentName})}let o={componentName:n,effectiveName:t.componentOrAdaptedName,componentType:t.componentType,rendererType:t.rendererType,actions:s};return this.componentsToRender[n]={children:i},{componentToRender:o,rendererStatesToUpdate:e}}deleteFromComponentsToRender({componentName:t,recurseToChildren:e=!0}){let r=[t];if(e){let n=this.componentsToRender[t];if(n)for(let i of n.children){let s=this.deleteFromComponentsToRender({componentName:i.componentName,recurseToChildren:e});r.push(...s)}}return delete this.componentsToRender[t],this.componentsWithChangedChildrenToRender.delete(t),r}async processStateVariableTriggers(){for(let t in this.stateVariableChangeTriggers){let e=this._components[t];for(let r in this.stateVariableChangeTriggers[t]){let n=this.stateVariableChangeTriggers[t][r],i=await e.state[r].value;if(i!==n.previousValue){let s=n.previousValue;n.previousValue=i,e.actions[n.action]&&await this.performAction({componentName:t,actionName:n.action,args:{stateValues:{[r]:i},previousValues:{[r]:s}}})}}}}async expandAllComposites(t,e=!1){let r=await this.expandCompositesOfDescendants(t,e),n=!0;for(;n;){n=!1;for(let i of r){let s=this._components[i],o=!1;for(let l of s.unexpandedCompositesNotReady){let u=this._components[l];if(u.state.readyToExpandWhenResolved.isResolved){o=!0;break}else if((await this.dependencies.resolveItem({componentName:u.componentName,type:"stateVariable",stateVariable:"readyToExpandWhenResolved",force:e,recurseUpstream:!0})).success){o=!0;break}}if(o){let l=this._components[i];await this.deriveChildResultsFromDefiningChildren({parent:l,expandComposites:!0,forceExpandComposites:e}),n=!0}}}}async expandCompositesOfDescendants(t,e=!1){let r=[];t.childrenMatched||(await this.deriveChildResultsFromDefiningChildren({parent:t,expandComposites:!0,forceExpandComposites:e}),t.unexpandedCompositesNotReady.length>0?r.push(t.componentName):await this.dependencies.resolveBlockersFromChangedActiveChildren(t,e));for(let n in t.attributes){let i=t.attributes[n].component;if(i){let s=await this.expandCompositesOfDescendants(i,e);r.push(...s)}}for(let n in t.allChildren){let i=t.allChildren[n].component;if(typeof i!="object")continue;let s=await this.expandCompositesOfDescendants(i,e);r.push(...s)}return r}async componentAndRenderedDescendants(t){if(!t?.componentName)return[];let e=[t.componentName];if(t.constructor.renderChildren){t.childrenMatched||await this.deriveChildResultsFromDefiningChildren({parent:t,expandComposites:!0});for(let r of t.activeChildren)e.push(...await this.componentAndRenderedDescendants(r))}return e}async createIsolatedComponents({serializedComponents:t,ancestors:e,shadow:r=!1,createNameContext:n=""}){let i="/";if(e.length>0){let o=e[0].componentName,l=this.components[o];l.attributes.newNamespace&&l.attributes.newNamespace.primitive?i=l.componentName+"/":i=mo(l.componentName)}let s=await this.createIsolatedComponentsSub({serializedComponents:t,ancestors:e,shadow:r,namespaceForUnamed:i,createNameContext:n});return{success:!0,components:s.components}}async createIsolatedComponentsSub({serializedComponents:t,ancestors:e,shadow:r=!1,createNameContext:n="",namespaceForUnamed:i="/",componentsReplacementOf:s}){let o=[],l="";for(let[c,p]of t.entries()){if(typeof p!="object"){o.push(p);continue}if(p.createdComponent===!0){let y=this._components[p.componentName];o.push(y),this.setAncestors(y,e);continue}let m=this.componentInfoObjects.allComponentClasses[p.componentType];if(m===void 0)throw Error("Cannot create component of type "+p.componentType);p.doenetAttributes||(p.doenetAttributes={});let f=p.componentName;if(f===void 0){let b=e[0].componentName+"|"+n+"|";p.uniqueIdentifier?b+=p.uniqueIdentifier:b+=c,f=Va(p.componentType.toLowerCase(),b),f=i+f}let h=(await this.createChildrenThenComponent({serializedComponent:p,componentName:f,ancestors:e,componentClass:m,shadow:r,namespaceForUnamed:i,componentsReplacementOf:s})).newComponent;o.push(h)}return{components:o}}async createChildrenThenComponent({serializedComponent:t,componentName:e,ancestors:r,componentClass:n,shadow:i=!1,namespaceForUnamed:s="/",componentsReplacementOf:o}){let l=t.children,u=[],c=[],p=[{componentName:e,componentClass:n},...r],m=this.parameterStack.parameters;this.parameterStack.push();let f=this.parameterStack.parameters;if(n.descendantCompositesMustHaveAReplacement?(f.compositesMustHaveAReplacement=!0,f.compositesDefaultReplacementType=n.descendantCompositesDefaultReplacementType):n.descendantCompositesMustHaveAReplacement===!1&&(f.compositesMustHaveAReplacement=!1),n.modifySharedParameters&&n.modifySharedParameters({sharedParameters:f,serializedComponent:t}),t.doenetAttributes.pushSharedParameters)for(let A of t.doenetAttributes.pushSharedParameters){let C=A.parameterName;C in f?f[C]=[...f[C]]:f[C]=[],f[C].push(A.value)}if(t.doenetAttributes.addToSharedParameters)for(let A of t.doenetAttributes.addToSharedParameters){let C=A.parameterName;C in f?f[C]=Object.assign({},f[C]):f[C]={},f[C][A.key]=A.value}if(l!==void 0)if(n.setUpVariant){let A,C;for(let[w,x]of l.entries())if(x.componentType==="variantControl"||x.createdComponent&&this._components[x.componentName].componentType==="variantControl"){A=w,C=x;break}let S=_a({serializedComponents:l,componentInfoObjects:this.componentInfoObjects});if(A!==void 0){if(t.variants){let x=t.variants.desiredVariant;x!==void 0&&(x.index!==void 0?C.variants={desiredVariantIndex:x.index}:x.name!==void 0&&(C.variants={desiredVariantName:x.name})),t.variants.uniqueVariants&&(f.numberOfVariants=t.variants.numberOfVariants)}let w=await this.createIsolatedComponentsSub({serializedComponents:[C],ancestors:p,shadow:i,createNameContext:"variantControl",namespaceForUnamed:s});u[A]=w.components[0]}if(await n.setUpVariant({serializedComponent:t,sharedParameters:f,definingChildrenSoFar:u,descendantVariantComponents:S}),n.keepChildrenSerialized&&A===void 0){let w=new Set([]),x=n.keepChildrenSerialized({serializedComponent:t,componentInfoObjects:this.componentInfoObjects});for(let O of x){if(w.has(Number(O)))throw Error("Invalid instructions to keep children serialized from "+n.componentType+": child repeated");w.add(Number(O)),c.push(l[O])}let R=[];for(let[O,_]of l.entries())w.has(O)||R.push(_);R.length>0&&(u=(await this.createIsolatedComponentsSub({serializedComponents:R,ancestors:p,shadow:i,namespaceForUnamed:s})).components)}else{let w=[...l.keys()].filter(O=>O!==A),x=l.filter((O,_)=>_!==A),R=await this.createIsolatedComponentsSub({serializedComponents:x,ancestors:p,shadow:i,namespaceForUnamed:s});for(let[O,_]of w.entries())u[_]=R.components[O]}}else if(n.keepChildrenSerialized){let A=new Set([]),C=n.keepChildrenSerialized({serializedComponent:t,componentInfoObjects:this.componentInfoObjects});for(let w of C){if(A.has(Number(w)))throw Error("Invalid instructions to keep children serialized from "+n.componentType+": child repeated");A.add(Number(w)),c.push(l[w])}let S=[];for(let[w,x]of l.entries())A.has(w)||S.push(x);S.length>0&&(u=(await this.createIsolatedComponentsSub({serializedComponents:S,ancestors:p,shadow:i,namespaceForUnamed:s})).components)}else u=(await this.createIsolatedComponentsSub({serializedComponents:l,ancestors:p,shadow:i,namespaceForUnamed:s})).components;let d={};if(t.attributes)for(let A in t.attributes)if(t.attributes[A].component){let S=await this.createIsolatedComponentsSub({serializedComponents:[t.attributes[A].component],ancestors:p,shadow:i,namespaceForUnamed:s,createNameContext:`attribute|${A}`});d[A]={component:S.components[0]}}else d[A]=t.attributes[A];let h={};t.downstreamDependencies&&Object.assign(h,t.downstreamDependencies);let y=await this.createStateVariableDefinitions({componentClass:n,prescribedDependencies:h});delete this.updateInfo.deletedComponents[e],delete this.updateInfo.deletedStateVariables[e];let b=new n({componentName:e,ancestors:r,definingChildren:u,stateVariableDefinitions:y,serializedChildren:c,serializedComponent:t,attributes:d,componentInfoObjects:this.componentInfoObjects,coreFunctions:this.coreFunctions,flags:this.flags,shadow:i,numerics:this.numerics,sharedParameters:f,parentSharedParameters:m});this.registerComponent(b),o&&(b.replacementOf=o),t.adaptedFrom&&(b.adaptedFrom=this._components[t.adaptedFrom],b.adaptedFrom.adapterUsed=b);for(let A in h){let C=h[A];for(let S of C)if(S.dependencyType==="referenceShadow"){let w={componentName:A};Object.assign(w,S),delete w.dependencyType,b.shadows=w;let x=this._components[A];x.shadowedBy||(x.shadowedBy=[]),x.shadowedBy.push(b);break}}await this.deriveChildResultsFromDefiningChildren({parent:b,expandComposites:!1}),await this.initializeComponentStateVariables(b),await this.dependencies.setUpComponentDependencies(b);let g=await this.dependencies.checkForDependenciesOnNewComponent(e);for(let A of g)await this.recordActualChangeInStateVariable({componentName:A.componentName,varName:A.varName});return await this.checkForStateVariablesUpdatesForNewComponent(e),await this.dependencies.resolveStateVariablesIfReady({component:b}),await this.checkForActionChaining({component:b}),this.parameterStack.pop(),{newComponent:b}}async checkForStateVariablesUpdatesForNewComponent(t){if(t in this.updateInfo.stateVariableUpdatesForMissingComponents){let e=await this.processNewStateVariableValues({[t]:this.updateInfo.stateVariableUpdatesForMissingComponents[t]}),r=this._components[t];for(let n in this.updateInfo.stateVariableUpdatesForMissingComponents[t])r.state[n]&&await this.getStateVariableValue({component:r,stateVariable:n,justUpdatedForNewComponent:!0});e.foundIgnore&&await this.processNewStateVariableValues({[t]:this.updateInfo.stateVariableUpdatesForMissingComponents[t]}),delete this.updateInfo.stateVariableUpdatesForMissingComponents[t]}}async deriveChildResultsFromDefiningChildren({parent:t,expandComposites:e=!0,forceExpandComposites:r=!1}){if(this.derivingChildResults||(this.derivingChildResults=[]),this.derivingChildResults.includes(t.componentName))return{success:!1,skipping:!0};this.derivingChildResults.push(t.componentName);let n=await this.expandCompositeOfDefiningChildren(t,t.definingChildren,e,r);t.unexpandedCompositesReady=n.unexpandedCompositesReady,t.unexpandedCompositesNotReady=n.unexpandedCompositesNotReady,t.activeChildren=t.definingChildren.slice(),t.allChildren={},t.allChildrenOrdered=[];for(let o=0;o<t.activeChildren.length;o++){let l=t.activeChildren[o],u;typeof l=="object"&&(u=l.componentName,t.allChildren[u]={activeChildrenIndex:o,definingChildrenIndex:o,component:l},t.allChildrenOrdered.push(u))}await this.replaceCompositeChildren(t);let i=await this.matchChildrenToChildGroups(t);if(i.success)delete this.unmatchedChildren[t.componentName],t.childrenMatchedWithPlaceholders=!0;else{t.childrenMatchedWithPlaceholders=!1;let o=i.unmatchedChildren.map(l=>l.componentType).join(", ");this.unmatchedChildren[t.componentName]={message:`invalid children of type(s): ${o}`}}await this.dependencies.addBlockersFromChangedActiveChildren({parent:t});let s=this.derivingChildResults.indexOf(t.componentName);return this.derivingChildResults.splice(s,1),t.constructor.renderChildren&&this.componentsWithChangedChildrenToRender.add(t.componentName),i}async expandCompositeOfDefiningChildren(t,e,r,n){let i=[],s=[];for(let o=0;o<e.length;o++){let l=e[o];if(l instanceof this.componentInfoObjects.allComponentClasses._composite){if(this.findChildGroup(l.componentType,t.constructor).success)continue;if(!l.isExpanded){if(l.state.readyToExpandWhenResolved.isResolved){if(!r){i.push(l.componentName),this.updateInfo.compositesToExpand.add(l.componentName);continue}}else if(r){if(!(await this.dependencies.resolveItem({componentName:l.componentName,type:"stateVariable",stateVariable:"readyToExpandWhenResolved",expandComposites:r,force:n})).success){s.push(l.componentName),this.updateInfo.compositesToExpand.add(l.componentName);continue}}else{s.push(l.componentName),this.updateInfo.compositesToExpand.add(l.componentName);continue}await this.expandCompositeComponent(l)}let u=await this.expandCompositeOfDefiningChildren(t,l.replacements,r,n);i.push(...u.unexpandedCompositesReady),s.push(...u.unexpandedCompositesNotReady)}}return{unexpandedCompositesReady:i,unexpandedCompositesNotReady:s}}async matchChildrenToChildGroups(t){t.childMatchesByGroup={};for(let n in t.constructor.childGroupIndsByName)t.childMatchesByGroup[n]=[];let e=!0,r=[];for(let[n,i]of t.activeChildren.entries()){let s=typeof i!="object"?typeof i:i.componentType,o=this.findChildGroup(s,t.constructor);o.success?(t.childMatchesByGroup[o.group].push(n),o.adapterIndUsed!==void 0&&await this.substituteAdapter({parent:t,childInd:n,adapterIndUsed:o.adapterIndUsed})):(e=!1,r.push(i))}return{success:e,unmatchedChildren:r}}findChildGroup(t,e){let r=this.findChildGroupNoAdapters(t,e);if(r.success)return r;if(t==="string")return{success:!1};let n=this.componentInfoObjects.allComponentClasses[t],i=n.nAdapters;for(let s=0;s<i;s++){let o=n.getAdapterComponentType(s,this.componentInfoObjects.publicStateVariableInfo);if(r=this.findChildGroupNoAdapters(o,e),r.success)return r.adapterIndUsed=s,r}return{success:!1}}findChildGroupNoAdapters(t,e){if(e.childGroupOfComponentType[t])return{success:!0,group:e.childGroupOfComponentType[t]};for(let r of e.childGroups)for(let n of r.componentTypes)if(this.componentInfoObjects.isInheritedComponentType({inheritedComponentType:t,baseComponentType:n})&&!(n==="_base"&&this.componentInfoObjects.isInheritedComponentType({inheritedComponentType:t,baseComponentType:"_composite"})))return e.childGroupOfComponentType[t]=r.group,{success:!0,group:r.group};return{success:!1}}async returnActiveChildrenIndicesToRender(t){let e=[],r=1/0;"nChildrenToRender"in t.state&&(r=await t.stateValues.nChildrenToRender);let n=null;"childIndicesToRender"in t.state&&(n=await t.stateValues.childIndicesToRender);for(let[i,s]of t.activeChildren.entries()){if(i>=r)break;if(!(n&&!n.includes(i)))if(typeof s=="object")await s.stateValues.hidden||e.push(i);else{let o=!1;if(t.compositeReplacementActiveRange){for(let l of t.compositeReplacementActiveRange)if(await this._components[l.compositeName].stateValues.hidden&&l.firstInd<=i&&l.lastInd>=i){o=!0;break}}o||e.push(i)}}return e}async substituteAdapter({parent:t,childInd:e,adapterIndUsed:r}){let n=t.activeChildren[e],i;n.componentName?i=n.getAdapter(r):i={componentType:this.componentInfoObjects.allComponentClasses[n.componentType].getAdapterComponentType(r,this.componentInfoObjects.publicStateVariableInfo),placeholderInd:n.placeholderInd+"adapt"};let s=n.adapterUsed;if(s===void 0||s.componentType!==i.componentType)if(n.componentName){let o;t.attributes.newNamespace&&t.attributes.newNamespace.primitive?o=t.componentName+"/":o=mo(t.componentName),i.adaptedFrom=n.componentName,s=(await this.createIsolatedComponentsSub({serializedComponents:[i],shadow:!0,ancestors:n.ancestors,createNameContext:n.componentName+"|adapter",namespaceForUnamed:o})).components[0]}else i.adaptedFrom=n,s=i;if(t.activeChildren.splice(e,1,s),n.componentName&&(delete t.allChildren[n.componentName].activeChildrenIndex,t.allChildren[s.componentName]={activeChildrenIndex:e,component:s}),n.componentName){let o=t.allChildrenOrdered.indexOf(n.componentName);t.allChildrenOrdered.splice(o+1,0,s.componentName)}else{let o=t.allChildrenOrdered.indexOf(n.placeholderInd);t.allChildrenOrdered.splice(o+1,0,s.placeholderInd)}}async expandCompositeComponent(t){if(!("readyToExpandWhenResolved"in t.state))throw Error(`Could not find state variable readyToExpandWhenResolved of composite ${t.componentName}`);if(!t.state.readyToExpandWhenResolved.isResolved)return this.updateInfo.compositesToExpand.add(t.componentName),{success:!1};if(this.updateInfo.compositesToExpand.delete(t.componentName),this.updateInfo.compositesBeingExpanded.push(t.componentName),t.parent){if(t.parent.unexpandedCompositesReady){let n=t.parent.unexpandedCompositesReady.indexOf(t.componentName);n!==-1&&t.parent.unexpandedCompositesReady.splice(n,1)}if(t.parent.unexpandedCompositesNotReady){let n=t.parent.unexpandedCompositesNotReady.indexOf(t.componentName);n!==-1&&t.parent.unexpandedCompositesNotReady.splice(n,1)}}if(t.shadows)return await this.expandShadowingComposite(t);let e=await t.constructor.createSerializedReplacements({component:this.components[t.componentName],components:this.components,workspace:t.replacementsWorkspace,componentInfoObjects:this.componentInfoObjects,flags:this.flags,resolveItem:this.dependencies.resolveItem.bind(this.dependencies),publicCaseInsensitiveAliasSubstitutions:this.publicCaseInsensitiveAliasSubstitutions.bind(this)});if(t.constructor.stateVariableToEvaluateAfterReplacements&&await t.stateValues[t.constructor.stateVariableToEvaluateAfterReplacements],e.replacements){let n=e.replacements;await this.createAndSetReplacements({component:t,serializedReplacements:n}),e.withholdReplacements&&(t.replacementsToWithhold=t.replacements.length)}else throw Error(`Invalid createSerializedReplacements of ${t.componentName}`);let r=this.updateInfo.compositesBeingExpanded.indexOf(t.componentName);if(r===-1)throw Error(`Something is wrong as we lost track that we were expanding ${t.componentName}`);return this.updateInfo.compositesBeingExpanded.splice(r,1),{success:!0,compositesExpanded:[t.componentName]}}async expandShadowingComposite(t){if(this.updateInfo.compositesBeingExpanded.includes(t.shadows.componentName)){let u=this._components[t.shadows.componentName];for(;u.shadows;)u=this._components[u.shadows.componentName];throw Error(`Circular reference involving ${u.componentName}`)}let e=this._components[t.shadows.componentName],r=[];if(!e.isExpanded){let u=await this.expandCompositeComponent(e);if(!u.success)throw Error(`expand result of ${t.componentName} was not a success even though ready to expand.`);r.push(...u.compositesExpanded)}let n=[];for(let u of e.replacements)typeof u=="object"?n.push(await u.serialize()):n.push(u);let i=t.replacementsWorkspace.uniqueIdentifiersUsed=[],s=t.shadows.compositeName;n=_r({serializedComponents:n,componentName:s,uniqueIdentifiersUsed:i});let o=t.attributes.newNamespace&&t.attributes.newNamespace.primitive;if(t.attributes.isResponse){let u=t.constructor.createAttributesObject({flags:this.flags});for(let c of n){if(typeof c!="object")continue;c.attributes||(c.attributes={});let p=Ze({attributes:{isResponse:t.attributes.isResponse},componentType:c.componentType,componentInfoObjects:this.componentInfoObjects,compositeAttributesObj:u,compositeCreatesNewNamespace:o});Object.assign(c.attributes,p)}}if(t.constructor.assignNamesToReplacements){let u=t.constructor.originalNamesAreConsistent&&o;n=de({assignNames:t.doenetAttributes.assignNames,serializedComponents:n,parentName:t.componentName,parentCreatesNewNamespace:o,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:u}).serializedComponents}else{let u=o;n=de({serializedComponents:n,parentName:t.componentName,parentCreatesNewNamespace:o,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:u}).serializedComponents}await this.createAndSetReplacements({component:t,serializedReplacements:n});let l=this.updateInfo.compositesBeingExpanded.indexOf(t.componentName);if(l===-1)throw Error(`Something is wrong as we lost track that we were expanding ${t.componentName}`);return this.updateInfo.compositesBeingExpanded.splice(l,1),r.push(t.componentName),{success:!0,compositesExpanded:r}}async createAndSetReplacements({component:t,serializedReplacements:e}){this.parameterStack.push(t.sharedParameters,!1);let r;t.attributes.newNamespace&&t.attributes.newNamespace.primitive?r=t.componentName+"/":r=mo(t.componentName);let n=await this.createIsolatedComponentsSub({serializedComponents:e,ancestors:t.ancestors,shadow:!0,createNameContext:t.componentName+"|replacements",namespaceForUnamed:r,componentsReplacementOf:t});this.parameterStack.pop(),t.replacements=n.components,await this.dependencies.addBlockersFromChangedReplacements(t),t.isExpanded=!0}async replaceCompositeChildren(t){delete t.placeholderActiveChildrenIndices,delete t.placeholderActiveChildrenIndicesByComposite,delete t.compositeReplacementActiveRange;let e=0;for(let r=0;r<t.activeChildren.length;r++){let n=t.activeChildren[r];if(n instanceof this.componentInfoObjects.allComponentClasses._composite){if(this.findChildGroup(n.componentType,t.constructor).success)continue;let i=!1;if(!n.isExpanded)if(n.attributes.componentType&&n.attributes.componentType.primitive)i=!0;else continue;let s;if(i){let u;n.attributes.nComponents?u=n.attributes.nComponents.primitive:u=1;let c=this.componentInfoObjects.componentTypeLowerCaseMapping[n.attributes.componentType.primitive.toLowerCase()];s=[];for(let m=0;m<u;m++)s.push({componentType:c,fromComposite:n.componentName,placeholderInd:e}),e++;t.hasPlaceholderActiveChildren=!0;let p=[...Array(u).keys()].map(m=>m+r);t.placeholderActiveChildrenIndices||(t.placeholderActiveChildrenIndices=[]),t.placeholderActiveChildrenIndices.push(...p),t.placeholderActiveChildrenIndicesByComposite||(t.placeholderActiveChildrenIndicesByComposite={}),t.placeholderActiveChildrenIndicesByComposite[n.componentName]=p}else await this.markWithheldReplacementsInactive(n),s=n.replacements,n.replacementsToWithhold>0&&(s=s.slice(0,-n.replacementsToWithhold)),(!t.constructor.includeBlankStringChildren||t.constructor.removeBlankStringChildrenPostSugar)&&(s=s.filter(u=>typeof u!="string"||/\S/.test(u)));t.compositeReplacementActiveRange||(t.compositeReplacementActiveRange=[]);for(let u of t.compositeReplacementActiveRange)u.lastInd>=r&&(u.lastInd+=s.length-1);t.compositeReplacementActiveRange.push({compositeName:n.componentName,target:await n.stateValues.target,firstInd:r,lastInd:r+s.length-1}),t.activeChildren.splice(r,1,...s);let o=t.allChildren[n.componentName];delete o.activeChildrenIndex;for(let u=0;u<s.length;u++){let c=s[u];c.componentName&&(t.allChildren[c.componentName]={activeChildrenIndex:r+u,component:c})}let l=t.allChildrenOrdered.indexOf(n.componentName);if(t.allChildrenOrdered.splice(l+1,0,...s.filter(u=>typeof u=="object").map(u=>u.componentName?u.componentName:u.placeholderInd)),s.length!==1){let u=s.length-1;for(let c=r+s.length;c<t.activeChildren.length;c++){let p=t.activeChildren[c];p.componentName&&(t.allChildren[p.componentName].activeChildrenIndex+=u)}}r--}}}async markWithheldReplacementsInactive(t){let e=t.replacements.length;await t.stateValues.isInactiveCompositeReplacement?e=0:t.replacementsToWithhold>0&&(e-=t.replacementsToWithhold);for(let r of t.replacements.slice(0,e))await this.changeInactiveComponentAndDescendants(r,!1);for(let r of t.replacements.slice(e))await this.changeInactiveComponentAndDescendants(r,!0);if(!await t.stateValues.isInactiveCompositeReplacement){let r=t.componentName;this.updateInfo.inactiveCompositesToUpdateReplacements.includes(r)&&(this.updateInfo.inactiveCompositesToUpdateReplacements=this.updateInfo.inactiveCompositesToUpdateReplacements.filter(n=>n!=r),this.updateInfo.compositesToUpdateReplacements.push(r))}}async changeInactiveComponentAndDescendants(t,e){if(typeof t=="object"&&await t.stateValues.isInactiveCompositeReplacement!==e){t.state.isInactiveCompositeReplacement.value=e,await this.markUpstreamDependentsStale({component:t,varName:"isInactiveCompositeReplacement"}),this.dependencies.recordActualChangeInUpstreamDependencies({component:t,varName:"isInactiveCompositeReplacement"});for(let r in t.allChildren)await this.changeInactiveComponentAndDescendants(this._components[r],e);for(let r in t.attributes){let n=t.attributes[r].component;n&&await this.changeInactiveComponentAndDescendants(this._components[n.componentName],e)}t.replacements&&await this.markWithheldReplacementsInactive(t)}}findShadowedChildInSerializedComponents({serializedComponents:t,shadowedComponentName:e}){for(let r of t){if(r.originalName===e)return r;if(r.children){let n=this.findShadowedChildInSerializedComponents({serializedComponents:r.children,shadowedComponentName:e});if(n)return n}}}async createStateVariableDefinitions({componentClass:t,prescribedDependencies:e}){let r;if(e)for(let s in e){let o=e[s];for(let l of o)l.dependencyType==="referenceShadow"?r={linkSource:"referenceShadow",targetName:s,compositeName:l.compositeName,propVariable:l.propVariable,arrayStateVariable:l.arrayStateVariable,arrayKey:l.arrayKey,ignorePrimaryStateVariable:l.ignorePrimaryStateVariable,substituteForPrimaryStateVariable:l.substituteForPrimaryStateVariable,firstLevelReplacement:l.firstLevelReplacement}:l.dependencyType==="adapter"&&(r={linkSource:"adapter",adapterTargetIdentity:l.adapterTargetIdentity,adapterVariable:l.adapterVariable,substituteForPrimaryStateVariable:l.substituteForPrimaryStateVariable})}let n={};r||this.createAttributeStateVariableDefinitions({stateVariableDefinitions:n,componentClass:t});let i=t.returnNormalizedStateVariableDefinitions({attributeNames:Object.keys(n),numerics:this.numerics});return Object.assign(n,i),r&&(r.linkSource==="adapter"?this.createAdapterStateVariableDefinitions({redefineDependencies:r,stateVariableDefinitions:n,componentClass:t}):await this.createReferenceShadowStateVariableDefinitions({redefineDependencies:r,stateVariableDefinitions:n,componentClass:t})),n}createAttributeStateVariableDefinitions({componentClass:t,stateVariableDefinitions:e}){let r=t.createAttributesObject({flags:this.flags});for(let n in r){let i=r[n];if(!i.createStateVariable)continue;let s=i.createStateVariable,o=e[s]={isAttribute:!0,hasEssential:!0},l=!i.createComponentOfType;i.public&&(o.public=!0,o.componentType=i.stateVariableComponentType,o.componentType===void 0&&(l?o.componentType=i.createPrimitiveOfType:o.componentType=i.createComponentOfType));let u;if(!l){let p=this.componentInfoObjects.allComponentClasses[i.createComponentOfType];if(!p)throw Error(`Component type ${i.createComponentOfType} does not exist so cannot create state variable for attribute ${n} of componentType ${t.componentType}.`);u=i.componentStateVariableForAttributeValue,u===void 0&&(u=p.stateVariableForAttributeValue,u===void 0&&(u="value"))}o.returnDependencies=function(){let p={};return i.fallBackToParentStateVariable&&(p.parentValue={dependencyType:"parentStateVariable",variableName:i.fallBackToParentStateVariable}),l?p.attributePrimitive={dependencyType:"attributePrimitive",attributeName:n}:p.attributeComponent={dependencyType:"attributeComponent",attributeName:n,variableNames:[u]},p},o.definition=function({dependencyValues:p,usedDefault:m}){let f;if(p.attributeComponent)f=p.attributeComponent.stateValues[u];else if(p.attributePrimitive!==void 0&&p.attributePrimitive!==null)f=p.attributePrimitive;else return p.parentValue!==void 0&&p.parentValue!==null&&!m.parentValue?{setValue:{[s]:p.parentValue}}:{useEssentialOrDefaultValue:{[s]:!0}};return f=SH({value:f,attributeSpecification:i,attribute:n}),{setValue:{[s]:f}}},i.noInverse||(o.inverseDefinition=async function({desiredStateVariableValues:p,dependencyValues:m,usedDefault:f}){return m.attributeComponent?{success:!0,instructions:[{setDependency:"attributeComponent",desiredValue:p[s],variableIndex:0}]}:m.attributePrimitive!==void 0&&m.attributePrimitive!==null?{success:!1}:m.parentValue!==void 0&&m.parentValue!==null&&!f.parentValue?{success:!0,instructions:[{setDependency:"parentValue",desiredValue:p[s]}]}:{success:!0,instructions:[{setEssentialValue:s,value:p[s]}]}});let c=["forRenderer","defaultValue","propagateToProps","triggerActionOnChange"];for(let p of c)p in i&&(o[p]=i[p])}}createAdapterStateVariableDefinitions({redefineDependencies:t,stateVariableDefinitions:e,componentClass:r}){let n=this._components[t.adapterTargetIdentity.componentName],i=r.createAttributesObject({flags:this.flags});for(let l in i){let u=i[l];if(!u.createStateVariable)continue;let c=u.createStateVariable,p=e[c]={isAttribute:!0,hasEssential:!0},m=!u.createComponentOfType;u.public&&(p.public=!0,p.componentType=u.stateVariableComponentType,p.componentType===void 0&&(m?(p.componentType=u.createPrimitiveOfType,p.componentType==="string"&&(p.componentType="text")):p.componentType=u.createComponentOfType)),c in n.state?p.returnDependencies=()=>({adapterTargetVariable:{dependencyType:"stateVariable",componentName:t.adapterTargetIdentity.componentName,variableName:c}}):p.returnDependencies=()=>({}),p.definition=function({dependencyValues:d,usedDefault:h}){return d.adapterTargetVariable===void 0||h.adapterTargetVariable?{useEssentialOrDefaultValue:{[c]:!0}}:{setValue:{[c]:d.adapterTargetVariable}}},u.noInverse||(p.inverseDefinition=async function({desiredStateVariableValues:d,dependencyValues:h}){return h.adapterTargetVariable===void 0?{success:!0,instructions:[{setEssentialValue:c,value:d[c]}]}:{success:!0,instructions:[{setDependency:"adapterTargetVariable",desiredValue:d[c]}]}});let f=["forRenderer","defaultValue","propagateToProps"];for(let d of f)d in u&&(p[d]=u[d])}let s="value";t.substituteForPrimaryStateVariable?s=t.substituteForPrimaryStateVariable:r.primaryStateVariableForDefinition&&(s=r.primaryStateVariableForDefinition);let o=e[s];o.returnDependencies=()=>({adapterTargetVariable:{dependencyType:"stateVariable",componentName:t.adapterTargetIdentity.componentName,variableName:t.adapterVariable}}),o.set?o.definition=function({dependencyValues:l}){return{setValue:{[s]:o.set(l.adapterTargetVariable)}}}:o.definition=function({dependencyValues:l}){return{setValue:{[s]:l.adapterTargetVariable}}},o.inverseDefinition=function({desiredStateVariableValues:l}){return{success:!0,instructions:[{setDependency:"adapterTargetVariable",desiredValue:l[s]}]}}}async createReferenceShadowStateVariableDefinitions({redefineDependencies:t,stateVariableDefinitions:e,componentClass:r}){let n=this._components[t.compositeName],i=this._components[t.targetName],s={};if(t.propVariable){let c=i.state[t.propVariable];!c&&this.checkIfArrayEntry({stateVariable:t.propVariable,component:i})&&(await this.createFromArrayEntry({stateVariable:t.propVariable,component:i}),c=i.state[t.propVariable]),c&&c.stateVariablesPrescribingAdditionalAttributes&&(s=c.stateVariablesPrescribingAdditionalAttributes)}let o=r.createAttributesObject({flags:this.flags});for(let c in o){let p=o[c];if(!p.createStateVariable)continue;let m=p.createStateVariable,f=e[m]={isAttribute:!0,hasEssential:!0},d=!p.createComponentOfType;p.public&&(f.public=!0,f.componentType=p.stateVariableComponentType,f.componentType===void 0&&(d?(f.componentType=p.createPrimitiveOfType,f.componentType==="string"&&(f.componentType="text")):f.componentType=p.createComponentOfType));let h;if(!d){let g=this.componentInfoObjects.allComponentClasses[p.createComponentOfType];if(!g)throw Error(`Component type ${p.createComponentOfType} does not exist so cannot create state variable for attribute ${c} of componentType ${r.componentType}.`);h=p.componentStateVariableForAttributeValue,h===void 0&&(h=g.stateVariableForAttributeValue,h===void 0&&(h="value"))}let y={};d?y.attributePrimitive={dependencyType:"attributePrimitive",attributeName:c}:y.attributeComponent={dependencyType:"attributeComponent",attributeName:c,variableNames:[h],fallBackToAttributeFromShadow:!1},(!t.propVariable||p.propagateToProps)&&m in i.state&&(y.targetVariable={dependencyType:"stateVariable",componentName:i.componentName,variableName:m},"targetAttributesToIgnore"in n.state&&t.firstLevelReplacement&&(y.targetAttributesToIgnore={dependencyType:"stateVariable",componentName:n.componentName,variableName:"targetAttributesToIgnore"})),"targetAttributesToAlwaysIgnore"in n.state&&(y.targetAttributesToAlwaysIgnore={dependencyType:"stateVariable",componentName:n.componentName,variableName:"targetAttributesToAlwaysIgnore"}),s[c]&&(y.targetVariable={dependencyType:"stateVariable",componentName:i.componentName,variableName:s[c]}),p.fallBackToParentStateVariable&&(y.parentValue={dependencyType:"parentStateVariable",variableName:p.fallBackToParentStateVariable}),f.returnDependencies=()=>y,f.definition=function({dependencyValues:g,usedDefault:v}){let A;if(g.attributeComponent)A=g.attributeComponent.stateValues[h];else if(g.attributePrimitive!==void 0&&g.attributePrimitive!==null)A=g.attributePrimitive;else{let C=[];return g.targetAttributesToIgnore&&C.push(...g.targetAttributesToIgnore),g.targetAttributesToAlwaysIgnore&&C.push(...g.targetAttributesToAlwaysIgnore),g.targetVariable!==void 0&&!C.includes(c)&&!v.targetVariable?{setValue:{[m]:g.targetVariable}}:g.parentValue!==void 0&&g.parentValue!==null&&!v.parentValue?{setValue:{[m]:g.parentValue}}:{useEssentialOrDefaultValue:{[m]:!0}}}return A=SH({value:A,attributeSpecification:p,attribute:c}),{setValue:{[m]:A}}},p.noInverse||(f.inverseDefinition=async function({desiredStateVariableValues:g,dependencyValues:v,stateValues:A,workspace:C}){if(!v.attributeComponent){if(v.attributePrimitive!==void 0&&v.attributePrimitive!==null)return{success:!1};let S=[];return v.targetAttributesToIgnore&&S.push(...v.targetAttributesToIgnore),v.targetAttributesToAlwaysIgnore&&S.push(...v.targetAttributesToAlwaysIgnore),v.targetVariable!==void 0&&!S.includes(c)?{success:!0,instructions:[{setDependency:"targetVariable",desiredValue:g[m]}]}:v.parentValue!==void 0&&v.parentValue!==null&&!usedDefault.parentValue?{success:!0,instructions:[{setDependency:"parentValue",desiredValue:g[m]}]}:{success:!0,instructions:[{setEssentialValue:m,value:g[m]}]}}return{success:!0,instructions:[{setDependency:"attributeComponent",desiredValue:g[m],variableIndex:0}]}});let b=["forRenderer","defaultValue","propagateToProps"];for(let g of b)g in p&&(f[g]=p[g])}if(t.propVariable){if(!t.ignorePrimaryStateVariable){let c="value";t.substituteForPrimaryStateVariable?c=t.substituteForPrimaryStateVariable:r.primaryStateVariableForDefinition&&(c=r.primaryStateVariableForDefinition);let p=e[c];if(!p)throw t.substituteForPrimaryStateVariable?Error(`Invalid public state variable of componentType ${r.componentType}: substituteForPrimaryStateVariable ${t.substituteForPrimaryStateVariable} does not exist`):Error(`Cannot have a public state variable with componentType ${r.componentType} as the class doesn't have a primary state variable for definition`);p.isShadow=!0,p.returnDependencies=()=>({targetVariable:{dependencyType:"stateVariable",componentName:i.componentName,variableName:t.propVariable}}),p.set?p.definition=function({dependencyValues:m}){return{setValue:{[c]:p.set(m.targetVariable)},alwaysShadow:[c]}}:p.definition=function({dependencyValues:m}){return{setValue:{[c]:m.targetVariable},alwaysShadow:[c]}},p.inverseDefinition=function({desiredStateVariableValues:m}){return{success:!0,instructions:[{setDependency:"targetVariable",desiredValue:m[c]}]}}}return}let l=!1;if("readyToExpandWhenResolved"in e){l=!0;let c=e.readyToExpandWhenResolved,p=c.returnDependencies.bind(c),m=c.definition;c.returnDependencies=function(f){let d=p(f);return d.targetReadyToExpandWhenResolved={dependencyType:"stateVariable",componentName:i.componentName,variableName:"readyToExpandWhenResolved"},d},c.definition=function(f){let d=m(f);return d.setValue&&d.setValue.readyToExpandWhenResolved&&(f.dependencyValues.targetReadyToExpandWhenResolved||(d.setValue.readyToExpandWhenResolved=!1)),d}}let u=[];for(let c in i.state){let p=i.state[c];(p.shadowVariable||p.isShadow)&&u.push(c)}this.modifyStateDefsToBeShadows({stateVariablesToShadow:u,stateVariableDefinitions:e,foundReadyToExpandWhenResolved:l,targetComponent:i})}modifyStateDefsToBeShadows({stateVariablesToShadow:t,stateVariableDefinitions:e,foundReadyToExpandWhenResolved:r,targetComponent:n}){let i={};for(let s of t){let o=e[s];if(o===void 0)if(s.slice(0,8)==="__array_")o=e[s]={};else continue;if(o.isShadow=!0,o.additionalStateVariablesDefined)for(let u of o.additionalStateVariablesDefined)t.includes(u)||(i[u]||(i[u]=[]),i[u].push(s));delete o.additionalStateVariablesDefined,r||delete o.stateVariablesDeterminingDependencies;let l=o.public&&o.hasVariableComponentType;if(o.isArray)o.returnArrayDependenciesByKey=function({arrayKeys:u}){let c={};for(let m of u)c[m]={targetVariable:{dependencyType:"stateVariable",componentName:n.componentName,variableName:this.arrayVarNameFromArrayKey(m)}};let p={};return l&&(p.targetVariableComponentType={dependencyType:"stateVariableComponentType",componentName:n.componentName,variableName:s}),o.inverseShadowToSetEntireArray&&(p.targetArray={dependencyType:"stateVariable",componentName:n.componentName,variableName:s}),{globalDependencies:p,dependenciesByKey:c}},o.arrayDefinitionByKey=function({globalDependencyValues:u,dependencyValuesByKey:c,arrayKeys:p}){let m={};for(let d of p)"targetVariable"in c[d]?m[d]=c[d].targetVariable:m[d]=o.defaultValueByArrayKey?.(d);let f={setValue:{[s]:m},alwaysShadow:[s]};return"targetVariableComponentType"in u&&(f.setComponentType={[s]:u.targetVariableComponentType}),f},o.inverseArrayDefinitionByKey=function({desiredStateVariableValues:u,dependencyValuesByKey:c,dependencyNamesByKey:p,arraySize:m,initialChange:f}){if(o.inverseShadowToSetEntireArray)return{success:!0,instructions:[{setDependency:"targetArray",desiredValue:u[s],treatAsInitialChange:f}]};let d=[];for(let h in u[s])!c[h]||d.push({setDependency:p[h].targetVariable,desiredValue:u[s][h],shadowedVariable:!0});return{success:!0,instructions:d}};else{let u=()=>({});r&&(u=o.returnDependencies.bind(o)),o.returnDependencies=function(c){let p=Object.assign({},u(c));return p.targetVariable={dependencyType:"stateVariable",componentName:n.componentName,variableName:s},l&&(p.targetVariableComponentType={dependencyType:"stateVariableComponentType",componentName:n.componentName,variableName:s}),p},o.definition=function({dependencyValues:c,usedDefault:p}){let m={alwaysShadow:[s]};return"targetVariableComponentType"in c&&(m.setComponentType={[s]:c.targetVariableComponentType}),p.targetVariable&&"defaultValue"in o?m.useEssentialOrDefaultValue={[s]:!0}:m.setValue={[s]:c.targetVariable},m},o.excludeDependencyValuesInInverseDefinition=!0,o.inverseDefinition=function({desiredStateVariableValues:c}){return{success:!0,instructions:[{setDependency:"targetVariable",desiredValue:c[s],shadowedVariable:!0}]}}}}for(let s in i)this.modifyStateDefToDeleteVariableReferences({varNamesToDelete:i[s],stateDef:e[s]})}modifyStateDefToDeleteVariableReferences({varNamesToDelete:t,stateDef:e}){for(let n of t){let i=e.additionalStateVariablesDefined.indexOf(n);e.additionalStateVariablesDefined.splice(i,1)}let r=e.definition;e.definition=function(n){let i=r(n);for(let s in i)if(Array.isArray(i[s]))for(let o of t){let l=i[s].indexOf(o);l!==-1&&i[s].splice(l,1)}else for(let o of t)delete i[s][o];return i}}async initializeComponentStateVariables(t){for(let e in t.state)t.state[e].isAlias?(t.stateVarAliases||(t.stateVarAliases={}),t.stateVarAliases[e]=t.state[e].targetVariableName,delete t.state[e]):await this.initializeStateVariable({component:t,stateVariable:e})}async initializeStateVariable({component:t,stateVariable:e,arrayStateVariable:r,arrayEntryPrefix:n}){let i=this.getStateVariableValue;t.state[e]||(t.state[e]={});let s=t.state[e];if(s.isResolved=!1,Object.defineProperty(s,"value",{get:()=>i({component:t,stateVariable:e}),configurable:!0}),n!==void 0?await this.initializeArrayEntryStateVariable({stateVarObj:s,arrayStateVariable:r,arrayEntryPrefix:n,component:t,stateVariable:e}):s.isArray&&await this.initializeArrayStateVariable({stateVarObj:s,component:t,stateVariable:e}),s.triggerActionOnChange){let o=this.stateVariableChangeTriggers[t.componentName];o||(o=this.stateVariableChangeTriggers[t.componentName]={}),o[e]={action:s.triggerActionOnChange}}}async checkForActionChaining({component:t,stateVariables:e}){if(!!t){e||(e=Object.keys(t.state));for(let r of e){let n=t.state[r];if(n.chainActionOnActionOfStateVariableTargets){let i=n.chainActionOnActionOfStateVariableTargets,s=await n.value,o=this.originsOfActionsChangedToActions[t.componentName],l;o&&(l=o[r]),l||(l=[]);let u=[];if(Array.isArray(s)){u=[...new Set(s)];for(let c of u){let p=l.indexOf(c);if(p===-1){let m=this.actionsChangedToActions[c];m||(m=this.actionsChangedToActions[c]=[]),m.push({componentName:t.componentName,actionName:i.triggeredAction,stateVariableDefiningChain:r,args:{}})}else l.splice(p,1)}}for(let c of l){let p=this.actionsChangedToActions[c];if(p){let m=[];for(let f of p)(f.componentName!==t.componentName||f.stateVariableDefiningChain!==r)&&m.push(f);this.actionsChangedToActions[c]=m}}u.length>0?(o||(o=this.originsOfActionsChangedToActions[t.componentName]={}),o[r]=u):o&&(delete o[r],Object.keys(o).length===0&&delete this.originsOfActionsChangedToActions[t.componentName])}}}}async initializeArrayEntryStateVariable({stateVarObj:t,arrayStateVariable:e,arrayEntryPrefix:r,component:n,stateVariable:i}){t.isArrayEntry=!0,t.arrayStateVariable=e;let s=n.state[e];if(t.definition=s.definition,t.inverseDefinition=s.inverseDefinition,t.markStale=s.markStale,t.freshnessInfo=s.freshnessInfo,t.getPreviousDependencyValuesForMarkStale=s.getPreviousDependencyValuesForMarkStale,t.provideEssentialValuesInDefinition=s.provideEssentialValuesInDefinition,t.providePreviousValuesInDefinition=s.providePreviousValuesInDefinition,t.nDimensions=s.returnEntryDimensions(r),t.wrappingComponents=s.returnWrappingComponents(r),t.entryPrefix=r,t.varEnding=i.slice(r.length),s.createWorkspace&&(t.createWorkspace=!0,t.workspace=s.workspace),s.basedOnArrayKeyStateVariables&&(t.basedOnArrayKeyStateVariables=!0),s.additionalStateVariablesDefined){t.additionalStateVariablesDefined=[];let l=s.entryPrefixes.indexOf(r);for(let u of s.additionalStateVariablesDefined){let c=n.state[u];if(c.isArray){let m=c.entryPrefixes[l]+t.varEnding;t.additionalStateVariablesDefined.push(m)}else t.additionalStateVariablesDefined.push(u)}}if(s.stateVariablesPrescribingAdditionalAttributes){t.stateVariablesPrescribingAdditionalAttributes={};let l=s.entryPrefixes.indexOf(r);for(let u in s.stateVariablesPrescribingAdditionalAttributes){let c=s.stateVariablesPrescribingAdditionalAttributes[u],p=n.state[c];if(p.isArray){let f=p.entryPrefixes[l]+t.varEnding;t.stateVariablesPrescribingAdditionalAttributes[u]=f}else t.stateVariablesPrescribingAdditionalAttributes[u]=c}}if(s.getEntryValues?t.getValueFromArrayValues=async function(){return await s.getEntryValues({varName:i})}:t.getValueFromArrayValues=async function(){let l=await t.arrayKeys;if(l.length===0)return;let u=[];for(let c of l)u.push(s.getArrayValue({arrayKey:c}));return u.length===1?u[0]:u},t.arraySizeStateVariable=s.arraySizeStateVariable,t._arrayKeys=[],t._unflattenedArrayKeys=[],Object.defineProperty(t,"arrayKeys",{get:function(){return(async()=>(await s.arraySize,t._arrayKeys))()}}),Object.defineProperty(t,"unflattenedArrayKeys",{get:function(){return(async()=>(await s.arraySize,t._unflattenedArrayKeys))()}}),n.state[t.arraySizeStateVariable].initiallyResolved){let l=await s.arraySize,u=s.getArrayKeysFromVarName({arrayEntryPrefix:t.entryPrefix,varEnding:t.varEnding,arraySize:l,nDimensions:s.nDimensions});t._unflattenedArrayKeys=u,t._arrayKeys=vr(u);let c=s.varNamesIncludingArrayKeys;for(let p of t._arrayKeys)c[p]||(c[p]=[]),c[p].push(i)}if(s.arrayEntryNames.push(i),Object.defineProperty(t,"arraySize",{get:()=>s.arraySize}),Object.defineProperty(t,"arrayEntrySize",{get:function(){return(async()=>{let l=await t.unflattenedArrayKeys,u=[],c=[l];for(let p=0;p<t.nDimensions;p++)c=c[0],u.push(c.length);return u.reverse(),u})()}}),s.stateVariablesDeterminingDependencies){t.stateVariablesDeterminingDependencies||(t.stateVariablesDeterminingDependencies=[]);for(let l of s.stateVariablesDeterminingDependencies)t.stateVariablesDeterminingDependencies.includes(l)||t.stateVariablesDeterminingDependencies.push(l)}let o=s.returnDependencies.bind(s);t.returnDependencies=async function(l){l.arraySize=await t.arraySize,l.arrayKeys=await t.arrayKeys;let u=await o(l),c=Object.keys(s.dependencyNames.namesByKey).length;return t.numberNamesInPreviousReturnDep!==c&&(l.changedDependency=!0),t.numberNamesInPreviousReturnDep=c,u}}async initializeArrayStateVariable({stateVarObj:t,component:e,stateVariable:r}){t.arrayValues=[],t.nDimensions===void 0&&(t.nDimensions=1),t.nDimensions>1?(t.keyToIndex=o=>o.split(",").map(l=>Number(l)),t.setArrayValue=function({value:o,arrayKey:l,arraySize:u,arrayValues:c=t.arrayValues}){let p=t.keyToIndex(l),m=p.length;if(!m>t.nDimensions)return console.warn("Cannot set array value.  Number of dimensions is too large."),{nFailures:1};let f=c,d=u;for(let y of p.slice(0,p.length-1))if(y>=0&&y<d[0])f[y]||(f[y]=[]),f=f[y],d=d.slice(1);else return console.warn("ignore setting array value out of bounds"),{nFailures:1};let h=0;if(m<t.nDimensions){let y=function(g,v,A){if(!Array.isArray(g))return console.warn("ignoring array values with insufficient dimensions"),{nFailures:1};let C=0,S=A[0];if(g.length>S&&(console.warn("ignoring array values of out bounds"),C+=g.length-S,g=g.slice(0,S)),A.length===1)for(let[w,x]of g.entries())v[w]=x;else for(let[w,x]of g.entries())v[w]||(v=[]),C+=y(x,v[w],A[w]).nFailures;return{nFailures:C}};h+=y(o,f,d).nFailures}else f[p[p.length-1]]=o;return{nFailures:h}},t.getArrayValue=function({arrayKey:o,arrayValues:l=t.arrayValues}){let u=t.keyToIndex(o),c=l;for(let p of u.slice(0,u.length-1))if(c=c[p],!c)return;return c[u[u.length-1]]},t.getAllArrayKeys||(t.getAllArrayKeys=function(o,l=!0,u){function c(p){if(p.length===1)return Array.from(Array(p[0]),(m,f)=>String(f));{let m=p[0],f=c(p.slice(1)),d=[];for(let h=0;h<m;h++)l?d.push(...f.map(y=>h+","+y)):d.push(f.map(y=>h+","+y));return d}}return u?u.length===0?[]:c(u):!o||o.length===0?[]:c(o)}),t.arrayVarNameFromArrayKey||(t.arrayVarNameFromArrayKey=function(o){return n[0]+o.split(",").map(l=>Number(l)+1).join("_")}),t.adjustArrayToNewArraySize=async function(){function o(u,c){if(u.length=c[0],c.length>1){let p=c.slice(1);for(let[m,f]of u.entries())f||(f=u[m]=[]),o(f,p)}}let l=await t.arraySize;o(t.arrayValues,l)}):(t.keyToIndex=o=>Number(o),t.setArrayValue=function({value:o,arrayKey:l,arraySize:u,arrayValues:c=t.arrayValues}){let p=t.keyToIndex(l);return p>=0&&p<u[0]?(c[p]=o,{nFailures:0}):(console.warn(`Ignoring setting array values out of bounds: ${l} of ${r}`),{nFailures:1})},t.getArrayValue=function({arrayKey:o,arrayValues:l=t.arrayValues}){return l[o]},t.getAllArrayKeys||(t.getAllArrayKeys=function(o,l,u){return u?u.length===0?[]:Array.from(Array(u[0]),(c,p)=>String(p)):!o||o.length===0?[]:Array.from(Array(o[0]),(c,p)=>String(p))}),t.arrayVarNameFromArrayKey||(t.arrayVarNameFromArrayKey=function(o){return n[0]+String(Number(o)+1)}),t.adjustArrayToNewArraySize=async function(){let o=await t.arraySize;t.arrayValues.length=o[0]}),t.getArrayKeysFromVarName||(t.getArrayKeysFromVarName=dh(t.nDimensions)),t.indexToKey=o=>String(o);let n=t.entryPrefixes;n||(n=t.entryPrefixes=[r]),e.arrayEntryPrefixes||(e.arrayEntryPrefixes={});for(let o of n)e.arrayEntryPrefixes[o]=r;t.returnEntryDimensions||(t.returnEntryDimensions=()=>1),t.returnWrappingComponents||(t.returnWrappingComponents=o=>[]),t.wrappingComponents=t.returnWrappingComponents(),t.usedDefaultByArrayKey={},t.arrayEntryNames=[],t.varNamesIncludingArrayKeys={};let i=[r];t.additionalStateVariablesDefined&&i.push(...t.additionalStateVariablesDefined),t.returnDependencies=async function(o){o.arraySize=await t.arraySize;for(let u in o.stateValues)u.slice(0,8)==="__array_"&&delete o.stateValues[u];if(o.arrayKeys===void 0&&(o.arrayKeys=t.getAllArrayKeys(o.arraySize)),!t.dependencyNames&&(t.dependencyNames={namesByKey:{},keysByName:{},global:[]},t.additionalStateVariablesDefined))for(let u of t.additionalStateVariablesDefined)e.state[u].dependencyNames=t.dependencyNames;let l={};if(t.basedOnArrayKeyStateVariables&&o.arrayKeys.length>1)for(let u of o.arrayKeys)for(let c of i){let p=e.state[c];l[c+"_"+u]={dependencyType:"stateVariable",variableName:p.arrayVarNameFromArrayKey(u)}}else{let u=t.returnArrayDependenciesByKey(o);u.globalDependencies&&(t.dependencyNames.global=Object.keys(u.globalDependencies),Object.assign(l,u.globalDependencies)),u.dependenciesByKey||(u.dependenciesByKey={});for(let c of o.arrayKeys){c in t.dependencyNames.namesByKey||(o.changedDependency=!0),t.dependencyNames.namesByKey[c]={};for(let p in u.dependenciesByKey[c]){let m="__"+c+"_"+p;l[m]=u.dependenciesByKey[c][p],t.dependencyNames.namesByKey[c][p]=m,t.dependencyNames.keysByName[m]||(t.dependencyNames.keysByName[m]=[]),t.dependencyNames.keysByName[m].includes(c)||t.dependencyNames.keysByName[m].push(c)}}t.dependencyNames.global.push("__array_size")}return l.__array_size={dependencyType:"stateVariable",variableName:t.arraySizeStateVariable},l},t.getCurrentFreshness=function({freshnessInfo:o,arrayKeys:l,arraySize:u}){l===void 0&&(l=t.getAllArrayKeys(u));let c=o.freshByKey,p=o.freshArraySize?1:0;for(let m of l)c[m]&&(p+=1);return p>0?p===l.length+1?{fresh:{[r]:!0}}:{partiallyFresh:{[r]:p}}:{fresh:{[r]:!1}}},t.markStale=function({freshnessInfo:o,changes:l,arrayKeys:u,arraySize:c}){let p={};u===void 0&&(u=t.getAllArrayKeys(c)),t.markStaleByKey&&(p=t.markStaleByKey({arrayKeys:u,changes:l}));let m=o.freshByKey;if(l.__array_size)return o.freshArraySize=!1,o.freshByKey={},p.fresh={[r]:!1},p;if(Object.keys(m).length===0)return o.freshByKey={},o.freshArraySize?(p.partiallyFresh={[r]:1},p):(p.fresh={[r]:!1},p);for(let d in l){if(t.dependencyNames.global.includes(d))return o.freshByKey={},o.freshArraySize?(p.partiallyFresh={[r]:1},p):(p.fresh={[r]:!1},p);if(t.basedOnArrayKeyStateVariables&&u.length>1)delete m[d];else for(let h of t.dependencyNames.keysByName[d])delete m[h]}let f=o.freshArraySize?1:0;for(let d of u)m[d]&&(f+=1);return f>0?f===u.length+1?(p.fresh={[r]:!0},p):(p.partiallyFresh={[r]:f},p):(p.fresh={[r]:!1},p)},t.freshenOnNoChanges=function({arrayKeys:o,freshnessInfo:l,arraySize:u}){let c=l.freshByKey;o===void 0&&(o=t.getAllArrayKeys(u));for(let p of o)c[p]=!0};function s(o,l,u){let c={},p={};for(let h of t.dependencyNames.global)c[h]=o[h],p[h]=u[h];let m={},f={},d={};for(let h of l)if(m[h]={},f[h]={},h in t.dependencyNames.namesByKey){d[h]=!0;for(let y in t.dependencyNames.namesByKey[h]){let b=t.dependencyNames.namesByKey[h][y];b in o?(m[h][y]=o[b],f[h][y]=u[b]):d[h]=!1}}return{globalDependencyValues:c,globalUsedDefault:p,dependencyValuesByKey:m,usedDefaultByKey:f,foundAllDependencyValuesForKey:d}}if(t.definition=function(o){if(o.arrayKeys===void 0&&(o.arrayKeys=t.getAllArrayKeys(o.arraySize)),t.basedOnArrayKeyStateVariables&&o.arrayKeys.length>1)return{};{let l=s(o.dependencyValues,o.arrayKeys,o.usedDefault),u=l.globalDependencyValues,c=l.globalUsedDefault,p=l.dependencyValuesByKey,m=l.usedDefaultByKey,f=l.foundAllDependencyValuesForKey;delete o.dependencyValues,o.globalDependencyValues=u,o.globalUsedDefault=c,o.dependencyValuesByKey=p,o.usedDefaultByKey=m;let d=[],h=o.freshnessInfo.freshByKey;for(let b of o.arrayKeys)!h[b]&&f[b]&&(h[b]=!0,d.push(b));let y;if(d.length===0)y={};else{if(o.arrayKeys=d,!t.arrayDefinitionByKey)throw Error(`For ${r} of ${e.componentType}, arrayDefinitionByKey must be a function`);if(y=t.arrayDefinitionByKey(o),y.setValue&&y.setValue[r])for(let b in y.setValue[r])h[b]=!0;if(y.useEssentialOrDefaultValue&&y.useEssentialOrDefaultValue[r])for(let b in y.useEssentialOrDefaultValue[r])h[b]=!0}if(!o.freshnessInfo.freshArraySize){if(o.changes.__array_size&&(y.arraySizeChanged=[r],t.additionalStateVariablesDefined))for(let b of t.additionalStateVariablesDefined)e.state[b].isArray&&y.arraySizeChanged.push(b);o.freshnessInfo.freshArraySize=!0}return y}},t.inverseDefinition=function(o){if(!t.inverseArrayDefinitionByKey)return{success:!1};if(o.arrayKeys===void 0&&(o.arrayKeys=t.getAllArrayKeys(o.arraySize)),t.basedOnArrayKeyStateVariables&&o.arrayKeys.length>1){let l=[];for(let u of i)for(let c in o.desiredStateVariableValues[u]){let p=u+"_"+c;p in o.dependencyValues&&l.push({setDependency:p,desiredValue:o.desiredStateVariableValues[u][c],treatAsInitialChange:o.initialChange})}return{success:!0,instructions:l}}else{let l=s(o.dependencyValues,o.arrayKeys,o.usedDefault),u=l.globalDependencyValues,c=l.globalUsedDefault,p=l.dependencyValuesByKey,m=l.usedDefaultByKey;return delete o.dependencyValues,o.globalDependencyValues=u,o.globalUsedDefault=c,o.dependencyValuesByKey=p,o.usedDefaultByKey=m,o.dependencyNamesByKey=t.dependencyNames.namesByKey,t.inverseArrayDefinitionByKey(o)}},await this.createArraySizeStateVariable({stateVarObj:t,component:e,stateVariable:r}),t.arraySizeStale=!0,t.previousArraySize=[],Object.defineProperty(t,"arraySize",{get:function(){return(async()=>e.state[t.arraySizeStateVariable].initiallyResolved?(t.arraySizeStale&&await t.recalculateArraySizeDependentQuantities(),await e.stateValues[t.arraySizeStateVariable]):[])()}}),t.recalculateArraySizeDependentQuantities=async function(){let o=await e.stateValues[t.arraySizeStateVariable];if(t.previousArraySize.length!==o.length||t.previousArraySize.some((l,u)=>l!=o[u])){t.previousArraySize=[...o];let l=t.varNamesIncludingArrayKeys={};for(let u of t.arrayEntryNames){let c=e.state[u],p=t.getArrayKeysFromVarName({arrayEntryPrefix:c.entryPrefix,varEnding:c.varEnding,arraySize:o,nDimensions:t.nDimensions});c._unflattenedArrayKeys=p,c._arrayKeys=vr(p);for(let m of c._arrayKeys)l[m]||(l[m]=[]),l[m].push(u)}}t.arraySizeStale=!1},!t.freshnessInfo&&(t.freshnessInfo={freshByKey:{}},t.additionalStateVariablesDefined))for(let o of t.additionalStateVariablesDefined)e.state[o]||(e.state[o]={}),e.state[o].freshnessInfo=t.freshnessInfo}async createArraySizeStateVariable({stateVarObj:t,component:e,stateVariable:r}){let n=[r];t.additionalStateVariablesDefined&&n.push(...t.additionalStateVariablesDefined),n.sort();let i="__array_size_"+n.join("_");t.arraySizeStateVariable=i;let s,o;if(t.stateVariablesDeterminingDependencies?(s=[...t.stateVariablesDeterminingDependencies],t.stateVariablesDeterminingDependencies.push(i)):t.stateVariablesDeterminingDependencies=[i],e.state[i]){if(e.state[i].isShadow){let l=e.state[i];l.markStale=function(){for(let u of n)e.state[u].arraySizeStale=!0;return{}}}return}e.state[i]={returnDependencies:t.returnArraySizeDependencies,definition({dependencyValues:l}){let u=t.returnArraySize({dependencyValues:l});for(let[c,p]of u.entries())Number.isInteger(p)&&p>=0||(u[c]=0);return{setValue:{[i]:u}}},markStale(){for(let l of n)e.state[l].arraySizeStale=!0;return{}}},t.stateVariablesDeterminingArraySizeDependencies&&(e.state[i].stateVariablesDeterminingDependencies=t.stateVariablesDeterminingArraySizeDependencies),await this.initializeStateVariable({component:e,stateVariable:i})}recursivelyReplaceCompositesWithReplacements({replacements:t,recurseNonStandardComposites:e=!1,forceExpandComposites:r=!1,includeWithheldReplacements:n=!1}){let i=[],s=[],o=[],l=[];for(let u of t)if(this.componentInfoObjects.isCompositeComponent({componentType:u.componentType,includeNonStandard:e}))if(i.push(u.componentName),u.isExpanded||(u.state.readyToExpandWhenResolved.isResolved?o.push(u.componentName):l.push(u.componentName)),u.isExpanded){let c=u.replacements;!n&&u.replacementsToWithhold>0&&(c=c.slice(0,-u.replacementsToWithhold));let p=this.recursivelyReplaceCompositesWithReplacements({replacements:c,recurseNonStandardComposites:e,forceExpandComposites:r,includeWithheldReplacements:n});i.push(...p.compositesFound),s.push(...p.newReplacements),o.push(...p.unexpandedCompositesReady),l.push(...p.unexpandedCompositesNotReady)}else s.push(u);else s.push(u);return{compositesFound:i,newReplacements:s,unexpandedCompositesReady:o,unexpandedCompositesNotReady:l}}async getStateVariableValue({component:t,stateVariable:e,justUpdatedForNewComponent:r=!1}){let n=t.state[e];if(!n)throw Error(`Can't get value of ${e} of ${t.componentName} as it doesn't exist.`);let i=n.additionalStateVariablesDefined,s=[e];i&&s.push(...i);for(let m of s)if(!t.state[m].isResolved&&!(await this.dependencies.resolveItem({componentName:t.componentName,type:"stateVariable",stateVariable:m,force:!0})).success)throw Error(`Can't get value of ${e} of ${t.componentName} as ${m} couldn't be resolved.`);let o=await this.getStateVariableDefinitionArguments({component:t,stateVariable:e});o.componentInfoObjects=this.componentInfoObjects,o.justUpdatedForNewComponent=r,o.freshnessInfo=n.freshnessInfo;let l=o.arraySize,u;if(Object.keys(o.changes).length===0&&n._previousValue!==void 0&&!n.forceRecalculation){let m=[e];i&&m.push(...i),u={noChanges:m},n.freshenOnNoChanges&&n.freshenOnNoChanges(o)}else delete n.forceRecalculation,u=n.definition(o);let c={[e]:!1},p={};if(i)for(let m of i)c[m]=!1;for(let m in u.setValue){if(!(m in t.state))throw Error(`Definition of state variable ${e} of ${t.componentName} returned value of ${m}, which isn't a state variable.`);let f;if(m in c)c[m]=!0,t.state[m].isArray?p[m]||(p[m]={arrayKeysChanged:{}}):p[m]=!0;else{if(t.state[m].isArray&&t.state[m].arrayEntryNames){for(let d of t.state[m].arrayEntryNames)if(d in c){f=d,c[d]=!0,p[d]=!0;break}}if(!f)throw Error(`Attempting to set value of stateVariable ${m} in definition of ${e} of ${t.componentName}, but it's not listed as an additional state variable defined.`)}if(!t.state[m].isResolved&&(!f||!t.state[f].isResolved))throw Error(`Attempting to set value of stateVariable ${m} of ${t.componentName} while it is still unresolved!`);if(t.state[m].isArray){p[m]||(p[m]={arrayKeysChanged:{}});let d={};u.checkForActualChange&&u.checkForActualChange[m]&&(d=u.checkForActualChange[m]);for(let h in u.setValue[m])if(d[h]){let y=t.state[m].getArrayValue({arrayKey:h}),b=u.setValue[m][h];y!==b&&(t.state[m].setArrayValue({value:u.setValue[m][h],arrayKey:h,arraySize:l}),t.state[m].usedDefaultByArrayKey[h]=!1,p[m].arrayKeysChanged[h]=!0)}else t.state[m].setArrayValue({value:u.setValue[m][h],arrayKey:h,arraySize:l}),t.state[m].usedDefaultByArrayKey[h]=!1,p[m].arrayKeysChanged[h]=!0}else if(delete t.state[m].value,t.state[m].value=u.setValue[m],delete t.state[m].usedDefault,u.checkForActualChange?.[m]){let d=t.state[m].value,h=t.state[m]._previousValue;(d===h||Array.isArray(d)&&Array.isArray(h)&&d.length===h.length&&d.every((y,b)=>y===h[b]))&&delete p[m]}}for(let m in u.useEssentialOrDefaultValue){if(!(m in t.state))throw Error(`Definition of state variable ${e} of ${t.componentName} requested essential or default value of ${m}, which isn't a state variable.`);if(!t.state[m].hasEssential)throw Error(`Definition of state variable ${e} of ${t.componentName} requested essential or default value of ${m}, but hasEssential is not set.`);let f;if(m in c)c[m]=!0,t.state[m].isArray?p[m]||(p[m]={arrayKeysChanged:{}}):p[m]=!0;else{if(t.state[m].isArray&&t.state[m].arrayEntryNames){for(let y of t.state[m].arrayEntryNames)if(y in c){f=y,c[y]=!0,p[y]=!0;break}}if(!f)throw Error(`Attempting to set value of stateVariable ${m} in definition of ${e} of ${t.componentName}, but it's not listed as an additional state variable defined.`)}if(!t.state[m].isResolved&&(!f||!t.state[f].isResolved))throw Error(`Attempting to set value of stateVariable ${m} of ${t.componentName} while it is still unresolved!`);let d=m;t.state[m].essentialVarName&&(d=t.state[m].essentialVarName);let h=t.essentialState[d];if(t.state[m].isArray){p[m]||(p[m]={arrayKeysChanged:{}});let y={};u.checkForActualChange&&u.checkForActualChange[m]&&(y=u.checkForActualChange[m]);for(let b in u.useEssentialOrDefaultValue[m]){let g;y[b]&&(g=t.state[m].getArrayValue({arrayKey:b}));let v;if(Array.isArray(h)?v=t.state[m].getArrayValue({arrayKey:b,arrayValues:h}):h=t.essentialState[d]=[],v!==void 0)t.state[m].setArrayValue({value:v,arrayKey:b,arraySize:l});else{let A=u.useEssentialOrDefaultValue[m][b].defaultValue;if(A!==void 0)t.state[m].setArrayValue({value:A,arrayKey:b,arraySize:l}),t.state[m].usedDefaultByArrayKey[b]=!0;else if(t.state[m].defaultValueByArrayKey?.(b)!==void 0)t.state[m].setArrayValue({value:t.state[m].defaultValueByArrayKey(b),arrayKey:b,arraySize:l}),t.state[m].usedDefaultByArrayKey[b]=!0;else throw Error(`Neither value nor default value specified; state variable: ${m}, component: ${t.componentName}, arrayKey: ${b}.`)}y[b]?t.state[m].getArrayValue({arrayKey:b})!==g&&(p[m].arrayKeysChanged[b]=!0):p[m].arrayKeysChanged[b]=!0}}else{if(h!==void 0)delete t.state[m].value,t.state[m].value=h;else{let y=u.useEssentialOrDefaultValue[m].defaultValue;if(y!==void 0)delete t.state[m].value,t.state[m].value=y,t.state[m].usedDefault=!0;else if(t.state[m].defaultValue!==void 0)delete t.state[m].value,t.state[m].value=t.state[m].defaultValue,t.state[m].usedDefault=!0;else throw Error(`Neither value nor default value specified; state variable: ${m}, component: ${t.componentName}.`)}if(u.checkForActualChange?.[m]){let y=t.state[m].value,b=t.state[m]._previousValue;(y===b||Array.isArray(y)&&Array.isArray(b)&&y.length===b.length&&y.every((g,v)=>g===b[v]))&&delete p[m]}}}for(let m in u.markAsUsedDefault){if(!t.state[m].isResolved)throw Error(`Marking state variable as used default when it isn't yet resolved: ${m} of ${t.componentName}`);if(!(m in c)){let f;if(t.state[m].isArray&&t.state[m].arrayEntryNames){for(let d of t.state[m].arrayEntryNames)if(d in c){f=d;break}}if(!f)throw Error(`Marking state variable  ${m} as used default in definition of ${e} of ${t.componentName}, but it's not listed as an additional state variable defined.`)}if(Array.isArray())for(let f in u.markAsUsedDefault[m])u.markAsUsedDefault[m][f]&&(t.state[m].usedDefaultByArrayKey[f]=!0);else u.markAsUsedDefault[m]&&(t.state[m].usedDefault=!0)}if(u.noChanges)for(let m of u.noChanges){if(!t.state[m].isResolved)throw Error(`Claiming state variable is unchanged when it isn't yet resolved: ${m} of ${t.componentName}`);if(!(m in c)){let f;if(t.state[m].isArray&&t.state[m].arrayEntryNames){for(let d of t.state[m].arrayEntryNames)if(d in c){f=d;break}}if(!f)throw Error(`Claiming stateVariable ${m} is unchanged in definition of ${e} of ${t.componentName}, but it's not listed as an additional state variable defined.`)}c[m]=!0,(Object.getOwnPropertyDescriptor(t.state[m],"value").get||t.state[m].immutable)&&(delete t.state[m].value,t.state[m].value=t.state[m]._previousValue)}for(let m in u.setEssentialValue){if(!(m in t.state))throw Error(`Definition of state variable ${e} of ${t.componentName} tried to make ${m} essential, which isn't a state variable.`);if(!(m in c)){let d;if(t.state[m].isArray&&t.state[m].arrayEntryNames){for(let h of t.state[m].arrayEntryNames)if(h in c){d=h;break}}if(!d)throw Error(`Attempting to set essential value of stateVariable ${m} in definition of ${e} of ${t.componentName}, but it's not listed as an additional state variable defined.`)}if(!t.state[m].hasEssential)throw Error(`Attempting to set the essential value of stateVariable ${m} in definition of ${e} of ${t.componentName}, but it does not have an essential value`);if(!(t.state[m].shadowVariable||t.state[m].doNotShadowEssential))throw Error(`Attempting to set the essential value of stateVariable ${m} in definition of ${e} of ${t.componentName}, but it is not allowed unless the state variable is shadowed or the essential state is not shadowed.`);this.essentialValuesSavedInDefinition[t.componentName]||(this.essentialValuesSavedInDefinition[t.componentName]={});let f=m;if(t.state[m].essentialVarName&&(f=t.state[m].essentialVarName),t.state[m].isArray){let d=t.essentialState[f];Array.isArray(d)||(d=t.essentialState[f]=[]),this.essentialValuesSavedInDefinition[t.componentName][m]||(this.essentialValuesSavedInDefinition[t.componentName][m]={mergeObject:!0});for(let h in u.setEssentialValue[m])t.state[m].setArrayValue({value:u.setEssentialValue[m][h],arrayKey:h,arraySize:l,arrayValues:d}),this.essentialValuesSavedInDefinition[t.componentName][m][h]=u.setEssentialValue[m][h]}else t.essentialState[f]=u.setEssentialValue[m],this.essentialValuesSavedInDefinition[t.componentName][m]=u.setEssentialValue[m]}if(u.setComponentType)for(let m in u.setComponentType){if(!t.state[m].hasVariableComponentType)throw Error(`Cannot set type of ${m} of ${t.componentName} as it it does not have the hasVariableComponentType attribute.`);let f=!1,d=t.state[m].componentType,h=u.setComponentType[m];if(Array.isArray(d)?Array.isArray(h)?(d.length!==h.length||d.some((y,b)=>y!=h[b]))&&(f=!0):f=!0:Array.isArray(h)?f=!0:f=d!==h,f&&(p[m]=!0),t.state[m].componentType=u.setComponentType[m],t.state[m].isArray&&t.state[m].arrayEntryNames){let y=u.setComponentType[m],b=Array.isArray(y);for(let g of t.state[m].arrayEntryNames)if(b){let v=await t.state[g].arrayKeys,A=[];for(let C of v){let S=t.state[m].keyToIndex(C);A.push(y[S])}t.state[g].componentType=A}else t.state[g].componentType=y}}if(u.arraySizeChanged)for(let m of u.arraySizeChanged)await t.state[m].adjustArrayToNewArraySize(),p[m]===void 0?p[m]={arrayKeysChanged:{}}:p[m]===!0&&(p[m]={allArrayKeysChanged:!0,arrayKeysChanged:{}}),p[m].arraySizeChanged=!0;for(let m in c){if(!(c[m]||t.state[m].isArrayEntry||t.state[m].isArray))throw Error(`definition of ${e} of ${t.componentName} didn't return value of ${m}`);t.state[m].isArray?(delete t.state[m].value,t.state[m].value=t.state[m].arrayValues):t.state[m].isArrayEntry&&(delete t.state[m].value,t.state[m].value=await t.state[m].getValueFromArrayValues())}for(let m in p)if(this.dependencies.recordActualChangeInUpstreamDependencies({component:t,varName:m,changes:p[m]}),t.state[m].isArray){let f=[];if(p[m]===!0||p[m].allArrayKeysChanged||p.arraySizeChanged)t.state[m].arrayEntryNames&&(f=t.state[m].arrayEntryNames);else{let d=t.state[m].varNamesIncludingArrayKeys;for(let h in p[m].arrayKeysChanged){let y=d[h];y&&f.push(...y)}}f=[...new Set(f)];for(let d of f)this.dependencies.recordActualChangeInUpstreamDependencies({component:t,varName:d})}return await n.value}async getStateVariableDefinitionArguments({component:t,stateVariable:e,excludeDependencyValues:r}){let n;r?n={}:n=await this.dependencies.getStateVariableDependencyValues({component:t,stateVariable:e}),n.componentName=t.componentName;let i=t.state[e];if(i.isArrayEntry?(n.arrayKeys=await i.arrayKeys,n.arraySize=await i.arraySize):i.isArray&&(n.arraySize=await i.arraySize),i.createWorkspace&&(n.workspace=i.workspace),i.providePreviousValuesInDefinition||i.provideEssentialValuesInDefinition){let s=[e];if(i.additionalStateVariablesDefined&&s.push(...i.additionalStateVariablesDefined),i.providePreviousValuesInDefinition){let o={};for(let l of s)t.state[l].isArrayEntry&&(l=t.state[l].arrayStateVariable),o[l]=t.state[l]._previousValue;n.previousValues=o}if(i.provideEssentialValuesInDefinition){let o={};for(let l of s){t.state[l].isArrayEntry&&(l=t.state[l].arrayStateVariable);let u=l;t.state[l].essentialVarName&&(u=t.state[l].essentialVarName),o[l]=t.essentialState[u]}n.essentialValues=o}}return n}async recordActualChangeInStateVariable({componentName:t,varName:e}){let r=this._components[t];await this.markStateVariableAndUpstreamDependentsStale({component:r,varName:e});let n=[e];r.state[e].additionalStateVariablesDefined&&n.push(...r.state[e].additionalStateVariablesDefined);for(let i of n)r.state[i].forceRecalculation=!0,this.dependencies.recordActualChangeInUpstreamDependencies({component:r,varName:i})}findCaseInsensitiveMatches({stateVariables:t,componentClass:e}){let r=this.componentInfoObjects.stateVariableInfo[e.componentType],n=[];for(let i of t){let s=!1,o=i.toLowerCase();for(let p in r.stateVariableDescriptions)if(o===p.toLowerCase()){s=!0,n.push(p);break}if(s)continue;let l=!1,u=o;o.substring(0,13)==="__array_size_"&&(l=!0,u=o.substring(13));for(let p in r.aliases)if(u===p.toLowerCase()){l&&(p="__array_size_"+p),n.push(p),s=!0;break}if(s)continue;let c=Object.keys(r.arrayEntryPrefixes).sort((p,m)=>m.length-p.length);for(let p of c)if(o.substring(0,p.length)===p.toLowerCase()){let m=r.arrayEntryPrefixes[p].arrayVariableName,f=r.stateVariableDescriptions[m];if(f.getArrayKeysFromVarName({arrayEntryPrefix:p,varEnding:i.substring(p.length),nDimensions:f.nDimensions}).length>0){let h=p+o.substring(p.length);s=!0,n.push(h);break}}s||n.push(i)}return n}matchPublicStateVariables({stateVariables:t,componentClass:e}){let r=this.componentInfoObjects.publicStateVariableInfo[e.componentType],n=[];for(let i of t){if(i in r.stateVariableDescriptions){n.push(i);continue}let s=i;if(s in r.aliases&&(s=r.aliases[s],s in r.stateVariableDescriptions)){n.push(s);continue}let o=!1,l=Object.keys(r.arrayEntryPrefixes).sort((u,c)=>c.length-u.length);for(let u of l)if(s.substring(0,u.length)===u){let c=r.arrayEntryPrefixes[u].arrayVariableName,p=r.stateVariableDescriptions[c];if(p.getArrayKeysFromVarName({arrayEntryPrefix:u,varEnding:s.substring(u.length),nDimensions:p.nDimensions}).length>0){o=!0;break}}o?n.push(i):n.push("__not_public_"+i)}return n}substituteAliases({stateVariables:t,componentClass:e}){let r=[],n=this.componentInfoObjects.stateVariableInfo[e.componentType];for(let i of t){let s=!1;i.substring(0,13)==="__array_size_"&&(s=!0,i=i.substring(13)),i=i in n.aliases?n.aliases[i]:i,s&&(i="__array_size_"+i),r.push(i)}return r}publicCaseInsensitiveAliasSubstitutions({stateVariables:t,componentClass:e}){let r=this.findCaseInsensitiveMatches({stateVariables:t,componentClass:e});return r=this.matchPublicStateVariables({stateVariables:r,componentClass:e}),r=this.substituteAliases({stateVariables:r,componentClass:e}),r}checkIfArrayEntry({stateVariable:t,component:e}){for(let r in e.arrayEntryPrefixes)if(t.substring(0,r.length)===r){let n=e.arrayEntryPrefixes[r],i=e.state[n];if(i.getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:t.substring(r.length),nDimensions:i.nDimensions}).length>0)return!0}return!1}async createFromArrayEntry({stateVariable:t,component:e,initializeOnly:r=!1}){if(!e.arrayEntryPrefixes)throw Error(`Unknown state variable ${t} of ${e.componentName}`);let n=Object.keys(e.arrayEntryPrefixes).sort((i,s)=>s.length-i.length);for(let i of n)if(t.substring(0,i.length)===i){let s=e.arrayEntryPrefixes[i],o=e.state[s];if(o.getArrayKeysFromVarName({arrayEntryPrefix:i,varEnding:t.substring(i.length),nDimensions:o.nDimensions}).length>0){let u=e.arrayEntryPrefixes[i];if(await this.initializeStateVariable({component:e,stateVariable:t,arrayStateVariable:u,arrayEntryPrefix:i}),r)return;let c=[t];if(e.state[t].additionalStateVariablesDefined){c.push(...e.state[t].additionalStateVariablesDefined);for(let m of e.state[t].additionalStateVariablesDefined)e.state[m]||await this.createFromArrayEntry({stateVariable:m,component:e,initializeOnly:!0})}await this.dependencies.setUpStateVariableDependencies({component:e,stateVariable:t,allStateVariablesAffected:c,core:this});let p=[];for(let m of c)this.dependencies.checkForCircularDependency({componentName:e.componentName,varName:m}),p.push(m),e.state[m].determineDependenciesStateVariable&&p.push(e.state[m].determineDependenciesStateVariable);await this.dependencies.resolveStateVariablesIfReady({component:e,stateVariables:p});return}}throw Error(`Unknown state variable ${t} of ${e.componentName}`)}async markStateVariableAndUpstreamDependentsStale({component:t,varName:e}){e in this.rendererVariablesByComponentType[t.componentType]&&this.updateInfo.componentsToUpdateRenderers.push(t.componentName);let r={[e]:t.state[e]};t.state[e].additionalStateVariablesDefined&&t.state[e].additionalStateVariablesDefined.forEach(p=>r[p]=t.state[p]);let n=await this.lookUpCurrentFreshness({component:t,varName:e,allStateVariablesAffectedObj:r}),i=[],s=[],o=0;for(let p in r){let m=r[p];Object.getOwnPropertyDescriptor(m,"value").get||m.immutable?n&&(n.fresh&&n.fresh[p]?s.push(p):n.partiallyFresh&&n.partiallyFresh[p]&&(o+=n.partiallyFresh[p])):i.push(p)}s.push(...i);let l=s.length>0||o>0,u={};for(let p in r)u[p]=!0;let c=!1;if(l){let p=await this.processMarkStale({component:t,varName:e,allStateVariablesAffectedObj:r});if(p.fresh)for(let f in p.fresh)p.fresh[f]&&delete u[f];let m=0;for(let f in r){if(s.includes(f)&&!(p.fresh&&p.fresh[f])){c=!0;break}p.partiallyFresh&&p.partiallyFresh[f]&&(m+=p.partiallyFresh[f])}if(m<o&&(c=!0),p.updateReplacements&&this.updateInfo.compositesToUpdateReplacements.push(t.componentName),p.updateParentRenderedChildren){for(let f of t.ancestors)if(!this.componentInfoObjects.allComponentClasses._composite.isPrototypeOf(f.componentCase)){f.componentClass.renderChildren&&this.componentsWithChangedChildrenToRender.add(f.componentName);break}}if(p.updateRenderedChildren&&this.componentsWithChangedChildrenToRender.add(t.componentName),p.updateActionChaining){let f=this.updateInfo.componentsToUpdateActionChaining[t.componentName];f||(f=this.updateInfo.componentsToUpdateActionChaining[t.componentName]=[]);for(let d in r)f.includes(d)||f.push(d)}if(p.updateDependencies)for(let f of p.updateDependencies)t.state[f].needDependenciesUpdated=!0}for(let p in u){let m=r[p];if(delete m.recursiveDependencyValues,i.includes(p)){m._previousValue=await m.value,delete m.value;let f=this.getStateVariableValue;Object.defineProperty(m,"value",{get:()=>f({component:t,stateVariable:p}),configurable:!0})}}if(c)for(let p in u)await this.markUpstreamDependentsStale({component:t,varName:p})}async lookUpCurrentFreshness({component:t,varName:e,allStateVariablesAffectedObj:r}){let n=t.state[e];if(!n.getCurrentFreshness)return;let i=n.freshnessInfo,s,o;if(n.isArrayEntry&&(s=n._arrayKeys),n.isArrayEntry||n.isArray){let u=t.state[n.arraySizeStateVariable];o=u._previousValue,!(Object.getOwnPropertyDescriptor(u,"value").get||u.immutable)&&(o=await u.value),Array.isArray(o)||(o=[])}let l=n.getCurrentFreshness({freshnessInfo:i,arrayKeys:s,arraySize:o});if(l.partiallyFresh){for(let u in r)if(r[u].isArrayEntry){let c=r[u].arrayStateVariable;l.partiallyFresh[u]=l.partiallyFresh[c],delete l.partiallyFresh[c]}}if(l.fresh){for(let u in r)if(r[u].isArrayEntry){let c=r[u].arrayStateVariable;c in l.fresh&&(l.fresh[u]=l.fresh[c],delete l.fresh[c])}}return l}async processMarkStale({component:t,varName:e,allStateVariablesAffectedObj:r}){let n=t.state[e];if(!n.markStale||!n.initiallyResolved){let p={};return Object.keys(r).forEach(m=>p[m]=!1),{fresh:p}}let i={},s=this.dependencies.downstreamDependencies[t.componentName][e];for(let p in s){let m=s[p],f={},d=!1;m.componentIdentityChanged&&(f.componentIdentityChanged=!0,d=!0),m.componentIdentitiesChanged&&(f.componentIdentitiesChanged=!0,d=!0),m.valuesChanged&&(f.valuesChanged=m.valuesChanged,d=!0),d&&(i[p]=f)}let o=n.freshnessInfo,l,u;if(n.isArrayEntry&&(l=n._arrayKeys),n.isArrayEntry||n.isArray){let p=t.state[n.arraySizeStateVariable];u=p._previousValue,!(Object.getOwnPropertyDescriptor(p,"value").get||p.immutable)&&(u=await p.value),Array.isArray(u)||(u=[])}let c=n.markStale({freshnessInfo:o,changes:i,arrayKeys:l,arraySize:u});if(c.partiallyFresh){for(let p in r)if(r[p].isArrayEntry){let m=r[p].arrayStateVariable;c.partiallyFresh[p]=c.partiallyFresh[m],delete c.partiallyFresh[m]}}if(c.fresh){for(let p in r)if(r[p].isArrayEntry){let m=r[p].arrayStateVariable;m in c.fresh&&(c.fresh[p]=c.fresh[m],delete c.fresh[m])}}return c}async markUpstreamDependentsStale({component:t,varName:e}){let r=t.componentName,n=this.getStateVariableValue,i=this.dependencies.upstreamDependencies[r][e],s;if(t.state[e]&&(s=t.state[e].freshnessInfo),i)for(let o of i){let l=!1;if(o.markStale&&await o.markStale(),o.downstreamComponentNames){let u=o.downstreamComponentNames.indexOf(r);if(u===-1)continue;if(o.mappedDownstreamVariableNamesByComponent){if(o.mappedDownstreamVariableNamesByComponent[u].indexOf(e)===-1)throw Error(`something went wrong as ${e} not a downstreamVariable of ${o.dependencyName}`);o.dependencyType==="determineDependencies"&&(o.recalculateDependencies=!0),o.valuesChanged||(o.valuesChanged=[]),o.valuesChanged[u]||(o.valuesChanged[u]={}),o.valuesChanged[u][e]||(o.valuesChanged[u][e]={}),o.valuesChanged[u][e].potentialChange=!0,s&&(o.valuesChanged[u][e].freshnessInfo=s),l=!0}else e===o.downstreamVariableNameIfNoVariables&&(o.valuesChanged||(o.valuesChanged={[o.downstreamVariableNameIfNoVariables]:{}}),o.componentIdentityChanged=!0,o.valuesChanged[o.downstreamVariableNameIfNoVariables].potentialChange=!0,l=!0)}if(l){for(let v of o.upstreamVariableNames)if(v in this.rendererVariablesByComponentType[this.components[o.upstreamComponentName].componentType]){this.updateInfo.componentsToUpdateRenderers.push(o.upstreamComponentName);break}let u=o.upstreamVariableNames[0],c=this._components[o.upstreamComponentName],p={};o.upstreamVariableNames.forEach(v=>p[v]=c.state[v]);let m=await this.lookUpCurrentFreshness({component:c,varName:u,allStateVariablesAffectedObj:p}),f=[],d=[],h=0;for(let v in p){let A=p[v];Object.getOwnPropertyDescriptor(A,"value").get||A.immutable?m&&(m.fresh&&m.fresh[v]?d.push(v):m.partiallyFresh&&m.partiallyFresh[v]&&(h+=m.partiallyFresh[v])):f.push(v)}d.push(...f);let y=d.length>0||h>0,b={};for(let v in p)b[v]=!0;let g=!1;if(y){let v=await this.processMarkStale({component:c,varName:u,allStateVariablesAffectedObj:p});if(v.fresh)for(let C in v.fresh)v.fresh[C]&&delete b[C];let A=0;for(let C in p){if(d.includes(C)&&!(v.fresh&&v.fresh[C])){g=!0;break}v.partiallyFresh&&v.partiallyFresh[C]&&(A+=v.partiallyFresh[C])}if(A<h&&(g=!0),v.updateReplacements&&this.updateInfo.compositesToUpdateReplacements.push(o.upstreamComponentName),v.updateParentRenderedChildren){for(let C of c.ancestors)if(!this.componentInfoObjects.allComponentClasses._composite.isPrototypeOf(C.componentCase)){C.componentClass.renderChildren&&this.componentsWithChangedChildrenToRender.add(C.componentName);break}}if(v.updateRenderedChildren&&this.componentsWithChangedChildrenToRender.add(t.componentName),v.updateActionChaining){let C=this.updateInfo.componentsToUpdateActionChaining[o.componentName];C||(C=this.updateInfo.componentsToUpdateActionChaining[o.componentName]=[]);for(let S in p)C.includes(S)||C.push(S)}if(v.updateDependencies)for(let C of v.updateDependencies)t.state[C].needDependenciesUpdated=!0}for(let v in b){let A=p[v];delete A.recursiveDependencyValues,f.includes(v)&&(A._previousValue=await A.value,delete A.value,Object.defineProperty(A,"value",{get:()=>n({component:c,stateVariable:v}),configurable:!0}))}if(g)for(let v in b)await this.markUpstreamDependentsStale({component:c,varName:v})}}}registerComponent(t){if(t.componentName in this._components)throw Error(`Duplicate componentName: ${t.componentName}`);this._components[t.componentName]=t}deregisterComponent(t,e=!0){if(e===!0)for(let r in t.allChildren)this.deregisterComponent(t.allChildren[r].component);delete this._components[t.componentName]}setAncestors(t,e=[]){t.ancestors=e;let r=[{componentName:t.componentName,componentClass:t.constructor},...t.ancestors];for(let n in t.allChildren){let i=this._components[n];this.setAncestors(i,r)}for(let n in t.attributes){let i=t.attributes[n].component;i&&this.setAncestors(i,r)}}async addChildrenAndRecurseToShadows({parent:t,indexOfDefiningChildren:e,newChildren:r,assignNamesOffset:n}){this.spliceChildren(t,e,r);let i=await this.processNewDefiningChildren({parent:t}),s={},o={};if(!i.success)return i;for(let l of r)typeof l=="object"&&(s[l.componentName]=l);if(t.shadowedBy)for(let l of t.shadowedBy){if(l.shadows.propVariable)continue;let u=[];for(let b of r)u.push(await b.serialize());u=_r({serializedComponents:u,componentName:l.shadows.compositeName});let c=l.attributes.newNamespace&&l.attributes.newNamespace.primitive,p=c;u=de({indOffset:n,serializedComponents:u,parentName:l.componentName,parentCreatesNewNamespace:c,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:p}).serializedComponents;let f=this._components[l.componentName];this.parameterStack.push(f.sharedParameters,!1);let d;c?d=l.componentName+"/":d=mo(l.componentName);let h=await this.createIsolatedComponentsSub({serializedComponents:u,ancestors:l.ancestors,createNameContext:l.componentName+"|addChildren|"+n,namespaceForUnamed:d});this.parameterStack.pop();let y=await this.addChildrenAndRecurseToShadows({parent:f,indexOfDefiningChildren:e,newChildren:h.components,assignNamesOffset:n});if(!y.success)throw Error("was able to add components to parent but not shadows!");Object.assign(s,y.addedComponents)}return{success:!0,deletedComponents:o,addedComponents:s}}async processNewDefiningChildren({parent:t,expandComposites:e=!0}){this.parameterStack.push(t.sharedParameters,!1);let r=await this.deriveChildResultsFromDefiningChildren({parent:t,expandComposites:e});this.parameterStack.pop();let n=[{componentName:t.componentName,componentClass:t.constructor},...t.ancestors];for(let i in t.allChildren){let s=this._components[i];this.setAncestors(s,n)}return r}spliceChildren(t,e,r){let n=t.definingChildren.length;if(!Number.isInteger(e)||e>n||e<0)throw Error("Can't add children at index "+e+". Invalid index.");t.definingChildren.splice(e,0,...r)}async deleteComponents({components:t,deleteUpstreamDependencies:e=!0,skipProcessingChildrenOfParents:r=[]}){Array.isArray(t)||(t=[t]);let n={};this.determineComponentsToDelete({components:t,deleteUpstreamDependencies:e,componentsToDelete:n});let i={};for(let l in n){let u=n[l],c=this.components[u.parentName];if(c===void 0||c.componentName in n)continue;let p=i[u.parentName];p===void 0&&(p={parent:this._components[u.parentName],childNamesToBeDeleted:new Set},i[u.parentName]=p),p.childNamesToBeDeleted.add(l)}let s=[];for(let l in n){let u=this._components[l];if(u.replacementOf){let c=u.replacementOf,m=c.replacements.map(f=>f.componentName).indexOf(l);m!==-1&&(c.replacements.splice(m,1),s.includes(c.componentName)||s.push(c.componentName))}}for(let l of s)l in n||await this.dependencies.addBlockersFromChangedReplacements(this._components[l]);let o=[];for(let l in i){let u=i[l],c=u.parent;o.push(c);for(let p=c.definingChildren.length-1;p>=0;p--){let m=c.definingChildren[p];u.childNamesToBeDeleted.has(m.componentName)&&c.definingChildren.splice(p,1)}r.includes(c.componentName)||await this.processNewDefiningChildren({parent:c,expandComposites:!1})}for(let l in n){let u=this._components[l];if(u.shadows){let c=this._components[u.shadows.componentName];c.shadowedBy.length===1?delete c.shadowedBy:c.shadowedBy.splice(c.shadowedBy.indexOf(u),1)}this.dependencies.deleteAllDownstreamDependencies({component:u});for(let c in this.dependencies.upstreamDependencies[u.componentName]){let p=this.dependencies.upstreamDependencies[u.componentName][c];for(let m of p)if(m.specifiedComponentName&&m.specifiedComponentName in n){let f=this.dependencies.updateTriggers.dependenciesMissingComponentBySpecifiedName[m.specifiedComponentName];f||(f=this.dependencies.updateTriggers.dependenciesMissingComponentBySpecifiedName[m.specifiedComponentName]=[]),f.includes(m)||f.push(m)}}await this.dependencies.deleteAllUpstreamDependencies({component:u}),this.updateInfo.deletedStateVariables[u.componentName]||(this.updateInfo.deletedStateVariables[u.componentName]=[]),this.updateInfo.deletedStateVariables[u.componentName].push(...Object.keys(u.state)),this.updateInfo.deletedComponents[u.componentName]=!0,delete this.unmatchedChildren[u.componentName],delete this.stateVariableChangeTriggers[u.componentName]}for(let l in n){let u=this._components[l];this.deregisterComponent(u,!1)}return this.updateInfo.componentsToUpdateRenderers=[...new Set(this.updateInfo.componentsToUpdateRenderers)].filter(l=>!(l in n)),this.updateInfo.compositesToUpdateReplacements=[...new Set(this.updateInfo.compositesToUpdateReplacements)].filter(l=>!(l in n)),{success:!0,deletedComponents:n,parentsOfDeleted:o}}determineComponentsToDelete({components:t,deleteUpstreamDependencies:e,componentsToDelete:r}){for(let n of t){if(typeof n!="object"||n.componentName in r)continue;r[n.componentName]=this._components[n.componentName];let i=Object.values(n.allChildren).map(s=>s.component);for(let s in n.attributes){let o=n.attributes[s].component;o&&i.push(o)}n.adaptedFrom!==void 0&&i.push(n.adaptedFrom),e===!0&&(n.shadowedBy&&i.push(...n.shadowedBy),n.adapterUsed&&i.push(n.adapterUsed),n.replacements&&i.push(...n.replacements)),this.determineComponentsToDelete({components:i,deleteUpstreamDependencies:e,componentsToDelete:r})}}async updateCompositeReplacements({component:t,componentChanges:e,sourceOfUpdate:r}){let n={},i={},s=new Set;if(t.shadows)return{success:!0,deletedComponents:n,addedComponents:i,parentsOfDeleted:s};let o=this.components[t.componentName];t.replacements||(t.replacements=[]),await t.stateValues.readyToExpandWhenResolved;let l=await t.constructor.calculateReplacementChanges({component:o,componentChanges:e,components:this.components,workspace:t.replacementsWorkspace,componentInfoObjects:this.componentInfoObjects,flags:this.flags,resolveItem:this.dependencies.resolveItem.bind(this.dependencies),publicCaseInsensitiveAliasSubstitutions:this.publicCaseInsensitiveAliasSubstitutions.bind(this)});t.constructor.stateVariableToEvaluateAfterReplacements&&await t.stateValues[t.constructor.stateVariableToEvaluateAfterReplacements];for(let c of l)if(c.changeType==="add"){c.replacementsToWithhold!==void 0&&await this.adjustReplacementsToWithhold({component:t,change:c,componentChanges:e});let p=this._components[t.componentName];this.parameterStack.push(p.sharedParameters,!1);let m,f={[t.componentName]:Xd(t)},d=c.numberReplacementsToReplace,h=c.firstReplacementInd;if(d>0&&c.changeTopLevelReplacements&&await this.deleteReplacementsFromShadowsThenComposite({change:c,composite:t,componentChanges:e,sourceOfUpdate:r,parentsOfDeleted:s,deletedComponents:n,addedComponents:i,processNewChildren:!1}),c.serializedReplacements){let b=c.serializedReplacements,g;t.attributes.newNamespace&&t.attributes.newNamespace.primitive?g=t.componentName+"/":g=mo(t.componentName),m=(await this.createIsolatedComponentsSub({serializedComponents:b,ancestors:t.ancestors,createNameContext:t.componentName+"|replacements",namespaceForUnamed:g,componentsReplacementOf:t})).components}else throw Error("Invalid replacement change.");this.parameterStack.pop();let y={[t.componentName]:{newComponents:m,parent:c.parent}};if(p.shadowedBy&&f[p.componentName].length>0){let b=await this.createShadowedReplacements({replacementsToShadow:m,componentToShadow:p,parentToShadow:c.parent,currentShadowedBy:f,assignNamesOffset:c.assignNamesOffset,componentChanges:e,sourceOfUpdate:r,parentsOfDeleted:s,deletedComponents:n,addedComponents:i});Object.assign(y,b)}for(let b in y){let g=this._components[b];if(!g)continue;let v=y[b].newComponents;if(!g.isExpanded){await this.expandCompositeComponent(g);let A={changeType:"addedReplacements",composite:g,newReplacements:g.replacements,topLevel:!0,firstIndex:0,numberDeleted:0};e.push(A);continue}for(let A of v)typeof A=="object"&&(i[A.componentName]=A);if(c.changeTopLevelReplacements===!0){let A=this._components[g.parentName];g.replacements.splice(h,0,...v),await this.dependencies.addBlockersFromChangedReplacements(g);let C={changeType:"addedReplacements",composite:g,newReplacements:v,topLevel:!0,firstIndex:h,numberDeleted:d};e.push(C),await this.processNewDefiningChildren({parent:A,expandComposites:!1});let S=await this.componentAndRenderedDescendants(A);this.updateInfo.componentsToUpdateRenderers.push(...S)}else{let A=this._components[y[b].parent.componentName];this.spliceChildren(A,c.indexOfDefiningChildren,v),await this.processNewDefiningChildren({parent:A});for(let w of v)typeof w=="object"&&(i[w.componentName]=w);let C=await this.componentAndRenderedDescendants(A);this.updateInfo.componentsToUpdateRenderers.push(...C);let S={changeType:"addedReplacements",composite:g,newReplacements:v};e.push(S)}}}else if(c.changeType==="delete")c.replacementsToWithhold!==void 0&&await this.adjustReplacementsToWithhold({component:t,change:c,componentChanges:e}),await this.deleteReplacementsFromShadowsThenComposite({change:c,composite:t,componentsToDelete:c.components,componentChanges:e,sourceOfUpdate:r,parentsOfDeleted:s,deletedComponents:n,addedComponents:i});else{if(c.changeType==="moveDependency")throw Error("moveDependency not implemented");if(c.changeType==="addDependency")throw Error("addDependency not implemented");if(c.changeType==="updateStateVariables"){let p={},m={};for(let f in c.stateChanges){let d={componentName:c.component.componentName,stateVariable:f,value:c.stateChanges[f],overrideFixed:!0};await this.requestComponentChanges({instruction:d,initialChange:!1,workspace:p,newStateVariableValues:m})}await this.processNewStateVariableValues(m)}else if(c.changeType==="changeReplacementsToWithhold"){if(c.replacementsToWithhold!==void 0){let p=await this.adjustReplacementsToWithhold({component:t,change:c,componentChanges:e})}await this.processChildChangesAndRecurseToShadows(t)}}return{success:!0,deletedComponents:n,addedComponents:i,parentsOfDeleted:s}}async deleteReplacementsFromShadowsThenComposite({change:t,composite:e,componentsToDelete:r,componentChanges:n,sourceOfUpdate:i,parentsOfDeleted:s,deletedComponents:o,addedComponents:l,processNewChildren:u=!0}){let c=[];if(!e.isExpanded)return c;if(e.shadowedBy)for(let p of e.shadowedBy){if(p.shadows.propVariable)continue;let m;if(r){m=[];for(let d of r){let h;if(d.shadowedBy){for(let y of d.shadowedBy)if(!y.shadows.propVariable&&y.shadows.compositeName===p.shadows.compositeName){h=y;break}}h?m.push(h):console.error(`could not find shadowing component of ${d.componentName}`)}}let f=await this.deleteReplacementsFromShadowsThenComposite({change:t,composite:p,componentsToDelete:m,componentChanges:n,sourceOfUpdate:i,parentsOfDeleted:s,deletedComponents:o,addedComponents:l,processNewChildren:u});c.push(...f)}if(t.changeTopLevelReplacements){let p=t.firstReplacementInd,m=t.numberReplacementsToDelete;t.changeType==="add"&&(m=t.numberReplacementsToReplace);let f=e.replacements.splice(p,m);await this.dependencies.addBlockersFromChangedReplacements(e);let d=await this.deleteComponents({components:f,componentChanges:n,sourceOfUpdate:i,skipProcessingChildrenOfParents:[e.parentName]});if(u&&await this.processNewDefiningChildren({parent:this._components[e.parentName],expandComposites:!1}),d.success===!1)throw Error("Couldn't delete components on composite update");for(let v of d.parentsOfDeleted){s.add(v.componentName);let A=await this.componentAndRenderedDescendants(v);this.updateInfo.componentsToUpdateRenderers.push(...A)}let h={};for(let v in d.deletedComponents){let C=d.deletedComponents[v].parentName;h[C]===void 0&&(h[C]=[]),h[C].push(v)}let y={changeType:"deletedReplacements",composite:e,topLevel:!0,firstIndex:p,numberDeleted:m,deletedNamesByParent:h,deletedComponents:d.deletedComponents};n.push(y),Object.assign(o,d.deletedComponents);let b=this._components[e.parentName],g=await this.componentAndRenderedDescendants(b);this.updateInfo.componentsToUpdateRenderers.push(...g)}else{let p=r.length,m=await this.deleteComponents({components:r,deleteUpstreamDependencies:!1,componentChanges:n,sourceOfUpdate:i});if(m.success===!1)throw Error("Couldn't delete components prescribed by composite");for(let h of m.parentsOfDeleted){s.add(h.componentName);let y=await this.componentAndRenderedDescendants(h);this.updateInfo.componentsToUpdateRenderers.push(...y)}let f={};for(let h in m.deletedComponents){let b=m.deletedComponents[h].parentName;f[b]===void 0&&(f[b]=[]),f[b].push(h)}let d={changeType:"deletedReplacements",composite:e,numberDeleted:p,deletedNamesByParent:f,deletedComponents:m.deletedComponents};n.push(d),Object.assign(o,m.deletedComponents),Object.assign(l,m.addedComponents)}return c}async processChildChangesAndRecurseToShadows(t){let e=this._components[t.parentName];await this.processNewDefiningChildren({parent:e,expandComposites:!1});let r=await this.componentAndRenderedDescendants(e);if(this.updateInfo.componentsToUpdateRenderers.push(...r),t.shadowedBy)for(let n of t.shadowedBy)n.shadows.propVariable||await this.processChildChangesAndRecurseToShadows(n)}async createShadowedReplacements({replacementsToShadow:t,componentToShadow:e,parentToShadow:r,currentShadowedBy:n,assignNamesOffset:i,componentChanges:s,sourceOfUpdate:o,parentsOfDeleted:l,deletedComponents:u,addedComponents:c}){let p=Xd(e);if(!n[e.componentName]||!p.every(d=>n[e.componentName].includes(d)))throw Error(`circular reference involving ${e.componentName}`);this.updateInfo.compositesBeingExpanded.push(e.componentName);let m={};for(let d of e.shadowedBy)if(!d.shadows.propVariable){if(this.updateInfo.compositesBeingExpanded.includes(d.componentName))throw Error(`circular dependence involving ${d.componentName}`);if(d.shadowedBy&&(n[d.componentName]=Xd(d)),d.isExpanded){let h=[];for(let S of t)typeof S=="object"?h.push(await S.serialize()):h.push(S);h=_r({serializedComponents:h,componentName:d.shadows.compositeName});let y=d.attributes.newNamespace?.primitive;if(d.attributes.isResponse){let S=d.constructor.createAttributesObject({flags:this.flags});for(let w of h){if(typeof w!="object")continue;w.attributes||(w.attributes={});let x=Ze({attributes:{isResponse:d.attributes.isResponse},componentType:w.componentType,componentInfoObjects:this.componentInfoObjects,compositeAttributesObj:S,compositeCreatesNewNamespace:y});Object.assign(w.attributes,x)}}if(d.constructor.assignNamesToReplacements){let S=d.constructor.originalNamesAreConsistent&&y;h=de({assignNames:d.doenetAttributes.assignNames,indOffset:i,serializedComponents:h,parentName:d.componentName,parentCreatesNewNamespace:y,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:S}).serializedComponents}else{let S=y;h=de({indOffset:i,serializedComponents:h,parentName:d.componentName,parentCreatesNewNamespace:y,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:S}).serializedComponents}let b,g=this._components[d.componentName];this.parameterStack.push(g.sharedParameters,!1);let v;y?v=d.componentName+"/":v=mo(d.componentName);let A=await this.createIsolatedComponentsSub({serializedComponents:h,ancestors:d.ancestors,createNameContext:d.componentName+"|replacements",namespaceForUnamed:v,componentsReplacementOf:d});this.parameterStack.pop(),b=A.components;let C;if(r){if(r.shadowedBy){for(let S of r.shadowedBy)if(!S.shadows.propVariable&&S.shadows.compositeName===d.shadows.compositeName){C=S;break}}C||console.error(`could not find shadowing parent of ${r.componentName}`)}if(m[d.componentName]={newComponents:b,parent:C},d.shadowedBy&&n[d.componentName].length>0){let S=await this.createShadowedReplacements({replacementsToShadow:b,componentToShadow:d,parentToShadow:C,currentShadowedBy:n,assignNamesOffset:i,componentChanges:s,sourceOfUpdate:o,parentsOfDeleted:l,deletedComponents:u,addedComponents:c});Object.assign(m,S)}}}let f=this.updateInfo.compositesBeingExpanded.indexOf(e.componentName);if(f===-1)throw Error(`Something is wrong as we lost track that we were expanding ${component.componentName}`);return this.updateInfo.compositesBeingExpanded.splice(f,1),m}async adjustReplacementsToWithhold({component:t,change:e,componentChanges:r}){let n=[],i=e.replacementsToWithhold,s;if(t.replacementsToWithhold!==void 0?s=i-t.replacementsToWithhold:s=i,s<0){n.push(t.componentName);let o=t.replacements.length-i,l=t.replacements.length-i+s,u=t.replacements.slice(l,o),c={changeType:"addedReplacements",composite:t,topLevel:!0,newReplacements:u,firstIndex:l,numberDeleted:0};r.push(c)}else if(s>0){n.push(t.componentName);let o=t.replacements.length-i,l=o+s,u=t.replacements.slice(o,l),c={};for(let m of u){let f=m.parentName;c[f]===void 0&&(c[f]=[]),c[f].push(m.componentName)}let p={changeType:"deletedReplacements",composite:t,topLevel:!0,firstIndex:o,numberDeleted:s,deletedNamesByParent:c,deletedComponents:u};r.push(p)}if(t.replacementsToWithhold=i,await this.dependencies.addBlockersFromChangedReplacements(t),t.shadowedBy)for(let o of t.shadowedBy){if(o.shadows.propVariable)continue;let l=await this.adjustReplacementsToWithhold({component:o,change:e,componentChanges:r});n.push(...l)}return n}get rendererTypesInDocument(){return this.document.allPotentialRendererTypes}get components(){return this._components}set components(t){return null}async executeProcesses(){for(;this.processQueue.length>0;){let t=this.processQueue.splice(0,1)[0],e;if(t.type==="update")(!t.skippable||this.processQueue.length<2)&&(e=await this.performUpdate(t));else if(t.type==="action")(!t.skippable||this.processQueue.length<2)&&(e=await this.performAction(t));else if(t.type==="recordEvent")e=await this.performRecordEvent(t);else throw Error(`Unrecognized process type: ${t.type}`);t.resolve(e)}this.processing=!1}requestAction({componentName:t,actionName:e,args:r,event:n}){return new Promise((i,s)=>{let o=r?.skippable;this.processQueue.push({type:"action",componentName:t,actionName:e,args:r,skippable:o,event:n,resolve:i,reject:s}),this.processing||(this.processing=!0,this.executeProcesses())})}async performAction({componentName:t,actionName:e,args:r,event:n}){let i=this.components[t];if(i&&i.actions){let s=i.actions[e];if(s)return n&&this.requestRecordEvent(n),r||(r={}),await s(r)}console.warn(`Cannot run action ${e} on component ${t}`)}resolveAction({actionId:t}){t&&postMessage({messageType:"resolveAction",args:{actionId:t}})}async triggerChainedActions({componentName:t}){for(let e in this.updateInfo.componentsToUpdateActionChaining)await this.checkForActionChaining({component:this.components[e],stateVariables:this.updateInfo.componentsToUpdateActionChaining[e]});if(this.updateInfo.componentsToUpdateActionChaining={},this.actionsChangedToActions[t])for(let e of this.actionsChangedToActions[t])await this.performAction(e)}async requestUpdate({updateInstructions:t,transient:e=!1,event:r,skippable:n=!1,overrideReadOnly:i=!1}){if(this.flags.readOnly&&!i){let s={};for(let o of t){let l=s[o.componentName];l||(l=s[o.componentName]={}),o.sourceInformation&&Object.assign(l,o.sourceInformation)}await this.updateRendererInstructions({componentNamesToUpdate:t.map(o=>o.componentName),sourceOfUpdate:{sourceInformation:s}});return}return new Promise((s,o)=>{this.processQueue.push({type:"update",updateInstructions:t,transient:e,event:r,skippable:n,resolve:s,reject:o}),this.processing||(this.processing=!0,this.executeProcesses())})}async performUpdate({updateInstructions:t,actionId:e,event:r,overrideReadOnly:n=!1}){if(this.flags.readOnly&&!n){let p={};for(let m of t){let f=p[m.componentName];f||(f=p[m.componentName]={}),m.sourceInformation&&Object.assign(f,m.sourceInformation)}await this.updateRendererInstructions({componentNamesToUpdate:t.map(m=>m.componentName),sourceOfUpdate:{sourceInformation:p},actionId:e});return}let i={},s=[],o={},l={},u=[];for(let p of t){if(p.componentName){let m=o[p.componentName];m||(m=o[p.componentName]={}),p.sourceInformation&&Object.assign(m,p.sourceInformation)}if(p.updateType==="updateValue")await this.requestComponentChanges({instruction:p,workspace:l,newStateVariableValues:i});else if(p.updateType==="addComponents")await this.addComponents({serializedComponents:p.serializedComponents,parentName:p.parentName,assignNamesOffset:p.assignNamesOffset});else if(p.updateType==="deleteComponents"){if(p.componentNames.length>0){let m=[];for(let f of p.componentNames){let d=this._components[f];d?m.push(d):console.warn(`Cannot delete ${f} as it doesn't exist.`)}m.length>0&&await this.deleteComponents({components:m})}}else p.updateType==="executeUpdate"?(await this.executeUpdateStateVariables(i),s.push(i),i={}):p.updateType==="recordItemSubmission"&&u.push(p)}await this.executeUpdateStateVariables(i),s.push(i),this.updateInfo.componentsToUpdateRenderers.push(...t.map(p=>p.componentName));let c=[...new Set(this.updateInfo.componentsToUpdateRenderers)];if(this.updateInfo.componentsToUpdateRenderers=[],await this.updateRendererInstructions({componentNamesToUpdate:c,sourceOfUpdate:{sourceInformation:o,local:!0},actionId:e}),this.updateInfo.compositesToUpdateReplacements.length>0){await this.replacementChangesFromCompositesToUpdate();let p=[...new Set(this.updateInfo.componentsToUpdateRenderers)];this.updateInfo.componentsToUpdateRenderers=[],await this.updateRendererInstructions({componentNamesToUpdate:p,sourceOfUpdate:{sourceInformation:o,local:!0},actionId:e})}if(await this.processStateVariableTriggers(),this.updateInfo.componentsToUpdateRenderers=this.updateInfo.componentsToUpdateRenderers.filter(p=>!c.includes(p)),Object.keys(this.unmatchedChildren).length>0){let p="";for(let m in this.unmatchedChildren)this._components[m].isShadow||(p+=`Invalid children for ${m}: ${this.unmatchedChildren[m].message} `);p&&console.warn(p)}if(u.length>0){let p=[...new Set(u.map(h=>h.itemNumber))];r&&(r.context||(r.context={}),r.context.subitemCreditAchieved||(r.context.subitemCreditAchieved={}),r.context.itemCreditAchieved=await this.document.stateValues.creditAchieved);let m=await this.document.stateValues.creditAchieved,f=await this.document.stateValues.itemCreditAchieved,d=[];for(let h of u)d.push({componentName:h.submittedComponent,response:h.response,responseText:h.responseText,creditAchieved:h.creditAchieved,subitemNumber:h.itemNumber});if(r)for(let h of p)r.context.subitemCreditAchieved[h]=f[h-1];this.itemNumber>0&&this.saveSubmissions({itemCreditAchieved:m,componentsSubmitted:d})}if(Object.keys(this.essentialValuesSavedInDefinition).length>0){for(let p in this.essentialValuesSavedInDefinition){let m=this._components[p]?.essentialState;if(m){this.cumulativeStateVariableChanges[p]||(this.cumulativeStateVariableChanges[p]={});for(let f in this.essentialValuesSavedInDefinition[p])if(m[f]!==void 0){let d=this.cumulativeStateVariableChanges[p][f];typeof d=="object"&&d!==null&&d.mergeObject?Object.assign(d,sa(m[f])):this.cumulativeStateVariableChanges[p][f]=sa(m[f])}}}this.essentialValuesSavedInDefinition={}}for(let p of s)for(let m in p){this.cumulativeStateVariableChanges[m]||(this.cumulativeStateVariableChanges[m]={});for(let f in p[m]){let d=this.cumulativeStateVariableChanges[m][f];typeof d=="object"&&d!==null&&d.mergeObject?Object.assign(d,sa(p[m][f])):this.cumulativeStateVariableChanges[m][f]=sa(p[m][f])}}clearTimeout(this.savePageStateTimeoutID),this.savePageStateTimeoutID=setTimeout(()=>{this.saveState()},1e3),await this.document.stateValues.itemCreditAchieved,r&&this.requestRecordEvent(r)}requestRecordEvent(t){return new Promise((e,r)=>{this.processQueue.push({type:"recordEvent",event:t,resolve:e,reject:r}),this.processing||(this.processing=!0,this.executeProcesses())})}performRecordEvent({event:t}){if(!this.flags.allowSaveEvents)return;t.timestamp=new Date().toISOString().slice(0,19).replace("T"," "),t.result||(t.result={}),t.context||(t.context={});let e={doenetId:this.doenetId,pageId:this.pageId,attemptNumber:this.attemptNumber,verb:t.verb,object:JSON.stringify(t.object,cn),result:JSON.stringify(t.result,cn),context:JSON.stringify(t.context,cn),timestamp:t.timestamp,version:"0.1.0"};return g0.post("/api/recordEvent.php",e).then(r=>{}).catch(r=>{console.error(`Error saving event: ${r.message}`)}),Promise.resolve()}async executeUpdateStateVariables(t){await this.processNewStateVariableValues(t),(await this.replacementChangesFromCompositesToUpdate()).updatedComposites&&(await this.expandAllComposites(this.document),await this.expandAllComposites(this.document,!0)),await this.replacementChangesFromCompositesToUpdate()}async replacementChangesFromCompositesToUpdate(){let t=[...new Set(this.updateInfo.compositesToUpdateReplacements)];this.updateInfo.compositesToUpdateReplacements=[];let e=[],r=0,n=!1,i=[];for(;t.length>0;){for(let s of t){let o=this._components[s];if(o instanceof this.componentInfoObjects.allComponentClasses._composite&&o.isExpanded)if(o.state.readyToExpandWhenResolved.initiallyResolved)if(await o.stateValues.isInactiveCompositeReplacement)this.updateInfo.inactiveCompositesToUpdateReplacements.push(s);else{let l=await this.updateCompositeReplacements({component:o,componentChanges:i});Object.keys(l.addedComponents).length>0&&(n=!0),Object.keys(l.deletedComponents).length>0&&(n=!0)}else e.push(s)}if(t=[...new Set(this.updateInfo.compositesToUpdateReplacements)],this.updateInfo.compositesToUpdateReplacements=[],r++,r>100)throw Error("Seem to have an infinite loop while calculating replacement changes")}return this.updateInfo.compositesToUpdateReplacements=e,{updatedComposites:n}}async processNewStateVariableValues(t){let e=0,r=!1;for(let n in t){let i=this._components[n];if(i===void 0){let o=this.updateInfo.stateVariableUpdatesForMissingComponents[n];o===void 0&&(o=this.updateInfo.stateVariableUpdatesForMissingComponents[n]={}),Object.assign(o,t[n]);continue}let s=t[n];for(let o in s){let l=i.state[o];if(l===void 0){let c=o.match(/^__def_primitive_(\d+)$/);if(c){let p=Number(c[1]);i.definingChildren[p]=s[o],await this.processNewDefiningChildren({parent:i,expandComposites:!1});continue}else if(c=o.match(/^__def_primitive_ignore_(\d+)$/),c){let p=Number(c[1]);i.definingChildren[p]=s[o],r=!0;continue}console.warn(`can't update state variable ${o} of component ${n}, as it doesn't exist.`);continue}if(!l.hasEssential){console.warn(`can't update state variable ${o} of component ${n}, as it does not have an essential state variable.`);continue}let u=o;if(i.state[o].essentialVarName&&(u=i.state[o].essentialVarName),o in this.rendererVariablesByComponentType[i.componentType]&&this.updateInfo.componentsToUpdateRenderers.push(i.componentName),l.isArray){let c=i.essentialState[u];Array.isArray(c)||(c=i.essentialState[u]=[]);let p=[];i.state[l.arraySizeStateVariable].initiallyResolved||await i.state[l.arraySizeStateVariable].value;let m=await l.arraySize;for(let f in s[o]){if(f==="mergeObject")continue;let d=b=>b;l.set&&(d=l.set);let h=l.setArrayValue({value:d(s[o][f]),arrayKey:f,arraySize:m,arrayValues:c});l.usedDefaultByArrayKey[f]=!1,e+=h.nFailures;let y=l.varNamesIncludingArrayKeys[f];y&&p.push(...y)}for(let f of p)await this.recordActualChangeInStateVariable({componentName:n,varName:f})}else{if(!l.hasEssential){console.warn(`can't update state variable ${o} of component ${n}, as it does not have an essential state variable.`);continue}l.set?i.essentialState[u]=l.set(s[o]):i.essentialState[u]=s[o],delete l.usedDefault}await this.recordActualChangeInStateVariable({componentName:n,varName:o})}}return{nFailures:e,foundIgnore:r}}async requestComponentChanges({instruction:t,initialChange:e=!0,workspace:r,newStateVariableValues:n}){let i=this._components[t.componentName],s=this.substituteAliases({stateVariables:[t.stateVariable],componentClass:i.constructor})[0];r[t.componentName]===void 0&&(r[t.componentName]={});let o=r[t.componentName],l=i.state[s],u=l.additionalStateVariablesDefined,c=[s];u&&c.push(...u);for(let b of c)if(!i.state[b].isResolved&&!(await this.dependencies.resolveItem({componentName:i.componentName,type:"stateVariable",stateVariable:b,force:!0})).success)throw Error(`Can't get value of ${s} of ${i.componentName} as ${b} couldn't be resolved.`);let p=await this.getStateVariableDefinitionArguments({component:i,stateVariable:s,excludeDependencyValues:l.excludeDependencyValuesInInverseDefinition});p.componentInfoObjects=this.componentInfoObjects,p.initialChange=e,p.stateValues=i.stateValues,p.overrideFixed=t.overrideFixed,p.shadowedVariable=t.shadowedVariable,p.sourceInformation=t.sourceInformation;let m=s;if(l.isArrayEntry){let b=l.arrayStateVariable;m=b;let g={};if(p.arrayKeys.length===1){if("value"in t)g[p.arrayKeys[0]]=t.value;else if("valueOfStateVariable"in t){let v=this.substituteAliases({stateVariables:[t.valueOfStateVariable],componentClass:i.constructor})[0],A=i.state[v];if(A)g[p.arrayKeys[0]]=await A.value;else throw Error(`Invalid instruction to change ${t.stateVariable} of ${t.componentName}, value of state variable ${t.valueOfStateVariable} not found.`)}}else for(let[v,A]of p.arrayKeys.entries())g[A]=t.value[v];p.desiredStateVariableValues={[b]:g}}else if("value"in t)p.desiredStateVariableValues={[s]:t.value};else if("valueOfStateVariable"in t){let b=this.substituteAliases({stateVariables:[t.valueOfStateVariable],componentClass:i.constructor})[0],g=i.state[b];if(g)p.desiredStateVariableValues={[s]:await g.value};else throw Error(`Invalid instruction to change ${t.stateVariable} of ${t.componentName}, value of state variable ${t.valueOfStateVariable} not found.`)}let f=o[m];if(f===void 0&&(f=o[m]={}),l.additionalStateVariablesDefined)for(let b of l.additionalStateVariablesDefined){let g=b;i.state[b].isArray&&(g=l.arrayStateVariable);let A=o[g];A&&(Object.assign(f,A),o[g]=f)}if(p.workspace=f,t.additionalStateVariableValues)for(let b in t.additionalStateVariableValues){if(!l.additionalStateVariablesDefined.includes(b)){console.warn(`Can't invert ${b} at the same time as ${s}, as not an additional state variable defined`);continue}p.desiredStateVariableValues[b]=t.additionalStateVariableValues[b]}if(!l.inverseDefinition){console.warn(`Cannot change state variable ${s} of ${i.componentName} as it doesn't have an inverse definition`);return}if(await i.stateValues.fixed&&!t.overrideFixed){console.log(`Changing ${s} of ${i.componentName} did not succeed because fixed is true.`);return}if(!(e||await i.stateValues.modifyIndirectly!==!1)){console.log(`Changing ${s} of ${i.componentName} did not succeed because modifyIndirectly is false.`);return}let d=await l.inverseDefinition(p);if(!d.success)return;let h=[],y;for(let b of d.instructions){let g=!1;if(b.setDependency){let v=b.setDependency,A=this.dependencies.downstreamDependencies[i.componentName][s][v];if(["stateVariable","parentStateVariable"].includes(A.dependencyType)&&A.downstreamComponentNames.length===1){let C=A.downstreamComponentNames[0],S=A.mappedDownstreamVariableNamesByComponent[0][0],w=this._components[C].state[S];if((w.isArrayEntry||w.isArray)&&!w.doNotCombineInverseArrayInstructions){let x=w.isArrayEntry?w.arrayStateVariable:S;if(y&&!(y.componentName===C&&y.stateVariable===x&&y.shadowedVariable===b.shadowedVariable&&y.treatAsInitialChange===b.treatAsInitialChange)&&(h.push(y),y=void 0),!(b.additionalDependencyValues||w.basedOnArrayKeyStateVariables))if(g=!0,y||(y={combinedArray:!0,componentName:C,stateVariable:x,shadowedVariable:b.shadowedVariable,treatAsInitialChange:b.treatAsInitialChange,desiredValue:{}}),w.isArrayEntry){let R=await w.arrayKeys;if(R.length===1)y.desiredValue[R[0]]=b.desiredValue;else for(let[O,_]of R.entries())y.desiredValue[_]=b.desiredValue[O]}else Object.assign(y.desiredValue,b.desiredValue)}}}g||(y&&(h.push(y),y=void 0),h.push(b))}y&&(h.push(y),y=void 0);for(let b of h)if(b.setEssentialValue){if(!c.includes(b.setEssentialValue)){let v=!1;if(l.isArrayEntry){let A=[l.arrayStateVariable];if(l.additionalStateVariablesDefined)for(let C of l.additionalStateVariablesDefined){let S=i.state[C];S.isArrayEntry&&A.push(S.arrayStateVariable)}v=A.includes(b.setEssentialValue)}if(!v)throw Error(`Invalid inverse definition of ${s} of ${i.componentName}: specified changing value of ${b.setEssentialValue}, which is not a state variable defined with ${s}.`)}if(!i.state[b.setEssentialValue].hasEssential)throw Error(`Invalid inverse definition of ${s} of ${i.componentName}: can't set essential value of ${b.setEssentialValue} if it is does not have an essential value.`);if(!("value"in b))throw Error(`Invalid inverse definition of ${s} of ${i.componentName}: setEssentialValue must specify a value`);let g=b.value;if(g instanceof c5e.class&&(g=(await Ql({desiredValue:g,stateValues:i.stateValues,variableName:b.setEssentialValue,workspace:f})).desiredValue),i.state[b.setEssentialValue].doNotShadowEssential||i.state[b.setEssentialValue].shadowVariable)this.calculateEssentialVariableChanges({component:i,varName:b.setEssentialValue,value:g,newStateVariableValues:n,recurseToShadows:!1});else{let v=i;for(;v.shadows&&v.shadows.propVariable===void 0;)v=this._components[v.shadows.componentName];this.calculateEssentialVariableChanges({component:v,varName:b.setEssentialValue,value:g,newStateVariableValues:n})}}else if(b.setDependency){let g=b.setDependency,v=this.dependencies.downstreamDependencies[i.componentName][s][g];if(v.dependencyType==="child"){let A=b.childIndex;if(v.downstreamPrimitives[A]!==null){if(typeof b.desiredValue==typeof v.downstreamPrimitives[A]){let C=this._components[v.parentName],S=v.activeChildrenIndices[A];if(C.compositeReplacementActiveRange){for(let O of C.compositeReplacementActiveRange)if(O.firstInd<=S&&O.lastInd>=S)throw console.log(`parent: ${C.componentName}, activeChildInd: ${S}`),console.log(C.compositeReplacementActiveRange),console.log(b),Error("Need to implement changing primitive replacements from composite")}let w=S;if(C.compositeReplacementActiveRange)for(let O of C.compositeReplacementActiveRange)O.lastInd<w&&(w-=O.lastInd-O.firstInd);let x=C;for(;x.shadows&&x.shadows.propVariable===void 0;)x=this._components[x.shadows.componentName];let R;b.ignoreChildChangeForComponent&&(R=C.componentName),this.calculatePrimitiveChildChanges({parent:x,definingInd:w,newValue:b.desiredValue,newStateVariableValues:n,markToIgnoreForParent:R})}}else{let C=v.downstreamPrimitives.slice(0,A+1).filter(R=>!R).length-1,S=v.downstreamComponentNames[C];if(!S)throw Error(`Invalid inverse definition of ${s} of ${i.componentName}: ${g} child of index ${b.childIndex} does not exist.`);let w=v.mappedDownstreamVariableNamesByComponent[b.childIndex][b.variableIndex];if(!w)throw Error(`Invalid inverse definition of ${s} of ${i.componentName}: ${g} variable of index ${b.variableIndex} does not exist.`);let x={componentName:S,stateVariable:w,value:b.desiredValue,overrideFixed:t.overrideFixed,arrayKey:b.arrayKey};await this.requestComponentChanges({instruction:x,initialChange:b.treatAsInitialChange===!0,workspace:r,newStateVariableValues:n})}}else if(v.dependencyType==="attributeComponent"){let A=v.downstreamComponentNames[0],C=v.mappedDownstreamVariableNamesByComponent[0][b.variableIndex];if(!C)throw Error(`Invalid inverse definition of ${s} of ${i.componentName}: ${g} variable of index ${b.variableIndex} does not exist.`);let S={componentName:A,stateVariable:C,value:b.desiredValue,overrideFixed:t.overrideFixed,arrayKey:b.arrayKey};await this.requestComponentChanges({instruction:S,initialChange:b.treatAsInitialChange===!0,workspace:r,newStateVariableValues:n})}else if(["stateVariable","parentStateVariable"].includes(v.dependencyType)&&v.downstreamComponentNames.length===1){let A=v.downstreamComponentNames[0],C=v.mappedDownstreamVariableNamesByComponent[0][0],S={componentName:A,stateVariable:C,value:b.desiredValue,overrideFixed:t.overrideFixed,shadowedVariable:b.shadowedVariable};if(b.additionalDependencyValues){let w=this.components[A].state[C];for(let x in b.additionalDependencyValues){let R=this.dependencies.downstreamDependencies[i.componentName][s][x];if(!(["stateVariable","parentStateVariable"].includes(R.dependencyType)&&R.downstreamComponentNames.length===1)){console.warn(`Can't simultaneously set additional dependency value ${x} if it isn't a state variable`);continue}let O=R.mappedDownstreamVariableNamesByComponent[0][0];if(R.downstreamComponentNames[0]!==A||!w.additionalStateVariablesDefined.includes(O)){console.warn(`Can't simultaneously set additional dependency value ${x} if it doesn't correspond to additional state variable defined of ${g}'s state variable`);continue}S.additionalStateVariableValues||(S.additionalStateVariableValues={}),S.additionalStateVariableValues[O]=b.additionalDependencyValues[x]}}await this.requestComponentChanges({instruction:S,initialChange:b.treatAsInitialChange===!0,workspace:r,newStateVariableValues:n})}else throw Error(`unimplemented dependency type ${v.dependencyType} in requestComponentChanges`)}else if(b.combinedArray){let g={componentName:b.componentName,stateVariable:b.stateVariable,value:b.desiredValue,overrideFixed:t.overrideFixed,shadowedVariable:b.shadowedVariable};await this.requestComponentChanges({instruction:g,initialChange:b.treatAsInitialChange===!0,workspace:r,newStateVariableValues:n})}else throw console.log(b),Error(`Unrecognized instruction in inverse definition of ${s} of ${i.componentName}`)}calculateEssentialVariableChanges({component:t,varName:e,value:r,newStateVariableValues:n,recurseToShadows:i=!0}){if(n[t.componentName]||(n[t.componentName]={}),t.state[e].isArray?(n[t.componentName][e]||(n[t.componentName][e]={mergeObject:!0}),Object.assign(n[t.componentName][e],r)):n[t.componentName][e]=r,i&&t.shadowedBy)for(let s of t.shadowedBy)s.shadows.propVariable===void 0&&this.calculateEssentialVariableChanges({component:s,varName:e,value:r,newStateVariableValues:n})}calculatePrimitiveChildChanges({parent:t,definingInd:e,newValue:r,newStateVariableValues:n,markToIgnoreForParent:i}){if(n[t.componentName]||(n[t.componentName]={}),t.componentName===i?n[t.componentName][`__def_primitive_ignore_${e}`]=r:n[t.componentName][`__def_primitive_${e}`]=r,t.shadowedBy)for(let s of t.shadowedBy)s.shadows.propVariable===void 0&&this.calculatePrimitiveChildChanges({parent:s,definingInd:e,newValue:r,newStateVariableValues:n,markToIgnoreForParent:i})}async saveState(){if(!this.flags.allowSaveState&&!this.flags.allowLocalState)return;let t=Qp();this.flags.allowLocalState&&UR(`${this.doenetId}|${this.pageId}|${this.attemptNumber}|${this.cid}`,{coreState:this.cumulativeStateVariableChanges,rendererState:this.rendererState,coreInfo:this.coreInfo,saveId:t}),!!this.flags.allowSaveState&&(this.pageStateToBeSavedToDatabase={cid:this.cid,coreInfo:this.coreInfoString,coreState:JSON.stringify(this.cumulativeStateVariableChanges,cn),rendererState:JSON.stringify(this.rendererState,cn),pageId:this.pageId,attemptNumber:this.attemptNumber,doenetId:this.doenetId,saveId:t,serverSaveId:this.serverSaveId,updateDataOnContentChange:this.updateDataOnContentChange},this.changesToBeSaved=!0,this.saveChangesToDatabase(),postMessage({messageType:"savedState"}))}async saveChangesToDatabase(){if(this.saveStateToDBTimerId!==null||!this.changesToBeSaved)return;this.changesToBeSaved=!1,this.saveStateToDBTimerId=setTimeout(()=>{this.saveStateToDBTimerId=null,this.saveChangesToDatabase()},1e4);let t;try{t=await g0.post("/api/savePageState.php",this.pageStateToBeSavedToDatabase)}catch(r){postMessage({messageType:"sendToast",args:{message:"Error synchronizing data.  Changes not saved to the server.",toastType:Fn.ERROR}});return}if(console.log("result from saving to database:",t.data),t.status===null){postMessage({messageType:"sendToast",args:{message:"Error synchronizing data.  Changes not saved to the server.  Are you connected to the internet?",toastType:Fn.ERROR}});return}let e=t.data;if(!e.success){postMessage({messageType:"sendToast",args:{message:e.message,toastType:Fn.ERROR}});return}this.serverSaveId=e.saveId,this.flags.allowLocalState&&UR(`${this.doenetId}|${this.pageId}|${this.attemptNumber}|${this.cid}|ServerSaveId`,e.saveId),e.stateOverwritten&&(this.attemptNumber!==Number(e.attemptNumber)||this.cid===e.cid?(this.flags.allowLocalState&&UR(`${this.doenetId}|${this.pageId}|${e.attemptNumber}|${e.cid}`,{coreState:JSON.parse(e.coreState,Kl),rendererState:JSON.parse(e.rendererState,Kl),coreInfo:JSON.parse(e.coreInfo,Kl),saveId:e.saveId}),postMessage({messageType:"resetPage",args:{changedOnDevice:e.device,newCid:e.cid,newAttemptNumber:Number(e.attemptNumber)}})):postMessage({messageType:"inErrorState",args:{errMsg:"Content changed unexpectedly!"}}))}saveSubmissions({itemCreditAchieved:t,componentsSubmitted:e}){if(!this.flags.allowSaveSubmissions)return;let r={doenetId:this.doenetId,attemptNumber:this.attemptNumber,credit:t,itemNumber:this.itemNumber,componentsSubmitted:JSON.stringify(sa(e,cn))};console.log("payload for save credit for item",r),g0.post("/api/saveCreditForItem.php",r).then(n=>{if(console.log(">>>>saveCreditForItem resp",n.data),n.status===null)postMessage({messageType:"sendToast",args:{message:"Credit not saved due to error.  Are you connected to the internet?",toastType:Fn.ERROR}});else if(!n.data.success)postMessage({messageType:"sendToast",args:{message:`Credit not saved due to error: ${n.data.message}`,toastType:Fn.ERROR}});else{let i=n.data;postMessage({messageType:"updateCreditAchieved",args:i}),i.viewedSolution&&postMessage({messageType:"sendToast",args:{message:"No credit awarded since solution was viewed.",toastType:Fn.INFO}}),i.timeExpired&&postMessage({messageType:"sendToast",args:{message:"No credit awarded since the time allowed has expired.",toastType:Fn.INFO}}),i.pastDueDate&&postMessage({messageType:"sendToast",args:{message:"No credit awarded since the due date has passed.",toastType:Fn.INFO}}),i.exceededAttemptsAllowed&&postMessage({messageType:"sendToast",args:{message:"No credit awarded since no more attempts are allowed.",toastType:Fn.INFO}}),i.databaseError&&postMessage({messageType:"sendToast",args:{message:"Credit not saved due to database error.",toastType:Fn.ERROR}})}}).catch(n=>{postMessage({messageType:"sendToast",args:{message:`Credit not saved due to error: ${n.message}`,toastType:Fn.ERROR}})})}async calculateScoredItemNumberOfContainer(t){let r=[...this._components[t].ancestors.slice(0,-1).reverse().map(s=>s.componentName),t],n,i;for(let[s,o]of(await this.document.stateValues.scoredDescendants).entries()){for(let l of r)if(o.componentName===l){n=l,i=s+1;break}if(n!==void 0)break}return n===void 0&&(n=this.document.componentName,i=(await this.document.stateValues.scoredDescendants).length),{scoredItemNumber:i,scoredComponent:n}}async recordSolutionView({itemNumber:t,scoredComponent:e}){try{let r=await g0.post("/api/reportSolutionViewed.php",{doenetId:this.doenetId,itemNumber:t,pageId:this.pageId,attemptNumber:this.attemptNumber});if(r.status===null){let n="Cannot show solution due to error.  Are you connected to the internet?";return postMessage({messageType:"sendToast",args:{message:n,toastType:Fn.ERROR}}),{allowView:!1,message:n,scoredComponent:e}}else{let n=r.data;if(n.success)return{allowView:!0,message:"",scoredComponent:e};{let i=`Cannot show solution due to error: ${n.message}`;return{allowView:!1,message:i,scoredComponent:e}}}}catch(r){let n="Cannot show solution due to error.";return postMessage({messageType:"sendToast",args:{message:n,toastType:Fn.ERROR}}),{allowView:!1,message:n,scoredComponent:e}}}get scoredItemWeights(){return(async()=>(await this.document.stateValues.scoredDescendants).map(t=>t.stateValues.weight))()}requestAnimationFrame(t){postMessage({messageType:"requestAnimationFrame",args:t})}cancelAnimationFrame(t){postMessage({messageType:"cancelAnimationFrame",args:t})}};function SH({value:a,attributeSpecification:t,attribute:e}){if(t.valueTransformations&&a in t.valueTransformations&&(a=t.valueTransformations[a]),t.transformNonFiniteTo!==void 0&&!Number.isFinite(a)&&(a=t.transformNonFiniteTo),t.toLowerCase&&(a=a.toLowerCase()),t.trim&&(a=a.trim()),t.validValues){if(!t.validValues.includes(a)){let r=t.validValues[0];console.warn(`Invalid value ${a} for attribute ${e}, using value ${r}`),a=r}}else t.clamp&&(a<t.clamp[0]?a=t.clamp[0]:a>t.clamp[1]?a=t.clamp[1]:Number.isFinite(a)||(a=t.defaultValue));return a}function Xd(a){let t=[];if(a.shadowedBy){for(let e of a.shadowedBy)if(!e.shadows.propVariable){t.push(e.componentName);let r=Xd(e);t.push(...r)}}if(a.replacementOf){let e=Xd(a.replacementOf);t.push(...e)}return t}import p5e from"math-expressions";var zl,zR=[];onmessage=function(a){a.data.messageType==="createCore"?m5e(a.data.args):a.data.messageType==="requestAction"?zl?.initialized?zl.requestAction(a.data.args):zR.push(a.data.args):a.data.messageType==="returnAllStateVariables"&&(console.log("all components"),console.log(zl._components),f5e(zl).then(t=>{postMessage({messageType:"returnAllStateVariables",args:t})}))};async function m5e(a){console.log("createCore",a),zl=new v0(a),zl.getInitializedPromise().then(()=>{for(let t of zR)zl.requestAction(t);zR=[]})}async function f5e(a){if(!a.components)return{};let t={};for(let e in a.components){let r=a.components[e],n=t[e]={componentName:e,componentType:r.componentType,stateValues:{}};for(let i in r.state)n.stateValues[i]=sa(await r.state[i].value);n.activeChildren=r.activeChildren.map(i=>i.componentName?{componentName:i.componentName,componentType:i.componentType}:i),r.replacements&&(n.replacements=r.replacements.map(i=>i.componentName?{componentName:i.componentName,componentType:i.componentType}:i),r.replacementsToWithhold!==void 0&&(n.replacementsToWithhold=r.replacementsToWithhold))}return t[a.documentName].sharedParameters=sa(a.components[a.documentName].sharedParameters),t}function sa(a){if(a instanceof p5e.class)a=a.tree;else if(typeof a=="function")a=void 0;else if(Array.isArray(a))a=a.map(t=>sa(t));else if(typeof a=="object"&&a!==null){let t={};for(let e in a)t[e]=sa(a[e]);a=t}return a}export{sa as removeFunctionsMathExpressionClass};
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */
/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */
