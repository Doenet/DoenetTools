var kb=Object.create,Ti=Object.defineProperty,Fb=Object.getPrototypeOf,Bb=Object.prototype.hasOwnProperty,zb=Object.getOwnPropertyNames,qb=Object.getOwnPropertyDescriptor;var jb=l=>Ti(l,"__esModule",{value:!0});var Qt=(l,t)=>()=>(t||(t={exports:{}},l(t.exports,t)),t.exports),mt=(l,t)=>{for(var e in t)Ti(l,e,{get:t[e],enumerable:!0})},Ub=(l,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of zb(t))!Bb.call(l,n)&&n!=="default"&&Ti(l,n,{get:()=>t[n],enumerable:!(e=qb(t,n))||e.enumerable});return l},De=l=>Ub(jb(Ti(l!=null?kb(Fb(l)):{},"default",l&&l.__esModule&&"default"in l?{get:()=>l.default,enumerable:!0}:{value:l,enumerable:!0})),l);var Ee=Qt((exports,module)=>{(function(l,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):l.MathExpression=t()})(exports,function(){"use strict";let get_tree=function(l){if(l!=null){var t;return l.tree!==void 0?t=l.tree:t=l,t}};function*subsets(l,t){var e=l.length;if(t===void 0&&(t=e),t!==0){for(let n=0;n<e;n++)yield[l[n]];if(t!==1)for(let n=0;n<e;n++){let r=subsets(l.slice(n+1),t-1);for(let i of r)yield[l[n]].concat(i)}}}var is_associative={"+":!0,"*":!0,and:!0,or:!0,union:!0,intersect:!0};function flatten(l){var t=get_tree(l);if(!Array.isArray(t))return t;var e=t[0],n=t.slice(1);if(n=n.map(function(a,s){return flatten(a)}),is_associative[e]){for(var r=[],i=0;i<n.length;i++)Array.isArray(n[i])&&n[i][0]===e?r=r.concat(n[i].slice(1)):r.push(n[i]);n=r}return[e].concat(n)}let unflattenRight=function(l){var t=get_tree(l);if(!Array.isArray(t))return t;var e=t[0],n=t.slice(1);if(n=n.map(function(s,o){return unflattenRight(s)}),n.length>2&&is_associative[e]){for(var r=[e,n[0],void 0],i=r,a=1;a<n.length-1;a++)i[2]=[e,n[a],void 0],i=i[2];return i[2]=n[n.length-1],r}return[e].concat(n)},unflattenLeft=function(l){var t=get_tree(l);if(!Array.isArray(t))return t;var e=t[0],n=t.slice(1);if(n=n.map(function(s,o){return unflattenLeft(s)}),n.length>2&&is_associative[e]){for(var r=[e,void 0,n[n.length-1]],i=r,a=n.length-2;a>0;a--)i[1]=[e,void 0,n[a]],i=i[1];return i[1]=n[0],r}return[e].concat(n)},allChildren=function(l){if(!Array.isArray(l))return[];var t=l[0],e=l.slice(1);return is_associative[t]?e.reduce(function(n,r){return Array.isArray(r)&&r[0]===t?n.concat(allChildren(r)):n.concat([r])},[]):e};function remove_duplicate_negatives(l){if(!Array.isArray(l))return l;var t=l[0],e=l.slice(1);return t==="-"&&e[0][0]==="-"?remove_duplicate_negatives(e[0][1]):(e=e.map(remove_duplicate_negatives),[t].concat(e))}function normalize_negatives_in_factors(l){if(!Array.isArray(l))return l;var t=l[0],e=l.slice(1);if(e=e.map(normalize_negatives_in_factors),t!=="*"&&t!=="/")return[t].concat(e);for(var n=1,r=[],i=0;i<e.length;i++)e[i][0]==="-"?(n*=-1,r.push(e[i][1])):r.push(e[i]);var a=[t].concat(r);return n===-1&&(a=["-",a]),a}function normalize_negatives(l){var t=get_tree(l);return t=remove_duplicate_negatives(t),t=normalize_negatives_in_factors(t),t=remove_duplicate_negatives(t),t}function sort_key(l,t={}){if(typeof l=="number")return t.ignore_negatives?[0,"number",Math.abs(l)]:[0,"number",l];if(typeof l=="string")return[1,"symbol",l];if(typeof l=="boolean")return[1,"boolean",l];if(!Array.isArray(l))return[-1,"unknown",l];var e=l[0],n=l.slice(1);if(e==="apply"){var r=[2,"function",n[0]],i=n[1],a=1,s=[];return Array.isArray(i)?(i=i.slice(1),a=i.length,s=i.map(c=>sort_key(c,t))):s=[sort_key(i,t)],r.push([a,s]),r}var o=n.length,u=n.map(sort_key,t);return e==="*"?[4,"product",o,u]:e==="/"?[4,"quotient",o,u]:e==="+"?[5,"sum",o,u]:e==="-"?t.ignore_negatives?u[0]:[6,"minus",o,u]:[7,e,o,u]}function arrayCompare(l,t){if(Array.isArray(l))if(Array.isArray(t)){let e=Math.min(l.length,t.length);for(let n=0;n<e;n++){let r=arrayCompare(l[n],t[n]);if(r!==0)return r}return l.length<t.length?-1:l.length>t.length?1:0}else return 1;else return Array.isArray(t)||l<t?-1:l>t?1:0}function compare_function(l,t,e={}){var n=sort_key(l,e),r=sort_key(t,e);return arrayCompare(n,r)}function coeff_factors_from_term(l,t){if(typeof l=="string"){let e=t.indexOf(l);e===-1&&(t.push(l),e=t.length-1);let n=[];return n[e]=1,{factor_contains:n,coeff:1}}else if(Array.isArray(l)){let e=l[0],n=l.slice(1);if(e==="*"){let r=[],i=[];for(let a of n){if(typeof a=="string"){let s=t.indexOf(a);s===-1&&(t.push(a),s=t.length-1),i[s]===void 0&&(i[s]=0),i[s]++;continue}else if(Array.isArray(a)&&a[0]==="^"||a[0]==="-"){let s=coeff_factors_from_term(a,t);for(let o in s.factor_contains)i[o]===void 0&&(i[o]=0),i[o]+=s.factor_contains[o];s.coeff!==1&&r.push(s.coeff);continue}r.push(a)}return r.length===0?r=1:r.length===1?r=r[0]:r=["*",...r],{factor_contains:i,coeff:r}}else if(e==="^"){let r=n[0],i=n[1],a=[];if(typeof r=="string"&&Number.isFinite(i)){let s=t.indexOf(r);return s===-1&&(t.push(r),s=t.length-1),a[s]=i,{factor_contains:a,coeff:1}}}else if(e==="-"){let r=coeff_factors_from_term(n[0],t),i=-1;return typeof r.coeff=="number"?i*=r.coeff:i=["-",r.coeff],{factor_contains:r.factor_contains,coeff:i}}else if(e==="/"){let r=coeff_factors_from_term(n[0],t),i=["/",r.coeff,n[1]];return{factor_contains:r.factor_contains,coeff:i}}}return{factor_contains:[],coeff:l}}function default_order(l,t){t===void 0&&(t={});var e=get_tree(l);e=flatten(e),e=normalize_negatives(e);function n(r){if(!Array.isArray(r))return r;var i=r[0],a=r.slice(1);if(a=a.map(n),i==="+"){let u=[],c=[],f=[];for(let v of a){let h=coeff_factors_from_term(v,u);c.push(h.factor_contains),f.push(h.coeff)}let p=[];for(let[v,h]of u.entries()){let y={varname:h,exponents_in_term:[]};for(let g=0;g<c.length;g++)y.exponents_in_term.push(c[g][v]||0);p.push(y)}p.sort((v,h)=>v.varname<h.varname?-1:1);let d=[];for(let v=0;v<f.length;v++){let h=p.reduce((y,g)=>[...y,-g.exponents_in_term[v]],[]);h.push(sort_key(f[v],t)),d.push(h)}let m=[];for(let[v,h]of a.entries())m.push({term:h,sort_key:d[v]});m.sort((v,h)=>arrayCompare(v.sort_key,h.sort_key)),a=m.map(v=>v.term)}else if(i==="*"||i==="="||i==="and"||i==="or"||i==="ne"||i==="union"||i==="intersect")a.sort((u,c)=>compare_function(u,c,t));else if(i===">"||i==="ge")a=a.reverse(),i===">"?i="<":i="le";else if(i==="gts"){var s=a[0],o=a[1];if(s[0]!=="tuple"||o[0]!=="tuple")throw new Error("Badly formed ast");s=["tuple"].concat(s.slice(1).reverse()),o=["tuple"].concat(o.slice(1).reverse()),i="lts",a=[s,o]}else if(i==="ni"||i==="notni"||i==="superset"||i==="notsuperset")a=a.reverse(),i==="ni"?i="in":i==="notni"?i="notin":i==="superset"?i="subset":i="notsubset";else if(i==="-"&&a[0][0]==="*")return a[0][1]=["-",a[0][1]],a[0];return[i].concat(a)}return normalize_negatives(n(e))}var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function unwrapExports(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function createCommonjsModule(l,t){return t={exports:{}},l(t,t.exports),t.exports}var isBigNumber=function(t){return t&&t.constructor.prototype.isBigNumber||!1},object=createCommonjsModule(function(l,t){t.clone=function e(n){var r=typeof n;if(r==="number"||r==="string"||r==="boolean"||n===null||n===void 0)return n;if(typeof n.clone=="function")return n.clone();if(Array.isArray(n))return n.map(function(i){return e(i)});if(n instanceof Number)return new Number(n.valueOf());if(n instanceof String)return new String(n.valueOf());if(n instanceof Boolean)return new Boolean(n.valueOf());if(n instanceof Date)return new Date(n.valueOf());if(isBigNumber(n))return n;if(n instanceof RegExp)throw new TypeError("Cannot clone "+n);return t.map(n,e)},t.map=function(e,n){var r={};for(var i in e)t.hasOwnProperty(e,i)&&(r[i]=n(e[i]));return r},t.extend=function(e,n){for(var r in n)t.hasOwnProperty(n,r)&&(e[r]=n[r]);return e},t.deepExtend=function e(n,r){if(Array.isArray(r))throw new TypeError("Arrays are not supported by deepExtend");for(var i in r)if(t.hasOwnProperty(r,i))if(r[i]&&r[i].constructor===Object)n[i]===void 0&&(n[i]={}),n[i].constructor===Object?e(n[i],r[i]):n[i]=r[i];else{if(Array.isArray(r[i]))throw new TypeError("Arrays are not supported by deepExtend");n[i]=r[i]}return n},t.deepEqual=function(n,r){var i,a,s;if(Array.isArray(n)){if(!Array.isArray(r)||n.length!=r.length)return!1;for(a=0,s=n.length;a<s;a++)if(!t.deepEqual(n[a],r[a]))return!1;return!0}else if(n instanceof Object){if(Array.isArray(r)||!(r instanceof Object))return!1;for(i in n)if(!t.deepEqual(n[i],r[i]))return!1;for(i in r)if(!t.deepEqual(n[i],r[i]))return!1;return!0}else return typeof n==typeof r&&n==r},t.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{get:function(){}}),!0}catch(e){}return!1},t.lazy=function(e,n,r){if(t.canDefineProperty()){var i=!0,a;Object.defineProperty(e,n,{get:function(){return i&&(a=r(),i=!1),a},set:function(s){a=s,i=!1},configurable:!0,enumerable:!0})}else e[n]=r()},t.traverse=function(e,n){var r=e;if(n)for(var i=n.split("."),a=0;a<i.length;a++){var s=i[a];s in r||(r[s]={}),r=r[s]}return r},t.hasOwnProperty=function(e,n){return e&&Object.hasOwnProperty.call(e,n)},t.isFactory=function(e){return e&&typeof e.factory=="function"}}),object_1=object.clone,object_2=object.map,object_3=object.extend,object_4=object.deepExtend,object_5=object.deepEqual,object_6=object.canDefineProperty,object_7=object.lazy,object_8=object.traverse,object_9=object.isFactory,typedFunction=createCommonjsModule(function(l,t){(function(e,n){l.exports=n()})(commonjsGlobal,function(){function e(){return!0}function n(){return!1}function r(){}function i(){var a=[{name:"number",test:function(H){return typeof H=="number"}},{name:"string",test:function(H){return typeof H=="string"}},{name:"boolean",test:function(H){return typeof H=="boolean"}},{name:"Function",test:function(H){return typeof H=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(H){return H instanceof Date}},{name:"RegExp",test:function(H){return H instanceof RegExp}},{name:"Object",test:function(H){return typeof H=="object"&&H.constructor===Object}},{name:"null",test:function(H){return H===null}},{name:"undefined",test:function(H){return H===void 0}}],s={name:"any",test:e},o=[],u=[],c={types:a,conversions:u,ignore:o};function f(H){var re=X(c.types,function(ue){return ue.name===H});if(re)return re;if(H==="any")return s;var ce=X(c.types,function(ue){return ue.name.toLowerCase()===H.toLowerCase()});throw new TypeError('Unknown type "'+H+'"'+(ce?'. Did you mean "'+ce.name+'"?':""))}function p(H){return H===s?999:c.types.indexOf(H)}function d(H){var re=X(c.types,function(ce){return ce.test(H)});if(re)return re.name;throw new TypeError("Value has unknown type. Value: "+H)}function m(H,re){if(!H.signatures)throw new TypeError("Function is no typed-function");var ce;if(typeof re=="string"){ce=re.split(",");for(var ue=0;ue<ce.length;ue++)ce[ue]=ce[ue].trim()}else if(Array.isArray(re))ce=re;else throw new TypeError("String array or a comma separated string expected");var Ce=ce.join(","),Ne=H.signatures[Ce];if(Ne)return Ne;throw new TypeError("Signature not found (signature: "+(H.name||"unnamed")+"("+ce.join(", ")+"))")}function v(H,re){var ce=d(H);if(re===ce)return H;for(var ue=0;ue<c.conversions.length;ue++){var Ce=c.conversions[ue];if(Ce.from===ce&&Ce.to===re)return Ce.convert(H)}throw new Error("Cannot convert from "+ce+" to "+re)}function h(H){return H.map(function(re){var ce=re.types.map(A);return(re.restParam?"...":"")+ce.join("|")}).join(",")}function y(H,re){var ce=H.indexOf("...")===0,ue=ce?H.length>3?H.slice(3):"any":H,Ce=ue.split("|").map(pe).filter(oe).filter(se),Ne=E(re,Ce),Te=Ce.map(function(Ae){var Ve=f(Ae);return{name:Ae,typeIndex:p(Ve),test:Ve.test,conversion:null,conversionIndex:-1}}),$e=Ne.map(function(Ae){var Ve=f(Ae.from);return{name:Ae.from,typeIndex:p(Ve),test:Ve.test,conversion:Ae,conversionIndex:re.indexOf(Ae)}});return{types:Te.concat($e),restParam:ce}}function g(H,re,ce){var ue=[];return H.trim()!==""&&(ue=H.split(",").map(pe).map(function(Ce,Ne,Te){var $e=y(Ce,ce);if($e.restParam&&Ne!==Te.length-1)throw new SyntaxError('Unexpected rest parameter "'+Ce+'": only allowed for the last parameter');return $e})),ue.some(O)?null:{params:ue,fn:re}}function b(H){var re=Z(H);return re?re.restParam:!1}function x(H){return H.types.some(function(re){return re.conversion!=null})}function N(H){if(!H||H.types.length===0)return e;if(H.types.length===1)return f(H.types[0].name).test;if(H.types.length===2){var re=f(H.types[0].name).test,ce=f(H.types[1].name).test;return function(Ne){return re(Ne)||ce(Ne)}}else{var ue=H.types.map(function(Ce){return f(Ce.name).test});return function(Ne){for(var Te=0;Te<ue.length;Te++)if(ue[Te](Ne))return!0;return!1}}}function C(H){var re,ce,ue;if(b(H)){re=z(H).map(N);var Ce=re.length,Ne=N(Z(H)),Te=function($e){for(var Ae=Ce;Ae<$e.length;Ae++)if(!Ne($e[Ae]))return!1;return!0};return function(Ae){for(var Ve=0;Ve<re.length;Ve++)if(!re[Ve](Ae[Ve]))return!1;return Te(Ae)&&Ae.length>=Ce+1}}else return H.length===0?function(Ae){return Ae.length===0}:H.length===1?(ce=N(H[0]),function(Ae){return ce(Ae[0])&&Ae.length===1}):H.length===2?(ce=N(H[0]),ue=N(H[1]),function(Ae){return ce(Ae[0])&&ue(Ae[1])&&Ae.length===2}):(re=H.map(N),function(Ae){for(var Ve=0;Ve<re.length;Ve++)if(!re[Ve](Ae[Ve]))return!1;return Ae.length===re.length})}function _(H,re){return re<H.params.length?H.params[re]:b(H.params)?Z(H.params):null}function w(H,re,ce){var ue=_(H,re),Ce=ue?ce?ue.types.filter($):ue.types:[];return Ce.map(A)}function A(H){return H.name}function $(H){return H.conversion===null||H.conversion===void 0}function S(H,re){var ce=te(de(H,function(ue){return w(ue,re,!1)}));return ce.indexOf("any")!==-1?["any"]:ce}function D(H,re,ce){var ue,Ce,Ne=H||"unnamed",Te=ce,$e;for($e=0;$e<re.length;$e++){var Ae=Te.filter(function(at){var Mt=N(_(at,$e));return($e<at.params.length||b(at.params))&&Mt(re[$e])});if(Ae.length===0){if(Ce=S(Te,$e),Ce.length>0){var Ve=d(re[$e]);return ue=new TypeError("Unexpected type of argument in function "+Ne+" (expected: "+Ce.join(" or ")+", actual: "+Ve+", index: "+$e+")"),ue.data={category:"wrongType",fn:Ne,index:$e,actual:Ve,expected:Ce},ue}}else Te=Ae}var Qe=Te.map(function(at){return b(at.params)?Infinity:at.params.length});if(re.length<Math.min.apply(null,Qe))return Ce=S(Te,$e),ue=new TypeError("Too few arguments in function "+Ne+" (expected: "+Ce.join(" or ")+", index: "+re.length+")"),ue.data={category:"tooFewArgs",fn:Ne,index:re.length,expected:Ce},ue;var Je=Math.max.apply(null,Qe);return re.length>Je?(ue=new TypeError("Too many arguments in function "+Ne+" (expected: "+Je+", actual: "+re.length+")"),ue.data={category:"tooManyArgs",fn:Ne,index:re.length,expectedLength:Je},ue):(ue=new TypeError('Arguments of type "'+re.join(", ")+'" do not match any of the defined signatures of function '+Ne+"."),ue.data={category:"mismatch",actual:re.map(d)},ue)}function V(H){for(var re=999,ce=0;ce<H.types.length;ce++)$(H.types[ce])&&(re=Math.min(re,H.types[ce].typeIndex));return re}function I(H){for(var re=999,ce=0;ce<H.types.length;ce++)$(H.types[ce])||(re=Math.min(re,H.types[ce].conversionIndex));return re}function q(H,re){var ce;return ce=H.restParam-re.restParam,ce!==0||(ce=x(H)-x(re),ce!==0)||(ce=V(H)-V(re),ce!==0)?ce:I(H)-I(re)}function K(H,re){var ce=Math.min(H.params.length,re.params.length),ue,Ce;if(Ce=H.params.some(x)-re.params.some(x),Ce!==0)return Ce;for(ue=0;ue<ce;ue++)if(Ce=x(H.params[ue])-x(re.params[ue]),Ce!==0)return Ce;for(ue=0;ue<ce;ue++)if(Ce=q(H.params[ue],re.params[ue]),Ce!==0)return Ce;return H.params.length-re.params.length}function E(H,re){var ce={};return H.forEach(function(ue){re.indexOf(ue.from)===-1&&re.indexOf(ue.to)!==-1&&!ce[ue.from]&&(ce[ue.from]=ue)}),Object.keys(ce).map(function(ue){return ce[ue]})}function W(H,re){var ce=re;if(H.some(x)){var ue=b(H),Ce=H.map(G);ce=function(){for(var Ae=[],Ve=ue?arguments.length-1:arguments.length,Qe=0;Qe<Ve;Qe++)Ae[Qe]=Ce[Qe](arguments[Qe]);return ue&&(Ae[Ve]=arguments[Ve].map(Ce[Ve])),re.apply(null,Ae)}}var Ne=ce;if(b(H)){var Te=H.length-1;Ne=function(){return ce.apply(null,J(arguments,0,Te).concat([J(arguments,Te)]))}}return Ne}function G(H){var re,ce,ue,Ce,Ne=[],Te=[];switch(H.types.forEach(function($e){$e.conversion&&(Ne.push(f($e.conversion.from).test),Te.push($e.conversion.convert))}),Te.length){case 0:return function(Ae){return Ae};case 1:return re=Ne[0],ue=Te[0],function(Ae){return re(Ae)?ue(Ae):Ae};case 2:return re=Ne[0],ce=Ne[1],ue=Te[0],Ce=Te[1],function(Ae){return re(Ae)?ue(Ae):ce(Ae)?Ce(Ae):Ae};default:return function(Ae){for(var Ve=0;Ve<Te.length;Ve++)if(Ne[Ve](Ae))return Te[Ve](Ae);return Ae}}}function P(H){var re={};return H.forEach(function(ce){ce.params.some(x)||Q(ce.params,!0).forEach(function(ue){re[h(ue)]=ce.fn})}),re}function Q(H,re){function ce(ue,Ce,Ne){if(Ce<ue.length){var Te=ue[Ce],$e=re?Te.types.filter($):Te.types,Ae;if(Te.restParam){var Ve=$e.filter($);Ae=Ve.length<$e.length?[Ve,$e]:[$e]}else Ae=$e.map(function(Je){return[Je]});return de(Ae,function(Je){return ce(ue,Ce+1,Ne.concat([Je]))})}else{var Qe=Ne.map(function(Je,at){return{types:Je,restParam:at===ue.length-1&&b(ue)}});return[Qe]}}return ce(H,0,[])}function ne(H,re){for(var ce=Math.max(H.params.length,re.params.length),ue=0;ue<ce;ue++){var Ce=w(H,ue,!0),Ne=w(re,ue,!0);if(!F(Ce,Ne))return!1}var Te=H.params.length,$e=re.params.length,Ae=b(H.params),Ve=b(re.params);return Ae?Ve?Te===$e:$e>=Te:Ve?Te>=$e:Te===$e}function Y(H,re){if(Object.keys(re).length===0)throw new SyntaxError("No signatures provided");var ce=[];Object.keys(re).map(function(L){return g(L,re[L],c.conversions)}).filter(ve).forEach(function(L){var k=X(ce,function(B){return ne(B,L)});if(k)throw new TypeError('Conflicting signatures "'+h(k.params)+'" and "'+h(L.params)+'".');ce.push(L)});var ue=de(ce,function(L){var k=L?Q(L.params,!1):[];return k.map(function(B){return{params:B,fn:L.fn}})}).filter(ve);ue.sort(K);var Ce=ue[0]&&ue[0].params.length<=2&&!b(ue[0].params),Ne=ue[1]&&ue[1].params.length<=2&&!b(ue[1].params),Te=ue[2]&&ue[2].params.length<=2&&!b(ue[2].params),$e=ue[3]&&ue[3].params.length<=2&&!b(ue[3].params),Ae=ue[4]&&ue[4].params.length<=2&&!b(ue[4].params),Ve=ue[5]&&ue[5].params.length<=2&&!b(ue[5].params),Qe=Ce&&Ne&&Te&&$e&&Ae&&Ve,Je=ue.map(function(L){return C(L.params)}),at=Ce?N(ue[0].params[0]):n,Mt=Ne?N(ue[1].params[0]):n,cr=Te?N(ue[2].params[0]):n,en=$e?N(ue[3].params[0]):n,Yt=Ae?N(ue[4].params[0]):n,Rn=Ve?N(ue[5].params[0]):n,tn=Ce?N(ue[0].params[1]):n,kn=Ne?N(ue[1].params[1]):n,rn=Te?N(ue[2].params[1]):n,Fn=$e?N(ue[3].params[1]):n,Bn=Ae?N(ue[4].params[1]):n,zn=Ve?N(ue[5].params[1]):n,qt=ue.map(function(L){return W(L.params,L.fn)}),nn=Ce?qt[0]:r,Xe=Ne?qt[1]:r,an=Te?qt[2]:r,ae=$e?qt[3]:r,ge=Ae?qt[4]:r,we=Ve?qt[5]:r,Re=Ce?ue[0].params.length:-1,Fe=Ne?ue[1].params.length:-1,jt=Te?ue[2].params.length:-1,qn=$e?ue[3].params.length:-1,Ma=Ae?ue[4].params.length:-1,Oa=Ve?ue[5].params.length:-1,Ea=Qe?6:0,Pa=ue.length,La=function(){for(var k=Ea;k<Pa;k++)if(Je[k](arguments))return qt[k].apply(null,arguments);throw D(H,arguments,ue)},M=function(k,B){return arguments.length===Re&&at(k)&&tn(B)?nn.apply(null,arguments):arguments.length===Fe&&Mt(k)&&kn(B)?Xe.apply(null,arguments):arguments.length===jt&&cr(k)&&rn(B)?an.apply(null,arguments):arguments.length===qn&&en(k)&&Fn(B)?ae.apply(null,arguments):arguments.length===Ma&&Yt(k)&&Bn(B)?ge.apply(null,arguments):arguments.length===Oa&&Rn(k)&&zn(B)?we.apply(null,arguments):La.apply(null,arguments)};try{Object.defineProperty(M,"name",{value:H})}catch(L){}return M.signatures=P(ue),M}function se(H){return c.ignore.indexOf(H)===-1}function pe(H){return H.trim()}function oe(H){return!!H}function ve(H){return H!==null}function O(H){return H.types.length===0}function z(H){return H.slice(0,H.length-1)}function Z(H){return H[H.length-1]}function J(H,re,ce){return Array.prototype.slice.call(H,re,ce)}function R(H,re){return H.indexOf(re)!==-1}function F(H,re){for(var ce=0;ce<H.length;ce++)if(R(re,H[ce]))return!0;return!1}function X(H,re){for(var ce=0;ce<H.length;ce++)if(re(H[ce]))return H[ce]}function te(H){for(var re={},ce=0;ce<H.length;ce++)re[H[ce]]=!0;return Object.keys(re)}function de(H,re){return Array.prototype.concat.apply([],H.map(re))}function he(H){for(var re="",ce=0;ce<H.length;ce++){var ue=H[ce];if(ue.signatures&&ue.name!==""){if(re==="")re=ue.name;else if(re!==ue.name){var Ce=new Error("Function names do not match (expected: "+re+", actual: "+ue.name+")");throw Ce.data={actual:ue.name,expected:re},Ce}}}return re}return c=Y("typed",{"string, Object":Y,Object:function(H){var re=[];for(var ce in H)H.hasOwnProperty(ce)&&re.push(H[ce]);var ue=he(re);return Y(ue,H)},"...Function":function(H){for(var re,ce=he(H),ue={},Ce=0;Ce<H.length;Ce++){var Ne=H[Ce];if(typeof Ne.signatures!="object")throw re=new TypeError("Function is no typed-function (index: "+Ce+")"),re.data={index:Ce},re;for(var Te in Ne.signatures)if(Ne.signatures.hasOwnProperty(Te))if(ue.hasOwnProperty(Te)){if(Ne.signatures[Te]!==ue[Te])throw re=new Error('Signature "'+Te+'" is defined twice'),re.data={signature:Te},re}else ue[Te]=Ne.signatures[Te]}return Y(ce,ue)}}),c.create=i,c.types=a,c.conversions=u,c.ignore=o,c.convert=v,c.find=m,c.addType=function(H){if(!H||typeof H.name!="string"||typeof H.test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");c.types.push(H)},c.addConversion=function(H){if(!H||typeof H.from!="string"||typeof H.to!="string"||typeof H.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");c.conversions.push(H)},c}return i()})}),number=createCommonjsModule(function(l,t){t.isNumber=function(n){return typeof n=="number"},t.isInteger=function(n){return isFinite(n)?n==Math.round(n):!1},t.sign=Math.sign||function(n){return n>0?1:n<0?-1:0},t.format=function(n,r){if(typeof r=="function")return r(n);if(n===Infinity)return"Infinity";if(n===-Infinity)return"-Infinity";if(isNaN(n))return"NaN";var i="auto",a=void 0;switch(r&&(r.notation&&(i=r.notation),t.isNumber(r)?a=r:r.precision&&(a=r.precision)),i){case"fixed":return t.toFixed(n,a);case"exponential":return t.toExponential(n,a);case"engineering":return t.toEngineering(n,a);case"auto":if(r&&r.exponential&&(r.exponential.lower!==void 0||r.exponential.upper!==void 0)){var s=object.map(r,function(o){return o});return s.exponential=void 0,r.exponential.lower!==void 0&&(s.lowerExp=Math.round(Math.log(r.exponential.lower)/Math.LN10)),r.exponential.upper!==void 0&&(s.upperExp=Math.round(Math.log(r.exponential.upper)/Math.LN10)),console.warn("Deprecation warning: Formatting options exponential.lower and exponential.upper (minimum and maximum value) are replaced with exponential.lowerExp and exponential.upperExp (minimum and maximum exponent) since version 4.0.0. Replace "+JSON.stringify(r)+" with "+JSON.stringify(s)),t.toPrecision(n,a,s)}return t.toPrecision(n,a,r&&r).replace(/((\.\d*?)(0+))($|e)/,function(){var o=arguments[2],u=arguments[4];return o!=="."?o+u:u});default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", or "fixed".')}},t.splitNumber=function(n){var r=String(n).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!r)throw new SyntaxError("Invalid number "+n);var i=r[1],a=r[2],s=parseFloat(r[4]||"0"),o=a.indexOf(".");s+=o!==-1?o-1:a.length-1;var u=a.replace(".","").replace(/^0*/,function(c){return s-=c.length,""}).replace(/0*$/,"").split("").map(function(c){return parseInt(c)});return u.length===0&&(u.push(0),s++),{sign:i,coefficients:u,exponent:s}},t.toEngineering=function(n,r){if(isNaN(n)||!isFinite(n))return String(n);var i=t.roundDigits(t.splitNumber(n),r),a=i.exponent,s=i.coefficients,o=a%3==0?a:a<0?a-3-a%3:a-a%3,u=a>=0?a:Math.abs(o);s.length-1<u&&(s=s.concat(e(u-(s.length-1))));for(var c=Math.abs(a-o),f=1;--c>=0;)f++;var p=s.slice(f).join(""),d=p.match(/[1-9]/)?"."+p:"",m=s.slice(0,f).join("")+d+"e"+(a>=0?"+":"")+o.toString();return i.sign+m},t.toFixed=function(n,r){if(isNaN(n)||!isFinite(n))return String(n);var i=t.splitNumber(n),a=typeof r=="number"?t.roundDigits(i,i.exponent+1+r):i,s=a.coefficients,o=a.exponent+1,u=o+(r||0);return s.length<u&&(s=s.concat(e(u-s.length))),o<0&&(s=e(-o+1).concat(s),o=1),o<s.length&&s.splice(o,0,o===0?"0.":"."),a.sign+s.join("")},t.toExponential=function(n,r){if(isNaN(n)||!isFinite(n))return String(n);var i=t.splitNumber(n),a=r?t.roundDigits(i,r):i,s=a.coefficients,o=a.exponent;s.length<r&&(s=s.concat(e(r-s.length)));var u=s.shift();return a.sign+u+(s.length>0?"."+s.join(""):"")+"e"+(o>=0?"+":"")+o},t.toPrecision=function(n,r,i){if(isNaN(n)||!isFinite(n))return String(n);var a=i&&i.lowerExp!==void 0?i.lowerExp:-3,s=i&&i.upperExp!==void 0?i.upperExp:5,o=t.splitNumber(n);if(o.exponent<a||o.exponent>=s)return t.toExponential(n,r);var u=r?t.roundDigits(o,r):o,c=u.coefficients,f=u.exponent;c.length<r&&(c=c.concat(e(r-c.length))),c=c.concat(e(f-c.length+1+(c.length<r?r-c.length:0))),c=e(-f).concat(c);var p=f>0?f:0;return p<c.length-1&&c.splice(p+1,0,"."),u.sign+c.join("")},t.roundDigits=function(n,r){for(var i={sign:n.sign,coefficients:n.coefficients,exponent:n.exponent},a=i.coefficients;r<=0;)a.unshift(0),i.exponent++,r++;if(a.length>r){var s=a.splice(r,a.length-r);if(s[0]>=5){var o=r-1;for(a[o]++;a[o]===10;)a.pop(),o===0&&(a.unshift(0),i.exponent++,o++),o--,a[o]++}}return i};function e(n){for(var r=[],i=0;i<n;i++)r.push(0);return r}t.digits=function(n){return n.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length},t.DBL_EPSILON=Number.EPSILON||2220446049250313e-31,t.nearlyEqual=function(n,r,i){if(i==null)return n==r;if(n==r)return!0;if(isNaN(n)||isNaN(r))return!1;if(isFinite(n)&&isFinite(r)){var a=Math.abs(n-r);return a<t.DBL_EPSILON?!0:a<=Math.max(Math.abs(n),Math.abs(r))*i}return!1}}),number_1=number.isNumber,number_2=number.isInteger,number_3=number.sign,number_4=number.format,number_5=number.splitNumber,number_6=number.toEngineering,number_7=number.toFixed,number_8=number.toExponential,number_9=number.toPrecision,number_10=number.roundDigits,number_11=number.digits,number_12=number.DBL_EPSILON,number_13=number.nearlyEqual,isMatrix=function(t){return t&&t.constructor.prototype.isMatrix||!1},digits=number.digits,createTyped=function(){return createTyped=typedFunction.create,typedFunction},create=function(t){t.isNumber=function(n){return typeof n=="number"},t.isComplex=function(n){return t.Complex&&n instanceof t.Complex||!1},t.isBigNumber=isBigNumber,t.isFraction=function(n){return t.Fraction&&n instanceof t.Fraction||!1},t.isUnit=function(n){return n&&n.constructor.prototype.isUnit||!1},t.isString=function(n){return typeof n=="string"},t.isArray=Array.isArray,t.isMatrix=isMatrix,t.isDenseMatrix=function(n){return n&&n.isDenseMatrix&&n.constructor.prototype.isMatrix||!1},t.isSparseMatrix=function(n){return n&&n.isSparseMatrix&&n.constructor.prototype.isMatrix||!1},t.isRange=function(n){return n&&n.constructor.prototype.isRange||!1},t.isIndex=function(n){return n&&n.constructor.prototype.isIndex||!1},t.isBoolean=function(n){return typeof n=="boolean"},t.isResultSet=function(n){return n&&n.constructor.prototype.isResultSet||!1},t.isHelp=function(n){return n&&n.constructor.prototype.isHelp||!1},t.isFunction=function(n){return typeof n=="function"},t.isDate=function(n){return n instanceof Date},t.isRegExp=function(n){return n instanceof RegExp},t.isObject=function(n){return typeof n=="object"&&n.constructor===Object&&!t.isComplex(n)&&!t.isFraction(n)},t.isNull=function(n){return n===null},t.isUndefined=function(n){return n===void 0},t.isAccessorNode=function(n){return n&&n.isAccessorNode&&n.constructor.prototype.isNode||!1},t.isArrayNode=function(n){return n&&n.isArrayNode&&n.constructor.prototype.isNode||!1},t.isAssignmentNode=function(n){return n&&n.isAssignmentNode&&n.constructor.prototype.isNode||!1},t.isBlockNode=function(n){return n&&n.isBlockNode&&n.constructor.prototype.isNode||!1},t.isConditionalNode=function(n){return n&&n.isConditionalNode&&n.constructor.prototype.isNode||!1},t.isConstantNode=function(n){return n&&n.isConstantNode&&n.constructor.prototype.isNode||!1},t.isFunctionAssignmentNode=function(n){return n&&n.isFunctionAssignmentNode&&n.constructor.prototype.isNode||!1},t.isFunctionNode=function(n){return n&&n.isFunctionNode&&n.constructor.prototype.isNode||!1},t.isIndexNode=function(n){return n&&n.isIndexNode&&n.constructor.prototype.isNode||!1},t.isNode=function(n){return n&&n.isNode&&n.constructor.prototype.isNode||!1},t.isObjectNode=function(n){return n&&n.isObjectNode&&n.constructor.prototype.isNode||!1},t.isOperatorNode=function(n){return n&&n.isOperatorNode&&n.constructor.prototype.isNode||!1},t.isParenthesisNode=function(n){return n&&n.isParenthesisNode&&n.constructor.prototype.isNode||!1},t.isRangeNode=function(n){return n&&n.isRangeNode&&n.constructor.prototype.isNode||!1},t.isSymbolNode=function(n){return n&&n.isSymbolNode&&n.constructor.prototype.isNode||!1},t.isChain=function(n){return n&&n.constructor.prototype.isChain||!1};var e=createTyped();return e.types=[{name:"number",test:t.isNumber},{name:"Complex",test:t.isComplex},{name:"BigNumber",test:t.isBigNumber},{name:"Fraction",test:t.isFraction},{name:"Unit",test:t.isUnit},{name:"string",test:t.isString},{name:"Array",test:t.isArray},{name:"Matrix",test:t.isMatrix},{name:"DenseMatrix",test:t.isDenseMatrix},{name:"SparseMatrix",test:t.isSparseMatrix},{name:"Range",test:t.isRange},{name:"Index",test:t.isIndex},{name:"boolean",test:t.isBoolean},{name:"ResultSet",test:t.isResultSet},{name:"Help",test:t.isHelp},{name:"function",test:t.isFunction},{name:"Date",test:t.isDate},{name:"RegExp",test:t.isRegExp},{name:"null",test:t.isNull},{name:"undefined",test:t.isUndefined},{name:"OperatorNode",test:t.isOperatorNode},{name:"ConstantNode",test:t.isConstantNode},{name:"SymbolNode",test:t.isSymbolNode},{name:"ParenthesisNode",test:t.isParenthesisNode},{name:"FunctionNode",test:t.isFunctionNode},{name:"FunctionAssignmentNode",test:t.isFunctionAssignmentNode},{name:"ArrayNode",test:t.isArrayNode},{name:"AssignmentNode",test:t.isAssignmentNode},{name:"BlockNode",test:t.isBlockNode},{name:"ConditionalNode",test:t.isConditionalNode},{name:"IndexNode",test:t.isIndexNode},{name:"RangeNode",test:t.isRangeNode},{name:"Node",test:t.isNode},{name:"Object",test:t.isObject}],e.conversions=[{from:"number",to:"BigNumber",convert:function(n){if(digits(n)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+n+"). Use function bignumber(x) to convert to BigNumber.");return new t.BigNumber(n)}},{from:"number",to:"Complex",convert:function(n){return new t.Complex(n,0)}},{from:"number",to:"string",convert:function(n){return n+""}},{from:"BigNumber",to:"Complex",convert:function(n){return new t.Complex(n.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(n){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(n){return new t.Complex(n.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(n){var r=new t.Fraction(n);if(r.valueOf()!==n)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+n+"). Use function fraction(x) to convert to Fraction.");return new t.Fraction(n)}},{from:"string",to:"number",convert:function(n){var r=Number(n);if(isNaN(r))throw new Error('Cannot convert "'+n+'" to a number');return r}},{from:"string",to:"BigNumber",convert:function(n){try{return new t.BigNumber(n)}catch(r){throw new Error('Cannot convert "'+n+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(n){try{return new t.Fraction(n)}catch(r){throw new Error('Cannot convert "'+n+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(n){try{return new t.Complex(n)}catch(r){throw new Error('Cannot convert "'+n+'" to Complex')}}},{from:"boolean",to:"number",convert:function(n){return+n}},{from:"boolean",to:"BigNumber",convert:function(n){return new t.BigNumber(+n)}},{from:"boolean",to:"Fraction",convert:function(n){return new t.Fraction(+n)}},{from:"boolean",to:"string",convert:function(n){return+n}},{from:"Array",to:"Matrix",convert:function(n){return new t.DenseMatrix(n)}},{from:"Matrix",to:"Array",convert:function(n){return n.valueOf()}}],e},typed={create};function E(){}E.prototype={on:function(l,t,e){var n=this.e||(this.e={});return(n[l]||(n[l]=[])).push({fn:t,ctx:e}),this},once:function(l,t,e){var n=this;function r(){n.off(l,r),t.apply(e,arguments)}return r._=t,this.on(l,r,e)},emit:function(l){var t=[].slice.call(arguments,1),e=((this.e||(this.e={}))[l]||[]).slice(),n=0,r=e.length;for(n;n<r;n++)e[n].fn.apply(e[n].ctx,t);return this},off:function(l,t){var e=this.e||(this.e={}),n=e[l],r=[];if(n&&t)for(var i=0,a=n.length;i<a;i++)n[i].fn!==t&&n[i].fn._!==t&&r.push(n[i]);return r.length?e[l]=r:delete e[l],this}};var tinyEmitter=E,mixin=function(l){var t=new tinyEmitter;return l.on=t.on.bind(t),l.off=t.off.bind(t),l.once=t.once.bind(t),l.emit=t.emit.bind(t),l},emitter={mixin};function ArgumentsError(l,t,e,n){if(!(this instanceof ArgumentsError))throw new SyntaxError("Constructor must be called with the new operator");this.fn=l,this.count=t,this.min=e,this.max=n,this.message="Wrong number of arguments in function "+l+" ("+t+" provided, "+e+(n!=null?"-"+n:"")+" expected)",this.stack=new Error().stack}ArgumentsError.prototype=new Error,ArgumentsError.prototype.constructor=Error,ArgumentsError.prototype.name="ArgumentsError",ArgumentsError.prototype.isArgumentsError=!0;var ArgumentsError_1=ArgumentsError,lazy=object.lazy,isFactory=object.isFactory,traverse=object.traverse;function factory(l,t,e,n,r){function i(v,h){var y=arguments.length;if(y!==1&&y!==2)throw new ArgumentsError_1("import",y,1,2);if(h||(h={}),isFactory(v))u(v,h);else if(Array.isArray(v))v.forEach(function(x){i(x,h)});else if(typeof v=="object"){for(var g in v)if(v.hasOwnProperty(g)){var b=v[g];c(b)?a(g,b,h):isFactory(v)?u(v,h):i(b,h)}}else if(!h.silent)throw new TypeError("Factory, Object, or Array expected")}function a(v,h,y){if(y.wrap&&typeof h=="function"&&(h=o(h)),f(r[v])&&f(h)){y.override?h=n(v,h.signatures):h=n(r[v],h),r[v]=h,s(v,h),r.emit("import",v,function(){return h});return}if(r[v]===void 0||y.override){r[v]=h,s(v,h),r.emit("import",v,function(){return h});return}if(!y.silent)throw new Error('Cannot import "'+v+'": already exists')}function s(v,h){h&&typeof h.transform=="function"?(r.expression.transform[v]=h.transform,p(v)&&(r.expression.mathWithTransform[v]=h.transform)):(delete r.expression.transform[v],p(v)&&(r.expression.mathWithTransform[v]=h))}function o(v){var h=function(){for(var g=[],b=0,x=arguments.length;b<x;b++){var N=arguments[b];g[b]=N&&N.valueOf()}return v.apply(r,g)};return v.transform&&(h.transform=v.transform),h}function u(v,h){if(typeof v.name=="string"){var y=v.name,g=y in r.expression.transform,b=v.path?traverse(r,v.path):r,x=b.hasOwnProperty(y)?b[y]:void 0,N=function(){var C=e(v);if(C&&typeof C.transform=="function")throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with exports.path="expression.transform"');if(f(x)&&f(C))return h.override||(C=n(x,C)),C;if(x===void 0||h.override)return C;if(!h.silent)throw new Error('Cannot import "'+y+'": already exists')};v.lazy!==!1?(lazy(b,y,N),g||(v.path==="expression.transform"||d(v))&&lazy(r.expression.mathWithTransform,y,N)):(b[y]=N(),g||(v.path==="expression.transform"||d(v))&&(r.expression.mathWithTransform[y]=N())),r.emit("import",y,N,v.path)}else e(v)}function c(v){return typeof v=="function"||typeof v=="number"||typeof v=="string"||typeof v=="boolean"||v===null||v&&l.isUnit(v)||v&&l.isComplex(v)||v&&l.isBigNumber(v)||v&&l.isFraction(v)||v&&l.isMatrix(v)||v&&Array.isArray(v)}function f(v){return typeof v=="function"&&typeof v.signatures=="object"}function p(v){return!m.hasOwnProperty(v)}function d(v){return v.path===void 0&&!m.hasOwnProperty(v.name)}var m={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return i}var math=!0,name="import",factory_1=factory,lazy_1=!0,_import={math,name,factory:factory_1,lazy:lazy_1};function factory$1(l,t,e,n,r){var i=["Matrix","Array"],a=["number","BigNumber","Fraction"];function s(o){if(o){var u=object.map(t,object.clone);validateOption(o,"matrix",i),validateOption(o,"number",a),object.deepExtend(t,o);var c=object.map(t,object.clone),f=object.map(o,object.clone);return r.emit("config",c,u,f),c}else return object.map(t,object.clone)}return s.MATRIX=i,s.NUMBER=a,s}function contains(l,t){return l.indexOf(t)!==-1}function findIndex(l,t){return l.map(function(e){return e.toLowerCase()}).indexOf(t.toLowerCase())}function validateOption(l,t,e){if(l[t]!==void 0&&!contains(e,l[t])){var n=findIndex(e,l[t]);n!==-1?(console.warn('Warning: Wrong casing for configuration option "'+t+'", should be "'+e[n]+'" instead of "'+l[t]+'".'),l[t]=e[n]):console.warn('Warning: Unknown value "'+l[t]+'" for configuration option "'+t+'". Available options: '+e.map(JSON.stringify).join(", ")+".")}}var name$1="config",math$1=!0,factory_1$1=factory$1,config={name:name$1,math:math$1,factory:factory_1$1},isFactory$1=object.isFactory,create$1=function(t){if(typeof Object.create!="function")throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var e=[],n=[],r=emitter.mixin({});r.type={},r.expression={transform:{},mathWithTransform:{}},r.typed=typed.create(r.type);var i={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function a(s){if(!isFactory$1(s))throw new Error("Factory object with properties `type`, `name`, and `factory` expected");var o=e.indexOf(s),u;return o===-1?(s.math===!0?u=s.factory(r.type,i,a,r.typed,r):u=s.factory(r.type,i,a,r.typed),e.push(s),n.push(u)):u=n[o],u}return r.import=a(_import),r.config=a(config),r.expression.mathWithTransform.config=r.config,t&&r.config(t),r},core={create:create$1},core$1=core,decimal=createCommonjsModule(function(l){(function(t){var e=9e15,n=1e9,r="0123456789abcdef",i="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",a="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",s={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-e,maxE:e,crypto:!1},o,u,c,f,p=!0,d="[DecimalError] ",m=d+"Invalid argument: ",v=d+"Precision limit exceeded",h=d+"crypto unavailable",y=Math.floor,g=Math.pow,b=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,x=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,N=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,C=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_=1e7,w=7,A=9007199254740991,$=i.length-1,S=a.length-1,D={name:"[object Decimal]"};D.absoluteValue=D.abs=function(){var M=new this.constructor(this);return M.s<0&&(M.s=1),G(M)},D.ceil=function(){return G(new this.constructor(this),this.e+1,2)},D.comparedTo=D.cmp=function(M){var L,k,B,U,j=this,ee=j.d,ie=(M=new j.constructor(M)).d,fe=j.s,le=M.s;if(!ee||!ie)return!fe||!le?NaN:fe!==le?fe:ee===ie?0:!ee^fe<0?1:-1;if(!ee[0]||!ie[0])return ee[0]?fe:ie[0]?-le:0;if(fe!==le)return fe;if(j.e!==M.e)return j.e>M.e^fe<0?1:-1;for(B=ee.length,U=ie.length,L=0,k=B<U?B:U;L<k;++L)if(ee[L]!==ie[L])return ee[L]>ie[L]^fe<0?1:-1;return B===U?0:B>U^fe<0?1:-1},D.cosine=D.cos=function(){var M,L,k=this,B=k.constructor;return k.d?k.d[0]?(M=B.precision,L=B.rounding,B.precision=M+Math.max(k.e,k.sd())+w,B.rounding=1,k=E(B,de(B,k)),B.precision=M,B.rounding=L,G(f==2||f==3?k.neg():k,M,L,!0)):new B(1):new B(NaN)},D.cubeRoot=D.cbrt=function(){var M,L,k,B,U,j,ee,ie,fe,le,ye=this,be=ye.constructor;if(!ye.isFinite()||ye.isZero())return new be(ye);for(p=!1,j=ye.s*Math.pow(ye.s*ye,1/3),!j||Math.abs(j)==1/0?(k=V(ye.d),M=ye.e,(j=(M-k.length+1)%3)&&(k+=j==1||j==-2?"0":"00"),j=Math.pow(k,1/3),M=y((M+1)/3)-(M%3==(M<0?-1:2)),j==1/0?k="5e"+M:(k=j.toExponential(),k=k.slice(0,k.indexOf("e")+1)+M),B=new be(k),B.s=ye.s):B=new be(j.toString()),ee=(M=be.precision)+3;;)if(ie=B,fe=ie.times(ie).times(ie),le=fe.plus(ye),B=W(le.plus(ye).times(ie),le.plus(fe),ee+2,1),V(ie.d).slice(0,ee)===(k=V(B.d)).slice(0,ee))if(k=k.slice(ee-3,ee+1),k=="9999"||!U&&k=="4999"){if(!U&&(G(ie,M+1,0),ie.times(ie).times(ie).eq(ye))){B=ie;break}ee+=4,U=1}else{(!+k||!+k.slice(1)&&k.charAt(0)=="5")&&(G(B,M+1,1),L=!B.times(B).times(B).eq(ye));break}return p=!0,G(B,M,be.rounding,L)},D.decimalPlaces=D.dp=function(){var M,L=this.d,k=NaN;if(L){if(M=L.length-1,k=(M-y(this.e/w))*w,M=L[M],M)for(;M%10==0;M/=10)k--;k<0&&(k=0)}return k},D.dividedBy=D.div=function(M){return W(this,new this.constructor(M))},D.dividedToIntegerBy=D.divToInt=function(M){var L=this,k=L.constructor;return G(W(L,new k(M),0,1,1),k.precision,k.rounding)},D.equals=D.eq=function(M){return this.cmp(M)===0},D.floor=function(){return G(new this.constructor(this),this.e+1,3)},D.greaterThan=D.gt=function(M){return this.cmp(M)>0},D.greaterThanOrEqualTo=D.gte=function(M){var L=this.cmp(M);return L==1||L===0},D.hyperbolicCosine=D.cosh=function(){var M,L,k,B,U,j=this,ee=j.constructor,ie=new ee(1);if(!j.isFinite())return new ee(j.s?1/0:NaN);if(j.isZero())return ie;k=ee.precision,B=ee.rounding,ee.precision=k+Math.max(j.e,j.sd())+4,ee.rounding=1,U=j.d.length,U<32?(M=Math.ceil(U/3),L=Math.pow(4,-M).toString()):(M=16,L="2.3283064365386962890625e-10"),j=te(ee,1,j.times(L),new ee(1),!0);for(var fe,le=M,ye=new ee(8);le--;)fe=j.times(j),j=ie.minus(fe.times(ye.minus(fe.times(ye))));return G(j,ee.precision=k,ee.rounding=B,!0)},D.hyperbolicSine=D.sinh=function(){var M,L,k,B,U=this,j=U.constructor;if(!U.isFinite()||U.isZero())return new j(U);if(L=j.precision,k=j.rounding,j.precision=L+Math.max(U.e,U.sd())+4,j.rounding=1,B=U.d.length,B<3)U=te(j,2,U,U,!0);else{M=1.4*Math.sqrt(B),M=M>16?16:M|0,U=U.times(Math.pow(5,-M)),U=te(j,2,U,U,!0);for(var ee,ie=new j(5),fe=new j(16),le=new j(20);M--;)ee=U.times(U),U=U.times(ie.plus(ee.times(fe.times(ee).plus(le))))}return j.precision=L,j.rounding=k,G(U,L,k,!0)},D.hyperbolicTangent=D.tanh=function(){var M,L,k=this,B=k.constructor;return k.isFinite()?k.isZero()?new B(k):(M=B.precision,L=B.rounding,B.precision=M+7,B.rounding=1,W(k.sinh(),k.cosh(),B.precision=M,B.rounding=L)):new B(k.s)},D.inverseCosine=D.acos=function(){var M,L=this,k=L.constructor,B=L.abs().cmp(1),U=k.precision,j=k.rounding;return B!==-1?B===0?L.isNeg()?Y(k,U,j):new k(0):new k(NaN):L.isZero()?Y(k,U+4,j).times(.5):(k.precision=U+6,k.rounding=1,L=L.asin(),M=Y(k,U+4,j).times(.5),k.precision=U,k.rounding=j,M.minus(L))},D.inverseHyperbolicCosine=D.acosh=function(){var M,L,k=this,B=k.constructor;return k.lte(1)?new B(k.eq(1)?0:NaN):k.isFinite()?(M=B.precision,L=B.rounding,B.precision=M+Math.max(Math.abs(k.e),k.sd())+4,B.rounding=1,p=!1,k=k.times(k).minus(1).sqrt().plus(k),p=!0,B.precision=M,B.rounding=L,k.ln()):new B(k)},D.inverseHyperbolicSine=D.asinh=function(){var M,L,k=this,B=k.constructor;return!k.isFinite()||k.isZero()?new B(k):(M=B.precision,L=B.rounding,B.precision=M+2*Math.max(Math.abs(k.e),k.sd())+6,B.rounding=1,p=!1,k=k.times(k).plus(1).sqrt().plus(k),p=!0,B.precision=M,B.rounding=L,k.ln())},D.inverseHyperbolicTangent=D.atanh=function(){var M,L,k,B,U=this,j=U.constructor;return U.isFinite()?U.e>=0?new j(U.abs().eq(1)?U.s/0:U.isZero()?U:NaN):(M=j.precision,L=j.rounding,B=U.sd(),Math.max(B,M)<2*-U.e-1?G(new j(U),M,L,!0):(j.precision=k=B-U.e,U=W(U.plus(1),new j(1).minus(U),k+M,1),j.precision=M+4,j.rounding=1,U=U.ln(),j.precision=M,j.rounding=L,U.times(.5))):new j(NaN)},D.inverseSine=D.asin=function(){var M,L,k,B,U=this,j=U.constructor;return U.isZero()?new j(U):(L=U.abs().cmp(1),k=j.precision,B=j.rounding,L!==-1?L===0?(M=Y(j,k+4,B).times(.5),M.s=U.s,M):new j(NaN):(j.precision=k+6,j.rounding=1,U=U.div(new j(1).minus(U.times(U)).sqrt().plus(1)).atan(),j.precision=k,j.rounding=B,U.times(2)))},D.inverseTangent=D.atan=function(){var M,L,k,B,U,j,ee,ie,fe,le=this,ye=le.constructor,be=ye.precision,xe=ye.rounding;if(le.isFinite()){if(le.isZero())return new ye(le);if(le.abs().eq(1)&&be+4<=S)return ee=Y(ye,be+4,xe).times(.25),ee.s=le.s,ee}else{if(!le.s)return new ye(NaN);if(be+4<=S)return ee=Y(ye,be+4,xe).times(.5),ee.s=le.s,ee}for(ye.precision=ie=be+10,ye.rounding=1,k=Math.min(28,ie/w+2|0),M=k;M;--M)le=le.div(le.times(le).plus(1).sqrt().plus(1));for(p=!1,L=Math.ceil(ie/w),B=1,fe=le.times(le),ee=new ye(le),U=le;M!==-1;)if(U=U.times(fe),j=ee.minus(U.div(B+=2)),U=U.times(fe),ee=j.plus(U.div(B+=2)),ee.d[L]!==void 0)for(M=L;ee.d[M]===j.d[M]&&M--;);return k&&(ee=ee.times(2<<k-1)),p=!0,G(ee,ye.precision=be,ye.rounding=xe,!0)},D.isFinite=function(){return!!this.d},D.isInteger=D.isInt=function(){return!!this.d&&y(this.e/w)>this.d.length-2},D.isNaN=function(){return!this.s},D.isNegative=D.isNeg=function(){return this.s<0},D.isPositive=D.isPos=function(){return this.s>0},D.isZero=function(){return!!this.d&&this.d[0]===0},D.lessThan=D.lt=function(M){return this.cmp(M)<0},D.lessThanOrEqualTo=D.lte=function(M){return this.cmp(M)<1},D.logarithm=D.log=function(M){var L,k,B,U,j,ee,ie,fe,le=this,ye=le.constructor,be=ye.precision,xe=ye.rounding,Ie=5;if(M==null)M=new ye(10),L=!0;else{if(M=new ye(M),k=M.d,M.s<0||!k||!k[0]||M.eq(1))return new ye(NaN);L=M.eq(10)}if(k=le.d,le.s<0||!k||!k[0]||le.eq(1))return new ye(k&&!k[0]?-1/0:le.s!=1?NaN:k?0:1/0);if(L)if(k.length>1)j=!0;else{for(U=k[0];U%10==0;)U/=10;j=U!==1}if(p=!1,ie=be+Ie,ee=Z(le,ie),B=L?ne(ye,ie+10):Z(M,ie),fe=W(ee,B,ie,1),q(fe.d,U=be,xe))do if(ie+=10,ee=Z(le,ie),B=L?ne(ye,ie+10):Z(M,ie),fe=W(ee,B,ie,1),!j){+V(fe.d).slice(U+1,U+15)+1==1e14&&(fe=G(fe,be+1,0));break}while(q(fe.d,U+=10,xe));return p=!0,G(fe,be,xe)},D.minus=D.sub=function(M){var L,k,B,U,j,ee,ie,fe,le,ye,be,xe,Ie=this,ze=Ie.constructor;if(M=new ze(M),!Ie.d||!M.d)return!Ie.s||!M.s?M=new ze(NaN):Ie.d?M.s=-M.s:M=new ze(M.d||Ie.s!==M.s?Ie:NaN),M;if(Ie.s!=M.s)return M.s=-M.s,Ie.plus(M);if(le=Ie.d,xe=M.d,ie=ze.precision,fe=ze.rounding,!le[0]||!xe[0]){if(xe[0])M.s=-M.s;else if(le[0])M=new ze(Ie);else return new ze(-0);return p?G(M,ie,fe):M}if(k=y(M.e/w),ye=y(Ie.e/w),le=le.slice(),j=ye-k,j){for(be=j<0,be?(L=le,j=-j,ee=xe.length):(L=xe,k=ye,ee=le.length),B=Math.max(Math.ceil(ie/w),ee)+2,j>B&&(j=B,L.length=1),L.reverse(),B=j;B--;)L.push(0);L.reverse()}else{for(B=le.length,ee=xe.length,be=B<ee,be&&(ee=B),B=0;B<ee;B++)if(le[B]!=xe[B]){be=le[B]<xe[B];break}j=0}for(be&&(L=le,le=xe,xe=L,M.s=-M.s),ee=le.length,B=xe.length-ee;B>0;--B)le[ee++]=0;for(B=xe.length;B>j;){if(le[--B]<xe[B]){for(U=B;U&&le[--U]===0;)le[U]=_-1;--le[U],le[B]+=_}le[B]-=xe[B]}for(;le[--ee]===0;)le.pop();for(;le[0]===0;le.shift())--k;return le[0]?(M.d=le,M.e=Q(le,k),p?G(M,ie,fe):M):new ze(-0)},D.modulo=D.mod=function(M){var L,k=this,B=k.constructor;return M=new B(M),!k.d||!M.s||M.d&&!M.d[0]?new B(NaN):!M.d||k.d&&!k.d[0]?G(new B(k),B.precision,B.rounding):(p=!1,B.modulo==9?(L=W(k,M.abs(),0,3,1),L.s*=M.s):L=W(k,M,0,B.modulo,1),L=L.times(M),p=!0,k.minus(L))},D.naturalExponential=D.exp=function(){return z(this)},D.naturalLogarithm=D.ln=function(){return Z(this)},D.negated=D.neg=function(){var M=new this.constructor(this);return M.s=-M.s,G(M)},D.plus=D.add=function(M){var L,k,B,U,j,ee,ie,fe,le,ye,be=this,xe=be.constructor;if(M=new xe(M),!be.d||!M.d)return!be.s||!M.s?M=new xe(NaN):be.d||(M=new xe(M.d||be.s===M.s?be:NaN)),M;if(be.s!=M.s)return M.s=-M.s,be.minus(M);if(le=be.d,ye=M.d,ie=xe.precision,fe=xe.rounding,!le[0]||!ye[0])return ye[0]||(M=new xe(be)),p?G(M,ie,fe):M;if(j=y(be.e/w),B=y(M.e/w),le=le.slice(),U=j-B,U){for(U<0?(k=le,U=-U,ee=ye.length):(k=ye,B=j,ee=le.length),j=Math.ceil(ie/w),ee=j>ee?j+1:ee+1,U>ee&&(U=ee,k.length=1),k.reverse();U--;)k.push(0);k.reverse()}for(ee=le.length,U=ye.length,ee-U<0&&(U=ee,k=ye,ye=le,le=k),L=0;U;)L=(le[--U]=le[U]+ye[U]+L)/_|0,le[U]%=_;for(L&&(le.unshift(L),++B),ee=le.length;le[--ee]==0;)le.pop();return M.d=le,M.e=Q(le,B),p?G(M,ie,fe):M},D.precision=D.sd=function(M){var L,k=this;if(M!==void 0&&M!==!!M&&M!==1&&M!==0)throw Error(m+M);return k.d?(L=se(k.d),M&&k.e+1>L&&(L=k.e+1)):L=NaN,L},D.round=function(){var M=this,L=M.constructor;return G(new L(M),M.e+1,L.rounding)},D.sine=D.sin=function(){var M,L,k=this,B=k.constructor;return k.isFinite()?k.isZero()?new B(k):(M=B.precision,L=B.rounding,B.precision=M+Math.max(k.e,k.sd())+w,B.rounding=1,k=X(B,de(B,k)),B.precision=M,B.rounding=L,G(f>2?k.neg():k,M,L,!0)):new B(NaN)},D.squareRoot=D.sqrt=function(){var M,L,k,B,U,j,ee=this,ie=ee.d,fe=ee.e,le=ee.s,ye=ee.constructor;if(le!==1||!ie||!ie[0])return new ye(!le||le<0&&(!ie||ie[0])?NaN:ie?ee:1/0);for(p=!1,le=Math.sqrt(+ee),le==0||le==1/0?(L=V(ie),(L.length+fe)%2==0&&(L+="0"),le=Math.sqrt(L),fe=y((fe+1)/2)-(fe<0||fe%2),le==1/0?L="1e"+fe:(L=le.toExponential(),L=L.slice(0,L.indexOf("e")+1)+fe),B=new ye(L)):B=new ye(le.toString()),k=(fe=ye.precision)+3;;)if(j=B,B=j.plus(W(ee,j,k+2,1)).times(.5),V(j.d).slice(0,k)===(L=V(B.d)).slice(0,k))if(L=L.slice(k-3,k+1),L=="9999"||!U&&L=="4999"){if(!U&&(G(j,fe+1,0),j.times(j).eq(ee))){B=j;break}k+=4,U=1}else{(!+L||!+L.slice(1)&&L.charAt(0)=="5")&&(G(B,fe+1,1),M=!B.times(B).eq(ee));break}return p=!0,G(B,fe,ye.rounding,M)},D.tangent=D.tan=function(){var M,L,k=this,B=k.constructor;return k.isFinite()?k.isZero()?new B(k):(M=B.precision,L=B.rounding,B.precision=M+10,B.rounding=1,k=k.sin(),k.s=1,k=W(k,new B(1).minus(k.times(k)).sqrt(),M+10,0),B.precision=M,B.rounding=L,G(f==2||f==4?k.neg():k,M,L,!0)):new B(NaN)},D.times=D.mul=function(M){var L,k,B,U,j,ee,ie,fe,le,ye=this,be=ye.constructor,xe=ye.d,Ie=(M=new be(M)).d;if(M.s*=ye.s,!xe||!xe[0]||!Ie||!Ie[0])return new be(!M.s||xe&&!xe[0]&&!Ie||Ie&&!Ie[0]&&!xe?NaN:!xe||!Ie?M.s/0:M.s*0);for(k=y(ye.e/w)+y(M.e/w),fe=xe.length,le=Ie.length,fe<le&&(j=xe,xe=Ie,Ie=j,ee=fe,fe=le,le=ee),j=[],ee=fe+le,B=ee;B--;)j.push(0);for(B=le;--B>=0;){for(L=0,U=fe+B;U>B;)ie=j[U]+Ie[B]*xe[U-B-1]+L,j[U--]=ie%_|0,L=ie/_|0;j[U]=(j[U]+L)%_|0}for(;!j[--ee];)j.pop();return L?++k:j.shift(),M.d=j,M.e=Q(j,k),p?G(M,be.precision,be.rounding):M},D.toBinary=function(M,L){return he(this,2,M,L)},D.toDecimalPlaces=D.toDP=function(M,L){var k=this,B=k.constructor;return k=new B(k),M===void 0?k:(I(M,0,n),L===void 0?L=B.rounding:I(L,0,8),G(k,M+k.e+1,L))},D.toExponential=function(M,L){var k,B=this,U=B.constructor;return M===void 0?k=P(B,!0):(I(M,0,n),L===void 0?L=U.rounding:I(L,0,8),B=G(new U(B),M+1,L),k=P(B,!0,M+1)),B.isNeg()&&!B.isZero()?"-"+k:k},D.toFixed=function(M,L){var k,B,U=this,j=U.constructor;return M===void 0?k=P(U):(I(M,0,n),L===void 0?L=j.rounding:I(L,0,8),B=G(new j(U),M+U.e+1,L),k=P(B,!1,M+B.e+1)),U.isNeg()&&!U.isZero()?"-"+k:k},D.toFraction=function(M){var L,k,B,U,j,ee,ie,fe,le,ye,be,xe,Ie=this,ze=Ie.d,Le=Ie.constructor;if(!ze)return new Le(Ie);if(le=k=new Le(1),B=fe=new Le(0),L=new Le(B),j=L.e=se(ze)-Ie.e-1,ee=j%w,L.d[0]=g(10,ee<0?w+ee:ee),M==null)M=j>0?L:le;else{if(ie=new Le(M),!ie.isInt()||ie.lt(le))throw Error(m+ie);M=ie.gt(L)?j>0?L:le:ie}for(p=!1,ie=new Le(V(ze)),ye=Le.precision,Le.precision=j=ze.length*w*2;be=W(ie,L,0,1,1),U=k.plus(be.times(B)),U.cmp(M)!=1;)k=B,B=U,U=le,le=fe.plus(be.times(U)),fe=U,U=L,L=ie.minus(be.times(U)),ie=U;return U=W(M.minus(k),B,0,1,1),fe=fe.plus(U.times(le)),k=k.plus(U.times(B)),fe.s=le.s=Ie.s,xe=W(le,B,j,1).minus(Ie).abs().cmp(W(fe,k,j,1).minus(Ie).abs())<1?[le,B]:[fe,k],Le.precision=ye,p=!0,xe},D.toHexadecimal=D.toHex=function(M,L){return he(this,16,M,L)},D.toNearest=function(M,L){var k=this,B=k.constructor;if(k=new B(k),M==null){if(!k.d)return k;M=new B(1),L=B.rounding}else{if(M=new B(M),L!==void 0&&I(L,0,8),!k.d)return M.s?k:M;if(!M.d)return M.s&&(M.s=k.s),M}return M.d[0]?(p=!1,L<4&&(L=[4,5,7,8][L]),k=W(k,M,0,L,1).times(M),p=!0,G(k)):(M.s=k.s,k=M),k},D.toNumber=function(){return+this},D.toOctal=function(M,L){return he(this,8,M,L)},D.toPower=D.pow=function(M){var L,k,B,U,j,ee,ie=this,fe=ie.constructor,le=+(M=new fe(M));if(!ie.d||!M.d||!ie.d[0]||!M.d[0])return new fe(g(+ie,le));if(ie=new fe(ie),ie.eq(1))return ie;if(B=fe.precision,j=fe.rounding,M.eq(1))return G(ie,B,j);if(L=y(M.e/w),L>=M.d.length-1&&(k=le<0?-le:le)<=A)return U=oe(fe,ie,k,B),M.s<0?new fe(1).div(U):G(U,B,j);if(ee=ie.s,ee<0){if(L<M.d.length-1)return new fe(NaN);if((M.d[L]&1)==0&&(ee=1),ie.e==0&&ie.d[0]==1&&ie.d.length==1)return ie.s=ee,ie}return k=g(+ie,le),L=k==0||!isFinite(k)?y(le*(Math.log("0."+V(ie.d))/Math.LN10+ie.e+1)):new fe(k+"").e,L>fe.maxE+1||L<fe.minE-1?new fe(L>0?ee/0:0):(p=!1,fe.rounding=ie.s=1,k=Math.min(12,(L+"").length),U=z(M.times(Z(ie,B+k)),B),U.d&&(U=G(U,B+5,1),q(U.d,B,j)&&(L=B+10,U=G(z(M.times(Z(ie,L+k)),L),L+5,1),+V(U.d).slice(B+1,B+15)+1==1e14&&(U=G(U,B+1,0)))),U.s=ee,p=!0,fe.rounding=j,G(U,B,j))},D.toPrecision=function(M,L){var k,B=this,U=B.constructor;return M===void 0?k=P(B,B.e<=U.toExpNeg||B.e>=U.toExpPos):(I(M,1,n),L===void 0?L=U.rounding:I(L,0,8),B=G(new U(B),M,L),k=P(B,M<=B.e||B.e<=U.toExpNeg,M)),B.isNeg()&&!B.isZero()?"-"+k:k},D.toSignificantDigits=D.toSD=function(M,L){var k=this,B=k.constructor;return M===void 0?(M=B.precision,L=B.rounding):(I(M,1,n),L===void 0?L=B.rounding:I(L,0,8)),G(new B(k),M,L)},D.toString=function(){var M=this,L=M.constructor,k=P(M,M.e<=L.toExpNeg||M.e>=L.toExpPos);return M.isNeg()&&!M.isZero()?"-"+k:k},D.truncated=D.trunc=function(){return G(new this.constructor(this),this.e+1,1)},D.valueOf=D.toJSON=function(){var M=this,L=M.constructor,k=P(M,M.e<=L.toExpNeg||M.e>=L.toExpPos);return M.isNeg()?"-"+k:k};function V(M){var L,k,B,U=M.length-1,j="",ee=M[0];if(U>0){for(j+=ee,L=1;L<U;L++)B=M[L]+"",k=w-B.length,k&&(j+=pe(k)),j+=B;ee=M[L],B=ee+"",k=w-B.length,k&&(j+=pe(k))}else if(ee===0)return"0";for(;ee%10==0;)ee/=10;return j+ee}function I(M,L,k){if(M!==~~M||M<L||M>k)throw Error(m+M)}function q(M,L,k,B){var U,j,ee,ie;for(j=M[0];j>=10;j/=10)--L;return--L<0?(L+=w,U=0):(U=Math.ceil((L+1)/w),L%=w),j=g(10,w-L),ie=M[U]%j|0,B==null?L<3?(L==0?ie=ie/100|0:L==1&&(ie=ie/10|0),ee=k<4&&ie==99999||k>3&&ie==49999||ie==5e4||ie==0):ee=(k<4&&ie+1==j||k>3&&ie+1==j/2)&&(M[U+1]/j/100|0)==g(10,L-2)-1||(ie==j/2||ie==0)&&(M[U+1]/j/100|0)==0:L<4?(L==0?ie=ie/1e3|0:L==1?ie=ie/100|0:L==2&&(ie=ie/10|0),ee=(B||k<4)&&ie==9999||!B&&k>3&&ie==4999):ee=((B||k<4)&&ie+1==j||!B&&k>3&&ie+1==j/2)&&(M[U+1]/j/1e3|0)==g(10,L-3)-1,ee}function K(M,L,k){for(var B,U=[0],j,ee=0,ie=M.length;ee<ie;){for(j=U.length;j--;)U[j]*=L;for(U[0]+=r.indexOf(M.charAt(ee++)),B=0;B<U.length;B++)U[B]>k-1&&(U[B+1]===void 0&&(U[B+1]=0),U[B+1]+=U[B]/k|0,U[B]%=k)}return U.reverse()}function E(M,L){var k,B,U=L.d.length;U<32?(k=Math.ceil(U/3),B=Math.pow(4,-k).toString()):(k=16,B="2.3283064365386962890625e-10"),M.precision+=k,L=te(M,1,L.times(B),new M(1));for(var j=k;j--;){var ee=L.times(L);L=ee.times(ee).minus(ee).times(8).plus(1)}return M.precision-=k,L}var W=function(){function M(B,U,j){var ee,ie=0,fe=B.length;for(B=B.slice();fe--;)ee=B[fe]*U+ie,B[fe]=ee%j|0,ie=ee/j|0;return ie&&B.unshift(ie),B}function L(B,U,j,ee){var ie,fe;if(j!=ee)fe=j>ee?1:-1;else for(ie=fe=0;ie<j;ie++)if(B[ie]!=U[ie]){fe=B[ie]>U[ie]?1:-1;break}return fe}function k(B,U,j,ee){for(var ie=0;j--;)B[j]-=ie,ie=B[j]<U[j]?1:0,B[j]=ie*ee+B[j]-U[j];for(;!B[0]&&B.length>1;)B.shift()}return function(B,U,j,ee,ie,fe){var le,ye,be,xe,Ie,ze,Le,At,et,Ut,Ge,Ct,xi,fr,Ra,Ci,jn,ka,Ht,Ni,wi=B.constructor,Fa=B.s==U.s?1:-1,Nt=B.d,Ze=U.d;if(!Nt||!Nt[0]||!Ze||!Ze[0])return new wi(!B.s||!U.s||(Nt?Ze&&Nt[0]==Ze[0]:!Ze)?NaN:Nt&&Nt[0]==0||!Ze?Fa*0:Fa/0);for(fe?(Ie=1,ye=B.e-U.e):(fe=_,Ie=w,ye=y(B.e/Ie)-y(U.e/Ie)),Ht=Ze.length,jn=Nt.length,et=new wi(Fa),Ut=et.d=[],be=0;Ze[be]==(Nt[be]||0);be++);if(Ze[be]>(Nt[be]||0)&&ye--,j==null?(fr=j=wi.precision,ee=wi.rounding):ie?fr=j+(B.e-U.e)+1:fr=j,fr<0)Ut.push(1),ze=!0;else{if(fr=fr/Ie+2|0,be=0,Ht==1){for(xe=0,Ze=Ze[0],fr++;(be<jn||xe)&&fr--;be++)Ra=xe*fe+(Nt[be]||0),Ut[be]=Ra/Ze|0,xe=Ra%Ze|0;ze=xe||be<jn}else{for(xe=fe/(Ze[0]+1)|0,xe>1&&(Ze=M(Ze,xe,fe),Nt=M(Nt,xe,fe),Ht=Ze.length,jn=Nt.length),Ci=Ht,Ge=Nt.slice(0,Ht),Ct=Ge.length;Ct<Ht;)Ge[Ct++]=0;Ni=Ze.slice(),Ni.unshift(0),ka=Ze[0],Ze[1]>=fe/2&&++ka;do xe=0,le=L(Ze,Ge,Ht,Ct),le<0?(xi=Ge[0],Ht!=Ct&&(xi=xi*fe+(Ge[1]||0)),xe=xi/ka|0,xe>1?(xe>=fe&&(xe=fe-1),Le=M(Ze,xe,fe),At=Le.length,Ct=Ge.length,le=L(Le,Ge,At,Ct),le==1&&(xe--,k(Le,Ht<At?Ni:Ze,At,fe))):(xe==0&&(le=xe=1),Le=Ze.slice()),At=Le.length,At<Ct&&Le.unshift(0),k(Ge,Le,Ct,fe),le==-1&&(Ct=Ge.length,le=L(Ze,Ge,Ht,Ct),le<1&&(xe++,k(Ge,Ht<Ct?Ni:Ze,Ct,fe))),Ct=Ge.length):le===0&&(xe++,Ge=[0]),Ut[be++]=xe,le&&Ge[0]?Ge[Ct++]=Nt[Ci]||0:(Ge=[Nt[Ci]],Ct=1);while((Ci++<jn||Ge[0]!==void 0)&&fr--);ze=Ge[0]!==void 0}Ut[0]||Ut.shift()}if(Ie==1)et.e=ye,u=ze;else{for(be=1,xe=Ut[0];xe>=10;xe/=10)be++;et.e=be+ye*Ie-1,G(et,ie?j+et.e+1:j,ee,ze)}return et}}();function G(M,L,k,B){var U,j,ee,ie,fe,le,ye,be,xe,Ie=M.constructor;e:if(L!=null){if(be=M.d,!be)return M;for(U=1,ie=be[0];ie>=10;ie/=10)U++;if(j=L-U,j<0)j+=w,ee=L,ye=be[xe=0],fe=ye/g(10,U-ee-1)%10|0;else if(xe=Math.ceil((j+1)/w),ie=be.length,xe>=ie)if(B){for(;ie++<=xe;)be.push(0);ye=fe=0,U=1,j%=w,ee=j-w+1}else break e;else{for(ye=ie=be[xe],U=1;ie>=10;ie/=10)U++;j%=w,ee=j-w+U,fe=ee<0?0:ye/g(10,U-ee-1)%10|0}if(B=B||L<0||be[xe+1]!==void 0||(ee<0?ye:ye%g(10,U-ee-1)),le=k<4?(fe||B)&&(k==0||k==(M.s<0?3:2)):fe>5||fe==5&&(k==4||B||k==6&&(j>0?ee>0?ye/g(10,U-ee):0:be[xe-1])%10&1||k==(M.s<0?8:7)),L<1||!be[0])return be.length=0,le?(L-=M.e+1,be[0]=g(10,(w-L%w)%w),M.e=-L||0):be[0]=M.e=0,M;if(j==0?(be.length=xe,ie=1,xe--):(be.length=xe+1,ie=g(10,w-j),be[xe]=ee>0?(ye/g(10,U-ee)%g(10,ee)|0)*ie:0),le)for(;;)if(xe==0){for(j=1,ee=be[0];ee>=10;ee/=10)j++;for(ee=be[0]+=ie,ie=1;ee>=10;ee/=10)ie++;j!=ie&&(M.e++,be[0]==_&&(be[0]=1));break}else{if(be[xe]+=ie,be[xe]!=_)break;be[xe--]=0,ie=1}for(j=be.length;be[--j]===0;)be.pop()}return p&&(M.e>Ie.maxE?(M.d=null,M.e=NaN):M.e<Ie.minE&&(M.e=0,M.d=[0])),M}function P(M,L,k){if(!M.isFinite())return J(M);var B,U=M.e,j=V(M.d),ee=j.length;return L?(k&&(B=k-ee)>0?j=j.charAt(0)+"."+j.slice(1)+pe(B):ee>1&&(j=j.charAt(0)+"."+j.slice(1)),j=j+(M.e<0?"e":"e+")+M.e):U<0?(j="0."+pe(-U-1)+j,k&&(B=k-ee)>0&&(j+=pe(B))):U>=ee?(j+=pe(U+1-ee),k&&(B=k-U-1)>0&&(j=j+"."+pe(B))):((B=U+1)<ee&&(j=j.slice(0,B)+"."+j.slice(B)),k&&(B=k-ee)>0&&(U+1===ee&&(j+="."),j+=pe(B))),j}function Q(M,L){var k=M[0];for(L*=w;k>=10;k/=10)L++;return L}function ne(M,L,k){if(L>$)throw p=!0,k&&(M.precision=k),Error(v);return G(new M(i),L,1,!0)}function Y(M,L,k){if(L>S)throw Error(v);return G(new M(a),L,k,!0)}function se(M){var L=M.length-1,k=L*w+1;if(L=M[L],L){for(;L%10==0;L/=10)k--;for(L=M[0];L>=10;L/=10)k++}return k}function pe(M){for(var L="";M--;)L+="0";return L}function oe(M,L,k,B){var U,j=new M(1),ee=Math.ceil(B/w+4);for(p=!1;;){if(k%2&&(j=j.times(L),H(j.d,ee)&&(U=!0)),k=y(k/2),k===0){k=j.d.length-1,U&&j.d[k]===0&&++j.d[k];break}L=L.times(L),H(L.d,ee)}return p=!0,j}function ve(M){return M.d[M.d.length-1]&1}function O(M,L,k){for(var B,U=new M(L[0]),j=0;++j<L.length;)if(B=new M(L[j]),B.s)U[k](B)&&(U=B);else{U=B;break}return U}function z(M,L){var k,B,U,j,ee,ie,fe,le=0,ye=0,be=0,xe=M.constructor,Ie=xe.rounding,ze=xe.precision;if(!M.d||!M.d[0]||M.e>17)return new xe(M.d?M.d[0]?M.s<0?0:1/0:1:M.s?M.s<0?0:M:0/0);for(L==null?(p=!1,fe=ze):fe=L,ie=new xe(.03125);M.e>-2;)M=M.times(ie),be+=5;for(B=Math.log(g(2,be))/Math.LN10*2+5|0,fe+=B,k=j=ee=new xe(1),xe.precision=fe;;){if(j=G(j.times(M),fe,1),k=k.times(++ye),ie=ee.plus(W(j,k,fe,1)),V(ie.d).slice(0,fe)===V(ee.d).slice(0,fe)){for(U=be;U--;)ee=G(ee.times(ee),fe,1);if(L==null)if(le<3&&q(ee.d,fe-B,Ie,le))xe.precision=fe+=10,k=j=ie=new xe(1),ye=0,le++;else return G(ee,xe.precision=ze,Ie,p=!0);else return xe.precision=ze,ee}ee=ie}}function Z(M,L){var k,B,U,j,ee,ie,fe,le,ye,be,xe,Ie=1,ze=10,Le=M,At=Le.d,et=Le.constructor,Ut=et.rounding,Ge=et.precision;if(Le.s<0||!At||!At[0]||!Le.e&&At[0]==1&&At.length==1)return new et(At&&!At[0]?-1/0:Le.s!=1?NaN:At?0:Le);if(L==null?(p=!1,ye=Ge):ye=L,et.precision=ye+=ze,k=V(At),B=k.charAt(0),Math.abs(j=Le.e)<15e14){for(;B<7&&B!=1||B==1&&k.charAt(1)>3;)Le=Le.times(M),k=V(Le.d),B=k.charAt(0),Ie++;j=Le.e,B>1?(Le=new et("0."+k),j++):Le=new et(B+"."+k.slice(1))}else return le=ne(et,ye+2,Ge).times(j+""),Le=Z(new et(B+"."+k.slice(1)),ye-ze).plus(le),et.precision=Ge,L==null?G(Le,Ge,Ut,p=!0):Le;for(be=Le,fe=ee=Le=W(Le.minus(1),Le.plus(1),ye,1),xe=G(Le.times(Le),ye,1),U=3;;){if(ee=G(ee.times(xe),ye,1),le=fe.plus(W(ee,new et(U),ye,1)),V(le.d).slice(0,ye)===V(fe.d).slice(0,ye))if(fe=fe.times(2),j!==0&&(fe=fe.plus(ne(et,ye+2,Ge).times(j+""))),fe=W(fe,new et(Ie),ye,1),L==null)if(q(fe.d,ye-ze,Ut,ie))et.precision=ye+=ze,le=ee=Le=W(be.minus(1),be.plus(1),ye,1),xe=G(Le.times(Le),ye,1),U=ie=1;else return G(fe,et.precision=Ge,Ut,p=!0);else return et.precision=Ge,fe;fe=le,U+=2}}function J(M){return String(M.s*M.s/0)}function R(M,L){var k,B,U;for((k=L.indexOf("."))>-1&&(L=L.replace(".","")),(B=L.search(/e/i))>0?(k<0&&(k=B),k+=+L.slice(B+1),L=L.substring(0,B)):k<0&&(k=L.length),B=0;L.charCodeAt(B)===48;B++);for(U=L.length;L.charCodeAt(U-1)===48;--U);if(L=L.slice(B,U),L){if(U-=B,M.e=k=k-B-1,M.d=[],B=(k+1)%w,k<0&&(B+=w),B<U){for(B&&M.d.push(+L.slice(0,B)),U-=w;B<U;)M.d.push(+L.slice(B,B+=w));L=L.slice(B),B=w-L.length}else B-=U;for(;B--;)L+="0";M.d.push(+L),p&&(M.e>M.constructor.maxE?(M.d=null,M.e=NaN):M.e<M.constructor.minE&&(M.e=0,M.d=[0]))}else M.e=0,M.d=[0];return M}function F(M,L){var k,B,U,j,ee,ie,fe,le,ye;if(L==="Infinity"||L==="NaN")return+L||(M.s=NaN),M.e=NaN,M.d=null,M;if(x.test(L))k=16,L=L.toLowerCase();else if(b.test(L))k=2;else if(N.test(L))k=8;else throw Error(m+L);for(j=L.search(/p/i),j>0?(fe=+L.slice(j+1),L=L.substring(2,j)):L=L.slice(2),j=L.indexOf("."),ee=j>=0,B=M.constructor,ee&&(L=L.replace(".",""),ie=L.length,j=ie-j,U=oe(B,new B(k),j,j*2)),le=K(L,k,_),ye=le.length-1,j=ye;le[j]===0;--j)le.pop();return j<0?new B(M.s*0):(M.e=Q(le,ye),M.d=le,p=!1,ee&&(M=W(M,U,ie*4)),fe&&(M=M.times(Math.abs(fe)<54?Math.pow(2,fe):o.pow(2,fe))),p=!0,M)}function X(M,L){var k,B=L.d.length;if(B<3)return te(M,2,L,L);k=1.4*Math.sqrt(B),k=k>16?16:k|0,L=L.times(Math.pow(5,-k)),L=te(M,2,L,L);for(var U,j=new M(5),ee=new M(16),ie=new M(20);k--;)U=L.times(L),L=L.times(j.plus(U.times(ee.times(U).minus(ie))));return L}function te(M,L,k,B,U){var j,ee,ie,fe,le=M.precision,ye=Math.ceil(le/w);for(p=!1,fe=k.times(k),ie=new M(B);;){if(ee=W(ie.times(fe),new M(L++*L++),le,1),ie=U?B.plus(ee):B.minus(ee),B=W(ee.times(fe),new M(L++*L++),le,1),ee=ie.plus(B),ee.d[ye]!==void 0){for(j=ye;ee.d[j]===ie.d[j]&&j--;);if(j==-1)break}j=ie,ie=B,B=ee,ee=j}return p=!0,ee.d.length=ye+1,ee}function de(M,L){var k,B=L.s<0,U=Y(M,M.precision,1),j=U.times(.5);if(L=L.abs(),L.lte(j))return f=B?4:1,L;if(k=L.divToInt(U),k.isZero())f=B?3:2;else{if(L=L.minus(k.times(U)),L.lte(j))return f=ve(k)?B?2:3:B?4:1,L;f=ve(k)?B?1:4:B?3:2}return L.minus(U).abs()}function he(M,L,k,B){var U,j,ee,ie,fe,le,ye,be,xe,Ie=M.constructor,ze=k!==void 0;if(ze?(I(k,1,n),B===void 0?B=Ie.rounding:I(B,0,8)):(k=Ie.precision,B=Ie.rounding),!M.isFinite())ye=J(M);else{for(ye=P(M),ee=ye.indexOf("."),ze?(U=2,L==16?k=k*4-3:L==8&&(k=k*3-2)):U=L,ee>=0&&(ye=ye.replace(".",""),xe=new Ie(1),xe.e=ye.length-ee,xe.d=K(P(xe),10,U),xe.e=xe.d.length),be=K(ye,10,U),j=fe=be.length;be[--fe]==0;)be.pop();if(!be[0])ye=ze?"0p+0":"0";else{if(ee<0?j--:(M=new Ie(M),M.d=be,M.e=j,M=W(M,xe,k,B,0,U),be=M.d,j=M.e,le=u),ee=be[k],ie=U/2,le=le||be[k+1]!==void 0,le=B<4?(ee!==void 0||le)&&(B===0||B===(M.s<0?3:2)):ee>ie||ee===ie&&(B===4||le||B===6&&be[k-1]&1||B===(M.s<0?8:7)),be.length=k,le)for(;++be[--k]>U-1;)be[k]=0,k||(++j,be.unshift(1));for(fe=be.length;!be[fe-1];--fe);for(ee=0,ye="";ee<fe;ee++)ye+=r.charAt(be[ee]);if(ze){if(fe>1)if(L==16||L==8){for(ee=L==16?4:3,--fe;fe%ee;fe++)ye+="0";for(be=K(ye,U,L),fe=be.length;!be[fe-1];--fe);for(ee=1,ye="1.";ee<fe;ee++)ye+=r.charAt(be[ee])}else ye=ye.charAt(0)+"."+ye.slice(1);ye=ye+(j<0?"p":"p+")+j}else if(j<0){for(;++j;)ye="0"+ye;ye="0."+ye}else if(++j>fe)for(j-=fe;j--;)ye+="0";else j<fe&&(ye=ye.slice(0,j)+"."+ye.slice(j))}ye=(L==16?"0x":L==2?"0b":L==8?"0o":"")+ye}return M.s<0?"-"+ye:ye}function H(M,L){if(M.length>L)return M.length=L,!0}function re(M){return new this(M).abs()}function ce(M){return new this(M).acos()}function ue(M){return new this(M).acosh()}function Ce(M,L){return new this(M).plus(L)}function Ne(M){return new this(M).asin()}function Te(M){return new this(M).asinh()}function $e(M){return new this(M).atan()}function Ae(M){return new this(M).atanh()}function Ve(M,L){M=new this(M),L=new this(L);var k,B=this.precision,U=this.rounding,j=B+4;return!M.s||!L.s?k=new this(NaN):!M.d&&!L.d?(k=Y(this,j,1).times(L.s>0?.25:.75),k.s=M.s):!L.d||M.isZero()?(k=L.s<0?Y(this,B,U):new this(0),k.s=M.s):!M.d||L.isZero()?(k=Y(this,j,1).times(.5),k.s=M.s):L.s<0?(this.precision=j,this.rounding=1,k=this.atan(W(M,L,j,1)),L=Y(this,j,1),this.precision=B,this.rounding=U,k=M.s<0?k.minus(L):k.plus(L)):k=this.atan(W(M,L,j,1)),k}function Qe(M){return new this(M).cbrt()}function Je(M){return G(M=new this(M),M.e+1,2)}function at(M){if(!M||typeof M!="object")throw Error(d+"Object expected");var L,k,B,U=M.defaults===!0,j=["precision",1,n,"rounding",0,8,"toExpNeg",-e,0,"toExpPos",0,e,"maxE",0,e,"minE",-e,0,"modulo",0,9];for(L=0;L<j.length;L+=3)if(k=j[L],U&&(this[k]=s[k]),(B=M[k])!==void 0)if(y(B)===B&&B>=j[L+1]&&B<=j[L+2])this[k]=B;else throw Error(m+k+": "+B);if(k="crypto",U&&(this[k]=s[k]),(B=M[k])!==void 0)if(B===!0||B===!1||B===0||B===1)if(B)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[k]=!0;else throw Error(h);else this[k]=!1;else throw Error(m+k+": "+B);return this}function Mt(M){return new this(M).cos()}function cr(M){return new this(M).cosh()}function en(M){var L,k,B;function U(j){var ee,ie,fe,le=this;if(!(le instanceof U))return new U(j);if(le.constructor=U,j instanceof U){le.s=j.s,le.e=j.e,le.d=(j=j.d)?j.slice():j;return}if(fe=typeof j,fe==="number"){if(j===0){le.s=1/j<0?-1:1,le.e=0,le.d=[0];return}if(j<0?(j=-j,le.s=-1):le.s=1,j===~~j&&j<1e7){for(ee=0,ie=j;ie>=10;ie/=10)ee++;le.e=ee,le.d=[j];return}else if(j*0!=0){j||(le.s=NaN),le.e=NaN,le.d=null;return}return R(le,j.toString())}else if(fe!=="string")throw Error(m+j);return j.charCodeAt(0)===45?(j=j.slice(1),le.s=-1):le.s=1,C.test(j)?R(le,j):F(le,j)}if(U.prototype=D,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=at,U.clone=en,U.isDecimal=rn,U.abs=re,U.acos=ce,U.acosh=ue,U.add=Ce,U.asin=Ne,U.asinh=Te,U.atan=$e,U.atanh=Ae,U.atan2=Ve,U.cbrt=Qe,U.ceil=Je,U.cos=Mt,U.cosh=cr,U.div=Yt,U.exp=Rn,U.floor=tn,U.hypot=kn,U.ln=Fn,U.log=Bn,U.log10=qt,U.log2=zn,U.max=nn,U.min=Xe,U.mod=an,U.mul=ae,U.pow=ge,U.random=we,U.round=Re,U.sign=Fe,U.sin=jt,U.sinh=qn,U.sqrt=Ma,U.sub=Oa,U.tan=Ea,U.tanh=Pa,U.trunc=La,M===void 0&&(M={}),M&&M.defaults!==!0)for(B=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],L=0;L<B.length;)M.hasOwnProperty(k=B[L++])||(M[k]=this[k]);return U.config(M),U}function Yt(M,L){return new this(M).div(L)}function Rn(M){return new this(M).exp()}function tn(M){return G(M=new this(M),M.e+1,3)}function kn(){var M,L,k=new this(0);for(p=!1,M=0;M<arguments.length;)if(L=new this(arguments[M++]),L.d)k.d&&(k=k.plus(L.times(L)));else{if(L.s)return p=!0,new this(1/0);k=L}return p=!0,k.sqrt()}function rn(M){return M instanceof o||M&&M.name==="[object Decimal]"||!1}function Fn(M){return new this(M).ln()}function Bn(M,L){return new this(M).log(L)}function zn(M){return new this(M).log(2)}function qt(M){return new this(M).log(10)}function nn(){return O(this,arguments,"lt")}function Xe(){return O(this,arguments,"gt")}function an(M,L){return new this(M).mod(L)}function ae(M,L){return new this(M).mul(L)}function ge(M,L){return new this(M).pow(L)}function we(M){var L,k,B,U,j=0,ee=new this(1),ie=[];if(M===void 0?M=this.precision:I(M,1,n),B=Math.ceil(M/w),this.crypto)if(crypto.getRandomValues)for(L=crypto.getRandomValues(new Uint32Array(B));j<B;)U=L[j],U>=429e7?L[j]=crypto.getRandomValues(new Uint32Array(1))[0]:ie[j++]=U%1e7;else if(crypto.randomBytes){for(L=crypto.randomBytes(B*=4);j<B;)U=L[j]+(L[j+1]<<8)+(L[j+2]<<16)+((L[j+3]&127)<<24),U>=214e7?crypto.randomBytes(4).copy(L,j):(ie.push(U%1e7),j+=4);j=B/4}else throw Error(h);else for(;j<B;)ie[j++]=Math.random()*1e7|0;for(B=ie[--j],M%=w,B&&M&&(U=g(10,w-M),ie[j]=(B/U|0)*U);ie[j]===0;j--)ie.pop();if(j<0)k=0,ie=[0];else{for(k=-1;ie[0]===0;k-=w)ie.shift();for(B=1,U=ie[0];U>=10;U/=10)B++;B<w&&(k-=w-B)}return ee.e=k,ee.d=ie,ee}function Re(M){return G(M=new this(M),M.e+1,this.rounding)}function Fe(M){return M=new this(M),M.d?M.d[0]?M.s:0*M.s:M.s||NaN}function jt(M){return new this(M).sin()}function qn(M){return new this(M).sinh()}function Ma(M){return new this(M).sqrt()}function Oa(M,L){return new this(M).sub(L)}function Ea(M){return new this(M).tan()}function Pa(M){return new this(M).tanh()}function La(M){return G(M=new this(M),M.e+1,1)}o=en(s),o.default=o.Decimal=o,i=new o(i),a=new o(a),l.exports?l.exports=o:(t||(t=typeof self!="undefined"&&self&&self.self==self?self:Function("return this")()),c=t.Decimal,o.noConflict=function(){return t.Decimal=c,o},t.Decimal=o)})(commonjsGlobal)});function factory$2(l,t,e,n,r){var i=decimal.clone({precision:t.precision});return i.prototype.type="BigNumber",i.prototype.isBigNumber=!0,i.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},i.fromJSON=function(a){return new i(a.value)},r.on("config",function(a,s){a.precision!==s.precision&&i.config({precision:a.precision})}),i}var name$2="BigNumber",path="type",factory_1$2=factory$2,math$2=!0,BigNumber={name:name$2,path,factory:factory_1$2,math:math$2},deepMap=function l(t,e,n){return t&&typeof t.map=="function"?t.map(function(r){return l(r,e,n)}):e(t)};function factory$3(l,t,e,n){var r=n("bignumber",{"":function(){return new l.BigNumber(0)},number:function(i){return new l.BigNumber(i+"")},string:function(i){return new l.BigNumber(i)},BigNumber:function(i){return i},Fraction:function(i){return new l.BigNumber(i.n).div(i.d)},null:function(i){return new l.BigNumber(0)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={0:"0",1:"\\left(${args[0]}\\right)"},r}var name$3="bignumber",factory_1$3=factory$3,bignumber={name:name$3,factory:factory_1$3},bignumber$1=[BigNumber,bignumber];function factory$4(l,t,e,n){var r=n("bool",{"":function(){return!1},boolean:function(i){return i},number:function(i){return!!i},null:function(i){return!1},BigNumber:function(i){return!i.isZero()},string:function(i){var a=i.toLowerCase();if(a==="true")return!0;if(a==="false")return!1;var s=Number(i);if(i!=""&&!isNaN(s))return!!s;throw new Error('Cannot convert "'+i+'" to a boolean')},"Array | Matrix":function(i){return deepMap(i,r)}});return r}var name$4="boolean",factory_1$4=factory$4,boolean_1={name:name$4,factory:factory_1$4},formatter=createCommonjsModule(function(l,t){t.format=function(e,n){if(typeof n=="function")return n(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var r="auto",i=void 0;switch(n!==void 0&&(n.notation&&(r=n.notation),typeof n=="number"?i=n:n.precision&&(i=n.precision)),r){case"fixed":return t.toFixed(e,i);case"exponential":return t.toExponential(e,i);case"auto":if(n&&n.exponential&&(n.exponential.lower!==void 0||n.exponential.upper!==void 0)){var a=object.map(n,function(f){return f});return a.exponential=void 0,n.exponential.lower!==void 0&&(a.lowerExp=Math.round(Math.log(n.exponential.lower)/Math.LN10)),n.exponential.upper!==void 0&&(a.upperExp=Math.round(Math.log(n.exponential.upper)/Math.LN10)),console.warn("Deprecation warning: Formatting options exponential.lower and exponential.upper (minimum and maximum value) are replaced with exponential.lowerExp and exponential.upperExp (minimum and maximum exponent) since version 4.0.0. Replace "+JSON.stringify(n)+" with "+JSON.stringify(a)),t.format(e,a)}var s=n&&n.lowerExp!==void 0?n.lowerExp:-3,o=n&&n.upperExp!==void 0?n.upperExp:5;if(e.isZero())return"0";var u,c=e.logarithm();return c.gte(s)&&c.lt(o)?u=e.toSignificantDigits(i).toFixed():u=t.toExponential(e,i),u.replace(/((\.\d*?)(0+))($|e)/,function(){var f=arguments[2],p=arguments[4];return f!=="."?f+p:p});default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}},t.toExponential=function(e,n){return n!==void 0?e.toExponential(n-1):e.toExponential()},t.toFixed=function(e,n){return e.toFixed(n)}}),formatter_1=formatter.format,formatter_2=formatter.toExponential,formatter_3=formatter.toFixed,string=createCommonjsModule(function(l,t){var e=number.format,n=formatter.format;t.isString=function(a){return typeof a=="string"},t.endsWith=function(a,s){var o=a.length-s.length,u=a.length;return a.substring(o,u)===s},t.format=function(a,s){if(typeof a=="number")return e(a,s);if(isBigNumber(a))return n(a,s);if(i(a))return!s||s.fraction!=="decimal"?a.s*a.n+"/"+a.d:a.toString();if(Array.isArray(a))return r(a,s);if(t.isString(a))return'"'+a+'"';if(typeof a=="function")return a.syntax?String(a.syntax):"function";if(a&&typeof a=="object"){if(typeof a.format=="function")return a.format(s);if(a&&a.toString()!=={}.toString())return a.toString();var o=[];for(var u in a)a.hasOwnProperty(u)&&o.push('"'+u+'": '+t.format(a[u],s));return"{"+o.join(", ")+"}"}return String(a)},t.stringify=function(a){for(var s=String(a),o="",u=0;u<s.length;){var c=s.charAt(u);c==="\\"?(o+=c,u++,c=s.charAt(u),(c===""||'"\\/bfnrtu'.indexOf(c)===-1)&&(o+="\\"),o+=c):c==='"'?o+='\\"':o+=c,u++}return'"'+o+'"'},t.escape=function(a){var s=String(a);return s=s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s};function r(a,s){if(Array.isArray(a)){for(var o="[",u=a.length,c=0;c<u;c++)c!=0&&(o+=", "),o+=r(a[c],s);return o+="]",o}else return t.format(a,s)}function i(a){return a&&typeof a=="object"&&typeof a.s=="number"&&typeof a.n=="number"&&typeof a.d=="number"||!1}}),string_1=string.isString,string_2=string.endsWith,string_3=string.format,string_4=string.stringify,string_5=string.escape,format=string.format,lazy$1=object.lazy;function factory$5(l,t,e,n,r){function i(u){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");l.isChain(u)?this.value=u.value:this.value=u}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return format(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(u){return new i(u.value)};function a(u,c){typeof c=="function"&&(i.prototype[u]=o(c))}function s(u,c){lazy$1(i.prototype,u,function(){var p=c();if(typeof p=="function")return o(p)})}function o(u){return function(){for(var c=[this.value],f=0;f<arguments.length;f++)c[f+1]=arguments[f];return new i(u.apply(u,c))}}return i.createProxy=function(u,c){if(typeof u=="string")a(u,c);else for(var f in u)u.hasOwnProperty(f)&&a(f,u[f])},i.createProxy(r),r.on("import",function(u,c,f){f===void 0&&s(u,c)}),i}var name$5="Chain",path$1="type",factory_1$5=factory$5,math$3=!0,lazy_1$1=!1,Chain={name:name$5,path:path$1,factory:factory_1$5,math:math$3,lazy:lazy_1$1};function factory$6(l,t,e,n){return n("chain",{"":function(){return new l.Chain},any:function(r){return new l.Chain(r)}})}var name$6="chain",factory_1$6=factory$6,chain={name:name$6,factory:factory_1$6},chain$1=[Chain,chain],complex=createCommonjsModule(function(l,t){(function(e){var n=function(f){return(Math.exp(f)+Math.exp(-f))*.5},r=function(f){return(Math.exp(f)-Math.exp(-f))*.5},i=function(f){var p=Math.PI/4;if(f<-p||f>p)return Math.cos(f)-1;var d=f*f;return d*(-.5+d*(1/24+d*(-1/720+d*(1/40320+d*(-1/3628800+d*(1/4790014600+d*(-1/87178291200+d*(1/20922789888e3))))))))},a=function(f,p){var d=Math.abs(f),m=Math.abs(p);return d<3e3&&m<3e3?Math.sqrt(d*d+m*m):(d<m?(d=m,m=f/p):m=p/f,d*Math.sqrt(1+m*m))},s=function(){throw SyntaxError("Invalid Param")};function o(f,p){var d=Math.abs(f),m=Math.abs(p);return f===0?Math.log(m):p===0?Math.log(d):d<3e3&&m<3e3?Math.log(f*f+p*p)*.5:Math.log(f/Math.cos(Math.atan2(p,f)))}var u=function(f,p){var d={re:0,im:0};if(f==null)d.re=d.im=0;else if(p!==void 0)d.re=f,d.im=p;else switch(typeof f){case"object":if("im"in f&&"re"in f)d.re=f.re,d.im=f.im;else if("abs"in f&&"arg"in f){if(!Number.isFinite(f.abs)&&Number.isFinite(f.arg))return c.INFINITY;d.re=f.abs*Math.cos(f.arg),d.im=f.abs*Math.sin(f.arg)}else if("r"in f&&"phi"in f){if(!Number.isFinite(f.r)&&Number.isFinite(f.phi))return c.INFINITY;d.re=f.r*Math.cos(f.phi),d.im=f.r*Math.sin(f.phi)}else f.length===2?(d.re=f[0],d.im=f[1]):s();break;case"string":d.im=d.re=0;var m=f.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),v=1,h=0;m===null&&s();for(var y=0;y<m.length;y++){var g=m[y];g===" "||g==="	"||g===`
`||(g==="+"?v++:g==="-"?h++:g==="i"||g==="I"?(v+h===0&&s(),m[y+1]!==" "&&!isNaN(m[y+1])?(d.im+=parseFloat((h%2?"-":"")+m[y+1]),y++):d.im+=parseFloat((h%2?"-":"")+"1"),v=h=0):((v+h===0||isNaN(g))&&s(),m[y+1]==="i"||m[y+1]==="I"?(d.im+=parseFloat((h%2?"-":"")+g),y++):d.re+=parseFloat((h%2?"-":"")+g),v=h=0))}v+h>0&&s();break;case"number":d.im=0,d.re=f;break;default:s()}return d};function c(f,p){if(!(this instanceof c))return new c(f,p);var d=u(f,p);this.re=d.re,this.im=d.im}c.prototype={re:0,im:0,sign:function(){var f=this.abs();return new c(this.re/f,this.im/f)},add:function(f,p){var d=new c(f,p);return this.isInfinite()&&d.isInfinite()?c.NAN:this.isInfinite()||d.isInfinite()?c.INFINITY:new c(this.re+d.re,this.im+d.im)},sub:function(f,p){var d=new c(f,p);return this.isInfinite()&&d.isInfinite()?c.NAN:this.isInfinite()||d.isInfinite()?c.INFINITY:new c(this.re-d.re,this.im-d.im)},mul:function(f,p){var d=new c(f,p);return this.isInfinite()&&d.isZero()||this.isZero()&&d.isInfinite()?c.NAN:this.isInfinite()||d.isInfinite()?c.INFINITY:d.im===0&&this.im===0?new c(this.re*d.re,0):new c(this.re*d.re-this.im*d.im,this.re*d.im+this.im*d.re)},div:function(f,p){var d=new c(f,p);if(this.isZero()&&d.isZero()||this.isInfinite()&&d.isInfinite())return c.NAN;if(this.isInfinite()||d.isZero())return c.INFINITY;if(this.isZero()||d.isInfinite())return c.ZERO;f=this.re,p=this.im;var m=d.re,v=d.im,h,y;return v===0?new c(f/m,p/m):Math.abs(m)<Math.abs(v)?(y=m/v,h=m*y+v,new c((f*y+p)/h,(p*y-f)/h)):(y=v/m,h=v*y+m,new c((f+p*y)/h,(p-f*y)/h))},pow:function(f,p){var d=new c(f,p);if(f=this.re,p=this.im,d.isZero())return c.ONE;if(d.im===0){if(p===0&&f>=0)return new c(Math.pow(f,d.re),0);if(f===0)switch((d.re%4+4)%4){case 0:return new c(Math.pow(p,d.re),0);case 1:return new c(0,Math.pow(p,d.re));case 2:return new c(-Math.pow(p,d.re),0);case 3:return new c(0,-Math.pow(p,d.re))}}if(f===0&&p===0&&d.re>0&&d.im>=0)return c.ZERO;var m=Math.atan2(p,f),v=o(f,p);return f=Math.exp(d.re*v-d.im*m),p=d.im*v+d.re*m,new c(f*Math.cos(p),f*Math.sin(p))},sqrt:function(){var f=this.re,p=this.im,d=this.abs(),m,v;if(f>=0){if(p===0)return new c(Math.sqrt(f),0);m=.5*Math.sqrt(2*(d+f))}else m=Math.abs(p)/Math.sqrt(2*(d-f));return f<=0?v=.5*Math.sqrt(2*(d-f)):v=Math.abs(p)/Math.sqrt(2*(d+f)),new c(m,p<0?-v:v)},exp:function(){var f=Math.exp(this.re);return this.im===0,new c(f*Math.cos(this.im),f*Math.sin(this.im))},expm1:function(){var f=this.re,p=this.im;return new c(Math.expm1(f)*Math.cos(p)+i(p),Math.exp(f)*Math.sin(p))},log:function(){var f=this.re,p=this.im;return new c(o(f,p),Math.atan2(p,f))},abs:function(){return a(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var f=this.re,p=this.im;return new c(Math.sin(f)*n(p),Math.cos(f)*r(p))},cos:function(){var f=this.re,p=this.im;return new c(Math.cos(f)*n(p),-Math.sin(f)*r(p))},tan:function(){var f=2*this.re,p=2*this.im,d=Math.cos(f)+n(p);return new c(Math.sin(f)/d,r(p)/d)},cot:function(){var f=2*this.re,p=2*this.im,d=Math.cos(f)-n(p);return new c(-Math.sin(f)/d,r(p)/d)},sec:function(){var f=this.re,p=this.im,d=.5*n(2*p)+.5*Math.cos(2*f);return new c(Math.cos(f)*n(p)/d,Math.sin(f)*r(p)/d)},csc:function(){var f=this.re,p=this.im,d=.5*n(2*p)-.5*Math.cos(2*f);return new c(Math.sin(f)*n(p)/d,-Math.cos(f)*r(p)/d)},asin:function(){var f=this.re,p=this.im,d=new c(p*p-f*f+1,-2*f*p).sqrt(),m=new c(d.re-p,d.im+f).log();return new c(m.im,-m.re)},acos:function(){var f=this.re,p=this.im,d=new c(p*p-f*f+1,-2*f*p).sqrt(),m=new c(d.re-p,d.im+f).log();return new c(Math.PI/2-m.im,m.re)},atan:function(){var f=this.re,p=this.im;if(f===0){if(p===1)return new c(0,Infinity);if(p===-1)return new c(0,-Infinity)}var d=f*f+(1-p)*(1-p),m=new c((1-p*p-f*f)/d,-2*f/d).log();return new c(-.5*m.im,.5*m.re)},acot:function(){var f=this.re,p=this.im;if(p===0)return new c(Math.atan2(1,f),0);var d=f*f+p*p;return d!==0?new c(f/d,-p/d).atan():new c(f!==0?f/0:0,p!==0?-p/0:0).atan()},asec:function(){var f=this.re,p=this.im;if(f===0&&p===0)return new c(0,Infinity);var d=f*f+p*p;return d!==0?new c(f/d,-p/d).acos():new c(f!==0?f/0:0,p!==0?-p/0:0).acos()},acsc:function(){var f=this.re,p=this.im;if(f===0&&p===0)return new c(Math.PI/2,Infinity);var d=f*f+p*p;return d!==0?new c(f/d,-p/d).asin():new c(f!==0?f/0:0,p!==0?-p/0:0).asin()},sinh:function(){var f=this.re,p=this.im;return new c(r(f)*Math.cos(p),n(f)*Math.sin(p))},cosh:function(){var f=this.re,p=this.im;return new c(n(f)*Math.cos(p),r(f)*Math.sin(p))},tanh:function(){var f=2*this.re,p=2*this.im,d=n(f)+Math.cos(p);return new c(r(f)/d,Math.sin(p)/d)},coth:function(){var f=2*this.re,p=2*this.im,d=n(f)-Math.cos(p);return new c(r(f)/d,-Math.sin(p)/d)},csch:function(){var f=this.re,p=this.im,d=Math.cos(2*p)-n(2*f);return new c(-2*r(f)*Math.cos(p)/d,2*n(f)*Math.sin(p)/d)},sech:function(){var f=this.re,p=this.im,d=Math.cos(2*p)+n(2*f);return new c(2*n(f)*Math.cos(p)/d,-2*r(f)*Math.sin(p)/d)},asinh:function(){var f=this.im;this.im=-this.re,this.re=f;var p=this.asin();return this.re=-this.im,this.im=f,f=p.re,p.re=-p.im,p.im=f,p},acosh:function(){var f=this.acos();if(f.im<=0){var p=f.re;f.re=-f.im,f.im=p}else{var p=f.im;f.im=-f.re,f.re=p}return f},atanh:function(){var f=this.re,p=this.im,d=f>1&&p===0,m=1-f,v=1+f,h=m*m+p*p,y=h!==0?new c((v*m-p*p)/h,(p*m+v*p)/h):new c(f!==-1?f/0:0,p!==0?p/0:0),g=y.re;return y.re=o(y.re,y.im)/2,y.im=Math.atan2(y.im,g)/2,d&&(y.im=-y.im),y},acoth:function(){var f=this.re,p=this.im;if(f===0&&p===0)return new c(0,Math.PI/2);var d=f*f+p*p;return d!==0?new c(f/d,-p/d).atanh():new c(f!==0?f/0:0,p!==0?-p/0:0).atanh()},acsch:function(){var f=this.re,p=this.im;if(p===0)return new c(f!==0?Math.log(f+Math.sqrt(f*f+1)):Infinity,0);var d=f*f+p*p;return d!==0?new c(f/d,-p/d).asinh():new c(f!==0?f/0:0,p!==0?-p/0:0).asinh()},asech:function(){var f=this.re,p=this.im;if(this.isZero())return c.INFINITY;var d=f*f+p*p;return d!==0?new c(f/d,-p/d).acosh():new c(f!==0?f/0:0,p!==0?-p/0:0).acosh()},inverse:function(){if(this.isZero())return c.INFINITY;if(this.isInfinite())return c.ZERO;var f=this.re,p=this.im,d=f*f+p*p;return new c(f/d,-p/d)},conjugate:function(){return new c(this.re,-this.im)},neg:function(){return new c(-this.re,-this.im)},ceil:function(f){return f=Math.pow(10,f||0),new c(Math.ceil(this.re*f)/f,Math.ceil(this.im*f)/f)},floor:function(f){return f=Math.pow(10,f||0),new c(Math.floor(this.re*f)/f,Math.floor(this.im*f)/f)},round:function(f){return f=Math.pow(10,f||0),new c(Math.round(this.re*f)/f,Math.round(this.im*f)/f)},equals:function(f,p){var d=new c(f,p);return Math.abs(d.re-this.re)<=c.EPSILON&&Math.abs(d.im-this.im)<=c.EPSILON},clone:function(){return new c(this.re,this.im)},toString:function(){var f=this.re,p=this.im,d="";return this.isNaN()?"NaN":this.isZero()?"0":this.isInfinite()?"Infinity":(f!==0&&(d+=f),p!==0&&(f!==0?d+=p<0?" - ":" + ":p<0&&(d+="-"),p=Math.abs(p),p!==1&&(d+=p),d+="i"),d||"0")},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return(this.re===0||this.re===-0)&&(this.im===0||this.im===-0)},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},c.ZERO=new c(0,0),c.ONE=new c(1,0),c.I=new c(0,1),c.PI=new c(Math.PI,0),c.E=new c(Math.E,0),c.INFINITY=new c(Infinity,Infinity),c.NAN=new c(NaN,NaN),c.EPSILON=1e-16,Object.defineProperty(t,"__esModule",{value:!0}),c.default=c,c.Complex=c,l.exports=c})(commonjsGlobal)});unwrapExports(complex);var format$1=number.format,isNumber=number.isNumber;function factory$7(l,t,e,n,r){return complex.prototype.type="Complex",complex.prototype.isComplex=!0,complex.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},complex.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},complex.prototype.format=function(i){var a="",s=this.im,o=this.re,u=format$1(this.re,i),c=format$1(this.im,i),f=isNumber(i)?i:i?i.precision:null;if(f!==null){var p=Math.pow(10,-f);Math.abs(o/s)<p&&(o=0),Math.abs(s/o)<p&&(s=0)}return s==0?a=u:o==0?s==1?a="i":s==-1?a="-i":a=c+"i":s<0?s==-1?a=u+" - i":a=u+" - "+c.substring(1)+"i":s==1?a=u+" + i":a=u+" + "+c+"i",a},complex.fromPolar=function(i){switch(arguments.length){case 1:var a=arguments[0];if(typeof a=="object")return complex(a);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var s=arguments[0],o=arguments[1];if(isNumber(s)){if(l.isUnit(o)&&o.hasBase("ANGLE")&&(o=o.toNumber("rad")),isNumber(o))return new complex({r:s,phi:o});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},complex.prototype.valueOf=complex.prototype.toString,complex.fromJSON=function(i){return new complex(i)},complex.EPSILON=t.epsilon,r.on("config",function(i,a){i.epsilon!==a.epsilon&&(complex.EPSILON=i.epsilon)}),complex.compare=function(i,a){return i.re>a.re?1:i.re<a.re?-1:i.im>a.im?1:i.im<a.im?-1:0},complex}var name$7="Complex",path$2="type",factory_1$7=factory$7,math$4=!0,Complex_1={name:name$7,path:path$2,factory:factory_1$7,math:math$4},defaultEscapes={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},formatEscapes={"\u2013":"\\--","\u2014":"\\---"," ":"~","	":"\\qquad{}","\r\n":"\\\\newline{}","\n":"\\\\newline{}"},defaultEscapeMapFn=function(t,e){return Object.assign({},t,e)},dist=function(l){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=t.preserveFormatting,n=e===void 0?!1:e,r=t.escapeMapFn,i=r===void 0?defaultEscapeMapFn:r,a=String(l),s="",o=i(Object.assign({},defaultEscapes),n?Object.assign({},formatEscapes):{}),u=Object.keys(o),c=function(){var p=!1;u.forEach(function(d,m){p||a.startsWith(d)&&(s+=o[u[m]],a=a.slice(d.length,a.length),p=!0)}),p||(s+=a.slice(0,1),a=a.slice(1,a.length))};a;)c();return s},latex=createCommonjsModule(function(l,t){t.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},t.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},t.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var e={deg:"^\\circ"};t.escape=function(n){return dist(n,{preserveFormatting:!0})},t.toSymbol=function(n,r){return r=typeof r=="undefined"?!1:r,r?e.hasOwnProperty(n)?e[n]:"\\mathrm{"+t.escape(n)+"}":t.symbols.hasOwnProperty(n)?t.symbols[n]:t.escape(n)}}),latex_1=latex.symbols,latex_2=latex.operators,latex_3=latex.defaultTemplate,latex_4=latex.escape,latex_5=latex.toSymbol;function factory$8(l,t,e,n){var r=latex,i=n("complex",{"":function(){return l.Complex.ZERO},number:function(a){return new l.Complex(a,0)},"number, number":function(a,s){return new l.Complex(a,s)},"BigNumber, BigNumber":function(a,s){return new l.Complex(a.toNumber(),s.toNumber())},Complex:function(a){return a.clone()},string:function(a){return l.Complex(a)},null:function(a){return l.Complex(0)},Object:function(a){if("re"in a&&"im"in a)return new l.Complex(a.re,a.im);if("r"in a&&"phi"in a)return new l.Complex(a);throw new Error("Expected object with either properties re and im, or properties r and phi.")},"Array | Matrix":function(a){return deepMap(a,i)}});return i.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+"+r.symbols.i+"\\cdot\\left(${args[1]}\\right)\\right)"},i}var name$8="complex",factory_1$8=factory$8,complex$2={name:name$8,factory:factory_1$8},complex$3=[Complex_1,complex$2],fraction=createCommonjsModule(function(l,t){(function(e){var n=2e3,r={s:1,n:0,d:1};function i(h){function y(){var b=Error.apply(this,arguments);b.name=this.name=h,this.stack=b.stack,this.message=b.message}function g(){}return g.prototype=Error.prototype,y.prototype=new g,y}var a=v.DivisionByZero=i("DivisionByZero"),s=v.InvalidParameter=i("InvalidParameter");function o(h,y){return isNaN(h=parseInt(h,10))&&u(),h*y}function u(){throw new s}var c=function(h,y){var g=0,b=1,x=1,N=0,C=0,_=0,w=1,A=1,$=0,S=1,D=1,V=1,I=1e7,q;if(h!=null)if(y!==void 0)g=h,b=y,x=g*b;else switch(typeof h){case"object":{"d"in h&&"n"in h?(g=h.n,b=h.d,"s"in h&&(g*=h.s)):0 in h?(g=h[0],1 in h&&(b=h[1])):u(),x=g*b;break}case"number":{if(h<0&&(x=h,h=-h),h%1==0)g=h;else if(h>0){for(h>=1&&(A=Math.pow(10,Math.floor(1+Math.log(h)/Math.LN10)),h/=A);S<=I&&V<=I;)if(q=($+D)/(S+V),h===q){S+V<=I?(g=$+D,b=S+V):V>S?(g=D,b=V):(g=$,b=S);break}else h>q?($+=D,S+=V):(D+=$,V+=S),S>I?(g=D,b=V):(g=$,b=S);g*=A}else(isNaN(h)||isNaN(y))&&(b=g=NaN);break}case"string":if(S=h.match(/\d+|./g),S===null&&u(),S[$]==="-"?(x=-1,$++):S[$]==="+"&&$++,S.length===$+1?C=o(S[$++],x):S[$+1]==="."||S[$]==="."?(S[$]!=="."&&(N=o(S[$++],x)),$++,($+1===S.length||S[$+1]==="("&&S[$+3]===")"||S[$+1]==="'"&&S[$+3]==="'")&&(C=o(S[$],x),w=Math.pow(10,S[$].length),$++),(S[$]==="("&&S[$+2]===")"||S[$]==="'"&&S[$+2]==="'")&&(_=o(S[$+1],x),A=Math.pow(10,S[$+1].length)-1,$+=3)):S[$+1]==="/"||S[$+1]===":"?(C=o(S[$],x),w=o(S[$+2],1),$+=3):S[$+3]==="/"&&S[$+1]===" "&&(N=o(S[$],x),C=o(S[$+2],x),w=o(S[$+4],1),$+=5),S.length<=$){b=w*A,x=g=_+b*N+A*C;break}default:u()}if(b===0)throw new a;r.s=x<0?-1:1,r.n=Math.abs(g),r.d=Math.abs(b)};function f(h,y,g){for(var b=1;y>0;h=h*h%g,y>>=1)y&1&&(b=b*h%g);return b}function p(h,y){for(;y%2==0;y/=2);for(;y%5==0;y/=5);if(y===1)return 0;for(var g=10%y,b=1;g!==1;b++)if(g=g*10%y,b>n)return 0;return b}function d(h,y,g){for(var b=1,x=f(10,g,y),N=0;N<300;N++){if(b===x)return N;b=b*10%y,x=x*10%y}return 0}function m(h,y){if(!h)return y;if(!y)return h;for(;;){if(h%=y,!h)return y;if(y%=h,!y)return h}}function v(h,y){if(!(this instanceof v))return new v(h,y);c(h,y),v.REDUCE?h=m(r.d,r.n):h=1,this.s=r.s,this.n=r.n/h,this.d=r.d/h}v.REDUCE=1,v.prototype={s:1,n:0,d:1,abs:function(){return new v(this.n,this.d)},neg:function(){return new v(-this.s*this.n,this.d)},add:function(h,y){return c(h,y),new v(this.s*this.n*r.d+r.s*this.d*r.n,this.d*r.d)},sub:function(h,y){return c(h,y),new v(this.s*this.n*r.d-r.s*this.d*r.n,this.d*r.d)},mul:function(h,y){return c(h,y),new v(this.s*r.s*this.n*r.n,this.d*r.d)},div:function(h,y){return c(h,y),new v(this.s*r.s*this.n*r.d,this.d*r.n)},clone:function(){return new v(this)},mod:function(h,y){return isNaN(this.n)||isNaN(this.d)?new v(NaN):h===void 0?new v(this.s*this.n%this.d,1):(c(h,y),r.n===0&&this.d===0&&v(0,0),new v(this.s*(r.d*this.n)%(r.n*this.d),r.d*this.d))},gcd:function(h,y){return c(h,y),new v(m(r.n,this.n)*m(r.d,this.d),r.d*this.d)},lcm:function(h,y){return c(h,y),r.n===0&&this.n===0?new v:new v(r.n*this.n,m(r.n,this.n)*m(r.d,this.d))},ceil:function(h){return h=Math.pow(10,h||0),isNaN(this.n)||isNaN(this.d)?new v(NaN):new v(Math.ceil(h*this.s*this.n/this.d),h)},floor:function(h){return h=Math.pow(10,h||0),isNaN(this.n)||isNaN(this.d)?new v(NaN):new v(Math.floor(h*this.s*this.n/this.d),h)},round:function(h){return h=Math.pow(10,h||0),isNaN(this.n)||isNaN(this.d)?new v(NaN):new v(Math.round(h*this.s*this.n/this.d),h)},inverse:function(){return new v(this.s*this.d,this.n)},pow:function(h){return h<0?new v(Math.pow(this.s*this.d,-h),Math.pow(this.n,-h)):new v(Math.pow(this.s*this.n,h),Math.pow(this.d,h))},equals:function(h,y){return c(h,y),this.s*this.n*r.d==r.s*r.n*this.d},compare:function(h,y){c(h,y);var g=this.s*this.n*r.d-r.s*r.n*this.d;return(0<g)-(g<0)},simplify:function(h){if(isNaN(this.n)||isNaN(this.d))return this;var y=this.abs().toContinued();h=h||.001;function g(N){return N.length===1?new v(N[0]):g(N.slice(1)).inverse().add(N[0])}for(var b=0;b<y.length;b++){var x=g(y.slice(0,b+1));if(x.sub(this.abs()).abs().valueOf()<h)return x.mul(this.s)}return this},divisible:function(h,y){return c(h,y),!(!(r.n*this.d)||this.n*r.d%(r.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(h){var y,g="",b=this.n,x=this.d;return this.s<0&&(g+="-"),x===1?g+=b:(h&&(y=Math.floor(b/x))>0&&(g+=y,g+=" ",b%=x),g+=b,g+="/",g+=x),g},toLatex:function(h){var y,g="",b=this.n,x=this.d;return this.s<0&&(g+="-"),x===1?g+=b:(h&&(y=Math.floor(b/x))>0&&(g+=y,b%=x),g+="\\frac{",g+=b,g+="}{",g+=x,g+="}"),g},toContinued:function(){var h,y=this.n,g=this.d,b=[];if(isNaN(this.n)||isNaN(this.d))return b;do b.push(Math.floor(y/g)),h=y%g,y=g,g=h;while(y!==1);return b},toString:function(){var h,y=this.n,g=this.d;if(isNaN(y)||isNaN(g))return"NaN";v.REDUCE||(h=m(y,g),y/=h,g/=h);var b=15,x=p(y,g),N=d(y,g,x),C=this.s===-1?"-":"";if(C+=y/g|0,y%=g,y*=10,y&&(C+="."),x){for(var _=N;_--;)C+=y/g|0,y%=g,y*=10;C+="(";for(var _=x;_--;)C+=y/g|0,y%=g,y*=10;C+=")"}else for(var _=b;y&&_--;)C+=y/g|0,y%=g,y*=10;return C}},Object.defineProperty(t,"__esModule",{value:!0}),v.default=v,v.Fraction=v,l.exports=v})(commonjsGlobal)});unwrapExports(fraction),fraction.prototype.type="Fraction",fraction.prototype.isFraction=!0,fraction.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},fraction.fromJSON=function(l){return new fraction(l)};function factory$9(l,t,e,n){return fraction}var name$9="Fraction",path$3="type",factory_1$9=factory$9,Fraction_1={name:name$9,path:path$3,factory:factory_1$9};function factory$10(l,t,e,n){var r=n("fraction",{number:function(i){if(!isFinite(i)||isNaN(i))throw new Error(i+" cannot be represented as a fraction");return new l.Fraction(i)},string:function(i){return new l.Fraction(i)},"number, number":function(i,a){return new l.Fraction(i,a)},null:function(i){return new l.Fraction(0)},BigNumber:function(i){return new l.Fraction(i.toString())},Fraction:function(i){return i},Object:function(i){return new l.Fraction(i)},"Array | Matrix":function(i){return deepMap(i,r)}});return r}var name$10="fraction",factory_1$10=factory$10,fraction$2={name:name$10,factory:factory_1$10},fraction$3=[Fraction_1,fraction$2];function DimensionError(l,t,e){if(!(this instanceof DimensionError))throw new SyntaxError("Constructor must be called with the new operator");this.actual=l,this.expected=t,this.relation=e,this.message="Dimension mismatch ("+(Array.isArray(l)?"["+l.join(", ")+"]":l)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=new Error().stack}DimensionError.prototype=new RangeError,DimensionError.prototype.constructor=RangeError,DimensionError.prototype.name="DimensionError",DimensionError.prototype.isDimensionError=!0;var DimensionError_1=DimensionError;function IndexError(l,t,e){if(!(this instanceof IndexError))throw new SyntaxError("Constructor must be called with the new operator");this.index=l,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=e),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}IndexError.prototype=new RangeError,IndexError.prototype.constructor=RangeError,IndexError.prototype.name="IndexError",IndexError.prototype.isIndexError=!0;var IndexError_1=IndexError,array=createCommonjsModule(function(l,t){t.size=function(s){for(var o=[];Array.isArray(s);)o.push(s.length),s=s[0];return o};function e(s,o,u){var c,f=s.length;if(f!=o[u])throw new DimensionError_1(f,o[u]);if(u<o.length-1){var p=u+1;for(c=0;c<f;c++){var d=s[c];if(!Array.isArray(d))throw new DimensionError_1(o.length-1,o.length,"<");e(s[c],o,p)}}else for(c=0;c<f;c++)if(Array.isArray(s[c]))throw new DimensionError_1(o.length+1,o.length,">")}t.validate=function(s,o){var u=o.length==0;if(u){if(Array.isArray(s))throw new DimensionError_1(s.length,0)}else e(s,o,0)},t.validateIndex=function(s,o){if(!number.isNumber(s)||!number.isInteger(s))throw new TypeError("Index must be an integer (value: "+s+")");if(s<0||typeof o=="number"&&s>=o)throw new IndexError_1(s,o)},t.resize=function(s,o,u){if(!Array.isArray(s)||!Array.isArray(o))throw new TypeError("Array expected");if(o.length===0)throw new Error("Resizing to scalar is not supported");o.forEach(function(f){if(!number.isNumber(f)||!number.isInteger(f)||f<0)throw new TypeError("Invalid size, must contain positive integers (size: "+string.format(o)+")")});var c=u!==void 0?u:0;return n(s,o,0,c),s};function n(s,o,u,c){var f,p,d=s.length,m=o[u],v=Math.min(d,m);if(s.length=m,u<o.length-1){var h=u+1;for(f=0;f<v;f++)p=s[f],Array.isArray(p)||(p=[p],s[f]=p),n(p,o,h,c);for(f=v;f<m;f++)p=[],s[f]=p,n(p,o,h,c)}else{for(f=0;f<v;f++)for(;Array.isArray(s[f]);)s[f]=s[f][0];for(f=v;f<m;f++)s[f]=c}}t.reshape=function(s,o){var u=t.flatten(s),c,f=function(p){return p.reduce(function(d,m){return d*m})};if(!Array.isArray(s)||!Array.isArray(o))throw new TypeError("Array expected");if(o.length===0)throw new DimensionError_1(0,f(t.size(s)),"!=");try{c=r(u,o)}catch(p){throw p instanceof DimensionError_1?new DimensionError_1(f(o),f(t.size(s)),"!="):p}if(u.length>0)throw new DimensionError_1(f(o),f(t.size(s)),"!=");return c};function r(s,o){var u=[],c;if(o.length===0){if(s.length===0)throw new DimensionError_1(null,null,"!=");return s.shift()}for(c=0;c<o[0];c+=1)u.push(r(s,o.slice(1)));return u}t.squeeze=function(s,o){for(var u=o||t.size(s);Array.isArray(s)&&s.length===1;)s=s[0],u.shift();for(var c=u.length;u[c-1]===1;)c--;return c<u.length&&(s=i(s,c,0),u.length=c),s};function i(s,o,u){var c,f;if(u<o){var p=u+1;for(c=0,f=s.length;c<f;c++)s[c]=i(s[c],o,p)}else for(;Array.isArray(s);)s=s[0];return s}t.unsqueeze=function(s,o,u,c){var f=c||t.size(s);if(u)for(var p=0;p<u;p++)s=[s],f.unshift(1);for(s=a(s,o,0);f.length<o;)f.push(1);return s};function a(s,o,u){var c,f;if(Array.isArray(s)){var p=u+1;for(c=0,f=s.length;c<f;c++)s[c]=a(s[c],o,p)}else for(var d=u;d<o;d++)s=[s];return s}t.flatten=function(s){if(!Array.isArray(s))return s;var o=[];return s.forEach(function u(c){Array.isArray(c)?c.forEach(u):o.push(c)}),o},t.map=function(s,o){return Array.prototype.map.call(s,o)},t.forEach=function(s,o){Array.prototype.forEach.call(s,o)},t.filter=function(s,o){if(t.size(s).length!==1)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(s,o)},t.filterRegExp=function(s,o){if(t.size(s).length!==1)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(s,function(u){return o.test(u)})},t.join=function(s,o){return Array.prototype.join.call(s,o)},t.identify=function(s){if(!Array.isArray(s))throw new TypeError("Array input expected");if(s.length===0)return s;var o=[],u=0;o[0]={value:s[0],identifier:0};for(var c=1;c<s.length;c++)s[c]===s[c-1]?u++:u=0,o.push({value:s[c],identifier:u});return o},t.generalize=function(s){if(!Array.isArray(s))throw new TypeError("Array input expected");if(s.length===0)return s;for(var o=[],u=0;u<s.length;u++)o.push(s[u].value);return o},t.isArray=Array.isArray}),array_1=array.size,array_2=array.validate,array_3=array.validateIndex,array_4=array.resize,array_5=array.reshape,array_6=array.squeeze,array_7=array.unsqueeze,array_8=array.flatten,array_9=array.map,array_10=array.forEach,array_11=array.filter,array_12=array.filterRegExp,array_13=array.join,array_14=array.identify,array_15=array.generalize,array_16=array.isArray,isBoolean=function(l){return typeof l=="boolean"},boolean_1$1={isBoolean},memoize=function(l,t){return function e(){typeof e.cache!="object"&&(e.cache={});for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t?t(n):JSON.stringify(n);return i in e.cache?e.cache[i]:e.cache[i]=l.apply(l,n)}},maxArgumentCount=function(l){return Object.keys(l.signatures||{}).reduce(function(t,e){var n=(e.match(/,/g)||[]).length+1;return Math.max(t,n)},-1)},callWithRightArgumentCount=function(l,t,e){return Object.keys(l.signatures||{}).reduce(function(n,r){var i=(r.match(/,/g)||[]).length+1;return Math.max(n,i)},-1)},_function={memoize,maxArgumentCount,callWithRightArgumentCount},utils=createCommonjsModule(function(l,t){t.array=array,t.boolean=boolean_1$1,t.function=_function,t.number=number,t.object=object,t.string=string,t.emitter=emitter}),utils_1=utils.array,utils_2=utils.number,utils_3=utils.object,utils_4=utils.string,utils_5=utils.emitter,string$1=utils.string,isString=string$1.isString;function factory$11(l,t,e,n){function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator")}return r.prototype.type="Matrix",r.prototype.isMatrix=!0,r.storage=function(i){if(!isString(i))throw new TypeError("format must be a string value");var a=r._storage[i];if(!a)throw new SyntaxError("Unsupported matrix storage format: "+i);return a},r._storage={},r.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},r.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},r.prototype.create=function(i,a){throw new Error("Cannot invoke create on a Matrix interface")},r.prototype.subset=function(i,a,s){throw new Error("Cannot invoke subset on a Matrix interface")},r.prototype.get=function(i){throw new Error("Cannot invoke get on a Matrix interface")},r.prototype.set=function(i,a,s){throw new Error("Cannot invoke set on a Matrix interface")},r.prototype.resize=function(i,a){throw new Error("Cannot invoke resize on a Matrix interface")},r.prototype.reshape=function(i,a){throw new Error("Cannot invoke reshape on a Matrix interface")},r.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},r.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},r.prototype.map=function(i,a){throw new Error("Cannot invoke map on a Matrix interface")},r.prototype.forEach=function(i){throw new Error("Cannot invoke forEach on a Matrix interface")},r.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},r.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},r.prototype.format=function(i){throw new Error("Cannot invoke format on a Matrix interface")},r.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},r}var name$11="Matrix",path$4="type",factory_1$11=factory$11,Matrix={name:name$11,path:path$4,factory:factory_1$11},string$2=utils.string,array$1=utils.array,object$1=utils.object,number$1=utils.number,isArray=Array.isArray,isNumber$1=number$1.isNumber,isInteger=number$1.isInteger,isString$1=string$2.isString,validateIndex=array$1.validateIndex;function factory$12(l,t,e,n){var r=e(Matrix);function i(d,m){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(m&&!isString$1(m))throw new Error("Invalid datatype: "+m);if(l.isMatrix(d))d.type==="DenseMatrix"?(this._data=object$1.clone(d._data),this._size=object$1.clone(d._size),this._datatype=m||d._datatype):(this._data=d.toArray(),this._size=d.size(),this._datatype=m||d._datatype);else if(d&&isArray(d.data)&&isArray(d.size))this._data=d.data,this._size=d.size,this._datatype=m||d.datatype;else if(isArray(d))this._data=p(d),this._size=array$1.size(this._data),array$1.validate(this._data,this._size),this._datatype=m;else{if(d)throw new TypeError("Unsupported type of data ("+utils.types.type(d)+")");this._data=[],this._size=[0],this._datatype=m}}i.prototype=new r,i.prototype.type="DenseMatrix",i.prototype.isDenseMatrix=!0,i.prototype.storage=function(){return"dense"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(d,m){return new i(d,m)},i.prototype.subset=function(d,m,v){switch(arguments.length){case 1:return a(this,d);case 2:case 3:return o(this,d,m,v);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(d){if(!isArray(d))throw new TypeError("Array expected");if(d.length!=this._size.length)throw new DimensionError_1(d.length,this._size.length);for(var m=0;m<d.length;m++)validateIndex(d[m],this._size[m]);for(var v=this._data,h=0,y=d.length;h<y;h++){var g=d[h];validateIndex(g,v.length),v=v[g]}return v},i.prototype.set=function(d,m,v){if(!isArray(d))throw new TypeError("Array expected");if(d.length<this._size.length)throw new DimensionError_1(d.length,this._size.length,"<");var h,y,g,b=d.map(function(N){return N+1});f(this,b,v);var x=this._data;for(h=0,y=d.length-1;h<y;h++)g=d[h],validateIndex(g,x.length),x=x[g];return g=d[d.length-1],validateIndex(g,x.length),x[g]=m,this};function a(d,m){if(!l.isIndex(m))throw new TypeError("Invalid index");var v=m.isScalar();if(v)return d.get(m.min());var h=m.size();if(h.length!=d._size.length)throw new DimensionError_1(h.length,d._size.length);for(var y=m.min(),g=m.max(),b=0,x=d._size.length;b<x;b++)validateIndex(y[b],d._size[b]),validateIndex(g[b],d._size[b]);return new i(s(d._data,m,h.length,0),d._datatype)}function s(d,m,v,h){var y=h===v-1,g=m.dimension(h);return y?g.map(function(b){return validateIndex(b,d.length),d[b]}).valueOf():g.map(function(b){validateIndex(b,d.length);var x=d[b];return s(x,m,v,h+1)}).valueOf()}function o(d,m,v,h){if(!m||m.isIndex!==!0)throw new TypeError("Invalid index");var y=m.size(),g=m.isScalar(),b;if(l.isMatrix(v)?(b=v.size(),v=v.valueOf()):b=array$1.size(v),g){if(b.length!==0)throw new TypeError("Scalar expected");d.set(m.min(),v,h)}else{if(y.length<d._size.length)throw new DimensionError_1(y.length,d._size.length,"<");if(b.length<y.length){for(var x=0,N=0;y[x]===1&&b[x]===1;)x++;for(;y[x]===1;)N++,x++;v=array$1.unsqueeze(v,y.length,N,b)}if(!object$1.deepEqual(y,b))throw new DimensionError_1(y,b,">");var C=m.max().map(function(A){return A+1});f(d,C,h);var _=y.length,w=0;u(d._data,m,v,_,w)}return d}function u(d,m,v,h,y){var g=y===h-1,b=m.dimension(y);g?b.forEach(function(x,N){validateIndex(x),d[x]=v[N[0]]}):b.forEach(function(x,N){validateIndex(x),u(d[x],m,v[N[0]],h,y+1)})}i.prototype.resize=function(d,m,v){if(!isArray(d))throw new TypeError("Array expected");var h=v?this.clone():this;return c(h,d,m)};var c=function(d,m,v){if(m.length===0){for(var h=d._data;isArray(h);)h=h[0];return h}return d._size=m.slice(0),d._data=array$1.resize(d._data,d._size,v),d};i.prototype.reshape=function(d,m){var v=m?this.clone():this;return v._data=array$1.reshape(v._data,d),v._size=d.slice(0),v};function f(d,m,v){for(var h=d._size.slice(0),y=!1;h.length<m.length;)h.push(0),y=!0;for(var g=0,b=m.length;g<b;g++)m[g]>h[g]&&(h[g]=m[g],y=!0);y&&c(d,h,v)}i.prototype.clone=function(){var d=new i({data:object$1.clone(this._data),size:object$1.clone(this._size),datatype:this._datatype});return d},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(d){var m=this,v=function(h,y){return isArray(h)?h.map(function(g,b){return v(g,y.concat(b))}):d(h,y,m)};return new i({data:v(this._data,[]),size:object$1.clone(this._size),datatype:this._datatype})},i.prototype.forEach=function(d){var m=this,v=function(h,y){isArray(h)?h.forEach(function(g,b){v(g,y.concat(b))}):d(h,y,m)};v(this._data,[])},i.prototype.toArray=function(){return object$1.clone(this._data)},i.prototype.valueOf=function(){return this._data},i.prototype.format=function(d){return string$2.format(this._data,d)},i.prototype.toString=function(){return string$2.format(this._data)},i.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(d){if(d){if(l.isBigNumber(d)&&(d=d.toNumber()),!isNumber$1(d)||!isInteger(d))throw new TypeError("The parameter k must be an integer number")}else d=0;for(var m=d>0?d:0,v=d<0?-d:0,h=this._size[0],y=this._size[1],g=Math.min(h-v,y-m),b=[],x=0;x<g;x++)b[x]=this._data[x+v][x+m];return new i({data:b,size:[g],datatype:this._datatype})},i.diagonal=function(d,m,v,h,y){if(!isArray(d))throw new TypeError("Array expected, size parameter");if(d.length!==2)throw new Error("Only two dimensions matrix are supported");if(d=d.map(function(S){if(l.isBigNumber(S)&&(S=S.toNumber()),!isNumber$1(S)||!isInteger(S)||S<1)throw new Error("Size values must be positive integers");return S}),v){if(l.isBigNumber(v)&&(v=v.toNumber()),!isNumber$1(v)||!isInteger(v))throw new TypeError("The parameter k must be an integer number")}else v=0;h&&isString$1(y)&&(h=n.convert(h,y));var g=v>0?v:0,b=v<0?-v:0,x=d[0],N=d[1],C=Math.min(x-b,N-g),_;if(isArray(m)){if(m.length!==C)throw new Error("Invalid value array length");_=function(S){return m[S]}}else if(l.isMatrix(m)){var w=m.size();if(w.length!==1||w[0]!==C)throw new Error("Invalid matrix length");_=function(S){return m.get([S])}}else _=function(){return m};h||(h=l.isBigNumber(_(0))?new l.BigNumber(0):0);var A=[];if(d.length>0){A=array$1.resize(A,d,h);for(var $=0;$<C;$++)A[$+b][$+g]=_($)}return new i({data:A,size:[x,N]})},i.fromJSON=function(d){return new i(d)},i.prototype.swapRows=function(d,m){if(!isNumber$1(d)||!isInteger(d)||!isNumber$1(m)||!isInteger(m))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return validateIndex(d,this._size[0]),validateIndex(m,this._size[0]),i._swapRows(d,m,this._data),this},i._swapRows=function(d,m,v){var h=v[d];v[d]=v[m],v[m]=h};function p(d){for(var m=0,v=d.length;m<v;m++){var h=d[m];isArray(h)?d[m]=p(h):h&&h.isMatrix===!0&&(d[m]=p(h.valueOf()))}return d}return l.Matrix._storage.dense=i,l.Matrix._storage.default=i,i}var name$12="DenseMatrix",path$5="type",factory_1$12=factory$12,lazy$2=!1,DenseMatrix={name:name$12,path:path$5,factory:factory_1$12,lazy:lazy$2},nearlyEqual=function(t,e,n){if(n==null)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var r=t.minus(e).abs();if(r.isZero())return!0;var i=t.constructor.max(t.abs(),e.abs());return r.lte(i.times(n))}return!1},nearlyEqual$1=number.nearlyEqual;function factory$13(l,t,e,n){var r=n("equalScalar",{"boolean, boolean":function(i,a){return i===a},"number, number":function(i,a){return i===a||nearlyEqual$1(i,a,t.epsilon)},"BigNumber, BigNumber":function(i,a){return i.eq(a)||nearlyEqual(i,a,t.epsilon)},"Fraction, Fraction":function(i,a){return i.equals(a)},"Complex, Complex":function(i,a){return i.equals(a)},"Unit, Unit":function(i,a){if(!i.equalBase(a))throw new Error("Cannot compare units with different base");return r(i.value,a.value)}});return r}var factory_1$13=factory$13,equalScalar={factory:factory_1$13},array$2=utils.array,object$2=utils.object,string$3=utils.string,number$2=utils.number,isArray$1=Array.isArray,isNumber$2=number$2.isNumber,isInteger$1=number$2.isInteger,isString$2=string$3.isString,validateIndex$1=array$2.validateIndex;function factory$14(l,t,e,n){var r=e(Matrix),i=e(equalScalar);function a(y,g){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(g&&!isString$2(g))throw new Error("Invalid datatype: "+g);if(l.isMatrix(y))s(this,y,g);else if(y&&isArray$1(y.index)&&isArray$1(y.ptr)&&isArray$1(y.size))this._values=y.values,this._index=y.index,this._ptr=y.ptr,this._size=y.size,this._datatype=g||y.datatype;else if(isArray$1(y))o(this,y,g);else{if(y)throw new TypeError("Unsupported type of data ("+utils.types.type(y)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=g}}var s=function(y,g,b){g.type==="SparseMatrix"?(y._values=g._values?object$2.clone(g._values):void 0,y._index=object$2.clone(g._index),y._ptr=object$2.clone(g._ptr),y._size=object$2.clone(g._size),y._datatype=b||g._datatype):o(y,g.valueOf(),b||g._datatype)},o=function(y,g,b){y._values=[],y._index=[],y._ptr=[],y._datatype=b;var x=g.length,N=0,C=i,_=0;if(isString$2(b)&&(C=n.find(i,[b,b])||i,_=n.convert(0,b)),x>0){var w=0;do{y._ptr.push(y._index.length);for(var A=0;A<x;A++){var $=g[A];if(isArray$1($)){if(w===0&&N<$.length&&(N=$.length),w<$.length){var S=$[w];C(S,_)||(y._values.push(S),y._index.push(A))}}else w===0&&N<1&&(N=1),C($,_)||(y._values.push($),y._index.push(A))}w++}while(w<N)}y._ptr.push(y._index.length),y._size=[x,N]};a.prototype=new r,a.prototype.type="SparseMatrix",a.prototype.isSparseMatrix=!0,a.prototype.storage=function(){return"sparse"},a.prototype.datatype=function(){return this._datatype},a.prototype.create=function(y,g){return new a(y,g)},a.prototype.density=function(){var y=this._size[0],g=this._size[1];return y!==0&&g!==0?this._index.length/(y*g):0},a.prototype.subset=function(y,g,b){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return u(this,y);case 2:case 3:return c(this,y,g,b);default:throw new SyntaxError("Wrong number of arguments")}};var u=function(y,g){if(!l.isIndex(g))throw new TypeError("Invalid index");var b=g.isScalar();if(b)return y.get(g.min());var x=g.size();if(x.length!=y._size.length)throw new DimensionError_1(x.length,y._size.length);var N,C,_,w,A=g.min(),$=g.max();for(N=0,C=y._size.length;N<C;N++)validateIndex$1(A[N],y._size[N]),validateIndex$1($[N],y._size[N]);var S=y._values,D=y._index,V=y._ptr,I=g.dimension(0),q=g.dimension(1),K=[],E=[];I.forEach(function(Q,ne){E[Q]=ne[0],K[Q]=!0});var W=S?[]:void 0,G=[],P=[];return q.forEach(function(Q){for(P.push(G.length),_=V[Q],w=V[Q+1];_<w;_++)N=D[_],K[N]===!0&&(G.push(E[N]),W&&W.push(S[_]))}),P.push(G.length),new a({values:W,index:G,ptr:P,size:x,datatype:y._datatype})},c=function(y,g,b,x){if(!g||g.isIndex!==!0)throw new TypeError("Invalid index");var N=g.size(),C=g.isScalar(),_;if(l.isMatrix(b)?(_=b.size(),b=b.toArray()):_=array$2.size(b),C){if(_.length!==0)throw new TypeError("Scalar expected");y.set(g.min(),b,x)}else{if(N.length!==1&&N.length!==2)throw new DimensionError_1(N.length,y._size.length,"<");if(_.length<N.length){for(var w=0,A=0;N[w]===1&&_[w]===1;)w++;for(;N[w]===1;)A++,w++;b=array$2.unsqueeze(b,N.length,A,_)}if(!object$2.deepEqual(N,_))throw new DimensionError_1(N,_,">");for(var $=g.min()[0],S=g.min()[1],D=_[0],V=_[1],I=0;I<D;I++)for(var q=0;q<V;q++){var K=b[I][q];y.set([I+$,q+S],K,x)}}return y};a.prototype.get=function(y){if(!isArray$1(y))throw new TypeError("Array expected");if(y.length!=this._size.length)throw new DimensionError_1(y.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var g=y[0],b=y[1];validateIndex$1(g,this._size[0]),validateIndex$1(b,this._size[1]);var x=f(g,this._ptr[b],this._ptr[b+1],this._index);return x<this._ptr[b+1]&&this._index[x]===g?this._values[x]:0},a.prototype.set=function(y,g,b){if(!isArray$1(y))throw new TypeError("Array expected");if(y.length!=this._size.length)throw new DimensionError_1(y.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var x=y[0],N=y[1],C=this._size[0],_=this._size[1],w=i,A=0;isString$2(this._datatype)&&(w=n.find(i,[this._datatype,this._datatype])||i,A=n.convert(0,this._datatype)),(x>C-1||N>_-1)&&(m(this,Math.max(x+1,C),Math.max(N+1,_),b),C=this._size[0],_=this._size[1]),validateIndex$1(x,C),validateIndex$1(N,_);var $=f(x,this._ptr[N],this._ptr[N+1],this._index);return $<this._ptr[N+1]&&this._index[$]===x?w(g,A)?p($,N,this._values,this._index,this._ptr):this._values[$]=g:d($,x,N,g,this._values,this._index,this._ptr),this};var f=function(y,g,b,x){if(b-g==0)return b;for(var N=g;N<b;N++)if(x[N]===y)return N;return g},p=function(y,g,b,x,N){b.splice(y,1),x.splice(y,1);for(var C=g+1;C<N.length;C++)N[C]--},d=function(y,g,b,x,N,C,_){N.splice(y,0,x),C.splice(y,0,g);for(var w=b+1;w<_.length;w++)_[w]++};a.prototype.resize=function(y,g,b){if(!isArray$1(y))throw new TypeError("Array expected");if(y.length!==2)throw new Error("Only two dimensions matrix are supported");y.forEach(function(N){if(!number$2.isNumber(N)||!number$2.isInteger(N)||N<0)throw new TypeError("Invalid size, must contain positive integers (size: "+string$3.format(y)+")")});var x=b?this.clone():this;return m(x,y[0],y[1],g)};var m=function(y,g,b,x){var N=x||0,C=i,_=0;isString$2(y._datatype)&&(C=n.find(i,[y._datatype,y._datatype])||i,_=n.convert(0,y._datatype),N=n.convert(N,y._datatype));var w=!C(N,_),A=y._size[0],$=y._size[1],S,D,V;if(b>$){for(D=$;D<b;D++)if(y._ptr[D]=y._values.length,w)for(S=0;S<A;S++)y._values.push(N),y._index.push(S);y._ptr[b]=y._values.length}else b<$&&(y._ptr.splice(b+1,$-b),y._values.splice(y._ptr[b],y._values.length),y._index.splice(y._ptr[b],y._index.length));if($=b,g>A){if(w){var I=0;for(D=0;D<$;D++){y._ptr[D]=y._ptr[D]+I,V=y._ptr[D+1]+I;var q=0;for(S=A;S<g;S++,q++)y._values.splice(V+q,0,N),y._index.splice(V+q,0,S),I++}y._ptr[$]=y._values.length}}else if(g<A){var K=0;for(D=0;D<$;D++){y._ptr[D]=y._ptr[D]-K;var E=y._ptr[D],W=y._ptr[D+1]-K;for(V=E;V<W;V++)S=y._index[V],S>g-1&&(y._values.splice(V,1),y._index.splice(V,1),K++)}y._ptr[D]=y._values.length}return y._size[0]=g,y._size[1]=b,y};a.prototype.reshape=function(y,g){if(!isArray$1(y))throw new TypeError("Array expected");if(y.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");if(y.forEach(function(q){if(!number$2.isNumber(q)||!number$2.isInteger(q)||q<0)throw new TypeError("Invalid size, must contain positive integers (size: "+string$3.format(y)+")")}),this._size[0]*this._size[1]!=y[0]*y[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var b=g?this.clone():this;if(this._size[0]===y[0]&&this._size[1]===y[1])return b;for(var x=[],N=0;N<b._ptr.length;N++)for(var C=0;C<b._ptr[N+1]-b._ptr[N];C++)x.push(N);for(var _=b._values.slice(),w=b._index.slice(),N=0;N<b._index.length;N++){var A=w[N],$=x[N],S=A*b._size[1]+$;x[N]=S%y[1],w[N]=Math.floor(S/y[1])}b._values.length=0,b._index.length=0,b._ptr.length=y[1]+1,b._size=y.slice();for(var N=0;N<b._ptr.length;N++)b._ptr[N]=0;for(var D=0;D<_.length;D++){var N=w[D],C=x[D],V=_[D],I=f(N,b._ptr[C],b._ptr[C+1],b._index);d(I,N,C,V,b._values,b._index,b._ptr)}return b},a.prototype.clone=function(){var y=new a({values:this._values?object$2.clone(this._values):void 0,index:object$2.clone(this._index),ptr:object$2.clone(this._ptr),size:object$2.clone(this._size),datatype:this._datatype});return y},a.prototype.size=function(){return this._size.slice(0)},a.prototype.map=function(y,g){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var b=this,x=this._size[0],N=this._size[1],C=function(_,w,A){return y(_,[w,A],b)};return v(this,0,x-1,0,N-1,C,g)};var v=function(y,g,b,x,N,C,_){var w=[],A=[],$=[],S=i,D=0;isString$2(y._datatype)&&(S=n.find(i,[y._datatype,y._datatype])||i,D=n.convert(0,y._datatype));for(var V=function(ne,Y,se){ne=C(ne,Y,se),S(ne,D)||(w.push(ne),A.push(Y))},I=x;I<=N;I++){$.push(w.length);for(var q=y._ptr[I],K=y._ptr[I+1],E=g,W=q;W<K;W++){var G=y._index[W];if(G>=g&&G<=b){if(!_)for(var P=E;P<G;P++)V(0,P-g,I-x);V(y._values[W],G-g,I-x)}E=G+1}if(!_)for(var Q=E;Q<=b;Q++)V(0,Q-g,I-x)}return $.push(w.length),new a({values:w,index:A,ptr:$,size:[b-g+1,N-x+1]})};a.prototype.forEach=function(y,g){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var b=this,x=this._size[0],N=this._size[1],C=0;C<N;C++){for(var _=this._ptr[C],w=this._ptr[C+1],A=0,$=_;$<w;$++){var S=this._index[$];if(!g)for(var D=A;D<S;D++)y(0,[D,C],b);y(this._values[$],[S,C],b),A=S+1}if(!g)for(var V=A;V<x;V++)y(0,[V,C],b)}},a.prototype.toArray=function(){return h(this._values,this._index,this._ptr,this._size,!0)},a.prototype.valueOf=function(){return h(this._values,this._index,this._ptr,this._size,!1)};var h=function(y,g,b,x,N){var C=x[0],_=x[1],w=[],A,$;for(A=0;A<C;A++)for(w[A]=[],$=0;$<_;$++)w[A][$]=0;for($=0;$<_;$++)for(var S=b[$],D=b[$+1],V=S;V<D;V++)A=g[V],w[A][$]=y?N?object$2.clone(y[V]):y[V]:1;return w};return a.prototype.format=function(y){for(var g=this._size[0],b=this._size[1],x=this.density(),N="Sparse Matrix ["+string$3.format(g,y)+" x "+string$3.format(b,y)+"] density: "+string$3.format(x,y)+`
`,C=0;C<b;C++)for(var _=this._ptr[C],w=this._ptr[C+1],A=_;A<w;A++){var $=this._index[A];N+=`
    (`+string$3.format($,y)+", "+string$3.format(C,y)+") ==> "+(this._values?string$3.format(this._values[A],y):"X")}return N},a.prototype.toString=function(){return string$3.format(this.toArray())},a.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},a.prototype.diagonal=function(y){if(y){if(l.isBigNumber(y)&&(y=y.toNumber()),!isNumber$2(y)||!isInteger$1(y))throw new TypeError("The parameter k must be an integer number")}else y=0;var g=y>0?y:0,b=y<0?-y:0,x=this._size[0],N=this._size[1],C=Math.min(x-b,N-g),_=[],w=[],A=[];A[0]=0;for(var $=g;$<N&&_.length<C;$++)for(var S=this._ptr[$],D=this._ptr[$+1],V=S;V<D;V++){var I=this._index[V];if(I===$-g+b){_.push(this._values[V]),w[_.length-1]=I-b;break}}return A.push(_.length),new a({values:_,index:w,ptr:A,size:[C,1]})},a.fromJSON=function(y){return new a(y)},a.diagonal=function(y,g,b,x,N){if(!isArray$1(y))throw new TypeError("Array expected, size parameter");if(y.length!==2)throw new Error("Only two dimensions matrix are supported");if(y=y.map(function(Q){if(l.isBigNumber(Q)&&(Q=Q.toNumber()),!isNumber$2(Q)||!isInteger$1(Q)||Q<1)throw new Error("Size values must be positive integers");return Q}),b){if(l.isBigNumber(b)&&(b=b.toNumber()),!isNumber$2(b)||!isInteger$1(b))throw new TypeError("The parameter k must be an integer number")}else b=0;var C=i,_=0;isString$2(N)&&(C=n.find(i,[N,N])||i,_=n.convert(0,N));var w=b>0?b:0,A=b<0?-b:0,$=y[0],S=y[1],D=Math.min($-A,S-w),V;if(isArray$1(g)){if(g.length!==D)throw new Error("Invalid value array length");V=function(Q){return g[Q]}}else if(l.isMatrix(g)){var I=g.size();if(I.length!==1||I[0]!==D)throw new Error("Invalid matrix length");V=function(Q){return g.get([Q])}}else V=function(){return g};for(var q=[],K=[],E=[],W=0;W<S;W++){E.push(q.length);var G=W-w;if(G>=0&&G<D){var P=V(G);C(P,_)||(K.push(G+A),q.push(P))}}return E.push(q.length),new a({values:q,index:K,ptr:E,size:[$,S]})},a.prototype.swapRows=function(y,g){if(!isNumber$2(y)||!isInteger$1(y)||!isNumber$2(g)||!isInteger$1(g))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return validateIndex$1(y,this._size[0]),validateIndex$1(g,this._size[0]),a._swapRows(y,g,this._size[1],this._values,this._index,this._ptr),this},a._forEachRow=function(y,g,b,x,N){for(var C=x[y],_=x[y+1],w=C;w<_;w++)N(b[w],g[w])},a._swapRows=function(y,g,b,x,N,C){for(var _=0;_<b;_++){var w=C[_],A=C[_+1],$=f(y,w,A,N),S=f(g,w,A,N);if($<A&&S<A&&N[$]===y&&N[S]===g){if(x){var D=x[$];x[$]=x[S],x[S]=D}continue}if($<A&&N[$]===y&&(S>=A||N[S]!==g)){var V=x?x[$]:void 0;N.splice(S,0,g),x&&x.splice(S,0,V),N.splice(S<=$?$+1:$,1),x&&x.splice(S<=$?$+1:$,1);continue}if(S<A&&N[S]===g&&($>=A||N[$]!==y)){var I=x?x[S]:void 0;N.splice($,0,y),x&&x.splice($,0,I),N.splice($<=S?S+1:S,1),x&&x.splice($<=S?S+1:S,1)}}},l.Matrix._storage.sparse=a,a}var name$13="SparseMatrix",path$6="type",factory_1$14=factory$14,lazy$3=!1,SparseMatrix={name:name$13,path:path$6,factory:factory_1$14,lazy:lazy$3};function factory$15(l,t,e,n){var r=n("matrix",{"":function(){return i([])},string:function(a){return i([],a)},"string, string":function(a,s){return i([],a,s)},Array:function(a){return i(a)},Matrix:function(a){return i(a,a.storage())},"Array | Matrix, string":i,"Array | Matrix, string, string":i});return r.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},r;function i(a,s,o){var u=l.Matrix.storage(s||"default");return new u(a,o)}}var name$14="matrix",factory_1$15=factory$15,matrix={name:name$14,factory:factory_1$15};function factory$16(l,t,e,n){var r=n("add",{"number, number":function(i,a){return i+a},"Complex, Complex":function(i,a){return i.add(a)},"BigNumber, BigNumber":function(i,a){return i.plus(a)},"Fraction, Fraction":function(i,a){return i.add(a)},"Unit, Unit":function(i,a){if(i.value==null)throw new Error("Parameter x contains a unit with undefined value");if(a.value==null)throw new Error("Parameter y contains a unit with undefined value");if(!i.equalBase(a))throw new Error("Units do not match");var s=i.clone();return s.value=r(s.value,a.value),s.fixPrefix=!1,s}});return r}var factory_1$16=factory$16,addScalar={factory:factory_1$16};function factory$17(l,t,e,n){var r=l.DenseMatrix,i=function(a,s,o,u){var c=a._data,f=a._size,p=a._datatype,d=s._values,m=s._index,v=s._ptr,h=s._size,y=s._datatype;if(f.length!==h.length)throw new DimensionError_1(f.length,h.length);if(f[0]!==h[0]||f[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+f+") must match Matrix B ("+h+")");if(!d)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=f[0],b=f[1],x=typeof p=="string"&&p===y?p:void 0,N=x?n.find(o,[x,x]):o,C,_,w=[];for(C=0;C<g;C++)w[C]=[];var A=[],$=[];for(_=0;_<b;_++){for(var S=_+1,D=v[_],V=v[_+1],I=D;I<V;I++)C=m[I],A[C]=u?N(d[I],c[C][_]):N(c[C][_],d[I]),$[C]=S;for(C=0;C<g;C++)$[C]===S?w[C][_]=A[C]:w[C][_]=c[C][_]}return new r({data:w,size:[g,b],datatype:x})};return i}var name$15="algorithm01",factory_1$17=factory$17,algorithm01={name:name$15,factory:factory_1$17};function factory$18(l,t,e,n){var r=e(equalScalar),i=l.SparseMatrix,a=function(s,o,u){var c=s._values,f=s._index,p=s._ptr,d=s._size,m=s._datatype,v=o._values,h=o._index,y=o._ptr,g=o._size,b=o._datatype;if(d.length!==g.length)throw new DimensionError_1(d.length,g.length);if(d[0]!==g[0]||d[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+g+")");var x=d[0],N=d[1],C,_=r,w=0,A=u;typeof m=="string"&&m===b&&(C=m,_=n.find(r,[C,C]),w=n.convert(0,C),A=n.find(u,[C,C]));var $=c&&v?[]:void 0,S=[],D=[],V=new i({values:$,index:S,ptr:D,size:[x,N],datatype:C}),I=c&&v?[]:void 0,q=c&&v?[]:void 0,K=[],E=[],W,G,P,Q,ne;for(G=0;G<N;G++){D[G]=S.length;var Y=G+1;for(Q=p[G],ne=p[G+1],P=Q;P<ne;P++)W=f[P],S.push(W),K[W]=Y,I&&(I[W]=c[P]);for(Q=y[G],ne=y[G+1],P=Q;P<ne;P++)if(W=h[P],K[W]===Y){if(I){var se=A(I[W],v[P]);_(se,w)?K[W]=null:I[W]=se}}else S.push(W),E[W]=Y,q&&(q[W]=v[P]);if(I&&q)for(P=D[G];P<S.length;)W=S[P],K[W]===Y?($[P]=I[W],P++):E[W]===Y?($[P]=q[W],P++):S.splice(P,1)}return D[N]=S.length,V};return a}var name$16="algorithm04",factory_1$18=factory$18,algorithm04={name:name$16,factory:factory_1$18};function factory$19(l,t,e,n){var r=l.DenseMatrix,i=function(a,s,o,u){var c=a._values,f=a._index,p=a._ptr,d=a._size,m=a._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var v=d[0],h=d[1],y,g=o;typeof m=="string"&&(y=m,s=n.convert(s,y),g=n.find(o,[y,y]));for(var b=[],x=new r({data:b,size:[v,h],datatype:y}),N=[],C=[],_=0;_<h;_++){for(var w=_+1,A=p[_],$=p[_+1],S=A;S<$;S++){var D=f[S];N[D]=c[S],C[D]=w}for(var V=0;V<v;V++)_===0&&(b[V]=[]),C[V]===w?b[V][_]=u?g(s,N[V]):g(N[V],s):b[V][_]=s}return x};return i}var name$17="algorithm10",factory_1$19=factory$19,algorithm10={name:name$17,factory:factory_1$19},string$4=utils.string,isString$3=string$4.isString;function factory$20(l,t,e,n){var r=l.DenseMatrix,i=function(s,o,u){var c=s._data,f=s._size,p=s._datatype,d=o._data,m=o._size,v=o._datatype,h=[];if(f.length!==m.length)throw new DimensionError_1(f.length,m.length);for(var y=0;y<f.length;y++){if(f[y]!==m[y])throw new RangeError("Dimension mismatch. Matrix A ("+f+") must match Matrix B ("+m+")");h[y]=f[y]}var g,b=u;typeof p=="string"&&p===v&&(g=p,o=n.convert(o,g),b=n.find(u,[g,g]));var x=h.length>0?a(b,0,h,h[0],c,d):[];return new r({data:x,size:h,datatype:g})},a=function(s,o,u,c,f,p){var d=[];if(o===u.length-1)for(var m=0;m<c;m++)d[m]=s(f[m],p[m]);else for(var v=0;v<c;v++)d[v]=a(s,o+1,u,u[o+1],f[v],p[v]);return d};return i}var name$18="algorithm13",factory_1$20=factory$20,algorithm13={name:name$18,factory:factory_1$20},clone=object.clone;function factory$21(l,t,e,n){var r=l.DenseMatrix,i=function(s,o,u,c){var f=s._data,p=s._size,d=s._datatype,m,v=u;typeof d=="string"&&(m=d,o=n.convert(o,m),v=n.find(u,[m,m]));var h=p.length>0?a(v,0,p,p[0],f,o,c):[];return new r({data:h,size:clone(p),datatype:m})},a=function(s,o,u,c,f,p,d){var m=[];if(o===u.length-1)for(var v=0;v<c;v++)m[v]=d?s(p,f[v]):s(f[v],p);else for(var h=0;h<c;h++)m[h]=a(s,o+1,u,u[o+1],f[h],p,d);return m};return i}var name$19="algorithm14",factory_1$21=factory$21,algorithm14={name:name$19,factory:factory_1$21},extend=object.extend;function factory$22(l,t,e,n){var r=e(matrix),i=e(addScalar),a=latex,s=e(algorithm01),o=e(algorithm04),u=e(algorithm10),c=e(algorithm13),f=e(algorithm14),p=n("add",extend({"DenseMatrix, DenseMatrix":function(d,m){return c(d,m,i)},"DenseMatrix, SparseMatrix":function(d,m){return s(d,m,i,!1)},"SparseMatrix, DenseMatrix":function(d,m){return s(m,d,i,!0)},"SparseMatrix, SparseMatrix":function(d,m){return o(d,m,i)},"Array, Array":function(d,m){return p(r(d),r(m)).valueOf()},"Array, Matrix":function(d,m){return p(r(d),m)},"Matrix, Array":function(d,m){return p(d,r(m))},"DenseMatrix, any":function(d,m){return f(d,m,i,!1)},"SparseMatrix, any":function(d,m){return u(d,m,i,!1)},"any, DenseMatrix":function(d,m){return f(m,d,i,!0)},"any, SparseMatrix":function(d,m){return u(m,d,i,!0)},"Array, any":function(d,m){return f(r(d),m,i,!1).valueOf()},"any, Array":function(d,m){return f(r(m),d,i,!0).valueOf()},"any, any":i,"any, any, ...any":function(d,m,v){for(var h=p(d,m),y=0;y<v.length;y++)h=p(h,v[y]);return h}},i.signatures));return p.toTex={2:"\\left(${args[0]}"+a.operators.add+"${args[1]}\\right)"},p}var name$20="add",factory_1$22=factory$22,add={name:name$20,factory:factory_1$22};function factory$23(l,t,e){var n=e(add),r=e(equalScalar);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new l.FibonacciHeap}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(a,s){if(this._values[a])this._values[a].value=s;else{var o=this._heap.insert(a,s);this._values[a]=o}},i.prototype.get=function(a){var s=this._values[a];return s?s.value:0},i.prototype.accumulate=function(a,s){var o=this._values[a];o?o.value=n(o.value,s):(o=this._heap.insert(a,s),this._values[a]=o)},i.prototype.forEach=function(a,s,o){var u=this._heap,c=this._values,f=[],p=u.extractMinimum();for(p&&f.push(p);p&&p.key<=s;)p.key>=a&&(r(p.value,0)||o(p.key,p.value,this)),p=u.extractMinimum(),p&&f.push(p);for(var d=0;d<f.length;d++){var m=f[d];p=u.insert(m.key,m.value),c[p.key]=p}},i.prototype.swap=function(a,s){var o=this._values[a],u=this._values[s];if(!o&&u)o=this._heap.insert(a,u.value),this._heap.remove(u),this._values[a]=o,this._values[s]=void 0;else if(o&&!u)u=this._heap.insert(s,o.value),this._heap.remove(o),this._values[s]=u,this._values[a]=void 0;else if(o&&u){var c=o.value;o.value=u.value,u.value=c}},i}var name$21="Spa",path$7="type",factory_1$23=factory$23,Spa={name:name$21,path:path$7,factory:factory_1$23};function factory$24(l,t,e,n){var r=l.DenseMatrix,i=function(a,s,o,u){var c=a._data,f=a._size,p=a._datatype,d=s._values,m=s._index,v=s._ptr,h=s._size,y=s._datatype;if(f.length!==h.length)throw new DimensionError_1(f.length,h.length);if(f[0]!==h[0]||f[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+f+") must match Matrix B ("+h+")");if(!d)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=f[0],b=f[1],x,N=0,C=o;typeof p=="string"&&p===y&&(x=p,N=n.convert(0,x),C=n.find(o,[x,x]));for(var _=[],w=0;w<g;w++)_[w]=[];for(var A=[],$=[],S=0;S<b;S++){for(var D=S+1,V=v[S],I=v[S+1],q=V;q<I;q++){var K=m[q];A[K]=u?C(d[q],c[K][S]):C(c[K][S],d[q]),$[K]=D}for(var E=0;E<g;E++)$[E]===D?_[E][S]=A[E]:_[E][S]=u?C(N,c[E][S]):C(c[E][S],N)}return new r({data:_,size:[g,b],datatype:x})};return i}var name$22="algorithm03",factory_1$24=factory$24,algorithm03={name:name$22,factory:factory_1$24};function factory$25(l,t,e,n){var r=l.DenseMatrix,i=function(s,o,u){var c=s._size,f=s._datatype,p=o._size,d=o._datatype;if(c.length!==p.length)throw new DimensionError_1(c.length,p.length);if(c[0]!==p[0]||c[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+p+")");var m=c[0],v=c[1],h,y=0,g=u;typeof f=="string"&&f===d&&(h=f,y=n.convert(0,h),g=n.find(u,[h,h]));var b,x,N=[];for(b=0;b<m;b++)N[b]=[];var C=new r({data:N,size:[m,v],datatype:h}),_=[],w=[],A=[],$=[];for(x=0;x<v;x++){var S=x+1;for(a(s,x,A,_,S),a(o,x,$,w,S),b=0;b<m;b++){var D=A[b]===S?_[b]:y,V=$[b]===S?w[b]:y;N[b][x]=g(D,V)}}return C},a=function(s,o,u,c,f){for(var p=s._values,d=s._index,m=s._ptr,v=m[o],h=m[o+1];v<h;v++){var y=d[v];u[y]=f,c[y]=p[v]}};return i}var name$23="algorithm07",factory_1$25=factory$25,algorithm07={name:name$23,factory:factory_1$25};function factory$26(l,t,e,n){var r=l.DenseMatrix,i=function(a,s,o,u){var c=a._values,f=a._index,p=a._ptr,d=a._size,m=a._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var v=d[0],h=d[1],y,g=o;typeof m=="string"&&(y=m,s=n.convert(s,y),g=n.find(o,[y,y]));for(var b=[],x=new r({data:b,size:[v,h],datatype:y}),N=[],C=[],_=0;_<h;_++){for(var w=_+1,A=p[_],$=p[_+1],S=A;S<$;S++){var D=f[S];N[D]=c[S],C[D]=w}for(var V=0;V<v;V++)_===0&&(b[V]=[]),C[V]===w?b[V][_]=u?g(s,N[V]):g(N[V],s):b[V][_]=u?g(s,0):g(0,s)}return x};return i}var name$24="algorithm12",factory_1$26=factory$26,algorithm12={name:name$24,factory:factory_1$26},nearlyEqual$2=number.nearlyEqual;function factory$27(l,t,e,n){var r=e(matrix),i=e(algorithm03),a=e(algorithm07),s=e(algorithm12),o=e(algorithm13),u=e(algorithm14),c=latex,f=n("smaller",{"boolean, boolean":function(p,d){return p<d},"number, number":function(p,d){return p<d&&!nearlyEqual$2(p,d,t.epsilon)},"BigNumber, BigNumber":function(p,d){return p.lt(d)&&!nearlyEqual(p,d,t.epsilon)},"Fraction, Fraction":function(p,d){return p.compare(d)===-1},"Complex, Complex":function(p,d){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(p,d){if(!p.equalBase(d))throw new Error("Cannot compare units with different base");return f(p.value,d.value)},"SparseMatrix, SparseMatrix":function(p,d){return a(p,d,f)},"SparseMatrix, DenseMatrix":function(p,d){return i(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return i(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return o(p,d,f)},"Array, Array":function(p,d){return f(r(p),r(d)).valueOf()},"Array, Matrix":function(p,d){return f(r(p),d)},"Matrix, Array":function(p,d){return f(p,r(d))},"SparseMatrix, any":function(p,d){return s(p,d,f,!1)},"DenseMatrix, any":function(p,d){return u(p,d,f,!1)},"any, SparseMatrix":function(p,d){return s(d,p,f,!0)},"any, DenseMatrix":function(p,d){return u(d,p,f,!0)},"Array, any":function(p,d){return u(r(p),d,f,!1).valueOf()},"any, Array":function(p,d){return u(r(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+c.operators.smaller+"${args[1]}\\right)"},f}var name$25="smaller",factory_1$27=factory$27,smaller={name:name$25,factory:factory_1$27},nearlyEqual$3=number.nearlyEqual;function factory$28(l,t,e,n){var r=e(matrix),i=e(algorithm03),a=e(algorithm07),s=e(algorithm12),o=e(algorithm13),u=e(algorithm14),c=latex,f=n("larger",{"boolean, boolean":function(p,d){return p>d},"number, number":function(p,d){return p>d&&!nearlyEqual$3(p,d,t.epsilon)},"BigNumber, BigNumber":function(p,d){return p.gt(d)&&!nearlyEqual(p,d,t.epsilon)},"Fraction, Fraction":function(p,d){return p.compare(d)===1},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(p,d){if(!p.equalBase(d))throw new Error("Cannot compare units with different base");return f(p.value,d.value)},"SparseMatrix, SparseMatrix":function(p,d){return a(p,d,f)},"SparseMatrix, DenseMatrix":function(p,d){return i(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return i(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return o(p,d,f)},"Array, Array":function(p,d){return f(r(p),r(d)).valueOf()},"Array, Matrix":function(p,d){return f(r(p),d)},"Matrix, Array":function(p,d){return f(p,r(d))},"SparseMatrix, any":function(p,d){return s(p,d,f,!1)},"DenseMatrix, any":function(p,d){return u(p,d,f,!1)},"any, SparseMatrix":function(p,d){return s(d,p,f,!0)},"any, DenseMatrix":function(p,d){return u(d,p,f,!0)},"Array, any":function(p,d){return u(r(p),d,f,!1).valueOf()},"any, Array":function(p,d){return u(r(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+c.operators.larger+"${args[1]}\\right)"},f}var name$26="larger",factory_1$28=factory$28,larger={name:name$26,factory:factory_1$28};function factory$29(l,t,e,n){var r=e(smaller),i=e(larger),a=1/Math.log((1+Math.sqrt(5))/2);function s(){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}s.prototype.type="FibonacciHeap",s.prototype.isFibonacciHeap=!0,s.prototype.insert=function(d,m){var v={key:d,value:m,degree:0};if(this._minimum){var h=this._minimum;v.left=h,v.right=h.right,h.right=v,v.right.left=v,r(d,h.key)&&(this._minimum=v)}else v.left=v,v.right=v,this._minimum=v;return this._size++,v},s.prototype.size=function(){return this._size},s.prototype.clear=function(){this._minimum=null,this._size=0},s.prototype.isEmpty=function(){return this._size===0},s.prototype.extractMinimum=function(){var d=this._minimum;if(d===null)return d;for(var m=this._minimum,v=d.degree,h=d.child;v>0;){var y=h.right;h.left.right=h.right,h.right.left=h.left,h.left=m,h.right=m.right,m.right=h,h.right.left=h,h.parent=null,h=y,v--}return d.left.right=d.right,d.right.left=d.left,d==d.right?m=null:(m=d.right,m=p(m,this._size)),this._size--,this._minimum=m,d},s.prototype.remove=function(d){this._minimum=o(this._minimum,d,-1),this.extractMinimum()};var o=function(d,m,v){m.key=v;var h=m.parent;return h&&r(m.key,h.key)&&(u(d,m,h),c(d,h)),r(m.key,d.key)&&(d=m),d},u=function(d,m,v){m.left.right=m.right,m.right.left=m.left,v.degree--,v.child==m&&(v.child=m.right),v.degree===0&&(v.child=null),m.left=d,m.right=d.right,d.right=m,m.right.left=m,m.parent=null,m.mark=!1},c=function(d,m){var v=m.parent;!v||(m.mark?(u(d,m,v),c(v)):m.mark=!0)},f=function(d,m){d.left.right=d.right,d.right.left=d.left,d.parent=m,m.child?(d.left=m.child,d.right=m.child.right,m.child.right=d,d.right.left=d):(m.child=d,d.right=d,d.left=d),m.degree++,d.mark=!1},p=function(d,m){var v=Math.floor(Math.log(m)*a)+1,h=new Array(v),y=0,g=d;if(g)for(y++,g=g.right;g!==d;)y++,g=g.right;for(var b;y>0;){for(var x=g.degree,N=g.right;b=h[x],!!b;){if(i(g.key,b.key)){var C=b;b=g,g=C}f(b,g),h[x]=null,x++}h[x]=g,g=N,y--}d=null;for(var _=0;_<v;_++)b=h[_],!!b&&(d?(b.left.right=b.right,b.right.left=b.left,b.left=d,b.right=d.right,d.right=b,b.right.left=b,r(b.key,d.key)&&(d=b)):d=b);return d};return s}var name$27="FibonacciHeap",path$8="type",factory_1$29=factory$29,FibonacciHeap={name:name$27,path:path$8,factory:factory_1$29},string$5=utils.string,object$3=utils.object,isArray$2=Array.isArray,isString$4=string$5.isString;function factory$30(l,t,e){var n=e(DenseMatrix),r=e(smaller);function i(a,s){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(s&&!isString$4(s))throw new Error("Invalid datatype: "+s);if(l.isMatrix(a)||isArray$2(a)){var o=new n(a,s);this._data=o._data,this._size=o._size,this._datatype=o._datatype,this._min=null,this._max=null}else if(a&&isArray$2(a.data)&&isArray$2(a.size))this._data=a.data,this._size=a.size,this._datatype=a.datatype,this._min=typeof a.min!="undefined"?a.min:null,this._max=typeof a.max!="undefined"?a.max:null;else{if(a)throw new TypeError("Unsupported type of data ("+utils.types.type(a)+")");this._data=[],this._size=[0],this._datatype=s,this._min=null,this._max=null}}return i.prototype=new n,i.prototype.type="ImmutableDenseMatrix",i.prototype.isImmutableDenseMatrix=!0,i.prototype.subset=function(a){switch(arguments.length){case 1:var s=n.prototype.subset.call(this,a);return l.isMatrix(s)?new i({data:s._data,size:s._size,datatype:s._datatype}):s;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},i.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},i.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},i.prototype.clone=function(){var a=new i({data:object$3.clone(this._data),size:object$3.clone(this._size),datatype:this._datatype});return a},i.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},i.fromJSON=function(a){return new i(a)},i.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},i.prototype.min=function(){if(this._min===null){var a=null;this.forEach(function(s){(a===null||r(s,a))&&(a=s)}),this._min=a!==null?a:void 0}return this._min},i.prototype.max=function(){if(this._max===null){var a=null;this.forEach(function(s){(a===null||r(a,s))&&(a=s)}),this._max=a!==null?a:void 0}return this._max},i}var name$28="ImmutableDenseMatrix",path$9="type",factory_1$30=factory$30,ImmutableDenseMatrix={name:name$28,path:path$9,factory:factory_1$30},clone$1=object.clone,isInteger$2=number.isInteger;function factory$31(l){function t(n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var r=0,i=arguments.length;r<i;r++){var a=arguments[r];if(l.isRange(a))this._dimensions.push(a),this._isScalar=!1;else if(Array.isArray(a)||l.isMatrix(a)){var s=e(a.valueOf());this._dimensions.push(s);var o=s.size();(o.length!==1||o[0]!==1)&&(this._isScalar=!1)}else if(typeof a=="number")this._dimensions.push(e([a]));else if(typeof a=="string")this._dimensions.push(a);else throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range")}}t.prototype.type="Index",t.prototype.isIndex=!0;function e(n){for(var r=0,i=n.length;r<i;r++)if(typeof n[r]!="number"||!isInteger$2(n[r]))throw new TypeError("Index parameters must be positive integer numbers");return new l.ImmutableDenseMatrix(n)}return t.prototype.clone=function(){var n=new t;return n._dimensions=clone$1(this._dimensions),n._isScalar=this._isScalar,n},t.create=function(n){var r=new t;return t.apply(r,n),r},t.prototype.size=function(){for(var n=[],r=0,i=this._dimensions.length;r<i;r++){var a=this._dimensions[r];n[r]=typeof a=="string"?1:a.size()[0]}return n},t.prototype.max=function(){for(var n=[],r=0,i=this._dimensions.length;r<i;r++){var a=this._dimensions[r];n[r]=typeof a=="string"?a:a.max()}return n},t.prototype.min=function(){for(var n=[],r=0,i=this._dimensions.length;r<i;r++){var a=this._dimensions[r];n[r]=typeof a=="string"?a:a.min()}return n},t.prototype.forEach=function(n){for(var r=0,i=this._dimensions.length;r<i;r++)n(this._dimensions[r],r,this)},t.prototype.dimension=function(n){return this._dimensions[n]||null},t.prototype.isObjectProperty=function(){return this._dimensions.length===1&&typeof this._dimensions[0]=="string"},t.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},t.prototype.isScalar=function(){return this._isScalar},t.prototype.toArray=function(){for(var n=[],r=0,i=this._dimensions.length;r<i;r++){var a=this._dimensions[r];n.push(typeof a=="string"?a:a.toArray())}return n},t.prototype.valueOf=t.prototype.toArray,t.prototype.toString=function(){for(var n=[],r=0,i=this._dimensions.length;r<i;r++){var a=this._dimensions[r];typeof a=="string"?n.push(JSON.stringify(a)):n.push(a.toString())}return"["+n.join(", ")+"]"},t.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},t.fromJSON=function(n){return t.create(n.dimensions)},t}var name$29="Index",path$10="type",factory_1$31=factory$31,MatrixIndex={name:name$29,path:path$10,factory:factory_1$31};function factory$32(l,t,e,n){function r(i,a,s){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(i!=null){if(l.isBigNumber(i))i=i.toNumber();else if(typeof i!="number")throw new TypeError("Parameter start must be a number")}if(a!=null){if(l.isBigNumber(a))a=a.toNumber();else if(typeof a!="number")throw new TypeError("Parameter end must be a number")}if(s!=null){if(l.isBigNumber(s))s=s.toNumber();else if(typeof s!="number")throw new TypeError("Parameter step must be a number")}this.start=i!=null?parseFloat(i):0,this.end=a!=null?parseFloat(a):0,this.step=s!=null?parseFloat(s):1}return r.prototype.type="Range",r.prototype.isRange=!0,r.parse=function(i){if(typeof i!="string")return null;var a=i.split(":"),s=a.map(function(u){return parseFloat(u)}),o=s.some(function(u){return isNaN(u)});if(o)return null;switch(s.length){case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[2],s[1]);default:return null}},r.prototype.clone=function(){return new r(this.start,this.end,this.step)},r.prototype.size=function(){var i=0,a=this.start,s=this.step,o=this.end,u=o-a;return number.sign(s)==number.sign(u)?i=Math.ceil(u/s):u==0&&(i=0),isNaN(i)&&(i=0),[i]},r.prototype.min=function(){var i=this.size()[0];if(i>0)return this.step>0?this.start:this.start+(i-1)*this.step},r.prototype.max=function(){var i=this.size()[0];if(i>0)return this.step>0?this.start+(i-1)*this.step:this.start},r.prototype.forEach=function(i){var a=this.start,s=this.step,o=this.end,u=0;if(s>0)for(;a<o;)i(a,[u],this),a+=s,u++;else if(s<0)for(;a>o;)i(a,[u],this),a+=s,u++},r.prototype.map=function(i){var a=[];return this.forEach(function(s,o,u){a[o[0]]=i(s,o,u)}),a},r.prototype.toArray=function(){var i=[];return this.forEach(function(a,s){i[s[0]]=a}),i},r.prototype.valueOf=function(){return this.toArray()},r.prototype.format=function(i){var a=number.format(this.start,i);return this.step!=1&&(a+=":"+number.format(this.step,i)),a+=":"+number.format(this.end,i),a},r.prototype.toString=function(){return this.format()},r.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},r.fromJSON=function(i){return new r(i.start,i.end,i.step)},r}var name$30="Range",path$11="type",factory_1$32=factory$32,Range={name:name$30,path:path$11,factory:factory_1$32};function factory$33(l,t,e,n){return n("index",{"...number | string | BigNumber | Range | Array | Matrix":function(r){var i=r.map(function(s){return l.isBigNumber(s)?s.toNumber():Array.isArray(s)||l.isMatrix(s)?s.map(function(o){return l.isBigNumber(o)?o.toNumber():o}):s}),a=new l.Index;return l.Index.apply(a,i),a}})}var name$31="index",factory_1$33=factory$33,_function$1={name:name$31,factory:factory_1$33};function factory$34(l,t,e,n){var r=l.SparseMatrix,i=n("sparse",{"":function(){return new r([])},string:function(a){return new r([],a)},"Array | Matrix":function(a){return new r(a)},"Array | Matrix, string":function(a,s){return new r(a,s)}});return i.toTex={0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},i}var name$32="sparse",factory_1$34=factory$34,sparse={name:name$32,factory:factory_1$34},matrix$1=[Matrix,DenseMatrix,SparseMatrix,Spa,FibonacciHeap,ImmutableDenseMatrix,MatrixIndex,Range,_function$1,matrix,sparse];function factory$35(l,t,e,n){var r=n("number",{"":function(){return 0},number:function(i){return i},string:function(i){var a=Number(i);if(isNaN(a))throw new SyntaxError('String "'+i+'" is no valid number');return a},BigNumber:function(i){return i.toNumber()},Fraction:function(i){return i.valueOf()},Unit:function(i){throw new Error("Second argument with valueless unit expected")},null:function(i){return 0},"Unit, string | Unit":function(i,a){return i.toNumber(a)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},r}var name$33="number",factory_1$35=factory$35,number$3={name:name$33,factory:factory_1$35};function factory$36(l,t,e,n){function r(i){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.entries=i||[]}return r.prototype.type="ResultSet",r.prototype.isResultSet=!0,r.prototype.valueOf=function(){return this.entries},r.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},r.fromJSON=function(i){return new r(i.entries)},r}var name$34="ResultSet",path$12="type",factory_1$36=factory$36,ResultSet={name:name$34,path:path$12,factory:factory_1$36},resultset=[ResultSet];function factory$37(l,t,e,n){var r=n("string",{"":function(){return""},number:number.format,null:function(i){return"null"},boolean:function(i){return i+""},string:function(i){return i},"Array | Matrix":function(i){return deepMap(i,r)},any:function(i){return String(i)}});return r.toTex={0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},r}var name$35="string",factory_1$37=factory$37,string$6={name:name$35,factory:factory_1$37},type=[bignumber$1,boolean_1,chain$1,complex$3,fraction$3,matrix$1,number$3,resultset,string$6],constants=createCommonjsModule(function(l,t){var e=_function.memoize;t.e=e(function(r){return new r(1).exp()},n),t.phi=e(function(r){return new r(1).plus(new r(5).sqrt()).div(2)},n),t.pi=e(function(r){return r.acos(-1)},n),t.tau=e(function(r){return t.pi(r).times(2)},n);function n(r){return r[0].precision}}),constants_1=constants.e,constants_2=constants.phi,constants_3=constants.pi,constants_4=constants.tau;function factory$38(l,t,e,n,r){r.on("config",function(i,a){(i.number!==a.number||i.define_pi!==a.define_pi||i.define_e!==a.define_e||i.define_i!==a.define_i)&&factory$38(l,t,e,n,r)}),setConstant(r,"true",!0),setConstant(r,"false",!1),setConstant(r,"null",null),setConstant(r,"uninitialized","Error: Constant uninitialized is removed since v4.0.0. Use null instead"),t.number==="BigNumber"?(setConstant(r,"Infinity",new l.BigNumber(Infinity)),setConstant(r,"NaN",new l.BigNumber(NaN)),t.define_pi===!1?deleteConstant(r,"pi"):setLazyConstant(r,"pi",function(){return constants.pi(l.BigNumber)}),t.define_e===!1?deleteConstant(r,"e"):setLazyConstant(r,"e",function(){return constants.e(l.BigNumber)})):(setConstant(r,"Infinity",Infinity),setConstant(r,"NaN",NaN),t.define_pi===!1?deleteConstant(r,"pi"):setConstant(r,"pi",Math.PI),t.define_e===!1?deleteConstant(r,"e"):setConstant(r,"e",Math.E)),t.define_i===!1?deleteConstant(r,"i"):setConstant(r,"i",l.Complex.I)}function deleteConstant(l,t){delete l[t],delete l.expression.mathWithTransform[t]}function setConstant(l,t,e){l[t]=e,l.expression.mathWithTransform[t]=e}function setLazyConstant(l,t,e){object.lazy(l,t,e),object.lazy(l.expression.mathWithTransform,t,e)}let lazy$4=!1,math$5=!0;var constants$1={factory:factory$38,lazy:lazy$4,math:math$5},bignumber$2={name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","fraction","index","matrix","string","unit"]},boolean_1$2={name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},complex$4={name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},createUnit={name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},fraction$4={name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(num,den)"],description:"Create a fraction from a number or from a numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},construction={name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["[]","[1, 2, 3]","A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[0:2, 0:2] = ones(2, 2)"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]},matrix$2={name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},number$4={name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","boolean","complex","fraction","index","matrix","string","unit"]},sparse$1={name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},splitUnit={name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},string$7={name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},unit={name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},e={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},_false={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},i={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},_Infinity={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},LN2={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},LN10={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},LOG2E={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},LOG10E={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},_NaN={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},_null={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},pi={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},phi={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},SQRT1_2={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},SQRT2={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},tau={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},_true={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},version={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},derivative={name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.eval({x: 3})"],seealso:["simplify","parse","eval"]},lsolve={name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Solves the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lup","lusolve","usolve","matrix","sparse"]},lup={name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lusolve={name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},simplify={name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.eval({x: 2})"],seealso:["derivative","parse","eval"]},rationalize={name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},slu={name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},usolve={name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Solves the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["lup","lusolve","lsolve","matrix","sparse"]},qr={name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},abs={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},add$1={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},cbrt={name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},ceil={name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]},cube={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},divide={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},dotDivide={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},dotMultiply={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},dotPow={name:"dotpow",category:"Operators",syntax:["x .^ y","dotpow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},exp={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},expm={name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},expm1={name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},fix={name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]},floor={name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]},gcd={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},hypot={name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenusa of a list with values. ",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},lcm={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},log={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},log2={name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},log1p={name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},log10={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},mod={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},multiply={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},norm={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},nthRoot={name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["sqrt","pow"]},pow={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)"],seealso:["multiply"]},round={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]},sign={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},sqrt={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply"]},sqrtm={name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[1, 2], [3, 4]])"],seealso:["sqrt","abs","square","multiply"]},square={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},subtract={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},unaryMinus={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},unaryPlus={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},xgcd={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},bitAnd={name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitNot={name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitOr={name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},bitXor={name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},leftShift={name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},rightArithShift={name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},rightLogShift={name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},bellNumbers={name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},catalan={name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},composition={name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},stirlingS2={name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},config$1={name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},_import$1={name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},typed$1={name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number, number": f(x)=x+x })',"double(2)",'double("hello")'],seealso:[]},arg={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},conj={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},re={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},im={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},_eval={name:"eval",category:"Expression",syntax:["eval(expression)","eval([expr1, expr2, expr3, ...])"],description:"Evaluate an expression or an array with expressions.",examples:['eval("2 + 3")','eval("sqrt(" + 4 + ")")'],seealso:[]},help={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},distance={name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},intersect={name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},and={name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},not={name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},or={name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},xor={name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},concat={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},cross={name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},det={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diag={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},dot={name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},eye={name:"eye",category:"Matrix",syntax:["eye(n)","eye(m, n)","eye([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["eye(3)","eye(3, 5)","a = [1, 2, 3; 4, 5, 6]","eye(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},filter={name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},flatten$1={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},forEach={name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["forEach([1, 2, 3], function(val) { console.log(val) })"],seealso:["map","sort","filter"]},inv={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","eye","ones","range","size","squeeze","subset","trace","transpose","zeros"]},kron={name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},map={name:"map",category:"Matrix",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], square)"],seealso:["filter","forEach"]},ones={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","eye","inv","range","size","squeeze","subset","trace","transpose","zeros"]},partitionSelect={name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1)'],seealso:["sort"]},range={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","eye","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},resize={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},reshape={name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])"],seealso:["size","squeeze","resize"]},size={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","det","diag","eye","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},sort={name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"])',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},squeeze={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","eye","inv","ones","range","size","subset","trace","transpose","zeros"]},subset={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of a matrix or string. Indexes are one-based. Both the ranges lower-bound and upper-bound are included.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","trace","transpose","zeros"]},trace={name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","transpose","zeros"]},transpose={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","zeros"]},zeros={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose"]},combinations={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["permutations","factorial"]},factorial={name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","permutations","gamma"]},gamma={name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},kldivergence={name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},multinomial={name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},permutations={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","factorial"]},pickRandom={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},random={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},randomInt={name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},compare={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},compareNatural={name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},compareText={name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},deepEqual={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},equal={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},equalText={name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},larger$1={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},largerEq={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},smaller$1={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},smallerEq={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},unequal={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},setCartesian={name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},setDifference={name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},setDistinct={name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},setIntersect={name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},setIsSubset={name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},setMultiplicity={name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},setPowerset={name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},setSize={name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},setSymDifference={name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},setUnion={name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},erf={name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},mad={name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},max={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dim)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","var"]},mean={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dim)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","var"]},median={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","var","quantileSeq"]},min={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dim)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","var"]},mode={name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","var"]},prod={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","var"]},quantileSeq={name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:`Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probablity are: Number, BigNumber. 

In case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.`,examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","var"]},std={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(var(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","sum","var"]},sum={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","var"]},_var={name:"var",category:"Statistics",syntax:["var(a, b, c, ...)","var(A)","var(A, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["var(2, 4, 6)","var([2, 4, 6, 8])",'var([2, 4, 6, 8], "uncorrected")','var([2, 4, 6, 8], "biased")',"var([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},acos={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},acosh={name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},acot={name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},acoth={name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the hyperbolic arccotangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},acsc={name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},acsch={name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the hyperbolic arccosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},asec={name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},asech={name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},asin={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},asinh={name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},atan={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},atanh={name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},atan2={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},cos={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},cosh={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},cot={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},coth={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},csc={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},csch={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},sec={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},sech={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},sin={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},sinh={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},tan={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},tanh={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},to={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},clone$2={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},format$2={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},_isNaN={name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isInteger$3={name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isNegative={name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},isNumeric={name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)","isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))",'isNumeric("3")',"isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN"]},isPositive={name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isPrime={name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isZero={name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},_typeof={name:"typeof",category:"Utils",syntax:["typeof(x)"],description:"Get the type of a variable.",examples:["typeof(3.5)","typeof(2 - 4i)","typeof(45 deg)",'typeof("hello world")'],seealso:[]};function factory$39(l,t,e,n){var r={};return r.bignumber=bignumber$2,r.boolean=boolean_1$2,r.complex=complex$4,r.createUnit=createUnit,r.fraction=fraction$4,r.index=construction,r.matrix=matrix$2,r.number=number$4,r.sparse=sparse$1,r.splitUnit=splitUnit,r.string=string$7,r.unit=unit,r.e=e,r.E=e,r.false=_false,r.i=i,r.Infinity=_Infinity,r.LN2=LN2,r.LN10=LN10,r.LOG2E=LOG2E,r.LOG10E=LOG10E,r.NaN=_NaN,r.null=_null,r.pi=pi,r.PI=pi,r.phi=phi,r.SQRT1_2=SQRT1_2,r.SQRT2=SQRT2,r.tau=tau,r.true=_true,r.version=version,r.speedOfLight={description:"Speed of light in vacuum",examples:["speedOfLight"]},r.gravitationConstant={description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},r.planckConstant={description:"Planck constant",examples:["planckConstant"]},r.reducedPlanckConstant={description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},r.magneticConstant={description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},r.electricConstant={description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},r.vacuumImpedance={description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},r.coulomb={description:"Coulomb's constant",examples:["coulomb"]},r.elementaryCharge={description:"Elementary charge",examples:["elementaryCharge"]},r.bohrMagneton={description:"Borh magneton",examples:["bohrMagneton"]},r.conductanceQuantum={description:"Conductance quantum",examples:["conductanceQuantum"]},r.inverseConductanceQuantum={description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},r.magneticFluxQuantum={description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},r.nuclearMagneton={description:"Nuclear magneton",examples:["nuclearMagneton"]},r.klitzing={description:"Von Klitzing constant",examples:["klitzing"]},r.bohrRadius={description:"Borh radius",examples:["bohrRadius"]},r.classicalElectronRadius={description:"Classical electron radius",examples:["classicalElectronRadius"]},r.electronMass={description:"Electron mass",examples:["electronMass"]},r.fermiCoupling={description:"Fermi coupling constant",examples:["fermiCoupling"]},r.fineStructure={description:"Fine-structure constant",examples:["fineStructure"]},r.hartreeEnergy={description:"Hartree energy",examples:["hartreeEnergy"]},r.protonMass={description:"Proton mass",examples:["protonMass"]},r.deuteronMass={description:"Deuteron Mass",examples:["deuteronMass"]},r.neutronMass={description:"Neutron mass",examples:["neutronMass"]},r.quantumOfCirculation={description:"Quantum of circulation",examples:["quantumOfCirculation"]},r.rydberg={description:"Rydberg constant",examples:["rydberg"]},r.thomsonCrossSection={description:"Thomson cross section",examples:["thomsonCrossSection"]},r.weakMixingAngle={description:"Weak mixing angle",examples:["weakMixingAngle"]},r.efimovFactor={description:"Efimov factor",examples:["efimovFactor"]},r.atomicMass={description:"Atomic mass constant",examples:["atomicMass"]},r.avogadro={description:"Avogadro's number",examples:["avogadro"]},r.boltzmann={description:"Boltzmann constant",examples:["boltzmann"]},r.faraday={description:"Faraday constant",examples:["faraday"]},r.firstRadiation={description:"First radiation constant",examples:["firstRadiation"]},r.loschmidt={description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},r.gasConstant={description:"Gas constant",examples:["gasConstant"]},r.molarPlanckConstant={description:"Molar Planck constant",examples:["molarPlanckConstant"]},r.molarVolume={description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},r.sackurTetrode={description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},r.secondRadiation={description:"Second radiation constant",examples:["secondRadiation"]},r.stefanBoltzmann={description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},r.wienDisplacement={description:"Wien displacement law constant",examples:["wienDisplacement"]},r.molarMass={description:"Molar mass constant",examples:["molarMass"]},r.molarMassC12={description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},r.gravity={description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},r.planckLength={description:"Planck length",examples:["planckLength"]},r.planckMass={description:"Planck mass",examples:["planckMass"]},r.planckTime={description:"Planck time",examples:["planckTime"]},r.planckCharge={description:"Planck charge",examples:["planckCharge"]},r.planckTemperature={description:"Planck temperature",examples:["planckTemperature"]},r.derivative=derivative,r.lsolve=lsolve,r.lup=lup,r.lusolve=lusolve,r.simplify=simplify,r.rationalize=rationalize,r.slu=slu,r.usolve=usolve,r.qr=qr,r.abs=abs,r.add=add$1,r.cbrt=cbrt,r.ceil=ceil,r.cube=cube,r.divide=divide,r.dotDivide=dotDivide,r.dotMultiply=dotMultiply,r.dotPow=dotPow,r.exp=exp,r.expm=expm,r.expm1=expm1,r.fix=fix,r.floor=floor,r.gcd=gcd,r.hypot=hypot,r.lcm=lcm,r.log=log,r.log2=log2,r.log1p=log1p,r.log10=log10,r.mod=mod,r.multiply=multiply,r.norm=norm,r.nthRoot=nthRoot,r.pow=pow,r.round=round,r.sign=sign,r.sqrt=sqrt,r.sqrtm=sqrtm,r.square=square,r.subtract=subtract,r.unaryMinus=unaryMinus,r.unaryPlus=unaryPlus,r.xgcd=xgcd,r.bitAnd=bitAnd,r.bitNot=bitNot,r.bitOr=bitOr,r.bitXor=bitXor,r.leftShift=leftShift,r.rightArithShift=rightArithShift,r.rightLogShift=rightLogShift,r.bellNumbers=bellNumbers,r.catalan=catalan,r.composition=composition,r.stirlingS2=stirlingS2,r.config=config$1,r.import=_import$1,r.typed=typed$1,r.arg=arg,r.conj=conj,r.re=re,r.im=im,r.eval=_eval,r.help=help,r.distance=distance,r.intersect=intersect,r.and=and,r.not=not,r.or=or,r.xor=xor,r.concat=concat,r.cross=cross,r.det=det,r.diag=diag,r.dot=dot,r.eye=eye,r.filter=filter,r.flatten=flatten$1,r.forEach=forEach,r.inv=inv,r.kron=kron,r.map=map,r.ones=ones,r.partitionSelect=partitionSelect,r.range=range,r.resize=resize,r.reshape=reshape,r.size=size,r.sort=sort,r.squeeze=squeeze,r.subset=subset,r.trace=trace,r.transpose=transpose,r.zeros=zeros,r.combinations=combinations,r.factorial=factorial,r.gamma=gamma,r.kldivergence=kldivergence,r.multinomial=multinomial,r.permutations=permutations,r.pickRandom=pickRandom,r.random=random,r.randomInt=randomInt,r.compare=compare,r.compareNatural=compareNatural,r.compareText=compareText,r.deepEqual=deepEqual,r.equal=equal,r.equalText=equalText,r.larger=larger$1,r.largerEq=largerEq,r.smaller=smaller$1,r.smallerEq=smallerEq,r.unequal=unequal,r.setCartesian=setCartesian,r.setDifference=setDifference,r.setDistinct=setDistinct,r.setIntersect=setIntersect,r.setIsSubset=setIsSubset,r.setMultiplicity=setMultiplicity,r.setPowerset=setPowerset,r.setSize=setSize,r.setSymDifference=setSymDifference,r.setUnion=setUnion,r.erf=erf,r.mad=mad,r.max=max,r.mean=mean,r.median=median,r.min=min,r.mode=mode,r.prod=prod,r.quantileSeq=quantileSeq,r.std=std,r.sum=sum,r.var=_var,r.acos=acos,r.acosh=acosh,r.acot=acot,r.acoth=acoth,r.acsc=acsc,r.acsch=acsch,r.asec=asec,r.asech=asech,r.asin=asin,r.asinh=asinh,r.atan=atan,r.atanh=atanh,r.atan2=atan2,r.cos=cos,r.cosh=cosh,r.cot=cot,r.coth=coth,r.csc=csc,r.csch=csch,r.sec=sec,r.sech=sech,r.sin=sin,r.sinh=sinh,r.tan=tan,r.tanh=tanh,r.to=to,r.clone=clone$2,r.format=format$2,r.isNaN=_isNaN,r.isInteger=isInteger$3,r.isNegative=isNegative,r.isNumeric=isNumeric,r.isPositive=isPositive,r.isPrime=isPrime,r.isZero=isZero,r.typeof=_typeof,r}var name$36="docs",path$13="expression",factory_1$38=factory$39,embeddedDocs={name:name$36,path:path$13,factory:factory_1$38};function factory$40(l,t,e,n){return function(i,a){if(a==="BigNumber")return new l.BigNumber(i);if(a==="Fraction")return new l.Fraction(i);if(typeof i=="number")return i;if(i==="Infinity")return Infinity;if(i==="NaN")return NaN;if(!/^[\-+]?((\d+\.?\d*)|(\d*\.?\d+))([eE][+\-]?\d+)?$/.test(i))throw new Error('Invalid numeric value "'+i+'"');return parseFloat(i.replace(/^(0*)[0-9]/,function(s,o){return s.substring(o.length)}))}}var factory_1$39=factory$40,numeric={factory:factory_1$39},hasOwnProperty=object.hasOwnProperty;function getSafeProperty(l,t){if(isPlainObject(l)&&isSafeProperty(l,t))return l[t];throw typeof l[t]=="function"&&isSafeMethod(l,t)?new Error('Cannot access method "'+t+'" as a property'):new Error('No access to property "'+t+'"')}function setSafeProperty(l,t,e){if(isPlainObject(l)&&isSafeProperty(l,t))return l[t]=e;throw new Error('No access to property "'+t+'"')}function isSafeProperty(l,t){return!l||typeof l!="object"?!1:hasOwnProperty(safeNativeProperties,t)?!0:!(t in Object.prototype||t in Function.prototype)}function validateSafeMethod(l,t){if(!isSafeMethod(l,t))throw new Error('No access to method "'+t+'"')}function isSafeMethod(l,t){return!l||typeof l[t]!="function"||hasOwnProperty(l,t)&&l.__proto__&&t in l.__proto__?!1:hasOwnProperty(safeNativeMethods,t)?!0:!(t in Object.prototype||t in Function.prototype)}function isPlainObject(l){return typeof l=="object"&&l&&l.constructor===Object}var safeNativeProperties={length:!0,name:!0},safeNativeMethods={toString:!0,valueOf:!0,toLocaleString:!0},getSafeProperty_1=getSafeProperty,setSafeProperty_1=setSafeProperty,isSafeProperty_1=isSafeProperty,validateSafeMethod_1=validateSafeMethod,isSafeMethod_1=isSafeMethod,isPlainObject_1=isPlainObject,customs={getSafeProperty:getSafeProperty_1,setSafeProperty:setSafeProperty_1,isSafeProperty:isSafeProperty_1,validateSafeMethod:validateSafeMethod_1,isSafeMethod:isSafeMethod_1,isPlainObject:isPlainObject_1},keywords={end:!0},deepEqual$1=object.deepEqual,hasOwnProperty$1=object.hasOwnProperty;function factory$41(l,t,e,n,r){function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator")}i.prototype.eval=function(s){return this.compile().eval(s)},i.prototype.type="Node",i.prototype.isNode=!0,i.prototype.comment="",i.prototype.compile=function(){var s=this._compile(r.expression.mathWithTransform,{}),o={},u=null;return{eval:function(f){var p=f||{};return a(p),s(p,o,u)}}},i.prototype._compile=function(s,o){throw new Error("Method _compile should be implemented by type "+this.type)},i.prototype.forEach=function(s){throw new Error("Cannot run forEach on a Node interface")},i.prototype.map=function(s){throw new Error("Cannot run map on a Node interface")},i.prototype._ifNode=function(s){if(!l.isNode(s))throw new TypeError("Callback function must return a Node");return s},i.prototype.traverse=function(s){s(this,null,null);function o(u,c){u.forEach(function(f,p,d){c(f,p,d),o(f,c)})}o(this,s)},i.prototype.transform=function(s){function o(c,f){return c.map(function(p,d,m){var v=f(p,d,m);return o(v,f)})}var u=s(this,null,null);return o(u,s)},i.prototype.filter=function(s){var o=[];return this.traverse(function(u,c,f){s(u,c,f)&&o.push(u)}),o},i.prototype.find=function(){throw new Error("Function Node.find is deprecated. Use Node.filter instead.")},i.prototype.match=function(){throw new Error("Function Node.match is deprecated. See functions Node.filter, Node.transform, Node.traverse.")},i.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},i.prototype.cloneDeep=function(){return this.map(function(s){return s.cloneDeep()})},i.prototype.equals=function(s){return s?deepEqual$1(this,s):!1},i.prototype.toString=function(s){var o;if(s&&typeof s=="object")switch(typeof s.handler){case"object":case"undefined":break;case"function":o=s.handler(this,s);break;default:throw new TypeError("Object or function expected as callback")}return typeof o!="undefined"?o:this._toString(s)},i.prototype.toJSON=function(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)},i.prototype.toHTML=function(s){var o;if(s&&typeof s=="object")switch(typeof s.handler){case"object":case"undefined":break;case"function":o=s.handler(this,s);break;default:throw new TypeError("Object or function expected as callback")}return typeof o!="undefined"?o:this.toHTML(s)},i.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},i.prototype.toTex=function(s){var o;if(s&&typeof s=="object")switch(typeof s.handler){case"object":case"undefined":break;case"function":o=s.handler(this,s);break;default:throw new TypeError("Object or function expected as callback")}return typeof o!="undefined"?o:this._toTex(s)},i.prototype._toTex=function(s){throw new Error("_toTex not implemented for "+this.type)},i.prototype.getIdentifier=function(){return this.type},i.prototype.getContent=function(){return this};function a(s){for(var o in s)if(hasOwnProperty$1(s,o)&&o in keywords)throw new Error('Scope contains an illegal symbol, "'+o+'" is a reserved keyword')}return i}var name$37="Node",path$14="expression.node",math$6=!0,factory_1$40=factory$41,Node={name:name$37,path:path$14,math:math$6,factory:factory_1$40},map$1=array.map,escape=string.escape;function factory$42(l,t,e,n){var r=e(Node),i=e(Range),a=Array.isArray;function s(u,c){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=u,this.dotNotation=c||!1,!a(u)||!u.every(l.isNode))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties");var f=function(){throw new Error("Property `IndexNode.object` is deprecated, use `IndexNode.fn` instead")};Object.defineProperty(this,"object",{get:f,set:f})}s.prototype=new r,s.prototype.type="IndexNode",s.prototype.isIndexNode=!0,s.prototype._compile=function(u,c){var f=map$1(this.dimensions,function(p,d){if(l.isRangeNode(p))if(p.needsEnd()){var m=Object.create(c);m.end=!0;var v=p.start._compile(u,m),h=p.end._compile(u,m),y=p.step?p.step._compile(u,m):function(){return 1};return function(x,N,C){var _=u.size(C).valueOf(),w=Object.create(N);return w.end=_[d],o(v(x,w,C),h(x,w,C),y(x,w,C))}}else{var v=p.start._compile(u,c),h=p.end._compile(u,c),y=p.step?p.step._compile(u,c):function(){return 1};return function(_,w,A){return o(v(_,w,A),h(_,w,A),y(_,w,A))}}else if(l.isSymbolNode(p)&&p.name==="end"){var m=Object.create(c);m.end=!0;var g=p._compile(u,m);return function(N,C,_){var w=u.size(_).valueOf(),A=Object.create(C);return A.end=w[d],g(N,A,_)}}else{var g=p._compile(u,c);return function(N,C,_){return g(N,C,_)}}});return function(d,m,v){var h=map$1(f,function(y){return y(d,m,v)});return u.index.apply(u,h)}},s.prototype.forEach=function(u){for(var c=0;c<this.dimensions.length;c++)u(this.dimensions[c],"dimensions["+c+"]",this)},s.prototype.map=function(u){for(var c=[],f=0;f<this.dimensions.length;f++)c[f]=this._ifNode(u(this.dimensions[f],"dimensions["+f+"]",this));return new s(c)},s.prototype.clone=function(){return new s(this.dimensions.slice(0))},s.prototype.isObjectProperty=function(){return this.dimensions.length===1&&l.isConstantNode(this.dimensions[0])&&typeof this.dimensions[0].value=="string"},s.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},s.prototype._toString=function(u){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},s.prototype.toJSON=function(){return{mathjs:"IndexNode",dimensions:this.dimensions,dotNotation:this.dotNotation}},s.fromJSON=function(u){return new s(u.dimensions,u.dotNotation)},s.prototype.toHTML=function(u){for(var c=[],f=0;f<this.dimensions.length;f++)c[f]=this.dimensions[f].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+escape(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+c.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},s.prototype._toTex=function(u){var c=this.dimensions.map(function(f){return f.toTex(u)});return this.dotNotation?"."+this.getObjectProperty()+"":"_{"+c.join(",")+"}"};function o(u,c,f){return new i(l.isBigNumber(u)?u.toNumber():u,l.isBigNumber(c)?c.toNumber():c,l.isBigNumber(f)?f.toNumber():f)}return s}var name$38="IndexNode",path$15="expression.node",factory_1$41=factory$42,IndexNode={name:name$38,path:path$15,factory:factory_1$41},transform=function(l){return l&&l.isIndexError?new IndexError_1(l.index+1,l.min+1,l.max!==void 0?l.max+1:void 0):l},error_transform={transform},clone$3=object.clone,validateIndex$2=array.validateIndex,getSafeProperty$1=customs.getSafeProperty,setSafeProperty$1=customs.setSafeProperty;function factory$43(l,t,e,n){var r=e(matrix),i=n("subset",{"Array, Index":function(o,u){var c=r(o),f=c.subset(u);return u.isScalar()?f:f.valueOf()},"Matrix, Index":function(o,u){return o.subset(u)},"Object, Index":_getObjectProperty,"string, Index":a,"Array, Index, any":function(o,u,c){return r(clone$3(o)).subset(u,c,void 0).valueOf()},"Array, Index, any, any":function(o,u,c,f){return r(clone$3(o)).subset(u,c,f).valueOf()},"Matrix, Index, any":function(o,u,c){return o.clone().subset(u,c)},"Matrix, Index, any, any":function(o,u,c,f){return o.clone().subset(u,c,f)},"string, Index, string":s,"string, Index, string, string":s,"Object, Index, any":_setObjectProperty});return i.toTex=void 0,i;function a(o,u){if(!l.isIndex(u))throw new TypeError("Index expected");if(u.size().length!=1)throw new DimensionError_1(u.size().length,1);var c=o.length;validateIndex$2(u.min()[0],c),validateIndex$2(u.max()[0],c);var f=u.dimension(0),p="";return f.forEach(function(d){p+=o.charAt(d)}),p}function s(o,u,c,f){if(!u||u.isIndex!==!0)throw new TypeError("Index expected");if(u.size().length!=1)throw new DimensionError_1(u.size().length,1);if(f!==void 0){if(typeof f!="string"||f.length!==1)throw new TypeError("Single character expected as defaultValue")}else f=" ";var p=u.dimension(0),d=p.size()[0];if(d!=c.length)throw new DimensionError_1(p.size()[0],c.length);var m=o.length;validateIndex$2(u.min()[0]),validateIndex$2(u.max()[0]);for(var v=[],h=0;h<m;h++)v[h]=o.charAt(h);if(p.forEach(function(y,g){v[y]=c.charAt(g[0])}),v.length>m)for(h=m-1,d=v.length;h<d;h++)v[h]||(v[h]=f);return v.join("")}}function _getObjectProperty(l,t){if(t.size().length!==1)throw new DimensionError_1(t.size(),1);var e=t.dimension(0);if(typeof e!="string")throw new TypeError("String expected as index to retrieve an object property");return getSafeProperty$1(l,e)}function _setObjectProperty(l,t,e){if(t.size().length!==1)throw new DimensionError_1(t.size(),1);var n=t.dimension(0);if(typeof n!="string")throw new TypeError("String expected as index to retrieve an object property");var r=clone$3(l);return setSafeProperty$1(r,n,e),r}var name$39="subset",factory_1$42=factory$43,subset$1={name:name$39,factory:factory_1$42},errorTransform=error_transform.transform,getSafeProperty$2=customs.getSafeProperty;function factory$44(l,t,e,n){var r=e(subset$1);return function(a,s){try{if(Array.isArray(a))return r(a,s);if(a&&typeof a.subset=="function")return a.subset(s);if(typeof a=="string")return r(a,s);if(typeof a=="object"){if(!s.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return getSafeProperty$2(a,s.getObjectProperty())}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(o){throw errorTransform(o)}}}var factory_1$43=factory$44,access={factory:factory_1$43},getSafeProperty$3=customs.getSafeProperty;function factory$45(l,t,e,n){var r=e(Node),i=e(IndexNode),a=e(access);function s(u,c){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(!l.isNode(u))throw new TypeError('Node expected for parameter "object"');if(!l.isIndexNode(c))throw new TypeError('IndexNode expected for parameter "index"');this.object=u||null,this.index=c,Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}s.prototype=new r,s.prototype.type="AccessorNode",s.prototype.isAccessorNode=!0,s.prototype._compile=function(u,c){var f=this.object._compile(u,c),p=this.index._compile(u,c);if(this.index.isObjectProperty()){var d=this.index.getObjectProperty();return function(v,h,y){return getSafeProperty$3(f(v,h,y),d)}}else return function(v,h,y){var g=f(v,h,y),b=p(v,h,g);return a(g,b)}},s.prototype.forEach=function(u){u(this.object,"object",this),u(this.index,"index",this)},s.prototype.map=function(u){return new s(this._ifNode(u(this.object,"object",this)),this._ifNode(u(this.index,"index",this)))},s.prototype.clone=function(){return new s(this.object,this.index)},s.prototype._toString=function(u){var c=this.object.toString(u);return o(this.object)&&(c="("+c+")"),c+this.index.toString(u)},s.prototype.toHTML=function(u){var c=this.object.toHTML(u);return o(this.object)&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),c+this.index.toHTML(u)},s.prototype._toTex=function(u){var c=this.object.toTex(u);return o(this.object)&&(c="\\left("+c+"\\right)"),c+this.index.toTex(u)},s.prototype.toJSON=function(){return{mathjs:"AccessorNode",object:this.object,index:this.index}},s.fromJSON=function(u){return new s(u.object,u.index)};function o(u){return!(l.isAccessorNode(u)||l.isArrayNode(u)||l.isConstantNode(u)||l.isFunctionNode(u)||l.isObjectNode(u)||l.isParenthesisNode(u)||l.isSymbolNode(u))}return s}var name$40="AccessorNode",path$16="expression.node",factory_1$44=factory$45,AccessorNode={name:name$40,path:path$16,factory:factory_1$44},map$2=array.map;function factory$46(l,t,e,n){var r=e(Node);function i(a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=a||[],!Array.isArray(this.items)||!this.items.every(l.isNode))throw new TypeError("Array containing Nodes expected");var s=function(){throw new Error("Property `ArrayNode.nodes` is deprecated, use `ArrayNode.items` instead")};Object.defineProperty(this,"nodes",{get:s,set:s})}return i.prototype=new r,i.prototype.type="ArrayNode",i.prototype.isArrayNode=!0,i.prototype._compile=function(a,s){var o=map$2(this.items,function(f){return f._compile(a,s)}),u=a.config().matrix!=="Array";if(u){var c=a.matrix;return function(p,d,m){return c(map$2(o,function(v){return v(p,d,m)}))}}else return function(p,d,m){return map$2(o,function(v){return v(p,d,m)})}},i.prototype.forEach=function(a){for(var s=0;s<this.items.length;s++){var o=this.items[s];a(o,"items["+s+"]",this)}},i.prototype.map=function(a){for(var s=[],o=0;o<this.items.length;o++)s[o]=this._ifNode(a(this.items[o],"items["+o+"]",this));return new i(s)},i.prototype.clone=function(){return new i(this.items.slice(0))},i.prototype._toString=function(a){var s=this.items.map(function(o){return o.toString(a)});return"["+s.join(", ")+"]"},i.prototype.toJSON=function(){return{mathjs:"ArrayNode",items:this.items}},i.fromJSON=function(a){return new i(a.items)},i.prototype.toHTML=function(a){var s=this.items.map(function(o){return o.toHTML(a)});return'<span class="math-parenthesis math-square-parenthesis">[</span>'+s.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},i.prototype._toTex=function(a){var s="\\begin{bmatrix}";return this.items.forEach(function(o){o.items?s+=o.items.map(function(u){return u.toTex(a)}).join("&"):s+=o.toTex(a),s+="\\\\"}),s+="\\end{bmatrix}",s},i}var name$41="ArrayNode",path$17="expression.node",factory_1$45=factory$46,ArrayNode={name:name$41,path:path$17,factory:factory_1$45},errorTransform$1=error_transform.transform,setSafeProperty$2=customs.setSafeProperty;function factory$47(l,t,e,n){var r=e(subset$1),i=e(matrix);return function(s,o,u){try{if(Array.isArray(s))return i(s).subset(o,u).valueOf();if(s&&typeof s.subset=="function")return s.subset(o,u);if(typeof s=="string")return r(s,o,u);if(typeof s=="object"){if(!o.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return setSafeProperty$2(s,o.getObjectProperty(),u),s}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(c){throw errorTransform$1(c)}}}var factory_1$46=factory$47,assign={factory:factory_1$46},properties=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];function getPrecedence(l,t){var e=l;t!=="keep"&&(e=l.getContent());for(var n=e.getIdentifier(),r=0;r<properties.length;r++)if(n in properties[r])return r;return null}function getAssociativity(l,t){var e=l;t!=="keep"&&(e=l.getContent());var n=e.getIdentifier(),r=getPrecedence(e,t);if(r===null)return null;var i=properties[r][n];if(i.hasOwnProperty("associativity")){if(i.associativity==="left")return"left";if(i.associativity==="right")return"right";throw Error("'"+n+"' has the invalid associativity '"+i.associativity+"'.")}return null}function isAssociativeWith(l,t,e){var n=l,r=t;if(e!=="keep")var n=l.getContent(),r=t.getContent();var i=n.getIdentifier(),a=r.getIdentifier(),s=getPrecedence(n,e);if(s===null)return null;var o=properties[s][i];if(o.hasOwnProperty("associativeWith")&&o.associativeWith instanceof Array){for(var u=0;u<o.associativeWith.length;u++)if(o.associativeWith[u]===a)return!0;return!1}return null}var properties_1=properties,getPrecedence_1=getPrecedence,getAssociativity_1=getAssociativity,isAssociativeWith_1=isAssociativeWith,operators={properties:properties_1,getPrecedence:getPrecedence_1,getAssociativity:getAssociativity_1,isAssociativeWith:isAssociativeWith_1},getSafeProperty$4=customs.getSafeProperty,setSafeProperty$3=customs.setSafeProperty;function factory$48(l,t,e,n){var r=e(Node),i=e(assign),a=e(access),s=operators;function o(c,f,p){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=c,this.index=p?f:null,this.value=p||f,!l.isSymbolNode(c)&&!l.isAccessorNode(c))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(l.isSymbolNode(c)&&c.name==="end")throw new Error('Cannot assign to symbol "end"');if(this.index&&!l.isIndexNode(this.index))throw new TypeError('IndexNode expected as "index"');if(!l.isNode(this.value))throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}o.prototype=new r,o.prototype.type="AssignmentNode",o.prototype.isAssignmentNode=!0,o.prototype._compile=function(c,f){var p=this.object._compile(c,f),d=this.index?this.index._compile(c,f):null,m=this.value._compile(c,f),v=this.object.name;if(this.index)if(this.index.isObjectProperty()){var h=this.index.getObjectProperty();return function(N,C,_){var w=p(N,C,_),A=m(N,C,_);return setSafeProperty$3(w,h,A)}}else{if(l.isSymbolNode(this.object))return function(N,C,_){var w=p(N,C,_),A=m(N,C,_),$=d(N,C,w);return setSafeProperty$3(N,v,i(w,$,A)),A};var y=this.object.object._compile(c,f);if(this.object.index.isObjectProperty()){var g=this.object.index.getObjectProperty();return function(N,C,_){var w=y(N,C,_),A=getSafeProperty$4(w,g),$=d(N,C,A),S=m(N,C,_);return setSafeProperty$3(w,g,i(A,$,S)),S}}else{var b=this.object.index._compile(c,f);return function(N,C,_){var w=y(N,C,_),A=b(N,C,w),$=a(w,A),S=d(N,C,$),D=m(N,C,_);return i(w,A,i($,S,D)),D}}}else{if(!l.isSymbolNode(this.object))throw new TypeError("SymbolNode expected as object");return function(N,C,_){return setSafeProperty$3(N,v,m(N,C,_))}}},o.prototype.forEach=function(c){c(this.object,"object",this),this.index&&c(this.index,"index",this),c(this.value,"value",this)},o.prototype.map=function(c){var f=this._ifNode(c(this.object,"object",this)),p=this.index?this._ifNode(c(this.index,"index",this)):null,d=this._ifNode(c(this.value,"value",this));return new o(f,p,d)},o.prototype.clone=function(){return new o(this.object,this.index,this.value)};function u(c,f){f||(f="keep");var p=s.getPrecedence(c,f),d=s.getPrecedence(c.value,f);return f==="all"||d!==null&&d<=p}return o.prototype._toString=function(c){var f=this.object.toString(c),p=this.index?this.index.toString(c):"",d=this.value.toString(c);return u(this,c&&c.parenthesis)&&(d="("+d+")"),f+p+" = "+d},o.prototype.toJSON=function(){return{mathjs:"AssignmentNode",object:this.object,index:this.index,value:this.value}},o.fromJSON=function(c){return new o(c.object,c.index,c.value)},o.prototype.toHTML=function(c){var f=this.object.toHTML(c),p=this.index?this.index.toHTML(c):"",d=this.value.toHTML(c);return u(this,c&&c.parenthesis)&&(d='<span class="math-paranthesis math-round-parenthesis">(</span>'+d+'<span class="math-paranthesis math-round-parenthesis">)</span>'),f+p+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+d},o.prototype._toTex=function(c){var f=this.object.toTex(c),p=this.index?this.index.toTex(c):"",d=this.value.toTex(c);return u(this,c&&c.parenthesis)&&(d="\\left("+d+"\\right)"),f+p+":="+d},o}var name$42="AssignmentNode",path$18="expression.node",factory_1$47=factory$48,AssignmentNode={name:name$42,path:path$18,factory:factory_1$47},forEach$1=array.forEach,map$3=array.map;function factory$49(l,t,e,n){var r=e(Node),i=e(ResultSet);function a(s){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(s))throw new Error("Array expected");this.blocks=s.map(function(o){var u=o&&o.node,c=o&&o.visible!==void 0?o.visible:!0;if(!l.isNode(u))throw new TypeError('Property "node" must be a Node');if(typeof c!="boolean")throw new TypeError('Property "visible" must be a boolean');return{node:u,visible:c}})}return a.prototype=new r,a.prototype.type="BlockNode",a.prototype.isBlockNode=!0,a.prototype._compile=function(s,o){var u=map$3(this.blocks,function(c){return{eval:c.node._compile(s,o),visible:c.visible}});return function(f,p,d){var m=[];return forEach$1(u,function(h){var y=h.eval(f,p,d);h.visible&&m.push(y)}),new i(m)}},a.prototype.forEach=function(s){for(var o=0;o<this.blocks.length;o++)s(this.blocks[o].node,"blocks["+o+"].node",this)},a.prototype.map=function(s){for(var o=[],u=0;u<this.blocks.length;u++){var c=this.blocks[u],f=this._ifNode(s(c.node,"blocks["+u+"].node",this));o[u]={node:f,visible:c.visible}}return new a(o)},a.prototype.clone=function(){var s=this.blocks.map(function(o){return{node:o.node,visible:o.visible}});return new a(s)},a.prototype._toString=function(s){return this.blocks.map(function(o){return o.node.toString(s)+(o.visible?"":";")}).join(`
`)},a.prototype.toJSON=function(){return{mathjs:"BlockNode",blocks:this.blocks}},a.fromJSON=function(s){return new a(s.blocks)},a.prototype.toHTML=function(s){return this.blocks.map(function(o){return o.node.toHTML(s)+(o.visible?"":'<span class="math-separator">;</span>')}).join('<span class="math-separator"><br /></span>')},a.prototype._toTex=function(s){return this.blocks.map(function(o){return o.node.toTex(s)+(o.visible?"":";")}).join(`\\;\\;
`)},a}var name$43="BlockNode",path$19="expression.node",factory_1$48=factory$49,BlockNode={name:name$43,path:path$19,factory:factory_1$48};function factory$50(l,t,e,n){var r=n("_typeof",{any:function(i){var a=typeof i;return a==="object"?i===null?"null":Array.isArray(i)?"Array":i instanceof Date?"Date":i instanceof RegExp?"RegExp":i instanceof Boolean?"boolean":i instanceof Number?"number":i instanceof String?"string":l.isBigNumber(i)?"BigNumber":l.isComplex(i)?"Complex":l.isFraction(i)?"Fraction":l.isMatrix(i)?"Matrix":l.isUnit(i)?"Unit":l.isIndex(i)?"Index":l.isRange(i)?"Range":l.isResultSet(i)?"ResultSet":l.isNode(i)?i.type:l.isChain(i)?"Chain":l.isHelp(i)?"Help":"Object":a==="function"?"Function":a}});return r.toTex=void 0,r}var name$44="typeof",factory_1$49=factory$50,_typeof$1={name:name$44,factory:factory_1$49};function factory$51(l,t,e,n){var r=e(Node),i=e(_typeof$1);function a(o,u,c){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!l.isNode(o))throw new TypeError("Parameter condition must be a Node");if(!l.isNode(u))throw new TypeError("Parameter trueExpr must be a Node");if(!l.isNode(c))throw new TypeError("Parameter falseExpr must be a Node");this.condition=o,this.trueExpr=u,this.falseExpr=c}a.prototype=new r,a.prototype.type="ConditionalNode",a.prototype.isConditionalNode=!0,a.prototype._compile=function(o,u){var c=this.condition._compile(o,u),f=this.trueExpr._compile(o,u),p=this.falseExpr._compile(o,u);return function(m,v,h){return s(c(m,v,h))?f(m,v,h):p(m,v,h)}},a.prototype.forEach=function(o){o(this.condition,"condition",this),o(this.trueExpr,"trueExpr",this),o(this.falseExpr,"falseExpr",this)},a.prototype.map=function(o){return new a(this._ifNode(o(this.condition,"condition",this)),this._ifNode(o(this.trueExpr,"trueExpr",this)),this._ifNode(o(this.falseExpr,"falseExpr",this)))},a.prototype.clone=function(){return new a(this.condition,this.trueExpr,this.falseExpr)},a.prototype._toString=function(o){var u=o&&o.parenthesis?o.parenthesis:"keep",c=operators.getPrecedence(this,u),f=this.condition.toString(o),p=operators.getPrecedence(this.condition,u);(u==="all"||this.condition.type==="OperatorNode"||p!==null&&p<=c)&&(f="("+f+")");var d=this.trueExpr.toString(o),m=operators.getPrecedence(this.trueExpr,u);(u==="all"||this.trueExpr.type==="OperatorNode"||m!==null&&m<=c)&&(d="("+d+")");var v=this.falseExpr.toString(o),h=operators.getPrecedence(this.falseExpr,u);return(u==="all"||this.falseExpr.type==="OperatorNode"||h!==null&&h<=c)&&(v="("+v+")"),f+" ? "+d+" : "+v},a.prototype.toJSON=function(){return{mathjs:"ConditionalNode",condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}},a.fromJSON=function(o){return new a(o.condition,o.trueExpr,o.falseExpr)},a.prototype.toHTML=function(o){var u=o&&o.parenthesis?o.parenthesis:"keep",c=operators.getPrecedence(this,u),f=this.condition.toHTML(o),p=operators.getPrecedence(this.condition,u);(u==="all"||this.condition.type==="OperatorNode"||p!==null&&p<=c)&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>');var d=this.trueExpr.toHTML(o),m=operators.getPrecedence(this.trueExpr,u);(u==="all"||this.trueExpr.type==="OperatorNode"||m!==null&&m<=c)&&(d='<span class="math-parenthesis math-round-parenthesis">(</span>'+d+'<span class="math-parenthesis math-round-parenthesis">)</span>');var v=this.falseExpr.toHTML(o),h=operators.getPrecedence(this.falseExpr,u);return(u==="all"||this.falseExpr.type==="OperatorNode"||h!==null&&h<=c)&&(v='<span class="math-parenthesis math-round-parenthesis">(</span>'+v+'<span class="math-parenthesis math-round-parenthesis">)</span>'),f+'<span class="math-operator math-conditional-operator">?</span>'+d+'<span class="math-operator math-conditional-operator">:</span>'+v},a.prototype._toTex=function(o){return"\\begin{cases} {"+this.trueExpr.toTex(o)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(o)+"}\\\\{"+this.falseExpr.toTex(o)+"}, &\\quad{\\text{otherwise}}\\end{cases}"};function s(o){if(typeof o=="number"||typeof o=="boolean"||typeof o=="string")return!!o;if(o){if(l.isBigNumber(o))return!o.isZero();if(l.isComplex(o))return!!(o.re||o.im);if(l.isUnit(o))return!!o.value}if(o==null)return!1;throw new TypeError('Unsupported type of condition "'+i(o)+'"')}return a}var name$45="ConditionalNode",path$20="expression.node",factory_1$50=factory$51,ConditionalNode={name:name$45,path:path$20,factory:factory_1$50},format$3=string.format,escapeLatex=latex.escape;function factory$52(l,t,e,n){var r=e(Node),i=e(_typeof$1);function a(s){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(arguments.length===2)throw new SyntaxError("new ConstantNode(valueStr, valueType) is not supported anymore since math v4.0.0. Use new ConstantNode(value) instead, where value is a non-stringified value.");this.value=s}return a.prototype=new r,a.prototype.type="ConstantNode",a.prototype.isConstantNode=!0,a.prototype._compile=function(s,o){var u=this.value;return function(){return u}},a.prototype.forEach=function(s){},a.prototype.map=function(s){return this.clone()},a.prototype.clone=function(){return new a(this.value)},a.prototype._toString=function(s){return format$3(this.value,s)},a.prototype.toHTML=function(s){var o=this._toString(s);switch(i(this.value)){case"number":case"BigNumber":case"Fraction":return'<span class="math-number">'+o+"</span>";case"string":return'<span class="math-string">'+o+"</span>";case"boolean":return'<span class="math-boolean">'+o+"</span>";case"null":return'<span class="math-null-symbol">'+o+"</span>";case"undefined":return'<span class="math-undefined">'+o+"</span>";default:return'<span class="math-symbol">'+o+"</span>"}},a.prototype.toJSON=function(){return{mathjs:"ConstantNode",value:this.value}},a.fromJSON=function(s){return new a(s.value)},a.prototype._toTex=function(s){var o=this._toString(s);switch(i(this.value)){case"string":return"\\mathtt{"+escapeLatex(o)+"}";case"number":case"BigNumber":var u=o.toLowerCase().indexOf("e");return u!==-1?o.substring(0,u)+"\\cdot10^{"+o.substring(u+1)+"}":o;case"Fraction":return this.value.toLatex();default:return o}},a}var name$46="ConstantNode",path$21="expression.node",factory_1$51=factory$52,ConstantNode={name:name$46,path:path$21,factory:factory_1$51},escape$1=string.escape,forEach$2=array.forEach,join=array.join,setSafeProperty$4=customs.setSafeProperty;function factory$53(l,t,e,n){var r=e(Node);function i(s,o,u){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(typeof s!="string")throw new TypeError('String expected for parameter "name"');if(!Array.isArray(o))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!l.isNode(u))throw new TypeError('Node expected for parameter "expr"');if(s in keywords)throw new Error('Illegal function name, "'+s+'" is a reserved keyword');this.name=s,this.params=o.map(function(c){return c&&c.name||c}),this.types=o.map(function(c){return c&&c.type||"any"}),this.expr=u}i.prototype=new r,i.prototype.type="FunctionAssignmentNode",i.prototype.isFunctionAssignmentNode=!0,i.prototype._compile=function(s,o){var u=Object.create(o);forEach$2(this.params,function(v){u[v]=!0});var c=this.expr._compile(s,u),f=this.name,p=this.params,d=join(this.types,","),m=f+"("+join(this.params,", ")+")";return function(h,y,g){var b={};b[d]=function(){for(var N=Object.create(y),C=0;C<p.length;C++)N[p[C]]=arguments[C];return c(h,N,g)};var x=n(f,b);return x.syntax=m,setSafeProperty$4(h,f,x),x}},i.prototype.forEach=function(s){s(this.expr,"expr",this)},i.prototype.map=function(s){var o=this._ifNode(s(this.expr,"expr",this));return new i(this.name,this.params.slice(0),o)},i.prototype.clone=function(){return new i(this.name,this.params.slice(0),this.expr)};function a(s,o){var u=operators.getPrecedence(s,o),c=operators.getPrecedence(s.expr,o);return o==="all"||c!==null&&c<=u}return i.prototype._toString=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",u=this.expr.toString(s);return a(this,o)&&(u="("+u+")"),this.name+"("+this.params.join(", ")+") = "+u},i.prototype.toJSON=function(){var s=this.types;return{mathjs:"FunctionAssignmentNode",name:this.name,params:this.params.map(function(o,u){return{name:o,type:s[u]}}),expr:this.expr}},i.fromJSON=function(s){return new i(s.name,s.params,s.expr)},i.prototype.toHTML=function(s){for(var o=s&&s.parenthesis?s.parenthesis:"keep",u=[],c=0;c<this.params.length;c++)u.push('<span class="math-symbol math-parameter">'+escape$1(this.params[c])+"</span>");var f=this.expr.toHTML(s);return a(this,o)&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+escape$1(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+u.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+f},i.prototype._toTex=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",u=this.expr.toTex(s);return a(this,o)&&(u="\\left("+u+"\\right)"),"\\mathrm{"+this.name+"}\\left("+this.params.map(latex.toSymbol).join(",")+"\\right):="+u},i}var name$47="FunctionAssignmentNode",path$22="expression.node",factory_1$52=factory$53,FunctionAssignmentNode={name:name$47,path:path$22,factory:factory_1$52},stringify=string.stringify,escape$2=string.escape,isSafeProperty$1=customs.isSafeProperty,hasOwnProperty$2=object.hasOwnProperty;function factory$54(l,t,e,n){var r=e(Node);function i(a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=a||{},a&&(typeof a!="object"||!Object.keys(a).every(function(s){return l.isNode(a[s])})))throw new TypeError("Object containing Nodes expected")}return i.prototype=new r,i.prototype.type="ObjectNode",i.prototype.isObjectNode=!0,i.prototype._compile=function(a,s){var o={};for(var u in this.properties)if(hasOwnProperty$2(this.properties,u)){var c=stringify(u),f=JSON.parse(c);if(!isSafeProperty$1(this.properties,f))throw new Error('No access to property "'+f+'"');o[f]=this.properties[u]._compile(a,s)}return function(d,m,v){var h={};for(var y in o)hasOwnProperty$2(o,y)&&(h[y]=o[y](d,m,v));return h}},i.prototype.forEach=function(a){for(var s in this.properties)this.properties.hasOwnProperty(s)&&a(this.properties[s],"properties["+stringify(s)+"]",this)},i.prototype.map=function(a){var s={};for(var o in this.properties)this.properties.hasOwnProperty(o)&&(s[o]=this._ifNode(a(this.properties[o],"properties["+stringify(o)+"]",this)));return new i(s)},i.prototype.clone=function(){var a={};for(var s in this.properties)this.properties.hasOwnProperty(s)&&(a[s]=this.properties[s]);return new i(a)},i.prototype._toString=function(a){var s=[];for(var o in this.properties)this.properties.hasOwnProperty(o)&&s.push(stringify(o)+": "+this.properties[o].toString(a));return"{"+s.join(", ")+"}"},i.prototype.toJSON=function(){return{mathjs:"ObjectNode",properties:this.properties}},i.fromJSON=function(a){return new i(a.properties)},i.prototype.toHTML=function(a){var s=[];for(var o in this.properties)this.properties.hasOwnProperty(o)&&s.push('<span class="math-symbol math-property">'+escape$2(o)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[o].toHTML(a));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+s.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'},i.prototype._toTex=function(a){var s=[];for(var o in this.properties)this.properties.hasOwnProperty(o)&&s.push("\\mathbf{"+o+":} & "+this.properties[o].toTex(a)+"\\\\");return"\\left\\{\\begin{array}{ll}"+s.join(`
`)+"\\end{array}\\right\\}"},i}var name$48="ObjectNode",path$23="expression.node",factory_1$53=factory$54,ObjectNode={name:name$48,path:path$23,factory:factory_1$53},map$4=array.map,escape$3=string.escape,isSafeMethod$1=customs.isSafeMethod,getSafeProperty$5=customs.getSafeProperty;function factory$55(l,t,e,n){var r=e(Node);function i(s,o,u,c){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(typeof s!="string")throw new TypeError('string expected for parameter "op"');if(typeof o!="string")throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(u)||!u.every(l.isNode))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=c===!0,this.op=s,this.fn=o,this.args=u||[]}i.prototype=new r,i.prototype.type="OperatorNode",i.prototype.isOperatorNode=!0,i.prototype._compile=function(s,o){if(typeof this.fn!="string"||!isSafeMethod$1(s,this.fn))throw s[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var u=getSafeProperty$5(s,this.fn),c=map$4(this.args,function(d){return d._compile(s,o)});if(c.length===1){var f=c[0];return function(m,v,h){return u(f(m,v,h))}}else if(c.length===2){var f=c[0],p=c[1];return function(v,h,y){return u(f(v,h,y),p(v,h,y))}}else return function(m,v,h){return u.apply(null,map$4(c,function(y){return y(m,v,h)}))}},i.prototype.forEach=function(s){for(var o=0;o<this.args.length;o++)s(this.args[o],"args["+o+"]",this)},i.prototype.map=function(s){for(var o=[],u=0;u<this.args.length;u++)o[u]=this._ifNode(s(this.args[u],"args["+u+"]",this));return new i(this.op,this.fn,o,this.implicit)},i.prototype.clone=function(){return new i(this.op,this.fn,this.args.slice(0),this.implicit)},i.prototype.isUnary=function(){return this.args.length===1},i.prototype.isBinary=function(){return this.args.length===2};function a(s,o,u,c,f){var p=operators.getPrecedence(s,o),d=operators.getAssociativity(s,o);if(o==="all"||c.length>2&&s.getIdentifier()!=="OperatorNode:add"&&s.getIdentifier()!=="OperatorNode:multiply"){var m=c.map(function(S){switch(S.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}});return m}var v=void 0;switch(c.length){case 0:v=[];break;case 1:var h=operators.getPrecedence(c[0],o);if(f&&h!==null){var y,g;if(o==="keep"?(y=c[0].getIdentifier(),g=s.getIdentifier()):(y=c[0].getContent().getIdentifier(),g=s.getContent().getIdentifier()),operators.properties[p][g].latexLeftParens===!1){v=[!1];break}if(operators.properties[h][y].latexParens===!1){v=[!1];break}}if(h===null){v=[!1];break}if(h<=p){v=[!0];break}v=[!1];break;case 2:var b,x=operators.getPrecedence(c[0],o),N=operators.isAssociativeWith(s,c[0],o);x===null?b=!1:x===p&&d==="right"&&!N||x<p?b=!0:b=!1;var C,_=operators.getPrecedence(c[1],o),w=operators.isAssociativeWith(s,c[1],o);if(_===null?C=!1:_===p&&d==="left"&&!w||_<p?C=!0:C=!1,f){var g,A,$;o==="keep"?(g=s.getIdentifier(),A=s.args[0].getIdentifier(),$=s.args[1].getIdentifier()):(g=s.getContent().getIdentifier(),A=s.args[0].getContent().getIdentifier(),$=s.args[1].getContent().getIdentifier()),x!==null&&(operators.properties[p][g].latexLeftParens===!1&&(b=!1),operators.properties[x][A].latexParens===!1&&(b=!1)),_!==null&&(operators.properties[p][g].latexRightParens===!1&&(C=!1),operators.properties[_][$].latexParens===!1&&(C=!1))}v=[b,C];break;default:if(s.getIdentifier()==="OperatorNode:add"||s.getIdentifier()==="OperatorNode:multiply")var v=c.map(function(D){var V=operators.getPrecedence(D,o),I=operators.isAssociativeWith(s,D,o),q=operators.getAssociativity(D,o);return V===null?!1:p===V&&d===q&&!I?!0:V<p});break}return c.length>=2&&s.getIdentifier()==="OperatorNode:multiply"&&s.implicit&&o==="auto"&&u==="hide"&&(v=c.map(function(S,D){var V=S.getIdentifier()==="ParenthesisNode";return!!(v[D]||V)})),v}return i.prototype._toString=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",u=s&&s.implicit?s.implicit:"hide",c=this.args,f=a(this,o,u,c,!1);if(c.length===1){var p=operators.getAssociativity(this,o),d=c[0].toString(s);return f[0]&&(d="("+d+")"),p==="right"?this.op+d:p==="left"?d+this.op:d+this.op}else if(c.length==2){var m=c[0].toString(s),v=c[1].toString(s);return f[0]&&(m="("+m+")"),f[1]&&(v="("+v+")"),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&u=="hide"?m+" "+v:m+" "+this.op+" "+v}else if(c.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var h=c.map(function(y,g){return y=y.toString(s),f[g]&&(y="("+y+")"),y});return this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&u==="hide"?h.join(" "):h.join(" "+this.op+" ")}else return this.fn+"("+this.args.join(", ")+")"},i.prototype.toJSON=function(){return{mathjs:"OperatorNode",op:this.op,fn:this.fn,args:this.args,implicit:this.implicit}},i.fromJSON=function(s){return new i(s.op,s.fn,s.args,s.implicit)},i.prototype.toHTML=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",u=s&&s.implicit?s.implicit:"hide",c=this.args,f=a(this,o,u,c,!1);if(c.length===1){var p=operators.getAssociativity(this,o),d=c[0].toHTML(s);return f[0]&&(d='<span class="math-parenthesis math-round-parenthesis">(</span>'+d+'<span class="math-parenthesis math-round-parenthesis">)</span>'),p==="right"?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+escape$3(this.op)+"</span>"+d:p==="left"?'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+escape$3(this.op)+"</span>"+d:'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+escape$3(this.op)+"</span>"+d}else if(c.length==2){var m=c[0].toHTML(s),v=c[1].toHTML(s);return f[0]&&(m='<span class="math-parenthesis math-round-parenthesis">(</span>'+m+'<span class="math-parenthesis math-round-parenthesis">)</span>'),f[1]&&(v='<span class="math-parenthesis math-round-parenthesis">(</span>'+v+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&u=="hide"?m+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+v:m+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+escape$3(this.op)+"</span>"+v}else if(c.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var h=c.map(function(y,g){return y=y.toHTML(s),f[g]&&(y='<span class="math-parenthesis math-round-parenthesis">(</span>'+y+'<span class="math-parenthesis math-round-parenthesis">)</span>'),y});return this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&u==="hide"?h.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):h.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+escape$3(this.op)+"</span>")}else return'<span class="math-function">'+escape$3(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+h.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'},i.prototype._toTex=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",u=s&&s.implicit?s.implicit:"hide",c=this.args,f=a(this,o,u,c,!0),p=latex.operators[this.fn];if(p=typeof p=="undefined"?this.op:p,c.length===1){var d=operators.getAssociativity(this,o),m=c[0].toTex(s);return f[0]&&(m="\\left("+m+"\\right)"),d==="right"?p+m:m+p}else if(c.length===2){var v=c[0],h=v.toTex(s);f[0]&&(h="\\left("+h+"\\right)");var y=c[1],g=y.toTex(s);f[1]&&(g="\\left("+g+"\\right)");var b;switch(o==="keep"?b=v.getIdentifier():b=v.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return p+"{"+h+"}{"+g+"}";case"OperatorNode:pow":switch(h="{"+h+"}",g="{"+g+"}",b){case"ConditionalNode":case"OperatorNode:divide":h="\\left("+h+"\\right)"}case"OperatorNode:multiply":if(this.implicit&&u==="hide")return h+"~"+g}return h+p+g}else if(c.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var x=c.map(function(N,C){return N=N.toTex(s),f[C]&&(N="\\left("+N+"\\right)"),N});return this.getIdentifier()==="OperatorNode:multiply"&&this.implicit?x.join("~"):x.join(p)}else return"\\mathrm{"+this.fn+"}\\left("+c.map(function(N){return N.toTex(s)}).join(",")+"\\right)"},i.prototype.getIdentifier=function(){return this.type+":"+this.fn},i}var name$49="OperatorNode",path$24="expression.node",factory_1$54=factory$55,OperatorNode={name:name$49,path:path$24,factory:factory_1$54};function factory$56(l,t,e,n){var r=e(Node);function i(a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(!l.isNode(a))throw new TypeError('Node expected for parameter "content"');this.content=a}return i.prototype=new r,i.prototype.type="ParenthesisNode",i.prototype.isParenthesisNode=!0,i.prototype._compile=function(a,s){return this.content._compile(a,s)},i.prototype.getContent=function(){return this.content.getContent()},i.prototype.forEach=function(a){a(this.content,"content",this)},i.prototype.map=function(a){var s=a(this.content,"content",this);return new i(s)},i.prototype.clone=function(){return new i(this.content)},i.prototype._toString=function(a){return!a||a&&!a.parenthesis||a&&a.parenthesis==="keep"?"("+this.content.toString(a)+")":this.content.toString(a)},i.prototype.toJSON=function(){return{mathjs:"ParenthesisNode",content:this.content}},i.fromJSON=function(a){return new i(a.content)},i.prototype.toHTML=function(a){return!a||a&&!a.parenthesis||a&&a.parenthesis==="keep"?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(a)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(a)},i.prototype._toTex=function(a){return!a||a&&!a.parenthesis||a&&a.parenthesis==="keep"?"\\left("+this.content.toTex(a)+"\\right)":this.content.toTex(a)},i}var name$50="ParenthesisNode",path$25="expression.node",factory_1$55=factory$56,ParenthesisNode={name:name$50,path:path$25,factory:factory_1$55},escape$4=string.escape,hasOwnProperty$3=object.hasOwnProperty,getSafeProperty$6=customs.getSafeProperty;function factory$57(l,t,e,n,r){var i=e(Node);function a(u){return l.Unit?l.Unit.isValuelessUnit(u):!1}function s(u){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(typeof u!="string")throw new TypeError('String expected for parameter "name"');this.name=u}s.prototype=new i,s.prototype.type="SymbolNode",s.prototype.isSymbolNode=!0,s.prototype._compile=function(u,c){var f=this.name;if(hasOwnProperty$3(c,f))return function(d,m,v){return m[f]};if(f in u)return function(d,m,v){return f in d?getSafeProperty$6(d,f):getSafeProperty$6(u,f)};var p=a(f);return function(d,m,v){return f in d?getSafeProperty$6(d,f):p?new l.Unit(null,f):o(f)}},s.prototype.forEach=function(u){},s.prototype.map=function(u){return this.clone()};function o(u){throw new Error("Undefined symbol "+u)}return s.prototype.clone=function(){return new s(this.name)},s.prototype._toString=function(u){return this.name},s.prototype.toHTML=function(u){var c=escape$4(this.name);return c=="true"||c=="false"?'<span class="math-symbol math-boolean">'+c+"</span>":c=="i"?'<span class="math-symbol math-imaginary-symbol">'+c+"</span>":c=="Infinity"?'<span class="math-symbol math-infinity-symbol">'+c+"</span>":c=="NaN"?'<span class="math-symbol math-nan-symbol">'+c+"</span>":c=="null"?'<span class="math-symbol math-null-symbol">'+c+"</span>":c=="undefined"?'<span class="math-symbol math-undefined-symbol">'+c+"</span>":'<span class="math-symbol">'+c+"</span>"},s.prototype.toJSON=function(){return{mathjs:"SymbolNode",name:this.name}},s.fromJSON=function(u){return new s(u.name)},s.prototype._toTex=function(u){var c=!1;typeof r[this.name]=="undefined"&&a(this.name)&&(c=!0);var f=latex.toSymbol(this.name,c);return f[0]==="\\"?f:" "+f},s}var name$51="SymbolNode",path$26="expression.node",math$7=!0,factory_1$56=factory$57,SymbolNode={name:name$51,path:path$26,math:math$7,factory:factory_1$56},latex$1=latex,escape$5=string.escape,hasOwnProperty$4=object.hasOwnProperty,map$5=array.map,validateSafeMethod$1=customs.validateSafeMethod,getSafeProperty$7=customs.getSafeProperty;function factory$58(l,t,e,n,r){var i=e(Node),a=e(SymbolNode);function s(f,p){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(typeof f=="string"&&(f=new a(f)),!l.isNode(f))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(p)||!p.every(l.isNode))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=f,this.args=p||[],Object.defineProperty(this,"name",{get:function(){return this.fn.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}});var d=function(){throw new Error("Property `FunctionNode.object` is deprecated, use `FunctionNode.fn` instead")};Object.defineProperty(this,"object",{get:d,set:d})}s.prototype=new i,s.prototype.type="FunctionNode",s.prototype.isFunctionNode=!0,s.prototype._compile=function(f,p){if(!(this instanceof s))throw new TypeError("No valid FunctionNode");var d=map$5(this.args,function(_){return _._compile(f,p)});if(l.isSymbolNode(this.fn)){var m=this.fn.name,v=m in f?getSafeProperty$7(f,m):void 0,h=typeof v=="function"&&v.rawArgs==!0;if(h){var y=this.args;return function(w,A,$){return(m in w?getSafeProperty$7(w,m):v)(y,f,w)}}else if(d.length===1){var g=d[0];return function(w,A,$){return(m in w?getSafeProperty$7(w,m):v)(g(w,A,$))}}else if(d.length===2){var g=d[0],b=d[1];return function(A,$,S){return(m in A?getSafeProperty$7(A,m):v)(g(A,$,S),b(A,$,S))}}else return function(w,A,$){return(m in w?getSafeProperty$7(w,m):v).apply(null,map$5(d,function(S){return S(w,A,$)}))}}else if(l.isAccessorNode(this.fn)&&l.isIndexNode(this.fn.index)&&this.fn.index.isObjectProperty()){var x=this.fn.object._compile(f,p),N=this.fn.index.getObjectProperty(),y=this.args;return function(A,$,S){var D=x(A,$,S);validateSafeMethod$1(D,N);var V=D[N]&&D[N].rawArgs;return V?D[N](y,f,A):D[N].apply(D,map$5(d,function(I){return I(A,$,S)}))}}else{var C=this.fn._compile(f,p);return function(w,A,$){var S=C(w,A,$),D=S&&S.rawArgs;return D?S(y,f,w):S.apply(S,map$5(d,function(V){return V(w,A,$)}))}}},s.prototype.forEach=function(f){for(var p=0;p<this.args.length;p++)f(this.args[p],"args["+p+"]",this)},s.prototype.map=function(f){for(var p=this.fn.map(f),d=[],m=0;m<this.args.length;m++)d[m]=this._ifNode(f(this.args[m],"args["+m+"]",this));return new s(p,d)},s.prototype.clone=function(){return new s(this.fn,this.args.slice(0))};var o=s.prototype.toString;s.prototype.toString=function(f){var p,d=this.fn.toString(f);return f&&typeof f.handler=="object"&&hasOwnProperty$4(f.handler,d)&&(p=f.handler[d](this,f)),typeof p!="undefined"?p:o.call(this,f)},s.prototype._toString=function(f){var p=this.args.map(function(m){return m.toString(f)}),d=l.isFunctionAssignmentNode(this.fn)?"("+this.fn.toString(f)+")":this.fn.toString(f);return d+"("+p.join(", ")+")"},s.prototype.toJSON=function(){return{mathjs:"FunctionNode",fn:this.fn,args:this.args}},s.fromJSON=function(f){return new s(f.fn,f.args)},s.prototype.toHTML=function(f){var p=this.args.map(function(d){return d.toHTML(f)});return'<span class="math-function">'+escape$5(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+p.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'};function u(f,p,d){for(var m="",v=new RegExp("\\$(?:\\{([a-z_][a-z_0-9]*)(?:\\[([0-9]+)\\])?\\}|\\$)","ig"),h=0,y;(y=v.exec(f))!==null;)if(m+=f.substring(h,y.index),h=y.index,y[0]==="$$")m+="$",h++;else{h+=y[0].length;var g=p[y[1]];if(!g)throw new ReferenceError("Template: Property "+y[1]+" does not exist.");if(y[2]===void 0)switch(typeof g){case"string":m+=g;break;case"object":if(l.isNode(g))m+=g.toTex(d);else if(Array.isArray(g))m+=g.map(function(b,x){if(l.isNode(b))return b.toTex(d);throw new TypeError("Template: "+y[1]+"["+x+"] is not a Node.")}).join(",");else throw new TypeError("Template: "+y[1]+" has to be a Node, String or array of Nodes");break;default:throw new TypeError("Template: "+y[1]+" has to be a Node, String or array of Nodes")}else if(l.isNode(g[y[2]]&&g[y[2]]))m+=g[y[2]].toTex(d);else throw new TypeError("Template: "+y[1]+"["+y[2]+"] is not a Node.")}return m+=f.slice(h),m}var c=s.prototype.toTex;return s.prototype.toTex=function(f){var p;return f&&typeof f.handler=="object"&&hasOwnProperty$4(f.handler,this.name)&&(p=f.handler[this.name](this,f)),typeof p!="undefined"?p:c.call(this,f)},s.prototype._toTex=function(f){var p=this.args.map(function(v){return v.toTex(f)}),d;r[this.name]&&(typeof r[this.name].toTex=="function"||typeof r[this.name].toTex=="object"||typeof r[this.name].toTex=="string")&&(d=r[this.name].toTex);var m;switch(typeof d){case"function":m=d(this,f);break;case"string":m=u(d,this,f);break;case"object":switch(typeof d[p.length]){case"function":m=d[p.length](this,f);break;case"string":m=u(d[p.length],this,f);break}}return typeof m!="undefined"?m:u(latex$1.defaultTemplate,this,f)},s.prototype.getIdentifier=function(){return this.type+":"+this.name},s}var name$52="FunctionNode",path$27="expression.node",math$8=!0,factory_1$57=factory$58,FunctionNode={name:name$52,path:path$27,math:math$8,factory:factory_1$57};function factory$59(l,t,e,n){var r=e(Node);function i(s,o,u){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(!l.isNode(s))throw new TypeError("Node expected");if(!l.isNode(o))throw new TypeError("Node expected");if(u&&!l.isNode(u))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=s,this.end=o,this.step=u||null}i.prototype=new r,i.prototype.type="RangeNode",i.prototype.isRangeNode=!0,i.prototype.needsEnd=function(){var s=this.filter(function(o){return l.isSymbolNode(o)&&o.name==="end"});return s.length>0},i.prototype._compile=function(s,o){var u=s.range,c=this.start._compile(s,o),f=this.end._compile(s,o);if(this.step){var p=this.step._compile(s,o);return function(m,v,h){return u(c(m,v,h),f(m,v,h),p(m,v,h))}}else return function(m,v,h){return u(c(m,v,h),f(m,v,h))}},i.prototype.forEach=function(s){s(this.start,"start",this),s(this.end,"end",this),this.step&&s(this.step,"step",this)},i.prototype.map=function(s){return new i(this._ifNode(s(this.start,"start",this)),this._ifNode(s(this.end,"end",this)),this.step&&this._ifNode(s(this.step,"step",this)))},i.prototype.clone=function(){return new i(this.start,this.end,this.step&&this.step)};function a(s,o){var u=operators.getPrecedence(s,o),c={},f=operators.getPrecedence(s.start,o);if(c.start=f!==null&&f<=u||o==="all",s.step){var p=operators.getPrecedence(s.step,o);c.step=p!==null&&p<=u||o==="all"}var d=operators.getPrecedence(s.end,o);return c.end=d!==null&&d<=u||o==="all",c}return i.prototype._toString=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",u=a(this,o),c,f=this.start.toString(s);if(u.start&&(f="("+f+")"),c=f,this.step){var p=this.step.toString(s);u.step&&(p="("+p+")"),c+=":"+p}var d=this.end.toString(s);return u.end&&(d="("+d+")"),c+=":"+d,c},i.prototype.toJSON=function(){return{mathjs:"RangeNode",start:this.start,end:this.end,step:this.step}},i.fromJSON=function(s){return new i(s.start,s.end,s.step)},i.prototype.toHTML=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",u=a(this,o),c,f=this.start.toHTML(s);if(u.start&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>'),c=f,this.step){var p=this.step.toHTML(s);u.step&&(p='<span class="math-parenthesis math-round-parenthesis">(</span>'+p+'<span class="math-parenthesis math-round-parenthesis">)</span>'),c+='<span class="math-operator math-range-operator">:</span>'+p}var d=this.end.toHTML(s);return u.end&&(d='<span class="math-parenthesis math-round-parenthesis">(</span>'+d+'<span class="math-parenthesis math-round-parenthesis">)</span>'),c+='<span class="math-operator math-range-operator">:</span>'+d,c},i.prototype._toTex=function(s){var o=s&&s.parenthesis?s.parenthesis:"keep",u=a(this,o),c=this.start.toTex(s);if(u.start&&(c="\\left("+c+"\\right)"),this.step){var f=this.step.toTex(s);u.step&&(f="\\left("+f+"\\right)"),c+=":"+f}var p=this.end.toTex(s);return u.end&&(p="\\left("+p+"\\right)"),c+=":"+p,c},i}var name$53="RangeNode",path$28="expression.node",factory_1$58=factory$59,RangeNode={name:name$53,path:path$28,factory:factory_1$58};function factory$60(l,t,e,n){var r=e(numeric),i=e(AccessorNode),a=e(ArrayNode),s=e(AssignmentNode),o=e(BlockNode),u=e(ConditionalNode),c=e(ConstantNode),f=e(FunctionAssignmentNode),p=e(IndexNode),d=e(ObjectNode),m=e(OperatorNode),v=e(ParenthesisNode),h=e(FunctionNode),y=e(RangeNode),g=e(SymbolNode);function b(ae,ge){if(arguments.length!==1&&arguments.length!==2)throw new ArgumentsError_1("parse",arguments.length,1,2);if(A=ge&&ge.nodes?ge.nodes:{},typeof ae=="string")return $=ae,J();if(Array.isArray(ae)||ae instanceof l.Matrix)return deepMap(ae,function(we){if(typeof we!="string")throw new TypeError("String expected");return $=we,J()});throw new TypeError("String or matrix expected")}var x={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},N={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"'":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},C={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},_={true:!0,false:!1,null:null,undefined:void 0},w=["NaN","Infinity"],A={},$="",S="",D=0,V="",I="",q=x.NULL,K=0,E=null,W=[];function G(){D=0,V=$.charAt(0),K=0,E=null}function P(){D++,V=$.charAt(D)}function Q(){return $.charAt(D-1)}function ne(){return $.charAt(D+1)}function Y(){return $.charAt(D+2)}function se(){W.push({token_type:q,token:I,comment:S,index:D,c:V})}function pe(){var ae=W.pop();q=ae.token_type,I=ae.token,S=ae.comment,D=ae.index,V=ae.c}function oe(){W.pop()}function ve(){for(q=x.NULL,I="",S="";b.isWhitespace(V,K);)P();if(V==="#")for(;V!==`
`&&V!=="";)S+=V,P();if(V===""){q=x.DELIMITER;return}if(V===`
`&&!K){q=x.DELIMITER,I=V,P();return}var ae=V+ne(),ge=ae+Y();if(ge.length===3&&N[ge]){q=x.DELIMITER,I=ge,P(),P(),P();return}if(ae.length===2&&N[ae]){q=x.DELIMITER,I=ae,P(),P();return}if(N[V]){q=x.DELIMITER,I=V,P();return}if(b.isDigitDot(V)){if(q=x.NUMBER,V===".")I+=V,P(),b.isDigit(V)||(q=x.DELIMITER);else{for(;b.isDigit(V);)I+=V,P();b.isDecimalMark(V,ne())&&(I+=V,P())}for(;b.isDigit(V);)I+=V,P();if(ae=ne(),V==="E"||V==="e"){if(b.isDigit(ae)||ae==="-"||ae==="+"){if(I+=V,P(),(V==="+"||V==="-")&&(I+=V,P()),!b.isDigit(V))throw Xe('Digit expected, got "'+V+'"');for(;b.isDigit(V);)I+=V,P();if(b.isDecimalMark(V,ne()))throw Xe('Digit expected, got "'+V+'"')}else if(ae===".")throw P(),Xe('Digit expected, got "'+V+'"')}return}if(b.isAlpha(V,Q(),ne())){for(;b.isAlpha(V,Q(),ne())||b.isDigit(V);)I+=V,P();C.hasOwnProperty(I)?q=x.DELIMITER:q=x.SYMBOL;return}for(q=x.UNKNOWN;V!=="";)I+=V,P();throw Xe('Syntax error in part "'+I+'"')}function O(){do ve();while(I===`
`)}function z(){K++}function Z(){K--}b.isAlpha=function(ge,we,Re){return b.isValidLatinOrGreek(ge)||b.isValidMathSymbol(ge,Re)||b.isValidMathSymbol(we,ge)},b.isValidLatinOrGreek=function(ge){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(ge)},b.isValidMathSymbol=function(ge,we){return/^[\uD835]$/.test(ge)&&/^[\uDC00-\uDFFF]$/.test(we)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(we)},b.isWhitespace=function(ge,we){return ge===" "||ge==="	"||ge===`
`&&we>0},b.isDecimalMark=function(ge,we){return ge==="."&&we!=="/"&&we!=="*"&&we!=="^"},b.isDigitDot=function(ge){return ge>="0"&&ge<="9"||ge==="."},b.isDigit=function(ge){return ge>="0"&&ge<="9"};function J(){G(),ve();var ae=R();if(I!=="")throw q===x.DELIMITER?an("Unexpected operator "+I):Xe('Unexpected part "'+I+'"');return ae}function R(){var ae,ge=[],we;for(I!==""&&I!==`
`&&I!==";"&&(ae=F(),ae.comment=S);I===`
`||I===";";)ge.length===0&&ae&&(we=I!==";",ge.push({node:ae,visible:we})),ve(),I!==`
`&&I!==";"&&I!==""&&(ae=F(),ae.comment=S,we=I!==";",ge.push({node:ae,visible:we}));return ge.length>0?new o(ge):(ae||(ae=new c(void 0),ae.comment=S),ae)}function F(){var ae,ge,we,Re,Fe=X();if(I==="="){if(l.isSymbolNode(Fe))return ae=Fe.name,O(),we=F(),new s(new g(ae),we);if(l.isAccessorNode(Fe))return O(),we=F(),new s(Fe.object,Fe.index,we);if(l.isFunctionNode(Fe)&&l.isSymbolNode(Fe.fn)&&(Re=!0,ge=[],ae=Fe.name,Fe.args.forEach(function(jt,qn){l.isSymbolNode(jt)?ge[qn]=jt.name:Re=!1}),Re))return O(),we=F(),new f(ae,ge,we);throw Xe("Invalid left hand side of assignment operator =")}return Fe}function X(){for(var ae=te();I==="?";){var ge=E;E=K,O();var we=ae,Re=F();if(I!==":")throw Xe("False part of conditional expression expected");E=null,O();var Fe=F();ae=new u(we,Re,Fe),E=ge}return ae}function te(){for(var ae=de();I==="or";)O(),ae=new m("or","or",[ae,de()]);return ae}function de(){for(var ae=he();I==="xor";)O(),ae=new m("xor","xor",[ae,he()]);return ae}function he(){for(var ae=H();I==="and";)O(),ae=new m("and","and",[ae,H()]);return ae}function H(){for(var ae=re();I==="|";)O(),ae=new m("|","bitOr",[ae,re()]);return ae}function re(){for(var ae=ce();I==="^|";)O(),ae=new m("^|","bitXor",[ae,ce()]);return ae}function ce(){for(var ae=ue();I==="&";)O(),ae=new m("&","bitAnd",[ae,ue()]);return ae}function ue(){var ae,ge,we,Re,Fe;for(ae=Ce(),ge={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};ge.hasOwnProperty(I);)we=I,Re=ge[we],O(),Fe=[ae,Ce()],ae=new m(we,Re,Fe);return ae}function Ce(){var ae,ge,we,Re,Fe;for(ae=Ne(),ge={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};ge.hasOwnProperty(I);)we=I,Re=ge[we],O(),Fe=[ae,Ne()],ae=new m(we,Re,Fe);return ae}function Ne(){var ae,ge,we,Re,Fe;for(ae=Te(),ge={to:"to",in:"to"};ge.hasOwnProperty(I);)we=I,Re=ge[we],O(),we==="in"&&I===""?ae=new m("*","multiply",[ae,new g("in")],!0):(Fe=[ae,Te()],ae=new m(we,Re,Fe));return ae}function Te(){var ae,ge=[];if(I===":"?ae=new c(1):ae=$e(),I===":"&&E!==K){for(ge.push(ae);I===":"&&ge.length<3;)O(),I===")"||I==="]"||I===","||I===""?ge.push(new g("end")):ge.push($e());ge.length===3?ae=new y(ge[0],ge[2],ge[1]):ae=new y(ge[0],ge[1])}return ae}function $e(){var ae,ge,we,Re,Fe;for(ae=Ae(),ge={"+":"add","-":"subtract"};ge.hasOwnProperty(I);)we=I,Re=ge[we],O(),Fe=[ae,Ae()],ae=new m(we,Re,Fe);return ae}function Ae(){var ae,ge,we,Re,Fe;for(ae=Ve(),ge=ae,we={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};we.hasOwnProperty(I);)Re=I,Fe=we[Re],O(),ge=Ve(),ae=new m(Re,Fe,[ae,ge]);return ae}function Ve(){var ae,ge;for(ae=Qe(),ge=ae;q===x.SYMBOL||I==="in"&&l.isConstantNode(ae)||q===x.NUMBER&&!l.isConstantNode(ge)&&(!l.isOperatorNode(ge)||ge.op==="!")||I==="(";)ge=Qe(),ae=new m("*","multiply",[ae,ge],!0);return ae}function Qe(){var ae,ge;for(ae=Je(),ge=ae;I==="/"&&l.isConstantNode(ge);)if(se(),O(),q===x.NUMBER)if(se(),O(),q===x.SYMBOL||I==="(")pe(),oe(),ge=Je(),ae=new m("/","divide",[ae,ge]);else{pe(),pe();break}else{pe();break}return ae}function Je(){var ae,ge,we,Re={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return Re.hasOwnProperty(I)?(we=Re[I],ae=I,O(),ge=[Je()],new m(ae,we,ge)):at()}function at(){var ae,ge,we,Re;return ae=Mt(),(I==="^"||I===".^")&&(ge=I,we=ge==="^"?"pow":"dotPow",O(),Re=[ae,Je()],ae=new m(ge,we,Re)),ae}function Mt(){var ae,ge,we,Re,Fe;for(ae=cr(),ge={"!":"factorial","'":"transpose"};ge.hasOwnProperty(I);)we=I,Re=ge[we],ve(),Fe=[ae],ae=new m(we,Re,Fe),ae=Yt(ae);return ae}function cr(){var ae=[];if(q===x.SYMBOL&&A.hasOwnProperty(I)){var ge=A[I];if(ve(),I==="("){if(ae=[],z(),ve(),I!==")")for(ae.push(F());I===",";)ve(),ae.push(F());if(I!==")")throw Xe("Parenthesis ) expected");Z(),ve()}return new ge(ae)}return en()}function en(){var ae,ge;return q===x.SYMBOL||q===x.DELIMITER&&I in C?(ge=I,ve(),_.hasOwnProperty(ge)?ae=new c(_[ge]):w.indexOf(ge)!==-1?ae=new c(r(ge)):ae=new g(ge),ae=Yt(ae),ae):Rn()}function Yt(ae,ge){for(var we;(I==="("||I==="["||I===".")&&(!ge||ge.indexOf(I)!==-1);)if(we=[],I==="(")if(l.isSymbolNode(ae)||l.isAccessorNode(ae)){if(z(),ve(),I!==")")for(we.push(F());I===",";)ve(),we.push(F());if(I!==")")throw Xe("Parenthesis ) expected");Z(),ve(),ae=new h(ae,we)}else return ae;else if(I==="["){if(z(),ve(),I!=="]")for(we.push(F());I===",";)ve(),we.push(F());if(I!=="]")throw Xe("Parenthesis ] expected");Z(),ve(),ae=new i(ae,new p(we))}else{if(ve(),q!==x.SYMBOL)throw Xe("Property name expected after dot");we.push(new c(I)),ve();var Re=!0;ae=new i(ae,new p(we,Re))}return ae}function Rn(){var ae,ge;return I==='"'?(ge=tn(),ae=new c(ge),ae=Yt(ae),ae):kn()}function tn(){for(var ae="";V!==""&&V!=='"';)V==="\\"&&(ae+=V,P()),ae+=V,P();if(ve(),I!=='"')throw Xe('End of string " expected');return ve(),JSON.parse('"'+ae+'"')}function kn(){var ae,ge,we,Re;if(I==="["){if(z(),ve(),I!=="]"){var Fe=rn();if(I===";"){for(we=1,ge=[Fe];I===";";)ve(),ge[we]=rn(),we++;if(I!=="]")throw Xe("End of matrix ] expected");Z(),ve(),Re=ge[0].items.length;for(var jt=1;jt<we;jt++)if(ge[jt].items.length!==Re)throw an("Column dimensions mismatch ("+ge[jt].items.length+" !== "+Re+")");ae=new a(ge)}else{if(I!=="]")throw Xe("End of matrix ] expected");Z(),ve(),ae=Fe}}else Z(),ve(),ae=new a([]);return Yt(ae)}return Fn()}function rn(){for(var ae=[F()],ge=1;I===",";)ve(),ae[ge]=F(),ge++;return new a(ae)}function Fn(){if(I==="{"){var ae,ge={};do if(ve(),I!=="}"){if(I==='"')ae=tn();else if(q===x.SYMBOL)ae=I,ve();else throw Xe("Symbol or string expected as object key");if(I!==":")throw Xe("Colon : expected after object key");ve(),ge[ae]=F()}while(I===",");if(I!=="}")throw Xe("Comma , or bracket } expected after object value");ve();var we=new d(ge);return we=Yt(we),we}return Bn()}function Bn(){var ae;return q===x.NUMBER?(ae=I,ve(),new c(r(ae,t.number))):zn()}function zn(){var ae;if(I==="("){if(z(),ve(),ae=F(),I!==")")throw Xe("Parenthesis ) expected");return Z(),ve(),ae=new v(ae),ae=Yt(ae),ae}return qt()}function qt(){throw Xe(I===""?"Unexpected end of expression":I==="'"?"Value expected. Note: strings must be enclosed by double quotes":"Value expected")}function nn(){return D-I.length+1}function Xe(ae){var ge=nn(),we=new SyntaxError(ae+" (char "+ge+")");return we.char=ge,we}function an(ae){var ge=nn(),we=new SyntaxError(ae+" (char "+ge+")");return we.char=ge,we}return b}var name$54="parse",path$29="expression",factory_1$59=factory$60,parse={name:name$54,path:path$29,factory:factory_1$59};function factory$61(l,t,e,n){var r=e(parse);return n("compile",{string:function(i){return r(i).compile()},"Array | Matrix":function(i){return deepMap(i,function(a){return r(a).compile()})}})}var name$55="compile",factory_1$60=factory$61,compile={name:name$55,factory:factory_1$60};function factory$62(l,t,e,n){var r=e(parse);return n("compile",{string:function(i){var a={};return r(i).compile().eval(a)},"string, Object":function(i,a){return r(i).compile().eval(a)},"Array | Matrix":function(i){var a={};return deepMap(i,function(s){return r(s).compile().eval(a)})},"Array | Matrix, Object":function(i,a){return deepMap(i,function(s){return r(s).compile().eval(a)})}})}var name$56="eval",factory_1$61=factory$62,_eval$1={name:name$56,factory:factory_1$61},getSafeProperty$8=customs.getSafeProperty;function factory$63(l,t,e,n,r){var i=e(embeddedDocs);return n("help",{any:function(a){var s,o=a;if(typeof a!="string"){for(s in r)if(r.hasOwnProperty(s)&&a===r[s]){o=s;break}}var u=getSafeProperty$8(i,o);if(!u)throw new Error('No documentation found on "'+o+'"');return new l.Help(u)}})}var math$9=!0,name$57="help",factory_1$62=factory$63,help$1={math:math$9,name:name$57,factory:factory_1$62};function factory$64(l,t,e,n){var r=e(parse);return n("parse",{"string | Array | Matrix":r,"string | Array | Matrix, Object":r})}var name$58="parse",factory_1$63=factory$64,parse$1={name:name$58,factory:factory_1$63},extend$1=object.extend;function factory$65(l,t,e,n,r){var i=e(parse);function a(){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this.scope={}}return a.prototype.type="Parser",a.prototype.isParser=!0,a.prototype.parse=function(s){throw new Error("Parser.parse is deprecated. Use math.parse instead.")},a.prototype.compile=function(s){throw new Error("Parser.compile is deprecated. Use math.compile instead.")},a.prototype.eval=function(s){return i(s).compile().eval(this.scope)},a.prototype.get=function(s){return s in this.scope?customs.getSafeProperty(this.scope,s):void 0},a.prototype.getAll=function(){return extend$1({},this.scope)},a.prototype.set=function(s,o){return customs.setSafeProperty(this.scope,s,o)},a.prototype.remove=function(s){delete this.scope[s]},a.prototype.clear=function(){for(var s in this.scope)this.scope.hasOwnProperty(s)&&delete this.scope[s]},a}var name$59="Parser",path$30="expression",factory_1$64=factory$65,math$10=!0,Parser={name:name$59,path:path$30,factory:factory_1$64,math:math$10};function factory$66(l,t,e,n,r){var i=e(Parser);return n("parser",{"":function(){return new i(r)}})}var name$60="parser",factory_1$65=factory$66,math$11=!0,parser={name:name$60,factory:factory_1$65,math:math$11},_function$2=[compile,_eval$1,help$1,parse$1,parser];function factory$67(l,t,e,n){function r(){throw new Error("UpdateNode is deprecated. Use AssignmentNode instead.")}return r}var name$61="UpdateNode",path$31="expression.node",factory_1$66=factory$67,UpdateNode={name:name$61,path:path$31,factory:factory_1$66},node=[AccessorNode,ArrayNode,AssignmentNode,BlockNode,ConditionalNode,ConstantNode,IndexNode,FunctionAssignmentNode,FunctionNode,Node,ObjectNode,OperatorNode,ParenthesisNode,RangeNode,SymbolNode,UpdateNode],clone$4=object.clone,isInteger$4=number.isInteger;function factory$68(l,t,e,n){var r=e(matrix),i=n("concat",{"...Array | Matrix | number | BigNumber":function(a){var s,o=a.length,u=-1,c,f=!1,p=[];for(s=0;s<o;s++){var d=a[s];if(l.isMatrix(d)&&(f=!0),l.isNumber(d)||l.isBigNumber(d)){if(s!==o-1)throw new Error("Dimension must be specified as last argument");if(c=u,u=d.valueOf(),!isInteger$4(u))throw new TypeError("Integer number expected for dimension");if(u<0||s>0&&u>c)throw new IndexError_1(u,c+1)}else{var m=clone$4(d).valueOf(),v=array.size(m);if(p[s]=m,c=u,u=v.length-1,s>0&&u!=c)throw new DimensionError_1(c+1,u+1)}}if(p.length==0)throw new SyntaxError("At least one matrix expected");for(var h=p.shift();p.length;)h=_concat(h,p.shift(),u,0);return f?r(h):h},"...string":function(a){return a.join("")}});return i.toTex=void 0,i}function _concat(l,t,e,n){if(n<e){if(l.length!=t.length)throw new DimensionError_1(l.length,t.length);for(var r=[],i=0;i<l.length;i++)r[i]=_concat(l[i],t[i],e,n+1);return r}else return l.concat(t)}var name$62="concat",factory_1$67=factory$68,concat$1={name:name$62,factory:factory_1$67},errorTransform$2=error_transform.transform;function factory$69(l,t,e,n){var r=e(concat$1);return n("concat",{"...any":function(i){var a=i.length-1,s=i[a];l.isNumber(s)?i[a]=s-1:l.isBigNumber(s)&&(i[a]=s.minus(1));try{return r.apply(null,i)}catch(o){throw errorTransform$2(o)}}})}var name$63="concat",path$32="expression.transform",factory_1$68=factory$69,concat_transform={name:name$63,path:path$32,factory:factory_1$68};function factory$70(l,t,e,n){return function(i,a,s){var o=i.filter(function(p){return l.isSymbolNode(p)&&!(p.name in a)&&!(p.name in s)})[0];if(!o)throw new Error('No undefined variable found in inline expression "'+i+'"');var u=o.name,c=Object.create(s),f=i.compile();return function(d){return c[u]=d,f.eval(c)}}}var factory_1$69=factory$70,compileInlineExpression={factory:factory_1$69},filter$1=array.filter,filterRegExp=array.filterRegExp,maxArgumentCount$1=_function.maxArgumentCount;function factory$71(l,t,e,n){var r=e(compileInlineExpression),i=e(matrix);function a(o,u,c){var f,p;return o[0]&&(f=o[0].compile().eval(c)),o[1]&&(l.isSymbolNode(o[1])||l.isFunctionAssignmentNode(o[1])?p=o[1].compile().eval(c):p=r(o[1],u,c)),s(f,p)}a.rawArgs=!0;var s=n("filter",{"Array, function":_filter,"Matrix, function":function(o,u){return i(_filter(o.toArray(),u))},"Array, RegExp":filterRegExp,"Matrix, RegExp":function(o,u){return i(filterRegExp(o.toArray(),u))}});return s.toTex=void 0,a}function _filter(l,t){var e=maxArgumentCount$1(t);return filter$1(l,function(n,r,i){return e===1?t(n):e===2?t(n,[r+1]):t(n,[r+1],i)})}var name$64="filter",path$33="expression.transform",factory_1$70=factory$71,filter_transform={name:name$64,path:path$33,factory:factory_1$70},maxArgumentCount$2=_function.maxArgumentCount,forEach$3=array.forEach;function factory$72(l,t,e,n){var r=e(compileInlineExpression);function i(s,o,u){var c,f;return s[0]&&(c=s[0].compile().eval(u)),s[1]&&(l.isSymbolNode(s[1])||l.isFunctionAssignmentNode(s[1])?f=s[1].compile().eval(u):f=r(s[1],o,u)),a(c,f)}i.rawArgs=!0;var a=n("forEach",{"Array | Matrix, function":function(s,o){var u=maxArgumentCount$2(o),c=function(f,p){Array.isArray(f)?forEach$3(f,function(d,m){c(d,p.concat(m+1))}):u===1?o(f):u===2?o(f,p):o(f,p,s)};c(s.valueOf(),[])}});return i}var name$65="forEach",path$34="expression.transform",factory_1$71=factory$72,forEach_transform={name:name$65,path:path$34,factory:factory_1$71};function factory$73(l,t,e){return function(){for(var r=[],i=0,a=arguments.length;i<a;i++){var s=arguments[i];if(l.isRange(s))s.start--,s.end-=s.step>0?0:2;else if(s&&s.isSet===!0)s=s.map(function(u){return u-1});else if(l.isArray(s)||l.isMatrix(s))s=s.map(function(u){return u-1});else if(l.isNumber(s))s--;else if(l.isBigNumber(s))s=s.toNumber()-1;else if(typeof s!="string")throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");r[i]=s}var o=new l.Index;return l.Index.apply(o,r),o}}var name$66="index",path$35="expression.transform",factory_1$72=factory$73,index_transform={name:name$66,path:path$35,factory:factory_1$72},maxArgumentCount$3=_function.maxArgumentCount,map$6=array.map;function factory$74(l,t,e,n){var r=e(compileInlineExpression),i=e(matrix);function a(o,u,c){var f,p;return o[0]&&(f=o[0].compile().eval(c)),o[1]&&(l.isSymbolNode(o[1])||l.isFunctionAssignmentNode(o[1])?p=o[1].compile().eval(c):p=r(o[1],u,c)),s(f,p)}a.rawArgs=!0;var s=n("map",{"Array, function":function(o,u){return _map(o,u,o)},"Matrix, function":function(o,u){return i(_map(o.valueOf(),u,o))}});return a}function _map(l,t,e){var n=maxArgumentCount$3(t);function r(i,a){return Array.isArray(i)?map$6(i,function(s,o){return r(s,a.concat(o+1))}):n===1?t(i):n===2?t(i,a):t(i,a,e)}return r(l,[])}var name$67="map",path$36="expression.transform",factory_1$73=factory$74,map_transform={name:name$67,path:path$36,factory:factory_1$73},isCollection=function(t){return Array.isArray(t)||isMatrix(t)},deepForEach=function l(t,e){isMatrix(t)&&(t=t.valueOf());for(var n=0,r=t.length;n<r;n++){var i=t[n];Array.isArray(i)?l(i,e):e(i)}},arraySize=array.size,reduce=function(l,t,e){var n=Array.isArray(l)?arraySize(l):l.size();if(t<0||t>=n.length)throw new IndexError_1(t,n.length);return isMatrix(l)?l.create(_reduce(l.valueOf(),t,e)):_reduce(l,t,e)};function _reduce(l,t,e){var n,r,i,a;if(t<=0)if(Array.isArray(l[0])){for(a=_switch(l),r=[],n=0;n<a.length;n++)r[n]=_reduce(a[n],t-1,e);return r}else{for(i=l[0],n=1;n<l.length;n++)i=e(i,l[n]);return i}else{for(r=[],n=0;n<l.length;n++)r[n]=_reduce(l[n],t-1,e);return r}}function _switch(l){var t=l.length,e=l[0].length,n,r,i=[];for(r=0;r<e;r++){var a=[];for(n=0;n<t;n++)a.push(l[n][r]);i.push(a)}return i}var containsCollections=function(t){for(var e=0;e<t.length;e++)if(isCollection(t[e]))return!0;return!1};function factory$75(l,t,e,n){var r=e(_typeof$1);return function(a,s,o){var u;return String(a).indexOf("Unexpected type")!==-1?(u=arguments.length>2?" (type: "+r(o)+", value: "+JSON.stringify(o)+")":" (type: "+a.data.actual+")",new TypeError("Cannot calculate "+s+", unexpected type of argument"+u)):String(a).indexOf("complex numbers")!==-1?(u=arguments.length>2?" (type: "+r(o)+", value: "+JSON.stringify(o)+")":"",new TypeError("Cannot calculate "+s+", no ordering relation is defined for complex numbers"+u)):a}}var factory_1$74=factory$75,improveErrorMessage={factory:factory_1$74};function factory$76(l,t,e,n){var r=e(larger),i=e(improveErrorMessage),a=n("max",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(u,c){return reduce(u,c.valueOf(),s)},"...":function(u){if(containsCollections(u))throw new TypeError("Scalar values expected in function max");return o(u)}});return a.toTex="\\max\\left(${args}\\right)",a;function s(u,c){try{return r(u,c)?u:c}catch(f){throw i(f,"max",c)}}function o(u){var c=void 0;if(deepForEach(u,function(f){try{(c===void 0||r(f,c))&&(c=f)}catch(p){throw i(p,"max",f)}}),c===void 0)throw new Error("Cannot calculate max of an empty array");return c}}var name$68="max",factory_1$75=factory$76,max$1={name:name$68,factory:factory_1$75},errorTransform$3=error_transform.transform;function factory$77(l,t,e,n){var r=e(max$1);return n("max",{"...any":function(i){if(i.length==2&&isCollection(i[0])){var a=i[1];l.isNumber(a)?i[1]=a-1:l.isBigNumber(a)&&(i[1]=a.minus(1))}try{return r.apply(null,i)}catch(s){throw errorTransform$3(s)}}})}var name$69="max",path$37="expression.transform",factory_1$76=factory$77,max_transform={name:name$69,path:path$37,factory:factory_1$76};function factory$78(l,t,e,n){var r=n("multiplyScalar",{"number, number":function(i,a){return i*a},"Complex, Complex":function(i,a){return i.mul(a)},"BigNumber, BigNumber":function(i,a){return i.times(a)},"Fraction, Fraction":function(i,a){return i.mul(a)},"number | Fraction | BigNumber | Complex, Unit":function(i,a){var s=a.clone();return s.value=s.value===null?s._normalize(i):r(s.value,i),s},"Unit, number | Fraction | BigNumber | Complex":function(i,a){var s=i.clone();return s.value=s.value===null?s._normalize(a):r(s.value,a),s},"Unit, Unit":function(i,a){return i.multiply(a)}});return r}var factory_1$77=factory$78,multiplyScalar={factory:factory_1$77};function factory$79(l,t,e,n){var r=e(multiplyScalar),i=n("divide",{"number, number":function(a,s){return a/s},"Complex, Complex":function(a,s){return a.div(s)},"BigNumber, BigNumber":function(a,s){return a.div(s)},"Fraction, Fraction":function(a,s){return a.div(s)},"Unit, number | Fraction | BigNumber":function(a,s){var o=a.clone();return o.value=i(o.value===null?o._normalize(1):o.value,s),o},"number | Fraction | BigNumber, Unit":function(a,s){var o=s.pow(-1);return o.value=r(o.value===null?o._normalize(1):o.value,a),o},"Unit, Unit":function(a,s){return a.divide(s)}});return i}var factory_1$78=factory$79,divideScalar={factory:factory_1$78};function factory$80(l,t,e,n){var r=e(equalScalar),i=l.SparseMatrix,a=function(s,o,u,c){var f=s._values,p=s._index,d=s._ptr,m=s._size,v=s._datatype;if(!f)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h=m[0],y=m[1],g,b=r,x=0,N=u;typeof v=="string"&&(g=v,b=n.find(r,[g,g]),x=n.convert(0,g),o=n.convert(o,g),N=n.find(u,[g,g]));for(var C=[],_=[],w=[],A=new i({values:C,index:_,ptr:w,size:[h,y],datatype:g}),$=0;$<y;$++){w[$]=_.length;for(var S=d[$],D=d[$+1],V=S;V<D;V++){var I=p[V],q=c?N(o,f[V]):N(f[V],o);b(q,x)||(_.push(I),C.push(q))}}return w[y]=_.length,A};return a}var name$70="algorithm11",factory_1$79=factory$80,algorithm11={name:name$70,factory:factory_1$79},extend$2=object.extend;function factory$81(l,t,e,n){var r=latex,i=e(matrix),a=e(addScalar),s=e(multiplyScalar),o=e(equalScalar),u=e(algorithm11),c=e(algorithm14),f=l.DenseMatrix,p=l.SparseMatrix,d=n("multiply",extend$2({"Array, Array":function($,S){m(array.size($),array.size(S));var D=d(i($),i(S));return l.isMatrix(D)?D.valueOf():D},"Matrix, Matrix":function($,S){var D=$.size(),V=S.size();return m(D,V),D.length===1?V.length===1?v($,S,D[0]):h($,S):V.length===1?g($,S):b($,S)},"Matrix, Array":function($,S){return d($,i(S))},"Array, Matrix":function($,S){return d(i($,S.storage()),S)},"SparseMatrix, any":function($,S){return u($,S,s,!1)},"DenseMatrix, any":function($,S){return c($,S,s,!1)},"any, SparseMatrix":function($,S){return u(S,$,s,!0)},"any, DenseMatrix":function($,S){return c(S,$,s,!0)},"Array, any":function($,S){return c(i($),S,s,!1).valueOf()},"any, Array":function($,S){return c(i(S),$,s,!0).valueOf()},"any, any":s,"any, any, ...any":function($,S,D){for(var V=d($,S),I=0;I<D.length;I++)V=d(V,D[I]);return V}},s.signatures)),m=function($,S){switch($.length){case 1:switch(S.length){case 1:if($[0]!==S[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if($[0]!==S[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+$[0]+") must match Matrix rows ("+S[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+S.length+" dimensions)")}break;case 2:switch(S.length){case 1:if($[1]!==S[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+$[1]+") must match Vector length ("+S[0]+")");break;case 2:if($[1]!==S[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+$[1]+") must match Matrix B rows ("+S[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+S.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+$.length+" dimensions)")}},v=function($,S,D){if(D===0)throw new Error("Cannot multiply two empty vectors");var V=$._data,I=$._datatype,q=S._data,K=S._datatype,E,W=a,G=s;I&&K&&I===K&&typeof I=="string"&&(E=I,W=n.find(a,[E,E]),G=n.find(s,[E,E]));for(var P=G(V[0],q[0]),Q=1;Q<D;Q++)P=W(P,G(V[Q],q[Q]));return P},h=function($,S){if(S.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return y($,S)},y=function($,S){var D=$._data,V=$._size,I=$._datatype,q=S._data,K=S._size,E=S._datatype,W=V[0],G=K[1],P,Q=a,ne=s;I&&E&&I===E&&typeof I=="string"&&(P=I,Q=n.find(a,[P,P]),ne=n.find(s,[P,P]));for(var Y=[],se=0;se<G;se++){for(var pe=ne(D[0],q[0][se]),oe=1;oe<W;oe++)pe=Q(pe,ne(D[oe],q[oe][se]));Y[se]=pe}return new f({data:Y,size:[G],datatype:P})},g=n("_multiplyMatrixVector",{"DenseMatrix, any":x,"SparseMatrix, any":_}),b=n("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":N,"DenseMatrix, SparseMatrix":C,"SparseMatrix, DenseMatrix":w,"SparseMatrix, SparseMatrix":A});function x($,S){var D=$._data,V=$._size,I=$._datatype,q=S._data,K=S._datatype,E=V[0],W=V[1],G,P=a,Q=s;I&&K&&I===K&&typeof I=="string"&&(G=I,P=n.find(a,[G,G]),Q=n.find(s,[G,G]));for(var ne=[],Y=0;Y<E;Y++){for(var se=D[Y],pe=Q(se[0],q[0]),oe=1;oe<W;oe++)pe=P(pe,Q(se[oe],q[oe]));ne[Y]=pe}return new f({data:ne,size:[E],datatype:G})}function N($,S){var D=$._data,V=$._size,I=$._datatype,q=S._data,K=S._size,E=S._datatype,W=V[0],G=V[1],P=K[1],Q,ne=a,Y=s;I&&E&&I===E&&typeof I=="string"&&(Q=I,ne=n.find(a,[Q,Q]),Y=n.find(s,[Q,Q]));for(var se=[],pe=0;pe<W;pe++){var oe=D[pe];se[pe]=[];for(var ve=0;ve<P;ve++){for(var O=Y(oe[0],q[0][ve]),z=1;z<G;z++)O=ne(O,Y(oe[z],q[z][ve]));se[pe][ve]=O}}return new f({data:se,size:[W,P],datatype:Q})}function C($,S){var D=$._data,V=$._size,I=$._datatype,q=S._values,K=S._index,E=S._ptr,W=S._size,G=S._datatype;if(!q)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var P=V[0],Q=W[1],ne,Y=a,se=s,pe=o,oe=0;I&&G&&I===G&&typeof I=="string"&&(ne=I,Y=n.find(a,[ne,ne]),se=n.find(s,[ne,ne]),pe=n.find(o,[ne,ne]),oe=n.convert(0,ne));for(var ve=[],O=[],z=[],Z=new p({values:ve,index:O,ptr:z,size:[P,Q],datatype:ne}),J=0;J<Q;J++){z[J]=O.length;var R=E[J],F=E[J+1];if(F>R)for(var X=0,te=0;te<P;te++){for(var de=te+1,he,H=R;H<F;H++){var re=K[H];X!==de?(he=se(D[te][re],q[H]),X=de):he=Y(he,se(D[te][re],q[H]))}X===de&&!pe(he,oe)&&(O.push(te),ve.push(he))}}return z[Q]=O.length,Z}function _($,S){var D=$._values,V=$._index,I=$._ptr,q=$._datatype;if(!D)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var K=S._data,E=S._datatype,W=$._size[0],G=S._size[0],P=[],Q=[],ne=[],Y,se=a,pe=s,oe=o,ve=0;q&&E&&q===E&&typeof q=="string"&&(Y=q,se=n.find(a,[Y,Y]),pe=n.find(s,[Y,Y]),oe=n.find(o,[Y,Y]),ve=n.convert(0,Y));var O=[],z=[];ne[0]=0;for(var Z=0;Z<G;Z++){var J=K[Z];if(!oe(J,ve))for(var R=I[Z],F=I[Z+1],X=R;X<F;X++){var te=V[X];z[te]?O[te]=se(O[te],pe(J,D[X])):(z[te]=!0,Q.push(te),O[te]=pe(J,D[X]))}}for(var de=Q.length,he=0;he<de;he++){var H=Q[he];P[he]=O[H]}return ne[1]=Q.length,new p({values:P,index:Q,ptr:ne,size:[W,1],datatype:Y})}function w($,S){var D=$._values,V=$._index,I=$._ptr,q=$._datatype;if(!D)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var K=S._data,E=S._datatype,W=$._size[0],G=S._size[0],P=S._size[1],Q,ne=a,Y=s,se=o,pe=0;q&&E&&q===E&&typeof q=="string"&&(Q=q,ne=n.find(a,[Q,Q]),Y=n.find(s,[Q,Q]),se=n.find(o,[Q,Q]),pe=n.convert(0,Q));for(var oe=[],ve=[],O=[],z=new p({values:oe,index:ve,ptr:O,size:[W,P],datatype:Q}),Z=[],J=[],R=0;R<P;R++){O[R]=ve.length;for(var F=R+1,X=0;X<G;X++){var te=K[X][R];if(!se(te,pe))for(var de=I[X],he=I[X+1],H=de;H<he;H++){var re=V[H];J[re]!==F?(J[re]=F,ve.push(re),Z[re]=Y(te,D[H])):Z[re]=ne(Z[re],Y(te,D[H]))}}for(var ce=O[R],ue=ve.length,Ce=ce;Ce<ue;Ce++){var Ne=ve[Ce];oe[Ce]=Z[Ne]}}return O[P]=ve.length,z}function A($,S){var D=$._values,V=$._index,I=$._ptr,q=$._datatype,K=S._values,E=S._index,W=S._ptr,G=S._datatype,P=$._size[0],Q=S._size[1],ne=D&&K,Y,se=a,pe=s;q&&G&&q===G&&typeof q=="string"&&(Y=q,se=n.find(a,[Y,Y]),pe=n.find(s,[Y,Y]));for(var oe=ne?[]:void 0,ve=[],O=[],z=new p({values:oe,index:ve,ptr:O,size:[P,Q],datatype:Y}),Z=ne?[]:void 0,J=[],R,F,X,te,de,he,H,re,ce=0;ce<Q;ce++){O[ce]=ve.length;var ue=ce+1;for(de=W[ce],he=W[ce+1],te=de;te<he;te++)if(re=E[te],ne)for(F=I[re],X=I[re+1],R=F;R<X;R++)H=V[R],J[H]!==ue?(J[H]=ue,ve.push(H),Z[H]=pe(K[te],D[R])):Z[H]=se(Z[H],pe(K[te],D[R]));else for(F=I[re],X=I[re+1],R=F;R<X;R++)H=V[R],J[H]!==ue&&(J[H]=ue,ve.push(H));if(ne)for(var Ce=O[ce],Ne=ve.length,Te=Ce;Te<Ne;Te++){var $e=ve[Te];oe[Te]=Z[$e]}}return O[Q]=ve.length,z}return d.toTex={2:"\\left(${args[0]}"+r.operators.multiply+"${args[1]}\\right)"},d}var name$71="multiply",factory_1$80=factory$81,multiply$1={name:name$71,factory:factory_1$80};function factory$82(l,t,e,n){var r=latex,i=n("unaryMinus",{number:function(a){return-a},Complex:function(a){return a.neg()},BigNumber:function(a){return a.neg()},Fraction:function(a){return a.neg()},Unit:function(a){var s=a.clone();return s.value=i(a.value),s},"Array | Matrix":function(a){return deepMap(a,i,!0)}});return i.toTex={1:r.operators.unaryMinus+"\\left(${args[0]}\\right)"},i}var name$72="unaryMinus",factory_1$81=factory$82,unaryMinus$1={name:name$72,factory:factory_1$81};function factory$83(l,t,e,n){var r=e(equalScalar),i=l.SparseMatrix,a=function(s,o,u){var c=s._values,f=s._index,p=s._ptr,d=s._size,m=s._datatype,v=o._values,h=o._index,y=o._ptr,g=o._size,b=o._datatype;if(d.length!==g.length)throw new DimensionError_1(d.length,g.length);if(d[0]!==g[0]||d[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+g+")");var x=d[0],N=d[1],C,_=r,w=0,A=u;typeof m=="string"&&m===b&&(C=m,_=n.find(r,[C,C]),w=n.convert(0,C),A=n.find(u,[C,C]));var $=c&&v?[]:void 0,S=[],D=[],V=new i({values:$,index:S,ptr:D,size:[x,N],datatype:C}),I=$?[]:void 0,q=$?[]:void 0,K=[],E=[],W,G,P,Q;for(G=0;G<N;G++){D[G]=S.length;var ne=G+1;for(P=p[G],Q=p[G+1];P<Q;P++)W=f[P],S.push(W),K[W]=ne,I&&(I[W]=c[P]);for(P=y[G],Q=y[G+1];P<Q;P++)W=h[P],K[W]!==ne&&S.push(W),E[W]=ne,q&&(q[W]=v[P]);if($)for(P=D[G];P<S.length;){W=S[P];var Y=K[W],se=E[W];if(Y===ne||se===ne){var pe=Y===ne?I[W]:w,oe=se===ne?q[W]:w,ve=A(pe,oe);_(ve,w)?S.splice(P,1):($.push(ve),P++)}}}return D[N]=S.length,V};return a}var name$73="algorithm05",factory_1$82=factory$83,algorithm05={name:name$73,factory:factory_1$82};function factory$84(l,t,e,n){var r=latex,i=e(matrix),a=e(addScalar),s=e(unaryMinus$1),o=e(algorithm01),u=e(algorithm03),c=e(algorithm05),f=e(algorithm10),p=e(algorithm13),d=e(algorithm14),m=n("subtract",{"number, number":function(v,h){return v-h},"Complex, Complex":function(v,h){return v.sub(h)},"BigNumber, BigNumber":function(v,h){return v.minus(h)},"Fraction, Fraction":function(v,h){return v.sub(h)},"Unit, Unit":function(v,h){if(v.value==null)throw new Error("Parameter x contains a unit with undefined value");if(h.value==null)throw new Error("Parameter y contains a unit with undefined value");if(!v.equalBase(h))throw new Error("Units do not match");var y=v.clone();return y.value=m(y.value,h.value),y.fixPrefix=!1,y},"SparseMatrix, SparseMatrix":function(v,h){return checkEqualDimensions(v,h),c(v,h,m)},"SparseMatrix, DenseMatrix":function(v,h){return checkEqualDimensions(v,h),u(h,v,m,!0)},"DenseMatrix, SparseMatrix":function(v,h){return checkEqualDimensions(v,h),o(v,h,m,!1)},"DenseMatrix, DenseMatrix":function(v,h){return checkEqualDimensions(v,h),p(v,h,m)},"Array, Array":function(v,h){return m(i(v),i(h)).valueOf()},"Array, Matrix":function(v,h){return m(i(v),h)},"Matrix, Array":function(v,h){return m(v,i(h))},"SparseMatrix, any":function(v,h){return f(v,s(h),a)},"DenseMatrix, any":function(v,h){return d(v,h,m)},"any, SparseMatrix":function(v,h){return f(h,v,m,!0)},"any, DenseMatrix":function(v,h){return d(h,v,m,!0)},"Array, any":function(v,h){return d(i(v),h,m,!1).valueOf()},"any, Array":function(v,h){return d(i(h),v,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+r.operators.subtract+"${args[1]}\\right)"},m}function checkEqualDimensions(l,t){var e=l.size(),n=t.size();if(e.length!==n.length)throw new DimensionError_1(e.length,n.length)}var name$74="subtract",factory_1$83=factory$84,subtract$1={name:name$74,factory:factory_1$83};function factory$85(l,t,e,n){var r=n("abs",{number:Math.abs,Complex:function(i){return i.abs()},BigNumber:function(i){return i.abs()},Fraction:function(i){return i.abs()},"Array | Matrix":function(i){return deepMap(i,r,!0)},Unit:function(i){return i.abs()}});return r.toTex={1:"\\left|${args[0]}\\right|"},r}var name$75="abs",factory_1$84=factory$85,abs$1={name:name$75,factory:factory_1$84},object$4=utils.object;function factory$86(l,t,e,n){var r=e(matrix),i=e(abs$1),a=e(addScalar),s=e(divideScalar),o=e(multiplyScalar),u=e(subtract$1),c=e(larger),f=e(equalScalar),p=e(unaryMinus$1),d=l.SparseMatrix,m=l.DenseMatrix,v=l.Spa,h=n("lup",{DenseMatrix:function(b){return y(b)},SparseMatrix:function(b){return g(b)},Array:function(b){var x=r(b),N=y(x);return{L:N.L.valueOf(),U:N.U.valueOf(),p:N.p}}}),y=function(b){var x=b._size[0],N=b._size[1],C=Math.min(x,N),_=object$4.clone(b._data),w=[],A=[x,C],$=[],S=[C,N],D,V,I,q=[];for(D=0;D<x;D++)q[D]=D;for(V=0;V<N;V++){if(V>0)for(D=0;D<x;D++){var K=Math.min(D,V),E=0;for(I=0;I<K;I++)E=a(E,o(_[D][I],_[I][V]));_[D][V]=u(_[D][V],E)}var W=V,G=0,P=0;for(D=V;D<x;D++){var Q=_[D][V],ne=i(Q);c(ne,G)&&(W=D,G=ne,P=Q)}if(V!==W&&(q[V]=[q[W],q[W]=q[V]][0],m._swapRows(V,W,_)),V<x)for(D=V+1;D<x;D++){var Y=_[D][V];f(Y,0)||(_[D][V]=s(_[D][V],P))}}for(V=0;V<N;V++)for(D=0;D<x;D++){if(V===0&&(D<N&&($[D]=[]),w[D]=[]),D<V){D<N&&($[D][V]=_[D][V]),V<x&&(w[D][V]=0);continue}if(D===V){D<N&&($[D][V]=_[D][V]),V<x&&(w[D][V]=1);continue}D<N&&($[D][V]=0),V<x&&(w[D][V]=_[D][V])}var se=new m({data:w,size:A}),pe=new m({data:$,size:S}),oe=[];for(D=0,C=q.length;D<C;D++)oe[q[D]]=D;return{L:se,U:pe,p:oe,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}},g=function(b){var x=b._size[0],N=b._size[1],C=Math.min(x,N),_=b._values,w=b._index,A=b._ptr,$=[],S=[],D=[],V=[x,C],I=[],q=[],K=[],E=[C,N],W,G,P,Q=[],ne=[];for(W=0;W<x;W++)Q[W]=W,ne[W]=W;var Y=function(Z,J){var R=ne[Z],F=ne[J];Q[R]=J,Q[F]=Z,ne[Z]=F,ne[J]=R};for(G=0;G<N;G++){var se=new v;G<x&&(D.push($.length),$.push(1),S.push(G)),K.push(I.length);var pe=A[G],oe=A[G+1];for(P=pe;P<oe;P++)W=w[P],se.set(Q[W],_[P]);G>0&&se.forEach(0,G-1,function(Z,J){d._forEachRow(Z,$,S,D,function(R,F){R>Z&&se.accumulate(R,p(o(F,J)))})});var ve=G,O=se.get(G),z=i(O);se.forEach(G+1,x-1,function(Z,J){var R=i(J);c(R,z)&&(ve=Z,z=R,O=J)}),G!==ve&&(d._swapRows(G,ve,V[1],$,S,D),d._swapRows(G,ve,E[1],I,q,K),se.swap(G,ve),Y(G,ve)),se.forEach(0,x-1,function(Z,J){Z<=G?(I.push(J),q.push(Z)):(J=s(J,O),f(J,0)||($.push(J),S.push(Z)))})}return K.push(I.length),D.push($.length),{L:new d({values:$,index:S,ptr:D,size:V}),U:new d({values:I,index:q,ptr:K,size:E}),p:Q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}};return h}var name$76="lup",factory_1$85=factory$86,lup$1={name:name$76,factory:factory_1$85},object$5=utils.object,string$8=utils.string;function factory$87(l,t,e,n){var r=e(matrix),i=e(add),a=e(subtract$1),s=e(multiply$1),o=e(unaryMinus$1),u=e(lup$1),c=n("det",{any:function(p){return object$5.clone(p)},"Array | Matrix":function(d){var m;switch(l.isMatrix(d)?m=d.size():Array.isArray(d)?(d=r(d),m=d.size()):m=[],m.length){case 0:return object$5.clone(d);case 1:if(m[0]==1)return object$5.clone(d.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+string$8.format(m)+")");case 2:var v=m[0],h=m[1];if(v==h)return f(d.clone().valueOf(),v,h);throw new RangeError("Matrix must be square (size: "+string$8.format(m)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+string$8.format(m)+")")}}});return c.toTex={1:"\\det\\left(${args[0]}\\right)"},c;function f(p,d,m){if(d==1)return object$5.clone(p[0][0]);if(d==2)return a(s(p[0][0],p[1][1]),s(p[1][0],p[0][1]));for(var v=u(p),h=v.U[0][0],g=1;g<d;g++)h=s(h,v.U[g][g]);for(var y=0,g=0,b=[];;){for(;b[g];)g++;if(g>=d)break;for(var x=g,N=0;!b[v.p[x]];)b[v.p[x]]=!0,x=v.p[x],N++;N%2==0&&y++}return y%2==0?h:o(h)}}var name$77="det",factory_1$86=factory$87,det$1={name:name$77,factory:factory_1$86},isInteger$5=number.isInteger;function factory$88(l,t,e,n){var r=e(matrix),i=n("eye",{"":function(){return t.matrix==="Matrix"?r([]):[]},string:function(o){return r(o)},"number | BigNumber":function(o){return s(o,o,t.matrix==="Matrix"?"default":void 0)},"number | BigNumber, string":function(o,u){return s(o,o,u)},"number | BigNumber, number | BigNumber":function(o,u){return s(o,u,t.matrix==="Matrix"?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(o,u,c){return s(o,u,c)},Array:function(o){return a(o)},"Array, string":function(o,u){return a(o,u)},Matrix:function(o){return a(o.valueOf(),o.storage())},"Matrix, string":function(o,u){return a(o.valueOf(),u)}});return i.toTex=void 0,i;function a(o,u){switch(o.length){case 0:return u?r(u):[];case 1:return s(o[0],o[0],u);case 2:return s(o[0],o[1],u);default:throw new Error("Vector containing two values expected")}}function s(o,u,c){var f=l.isBigNumber(o)||l.isBigNumber(u)?l.BigNumber:null;if(l.isBigNumber(o)&&(o=o.toNumber()),l.isBigNumber(u)&&(u=u.toNumber()),!isInteger$5(o)||o<1)throw new Error("Parameters in function eye must be positive integers");if(!isInteger$5(u)||u<1)throw new Error("Parameters in function eye must be positive integers");var p=f?new l.BigNumber(1):1,d=f?new f(0):0,m=[o,u];if(c){var v=l.Matrix.storage(c);return v.diagonal(m,p,0,d)}for(var h=array.resize([],m,d),y=o<u?o:u,g=0;g<y;g++)h[g][g]=p;return h}}var name$78="eye",factory_1$87=factory$88,eye$1={name:name$78,factory:factory_1$87};function factory$89(l,t,e,n){var r=e(matrix),i=e(divideScalar),a=e(addScalar),s=e(multiply$1),o=e(unaryMinus$1),u=e(det$1),c=e(eye$1),f=e(abs$1),p=n("inv",{"Array | Matrix":function(m){var v=l.isMatrix(m)?m.size():utils.array.size(m);switch(v.length){case 1:if(v[0]==1)return l.isMatrix(m)?r([i(1,m.valueOf()[0])]):[i(1,m[0])];throw new RangeError("Matrix must be square (size: "+utils.string.format(v)+")");case 2:var h=v[0],y=v[1];if(h==y)return l.isMatrix(m)?r(d(m.valueOf(),h,y),m.storage()):d(m,h,y);throw new RangeError("Matrix must be square (size: "+utils.string.format(v)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+utils.string.format(v)+")")}},any:function(m){return i(1,m)}});function d(m,v,h){var y,g,b,x,N;if(v==1){if(x=m[0][0],x==0)throw Error("Cannot calculate inverse, determinant is zero");return[[i(1,x)]]}else if(v==2){var C=u(m);if(C==0)throw Error("Cannot calculate inverse, determinant is zero");return[[i(m[1][1],C),i(o(m[0][1]),C)],[i(o(m[1][0]),C),i(m[0][0],C)]]}else{var _=m.concat();for(y=0;y<v;y++)_[y]=_[y].concat();for(var w=c(v).valueOf(),A=0;A<h;A++){var $=f(_[A][A]),S=A;for(y=A+1;y<v;)f(_[y][A])>$&&($=f(_[y][A]),S=y),y++;if($==0)throw Error("Cannot calculate inverse, determinant is zero");y=S,y!=A&&(N=_[A],_[A]=_[y],_[y]=N,N=w[A],w[A]=w[y],w[y]=N);var D=_[A],V=w[A];for(y=0;y<v;y++){var I=_[y],q=w[y];if(y!=A){if(I[A]!=0){for(b=i(o(I[A]),D[A]),g=A;g<h;g++)I[g]=a(I[g],s(b,D[g]));for(g=0;g<h;g++)q[g]=a(q[g],s(b,V[g]))}}else{for(b=D[A],g=A;g<h;g++)I[g]=i(I[g],b);for(g=0;g<h;g++)q[g]=i(q[g],b)}}}return w}}return p.toTex={1:"\\left(${args[0]}\\right)^{-1}"},p}var name$79="inv",factory_1$88=factory$89,inv$1={name:name$79,factory:factory_1$88},extend$3=object.extend;function factory$90(l,t,e,n){var r=e(divideScalar),i=e(multiply$1),a=e(inv$1),s=e(matrix),o=e(algorithm11),u=e(algorithm14),c=n("divide",extend$3({"Array | Matrix, Array | Matrix":function(f,p){return i(f,a(p))},"DenseMatrix, any":function(f,p){return u(f,p,r,!1)},"SparseMatrix, any":function(f,p){return o(f,p,r,!1)},"Array, any":function(f,p){return u(s(f),p,r,!1).valueOf()},"any, Array | Matrix":function(f,p){return i(f,a(p))}},r.signatures));return c.toTex={2:"\\frac{${args[0]}}{${args[1]}}"},c}var name$80="divide",factory_1$89=factory$90,divide$1={name:name$80,factory:factory_1$89},size$1=array.size;function factory$91(l,t,e,n){var r=e(add),i=e(divide$1),a=e(improveErrorMessage),s=n("mean",{"Array | Matrix":u,"Array | Matrix, number | BigNumber":o,"...":function(c){if(containsCollections(c))throw new TypeError("Scalar values expected in function mean");return u(c)}});return s.toTex=void 0,s;function o(c,f){try{var p=reduce(c,f,r),d=Array.isArray(c)?size$1(c):c.size();return i(p,d[f])}catch(m){throw a(m,"mean")}}function u(c){var f=0,p=0;if(deepForEach(c,function(d){try{f=r(f,d),p++}catch(m){throw a(m,"mean",d)}}),p===0)throw new Error("Cannot calculate mean of an empty array");return i(f,p)}}var name$81="mean",factory_1$90=factory$91,mean$1={name:name$81,factory:factory_1$90},errorTransform$4=error_transform.transform;function factory$92(l,t,e,n){var r=e(mean$1);return n("mean",{"...any":function(i){if(i.length==2&&isCollection(i[0])){var a=i[1];l.isNumber(a)?i[1]=a-1:l.isBigNumber(a)&&(i[1]=a.minus(1))}try{return r.apply(null,i)}catch(s){throw errorTransform$4(s)}}})}var name$82="mean",path$38="expression.transform",factory_1$91=factory$92,mean_transform={name:name$82,path:path$38,factory:factory_1$91};function factory$93(l,t,e,n){var r=e(smaller),i=e(improveErrorMessage),a=n("min",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(u,c){return reduce(u,c.valueOf(),s)},"...":function(u){if(containsCollections(u))throw new TypeError("Scalar values expected in function min");return o(u)}});return a.toTex="\\min\\left(${args}\\right)",a;function s(u,c){try{return r(u,c)?u:c}catch(f){throw i(f,"min",c)}}function o(u){var c=void 0;if(deepForEach(u,function(f){try{(c===void 0||r(f,c))&&(c=f)}catch(p){throw i(p,"min",f)}}),c===void 0)throw new Error("Cannot calculate min of an empty array");return c}}var name$83="min",factory_1$92=factory$93,min$1={name:name$83,factory:factory_1$92},errorTransform$5=error_transform.transform;function factory$94(l,t,e,n){var r=e(min$1);return n("min",{"...any":function(i){if(i.length==2&&isCollection(i[0])){var a=i[1];l.isNumber(a)?i[1]=a-1:l.isBigNumber(a)&&(i[1]=a.minus(1))}try{return r.apply(null,i)}catch(s){throw errorTransform$5(s)}}})}var name$84="min",path$39="expression.transform",factory_1$93=factory$94,min_transform={name:name$84,path:path$39,factory:factory_1$93};function factory$95(l,t,e,n){var r=e(matrix),i=new l.BigNumber(0),a=new l.BigNumber(1),s=n("range",{string:u,"string, boolean":u,"number, number":function(v,h){return o(c(v,h,1))},"number, number, number":function(v,h,y){return o(c(v,h,y))},"number, number, boolean":function(v,h,y){return o(y?f(v,h,1):c(v,h,1))},"number, number, number, boolean":function(v,h,y,g){return o(g?f(v,h,y):c(v,h,y))},"BigNumber, BigNumber":function(v,h){return o(p(v,h,a))},"BigNumber, BigNumber, BigNumber":function(v,h,y){return o(p(v,h,y))},"BigNumber, BigNumber, boolean":function(v,h,y){return o(y?d(v,h,a):p(v,h,a))},"BigNumber, BigNumber, BigNumber, boolean":function(v,h,y,g){return o(g?d(v,h,y):p(v,h,y))}});return s.toTex=void 0,s;function o(v){return t.matrix==="Array"?v:r(v)}function u(v,h){var y=m(v);if(!y)throw new SyntaxError('String "'+v+'" is no valid range');var g;return t.number==="BigNumber"?(g=h?d:p,o(g(new l.BigNumber(y.start),new l.BigNumber(y.end),new l.BigNumber(y.step)))):(g=h?f:c,o(g(y.start,y.end,y.step)))}function c(v,h,y){var g=[],b=v;if(y>0)for(;b<h;)g.push(b),b+=y;else if(y<0)for(;b>h;)g.push(b),b+=y;return g}function f(v,h,y){var g=[],b=v;if(y>0)for(;b<=h;)g.push(b),b+=y;else if(y<0)for(;b>=h;)g.push(b),b+=y;return g}function p(v,h,y){var g=[],b=v;if(y.gt(i))for(;b.lt(h);)g.push(b),b=b.plus(y);else if(y.lt(i))for(;b.gt(h);)g.push(b),b=b.plus(y);return g}function d(v,h,y){var g=[],b=v;if(y.gt(i))for(;b.lte(h);)g.push(b),b=b.plus(y);else if(y.lt(i))for(;b.gte(h);)g.push(b),b=b.plus(y);return g}function m(v){var h=v.split(":"),y=h.map(function(b){return Number(b)}),g=y.some(function(b){return isNaN(b)});if(g)return null;switch(y.length){case 2:return{start:y[0],end:y[1],step:1};case 3:return{start:y[0],end:y[2],step:y[1]};default:return null}}}var name$85="range",factory_1$94=factory$95,range$1={name:name$85,factory:factory_1$94};function factory$96(l,t,e,n){var r=e(range$1);return n("range",{"...any":function(i){var a=i.length-1,s=i[a];return typeof s!="boolean"&&i.push(!0),r.apply(null,i)}})}var name$86="range",path$40="expression.transform",factory_1$95=factory$96,range_transform={name:name$86,path:path$40,factory:factory_1$95},errorTransform$6=error_transform.transform;function factory$97(l,t,e,n){var r=e(subset$1);return n("subset",{"...any":function(i){try{return r.apply(null,i)}catch(a){throw errorTransform$6(a)}}})}var name$87="subset",path$41="expression.transform",factory_1$96=factory$97,subset_transform={name:name$87,path:path$41,factory:factory_1$96},transform$1=[concat_transform,filter_transform,forEach_transform,index_transform,map_transform,max_transform,mean_transform,min_transform,range_transform,subset_transform];function factory$98(l,t,e,n){var r=e(parser)();function i(a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(!a)throw new Error('Argument "doc" missing');this.doc=a}return i.prototype.type="Help",i.prototype.isHelp=!0,i.prototype.toString=function(){var a=this.doc||{},s=`
`;if(a.name&&(s+="Name: "+a.name+`

`),a.category&&(s+="Category: "+a.category+`

`),a.description&&(s+=`Description:
    `+a.description+`

`),a.syntax&&(s+=`Syntax:
    `+a.syntax.join(`
    `)+`

`),a.examples){s+=`Examples:
`;for(var o=0;o<a.examples.length;o++){var u=a.examples[o];s+="    "+u+`
`;var c;try{c=r.eval(u)}catch(f){c=f}c!==void 0&&!l.isHelp(c)&&(s+="        "+string.format(c,{precision:14})+`
`)}s+=`
`}return a.seealso&&a.seealso.length&&(s+="See also: "+a.seealso.join(", ")+`
`),s},i.prototype.toJSON=function(){var a=object.clone(this.doc);return a.mathjs="Help",a},i.fromJSON=function(a){var s={};for(var o in a)o!=="mathjs"&&(s[o]=a[o]);return new i(s)},i.prototype.valueOf=i.prototype.toString,i}var name$88="Help",path$42="type",factory_1$97=factory$98,Help={name:name$88,path:path$42,factory:factory_1$97},expression=[embeddedDocs,_function$2,node,transform$1,Help,parse,Parser];function factory$99(l,t,e,n){var r=e(matrix),i=e(equalScalar),a=e(algorithm03),s=e(algorithm07),o=e(algorithm12),u=e(algorithm13),c=e(algorithm14),f=latex,p=n("equal",{"any, any":function(d,m){return d===null?m===null:m===null?d===null:d===void 0?m===void 0:m===void 0?d===void 0:i(d,m)},"SparseMatrix, SparseMatrix":function(d,m){return s(d,m,i)},"SparseMatrix, DenseMatrix":function(d,m){return a(m,d,i,!0)},"DenseMatrix, SparseMatrix":function(d,m){return a(d,m,i,!1)},"DenseMatrix, DenseMatrix":function(d,m){return u(d,m,i)},"Array, Array":function(d,m){return p(r(d),r(m)).valueOf()},"Array, Matrix":function(d,m){return p(r(d),m)},"Matrix, Array":function(d,m){return p(d,r(m))},"SparseMatrix, any":function(d,m){return o(d,m,i,!1)},"DenseMatrix, any":function(d,m){return c(d,m,i,!1)},"any, SparseMatrix":function(d,m){return o(m,d,i,!0)},"any, DenseMatrix":function(d,m){return c(m,d,i,!0)},"Array, any":function(d,m){return c(r(d),m,i,!1).valueOf()},"any, Array":function(d,m){return c(r(m),d,i,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+f.operators.equal+"${args[1]}\\right)"},p}var name$89="equal",factory_1$98=factory$99,equal$1={name:name$89,factory:factory_1$98};function factory$100(l,t,e,n,r){var i=r.expression.node.FunctionNode,a=r.expression.node.OperatorNode,s=r.expression.node.SymbolNode,o={add:!0,multiply:!0},u={add:!0,multiply:!0};function c(y,g){if(!l.isOperatorNode(y))return!0;var b=y.fn.toString();return g&&g.hasOwnProperty(b)&&g[b].hasOwnProperty("commutative")?g[b].commutative:o[b]||!1}function f(y,g){if(!l.isOperatorNode(y))return!1;var b=y.fn.toString();return g&&g.hasOwnProperty(b)&&g[b].hasOwnProperty("associative")?g[b].associative:u[b]||!1}function p(y){if(!y.args||y.args.length===0)return y;y.args=d(y);for(var g=0;g<y.args.length;g++)p(y.args[g])}function d(y){var g,b=[],x=function(N){for(var C=0;C<N.args.length;C++){var _=N.args[C];l.isOperatorNode(_)&&g===_.op?x(_):b.push(_)}};return f(y)?(g=y.op,x(y),b):y.args}function m(y){if(!(!y.args||y.args.length===0)){for(var g=h(y),b=y.args.length,x=0;x<b;x++)m(y.args[x]);if(b>2&&f(y)){for(var N=y.args.pop();y.args.length>0;)N=g([y.args.pop(),N]);y.args=N.args}}}function v(y){if(!(!y.args||y.args.length===0)){for(var g=h(y),b=y.args.length,x=0;x<b;x++)v(y.args[x]);if(b>2&&f(y)){for(var N=y.args.shift();y.args.length>0;)N=g([N,y.args.shift()]);y.args=N.args}}}function h(y){return l.isOperatorNode(y)?function(g){try{return new a(y.op,y.fn,g)}catch(b){return console.error(b),[]}}:function(g){return new i(new s(y.name),g)}}return{createMakeNodeFunction:h,isCommutative:c,isAssociative:f,flatten:p,allChildren:d,unflattenr:m,unflattenl:v}}var factory_1$99=factory$100,math$12=!0,util={factory:factory_1$99,math:math$12};function factory$101(l,t,e,n){var r=n("isNumeric",{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string":function(){return!1},"Array | Matrix":function(i){return deepMap(i,r)}});return r}var name$90="isNumeric",factory_1$100=factory$101,isNumeric$1={name:name$90,factory:factory_1$100},digits$1=number.digits;function factory$102(l,t,e,n,r){var i=e(util),a=e(isNumeric$1),s=i.isCommutative,o=i.isAssociative,u=i.allChildren,c=i.createMakeNodeFunction,f=r.expression.node.ConstantNode,p=r.expression.node.OperatorNode,d=r.expression.node.FunctionNode;function m(_){var w=C(_);return l.isNode(w)?w:h(w)}function v(_,w){try{return g(r[_].apply(null,w))}catch(A){return w=w.map(function($){return l.isFraction($)?$.valueOf():$}),g(r[_].apply(null,w))}}var h=n({Fraction:x,number:function(_){return _<0?b(new f(-_)):new f(_)},BigNumber:function(_){return _<0?b(new f(_.negated().toString(),"number")):new f(_.toString(),"number")},Complex:function(_){throw"Cannot convert Complex number to Node"}});function y(_){if(isFinite(_)){var w=r.fraction(_);if(w.valueOf()===_)return w}return _}var g=n({string:function(_){return t.number==="BigNumber"?r.bignumber(_):t.number==="Fraction"?r.fraction(_):y(parseFloat(_))},Fraction:function(_){return _},BigNumber:function(_){return _},number:function(_){return y(_)},Complex:function(_){return _.im!==0?_:y(_.re)}});function b(_){return new p("-","unaryMinus",[_])}function x(_){var w,A=_.s*_.n;return A<0?w=new p("-","unaryMinus",[new f(-A)]):w=new f(A),_.d===1?w:new p("/","divide",[w,new f(_.d)])}function N(_,w,A){return w.reduce(function($,S){if(!l.isNode($)&&!l.isNode(S)){try{return v(_,[$,S])}catch(D){}$=h($),S=h(S)}else l.isNode($)?l.isNode(S)||(S=h(S)):$=h($);return A([$,S])})}function C(_){switch(_.type){case"SymbolNode":return _;case"ConstantNode":return typeof _.value=="number"?g(_.value):_;case"FunctionNode":if(r[_.name]&&r[_.name].rawArgs)return _;var w=["add","multiply"];if(w.indexOf(_.name)===-1){var $=_.args.map(C);if(!$.some(l.isNode))try{return v(_.name,$)}catch(E){}return $=$.map(function(E){return l.isNode(E)?E:h(E)}),new d(_.name,$)}case"OperatorNode":var A=_.fn.toString(),$,S,D=c(_);if(_.isUnary())$=[C(_.args[0])],l.isNode($[0])?S=D($):S=v(A,$);else if(o(_))if($=u(_),$=$.map(C),s(A)){for(var V=[],I=[],q=0;q<$.length;q++)l.isNode($[q])?I.push($[q]):V.push($[q]);V.length>1?(S=N(A,V,D),I.unshift(S),S=N(A,I,D)):S=N(A,$,D)}else S=N(A,$,D);else $=_.args.map(C),S=N(A,$,D);return S;case"ParenthesisNode":return C(_.content);case"AccessorNode":case"ArrayNode":case"AssignmentNode":case"BlockNode":case"FunctionAssignmentNode":case"IndexNode":case"ObjectNode":case"RangeNode":case"UpdateNode":case"ConditionalNode":default:throw"Unimplemented node type in simplifyConstant: "+_.type}}return m}var math$13=!0,name$91="simplifyConstant",path$43="algebra.simplify",factory_1$101=factory$102,simplifyConstant={math:math$13,name:name$91,path:path$43,factory:factory_1$101};function factory$103(l,t,e,n){var r=n("isZero",{number:function(i){return i===0},BigNumber:function(i){return i.isZero()},Complex:function(i){return i.re===0&&i.im===0},Fraction:function(i){return i.d===1&&i.n===0},Unit:function(i){return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r}var name$92="isZero",factory_1$102=factory$103,isZero$1={name:name$92,factory:factory_1$102},isInteger$6=number.isInteger,size$2=array.size;function factory$104(l,t,e,n){var r=latex,i=e(eye$1),a=e(multiply$1),s=e(matrix),o=e(fraction$2),u=e(number$3),c=n("pow",{"number, number":f,"Complex, Complex":function(m,v){return m.pow(v)},"BigNumber, BigNumber":function(m,v){return v.isInteger()||m>=0||t.predictable?m.pow(v):new l.Complex(m.toNumber(),0).pow(v.toNumber(),0)},"Fraction, Fraction":function(m,v){if(v.d!==1){if(t.predictable)throw new Error("Function pow does not support non-integer exponents for fractions.");return f(m.valueOf(),v.valueOf())}else return m.pow(v)},"Array, number":p,"Array, BigNumber":function(m,v){return p(m,v.toNumber())},"Matrix, number":d,"Matrix, BigNumber":function(m,v){return d(m,v.toNumber())},"Unit, number":function(m,v){return m.pow(v)}});function f(m,v){if(t.predictable&&!isInteger$6(v)&&m<0)try{var h=o(v),y=u(h);if((v===y||Math.abs((v-y)/v)<1e-14)&&h.d%2==1)return(h.n%2==0?1:-1)*Math.pow(-m,v)}catch(g){}return m*m<1&&v===Infinity||m*m>1&&v===-Infinity?0:t.predictable&&(m<-1&&v===Infinity||m>-1&&m<0&&v===-Infinity)?NaN:isInteger$6(v)||m>=0||t.predictable?Math.pow(m,v):new l.Complex(m,0).pow(v,0)}function p(m,v){if(!isInteger$6(v)||v<0)throw new TypeError("For A^b, b must be a positive integer (value is "+v+")");var h=size$2(m);if(h.length!=2)throw new Error("For A^b, A must be 2 dimensional (A has "+h.length+" dimensions)");if(h[0]!=h[1])throw new Error("For A^b, A must be square (size is "+h[0]+"x"+h[1]+")");for(var y=i(h[0]).valueOf(),g=m;v>=1;)(v&1)==1&&(y=a(g,y)),v>>=1,g=a(g,g);return y}function d(m,v){return s(p(m.valueOf(),v))}return c.toTex={2:"\\left(${args[0]}\\right)"+r.operators.pow+"{${args[1]}}"},c}var name$93="pow",factory_1$103=factory$104,pow$1={name:name$93,factory:factory_1$103};function factory$105(l,t,e,n,r){var i=e(equal$1),a=e(isZero$1),s=e(isNumeric$1),o=e(add),u=e(subtract$1),c=e(multiply$1),f=e(divide$1),p=e(pow$1),d=r.expression.node.ConstantNode,m=r.expression.node.OperatorNode,v=r.expression.node.FunctionNode,h=r.expression.node.ParenthesisNode,y=new d(0),g=new d(1);function b(x){if(l.isOperatorNode(x)&&x.isUnary()){var N=b(x.args[0]);if(x.op==="+")return N;if(x.op==="-"){if(l.isOperatorNode(N)){if(N.isUnary()&&N.op==="-")return N.args[0];if(N.isBinary()&&N.fn==="subtract")return new m("-","subtract",[N.args[1],N.args[0]])}return new m(x.op,x.fn,[N])}}else if(l.isOperatorNode(x)&&x.isBinary()){var N=b(x.args[0]),C=b(x.args[1]);if(x.op==="+"){if(l.isConstantNode(N)){if(a(N.value))return C;if(l.isConstantNode(C))return new d(o(N.value,C.value))}return l.isConstantNode(C)&&a(C.value)?N:l.isOperatorNode(C)&&C.isUnary()&&C.op==="-"?new m("-","subtract",[N,C.args[0]]):new m(x.op,x.fn,C?[N,C]:[N])}else if(x.op==="-"){if(l.isConstantNode(N)&&C){if(l.isConstantNode(C))return new d(u(N.value,C.value));if(a(N.value))return new m("-","unaryMinus",[C])}if(x.fn==="subtract")return l.isConstantNode(C)&&a(C.value)?N:l.isOperatorNode(C)&&C.isUnary()&&C.op==="-"?b(new m("+","add",[N,C.args[0]])):new m(x.op,x.fn,[N,C])}else if(x.op==="*"){if(l.isConstantNode(N)){if(a(N.value))return y;if(i(N.value,1))return C;if(l.isConstantNode(C))return new d(c(N.value,C.value))}if(l.isConstantNode(C)){if(a(C.value))return y;if(i(C.value,1))return N;if(l.isOperatorNode(N)&&N.isBinary()&&N.op===x.op){var _=N.args[0];if(l.isConstantNode(_)){var w=new d(c(_.value,C.value));return new m(x.op,x.fn,[w,N.args[1]])}}return new m(x.op,x.fn,[C,N])}return new m(x.op,x.fn,[N,C])}else if(x.op==="/"){if(l.isConstantNode(N)){if(a(N.value))return y;if(l.isConstantNode(C)&&(i(C.value,1)||i(C.value,2)||i(C.value,4)))return new d(f(N.value,C.value))}return new m(x.op,x.fn,[N,C])}else if(x.op==="^"){if(l.isConstantNode(C)){if(a(C.value))return g;if(i(C.value,1))return N;if(l.isConstantNode(N))return new d(p(N.value,C.value));if(l.isOperatorNode(N)&&N.isBinary()&&N.op==="^"){var A=N.args[1];if(l.isConstantNode(A))return new m(x.op,x.fn,[N.args[0],new d(c(A.value,C.value))])}}return new m(x.op,x.fn,[N,C])}}else if(l.isParenthesisNode(x)){var $=b(x.content);return l.isParenthesisNode($)||l.isSymbolNode($)||l.isConstantNode($)?$:new h($)}else if(l.isFunctionNode(x)){var S=x.args.map(b).map(function(D){return l.isParenthesisNode(D)?D.content:D});return new v(b(x.fn),S)}return x}return b}var math$14=!0,name$94="simplifyCore",path$44="algebra.simplify",factory_1$104=factory$105,simplifyCore={math:math$14,name:name$94,path:path$44,factory:factory_1$104};function factory$106(l,t,e,n,r){var i=r.expression.node.Node,a=r.expression.node.OperatorNode,s=r.expression.node.FunctionNode,o=r.expression.node.ParenthesisNode;function u(c,f){if(!f)return c;if(l.isSymbolNode(c)){var p=f[c.name];if(p instanceof i)return u(p,f);if(typeof p=="number")return r.parse(String(p))}else if(l.isOperatorNode(c)){var d=c.args.map(function(m){return u(m,f)});return new a(c.op,c.fn,d)}else{if(l.isParenthesisNode(c))return new o(u(c.content,f));if(l.isFunctionNode(c)){var d=c.args.map(function(v){return u(v,f)});return new s(c.name,d)}}return c}return u}var math$15=!0,name$95="resolve",path$45="algebra.simplify",factory_1$105=factory$106,resolve={math:math$15,name:name$95,path:path$45,factory:factory_1$105};function factory$107(l,t,e,n,r){var i=e(parse),a=e(equal$1),s=e(ConstantNode),o=e(FunctionNode),u=e(OperatorNode),c=e(ParenthesisNode),f=e(SymbolNode),p=e(Node),d=e(simplifyConstant),m=e(simplifyCore),v=e(resolve),h=e(util),y=h.isCommutative,g=h.isAssociative,b=h.flatten,x=h.unflattenr,N=h.unflattenl,C=h.createMakeNodeFunction,_=n("simplify",{string:function(P){return _(i(P),_.rules,{})},"string, Object":function(P,Q){return _(i(P),_.rules,Q)},"string, Array":function(P,Q){return _(i(P),Q,{})},"string, Array, Object":function(P,Q,ne){return _(i(P),Q,ne)},"Node, Object":function(P,Q){return _(P,_.rules,Q)},Node:function(P){return _(P,_.rules,{})},"Node, Array":function(P,Q){return _(P,Q,{})},"Node, Array, Object":function(P,Q,ne){Q=$(Q);for(var Y=v(P,ne),Y=w(Y),se={},pe=Y.toString({parenthesis:"all"});!se[pe];){se[pe]=!0,S=0;for(var oe=0;oe<Q.length;oe++)typeof Q[oe]=="function"?Y=Q[oe](Y):(b(Y),Y=V(Y,Q[oe])),N(Y);pe=Y.toString({parenthesis:"all"})}return Y}});_.simplifyCore=m,_.resolve=v;function w(P){return P.transform(function(Q,ne,Y){return l.isParenthesisNode(Q)?Q.content:Q})}var A={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};_.rules=[m,{l:"log(e)",r:"1"},{l:"n-n1",r:"n+-n1"},{l:"-(c*v)",r:"(-c) * v"},{l:"-v",r:"(-1) * v"},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{l:"(n ^ n1) ^ n2",r:"n ^ (n1 * n2)"},{l:"n*n",r:"n^2"},{l:"n * n^n1",r:"n^(n1+1)"},{l:"n^n1 * n^n2",r:"n^(n1+n2)"},{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},{l:"n1*n2 + n2",r:"(n1+1)*n2"},{l:"n1*n3 + n2*n3",r:"(n1+n2)*n3"},{l:"n1 + -1 * (n2 + n3)",r:"n1 + -1 * n2 + -1 * n3"},d,{l:"(-n)*n1",r:"-(n*n1)"},{l:"c+v",r:"v+c",context:{add:{commutative:!1}}},{l:"v*c",r:"c*v",context:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"n-(n1+n2)",r:"n-n1-n2"},{l:"1*n",r:"n"}];function $(P){for(var Q=[],ne=0;ne<P.length;ne++){var Y=P[ne],se,pe=typeof Y;switch(pe){case"string":var oe=Y.split("->");if(oe.length!==2)throw SyntaxError("Could not parse rule: "+Y);Y={l:oe[0],r:oe[1]};case"object":if(se={l:w(i(Y.l)),r:w(i(Y.r))},Y.context&&(se.evaluate=Y.context),Y.evaluate&&(se.evaluate=i(Y.evaluate)),g(se.l)){var ve=C(se.l),O=D();se.expanded={},se.expanded.l=ve([se.l.clone(),O]),b(se.expanded.l),x(se.expanded.l),se.expanded.r=ve([se.r,O])}break;case"function":se=Y;break;default:throw TypeError("Unsupported type of rule: "+pe)}Q.push(se)}return Q}var S=0;function D(){return new f("_p"+S++)}var V=n("applyRule",{"Node, Object":function(P,Q){var ne=P;if(ne instanceof u||ne instanceof o){if(ne.args)for(var Y=0;Y<ne.args.length;Y++)ne.args[Y]=V(ne.args[Y],Q)}else ne instanceof c&&ne.content&&(ne.content=V(ne.content,Q));var se=Q.r,pe=W(Q.l,ne)[0];if(!pe&&Q.expanded&&(se=Q.expanded.r,pe=W(Q.expanded.l,ne)[0]),pe){ne=se.clone();var oe=function(ve){return ve.isSymbolNode&&pe.placeholders.hasOwnProperty(ve.name)?pe.placeholders[ve.name].clone():ve.map(oe)};ne=oe(ne)}return ne}});function I(P,Q){var ne=[],Y,se,pe=C(P);if(y(P,Q))for(var oe=0;oe<P.args.length;oe++)se=P.args.slice(0),se.splice(oe,1),Y=se.length===1?se[0]:pe(se),ne.push(pe([P.args[oe],Y]));else se=P.args.slice(1),Y=se.length===1?se[0]:pe(se),ne.push(pe([P.args[0],Y]));return ne}function q(P,Q){var ne={placeholders:{}};if(!P.placeholders&&!Q.placeholders)return ne;if(P.placeholders){if(!Q.placeholders)return P}else return Q;for(var Y in P.placeholders)if(ne.placeholders[Y]=P.placeholders[Y],Q.placeholders.hasOwnProperty(Y)&&!G(P.placeholders[Y],Q.placeholders[Y]))return null;for(var Y in Q.placeholders)ne.placeholders[Y]=Q.placeholders[Y];return ne}function K(P,Q){var ne=[];if(P.length===0||Q.length===0)return ne;for(var Y,se=0;se<P.length;se++)for(var pe=0;pe<Q.length;pe++)Y=q(P[se],Q[pe]),Y&&ne.push(Y);return ne}function E(P){if(P.length===0)return P;for(var Q=P.reduce(K),ne=[],Y={},se=0;se<Q.length;se++){var pe=JSON.stringify(Q[se]);Y[pe]||(Y[pe]=!0,ne.push(Q[se]))}return ne}function W(P,Q,ne){var Y=[{placeholders:{}}];if(P instanceof u&&Q instanceof u||P instanceof o&&Q instanceof o){if(P instanceof u){if(P.op!==Q.op||P.fn!==Q.fn)return[]}else if(P instanceof o&&P.name!==Q.name)return[];if(Q.args.length===1&&P.args.length===1||!g(Q)||ne){for(var se=[],pe=0;pe<P.args.length;pe++){var oe=W(P.args[pe],Q.args[pe]);if(oe.length===0)return[];se.push(oe)}Y=E(se)}else if(Q.args.length>=2&&P.args.length===2){for(var ve=I(Q,P.context),O=[],pe=0;pe<ve.length;pe++){var z=W(P,ve[pe],!0);O=O.concat(z)}return O}else{if(P.args.length>2)throw Error("Unexpected non-binary associative function: "+P.toString());return[]}}else if(P instanceof f){if(P.name.length===0)throw new Error("Symbol in rule has 0 length...!?");if(r.hasOwnProperty(P.name)){if(!A[P.name])throw new Error("Built in constant: "+P.name+" is not supported by simplify.");if(P.name!==Q.name)return[]}else if(P.name[0]==="n"||P.name.substring(0,2)==="_p")Y[0].placeholders[P.name]=Q;else if(P.name[0]==="v")if(!l.isConstantNode(Q))Y[0].placeholders[P.name]=Q;else return[];else if(P.name[0]==="c")if(Q instanceof s)Y[0].placeholders[P.name]=Q;else return[];else throw new Error("Invalid symbol in rule: "+P.name)}else if(P instanceof s){if(!a(P.value,Q.value))return[]}else return[];return Y}function G(P,Q){if(P instanceof s&&Q instanceof s){if(!a(P.value,Q.value))return!1}else if(P instanceof f&&Q instanceof f){if(P.name!==Q.name)return!1}else if(P instanceof u&&Q instanceof u||P instanceof o&&Q instanceof o){if(P instanceof u){if(P.op!==Q.op||P.fn!==Q.fn)return!1}else if(P instanceof o&&P.name!==Q.name)return!1;if(P.args.length!==Q.args.length)return!1;for(var ne=0;ne<P.args.length;ne++)if(!G(P.args[ne],Q.args[ne]))return!1}else return!1;return!0}return _}var math$16=!0,name$96="simplify",factory_1$106=factory$107,simplify$1={math:math$16,name:name$96,factory:factory_1$106};function factory$108(l,t,e,n){var r=e(parse),i=e(simplify$1),a=e(equal$1),s=e(isZero$1),o=e(numeric),u=e(ConstantNode),c=e(FunctionNode),f=e(OperatorNode),p=e(ParenthesisNode),d=e(SymbolNode),m=n("derivative",{"Node, SymbolNode, Object":function(x,N,C){var _={};h(_,x,N.name);var w=y(x,_);return C.simplify?i(w):w},"Node, SymbolNode":function(x,N){return m(x,N,{simplify:!0})},"string, SymbolNode":function(x,N){return m(r(x),N)},"string, SymbolNode, Object":function(x,N,C){return m(r(x),N,C)},"string, string":function(x,N){return m(r(x),r(N))},"string, string, Object":function(x,N,C){return m(r(x),r(N),C)},"Node, string":function(x,N){return m(x,r(N))},"Node, string, Object":function(x,N,C){return m(x,r(N),C)}});m._simplify=!0,m.toTex=function(x){return v.apply(null,x.args)};var v=n("_derivTex",{"Node, SymbolNode":function(x,N){return v(x.toString(),N.toString(),1)},"Node, SymbolNode, ConstantNode":function(x,N,C){return v(x.toString(),N.name,C.value)},"string, string, number":function(x,N,C){var _;return C===1?_="{d\\over d"+N+"}":_="{d^{"+C+"}\\over d"+N+"^{"+C+"}}",_+"\\left["+x+"\\right]"}}),h=n("constTag",{"Object, ConstantNode, string":function(x,N){return x[N]=!0},"Object, SymbolNode, string":function(x,N,C){return N.name!==C?x[N]=!0:!1},"Object, ParenthesisNode, string":function(x,N,C){return h(x,N.content,C)},"Object, FunctionAssignmentNode, string":function(x,N,C){return N.params.indexOf(C)===-1?x[N]=!0:h(x,N.expr,C)},"Object, FunctionNode | OperatorNode, string":function(x,N,C){if(N.args.length>0){for(var _=h(x,N.args[0],C),w=1;w<N.args.length;++w)_=h(x,N.args[w],C)&&_;if(_)return x[N]=!0}return!1}}),y=n("_derivative",{"ConstantNode, Object":function(x){return b(0)},"SymbolNode, Object":function(x,N){return N[x]!==void 0?b(0):b(1)},"ParenthesisNode, Object":function(x,N){return new p(y(x.content,N))},"FunctionAssignmentNode, Object":function(x,N){return N[x]!==void 0?b(0):y(x.expr,N)},"FunctionNode, Object":function(x,N){if(x.args.length!==1&&g(x),N[x]!==void 0)return b(0);var C=x.args[0],_,w=!1,A=!1,$;switch(x.name){case"cbrt":w=!0,$=new f("*","multiply",[b(3),new f("^","pow",[C,new f("/","divide",[b(2),b(3)])])]);break;case"sqrt":case"nthRoot":if(x.args.length===1)w=!0,$=new f("*","multiply",[b(2),new c("sqrt",[C])]);else if(x.args.length===2)return _=new f("/","divide",[b(1),x.args[1]]),N[_]=N[x.args[1]],y(new f("^","pow",[C,_]),N);break;case"log10":_=b(10);case"log":if(!_&&x.args.length===1)$=C.clone(),w=!0;else if(x.args.length===1&&_||x.args.length===2&&N[x.args[1]]!==void 0)$=new f("*","multiply",[C.clone(),new c("log",[_||x.args[1]])]),w=!0;else if(x.args.length===2)return y(new f("/","divide",[new c("log",[C]),new c("log",[x.args[1]])]),N);break;case"exp":$=new c("exp",[C.clone()]);break;case"sin":$=new c("cos",[C.clone()]);break;case"cos":$=new f("-","unaryMinus",[new c("sin",[C.clone()])]);break;case"tan":$=new f("^","pow",[new c("sec",[C.clone()]),b(2)]);break;case"sec":$=new f("*","multiply",[x,new c("tan",[C.clone()])]);break;case"csc":A=!0,$=new f("*","multiply",[x,new c("cot",[C.clone()])]);break;case"cot":A=!0,$=new f("^","pow",[new c("csc",[C.clone()]),b(2)]);break;case"asin":w=!0,$=new c("sqrt",[new f("-","subtract",[b(1),new f("^","pow",[C.clone(),b(2)])])]);break;case"acos":w=!0,A=!0,$=new c("sqrt",[new f("-","subtract",[b(1),new f("^","pow",[C.clone(),b(2)])])]);break;case"atan":w=!0,$=new f("+","add",[new f("^","pow",[C.clone(),b(2)]),b(1)]);break;case"asec":w=!0,$=new f("*","multiply",[new c("abs",[C.clone()]),new c("sqrt",[new f("-","subtract",[new f("^","pow",[C.clone(),b(2)]),b(1)])])]);break;case"acsc":w=!0,A=!0,$=new f("*","multiply",[new c("abs",[C.clone()]),new c("sqrt",[new f("-","subtract",[new f("^","pow",[C.clone(),b(2)]),b(1)])])]);break;case"acot":w=!0,A=!0,$=new f("+","add",[new f("^","pow",[C.clone(),b(2)]),b(1)]);break;case"sinh":$=new c("cosh",[C.clone()]);break;case"cosh":$=new c("sinh",[C.clone()]);break;case"tanh":$=new f("^","pow",[new c("sech",[C.clone()]),b(2)]);break;case"sech":A=!0,$=new f("*","multiply",[x,new c("tanh",[C.clone()])]);break;case"csch":A=!0,$=new f("*","multiply",[x,new c("coth",[C.clone()])]);break;case"coth":A=!0,$=new f("^","pow",[new c("csch",[C.clone()]),b(2)]);break;case"asinh":w=!0,$=new c("sqrt",[new f("+","add",[new f("^","pow",[C.clone(),b(2)]),b(1)])]);break;case"acosh":w=!0,$=new c("sqrt",[new f("-","subtract",[new f("^","pow",[C.clone(),b(2)]),b(1)])]);break;case"atanh":w=!0,$=new f("-","subtract",[b(1),new f("^","pow",[C.clone(),b(2)])]);break;case"asech":w=!0,A=!0,$=new f("*","multiply",[C.clone(),new c("sqrt",[new f("-","subtract",[b(1),new f("^","pow",[C.clone(),b(2)])])])]);break;case"acsch":w=!0,A=!0,$=new f("*","multiply",[new c("abs",[C.clone()]),new c("sqrt",[new f("+","add",[new f("^","pow",[C.clone(),b(2)]),b(1)])])]);break;case"acoth":w=!0,A=!0,$=new f("-","subtract",[b(1),new f("^","pow",[C.clone(),b(2)])]);break;case"abs":$=new f("/","divide",[new c(new d("abs"),[C.clone()]),C.clone()]);break;case"gamma":default:throw new Error('Function "'+x.name+'" is not supported by derivative, or a wrong number of arguments is passed')}var S,D;w?(S="/",D="divide"):(S="*",D="multiply");var V=y(C,N);return A&&(V=new f("-","unaryMinus",[V])),new f(S,D,[V,$])},"OperatorNode, Object":function(x,N){if(N[x]!==void 0)return b(0);if(x.op==="+")return new f(x.op,x.fn,x.args.map(function(V){return y(V,N)}));if(x.op==="-"){if(x.isUnary())return new f(x.op,x.fn,[y(x.args[0],N)]);if(x.isBinary())return new f(x.op,x.fn,[y(x.args[0],N),y(x.args[1],N)])}if(x.op==="*"){var C=x.args.filter(function(V){return N[V]!==void 0});if(C.length>0){var _=x.args.filter(function(V){return N[V]===void 0}),w=_.length===1?_[0]:new f("*","multiply",_),A=C.concat(y(w,N));return new f("*","multiply",A)}return new f("+","add",x.args.map(function(V){return new f("*","multiply",x.args.map(function(I){return I===V?y(I,N):I.clone()}))}))}if(x.op==="/"&&x.isBinary()){var $=x.args[0],S=x.args[1];return N[S]!==void 0?new f("/","divide",[y($,N),S]):N[$]!==void 0?new f("*","multiply",[new f("-","unaryMinus",[$]),new f("/","divide",[y(S,N),new f("^","pow",[S.clone(),b(2)])])]):new f("/","divide",[new f("-","subtract",[new f("*","multiply",[y($,N),S.clone()]),new f("*","multiply",[$.clone(),y(S,N)])]),new f("^","pow",[S.clone(),b(2)])])}if(x.op==="^"&&x.isBinary()){var $=x.args[0],S=x.args[1];if(N[$]!==void 0)return l.isConstantNode($)&&(s($.value)||a($.value,1))?b(0):new f("*","multiply",[x,new f("*","multiply",[new c("log",[$.clone()]),y(S.clone(),N)])]);if(N[S]!==void 0){if(l.isConstantNode(S)){if(s(S.value))return b(0);if(a(S.value,1))return y($,N)}var D=new f("^","pow",[$.clone(),new f("-","subtract",[S,b(1)])]);return new f("*","multiply",[S.clone(),new f("*","multiply",[y($,N),D])])}return new f("*","multiply",[new f("^","pow",[$.clone(),S.clone()]),new f("+","add",[new f("*","multiply",[y($,N),new f("/","divide",[S.clone(),$.clone()])]),new f("*","multiply",[y(S,N),new c("log",[$.clone()])])])])}throw new Error('Operator "'+x.op+'" is not supported by derivative, or a wrong number of arguments is passed')}});function g(x){if(!((x.name==="log"||x.name==="nthRoot")&&x.args.length===2)){for(var N=0;N<x.args.length;++N)x.args[N]=b(0);throw x.compile().eval(),new Error("Expected TypeError, but none found")}}function b(x,N){return new u(o(x,N||t.number))}return m}var name$97="derivative",factory_1$107=factory$108,derivative$1={name:name$97,factory:factory_1$107};function factory$109(l,t,e,n){var r=e(simplify$1),i=e(simplifyCore),a=e(simplifyConstant),s=ArgumentsError_1,o=e(parse$1),u=number,c=e(ConstantNode),f=e(OperatorNode),p=e(SymbolNode),d=n("rationalize",{string:function(g){return d(o(g),{},!1)},"string, boolean":function(g,b){return d(o(g),{},b)},"string, Object":function(g,b){return d(o(g),b,!1)},"string, Object, boolean":function(g,b,x){return d(o(g),b,x)},Node:function(g){return d(g,{},!1)},"Node, boolean":function(g,b){return d(g,{},b)},"Node, Object":function(g,b){return d(g,b,!1)},"Node, Object, boolean":function(g,b,x){var N=m(g,b,!0),C=N.variables.length,g=N.expression;if(C>=1){var _=v();g=h(g);var w=!0,A="",$,S,D=!0;for(g=r(g,_.firstRules),A=g.toString();S=D?_.distrDivRules:_.sucDivRules,g=r(g,S),D=!D,A=g.toString(),A!==$;)w=!0,$=A;w&&(g=r(g,_.firstRulesAgain)),g=r(g,_.finalRules)}var V=[],I={};return g.type==="OperatorNode"&&g.isBinary()&&g.op==="/"?(C==1&&(g.args[0]=y(g.args[0],V),g.args[1]=y(g.args[1])),x&&(I.numerator=g.args[0],I.denominator=g.args[1])):(C==1&&(g=y(g,V)),x&&(I.numerator=g,I.denominator=null)),x?(I.coefficients=V,I.variables=N.variables,I.expression=g,I):g}});function m(g,b,x){var N=[],C=r(g,b);x=!!x;var _="+-*"+(x?"/":"");A(C);var w={};return w.expression=C,w.variables=N,w;function A($){var S=$.type;if(S==="FunctionNode")throw new s("There is an unsolved function call");if(S==="OperatorNode")if($.op==="^"&&$.isBinary()){if($.args[1].type!=="ConstantNode"||!u.isInteger(parseFloat($.args[1].value)))throw new s("There is a non-integer exponent");A($.args[0])}else{if(_.indexOf($.op)===-1)throw new s("Operator "+$.op+" invalid in polynomial expression");for(var D=0;D<$.args.length;D++)A($.args[D])}else if(S==="SymbolNode"){var V=$.name,I=N.indexOf(V);I===-1&&N.push(V)}else if(S==="ParenthesisNode")A($.content);else if(S!=="ConstantNode")throw new s("type "+S+" is not allowed in polynomial expression")}}function v(){var g=[i,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},a,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],b=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],x=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],N=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],C={};return C.firstRules=g.concat(b,N),C.distrDivRules=x,C.sucDivRules=N,C.firstRulesAgain=g.concat(b),C.finalRules=[i,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},a,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],C}function h(g,b,x){var N=g.type,C=arguments.length>1;if(N==="OperatorNode"&&g.isBinary()){var _=!1;if(g.op==="^"&&(g.args[0].type==="ParenthesisNode"||g.args[0].type==="OperatorNode")&&g.args[1].type==="ConstantNode"){var w=parseFloat(g.args[1].value);_=w>=2&&u.isInteger(w)}if(_){if(w>2){var A=g.args[0],$=new f("^","pow",[g.args[0].cloneDeep(),new c(w-1)]);g=new f("*","multiply",[A,$])}else g=new f("*","multiply",[g.args[0],g.args[0].cloneDeep()]);C&&(x==="content"?b.content=g:b.args[x]=g)}}if(N==="ParenthesisNode")h(g.content,g,"content");else if(N!=="ConstantNode"&&N!=="SymbolNode")for(var S=0;S<g.args.length;S++)h(g.args[S],g,S);if(!C)return g}function y(g,b){var x;b===void 0&&(b=[]),b[0]=0;var N={};N.cte=1,N.oper="+",N.fire="";var C=0,_="";I(g,null,N),C=b.length-1;var w=!0;for(x=C;x>=0;x--)if(b[x]!==0){var A=new c(w?b[x]:Math.abs(b[x])),$=b[x]<0?"-":"+";if(x>0){var S=new p(_);if(x>1){var D=new c(x);S=new f("^","pow",[S,D])}b[x]===-1&&w?A=new f("-","unaryMinus",[S]):Math.abs(b[x])===1?A=S:A=new f("*","multiply",[A,S])}var V;w?V=A:$==="+"?V=new f("+","add",[V,A]):V=new f("-","subtract",[V,A]),w=!1}if(w)return new c(0);return V;function I(q,K,E){var W=q.type;if(W==="FunctionNode")throw new s("There is an unsolved function call");if(W==="OperatorNode"){if("+-*^".indexOf(q.op)===-1)throw new s("Operator "+q.op+" invalid");if(K!==null){if((q.fn==="unaryMinus"||q.fn==="pow")&&K.fn!=="add"&&K.fn!=="subtract"&&K.fn!=="multiply")throw new s("Invalid "+q.op+" placing");if((q.fn==="subtract"||q.fn==="add"||q.fn==="multiply")&&K.fn!=="add"&&K.fn!=="subtract")throw new s("Invalid "+q.op+" placing");if((q.fn==="subtract"||q.fn==="add"||q.fn==="unaryMinus")&&E.noFil!==0)throw new s("Invalid "+q.op+" placing")}(q.op==="^"||q.op==="*")&&(E.fire=q.op);for(var G=0;G<q.args.length;G++)q.fn==="unaryMinus"&&(E.oper="-"),(q.op==="+"||q.fn==="subtract")&&(E.fire="",E.cte=1,E.oper=G===0?"+":q.op),E.noFil=G,I(q.args[G],q,E)}else if(W==="SymbolNode"){if(q.name!==_&&_!=="")throw new s("There is more than one variable");if(_=q.name,K===null){b[1]=1;return}if(K.op==="^"&&E.noFil!==0)throw new s("In power the variable should be the first parameter");if(K.op==="*"&&E.noFil!==1)throw new s("In multiply the variable should be the second parameter");(E.fire===""||E.fire==="*")&&(C<1&&(b[1]=0),b[1]+=E.cte*(E.oper==="+"?1:-1),C=Math.max(1,C))}else if(W==="ConstantNode"){var P=parseFloat(q.value);if(K===null){b[0]=P;return}if(K.op==="^"){if(E.noFil!==1)throw new s("Constant cannot be powered");if(!u.isInteger(P)||P<=0)throw new s("Non-integer exponent is not allowed");for(var G=C+1;G<P;G++)b[G]=0;P>C&&(b[P]=0),b[P]+=E.cte*(E.oper==="+"?1:-1),C=Math.max(P,C);return}E.cte=P,E.fire===""&&(b[0]+=E.cte*(E.oper==="+"?1:-1))}else throw new s("Type "+W+" is not allowed")}}return d}var name$98="rationalize",factory_1$108=factory$109,rationalize$1={name:name$98,factory:factory_1$108},isInteger$7=number.isInteger,resize$1=array.resize;function factory$110(l,t,e,n){var r=e(matrix),i=n("zeros",{"":function(){return t.matrix==="Array"?a([]):a([],"default")},"...number | BigNumber | string":function(u){var c=u[u.length-1];if(typeof c=="string"){var f=u.pop();return a(u,f)}else return t.matrix==="Array"?a(u):a(u,"default")},Array:a,Matrix:function(u){var c=u.storage();return a(u.valueOf(),c)},"Array | Matrix, string":function(u,c){return a(u.valueOf(),c)}});return i.toTex=void 0,i;function a(u,c){var f=s(u),p=f?new l.BigNumber(0):0;if(o(u),c){var d=r(c);return u.length>0?d.resize(u,p):d}else{var m=[];return u.length>0?resize$1(m,u,p):m}}function s(u){var c=!1;return u.forEach(function(f,p,d){l.isBigNumber(f)&&(c=!0,d[p]=f.toNumber())}),c}function o(u){u.forEach(function(c){if(typeof c!="number"||!isInteger$7(c)||c<0)throw new Error("Parameters in function zeros must be positive integers")})}}var name$99="zeros",factory_1$109=factory$110,zeros$1={name:name$99,factory:factory_1$109};function factory$111(l,t,e,n){var r=n("clone",{any:object.clone});return r.toTex=void 0,r}var name$100="clone",factory_1$110=factory$111,clone$5={name:name$100,factory:factory_1$110};function factory$112(l,t,e,n){var r=n("isPositive",{number:function(i){return i>0},BigNumber:function(i){return!i.isNeg()&&!i.isZero()&&!i.isNaN()},Fraction:function(i){return i.s>0&&i.n>0},Unit:function(i){return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r}var name$101="isPositive",factory_1$111=factory$112,isPositive$1={name:name$101,factory:factory_1$111},nearlyEqual$4=number.nearlyEqual;function factory$113(l,t,e,n){var r=e(matrix),i=e(algorithm03),a=e(algorithm07),s=e(algorithm12),o=e(algorithm13),u=e(algorithm14),c=latex,f=n("unequal",{"any, any":function(d,m){return d===null?m!==null:m===null?d!==null:d===void 0?m!==void 0:m===void 0?d!==void 0:p(d,m)},"SparseMatrix, SparseMatrix":function(d,m){return a(d,m,p)},"SparseMatrix, DenseMatrix":function(d,m){return i(m,d,p,!0)},"DenseMatrix, SparseMatrix":function(d,m){return i(d,m,p,!1)},"DenseMatrix, DenseMatrix":function(d,m){return o(d,m,p)},"Array, Array":function(d,m){return f(r(d),r(m)).valueOf()},"Array, Matrix":function(d,m){return f(r(d),m)},"Matrix, Array":function(d,m){return f(d,r(m))},"SparseMatrix, any":function(d,m){return s(d,m,p,!1)},"DenseMatrix, any":function(d,m){return u(d,m,p,!1)},"any, SparseMatrix":function(d,m){return s(m,d,p,!0)},"any, DenseMatrix":function(d,m){return u(m,d,p,!0)},"Array, any":function(d,m){return u(r(d),m,p,!1).valueOf()},"any, Array":function(d,m){return u(r(m),d,p,!0).valueOf()}}),p=n("_unequal",{"boolean, boolean":function(d,m){return d!==m},"number, number":function(d,m){return!nearlyEqual$4(d,m,t.epsilon)},"BigNumber, BigNumber":function(d,m){return!nearlyEqual(d,m,t.epsilon)},"Fraction, Fraction":function(d,m){return!d.equals(m)},"Complex, Complex":function(d,m){return!d.equals(m)},"Unit, Unit":function(d,m){if(!d.equalBase(m))throw new Error("Cannot compare units with different base");return f(d.value,m.value)}});return f.toTex={2:"\\left(${args[0]}"+c.operators.unequal+"${args[1]}\\right)"},f}var name$102="unequal",factory_1$112=factory$113,unequal$1={name:name$102,factory:factory_1$112};function factory$114(l,t,e,n){var r=n("sign",{number:number.sign,Complex:function(i){return i.sign()},BigNumber:function(i){return new l.BigNumber(i.cmp(0))},Fraction:function(i){return new l.Fraction(i.s,1)},"Array | Matrix":function(i){return deepMap(i,r,!0)},Unit:function(i){return r(i.value)}});return r.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},r}var name$103="sign",factory_1$113=factory$114,sign$1={name:name$103,factory:factory_1$113};function factory$115(l,t,e,n){var r=n("sqrt",{number:i,Complex:function(a){return a.sqrt()},BigNumber:function(a){return!a.isNegative()||t.predictable?a.sqrt():i(a.toNumber())},"Array | Matrix":function(a){return deepMap(a,r,!0)},Unit:function(a){return a.pow(.5)}});function i(a){return a>=0||t.predictable?Math.sqrt(a):new l.Complex(a,0).sqrt()}return r.toTex={1:"\\sqrt{${args[0]}}"},r}var name$104="sqrt",factory_1$114=factory$115,sqrt$1={name:name$104,factory:factory_1$114};function factory$116(l,t,e,n){var r=n("conj",{number:function(i){return i},BigNumber:function(i){return i},Complex:function(i){return i.conjugate()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\left(${args[0]}\\right)^*"},r}var name$105="conj",factory_1$115=factory$116,conj$1={name:name$105,factory:factory_1$115};function factory$117(l,t,e,n){var r=e(matrix),i=e(zeros$1),a=e(eye$1),s=e(clone$5),o=e(isZero$1),u=e(isPositive$1),c=e(unequal$1),f=e(abs$1),p=e(sign$1),d=e(sqrt$1),m=e(conj$1),v=e(unaryMinus$1),h=e(addScalar),y=e(divideScalar),g=e(multiplyScalar),b=e(subtract$1),x=n("qr",{DenseMatrix:function(_){return N(_)},SparseMatrix:function(_){return C(_)},Array:function(_){var w=r(_),A=N(w);return{Q:A.Q.valueOf(),R:A.R.valueOf()}}}),N=function(_){var w=_._size[0],A=_._size[1],$=a([w],"dense"),S=$._data,D=_.clone(),V=D._data,I,q,K,E=i([w],"");for(K=0;K<Math.min(A,w);++K){var W=V[K][K],G=v(p(W)),P=m(G),Q=0;for(I=K;I<w;I++)Q=h(Q,g(V[I][K],m(V[I][K])));var ne=g(G,d(Q));if(!o(ne)){var Y=b(W,ne);for(E[K]=1,I=K+1;I<w;I++)E[I]=y(V[I][K],Y);var se=v(m(y(Y,ne))),pe;for(q=K;q<A;q++){for(pe=0,I=K;I<w;I++)pe=h(pe,g(m(E[I]),V[I][q]));for(pe=g(pe,se),I=K;I<w;I++)V[I][q]=g(b(V[I][q],g(E[I],pe)),P)}for(I=0;I<w;I++){for(pe=0,q=K;q<w;q++)pe=h(pe,g(S[I][q],E[q]));for(pe=g(pe,se),q=K;q<w;++q)S[I][q]=y(b(S[I][q],g(pe,m(E[q]))),P)}}}for(I=0;I<w;++I)for(q=0;q<I&&q<A;++q){if(c(0,y(V[I][q],1e5)))throw new Error("math.qr(): unknown error - R is not lower triangular (element ("+I+", "+q+")  = "+V[I][q]+")");V[I][q]=g(V[I][q],0)}return{Q:$,R:D,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}},C=function(_){throw new Error("qr not implemented for sparse matrices yet")};return x}var name$106="qr",factory_1$116=factory$117,qr$1={name:name$106,factory:factory_1$116};function factory$118(){var l=function(t){return-t-2};return l}var name$107="cs_flip",path$46="sparse",factory_1$117=factory$118,cs_flip={name:name$107,path:path$46,factory:factory_1$117};function factory$119(){var l=function(t,e,n){for(var r=t._values,i=t._index,a=t._ptr,s=t._size,o=s[1],u=0,c=0;c<o;c++){var f=a[c];for(a[c]=u;f<a[c+1];f++)e(i[f],c,r?r[f]:1,n)&&(i[u]=i[f],r&&(r[u]=r[f]),u++)}return a[o]=u,i.splice(u,i.length-u),r&&r.splice(u,r.length-u),u};return l}var name$108="cs_fkeep",path$47="sparse",factory_1$118=factory$119,cs_fkeep={name:name$108,path:path$47,factory:factory_1$118};function factory$120(){var l=function(t,e,n,r,i,a,s){var o=0;for(n[s]=t;o>=0;){var u=n[s+o],c=n[r+u];c==-1?(o--,a[e++]=u):(n[r+u]=n[i+c],++o,n[s+o]=c)}return e};return l}var name$109="cs_tdfs",path$48="sparse",factory_1$119=factory$120,cs_tdfs={name:name$109,path:path$48,factory:factory_1$119},clone$6=object.clone,format$4=string.format;function factory$121(l,t,e,n){var r=latex,i=e(matrix),a=l.DenseMatrix,s=l.SparseMatrix,o=n("transpose",{Array:function(f){return o(i(f)).valueOf()},Matrix:function(f){var p=f.size(),d;switch(p.length){case 1:d=f.clone();break;case 2:var m=p[0],v=p[1];if(v===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+format$4(p)+")");switch(f.storage()){case"dense":d=u(f,m,v);break;case"sparse":d=c(f,m,v);break}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+format$4(this._size)+")")}return d},any:function(f){return clone$6(f)}}),u=function(f,p,d){for(var m=f._data,v=[],h,y=0;y<d;y++){h=v[y]=[];for(var g=0;g<p;g++)h[g]=clone$6(m[g][y])}return new a({data:v,size:[d,p],datatype:f._datatype})},c=function(f,p,d){for(var m=f._values,v=f._index,h=f._ptr,y=m?[]:void 0,g=[],b=[],x=[],N=0;N<p;N++)x[N]=0;var C,_,w;for(C=0,_=v.length;C<_;C++)x[v[C]]++;for(var A=0,$=0;$<p;$++)b.push(A),A+=x[$],x[$]=b[$];for(b.push(A),w=0;w<d;w++)for(var S=h[w],D=h[w+1],V=S;V<D;V++){var I=x[v[V]]++;g[I]=w,m&&(y[I]=clone$6(m[V]))}return new s({values:y,index:g,ptr:b,size:[d,p],datatype:f._datatype})};return o.toTex={1:"\\left(${args[0]}\\right)"+r.operators.transpose},o}var name$110="transpose",factory_1$120=factory$121,transpose$1={name:name$110,factory:factory_1$120};function factory$122(l,t,e){var n=e(cs_flip),r=e(cs_fkeep),i=e(cs_tdfs),a=e(add),s=e(multiply$1),o=e(transpose$1),u=function(v,h){if(!h||v<=0||v>3)return null;var y=h._size,g=y[0],b=y[1],x=0,N=Math.max(16,10*Math.sqrt(b));N=Math.min(b-2,N);var C=c(v,h,g,b,N);r(C,m,null);for(var _=C._index,w=C._ptr,A=w[b],$=[],S=[],D=0,V=b+1,I=2*(b+1),q=3*(b+1),K=4*(b+1),E=5*(b+1),W=6*(b+1),G=7*(b+1),P=$,Q=f(b,w,S,D,q,P,I,G,V,W,K,E),ne=p(b,w,S,E,K,W,N,V,q,P,I),Y=0,se,pe,oe,ve,O,z,Z,J,R,F,X,te,de,he,H,re;ne<b;){for(oe=-1;Y<b&&(oe=S[q+Y])==-1;Y++);S[I+oe]!=-1&&(P[S[I+oe]]=-1),S[q+Y]=S[I+oe];var ce=S[K+oe],ue=S[V+oe];ne+=ue;var Ce=0;S[V+oe]=-ue;var Ne=w[oe],Te=ce===0?Ne:A,$e=Te;for(ve=1;ve<=ce+1;ve++){for(ve>ce?(z=oe,Z=Ne,J=S[D+oe]-ce):(z=_[Ne++],Z=w[z],J=S[D+z]),O=1;O<=J;O++)se=_[Z++],!((R=S[V+se])<=0)&&(Ce+=R,S[V+se]=-R,_[$e++]=se,S[I+se]!=-1&&(P[S[I+se]]=P[se]),P[se]!=-1?S[I+P[se]]=S[I+se]:S[q+S[E+se]]=S[I+se]);z!=oe&&(w[z]=n(oe),S[W+z]=0)}for(ce!==0&&(A=$e),S[E+oe]=Ce,w[oe]=Te,S[D+oe]=$e-Te,S[K+oe]=-2,Q=d(Q,x,S,W,b),F=Te;F<$e;F++)if(se=_[F],!((X=S[K+se])<=0)){R=-S[V+se];var Ae=Q-R;for(Ne=w[se],te=w[se]+X-1;Ne<=te;Ne++)z=_[Ne],S[W+z]>=Q?S[W+z]-=R:S[W+z]!==0&&(S[W+z]=S[E+z]+Ae)}for(F=Te;F<$e;F++){for(se=_[F],te=w[se],de=te+S[K+se]-1,he=te,H=0,re=0,Ne=te;Ne<=de;Ne++)if(z=_[Ne],S[W+z]!==0){var Ve=S[W+z]-Q;Ve>0?(re+=Ve,_[he++]=z,H+=z):(w[z]=n(oe),S[W+z]=0)}S[K+se]=he-te+1;var Qe=he,Je=te+S[D+se];for(Ne=de+1;Ne<Je;Ne++){pe=_[Ne];var at=S[V+pe];at<=0||(re+=at,_[he++]=pe,H+=pe)}re===0?(w[se]=n(oe),R=-S[V+se],Ce-=R,ue+=R,ne+=R,S[V+se]=0,S[K+se]=-1):(S[E+se]=Math.min(S[E+se],re),_[he]=_[Qe],_[Qe]=_[te],_[te]=oe,S[D+se]=he-te+1,H=(H<0?-H:H)%b,S[I+se]=S[G+H],S[G+H]=se,P[se]=H)}for(S[E+oe]=Ce,x=Math.max(x,Ce),Q=d(Q+x,x,S,W,b),F=Te;F<$e;F++)if(se=_[F],!(S[V+se]>=0))for(H=P[se],se=S[G+H],S[G+H]=-1;se!=-1&&S[I+se]!=-1;se=S[I+se],Q++){for(J=S[D+se],X=S[K+se],Ne=w[se]+1;Ne<=w[se]+J-1;Ne++)S[W+_[Ne]]=Q;var Mt=se;for(pe=S[I+se];pe!=-1;){var cr=S[D+pe]===J&&S[K+pe]===X;for(Ne=w[pe]+1;cr&&Ne<=w[pe]+J-1;Ne++)S[W+_[Ne]]!=Q&&(cr=0);cr?(w[pe]=n(se),S[V+se]+=S[V+pe],S[V+pe]=0,S[K+pe]=-1,pe=S[I+pe],S[I+Mt]=pe):(Mt=pe,pe=S[I+pe])}}for(Ne=Te,F=Te;F<$e;F++)se=_[F],!((R=-S[V+se])<=0)&&(S[V+se]=R,re=S[E+se]+Ce-R,re=Math.min(re,b-ne-R),S[q+re]!=-1&&(P[S[q+re]]=se),S[I+se]=S[q+re],P[se]=-1,S[q+re]=se,Y=Math.min(Y,re),S[E+se]=re,_[Ne++]=se);S[V+oe]=ue,(S[D+oe]=Ne-Te)==0&&(w[oe]=-1,S[W+oe]=0),ce!==0&&(A=Ne)}for(se=0;se<b;se++)w[se]=n(w[se]);for(pe=0;pe<=b;pe++)S[q+pe]=-1;for(pe=b;pe>=0;pe--)S[V+pe]>0||(S[I+pe]=S[q+w[pe]],S[q+w[pe]]=pe);for(z=b;z>=0;z--)S[V+z]<=0||w[z]!=-1&&(S[I+z]=S[q+w[z]],S[q+w[z]]=z);for(oe=0,se=0;se<=b;se++)w[se]==-1&&(oe=i(se,oe,S,q,I,$,W));return $.splice($.length-1,1),$},c=function(v,h,y,g,b){var x=o(h);if(v===1&&g===y)return a(h,x);if(v==2){for(var N=x._index,C=x._ptr,_=0,w=0;w<y;w++){var A=C[w];if(C[w]=_,!(C[w+1]-A>b))for(var $=C[w+1];A<$;A++)N[_++]=N[A]}return C[y]=_,h=o(x),s(x,h)}return s(x,h)},f=function(v,h,y,g,b,x,N,C,_,w,A,$){for(var S=0;S<v;S++)y[g+S]=h[S+1]-h[S];y[g+v]=0;for(var D=0;D<=v;D++)y[b+D]=-1,x[D]=-1,y[N+D]=-1,y[C+D]=-1,y[_+D]=1,y[w+D]=1,y[A+D]=0,y[$+D]=y[g+D];var V=d(0,0,y,w,v);return y[A+v]=-2,h[v]=-1,y[w+v]=0,V},p=function(v,h,y,g,b,x,N,C,_,w,A){for(var $=0,S=0;S<v;S++){var D=y[g+S];if(D===0)y[b+S]=-2,$++,h[S]=-1,y[x+S]=0;else if(D>N)y[C+S]=0,y[b+S]=-1,$++,h[S]=n(v),y[C+v]++;else{var V=y[_+D];V!=-1&&(w[V]=S),y[A+S]=y[_+D],y[_+D]=S}}return $},d=function(v,h,y,g,b){if(v<2||v+h<0){for(var x=0;x<b;x++)y[g+x]!==0&&(y[g+x]=1);v=2}return v},m=function(v,h){return v!=h};return u}var name$111="cs_amd",path$49="sparse",factory_1$121=factory$122,cs_amd={name:name$111,path:path$49,factory:factory_1$121};function factory$123(l){var t=l.SparseMatrix,e=function(n,r,i,a){for(var s=n._values,o=n._index,u=n._ptr,c=n._size,f=n._datatype,p=c[0],d=c[1],m=a&&n._values?[]:null,v=[],h=[],y=0,g=0;g<d;g++){h[g]=y;for(var b=i?i[g]:g,x=u[b],N=u[b+1],C=x;C<N;C++){var _=r?r[o[C]]:o[C];v[y]=_,m&&(m[y]=s[C]),y++}}return h[d]=y,new t({values:m,index:v,ptr:h,size:[p,d],datatype:f})};return e}var name$112="cs_permute",path$50="sparse",factory_1$122=factory$123,cs_permute={name:name$112,path:path$50,factory:factory_1$122};function factory$124(){var l=function(t,e){if(!t)return null;var n=t._index,r=t._ptr,i=t._size,a=i[0],s=i[1],o=[],u=[],c=0,f=s,p,d;if(e)for(p=0;p<a;p++)u[f+p]=-1;for(var m=0;m<s;m++){o[m]=-1,u[c+m]=-1;for(var v=r[m],h=r[m+1],y=v;y<h;y++){var g=n[y];for(p=e?u[f+g]:g;p!=-1&&p<m;p=d)d=u[c+p],u[c+p]=m,d==-1&&(o[p]=m);e&&(u[f+g]=m)}}return o};return l}var name$113="cs_etree",path$51="sparse",factory_1$123=factory$124,cs_etree={name:name$113,path:path$51,factory:factory_1$123};function factory$125(l,t,e){var n=e(cs_tdfs),r=function(i,a){if(!i)return null;var s=0,o,u=[],c=[],f=0,p=a,d=2*a;for(o=0;o<a;o++)c[f+o]=-1;for(o=a-1;o>=0;o--)i[o]!=-1&&(c[p+o]=c[f+i[o]],c[f+i[o]]=o);for(o=0;o<a;o++)i[o]==-1&&(s=n(o,s,c,f,p,u,d));return u};return r}var name$114="cs_post",path$52="sparse",factory_1$124=factory$125,cs_post={name:name$114,path:path$52,factory:factory_1$124};function factory$126(){var l=function(t,e,n,r,i,a,s){var o,u,c,f=0,p;if(t<=e||n[r+e]<=n[i+t])return-1;if(n[i+t]=n[r+e],c=n[a+t],n[a+t]=e,c===-1)f=1,p=t;else{for(f=2,p=c;p!=n[s+p];p=n[s+p]);for(o=c;o!=p;o=u)u=n[s+o],n[s+o]=p}return{jleaf:f,q:p}};return l}var name$115="cs_leaf",path$53="sparse",factory_1$125=factory$126,cs_leaf={name:name$115,path:path$53,factory:factory_1$125};function factory$127(l,t,e){var n=e(transpose$1),r=e(cs_leaf),i=function(a,s,o,u){if(!a||!s||!o)return null;var c=a._size,f=c[0],p=c[1],d,m,v,h,y,g,b,x=4*p+(u?p+f+1:0),N=[],C=0,_=p,w=2*p,A=3*p,$=4*p,S=5*p+1;for(v=0;v<x;v++)N[v]=-1;var D=[],V=n(a),I=V._index,q=V._ptr;for(v=0;v<p;v++)for(m=o[v],D[m]=N[A+m]==-1?1:0;m!=-1&&N[A+m]==-1;m=s[m])N[A+m]=v;if(u){for(v=0;v<p;v++)N[o[v]]=v;for(d=0;d<f;d++){for(v=p,g=q[d],b=q[d+1],y=g;y<b;y++)v=Math.min(v,N[I[y]]);N[S+d]=N[$+v],N[$+v]=d}}for(d=0;d<p;d++)N[C+d]=d;for(v=0;v<p;v++){for(m=o[v],s[m]!=-1&&D[s[m]]--,h=u?N[$+v]:m;h!=-1;h=u?N[S+h]:-1)for(y=q[h];y<q[h+1];y++){d=I[y];var K=r(d,m,N,A,_,w,C);K.jleaf>=1&&D[m]++,K.jleaf==2&&D[K.q]--}s[m]!=-1&&(N[C+m]=s[m])}for(m=0;m<p;m++)s[m]!=-1&&(D[s[m]]+=D[m]);return D};return i}var name$116="cs_counts",path$54="sparse",factory_1$126=factory$127,cs_counts={name:name$116,path:path$54,factory:factory_1$126};function factory$128(l,t,e){var n=e(cs_amd),r=e(cs_permute),i=e(cs_etree),a=e(cs_post),s=e(cs_counts),o=function(c,f,p){var d=f._ptr,m=f._size,v=m[1],h,y={};if(y.q=n(c,f),c&&!y.q)return null;if(p){var g=c?r(f,null,y.q,0):f;y.parent=i(g,1);var b=a(y.parent,v);if(y.cp=s(g,y.parent,b,1),g&&y.parent&&y.cp&&u(g,y))for(y.unz=0,h=0;h<v;h++)y.unz+=y.cp[h]}else y.unz=4*d[v]+v,y.lnz=y.unz;return y},u=function(c,f){var p=c._ptr,d=c._index,m=c._size,v=m[0],h=m[1];f.pinv=[],f.leftmost=[];var y=f.parent,g=f.pinv,b=f.leftmost,x=[],N=0,C=v,_=v+h,w=v+2*h,A,$,S,D,V;for($=0;$<h;$++)x[C+$]=-1,x[_+$]=-1,x[w+$]=0;for(A=0;A<v;A++)b[A]=-1;for($=h-1;$>=0;$--)for(D=p[$],V=p[$+1],S=D;S<V;S++)b[d[S]]=$;for(A=v-1;A>=0;A--)g[A]=-1,$=b[A],$!=-1&&(x[w+$]++==0&&(x[_+$]=A),x[N+A]=x[C+$],x[C+$]=A);for(f.lnz=0,f.m2=v,$=0;$<h;$++)if(A=x[C+$],f.lnz++,A<0&&(A=f.m2++),g[A]=$,!(--w[$]<=0)){f.lnz+=x[w+$];var I=y[$];I!=-1&&(x[w+I]===0&&(x[_+I]=x[_+$]),x[N+x[_+$]]=x[C+I],x[C+I]=x[N+A],x[w+I]+=x[w+$])}for(A=0;A<v;A++)g[A]<0&&(g[A]=$++);return!0};return o}var name$117="cs_sqr",path$55="sparse",factory_1$127=factory$128,cs_sqr={name:name$117,path:path$55,factory:factory_1$127},nearlyEqual$5=number.nearlyEqual;function factory$129(l,t,e,n){var r=e(matrix),i=e(algorithm03),a=e(algorithm07),s=e(algorithm12),o=e(algorithm13),u=e(algorithm14),c=latex,f=n("largerEq",{"boolean, boolean":function(p,d){return p>=d},"number, number":function(p,d){return p>=d||nearlyEqual$5(p,d,t.epsilon)},"BigNumber, BigNumber":function(p,d){return p.gte(d)||nearlyEqual(p,d,t.epsilon)},"Fraction, Fraction":function(p,d){return p.compare(d)!==-1},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(p,d){if(!p.equalBase(d))throw new Error("Cannot compare units with different base");return f(p.value,d.value)},"SparseMatrix, SparseMatrix":function(p,d){return a(p,d,f)},"SparseMatrix, DenseMatrix":function(p,d){return i(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return i(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return o(p,d,f)},"Array, Array":function(p,d){return f(r(p),r(d)).valueOf()},"Array, Matrix":function(p,d){return f(r(p),d)},"Matrix, Array":function(p,d){return f(p,r(d))},"SparseMatrix, any":function(p,d){return s(p,d,f,!1)},"DenseMatrix, any":function(p,d){return u(p,d,f,!1)},"any, SparseMatrix":function(p,d){return s(d,p,f,!0)},"any, DenseMatrix":function(p,d){return u(d,p,f,!0)},"Array, any":function(p,d){return u(r(p),d,f,!1).valueOf()},"any, Array":function(p,d){return u(r(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+c.operators.largerEq+"${args[1]}\\right)"},f}var name$118="largerEq",factory_1$128=factory$129,largerEq$1={name:name$118,factory:factory_1$128};function factory$130(){var l=function(t,e){return t[e]<0};return l}var name$119="cs_marked",path$56="sparse",factory_1$129=factory$130,cs_marked={name:name$119,path:path$56,factory:factory_1$129};function factory$131(l,t,e){var n=e(cs_flip),r=function(i,a){i[a]=n(i[a])};return r}var name$120="cs_mark",path$57="sparse",factory_1$130=factory$131,cs_mark={name:name$120,path:path$57,factory:factory_1$130};function factory$132(l,t,e){var n=e(cs_flip),r=function(i){return i<0?n(i):i};return r}var name$121="cs_unflip",path$58="sparse",factory_1$131=factory$132,cs_unflip={name:name$121,path:path$58,factory:factory_1$131};function factory$133(l,t,e){var n=e(cs_marked),r=e(cs_mark),i=e(cs_unflip),a=function(s,o,u,c,f){var p=o._index,d=o._ptr,m=o._size,v=m[1],h,y,g,b=0;for(c[0]=s;b>=0;){s=c[b];var x=f?f[s]:s;n(d,s)||(r(d,s),c[v+b]=x<0?0:i(d[x]));var N=1;for(y=c[v+b],g=x<0?0:i(d[x+1]);y<g;y++)if(h=p[y],!n(d,h)){c[v+b]=y,c[++b]=h,N=0;break}N&&(b--,c[--u]=s)}return u};return a}var name$122="cs_dfs",path$59="sparse",factory_1$132=factory$133,cs_dfs={name:name$122,path:path$59,factory:factory_1$132};function factory$134(l,t,e){var n=e(cs_dfs),r=e(cs_marked),i=e(cs_mark),a=function(s,o,u,c,f){var p=s._ptr,d=s._size,m=o._index,v=o._ptr,h=d[1],y,g,b,x=h;for(g=v[u],b=v[u+1],y=g;y<b;y++){var N=m[y];r(p,N)||(x=n(N,s,x,c,f))}for(y=x;y<h;y++)i(p,c[y]);return x};return a}var name$123="cs_reach",path$60="sparse",factory_1$133=factory$134,cs_reach={name:name$123,path:path$60,factory:factory_1$133};function factory$135(l,t,e){var n=e(divideScalar),r=e(multiply$1),i=e(subtract$1),a=e(cs_reach),s=function(o,u,c,f,p,d,m){var v=o._values,h=o._index,y=o._ptr,g=o._size,b=g[1],x=u._values,N=u._index,C=u._ptr,_,w,A,$,S=a(o,u,c,f,d);for(_=S;_<b;_++)p[f[_]]=0;for(w=C[c],A=C[c+1],_=w;_<A;_++)p[N[_]]=x[_];for(var D=S;D<b;D++){var V=f[D],I=d?d[V]:V;if(!(I<0))for(w=y[I],A=y[I+1],p[V]=n(p[V],v[m?w:A-1]),_=m?w+1:w,$=m?A:A-1;_<$;_++){var q=h[_];p[q]=i(p[q],r(v[_],p[V]))}}return S};return s}var name$124="cs_spsolve",path$61="sparse",factory_1$134=factory$135,cs_spsolve={name:name$124,path:path$61,factory:factory_1$134};function factory$136(l,t,e){var n=e(abs$1),r=e(divideScalar),i=e(multiply$1),a=e(larger),s=e(largerEq$1),o=e(cs_spsolve),u=l.SparseMatrix,c=function(f,p,d){if(!f)return null;var m=f._size,v=m[1],h,y=100,g=100;p&&(h=p.q,y=p.lnz||y,g=p.unz||g);var b=[],x=[],N=[],C=new u({values:b,index:x,ptr:N,size:[v,v]}),_=[],w=[],A=[],$=new u({values:_,index:w,ptr:A,size:[v,v]}),S=[],D,V,I=[],q=[];for(D=0;D<v;D++)I[D]=0,S[D]=-1,N[D+1]=0;y=0,g=0;for(var K=0;K<v;K++){N[K]=y,A[K]=g;var E=h?h[K]:K,W=o(C,f,E,q,I,S,1),G=-1,P=-1;for(V=W;V<v;V++)if(D=q[V],S[D]<0){var Q=n(I[D]);a(Q,P)&&(P=Q,G=D)}else w[g]=S[D],_[g++]=I[D];if(G==-1||P<=0)return null;S[E]<0&&s(n(I[E]),i(P,d))&&(G=E);var ne=I[G];for(w[g]=K,_[g++]=ne,S[G]=K,x[y]=G,b[y++]=1,V=W;V<v;V++)D=q[V],S[D]<0&&(x[y]=D,b[y++]=r(I[D],ne)),I[D]=0}for(N[v]=y,A[v]=g,V=0;V<y;V++)x[V]=S[x[V]];return b.splice(y,b.length-y),x.splice(y,x.length-y),_.splice(g,_.length-g),w.splice(g,w.length-g),{L:C,U:$,pinv:S}};return c}var name$125="cs_lu",path$62="sparse",factory_1$135=factory$136,cs_lu={name:name$125,path:path$62,factory:factory_1$135},number$5=utils.number,isInteger$8=number$5.isInteger;function factory$137(l,t,e,n){var r=e(cs_sqr),i=e(cs_lu),a=n("slu",{"SparseMatrix, number, number":function(s,o,u){if(!isInteger$8(o)||o<0||o>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(u<0||u>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var c=r(o,s,!1),f=i(s,c,u);return{L:f.L,U:f.U,p:f.pinv,q:c.q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
p: `+this.p.toString()+(this.q?`
q: `+this.q.toString():"")+`
`}}}});return a}var name$126="slu",factory_1$136=factory$137,slu$1={name:name$126,factory:factory_1$136},string$9=utils.string,array$3=utils.array,isArray$3=Array.isArray;function factory$138(l){var t=l.DenseMatrix,e=function(n,r,i){var a=n.size();if(a.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+string$9.format(a)+")");var s=a[0],o=a[1];if(s!==o)throw new RangeError("Matrix must be square (size: "+string$9.format(a)+")");var u,c,f;if(l.isMatrix(r)){var p=r.size();if(p.length===1){if(p[0]!==s)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(u=[],f=r._data,c=0;c<s;c++)u[c]=[f[c]];return new t({data:u,size:[s,1],datatype:r._datatype})}if(p.length===2){if(p[0]!==s||p[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(l.isDenseMatrix(r)){if(i){for(u=[],f=r._data,c=0;c<s;c++)u[c]=[f[c][0]];return new t({data:u,size:[s,1],datatype:r._datatype})}return r}for(u=[],c=0;c<s;c++)u[c]=[0];for(var d=r._values,m=r._index,v=r._ptr,h=v[1],y=v[0];y<h;y++)c=m[y],u[c][0]=d[y];return new t({data:u,size:[s,1],datatype:r._datatype})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}if(isArray$3(r)){var g=array$3.size(r);if(g.length===1){if(g[0]!==s)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(u=[],c=0;c<s;c++)u[c]=[r[c]];return new t({data:u,size:[s,1]})}if(g.length===2){if(g[0]!==s||g[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(u=[],c=0;c<s;c++)u[c]=[r[c][0]];return new t({data:u,size:[s,1]})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}};return e}var factory_1$137=factory$138,solveValidation={factory:factory_1$137};function factory$139(l,t,e,n){var r=e(matrix),i=e(divideScalar),a=e(multiplyScalar),s=e(subtract$1),o=e(equalScalar),u=e(solveValidation),c=l.DenseMatrix,f=n("lsolve",{"SparseMatrix, Array | Matrix":function(m,v){return d(m,v)},"DenseMatrix, Array | Matrix":function(m,v){return p(m,v)},"Array, Array | Matrix":function(m,v){var h=r(m),y=p(h,v);return y.valueOf()}}),p=function(m,v){v=u(m,v,!0);for(var h=v._data,y=m._size[0],g=m._size[1],b=[],x=m._data,N=0;N<g;N++){var C=h[N][0]||0,_;if(o(C,0))_=0;else{var w=x[N][N];if(o(w,0))throw new Error("Linear system cannot be solved since matrix is singular");_=i(C,w);for(var A=N+1;A<y;A++)h[A]=[s(h[A][0]||0,a(_,x[A][N]))]}b[N]=[_]}return new c({data:b,size:[y,1]})},d=function(m,v){v=u(m,v,!0);for(var h=v._data,y=m._size[0],g=m._size[1],b=m._values,x=m._index,N=m._ptr,C,_,w=[],A=0;A<g;A++){var $=h[A][0]||0;if(o($,0))w[A]=[0];else{var S=0,D=[],V=[],I=N[A+1];for(_=N[A];_<I;_++)C=x[_],C===A?S=b[_]:C>A&&(D.push(b[_]),V.push(C));if(o(S,0))throw new Error("Linear system cannot be solved since matrix is singular");var q=i($,S);for(_=0,I=V.length;_<I;_++)C=V[_],h[C]=[s(h[C][0]||0,a(q,D[_]))];w[A]=[q]}}return new c({data:w,size:[y,1]})};return f}var name$127="lsolve",factory_1$138=factory$139,lsolve$1={name:name$127,factory:factory_1$138};function factory$140(){var l=function(t,e,n){var r,n=e.length,i=[];if(t)for(r=0;r<n;r++)i[t[r]]=e[r];else for(r=0;r<n;r++)i[r]=e[r];return i};return l}var name$128="cs_ipvec",path$63="sparse",factory_1$139=factory$140,cs_ipvec={name:name$128,path:path$63,factory:factory_1$139};function factory$141(l,t,e,n){var r=e(matrix),i=e(divideScalar),a=e(multiplyScalar),s=e(subtract$1),o=e(equalScalar),u=e(solveValidation),c=l.DenseMatrix,f=n("usolve",{"SparseMatrix, Array | Matrix":function(m,v){return d(m,v)},"DenseMatrix, Array | Matrix":function(m,v){return p(m,v)},"Array, Array | Matrix":function(m,v){var h=r(m),y=p(h,v);return y.valueOf()}}),p=function(m,v){v=u(m,v,!0);for(var h=v._data,y=m._size[0],g=m._size[1],b=[],x=m._data,N=g-1;N>=0;N--){var C=h[N][0]||0,_;if(o(C,0))_=0;else{var w=x[N][N];if(o(w,0))throw new Error("Linear system cannot be solved since matrix is singular");_=i(C,w);for(var A=N-1;A>=0;A--)h[A]=[s(h[A][0]||0,a(_,x[A][N]))]}b[N]=[_]}return new c({data:b,size:[y,1]})},d=function(m,v){v=u(m,v,!0);for(var h=v._data,y=m._size[0],g=m._size[1],b=m._values,x=m._index,N=m._ptr,C,_,w=[],A=g-1;A>=0;A--){var $=h[A][0]||0;if(o($,0))w[A]=[0];else{var S=0,D=[],V=[],I=N[A],q=N[A+1];for(_=q-1;_>=I;_--)C=x[_],C===A?S=b[_]:C<A&&(D.push(b[_]),V.push(C));if(o(S,0))throw new Error("Linear system cannot be solved since matrix is singular");var K=i($,S);for(_=0,q=V.length;_<q;_++)C=V[_],h[C]=[s(h[C][0],a(K,D[_]))];w[A]=[K]}}return new c({data:w,size:[y,1]})};return f}var name$129="usolve",factory_1$140=factory$141,usolve$1={name:name$129,factory:factory_1$140},isArray$4=Array.isArray;function factory$142(l,t,e,n){var r=e(matrix),i=e(lup$1),a=e(slu$1),s=e(cs_ipvec),o=e(solveValidation),u=e(usolve$1),c=e(lsolve$1),f=n("lusolve",{"Array, Array | Matrix":function(m,v){m=r(m);var h=i(m),y=d(h.L,h.U,h.p,null,v);return y.valueOf()},"DenseMatrix, Array | Matrix":function(m,v){var h=i(m);return d(h.L,h.U,h.p,null,v)},"SparseMatrix, Array | Matrix":function(m,v){var h=i(m);return d(h.L,h.U,h.p,null,v)},"SparseMatrix, Array | Matrix, number, number":function(m,v,h,y){var g=a(m,h,y);return d(g.L,g.U,g.p,g.q,v)},"Object, Array | Matrix":function(m,v){return d(m.L,m.U,m.p,m.q,v)}}),p=function(m){if(l.isMatrix(m))return m;if(isArray$4(m))return r(m);throw new TypeError("Invalid Matrix LU decomposition")},d=function(m,v,h,y,g){m=p(m),v=p(v),g=o(m,g,!1),h&&(g._data=s(h,g._data));var b=c(m,g),x=u(v,b);return y&&(x._data=s(y,x._data)),x};return f}var name$130="lusolve",factory_1$141=factory$142,lusolve$1={name:name$130,factory:factory_1$141},algebra=[derivative$1,simplify$1,rationalize$1,qr$1,lup$1,slu$1,lsolve$1,lusolve$1,usolve$1];function factory$143(l,t,e,n){var r=n("isNegative",{number:function(i){return i<0},BigNumber:function(i){return i.isNeg()&&!i.isZero()&&!i.isNaN()},Fraction:function(i){return i.s<0},Unit:function(i){return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r}var name$131="isNegative",factory_1$142=factory$143,isNegative$1={name:name$131,factory:factory_1$142};function factory$144(l,t,e,n){var r=e(unaryMinus$1),i=e(isNegative$1),a=e(matrix),s=n("cbrt",{number:_cbrtNumber,Complex:o,"Complex, boolean":o,BigNumber:function(c){return c.cbrt()},Unit:u,"Array | Matrix":function(c){return deepMap(c,s,!0)}});function o(c,f){var p=c.arg()/3,d=c.abs(),m=new l.Complex(_cbrtNumber(d),0).mul(new l.Complex(0,p).exp());if(f){var v=[m,new l.Complex(_cbrtNumber(d),0).mul(new l.Complex(0,p+Math.PI*2/3).exp()),new l.Complex(_cbrtNumber(d),0).mul(new l.Complex(0,p-Math.PI*2/3).exp())];return t.matrix==="Array"?v:a(v)}else return m}function u(c){if(c.value&&l.isComplex(c.value)){var f=c.clone();return f.value=1,f=f.pow(1/3),f.value=o(c.value),f}else{var p=i(c.value);p&&(c.value=r(c.value));var d;l.isBigNumber(c.value)?d=new l.BigNumber(1).div(3):l.isFraction(c.value)?d=new l.Fraction(1,3):d=1/3;var f=c.pow(d);return p&&(f.value=r(f.value)),f}}return s.toTex={1:"\\sqrt[3]{${args[0]}}"},s}var _cbrtNumber=Math.cbrt||function(l){if(l===0)return l;var t=l<0,e;return t&&(l=-l),isFinite(l)?(e=Math.exp(Math.log(l)/3),e=(l/(e*e)+2*e)/3):e=l,t?-e:e},name$132="cbrt",factory_1$143=factory$144,cbrt$1={name:name$132,factory:factory_1$143};function factory$145(l,t,e,n){var r=n("ceil",{number:Math.ceil,Complex:function(i){return i.ceil()},BigNumber:function(i){return i.ceil()},Fraction:function(i){return i.ceil()},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\left\\lceil${args[0]}\\right\\rceil"},r}var name$133="ceil",factory_1$144=factory$145,ceil$1={name:name$133,factory:factory_1$144};function factory$146(l,t,e,n){var r=n("cube",{number:function(i){return i*i*i},Complex:function(i){return i.mul(i).mul(i)},BigNumber:function(i){return i.times(i).times(i)},Fraction:function(i){return i.pow(3)},"Array | Matrix":function(i){return deepMap(i,r,!0)},Unit:function(i){return i.pow(3)}});return r.toTex={1:"\\left(${args[0]}\\right)^3"},r}var name$134="cube",factory_1$145=factory$146,cube$1={name:name$134,factory:factory_1$145};function factory$147(l,t,e,n){var r=e(equalScalar),i=l.SparseMatrix,a=function(s,o,u,c){var f=s._data,p=s._size,d=s._datatype,m=o._values,v=o._index,h=o._ptr,y=o._size,g=o._datatype;if(p.length!==y.length)throw new DimensionError_1(p.length,y.length);if(p[0]!==y[0]||p[1]!==y[1])throw new RangeError("Dimension mismatch. Matrix A ("+p+") must match Matrix B ("+y+")");if(!m)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var b=p[0],x=p[1],N,C=r,_=0,w=u;typeof d=="string"&&d===g&&(N=d,C=n.find(r,[N,N]),_=n.convert(0,N),w=n.find(u,[N,N]));for(var A=[],$=[],S=[],D=0;D<x;D++){S[D]=$.length;for(var V=h[D],I=h[D+1],q=V;q<I;q++){var K=v[q],E=c?w(m[q],f[K][D]):w(f[K][D],m[q]);C(E,_)||($.push(K),A.push(E))}}return S[x]=$.length,new i({values:A,index:$,ptr:S,size:[b,x],datatype:N})};return a}var name$135="algorithm02",factory_1$146=factory$147,algorithm02={name:name$135,factory:factory_1$146};function factory$148(l,t,e,n){var r=e(matrix),i=e(divideScalar),a=latex,s=e(algorithm02),o=e(algorithm03),u=e(algorithm07),c=e(algorithm11),f=e(algorithm12),p=e(algorithm13),d=e(algorithm14),m=n("dotDivide",{"any, any":i,"SparseMatrix, SparseMatrix":function(v,h){return u(v,h,i,!1)},"SparseMatrix, DenseMatrix":function(v,h){return s(h,v,i,!0)},"DenseMatrix, SparseMatrix":function(v,h){return o(v,h,i,!1)},"DenseMatrix, DenseMatrix":function(v,h){return p(v,h,i)},"Array, Array":function(v,h){return m(r(v),r(h)).valueOf()},"Array, Matrix":function(v,h){return m(r(v),h)},"Matrix, Array":function(v,h){return m(v,r(h))},"SparseMatrix, any":function(v,h){return c(v,h,i,!1)},"DenseMatrix, any":function(v,h){return d(v,h,i,!1)},"any, SparseMatrix":function(v,h){return f(h,v,i,!0)},"any, DenseMatrix":function(v,h){return d(h,v,i,!0)},"Array, any":function(v,h){return d(r(v),h,i,!1).valueOf()},"any, Array":function(v,h){return d(r(h),v,i,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+a.operators.dotDivide+"${args[1]}\\right)"},m}var name$136="dotDivide",factory_1$147=factory$148,dotDivide$1={name:name$136,factory:factory_1$147};function factory$149(l,t,e,n){var r=e(equalScalar),i=l.SparseMatrix,a=function(s,o,u){var c=s._values,f=s._index,p=s._ptr,d=s._size,m=s._datatype,v=o._values,h=o._index,y=o._ptr,g=o._size,b=o._datatype;if(d.length!==g.length)throw new DimensionError_1(d.length,g.length);if(d[0]!==g[0]||d[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+g+")");var x=d[0],N=d[1],C,_=r,w=0,A=u;typeof m=="string"&&m===b&&(C=m,_=n.find(r,[C,C]),w=n.convert(0,C),A=n.find(u,[C,C]));var $=c&&v?[]:void 0,S=[],D=[],V=new i({values:$,index:S,ptr:D,size:[x,N],datatype:C}),I=$?[]:void 0,q=[],K,E,W,G,P;for(E=0;E<N;E++){D[E]=S.length;var Q=E+1;if(I)for(G=y[E],P=y[E+1],W=G;W<P;W++)K=h[W],q[K]=Q,I[K]=v[W];for(G=p[E],P=p[E+1],W=G;W<P;W++)if(K=f[W],I){var ne=q[K]===Q?I[K]:w,Y=A(c[W],ne);_(Y,w)||(S.push(K),$.push(Y))}else S.push(K)}return D[N]=S.length,V};return a}var name$137="algorithm09",factory_1$148=factory$149,algorithm09={name:name$137,factory:factory_1$148};function factory$150(l,t,e,n){var r=e(matrix),i=e(multiplyScalar),a=latex,s=e(algorithm02),o=e(algorithm09),u=e(algorithm11),c=e(algorithm13),f=e(algorithm14),p=n("dotMultiply",{"any, any":i,"SparseMatrix, SparseMatrix":function(d,m){return o(d,m,i,!1)},"SparseMatrix, DenseMatrix":function(d,m){return s(m,d,i,!0)},"DenseMatrix, SparseMatrix":function(d,m){return s(d,m,i,!1)},"DenseMatrix, DenseMatrix":function(d,m){return c(d,m,i)},"Array, Array":function(d,m){return p(r(d),r(m)).valueOf()},"Array, Matrix":function(d,m){return p(r(d),m)},"Matrix, Array":function(d,m){return p(d,r(m))},"SparseMatrix, any":function(d,m){return u(d,m,i,!1)},"DenseMatrix, any":function(d,m){return f(d,m,i,!1)},"any, SparseMatrix":function(d,m){return u(m,d,i,!0)},"any, DenseMatrix":function(d,m){return f(m,d,i,!0)},"Array, any":function(d,m){return f(r(d),m,i,!1).valueOf()},"any, Array":function(d,m){return f(r(m),d,i,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+a.operators.dotMultiply+"${args[1]}\\right)"},p}var name$138="dotMultiply",factory_1$149=factory$150,dotMultiply$1={name:name$138,factory:factory_1$149};function factory$151(l,t,e,n){var r=e(matrix),i=e(pow$1),a=latex,s=e(algorithm03),o=e(algorithm07),u=e(algorithm11),c=e(algorithm12),f=e(algorithm13),p=e(algorithm14),d=n("dotPow",{"any, any":i,"SparseMatrix, SparseMatrix":function(m,v){return o(m,v,i,!1)},"SparseMatrix, DenseMatrix":function(m,v){return s(v,m,i,!0)},"DenseMatrix, SparseMatrix":function(m,v){return s(m,v,i,!1)},"DenseMatrix, DenseMatrix":function(m,v){return f(m,v,i)},"Array, Array":function(m,v){return d(r(m),r(v)).valueOf()},"Array, Matrix":function(m,v){return d(r(m),v)},"Matrix, Array":function(m,v){return d(m,r(v))},"SparseMatrix, any":function(m,v){return u(m,v,d,!1)},"DenseMatrix, any":function(m,v){return p(m,v,d,!1)},"any, SparseMatrix":function(m,v){return c(v,m,d,!0)},"any, DenseMatrix":function(m,v){return p(v,m,d,!0)},"Array, any":function(m,v){return p(r(m),v,d,!1).valueOf()},"any, Array":function(m,v){return p(r(v),m,d,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+a.operators.dotPow+"${args[1]}\\right)"},d}var name$139="dotPow",factory_1$150=factory$151,dotPow$1={name:name$139,factory:factory_1$150};function factory$152(l,t,e,n){var r=n("exp",{number:Math.exp,Complex:function(i){return i.exp()},BigNumber:function(i){return i.exp()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\exp\\left(${args[0]}\\right)"},r}var name$140="exp",factory_1$151=factory$152,exp$1={name:name$140,factory:factory_1$151};function factory$153(l,t,e,n){var r=latex,i=n("expm1",{number:Math.expm1||a,Complex:function(s){var o=Math.exp(s.re);return new l.Complex(o*Math.cos(s.im)-1,o*Math.sin(s.im))},BigNumber:function(s){return s.exp().minus(1)},"Array | Matrix":function(s){return deepMap(s,i)}});function a(s){return s>=2e-4||s<=-2e-4?Math.exp(s)-1:s+s*s/2+s*s*s/6}return i.toTex="\\left(e"+r.operators.pow+"{${args[0]}}-1\\right)",i}var name$141="expm1",factory_1$152=factory$153,expm1$1={name:name$141,factory:factory_1$152};function factory$154(l,t,e,n){var r=n("fix",{number:function(i){return i>0?Math.floor(i):Math.ceil(i)},Complex:function(i){return new l.Complex(i.re>0?Math.floor(i.re):Math.ceil(i.re),i.im>0?Math.floor(i.im):Math.ceil(i.im))},BigNumber:function(i){return i.isNegative()?i.ceil():i.floor()},Fraction:function(i){return i.s<0?i.ceil():i.floor()},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},r}var name$142="fix",factory_1$153=factory$154,fix$1={name:name$142,factory:factory_1$153};function factory$155(l,t,e,n){var r=n("floor",{number:Math.floor,Complex:function(i){return i.floor()},BigNumber:function(i){return i.floor()},Fraction:function(i){return i.floor()},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\left\\lfloor${args[0]}\\right\\rfloor"},r}var name$143="floor",factory_1$154=factory$155,floor$1={name:name$143,factory:factory_1$154},isInteger$9=number.isInteger;function factory$156(l,t,e,n){var r=e(matrix),i=e(algorithm01),a=e(algorithm04),s=e(algorithm10),o=e(algorithm13),u=e(algorithm14),c=n("gcd",{"number, number":_gcd,"BigNumber, BigNumber":f,"Fraction, Fraction":function(p,d){return p.gcd(d)},"SparseMatrix, SparseMatrix":function(p,d){return a(p,d,c)},"SparseMatrix, DenseMatrix":function(p,d){return i(d,p,c,!0)},"DenseMatrix, SparseMatrix":function(p,d){return i(p,d,c,!1)},"DenseMatrix, DenseMatrix":function(p,d){return o(p,d,c)},"Array, Array":function(p,d){return c(r(p),r(d)).valueOf()},"Array, Matrix":function(p,d){return c(r(p),d)},"Matrix, Array":function(p,d){return c(p,r(d))},"SparseMatrix, number | BigNumber":function(p,d){return s(p,d,c,!1)},"DenseMatrix, number | BigNumber":function(p,d){return u(p,d,c,!1)},"number | BigNumber, SparseMatrix":function(p,d){return s(d,p,c,!0)},"number | BigNumber, DenseMatrix":function(p,d){return u(d,p,c,!0)},"Array, number | BigNumber":function(p,d){return u(r(p),d,c,!1).valueOf()},"number | BigNumber, Array":function(p,d){return u(r(d),p,c,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(p,d,m){for(var v=c(p,d),h=0;h<m.length;h++)v=c(v,m[h]);return v}});return c.toTex="\\gcd\\left(${args}\\right)",c;function f(p,d){if(!p.isInt()||!d.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var m=new l.BigNumber(0);!d.isZero();){var v=p.mod(d);p=d,d=v}return p.lt(m)?p.neg():p}}function _gcd(l,t){if(!isInteger$9(l)||!isInteger$9(t))throw new Error("Parameters in function gcd must be integer numbers");for(var e;t!=0;)e=l%t,l=t,t=e;return l<0?-l:l}var name$144="gcd",factory_1$155=factory$156,gcd$1={name:name$144,factory:factory_1$155},flatten$2=array.flatten;function factory$157(l,t,e,n){var r=e(abs$1),i=e(addScalar),a=e(divideScalar),s=e(multiplyScalar),o=e(sqrt$1),u=e(smaller),c=e(isPositive$1),f=n("hypot",{"... number | BigNumber":p,Array:function(d){return f.apply(f,flatten$2(d))},Matrix:function(d){return f.apply(f,flatten$2(d.toArray()))}});function p(d){for(var m=0,v=0,h=0;h<d.length;h++){var y=r(d[h]);u(v,y)?(m=s(m,s(a(v,y),a(v,y))),m=i(m,1),v=y):m=i(m,c(y)?s(a(y,v),a(y,v)):y)}return s(v,o(m))}return f.toTex="\\hypot\\left(${args}\\right)",f}var name$145="hypot",factory_1$156=factory$157,hypot$1={name:name$145,factory:factory_1$156},scatter=function(t,e,n,r,i,a,s,o,u,c,f){var p=t._values,d=t._index,m=t._ptr,v=s._index,h,y,g,b;if(r)for(y=m[e],g=m[e+1],h=y;h<g;h++)b=d[h],n[b]!==a?(n[b]=a,v.push(b),c?(r[b]=u?o(p[h],f):o(f,p[h]),i[b]=a):r[b]=p[h]):(r[b]=u?o(p[h],r[b]):o(r[b],p[h]),i[b]=a);else for(y=m[e],g=m[e+1],h=y;h<g;h++)b=d[h],n[b]!==a?(n[b]=a,v.push(b)):i[b]=a};function factory$158(l,t,e,n){var r=e(equalScalar),i=l.SparseMatrix,a=function(s,o,u){var c=s._values,f=s._size,p=s._datatype,d=o._values,m=o._size,v=o._datatype;if(f.length!==m.length)throw new DimensionError_1(f.length,m.length);if(f[0]!==m[0]||f[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+f+") must match Matrix B ("+m+")");var h=f[0],y=f[1],g,b=r,x=0,N=u;typeof p=="string"&&p===v&&(g=p,b=n.find(r,[g,g]),x=n.convert(0,g),N=n.find(u,[g,g]));for(var C=c&&d?[]:void 0,_=[],w=[],A=new i({values:C,index:_,ptr:w,size:[h,y],datatype:g}),$=C?[]:void 0,S=[],D=[],V=0;V<y;V++){w[V]=_.length;var I=V+1;if(scatter(s,V,S,$,D,I,A,N),scatter(o,V,S,$,D,I,A,N),$)for(var q=w[V];q<_.length;){var K=_[q];if(D[K]===I){var E=$[K];b(E,x)?_.splice(q,1):(C.push(E),q++)}else _.splice(q,1)}else for(var W=w[V];W<_.length;){var G=_[W];D[G]!==I?_.splice(W,1):W++}}return w[y]=_.length,A};return a}var name$146="algorithm06",factory_1$157=factory$158,algorithm06={name:name$146,factory:factory_1$157},isInteger$10=number.isInteger;function factory$159(l,t,e,n){var r=e(matrix),i=e(algorithm02),a=e(algorithm06),s=e(algorithm11),o=e(algorithm13),u=e(algorithm14),c=n("lcm",{"number, number":_lcm,"BigNumber, BigNumber":f,"Fraction, Fraction":function(p,d){return p.lcm(d)},"SparseMatrix, SparseMatrix":function(p,d){return a(p,d,c)},"SparseMatrix, DenseMatrix":function(p,d){return i(d,p,c,!0)},"DenseMatrix, SparseMatrix":function(p,d){return i(p,d,c,!1)},"DenseMatrix, DenseMatrix":function(p,d){return o(p,d,c)},"Array, Array":function(p,d){return c(r(p),r(d)).valueOf()},"Array, Matrix":function(p,d){return c(r(p),d)},"Matrix, Array":function(p,d){return c(p,r(d))},"SparseMatrix, number | BigNumber":function(p,d){return s(p,d,c,!1)},"DenseMatrix, number | BigNumber":function(p,d){return u(p,d,c,!1)},"number | BigNumber, SparseMatrix":function(p,d){return s(d,p,c,!0)},"number | BigNumber, DenseMatrix":function(p,d){return u(d,p,c,!0)},"Array, number | BigNumber":function(p,d){return u(r(p),d,c,!1).valueOf()},"number | BigNumber, Array":function(p,d){return u(r(d),p,c,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(p,d,m){for(var v=c(p,d),h=0;h<m.length;h++)v=c(v,m[h]);return v}});return c.toTex=void 0,c;function f(p,d){if(!p.isInt()||!d.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(p.isZero()||d.isZero())return new l.BigNumber(0);for(var m=p.times(d);!d.isZero();){var v=d;d=p.mod(v),p=v}return m.div(p).abs()}}function _lcm(l,t){if(!isInteger$10(l)||!isInteger$10(t))throw new Error("Parameters in function lcm must be integer numbers");if(l==0||t==0)return 0;for(var e,n=l*t;t!=0;)e=t,t=l%e,l=e;return Math.abs(n/l)}var name$147="lcm",factory_1$158=factory$159,lcm$1={name:name$147,factory:factory_1$158};function factory$160(l,t,e,n){var r=e(divideScalar),i=n("log",{number:function(a){return a>=0||t.predictable?Math.log(a):new l.Complex(a,0).log()},Complex:function(a){return a.log()},BigNumber:function(a){return!a.isNegative()||t.predictable?a.ln():new l.Complex(a.toNumber(),0).log()},"Array | Matrix":function(a){return deepMap(a,i)},"any, any":function(a,s){return r(i(a),i(s))}});return i.toTex={1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},i}var name$148="log",factory_1$159=factory$160,log$1={name:name$148,factory:factory_1$159};function factory$161(l,t,e,n){var r=n("log10",{number:function(i){return i>=0||t.predictable?_log10(i):new l.Complex(i,0).log().div(Math.LN10)},Complex:function(i){return new l.Complex(i).log().div(Math.LN10)},BigNumber:function(i){return!i.isNegative()||t.predictable?i.log():new l.Complex(i.toNumber(),0).log().div(Math.LN10)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\log_{10}\\left(${args[0]}\\right)"},r}var _log10=Math.log10||function(l){return Math.log(l)/Math.LN10},name$149="log10",factory_1$160=factory$161,log10$1={name:name$149,factory:factory_1$160};function factory$162(l,t,e,n){var r=e(divideScalar),i=e(log$1),a=n("log1p",{number:s,Complex:o,BigNumber:function(u){var c=u.plus(1);return!c.isNegative()||t.predictable?c.ln():o(new l.Complex(u.toNumber(),0))},"Array | Matrix":function(u){return deepMap(u,a)},"any, any":function(u,c){return r(a(u),i(c))}});function s(u){return u>=-1||t.predictable?Math.log1p?Math.log1p(u):Math.log(u+1):o(new l.Complex(u,0))}function o(u){var c=u.re+1;return new l.Complex(Math.log(Math.sqrt(c*c+u.im*u.im)),Math.atan2(u.im,c))}return a.toTex={1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},a}var name$150="log1p",factory_1$161=factory$162,log1p$1={name:name$150,factory:factory_1$161};function factory$163(l,t,e,n){var r=n("log2",{number:function(a){return a>=0||t.predictable?Math.log2?Math.log2(a):Math.log(a)/Math.LN2:i(new l.Complex(a,0))},Complex:i,BigNumber:function(a){return!a.isNegative()||t.predictable?a.log(2):i(new l.Complex(a.toNumber(),0))},"Array | Matrix":function(a){return deepMap(a,r)}});function i(a){var s=Math.sqrt(a.re*a.re+a.im*a.im);return new l.Complex(Math.log2?Math.log2(s):Math.log(s)/Math.LN2,Math.atan2(a.im,a.re)/Math.LN2)}return r.toTex="\\log_{2}\\left(${args[0]}\\right)",r}var name$151="log2",factory_1$162=factory$163,log2$1={name:name$151,factory:factory_1$162};function factory$164(l,t,e,n){var r=e(matrix),i=latex,a=e(algorithm02),s=e(algorithm03),o=e(algorithm05),u=e(algorithm11),c=e(algorithm12),f=e(algorithm13),p=e(algorithm14),d=n("mod",{"number, number":m,"BigNumber, BigNumber":function(v,h){return h.isZero()?v:v.mod(h)},"Fraction, Fraction":function(v,h){return v.mod(h)},"SparseMatrix, SparseMatrix":function(v,h){return o(v,h,d,!1)},"SparseMatrix, DenseMatrix":function(v,h){return a(h,v,d,!0)},"DenseMatrix, SparseMatrix":function(v,h){return s(v,h,d,!1)},"DenseMatrix, DenseMatrix":function(v,h){return f(v,h,d)},"Array, Array":function(v,h){return d(r(v),r(h)).valueOf()},"Array, Matrix":function(v,h){return d(r(v),h)},"Matrix, Array":function(v,h){return d(v,r(h))},"SparseMatrix, any":function(v,h){return u(v,h,d,!1)},"DenseMatrix, any":function(v,h){return p(v,h,d,!1)},"any, SparseMatrix":function(v,h){return c(h,v,d,!0)},"any, DenseMatrix":function(v,h){return p(h,v,d,!0)},"Array, any":function(v,h){return p(r(v),h,d,!1).valueOf()},"any, Array":function(v,h){return p(r(h),v,d,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+i.operators.mod+"${args[1]}\\right)"},d;function m(v,h){if(h>0)return v-h*Math.floor(v/h);if(h===0)return v;throw new Error("Cannot calculate mod for a negative divisor")}}var name$152="mod",factory_1$163=factory$164,mod$1={name:name$152,factory:factory_1$163},clone$7=object.clone,format$5=string.format;function factory$165(l,t,e,n){var r=e(matrix),i=e(add),a=n("trace",{Array:function(c){return s(r(c))},SparseMatrix:o,DenseMatrix:s,any:clone$7});function s(u){var c=u._size,f=u._data;switch(c.length){case 1:if(c[0]===1)return clone$7(f[0]);throw new RangeError("Matrix must be square (size: "+format$5(c)+")");case 2:var p=c[0],d=c[1];if(p===d){for(var m=0,v=0;v<p;v++)m=i(m,f[v][v]);return m}throw new RangeError("Matrix must be square (size: "+format$5(c)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+format$5(c)+")")}}function o(u){var c=u._values,f=u._index,p=u._ptr,d=u._size,m=d[0],v=d[1];if(m===v){var h=0;if(c.length>0)for(var y=0;y<v;y++)for(var g=p[y],b=p[y+1],x=g;x<b;x++){var N=f[x];if(N===y){h=i(h,c[x]);break}if(N>y)break}return h}throw new RangeError("Matrix must be square (size: "+format$5(d)+")")}return a.toTex={1:"\\mathrm{tr}\\left(${args[0]}\\right)"},a}var name$153="trace",factory_1$164=factory$165,trace$1={name:name$153,factory:factory_1$164};function factory$166(l,t,e,n){var r=e(abs$1),i=e(add),a=e(pow$1),s=e(conj$1),o=e(sqrt$1),u=e(multiply$1),c=e(equalScalar),f=e(larger),p=e(smaller),d=e(matrix),m=e(trace$1),v=e(transpose$1),h=n("norm",{number:Math.abs,Complex:function(g){return g.abs()},BigNumber:function(g){return g.abs()},boolean:function(g){return Math.abs(g)},Array:function(g){return y(d(g),2)},Matrix:function(g){return y(g,2)},"number | Complex | BigNumber | boolean, number | BigNumber | string":function(g){return h(g)},"Array, number | BigNumber | string":function(g,b){return y(d(g),b)},"Matrix, number | BigNumber | string":function(g,b){return y(g,b)}});function y(g,b){var x=g.size();if(x.length==1){if(b===Number.POSITIVE_INFINITY||b==="inf"){var N=0;return g.forEach(function(V){var I=r(V);f(I,N)&&(N=I)},!0),N}if(b===Number.NEGATIVE_INFINITY||b==="-inf"){var C;return g.forEach(function(V){var I=r(V);(!C||p(I,C))&&(C=I)},!0),C||0}if(b==="fro")return y(g,2);if(typeof b=="number"&&!isNaN(b)){if(!c(b,0)){var _=0;return g.forEach(function(V){_=i(a(r(V),b),_)},!0),a(_,1/b)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}if(x.length==2){if(b===1){var w=[],A=0;return g.forEach(function(V,I){var q=I[1],K=i(w[q]||0,r(V));f(K,A)&&(A=K),w[q]=K},!0),A}if(b===Number.POSITIVE_INFINITY||b==="inf"){var $=[],S=0;return g.forEach(function(V,I){var q=I[0],K=i($[q]||0,r(V));f(K,S)&&(S=K),$[q]=K},!0),S}if(b==="fro"){var D=0;return g.forEach(function(V,I){D=i(D,u(V,s(V)))}),o(D)}throw b===2?new Error("Unsupported parameter value, missing implementation of matrix singular value decomposition"):new Error("Unsupported parameter value")}}return h.toTex={1:"\\left\\|${args[0]}\\right\\|",2:void 0},h}var name$154="norm",factory_1$165=factory$166,norm$1={name:name$154,factory:factory_1$165};function factory$167(l,t,e,n){var r=e(matrix),i=e(algorithm01),a=e(algorithm02),s=e(algorithm06),o=e(algorithm11),u=e(algorithm13),c=e(algorithm14),f=n("nthRoot",{number:function(d){return _nthRoot(d,2)},"number, number":_nthRoot,BigNumber:function(d){return p(d,new l.BigNumber(2))},Complex:function(d){return _nthComplexRoot(d,2)},"Complex, number":_nthComplexRoot,"BigNumber, BigNumber":p,"Array | Matrix":function(d){return f(d,2)},"SparseMatrix, SparseMatrix":function(d,m){if(m.density()===1)return s(d,m,f);throw new Error("Root must be non-zero")},"SparseMatrix, DenseMatrix":function(d,m){return a(m,d,f,!0)},"DenseMatrix, SparseMatrix":function(d,m){if(m.density()===1)return i(d,m,f,!1);throw new Error("Root must be non-zero")},"DenseMatrix, DenseMatrix":function(d,m){return u(d,m,f)},"Array, Array":function(d,m){return f(r(d),r(m)).valueOf()},"Array, Matrix":function(d,m){return f(r(d),m)},"Matrix, Array":function(d,m){return f(d,r(m))},"SparseMatrix, number | BigNumber":function(d,m){return o(d,m,f,!1)},"DenseMatrix, number | BigNumber":function(d,m){return c(d,m,f,!1)},"number | BigNumber, SparseMatrix":function(d,m){if(m.density()===1)return o(m,d,f,!0);throw new Error("Root must be non-zero")},"number | BigNumber, DenseMatrix":function(d,m){return c(m,d,f,!0)},"Array, number | BigNumber":function(d,m){return f(r(d),m).valueOf()},"number | BigNumber, Array":function(d,m){return f(d,r(m)).valueOf()}});return f.toTex={2:"\\sqrt[${args[1]}]{${args[0]}}"},f;function p(d,m){var v=l.BigNumber.precision,h=l.BigNumber.clone({precision:v+2}),y=new l.BigNumber(0),g=new h(1),b=m.isNegative();if(b&&(m=m.neg()),m.isZero())throw new Error("Root must be non-zero");if(d.isNegative()&&!m.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(d.isZero())return b?new h(Infinity):0;if(!d.isFinite())return b?y:d;var x=d.abs().pow(g.div(m));return x=d.isNeg()?x.neg():x,new l.BigNumber((b?g.div(x):x).toPrecision(v))}}function _nthRoot(l,t){var e=t<0;if(e&&(t=-t),t===0)throw new Error("Root must be non-zero");if(l<0&&Math.abs(t)%2!=1)throw new Error("Root must be odd when a is negative.");if(l==0)return e?Infinity:0;if(!isFinite(l))return e?0:l;var n=Math.pow(Math.abs(l),1/t);return n=l<0?-n:n,e?1/n:n}function _nthComplexRoot(l,t){if(t<0)throw new Error("Root must be greater than zero");if(t===0)throw new Error("Root must be non-zero");if(t%1!=0)throw new Error("Root must be an integer");for(var e=l.arg(),n=l.abs(),r=[],i=Math.pow(n,1/t),a=0;a<t;a++)r.push({r:i,phi:(e+2*Math.PI*a)/t});return r}var name$155="nthRoot",factory_1$166=factory$167,nthRoot$1={name:name$155,factory:factory_1$166},isInteger$11=number.isInteger,toFixed=number.toFixed,NO_INT="Number of decimals in function round must be an integer";function factory$168(l,t,e,n){var r=e(matrix),i=e(equalScalar),a=e(zeros$1),s=e(algorithm11),o=e(algorithm12),u=e(algorithm14),c=n("round",{number:Math.round,"number, number":function(f,p){if(!isInteger$11(p))throw new TypeError(NO_INT);if(p<0||p>15)throw new Error("Number of decimals in function round must be in te range of 0-15");return _round(f,p)},Complex:function(f){return f.round()},"Complex, number":function(f,p){if(p%1)throw new TypeError(NO_INT);return f.round(p)},"Complex, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(NO_INT);var d=p.toNumber();return f.round(d)},"number, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(NO_INT);return new l.BigNumber(f).toDecimalPlaces(p.toNumber())},BigNumber:function(f){return f.toDecimalPlaces(0)},"BigNumber, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(NO_INT);return f.toDecimalPlaces(p.toNumber())},Fraction:function(f){return f.round()},"Fraction, number":function(f,p){if(p%1)throw new TypeError(NO_INT);return f.round(p)},"Array | Matrix":function(f){return deepMap(f,c,!0)},"SparseMatrix, number | BigNumber":function(f,p){return s(f,p,c,!1)},"DenseMatrix, number | BigNumber":function(f,p){return u(f,p,c,!1)},"number | Complex | BigNumber, SparseMatrix":function(f,p){return i(f,0)?a(p.size(),p.storage()):o(p,f,c,!0)},"number | Complex | BigNumber, DenseMatrix":function(f,p){return i(f,0)?a(p.size(),p.storage()):u(p,f,c,!0)},"Array, number | BigNumber":function(f,p){return u(r(f),p,c,!1).valueOf()},"number | Complex | BigNumber, Array":function(f,p){return u(r(p),f,c,!0).valueOf()}});return c.toTex={1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},c}function _round(l,t){return parseFloat(toFixed(l,t))}var name$156="round",factory_1$167=factory$168,round$1={name:name$156,factory:factory_1$167};function factory$169(l,t,e,n){var r=n("square",{number:function(i){return i*i},Complex:function(i){return i.mul(i)},BigNumber:function(i){return i.times(i)},Fraction:function(i){return i.mul(i)},"Array | Matrix":function(i){return deepMap(i,r,!0)},Unit:function(i){return i.pow(2)}});return r.toTex={1:"\\left(${args[0]}\\right)^2"},r}var name$157="square",factory_1$168=factory$169,square$1={name:name$157,factory:factory_1$168};function factory$170(l,t,e,n){var r=latex,i=n("unaryPlus",{number:function(a){return a},Complex:function(a){return a},BigNumber:function(a){return a},Fraction:function(a){return a},Unit:function(a){return a.clone()},"Array | Matrix":function(a){return deepMap(a,i,!0)},"boolean | string":function(a){return t.number=="BigNumber"?new l.BigNumber(+a):+a}});return i.toTex={1:r.operators.unaryPlus+"\\left(${args[0]}\\right)"},i}var name$158="unaryPlus",factory_1$169=factory$170,unaryPlus$1={name:name$158,factory:factory_1$169},isInteger$12=number.isInteger;function factory$171(l,t,e,n){var r=e(matrix),i=n("xgcd",{"number, number":a,"BigNumber, BigNumber":s});return i.toTex=void 0,i;function a(o,u){var c,f,p,d=0,m=1,v=1,h=0;if(!isInteger$12(o)||!isInteger$12(u))throw new Error("Parameters in function xgcd must be integer numbers");for(;u;)f=Math.floor(o/u),p=o-f*u,c=d,d=m-f*d,m=c,c=v,v=h-f*v,h=c,o=u,u=p;var y;return o<0?y=[-o,-m,-h]:y=[o,o?m:0,h],t.matrix==="Array"?y:r(y)}function s(o,u){var c,f,p,d=new l.BigNumber(0),m=new l.BigNumber(1),v=d,h=m,y=m,g=d;if(!o.isInt()||!u.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!u.isZero();)f=o.div(u).floor(),p=o.mod(u),c=v,v=h.minus(f.times(v)),h=c,c=y,y=g.minus(f.times(y)),g=c,o=u,u=p;var b;return o.lt(d)?b=[o.neg(),h.neg(),g.neg()]:b=[o,o.isZero()?0:h,g],t.matrix==="Array"?b:r(b)}}var name$159="xgcd",factory_1$170=factory$171,xgcd$1={name:name$159,factory:factory_1$170},arithmetic=[abs$1,add,addScalar,cbrt$1,ceil$1,cube$1,divide$1,dotDivide$1,dotMultiply$1,dotPow$1,exp$1,expm1$1,fix$1,floor$1,gcd$1,hypot$1,lcm$1,log$1,log10$1,log1p$1,log2$1,mod$1,multiply$1,norm$1,nthRoot$1,pow$1,round$1,sign$1,sqrt$1,square$1,subtract$1,unaryMinus$1,unaryPlus$1,xgcd$1],bitNot$1=function(t){if(t.isFinite()&&!t.isInteger())throw new Error("Integer expected in function bitNot");var e=t.constructor,n=e.precision;e.config({precision:1e9});var t=t.plus(new e(1));return t.s=-t.s||null,e.config({precision:n}),t},bitwise=function(t,e,n){var r=t.constructor,i,a,s=+(t.s<0),o=+(e.s<0);if(s){i=decCoefficientToBinaryString(bitNot$1(t));for(var u=0;u<i.length;++u)i[u]^=1}else i=decCoefficientToBinaryString(t);if(o){a=decCoefficientToBinaryString(bitNot$1(e));for(var u=0;u<a.length;++u)a[u]^=1}else a=decCoefficientToBinaryString(e);var c,f,p;i.length<=a.length?(c=i,f=a,p=s):(c=a,f=i,p=o);var d=c.length,m=f.length,v=n(s,o)^1,h=new r(v^1),y=new r(1),g=new r(2),b=r.precision;for(r.config({precision:1e9});d>0;)n(c[--d],f[--m])==v&&(h=h.plus(y)),y=y.times(g);for(;m>0;)n(p,f[--m])==v&&(h=h.plus(y)),y=y.times(g);return r.config({precision:b}),v==0&&(h.s=-h.s),h};function decCoefficientToBinaryString(l){for(var t=l.d,e=t[0]+"",n=1;n<t.length;++n){for(var r=t[n]+"",i=7-r.length;i--;)r="0"+r;e+=r}var a;for(a=e.length-1;e.charAt(a)=="0";--a);var s=l.e,o=e.slice(0,a+1||1),u=o.length;if(s>0)if(++s>u)for(s-=u;s--;o+="0");else s<u&&(o=o.slice(0,s)+"."+o.slice(s));for(var c=[0],n=0;n<o.length;){for(var f=c.length;f--;c[f]*=10);c[0]+=o.charAt(n++)<<0;for(var a=0;a<c.length;++a)c[a]>1&&(c[a+1]==null&&(c[a+1]=0),c[a+1]+=c[a]>>1,c[a]&=1)}return c.reverse()}var bitAnd$1=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);if(t.isZero()||e.eq(-1)||t.eq(e))return t;if(e.isZero()||t.eq(-1))return e;if(!t.isFinite()||!e.isFinite()){if(!t.isFinite()&&!e.isFinite())return t.isNegative()==e.isNegative()?t:new n(0);if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new n(0):e;if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new n(0):t}return bitwise(t,e,function(r,i){return r&i})},isInteger$13=number.isInteger;function factory$172(l,t,e,n){var r=latex,i=e(matrix),a=e(algorithm02),s=e(algorithm06),o=e(algorithm11),u=e(algorithm13),c=e(algorithm14),f=n("bitAnd",{"number, number":function(p,d){if(!isInteger$13(p)||!isInteger$13(d))throw new Error("Integers expected in function bitAnd");return p&d},"BigNumber, BigNumber":bitAnd$1,"SparseMatrix, SparseMatrix":function(p,d){return s(p,d,f,!1)},"SparseMatrix, DenseMatrix":function(p,d){return a(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return a(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return u(p,d,f)},"Array, Array":function(p,d){return f(i(p),i(d)).valueOf()},"Array, Matrix":function(p,d){return f(i(p),d)},"Matrix, Array":function(p,d){return f(p,i(d))},"SparseMatrix, any":function(p,d){return o(p,d,f,!1)},"DenseMatrix, any":function(p,d){return c(p,d,f,!1)},"any, SparseMatrix":function(p,d){return o(d,p,f,!0)},"any, DenseMatrix":function(p,d){return c(d,p,f,!0)},"Array, any":function(p,d){return c(i(p),d,f,!1).valueOf()},"any, Array":function(p,d){return c(i(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+r.operators.bitAnd+"${args[1]}\\right)"},f}var name$160="bitAnd",factory_1$171=factory$172,bitAnd$2={name:name$160,factory:factory_1$171},isInteger$14=number.isInteger;function factory$173(l,t,e,n){var r=latex,i=n("bitNot",{number:function(a){if(!isInteger$14(a))throw new Error("Integer expected in function bitNot");return~a},BigNumber:bitNot$1,"Array | Matrix":function(a){return deepMap(a,i)}});return i.toTex={1:r.operators.bitNot+"\\left(${args[0]}\\right)"},i}var name$161="bitNot",factory_1$172=factory$173,bitNot$2={name:name$161,factory:factory_1$172},bitOr$1=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);var r=new n(-1);return t.isZero()||e.eq(r)||t.eq(e)?e:e.isZero()||t.eq(r)?t:!t.isFinite()||!e.isFinite()?!t.isFinite()&&!t.isNegative()&&e.isNegative()||t.isNegative()&&!e.isNegative()&&!e.isFinite()?r:t.isNegative()&&e.isNegative()?t.isFinite()?t:e:t.isFinite()?e:t:bitwise(t,e,function(i,a){return i|a})},isInteger$15=number.isInteger;function factory$174(l,t,e,n){var r=latex,i=e(matrix),a=e(algorithm01),s=e(algorithm04),o=e(algorithm10),u=e(algorithm13),c=e(algorithm14),f=n("bitOr",{"number, number":function(p,d){if(!isInteger$15(p)||!isInteger$15(d))throw new Error("Integers expected in function bitOr");return p|d},"BigNumber, BigNumber":bitOr$1,"SparseMatrix, SparseMatrix":function(p,d){return s(p,d,f)},"SparseMatrix, DenseMatrix":function(p,d){return a(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return a(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return u(p,d,f)},"Array, Array":function(p,d){return f(i(p),i(d)).valueOf()},"Array, Matrix":function(p,d){return f(i(p),d)},"Matrix, Array":function(p,d){return f(p,i(d))},"SparseMatrix, any":function(p,d){return o(p,d,f,!1)},"DenseMatrix, any":function(p,d){return c(p,d,f,!1)},"any, SparseMatrix":function(p,d){return o(d,p,f,!0)},"any, DenseMatrix":function(p,d){return c(d,p,f,!0)},"Array, any":function(p,d){return c(i(p),d,f,!1).valueOf()},"any, Array":function(p,d){return c(i(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+r.operators.bitOr+"${args[1]}\\right)"},f}var name$162="bitOr",factory_1$173=factory$174,bitOr$2={name:name$162,factory:factory_1$173},bitXor$1=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);if(t.isZero())return e;if(e.isZero())return t;if(t.eq(e))return new n(0);var r=new n(-1);return t.eq(r)?bitNot$1(e):e.eq(r)?bitNot$1(t):!t.isFinite()||!e.isFinite()?!t.isFinite()&&!e.isFinite()?r:new n(t.isNegative()==e.isNegative()?Infinity:-Infinity):bitwise(t,e,function(i,a){return i^a})},isInteger$16=number.isInteger;function factory$175(l,t,e,n){var r=latex,i=e(matrix),a=e(algorithm03),s=e(algorithm07),o=e(algorithm12),u=e(algorithm13),c=e(algorithm14),f=n("bitXor",{"number, number":function(p,d){if(!isInteger$16(p)||!isInteger$16(d))throw new Error("Integers expected in function bitXor");return p^d},"BigNumber, BigNumber":bitXor$1,"SparseMatrix, SparseMatrix":function(p,d){return s(p,d,f)},"SparseMatrix, DenseMatrix":function(p,d){return a(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return a(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return u(p,d,f)},"Array, Array":function(p,d){return f(i(p),i(d)).valueOf()},"Array, Matrix":function(p,d){return f(i(p),d)},"Matrix, Array":function(p,d){return f(p,i(d))},"SparseMatrix, any":function(p,d){return o(p,d,f,!1)},"DenseMatrix, any":function(p,d){return c(p,d,f,!1)},"any, SparseMatrix":function(p,d){return o(d,p,f,!0)},"any, DenseMatrix":function(p,d){return c(d,p,f,!0)},"Array, any":function(p,d){return c(i(p),d,f,!1).valueOf()},"any, Array":function(p,d){return c(i(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+r.operators.bitXor+"${args[1]}\\right)"},f}var name$163="bitXor",factory_1$174=factory$175,bitXor$2={name:name$163,factory:factory_1$174},leftShift$1=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var n=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new n(NaN):t.isZero()||e.isZero()?t:!t.isFinite()&&!e.isFinite()?new n(NaN):e.lt(55)?t.times(Math.pow(2,e.toNumber())+""):t.times(new n(2).pow(e))};function factory$176(l,t,e,n){var r=e(equalScalar),i=l.SparseMatrix,a=function(s,o,u){var c=s._values,f=s._index,p=s._ptr,d=s._size,m=s._datatype,v=o._values,h=o._index,y=o._ptr,g=o._size,b=o._datatype;if(d.length!==g.length)throw new DimensionError_1(d.length,g.length);if(d[0]!==g[0]||d[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+g+")");if(!c||!v)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var x=d[0],N=d[1],C,_=r,w=0,A=u;typeof m=="string"&&m===b&&(C=m,_=n.find(r,[C,C]),w=n.convert(0,C),A=n.find(u,[C,C]));for(var $=[],S=[],D=[],V=new i({values:$,index:S,ptr:D,size:[x,N],datatype:C}),I=[],q=[],K,E,W,G,P=0;P<N;P++){D[P]=S.length;var Q=P+1;for(E=p[P],W=p[P+1],K=E;K<W;K++)G=f[K],q[G]=Q,I[G]=c[K],S.push(G);for(E=y[P],W=y[P+1],K=E;K<W;K++)G=h[K],q[G]===Q&&(I[G]=A(I[G],v[K]));for(K=D[P];K<S.length;){G=S[K];var ne=I[G];_(ne,w)?S.splice(K,1):($.push(ne),K++)}}return D[N]=S.length,V};return a}var name$164="algorithm08",factory_1$175=factory$176,algorithm08={name:name$164,factory:factory_1$175},isInteger$17=number.isInteger;function factory$177(l,t,e,n){var r=latex,i=e(matrix),a=e(equalScalar),s=e(zeros$1),o=e(algorithm01),u=e(algorithm02),c=e(algorithm08),f=e(algorithm10),p=e(algorithm11),d=e(algorithm13),m=e(algorithm14),v=n("leftShift",{"number, number":function(h,y){if(!isInteger$17(h)||!isInteger$17(y))throw new Error("Integers expected in function leftShift");return h<<y},"BigNumber, BigNumber":leftShift$1,"SparseMatrix, SparseMatrix":function(h,y){return c(h,y,v,!1)},"SparseMatrix, DenseMatrix":function(h,y){return u(y,h,v,!0)},"DenseMatrix, SparseMatrix":function(h,y){return o(h,y,v,!1)},"DenseMatrix, DenseMatrix":function(h,y){return d(h,y,v)},"Array, Array":function(h,y){return v(i(h),i(y)).valueOf()},"Array, Matrix":function(h,y){return v(i(h),y)},"Matrix, Array":function(h,y){return v(h,i(y))},"SparseMatrix, number | BigNumber":function(h,y){return a(y,0)?h.clone():p(h,y,v,!1)},"DenseMatrix, number | BigNumber":function(h,y){return a(y,0)?h.clone():m(h,y,v,!1)},"number | BigNumber, SparseMatrix":function(h,y){return a(h,0)?s(y.size(),y.storage()):f(y,h,v,!0)},"number | BigNumber, DenseMatrix":function(h,y){return a(h,0)?s(y.size(),y.storage()):m(y,h,v,!0)},"Array, number | BigNumber":function(h,y){return v(i(h),y).valueOf()},"number | BigNumber, Array":function(h,y){return v(h,i(y)).valueOf()}});return v.toTex={2:"\\left(${args[0]}"+r.operators.leftShift+"${args[1]}\\right)"},v}var name$165="leftShift",factory_1$176=factory$177,leftShift$2={name:name$165,factory:factory_1$176},rightArithShift$1=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var n=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new n(NaN):t.isZero()||e.isZero()?t:e.isFinite()?e.lt(55)?t.div(Math.pow(2,e.toNumber())+"").floor():t.div(new n(2).pow(e)).floor():t.isNegative()?new n(-1):t.isFinite()?new n(0):new n(NaN)},isInteger$18=number.isInteger;function factory$178(l,t,e,n){var r=latex,i=e(matrix),a=e(equalScalar),s=e(zeros$1),o=e(algorithm01),u=e(algorithm02),c=e(algorithm08),f=e(algorithm10),p=e(algorithm11),d=e(algorithm13),m=e(algorithm14),v=n("rightArithShift",{"number, number":function(h,y){if(!isInteger$18(h)||!isInteger$18(y))throw new Error("Integers expected in function rightArithShift");return h>>y},"BigNumber, BigNumber":rightArithShift$1,"SparseMatrix, SparseMatrix":function(h,y){return c(h,y,v,!1)},"SparseMatrix, DenseMatrix":function(h,y){return u(y,h,v,!0)},"DenseMatrix, SparseMatrix":function(h,y){return o(h,y,v,!1)},"DenseMatrix, DenseMatrix":function(h,y){return d(h,y,v)},"Array, Array":function(h,y){return v(i(h),i(y)).valueOf()},"Array, Matrix":function(h,y){return v(i(h),y)},"Matrix, Array":function(h,y){return v(h,i(y))},"SparseMatrix, number | BigNumber":function(h,y){return a(y,0)?h.clone():p(h,y,v,!1)},"DenseMatrix, number | BigNumber":function(h,y){return a(y,0)?h.clone():m(h,y,v,!1)},"number | BigNumber, SparseMatrix":function(h,y){return a(h,0)?s(y.size(),y.storage()):f(y,h,v,!0)},"number | BigNumber, DenseMatrix":function(h,y){return a(h,0)?s(y.size(),y.storage()):m(y,h,v,!0)},"Array, number | BigNumber":function(h,y){return v(i(h),y).valueOf()},"number | BigNumber, Array":function(h,y){return v(h,i(y)).valueOf()}});return v.toTex={2:"\\left(${args[0]}"+r.operators.rightArithShift+"${args[1]}\\right)"},v}var name$166="rightArithShift",factory_1$177=factory$178,rightArithShift$2={name:name$166,factory:factory_1$177},isInteger$19=number.isInteger;function factory$179(l,t,e,n){var r=latex,i=e(matrix),a=e(equalScalar),s=e(zeros$1),o=e(algorithm01),u=e(algorithm02),c=e(algorithm08),f=e(algorithm10),p=e(algorithm11),d=e(algorithm13),m=e(algorithm14),v=n("rightLogShift",{"number, number":function(h,y){if(!isInteger$19(h)||!isInteger$19(y))throw new Error("Integers expected in function rightLogShift");return h>>>y},"SparseMatrix, SparseMatrix":function(h,y){return c(h,y,v,!1)},"SparseMatrix, DenseMatrix":function(h,y){return u(y,h,v,!0)},"DenseMatrix, SparseMatrix":function(h,y){return o(h,y,v,!1)},"DenseMatrix, DenseMatrix":function(h,y){return d(h,y,v)},"Array, Array":function(h,y){return v(i(h),i(y)).valueOf()},"Array, Matrix":function(h,y){return v(i(h),y)},"Matrix, Array":function(h,y){return v(h,i(y))},"SparseMatrix, number | BigNumber":function(h,y){return a(y,0)?h.clone():p(h,y,v,!1)},"DenseMatrix, number | BigNumber":function(h,y){return a(y,0)?h.clone():m(h,y,v,!1)},"number | BigNumber, SparseMatrix":function(h,y){return a(h,0)?s(y.size(),y.storage()):f(y,h,v,!0)},"number | BigNumber, DenseMatrix":function(h,y){return a(h,0)?s(y.size(),y.storage()):m(y,h,v,!0)},"Array, number | BigNumber":function(h,y){return v(i(h),y).valueOf()},"number | BigNumber, Array":function(h,y){return v(h,i(y)).valueOf()}});return v.toTex={2:"\\left(${args[0]}"+r.operators.rightLogShift+"${args[1]}\\right)"},v}var name$167="rightLogShift",factory_1$178=factory$179,rightLogShift$1={name:name$167,factory:factory_1$178},bitwise$1=[bitAnd$2,bitNot$2,bitOr$2,bitXor$2,leftShift$2,rightArithShift$2,rightLogShift$1],isInteger$20=number.isInteger;function factory$180(l,t,e,n){var r=e(multiply$1),i=e(pow$1),a=n("gamma",{number:function(o){var u,c;if(isInteger$20(o)){if(o<=0)return isFinite(o)?Infinity:NaN;if(o>171)return Infinity;for(var f=o-2,p=o-1;f>1;)p*=f,f--;return p==0&&(p=1),p}if(o<.5)return Math.PI/(Math.sin(Math.PI*o)*a(1-o));if(o>=171.35)return Infinity;if(o>85){var d=o*o,m=d*o,v=m*o,h=v*o;return Math.sqrt(2*Math.PI/o)*Math.pow(o/Math.E,o)*(1+1/(12*o)+1/(288*d)-139/(51840*m)-571/(2488320*v)+163879/(209018880*h)+5246819/(75246796800*h*o))}--o,c=p[0];for(var y=1;y<p.length;++y)c+=p[y]/(o+y);return u=o+g+.5,Math.sqrt(2*Math.PI)*Math.pow(u,o+.5)*Math.exp(-u)*c},Complex:function(o){var u,c;if(o.im==0)return a(o.re);o=new l.Complex(o.re-1,o.im),c=new l.Complex(p[0],0);for(var f=1;f<p.length;++f){var p=o.re+f,d=p*p+o.im*o.im;d!=0?(c.re+=p[f]*p/d,c.im+=-(p[f]*o.im)/d):c.re=p[f]<0?-Infinity:Infinity}u=new l.Complex(o.re+g+.5,o.im);var m=Math.sqrt(2*Math.PI);o.re+=.5;var v=i(u,o);v.im==0?v.re*=m:(v.re==0||(v.re*=m),v.im*=m);var h=Math.exp(-u.re);return u.re=h*Math.cos(-u.im),u.im=h*Math.sin(-u.im),r(r(v,u),c)},BigNumber:function(o){if(o.isInteger())return o.isNegative()||o.isZero()?new l.BigNumber(Infinity):s(o.minus(1));if(!o.isFinite())return new l.BigNumber(o.isNegative()?NaN:Infinity);throw new Error("Integer BigNumber expected")},"Array | Matrix":function(o){return deepMap(o,a)}});function s(o){if(o.isZero())return new l.BigNumber(1);for(var u=t.precision+(Math.log(o.toNumber())|0),c=l.BigNumber.clone({precision:u}),f=new c(o),p=o.toNumber()-1;p>1;)f=f.times(p),p--;return new l.BigNumber(f.toPrecision(l.BigNumber.precision))}return a.toTex={1:"\\Gamma\\left(${args[0]}\\right)"},a}var g=4.7421875,p=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],name$168="gamma",factory_1$179=factory$180,gamma$1={name:name$168,factory:factory_1$179};function factory$181(l,t,e,n){var r=e(gamma$1),i=latex,a=n("factorial",{number:function(s){if(s<0)throw new Error("Value must be non-negative");return r(s+1)},BigNumber:function(s){if(s.isNegative())throw new Error("Value must be non-negative");return r(s.plus(1))},"Array | Matrix":function(s){return deepMap(s,a)}});return a.toTex={1:"\\left(${args[0]}\\right)"+i.operators.factorial},a}var name$169="factorial",factory_1$180=factory$181,factorial$1={name:name$169,factory:factory_1$180},isInteger$21=number.isInteger;function factory$182(l,t,e,n){var r=n("combinations",{"number, number":function(i,a){var s,o,u;if(!isInteger$21(i)||i<0)throw new TypeError("Positive integer value expected in function combinations");if(!isInteger$21(a)||a<0)throw new TypeError("Positive integer value expected in function combinations");if(a>i)throw new TypeError("k must be less than or equal to n");for(s=Math.max(a,i-a),o=1,u=1;u<=i-s;u++)o=o*(s+u)/u;return o},"BigNumber, BigNumber":function(i,a){var s,o,u,c,f=new l.BigNumber(1);if(!isPositiveInteger(i)||!isPositiveInteger(a))throw new TypeError("Positive integer value expected in function combinations");if(a.gt(i))throw new TypeError("k must be less than n in function combinations");for(s=i.minus(a),a.lt(s)&&(s=a),o=f,u=f,c=i.minus(s);u.lte(c);u=u.plus(1))o=o.times(s.plus(u)).dividedBy(u);return o}});return r.toTex={2:"\\binom{${args[0]}}{${args[1]}}"},r}function isPositiveInteger(l){return l.isInteger()&&l.gte(0)}var name$170="combinations",factory_1$181=factory$182,combinations$1={name:name$170,factory:factory_1$181};function factory$183(l,t,e,n){var r=n("isInteger",{number:number.isInteger,BigNumber:function(i){return i.isInt()},Fraction:function(i){return i.d===1&&isFinite(i.n)},"Array | Matrix":function(i){return deepMap(i,r)}});return r}var name$171="isInteger",factory_1$182=factory$183,isInteger$22={name:name$171,factory:factory_1$182};function factory$184(l,t,e,n){var r=e(add),i=e(subtract$1),a=e(multiply$1),s=e(divide$1),o=e(pow$1),u=e(factorial$1),c=e(combinations$1),f=e(isNegative$1),p=e(isInteger$22),d=e(larger),m=n("stirlingS2",{"number | BigNumber, number | BigNumber":function(v,h){if(!p(v)||f(v)||!p(h)||f(h))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(d(h,v))throw new TypeError("k must be less than or equal to n in function stirlingS2");for(var y=u(h),g=0,b=0;b<=h;b++){var x=o(-1,i(h,b)),N=c(h,b),C=o(b,v);g=r(g,a(a(N,C),x))}return s(g,y)}});return m.toTex={2:"\\mathrm{S}\\left(${args}\\right)"},m}var name$172="stirlingS2",factory_1$183=factory$184,stirlingS2$1={name:name$172,factory:factory_1$183};function factory$185(l,t,e,n){var r=e(add),i=e(stirlingS2$1),a=e(isNegative$1),s=e(isInteger$22),o=n("bellNumbers",{"number | BigNumber":function(u){if(!s(u)||a(u))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var c=0,f=0;f<=u;f++)c=r(c,i(u,f));return c}});return o.toTex={1:"\\mathrm{B}_{${args[0]}}"},o}var name$173="bellNumbers",factory_1$184=factory$185,bellNumbers$1={name:name$173,factory:factory_1$184};function factory$186(l,t,e,n){var r=e(combinations$1),i=e(addScalar),a=e(isPositive$1),s=e(isInteger$22),o=e(larger),u=n("composition",{"number | BigNumber, number | BigNumber":function(c,f){if(!s(c)||!a(c)||!s(f)||!a(f))throw new TypeError("Positive integer value expected in function composition");if(o(f,c))throw new TypeError("k must be less than or equal to n in function composition");return r(i(c,-1),i(f,-1))}});return u.toTex=void 0,u}var name$174="composition",factory_1$185=factory$186,composition$1={name:name$174,factory:factory_1$185};function factory$187(l,t,e,n){var r=e(add),i=e(divide$1),a=e(multiply$1),s=e(combinations$1),o=e(isNegative$1),u=e(isInteger$22),c=n("catalan",{"number | BigNumber":function(f){if(!u(f)||o(f))throw new TypeError("Non-negative integer value expected in function catalan");return i(s(a(f,2),f),r(f,1))}});return c.toTex={1:"\\mathrm{C}_{${args[0]}}"},c}var name$175="catalan",factory_1$186=factory$187,catalan$1={name:name$175,factory:factory_1$186},combinatorics=[bellNumbers$1,composition$1,stirlingS2$1,catalan$1];function factory$188(l,t,e,n){var r=n("arg",{number:function(i){return Math.atan2(0,i)},BigNumber:function(i){return l.BigNumber.atan2(0,i)},Complex:function(i){return i.arg()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\arg\\left(${args[0]}\\right)"},r}var name$176="arg",factory_1$187=factory$188,arg$1={name:name$176,factory:factory_1$187};function factory$189(l,t,e,n){var r=n("im",{number:function(i){return 0},BigNumber:function(i){return new l.BigNumber(0)},Complex:function(i){return i.im},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},r}var name$177="im",factory_1$188=factory$189,im$1={name:name$177,factory:factory_1$188};function factory$190(l,t,e,n){var r=n("re",{number:function(i){return i},BigNumber:function(i){return i},Complex:function(i){return i.re},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},r}var name$178="re",factory_1$189=factory$190,re$1={name:name$178,factory:factory_1$189},complex$5=[arg$1,conj$1,im$1,re$1];function factory$191(l,t,e,n){var r=e(abs$1),i=e(add),a=e(addScalar),s=e(matrix),o=e(multiply$1),u=e(multiplyScalar),c=e(divideScalar),f=e(subtract$1),p=e(smaller),d=e(equalScalar),m=n("intersect",{"Array, Array, Array":function(_,w,A){if(!y(_))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!y(w))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!g(A))throw new TypeError("Array with 4 numbers expected as third argument");return C(_[0],_[1],_[2],w[0],w[1],w[2],A[0],A[1],A[2],A[3])},"Array, Array, Array, Array":function(_,w,A,$){if(_.length===2){if(!h(_))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!h(w))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!h(A))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!h($))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return b(_,w,A,$)}else if(_.length===3){if(!y(_))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!y(w))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!y(A))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!y($))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return N(_[0],_[1],_[2],w[0],w[1],w[2],A[0],A[1],A[2],$[0],$[1],$[2])}else throw new TypeError("Arrays with two or thee dimensional points expected")},"Matrix, Matrix, Matrix":function(_,w,A){return s(m(_.valueOf(),w.valueOf(),A.valueOf()))},"Matrix, Matrix, Matrix, Matrix":function(_,w,A,$){return s(m(_.valueOf(),w.valueOf(),A.valueOf(),$.valueOf()))}});function v(_){return typeof _=="number"||l.isBigNumber(_)}function h(_){return _.length===2&&v(_[0])&&v(_[1])}function y(_){return _.length===3&&v(_[0])&&v(_[1])&&v(_[2])}function g(_){return _.length===4&&v(_[0])&&v(_[1])&&v(_[2])&&v(_[3])}function b(_,w,A,$){var S=_,D=A,V=f(S,w),I=f(D,$),q=f(u(V[0],I[1]),u(I[0],V[1]));if(p(r(q),t.epsilon))return null;var K=u(I[0],S[1]),E=u(I[1],S[0]),W=u(I[0],D[1]),G=u(I[1],D[0]),P=c(a(f(f(K,E),W),G),q);return i(o(V,P),S)}function x(_,w,A,$,S,D,V,I,q,K,E,W){var G=u(f(_,w),f(A,$)),P=u(f(S,D),f(V,I)),Q=u(f(q,K),f(E,W));return a(a(G,P),Q)}function N(_,w,A,$,S,D,V,I,q,K,E,W){var G=x(_,V,K,V,w,I,E,I,A,q,W,q),P=x(K,V,$,_,E,I,S,w,W,q,D,A),Q=x(_,V,$,_,w,I,S,w,A,q,D,A),ne=x(K,V,K,V,E,I,E,I,W,q,W,q),Y=x($,_,$,_,S,w,S,w,D,A,D,A),se=c(f(u(G,P),u(Q,ne)),f(u(Y,ne),u(P,P))),pe=c(a(G,u(se,P)),ne),oe=a(_,u(se,f($,_))),ve=a(w,u(se,f(S,w))),O=a(A,u(se,f(D,A))),z=a(V,u(pe,f(K,V))),Z=a(I,u(pe,f(E,I))),J=a(q,u(pe,f(W,q)));return d(oe,z)&&d(ve,Z)&&d(O,J)?[oe,ve,O]:null}function C(_,w,A,$,S,D,V,I,q,K){var E=u(_,V),W=u($,V),G=u(w,I),P=u(S,I),Q=u(A,q),ne=u(D,q),Y=c(f(f(f(K,E),G),Q),f(f(f(a(a(W,P),ne),E),G),Q)),se=a(_,u(Y,f($,_))),pe=a(w,u(Y,f(S,w))),oe=a(A,u(Y,f(D,A)));return[se,pe,oe]}return m}var name$179="intersect",factory_1$190=factory$191,intersect$1={name:name$179,factory:factory_1$190};function factory$192(l,t,e,n){var r=e(matrix),i=e(addScalar),a=e(subtract$1),s=e(multiplyScalar),o=e(divideScalar),u=e(unaryMinus$1),c=e(sqrt$1),f=e(abs$1),p=n("distance",{"Array, Array, Array":function(w,A,$){if(w.length==2&&A.length==2&&$.length==2){if(!m(w))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!m(A))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!m($))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");var S=o(a($[1],$[0]),a(A[1],A[0])),D=s(s(S,S),A[0]),V=u(s(S,A[0])),I=w[1];return b(w[0],w[1],D,V,I)}else throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(w,A,$){if(Object.keys(w).length==2&&Object.keys(A).length==2&&Object.keys($).length==2){if(!m(w))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!m(A))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!m($))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(w.hasOwnProperty("pointX")&&w.hasOwnProperty("pointY")&&A.hasOwnProperty("lineOnePtX")&&A.hasOwnProperty("lineOnePtY")&&$.hasOwnProperty("lineTwoPtX")&&$.hasOwnProperty("lineTwoPtY")){var S=o(a($.lineTwoPtY,$.lineTwoPtX),a(A.lineOnePtY,A.lineOnePtX)),D=s(s(S,S),A.lineOnePtX),V=u(s(S,A.lineOnePtX)),I=w.pointX;return b(w.pointX,w.pointY,D,V,I)}else throw new TypeError("Key names do not match")}else throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(w,A){if(w.length==2&&A.length==3){if(!m(w))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!v(A))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return b(w[0],w[1],A[0],A[1],A[2])}else if(w.length==3&&A.length==6){if(!v(w))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!h(A))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return x(w[0],w[1],w[2],A[0],A[1],A[2],A[3],A[4],A[5])}else if(w.length==2&&A.length==2){if(!m(w))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!m(A))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");return N(w[0],w[1],A[0],A[1])}else if(w.length==3&&A.length==3){if(!v(w))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!v(A))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return C(w[0],w[1],w[2],A[0],A[1],A[2])}else throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(w,A){if(Object.keys(w).length==2&&Object.keys(A).length==3){if(!m(w))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!v(A))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if(w.hasOwnProperty("pointX")&&w.hasOwnProperty("pointY")&&A.hasOwnProperty("xCoeffLine")&&A.hasOwnProperty("yCoeffLine")&&A.hasOwnProperty("constant"))return b(w.pointX,w.pointY,A.xCoeffLine,A.yCoeffLine,A.constant);throw new TypeError("Key names do not match")}else if(Object.keys(w).length==3&&Object.keys(A).length==6){if(!v(w))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!h(A))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if(w.hasOwnProperty("pointX")&&w.hasOwnProperty("pointY")&&A.hasOwnProperty("x0")&&A.hasOwnProperty("y0")&&A.hasOwnProperty("z0")&&A.hasOwnProperty("a")&&A.hasOwnProperty("b")&&A.hasOwnProperty("c"))return x(w.pointX,w.pointY,w.pointZ,A.x0,A.y0,A.z0,A.a,A.b,A.c);throw new TypeError("Key names do not match")}else if(Object.keys(w).length==2&&Object.keys(A).length==2){if(!m(w))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!m(A))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if(w.hasOwnProperty("pointOneX")&&w.hasOwnProperty("pointOneY")&&A.hasOwnProperty("pointTwoX")&&A.hasOwnProperty("pointTwoY"))return N(w.pointOneX,w.pointOneY,A.pointTwoX,A.pointTwoY);throw new TypeError("Key names do not match")}else if(Object.keys(w).length==3&&Object.keys(A).length==3){if(!v(w))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!v(A))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if(w.hasOwnProperty("pointOneX")&&w.hasOwnProperty("pointOneY")&&w.hasOwnProperty("pointOneZ")&&A.hasOwnProperty("pointTwoX")&&A.hasOwnProperty("pointTwoY")&&A.hasOwnProperty("pointTwoZ"))return C(w.pointOneX,w.pointOneY,w.pointOneZ,A.pointTwoX,A.pointTwoY,A.pointTwoZ);throw new TypeError("Key names do not match")}else throw new TypeError("Invalid Arguments: Try again")},Array:function(w){if(!g(w))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return _(w)}});function d(w){return typeof w=="number"||l.isBigNumber(w)}function m(w){return w.constructor!==Array&&(w=y(w)),d(w[0])&&d(w[1])}function v(w){return w.constructor!==Array&&(w=y(w)),d(w[0])&&d(w[1])&&d(w[2])}function h(w){return w.constructor!==Array&&(w=y(w)),d(w[0])&&d(w[1])&&d(w[2])&&d(w[3])&&d(w[4])&&d(w[5])}function y(w){for(var A=Object.keys(w),$=[],S=0;S<A.length;S++)$.push(w[A[S]]);return $}function g(w){if(w[0].length==2&&d(w[0][0])&&d(w[0][1])){for(var A in w)if(w[A].length!=2||!d(w[A][0])||!d(w[A][1]))return!1}else if(w[0].length==3&&d(w[0][0])&&d(w[0][1])&&d(w[0][2])){for(var A in w)if(w[A].length!=3||!d(w[A][0])||!d(w[A][1])||!d(w[A][2]))return!1}else return!1;return!0}function b(w,A,$,S,D){var V=f(i(i(s($,w),s(S,A)),D)),I=c(i(s($,$),s(S,S))),q=o(V,I);return q}function x(w,A,$,S,D,V,I,q,K){var E=[a(s(a(D,A),K),s(a(V,$),q)),a(s(a(V,$),I),s(a(S,w),K)),a(s(a(S,w),q),s(a(D,A),I))];E=c(i(i(s(E[0],E[0]),s(E[1],E[1])),s(E[2],E[2])));var W=c(i(i(s(I,I),s(q,q)),s(K,K))),G=o(E,W);return G}function N(w,A,$,S){var D=a(S,A),V=a($,w),I=i(s(D,D),s(V,V)),q=c(I);return q}function C(w,A,$,S,D,V){var I=a(V,$),q=a(D,A),K=a(S,w),E=i(i(s(I,I),s(q,q)),s(K,K)),W=c(E);return W}function _(w){for(var A=[],$=0;$<w.length-1;$++)for(var S=$+1;S<w.length;S++)w[0].length==2?A.push(N(w[$][0],w[$][1],w[S][0],w[S][1])):w[0].length==3&&A.push(C(w[$][0],w[$][1],w[$][2],w[S][0],w[S][1],w[S][2]));return A}return p}var name$180="distance",factory_1$191=factory$192,distance$1={name:name$180,factory:factory_1$191},geometry=[intersect$1,distance$1];function factory$193(l,t,e,n){var r=latex,i=n("not",{number:function(a){return!a},Complex:function(a){return a.re===0&&a.im===0},BigNumber:function(a){return a.isZero()||a.isNaN()},Unit:function(a){return a.value!==null?i(a.value):!0},"Array | Matrix":function(a){return deepMap(a,i)}});return i.toTex={1:r.operators.not+"\\left(${args[0]}\\right)"},i}var name$181="not",factory_1$192=factory$193,not$1={name:name$181,factory:factory_1$192};function factory$194(l,t,e,n){var r=latex,i=e(matrix),a=e(zeros$1),s=e(not$1),o=e(isZero$1),u=e(algorithm02),c=e(algorithm06),f=e(algorithm11),p=e(algorithm13),d=e(algorithm14),m=n("and",{"number, number":function(v,h){return!!(v&&h)},"Complex, Complex":function(v,h){return(v.re!==0||v.im!==0)&&(h.re!==0||h.im!==0)},"BigNumber, BigNumber":function(v,h){return!v.isZero()&&!h.isZero()&&!v.isNaN()&&!h.isNaN()},"Unit, Unit":function(v,h){return m(v.value||0,h.value||0)},"SparseMatrix, SparseMatrix":function(v,h){return c(v,h,m,!1)},"SparseMatrix, DenseMatrix":function(v,h){return u(h,v,m,!0)},"DenseMatrix, SparseMatrix":function(v,h){return u(v,h,m,!1)},"DenseMatrix, DenseMatrix":function(v,h){return p(v,h,m)},"Array, Array":function(v,h){return m(i(v),i(h)).valueOf()},"Array, Matrix":function(v,h){return m(i(v),h)},"Matrix, Array":function(v,h){return m(v,i(h))},"SparseMatrix, any":function(v,h){return s(h)?a(v.size(),v.storage()):f(v,h,m,!1)},"DenseMatrix, any":function(v,h){return s(h)?a(v.size(),v.storage()):d(v,h,m,!1)},"any, SparseMatrix":function(v,h){return s(v)?a(v.size(),v.storage()):f(h,v,m,!0)},"any, DenseMatrix":function(v,h){return s(v)?a(v.size(),v.storage()):d(h,v,m,!0)},"Array, any":function(v,h){return m(i(v),h).valueOf()},"any, Array":function(v,h){return m(v,i(h)).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+r.operators.and+"${args[1]}\\right)"},m}var name$182="and",factory_1$193=factory$194,and$1={name:name$182,factory:factory_1$193};function factory$195(l,t,e,n){var r=latex,i=e(matrix),a=e(algorithm03),s=e(algorithm05),o=e(algorithm12),u=e(algorithm13),c=e(algorithm14),f=n("or",{"number, number":function(p,d){return!!(p||d)},"Complex, Complex":function(p,d){return p.re!==0||p.im!==0||d.re!==0||d.im!==0},"BigNumber, BigNumber":function(p,d){return!p.isZero()&&!p.isNaN()||!d.isZero()&&!d.isNaN()},"Unit, Unit":function(p,d){return f(p.value||0,d.value||0)},"SparseMatrix, SparseMatrix":function(p,d){return s(p,d,f)},"SparseMatrix, DenseMatrix":function(p,d){return a(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return a(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return u(p,d,f)},"Array, Array":function(p,d){return f(i(p),i(d)).valueOf()},"Array, Matrix":function(p,d){return f(i(p),d)},"Matrix, Array":function(p,d){return f(p,i(d))},"SparseMatrix, any":function(p,d){return o(p,d,f,!1)},"DenseMatrix, any":function(p,d){return c(p,d,f,!1)},"any, SparseMatrix":function(p,d){return o(d,p,f,!0)},"any, DenseMatrix":function(p,d){return c(d,p,f,!0)},"Array, any":function(p,d){return c(i(p),d,f,!1).valueOf()},"any, Array":function(p,d){return c(i(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+r.operators.or+"${args[1]}\\right)"},f}var name$183="or",factory_1$194=factory$195,or$1={name:name$183,factory:factory_1$194};function factory$196(l,t,e,n){var r=latex,i=e(matrix),a=e(algorithm03),s=e(algorithm07),o=e(algorithm12),u=e(algorithm13),c=e(algorithm14),f=n("xor",{"number, number":function(p,d){return!!p!=!!d},"Complex, Complex":function(p,d){return(p.re!==0||p.im!==0)!=(d.re!==0||d.im!==0)},"BigNumber, BigNumber":function(p,d){return(!p.isZero()&&!p.isNaN())!=(!d.isZero()&&!d.isNaN())},"Unit, Unit":function(p,d){return f(p.value||0,d.value||0)},"SparseMatrix, SparseMatrix":function(p,d){return s(p,d,f)},"SparseMatrix, DenseMatrix":function(p,d){return a(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return a(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return u(p,d,f)},"Array, Array":function(p,d){return f(i(p),i(d)).valueOf()},"Array, Matrix":function(p,d){return f(i(p),d)},"Matrix, Array":function(p,d){return f(p,i(d))},"SparseMatrix, any":function(p,d){return o(p,d,f,!1)},"DenseMatrix, any":function(p,d){return c(p,d,f,!1)},"any, SparseMatrix":function(p,d){return o(d,p,f,!0)},"any, DenseMatrix":function(p,d){return c(d,p,f,!0)},"Array, any":function(p,d){return c(i(p),d,f,!1).valueOf()},"any, Array":function(p,d){return c(i(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+r.operators.xor+"${args[1]}\\right)"},f}var name$184="xor",factory_1$195=factory$196,xor$1={name:name$184,factory:factory_1$195},logical=[and$1,not$1,or$1,xor$1];function factory$197(l,t,e,n){var r=e(matrix),i=e(subtract$1),a=e(multiply$1),s=n("cross",{"Matrix, Matrix":function(u,c){return r(o(u.toArray(),c.toArray()))},"Matrix, Array":function(u,c){return r(o(u.toArray(),c))},"Array, Matrix":function(u,c){return r(o(u,c.toArray()))},"Array, Array":o});return s.toTex={2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},s;function o(u,c){var f=Math.max(array.size(u).length,array.size(c).length);u=array.squeeze(u),c=array.squeeze(c);var p=array.size(u),d=array.size(c);if(p.length!=1||d.length!=1||p[0]!=3||d[0]!=3)throw new RangeError("Vectors with length 3 expected (Size A = ["+p.join(", ")+"], B = ["+d.join(", ")+"])");var m=[i(a(u[1],c[2]),a(u[2],c[1])),i(a(u[2],c[0]),a(u[0],c[2])),i(a(u[0],c[1]),a(u[1],c[0]))];return f>1?[m]:m}}var name$185="cross",factory_1$196=factory$197,cross$1={name:name$185,factory:factory_1$196},clone$8=object.clone,isInteger$23=number.isInteger;function factory$198(l,t,e,n){var r=e(matrix),i=n("diag",{Array:function(u){return a(u,0,array.size(u),null)},"Array, number":function(u,c){return a(u,c,array.size(u),null)},"Array, BigNumber":function(u,c){return a(u,c.toNumber(),array.size(u),null)},"Array, string":function(u,c){return a(u,0,array.size(u),c)},"Array, number, string":function(u,c,f){return a(u,c,array.size(u),f)},"Array, BigNumber, string":function(u,c,f){return a(u,c.toNumber(),array.size(u),f)},Matrix:function(u){return a(u,0,u.size(),u.storage())},"Matrix, number":function(u,c){return a(u,c,u.size(),u.storage())},"Matrix, BigNumber":function(u,c){return a(u,c.toNumber(),u.size(),u.storage())},"Matrix, string":function(u,c){return a(u,0,u.size(),c)},"Matrix, number, string":function(u,c,f){return a(u,c,u.size(),f)},"Matrix, BigNumber, string":function(u,c,f){return a(u,c.toNumber(),u.size(),f)}});return i.toTex=void 0,i;function a(u,c,f,p){if(!isInteger$23(c))throw new TypeError("Second parameter in function diag must be an integer");var d=c>0?c:0,m=c<0?-c:0;switch(f.length){case 1:return s(u,c,p,f[0],m,d);case 2:return o(u,c,p,f,m,d)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function s(u,c,f,p,d,m){var v=[p+d,p+m],h=l.Matrix.storage(f||"dense"),y=h.diagonal(v,u,c);return f!==null?y:y.valueOf()}function o(u,c,f,p,d,m){if(l.isMatrix(u)){var v=u.diagonal(c);return f!==null?f!==v.storage()?r(v,f):v:v.valueOf()}for(var h=Math.min(p[0]-d,p[1]-m),y=[],g=0;g<h;g++)y[g]=u[g+d][g+m];return f!==null?r(y):y}}var name$186="diag",factory_1$197=factory$198,diag$1={name:name$186,factory:factory_1$197},size$3=array.size;function factory$199(l,t,e,n){var r=e(add),i=e(multiply$1),a=n("dot",{"Matrix, Matrix":function(o,u){return s(o.toArray(),u.toArray())},"Matrix, Array":function(o,u){return s(o.toArray(),u)},"Array, Matrix":function(o,u){return s(o,u.toArray())},"Array, Array":s});return a.toTex={2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},a;function s(o,u){var c=size$3(o),f=size$3(u),p=c[0];if(c.length!==1||f.length!==1)throw new RangeError("Vector expected");if(c[0]!=f[0])throw new RangeError("Vectors must have equal length ("+c[0]+" != "+f[0]+")");if(p==0)throw new RangeError("Cannot calculate the dot product of empty vectors");for(var d=0,m=0;m<p;m++)d=r(d,i(o[m],u[m]));return d}}var name$187="dot",factory_1$198=factory$199,dot$1={name:name$187,factory:factory_1$198},format$6=string.format;function factory$200(l,t,e,n){var r=e(abs$1),i=e(add),a=e(eye$1),s=e(inv$1),o=e(multiply$1),u=l.SparseMatrix,c=n("expm",{Matrix:function(m){var v=m.size();if(v.length!==2||v[0]!==v[1])throw new RangeError("Matrix must be square (size: "+format$6(v)+")");for(var h=v[0],y=1e-15,g=f(m),b=p(g,y),x=b.q,N=b.j,C=o(m,Math.pow(2,-N)),_=a(h),w=a(h),A=1,$=C,S=-1,D=1;D<=x;D++)D>1&&($=o($,C),S=-S),A=A*(x-D+1)/((2*x-D+1)*D),_=i(_,o(A,$)),w=i(w,o(A*S,$));for(var V=o(s(w),_),D=0;D<N;D++)V=o(V,V);return l.isSparseMatrix(m)?new u(V):V}});function f(m){for(var v=m.size()[0],h=0,y=0;y<v;y++){for(var g=0,b=0;b<v;b++)g+=r(m.get([y,b]));h=Math.max(g,h)}return h}function p(m,v){for(var h=30,y=0;y<h;y++)for(var g=0;g<=y;g++){var b=y-g;if(d(m,g,b)<v)return{q:g,j:b}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}function d(m,v,h){for(var y=1,g=2;g<=v;g++)y*=g;for(var b=y,g=v+1;g<=2*v;g++)b*=g;var x=b*(2*v+1);return 8*Math.pow(m/Math.pow(2,h),2*v)*y*y/(b*x)}return c.toTex={1:"\\exp\\left(${args[0]}\\right)"},c}var name$188="expm",factory_1$199=factory$200,expm$1={name:name$188,factory:factory_1$199},filter$2=array.filter,filterRegExp$1=array.filterRegExp,maxArgumentCount$4=_function.maxArgumentCount;function factory$201(l,t,e,n){var r=e(matrix),i=n("filter",{"Array, function":_filterCallback,"Matrix, function":function(a,s){return r(_filterCallback(a.toArray(),s))},"Array, RegExp":filterRegExp$1,"Matrix, RegExp":function(a,s){return r(filterRegExp$1(a.toArray(),s))}});return i.toTex=void 0,i}function _filterCallback(l,t){var e=maxArgumentCount$4(t);return filter$2(l,function(n,r,i){return e===1?t(n):e===2?t(n,[r]):t(n,[r],i)})}var name$189="filter",factory_1$200=factory$201,filter_1={name:name$189,factory:factory_1$200},clone$9=object.clone,_flatten=array.flatten;function factory$202(l,t,e,n){var r=e(matrix),i=n("flatten",{Array:function(a){return _flatten(clone$9(a))},Matrix:function(a){var s=_flatten(clone$9(a.toArray()));return r(s)}});return i.toTex=void 0,i}var name$190="flatten",factory_1$201=factory$202,flatten$3={name:name$190,factory:factory_1$201},maxArgumentCount$5=_function.maxArgumentCount,forEach$4=array.forEach;function factory$203(l,t,e,n){var r=n("forEach",{"Array, function":_forEach,"Matrix, function":function(i,a){return i.forEach(a)}});return r.toTex=void 0,r}function _forEach(l,t){var e=maxArgumentCount$5(t),n=function(r,i){Array.isArray(r)?forEach$4(r,function(a,s){n(a,i.concat(s))}):e===1?t(r):e===2?t(r,i):t(r,i,l)};n(l,[])}var name$191="forEach",factory_1$202=factory$203,forEach_1={name:name$191,factory:factory_1$202},size$4=array.size;function factory$204(l,t,e,n){var r=e(matrix),i=e(multiplyScalar),a=n("kron",{"Matrix, Matrix":function(o,u){return r(s(o.toArray(),u.toArray()))},"Matrix, Array":function(o,u){return r(s(o.toArray(),u))},"Array, Matrix":function(o,u){return r(s(o,u.toArray()))},"Array, Array":s});return a;function s(o,u){if(size$4(o).length===1&&(o=[o]),size$4(u).length===1&&(u=[u]),size$4(o).length>2||size$4(u).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(o.length)+", y = "+JSON.stringify(u.length)+")");var c=[],f=[];return o.map(function(p){return u.map(function(d){return p.map(function(m){return d.map(function(v){return f.push(i(m,v))})},c.push(f=[]))})},c=[])&&c}}var name$192="kron",factory_1$203=factory$204,kron$1={name:name$192,factory:factory_1$203},maxArgumentCount$6=_function.maxArgumentCount;function factory$205(l,t,e,n){var r=n("map",{"Array, function":_map$1,"Matrix, function":function(i,a){return i.map(a)}});return r.toTex=void 0,r}function _map$1(l,t){var e=maxArgumentCount$6(t),n=function(r,i){return Array.isArray(r)?r.map(function(a,s){return n(a,i.concat(s))}):e===1?t(r):e===2?t(r,i):t(r,i,l)};return n(l,[])}var name$193="map",factory_1$204=factory$205,map$7={name:name$193,factory:factory_1$204},isInteger$24=number.isInteger,resize$2=array.resize;function factory$206(l,t,e,n){var r=e(matrix),i=n("ones",{"":function(){return t.matrix==="Array"?a([]):a([],"default")},"...number | BigNumber | string":function(u){var c=u[u.length-1];if(typeof c=="string"){var f=u.pop();return a(u,f)}else return t.matrix==="Array"?a(u):a(u,"default")},Array:a,Matrix:function(u){var c=u.storage();return a(u.valueOf(),c)},"Array | Matrix, string":function(u,c){return a(u.valueOf(),c)}});return i.toTex=void 0,i;function a(u,c){var f=s(u),p=f?new l.BigNumber(1):1;if(o(u),c){var d=r(c);return u.length>0?d.resize(u,p):d}else{var m=[];return u.length>0?resize$2(m,u,p):m}}function s(u){var c=!1;return u.forEach(function(f,p,d){l.isBigNumber(f)&&(c=!0,d[p]=f.toNumber())}),c}function o(u){u.forEach(function(c){if(typeof c!="number"||!isInteger$24(c)||c<0)throw new Error("Parameters in function ones must be positive integers")})}}var name$194="ones",factory_1$205=factory$206,ones$1={name:name$194,factory:factory_1$205},nearlyEqual$6=number.nearlyEqual;function factory$207(l,t,e,n){var r=e(matrix),i=e(algorithm03),a=e(algorithm05),s=e(algorithm12),o=e(algorithm13),u=e(algorithm14),c=n("compare",{"boolean, boolean":function(f,p){return f===p?0:f>p?1:-1},"number, number":function(f,p){return f===p||nearlyEqual$6(f,p,t.epsilon)?0:f>p?1:-1},"BigNumber, BigNumber":function(f,p){return f.eq(p)||nearlyEqual(f,p,t.epsilon)?new l.BigNumber(0):new l.BigNumber(f.cmp(p))},"Fraction, Fraction":function(f,p){return new l.Fraction(f.compare(p))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(f,p){if(!f.equalBase(p))throw new Error("Cannot compare units with different base");return c(f.value,p.value)},"SparseMatrix, SparseMatrix":function(f,p){return a(f,p,c)},"SparseMatrix, DenseMatrix":function(f,p){return i(p,f,c,!0)},"DenseMatrix, SparseMatrix":function(f,p){return i(f,p,c,!1)},"DenseMatrix, DenseMatrix":function(f,p){return o(f,p,c)},"Array, Array":function(f,p){return c(r(f),r(p)).valueOf()},"Array, Matrix":function(f,p){return c(r(f),p)},"Matrix, Array":function(f,p){return c(f,r(p))},"SparseMatrix, any":function(f,p){return s(f,p,c,!1)},"DenseMatrix, any":function(f,p){return u(f,p,c,!1)},"any, SparseMatrix":function(f,p){return s(p,f,c,!0)},"any, DenseMatrix":function(f,p){return u(p,f,c,!0)},"Array, any":function(f,p){return u(r(f),p,c,!1).valueOf()},"any, Array":function(f,p){return u(r(p),f,c,!0).valueOf()}});return c.toTex=void 0,c}var name$195="compare",factory_1$206=factory$207,compare$1={name:name$195,factory:factory_1$206},isInteger$25=number.isInteger;function factory$208(l,t,e,n){var r=e(compare$1);function i(o,u){return-r(o,u)}return n("partitionSelect",{"Array | Matrix, number":function(o,u){return a(o,u,r)},"Array | Matrix, number, string":function(o,u,c){if(c==="asc")return a(o,u,r);if(c==="desc")return a(o,u,i);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":a});function a(o,u,c){if(!isInteger$25(u)||u<0)throw new Error("k must be a non-negative integer");if(l.isMatrix(o)){var f=o.size();if(f.length>1)throw new Error("Only one dimensional matrices supported");return s(o.valueOf(),u,c)}if(Array.isArray(o))return s(o,u,c)}function s(o,u,c){if(u>=o.length)throw new Error("k out of bounds");for(var f=0,p=o.length-1;f<p;){for(var d=f,m=p,v=o[Math.floor(Math.random()*(p-f+1))+f];d<m;)if(c(o[d],v)>=0){var h=o[m];o[m]=o[d],o[d]=h,--m}else++d;c(o[d],v)>0&&--d,u<=d?p=d:f=d+1}return o[u]}}var name$196="partitionSelect",factory_1$207=factory$208,partitionSelect$1={name:name$196,factory:factory_1$207},isInteger$26=number.isInteger;function factory$209(l,t,e,n){var r=e(matrix),i=n("reshape",{"Matrix, Array":function(a,s){return a.reshape?a.reshape(s):r(array.reshape(a.valueOf(),s))},"Array, Array":function(a,s){return s.forEach(function(o){if(!isInteger$26(o))throw new TypeError("Invalid size for dimension: "+o)}),array.reshape(a,s)}});return i.toTex=void 0,i}var name$197="reshape",factory_1$208=factory$209,reshape$1={name:name$197,factory:factory_1$208},isInteger$27=number.isInteger,format$7=string.format,clone$10=object.clone;function factory$210(l,t,e,n){var r=e(matrix),i=function(o,u,c){if(arguments.length!=2&&arguments.length!=3)throw new ArgumentsError_1("resize",arguments.length,2,3);if(l.isMatrix(u)&&(u=u.valueOf()),l.isBigNumber(u[0])&&(u=u.map(function(d){return l.isBigNumber(d)?d.toNumber():d})),l.isMatrix(o))return o.resize(u,c,!0);if(typeof o=="string")return a(o,u,c);var f=Array.isArray(o)?!1:t.matrix!=="Array";if(u.length==0){for(;Array.isArray(o);)o=o[0];return clone$10(o)}else{Array.isArray(o)||(o=[o]),o=clone$10(o);var p=array.resize(o,u,c);return f?r(p):p}};return i.toTex=void 0,i;function a(s,o,u){if(u!==void 0){if(typeof u!="string"||u.length!==1)throw new TypeError("Single character expected as defaultValue")}else u=" ";if(o.length!==1)throw new DimensionError_1(o.length,1);var c=o[0];if(typeof c!="number"||!isInteger$27(c))throw new TypeError("Invalid size, must contain positive integers (size: "+format$7(o)+")");if(s.length>c)return s.substring(0,c);if(s.length<c){for(var f=s,p=0,d=c-s.length;p<d;p++)f+=u;return f}else return s}}var name$198="resize",factory_1$209=factory$210,resize$3={name:name$198,factory:factory_1$209};function factory$211(l,t,e,n){var r=e(matrix),i=n("size",{Matrix:function(a){return r(a.size())},Array:array.size,string:function(a){return t.matrix==="Array"?[a.length]:r([a.length])},"number | Complex | BigNumber | Unit | boolean | null":function(a){return t.matrix==="Array"?[]:r([])}});return i.toTex=void 0,i}var name$199="size",factory_1$210=factory$211,size$5={name:name$199,factory:factory_1$210},naturalSort=function l(t,e){var n=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,r=/(^[ ]*|[ ]*$)/g,i=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,a=/^0x[0-9a-f]+$/i,s=/^0/,o=function(b){return l.insensitive&&(""+b).toLowerCase()||""+b},u=o(t).replace(r,"")||"",c=o(e).replace(r,"")||"",f=u.replace(n,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=c.replace(n,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),d=parseInt(u.match(a),16)||f.length!==1&&u.match(i)&&Date.parse(u),m=parseInt(c.match(a),16)||d&&c.match(i)&&Date.parse(c)||null,v,h;if(m){if(d<m)return-1;if(d>m)return 1}for(var y=0,g=Math.max(f.length,p.length);y<g;y++){if(v=!(f[y]||"").match(s)&&parseFloat(f[y])||f[y]||0,h=!(p[y]||"").match(s)&&parseFloat(p[y])||p[y]||0,isNaN(v)!==isNaN(h))return isNaN(v)?1:-1;if(typeof v!=typeof h&&(v+="",h+=""),v<h)return-1;if(v>h)return 1}return 0};function factory$212(l,t,e,n){var r=e(_typeof$1),i=e(compare$1),a=i.signatures["boolean,boolean"],s=n("compareNatural",{"any, any":function(f,p){var d=r(f),m=r(p),v;if((d==="number"||d==="BigNumber"||d==="Fraction")&&(m==="number"||m==="BigNumber"||m==="Fraction"))return v=i(f,p),v.toString()!=="0"?v>0?1:-1:naturalSort(d,m);if(d==="Array"||d==="Matrix"||m==="Array"||m==="Matrix")return v=o(f,p),v!==0?v:naturalSort(d,m);if(d!==m)return naturalSort(d,m);if(d==="Complex")return compareComplexNumbers(f,p);if(d==="Unit")return f.equalBase(p)?s(f.value,p.value):u(f.formatUnits(),p.formatUnits());if(d==="boolean")return a(f,p);if(d==="string")return naturalSort(f,p);if(d==="Object")return c(f,p);if(d==="null"||d==="undefined")return 0;throw new TypeError('Unsupported type of value "'+d+'"')}});s.toTex=void 0;function o(f,p){return l.isSparseMatrix(f)&&l.isSparseMatrix(p)?u(f.toJSON().values,p.toJSON().values):l.isSparseMatrix(f)?o(f.toArray(),p):l.isSparseMatrix(p)?o(f,p.toArray()):l.isDenseMatrix(f)?o(f.toJSON().data,p):l.isDenseMatrix(p)?o(f,p.toJSON().data):Array.isArray(f)?Array.isArray(p)?u(f,p):o(f,[p]):o([f],p)}function u(f,p){for(var d=0,m=Math.min(f.length,p.length);d<m;d++){var v=s(f[d],p[d]);if(v!==0)return v}return f.length>p.length?1:f.length<p.length?-1:0}function c(f,p){var d=Object.keys(f),m=Object.keys(p);d.sort(naturalSort),m.sort(naturalSort);var v=u(d,m);if(v!==0)return v;for(var h=0;h<d.length;h++){var y=s(f[d[h]],p[m[h]]);if(y!==0)return y}return 0}return s}function compareComplexNumbers(l,t){return l.re>t.re?1:l.re<t.re?-1:l.im>t.im?1:l.im<t.im?-1:0}var name$200="compareNatural",factory_1$211=factory$212,compareNatural$1={name:name$200,factory:factory_1$211},size$6=array.size;function factory$213(l,t,e,n){var r=e(matrix),i=e(compare$1),a=function(p,d){return-i(p,d)},s=e(compareNatural$1),o=n("sort",{Array:function(p){return c(p),p.sort(i)},Matrix:function(p){return f(p),r(p.toArray().sort(i),p.storage())},"Array, function":function(p,d){return c(p),p.sort(d)},"Matrix, function":function(p,d){return f(p),r(p.toArray().sort(d),p.storage())},"Array, string":function(p,d){return c(p),p.sort(u(d))},"Matrix, string":function(p,d){return f(p),r(p.toArray().sort(u(d)),p.storage())}});o.toTex=void 0;function u(p){if(p==="asc")return i;if(p==="desc")return a;if(p==="natural")return s;throw new Error('String "asc", "desc", or "natural" expected')}function c(p){if(size$6(p).length!==1)throw new Error("One dimensional array expected")}function f(p){if(p.size().length!==1)throw new Error("One dimensional matrix expected")}return o}var name$201="sort",factory_1$212=factory$213,sort$1={name:name$201,factory:factory_1$212};function factory$214(l,t,e,n){var r=e(matrix),i=e(abs$1),a=e(add),s=e(divide$1),o=e(multiply$1),u=e(sqrt$1),c=e(subtract$1),f=e(inv$1),p=e(size$5),d=e(max$1),m=e(eye$1),v=n("sqrtm",{"Array | Matrix":function(b){var x=l.isMatrix(b)?b.size():array.size(b);switch(x.length){case 1:if(x[0]==1)return u(b);throw new RangeError("Matrix must be square (size: "+string.format(x)+")");case 2:var N=x[0],C=x[1];if(N==C)return g(b);throw new RangeError("Matrix must be square (size: "+string.format(x)+")")}}}),h=1e3,y=1e-6;function g(b){var x,N=0,C=b,_=m(p(b));do{var w=C;if(C=o(.5,a(w,f(_))),_=o(.5,a(_,f(w))),x=d(i(c(C,w))),x>y&&++N>h)throw new Error("computing square root of matrix: iterative method could not converge")}while(x>y);return C}return v.toTex={1:"{${args[0]}}"+latex.operators.pow+"{\\frac{1}{2}}"},v}var name$202="sqrtm",factory_1$213=factory$214,sqrtm$1={name:name$202,factory:factory_1$213};function factory$215(l,t,e,n){var r=e(matrix),i=n("squeeze",{Array:function(a){return array.squeeze(object.clone(a))},Matrix:function(a){var s=array.squeeze(a.toArray());return Array.isArray(s)?r(s):s},any:function(a){return object.clone(a)}});return i.toTex=void 0,i}var name$203="squeeze",factory_1$214=factory$215,squeeze$1={name:name$203,factory:factory_1$214},matrix$3=[concat$1,cross$1,det$1,diag$1,dot$1,eye$1,expm$1,filter_1,flatten$3,forEach_1,inv$1,kron$1,map$7,ones$1,partitionSelect$1,range$1,reshape$1,resize$3,size$5,sort$1,sqrtm$1,squeeze$1,subset$1,trace$1,transpose$1,zeros$1];function factory$216(l,t,e,n){var r=e(addScalar),i=e(improveErrorMessage),a=n("sum",{"Array | Matrix":function(o){return s(o)},"Array | Matrix, number | BigNumber":function(){throw new Error("sum(A, dim) is not yet supported")},"...":function(o){return s(o)}});return a.toTex=void 0,a;function s(o){var u=void 0;if(deepForEach(o,function(c){try{u=u===void 0?c:r(u,c)}catch(f){throw i(f,"sum",c)}}),u===void 0)switch(t.number){case"number":return 0;case"BigNumber":return new l.BigNumber(0);case"Fraction":return new l.Fraction(0);default:return 0}return u}}var name$204="sum",factory_1$215=factory$216,sum$1={name:name$204,factory:factory_1$215};function factory$217(l,t,e,n){var r=e(matrix),i=e(divide$1),a=e(sum$1),s=e(multiply$1),o=e(dotDivide$1),u=e(log$1),c=e(isNumeric$1),f=n("kldivergence",{"Array, Array":function(d,m){return p(r(d),r(m))},"Matrix, Array":function(d,m){return p(d,r(m))},"Array, Matrix":function(d,m){return p(r(d),m)},"Matrix, Matrix":function(d,m){return p(d,m)}});function p(d,m){var v=m.size().length,h=d.size().length;if(v>1)throw new Error("first object must be one dimensional");if(h>1)throw new Error("second object must be one dimensional");if(v!==h)throw new Error("Length of two vectors must be equal");var y=a(d);if(y===0)throw new Error("Sum of elements in first object must be non zero");var g=a(m);if(g===0)throw new Error("Sum of elements in second object must be non zero");var b=i(d,a(d)),x=i(m,a(m)),N=a(s(b,u(o(b,x))));return c(N)?N:Number.NaN}return f}var name$205="kldivergence",factory_1$216=factory$217,kldivergence$1={name:name$205,factory:factory_1$216};function factory$218(l,t,e,n){var r=e(add),i=e(multiply$1),a=e(divide$1),s=e(factorial$1),o=e(isInteger$22),u=e(isPositive$1);return n("multinomial",{"Array | Matrix":function(c){var f=0,p=1;return deepForEach(c,function(d){if(!o(d)||!u(d))throw new TypeError("Positive integer value expected in function multinomial");f=r(f,d),p=i(p,s(d))}),a(s(f),p)}})}var name$206="multinomial",factory_1$217=factory$218,multinomial$1={name:name$206,factory:factory_1$217},isInteger$28=number.isInteger;function factory$219(l,t,e,n){var r=e(factorial$1),i=n("permutations",{"number | BigNumber":r,"number, number":function(a,s){var o,u;if(!isInteger$28(a)||a<0)throw new TypeError("Positive integer value expected in function permutations");if(!isInteger$28(s)||s<0)throw new TypeError("Positive integer value expected in function permutations");if(s>a)throw new TypeError("second argument k must be less than or equal to first argument n");for(o=1,u=a-s+1;u<=a;u++)o=o*u;return o},"BigNumber, BigNumber":function(a,s){var o,u;if(!isPositiveInteger$1(a)||!isPositiveInteger$1(s))throw new TypeError("Positive integer value expected in function permutations");if(s.gt(a))throw new TypeError("second argument k must be less than or equal to first argument n");for(o=new l.BigNumber(1),u=a.minus(s).plus(1);u.lte(a);u=u.plus(1))o=o.times(u);return o}});return i.toTex=void 0,i}function isPositiveInteger$1(l){return l.isInteger()&&l.gte(0)}var name$207="permutations",factory_1$218=factory$219,permutations$1={name:name$207,factory:factory_1$218},seedRandom=createCommonjsModule(function(l){var t=256,e=6,n=52,r=[],i=typeof commonjsGlobal=="undefined"?window:commonjsGlobal,a=Math.pow(t,e),s=Math.pow(2,n),o=s*2,u=t-1,c=Math.random;l.exports=function(h,y){if(y&&y.global===!0)return y.global=!1,Math.random=l.exports(h,y),y.global=!0,Math.random;var g=y&&y.entropy||!1,b=[],x=d(p(g?[h,v(r)]:0 in arguments?h:m(),3),b),N=new f(b);return d(v(N.S),r),function(){for(var C=N.g(e),_=a,w=0;C<s;)C=(C+w)*t,_*=t,w=N.g(1);for(;C>=o;)C/=2,_/=2,w>>>=1;return(C+w)/_}},l.exports.resetGlobal=function(){Math.random=c};function f(h){var y,g=h.length,b=this,x=0,N=b.i=b.j=0,C=b.S=[];for(g||(h=[g++]);x<t;)C[x]=x++;for(x=0;x<t;x++)C[x]=C[N=u&N+h[x%g]+(y=C[x])],C[N]=y;(b.g=function(_){for(var w,A=0,$=b.i,S=b.j,D=b.S;_--;)w=D[$=u&$+1],A=A*t+D[u&(D[$]=D[S=u&S+w])+(D[S]=w)];return b.i=$,b.j=S,A})(t)}function p(h,y){var g=[],b=(typeof h)[0],x;if(y&&b=="o")for(x in h)try{g.push(p(h[x],y-1))}catch(N){}return g.length?g:b=="s"?h:h+"\0"}function d(h,y){for(var g=h+"",b,x=0;x<g.length;)y[u&x]=u&(b^=y[u&x]*19)+g.charCodeAt(x++);return v(y)}function m(h){try{return i.crypto.getRandomValues(h=new Uint8Array(t)),v(h)}catch(y){return[+new Date,i,i.navigator&&i.navigator.plugins,i.screen,v(r)]}}function v(h){return String.fromCharCode.apply(0,h)}d(Math.random(),r)}),seedRandom_1=seedRandom.resetGlobal,singletonRandom=seedRandom();function factory$220(l,t,e,n,r){var i;function a(o){i=o===null?singletonRandom:seedRandom(String(o))}a(t.randomSeed);function s(){return i()}return r.on("config",function(o,u,c){c.randomSeed!==void 0&&a(o.randomSeed)}),s}var factory_1$219=factory$220,math$17=!0,seededRNG={factory:factory_1$219,math:math$17},isNumber$3=number.isNumber;function factory$221(l,t,e,n,r){var i=e(matrix),a=array,s=e(seededRNG);function o(c){if(!u.hasOwnProperty(c))throw new Error("Unknown distribution "+c);var f=Array.prototype.slice.call(arguments,1),p=u[c].apply(this,f);return function(d){var m={random:function(b,x,N){var C,_,w;if(arguments.length>3)throw new ArgumentsError_1("random",arguments.length,0,3);if(arguments.length===1?isCollection(b)?C=b:w=b:arguments.length===2?isCollection(b)?(C=b,w=x):(_=b,w=x):(C=b,_=x,w=N),_!==void 0&&!isNumber$3(_)||w!==void 0&&!isNumber$3(w))throw new TypeError("Invalid argument in function random");if(w===void 0&&(w=1),_===void 0&&(_=0),C!==void 0){var A=g(C.valueOf(),_,w,h);return l.isMatrix(C)?i(A):A}return h(_,w)},randomInt:n({"number | Array":function(b){var x=0;if(isCollection(b)){var N=b,C=1,_=g(N.valueOf(),x,C,y);return l.isMatrix(N)?i(_):_}else{var C=b;return y(x,C)}},"number | Array, number":function(b,x){if(isCollection(b)){var N=b,C=x,_=0,w=g(N.valueOf(),_,C,y);return l.isMatrix(N)?i(w):w}else{var _=b,C=x;return y(_,C)}},"Array, number, number":function(b,x,N){var C=g(b.valueOf(),x,N,y);return b&&b.isMatrix===!0?i(C):C}}),pickRandom:n({Array:function(b){return v(b)},"Array, number | Array":function(b,x){var N,C;if(Array.isArray(x))C=x;else if(isNumber$3(x))N=x;else throw new TypeError("Invalid argument in function pickRandom");return v(b,N,C)},"Array, number | Array, Array | number":function(b,x,N){var C,_;if(Array.isArray(x)?(_=x,C=N):(_=N,C=x),!Array.isArray(_)||!isNumber$3(C))throw new TypeError("Invalid argument in function pickRandom");return v(b,C,_)}})},v=function(b,x,N){var C=typeof x=="undefined";if(C&&(x=1),l.isMatrix(b))b=b.valueOf();else if(!Array.isArray(b))throw new TypeError("Unsupported type of value in function pickRandom");if(a.size(b).length>1)throw new Error("Only one dimensional vectors supported");if(typeof N!="undefined"){if(N.length!=b.length)throw new Error("Weights must have the same length as possibles");for(var _=0,w=0,A=N.length;w<A;w++){if(!isNumber$3(N[w])||N[w]<0)throw new Error("Weights must be an array of positive numbers");_+=N[w]}}var $=b.length;if($==0)return[];if(x>=$)return x>1?b:b[0];for(var S=[],D;S.length<x;){if(typeof N=="undefined")D=b[Math.floor(s()*$)];else for(var V=s()*_,w=0,A=b.length;w<A;w++)if(V-=N[w],V<0){D=b[w];break}S.indexOf(D)==-1&&S.push(D)}return C?S[0]:S},h=function(b,x){return b+d()*(x-b)},y=function(b,x){return Math.floor(b+d()*(x-b))},g=function(b,x,N,C){var _=[],w,A;if(b=b.slice(0),b.length>1)for(var A=0,w=b.shift();A<w;A++)_.push(g(b,x,N,C));else for(var A=0,w=b.shift();A<w;A++)_.push(C(x,N));return _};return m}(p)}var u={uniform:function(){return s},normal:function(){return function(){for(var c,f,p=-1;p<0||p>1;)c=s(),f=s(),p=1/6*Math.pow(-2*Math.log(c),.5)*Math.cos(2*Math.PI*f)+.5;return p}}};return o.toTex=void 0,o}var name$208="distribution",factory_1$220=factory$221,distribution={name:name$208,factory:factory_1$220};function factory$222(l,t,e,n){var r=e(distribution),i=r("uniform").pickRandom;return i.toTex=void 0,i}var name$209="pickRandom",factory_1$221=factory$222,pickRandom$1={name:name$209,factory:factory_1$221};function factory$223(l,t,e,n){var r=e(distribution),i=r("uniform").random;return i.toTex=void 0,i}var name$210="random",factory_1$222=factory$223,random$1={name:name$210,factory:factory_1$222};function factory$224(l,t,e,n){var r=e(distribution),i=r("uniform").randomInt;return i.toTex=void 0,i}var name$211="randomInt",factory_1$223=factory$224,randomInt$1={name:name$211,factory:factory_1$223},probability=[combinations$1,factorial$1,gamma$1,kldivergence$1,multinomial$1,permutations$1,pickRandom$1,random$1,randomInt$1];function factory$225(l,t,e,n){var r=e(matrix),i=e(_typeof$1),a=e(algorithm13),s=e(algorithm14),o=n("compareText",{"any, any":u,"DenseMatrix, DenseMatrix":function(c,f){return a(c,f,u)},"Array, Array":function(c,f){return o(r(c),r(f)).valueOf()},"Array, Matrix":function(c,f){return o(r(c),f)},"Matrix, Array":function(c,f){return o(c,r(f))},"DenseMatrix, any":function(c,f){return s(c,f,u,!1)},"any, DenseMatrix":function(c,f){return s(f,c,u,!0)},"Array, any":function(c,f){return s(r(c),f,u,!1).valueOf()},"any, Array":function(c,f){return s(r(f),c,u,!0).valueOf()}});function u(c,f){if(!l.isString(c))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+i(c)+", index: 0)");if(!l.isString(f))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+i(f)+", index: 1)");return c===f?0:c>f?1:-1}return o.toTex=void 0,o}var name$212="compareText",factory_1$224=factory$225,compareText$1={name:name$212,factory:factory_1$224};function factory$226(l,t,e,n){var r=e(equal$1),i=n("deepEqual",{"any, any":function(s,o){return a(s.valueOf(),o.valueOf())}});return i.toTex=void 0,i;function a(s,o){if(Array.isArray(s))if(Array.isArray(o)){var u=s.length;if(u!==o.length)return!1;for(var c=0;c<u;c++)if(!a(s[c],o[c]))return!1;return!0}else return!1;else return Array.isArray(o)?!1:r(s,o)}}var name$213="deepEqual",factory_1$225=factory$226,deepEqual$2={name:name$213,factory:factory_1$225};function factory$227(l,t,e,n){var r=e(compareText$1),i=e(isZero$1),a=n("equalText",{"any, any":function(s,o){return i(r(s,o))}});return a.toTex=void 0,a}var name$214="equalText",factory_1$226=factory$227,equalText$1={name:name$214,factory:factory_1$226},nearlyEqual$7=number.nearlyEqual;function factory$228(l,t,e,n){var r=e(matrix),i=e(algorithm03),a=e(algorithm07),s=e(algorithm12),o=e(algorithm13),u=e(algorithm14),c=latex,f=n("smallerEq",{"boolean, boolean":function(p,d){return p<=d},"number, number":function(p,d){return p<=d||nearlyEqual$7(p,d,t.epsilon)},"BigNumber, BigNumber":function(p,d){return p.lte(d)||nearlyEqual(p,d,t.epsilon)},"Fraction, Fraction":function(p,d){return p.compare(d)!==1},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(p,d){if(!p.equalBase(d))throw new Error("Cannot compare units with different base");return f(p.value,d.value)},"SparseMatrix, SparseMatrix":function(p,d){return a(p,d,f)},"SparseMatrix, DenseMatrix":function(p,d){return i(d,p,f,!0)},"DenseMatrix, SparseMatrix":function(p,d){return i(p,d,f,!1)},"DenseMatrix, DenseMatrix":function(p,d){return o(p,d,f)},"Array, Array":function(p,d){return f(r(p),r(d)).valueOf()},"Array, Matrix":function(p,d){return f(r(p),d)},"Matrix, Array":function(p,d){return f(p,r(d))},"SparseMatrix, any":function(p,d){return s(p,d,f,!1)},"DenseMatrix, any":function(p,d){return u(p,d,f,!1)},"any, SparseMatrix":function(p,d){return s(d,p,f,!0)},"any, DenseMatrix":function(p,d){return u(d,p,f,!0)},"Array, any":function(p,d){return u(r(p),d,f,!1).valueOf()},"any, Array":function(p,d){return u(r(d),p,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+c.operators.smallerEq+"${args[1]}\\right)"},f}var name$215="smallerEq",factory_1$227=factory$228,smallerEq$1={name:name$215,factory:factory_1$227},relational=[compare$1,compareNatural$1,compareText$1,deepEqual$2,equal$1,equalText$1,larger,largerEq$1,smaller,smallerEq$1,unequal$1],flatten$4=array.flatten;function factory$229(l,t,e,n){var r=e(MatrixIndex),i=e(DenseMatrix),a=e(size$5),s=e(subset$1),o=e(compareNatural$1),u=n("setCartesian",{"Array | Matrix, Array | Matrix":function(c,f){if(s(a(c),new r(0))===0||s(a(f),new r(0))===0)var p=[];else for(var d=flatten$4(Array.isArray(c)?c:c.toArray()).sort(o),m=flatten$4(Array.isArray(f)?f:f.toArray()).sort(o),p=[],v=0;v<d.length;v++)for(var h=0;h<m.length;h++)p.push([d[v],m[h]]);return Array.isArray(c)&&Array.isArray(f)?p:new i(p)}});return u}var name$216="setCartesian",factory_1$228=factory$229,setCartesian$1={name:name$216,factory:factory_1$228},flatten$5=array.flatten,identify=array.identify,generalize=array.generalize;function factory$230(l,t,e,n){var r=e(MatrixIndex),i=e(DenseMatrix),a=e(size$5),s=e(subset$1),o=e(compareNatural$1),u=n("setDifference",{"Array | Matrix, Array | Matrix":function(c,f){if(s(a(c),new r(0))===0)var p=[];else{if(s(a(f),new r(0))===0)return flatten$5(c.toArray());for(var d=identify(flatten$5(Array.isArray(c)?c:c.toArray()).sort(o)),m=identify(flatten$5(Array.isArray(f)?f:f.toArray()).sort(o)),p=[],v,h=0;h<d.length;h++){v=!1;for(var y=0;y<m.length;y++)if(o(d[h].value,m[y].value)===0&&d[h].identifier===m[y].identifier){v=!0;break}v||p.push(d[h])}}return Array.isArray(c)&&Array.isArray(f)?generalize(p):new i(generalize(p))}});return u}var name$217="setDifference",factory_1$229=factory$230,setDifference$1={name:name$217,factory:factory_1$229},flatten$6=array.flatten;function factory$231(l,t,e,n){var r=e(MatrixIndex),i=e(DenseMatrix),a=e(size$5),s=e(subset$1),o=e(compareNatural$1),u=n("setDistinct",{"Array | Matrix":function(c){if(s(a(c),new r(0))===0)var f=[];else{var p=flatten$6(Array.isArray(c)?c:c.toArray()).sort(o),f=[];f.push(p[0]);for(var d=1;d<p.length;d++)o(p[d],p[d-1])!==0&&f.push(p[d])}return Array.isArray(c)?f:new i(f)}});return u}var name$218="setDistinct",factory_1$230=factory$231,setDistinct$1={name:name$218,factory:factory_1$230},flatten$7=array.flatten,identify$1=array.identify,generalize$1=array.generalize;function factory$232(l,t,e,n){var r=e(MatrixIndex),i=e(DenseMatrix),a=e(size$5),s=e(subset$1),o=e(compareNatural$1),u=n("setIntersect",{"Array | Matrix, Array | Matrix":function(c,f){if(s(a(c),new r(0))===0||s(a(f),new r(0))===0)var p=[];else for(var d=identify$1(flatten$7(Array.isArray(c)?c:c.toArray()).sort(o)),m=identify$1(flatten$7(Array.isArray(f)?f:f.toArray()).sort(o)),p=[],v=0;v<d.length;v++)for(var h=0;h<m.length;h++)if(o(d[v].value,m[h].value)===0&&d[v].identifier===m[h].identifier){p.push(d[v]);break}return Array.isArray(c)&&Array.isArray(f)?generalize$1(p):new i(generalize$1(p))}});return u}var name$219="setIntersect",factory_1$231=factory$232,setIntersect$1={name:name$219,factory:factory_1$231},flatten$8=array.flatten,identify$2=array.identify;function factory$233(l,t,e,n){var r=e(MatrixIndex),i=e(size$5),a=e(subset$1),s=e(compareNatural$1),o=n("setIsSubset",{"Array | Matrix, Array | Matrix":function(u,c){if(a(i(u),new r(0))===0)return!0;if(a(i(c),new r(0))===0)return!1;for(var f=identify$2(flatten$8(Array.isArray(u)?u:u.toArray()).sort(s)),p=identify$2(flatten$8(Array.isArray(c)?c:c.toArray()).sort(s)),d,m=0;m<f.length;m++){d=!1;for(var v=0;v<p.length;v++)if(s(f[m].value,p[v].value)===0&&f[m].identifier===p[v].identifier){d=!0;break}if(d===!1)return!1}return!0}});return o}var name$220="setIsSubset",factory_1$232=factory$233,setIsSubset$1={name:name$220,factory:factory_1$232},flatten$9=array.flatten;function factory$234(l,t,e,n){var r=e(compareNatural$1),i=e(MatrixIndex),a=e(size$5),s=e(subset$1),o=n("setMultiplicity",{"number | BigNumber | Fraction | Complex, Array | Matrix":function(u,c){if(s(a(c),new i(0))===0)return 0;for(var f=flatten$9(Array.isArray(c)?c:c.toArray()),p=0,d=0;d<f.length;d++)r(f[d],u)===0&&p++;return p}});return o}var name$221="setMultiplicity",factory_1$233=factory$234,setMultiplicity$1={name:name$221,factory:factory_1$233},flatten$10=array.flatten;function factory$235(l,t,e,n){var r=e(MatrixIndex),i=e(size$5),a=e(subset$1),s=e(compareNatural$1),o=n("setPowerset",{"Array | Matrix":function(f){if(a(i(f),new r(0))===0)return[];for(var p=flatten$10(Array.isArray(f)?f:f.toArray()).sort(s),d=[],m=0;m.toString(2).length<=p.length;)d.push(u(p,m.toString(2).split("").reverse())),m++;return c(d)}});return o;function u(f,p){for(var d=[],m=0;m<p.length;m++)p[m]==="1"&&d.push(f[m]);return d}function c(f){for(var p=[],d=f.length-1;d>0;d--)for(var m=0;m<d;m++)f[m].length>f[m+1].length&&(p=f[m],f[m]=f[m+1],f[m+1]=p);return f}}var name$222="setPowerset",factory_1$234=factory$235,setPowerset$1={name:name$222,factory:factory_1$234},flatten$11=array.flatten;function factory$236(l,t,e,n){var r=e(compareNatural$1),i=n("setSize",{"Array | Matrix":function(a){return Array.isArray(a)?flatten$11(a).length:flatten$11(a.toArray()).length},"Array | Matrix, boolean":function(a,s){if(s===!1||a.length===0)return Array.isArray(a)?flatten$11(a).length:flatten$11(a.toArray()).length;for(var o=flatten$11(Array.isArray(a)?a:a.toArray()).sort(r),u=1,c=1;c<o.length;c++)r(o[c],o[c-1])!==0&&u++;return u}});return i}var name$223="setSize",factory_1$235=factory$236,setSize$1={name:name$223,factory:factory_1$235},flatten$12=array.flatten;function factory$237(l,t,e,n){var r=e(MatrixIndex),i=e(concat$1),a=e(size$5),s=e(subset$1),o=e(setDifference$1),u=n("setSymDifference",{"Array | Matrix, Array | Matrix":function(c,f){if(s(a(c),new r(0))===0)return flatten$12(f);if(s(a(f),new r(0))===0)return flatten$12(c);var p=flatten$12(c),d=flatten$12(f);return i(o(p,d),o(d,p))}});return u}var name$224="setSymDifference",factory_1$236=factory$237,setSymDifference$1={name:name$224,factory:factory_1$236},flatten$13=array.flatten;function factory$238(l,t,e,n){var r=e(MatrixIndex),i=e(concat$1),a=e(size$5),s=e(subset$1),o=e(setIntersect$1),u=e(setSymDifference$1),c=n("setUnion",{"Array | Matrix, Array | Matrix":function(f,p){if(s(a(f),new r(0))===0)return flatten$13(p);if(s(a(p),new r(0))===0)return flatten$13(f);var d=flatten$13(f),m=flatten$13(p);return i(u(d,m),o(d,m))}});return c}var name$225="setUnion",factory_1$237=factory$238,setUnion$1={name:name$225,factory:factory_1$237},set=[setCartesian$1,setDifference$1,setDistinct$1,setIntersect$1,setIsSubset$1,setMultiplicity$1,setPowerset$1,setSize$1,setSymDifference$1,setUnion$1],sign$2=number.sign;function factory$239(l,t,e,n){var r=n("erf",{number:function(o){var u=Math.abs(o);return u>=MAX_NUM?sign$2(o):u<=THRESH?sign$2(o)*i(u):u<=4?sign$2(o)*(1-a(u)):sign$2(o)*(1-s(u))},BigNumber:function(o){return new l.BigNumber(r(o.toNumber()))},"Array | Matrix":function(o){return deepMap(o,r)}});function i(o){var u=o*o,c=P[0][4]*u,f=u,p;for(p=0;p<3;p+=1)c=(c+P[0][p])*u,f=(f+Q[0][p])*u;return o*(c+P[0][3])/(f+Q[0][3])}function a(o){var u=P[1][8]*o,c=o,f;for(f=0;f<7;f+=1)u=(u+P[1][f])*o,c=(c+Q[1][f])*o;var p=(u+P[1][7])/(c+Q[1][7]),d=parseInt(o*16)/16,m=(o-d)*(o+d);return Math.exp(-d*d)*Math.exp(-m)*p}function s(o){var u=1/(o*o),c=P[2][5]*u,f=u,p;for(p=0;p<4;p+=1)c=(c+P[2][p])*u,f=(f+Q[2][p])*u;var d=u*(c+P[2][4])/(f+Q[2][4]);d=(SQRPI-d)/o,u=parseInt(o*16)/16;var m=(o-u)*(o+u);return Math.exp(-u*u)*Math.exp(-m)*d}return r.toTex={1:"erf\\left(${args[0]}\\right)"},r}var THRESH=.46875,SQRPI=.5641895835477563,P=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,21531153547440383e-24],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],Q=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],MAX_NUM=Math.pow(2,53),name$226="erf",factory_1$238=factory$239,erf$1={name:name$226,factory:factory_1$238},special=[erf$1],flatten$14=array.flatten;function factory$240(l,t,e,n){var r=e(addScalar),i=e(divideScalar),a=e(compare$1),s=e(partitionSelect$1),o=e(improveErrorMessage),u=n("median",{"Array | Matrix":c,"Array | Matrix, number | BigNumber":function(d,m){throw new Error("median(A, dim) is not yet supported")},"...":function(d){if(containsCollections(d))throw new TypeError("Scalar values expected in function median");return c(d)}});function c(d){try{d=flatten$14(d.valueOf());var m=d.length;if(m==0)throw new Error("Cannot calculate median of an empty array");if(m%2==0){for(var v=m/2-1,h=s(d,v+1),y=d[v],g=0;g<v;++g)a(d[g],y)>0&&(y=d[g]);return p(y,h)}else{var b=s(d,(m-1)/2);return f(b)}}catch(x){throw o(x,"median")}}var f=n({"number | BigNumber | Complex | Unit":function(d){return d}}),p=n({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(d,m){return i(r(d,m),2)}});return u.toTex=void 0,u}var name$227="median",factory_1$239=factory$240,median$1={name:name$227,factory:factory_1$239},flatten$15=array.flatten;function factory$241(l,t,e,n){var r=e(abs$1),i=e(map$7),a=e(median$1),s=e(subtract$1),o=e(improveErrorMessage),u=n("mad",{"Array | Matrix":c,"...":function(f){return c(f)}});return u.toTex=void 0,u;function c(f){if(f=flatten$15(f.valueOf()),f.length===0)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var p=a(f);return a(i(f,function(d){return r(s(d,p))}))}catch(d){throw d instanceof TypeError&&d.message.indexOf("median")!==-1?new TypeError(d.message.replace("median","mad")):o(d,"mad")}}}var name$228="mad",factory_1$240=factory$241,mad$1={name:name$228,factory:factory_1$240},flatten$16=array.flatten;function factory$242(l,t,e,n){var r=n("mode",{"Array | Matrix":i,"...":function(a){return i(a)}});return r;function i(a){a=flatten$16(a.valueOf());var s=a.length;if(s==0)throw new Error("Cannot calculate mode of an empty array");var o={},u=[],c=0;for(var f in a)a[f]in o||(o[a[f]]=0),o[a[f]]++,o[a[f]]==c?u.push(a[f]):o[a[f]]>c&&(c=o[a[f]],u=[a[f]]);return u}}var name$229="mode",factory_1$241=factory$242,mode$1={name:name$229,factory:factory_1$241};function factory$243(l,t,e,n){var r=e(multiplyScalar),i=e(improveErrorMessage),a=n("prod",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(o,u){throw new Error("prod(A, dim) is not yet supported")},"...":function(o){return s(o)}});return a.toTex=void 0,a;function s(o){var u=void 0;if(deepForEach(o,function(c){try{u=u===void 0?c:r(u,c)}catch(f){throw i(f,"prod",c)}}),u===void 0)throw new Error("Cannot calculate prod of an empty array");return u}}var name$230="prod",factory_1$242=factory$243,prod$1={name:name$230,factory:factory_1$242},isInteger$29=number.isInteger,isNumber$4=number.isNumber,flatten$17=array.flatten;function factory$244(l,t,e,n){var r=e(add),i=e(multiply$1),a=e(partitionSelect$1),s=e(compare$1);function o(f,p,d){var m,v,h;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(isCollection(f)){if(d=d||!1,typeof d=="boolean"){if(v=f.valueOf(),isNumber$4(p)){if(p<0)throw new Error("N/prob must be non-negative");if(p<=1)return u(v,p,d);if(p>1){if(!isInteger$29(p))throw new Error("N must be a positive integer");var y=p+1;m=new Array(p);for(var g=0;g<p;)m[g]=u(v,++g/y,d);return m}}if(l.isBigNumber(p)){if(p.isNegative())throw new Error("N/prob must be non-negative");if(h=new p.constructor(1),p.lte(h))return u(v,p,d);if(p.gt(h)){if(!p.isInteger())throw new Error("N must be a positive integer");var b=p.toNumber();if(b>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var y=new l.BigNumber(b+1);m=new Array(b);for(var g=0;g<b;)m[g]=u(v,new l.BigNumber(++g).div(y),d);return m}}if(Array.isArray(p)){m=new Array(p.length);for(var g=0;g<m.length;++g){var x=p[g];if(isNumber$4(x)){if(x<0||x>1)throw new Error("Probability must be between 0 and 1, inclusive")}else if(l.isBigNumber(x)){if(h=new x.constructor(1),x.isNegative()||x.gt(h))throw new Error("Probability must be between 0 and 1, inclusive")}else throw new TypeError("Unexpected type of argument in function quantileSeq");m[g]=u(v,x,d)}return m}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}function u(f,p,d){var m=flatten$17(f),v=m.length;if(v===0)throw new Error("Cannot calculate quantile of an empty sequence");if(isNumber$4(p)){var g=p*(v-1),x=g%1;if(x===0){var h=d?m[g]:a(m,g);return c(h),h}var b=Math.floor(g),C,_;if(d)C=m[b],_=m[b+1];else{_=a(m,b+1),C=m[b];for(var y=0;y<b;++y)s(m[y],C)>0&&(C=m[y])}return c(C),c(_),r(i(C,1-x),i(_,x))}var g=p.times(v-1);if(g.isInteger()){g=g.toNumber();var h=d?m[g]:a(m,g);return c(h),h}var b=g.floor(),x=g.minus(b),N=b.toNumber(),C,_;if(d)C=m[N],_=m[N+1];else{_=a(m,N+1),C=m[N];for(var y=0;y<N;++y)s(m[y],C)>0&&(C=m[y])}c(C),c(_);var w=new x.constructor(1);return r(i(C,w.minus(x)),i(_,x))}var c=n({"number | BigNumber | Unit":function(f){return f}});return o}var name$231="quantileSeq",factory_1$243=factory$244,quantileSeq$1={name:name$231,factory:factory_1$243},DEFAULT_NORMALIZATION="unbiased";function factory$245(l,t,e,n){var r=e(addScalar),i=e(subtract$1),a=e(multiplyScalar),s=e(divideScalar),o=e(improveErrorMessage),u=n("variance",{"Array | Matrix":function(f){return c(f,DEFAULT_NORMALIZATION)},"Array | Matrix, string":c,"...":function(f){return c(f,DEFAULT_NORMALIZATION)}});return u.toTex="\\mathrm{Var}\\left(${args}\\right)",u;function c(f,p){var d=0,m=0;if(f.length==0)throw new SyntaxError("Function var requires one or more parameters (0 provided)");if(deepForEach(f,function(y){try{d=r(d,y),m++}catch(g){throw o(g,"var",y)}}),m===0)throw new Error("Cannot calculate var of an empty array");var v=s(d,m);switch(d=0,deepForEach(f,function(y){var g=i(y,v);d=r(d,a(g,g))}),p){case"uncorrected":return s(d,m);case"biased":return s(d,m+1);case"unbiased":var h=l.isBigNumber(d)?new l.BigNumber(0):0;return m==1?h:s(d,m-1);default:throw new Error('Unknown normalization "'+p+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}}var name$232="var",factory_1$244=factory$245,_var$1={name:name$232,factory:factory_1$244};function factory$246(l,t,e,n){var r=e(sqrt$1),i=e(_var$1),a=n("std",{"Array | Matrix":s,"Array | Matrix, string":s,"...":function(o){return s(o)}});return a.toTex=void 0,a;function s(o,u){if(o.length==0)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{return r(i.apply(null,arguments))}catch(c){throw c instanceof TypeError&&c.message.indexOf(" var")!==-1?new TypeError(c.message.replace(" var"," std")):c}}}var name$233="std",factory_1$245=factory$246,std$1={name:name$233,factory:factory_1$245},statistics=[mad$1,max$1,mean$1,median$1,min$1,mode$1,prod$1,quantileSeq$1,std$1,sum$1,_var$1];function factory$247(l,t,e,n){var r=n("format",{any:string.format,"any, Object | function | number":string.format});return r.toTex=void 0,r}var name$234="format",factory_1$246=factory$247,format$8={name:name$234,factory:factory_1$246},isString$5=string.isString,format$9=string.format;function factory$248(l,t,e,n){var r=n("print",{"string, Object | Array":_print,"string, Object |\xA0Array, number | Object":_print});return r.toTex=void 0,r}function _print(l,t,e){return l.replace(/\$([\w\.]+)/g,function(n,r){for(var i=r.split("."),a=t[i.shift()];i.length&&a!==void 0;){var s=i.shift();a=s?a[s]:a+"."}return a!==void 0?isString$5(a)?a:format$9(a,e):n})}var name$235="print",factory_1$247=factory$248,print={name:name$235,factory:factory_1$247},string$10=[format$8,print];function factory$249(l,t,e,n){var r=n("acos",{number:function(i){return i>=-1&&i<=1||t.predictable?Math.acos(i):new l.Complex(i,0).acos()},Complex:function(i){return i.acos()},BigNumber:function(i){return i.acos()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\cos^{-1}\\left(${args[0]}\\right)"},r}var name$236="acos",factory_1$248=factory$249,acos$1={name:name$236,factory:factory_1$248};function factory$250(l,t,e,n){var r=n("acosh",{number:function(i){return i>=1||t.predictable?_acosh(i):i<=-1?new l.Complex(Math.log(Math.sqrt(i*i-1)-i),Math.PI):new l.Complex(i,0).acosh()},Complex:function(i){return i.acosh()},BigNumber:function(i){return i.acosh()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\cosh^{-1}\\left(${args[0]}\\right)"},r}var _acosh=Math.acosh||function(l){return Math.log(Math.sqrt(l*l-1)+l)},name$237="acosh",factory_1$249=factory$250,acosh$1={name:name$237,factory:factory_1$249};function factory$251(l,t,e,n){var r=n("acot",{number:function(i){return Math.atan(1/i)},Complex:function(i){return i.acot()},BigNumber:function(i){return new l.BigNumber(1).div(i).atan()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\cot^{-1}\\left(${args[0]}\\right)"},r}var name$238="acot",factory_1$250=factory$251,acot$1={name:name$238,factory:factory_1$250};function factory$252(l,t,e,n){var r=n("acoth",{number:function(i){return i>=1||i<=-1||t.predictable?isFinite(i)?(Math.log((i+1)/i)+Math.log(i/(i-1)))/2:0:new l.Complex(i,0).acoth()},Complex:function(i){return i.acoth()},BigNumber:function(i){return new l.BigNumber(1).div(i).atanh()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\coth^{-1}\\left(${args[0]}\\right)"},r}var name$239="acoth",factory_1$251=factory$252,acoth$1={name:name$239,factory:factory_1$251};function factory$253(l,t,e,n){var r=n("acsc",{number:function(i){return i<=-1||i>=1||t.predictable?Math.asin(1/i):new l.Complex(i,0).acsc()},Complex:function(i){return i.acsc()},BigNumber:function(i){return new l.BigNumber(1).div(i).asin()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\csc^{-1}\\left(${args[0]}\\right)"},r}var name$240="acsc",factory_1$252=factory$253,acsc$1={name:name$240,factory:factory_1$252};function factory$254(l,t,e,n){var r=n("acsch",{number:function(i){return i=1/i,Math.log(i+Math.sqrt(i*i+1))},Complex:function(i){return i.acsch()},BigNumber:function(i){return new l.BigNumber(1).div(i).asinh()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},r}var name$241="acsch",factory_1$253=factory$254,acsch$1={name:name$241,factory:factory_1$253};function factory$255(l,t,e,n){var r=n("asec",{number:function(i){return i<=-1||i>=1||t.predictable?Math.acos(1/i):new l.Complex(i,0).asec()},Complex:function(i){return i.asec()},BigNumber:function(i){return new l.BigNumber(1).div(i).acos()},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\sec^{-1}\\left(${args[0]}\\right)"},r}var name$242="asec",factory_1$254=factory$255,asec$1={name:name$242,factory:factory_1$254};function factory$256(l,t,e,n){var r=n.find(e(acosh$1),["Complex"]),i=n("asech",{number:function(a){if(a<=1&&a>=-1||t.predictable){a=1/a;var s=Math.sqrt(a*a-1);return a>0||t.predictable?Math.log(s+a):new l.Complex(Math.log(s-a),Math.PI)}return new l.Complex(a,0).asech()},Complex:function(a){return a.asech()},BigNumber:function(a){return new l.BigNumber(1).div(a).acosh()},"Array | Matrix":function(a){return deepMap(a,i)}});return i.toTex={1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},i}var name$243="asech",factory_1$255=factory$256,asech$1={name:name$243,factory:factory_1$255};function factory$257(l,t,e,n){var r=n("asin",{number:function(i){return i>=-1&&i<=1||t.predictable?Math.asin(i):new l.Complex(i,0).asin()},Complex:function(i){return i.asin()},BigNumber:function(i){return i.asin()},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\sin^{-1}\\left(${args[0]}\\right)"},r}var name$244="asin",factory_1$256=factory$257,asin$1={name:name$244,factory:factory_1$256};function factory$258(l,t,e,n){var r=n("asinh",{number:Math.asinh||function(i){return Math.log(Math.sqrt(i*i+1)+i)},Complex:function(i){return i.asinh()},BigNumber:function(i){return i.asinh()},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\sinh^{-1}\\left(${args[0]}\\right)"},r}var name$245="asinh",factory_1$257=factory$258,asinh$1={name:name$245,factory:factory_1$257};function factory$259(l,t,e,n){var r=n("atan",{number:function(i){return Math.atan(i)},Complex:function(i){return i.atan()},BigNumber:function(i){return i.atan()},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\tan^{-1}\\left(${args[0]}\\right)"},r}var name$246="atan",factory_1$258=factory$259,atan$1={name:name$246,factory:factory_1$258};function factory$260(l,t,e,n){var r=e(matrix),i=e(algorithm02),a=e(algorithm03),s=e(algorithm09),o=e(algorithm11),u=e(algorithm12),c=e(algorithm13),f=e(algorithm14),p=n("atan2",{"number, number":Math.atan2,"BigNumber, BigNumber":function(d,m){return l.BigNumber.atan2(d,m)},"SparseMatrix, SparseMatrix":function(d,m){return s(d,m,p,!1)},"SparseMatrix, DenseMatrix":function(d,m){return i(m,d,p,!0)},"DenseMatrix, SparseMatrix":function(d,m){return a(d,m,p,!1)},"DenseMatrix, DenseMatrix":function(d,m){return c(d,m,p)},"Array, Array":function(d,m){return p(r(d),r(m)).valueOf()},"Array, Matrix":function(d,m){return p(r(d),m)},"Matrix, Array":function(d,m){return p(d,r(m))},"SparseMatrix, number | BigNumber":function(d,m){return o(d,m,p,!1)},"DenseMatrix, number | BigNumber":function(d,m){return f(d,m,p,!1)},"number | BigNumber, SparseMatrix":function(d,m){return u(m,d,p,!0)},"number | BigNumber, DenseMatrix":function(d,m){return f(m,d,p,!0)},"Array, number | BigNumber":function(d,m){return f(r(d),m,p,!1).valueOf()},"number | BigNumber, Array":function(d,m){return f(r(m),d,p,!0).valueOf()}});return p.toTex={2:"\\mathrm{atan2}\\left(${args}\\right)"},p}var name$247="atan2",factory_1$259=factory$260,atan2$1={name:name$247,factory:factory_1$259};function factory$261(l,t,e,n){var r=n("atanh",{number:function(i){return i<=1&&i>=-1||t.predictable?_atanh(i):new l.Complex(i,0).atanh()},Complex:function(i){return i.atanh()},BigNumber:function(i){return i.atanh()},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\tanh^{-1}\\left(${args[0]}\\right)"},r}var _atanh=Math.atanh||function(l){return Math.log((1+l)/(1-l))/2},name$248="atanh",factory_1$260=factory$261,atanh$1={name:name$248,factory:factory_1$260};function factory$262(l,t,e,n){var r=n("cos",{number:Math.cos,Complex:function(i){return i.cos()},BigNumber:function(i){return i.cos()},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\cos\\left(${args[0]}\\right)"},r}var name$249="cos",factory_1$261=factory$262,cos$1={name:name$249,factory:factory_1$261};function factory$263(l,t,e,n){var r=n("cosh",{number:_cosh,Complex:function(i){return i.cosh()},BigNumber:function(i){return i.cosh()},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\cosh\\left(${args[0]}\\right)"},r}var _cosh=Math.cosh||function(l){return(Math.exp(l)+Math.exp(-l))/2},name$250="cosh",factory_1$262=factory$263,cosh$1={name:name$250,factory:factory_1$262};function factory$264(l,t,e,n){var r=n("cot",{number:function(i){return 1/Math.tan(i)},Complex:function(i){return i.cot()},BigNumber:function(i){return new l.BigNumber(1).div(i.tan())},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\cot\\left(${args[0]}\\right)"},r}var name$251="cot",factory_1$263=factory$264,cot$1={name:name$251,factory:factory_1$263};function factory$265(l,t,e,n){var r=n("coth",{number:_coth,Complex:function(i){return i.coth()},BigNumber:function(i){return new l.BigNumber(1).div(i.tanh())},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function coth is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\coth\\left(${args[0]}\\right)"},r}function _coth(l){var t=Math.exp(2*l);return(t+1)/(t-1)}var name$252="coth",factory_1$264=factory$265,coth$1={name:name$252,factory:factory_1$264};function factory$266(l,t,e,n){var r=n("csc",{number:function(i){return 1/Math.sin(i)},Complex:function(i){return i.csc()},BigNumber:function(i){return new l.BigNumber(1).div(i.sin())},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csc is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\csc\\left(${args[0]}\\right)"},r}var name$253="csc",factory_1$265=factory$266,csc$1={name:name$253,factory:factory_1$265},sign$3=number.sign;function factory$267(l,t,e,n){var r=n("csch",{number:_csch,Complex:function(i){return i.csch()},BigNumber:function(i){return new l.BigNumber(1).div(i.sinh())},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csch is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\mathrm{csch}\\left(${args[0]}\\right)"},r}function _csch(l){return l==0?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(l)-Math.exp(-l)))*sign$3(l)}var name$254="csch",factory_1$266=factory$267,csch$1={name:name$254,factory:factory_1$266};function factory$268(l,t,e,n){var r=n("sec",{number:function(i){return 1/Math.cos(i)},Complex:function(i){return i.sec()},BigNumber:function(i){return new l.BigNumber(1).div(i.cos())},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sec is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\sec\\left(${args[0]}\\right)"},r}var name$255="sec",factory_1$267=factory$268,sec$1={name:name$255,factory:factory_1$267};function factory$269(l,t,e,n){var r=n("sech",{number:_sech,Complex:function(i){return i.sech()},BigNumber:function(i){return new l.BigNumber(1).div(i.cosh())},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sech is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\mathrm{sech}\\left(${args[0]}\\right)"},r}function _sech(l){return 2/(Math.exp(l)+Math.exp(-l))}var name$256="sech",factory_1$268=factory$269,sech$1={name:name$256,factory:factory_1$268};function factory$270(l,t,e,n){var r=n("sin",{number:Math.sin,Complex:function(i){return i.sin()},BigNumber:function(i){return i.sin()},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\sin\\left(${args[0]}\\right)"},r}var name$257="sin",factory_1$269=factory$270,sin$1={name:name$257,factory:factory_1$269};function factory$271(l,t,e,n){var r=n("sinh",{number:_sinh,Complex:function(i){return i.sinh()},BigNumber:function(i){return i.sinh()},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\sinh\\left(${args[0]}\\right)"},r}var _sinh=Math.sinh||function(l){return(Math.exp(l)-Math.exp(-l))/2},name$258="sinh",factory_1$270=factory$271,sinh$1={name:name$258,factory:factory_1$270};function factory$272(l,t,e,n){var r=n("tan",{number:Math.tan,Complex:function(i){return i.tan()},BigNumber:function(i){return i.tan()},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\tan\\left(${args[0]}\\right)"},r}var name$259="tan",factory_1$271=factory$272,tan$1={name:name$259,factory:factory_1$271};function factory$273(l,t,e,n){var r=n("tanh",{number:_tanh,Complex:function(i){return i.tanh()},BigNumber:function(i){return i.tanh()},Unit:function(i){if(!i.hasBase(l.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tanh is no angle");return r(i.value)},"Array | Matrix":function(i){return deepMap(i,r,!0)}});return r.toTex={1:"\\tanh\\left(${args[0]}\\right)"},r}var _tanh=Math.tanh||function(l){var t=Math.exp(2*l);return(t-1)/(t+1)},name$260="tanh",factory_1$272=factory$273,tanh$1={name:name$260,factory:factory_1$272},trigonometry=[acos$1,acosh$1,acot$1,acoth$1,acsc$1,acsch$1,asec$1,asech$1,asin$1,asinh$1,atan$1,atan2$1,atanh$1,cos$1,cosh$1,cot$1,coth$1,csc$1,csch$1,sec$1,sech$1,sin$1,sinh$1,tan$1,tanh$1];function factory$274(l,t,e,n){var r=latex,i=e(matrix),a=e(algorithm13),s=e(algorithm14),o=n("to",{"Unit, Unit | string":function(u,c){return u.to(c)},"Matrix, Matrix":function(u,c){return a(u,c,o)},"Array, Array":function(u,c){return o(i(u),i(c)).valueOf()},"Array, Matrix":function(u,c){return o(i(u),c)},"Matrix, Array":function(u,c){return o(u,i(c))},"Matrix, any":function(u,c){return s(u,c,o,!1)},"any, Matrix":function(u,c){return s(c,u,o,!0)},"Array, any":function(u,c){return s(i(u),c,o,!1).valueOf()},"any, Array":function(u,c){return s(i(c),u,o,!0).valueOf()}});return o.toTex={2:"\\left(${args[0]}"+r.operators.to+"${args[1]}\\right)"},o}var name$261="to",factory_1$273=factory$274,to$1={name:name$261,factory:factory_1$273},unit$1=[to$1];function factory$275(l,t,e,n){var r=n("isPrime",{number:function(i){if(i<2)return!1;if(i==2)return!0;if(i%2==0)return!1;for(var a=3;a*a<=i;a+=2)if(i%a==0)return!1;return!0},BigNumber:function(i){if(i.lt(2))return!1;if(i.equals(2))return!0;if(i.mod(2).isZero())return!1;for(var a=l.BigNumber(3);a.times(a).lte(i);a=a.plus(1))if(i.mod(a).isZero())return!1;return!0},"Array | Matrix":function(i){return deepMap(i,r)}});return r}var name$262="isPrime",factory_1$274=factory$275,isPrime$1={name:name$262,factory:factory_1$274};function factory$276(l,t,e,n){var r=n("isNaN",{number:function(i){return Number.isNaN(i)},BigNumber:function(i){return i.isNaN()},Fraction:function(i){return!1},Complex:function(i){return i.isNaN()},Unit:function(i){return Number.isNaN(i.value)},"Array | Matrix":function(i){return deepMap(i,Number.isNaN)}});return r}var name$263="isNaN",factory_1$275=factory$276,_isNaN$1={name:name$263,factory:factory_1$275},utils$1=[clone$5,isInteger$22,isNegative$1,isNumeric$1,isPositive$1,isPrime$1,isZero$1,_isNaN$1,_typeof$1],_function$3=[algebra,arithmetic,bitwise$1,combinatorics,complex$5,geometry,logical,matrix$3,probability,relational,set,special,statistics,string$10,trigonometry,unit$1,utils$1];function factory$277(l,t,e,n,r){return function(a,s){var o=l[s&&s.mathjs]||r.expression&&r.expression.node[s&&s.mathjs];return o&&typeof o.fromJSON=="function"?o.fromJSON(s):s}}var name$264="reviver",path$64="json",factory_1$276=factory$277,math$18=!0,reviver={name:name$264,path:path$64,factory:factory_1$276,math:math$18},json=[reviver],error=[{name:"ArgumentsError",path:"error",factory:function(){return ArgumentsError_1}},{name:"DimensionError",path:"error",factory:function(){return DimensionError_1}},{name:"IndexError",path:"error",factory:function(){return IndexError_1}}],lib=[type,constants$1,expression,_function$3,json,error],numeric1_2_6=createCommonjsModule(function(module,exports){var numeric=exports;typeof commonjsGlobal!="undefined"&&(commonjsGlobal.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var n,r,i,a;for(typeof e=="undefined"&&(e=15),i=.5,n=new Date;;){for(i*=2,a=i;a>3;a-=4)t(),t(),t(),t();for(;a>0;)t(),a--;if(r=new Date,r-n>e)break}for(a=i;a>3;a-=4)t(),t(),t(),t();for(;a>0;)t(),a--;return r=new Date,1e3*(3*i-1)/(r-n)},numeric._myIndexOf=function(t){var e=this.length,n;for(n=0;n<e;++n)if(this[n]===t)return n;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(i){if(i===0)return"0";if(isNaN(i))return"NaN";if(i<0)return"-"+e(-i);if(isFinite(i)){var a=Math.floor(Math.log(i)/Math.log(10)),s=i/Math.pow(10,a),o=s.toPrecision(numeric.precision);return parseFloat(o)===10&&(a++,s=1,o=s.toPrecision(numeric.precision)),parseFloat(o).toString()+"e"+a.toString()}return"Infinity"}var n=[];function r(i){var a;if(typeof i=="undefined")return n.push(Array(numeric.precision+8).join(" ")),!1;if(typeof i=="string")return n.push('"'+i+'"'),!1;if(typeof i=="boolean")return n.push(i.toString()),!1;if(typeof i=="number"){var s=e(i),o=i.toPrecision(numeric.precision),u=parseFloat(i.toString()).toString(),c=[s,o,u,parseFloat(o).toString(),parseFloat(u).toString()];for(a=1;a<c.length;a++)c[a].length<s.length&&(s=c[a]);return n.push(Array(numeric.precision+8-s.length).join(" ")+s),!1}if(i===null)return n.push("null"),!1;if(typeof i=="function"){n.push(i.toString());var f=!1;for(a in i)i.hasOwnProperty(a)&&(f?n.push(`,
`):n.push(`
{`),f=!0,n.push(a),n.push(`: 
`),r(i[a]));return f&&n.push(`}
`),!0}if(i instanceof Array){if(i.length>numeric.largeArray)return n.push("...Large Array..."),!0;var f=!1;for(n.push("["),a=0;a<i.length;a++)a>0&&(n.push(","),f&&n.push(`
 `)),f=r(i[a]);return n.push("]"),!0}n.push("{");var f=!1;for(a in i)i.hasOwnProperty(a)&&(f&&n.push(`,
`),f=!0,n.push(a),n.push(`: 
`),r(i[a]));return n.push("}"),!0}return r(t),n.join("")},numeric.parseDate=function(t){function e(n){if(typeof n=="string")return Date.parse(n.replace(/-/g,"/"));if(!(n instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var r=[],i;for(i=0;i<n.length;i++)r[i]=e(n[i]);return r}return e(t)},numeric.parseFloat=function(t){function e(n){if(typeof n=="string")return parseFloat(n);if(!(n instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var r=[],i;for(i=0;i<n.length;i++)r[i]=e(n[i]);return r}return e(t)},numeric.parseCSV=function(t){var e=t.split(`
`),n,r,i=[],a=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,o=function(p){return p.substr(0,p.length-1)},u=0;for(r=0;r<e.length;r++){var c=(e[r]+",").match(a),f;if(c.length>0){for(i[u]=[],n=0;n<c.length;n++)f=o(c[n]),s.test(f)?i[u][n]=parseFloat(f):i[u][n]=f;u++}}return i},numeric.toCSV=function(t){var e=numeric.dim(t),n,r,i,a,s,o;for(i=e[0],a=e[1],o=[],n=0;n<i;n++){for(s=[],r=0;r<i;r++)s[r]=t[n][r].toString();o[n]=s.join(", ")}return o.join(`
`)+`
`},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(y){var g=y.length,b,x,N,C,_,w,A,$,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",D="";for(b=0;b<g;b+=3)x=y[b],N=y[b+1],C=y[b+2],_=x>>2,w=((x&3)<<4)+(N>>4),A=((N&15)<<2)+(C>>6),$=C&63,b+1>=g?A=$=64:b+2>=g&&($=64),D+=S.charAt(_)+S.charAt(w)+S.charAt(A)+S.charAt($);return D}function n(y,g,b){typeof g=="undefined"&&(g=0),typeof b=="undefined"&&(b=y.length);var x=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],N=-1,C=0,_=y.length,w;for(w=g;w<b;w++)C=(N^y[w])&255,N=N>>>8^x[C];return N^-1}var r=t[0].length,i=t[0][0].length,a,s,o,u,c,f,p,d,m,v,h=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,i>>24&255,i>>16&255,i>>8&255,i&255,r>>24&255,r>>16&255,r>>8&255,r&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(v=n(h,12,29),h[29]=v>>24&255,h[30]=v>>16&255,h[31]=v>>8&255,h[32]=v&255,a=1,s=0,p=0;p<r;p++){for(p<r-1?h.push(0):h.push(1),c=3*i+1+(p===0)&255,f=3*i+1+(p===0)>>8&255,h.push(c),h.push(f),h.push(~c&255),h.push(~f&255),p===0&&h.push(0),d=0;d<i;d++)for(o=0;o<3;o++)c=t[o][p][d],c>255?c=255:c<0?c=0:c=Math.round(c),a=(a+c)%65521,s=(s+a)%65521,h.push(c);h.push(0)}return m=(s<<16)+a,h.push(m>>24&255),h.push(m>>16&255),h.push(m>>8&255),h.push(m&255),u=h.length-41,h[33]=u>>24&255,h[34]=u>>16&255,h[35]=u>>8&255,h[36]=u&255,v=n(h,37),h.push(v>>24&255),h.push(v>>16&255),h.push(v>>8&255),h.push(v&255),h.push(0),h.push(0),h.push(0),h.push(0),h.push(73),h.push(69),h.push(78),h.push(68),h.push(174),h.push(66),h.push(96),h.push(130),"data:image/png;base64,"+e(h)},numeric._dim=function(t){for(var e=[];typeof t=="object";)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e,n;return typeof t=="object"?(e=t[0],typeof e=="object"?(n=e[0],typeof n=="object"?numeric._dim(t):[t.length,e.length]):[t.length]):[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+`;
if(typeof x === "number") { var xi = x; `+t+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+t+`;
    xi = x[i-1];
    `+t+`;
}
if(i === 0) {
    xi = x[i];
    `+t+`
}
return accum;`)},numeric.mapreduce2=function(t,e){return Function("x",`var n = x.length;
var i,xi;
`+e+`;
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+t+`;
}
return accum;`)},numeric.same=function l(t,e){var n,r;if(!(t instanceof Array)||!(e instanceof Array)||(r=t.length,r!==e.length))return!1;for(n=0;n<r;n++)if(t[n]!==e[n])if(typeof t[n]=="object"){if(!l(t[n],e[n]))return!1}else return!1;return!0},numeric.rep=function(t,e,n){typeof n=="undefined"&&(n=0);var r=t[n],i=Array(r),a;if(n===t.length-1){for(a=r-2;a>=0;a-=2)i[a+1]=e,i[a]=e;return a===-1&&(i[0]=e),i}for(a=r-1;a>=0;a--)i[a]=numeric.rep(t,e,n+1);return i},numeric.dotMMsmall=function(t,e){var n,r,i,a,s,o,u,c,f,p,d;for(a=t.length,s=e.length,o=e[0].length,u=Array(a),n=a-1;n>=0;n--){for(c=Array(o),f=t[n],i=o-1;i>=0;i--){for(p=f[s-1]*e[s-1][i],r=s-2;r>=1;r-=2)d=r-1,p+=f[r]*e[r][i]+f[d]*e[d][i];r===0&&(p+=f[0]*e[0][i]),c[i]=p}u[n]=c}return u},numeric._getCol=function(t,e,n){var r=t.length,i;for(i=r-1;i>0;--i)n[i]=t[i][e],--i,n[i]=t[i][e];i===0&&(n[0]=t[0][e])},numeric.dotMMbig=function(t,e){var n=numeric._getCol,r=e.length,i=Array(r),a=t.length,s=e[0].length,o=new Array(a),u,c=numeric.dotVV,f,p;for(--r,--a,f=a;f!==-1;--f)o[f]=Array(s);for(--s,f=s;f!==-1;--f)for(n(e,f,i),p=a;p!==-1;--p)u=t[p],o[p][f]=c(u,i);return o},numeric.dotMV=function(t,e){var n=t.length,r=e.length,i,a=Array(n),s=numeric.dotVV;for(i=n-1;i>=0;i--)a[i]=s(t[i],e);return a},numeric.dotVM=function(t,e){var n,r,i,a,s,o,u;for(i=t.length,a=e[0].length,s=Array(a),r=a-1;r>=0;r--){for(o=t[i-1]*e[i-1][r],n=i-2;n>=1;n-=2)u=n-1,o+=t[n]*e[n][r]+t[u]*e[u][r];n===0&&(o+=t[0]*e[0][r]),s[r]=o}return s},numeric.dotVV=function(t,e){var n,r=t.length,i,a=t[r-1]*e[r-1];for(n=r-2;n>=1;n-=2)i=n-1,a+=t[n]*e[n]+t[i]*e[i];return n===0&&(a+=t[0]*e[0]),a},numeric.dot=function(t,e){var n=numeric.dim;switch(n(t).length*1e3+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,n,r,i=t.length,a=Array(i),s;for(e=i-1;e>=0;e--){for(s=Array(i),n=e+2,r=i-1;r>=n;r-=2)s[r]=0,s[r-1]=0;for(r>e&&(s[r]=0),s[e]=t[e],r=e-1;r>=1;r-=2)s[r]=0,s[r-1]=0;r===0&&(s[0]=0),a[e]=s}return a},numeric.getDiag=function(l){var t=Math.min(l.length,l[0].length),e,n=Array(t);for(e=t-1;e>=1;--e)n[e]=l[e][e],--e,n[e]=l[e][e];return e===0&&(n[0]=l[0][0]),n},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,n){typeof n=="undefined"&&(n="");var r=[],i,a=/\[i\]$/,s,o="",u=!1;for(i=0;i<t.length;i++)a.test(t[i])?(s=t[i].substring(0,t[i].length-3),o=s):s=t[i],s==="ret"&&(u=!0),r.push(s);return r[t.length]="_s",r[t.length+1]="_k",r[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+o+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(u?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(",")+`,_s,_k+1);
    return ret;
}
`+n+`
for(i=_n-1;i!==-1;--i) {
    `+e+`
}
return ret;`,Function.apply(null,r)},numeric.pointwise2=function(t,e,n){typeof n=="undefined"&&(n="");var r=[],i,a=/\[i\]$/,s,o="",u=!1;for(i=0;i<t.length;i++)a.test(t[i])?(s=t[i].substring(0,t[i].length-3),o=s):s=t[i],s==="ret"&&(u=!0),r.push(s);return r[t.length]="var _n = "+o+`.length;
var i`+(u?"":", ret = Array(_n)")+`;
`+n+`
for(i=_n-1;i!==-1;--i) {
`+e+`
}
return ret;`,Function.apply(null,r)},numeric._biforeach=function l(t,e,n,r,i){if(r===n.length-1){i(t,e);return}var a,s=n[r];for(a=s-1;a>=0;a--)l(typeof t=="object"?t[a]:t,typeof e=="object"?e[a]:e,n,r+1,i)},numeric._biforeach2=function l(t,e,n,r,i){if(r===n.length-1)return i(t,e);var a,s=n[r],o=Array(s);for(a=s-1;a>=0;--a)o[a]=l(typeof t=="object"?t[a]:t,typeof e=="object"?e[a]:e,n,r+1,i);return o},numeric._foreach=function l(t,e,n,r){if(n===e.length-1){r(t);return}var i,a=e[n];for(i=a-1;i>=0;i--)l(t[i],e,n+1,r)},numeric._foreach2=function l(t,e,n,r){if(n===e.length-1)return r(t);var i,a=e[n],s=Array(a);for(i=a-1;i>=0;i--)s[i]=l(t[i],e,n+1,r);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var l,t;for(l=0;l<numeric.mathfuns2.length;++l)t=numeric.mathfuns2[l],numeric.ops2[t]=t;for(l in numeric.ops2)if(numeric.ops2.hasOwnProperty(l)){t=numeric.ops2[l];var e,n,r="";numeric.myIndexOf.call(numeric.mathfuns2,l)!==-1?(r="var "+t+" = Math."+t+`;
`,e=function(i,a,s){return i+" = "+t+"("+a+","+s+")"},n=function(i,a){return i+" = "+t+"("+i+","+a+")"}):(e=function(i,a,s){return i+" = "+a+" "+t+" "+s},numeric.opseq.hasOwnProperty(l+"eq")?n=function(i,a){return i+" "+t+"= "+a}:n=function(i,a){return i+" = "+i+" "+t+" "+a}),numeric[l+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),r),numeric[l+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),r),numeric[l+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),r),numeric[l]=Function(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+l+"VV, VS = numeric."+l+"VS, SV = numeric."+l+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+n("x","y")+`
}
return x;
`),numeric[t]=numeric[l],numeric[l+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),r),numeric[l+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),r),numeric[l+"eq"]=Function(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+l+"eqV, S = numeric."+l+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(l=0;l<numeric.mathfuns2.length;++l)t=numeric.mathfuns2[l],delete numeric.ops2[t];for(l=0;l<numeric.mathfuns.length;++l)t=numeric.mathfuns[l],numeric.ops1[t]=t;for(l in numeric.ops1)numeric.ops1.hasOwnProperty(l)&&(r="",t=numeric.ops1[l],numeric.myIndexOf.call(numeric.mathfuns,l)!==-1&&Math.hasOwnProperty(t)&&(r="var "+t+" = Math."+t+`;
`),numeric[l+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",r),numeric[l+"eq"]=Function("x",'if(typeof x !== "object") return '+t+`x
var i;
var V = numeric.`+l+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),numeric[l+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",r),numeric[l]=Function("x",'if(typeof x !== "object") return '+t+`(x)
var i;
var V = numeric.`+l+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(l=0;l<numeric.mathfuns.length;++l)t=numeric.mathfuns[l],delete numeric.ops1[t];for(l in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(l)&&(t=numeric.mapreducers[l],numeric[l+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[l]=Function("x","s","k",t[1]+`if(typeof x !== "object") {    xi = x;
`+t[0]+`;
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+l+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+t[0]+`;
}
return accum;
`))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return typeof t=="object"?typeof e=="object"?numeric.truncVV(t,e):numeric.truncVS(t,e):typeof e=="object"?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e=numeric.dim(t),n=Math.abs,r=e[0],i=e[1],a=numeric.clone(t),s,o,u=numeric.identity(r),c,f,p,d,m,t;for(d=0;d<i;++d){var v=-1,h=-1;for(p=d;p!==r;++p)m=n(a[p][d]),m>h&&(v=p,h=m);for(o=a[v],a[v]=a[d],a[d]=o,f=u[v],u[v]=u[d],u[d]=f,t=o[d],m=d;m!==i;++m)o[m]/=t;for(m=i-1;m!==-1;--m)f[m]/=t;for(p=r-1;p!==-1;--p)if(p!==d){for(s=a[p],c=u[p],t=s[d],m=d+1;m!==i;++m)s[m]-=o[m]*t;for(m=i-1;m>0;--m)c[m]-=f[m]*t,--m,c[m]-=f[m]*t;m===0&&(c[0]-=f[0]*t)}}return u},numeric.det=function(t){var e=numeric.dim(t);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n=e[0],r=1,i,a,s,o=numeric.clone(t),u,c,f,p,d;for(a=0;a<n-1;a++){for(s=a,i=a+1;i<n;i++)Math.abs(o[i][a])>Math.abs(o[s][a])&&(s=i);for(s!==a&&(p=o[s],o[s]=o[a],o[a]=p,r*=-1),u=o[a],i=a+1;i<n;i++){for(c=o[i],f=c[a]/u[a],s=a+1;s<n-1;s+=2)d=s+1,c[s]-=u[s]*f,c[d]-=u[d]*f;s!==n&&(c[s]-=u[s]*f)}if(u[a]===0)return 0;r*=u[a]}return r*o[a][a]},numeric.transpose=function(t){var e,n,r=t.length,i=t[0].length,a=Array(i),s,o,u;for(n=0;n<i;n++)a[n]=Array(r);for(e=r-1;e>=1;e-=2){for(o=t[e],s=t[e-1],n=i-1;n>=1;--n)u=a[n],u[e]=o[n],u[e-1]=s[n],--n,u=a[n],u[e]=o[n],u[e-1]=s[n];n===0&&(u=a[0],u[e]=o[0],u[e-1]=s[0])}if(e===0){for(s=t[0],n=i-1;n>=1;--n)a[n][0]=s[n],--n,a[n][0]=s[n];n===0&&(a[0][0]=s[0])}return a},numeric.negtranspose=function(t){var e,n,r=t.length,i=t[0].length,a=Array(i),s,o,u;for(n=0;n<i;n++)a[n]=Array(r);for(e=r-1;e>=1;e-=2){for(o=t[e],s=t[e-1],n=i-1;n>=1;--n)u=a[n],u[e]=-o[n],u[e-1]=-s[n],--n,u=a[n],u[e]=-o[n],u[e-1]=-s[n];n===0&&(u=a[0],u[e]=-o[0],u[e-1]=-s[0])}if(e===0){for(s=t[0],n=i-1;n>=1;--n)a[n][0]=-s[n],--n,a[n][0]=-s[n];n===0&&(a[0][0]=-s[0])}return a},numeric._random=function l(t,e){var n,r=t[e],i=Array(r),a;if(e===t.length-1){for(a=Math.random,n=r-1;n>=1;n-=2)i[n]=a(),i[n-1]=a();return n===0&&(i[0]=a()),i}for(n=r-1;n>=0;n--)i[n]=l(t,e+1);return i},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,n){if(typeof n=="undefined"&&(n=Math.max(Math.round(e-t)+1,1)),n<2)return n===1?[t]:[];var r,i=Array(n);for(n--,r=n;r>=0;r--)i[r]=(r*e+(n-r)*t)/n;return i},numeric.getBlock=function(t,e,n){var r=numeric.dim(t);function i(a,s){var o,u=e[s],c=n[s]-u,f=Array(c);if(s===r.length-1){for(o=c;o>=0;o--)f[o]=a[o+u];return f}for(o=c;o>=0;o--)f[o]=i(a[o+u],s+1);return f}return i(t,0)},numeric.setBlock=function(t,e,n,r){var i=numeric.dim(t);function a(s,o,u){var c,f=e[u],p=n[u]-f;if(u===i.length-1)for(c=p;c>=0;c--)s[c+f]=o[c];for(c=p;c>=0;c--)a(s[c+f],o[c],u+1)}return a(t,r,0),t},numeric.getRange=function(t,e,n){var r=e.length,i=n.length,a,s,o=Array(r),u,c;for(a=r-1;a!==-1;--a)for(o[a]=Array(i),u=o[a],c=t[e[a]],s=i-1;s!==-1;--s)u[s]=c[n[s]];return o},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var n=e[0],r=e[1],i,a,s,o,u;for(i=0,a=0,s=0;s<n;++s)i+=t[s][0].length;for(o=0;o<r;++o)a+=t[0][o][0].length;var c=Array(i);for(s=0;s<i;++s)c[s]=Array(a);var f=0,p,d,m,v,h;for(s=0;s<n;++s){for(p=a,o=r-1;o!==-1;--o)for(u=t[s][o],p-=u[0].length,m=u.length-1;m!==-1;--m)for(h=u[m],d=c[f+m],v=h.length-1;v!==-1;--v)d[p+v]=h[v];f+=t[s][0].length}return c},numeric.tensor=function(t,e){if(typeof t=="number"||typeof e=="number")return numeric.mul(t,e);var n=numeric.dim(t),r=numeric.dim(e);if(n.length!==1||r.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var i=n[0],a=r[0],s=Array(i),o,u,c,f;for(u=i-1;u>=0;u--){for(o=Array(a),f=t[u],c=a-1;c>=3;--c)o[c]=f*e[c],--c,o[c]=f*e[c],--c,o[c]=f*e[c],--c,o[c]=f*e[c];for(;c>=0;)o[c]=f*e[c],--c;s[u]=o}return s},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,n,r,i){var a=numeric.indexOf;if(typeof i!="string"){var s;i="";for(s in numeric)numeric.hasOwnProperty(s)&&(t.indexOf(s)>=0||e.indexOf(s)>=0||n.indexOf(s)>=0||r.indexOf(s)>=0)&&s.length>1&&(i+="var "+s+" = numeric."+s+`;
`)}return Function(["y"],`var x = this;
if(!(y instanceof numeric.T)) { y = new numeric.T(y); }
`+i+`
if(x.y) {  if(y.y) {    return new numeric.T(`+r+`);
  }
  return new numeric.T(`+n+`);
}
if(y.y) {
  return new numeric.T(`+e+`);
}
return new numeric.T(`+t+`);
`)},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),numeric.negtranspose(n)):new numeric.T(t(e))},numeric.Tunop=function(t,e,n){return typeof n!="string"&&(n=""),Function(`var x = this;
`+n+`
if(x.y) {  `+e+`;
}
`+t+`;
`)},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));",`var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();
return new numeric.T(numeric.log(r.x),theta.x);`),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);",`var f = numeric.norm2Squared;
return Math.sqrt(f(x.x)+f(x.y));`),numeric.T.prototype.inv=function(){var t=this;if(typeof t.y=="undefined")return new numeric.T(numeric.inv(t.x));var e=t.x.length,n,r,i,a=numeric.identity(e),s=numeric.rep([e,e],0),o=numeric.clone(t.x),u=numeric.clone(t.y),c,f,p,d,m,v,h,y,n,r,i,g,b,x,N,C,_,w;for(n=0;n<e;n++){for(x=o[n][n],N=u[n][n],g=x*x+N*N,i=n,r=n+1;r<e;r++)x=o[r][n],N=u[r][n],b=x*x+N*N,b>g&&(i=r,g=b);for(i!==n&&(w=o[n],o[n]=o[i],o[i]=w,w=u[n],u[n]=u[i],u[i]=w,w=a[n],a[n]=a[i],a[i]=w,w=s[n],s[n]=s[i],s[i]=w),c=o[n],f=u[n],m=a[n],v=s[n],x=c[n],N=f[n],r=n+1;r<e;r++)C=c[r],_=f[r],c[r]=(C*x+_*N)/g,f[r]=(_*x-C*N)/g;for(r=0;r<e;r++)C=m[r],_=v[r],m[r]=(C*x+_*N)/g,v[r]=(_*x-C*N)/g;for(r=n+1;r<e;r++){for(p=o[r],d=u[r],h=a[r],y=s[r],x=p[n],N=d[n],i=n+1;i<e;i++)C=c[i],_=f[i],p[i]-=C*x-_*N,d[i]-=_*x+C*N;for(i=0;i<e;i++)C=m[i],_=v[i],h[i]-=C*x-_*N,y[i]-=_*x+C*N}}for(n=e-1;n>0;n--)for(m=a[n],v=s[n],r=n-1;r>=0;r--)for(h=a[r],y=s[r],x=o[r][n],N=u[r][n],i=e-1;i>=0;i--)C=m[i],_=v[i],h[i]-=x*C-N*_,y[i]-=x*_+N*C;return new numeric.T(a,s)},numeric.T.prototype.get=function(t){var e=this.x,n=this.y,r=0,i,a=t.length;if(n){for(;r<a;)i=t[r],e=e[i],n=n[i],r++;return new numeric.T(e,n)}for(;r<a;)i=t[r],e=e[i],r++;return new numeric.T(e)},numeric.T.prototype.set=function(t,e){var n=this.x,r=this.y,i=0,a,s=t.length,o=e.x,u=e.y;if(s===0)return u?this.y=u:r&&(this.y=void 0),this.x=n,this;if(u){for(r||(r=numeric.rep(numeric.dim(n),0),this.y=r);i<s-1;)a=t[i],n=n[a],r=r[a],i++;return a=t[i],n[a]=o,r[a]=u,this}if(r){for(;i<s-1;)a=t[i],n=n[a],r=r[a],i++;return a=t[i],n[a]=o,o instanceof Array?r[a]=numeric.rep(numeric.dim(o),0):r[a]=0,this}for(;i<s-1;)a=t[i],n=n[a],i++;return a=t[i],n[a]=o,this},numeric.T.prototype.getRows=function(t,e){var n=e-t+1,r,i=Array(n),a,s=this.x,o=this.y;for(r=t;r<=e;r++)i[r-t]=s[r];if(o){for(a=Array(n),r=t;r<=e;r++)a[r-t]=o[r];return new numeric.T(i,a)}return new numeric.T(i)},numeric.T.prototype.setRows=function(t,e,n){var r,i=this.x,a=this.y,s=n.x,o=n.y;for(r=t;r<=e;r++)i[r]=s[r-t];if(o)for(a||(a=numeric.rep(numeric.dim(i),0),this.y=a),r=t;r<=e;r++)a[r]=o[r-t];else if(a)for(r=t;r<=e;r++)a[r]=numeric.rep([s[r-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,n=this.y;return n?new numeric.T(e[t],n[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var n=this.x,r=this.y,i=e.x,a=e.y;return n[t]=i,a?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[t]=a):r&&(r=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var n=this.x,r=this.y,i=numeric.getBlock;return r?new numeric.T(i(n,t,e),i(r,t,e)):new numeric.T(i(n,t,e))},numeric.T.prototype.setBlock=function(t,e,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,i=this.y,a=numeric.setBlock,s=n.x,o=n.y;if(o)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),a(r,t,e,s),a(i,t,e,o),this;a(r,t,e,s),i&&a(i,t,e,numeric.rep(numeric.dim(s),0))},numeric.T.rep=function(t,e){var n=numeric.T;e instanceof n||(e=new n(e));var r=e.x,i=e.y,a=numeric.rep;return i?new n(a(t,r),a(t,i)):new n(a(t,r))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,n=t.y,r=numeric.diag;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,n=this.y;return n?new t.T(t.getDiag(e),t.getDiag(n)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),n=t[0]>=0?1:-1,r=n*numeric.norm2(t);e[0]+=r;var i=numeric.norm2(e);if(i===0)throw new Error("eig: internal error");return numeric.div(e,i)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n=e[0],r,i,a,s,o,u=numeric.clone(t),c,f,p,d,m=numeric.identity(n),v;for(i=0;i<n-2;i++){for(s=Array(n-i-1),r=i+1;r<n;r++)s[r-i-1]=u[r][i];if(numeric.norm2(s)>0){for(o=numeric.house(s),c=numeric.getBlock(u,[i+1,i],[n-1,n-1]),f=numeric.tensor(o,numeric.dot(o,c)),r=i+1;r<n;r++)for(p=u[r],d=f[r-i-1],a=i;a<n;a++)p[a]-=2*d[a-i];for(c=numeric.getBlock(u,[0,i+1],[n-1,n-1]),f=numeric.tensor(numeric.dot(c,o),o),r=0;r<n;r++)for(p=u[r],d=f[r],a=i+1;a<n;a++)p[a]-=2*d[a-i-1];for(c=Array(n-i-1),r=i+1;r<n;r++)c[r-i-1]=m[r];for(f=numeric.tensor(o,numeric.dot(o,c)),r=i+1;r<n;r++)for(v=m[r],d=f[r-i-1],a=0;a<n;a++)v[a]-=2*d[a]}}return{H:u,Q:m}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(l,t){typeof t=="undefined"&&(t=1e4),l=numeric.clone(l);var e=numeric.clone(l),n=numeric.dim(l),r=n[0],i,a,s,o,u,c,f,p,d,m=numeric.identity(r),v,h,y,g,b,x,N,C,_;if(r<3)return{Q:m,B:[[0,r-1]]};var w=numeric.epsilon;for(_=0;_<t;_++){for(N=0;N<r-1;N++)if(Math.abs(l[N+1][N])<w*(Math.abs(l[N][N])+Math.abs(l[N+1][N+1]))){var A=numeric.QRFrancis(numeric.getBlock(l,[0,0],[N,N]),t),$=numeric.QRFrancis(numeric.getBlock(l,[N+1,N+1],[r-1,r-1]),t);for(y=Array(N+1),x=0;x<=N;x++)y[x]=m[x];for(g=numeric.dot(A.Q,y),x=0;x<=N;x++)m[x]=g[x];for(y=Array(r-N-1),x=N+1;x<r;x++)y[x-N-1]=m[x];for(g=numeric.dot($.Q,y),x=N+1;x<r;x++)m[x]=g[x-N-1];return{Q:m,B:A.B.concat(numeric.add($.B,N+1))}}if(s=l[r-2][r-2],o=l[r-2][r-1],u=l[r-1][r-2],c=l[r-1][r-1],p=s+c,f=s*c-o*u,d=numeric.getBlock(l,[0,0],[2,2]),p*p>=4*f){var S,D;S=.5*(p+Math.sqrt(p*p-4*f)),D=.5*(p-Math.sqrt(p*p-4*f)),d=numeric.add(numeric.sub(numeric.dot(d,d),numeric.mul(d,S+D)),numeric.diag(numeric.rep([3],S*D)))}else d=numeric.add(numeric.sub(numeric.dot(d,d),numeric.mul(d,p)),numeric.diag(numeric.rep([3],f)));for(i=[d[0][0],d[1][0],d[2][0]],a=numeric.house(i),y=[l[0],l[1],l[2]],g=numeric.tensor(a,numeric.dot(a,y)),x=0;x<3;x++)for(h=l[x],b=g[x],C=0;C<r;C++)h[C]-=2*b[C];for(y=numeric.getBlock(l,[0,0],[r-1,2]),g=numeric.tensor(numeric.dot(y,a),a),x=0;x<r;x++)for(h=l[x],b=g[x],C=0;C<3;C++)h[C]-=2*b[C];for(y=[m[0],m[1],m[2]],g=numeric.tensor(a,numeric.dot(a,y)),x=0;x<3;x++)for(v=m[x],b=g[x],C=0;C<r;C++)v[C]-=2*b[C];var V;for(N=0;N<r-2;N++){for(C=N;C<=N+1;C++)if(Math.abs(l[C+1][C])<w*(Math.abs(l[C][C])+Math.abs(l[C+1][C+1]))){var A=numeric.QRFrancis(numeric.getBlock(l,[0,0],[C,C]),t),$=numeric.QRFrancis(numeric.getBlock(l,[C+1,C+1],[r-1,r-1]),t);for(y=Array(C+1),x=0;x<=C;x++)y[x]=m[x];for(g=numeric.dot(A.Q,y),x=0;x<=C;x++)m[x]=g[x];for(y=Array(r-C-1),x=C+1;x<r;x++)y[x-C-1]=m[x];for(g=numeric.dot($.Q,y),x=C+1;x<r;x++)m[x]=g[x-C-1];return{Q:m,B:A.B.concat(numeric.add($.B,C+1))}}for(V=Math.min(r-1,N+3),i=Array(V-N),x=N+1;x<=V;x++)i[x-N-1]=l[x][N];for(a=numeric.house(i),y=numeric.getBlock(l,[N+1,N],[V,r-1]),g=numeric.tensor(a,numeric.dot(a,y)),x=N+1;x<=V;x++)for(h=l[x],b=g[x-N-1],C=N;C<r;C++)h[C]-=2*b[C-N];for(y=numeric.getBlock(l,[0,N+1],[r-1,V]),g=numeric.tensor(numeric.dot(y,a),a),x=0;x<r;x++)for(h=l[x],b=g[x],C=N+1;C<=V;C++)h[C]-=2*b[C-N-1];for(y=Array(V-N),x=N+1;x<=V;x++)y[x-N-1]=m[x];for(g=numeric.tensor(a,numeric.dot(a,y)),x=N+1;x<=V;x++)for(v=m[x],b=g[x-N-1],C=0;C<r;C++)v[C]-=2*b[C]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var n=numeric.toUpperHessenberg(t),r=numeric.QRFrancis(n.H,e),i=numeric.T,a=t.length,s,o,u=r.B,c=numeric.dot(r.Q,numeric.dot(n.H,numeric.transpose(r.Q))),f=new i(numeric.dot(r.Q,n.Q)),p,d=u.length,m,v,h,y,g,b,x,N,C,_,w,A,$,S,D=Math.sqrt;for(o=0;o<d;o++)if(s=u[o][0],s!==u[o][1]){if(m=s+1,v=c[s][s],h=c[s][m],y=c[m][s],g=c[m][m],h===0&&y===0)continue;b=-v-g,x=v*g-h*y,N=b*b-4*x,N>=0?(b<0?C=-.5*(b-D(N)):C=-.5*(b+D(N)),$=(v-C)*(v-C)+h*h,S=y*y+(g-C)*(g-C),$>S?($=D($),w=(v-C)/$,A=h/$):(S=D(S),w=y/S,A=(g-C)/S),p=new i([[A,-w],[w,A]]),f.setRows(s,m,p.dot(f.getRows(s,m)))):(C=-.5*b,_=.5*D(-N),$=(v-C)*(v-C)+h*h,S=y*y+(g-C)*(g-C),$>S?($=D($+_*_),w=(v-C)/$,A=h/$,C=0,_/=$):(S=D(S+_*_),w=y/S,A=(g-C)/S,C=_/S,_=0),p=new i([[A,-w],[w,A]],[[C,_],[_,-C]]),f.setRows(s,m,p.dot(f.getRows(s,m))))}var V=f.dot(t).dot(f.transjugate()),a=t.length,I=numeric.T.identity(a);for(m=0;m<a;m++)if(m>0)for(o=m-1;o>=0;o--){var q=V.get([o,o]),K=V.get([m,m]);if(numeric.neq(q.x,K.x)||numeric.neq(q.y,K.y))C=V.getRow(o).getBlock([o],[m-1]),_=I.getRow(m).getBlock([o],[m-1]),I.set([m,o],V.get([o,m]).neg().sub(C.dot(_)).div(q.sub(K)));else{I.setRow(m,I.getRow(o));continue}}for(m=0;m<a;m++)C=I.getRow(m),I.setRow(m,C.div(C.norm2()));return I=I.transpose(),I=f.transjugate().dot(I),{lambda:V.getDiag(),E:I}},numeric.ccsSparse=function(t){var e=t.length,n,r,i,a,s=[];for(i=e-1;i!==-1;--i){r=t[i];for(a in r){for(a=parseInt(a);a>=s.length;)s[s.length]=0;r[a]!==0&&s[a]++}}var n=s.length,o=Array(n+1);for(o[0]=0,i=0;i<n;++i)o[i+1]=o[i]+s[i];var u=Array(o[n]),c=Array(o[n]);for(i=e-1;i!==-1;--i){r=t[i];for(a in r)r[a]!==0&&(s[a]--,u[o[a]+s[a]]=i,c[o[a]+s[a]]=r[a])}return[o,u,c]},numeric.ccsFull=function(t){var e=t[0],n=t[1],r=t[2],i=numeric.ccsDim(t),a=i[0],s=i[1],o,u,c,f,p=numeric.rep([a,s],0);for(o=0;o<s;o++)for(c=e[o],f=e[o+1],u=c;u<f;++u)p[n[u]][o]=r[u];return p},numeric.ccsTSolve=function(t,e,n,r,i){var a=t[0],s=t[1],o=t[2],u=a.length-1,c=Math.max,f=0;typeof r=="undefined"&&(n=numeric.rep([u],0)),typeof r=="undefined"&&(r=numeric.linspace(0,n.length-1)),typeof i=="undefined"&&(i=[]);function p(x){var N;if(n[x]===0){for(n[x]=1,N=a[x];N<a[x+1];++N)p(s[N]);i[f]=x,++f}}var d,m,v,h,y,g,b;for(d=r.length-1;d!==-1;--d)p(r[d]);for(i.length=f,d=i.length-1;d!==-1;--d)n[i[d]]=0;for(d=r.length-1;d!==-1;--d)m=r[d],n[m]=e[m];for(d=i.length-1;d!==-1;--d){for(m=i[d],v=a[m],h=c(a[m+1],v),y=v;y!==h;++y)if(s[y]===m){n[m]/=o[y];break}for(b=n[m],y=v;y!==h;++y)g=s[y],g!==m&&(n[g]-=b*o[y])}return n},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,n,r,i,a){var s=0,o,u=i.length,c=this.k,f=this.k1,p=this.j,d,m;if(r[t]===0)for(r[t]=1,p[0]=t,c[0]=d=e[t],f[0]=m=e[t+1];;)if(d>=m){if(i[u]=p[s],s===0)return;++u,--s,d=c[s],m=f[s]}else o=a[n[d]],r[o]===0?(r[o]=1,c[s]=d,++s,p[s]=o,d=e[o],f[s]=m=e[o+1]):++d},numeric.ccsLPSolve=function(t,e,n,r,i,a,s){var o=t[0],u=t[1],c=t[2],f=o.length-1,p=e[0],d=e[1],m=e[2],v,h,y,g,b,x,N,C,_;for(h=p[i],y=p[i+1],r.length=0,v=h;v<y;++v)s.dfs(a[d[v]],o,u,n,r,a);for(v=r.length-1;v!==-1;--v)n[r[v]]=0;for(v=h;v!==y;++v)g=a[d[v]],n[g]=m[v];for(v=r.length-1;v!==-1;--v){for(g=r[v],b=o[g],x=o[g+1],N=b;N<x;++N)if(a[u[N]]===g){n[g]/=c[N];break}for(_=n[g],N=b;N<x;++N)C=a[u[N]],C!==g&&(n[C]-=_*c[N])}return n},numeric.ccsLUP1=function(t,e){var n=t[0].length-1,r=[numeric.rep([n+1],0),[],[]],i=[numeric.rep([n+1],0),[],[]],a=r[0],s=r[1],o=r[2],u=i[0],c=i[1],f=i[2],p=numeric.rep([n],0),d=numeric.rep([n],0),m,v,h,y,g,b,x,N=numeric.ccsLPSolve,C=Math.abs,_=numeric.linspace(0,n-1),w=numeric.linspace(0,n-1),A=new numeric.ccsDFS(n);for(typeof e=="undefined"&&(e=1),m=0;m<n;++m){for(N(r,t,p,d,m,w,A),y=-1,g=-1,v=d.length-1;v!==-1;--v)h=d[v],!(h<=m)&&(b=C(p[h]),b>y&&(g=h,y=b));for(C(p[m])<e*y&&(v=_[m],y=_[g],_[m]=y,w[y]=m,_[g]=v,w[v]=g,y=p[m],p[m]=p[g],p[g]=y),y=a[m],g=u[m],x=p[m],s[y]=_[m],o[y]=1,++y,v=d.length-1;v!==-1;--v)h=d[v],b=p[h],d[v]=0,p[h]=0,h<=m?(c[g]=h,f[g]=b,++g):(s[y]=_[h],o[y]=b/x,++y);a[m+1]=y,u[m+1]=g}for(v=s.length-1;v!==-1;--v)s[v]=w[s[v]];return{L:r,U:i,P:_,Pinv:w}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,n,r,i,a,s){var o=0,u,c=i.length,f=this.k,p=this.k1,d=this.j,m,v;if(r[t]===0)for(r[t]=1,d[0]=t,f[0]=m=e[a[t]],p[0]=v=e[a[t]+1];;){if(isNaN(m))throw new Error("Ow!");if(m>=v){if(i[c]=a[d[o]],o===0)return;++c,--o,m=f[o],v=p[o]}else u=n[m],r[u]===0?(r[u]=1,f[o]=m,++o,d[o]=u,u=a[u],m=e[u],p[o]=v=e[u+1]):++m}},numeric.ccsLPSolve0=function(t,e,n,r,i,a,s,o){var u=t[0],c=t[1],f=t[2],p=u.length-1,d=e[0],m=e[1],v=e[2],h,y,g,b,x,N,C,_,w;for(y=d[i],g=d[i+1],r.length=0,h=y;h<g;++h)o.dfs(m[h],u,c,n,r,a,s);for(h=r.length-1;h!==-1;--h)b=r[h],n[s[b]]=0;for(h=y;h!==g;++h)b=m[h],n[b]=v[h];for(h=r.length-1;h!==-1;--h){for(b=r[h],_=s[b],x=u[b],N=u[b+1],C=x;C<N;++C)if(c[C]===_){n[_]/=f[C];break}for(w=n[_],C=x;C<N;++C)n[c[C]]-=w*f[C];n[_]=w}},numeric.ccsLUP0=function(t,e){var n=t[0].length-1,r=[numeric.rep([n+1],0),[],[]],i=[numeric.rep([n+1],0),[],[]],a=r[0],s=r[1],o=r[2],u=i[0],c=i[1],f=i[2],p=numeric.rep([n],0),d=numeric.rep([n],0),m,v,h,y,g,b,x,N=numeric.ccsLPSolve0,C=Math.abs,_=numeric.linspace(0,n-1),w=numeric.linspace(0,n-1),A=new numeric.ccsDFS0(n);for(typeof e=="undefined"&&(e=1),m=0;m<n;++m){for(N(r,t,p,d,m,w,_,A),y=-1,g=-1,v=d.length-1;v!==-1;--v)h=d[v],!(h<=m)&&(b=C(p[_[h]]),b>y&&(g=h,y=b));for(C(p[_[m]])<e*y&&(v=_[m],y=_[g],_[m]=y,w[y]=m,_[g]=v,w[v]=g),y=a[m],g=u[m],x=p[_[m]],s[y]=_[m],o[y]=1,++y,v=d.length-1;v!==-1;--v)h=d[v],b=p[_[h]],d[v]=0,p[_[h]]=0,h<=m?(c[g]=h,f[g]=b,++g):(s[y]=_[h],o[y]=b/x,++y);a[m+1]=y,u[m+1]=g}for(v=s.length-1;v!==-1;--v)s[v]=w[s[v]];return{L:r,U:i,P:_,Pinv:w}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,n){var r=numeric.ccsDim(t),i=r[0],a=r[1];typeof e=="undefined"?e=numeric.linspace(0,i-1):typeof e=="number"&&(e=[e]),typeof n=="undefined"?n=numeric.linspace(0,a-1):typeof n=="number"&&(n=[n]);var s,o=e.length,u,c=n.length,f,p,d,m=numeric.rep([a],0),v=[],h=[],y=[m,v,h],g=t[0],b=t[1],x=t[2],N=numeric.rep([i],0),C=0,_=numeric.rep([i],0);for(u=0;u<c;++u){p=n[u];var w=g[p],A=g[p+1];for(s=w;s<A;++s)f=b[s],_[f]=1,N[f]=x[s];for(s=0;s<o;++s)d=e[s],_[d]&&(v[C]=s,h[C]=N[e[s]],++C);for(s=w;s<A;++s)f=b[s],_[f]=0;m[u+1]=C}return y},numeric.ccsDot=function(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],s=e[1],o=e[2],u=numeric.ccsDim(t),c=numeric.ccsDim(e),f=u[0],p=u[1],d=c[1],m=numeric.rep([f],0),v=numeric.rep([f],0),h=Array(f),y=numeric.rep([d],0),g=[],b=[],x=[y,g,b],N,C,_,w,A,$,S,D,V,I,q;for(_=0;_!==d;++_){for(w=a[_],A=a[_+1],V=0,C=w;C<A;++C)for(I=s[C],q=o[C],$=n[I],S=n[I+1],N=$;N<S;++N)D=r[N],v[D]===0&&(h[V]=D,v[D]=1,V=V+1),m[D]=m[D]+i[N]*q;for(w=y[_],A=w+V,y[_+1]=A,C=V-1;C!==-1;--C)q=w+C,N=h[C],g[q]=N,b[q]=m[N],v[N]=0,m[N]=0;y[_+1]=y[_]+V}return x},numeric.ccsLUPSolve=function(t,e){var n=t.L,r=t.U,i=t.P,a=e[0],s=!1;typeof a!="object"&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],a=e[0],s=!0);var o=e[1],u=e[2],c=n[0].length-1,f=a.length-1,p=numeric.rep([c],0),d=Array(c),m=numeric.rep([c],0),v=Array(c),h=numeric.rep([f+1],0),y=[],g=[],b=numeric.ccsTSolve,x,N,C,_,w,A,$=0;for(x=0;x<f;++x){for(w=0,C=a[x],_=a[x+1],N=C;N<_;++N)A=t.Pinv[o[N]],v[w]=A,m[A]=u[N],++w;for(v.length=w,b(n,m,p,v,d),N=v.length-1;N!==-1;--N)m[v[N]]=0;if(b(r,p,m,d,v),s)return m;for(N=d.length-1;N!==-1;--N)p[d[N]]=0;for(N=v.length-1;N!==-1;--N)A=v[N],y[$]=A,g[$]=m[A],m[A]=0,++$;h[x+1]=$}return[h,y,g]},numeric.ccsbinop=function(t,e){return typeof e=="undefined"&&(e=""),Function("X","Y",`var Xi = X[0], Xj = X[1], Xv = X[2];
var Yi = Y[0], Yj = Y[1], Yv = Y[2];
var n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;
var Zi = numeric.rep([n+1],0), Zj = [], Zv = [];
var x = numeric.rep([m],0),y = numeric.rep([m],0);
var xk,yk,zk;
var i,j,j0,j1,k,p=0;
`+e+`for(i=0;i<n;++i) {
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Xj[j];
    x[k] = 1;
    Zj[p] = k;
    ++p;
  }
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Yj[j];
    y[k] = Yv[j];
    if(x[k] === 0) {
      Zj[p] = k;
      ++p;
    }
  }
  Zi[i+1] = p;
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];
  j0 = Zi[i]; j1 = Zi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Zj[j];
    xk = x[k];
    yk = y[k];
`+t+`
    Zv[j] = zk;
  }
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;
}
return [Zi,Zj,Zv];`)},function(){var k,A,B,C;for(k in numeric.ops2)isFinite(eval("1"+numeric.ops2[k]+"0"))?A="[Y[0],Y[1],numeric."+k+"(X,Y[2])]":A="NaN",isFinite(eval("0"+numeric.ops2[k]+"1"))?B="[X[0],X[1],numeric."+k+"(X[2],Y)]":B="NaN",isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?C="numeric.ccs"+k+"MM(X,Y)":C="NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+`;
if(typeof Y === "number") return `+B+`;
return `+C+`;
`)}(),numeric.ccsScatter=function(t){var e=t[0],n=t[1],r=t[2],i=numeric.sup(n)+1,a=e.length,s=numeric.rep([i],0),o=Array(a),u=Array(a),c=numeric.rep([i],0),f;for(f=0;f<a;++f)c[n[f]]++;for(f=0;f<i;++f)s[f+1]=s[f]+c[f];var p=s.slice(0),d,m;for(f=0;f<a;++f)m=n[f],d=p[m],o[d]=e[f],u[d]=r[f],p[m]=p[m]+1;return[s,o,u]},numeric.ccsGather=function(t){var e=t[0],n=t[1],r=t[2],i=e.length-1,a=n.length,s=Array(a),o=Array(a),u=Array(a),c,f,p,d,m;for(m=0,c=0;c<i;++c)for(p=e[c],d=e[c+1],f=p;f!==d;++f)o[m]=c,s[m]=n[f],u[m]=r[f],++m;return[s,o,u]},numeric.sdim=function l(t,e,n){if(typeof e=="undefined"&&(e=[]),typeof t!="object")return e;typeof n=="undefined"&&(n=0),n in e||(e[n]=0),t.length>e[n]&&(e[n]=t.length);var r;for(r in t)t.hasOwnProperty(r)&&l(t[r],e,n+1);return e},numeric.sclone=function l(t,e,n){typeof e=="undefined"&&(e=0),typeof n=="undefined"&&(n=numeric.sdim(t).length);var r,i=Array(t.length);if(e===n-1){for(r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);return i}for(r in t)t.hasOwnProperty(r)&&(i[r]=l(t[r],e+1,n));return i},numeric.sdiag=function(t){var e=t.length,n,r=Array(e),i;for(n=e-1;n>=1;n-=2)i=n-1,r[n]=[],r[n][n]=t[n],r[i]=[],r[i][i]=t[i];return n===0&&(r[0]=[],r[0][0]=t[n]),r},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e=[],n=t.length,r,i,a;for(r in t)if(!!t.hasOwnProperty(r)){a=t[r];for(i in a)!a.hasOwnProperty(i)||(typeof e[i]!="object"&&(e[i]=[]),e[i][r]=a[i])}return e},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var n=t.length,r=e.length,i=numeric.stranspose(e),a=i.length,s,o,u,c,f,p,d=Array(n),m;for(u=n-1;u>=0;u--){for(m=[],s=t[u],f=a-1;f>=0;f--){p=0,o=i[f];for(c in s)!s.hasOwnProperty(c)||c in o&&(p+=s[c]*o[c]);p&&(m[f]=p)}d[u]=m}return d},numeric.sdotMV=function(t,e){var n=t.length,r,i,a,s=Array(n),o;for(i=n-1;i>=0;i--){r=t[i],o=0;for(a in r)!r.hasOwnProperty(a)||e[a]&&(o+=r[a]*e[a]);o&&(s[i]=o)}return s},numeric.sdotVM=function(t,e){var n,r,i,a,s=[];for(n in t)if(!!t.hasOwnProperty(n)){i=e[n],a=t[n];for(r in i)!i.hasOwnProperty(r)||(s[r]||(s[r]=0),s[r]+=a*i[r])}return s},numeric.sdotVV=function(t,e){var n,r=0;for(n in t)t[n]&&e[n]&&(r+=t[n]*e[n]);return r},numeric.sdot=function(t,e){var n=numeric.sdim(t).length,r=numeric.sdim(e).length,i=n*1e3+r;switch(i){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(t){var e=t[0].length,n,r,i,a=t.length,s=[],o;for(r=e-1;r>=0;--r)if(!!t[a-1][r]){for(o=s,i=0;i<a-2;i++)n=t[i][r],o[n]||(o[n]=[]),o=o[n];o[t[i][r]]=t[i+1][r]}return s},numeric.sgather=function l(t,e,n){typeof e=="undefined"&&(e=[]),typeof n=="undefined"&&(n=[]);var r,i,a;r=n.length;for(i in t)if(t.hasOwnProperty(i))if(n[r]=parseInt(i),a=t[i],typeof a=="number"){if(a){if(e.length===0)for(i=r+1;i>=0;--i)e[i]=[];for(i=r;i>=0;--i)e[i].push(n[i]);e[r+1].push(a)}}else l(a,e,n);return n.length>r&&n.pop(),e},numeric.cLU=function(t){var e=t[0],n=t[1],r=t[2],i=e.length,a=0,s,o,u,c,f,p;for(s=0;s<i;s++)e[s]>a&&(a=e[s]);a++;var d=Array(a),m=Array(a),v=numeric.rep([a],Infinity),h=numeric.rep([a],-Infinity),y,g,b;for(u=0;u<i;u++)s=e[u],o=n[u],o<v[s]&&(v[s]=o),o>h[s]&&(h[s]=o);for(s=0;s<a-1;s++)h[s]>h[s+1]&&(h[s+1]=h[s]);for(s=a-1;s>=1;s--)v[s]<v[s-1]&&(v[s-1]=v[s]);var x=0,N=0;for(s=0;s<a;s++)m[s]=numeric.rep([h[s]-v[s]+1],0),d[s]=numeric.rep([s-v[s]],0),x+=s-v[s]+1,N+=h[s]-s+1;for(u=0;u<i;u++)s=e[u],m[s][n[u]-v[s]]=r[u];for(s=0;s<a-1;s++)for(c=s-v[s],y=m[s],o=s+1;v[o]<=s&&o<a;o++)if(f=s-v[o],p=h[s]-s,g=m[o],b=g[f]/y[c],b){for(u=1;u<=p;u++)g[u+f]-=b*y[u+c];d[o][s-v[o]]=b}var y=[],g=[],C=[],_=[],w=[],A=[],i,$,S;for(i=0,$=0,s=0;s<a;s++){for(c=v[s],f=h[s],S=m[s],o=s;o<=f;o++)S[o-c]&&(y[i]=s,g[i]=o,C[i]=S[o-c],i++);for(S=d[s],o=c;o<s;o++)S[o-c]&&(_[$]=s,w[$]=o,A[$]=S[o-c],$++);_[$]=s,w[$]=s,A[$]=1,$++}return{U:[y,g,C],L:[_,w,A]}},numeric.cLUsolve=function(t,e){var n=t.L,r=t.U,i=numeric.clone(e),a=n[0],s=n[1],o=n[2],u=r[0],c=r[1],f=r[2],p=u.length,d=a.length,m=i.length,v,h;for(h=0,v=0;v<m;v++){for(;s[h]<v;)i[v]-=o[h]*i[s[h]],h++;h++}for(h=p-1,v=m-1;v>=0;v--){for(;c[h]>v;)i[v]-=f[h]*i[c[h]],h--;i[v]/=f[h],h--}return i},numeric.cgrid=function(t,e){typeof t=="number"&&(t=[t,t]);var n=numeric.rep(t,-1),r,i,a;if(typeof e!="function")switch(e){case"L":e=function(s,o){return s>=t[0]/2||o<t[1]/2};break;default:e=function(s,o){return!0};break}for(a=0,r=1;r<t[0]-1;r++)for(i=1;i<t[1]-1;i++)e(r,i)&&(n[r][i]=a,a++);return n},numeric.cdelsq=function(t){var e=[[-1,0],[0,-1],[0,1],[1,0]],n=numeric.dim(t),r=n[0],i=n[1],a,s,o,u,c,f=[],p=[],d=[];for(a=1;a<r-1;a++)for(s=1;s<i-1;s++)if(!(t[a][s]<0)){for(o=0;o<4;o++)u=a+e[o][0],c=s+e[o][1],!(t[u][c]<0)&&(f.push(t[a][s]),p.push(t[u][c]),d.push(-1));f.push(t[a][s]),p.push(t[a][s]),d.push(4)}return[f,p,d]},numeric.cdotMV=function(t,e){var n,r=t[0],i=t[1],a=t[2],s,o=r.length,u;for(u=0,s=0;s<o;s++)r[s]>u&&(u=r[s]);for(u++,n=numeric.rep([u],0),s=0;s<o;s++)n[r[s]]+=a[s]*e[i[s]];return n},numeric.Spline=function(t,e,n,r,i){this.x=t,this.yl=e,this.yr=n,this.kl=r,this.kr=i},numeric.Spline.prototype._at=function(t,e){var n=this.x,r=this.yl,i=this.yr,a=this.kl,s=this.kr,t,o,u,c,f=numeric.add,p=numeric.sub,d=numeric.mul;o=p(d(a[e],n[e+1]-n[e]),p(i[e+1],r[e])),u=f(d(s[e+1],n[e]-n[e+1]),p(i[e+1],r[e])),c=(t-n[e])/(n[e+1]-n[e]);var m=c*(1-c);return f(f(f(d(1-c,r[e]),d(c,i[e+1])),d(o,m*(1-c))),d(u,m*c))},numeric.Spline.prototype.at=function(t){if(typeof t=="number"){var e=this.x,s=e.length,n,r,i,a=Math.floor;for(n=0,r=s-1;r-n>1;)i=a((n+r)/2),e[i]<=t?n=i:r=i;return this._at(t,n)}var s=t.length,o,u=Array(s);for(o=s-1;o!==-1;--o)u[o]=this.at(t[o]);return u},numeric.Spline.prototype.diff=function(){var t=this.x,e=this.yl,n=this.yr,r=this.kl,i=this.kr,a=e.length,s,o,u,c=r,f=i,p=Array(a),d=Array(a),m=numeric.add,v=numeric.mul,h=numeric.div,y=numeric.sub;for(s=a-1;s!==-1;--s)o=t[s+1]-t[s],u=y(n[s+1],e[s]),p[s]=h(m(v(u,6),v(r[s],-4*o),v(i[s+1],-2*o)),o*o),d[s+1]=h(m(v(u,-6),v(r[s],2*o),v(i[s+1],4*o)),o*o);return new numeric.Spline(t,c,f,p,d)},numeric.Spline.prototype.roots=function(){function t(P){return P*P}var e=[],n=this.x,r=this.yl,i=this.yr,a=this.kl,s=this.kr;typeof r[0]=="number"&&(r=[r],i=[i],a=[a],s=[s]);var o=r.length,u=n.length-1,c,f,p,d,m,v,h,e=Array(o),y,g,b,x,N,C,_,w,A,$,S,D,V,I,q,K,E,W=Math.sqrt;for(c=0;c!==o;++c){for(d=r[c],m=i[c],v=a[c],h=s[c],y=[],f=0;f!==u;f++){for(f>0&&m[f]*d[f]<0&&y.push(n[f]),A=n[f+1]-n[f],$=n[f],x=d[f],N=m[f+1],g=v[f]/A,b=h[f+1]/A,w=t(g-b+3*(x-N))+12*b*x,C=b+3*x+2*g-3*N,_=3*(b+g+2*(x-N)),w<=0?(D=C/_,D>n[f]&&D<n[f+1]?S=[n[f],D,n[f+1]]:S=[n[f],n[f+1]]):(D=(C-W(w))/_,V=(C+W(w))/_,S=[n[f]],D>n[f]&&D<n[f+1]&&S.push(D),V>n[f]&&V<n[f+1]&&S.push(V),S.push(n[f+1])),q=S[0],D=this._at(q,f),p=0;p<S.length-1;p++){if(K=S[p+1],V=this._at(K,f),D===0){y.push(q),q=K,D=V;continue}if(V===0||D*V>0){q=K,D=V;continue}for(var G=0;E=(D*K-V*q)/(D-V),!(E<=q||E>=K);)if(I=this._at(E,f),I*V>0)K=E,V=I,G===-1&&(D*=.5),G=-1;else if(I*D>0)q=E,D=I,G===1&&(V*=.5),G=1;else break;y.push(E),q=S[p+1],D=this._at(q,f)}V===0&&y.push(K)}e[c]=y}return typeof this.yl[0]=="number"?e[0]:e},numeric.spline=function(t,e,n,r){var i=t.length,a=[],s=[],o=[],u,c=numeric.sub,f=numeric.mul,p=numeric.add;for(u=i-2;u>=0;u--)s[u]=t[u+1]-t[u],o[u]=c(e[u+1],e[u]);(typeof n=="string"||typeof r=="string")&&(n=r="periodic");var d=[[],[],[]];switch(typeof n){case"undefined":a[0]=f(3/(s[0]*s[0]),o[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/s[0],1/s[0]);break;case"string":a[0]=p(f(3/(s[i-2]*s[i-2]),o[i-2]),f(3/(s[0]*s[0]),o[0])),d[0].push(0,0,0),d[1].push(i-2,0,1),d[2].push(1/s[i-2],2/s[i-2]+2/s[0],1/s[0]);break;default:a[0]=n,d[0].push(0),d[1].push(0),d[2].push(1);break}for(u=1;u<i-1;u++)a[u]=p(f(3/(s[u-1]*s[u-1]),o[u-1]),f(3/(s[u]*s[u]),o[u])),d[0].push(u,u,u),d[1].push(u-1,u,u+1),d[2].push(1/s[u-1],2/s[u-1]+2/s[u],1/s[u]);switch(typeof r){case"undefined":a[i-1]=f(3/(s[i-2]*s[i-2]),o[i-2]),d[0].push(i-1,i-1),d[1].push(i-2,i-1),d[2].push(1/s[i-2],2/s[i-2]);break;case"string":d[1][d[1].length-1]=0;break;default:a[i-1]=r,d[0].push(i-1),d[1].push(i-1),d[2].push(1);break}typeof a[0]!="number"?a=numeric.transpose(a):a=[a];var m=Array(a.length);if(typeof n=="string")for(u=m.length-1;u!==-1;--u)m[u]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(d)),a[u]),m[u][i-1]=m[u][0];else for(u=m.length-1;u!==-1;--u)m[u]=numeric.cLUsolve(numeric.cLU(d),a[u]);return typeof e[0]=="number"?m=m[0]:m=numeric.transpose(m),new numeric.Spline(t,e,e,m,m)},numeric.fftpow2=function l(t,e){var n=t.length;if(n!==1){var r=Math.cos,i=Math.sin,a,s,o=Array(n/2),u=Array(n/2),c=Array(n/2),f=Array(n/2);for(s=n/2,a=n-1;a!==-1;--a)--s,c[s]=t[a],f[s]=e[a],--a,o[s]=t[a],u[s]=e[a];l(o,u),l(c,f),s=n/2;var p,d=-6.283185307179586/n,m,v;for(a=n-1;a!==-1;--a)--s,s===-1&&(s=n/2-1),p=d*a,m=r(p),v=i(p),t[a]=o[s]+m*c[s]-v*f[s],e[a]=u[s]+m*f[s]+v*c[s]}},numeric._ifftpow2=function l(t,e){var n=t.length;if(n!==1){var r=Math.cos,i=Math.sin,a,s,o=Array(n/2),u=Array(n/2),c=Array(n/2),f=Array(n/2);for(s=n/2,a=n-1;a!==-1;--a)--s,c[s]=t[a],f[s]=e[a],--a,o[s]=t[a],u[s]=e[a];l(o,u),l(c,f),s=n/2;var p,d=6.283185307179586/n,m,v;for(a=n-1;a!==-1;--a)--s,s===-1&&(s=n/2-1),p=d*a,m=r(p),v=i(p),t[a]=o[s]+m*c[s]-v*f[s],e[a]=u[s]+m*f[s]+v*c[s]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,n,r){numeric.fftpow2(t,e),numeric.fftpow2(n,r);var i,a=t.length,s,o,u,c;for(i=a-1;i!==-1;--i)s=t[i],u=e[i],o=n[i],c=r[i],t[i]=s*o-u*c,e[i]=s*c+u*o;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t=this.x,e=this.y,n=t.length,r=Math.log,i=r(2),a=Math.ceil(r(2*n-1)/i),s=Math.pow(2,a),o=numeric.rep([s],0),u=numeric.rep([s],0),c=Math.cos,f=Math.sin,p,d=-3.141592653589793/n,m,v=numeric.rep([s],0),h=numeric.rep([s],0);for(p=0;p<n;p++)v[p]=t[p];if(typeof e!="undefined")for(p=0;p<n;p++)h[p]=e[p];for(o[0]=1,p=1;p<=s/2;p++)m=d*p*p,o[p]=c(m),u[p]=f(m),o[s-p]=c(m),u[s-p]=f(m);var y=new numeric.T(v,h),g=new numeric.T(o,u);return y=y.mul(g),numeric.convpow2(y.x,y.y,numeric.clone(g.x),numeric.neg(g.y)),y=y.mul(g),y.x.length=n,y.y.length=n,y},numeric.T.prototype.ifft=function(){var t=this.x,e=this.y,n=t.length,r=Math.log,i=r(2),a=Math.ceil(r(2*n-1)/i),s=Math.pow(2,a),o=numeric.rep([s],0),u=numeric.rep([s],0),c=Math.cos,f=Math.sin,p,d=3.141592653589793/n,m,v=numeric.rep([s],0),h=numeric.rep([s],0);for(p=0;p<n;p++)v[p]=t[p];if(typeof e!="undefined")for(p=0;p<n;p++)h[p]=e[p];for(o[0]=1,p=1;p<=s/2;p++)m=d*p*p,o[p]=c(m),u[p]=f(m),o[s-p]=c(m),u[s-p]=f(m);var y=new numeric.T(v,h),g=new numeric.T(o,u);return y=y.mul(g),numeric.convpow2(y.x,y.y,numeric.clone(g.x),numeric.neg(g.y)),y=y.mul(g),y.x.length=n,y.y.length=n,y.div(n)},numeric.gradient=function(t,e){var n=e.length,r=t(e);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var i=Math.max,a,s=numeric.clone(e),o,u,c=Array(n),f=numeric.div,p=numeric.sub,d,i=Math.max,m=.001,v=Math.abs,h=Math.min,y,g,b,x=0,N,C,_;for(a=0;a<n;a++)for(var w=i(1e-6*r,1e-8);;){if(++x,x>20)throw new Error("Numerical gradient fails");if(s[a]=e[a]+w,o=t(s),s[a]=e[a]-w,u=t(s),s[a]=e[a],isNaN(o)||isNaN(u)){w/=16;continue}if(c[a]=(o-u)/(2*w),y=e[a]-w,g=e[a],b=e[a]+w,N=(o-r)/w,C=(r-u)/w,_=i(v(c[a]),v(r),v(o),v(u),v(y),v(g),v(b),1e-8),d=h(i(v(N-c[a]),v(C-c[a]),v(N-C))/_,w/_),d>m)w/=16;else break}return c},numeric.uncmin=function(t,e,n,r,i,a,s){var o=numeric.gradient;typeof s=="undefined"&&(s={}),typeof n=="undefined"&&(n=1e-8),typeof r=="undefined"&&(r=function(ne){return o(t,ne)}),typeof i=="undefined"&&(i=1e3),e=numeric.clone(e);var u=e.length,c=t(e),f,p;if(isNaN(c))throw new Error("uncmin: f(x0) is a NaN!");var d=Math.max,m=numeric.norm2;n=d(n,numeric.epsilon);var v,h,y,g=s.Hinv||numeric.identity(u),b=numeric.dot,x=numeric.inv,N=numeric.sub,C=numeric.add,_=numeric.tensor,w=numeric.div,A=numeric.mul,$=numeric.all,S=numeric.isFinite,D=numeric.neg,V=0,I,q,K,E,W,G,P,Q="";for(h=r(e);V<i;){if(typeof a=="function"&&a(V,e,c,h,g)){Q="Callback returned true";break}if(!$(S(h))){Q="Gradient has Infinity or NaN";break}if(v=D(b(g,h)),!$(S(v))){Q="Search direction has Infinity or NaN";break}if(P=m(v),P<n){Q="Newton step smaller than tol";break}for(G=1,p=b(h,v),q=e;V<i&&!(G*P<n);){if(I=A(v,G),q=C(e,I),f=t(q),f-c>=.1*G*p||isNaN(f)){G*=.5,++V;continue}break}if(G*P<n){Q="Line search step size smaller than tol";break}if(V===i){Q="maxit reached during line search";break}y=r(q),K=N(y,h),W=b(K,I),E=b(g,K),g=N(C(g,A((W+b(K,E))/(W*W),_(I,I))),w(C(_(E,I),_(I,E)),W)),e=q,c=f,h=y,++V}return{solution:e,f:c,gradient:h,invHessian:g,iterations:V,message:Q}},numeric.Dopri=function(t,e,n,r,i,a,s){this.x=t,this.y=e,this.f=n,this.ymid=r,this.iterations=i,this.events=s,this.message=a},numeric.Dopri.prototype._at=function(t,e){function n(w){return w*w}var r=this,i=r.x,a=r.y,s=r.f,o=r.ymid,u=i.length,c,f,p,d,m,v,t,h,y=.5,g=numeric.add,b=numeric.mul,x=numeric.sub,N,C,_;return c=i[e],f=i[e+1],d=a[e],m=a[e+1],h=f-c,p=c+y*h,v=o[e],N=x(s[e],b(d,1/(c-p)+2/(c-f))),C=x(s[e+1],b(m,1/(f-p)+2/(f-c))),_=[n(t-f)*(t-p)/n(c-f)/(c-p),n(t-c)*n(t-f)/n(c-p)/n(f-p),n(t-c)*(t-p)/n(f-c)/(f-p),(t-c)*n(t-f)*(t-p)/n(c-f)/(c-p),(t-f)*n(t-c)*(t-p)/n(c-f)/(f-p)],g(g(g(g(b(d,_[0]),b(v,_[1])),b(m,_[2])),b(N,_[3])),b(C,_[4]))},numeric.Dopri.prototype.at=function(t){var e,n,r,i=Math.floor;if(typeof t!="number"){var a=t.length,s=Array(a);for(e=a-1;e!==-1;--e)s[e]=this.at(t[e]);return s}var o=this.x;for(e=0,n=o.length-1;n-e>1;)r=i(.5*(e+n)),o[r]<=t?e=r:n=r;return this._at(t,e)},numeric.dopri=function(t,e,n,r,i,a,s){typeof i=="undefined"&&(i=1e-6),typeof a=="undefined"&&(a=1e3);var o=[t],u=[n],c=[r(t,n)],f,p,d,m,v,h,y=[],g=1/5,b=[3/40,9/40],x=[44/45,-56/15,32/9],N=[19372/6561,-25360/2187,64448/6561,-212/729],C=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],_=[35/384,0,500/1113,125/192,-2187/6784,11/84],w=[.5*6025192743/30085553152,0,.5*51252292925/65400821598,.5*-2691868925/45128329728,.5*187940372067/1594534317056,.5*-1776094331/19743644256,.5*11237099/235043384],A=[1/5,3/10,4/5,8/9,1,1],$=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],S=0,D,V,I=(e-t)/10,q=0,K=numeric.add,E=numeric.mul,W,G,P=Math.min,Q=Math.abs,ne=numeric.norminf,Y=Math.pow,se=numeric.any,pe=numeric.lt,oe=numeric.and,ve=numeric.sub,O,z,Z,J=new numeric.Dopri(o,u,c,y,-1,"");for(typeof s=="function"&&(O=s(t,n));t<e&&q<a;){if(++q,t+I>e&&(I=e-t),f=r(t+A[0]*I,K(n,E(g*I,c[S]))),p=r(t+A[1]*I,K(K(n,E(b[0]*I,c[S])),E(b[1]*I,f))),d=r(t+A[2]*I,K(K(K(n,E(x[0]*I,c[S])),E(x[1]*I,f)),E(x[2]*I,p))),m=r(t+A[3]*I,K(K(K(K(n,E(N[0]*I,c[S])),E(N[1]*I,f)),E(N[2]*I,p)),E(N[3]*I,d))),v=r(t+A[4]*I,K(K(K(K(K(n,E(C[0]*I,c[S])),E(C[1]*I,f)),E(C[2]*I,p)),E(C[3]*I,d)),E(C[4]*I,m))),W=K(K(K(K(K(n,E(c[S],I*_[0])),E(p,I*_[2])),E(d,I*_[3])),E(m,I*_[4])),E(v,I*_[5])),h=r(t+I,W),D=K(K(K(K(K(E(c[S],I*$[0]),E(p,I*$[2])),E(d,I*$[3])),E(m,I*$[4])),E(v,I*$[5])),E(h,I*$[6])),typeof D=="number"?G=Q(D):G=ne(D),G>i){if(I=.2*I*Y(i/G,.25),t+I===t){J.msg="Step size became too small";break}continue}if(y[S]=K(K(K(K(K(K(n,E(c[S],I*w[0])),E(p,I*w[2])),E(d,I*w[3])),E(m,I*w[4])),E(v,I*w[5])),E(h,I*w[6])),++S,o[S]=t+I,u[S]=W,c[S]=h,typeof s=="function"){var R,F=t,X=t+.5*I,te;if(z=s(X,y[S-1]),Z=oe(pe(O,0),pe(0,z)),se(Z)||(F=X,X=t+I,O=z,z=s(X,W),Z=oe(pe(O,0),pe(0,z))),se(Z)){for(var de,he,H=0,re=1,ce=1;;){if(typeof O=="number")te=(ce*z*F-re*O*X)/(ce*z-re*O);else for(te=X,V=O.length-1;V!==-1;--V)O[V]<0&&z[V]>0&&(te=P(te,(ce*z[V]*F-re*O[V]*X)/(ce*z[V]-re*O[V])));if(te<=F||te>=X)break;R=J._at(te,S-1),he=s(te,R),de=oe(pe(O,0),pe(0,he)),se(de)?(X=te,z=he,Z=de,ce=1,H===-1?re*=.5:re=1,H=-1):(F=te,O=he,re=1,H===1?ce*=.5:ce=1,H=1)}return W=J._at(.5*(t+te),S-1),J.f[S]=r(te,R),J.x[S]=te,J.y[S]=R,J.ymid[S-1]=W,J.events=Z,J.iterations=q,J}}t+=I,n=W,O=z,I=P(.8*I*Y(i/G,.25),4*I)}return J.iterations=q,J},numeric.LU=function(l,t){t=t||!1;var e=Math.abs,n,r,i,a,s,o,u,c,f,p=l.length,d=p-1,m=new Array(p);for(t||(l=numeric.clone(l)),i=0;i<p;++i){for(u=i,o=l[i],f=e(o[i]),r=i+1;r<p;++r)a=e(l[r][i]),f<a&&(f=a,u=r);for(m[i]=u,u!=i&&(l[i]=l[u],l[u]=o,o=l[i]),s=o[i],n=i+1;n<p;++n)l[n][i]/=s;for(n=i+1;n<p;++n){for(c=l[n],r=i+1;r<d;++r)c[r]-=c[i]*o[r],++r,c[r]-=c[i]*o[r];r===d&&(c[r]-=c[i]*o[r])}}return{LU:l,P:m}},numeric.LUsolve=function(t,e){var n,r,i=t.LU,a=i.length,s=numeric.clone(e),o=t.P,u,c,f;for(n=a-1;n!==-1;--n)s[n]=e[n];for(n=0;n<a;++n)for(u=o[n],o[n]!==n&&(f=s[n],s[n]=s[u],s[u]=f),c=i[n],r=0;r<n;++r)s[n]-=s[r]*c[r];for(n=a-1;n>=0;--n){for(c=i[n],r=n+1;r<a;++r)s[n]-=s[r]*c[r];s[n]/=c[n]}return s},numeric.solve=function(t,e,n){return numeric.LUsolve(numeric.LU(t,n),e)},numeric.echelonize=function(t){var e=numeric.dim(t),n=e[0],r=e[1],i=numeric.identity(n),a=Array(n),s,o,u,c,f,p,d,m,v=Math.abs,h=numeric.diveq;for(t=numeric.clone(t),s=0;s<n;++s){for(u=0,f=t[s],p=i[s],o=1;o<r;++o)v(f[u])<v(f[o])&&(u=o);for(a[s]=u,h(p,f[u]),h(f,f[u]),o=0;o<n;++o)if(o!==s){for(d=t[o],m=d[u],c=r-1;c!==-1;--c)d[c]-=f[c]*m;for(d=i[o],c=n-1;c!==-1;--c)d[c]-=p[c]*m}}return{I:i,A:t,P:a}},numeric.__solveLP=function(t,e,n,r,i,a,s){var o=numeric.sum,u=numeric.log,c=numeric.mul,f=numeric.sub,p=numeric.dot,d=numeric.div,m=numeric.add,v=t.length,h=n.length,y,g=!1,b=0,x=1,N=numeric.transpose(e),C=numeric.svd,_=numeric.transpose,w=numeric.leq,A=Math.sqrt,$=Math.abs,S=numeric.muleq,D=numeric.norminf,V=numeric.any,I=Math.min,q=numeric.all,K=numeric.gt,E=Array(v),W=Array(h),G=numeric.rep([h],1),P,Q=numeric.solve,ne=f(n,p(e,a)),Y,se=p(t,t),pe;for(Y=b;Y<i;++Y){var oe,ve;for(oe=h-1;oe!==-1;--oe)W[oe]=d(e[oe],ne[oe]);var O=_(W);for(oe=v-1;oe!==-1;--oe)E[oe]=o(O[oe]);x=.25*$(se/p(t,E));var z=100*A(se/p(E,E));for((!isFinite(x)||x>z)&&(x=z),pe=m(t,c(x,E)),P=p(O,W),oe=v-1;oe!==-1;--oe)P[oe][oe]+=1;ve=Q(P,d(pe,x),!0);var Z=d(ne,p(e,ve)),J=1;for(oe=h-1;oe!==-1;--oe)Z[oe]<0&&(J=I(J,-.999*Z[oe]));if(y=f(a,c(ve,J)),ne=f(n,p(e,y)),!q(K(ne,0)))return{solution:a,message:"",iterations:Y};if(a=y,x<r)return{solution:y,message:"",iterations:Y};if(s){var R=p(t,pe),F=p(e,pe);for(g=!0,oe=h-1;oe!==-1;--oe)if(R*F[oe]<0){g=!1;break}}else a[v-1]>=0?g=!1:g=!0;if(g)return{solution:y,message:"Unbounded",iterations:Y}}return{solution:a,message:"maximum iteration count exceeded",iterations:Y}},numeric._solveLP=function(t,e,n,r,i){var a=t.length,s=n.length,o,u=numeric.sum,c=numeric.log,f=numeric.mul,p=numeric.sub,d=numeric.dot,m=numeric.div,v=numeric.add,h=numeric.rep([a],0).concat([1]),y=numeric.rep([s,1],-1),g=numeric.blockMatrix([[e,y]]),b=n,o=numeric.rep([a],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),x=numeric.__solveLP(h,g,b,r,i,o,!1),N=numeric.clone(x.solution);N.length=a;var C=numeric.inf(p(n,d(e,N)));if(C<0)return{solution:NaN,message:"Infeasible",iterations:x.iterations};var _=numeric.__solveLP(t,e,n,r,i-x.iterations,N,!0);return _.iterations+=x.iterations,_},numeric.solveLP=function(t,e,n,r,i,a,s){if(typeof s=="undefined"&&(s=1e3),typeof a=="undefined"&&(a=numeric.epsilon),typeof r=="undefined")return numeric._solveLP(t,e,n,a,s);var o=r.length,u=r[0].length,c=e.length,f=numeric.echelonize(r),p=numeric.rep([u],0),d=f.P,m=[],v;for(v=d.length-1;v!==-1;--v)p[d[v]]=1;for(v=u-1;v!==-1;--v)p[v]===0&&m.push(v);var h=numeric.getRange,y=numeric.linspace(0,o-1),g=numeric.linspace(0,c-1),b=h(r,y,m),x=h(e,g,d),N=h(e,g,m),C=numeric.dot,_=numeric.sub,w=C(x,f.I),A=_(N,C(w,b)),$=_(n,C(w,i)),S=Array(d.length),D=Array(m.length);for(v=d.length-1;v!==-1;--v)S[v]=t[d[v]];for(v=m.length-1;v!==-1;--v)D[v]=t[m[v]];var V=_(D,C(S,C(f.I,b))),I=numeric._solveLP(V,A,$,a,s),q=I.solution;if(q!==q)return I;var K=C(f.I,_(i,C(b,q))),E=Array(t.length);for(v=d.length-1;v!==-1;--v)E[d[v]]=K[v];for(v=m.length-1;v!==-1;--v)E[m[v]]=q[v];return{solution:E,message:I.message,iterations:I.iterations}},numeric.MPStoLP=function(t){t instanceof String&&t.split(`
`);var e=0,n=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],r=t.length,i,a,s,o=0,u={},c=[],f=0,p={},d=0,m,v=[],h=[],y=[];function g(_){throw new Error("MPStoLP: "+_+`
Line `+i+": "+t[i]+`
Current state: `+n[e]+`
`)}for(i=0;i<r;++i){s=t[i];var b=s.match(/\S*/g),x=[];for(a=0;a<b.length;++a)b[a]!==""&&x.push(b[a]);if(x.length!==0){for(a=0;a<n.length&&s.substr(0,n[a].length)!==n[a];++a);if(a<n.length){if(e=a,a===1&&(m=x[1]),a===6)return{name:m,c:v,A:numeric.transpose(h),b:y,rows:u,vars:p};continue}switch(e){case 0:case 1:g("Unexpected line");case 2:switch(x[0]){case"N":o===0?o=x[1]:g("Two or more N rows");break;case"L":u[x[1]]=f,c[f]=1,y[f]=0,++f;break;case"G":u[x[1]]=f,c[f]=-1,y[f]=0,++f;break;case"E":u[x[1]]=f,c[f]=0,y[f]=0,++f;break;default:g("Parse error "+numeric.prettyPrint(x))}break;case 3:p.hasOwnProperty(x[0])||(p[x[0]]=d,v[d]=0,h[d]=numeric.rep([f],0),++d);var N=p[x[0]];for(a=1;a<x.length;a+=2){if(x[a]===o){v[N]=parseFloat(x[a+1]);continue}var C=u[x[a]];h[N][C]=(c[C]<0?-1:1)*parseFloat(x[a+1])}break;case 4:for(a=1;a<x.length;a+=2)y[u[x[a]]]=(c[u[x[a]]]<0?-1:1)*parseFloat(x[a+1]);break;case 5:break;case 6:g("Internal error")}}}g("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(l,t,e,n,r,i,a){t.seedrandom=function(p,d){var m=[],v;return p=u(o(d?[p,l]:arguments.length?p:[new Date().getTime(),l,window],3),m),v=new s(m),u(v.S,l),t.random=function(){for(var y=v.g(n),g=a,b=0;y<r;)y=(y+b)*e,g*=e,b=v.g(1);for(;y>=i;)y/=2,g/=2,b>>>=1;return(y+b)/g},p};function s(f){var p,d,m=this,v=f.length,h=0,y=m.i=m.j=m.m=0;for(m.S=[],m.c=[],v||(f=[v++]);h<e;)m.S[h]=h++;for(h=0;h<e;h++)p=m.S[h],y=c(y+p+f[h%v]),d=m.S[y],m.S[h]=d,m.S[y]=p;m.g=function(b){var x=m.S,N=c(m.i+1),C=x[N],_=c(m.j+C),w=x[_];x[N]=w,x[_]=C;for(var A=x[c(C+w)];--b;)N=c(N+1),C=x[N],_=c(_+C),w=x[_],x[N]=w,x[_]=C,A=A*e+x[c(C+w)];return m.i=N,m.j=_,A},m.g(e)}function o(f,p,d,m,v){if(d=[],v=typeof f,p&&v=="object"){for(m in f)if(m.indexOf("S")<5)try{d.push(o(f[m],p-1))}catch(h){}}return d.length?d:f+(v!="string"?"\0":"")}function u(f,p,d,m){for(f+="",d=0,m=0;m<f.length;m++)p[c(m)]=c((d^=p[c(m)]*19)+f.charCodeAt(m));f="";for(m in p)f+=String.fromCharCode(p[m]);return f}function c(f){return f&e-1}a=t.pow(e,n),r=t.pow(2,r),i=r*2,u(t.random(),l)}([],numeric.seedrandom,256,6,52),function(l){function t(o){if(typeof o!="object")return o;var u=[],c,f=o.length;for(c=0;c<f;c++)u[c+1]=t(o[c]);return u}function e(o){if(typeof o!="object")return o;var u=[],c,f=o.length;for(c=1;c<f;c++)u[c-1]=e(o[c]);return u}function n(o,u,c){var f,p,d,m,v;for(d=1;d<=c;d=d+1){for(o[d][d]=1/o[d][d],v=-o[d][d],f=1;f<d;f=f+1)o[f][d]=v*o[f][d];if(m=d+1,c<m)break;for(p=m;p<=c;p=p+1)for(v=o[d][p],o[d][p]=0,f=1;f<=d;f=f+1)o[f][p]=o[f][p]+v*o[f][d]}}function r(o,u,c,f){var p,d,m,v;for(d=1;d<=c;d=d+1){for(v=0,p=1;p<d;p=p+1)v=v+o[p][d]*f[p];f[d]=(f[d]-v)/o[d][d]}for(m=1;m<=c;m=m+1)for(d=c+1-m,f[d]=f[d]/o[d][d],v=-f[d],p=1;p<d;p=p+1)f[p]=f[p]+v*o[p][d]}function i(o,u,c,f){var p,d,m,v,h,y;for(d=1;d<=c;d=d+1){if(f[1]=d,y=0,m=d-1,m<1){if(y=o[d][d]-y,y<=0)break;o[d][d]=Math.sqrt(y)}else{for(v=1;v<=m;v=v+1){for(h=o[v][d],p=1;p<v;p=p+1)h=h-o[p][d]*o[p][v];h=h/o[v][v],o[v][d]=h,y=y+h*h}if(y=o[d][d]-y,y<=0)break;o[d][d]=Math.sqrt(y)}f[1]=0}}function a(o,u,c,f,p,d,m,v,h,y,g,b,x,N,C,_){var w,A,$,S,D,V,I,q,K,E,W,G,P,Q,ne,Y,se,pe,oe,ve,O,z,Z,J,R,F,X;P=Math.min(f,y),$=2*f+P*(P+5)/2+2*y+1,J=1e-60;do J=J+J,R=1+.1*J,F=1+.2*J;while(R<=1||F<=1);for(w=1;w<=f;w=w+1)C[w]=u[w];for(w=f+1;w<=$;w=w+1)C[w]=0;for(w=1;w<=y;w=w+1)b[w]=0;if(D=[],_[1]===0){if(i(o,c,f,D),D[1]!==0){_[1]=2;return}r(o,c,f,u),n(o,c,f)}else{for(A=1;A<=f;A=A+1)for(p[A]=0,w=1;w<=A;w=w+1)p[A]=p[A]+o[w][A]*u[w];for(A=1;A<=f;A=A+1)for(u[A]=0,w=A;w<=f;w=w+1)u[A]=u[A]+o[A][w]*p[w]}for(d[1]=0,A=1;A<=f;A=A+1)for(p[A]=u[A],d[1]=d[1]+C[A]*p[A],C[A]=0,w=A+1;w<=f;w=w+1)o[w][A]=0;for(d[1]=-d[1]/2,_[1]=0,I=f,q=I+f,W=q+P,K=W+P+1,E=K+P*(P+1)/2,Q=E+y,w=1;w<=y;w=w+1){for(Y=0,A=1;A<=f;A=A+1)Y=Y+m[A][w]*m[A][w];C[Q+w]=Math.sqrt(Y)}x=0,N[1]=0,N[2]=0;function te(){for(N[1]=N[1]+1,$=E,w=1;w<=y;w=w+1){for($=$+1,Y=-v[w],A=1;A<=f;A=A+1)Y=Y+m[A][w]*p[A];if(Math.abs(Y)<J&&(Y=0),w>g)C[$]=Y;else if(C[$]=-Math.abs(Y),Y>0){for(A=1;A<=f;A=A+1)m[A][w]=-m[A][w];v[w]=-v[w]}}for(w=1;w<=x;w=w+1)C[E+b[w]]=0;for(G=0,ne=0,w=1;w<=y;w=w+1)C[E+w]<ne*C[Q+w]&&(G=w,ne=C[E+w]/C[Q+w]);return G===0?999:0}function de(){for(w=1;w<=f;w=w+1){for(Y=0,A=1;A<=f;A=A+1)Y=Y+o[A][w]*m[A][G];C[w]=Y}for(S=I,w=1;w<=f;w=w+1)C[S+w]=0;for(A=x+1;A<=f;A=A+1)for(w=1;w<=f;w=w+1)C[S+w]=C[S+w]+o[w][A]*C[A];for(z=!0,w=x;w>=1;w=w-1){for(Y=C[w],$=K+w*(w+3)/2,S=$-w,A=w+1;A<=x;A=A+1)Y=Y-C[$]*C[q+A],$=$+A;if(Y=Y/C[S],C[q+w]=Y,b[w]<g||Y<0)break;z=!1,V=w}if(!z)for(se=C[W+V]/C[q+V],w=1;w<=x&&!(b[w]<g||C[q+w]<0);w=w+1)ne=C[W+w]/C[q+w],ne<se&&(se=ne,V=w);for(Y=0,w=I+1;w<=I+f;w=w+1)Y=Y+C[w]*C[w];if(Math.abs(Y)<=J){if(z)return _[1]=1,999;for(w=1;w<=x;w=w+1)C[W+w]=C[W+w]-se*C[q+w];return C[W+x+1]=C[W+x+1]+se,700}else{for(Y=0,w=1;w<=f;w=w+1)Y=Y+C[I+w]*m[w][G];for(pe=-C[E+G]/Y,Z=!0,z||se<pe&&(pe=se,Z=!1),w=1;w<=f;w=w+1)p[w]=p[w]+pe*C[I+w],Math.abs(p[w])<J&&(p[w]=0);for(d[1]=d[1]+pe*Y*(pe/2+C[W+x+1]),w=1;w<=x;w=w+1)C[W+w]=C[W+w]-pe*C[q+w];if(C[W+x+1]=C[W+x+1]+pe,Z){for(x=x+1,b[x]=G,$=K+(x-1)*x/2+1,w=1;w<=x-1;w=w+1)C[$]=C[w],$=$+1;if(x===f)C[$]=C[f];else{for(w=f;w>=x+1&&!(C[w]===0||(oe=Math.max(Math.abs(C[w-1]),Math.abs(C[w])),ve=Math.min(Math.abs(C[w-1]),Math.abs(C[w])),C[w-1]>=0?ne=Math.abs(oe*Math.sqrt(1+ve*ve/(oe*oe))):ne=-Math.abs(oe*Math.sqrt(1+ve*ve/(oe*oe))),oe=C[w-1]/ne,ve=C[w]/ne,oe===1));w=w-1)if(oe===0)for(C[w-1]=ve*ne,A=1;A<=f;A=A+1)ne=o[A][w-1],o[A][w-1]=o[A][w],o[A][w]=ne;else for(C[w-1]=ne,O=ve/(1+oe),A=1;A<=f;A=A+1)ne=oe*o[A][w-1]+ve*o[A][w],o[A][w]=O*(o[A][w-1]+ne)-o[A][w],o[A][w-1]=ne;C[$]=C[x]}}else{for(Y=-v[G],A=1;A<=f;A=A+1)Y=Y+p[A]*m[A][G];if(G>g)C[E+G]=Y;else if(C[E+G]=-Math.abs(Y),Y>0){for(A=1;A<=f;A=A+1)m[A][G]=-m[A][G];v[G]=-v[G]}return 700}}return 0}function he(){if($=K+V*(V+1)/2+1,S=$+V,C[S]===0||(oe=Math.max(Math.abs(C[S-1]),Math.abs(C[S])),ve=Math.min(Math.abs(C[S-1]),Math.abs(C[S])),C[S-1]>=0?ne=Math.abs(oe*Math.sqrt(1+ve*ve/(oe*oe))):ne=-Math.abs(oe*Math.sqrt(1+ve*ve/(oe*oe))),oe=C[S-1]/ne,ve=C[S]/ne,oe===1))return 798;if(oe===0){for(w=V+1;w<=x;w=w+1)ne=C[S-1],C[S-1]=C[S],C[S]=ne,S=S+w;for(w=1;w<=f;w=w+1)ne=o[w][V],o[w][V]=o[w][V+1],o[w][V+1]=ne}else{for(O=ve/(1+oe),w=V+1;w<=x;w=w+1)ne=oe*C[S-1]+ve*C[S],C[S]=O*(C[S-1]+ne)-C[S],C[S-1]=ne,S=S+w;for(w=1;w<=f;w=w+1)ne=oe*o[w][V]+ve*o[w][V+1],o[w][V+1]=O*(o[w][V]+ne)-o[w][V+1],o[w][V]=ne}return 0}function H(){for(S=$-V,w=1;w<=V;w=w+1)C[S]=C[$],$=$+1,S=S+1;return C[W+V]=C[W+V+1],b[V]=b[V+1],V=V+1,V<x?797:0}function re(){return C[W+x]=C[W+x+1],C[W+x+1]=0,b[x]=0,x=x-1,N[2]=N[2]+1,0}for(X=0;;){if(X=te(),X===999)return;for(;X=de(),X!==0;){if(X===999)return;if(X===700)if(V===x)re();else{for(;he(),X=H(),X===797;);re()}}}}function s(o,u,c,f,p,d){o=t(o),u=t(u),c=t(c);var m,v,h,y,g,b=[],x=[],N=[],C=[],_=[],w;if(p=p||0,d=d?t(d):[void 0,0],f=f?t(f):[],v=o.length-1,h=c[1].length-1,!f)for(m=1;m<=h;m=m+1)f[m]=0;for(m=1;m<=h;m=m+1)x[m]=0;for(y=0,g=Math.min(v,h),m=1;m<=v;m=m+1)N[m]=0;for(b[1]=0,m=1;m<=2*v+g*(g+5)/2+2*h+1;m=m+1)C[m]=0;for(m=1;m<=2;m=m+1)_[m]=0;return a(o,u,v,v,N,b,c,f,v,h,p,x,y,_,C,d),w="",d[1]===1&&(w="constraints are inconsistent, no solution!"),d[1]===2&&(w="matrix D in quadratic function is not positive definite!"),{solution:e(N),value:e(b),unconstrained_solution:e(u),iterations:e(_),iact:e(x),message:w}}l.solveQP=s}(numeric),numeric.svd=function(t){var e,n=numeric.epsilon,r=1e-64/n,i=50,a=0,s=0,o=0,u=0,c=0,f=numeric.clone(t),p=f.length,d=f[0].length;if(p<d)throw"Need more rows than columns";var m=new Array(d),v=new Array(d);for(s=0;s<d;s++)m[s]=v[s]=0;var h=numeric.rep([d,d],0);function y(D,V){return D=Math.abs(D),V=Math.abs(V),D>V?D*Math.sqrt(1+V*V/D/D):V==0?D:V*Math.sqrt(1+D*D/V/V)}var g=0,b=0,x=0,N=0,C=0,_=0,w=0;for(s=0;s<d;s++){for(m[s]=b,w=0,c=s+1,o=s;o<p;o++)w+=f[o][s]*f[o][s];if(w<=r)b=0;else for(g=f[s][s],b=Math.sqrt(w),g>=0&&(b=-b),x=g*b-w,f[s][s]=g-b,o=c;o<d;o++){for(w=0,u=s;u<p;u++)w+=f[u][s]*f[u][o];for(g=w/x,u=s;u<p;u++)f[u][o]+=g*f[u][s]}for(v[s]=b,w=0,o=c;o<d;o++)w=w+f[s][o]*f[s][o];if(w<=r)b=0;else{for(g=f[s][s+1],b=Math.sqrt(w),g>=0&&(b=-b),x=g*b-w,f[s][s+1]=g-b,o=c;o<d;o++)m[o]=f[s][o]/x;for(o=c;o<p;o++){for(w=0,u=c;u<d;u++)w+=f[o][u]*f[s][u];for(u=c;u<d;u++)f[o][u]+=w*m[u]}}C=Math.abs(v[s])+Math.abs(m[s]),C>N&&(N=C)}for(s=d-1;s!=-1;s+=-1){if(b!=0){for(x=b*f[s][s+1],o=c;o<d;o++)h[o][s]=f[s][o]/x;for(o=c;o<d;o++){for(w=0,u=c;u<d;u++)w+=f[s][u]*h[u][o];for(u=c;u<d;u++)h[u][o]+=w*h[u][s]}}for(o=c;o<d;o++)h[s][o]=0,h[o][s]=0;h[s][s]=1,b=m[s],c=s}for(s=d-1;s!=-1;s+=-1){for(c=s+1,b=v[s],o=c;o<d;o++)f[s][o]=0;if(b!=0){for(x=f[s][s]*b,o=c;o<d;o++){for(w=0,u=c;u<p;u++)w+=f[u][s]*f[u][o];for(g=w/x,u=s;u<p;u++)f[u][o]+=g*f[u][s]}for(o=s;o<p;o++)f[o][s]=f[o][s]/b}else for(o=s;o<p;o++)f[o][s]=0;f[s][s]+=1}for(n=n*N,u=d-1;u!=-1;u+=-1)for(var A=0;A<i;A++){var $=!1;for(c=u;c!=-1;c+=-1){if(Math.abs(m[c])<=n){$=!0;break}if(Math.abs(v[c-1])<=n)break}if(!$){a=0,w=1;var S=c-1;for(s=c;s<u+1&&(g=w*m[s],m[s]=a*m[s],!(Math.abs(g)<=n));s++)for(b=v[s],x=y(g,b),v[s]=x,a=b/x,w=-g/x,o=0;o<p;o++)C=f[o][S],_=f[o][s],f[o][S]=C*a+_*w,f[o][s]=-C*w+_*a}if(_=v[u],c==u){if(_<0)for(v[u]=-_,o=0;o<d;o++)h[o][u]=-h[o][u];break}if(A>=i-1)throw"Error: no convergence.";for(N=v[c],C=v[u-1],b=m[u-1],x=m[u],g=((C-_)*(C+_)+(b-x)*(b+x))/(2*x*C),b=y(g,1),g<0?g=((N-_)*(N+_)+x*(C/(g-b)-x))/N:g=((N-_)*(N+_)+x*(C/(g+b)-x))/N,a=1,w=1,s=c+1;s<u+1;s++){for(b=m[s],C=v[s],x=w*b,b=a*b,_=y(g,x),m[s-1]=_,a=g/_,w=x/_,g=N*a+b*w,b=-N*w+b*a,x=C*w,C=C*a,o=0;o<d;o++)N=h[o][s-1],_=h[o][s],h[o][s-1]=N*a+_*w,h[o][s]=-N*w+_*a;for(_=y(g,x),v[s-1]=_,a=g/_,w=x/_,g=a*b+w*C,N=-w*b+a*C,o=0;o<p;o++)C=f[o][s-1],_=f[o][s],f[o][s-1]=C*a+_*w,f[o][s]=-C*w+_*a}m[c]=0,m[u]=g,v[u]=N}for(s=0;s<v.length;s++)v[s]<n&&(v[s]=0);for(s=0;s<d;s++)for(o=s-1;o>=0;o--)if(v[o]<v[s]){for(a=v[o],v[o]=v[s],v[s]=a,u=0;u<f.length;u++)e=f[u][s],f[u][s]=f[u][o],f[u][o]=e;for(u=0;u<h.length;u++)e=h[u][s],h[u][s]=h[u][o],h[u][o]=e;s=o}return{U:f,S:v,V:h}}});function create$2(l){var t=core$1.create(l);t.create=create$2,t.import(lib),t.import(numeric1_2_6,{wrap:!0,silent:!0});var e=t.pow;function n(p,d){return d===0&&typeof p=="number"&&(p===0||!Number.isFinite(p))?NaN:e(p,d)}function r(p){p?t.import({pow:n},{override:!0}):t.import({pow:e},{override:!0})}var i=()=>t.pow===n;Object.defineProperty(t,"pow_strict",{get:i,set:r}),t.pow_strict=!0;function a(p){p?t.config({define_e:!0}):t.config({define_e:!1})}var s=()=>t.config().define_e!==!1;function o(p){p?t.config({define_i:!0}):t.config({define_i:!1})}var u=()=>t.config().define_i!==!1;function c(p){p?t.config({define_pi:!0}):t.config({define_pi:!1})}var f=()=>t.config().define_pi!==!1;return Object.defineProperty(t,"define_e",{get:s,set:a}),Object.defineProperty(t,"define_i",{get:u,set:o}),Object.defineProperty(t,"define_pi",{get:f,set:c}),t}var math$19=create$2();function leaves(l,t){if(!Array.isArray(l))return[l];var e=l[0],n=l.slice(1);return t&&e==="_"&&typeof n[0]=="string"&&(typeof n[1]=="string"||typeof n[1]=="number")?[n[0]+"_"+n[1]]:(e==="apply"&&(n=l.slice(2)),n.length===0?[]:n.map(function(r,i){return leaves(r,t)}).reduce(function(r,i){return r.concat(i)}))}function variables(l,t=!1){var e=get_tree(l),n=leaves(e,t);return n=n.filter(function(r,i){return typeof r=="string"&&(math$19.define_e||r!=="e")&&(math$19.define_pi||r!=="pi")&&(math$19.define_i||r!=="i")}),n=n.filter(function(r,i,a){return i===n.indexOf(r)}),n}function operators_list(l){if(!Array.isArray(l))return[];var t=l[0],e=l.slice(1);return t==="apply"&&(e=l.slice(2)),e.length===0?[t]:[t].concat(e.map(function(n,r){return operators_list(n)}).reduce(function(n,r){return n.concat(r)}))}function operators$1(l){var t=get_tree(l),e=operators_list(t);return e=e.filter(function(n,r){return n!=="apply"}),e=e.filter(function(n,r,i){return r===e.indexOf(n)}),e}function functions_list(l){if(typeof l=="number")return[];if(typeof l=="string")return[];if(typeof l=="boolean")return[];var t=l[0],e=l.slice(1),n=[];return t==="apply"&&(n=[e[0]],e=l.slice(2)),n.concat(e.map(function(r,i){return functions_list(r)}).reduce(function(r,i){return r.concat(i)}))}function functions(l){var t=get_tree(l),e=functions_list(t);return e=e.filter(function(n,r,i){return r===e.indexOf(n)}),e}var variables$1=Object.freeze({variables,operators:operators$1,functions}),underscore=createCommonjsModule(function(l,t){(function(){var e=this,n=e._,r=Array.prototype,i=Object.prototype,a=Function.prototype,s=r.push,o=r.slice,u=i.toString,c=i.hasOwnProperty,f=Array.isArray,p=Object.keys,d=a.bind,m=Object.create,v=function(){},h=function(O){if(O instanceof h)return O;if(!(this instanceof h))return new h(O);this._wrapped=O};l.exports&&(t=l.exports=h),t._=h,h.VERSION="1.8.3";var y=function(O,z,Z){if(z===void 0)return O;switch(Z??3){case 1:return function(J){return O.call(z,J)};case 2:return function(J,R){return O.call(z,J,R)};case 3:return function(J,R,F){return O.call(z,J,R,F)};case 4:return function(J,R,F,X){return O.call(z,J,R,F,X)}}return function(){return O.apply(z,arguments)}},g=function(O,z,Z){return O==null?h.identity:h.isFunction(O)?y(O,z,Z):h.isObject(O)?h.matcher(O):h.property(O)};h.iteratee=function(O,z){return g(O,z,Infinity)};var b=function(O,z){return function(Z){var J=arguments.length;if(J<2||Z==null)return Z;for(var R=1;R<J;R++)for(var F=arguments[R],X=O(F),te=X.length,de=0;de<te;de++){var he=X[de];(!z||Z[he]===void 0)&&(Z[he]=F[he])}return Z}},x=function(O){if(!h.isObject(O))return{};if(m)return m(O);v.prototype=O;var z=new v;return v.prototype=null,z},N=function(O){return function(z){return z==null?void 0:z[O]}},C=Math.pow(2,53)-1,_=N("length"),w=function(O){var z=_(O);return typeof z=="number"&&z>=0&&z<=C};h.each=h.forEach=function(O,z,Z){z=y(z,Z);var J,R;if(w(O))for(J=0,R=O.length;J<R;J++)z(O[J],J,O);else{var F=h.keys(O);for(J=0,R=F.length;J<R;J++)z(O[F[J]],F[J],O)}return O},h.map=h.collect=function(O,z,Z){z=g(z,Z);for(var J=!w(O)&&h.keys(O),R=(J||O).length,F=Array(R),X=0;X<R;X++){var te=J?J[X]:X;F[X]=z(O[te],te,O)}return F};function A(O){function z(Z,J,R,F,X,te){for(;X>=0&&X<te;X+=O){var de=F?F[X]:X;R=J(R,Z[de],de,Z)}return R}return function(Z,J,R,F){J=y(J,F,4);var X=!w(Z)&&h.keys(Z),te=(X||Z).length,de=O>0?0:te-1;return arguments.length<3&&(R=Z[X?X[de]:de],de+=O),z(Z,J,R,X,de,te)}}h.reduce=h.foldl=h.inject=A(1),h.reduceRight=h.foldr=A(-1),h.find=h.detect=function(O,z,Z){var J;if(w(O)?J=h.findIndex(O,z,Z):J=h.findKey(O,z,Z),J!==void 0&&J!==-1)return O[J]},h.filter=h.select=function(O,z,Z){var J=[];return z=g(z,Z),h.each(O,function(R,F,X){z(R,F,X)&&J.push(R)}),J},h.reject=function(O,z,Z){return h.filter(O,h.negate(g(z)),Z)},h.every=h.all=function(O,z,Z){z=g(z,Z);for(var J=!w(O)&&h.keys(O),R=(J||O).length,F=0;F<R;F++){var X=J?J[F]:F;if(!z(O[X],X,O))return!1}return!0},h.some=h.any=function(O,z,Z){z=g(z,Z);for(var J=!w(O)&&h.keys(O),R=(J||O).length,F=0;F<R;F++){var X=J?J[F]:F;if(z(O[X],X,O))return!0}return!1},h.contains=h.includes=h.include=function(O,z,Z,J){return w(O)||(O=h.values(O)),(typeof Z!="number"||J)&&(Z=0),h.indexOf(O,z,Z)>=0},h.invoke=function(O,z){var Z=o.call(arguments,2),J=h.isFunction(z);return h.map(O,function(R){var F=J?z:R[z];return F==null?F:F.apply(R,Z)})},h.pluck=function(O,z){return h.map(O,h.property(z))},h.where=function(O,z){return h.filter(O,h.matcher(z))},h.findWhere=function(O,z){return h.find(O,h.matcher(z))},h.max=function(O,z,Z){var J=-Infinity,R=-Infinity,F,X;if(z==null&&O!=null){O=w(O)?O:h.values(O);for(var te=0,de=O.length;te<de;te++)F=O[te],F>J&&(J=F)}else z=g(z,Z),h.each(O,function(he,H,re){X=z(he,H,re),(X>R||X===-Infinity&&J===-Infinity)&&(J=he,R=X)});return J},h.min=function(O,z,Z){var J=Infinity,R=Infinity,F,X;if(z==null&&O!=null){O=w(O)?O:h.values(O);for(var te=0,de=O.length;te<de;te++)F=O[te],F<J&&(J=F)}else z=g(z,Z),h.each(O,function(he,H,re){X=z(he,H,re),(X<R||X===Infinity&&J===Infinity)&&(J=he,R=X)});return J},h.shuffle=function(O){for(var z=w(O)?O:h.values(O),Z=z.length,J=Array(Z),R=0,F;R<Z;R++)F=h.random(0,R),F!==R&&(J[R]=J[F]),J[F]=z[R];return J},h.sample=function(O,z,Z){return z==null||Z?(w(O)||(O=h.values(O)),O[h.random(O.length-1)]):h.shuffle(O).slice(0,Math.max(0,z))},h.sortBy=function(O,z,Z){return z=g(z,Z),h.pluck(h.map(O,function(J,R,F){return{value:J,index:R,criteria:z(J,R,F)}}).sort(function(J,R){var F=J.criteria,X=R.criteria;if(F!==X){if(F>X||F===void 0)return 1;if(F<X||X===void 0)return-1}return J.index-R.index}),"value")};var $=function(O){return function(z,Z,J){var R={};return Z=g(Z,J),h.each(z,function(F,X){var te=Z(F,X,z);O(R,F,te)}),R}};h.groupBy=$(function(O,z,Z){h.has(O,Z)?O[Z].push(z):O[Z]=[z]}),h.indexBy=$(function(O,z,Z){O[Z]=z}),h.countBy=$(function(O,z,Z){h.has(O,Z)?O[Z]++:O[Z]=1}),h.toArray=function(O){return O?h.isArray(O)?o.call(O):w(O)?h.map(O,h.identity):h.values(O):[]},h.size=function(O){return O==null?0:w(O)?O.length:h.keys(O).length},h.partition=function(O,z,Z){z=g(z,Z);var J=[],R=[];return h.each(O,function(F,X,te){(z(F,X,te)?J:R).push(F)}),[J,R]},h.first=h.head=h.take=function(O,z,Z){if(O!=null)return z==null||Z?O[0]:h.initial(O,O.length-z)},h.initial=function(O,z,Z){return o.call(O,0,Math.max(0,O.length-(z==null||Z?1:z)))},h.last=function(O,z,Z){if(O!=null)return z==null||Z?O[O.length-1]:h.rest(O,Math.max(0,O.length-z))},h.rest=h.tail=h.drop=function(O,z,Z){return o.call(O,z==null||Z?1:z)},h.compact=function(O){return h.filter(O,h.identity)};var S=function(O,z,Z,J){for(var R=[],F=0,X=J||0,te=_(O);X<te;X++){var de=O[X];if(w(de)&&(h.isArray(de)||h.isArguments(de))){z||(de=S(de,z,Z));var he=0,H=de.length;for(R.length+=H;he<H;)R[F++]=de[he++]}else Z||(R[F++]=de)}return R};h.flatten=function(O,z){return S(O,z,!1)},h.without=function(O){return h.difference(O,o.call(arguments,1))},h.uniq=h.unique=function(O,z,Z,J){h.isBoolean(z)||(J=Z,Z=z,z=!1),Z!=null&&(Z=g(Z,J));for(var R=[],F=[],X=0,te=_(O);X<te;X++){var de=O[X],he=Z?Z(de,X,O):de;z?((!X||F!==he)&&R.push(de),F=he):Z?h.contains(F,he)||(F.push(he),R.push(de)):h.contains(R,de)||R.push(de)}return R},h.union=function(){return h.uniq(S(arguments,!0,!0))},h.intersection=function(O){for(var z=[],Z=arguments.length,J=0,R=_(O);J<R;J++){var F=O[J];if(!h.contains(z,F)){for(var X=1;X<Z&&h.contains(arguments[X],F);X++);X===Z&&z.push(F)}}return z},h.difference=function(O){var z=S(arguments,!0,!0,1);return h.filter(O,function(Z){return!h.contains(z,Z)})},h.zip=function(){return h.unzip(arguments)},h.unzip=function(O){for(var z=O&&h.max(O,_).length||0,Z=Array(z),J=0;J<z;J++)Z[J]=h.pluck(O,J);return Z},h.object=function(O,z){for(var Z={},J=0,R=_(O);J<R;J++)z?Z[O[J]]=z[J]:Z[O[J][0]]=O[J][1];return Z};function D(O){return function(z,Z,J){Z=g(Z,J);for(var R=_(z),F=O>0?0:R-1;F>=0&&F<R;F+=O)if(Z(z[F],F,z))return F;return-1}}h.findIndex=D(1),h.findLastIndex=D(-1),h.sortedIndex=function(O,z,Z,J){Z=g(Z,J,1);for(var R=Z(z),F=0,X=_(O);F<X;){var te=Math.floor((F+X)/2);Z(O[te])<R?F=te+1:X=te}return F};function V(O,z,Z){return function(J,R,F){var X=0,te=_(J);if(typeof F=="number")O>0?X=F>=0?F:Math.max(F+te,X):te=F>=0?Math.min(F+1,te):F+te+1;else if(Z&&F&&te)return F=Z(J,R),J[F]===R?F:-1;if(R!==R)return F=z(o.call(J,X,te),h.isNaN),F>=0?F+X:-1;for(F=O>0?X:te-1;F>=0&&F<te;F+=O)if(J[F]===R)return F;return-1}}h.indexOf=V(1,h.findIndex,h.sortedIndex),h.lastIndexOf=V(-1,h.findLastIndex),h.range=function(O,z,Z){z==null&&(z=O||0,O=0),Z=Z||1;for(var J=Math.max(Math.ceil((z-O)/Z),0),R=Array(J),F=0;F<J;F++,O+=Z)R[F]=O;return R};var I=function(O,z,Z,J,R){if(!(J instanceof z))return O.apply(Z,R);var F=x(O.prototype),X=O.apply(F,R);return h.isObject(X)?X:F};h.bind=function(O,z){if(d&&O.bind===d)return d.apply(O,o.call(arguments,1));if(!h.isFunction(O))throw new TypeError("Bind must be called on a function");var Z=o.call(arguments,2),J=function(){return I(O,J,z,this,Z.concat(o.call(arguments)))};return J},h.partial=function(O){var z=o.call(arguments,1),Z=function(){for(var J=0,R=z.length,F=Array(R),X=0;X<R;X++)F[X]=z[X]===h?arguments[J++]:z[X];for(;J<arguments.length;)F.push(arguments[J++]);return I(O,Z,this,this,F)};return Z},h.bindAll=function(O){var z,Z=arguments.length,J;if(Z<=1)throw new Error("bindAll must be passed function names");for(z=1;z<Z;z++)J=arguments[z],O[J]=h.bind(O[J],O);return O},h.memoize=function(O,z){var Z=function(J){var R=Z.cache,F=""+(z?z.apply(this,arguments):J);return h.has(R,F)||(R[F]=O.apply(this,arguments)),R[F]};return Z.cache={},Z},h.delay=function(O,z){var Z=o.call(arguments,2);return setTimeout(function(){return O.apply(null,Z)},z)},h.defer=h.partial(h.delay,h,1),h.throttle=function(O,z,Z){var J,R,F,X=null,te=0;Z||(Z={});var de=function(){te=Z.leading===!1?0:h.now(),X=null,F=O.apply(J,R),X||(J=R=null)};return function(){var he=h.now();!te&&Z.leading===!1&&(te=he);var H=z-(he-te);return J=this,R=arguments,H<=0||H>z?(X&&(clearTimeout(X),X=null),te=he,F=O.apply(J,R),X||(J=R=null)):!X&&Z.trailing!==!1&&(X=setTimeout(de,H)),F}},h.debounce=function(O,z,Z){var J,R,F,X,te,de=function(){var he=h.now()-X;he<z&&he>=0?J=setTimeout(de,z-he):(J=null,Z||(te=O.apply(F,R),J||(F=R=null)))};return function(){F=this,R=arguments,X=h.now();var he=Z&&!J;return J||(J=setTimeout(de,z)),he&&(te=O.apply(F,R),F=R=null),te}},h.wrap=function(O,z){return h.partial(z,O)},h.negate=function(O){return function(){return!O.apply(this,arguments)}},h.compose=function(){var O=arguments,z=O.length-1;return function(){for(var Z=z,J=O[z].apply(this,arguments);Z--;)J=O[Z].call(this,J);return J}},h.after=function(O,z){return function(){if(--O<1)return z.apply(this,arguments)}},h.before=function(O,z){var Z;return function(){return--O>0&&(Z=z.apply(this,arguments)),O<=1&&(z=null),Z}},h.once=h.partial(h.before,2);var q=!{toString:null}.propertyIsEnumerable("toString"),K=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function E(O,z){var Z=K.length,J=O.constructor,R=h.isFunction(J)&&J.prototype||i,F="constructor";for(h.has(O,F)&&!h.contains(z,F)&&z.push(F);Z--;)F=K[Z],F in O&&O[F]!==R[F]&&!h.contains(z,F)&&z.push(F)}h.keys=function(O){if(!h.isObject(O))return[];if(p)return p(O);var z=[];for(var Z in O)h.has(O,Z)&&z.push(Z);return q&&E(O,z),z},h.allKeys=function(O){if(!h.isObject(O))return[];var z=[];for(var Z in O)z.push(Z);return q&&E(O,z),z},h.values=function(O){for(var z=h.keys(O),Z=z.length,J=Array(Z),R=0;R<Z;R++)J[R]=O[z[R]];return J},h.mapObject=function(O,z,Z){z=g(z,Z);for(var J=h.keys(O),R=J.length,F={},X,te=0;te<R;te++)X=J[te],F[X]=z(O[X],X,O);return F},h.pairs=function(O){for(var z=h.keys(O),Z=z.length,J=Array(Z),R=0;R<Z;R++)J[R]=[z[R],O[z[R]]];return J},h.invert=function(O){for(var z={},Z=h.keys(O),J=0,R=Z.length;J<R;J++)z[O[Z[J]]]=Z[J];return z},h.functions=h.methods=function(O){var z=[];for(var Z in O)h.isFunction(O[Z])&&z.push(Z);return z.sort()},h.extend=b(h.allKeys),h.extendOwn=h.assign=b(h.keys),h.findKey=function(O,z,Z){z=g(z,Z);for(var J=h.keys(O),R,F=0,X=J.length;F<X;F++)if(R=J[F],z(O[R],R,O))return R},h.pick=function(O,z,Z){var J={},R=O,F,X;if(R==null)return J;h.isFunction(z)?(X=h.allKeys(R),F=y(z,Z)):(X=S(arguments,!1,!1,1),F=function(re,ce,ue){return ce in ue},R=Object(R));for(var te=0,de=X.length;te<de;te++){var he=X[te],H=R[he];F(H,he,R)&&(J[he]=H)}return J},h.omit=function(O,z,Z){if(h.isFunction(z))z=h.negate(z);else{var J=h.map(S(arguments,!1,!1,1),String);z=function(R,F){return!h.contains(J,F)}}return h.pick(O,z,Z)},h.defaults=b(h.allKeys,!0),h.create=function(O,z){var Z=x(O);return z&&h.extendOwn(Z,z),Z},h.clone=function(O){return h.isObject(O)?h.isArray(O)?O.slice():h.extend({},O):O},h.tap=function(O,z){return z(O),O},h.isMatch=function(O,z){var Z=h.keys(z),J=Z.length;if(O==null)return!J;for(var R=Object(O),F=0;F<J;F++){var X=Z[F];if(z[X]!==R[X]||!(X in R))return!1}return!0};var W=function(O,z,Z,J){if(O===z)return O!==0||1/O==1/z;if(O==null||z==null)return O===z;O instanceof h&&(O=O._wrapped),z instanceof h&&(z=z._wrapped);var R=u.call(O);if(R!==u.call(z))return!1;switch(R){case"[object RegExp]":case"[object String]":return""+O==""+z;case"[object Number]":return+O!=+O?+z!=+z:+O==0?1/+O==1/z:+O==+z;case"[object Date]":case"[object Boolean]":return+O==+z}var F=R==="[object Array]";if(!F){if(typeof O!="object"||typeof z!="object")return!1;var X=O.constructor,te=z.constructor;if(X!==te&&!(h.isFunction(X)&&X instanceof X&&h.isFunction(te)&&te instanceof te)&&"constructor"in O&&"constructor"in z)return!1}Z=Z||[],J=J||[];for(var de=Z.length;de--;)if(Z[de]===O)return J[de]===z;if(Z.push(O),J.push(z),F){if(de=O.length,de!==z.length)return!1;for(;de--;)if(!W(O[de],z[de],Z,J))return!1}else{var he=h.keys(O),H;if(de=he.length,h.keys(z).length!==de)return!1;for(;de--;)if(H=he[de],!(h.has(z,H)&&W(O[H],z[H],Z,J)))return!1}return Z.pop(),J.pop(),!0};h.isEqual=function(O,z){return W(O,z)},h.isEmpty=function(O){return O==null?!0:w(O)&&(h.isArray(O)||h.isString(O)||h.isArguments(O))?O.length===0:h.keys(O).length===0},h.isElement=function(O){return!!(O&&O.nodeType===1)},h.isArray=f||function(O){return u.call(O)==="[object Array]"},h.isObject=function(O){var z=typeof O;return z==="function"||z==="object"&&!!O},h.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(O){h["is"+O]=function(z){return u.call(z)==="[object "+O+"]"}}),h.isArguments(arguments)||(h.isArguments=function(O){return h.has(O,"callee")}),typeof/./!="function"&&typeof Int8Array!="object"&&(h.isFunction=function(O){return typeof O=="function"||!1}),h.isFinite=function(O){return isFinite(O)&&!isNaN(parseFloat(O))},h.isNaN=function(O){return h.isNumber(O)&&O!==+O},h.isBoolean=function(O){return O===!0||O===!1||u.call(O)==="[object Boolean]"},h.isNull=function(O){return O===null},h.isUndefined=function(O){return O===void 0},h.has=function(O,z){return O!=null&&c.call(O,z)},h.noConflict=function(){return e._=n,this},h.identity=function(O){return O},h.constant=function(O){return function(){return O}},h.noop=function(){},h.property=N,h.propertyOf=function(O){return O==null?function(){}:function(z){return O[z]}},h.matcher=h.matches=function(O){return O=h.extendOwn({},O),function(z){return h.isMatch(z,O)}},h.times=function(O,z,Z){var J=Array(Math.max(0,O));z=y(z,Z,1);for(var R=0;R<O;R++)J[R]=z(R);return J},h.random=function(O,z){return z==null&&(z=O,O=0),O+Math.floor(Math.random()*(z-O+1))},h.now=Date.now||function(){return new Date().getTime()};var G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=h.invert(G),Q=function(O){var z=function(F){return O[F]},Z="(?:"+h.keys(O).join("|")+")",J=RegExp(Z),R=RegExp(Z,"g");return function(F){return F=F==null?"":""+F,J.test(F)?F.replace(R,z):F}};h.escape=Q(G),h.unescape=Q(P),h.result=function(O,z,Z){var J=O==null?void 0:O[z];return J===void 0&&(J=Z),h.isFunction(J)?J.call(O):J};var ne=0;h.uniqueId=function(O){var z=++ne+"";return O?O+z:z},h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Y=/(.)^/,se={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},pe=/\\|'|\r|\n|\u2028|\u2029/g,oe=function(O){return"\\"+se[O]};h.template=function(O,z,Z){!z&&Z&&(z=Z),z=h.defaults({},z,h.templateSettings);var J=RegExp([(z.escape||Y).source,(z.interpolate||Y).source,(z.evaluate||Y).source].join("|")+"|$","g"),R=0,F="__p+='";O.replace(J,function(he,H,re,ce,ue){return F+=O.slice(R,ue).replace(pe,oe),R=ue+he.length,H?F+=`'+
((__t=(`+H+`))==null?'':_.escape(__t))+
'`:re?F+=`'+
((__t=(`+re+`))==null?'':__t)+
'`:ce&&(F+=`';
`+ce+`
__p+='`),he}),F+=`';
`,z.variable||(F=`with(obj||{}){
`+F+`}
`),F=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+F+`return __p;
`;try{var X=new Function(z.variable||"obj","_",F)}catch(he){throw he.source=F,he}var te=function(he){return X.call(this,he,h)},de=z.variable||"obj";return te.source="function("+de+`){
`+F+"}",te},h.chain=function(O){var z=h(O);return z._chain=!0,z};var ve=function(O,z){return O._chain?h(z).chain():z};h.mixin=function(O){h.each(h.functions(O),function(z){var Z=h[z]=O[z];h.prototype[z]=function(){var J=[this._wrapped];return s.apply(J,arguments),ve(this,Z.apply(h,J))}})},h.mixin(h),h.each(["pop","push","reverse","shift","sort","splice","unshift"],function(O){var z=r[O];h.prototype[O]=function(){var Z=this._wrapped;return z.apply(Z,arguments),(O==="shift"||O==="splice")&&Z.length===0&&delete Z[0],ve(this,Z)}}),h.each(["concat","join","slice"],function(O){var z=r[O];h.prototype[O]=function(){return ve(this,z.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},h.prototype.valueOf=h.prototype.toJSON=h.prototype.value,h.prototype.toString=function(){return""+this._wrapped}}).call(commonjsGlobal)}),underscore_1=underscore._;function handleNaNInfinityStringify(l,t){return t!==t?"0/0":t===1/0?"1/0":t===-1/0?"-1/0":t}function handleNaNInfinityParse(l,t){return t==="0/0"?0/0:t==="1/0"?Infinity:t==="-1/0"?-1/0:t}function deepClone(l){return JSON.parse(JSON.stringify(l,handleNaNInfinityStringify),handleNaNInfinityParse)}let equal$2=function(l,t,{allowed_error_in_numbers:e=0,include_error_in_number_exponents:n=!1,allowed_error_is_absolute:r=!1}={}){if(!(Array.isArray(l)&&Array.isArray(t))){if(typeof l!=typeof t)return!1;if(typeof l=="number"&&Number.isFinite(l)){let u=1e-14,c=Math.min(Math.abs(l),Math.abs(t));return r?(u*=c,e>u&&(u=e)):(e>u&&(u=e),u*=c),Math.abs(l-t)<=u}return l===t}var i=l[0],a=l.slice(1),s=t[0],o=t.slice(1);return i!==s||a.length!==o.length?!1:e>0&&!n&&i==="^"?equal$2(a[0],o[0],{allowed_error_in_numbers:e,include_error_in_number_exponents:n,allowed_error_is_absolute:r})?equal$2(a[1],o[1]):!1:underscore.every(underscore.zip(a,o),function(u){return equal$2(u[0],u[1],{allowed_error_in_numbers:e,include_error_in_number_exponents:n,allowed_error_is_absolute:r})})},match=function(l,t,e){var n=!1;e===void 0?e={}:e.allow_extended_match&&(n=!0,e=Object.assign({},e),delete e.allow_extended_match);var r=e.variables;if(r===void 0){r={};let u=variables(t);for(let c=0;c<u.length;c++)r[u[c]]=!0;e=Object.assign({},e),e.variables=r}if(t in r){let u=r[t];if(u!==!0)if(u instanceof RegExp){if(typeof l=="string"){if(!l.match(u))return!1}else if(!JSON.stringify(l).match(u))return!1}else if(typeof r[t]=="function"){if(!r[t](l))return!1}else return!1;let c={};return c[t]=l,c}if(e.allow_permutations&&(l=default_order(l),t=default_order(t)),!Array.isArray(t))return l===t?{}:!1;var i=allChildren(l),a=t[0],s=t.slice(1);if(!Array.isArray(l)||l[0]!==a||i.length<s.length){if(Array.isArray(e.allow_implicit_identities)){let u=matchImplicitIdentity(l,t,e);if(u)return u}if(a==="*"&&Array.isArray(l)&&l[0]==="-"&&Array.isArray(l[1])&&l[1][0]==="*")i=allChildren(l[1]),i[0]=["-",i[0]];else return!1}let o=matchOperands(a,i,s,e,n);return o||(Array.isArray(e.allow_implicit_identities)?matchImplicitIdentity([a].concat(i),t,e):!1)};function matchOperands(l,t,e,n,r){var i=e.map(f=>Object()),a=e.length,s=!1;n.allow_permutations&&(l==="*"||l==="+"||l==="="||l==="and"||l==="or"||l==="ne"||l==="union"||l==="intersect")&&(s=!0);function o(f,p,d){let m=1,v=1;is_associative[l]&&(m=f.length-(a-p-1),v=f.length),n.max_group!==void 0&&(m=n.max_group<m?n.max_group:m),n.max_last_group!==void 0&&(v=n.max_last_group<v?n.max_last_group:v);let h;if(!r&&p===a-1)if(f.length<=v)h=[f];else return!1;else if(s)h=subsets(f,m);else{h=[];for(let y=1;y<=m;y++)h.push(f.slice(0,y))}for(let y of h){let g=i[p][y];if(g===void 0){let C=y.reduce(function(_,w){return _.concat([t[w]])},[]);C.length>1?C=[l].concat(C):C=C[0],g=match(C,e[p],n),i[p][y]=g}if(!g||!underscore.every(underscore.intersection(Object.keys(d),Object.keys(g)),function(C){return equal$2(d[C],g[C])}))continue;let b=Object.assign({},g);Object.assign(b,d);let x=f.filter(C=>!y.includes(C));if(p===a-1){let C=x.reduce(function(_,w){return _.concat([t[w]])},[]);return{matches:b,skipped:C}}let N=o(x,p+1,b);if(N)return N}return!1}var u={},c=[...Array(t.length).keys()];if(s){let f=o(c,0,{});return f?(u=f.matches,f.skipped.length>0&&(u._skipped=f.skipped),u):!1}else{let f=r?t.length-a:0,p=[],d;for(let m=0;m<=f&&(d=o(c,0,{}),!d);m++)c=c.slice(1),p.push(t[m]);return d?(u=d.matches,d.skipped.length>0&&(u._skipped=d.skipped),p.length>0&&(u._skipped_before=p),u):!1}}function matchImplicitIdentity(l,t,e){var n=t[0],r=t.slice(1);if(!(n==="+"||n==="*"||n==="^"))return!1;var i=null;for(let u=0;u<r.length;u++){let c=r[u];if(typeof c=="string"&&e.allow_implicit_identities.includes(c)){i=c;break}}if(i===null)return!1;var a={};n==="+"?a[i]=0:a[i]=1,n==="*"&&r.includes(i)&&Array.isArray(l)&&l[0]==="-"&&(a[i]=-1,l=l[1]);var s=r.indexOf(i);if(r.splice(s,1),n==="^"&&s===0)return!1;r.length===1?t=r[0]:t=[n].concat(r);var o=match(l,t,e);if(o){if(i in o&&!equal$2(o[i],a[i]))return!1;Object.assign(a,o)}else return!1;return a}let substitute=function(l,t){return typeof l=="number"||typeof l=="boolean"?l:typeof l=="string"?t[l]!==void 0?deepClone(t[l]):l:Array.isArray(l)?[l[0]].concat(l.slice(1).map(function(e){return substitute(e,t)})):[]},transform$2=function(l,t){if(Array.isArray(l)){let e=[l[0]];for(let n=1;n<l.length;n++)e.push(transform$2(l[n],t));return t(e)}return t(l)},applyAllTransformations=function(l,t,e){e===void 0&&(e=5);for(var n=l,r;e>0;e--){r=n;for(let i=0;i<t.length;i++){let a=t[i][0],s=t[i][1],o=t[i][2];o===void 0&&(o={}),n=transform$2(n,function(u){let c=match(u,a,o);if(c){let f=substitute(s,c);o.evaluate_numbers&&(f=evaluate_numbers(f,{max_digits:o.max_digits}));let p=[],d=[];return c._skipped&&(p=c._skipped),c._skipped_before&&(d=c._skipped_before),(d.length>0||p.length>0)&&(Array.isArray(f)&&(f[0]===a[0]?f=f.slice(1):f=[f]),f=[a[0]].concat(d,f,p)),o.evaluate_numbers&&(f=evaluate_numbers(f,{max_digits:o.max_digits})),f}else return u})}if(equal$2(r,n))return n}return n};var endsWith=string.endsWith,clone$11=object.clone;function factory$278(l,t,e,n,r){var i=e(addScalar),a=e(subtract$1),s=e(multiplyScalar),o=e(divideScalar),u=e(pow$1),c=e(abs$1),f=e(fix$1),p=e(round$1),d=e(equal$1),m=e(isNumeric$1),v=e(format$8),h=e(_typeof$1),y=e(number$3),g=e(Complex_1);function b(R,F){if(!(this instanceof b))throw new Error("Constructor must be called with the new operator");if(!(R==null||m(R)||l.isComplex(R)))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(F!=null&&(typeof F!="string"||F===""))throw new TypeError("Second parameter in Unit constructor must be a string");if(F!=null){var X=b.parse(F);this.units=X.units,this.dimensions=X.dimensions}else{this.units=[{unit:ne,prefix:E.NONE,power:0}],this.dimensions=[];for(var te=0;te<G.length;te++)this.dimensions[te]=0}this.value=R!=null?this._normalize(R):null,this.fixPrefix=!1,this.isUnitListSimplified=!0}b.prototype.type="Unit",b.prototype.isUnit=!0;var x,N,C;function _(){for(;C==" "||C=="	";)$()}function w(R){return R>="0"&&R<="9"||R=="."}function A(R){return R>="0"&&R<="9"}function $(){N++,C=x.charAt(N)}function S(R){N=R,C=x.charAt(N)}function D(){var R="",F;if(F=N,C=="+"?$():C=="-"&&(R+=C,$()),!w(C))return S(F),null;if(C=="."){if(R+=C,$(),!A(C))return S(F),null}else{for(;A(C);)R+=C,$();C=="."&&(R+=C,$())}for(;A(C);)R+=C,$();if(C=="E"||C=="e"){var X="",te=N;if(X+=C,$(),(C=="+"||C=="-")&&(X+=C,$()),!A(C))return S(te),R;for(R=R+X;A(C);)R+=C,$()}return R}function V(){for(var R="",F=x.charCodeAt(N);F>=48&&F<=57||F>=65&&F<=90||F>=97&&F<=122;)R+=C,$(),F=x.charCodeAt(N);return F=R.charCodeAt(0),(F>=65&&F<=90||F>=97&&F<=122)&&R||null}function I(R){return C===R?($(),R):null}b.parse=function(R,F){if(F=F||{},x=R,N=-1,C="",typeof x!="string")throw new TypeError("Invalid argument in Unit.parse, string expected");var X=new b;X.units=[];var te=1,de=!1;$(),_();var he=D(),H=null;he&&(t.number==="BigNumber"?H=new l.BigNumber(he):t.number==="Fraction"?H=new l.Fraction(he):H=parseFloat(he),_(),I("*")?(te=1,de=!0):I("/")&&(te=-1,de=!0));for(var re=[],ce=1;;){for(_();C==="(";)re.push(te),ce*=te,te=1,$(),_();if(C){var ue=C,Ce=V();if(Ce==null)throw new SyntaxError('Unexpected "'+ue+'" in "'+x+'" at index '+N.toString())}else break;var Ne=q(Ce);if(Ne==null)throw new SyntaxError('Unit "'+Ce+'" not found.');var Te=te*ce;if(_(),I("^")){_();var $e=D();if($e==null)throw new SyntaxError('In "'+R+'", "^" must be followed by a floating-point number');Te*=$e}X.units.push({unit:Ne.unit,prefix:Ne.prefix,power:Te});for(var Ae=0;Ae<G.length;Ae++)X.dimensions[Ae]+=(Ne.unit.dimensions[Ae]||0)*Te;for(_();C===")";){if(re.length===0)throw new SyntaxError('Unmatched ")" in "'+x+'" at index '+N.toString());ce/=re.pop(),$(),_()}if(de=!1,I("*")?(te=1,de=!0):I("/")?(te=-1,de=!0):te=1,Ne.unit.base){var Ve=Ne.unit.base.key;oe.auto[Ve]={unit:Ne.unit,prefix:Ne.prefix}}}if(_(),C)throw new SyntaxError('Could not parse: "'+R+'"');if(de)throw new SyntaxError('Trailing characters: "'+R+'"');if(re.length!==0)throw new SyntaxError('Unmatched "(" in "'+x+'"');if(X.units.length==0&&!F.allowNoUnits)throw new SyntaxError('"'+R+'" contains no units');return X.value=H!=null?X._normalize(H):null,X},b.prototype.clone=function(){var R=new b;R.fixPrefix=this.fixPrefix,R.isUnitListSimplified=this.isUnitListSimplified,R.value=clone$11(this.value),R.dimensions=this.dimensions.slice(0),R.units=[];for(var F=0;F<this.units.length;F++){R.units[F]={};for(var X in this.units[F])this.units[F].hasOwnProperty(X)&&(R.units[F][X]=this.units[F][X])}return R},b.prototype._isDerived=function(){return this.units.length===0?!1:this.units.length>1||Math.abs(this.units[0].power-1)>1e-15},b.prototype._normalize=function(R){var F,X,te,de,he;if(R==null||this.units.length===0)return R;if(this._isDerived()){var H=R;he=b._getNumberConverter(h(R));for(var re=0;re<this.units.length;re++)F=he(this.units[re].unit.value),de=he(this.units[re].prefix.value),te=he(this.units[re].power),H=s(H,u(s(F,de),te));return H}else return he=b._getNumberConverter(h(R)),F=he(this.units[0].unit.value),X=he(this.units[0].unit.offset),de=he(this.units[0].prefix.value),s(i(R,X),s(F,de))},b.prototype._denormalize=function(R,F){var X,te,de,he,H;if(R==null||this.units.length===0)return R;if(this._isDerived()){var re=R;H=b._getNumberConverter(h(R));for(var ce=0;ce<this.units.length;ce++)X=H(this.units[ce].unit.value),he=H(this.units[ce].prefix.value),de=H(this.units[ce].power),re=o(re,u(s(X,he),de));return re}else return H=b._getNumberConverter(h(R)),X=H(this.units[0].unit.value),he=H(this.units[0].prefix.value),te=H(this.units[0].unit.offset),F==null?a(o(o(R,X),he),te):a(o(o(R,X),F),te)};function q(R){if(Y.hasOwnProperty(R)){var F=Y[R],X=F.prefixes[""];return{unit:F,prefix:X}}for(var te in Y)if(Y.hasOwnProperty(te)&&endsWith(R,te)){var F=Y[te],de=R.length-te.length,he=R.substring(0,de),X=F.prefixes.hasOwnProperty(he)?F.prefixes[he]:void 0;if(X!==void 0)return{unit:F,prefix:X}}return null}b.isValuelessUnit=function(R){return q(R)!=null},b.prototype.hasBase=function(R){if(typeof R=="string"&&(R=P[R]),!R)return!1;for(var F=0;F<G.length;F++)if(Math.abs((this.dimensions[F]||0)-(R.dimensions[F]||0))>1e-12)return!1;return!0},b.prototype.equalBase=function(R){for(var F=0;F<G.length;F++)if(Math.abs((this.dimensions[F]||0)-(R.dimensions[F]||0))>1e-12)return!1;return!0},b.prototype.equals=function(R){return this.equalBase(R)&&d(this.value,R.value)},b.prototype.multiply=function(R){for(var F=this.clone(),X=0;X<G.length;X++)F.dimensions[X]=(this.dimensions[X]||0)+(R.dimensions[X]||0);for(var X=0;X<R.units.length;X++){var te={};for(var de in R.units[X])te[de]=R.units[X][de];F.units.push(te)}if(this.value!=null||R.value!=null){var he=this.value==null?this._normalize(1):this.value,H=R.value==null?R._normalize(1):R.value;F.value=s(he,H)}else F.value=null;return F.isUnitListSimplified=!1,K(F)},b.prototype.divide=function(R){for(var F=this.clone(),X=0;X<G.length;X++)F.dimensions[X]=(this.dimensions[X]||0)-(R.dimensions[X]||0);for(var X=0;X<R.units.length;X++){var te={};for(var de in R.units[X])te[de]=R.units[X][de];te.power=-te.power,F.units.push(te)}if(this.value!=null||R.value!=null){var he=this.value==null?this._normalize(1):this.value,H=R.value==null?R._normalize(1):R.value;F.value=o(he,H)}else F.value=null;return F.isUnitListSimplified=!1,K(F)},b.prototype.pow=function(R){for(var F=this.clone(),X=0;X<G.length;X++)F.dimensions[X]=(this.dimensions[X]||0)*R;for(var X=0;X<F.units.length;X++)F.units[X].power*=R;return F.value!=null?F.value=u(F.value,R):F.value=null,F.isUnitListSimplified=!1,K(F)};var K=function(R){return R.equalBase(P.NONE)&&R.value!==null&&!t.predictable?R.value:R};b.prototype.abs=function(){var R=this.clone();R.value=R.value!==null?c(R.value):null;for(var F in R.units)(R.units[F].unit.name==="VA"||R.units[F].unit.name==="VAR")&&(R.units[F].unit=Y.W);return R},b.prototype.to=function(R){var F,X=this.value==null?this._normalize(1):this.value;if(typeof R=="string"){if(F=b.parse(R),!this.equalBase(F))throw new Error("Units do not match");if(F.value!==null)throw new Error("Cannot convert to a unit with a value");return F.value=clone$11(X),F.fixPrefix=!0,F.isUnitListSimplified=!0,F}else if(l.isUnit(R)){if(!this.equalBase(R))throw new Error("Units do not match");if(R.value!==null)throw new Error("Cannot convert to a unit with a value");return F=R.clone(),F.value=clone$11(X),F.fixPrefix=!0,F.isUnitListSimplified=!0,F}else throw new Error("String or Unit expected as parameter")},b.prototype.toNumber=function(R){return y(this.toNumeric(R))},b.prototype.toNumeric=function(R){var F=this;return R&&(F=this.to(R)),F.simplifyUnitListLazy(),F._isDerived()?F._denormalize(F.value):F._denormalize(F.value,F.units[0].prefix.value)},b.prototype.toString=function(){return this.format()},b.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},b.fromJSON=function(R){var F=new b(R.value,R.unit);return F.fixPrefix=R.fixPrefix||!1,F},b.prototype.valueOf=b.prototype.toString,b.prototype.simplifyUnitListLazy=function(){if(!(this.isUnitListSimplified||this.value==null)){var R=[],F;for(var X in ve)if(this.hasBase(P[X])){F=X;break}if(F==="NONE")this.units=[];else{var te;if(F&&ve.hasOwnProperty(F)&&(te=ve[F]),te)this.units=[{unit:te.unit,prefix:te.prefix,power:1}];else{for(var de=!1,he=0;he<G.length;he++){var H=G[he];Math.abs(this.dimensions[he]||0)>1e-12&&(ve.hasOwnProperty(H)?R.push({unit:ve[H].unit,prefix:ve[H].prefix,power:this.dimensions[he]||0}):de=!0)}R.length<this.units.length&&!de&&(this.units=R)}}this.isUnitListSimplified=!0}},b.prototype.toSI=function(){for(var R=this.clone(),F=[],X=0;X<G.length;X++){var te=G[X];if(Math.abs(R.dimensions[X]||0)>1e-12)if(oe.si.hasOwnProperty(te))F.push({unit:oe.si[te].unit,prefix:oe.si[te].prefix,power:R.dimensions[X]||0});else throw new Error("Cannot express custom unit "+te+" in SI units")}return R.units=F,R.isUnitListSimplified=!0,R},b.prototype.formatUnits=function(){this.simplifyUnitListLazy();for(var R="",F="",X=0,te=0,de=0;de<this.units.length;de++)this.units[de].power>0?(X++,R+=" "+this.units[de].prefix.name+this.units[de].unit.name,Math.abs(this.units[de].power-1)>1e-15&&(R+="^"+this.units[de].power)):this.units[de].power<0&&te++;if(te>0)for(var de=0;de<this.units.length;de++)this.units[de].power<0&&(X>0?(F+=" "+this.units[de].prefix.name+this.units[de].unit.name,Math.abs(this.units[de].power+1)>1e-15&&(F+="^"+-this.units[de].power)):(F+=" "+this.units[de].prefix.name+this.units[de].unit.name,F+="^"+this.units[de].power));R=R.substr(1),F=F.substr(1),X>1&&te>0&&(R="("+R+")"),te>1&&X>0&&(F="("+F+")");var he=R;return X>0&&te>0&&(he+=" / "),he+=F,he},b.prototype.format=function(R){this.simplifyUnitListLazy();var F=!1,X=!0;typeof this.value!="undefined"&&this.value!==null&&l.isComplex(this.value)&&(F=Math.abs(this.value.re)<1e-14,X=Math.abs(this.value.im)<1e-14);for(var te in this.units)this.units[te].unit&&(this.units[te].unit.name==="VA"&&F?this.units[te].unit=Y.VAR:this.units[te].unit.name==="VAR"&&!F&&(this.units[te].unit=Y.VA));this.units.length===1&&!this.fixPrefix&&Math.abs(this.units[0].power-Math.round(this.units[0].power))<1e-14&&(this.units[0].prefix=this._bestPrefix());var de=this._denormalize(this.value),he=this.value!==null?v(de,R||{}):"",H=this.formatUnits();return this.value&&l.isComplex(this.value)&&(he="("+he+")"),H.length>0&&he.length>0&&(he+=" "),he+=H,he},b.prototype._bestPrefix=function(){if(this.units.length!==1)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var R=this.value!==null?c(this.value):0,F=c(this.units[0].unit.value),X=this.units[0].prefix;if(R===0)return X;var te=this.units[0].power,de=Math.log(R/Math.pow(X.value*F,te))/Math.LN10-1.2;if(de>-2.200001&&de<1.800001)return X;de=Math.abs(de);var he=this.units[0].unit.prefixes;for(var H in he)if(he.hasOwnProperty(H)){var re=he[H];if(re.scientific){var ce=Math.abs(Math.log(R/Math.pow(re.value*F,te))/Math.LN10-1.2);(ce<de||ce===de&&re.name.length<X.name.length)&&(X=re,de=ce)}}return X},b.prototype.splitUnit=function(R){for(var F=this.clone(),X=[],te=0;te<R.length&&(F=F.to(R[te]),te!=R.length-1);te++){var de=F.toNumeric(),he=p(de),H,re=d(he,de);re?H=he:H=f(F.toNumeric());var ce=new b(H,R[te].toString());X.push(ce),F=a(F,ce)}for(var ue=0,te=0;te<X.length;te++)ue=i(ue,X[te].value);return d(ue,this.value)&&(F.value=0),X.push(F),X};var E={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};E.SHORTLONG={};for(var W in E.SHORT)E.SHORT.hasOwnProperty(W)&&(E.SHORTLONG[W]=E.SHORT[W]);for(var W in E.LONG)E.LONG.hasOwnProperty(W)&&(E.SHORTLONG[W]=E.LONG[W]);var G=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],P={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var W in P)P[W].key=W;var Q={},ne={name:"",base:Q,value:1,offset:0,dimensions:[0,0,0,0,0,0,0,0,0]},Y={meter:{name:"meter",base:P.LENGTH,prefixes:E.LONG,value:1,offset:0},inch:{name:"inch",base:P.LENGTH,prefixes:E.NONE,value:.0254,offset:0},foot:{name:"foot",base:P.LENGTH,prefixes:E.NONE,value:.3048,offset:0},yard:{name:"yard",base:P.LENGTH,prefixes:E.NONE,value:.9144,offset:0},mile:{name:"mile",base:P.LENGTH,prefixes:E.NONE,value:1609.344,offset:0},link:{name:"link",base:P.LENGTH,prefixes:E.NONE,value:.201168,offset:0},rod:{name:"rod",base:P.LENGTH,prefixes:E.NONE,value:5.02921,offset:0},chain:{name:"chain",base:P.LENGTH,prefixes:E.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:P.LENGTH,prefixes:E.NONE,value:1e-10,offset:0},m:{name:"m",base:P.LENGTH,prefixes:E.SHORT,value:1,offset:0},in:{name:"in",base:P.LENGTH,prefixes:E.NONE,value:.0254,offset:0},ft:{name:"ft",base:P.LENGTH,prefixes:E.NONE,value:.3048,offset:0},yd:{name:"yd",base:P.LENGTH,prefixes:E.NONE,value:.9144,offset:0},mi:{name:"mi",base:P.LENGTH,prefixes:E.NONE,value:1609.344,offset:0},li:{name:"li",base:P.LENGTH,prefixes:E.NONE,value:.201168,offset:0},rd:{name:"rd",base:P.LENGTH,prefixes:E.NONE,value:5.02921,offset:0},ch:{name:"ch",base:P.LENGTH,prefixes:E.NONE,value:20.1168,offset:0},mil:{name:"mil",base:P.LENGTH,prefixes:E.NONE,value:254e-7,offset:0},m2:{name:"m2",base:P.SURFACE,prefixes:E.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:P.SURFACE,prefixes:E.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:P.SURFACE,prefixes:E.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:P.SURFACE,prefixes:E.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:P.SURFACE,prefixes:E.NONE,value:2589988110336e-6,offset:0},sqrd:{name:"sqrd",base:P.SURFACE,prefixes:E.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:P.SURFACE,prefixes:E.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:P.SURFACE,prefixes:E.NONE,value:64516e-14,offset:0},acre:{name:"acre",base:P.SURFACE,prefixes:E.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:P.SURFACE,prefixes:E.NONE,value:1e4,offset:0},m3:{name:"m3",base:P.VOLUME,prefixes:E.CUBIC,value:1,offset:0},L:{name:"L",base:P.VOLUME,prefixes:E.SHORT,value:.001,offset:0},l:{name:"l",base:P.VOLUME,prefixes:E.SHORT,value:.001,offset:0},litre:{name:"litre",base:P.VOLUME,prefixes:E.LONG,value:.001,offset:0},cuin:{name:"cuin",base:P.VOLUME,prefixes:E.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:P.VOLUME,prefixes:E.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:P.VOLUME,prefixes:E.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:P.VOLUME,prefixes:E.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:P.VOLUME,prefixes:E.NONE,value:15e-6,offset:0},drop:{name:"drop",base:P.VOLUME,prefixes:E.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:P.VOLUME,prefixes:E.NONE,value:5e-8,offset:0},minim:{name:"minim",base:P.VOLUME,prefixes:E.NONE,value:6161152e-14,offset:0},fluiddram:{name:"fluiddram",base:P.VOLUME,prefixes:E.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:P.VOLUME,prefixes:E.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:P.VOLUME,prefixes:E.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:P.VOLUME,prefixes:E.NONE,value:1e-6,offset:0},cup:{name:"cup",base:P.VOLUME,prefixes:E.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:P.VOLUME,prefixes:E.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:P.VOLUME,prefixes:E.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:P.VOLUME,prefixes:E.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:P.VOLUME,prefixes:E.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:P.VOLUME,prefixes:E.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:P.VOLUME,prefixes:E.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:P.VOLUME,prefixes:E.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:P.VOLUME,prefixes:E.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:P.VOLUME,prefixes:E.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:P.VOLUME,prefixes:E.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:P.VOLUME,prefixes:E.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:P.VOLUME,prefixes:E.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:P.VOLUME,prefixes:E.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:P.VOLUME,prefixes:E.NONE,value:.1173478,offset:0},obl:{name:"obl",base:P.VOLUME,prefixes:E.NONE,value:.1589873,offset:0},g:{name:"g",base:P.MASS,prefixes:E.SHORT,value:.001,offset:0},gram:{name:"gram",base:P.MASS,prefixes:E.LONG,value:.001,offset:0},ton:{name:"ton",base:P.MASS,prefixes:E.SHORT,value:907.18474,offset:0},tonne:{name:"tonne",base:P.MASS,prefixes:E.SHORT,value:1e3,offset:0},grain:{name:"grain",base:P.MASS,prefixes:E.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:P.MASS,prefixes:E.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:P.MASS,prefixes:E.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:P.MASS,prefixes:E.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:P.MASS,prefixes:E.NONE,value:45.359237,offset:0},stick:{name:"stick",base:P.MASS,prefixes:E.NONE,value:.115,offset:0},stone:{name:"stone",base:P.MASS,prefixes:E.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:P.MASS,prefixes:E.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:P.MASS,prefixes:E.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:P.MASS,prefixes:E.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:P.MASS,prefixes:E.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:P.MASS,prefixes:E.NONE,value:45.359237,offset:0},s:{name:"s",base:P.TIME,prefixes:E.SHORT,value:1,offset:0},min:{name:"min",base:P.TIME,prefixes:E.NONE,value:60,offset:0},h:{name:"h",base:P.TIME,prefixes:E.NONE,value:3600,offset:0},second:{name:"second",base:P.TIME,prefixes:E.LONG,value:1,offset:0},sec:{name:"sec",base:P.TIME,prefixes:E.LONG,value:1,offset:0},minute:{name:"minute",base:P.TIME,prefixes:E.NONE,value:60,offset:0},hour:{name:"hour",base:P.TIME,prefixes:E.NONE,value:3600,offset:0},day:{name:"day",base:P.TIME,prefixes:E.NONE,value:86400,offset:0},week:{name:"week",base:P.TIME,prefixes:E.NONE,value:7*86400,offset:0},month:{name:"month",base:P.TIME,prefixes:E.NONE,value:2629800,offset:0},year:{name:"year",base:P.TIME,prefixes:E.NONE,value:31557600,offset:0},decade:{name:"decade",base:P.TIME,prefixes:E.NONE,value:315576e3,offset:0},century:{name:"century",base:P.TIME,prefixes:E.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:P.TIME,prefixes:E.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:P.FREQUENCY,prefixes:E.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:P.FREQUENCY,prefixes:E.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:P.ANGLE,prefixes:E.SHORT,value:1,offset:0},radian:{name:"radian",base:P.ANGLE,prefixes:E.LONG,value:1,offset:0},deg:{name:"deg",base:P.ANGLE,prefixes:E.SHORT,value:null,offset:0},degree:{name:"degree",base:P.ANGLE,prefixes:E.LONG,value:null,offset:0},grad:{name:"grad",base:P.ANGLE,prefixes:E.SHORT,value:null,offset:0},gradian:{name:"gradian",base:P.ANGLE,prefixes:E.LONG,value:null,offset:0},cycle:{name:"cycle",base:P.ANGLE,prefixes:E.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:P.ANGLE,prefixes:E.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:P.ANGLE,prefixes:E.NONE,value:null,offset:0},A:{name:"A",base:P.CURRENT,prefixes:E.SHORT,value:1,offset:0},ampere:{name:"ampere",base:P.CURRENT,prefixes:E.LONG,value:1,offset:0},K:{name:"K",base:P.TEMPERATURE,prefixes:E.NONE,value:1,offset:0},degC:{name:"degC",base:P.TEMPERATURE,prefixes:E.NONE,value:1,offset:273.15},degF:{name:"degF",base:P.TEMPERATURE,prefixes:E.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:P.TEMPERATURE,prefixes:E.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:P.TEMPERATURE,prefixes:E.NONE,value:1,offset:0},celsius:{name:"celsius",base:P.TEMPERATURE,prefixes:E.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:P.TEMPERATURE,prefixes:E.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:P.TEMPERATURE,prefixes:E.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:P.AMOUNT_OF_SUBSTANCE,prefixes:E.SHORT,value:1,offset:0},mole:{name:"mole",base:P.AMOUNT_OF_SUBSTANCE,prefixes:E.LONG,value:1,offset:0},cd:{name:"cd",base:P.LUMINOUS_INTENSITY,prefixes:E.NONE,value:1,offset:0},candela:{name:"candela",base:P.LUMINOUS_INTENSITY,prefixes:E.NONE,value:1,offset:0},N:{name:"N",base:P.FORCE,prefixes:E.SHORT,value:1,offset:0},newton:{name:"newton",base:P.FORCE,prefixes:E.LONG,value:1,offset:0},dyn:{name:"dyn",base:P.FORCE,prefixes:E.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:P.FORCE,prefixes:E.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:P.FORCE,prefixes:E.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:P.FORCE,prefixes:E.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:P.FORCE,prefixes:E.LONG,value:4448.2216,offset:0},J:{name:"J",base:P.ENERGY,prefixes:E.SHORT,value:1,offset:0},joule:{name:"joule",base:P.ENERGY,prefixes:E.SHORT,value:1,offset:0},erg:{name:"erg",base:P.ENERGY,prefixes:E.NONE,value:1e-7,offset:0},Wh:{name:"Wh",base:P.ENERGY,prefixes:E.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:P.ENERGY,prefixes:E.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:P.ENERGY,prefixes:E.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:P.ENERGY,prefixes:E.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:P.POWER,prefixes:E.SHORT,value:1,offset:0},watt:{name:"watt",base:P.POWER,prefixes:E.LONG,value:1,offset:0},hp:{name:"hp",base:P.POWER,prefixes:E.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:P.POWER,prefixes:E.SHORT,value:g.I,offset:0},VA:{name:"VA",base:P.POWER,prefixes:E.SHORT,value:1,offset:0},Pa:{name:"Pa",base:P.PRESSURE,prefixes:E.SHORT,value:1,offset:0},psi:{name:"psi",base:P.PRESSURE,prefixes:E.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:P.PRESSURE,prefixes:E.NONE,value:101325,offset:0},bar:{name:"bar",base:P.PRESSURE,prefixes:E.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:P.PRESSURE,prefixes:E.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:P.PRESSURE,prefixes:E.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:P.PRESSURE,prefixes:E.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:P.PRESSURE,prefixes:E.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:P.ELECTRIC_CHARGE,prefixes:E.LONG,value:1,offset:0},C:{name:"C",base:P.ELECTRIC_CHARGE,prefixes:E.SHORT,value:1,offset:0},farad:{name:"farad",base:P.ELECTRIC_CAPACITANCE,prefixes:E.LONG,value:1,offset:0},F:{name:"F",base:P.ELECTRIC_CAPACITANCE,prefixes:E.SHORT,value:1,offset:0},volt:{name:"volt",base:P.ELECTRIC_POTENTIAL,prefixes:E.LONG,value:1,offset:0},V:{name:"V",base:P.ELECTRIC_POTENTIAL,prefixes:E.SHORT,value:1,offset:0},ohm:{name:"ohm",base:P.ELECTRIC_RESISTANCE,prefixes:E.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:P.ELECTRIC_INDUCTANCE,prefixes:E.LONG,value:1,offset:0},H:{name:"H",base:P.ELECTRIC_INDUCTANCE,prefixes:E.SHORT,value:1,offset:0},siemens:{name:"siemens",base:P.ELECTRIC_CONDUCTANCE,prefixes:E.LONG,value:1,offset:0},S:{name:"S",base:P.ELECTRIC_CONDUCTANCE,prefixes:E.SHORT,value:1,offset:0},weber:{name:"weber",base:P.MAGNETIC_FLUX,prefixes:E.LONG,value:1,offset:0},Wb:{name:"Wb",base:P.MAGNETIC_FLUX,prefixes:E.SHORT,value:1,offset:0},tesla:{name:"tesla",base:P.MAGNETIC_FLUX_DENSITY,prefixes:E.LONG,value:1,offset:0},T:{name:"T",base:P.MAGNETIC_FLUX_DENSITY,prefixes:E.SHORT,value:1,offset:0},b:{name:"b",base:P.BIT,prefixes:E.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:P.BIT,prefixes:E.BINARY_LONG,value:1,offset:0},B:{name:"B",base:P.BIT,prefixes:E.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:P.BIT,prefixes:E.BINARY_LONG,value:8,offset:0}},se={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole"};function pe(R){if(R.number==="BigNumber"){var F=constants.pi(l.BigNumber);Y.rad.value=new l.BigNumber(1),Y.deg.value=F.div(180),Y.grad.value=F.div(200),Y.cycle.value=F.times(2),Y.arcsec.value=F.div(648e3),Y.arcmin.value=F.div(10800)}else Y.rad.value=1,Y.deg.value=Math.PI/180,Y.grad.value=Math.PI/200,Y.cycle.value=Math.PI*2,Y.arcsec.value=Math.PI/648e3,Y.arcmin.value=Math.PI/10800;Y.radian.value=Y.rad.value,Y.degree.value=Y.deg.value,Y.gradian.value=Y.grad.value}pe(t),r.on("config",function(R,F){R.number!==F.number&&pe(R)});var oe={si:{NONE:{unit:ne,prefix:E.NONE[""]},LENGTH:{unit:Y.m,prefix:E.SHORT[""]},MASS:{unit:Y.g,prefix:E.SHORT.k},TIME:{unit:Y.s,prefix:E.SHORT[""]},CURRENT:{unit:Y.A,prefix:E.SHORT[""]},TEMPERATURE:{unit:Y.K,prefix:E.SHORT[""]},LUMINOUS_INTENSITY:{unit:Y.cd,prefix:E.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:Y.mol,prefix:E.SHORT[""]},ANGLE:{unit:Y.rad,prefix:E.SHORT[""]},BIT:{unit:Y.bit,prefix:E.SHORT[""]},FORCE:{unit:Y.N,prefix:E.SHORT[""]},ENERGY:{unit:Y.J,prefix:E.SHORT[""]},POWER:{unit:Y.W,prefix:E.SHORT[""]},PRESSURE:{unit:Y.Pa,prefix:E.SHORT[""]},ELECTRIC_CHARGE:{unit:Y.C,prefix:E.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:Y.F,prefix:E.SHORT[""]},ELECTRIC_POTENTIAL:{unit:Y.V,prefix:E.SHORT[""]},ELECTRIC_RESISTANCE:{unit:Y.ohm,prefix:E.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:Y.H,prefix:E.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:Y.S,prefix:E.SHORT[""]},MAGNETIC_FLUX:{unit:Y.Wb,prefix:E.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:Y.T,prefix:E.SHORT[""]},FREQUENCY:{unit:Y.Hz,prefix:E.SHORT[""]}}};oe.cgs=JSON.parse(JSON.stringify(oe.si)),oe.cgs.LENGTH={unit:Y.m,prefix:E.SHORT.c},oe.cgs.MASS={unit:Y.g,prefix:E.SHORT[""]},oe.cgs.FORCE={unit:Y.dyn,prefix:E.SHORT[""]},oe.cgs.ENERGY={unit:Y.erg,prefix:E.NONE[""]},oe.us=JSON.parse(JSON.stringify(oe.si)),oe.us.LENGTH={unit:Y.ft,prefix:E.NONE[""]},oe.us.MASS={unit:Y.lbm,prefix:E.NONE[""]},oe.us.TEMPERATURE={unit:Y.degF,prefix:E.NONE[""]},oe.us.FORCE={unit:Y.lbf,prefix:E.NONE[""]},oe.us.ENERGY={unit:Y.BTU,prefix:E.BTU[""]},oe.us.POWER={unit:Y.hp,prefix:E.NONE[""]},oe.us.PRESSURE={unit:Y.psi,prefix:E.NONE[""]},oe.auto=JSON.parse(JSON.stringify(oe.si));var ve=oe.auto;b.setUnitSystem=function(R){if(oe.hasOwnProperty(R))ve=oe[R];else throw new Error("Unit system "+R+" does not exist. Choices are: "+Object.keys(oe).join(", "))},b.getUnitSystem=function(){for(var R in oe)if(oe[R]===ve)return R},b.typeConverters={BigNumber:function(R){return new l.BigNumber(R+"")},Fraction:function(R){return new l.Fraction(R)},Complex:function(R){return R},number:function(R){return R}},b._getNumberConverter=function(R){if(!b.typeConverters[R])throw new TypeError('Unsupported type "'+R+'"');return b.typeConverters[R]};for(var W in Y){var O=Y[W];O.dimensions=O.base.dimensions}for(var z in se)if(se.hasOwnProperty(z)){var O=Y[se[z]],Z={};for(var W in O)O.hasOwnProperty(W)&&(Z[W]=O[W]);Z.name=z,Y[z]=Z}function J(R){for(var F=0;F<R.length;F++){var X=R.charAt(F),te=function(he){return/^[a-zA-Z]$/.test(he)},de=function(he){return he>="0"&&he<="9"};if(F===0&&!te(X))throw new Error('Invalid unit name (must begin with alpha character): "'+R+'"');if(F>0&&!(te(X)||de(X)))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+R+'"')}}return b.createUnit=function(R,F){if(typeof R!="object")throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(F&&F.override){for(var X in R)if(R.hasOwnProperty(X)&&b.deleteUnit(X),R[X].aliases)for(var te=0;te<R[X].aliases.length;te++)b.deleteUnit(R[X].aliases[te])}var de;for(var X in R)R.hasOwnProperty(X)&&(de=b.createUnitSingle(X,R[X]));return de},b.createUnitSingle=function(R,F,X){if((typeof F=="undefined"||F===null)&&(F={}),typeof R!="string")throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(Y.hasOwnProperty(R))throw new Error('Cannot create unit "'+R+'": a unit with that name already exists');J(R);var te=null,de=[],he=0,H,re;if(F&&F.type==="Unit")te=F.clone();else if(typeof F=="string")F!==""&&(H=F);else if(typeof F=="object")H=F.definition,re=F.prefixes,he=F.offset,F.aliases&&(de=F.aliases.valueOf());else throw new TypeError('Cannot create unit "'+R+'" from "'+F.toString()+'": expecting "string" or "Unit" or "Object"');if(de){for(var ce=0;ce<de.length;ce++)if(Y.hasOwnProperty(de[ce]))throw new Error('Cannot create alias "'+de[ce]+'": a unit with that name already exists')}if(H&&typeof H=="string"&&!te)try{te=b.parse(H,{allowNoUnits:!0})}catch(Mt){throw Mt.message='Could not create unit "'+R+'" from "'+H+'": '+Mt.message,Mt}else H&&H.type==="Unit"&&(te=H.clone());de=de||[],he=he||0,re&&re.toUpperCase?re=E[re.toUpperCase()]||E.NONE:re=E.NONE;var ue={};if(te){ue={name:R,value:te.value,dimensions:te.dimensions.slice(0),prefixes:re,offset:he};var $e=!1;for(var ce in P)if(P.hasOwnProperty(ce)){for(var Ae=!0,Ve=0;Ve<G.length;Ve++)if(Math.abs((ue.dimensions[Ve]||0)-(P[ce].dimensions[Ve]||0))>1e-12){Ae=!1;break}if(Ae){$e=!0;break}}if(!$e){var Ce=R+"_STUFF",Te={dimensions:te.dimensions.slice(0)};Te.key=Ce,P[Ce]=Te,ve[Ce]={unit:ue,prefix:E.NONE[""]},ue.base=Ce}}else{var Ce=R+"_STUFF";if(G.indexOf(Ce)>=0)throw new Error('Cannot create new base unit "'+R+'": a base unit with that name already exists (and cannot be overridden)');G.push(Ce);for(var Ne in P)P.hasOwnProperty(Ne)&&(P[Ne].dimensions[G.length-1]=0);for(var Te={dimensions:[]},ce=0;ce<G.length;ce++)Te.dimensions[ce]=0;Te.dimensions[G.length-1]=1,Te.key=Ce,P[Ce]=Te,ue={name:R,value:1,dimensions:P[Ce].dimensions.slice(0),prefixes:re,offset:he,base:Ce},ve[Ce]={unit:ue,prefix:E.NONE[""]}}b.UNITS[R]=ue;for(var ce=0;ce<de.length;ce++){var Qe=de[ce],Je={};for(var at in ue)ue.hasOwnProperty(at)&&(Je[at]=ue[at]);Je.name=Qe,b.UNITS[Qe]=Je}return new b(null,R)},b.deleteUnit=function(R){delete b.UNITS[R]},b.PREFIXES=E,b.BASE_DIMENSIONS=G,b.BASE_UNITS=P,b.UNIT_SYSTEMS=oe,b.UNITS=Y,b}var name$265="Unit",path$65="type",factory_1$277=factory$278,math$20=!0,Unit={name:name$265,path:path$65,factory:factory_1$277,math:math$20};function factory$279(l,t,e,n){var r=n("unit",{Unit:function(i){return i.clone()},string:function(i){return l.Unit.isValuelessUnit(i)?new l.Unit(null,i):l.Unit.parse(i)},"number | BigNumber | Fraction | Complex, string":function(i,a){return new l.Unit(i,a)},"Array | Matrix":function(i){return deepMap(i,r)}});return r.toTex={1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},r}var name$266="unit",factory_1$278=factory$279,unit$2={name:name$266,factory:factory_1$278};function factory$280(l,t,e,n){var r=n("createUnit",{"Object, Object":function(i,a){return l.Unit.createUnit(i,a)},Object:function(i){return l.Unit.createUnit(i,{})},"string, Unit | string | Object, Object":function(i,a,s){var o={};return o[i]=a,l.Unit.createUnit(o,s)},"string, Unit | string | Object":function(i,a){var s={};return s[i]=a,l.Unit.createUnit(s,{})},string:function(i){var a={};return a[i]={},l.Unit.createUnit(a,{})}});return r}var name$267="createUnit",factory_1$279=factory$280,createUnit$1={name:name$267,factory:factory_1$279};function factory$281(l,t,e,n){var r=n("splitUnit",{"Unit, Array":function(i,a){return i.splitUnit(a)}});return r}var name$268="splitUnit",factory_1$280=factory$281,splitUnit$1={name:name$268,factory:factory_1$280},lazy$5=object.lazy;function factory$282(l,t,e,n,r){function i(a){var s=l.Unit.parse(a);return s.fixPrefix=!0,s}setLazyConstant$1(r,"speedOfLight",function(){return i("299792458 m s^-1")}),setLazyConstant$1(r,"gravitationConstant",function(){return i("6.6738480e-11 m^3 kg^-1 s^-2")}),setLazyConstant$1(r,"planckConstant",function(){return i("6.626069311e-34 J s")}),setLazyConstant$1(r,"reducedPlanckConstant",function(){return i("1.05457172647e-34 J s")}),setLazyConstant$1(r,"magneticConstant",function(){return i("1.2566370614e-6 N A^-2")}),setLazyConstant$1(r,"electricConstant",function(){return i("8.854187817e-12 F m^-1")}),setLazyConstant$1(r,"vacuumImpedance",function(){return i("376.730313461 ohm")}),setLazyConstant$1(r,"coulomb",function(){return i("8.9875517873681764e9 N m^2 C^-2")}),setLazyConstant$1(r,"elementaryCharge",function(){return i("1.60217656535e-19 C")}),setLazyConstant$1(r,"bohrMagneton",function(){return i("9.2740096820e-24 J T^-1")}),setLazyConstant$1(r,"conductanceQuantum",function(){return i("7.748091734625e-5 S")}),setLazyConstant$1(r,"inverseConductanceQuantum",function(){return i("12906.403721742 ohm")}),setLazyConstant$1(r,"magneticFluxQuantum",function(){return i("2.06783375846e-15 Wb")}),setLazyConstant$1(r,"nuclearMagneton",function(){return i("5.0507835311e-27 J T^-1")}),setLazyConstant$1(r,"klitzing",function(){return i("25812.807443484 ohm")}),setLazyConstant$1(r,"bohrRadius",function(){return i("5.291772109217e-11 m")}),setLazyConstant$1(r,"classicalElectronRadius",function(){return i("2.817940326727e-15 m")}),setLazyConstant$1(r,"electronMass",function(){return i("9.1093829140e-31 kg")}),setLazyConstant$1(r,"fermiCoupling",function(){return i("1.1663645e-5 GeV^-2")}),setLazyConstant$1(r,"fineStructure",function(){return .007297352569824}),setLazyConstant$1(r,"hartreeEnergy",function(){return i("4.3597443419e-18 J")}),setLazyConstant$1(r,"protonMass",function(){return i("1.67262177774e-27 kg")}),setLazyConstant$1(r,"deuteronMass",function(){return i("3.3435830926e-27 kg")}),setLazyConstant$1(r,"neutronMass",function(){return i("1.6749271613e-27 kg")}),setLazyConstant$1(r,"quantumOfCirculation",function(){return i("3.636947552024e-4 m^2 s^-1")}),setLazyConstant$1(r,"rydberg",function(){return i("10973731.56853955 m^-1")}),setLazyConstant$1(r,"thomsonCrossSection",function(){return i("6.65245873413e-29 m^2")}),setLazyConstant$1(r,"weakMixingAngle",function(){return .222321}),setLazyConstant$1(r,"efimovFactor",function(){return 22.7}),setLazyConstant$1(r,"atomicMass",function(){return i("1.66053892173e-27 kg")}),setLazyConstant$1(r,"avogadro",function(){return i("6.0221412927e23 mol^-1")}),setLazyConstant$1(r,"boltzmann",function(){return i("1.380648813e-23 J K^-1")}),setLazyConstant$1(r,"faraday",function(){return i("96485.336521 C mol^-1")}),setLazyConstant$1(r,"firstRadiation",function(){return i("3.7417715317e-16 W m^2")}),setLazyConstant$1(r,"loschmidt",function(){return i("2.686780524e25 m^-3")}),setLazyConstant$1(r,"gasConstant",function(){return i("8.314462175 J K^-1 mol^-1")}),setLazyConstant$1(r,"molarPlanckConstant",function(){return i("3.990312717628e-10 J s mol^-1")}),setLazyConstant$1(r,"molarVolume",function(){return i("2.241396820e-10 m^3 mol^-1")}),setLazyConstant$1(r,"sackurTetrode",function(){return-1.164870823}),setLazyConstant$1(r,"secondRadiation",function(){return i("1.438777013e-2 m K")}),setLazyConstant$1(r,"stefanBoltzmann",function(){return i("5.67037321e-8 W m^-2 K^-4")}),setLazyConstant$1(r,"wienDisplacement",function(){return i("2.897772126e-3 m K")}),setLazyConstant$1(r,"molarMass",function(){return i("1e-3 kg mol^-1")}),setLazyConstant$1(r,"molarMassC12",function(){return i("1.2e-2 kg mol^-1")}),setLazyConstant$1(r,"gravity",function(){return i("9.80665 m s^-2")}),setLazyConstant$1(r,"planckLength",function(){return i("1.61619997e-35 m")}),setLazyConstant$1(r,"planckMass",function(){return i("2.1765113e-8 kg")}),setLazyConstant$1(r,"planckTime",function(){return i("5.3910632e-44 s")}),setLazyConstant$1(r,"planckCharge",function(){return i("1.87554595641e-18 C")}),setLazyConstant$1(r,"planckTemperature",function(){return i("1.41683385e+32 K")})}function setLazyConstant$1(l,t,e){lazy$5(l,t,e),lazy$5(l.expression.mathWithTransform,t,e)}var factory_1$281=factory$282,lazy_1$2=!1,math$21=!0,physicalConstants={factory:factory_1$281,lazy:lazy_1$2,math:math$21},unit$3=[Unit,unit$2,createUnit$1,splitUnit$1,physicalConstants],type$1=[bignumber$1,boolean_1,chain$1,complex$3,fraction$3,matrix$1,number$3,resultset,string$6,unit$3],version$1="4.4.2";function factory$283(l,t,e,n,r){r.on("config",function(i,a){i.number!==a.number&&factory$283(l,t,e,n,r)}),setConstant$1(r,"true",!0),setConstant$1(r,"false",!1),setConstant$1(r,"null",null),setConstant$1(r,"uninitialized","Error: Constant uninitialized is removed since v4.0.0. Use null instead"),t.number==="BigNumber"?(setConstant$1(r,"Infinity",new l.BigNumber(Infinity)),setConstant$1(r,"NaN",new l.BigNumber(NaN)),setLazyConstant$2(r,"pi",function(){return constants.pi(l.BigNumber)}),setLazyConstant$2(r,"tau",function(){return constants.tau(l.BigNumber)}),setLazyConstant$2(r,"e",function(){return constants.e(l.BigNumber)}),setLazyConstant$2(r,"phi",function(){return constants.phi(l.BigNumber)}),setLazyConstant$2(r,"E",function(){return r.e}),setLazyConstant$2(r,"LN2",function(){return new l.BigNumber(2).ln()}),setLazyConstant$2(r,"LN10",function(){return new l.BigNumber(10).ln()}),setLazyConstant$2(r,"LOG2E",function(){return new l.BigNumber(1).div(new l.BigNumber(2).ln())}),setLazyConstant$2(r,"LOG10E",function(){return new l.BigNumber(1).div(new l.BigNumber(10).ln())}),setLazyConstant$2(r,"PI",function(){return r.pi}),setLazyConstant$2(r,"SQRT1_2",function(){return new l.BigNumber("0.5").sqrt()}),setLazyConstant$2(r,"SQRT2",function(){return new l.BigNumber(2).sqrt()})):(setConstant$1(r,"Infinity",Infinity),setConstant$1(r,"NaN",NaN),setConstant$1(r,"pi",Math.PI),setConstant$1(r,"tau",Math.PI*2),setConstant$1(r,"e",Math.E),setConstant$1(r,"phi",1.618033988749895),setConstant$1(r,"E",r.e),setConstant$1(r,"LN2",Math.LN2),setConstant$1(r,"LN10",Math.LN10),setConstant$1(r,"LOG2E",Math.LOG2E),setConstant$1(r,"LOG10E",Math.LOG10E),setConstant$1(r,"PI",r.pi),setConstant$1(r,"SQRT1_2",Math.SQRT1_2),setConstant$1(r,"SQRT2",Math.SQRT2)),setConstant$1(r,"i",l.Complex.I),setConstant$1(r,"version",version$1)}function setConstant$1(l,t,e){l[t]=e,l.expression.mathWithTransform[t]=e}function setLazyConstant$2(l,t,e){object.lazy(l,t,e),object.lazy(l.expression.mathWithTransform,t,e)}var factory_1$282=factory$283,lazy$6=!1,math$22=!0,constants$2={factory:factory_1$282,lazy:lazy$6,math:math$22},lib$1=[type$1,constants$2,expression,_function$3,json,error];function create$3(l){var t=core$1.create(l);return t.create=create$3,t.import(lib$1),t}var mathjs=create$3(),node$1=mathjs.expression.node;let operators$2={"+":function(l){return new node$1.OperatorNode("+","add",l)},"*":function(l){return new node$1.OperatorNode("*","multiply",l)},"/":function(l){return new node$1.OperatorNode("/","divide",l)},"-":function(l){return new node$1.OperatorNode("-","unaryMinus",[l[0]])},"^":function(l){return new node$1.OperatorNode("^","pow",l)},vector:function(l){return new node$1.ArrayNode(l)},and:function(l){return new node$1.OperatorNode("and","and",l)},or:function(l){return new node$1.OperatorNode("or","or",l)},not:function(l){return new node$1.OperatorNode("not","not",[l[0]])},"<":function(l){return new node$1.OperatorNode("<","smaller",l)},">":function(l){return new node$1.OperatorNode(">","larger",l)},le:function(l){return new node$1.OperatorNode("<=","smallerEq",l)},ge:function(l){return new node$1.OperatorNode(">=","largerEq",l)},ne:function(l){return new node$1.OperatorNode("!=","unequal",l)}};class astToMathjs{constructor({mathjs:t=null}={}){t&&(node$1=t.expression.node)}convert(t){if(typeof t=="number")return Number.isFinite(t)?new node$1.ConstantNode(t):Number.isNaN(t)?new node$1.SymbolNode("NaN"):t<0?operators$2["-"]([new node$1.SymbolNode("Infinity")]):new node$1.SymbolNode("Infinity");if(typeof t=="string")return new node$1.SymbolNode(t);if(typeof t=="boolean")throw Error("no support for boolean");if(!Array.isArray(t))throw Error("Invalid ast");let e=t[0],n=t.slice(1);if(e==="apply"){if(typeof n[0]!="string")throw Error("Non string functions not implemented for conversion to mathjs");if(n[0]==="factorial")return new node$1.OperatorNode("!","factorial",[this.convert(n[1])]);let r=new node$1.SymbolNode(n[0]),i=n[1],a;return i[0]==="tuple"?a=i.slice(1).map(function(s,o){return this.convert(s)}.bind(this)):a=[this.convert(i)],new node$1.FunctionNode(r,a)}if(e==="lts"||e==="gts"){let r=n[0],i=n[1];if(r[0]!=="tuple"||i[0]!=="tuple")throw new Error("Badly formed ast");let a=r.slice(1).map(function(u,c){return this.convert(u)}.bind(this)),s=[];for(let u=1;u<r.length-1;u++)i[u]?e==="lts"?s.push(new node$1.OperatorNode("<","smaller",a.slice(u-1,u+1))):s.push(new node$1.OperatorNode(">","larger",a.slice(u-1,u+1))):e==="lts"?s.push(new node$1.OperatorNode("<=","smallerEq",a.slice(u-1,u+1))):s.push(new node$1.OperatorNode(">=","largerEq",a.slice(u-1,u+1)));let o=new node$1.OperatorNode("and","and",s.slice(0,2));for(let u=2;u<s.length;u++)o=new node$1.OperatorNode("and","and",[o,s[u]]);return o}if(e==="="){let r=n.map(function(s,o){return this.convert(s)}.bind(this)),i=[];for(let s=1;s<r.length;s++)i.push(new node$1.OperatorNode("==","equal",r.slice(s-1,s+1)));if(i.length===1)return i[0];let a=new node$1.OperatorNode("and","and",i.slice(0,2));for(let s=2;s<i.length;s++)a=new node$1.OperatorNode("and","and",[a,i[s]]);return a}if(e==="in"||e==="notin"||e==="ni"||e==="notni"){let r,i;if(e==="in"||e==="notin"?(r=n[0],i=n[1]):(r=n[1],i=n[0]),typeof r!="number"&&typeof r!="string")throw Error("Set membership non-string variables not implemented for conversion to mathjs");if(r=this.convert(r),i[0]!=="interval")throw Error("Set membership in non-intervals not implemented for conversion to mathjs");let a=i[1],s=i[2];if(a[0]!=="tuple"||s[0]!=="tuple")throw new Error("Badly formed ast");let o=this.convert(a[1]),u=this.convert(a[2]),c=[];s[1]?c.push(new node$1.OperatorNode(">=","largerEq",[r,o])):c.push(new node$1.OperatorNode(">","larger",[r,o])),s[2]?c.push(new node$1.OperatorNode("<=","smallerEq",[r,u])):c.push(new node$1.OperatorNode("<","smaller",[r,u]));let f=new node$1.OperatorNode("and","and",c);return(e==="notin"||e==="notni")&&(f=new node$1.OperatorNode("not","not",[f])),f}if(e==="subset"||e==="notsubset"||e==="superset"||e==="notsuperset"){let r,i;if(e==="subset"||e==="notsubset"?(i=n[0],r=n[1]):(i=n[1],r=n[0]),i[0]!=="interval"||r[0]!=="interval")throw Error("Set containment of non-intervals not implemented for conversion to mathjs");let a=i[1],s=i[2],o=r[1],u=r[2];if(a[0]!=="tuple"||s[0]!=="tuple"||o[0]!=="tuple"||u[0]!=="tuple")throw Error("Badly formed ast");let c=this.convert(a[1]),f=this.convert(a[2]),p=this.convert(o[1]),d=this.convert(o[2]),m=[];s[1]&&!u[1]?m.push(new node$1.OperatorNode(">","larger",[c,p])):m.push(new node$1.OperatorNode(">=","largerEq",[c,p])),s[2]&&!u[2]?m.push(new node$1.OperatorNode("<","smaller",[f,d])):m.push(new node$1.OperatorNode("<=","smallerEq",[f,d]));let v=new node$1.OperatorNode("and","and",m);return(e==="notsubset"||e==="notsuperset")&&(v=new node$1.OperatorNode("not","not",[v])),v}if(e==="matrix"){let r=n[0],i=r[1],a=r[2],s=n[1];if(!Number.isInteger(i)||!Number.isInteger(a))throw Error("Matrix must have integer dimensions");let o=[];for(let u=1;u<=i;u++){let c=[];for(let f=1;f<=a;f++)c.push(this.convert(s[u][f]));o.push(new node$1.ArrayNode(c))}return new node$1.ArrayNode(o)}if(e in operators$2)return operators$2[e](n.map(function(r,i){return this.convert(r)}.bind(this)));throw Error("Operator "+e+" not implemented for conversion to mathjs")}}var function_normalizations={ln:"log",arccos:"acos",arccosh:"acosh",arcsin:"asin",arcsinh:"asinh",arctan:"atan",arctanh:"atanh",arcsec:"asec",arcsech:"asech",arccsc:"acsc",arccsch:"acsch",arccot:"acot",arccoth:"acoth",cosec:"csc"};function normalize_function_names(l){var t=get_tree(l);if(!Array.isArray(t))return t;var e=t[0],n=t.slice(1);if(e==="apply"){if(n[0]==="sqrt")return["^",normalize_function_names(n[1]),.5];var r=normalize_function_names_sub(n[0]);r=["apply",r];var i=n.slice(1).map(function(a){return normalize_function_names(a)});return i.length>1?i=["tuple"].concat(i):i=i[0],r.push(i),r}return e==="^"&&n[0]==="e"&&math$19.define_e?["apply","exp",normalize_function_names(n[1])]:[e].concat(n.map(function(a){return normalize_function_names(a)}))}function normalize_function_names_sub(l){if(typeof l=="string")return l in function_normalizations?function_normalizations[l]:l;if(!Array.isArray(l))return l;var t=l[0],e=l.slice(1),n=[t].concat(e.map(function(r){return normalize_function_names_sub(r)}));return n}function normalize_applied_functions(l){var t=get_tree(l);if(!Array.isArray(t))return t;var e=t[0],n=t.slice(1);if(e==="apply"){let i=strip_function_names(n[0]),a=["apply",i.tree,n[1]];for(let s=0;s<i.n_primes;s++)a=["prime",a];return i.exponent!==void 0&&(a=["^",a,i.exponent]),a}var r=[e].concat(n.map(function(i,a){return normalize_applied_functions(i)}));return r}function strip_function_names(l){if(!Array.isArray(l))return{tree:l,n_primes:0};var t=l[0],e=l.slice(1);if(t==="^"){let n=strip_function_names(e[0]),r=normalize_applied_functions(e[1]);return n.exponent=r,n}if(t==="prime"){let n=strip_function_names(e[0]);return n.n_primes+=1,n}return{tree:normalize_applied_functions(l),n_primes:0}}function substitute_abs(l){var t=get_tree(l);if(!Array.isArray(t))return t;var e=t[0],n=t.slice(1);return e==="apply"&&n[0]==="abs"?["^",["^",substitute_abs(n[1]),2],.5]:[e].concat(n.map(function(r){return substitute_abs(r)}))}function constants_to_floats(l){var t=get_tree(l);if(!(math$19.define_e||math$19.define_pi))return t;if(typeof t=="string"){if(t==="e"){if(math$19.define_e)return math$19.e}else if(t==="pi"&&math$19.define_pi)return math$19.pi;return t}if(!Array.isArray(t))return t;let e=t[0],n=t.slice(1);return e==="^"&&n[0]==="e"?["^","e",constants_to_floats(n[1])]:[e,...n.map(constants_to_floats)]}var astToMathjs$1=new astToMathjs({mathjs:math$19});let f=function(l){var t=get_tree(l),e=factorial_to_gamma_function(astToMathjs$1.convert(normalize_function_names(normalize_applied_functions(t))));return e.eval.bind(e)},evaluate=function(l,t){return f(l)(t)},evaluate_to_constant=function(l){var t=get_tree(l);if(typeof t=="number")return t;if(typeof t=="string")return t==="pi"&&math$19.define_pi?Math.PI:t==="e"&&math$19.define_e?Math.E:t==="i"&&math$19.define_i?{re:0,im:1}:null;var e=null;try{var n=f(l);e=n()}catch(r){}return e};function factorial_to_gamma_function(l){var t=l.transform(function(e,n,r){if(e.isOperatorNode&&e.op==="!"&&e.fn==="factorial"){var i=[new math$19.expression.node.OperatorNode("+","add",[e.args[0],new math$19.expression.node.ConstantNode(1)])];return new math$19.expression.node.FunctionNode(new math$19.expression.node.SymbolNode("gamma"),i)}else return e});return t}var evaluation=Object.freeze({f,evaluate,evaluate_to_constant}),functions$1={C:{},R:{},nonzeroC:{},nonneg:{},pos:{}};functions$1.C.nonneg=["abs"],functions$1.C.nonzero=["exp"],functions$1.C.R=["abs","arg"],functions$1.C.C=["abs","arg","exp","sign","cos","cosh","sin","sinh","erf","sqrt","log","ln","log10"],functions$1.R.pos=["exp"],functions$1.R.nonneg=["abs","exp","arg"],functions$1.R.R=["abs","arg","exp","sign","cos","cosh","sin","sinh","erf"],functions$1.R.Z=["sign"],functions$1.nonzeroC.pos=["abs"],functions$1.nonneg.nonneg=["abs","exp","arg","sqrt","erf"],functions$1.nonzeroC.nonzero=["abs"],functions$1.nonneg.R=[...new Set(functions$1.R.R.concat(functions$1.nonneg.nonneg))],functions$1.pos.pos=["abs","exp","sqrt","erf"],functions$1.pos.nonneg=functions$1.pos.pos,functions$1.pos.nonzero=["abs","exp","sqrt","erf"],functions$1.pos.R=functions$1.nonneg.R.concat(["log","ln","log10"]);function negate_adjust(l,t){if(l)return!t;if(l===!1)return t}function narrow_assumptions(l,t){if(!Array.isArray(t))return[];var e=t[0],n=t.slice(1);if(e!=="and")return[];for(var r=[],i=0;i<n.length;i++)equal$2(n[i],l)||r.push(n[i]);return r.length===0?[]:r.legnth===1?r[0]:[e].concat(r)}function simple_assumption_combination(l,t,e){return l==="and"?t===void 0?e:e===void 0?t:t||e:t===void 0||e===void 0||t!==e?void 0:t}function is_integer_ast(l,t,e){if(typeof t!="object"&&(t=[]),e===void 0&&(e=t),typeof l=="number")return Number.isInteger(l);var n=evaluate_to_constant(l);if(n!==null)return Number.isInteger(n);if(typeof l=="string"){let r;if(Array.isArray(t)?r=t:r=t.get_assumptions(l),!Array.isArray(r))return;let i=r,a=r[0],s=r.slice(1),o=!1;for(;a==="not";){if(o=!o,r=s[0],!Array.isArray(r))return;a=r[0],s=r.slice(1)}if(a==="in"&&s[0]===l&&s[1]==="Z")return negate_adjust(!0,o);if(a==="notin"&&s[0]===l&&s[1]==="Z")return negate_adjust(!1,o);if(o===!1){if(a==="notin"&&(s[0]===l&&s[1]==="R"||s[0]===l&&s[1]==="C"))return!1}else if(a==="in"&&(s[0]===l&&s[1]==="R"||s[0]===l&&s[1]==="Z"))return!1;if(a==="="&&!o||a==="ne"&&o){let f=narrow_assumptions(i,e);if(s[0]===l)return is_integer_ast(s[1],f);if(s[1]===l)return is_integer_ast(s[0],f)}if(a!=="and"&&a!=="or"||o)return;s.length>2&&(r=unflattenRight(r),s=r.slice(1));let u=is_integer_ast(l,s[0],e),c=is_integer_ast(l,s[1],e);return simple_assumption_combination(a,u,c)}if(Array.isArray(l)){let r;Array.isArray(t)?r=t:r=t.get_assumptions([variables(l)]);let i=l[0],a=l.slice(1);if(i==="-")return is_integer_ast(a[0],r,e);if(i==="*")return a.every(function(o){return is_integer_ast(o,r,e)})?!0:void 0;if(i==="^"){let s=is_nonzero_ast(a[0],r,e);if(s){if(is_nonzero_ast(a[1],r,e)===!1)return!(a[0]===Infinity||a[0]===-Infinity)}else{if(Number.isNaN(a[0]))return!1;if(is_positive_ast(a[1],r,!0,e)){if(s===!1)return!0}else return}let o=is_integer_ast(a[0],r,e),u=is_integer_ast(a[1],r,e);return o&&(u&&is_positive_ast(a[1],r,!1,e)?!0:void 0)}if(i==="+"){let s=0;for(let o=0;o<a.length;o++){let u=is_integer_ast(a[o],r,e);if(u===!1){if(s>0)return;s+=1}if(u===void 0)return}return s===0}return i==="apply"?functions$1.C.Z&&functions$1.C.Z.includes(a[0])&&is_complex_ast(a[1],r,e)||functions$1.R.Z&&functions$1.R.Z.includes(a[0])&&is_real_ast(a[1],r,e)||functions$1.nonzeroC.Z&&functions$1.nonzeroC.Z.includes(a[0])&&is_nonzero_ast(a[1],r,e)&&is_complex_ast(a[1],r,e)||functions$1.nonneg.Z&&functions$1.nonneg.Z.includes(a[0])&&is_positive_ast(a[1],r,!1,e)||functions$1.pos.Z&&functions$1.pos.Z.includes(a[0])&&is_positive_ast(a[1],r,!0,e)?!0:void 0:i==="/"||i==="prime"?void 0:!1}return!1}function is_real_ast(l,t,e){if(typeof t!="object"&&(t=[]),e===void 0&&(e=t),typeof l=="number")return Number.isFinite(l);var n=evaluate_to_constant(l);if(n!==null)return typeof n=="number"?Number.isFinite(n):!1;if(typeof l=="string"){let r;if(Array.isArray(t)?r=t:r=t.get_assumptions(l),!Array.isArray(r))return;let i=r,a=r[0],s=r.slice(1),o=!1;for(;a==="not";){if(o=!o,r=s[0],!Array.isArray(r))return;a=r[0],s=r.slice(1)}if(a==="in"&&s[0]===l&&s[1]==="R")return negate_adjust(!0,o);if(a==="notin"&&s[0]===l&&s[1]==="R")return negate_adjust(!1,o);if(o===!1){if(a==="in"&&s[0]===l&&s[1]==="Z")return!0}else if(a==="notin"&&s[0]===l&&s[1]==="Z")return!0;if(a==="<"||a==="le"){let f=variables(r),p=functions(r);if(f.indexOf(l)!==-1&&p.length===0)return!0}if(a==="="&&!o||a==="ne"&&o){let f=narrow_assumptions(i,e);if(s[0]===l)return is_real_ast(s[1],f);if(s[1]===l)return is_real_ast(s[0],f)}if(a!=="and"&&a!=="or"||o)return;s.length>2&&(r=unflattenRight(r),s=r.slice(1));let u=is_real_ast(l,s[0],e),c=is_real_ast(l,s[1],e);return simple_assumption_combination(a,u,c)}if(Array.isArray(l)){let r;Array.isArray(t)?r=t:r=t.get_assumptions([variables(l)]);let i=l[0],a=l.slice(1);if(i==="-")return is_real_ast(a[0],r,e);if(i==="*"||i==="+"){if(a.length>2&&(l=unflattenRight(l),a=l.slice(1)),i==="*"&&(is_nonzero_ast(a[0],r,e)===!1||is_nonzero_ast(a[1],r,e)===!1))return!0;let s=is_real_ast(a[0],r,e),o=is_real_ast(a[1],r,e);return s&&o?!0:s&&o===!1||o&&s===!1?!1:void 0}if(i==="^"){let s=is_nonzero_ast(a[0],r,e),o=is_positive_ast(a[1],r,!0,e);if(s){if(is_nonzero_ast(a[1],r,e)===!1)return!(a[0]===Infinity||a[0]===-Infinity)}else{if(Number.isNaN(a[0]))return!1;if(o){if(s===!1)return!0}else return}let u=is_real_ast(a[0],r,e),c=is_real_ast(a[1],r,e);return u&&c?is_positive_ast(a[0],r,!1,e)?is_positive_ast(a[0],r,!0,e)||o?!0:void 0:is_integer_ast(a[1],r,e)?!0:void 0:void 0}return i==="/"?is_nonzero_ast(a[1],r,e)&&(is_nonzero_ast(a[0],r,e)===!1||is_real_ast(a[0],r,e)&&is_real_ast(a[1],r,e))?!0:void 0:i==="apply"?functions$1.C.R&&functions$1.C.R.includes(a[0])&&is_complex_ast(a[1],r,e)||functions$1.R.R&&functions$1.R.R.includes(a[0])&&is_real_ast(a[1],r,e)||functions$1.nonzeroC.R&&functions$1.nonzeroC.R.includes(a[0])&&is_nonzero_ast(a[1],r,e)&&is_complex_ast(a[1],r,e)||functions$1.nonneg.R&&functions$1.nonneg.R.includes(a[0])&&is_positive_ast(a[1],r,!1,e)||functions$1.pos.R&&functions$1.pos.R.includes(a[0])&&is_positive_ast(a[1],r,!0,e)?!0:void 0:i==="prime"?void 0:!1}return!1}function is_complex_ast(l,t,e){if(typeof t!="object"&&(t=[]),e===void 0&&(e=t),typeof l=="number")return Number.isFinite(l);var n=evaluate_to_constant(l);if(n!==null)return typeof n=="number"?Number.isFinite(n):!!(n.re!==void 0&&Number.isFinite(n.re)&&n.im!==void 0&&Number.isFinite(n.im));if(typeof l=="string"){let r;if(Array.isArray(t)?r=t:r=t.get_assumptions(l),!Array.isArray(r))return;let i=r,a=r[0],s=r.slice(1),o=!1;for(;a==="not";){if(o=!o,r=s[0],!Array.isArray(r))return;a=r[0],s=r.slice(1)}if(a==="in"&&s[0]===l&&s[1]==="C")return negate_adjust(!0,o);if(a==="notin"&&s[0]===l&&s[1]==="C")return negate_adjust(!1,o);if(o===!1){if(a==="in"&&(s[0]===l&&s[1]==="Z"||s[0]===l&&s[1]==="R"))return!0}else if(a==="notin"&&(s[0]===l&&s[1]==="Z"||s[0]===l&&s[1]==="R"))return!0;if(a==="<"||a==="le"){let f=variables(r),p=functions(r);if(f.indexOf(l)!==-1&&p.length===0)return!0}if(a==="="&&!o||a==="ne"&&o){let f=narrow_assumptions(i,e);if(s[0]===l)return is_complex_ast(s[1],f);if(s[1]===l)return is_complex_ast(s[0],f)}if(a!=="and"&&a!=="or"||o)return;s.length>2&&(r=unflattenRight(r),s=r.slice(1));let u=is_complex_ast(l,s[0],e),c=is_complex_ast(l,s[1],e);return simple_assumption_combination(a,u,c)}if(Array.isArray(l)){let r;Array.isArray(t)?r=t:r=t.get_assumptions([variables(l)]);let i=l[0],a=l.slice(1);if(i==="-")return is_complex_ast(a[0],r,e);if(i==="*"||i==="+")return i==="*"&&!a.every(o=>is_nonzero_ast(o,r,e)!==!1)||a.every(o=>is_complex_ast(o,r,e))?!0:void 0;if(i==="^"){let s=is_nonzero_ast(a[0],r,e),o=is_positive_ast(a[1],r,!0,e);if(s){if(is_nonzero_ast(a[1],r,e)===!1)return!(a[0]===Infinity||a[0]===-Infinity)}else{if(Number.isNaN(a[0]))return!1;if(o){if(s===!1)return!0}else return}let u=is_complex_ast(a[0],r,e),c=is_complex_ast(a[1],r,e);return u&&c?!0:void 0}return i==="/"?is_nonzero_ast(a[1],r,e)&&(is_nonzero_ast(a[0],r,e)===!1||is_complex_ast(a[0],r,e)&&is_complex_ast(a[1],r,e))?!0:void 0:i==="apply"?functions$1.C.C&&functions$1.C.C.includes(a[0])&&is_complex_ast(a[1],r,e)||functions$1.R.C&&functions$1.R.C.includes(a[0])&&is_real_ast(a[1],r,e)||functions$1.nonzeroC.C&&functions$1.nonzeroC.C.includes(a[0])&&is_nonzero_ast(a[1],r,e)&&is_complex_ast(a[1],r,e)||functions$1.nonneg.C&&functions$1.nonneg.C.includes(a[0])&&is_positive_ast(a[1],r,!1,e)||functions$1.pos.C&&functions$1.pos.C.includes(a[0])&&is_positive_ast(a[1],r,!0,e)?!0:void 0:i==="prime"?void 0:!1}return!1}function is_nonzero_ast(l,t,e){if(typeof t!="object"&&(t=[]),e===void 0&&(e=t),typeof l=="number")return Number.isFinite(l)?l!==0:Number.isNaN(l)?void 0:!0;var n=evaluate_to_constant(l);if(n!==null)return typeof n=="number"?Number.isFinite(n)?n!==0:Number.isNaN(n)?void 0:!0:n.re!==void 0&&n.im!==void 0&&(n.re!==0||n.im!==0)?!0:void 0;if(typeof l=="string"){let r;if(Array.isArray(t)?r=t:r=t.get_assumptions(l),!Array.isArray(r))return;let i=r,a=r[0],s=r.slice(1),o=!1;for(;a==="not";){if(o=!o,r=s[0],!Array.isArray(r))return;a=r[0],s=r.slice(1)}let u=narrow_assumptions(i,e);if(a==="="&&!o||a==="ne"&&o){if(s[0]===l)return is_nonzero_ast(s[1],u);if(s[1]===l)return is_nonzero_ast(s[0],u)}if((a==="ne"&&!o||a==="="&&o)&&(s[0]===l&&is_nonzero_ast(s[1],u)===!1||s[1]===l&&is_nonzero_ast(s[0],u)===!1))return!0;if(a==="<"){if(o){if(s[0]===l&&is_positive_ast(s[1],u,!0)||s[1]===l&&is_negative_ast(s[0],u,!0))return!0}else if(s[0]===l&&is_negative_ast(s[1],u,!1)||s[1]===l&&is_positive_ast(s[0],u,!1))return!0}if(a==="le"){if(o){if(s[0]===l&&is_positive_ast(s[1],u,!1)||s[1]===l&&is_negative_ast(s[0],u,!1))return!0}else if(s[0]===l&&is_negative_ast(s[1],u,!0)||s[1]===l&&is_positive_ast(s[0],u,!0))return!0}if(a!=="and"&&a!=="or"||o)return;s.length>2&&(r=unflattenRight(r),s=r.slice(1));let c=is_nonzero_ast(l,s[0],e),f=is_nonzero_ast(l,s[1],e);return simple_assumption_combination(a,c,f)}if(Array.isArray(l)){let r;Array.isArray(t)?r=t:r=t.get_assumptions([variables(l)]);let i=l[0],a=l.slice(1);if(i==="-")return is_nonzero_ast(a[0],r,e);if(i==="+"){if(a.length>2&&(l=unflattenRight(l),a=l.slice(1)),equal$2(a[0],simplify$2(["-",a[1]],e)))return!1;let s=is_nonzero_ast(a[0],r,e),o=is_nonzero_ast(a[1],r,e);if(s===!1)return o;if(o===!1)return s;let u=is_real_ast(a[0],r,e),c=is_real_ast(a[1],r,e);if(!u||!c)return u===!0?c===!1?!0:void 0:c===!0&&u===!1?!0:void 0;let f=is_positive_ast(a[0],r,!1,e),p=is_positive_ast(a[1],r,!1,e),d=is_positive_ast(a[0],r,!0,e),m=is_positive_ast(a[1],r,!0,e);return f&&m||d&&p||f===!1&&m===!1||d===!1&&p===!1?!0:void 0}if(i==="*"){let s=!0;for(let o=0;o<a.length;o++){let u=is_nonzero_ast(a[o],r,e);if(u===!1)return!1;u===void 0&&(s=!1)}return s?!0:void 0}if(i==="/"){let s=is_nonzero_ast(a[0],r,e);return is_nonzero_ast(a[1],r,e)?s:void 0}if(i==="^"){let s=is_nonzero_ast(a[0],r,e);return s?(a[0]===Infinity||a[0]===-Infinity)&&is_nonzero_ast(a[1],r,e)===!1?void 0:!0:is_positive_ast(a[1],r,!0,e)&&s===!1?!1:void 0}return i==="apply"?functions$1.C.nonzero&&functions$1.C.nonzero.includes(a[0])&&is_complex_ast(a[1],r,e)||functions$1.R.nonzero&&functions$1.R.nonzero.includes(a[0])&&is_real_ast(a[1],r,e)||functions$1.nonzeroC.nonzero&&functions$1.nonzeroC.nonzero.includes(a[0])&&is_nonzero_ast(a[1],r,e)&&is_complex_ast(a[1],r,e)||functions$1.nonneg.nonzero&&functions$1.nonneg.nonzero.includes(a[0])&&is_positive_ast(a[1],r,!1,e)||functions$1.pos.nonzero&&functions$1.pos.nonzero.includes(a[0])&&is_positive_ast(a[1],r,!0,e)?!0:void 0:i==="prime"?void 0:!1}return!1}function is_positive_ast(l,t,e,n){if(typeof t!="object"&&(t=[]),n===void 0&&(n=t),e===void 0&&(e=!0),typeof l=="number")return Number.isFinite(l)?e?l>0:l>=0:!1;var r=is_real_ast(l,t,n);if(!r)return r;var i=evaluate_to_constant(l);if(i!==null)return typeof i=="number"&&Number.isFinite(i)?e?i>0:i>=0:!1;if(typeof l=="string"){let a;if(Array.isArray(t)?a=t:a=t.get_assumptions(l),!Array.isArray(a))return;let s=a,o=a[0],u=a.slice(1),c=!1;for(;o==="not";){if(c=!c,a=u[0],!Array.isArray(a))return;o=a[0],u=a.slice(1)}let f=narrow_assumptions(s,n);if(o==="="&&!c||o==="ne"&&c){if(u[0]===l)return is_positive_ast(u[1],f,e);if(u[1]===l)return is_positive_ast(u[0],f,e)}if(o==="<")if(c){if(u[0]===l&&is_positive_ast(u[1],f,e))return!0;if(u[1]===l&&is_negative_ast(u[0],f,!e))return!1}else{if(u[0]===l&&is_negative_ast(u[1],f,!1))return!1;if(u[1]===l&&is_positive_ast(u[0],f,!1))return!0}if(o==="le")if(c){if(u[0]===l&&is_positive_ast(u[1],f,!1))return!0;if(u[1]===l&&is_negative_ast(u[0],f,!1))return!1}else{if(u[0]===l&&is_negative_ast(u[1],f,!e))return!1;if(u[1]===l&&is_positive_ast(u[0],f,e))return!0}if(o!=="and"&&o!=="or"||c)return;u.length>2&&(a=unflattenRight(a),u=a.slice(1));let p=is_positive_ast(l,u[0],e,n),d=is_positive_ast(l,u[1],e,n);return simple_assumption_combination(o,p,d)}if(Array.isArray(l)){let a;Array.isArray(t)?a=t:a=t.get_assumptions([variables(l)]);let s=l[0],o=l.slice(1);if(s==="-")return is_negative_ast(o[0],a,e,n);if(s==="+"){o.length>2&&(l=unflattenRight(l),o=l.slice(1));let u=is_positive_ast(o[0],a,!1,n),c=is_positive_ast(o[1],a,!1,n),f=is_positive_ast(o[0],a,!0,n),p=is_positive_ast(o[1],a,!0,n);if(e){if(u&&p||f&&c)return!0}else if(u&&c)return!0;if(e){if(f===!1&&p===!1)return!1}else if(u===!1&&p===!1||f===!1&&c===!1)return!1;return}if(s==="*"){if(!o.every(v=>is_nonzero_ast(v,a,n)!==!1))return!e;o.length>2&&(l=unflattenRight(l),o=l.slice(1));let u=is_real_ast(o[0],a,n),c=is_real_ast(o[1],a,n);if(u===void 0||c===void 0)return;if(u===!1)return c===!1?void 0:!1;if(c===!1)return!1;let f=is_positive_ast(o[0],a,!1,n),p=is_positive_ast(o[1],a,!1,n),d=is_positive_ast(o[0],a,!0,n),m=is_positive_ast(o[1],a,!0,n);if(e){if(d&&m||f===!1&&p===!1)return!0;if(d===!1&&p||f&&m===!1)return!1}else{if(f&&p||d===!1&&m===!1)return!0;if(d&&p===!1||f===!1&&m)return!1}return}if(s==="/"){if(!is_nonzero_ast(o[1],a,n))return;if(is_nonzero_ast(o[0],a,n)===!1)return!e;let u=is_positive_ast(o[1],a,!0,n);if(u===void 0)return;let c=u?e:!e,f=is_positive_ast(o[0],a,c,n);return f===void 0?void 0:f===!0?u===!0:u!==!0}if(s==="^"){let u=is_nonzero_ast(o[0],a,n);if(u){if(is_nonzero_ast(o[1],a,n)===!1)return o[0]===Infinity||o[0]===-Infinity?void 0:!0}else if(is_positive_ast(o[1],a,!0,n)){if(u===!1)return!e;if(e)return}else return;if(is_real_ast(o[0],a,n)!==!0)return;if(!is_positive_ast(o[0],a,e,n)){let d=simplify$2(["/",o[1],2],n);return is_integer_ast(d,a,n)?!0:void 0}return is_real_ast(o[1],a,n)?!0:void 0}return s==="apply"&&!e?functions$1.C.nonneg&&functions$1.C.nonneg.includes(o[0])&&is_complex_ast(o[1],a,n)||functions$1.R.nonneg&&functions$1.R.nonneg.includes(o[0])&&is_real_ast(o[1],a,n)||functions$1.nonzeroC.nonneg&&functions$1.nonzeroC.nonneg.includes(o[0])&&is_nonzero_ast(o[1],a,n)&&is_complex_ast(o[1],a,n)||functions$1.nonneg.nonneg&&functions$1.nonneg.nonneg.includes(o[0])&&is_positive_ast(o[1],a,!1,n)||functions$1.pos.nonneg&&functions$1.pos.nonneg.includes(o[0])&&is_positive_ast(o[1],a,!0,n)?!0:void 0:s==="apply"&&e?functions$1.C.pos&&functions$1.C.pos.includes(o[0])&&is_complex_ast(o[1],a,n)||functions$1.R.pos&&functions$1.R.pos.includes(o[0])&&is_real_ast(o[1],a,n)||functions$1.nonzeroC.pos&&functions$1.nonzeroC.pos.includes(o[0])&&is_nonzero_ast(o[1],a,n)&&is_complex_ast(o[1],a,n)||functions$1.nonneg.pos&&functions$1.nonneg.pos.includes(o[0])&&is_positive_ast(o[1],a,!1,n)||functions$1.pos.pos&&functions$1.pos.pos.includes(o[0])&&is_positive_ast(o[1],a,!0,n)?!0:void 0:s==="prime"?void 0:!1}return!1}function is_negative_ast(l,t,e,n){e===void 0&&(e=!0);var r=is_real_ast(l,t,n);if(r===!0){let i=is_positive_ast(l,t,!e,n);return i===!1?!0:i===!0?!1:void 0}return r}function clean(l){var t=get_tree(l);return flatten(t)}function evalf(l,t){return parseFloat(number_8(l,t))}function collapse_unary_minus(l){var t=get_tree(l);if(!Array.isArray(t))return t;var e=t[0],n=t.slice(1);if(n=n.map(r=>collapse_unary_minus(r)),e==="-"){if(typeof n[0]=="number")return-n[0];if(Array.isArray(n[0])&&n[0][0]==="*"&&typeof n[0][1]=="number")return["*",-n[0][1]].concat(n[0].slice(2));if(Array.isArray(n[0])&&n[0][0]==="/"){if(typeof n[0][1]=="number")return["/",-n[0][1],n[0][2]];if(Array.isArray(n[0][1])&&n[0][1][0]==="*"&&typeof n[0][1][1]=="number")return["/",["*",-n[0][1][1]].concat(n[0][1].slice(2)),n[0][2]]}}return[e].concat(n)}function simplify$2(l,t,e){var n=get_tree(l);return t===void 0&&l.context!==void 0&&l.context.get_assumptions!==void 0&&(t=l.context.get_assumptions([l.variables()])),n=evaluate_numbers(n,{assumptions:t,max_digits:e,evaluate_functions:!0}),Array.isArray(n)&&(n=simplify_logical(n,t),n=collect_like_terms_factors(n,t,e)),n}function simplify_logical(l,t){var e=get_tree(l);t===void 0&&l.context!==void 0&&l.context.get_assumptions!==void 0&&(t=l.context.get_assumptions([l.variables()])),e=evaluate_numbers(e,{assumptions:t}),e=unflattenRight(e);var n=[];return n.push([["not",["not","a"]],"a"]),n.push([["not",["and","a","b"]],["or",["not","a"],["not","b"]]]),n.push([["not",["or","a","b"]],["and",["not","a"],["not","b"]]]),n.push([["not",["=","a","b"]],["ne","a","b"]]),n.push([["not",["ne","a","b"]],["=","a","b"]]),n.push([["not",["<","a","b"]],["le","b","a"]]),n.push([["not",["le","a","b"]],["not",["le","a","b"]]]),n.push([["not",["in","a","b"]],["notin","a","b"]]),n.push([["not",["subset","a","b"]],["notsubset","a","b"]]),e=applyAllTransformations(e,n,20),e=flatten(e),e}function contains_decimal_number(l){return typeof l=="string"?!1:typeof l=="number"?!!(Number.isFinite(l)&&!Number.isInteger(l)):Array.isArray(l)?l.slice(1).some(t=>contains_decimal_number(t)):!1}function contains_only_numbers(l,{include_number_symbols:t=!1}={}){return typeof l=="string"?!!(t&&(l==="e"&&math$19.define_e||l==="pi"&&math$19.define_pi)):typeof l=="number"?!0:Array.isArray(l)?l.slice(1).every(e=>contains_only_numbers(e,{include_number_symbols:t})):!1}function evaluate_numbers_sub(l,t,e,n,r,i){if(l===void 0)return l;if(typeof l=="number")return i>0&&math$19.abs(l)<i||l===0?0:l;if(r||contains_only_numbers(l,{include_number_symbols:!0})){var a=evaluate_to_constant(l);if(a!==null&&typeof a=="number"&&Number.isFinite(a)){if(i>0&&math$19.abs(a)<i)return 0;if(e===Infinity)return a;if(Number.isInteger(a))return a===0?0:a;let u=evalf(a,14),c=evalf(a,e);if(e===0&&(c=math$19.round(a)),c===u||contains_decimal_number(l)&&contains_only_numbers(l))return a;let f=math$19.fraction(a),p=evalf(f.d,3);if((f.n<1e4||p===f.d)&&evalf(f.s*f.n/f.d,14)===u)return f.d===1?f.s*f.n:["/",f.s*f.n,f.d]}}if(!Array.isArray(l))return l;var s=l[0],o=l.slice(1).map(u=>evaluate_numbers_sub(u,t,e,n,r,i));if(s==="+"){let u=o[0],c=o[1];if(c===void 0)return u;if(typeof u=="number"){if(u===0)return c;if(typeof c=="number")return u+c;if(Array.isArray(c)&&c[0]==="+"&&typeof c[1]=="number")return["+",u+c[1],c[2]];if(!n&&Array.isArray(c)&&c[0]==="+"&&typeof c[2]=="number")return["+",u+c[2],c[1]]}return typeof c=="number"&&c===0?u:[s].concat(o)}if(s==="-"){if(typeof o[0]=="number")return-o[0];if(Array.isArray(o[0])&&o[0][0]==="*"&&typeof o[0][1]=="number")return["*",-o[0][1]].concat(o[0].slice(2));if(Array.isArray(o[0])&&o[0][0]==="/"){if(typeof o[0][1]=="number")return["/",-o[0][1],o[0][2]];if(Array.isArray(o[0][1])&&o[0][1][0]==="*"&&typeof o[0][1][1]=="number")return["/",["*",-o[0][1][1]].concat(o[0][1].slice(2)),o[0][2]]}return[s].concat(o)}if(s==="*"){let u=o[0],c=o[1];if(c===void 0)return u;if(typeof u=="number"){if(isNaN(u))return NaN;if(typeof c=="number")return u*c;if(!isFinite(u))return u===Infinity&&is_negative_ast(c)||u===-Infinity&&is_positive_ast(c)?-Infinity:is_nonzero_ast(c)===!1?NaN:Infinity;if(u===0)return 0;if(u===1)return c;if(u===-1)return["-",c];if(Array.isArray(c)&&c[0]==="*"&&typeof c[1]=="number")return u=u*c[1],c=c[2],u===1?c:u===-1?["-",c]:["*",u,c]}if(typeof c=="number"){if(isNaN(c))return NaN;if(!isFinite(c))return c===Infinity&&is_negative_ast(u)||c===-Infinity&&is_positive_ast(u)?-Infinity:is_nonzero_ast(u)===!1?NaN:Infinity;if(c===0)return 0;if(c===1)return u;if(c===-1)return["-",u];if(Array.isArray(u)&&u[0]==="*"&&typeof u[1]=="number")return c=c*u[1],u=u[2],c===1?u:c===-1?["-",u]:["*",u,c]}return[s].concat(o)}if(s==="/"){let u=o[0],c=o[1];if(typeof u=="number"){if(u===0){let f=is_nonzero_ast(c,t);if(f)return 0;if(f===!1)return NaN}if(typeof c=="number"){let f=u/c;if(e===Infinity||math$19.round(f,e)===f)return f;if(c<0)return["/",-u,-c]}if(Array.isArray(c)&&c[0]==="*"&&typeof c[1]=="number"){let f=u/c[1];if(e===Infinity||math$19.round(f,e)===f)return["/",f,c[2]]}}else if(typeof c=="number"){if(Array.isArray(u)&&u[0]==="*"&&typeof u[1]=="number"){let p=u[1]/c;if(e===Infinity||math$19.round(p,e)===p)return p===1?u[2]:["*",p,u[2]];if(c<0)return["/",["*",-u[1],u[2]],-c]}let f=1/c;if(e===Infinity||math$19.round(f,e)===f)return["*",f,u];if(c<0)return Array.isArray(u)&&u[0]==="-"?["/",u[1],-c]:["-",["/",u,-c]]}return[s].concat(o)}if(s==="^"){let u=o[0],c=o[1];if(typeof c=="number")if(c===0){if(!math$19.pow_strict)return 1;let f=is_nonzero_ast(u,t);if(f&&u!==Infinity&&u!==-Infinity)return 1;if(f===!1)return NaN}else{if(c===1)return u;if(typeof u=="number"){let f=math$19.pow(u,c);if(e===Infinity||math$19.round(f,e)===f)return f}}else if(u===1)return 1;return[s].concat(o)}return[s].concat(o)}function evaluate_numbers(l,{assumptions:t,max_digits:e,skip_ordering:n=!1,evaluate_functions:r=!1,set_small_zero:i=0}={}){(e===void 0||!(Number.isInteger(e)||e===Infinity))&&(e=0),i===!0&&(i=1e-14);var a=get_tree(l);t===void 0&&l.context!==void 0&&l.context.get_assumptions!==void 0&&(t=l.context.get_assumptions([l.variables()]));var s;return n?(a=unflattenRight(flatten(a)),s=evaluate_numbers_sub(a,t,e,n,r,i)):(a=unflattenRight(default_order(flatten(a))),s=default_order(evaluate_numbers_sub(a,t,e,n,r,i)),s=default_order(evaluate_numbers_sub(unflattenRight(s),t,e,n,r,i))),flatten(s)}function collect_like_terms_factors(l,t,e){function n(o){return!!(typeof o=="number"||Array.isArray(o)&&o[0]==="-"&&typeof o[1]=="number")}function r(o){return!!(typeof o=="number"&&o<0||Array.isArray(o)&&o[0]==="-"&&typeof o[1]=="number")}function i(o){if(typeof o=="number"||Array.isArray(o)&&o[0]==="-"&&typeof o[1]=="number")return!0;let u=evaluate_to_constant(o);return!!(typeof u=="number"&&Number.isFinite(u))}var a=get_tree(l);t===void 0&&l.context!==void 0&&l.context.get_assumptions!==void 0&&(t=l.context.get_assumptions([l.variables()])),a=evaluate_numbers(a,{assumptions:t,max_digits:e,evaluate_functions:!0});var s=[];return s.push([["/","x",["^","y","a"]],["*","x",["^","y",["-","a"]]],{evaluate_numbers:!0,max_digits:e}]),s.push([["/","x","y"],["*","x",["^","y",["-",1]]],{evaluate_numbers:!0,max_digits:e}]),a=applyAllTransformations(a,s,40),s=[],s.push([["*",["^","x","n"],["^","x","m"]],["^","x",["+","n","m"]],{variables:{x:o=>is_nonzero_ast(o,t),n,m:n},evaluate_numbers:!0,max_digits:e,allow_implicit_identities:["m","n"],allow_extended_match:!0,allow_permutations:!0,max_group:1}]),s.push([["*",["^","x","n"],["^","x","m"]],["^","x",["+","n","m"]],{variables:{x:!0,n:o=>n(o)&&is_positive_ast(o,t),m:o=>n(o)&&is_positive_ast(o,t)},evaluate_numbers:!0,max_digits:e,allow_implicit_identities:["m","n"],allow_extended_match:!0,allow_permutations:!0,max_group:1}]),s.push([["*",["^","x","n"],["^","x","m"]],["^","x",["+","n","m"]],{variables:{x:!0,n:o=>n(o)&&is_negative_ast(o,t),m:o=>n(o)&&is_negative_ast(o,t)},evaluate_numbers:!0,max_digits:e,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),s.push([["+",["*","n","x"],["*","m","x"]],["*",["+","n","m"],"x"],{variables:{x:!0,n,m:n},evaluate_numbers:!0,max_digits:e,allow_implicit_identities:["m","n"],allow_extended_match:!0,allow_permutations:!0,max_group:1}]),s.push([["+",["*","n","x"],["-",["*","m","x"]]],["*",["+","n",["-","m"]],"x"],{variables:{x:!0,n,m:n},evaluate_numbers:!0,max_digits:e,allow_implicit_identities:["m","n"],allow_extended_match:!0,allow_permutations:!0,max_group:1}]),s.push([["^",["*","x","y"],"a"],["*",["^","x","a"],["^","y","a"]],{allow_permutations:!0}]),s.push([["^",["^","x","n"],"m"],["^","x",["*","n","m"]],{variables:{x:!0,n,m:n},evaluate_numbers:!0,max_digits:e,allow_permutations:!0}]),s.push([["-",["+","a","b"]],["+",["-","a"],["-","b"]]]),s.push([["*","x","y"],["*","x","y"],{variables:{x:i,y:i},evaluate_numbers:!0,max_digits:e,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),a=applyAllTransformations(a,s,40),s=[],s.push([["*","x",["^","y",["-","a"]]],["/","x",["^","y","a"]],{allow_extended_match:!0,allow_permutations:!0,evaluate_numbers:!0,max_digits:e,max_group:1}]),s.push([["*","x",["^","y","n"]],["/","x",["^","y",["-","n"]]],{variables:{x:!0,y:!0,n:r},evaluate_numbers:!0,max_digits:e,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),a=applyAllTransformations(a,s,40),s=[],s.push([["^","y","n"],["/",1,["^","y",["-","n"]]],{variables:{y:!0,n:r},evaluate_numbers:!0,max_digits:e}]),a=applyAllTransformations(a,s,40),s=[],s.push([["*","x",["/","y","z"]],["/",["*","x","y"],"z"],{allow_extended_match:!0,allow_permutations:!0,max_group:1}]),s.push([["/",["/","x","y"],"z"],["/","x",["*","y","z"]],{allow_extended_match:!0,allow_permutations:!0}]),s.push([["/","x",["/","y","z"]],["/",["*","x","z"],"y"],{allow_extended_match:!0,allow_permutations:!0}]),a=applyAllTransformations(a,s,40),a=evaluate_numbers(a,{assumptions:t,max_digits:e}),a}function simplify_ratios(l,t){function e(i){var a=1;return i=i.map(function(s){if(typeof s=="number")return s<0?(a*=-1,-s):s;if(!Array.isArray(s))return s;if(s[0]==="-")return a*=-1,s[1];if(s[0]!=="+")return s;var o=!1;if((typeof s[1]=="number"&&s[1]<0||Array.isArray(s[1])&&s[1][0]==="-"||Array.isArray(s[1])&&s[1][0]==="*"&&Number(s[1][1])<0)&&(o=!0),o){a*=-1;var u=s.slice(1).map(c=>["-",c]);return evaluate_numbers(["+"].concat(u))}else return s}),{factors:i,sign_change:a}}function n(i,a){if(!Array.isArray(i))return a?["-",i]:i;var s=i[0];if(s==="-")return n(i[1],a=!0);var o=i.slice(1).map(v=>n(v));if(s!=="/")return a?["-",[s,...o]]:[s,...o];var u=o[0],c=o[1];u=default_order(u,{ignore_negatives:!0});var f;Array.isArray(u)&&u[0]==="*"?f=u.slice(1):f=[u];var p=e(f);f=p.factors,a&&(p.sign_change*=-1),c=default_order(c,{ignore_negatives:!0});var d;Array.isArray(c)&&c[0]==="*"?d=c.slice(1):d=[c];var m=e(d);return d=m.factors,p.sign_change*m.sign_change<0&&(f[0]=["-",f[0]]),f.length===1?u=f[0]:u=["*"].concat(f),d.length===1?c=d[0]:c=["*"].concat(d),["/",u,c]}var r=get_tree(l);return t===void 0&&l.context!==void 0&&l.context.get_assumptions!==void 0&&(t=l.context.get_assumptions([l.variables()])),n(r)}var simplify$3=Object.freeze({clean,simplify:simplify$2,simplify_logical,evaluate_numbers,collect_like_terms_factors,collapse_unary_minus,simplify_ratios,default_order});function tuples_to_vectors(l){var t=get_tree(l);if(typeof t=="number"||typeof t=="string"||typeof t=="boolean")return t;var e=t[0],n=t.slice(1);if(e==="tuple")return["vector"].concat(n.map(function(a,s){return tuples_to_vectors(a)}));if(e==="apply"){if(n[1][0]==="tuple"){let i=tuples_to_vectors(n[0]),a=n[1].slice(1),s=["tuple"].concat(a.map(function(o,u){return tuples_to_vectors(o)}));return["apply",i,s]}}else if(e==="gts"||e==="lts"||e==="interval"){let i=n[0],a=n[1];if(i[0]!=="tuple"||a[0]!=="tuple")throw new Error("Badly formed ast");let s=["tuple"].concat(i.slice(1).map(function(o,u){return tuples_to_vectors(o)}));return[e,s,a]}var r=[e].concat(n.map(function(i,a){return tuples_to_vectors(i)}));return r}function to_intervals(l){var t=get_tree(l);if(typeof t=="number"||typeof t=="string"||typeof t=="boolean")return t;var e=t[0],n=t.slice(1);if(e==="tuple"&&n.length===2){let i=["tuple"].concat(n.map(function(a,s){return to_intervals(a)}));return i=["interval",i,["tuple",!1,!1]],i}if(e==="array"&&n.length===2){let i=["tuple"].concat(n.map(function(a,s){return to_intervals(a)}));return i=["interval",i,["tuple",!0,!0]],i}if(e==="apply"){if(n[1][0]==="tuple"){let i=to_intervals(n[0]),a=n[1].slice(1),s=["tuple"].concat(a.map(function(o,u){return to_intervals(o)}));return["apply",i,s]}}else if(e==="gts"||e==="lts"||e==="interval"){let i=n[0],a=n[1];if(i[0]!=="tuple"||a[0]!=="tuple")throw new Error("Badly formed ast");let s=["tuple"].concat(i.slice(1).map(function(o,u){return to_intervals(o)}));return[e,s,a]}var r=[e].concat(n.map(function(i,a){return to_intervals(i)}));return r}function ParseError(l,t){this.name="ParseError",this.message=l||"Error parsing input",this.stack=new Error().stack,this.location=t}ParseError.prototype=Object.create(Error.prototype),ParseError.prototype.constructor=ParseError;class lexer{constructor(t,e="\\s"){this.input="",this.location=0,this.token_rules=[],this.initial_whitespace=new RegExp("^("+e+")+");for(let n of t)this.token_rules.push([new RegExp("^"+n[0])].concat(n.slice(1)))}set_input(t){if(typeof t!="string")throw new Error("Input must be a string");this.input=t,this.location=0}return_state(){return{input:this.input,location:this.location}}set_state({input:t=null,location:e=0}={}){t!==null&&(this.input=t,this.location=e)}advance({remove_initial_space:t=!0}={}){let e=this.initial_whitespace.exec(this.input);if(e){let r=e[0].length;if(this.input=this.input.slice(r),this.location+=r,!t)return{token_type:"SPACE",token_text:e[0],original_text:e[0]}}if(this.input.length===0)return{token_type:"EOF",token_text:"",original_text:""};e=null;for(var n of this.token_rules)if(e=n[0].exec(this.input),e){let r=e[0].length;this.input=this.input.slice(r),this.location+=r;break}return e===null?{token_type:"INVALID",token_text:this.input[0],original_text:this.input[0]}:n.length>2?{token_type:n[1],token_text:n[2],original_text:e[0]}:{token_type:n[1],token_text:e[0],original_text:e[0]}}unput(t){if(typeof t!="string")throw new Error("Input must be a string");this.location-=t.length,this.input=t+this.input}}var is_associative$1={"+":!0,"*":!0,and:!0,or:!0,union:!0,intersect:!0};function flatten$18(l){if(!Array.isArray(l))return l;var t=l[0],e=l.slice(1);if(e=e.map(function(i,a){return flatten$18(i)}),is_associative$1[t]){for(var n=[],r=0;r<e.length;r++)Array.isArray(e[r])&&e[r][0]===t?n=n.concat(e[r].slice(1)):n.push(e[r]);e=n}return[t].concat(e)}let sci_notat_exp_regex="(E[+\\-]?[0-9]+\\s*($|(?=\\,|\\||\\)|\\}|\\])))?",text_rules=[["[0-9]+(\\.[0-9]*)?"+sci_notat_exp_regex,"NUMBER"],["\\.[0-9]+"+sci_notat_exp_regex,"NUMBER"],["\\*\\*","^"],["\\*","*"],["\\xB7","*"],["\xB7","*"],["\u2022","*"],["\u22C5","*"],["\xD7","*"],["/","/"],["-","-"],["\u058A","-"],["\u05BE","-"],["\u1806","-"],["\u2010","-"],["\u2011","-"],["\u2012","-"],["\u2013","-"],["\u2014","-"],["\u2015","-"],["\u207B","-"],["\u208B","-"],["\u2212","-"],["\u2E3A","-"],["\u2E3B","-"],["\uFE58","-"],["\uFE63","-"],["\uFF0D","-"],["\\+","+"],["\\^","^"],["\u2038","^"],["\u028C","^"],["\\|","|"],["\\(","("],["\\)",")"],["\\[","["],["\\]","]"],["\\{","{"],["\\}","}"],[",",","],[":",":"],["\u03B1","VARMULTICHAR","alpha"],["\u03B2","VARMULTICHAR","beta"],["\u03D0","VARMULTICHAR","beta"],["\u0393","VARMULTICHAR","Gamma"],["\u03B3","VARMULTICHAR","gamma"],["\u0394","VARMULTICHAR","Delta"],["\u03B4","VARMULTICHAR","delta"],["\u03B5","VARMULTICHAR","epsilon"],["\u03F5","VARMULTICHAR","epsilon"],["\u03B6","VARMULTICHAR","zeta"],["\u03B7","VARMULTICHAR","eta"],["\u0398","VARMULTICHAR","Theta"],["\u03F4","VARMULTICHAR","Theta"],["\u03B8","VARMULTICHAR","theta"],["\u1DBF","VARMULTICHAR","theta"],["\u03D1","VARMULTICHAR","theta"],["\u03B9","VARMULTICHAR","iota"],["\u03BA","VARMULTICHAR","kappa"],["\u039B","VARMULTICHAR","Lambda"],["\u03BB","VARMULTICHAR","lambda"],["\u03BC","VARMULTICHAR","mu"],["\xB5","VARMULTICHAR","mu"],["\u03BD","VARMULTICHAR","nu"],["\u039E","VARMULTICHAR","Xi"],["\u03BE","VARMULTICHAR","xi"],["\u03A0","VARMULTICHAR","Pi"],["\u03C0","VARMULTICHAR","pi"],["\u03D6","VARMULTICHAR","pi"],["\u03C1","VARMULTICHAR","rho"],["\u03F1","VARMULTICHAR","rho"],["\u03A3","VARMULTICHAR","Sigma"],["\u03C3","VARMULTICHAR","sigma"],["\u03C2","VARMULTICHAR","sigma"],["\u03C4","VARMULTICHAR","tau"],["\u03A5","VARMULTICHAR","Upsilon"],["\u03C5","VARMULTICHAR","upsilon"],["\u03A6","VARMULTICHAR","Phi"],["\u03C6","VARMULTICHAR","phi"],["\u03D5","VARMULTICHAR","phi"],["\u03A8","VARMULTICHAR","Psi"],["\u03C8","VARMULTICHAR","psi"],["\u03A9","VARMULTICHAR","Omega"],["\u03C9","VARMULTICHAR","omega"],["oo\\b","INFINITY"],["OO\\b","INFINITY"],["infty\\b","INFINITY"],["infinity\\b","INFINITY"],["Infinity\\b","INFINITY"],["\u221E","INFINITY"],["\u212F","VAR","e"],["\u2660","VARMULTICHAR","spade"],["\u2661","VARMULTICHAR","heart"],["\u2662","VARMULTICHAR","diamond"],["\u2663","VARMULTICHAR","club"],["\u2605","VARMULTICHAR","bigstar"],["\u25EF","VARMULTICHAR","bigcirc"],["\u25CA","VARMULTICHAR","lozenge"],["\u25B3","VARMULTICHAR","bigtriangleup"],["\u25BD","VARMULTICHAR","bigtriangledown"],["\u29EB","VARMULTICHAR","blacklozenge"],["\u25A0","VARMULTICHAR","blacksquare"],["\u25B2","VARMULTICHAR","blacktriangle"],["\u25BC","VARMULTICHAR","blacktriangledown"],["\u25C0","VARMULTICHAR","blacktriangleleft"],["\u25B6","VARMULTICHAR","blacktriangleright"],["\u25A1","VARMULTICHAR","Box"],["\u2218","VARMULTICHAR","circ"],["\u22C6","VARMULTICHAR","star"],["and\\b","AND"],["\\&\\&?","AND"],["\u2227","AND"],["or\\b","OR"],["\u2228","OR"],["not\\b","NOT"],["\xAC","NOT"],["=","="],["\u1400","="],["\u30A0","="],["!=","NE"],["\u2260","NE"],["<=","LE"],["\u2264","LE"],[">=","GE"],["\u2265","GE"],["<","<"],[">",">"],["elementof\\b","IN"],["\u2208","IN"],["notelementof\\b","NOTIN"],["\u2209","NOTIN"],["containselement\\b","NI"],["\u220B","NI"],["notcontainselement\\b","NOTNI"],["\u220C","NOTNI"],["subset\\b","SUBSET"],["\u2282","SUBSET"],["notsubset\\b","NOTSUBSET"],["\u2284","NOTSUBSET"],["superset\\b","SUPERSET"],["\u2283","SUPERSET"],["notsuperset\\b","NOTSUPERSET"],["\u2285","NOTSUPERSET"],["union\\b","UNION"],["\u222A","UNION"],["intersect\\b","INTERSECT"],["\u2229","INTERSECT"],["!","!"],["'","'"],["_","_"],["\\.\\.\\.","LDOTS"],["[a-zA-Z\u2202][a-zA-Z\u22020-9]*","VAR"]],allowSimplifiedFunctionApplicationDefault=!0,splitSymbolsDefault=!0,unsplitSymbolsDefault=["alpha","beta","gamma","Gamma","delta","Delta","epsilon","zeta","eta","theta","Theta","iota","kappa","lambda","Lambda","mu","nu","xi","Xi","pi","Pi","rho","sigma","Sigma","tau","Tau","upsilon","Upsilon","phi","Phi","chi","psi","Psi","omega","Omega"],appliedFunctionSymbolsDefault=["abs","exp","log","ln","log10","sign","sqrt","erf","acos","acosh","acot","acoth","acsc","acsch","asec","asech","asin","asinh","atan","atanh","cos","cosh","cot","coth","csc","csch","sec","sech","sin","sinh","tan","tanh","arcsin","arccos","arctan","arccsc","arcsec","arccot","cosec","arg","conj"],functionSymbolsDefault=["f","g"],parseLeibnizNotationDefault=!0;class textToAst{constructor({allowSimplifiedFunctionApplication:t=allowSimplifiedFunctionApplicationDefault,splitSymbols:e=splitSymbolsDefault,unsplitSymbols:n=unsplitSymbolsDefault,appliedFunctionSymbols:r=appliedFunctionSymbolsDefault,functionSymbols:i=functionSymbolsDefault,parseLeibnizNotation:a=parseLeibnizNotationDefault}={}){this.allowSimplifiedFunctionApplication=t,this.splitSymbols=e,this.unsplitSymbols=n,this.appliedFunctionSymbols=r,this.functionSymbols=i,this.parseLeibnizNotation=a,this.lexer=new lexer(text_rules)}advance(t){if(this.token=this.lexer.advance(t),this.token.token_type==="INVALID")throw new ParseError("Invalid symbol '"+this.token.original_text+"'",this.lexer.location)}return_state(){return{lexer_state:this.lexer.return_state(),token:Object.assign({},this.token)}}set_state(t){this.lexer.set_state(t.lexer_state),this.token=Object.assign({},t.token)}convert(t){this.lexer.set_input(t),this.advance();var e=this.statement_list();if(this.token.token_type!=="EOF")throw new ParseError("Invalid location of '"+this.token.original_text+"'",this.lexer.location);return flatten$18(e)}statement_list(){for(var t=[this.statement()];this.token.token_type===",";)this.advance(),t.push(this.statement());return t.length>1?t=["list"].concat(t):t=t[0],t}statement({inside_absolute_value:t=0}={}){if(this.token.token_type==="LDOTS")return this.advance(),["ldots"];var e;try{e=this.return_state();let n=this.statement_a({inside_absolute_value:t});if(this.token.token_type!==":")return n;this.advance();let r=this.statement_a();return[":",n,r]}catch(n){try{this.set_state(e);let r=this.statement_a({parse_absolute_value:!1});if(this.token.token_type!=="|")throw n;this.advance();let i=this.statement_a({parse_absolute_value:!1});return["|",r,i]}catch(r){throw n}}}statement_a({inside_absolute_value:t=0,parse_absolute_value:e=!0}={}){for(var n=this.statement_b({inside_absolute_value:t,parse_absolute_value:e});this.token.token_type==="OR";){let r=this.token.token_type.toLowerCase();this.advance();let i=this.statement_b({inside_absolute_value:t,parse_absolute_value:e});n=[r,n,i]}return n}statement_b(t){for(var e=this.relation(t);this.token.token_type==="AND";){let n=this.token.token_type.toLowerCase();this.advance();let r=this.relation(t);e=[n,e,r]}return e}relation(t){if(this.token.token_type==="NOT"||this.token.token_type==="!")return this.advance(),["not",this.relation(t)];for(var e=this.expression(t);this.token.token_type==="="||this.token.token_type==="NE"||this.token.token_type==="<"||this.token.token_type===">"||this.token.token_type==="LE"||this.token.token_type==="GE"||this.token.token_type==="IN"||this.token.token_type==="NOTIN"||this.token.token_type==="NI"||this.token.token_type==="NOTNI"||this.token.token_type==="SUBSET"||this.token.token_type==="NOTSUBSET"||this.token.token_type==="SUPERSET"||this.token.token_type==="NOTSUPERSET";){let n=this.token.token_type.toLowerCase(),r=0;this.token.token_type==="<"||this.token.token_type==="LE"?r=-1:(this.token.token_type===">"||this.token.token_type==="GE")&&(r=1),this.advance();let i=this.expression(t);if(r===-1)if(this.token.token_type==="<"||this.token.token_type==="LE"){let a=["tuple"];n==="<"?a.push(!0):a.push(!1);let s=["tuple",e,i];for(;this.token.token_type==="<"||this.token.token_type==="LE";)this.token.token_type==="<"?a.push(!0):a.push(!1),this.advance(),s.push(this.expression(t));e=["lts",s,a]}else e=[n,e,i];else if(r===1)if(this.token.token_type===">"||this.token.token_type==="GE"){let a=["tuple"];n===">"?a.push(!0):a.push(!1);let s=["tuple",e,i];for(;this.token.token_type===">"||this.token.token_type==="GE";)this.token.token_type===">"?a.push(!0):a.push(!1),this.advance(),s.push(this.expression(t));e=["gts",s,a]}else e=[n,e,i];else if(n==="=")for(e=["=",e,i];this.token.token_type==="=";)this.advance(),e.push(this.expression(t));else e=[n,e,i]}return e}expression(t){this.token.token_type==="+"&&this.advance();let e=!1;this.token.token_type==="-"&&(e=!0,this.advance());var n=this.term(t);for(e&&(n=["-",n]);this.token.token_type==="+"||this.token.token_type==="-"||this.token.token_type==="UNION"||this.token.token_type==="INTERSECT";){let r=this.token.token_type.toLowerCase(),i=!1;this.token.token_type==="-"?(r="+",i=!0,this.advance()):(this.advance(),r==="+"&&this.token.token_type==="-"&&(i=!0,this.advance()));let a=this.term(t);i&&(a=["-",a]),n=[r,n,a]}return n}term(t){var e=this.factor(t),n=!1;do if(n=!1,this.token.token_type==="*")this.advance(),e=["*",e,this.factor(t)],n=!0;else if(this.token.token_type==="/")this.advance(),e=["/",e,this.factor(t)],n=!0;else{let r=Object.assign({},t);r.allow_absolute_value_closing=!0;let i=this.nonMinusFactor(r);i!==!1&&(e=["*",e,i],n=!0)}while(n);return e}factor(t){if(this.token.token_type==="-")return this.advance(),["-",this.factor(t)];var e=this.nonMinusFactor(t);if(e===!1)throw this.token.token_type==="EOF"?new ParseError("Unexpected end of input",this.lexer.location):new ParseError("Invalid location of '"+this.token.original_text+"'",this.lexer.location);return e}nonMinusFactor(t){var e=this.baseFactor(t);if(this.token.token_type==="!"||this.token.token_type==="'"){if(e===!1)throw new ParseError("Invalid location of "+this.token.token_type,this.lexer.location);for(;this.token.token_type==="!"||this.token.token_type==="'";)this.token.token_type==="!"?e=["apply","factorial",e]:e=["prime",e],this.advance()}if(this.token.token_type==="^"){if(e===!1)throw new ParseError("Invalid location of ^",this.lexer.location);this.advance();let n=Object.assign({},t);return delete n.allow_absolute_value_closing,delete n.inside_absolute_value,["^",e,this.factor(n)]}return e}baseFactor({inside_absolute_value:t=0,parse_absolute_value:e=!0,allow_absolute_value_closing:n=!1}={}){var r=!1;if(this.token.token_type==="NUMBER")r=parseFloat(this.token.token_text),this.advance();else if(this.token.token_type==="INFINITY")r=Infinity,this.advance();else if(this.token.token_type==="VAR"||this.token.token_type==="VARMULTICHAR")if(r=this.token.token_text,this.appliedFunctionSymbols.includes(r)||this.functionSymbols.includes(r)){let i=!1;if(this.appliedFunctionSymbols.includes(r)&&(i=!0),this.advance(),this.token.token_type==="_"){this.advance();let a=this.baseFactor({parse_absolute_value:e});if(a===!1)throw this.token.token_type==="EOF"?new ParseError("Unexpected end of input",this.lexer.location):new ParseError("Invalid location of '"+this.token.original_text+"'",this.lexer.location);r=["_",r,a]}for(;this.token.token_type==="'";)r=["prime",r],this.advance();if(this.token.token_type==="^"&&(this.advance(),r=["^",r,this.factor({parse_absolute_value:e})]),this.token.token_type==="("){this.advance();let a=this.statement_list();if(this.token.token_type!==")")throw new ParseError("Expecting )",this.lexer.location);this.advance(),a[0]==="list"&&(a[0]="tuple"),r=["apply",r,a]}else if(i){if(!this.allowSimplifiedFunctionApplication)throw new ParseError("Expecting ( after function",this.lexer.location);r=["apply",r,this.factor({parse_absolute_value:e})]}}else{if(this.parseLeibnizNotation){let a=this.return_state(),s=this.leibniz_notation();if(s)return s;this.set_state(a)}let i=this.splitSymbols;if(i&&(this.token.token_type==="VARMULTICHAR"||this.unsplitSymbols.includes(r)||r.length===1||r.match(/[\d]/g))&&(i=!1),i){for(let a=r.length-1;a>=0;a--)this.lexer.unput(" "),this.lexer.unput(r[a]);return this.advance(),this.baseFactor({inside_absolute_value:t,parse_absolute_value:e,allow_absolute_value_closing:n})}else this.advance()}else if(this.token.token_type==="("||this.token.token_type==="["||this.token.token_type==="{"){let i=this.token.token_type,a,s;this.token.token_type==="("?(a=")",s="]"):this.token.token_type==="["?(a="]",s=")"):(a="}",s=null),this.advance(),r=this.statement_list();let o=1;if(r[0]==="list"&&(o=r.length-1),this.token.token_type!==a){if(o!==2||s===null)throw new ParseError("Expecting "+a,this.lexer.location);if(this.token.token_type!==s)throw new ParseError("Expecting ) or ]",this.lexer.location);r[0]="tuple",r=["interval",r];let u;i==="("?u=["tuple",!1,!0]:u=["tuple",!0,!1],r.push(u)}else o>=2?i==="("?r[0]="tuple":i==="["?r[0]="array":r[0]="set":i==="{"&&(r[0]==="|"||r[0]===":"?r=["set",r]:r=["set",r]);this.advance()}else if(this.token.token_type==="|"&&e&&(t===0||!n)){if(t+=1,this.advance(),r=this.statement({inside_absolute_value:t}),r=["apply","abs",r],this.token.token_type!=="|")throw new ParseError("Expecting |",this.lexer.location);this.advance()}if(this.token.token_type==="_"){if(r===!1)throw new ParseError("Invalid location of _",this.lexer.location);this.advance();let i=this.baseFactor({parse_absolute_value:e});if(i===!1)throw this.token.token_type==="EOF"?new ParseError("Unexpected end of input",this.lexer.location):new ParseError("Invalid location of '"+this.token.original_text+"'",this.lexer.location);return["_",r,i]}return r}leibniz_notation(){var t=this.token.token_text;if(!(this.token.token_type==="VAR"&&(t[0]==="d"||t[0]==="\u2202")&&(t.length===1||t.length===2&&/[a-zA-Z]/.exec(t[1]))))return!1;let e=t[0],n=1,r="",i=[],a=[];if(t.length===2)r=t[1];else if(this.advance(),this.token.token_type==="VARMULTICHAR"||this.token.token_type==="VAR"&&!this.token.token_text.includes("\u2202"))r=this.token.token_text;else{if(this.token.token_type!=="^"||(this.advance(),this.token.token_type!=="NUMBER")||(n=parseFloat(this.token.token_text),!Number.isInteger(n)))return!1;if(this.advance(),this.token.token_type==="VAR"&&!this.token.token_text.includes("\u2202")||this.token.token_type==="VARMULTICHAR")r=this.token.token_text;else return!1}if(this.advance(),this.token.token_type!=="/")return!1;let s=0;for(this.advance();;){if(this.token.token_type!=="VAR"||this.token.token_text[0]!==e)return!1;this.token.token_text.length>2&&(this.lexer.unput(this.token.token_text.slice(2)),this.token.token_text=this.token.token_text.slice(0,2));let o=this.token.token_text;if(o.length===2)if(/[a-zA-Z]/.exec(o[1]))i.push(o[1]);else return!1;else{if(this.advance(),!(this.token.token_type==="VAR"&&!this.token.token_text.includes("\u2202")||this.token.token_type==="VARMULTICHAR"))return!1;i.push(this.token.token_text)}let u=1,c=!1;if(this.advance({remove_initial_space:!1}),this.token.token_type==="SPACE"&&(c=!0,this.advance()),this.token.token_type==="^"){if(this.advance(),this.token.token_type!=="NUMBER"||(u=parseFloat(this.token.token_text),!Number.isInteger(u)))return!1;c=!1,this.advance({remove_initial_space:!1}),this.token.token_type==="SPACE"&&(c=!0,this.advance())}if(a.push(u),s+=u,s>n)return!1;if(s===n){if(!c&&(this.token.token_type==="VAR"||this.token.token_type==="VARMULTICHAR"))return!1;this.token.token_type==="SPACE"&&this.advance();let f="derivative_leibniz";e==="\u2202"&&(f="partial_"+f),t=[f],n===1?t.push(r):t.push(["tuple",r,n]);let p=[];for(let d=0;d<i.length;d+=1)a[d]===1?p.push(i[d]):p.push(["tuple",i[d],a[d]]);return p=["tuple"].concat(p),t.push(p),t}}}}var textToAst$1=new textToAst;function expand(l,t){var e=get_tree(l),n=[];return n.push([textToAst$1.convert("a*(b+c)"),textToAst$1.convert("a*b+a*c")]),n.push([textToAst$1.convert("(a+b)*c"),textToAst$1.convert("a*c+b*c")]),t||n.push([textToAst$1.convert("(a+b)/c"),textToAst$1.convert("a/c+b/c")]),n.push([textToAst$1.convert("-(a+b)"),textToAst$1.convert("-a-b")]),n.push([textToAst$1.convert("a(-b)"),textToAst$1.convert("-ab")]),n.push([textToAst$1.convert("(a+b)^2"),textToAst$1.convert("a^2+2ab+b^2")]),n.push([textToAst$1.convert("(a+b)^3"),textToAst$1.convert("a^3+3a^2b+3ab^2+b^3")]),n.push([textToAst$1.convert("(a+b)^4"),textToAst$1.convert("a^4+4a^3b+6a^2b^2+4ab^3+b^4")]),n.push([textToAst$1.convert("(-a)^2"),textToAst$1.convert("a^2")]),n.push([textToAst$1.convert("(-a)^3"),textToAst$1.convert("-a^3")]),n.push([textToAst$1.convert("(-a)^4"),textToAst$1.convert("a^4")]),e=applyAllTransformations(e,n,20),e=flatten(e),e=evaluate_numbers(e),e=collect_like_terms_factors(e),e=normalize_negatives(e),e}function expand_relations(l){var t=get_tree(l);return transform$2(t,expand_relations_transform)}function expand_relations_transform(l){if(!Array.isArray(l))return l;var t=l[0],e=l.slice(1);if(t==="="){if(e.length<=2)return l;let n=["and"];for(let r=0;r<e.length-1;r++)n.push(["=",e[r],e[r+1]]);return n}if(t==="gts"||t==="lts"){let n=e[0],r=e[1];if(n[0]!=="tuple"||r[0]!=="tuple")throw new Error("Badly formed ast");let i=[];for(let s=1;s<n.length-1;s++){let o;r[s]?t==="lts"?o="<":o=">":t==="lts"?o="le":o="ge",i.push([o,n[s],n[s+1]])}let a=["and",i[0],i[1]];for(let s=2;s<i.length;s++)a=["and",a,i[s]];return a}if(t==="in"||t==="notin"||t==="ni"||t==="notni"){let n=!1;(t==="notin"||t==="notni")&&(n=!0);let r,i;if(t==="in"||t==="notin"?(r=e[0],i=e[1]):(r=e[1],i=e[0]),i=to_intervals(i),i[0]!=="interval")return l;let a=i[1],s=i[2];if(a[0]!=="tuple"||s[0]!=="tuple")throw new Error("Badly formed ast");let o=a[1],u=a[2],c=[];s[1]?n?c.push(["<",r,o]):c.push(["ge",r,o]):n?c.push(["le",r,o]):c.push([">",r,o]),s[2]?n?c.push([">",r,u]):c.push(["le",r,u]):n?c.push(["ge",r,u]):c.push(["<",r,u]);let f;return n?f=["or"].concat(c):f=["and"].concat(c),f}if(t==="subset"||t==="notsubset"||t==="superset"||t==="notsuperset"){let n=!1;(t==="notsubset"||t==="notsuperset")&&(n=!0);let r,i;if(t==="subset"||t==="notsubset"?(r=e[0],i=e[1]):(r=e[1],i=e[0]),r=to_intervals(r),i=to_intervals(i),r[0]!=="interval"||i[0]!=="interval")return l;let a=r[1],s=r[2],o=i[1],u=i[2];if(a[0]!=="tuple"||s[0]!=="tuple"||o[0]!=="tuple"||u[0]!=="tuple")throw new Error("Badly formed ast");let c=a[1],f=a[2],p=o[1],d=o[2],m=[];s[1]&&!u[1]?n?m.push(["le",c,p]):m.push([">",c,p]):n?m.push(["<",c,p]):m.push(["ge",c,p]),s[2]&&!u[2]?n?m.push(["ge",f,d]):m.push(["<",f,d]):n?m.push([">",f,d]):m.push(["le",f,d]);let v;return n?v=["or"].concat(m):v=["and"].concat(m),v}return l}function substitute$1(l,t){var e=get_tree(l),n={};for(let r in t)n[r]=get_tree(t[r]);return substitute(e,n)}function substitute_component(l,t,e){let n=get_tree(l),r=get_tree(e);if(typeof t=="number")t=[t];else if(!Array.isArray(t))throw Error("Invalid substitute_component: "+t);let i=["list","tuple","vector","array"];return a(n,t,r);function a(s,o,u){if(o.length===0)return e;if(!Array.isArray(s))throw Error("Invalid substitute_component: expected list, tuple, vector, or array");let c=s[0],f=s.slice(1);if(!i.includes(c))throw Error("Invalid substitute_component: expected list, tuple, vector, or array");let p=o[0];if(p<0||p>f.length-1)throw Error("Invalid substitute_component: component out of range");let d=o.slice(1),m=a(f[p],d,u);return[c,...f.slice(0,p),m,...f.slice(p+1)]}}function get_component(l,t){let e=get_tree(l);if(typeof t=="number")t=[t];else if(!Array.isArray(t))throw Error("Invalid get_component: "+t);let n=["list","tuple","vector","array"];return r(e,t);function r(i,a){if(a.length===0)return i;if(!Array.isArray(i))throw Error("Invalid get_component: expected list, tuple, vector, or array");let s=i[0],o=i.slice(1);if(!n.includes(s))throw Error("Invalid get_component: expected list, tuple, vector, or array");let u=a[0];if(u<0||u>o.length-1)throw Error("Invalid get_component: component out of range");let c=a.slice(1);return r(o[u],c)}}var transformation=Object.freeze({expand,expand_relations,substitute:substitute$1,substitute_component,get_component});function solve_linear(l,t,e){if(typeof t=="string"){e===void 0&&l.context!==void 0&&l.context.get_assumptions!==void 0&&(e=l.context.get_assumptions([l.variables()]));var n=simplify$2(get_tree(l),e);if(!!Array.isArray(n)){var r=n[0],i=n.slice(1);if(r==="="||r==="ne"||r==="<"||r==="le"||r===">"||r==="ge"){var a=simplify$2(["+",i[0],["-",i[1]]],e),s=v=>!variables(v).includes(t),o=[["+",["*","_a",t],["*","_b",t]],["*",["+","_a","_b"],t],{variables:{_a:s,_b:s},allow_permutations:!0,allow_extended_match:!0,allow_implicit_identities:["_a","_b"],evaluate_numbers:!0}];if(a=simplify$2(applyAllTransformations(a,[o],20)),!!variables(a).includes(t)){var u=["+",["*","_a",t],"_b"],c={variables:{_a:s,_b:s},allow_permutations:!0,allow_implicit_identities:["_a","_b"]},f=match(a,u,c);if(!!f){var p=simplify$2(f._a),d=simplify$2(f._b);if(!!is_nonzero_ast(p,e)){if(r==="="||r==="ne"||is_positive_ast(p,e)){let v=simplify$2(["/",["-",d],p]);return[r,t,v]}if(!!is_negative_ast(p,e)){var m=simplify$2(["/",["-",d],p]);return r==="<"?r=">":r==="le"?r="ge":r===">"?r="<":r="le",[r,t,m]}}}}}}}}var solve=Object.freeze({solve_linear});function clean_assumptions(l,t){if(!Array.isArray(l)||l.length===0)return l;l=flatten(default_order(simplify_logical(expand_relations(l))));var e=l[0],n=l.slice(1);if(e==="and"||e==="or"){if(n=n.reduce(function(r,i){return r.every(function(a){return!equal$2(a,i)})&&r.push(i),r},[]),e==="and"&&t&&Array.isArray(t)){let r;t[0]==="and"?r=t.slice(1):r=[t],n=n.filter(i=>r.every(a=>!equal$2(a,i)))}n.length===1?l=n[0]:l=[e].concat(n)}if(e!=="and"&&t&&Array.isArray(t)){let r;if(t[0]==="and"?r=t.slice(1):r=[t],!r.every(i=>!equal$2(i,l)))return}return l}function calculate_derived_assumptions(l,t){if(t===void 0){t=[];for(let o in l.byvar){let u=l.byvar[o];u.length>0&&t.push(u)}if(t.length===0)return{};t.length===1?t=t[0]:t=["and"].concat(t),t=clean_assumptions(t)}if(!Array.isArray(t)||t.length===0)return{};var e=t[0],n=t.slice(1);if(e==="and"||e==="or"){let o=n.map(function(f){return calculate_derived_assumptions(l,f)}),u=[...new Set(o.reduce((f,p)=>[...f,...Object.keys(p)],[]))],c={};for(let f of u){let p=o.reduce(function(d,m){return m[f]!==void 0&&d.push(m[f]),d},[]);if(e==="and"||p.length===o.length){let d=c[f];d===void 0?p.length>1?d=[e].concat(p):d=p[0]:p.length>1?d=["and",d,[e].concat(p)]:d=["and",d,p[0]],c[f]=clean_assumptions(d,get_assumptions(l,f,{omit_derived:!0}))}}return c}let r={};if(e==="="||e==="ne"||e==="<"||e==="le"||e==="in"||e==="subset"||e==="notin"||e==="notsubset"){var i=!1;for(let o=0;o<2;o++){let u=n[o],c=n[1-o],f=variables(c);if(typeof u!="string"||f.length===0||f.includes(u))continue;i=!0;var a=e;o===1&&(e==="<"?a=">":e==="le"?a="ge":e==="in"?a="ni":e==="subset"?a="superset":e==="notin"?a="notni":e==="notsubset"&&(a="notsuperset"));let p=get_assumptions_for_expr(l,c,[u]);if(p=combine_assumptions(u,a,c,p),p!==void 0){let d=r[u];d===void 0?d=p:d=["and",d,p],r[u]=clean_assumptions(d,get_assumptions(l,u,{omit_derived:!0}))}}if(i)return r}let s=[];for(let o of n){let u=get_assumptions_for_expr(l,o,[]);u!==void 0&&s.push(u)}if(s.length===0)return{};s.length===1?s=s[0]:s=["and"].concat(s);for(let o of variables(t))r[o]=clean_assumptions(s,get_assumptions(l,o,{omit_derived:!0}));return r}function get_assumptions_for_expr(l,t,e){let n=variables(t);if(n=n.filter(d=>!e.includes(d)),n.length===0)return;function r(d){return!!(typeof d=="number"||Array.isArray(d)&&d[0]==="-"&&typeof d[1]=="number")}var i=["_b"],a=["_b"],s={_b:r},o={};for(let d=0;d<n.length;d++){let m="_a"+d;o[n[d]]=m,i.push(["*",m,n[d]]),a.push(m),s[m]=r}i=["+"].concat(i);var u=match(t,i,{variables:s,allow_permutations:!0,allow_extended_match:!1,allow_implicit_identities:a,max_group:1});if(!u){let d=[];for(let m of variables(t)){let v=get_assumptions_for_expr(l,m,e);v!==void 0&&d.push(v)}return d.length===0?void 0:d.length===1?d[0]:["and"].concat(d)}for(let d of n)o[d]=u[o[d]];let c=!1;u._b===0&&u._a0===1&&n.length===1&&(c=!0);var f;if(f=get_assumptions(l,[n],{exclude_variables:e}),f===void 0)return;return clean_assumptions(p(f));function p(d){if(!Array.isArray(d))return;var m=d[0],v=d.slice(1);if(m==="and"||m==="or"){let C=v.map(p).filter(_=>_!==void 0);return C.length===0?void 0:m==="or"?C.length===v.length?["or"].concat(C):void 0:C.length===1?C[0]:["and"].concat(C)}if(!(["=","ne","<","le"].includes(m)||["in","notin","subset","notsubset"].includes(m)&&c)){let C=e.concat(variables(t)),_=[];for(let w of variables(d)){if(C.includes(w))continue;let A=get_assumptions_for_expr(l,w,C);A!==void 0&&_.push(A)}return _.length===0?d:_.length===1?["and",d,_[0]]:["and",d].concat(_)}let h=[];for(let C=0;C<=1;C++){let _=v[C],w=v[1-C];if(typeof _=="string"&&n.includes(_)){var y={};y[_]=w;var g=simplify$2(substitute(t,y)),b=!1,x=m;(C===1&&o[_]>0||C===0&&o[_]<0)&&(m==="<"?(b=!0,x=">"):m==="le"?(b=!0,x="ge"):m==="in"?(b=!0,x="ni"):m==="subset"?(b=!0,x="superset"):m==="notin"?(b=!0,x="notni"):m==="notsubset"&&(b=!0,x="notsuperset")),b?h.push([m,g,t]):h.push([m,t,g]);let A=e.concat([_]),$=get_assumptions_for_expr(l,g,A);$=combine_assumptions(t,x,g,$),$!==void 0&&h.push($)}}if(h.length===1)return h[0];if(h.length>1)return["and"].concat(h);let N=e.concat(variables(t));h=[];for(let C of variables(d)){if(N.includes(C))continue;let _=get_assumptions_for_expr(l,C,N);_!==void 0&&h.push(_)}return h.length===0?d:h.length===1?["and",d,h[0]]:["and",d].concat(h)}}function combine_assumptions(l,t,e,n){if(!["=","ne","<","le",">","ge","in","notin","ni","notni","subset","notsubset","superset","notsuperset"].includes(t))return n;if(!!Array.isArray(n)){var r=n[0],i=n.slice(1);if(r==="and"||r==="or"){let u=i.map(c=>combine_assumptions(l,t,e,c)).filter(c=>c!==void 0);return u.length===0?void 0:r==="or"?u.length===i.length?[["or"].concat(u)]:void 0:u.length===1?u[0]:["and"].concat(u)}if(!["=","ne","<","le","in","notin","subset","notsubset"].includes(r))return n;var a=r,s;if(equal$2(i[0],e))s=i[1];else if(equal$2(i[1],e))s=i[0],r==="<"?a=">":r==="le"?a="ge":r==="in"?a="ni":r==="notin"?a="notni":r==="subset"?a="superset":r==="notsubset"&&(a="notsuperset");else return n;var o;if(t==="=")o=a;else if(a==="=")o=t;else if(t==="<")if(a==="<"||a==="le")o="<";else return a==="in"||a==="notin"?n:void 0;else if(t==="le")if(a==="<")o="<";else if(a==="le")o="le";else return a==="in"||a==="notin"?n:void 0;else if(t===">")if(a===">"||a==="ge")o=">";else return a==="in"||a==="notin"?n:void 0;else if(t==="ge")if(a===">")o=">";else if(a==="ge")o="ge";else return a==="in"||a==="notin"?n:void 0;else if(t==="in")if(a==="subset")o="in";else return;else if(t==="notin")if(a==="superset")o="notin";else return;else if(t==="ni")if(a==="notin")o="notsubset";else return;else if(t==="notni")if(a==="in")o="notsuperset";else return;else if(t==="subset")if(a==="subset")o="subset";else if(a==="notni")o="notni";else if(a==="notsuperset")o="notsuperset";else return;else if(t==="notsubset")if(a==="superset")o="notsubset";else return;else if(t==="superset")if(a==="superset")o="superset";else if(a==="ni")o="ni";else if(a==="notsubset")o="notsubset";else return;else if(t==="notsuperset")if(a==="subset")o="notsuperset";else return;else return;return o===">"?["<",s,l]:o==="ge"?["le",s,l]:o==="ni"?["in",s,l]:o==="notni"?["notin",s,l]:o==="superset"?["subset",s,l]:o==="notsuperset"?["notsubset",s,l]:[o,l,s]}}function filter_assumptions_from_tree(l,t){if(!(!Array.isArray(l)||l.length===0)){Array.isArray(t)||(t=[t]);var e=l[0],n=l.slice(1);if(e==="and"){var r=n.map(function(s){return filter_assumptions_from_tree(s,t)});return r=r.filter(s=>s!==void 0),r.length===0?void 0:r.length===1?r[0]:["and"].concat(r)}var i=variables(l),a=t.filter(s=>i.includes(s)).length>0;if(!a)return l}}function get_assumptions_sub(l,t,e,n){Array.isArray(t)||(t=[t]);var r=[];if(t.forEach(function(i){if(l.byvar[i]||l.derived[i]){if(l.byvar[i]&&l.byvar[i].length>0){var a=filter_assumptions_from_tree(l.byvar[i],e);a!==void 0&&r.push(a)}if(l.derived[i]&&l.derived[i].length>0&&!n){var s=filter_assumptions_from_tree(l.derived[i],e);s!==void 0&&r.push(s)}}else l.generic.length>0&&(i==="x"||!variables(l.generic).includes(i))&&r.push(substitute(l.generic,{x:i}))}),r.length===1?r=r[0]:r.length>1&&(r=["and"].concat(r)),r.length>0)return clean_assumptions(r)}function get_assumptions(l,t,e){e===void 0&&(e={});var n=e.exclude_variables;n===void 0?n=[]:Array.isArray(n)||(n=[n]);var r,i=get_tree(t);if(typeof i=="string")r=[i];else if(Array.isArray(i))Array.isArray(i[0])&&(r=i[0]);else return;return r?get_assumptions_sub(l,r,n,e.omit_derived):get_assumptions_for_expr(l,i,n)}function add_assumption(l,t,e){var n=get_tree(t);if(!Array.isArray(n))return 0;n=clean_assumptions(simplify$2(n,l));var r=add_assumption_sub(l,n,e);return r&&(l.derived=calculate_derived_assumptions(l)),r}function add_assumption_sub(l,t,e){if(t[0]==="and"){var n=t.slice(1).map(a=>add_assumption_sub(l,a,e));return n.reduce(function(a,s){return a+s})}var r=variables(t);if(r.length===0)return 0;let i=0;!e&&l.generic.length>0&&r.forEach(function(a){l.byvar[a]===void 0&&(a==="x"||!variables(l.generic).includes(a))&&(add_assumption_sub(l,substitute(l.generic,{x:a}),!0),i+=1)});for(let a of r){let s=solve_linear(t,a,l),o=t;s&&(o=s);let u=l.byvar[a];u!==void 0&&u.length!==0&&(o=["and",u,o]),o=clean_assumptions(o),equal$2(o,u)||(l.byvar[a]=o,i+=1)}return i}function add_generic_assumption(l,t){var e=get_tree(t);if(!Array.isArray(e))return 0;e=clean_assumptions(simplify$2(e,l));var n=add_generic_assumption_sub(l,e);return n&&(l.derived=calculate_derived_assumptions(l)),n}function add_generic_assumption_sub(l,t){if(t[0]==="and"){var e=t.slice(1).map(s=>add_generic_assumption_sub(l,s));return e.reduce(function(s,o){return s+o})}var n=variables(t);if(!n.includes("x"))return 0;let r=solve_linear(t,"x",l),i=t;r&&(i=r);let a=l.generic;return a.length!==0&&(i=["and",a,i]),i=clean_assumptions(i),equal$2(i,a)?0:(l.generic=i,1)}function remove_assumption(l,t){var e=get_tree(t);if(!Array.isArray(e))return 0;e=clean_assumptions(simplify$2(e,l));var n=remove_assumption_sub(l,e);return n&&(l.derived=calculate_derived_assumptions(l)),n}function remove_assumption_sub(l,t){if(t[0]==="and"){var e=t.slice(1).map(i=>remove_assumption_sub(l,i));return e.reduce(function(i,a){return i+a})}var n=variables(t);if(n.length===0)return 0;var r=0;for(let i of n){let a=solve_linear(t,i,l),s=l.byvar[i];if(!s||s.length===0)continue;let o=s[0],u=s.slice(1),c=u.length,f;if(o==="and")if(u=u.filter(p=>!(equal$2(p,t)||equal$2(p,a))),u.length===0)f=[];else if(u.length===1)f=u[0];else if(u.length<c)f=[o].concat(u);else continue;else if(equal$2(s,t)||equal$2(s,a))f=[];else continue;r+=1,l.byvar[i]=f}return r}function remove_generic_assumption(l,t){var e=get_tree(t);if(!Array.isArray(e))return 0;e=clean_assumptions(simplify$2(e,l));var n=remove_generic_assumption_sub(l,e);return n&&(l.derived=calculate_derived_assumptions(l)),n}function remove_generic_assumption_sub(l,t){if(t[0]==="and"){var e=t.slice(1).map(c=>remove_generic_assumption_sub(l,c));return e.reduce(function(c,f){return c+f})}var n=variables(t);if(!n.includes("x"))return 0;var r=l.generic;if(r.length===0)return 0;let i=solve_linear(t,"x",l);var a=r[0],s=r.slice(1),o=s.length,u;if(a==="and")if(s=s.filter(c=>!(equal$2(c,t)||equal$2(c,i))),s.length===0)u=[];else if(s.length===1)u=s[0];else if(s.length<o)u=[a].concat(s);else return 0;else if(equal$2(r,t)||equal$2(r,i))u=[];else return 0;return l.generic=u,1}function initialize_assumptions(){var l={};return l.byvar={},l.derived={},l.generic=[],l.not_commutative=[],l.get_assumptions=function(t,e){return get_assumptions(l,t,e)},l.add_assumption=function(t,e){return add_assumption(l,t,e)},l.add_generic_assumption=function(t){return add_generic_assumption(l,t)},l.remove_assumption=function(t){return remove_assumption(l,t)},l.remove_generic_assumption=function(t){return remove_generic_assumption(l,t)},l}let operators$3={"+":function(l){return l.join(" ")},"-":function(l){return"- "+l[0]},"*":function(l){return l.join(" ")},"/":function(l){return"\\frac{"+l[0]+"}{"+l[1]+"}"},_:function(l){return l[0]+"_{"+l[1]+"}"},"^":function(l){return l[0]+"^{"+l[1]+"}"},prime:function(l){return l[0]+"'"},tuple:function(l){return"\\left( "+l.join(", ")+" \\right)"},array:function(l){return"\\left[ "+l.join(", ")+" \\right]"},list:function(l){return l.join(", ")},set:function(l){return"\\left\\{ "+l.join(", ")+" \\right\\}"},vector:function(l){return"\\left( "+l.join(", ")+" \\right)"},interval:function(l){return"\\left( "+l.join(", ")+" \\right)"},matrix:function(l){return"\\left( "+l.join(", ")+" \\right)"},and:function(l){return l.join(" \\land ")},or:function(l){return l.join(" \\lor ")},not:function(l){return"\\lnot "+l[0]},"=":function(l){return l.join(" = ")},"<":function(l){return l.join(" < ")},">":function(l){return l.join(" > ")},lts:function(l){return l.join(" < ")},gts:function(l){return l.join(" > ")},le:function(l){return l.join(" \\le ")},ge:function(l){return l.join(" \\ge ")},ne:function(l){return l.join(" \\ne ")},in:function(l){return l[0]+" \\in "+l[1]},notin:function(l){return l[0]+" \\notin "+l[1]},ni:function(l){return l[0]+" \\ni "+l[1]},notni:function(l){return l[0]+" \\not\\ni "+l[1]},subset:function(l){return l[0]+" \\subset "+l[1]},notsubset:function(l){return l[0]+" \\not\\subset "+l[1]},superset:function(l){return l[0]+" \\supset "+l[1]},notsuperset:function(l){return l[0]+" \\not\\supset "+l[1]},union:function(l){return l.join(" \\cup ")},intersect:function(l){return l.join(" \\cap ")},derivative_leibniz:function(l){return"\\frac{d"+l[0]+"}{d"+l[1]+"}"},partial_derivative_leibniz:function(l){return"\\frac{d"+l[0]+"}{d"+l[1]+"}"},"|":function(l){return l[0]+" \\mid "+l[1]},":":function(l){return l[0]+" : "+l[1]}},allowedLatexSymbolsDefault=["alpha","beta","gamma","Gamma","delta","Delta","epsilon","zeta","eta","theta","Theta","iota","kappa","lambda","Lambda","mu","nu","xi","Xi","pi","Pi","rho","sigma","Sigma","tau","Tau","upsilon","Upsilon","phi","Phi","chi","psi","Psi","omega","Omega","partial","abs","exp","log","ln","log10","sign","sqrt","erf","acos","acosh","acot","acoth","acsc","acsch","asec","asech","asin","asinh","atan","atanh","cos","cosh","cot","coth","csc","csch","sec","sech","sin","sinh","tan","tanh","arcsin","arccos","arctan","arccsc","arcsec","arccot","cosec","arg"],matrixEnvironmentDefault="bmatrix";class astToLatex{constructor({allowedLatexSymbols:t=allowedLatexSymbolsDefault,matrixEnvironment:e=matrixEnvironmentDefault}={}){this.allowedLatexSymbols=t,this.matrixEnvironment=e}convert(t){return this.statement(t)}statement(t){if(typeof t=="string"||typeof t=="number")return this.single_statement(t);var e=t[0],n=t.slice(1);if(e==="ldots")return"\\ldots";if(!(e in operators$3)&&e!=="apply")throw new Error("Badly formed ast: operator "+e+" not recognized.");return e==="and"||e==="or"?operators$3[e](n.map(function(r,i){let a=this.single_statement(r);return a.toString().match(/ /)&&!a.toString().match(/^\\left\(.*\\right\)$/)?"\\left("+a+"\\right)":a}.bind(this))):this.single_statement(t)}single_statement(t){if(typeof t=="string"||typeof t=="number")return this.expression(t);var e=t[0],n=t.slice(1);if(e==="not")return operators$3[e](n.map(function(r,i){let a=this.single_statement(r);return a.toString().match(/ /)&&!a.toString().match(/^\\left\(.*\\right\)$/)?"\\left("+a+"\\right)":a}.bind(this)));if(e==="="||e==="ne"||e==="<"||e===">"||e==="le"||e==="ge"||e==="in"||e==="notin"||e==="ni"||e==="notni"||e==="subset"||e==="notsubset"||e==="superset"||e==="notsuperset")return operators$3[e](n.map(function(r,i){return this.expression(r)}.bind(this)));if(e==="lts"||e==="gts"){let r=n[0],i=n[1];if(r[0]!=="tuple"||i[0]!=="tuple")throw new Error("Badly formed ast");let a=this.expression(r[1]);for(let s=1;s<r.length-1;s++)i[s]?e==="lts"?a+=" < ":a+=" > ":e==="lts"?a+=" \\le ":a+=" \\ge ",a+=this.expression(r[s+1]);return a}return this.expression(t)}expression(t){if(typeof t=="string"||typeof t=="number")return this.term(t);var e=t[0],n=t.slice(1);return e==="+"?operators$3[e](n.map(function(r,i){return i>0?this.termWithPlusIfNotNegated(r):this.term(r)}.bind(this))):e==="union"||e==="intersect"?operators$3[e](n.map(function(r,i){return this.term(r)}.bind(this))):this.term(t)}term(t){if(typeof t=="string"||typeof t=="number")return this.factor(t);var e=t[0],n=t.slice(1);return e==="-"?operators$3[e](n.map(function(r,i){return this.term(r)}.bind(this))):e==="*"?operators$3[e](n.map(function(r,i){let a;return i>0?(a=this.factorWithParenthesesIfNegated(r),a.toString().match(/^[0-9]/)?"\\cdot "+a:"\\, "+a):this.factor(r)}.bind(this))):e==="/"?operators$3[e](n.map(function(r,i){return this.expression(r)}.bind(this))):this.factor(t)}simple_factor_or_function_or_parens(t){var e=this.factor(t);return e.toString().length===1||typeof t=="string"||t[0]==="apply"&&t[1]!=="sqrt"||e.toString().match(/^\\left\(.*\\right\)$/)?!0:typeof t=="number"?t>=0&&!t.toString().includes("e"):!1}stringConvert(t){return t.length>1?this.allowedLatexSymbols.includes(t)?"\\"+t:"\\var{"+t+"}":t}factor(t){if(typeof t=="string")return this.stringConvert(t);if(typeof t=="number"){if(t===Infinity)return"\\infty";if(t===-Infinity)return"-\\infty";{let r=t.toString(),i=r.indexOf("e");if(i===-1)return r;let a=r.substring(0,i),s=r.substring(i+1);return a+" \\cdot 10^{"+s+"}"}}var e=t[0],n=t.slice(1);if(e==="^"){let r=this.factor(n[0]),i=n[0];for(;i[0]==="prime";)i=i[1];return this.simple_factor_or_function_or_parens(i)||i[0]==="_"&&typeof i[1]=="string"||(r="\\left("+r.toString()+"\\right)"),r+"^{"+this.statement(n[1])+"}"}else if(e==="_"){let r=this.factor(n[0]);return this.simple_factor_or_function_or_parens(n[0])||(r="\\left("+r.toString()+"\\right)"),r+"_{"+this.statement(n[1])+"}"}else if(e==="prime"){let r=n[0],i=1;for(;r[0]==="prime";)i+=1,r=r[1];let a=this.factor(r);this.simple_factor_or_function_or_parens(r)||r[0]==="_"&&typeof r[1]=="string"||(a="\\left("+a.toString()+"\\right)");for(let s=0;s<i;s++)a+="'";return a}else{if(e==="-")return operators$3[e](n.map(function(r,i){return this.factor(r)}.bind(this)));if(e==="tuple"||e==="array"||e==="list"||e==="set"||e==="vector"||e==="|"||e===":")return operators$3[e](n.map(function(r,i){return this.statement(r)}.bind(this)));if(e==="interval"){let r=n[0],i=n[1];if(r[0]!=="tuple"||i[0]!=="tuple")throw new Error("Badly formed ast");let a=this.statement(r[1])+", "+this.statement(r[2]);return i[1]?a="\\left[ "+a:a="\\left( "+a,i[2]?a=a+" \\right]":a=a+" \\right)",a}else if(e==="matrix"){let r=n[0],i=n[1],a="\\begin{"+this.matrixEnvironment+"} ";for(let s=0;s<r[1];s+=1){for(let o=0;o<r[2];o+=1)a=a+this.statement(i[s+1][o+1]),o<r[2]-1&&(a=a+" & ");s<r[1]-1&&(a=a+" \\\\ ")}return a=a+" \\end{"+this.matrixEnvironment+"}",a}else if(e==="derivative_leibniz"||e==="partial_derivative_leibniz"){let r="d";e==="partial_derivative_leibniz"&&(r="\\partial ");let i=n[0],a=n[1],s=1,o="";Array.isArray(i)?(o=i[1],s=i[2]):o=i;let u=r;s>1?u=u.trimRight()+"^{"+s+"}"+this.stringConvert(o):u=u+this.stringConvert(o),u="\\frac{ "+u+" }{ ";let c=1;Array.isArray(a)&&(c=a.length-1);for(let f=1;f<=c;f++){let p=a[f],d=1,m="";Array.isArray(p)?(m=p[1],d=p[2]):m=p,u=u+r+this.stringConvert(m),d>1&&(u=u+"^{"+d+"}"),u=u+" "}return u=u+"}",u}else if(e==="apply"){if(n[0]==="abs")return"\\left|"+this.statement(n[1])+"\\right|";if(n[0]==="factorial"){let a=this.factor(n[1]);return this.simple_factor_or_function_or_parens(n[1])||n[1][0]==="_"&&typeof n[1][1]=="string"?a+"!":"\\left("+a.toString()+"\\right)!"}if(n[0]==="sqrt")return"\\sqrt{"+this.statement(n[1])+"}";let r=this.factor(n[0]),i=this.statement(n[1]);return n[1][0]!=="tuple"&&(i="\\left("+i+"\\right)"),r+i}else return"\\left("+this.statement(t)+"\\right)"}}factorWithParenthesesIfNegated(t){var e=this.factor(t);return e.toString().match(/^-/)?"\\left("+e.toString()+"\\right)":e}termWithPlusIfNotNegated(t){var e=this.term(t);return e.toString().match(/^-/)?e:"+ "+e.toString()}}let textToAst$2=new textToAst,astToLatex$1=new astToLatex;var derivatives={sin:textToAst$2.convert("cos x"),cos:textToAst$2.convert("-(sin x)"),tan:textToAst$2.convert("(sec x)^2"),cot:textToAst$2.convert("-((csc x)^2)"),sec:textToAst$2.convert("(sec x)*(tan x)"),csc:textToAst$2.convert("-(csc x)*(cot x)"),sqrt:textToAst$2.convert("1/(2*sqrt(x))"),log:textToAst$2.convert("1/x"),ln:textToAst$2.convert("1/x"),exp:textToAst$2.convert("exp(x)"),arcsin:textToAst$2.convert("1/sqrt(1 - x^2)"),arccos:textToAst$2.convert("-1/sqrt(1 - x^2)"),arctan:textToAst$2.convert("1/(1 + x^2)"),arccsc:textToAst$2.convert("-1/(sqrt(-1/x^2 + 1)*x^2)"),arcsec:textToAst$2.convert("1/(sqrt(-1/x^2 + 1)*x^2)"),arccot:textToAst$2.convert("-1/(1 + x^2)"),abs:textToAst$2.convert("abs(x)/x")};function derivative$2(l,t,e=[]){var n=get_tree(l),r="\\frac{d}{d"+t+"} ";if(typeof n=="number"||variables(n).indexOf(t)<0)return e.push("The derivative of a constant is zero, that is, \\("+r+astToLatex$1.convert(n)+" = 0\\)."),0;if(typeof n=="string")return t===n?(e.push("We know the derivative of the identity function is one, that is, \\("+r+astToLatex$1.convert(n)+" = 1\\)."),1):(e.push("As far as \\("+astToLatex$1.convert(t)+"\\) is concerned, \\("+astToLatex$1.convert(n)+"\\) is constant, so "+r+astToLatex$1.convert(n)+" = 0\\)."),0);var i=n[0],a=n.slice(1);if(i==="+"||i==="-"||i==="~"){e.push("Using the sum rule, \\("+r+astToLatex$1.convert(n)+" = "+a.map(function(o,u){return r+astToLatex$1.convert(o)}).join(" + ")+"\\).");let s=[i].concat(a.map(function(o,u){return derivative$2(o,t,e)}));return s=simplify$2(s),e.push("So using the sum rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(s)+"\\)."),s}if(i==="*"){let s=[],o=[];for(let f=0;f<a.length;f++)typeof a[f]=="number"||variables(a[f]).indexOf(t)<0?o.push(a[f]):s.push(a[f]);if(o.length>0){if(s.length===0)return e.push("Since the derivative of a constant is zero, \\("+r+astToLatex$1.convert(n)+" = 0.\\)"),0;let f=["*"].concat(s);if(s.length===1&&(f=s[0]),f===t){e.push("By the constant multiple rule, \\("+r+astToLatex$1.convert(n)+" = "+o.map(function(v,h){return astToLatex$1.convert(v)}).join(" \\cdot ")+"\\).");let m=["*"].concat(o);return m=simplify$2(m),m}e.push("By the constant multiple rule, \\("+r+astToLatex$1.convert(n)+" = "+o.map(function(m,v){return astToLatex$1.convert(m)}).join(" \\cdot ")+" \\cdot "+r+"\\left("+astToLatex$1.convert(f)+"\\right)\\).");let p=derivative$2(f,t,e),d=["*"].concat(o.concat([p]));return d=simplify$2(d),e.push("And so \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(d)+"\\)."),d}e.push("Using the product rule, \\("+r+astToLatex$1.convert(n)+" = "+a.map(function(f,p){return a.map(function(d,m){return p===m?r+"\\left("+astToLatex$1.convert(f)+"\\right)":astToLatex$1.convert(d)}).join(" \\cdot ")}).join(" + ")+"\\).");let u=a.slice(),c=["+"].concat(a.map(function(f,p){return["*"].concat(u.map(function(d,m){if(p===m){let v=derivative$2(d,t,e);return v===1?null:v}else return d}).filter(function(d){return d!=null}))}));return c=simplify$2(c),e.push("So using the product rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(c)+"\\)."),c}if(i==="/"){let s=a[0],o=a[1];if(variables(o).indexOf(t)<0){e.push("By the constant multiple rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(["/",1,o])+" \\cdot "+r+"\\left("+astToLatex$1.convert(s)+"\\right)\\).");let d=derivative$2(s,t,e),m=textToAst$2.convert("(1/g)*d"),v=substitute(m,{d,g:o});return v=simplify$2(v),e.push("So \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(v)+"\\)."),v}if(variables(s).indexOf(t)<0){s!==1&&e.push("By the constant multiple rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(s)+" \\cdot "+r+"\\left("+astToLatex$1.convert(["/",1,o])+"\\right)\\)."),e.push("Since \\(\\frac{d}{du} \\frac{1}{u}\\) is \\(\\frac{-1}{u^2}\\), the chain rule gives \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(s)+"\\cdot \\frac{-1}{ "+astToLatex$1.convert(o)+"^2} \\cdot "+r+astToLatex$1.convert(o)+"\\).");let d=derivative$2(o,t,e),m=textToAst$2.convert("f * (-a/(g^2))"),v=substitute(m,{f:s,a:d,g:o});return v=simplify$2(v),e.push("So since \\(\\frac{d}{du} \\frac{1}{u}\\) is \\(\\frac{-1}{u^2}\\), the chain rule gives \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(v)+"\\)."),v}e.push("Using the quotient rule, \\("+r+astToLatex$1.convert(n)+" = \\frac{"+r+"\\left("+astToLatex$1.convert(s)+"\\right) \\cdot "+astToLatex$1.convert(o)+" - "+astToLatex$1.convert(s)+"\\cdot "+r+"\\left("+astToLatex$1.convert(o)+"\\right)}{ \\left( "+astToLatex$1.convert(o)+" \\right)^2} \\).");let u=derivative$2(s,t,e),c=derivative$2(o,t,e),f=textToAst$2.convert("(a * g - f * b)/(g^2)"),p=substitute(f,{a:u,b:c,f:s,g:o});return p=simplify$2(p),e.push("So using the quotient rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(p)+"\\)."),p}if(i==="^"){let s=a[0],o=a[1];if(variables(o).indexOf(t)<0){if(typeof s=="string"&&s==="x"){if(typeof o=="number"){let x=textToAst$2.convert("n * (f^m)"),N=substitute(x,{n:o,m:o-1,f:s});return N=simplify$2(N),e.push("By the power rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(o)+" \\cdot \\left("+astToLatex$1.convert(s)+"\\right)^{"+astToLatex$1.convert(["-",o,1])+"}\\)."),N}let g=textToAst$2.convert("n * (f^(n-1))"),b=substitute(g,{n:o,f:s});return b=simplify$2(b),e.push("By the power rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(o)+" \\cdot \\left("+astToLatex$1.convert(s)+"\\right)^{"+astToLatex$1.convert(["-",o,1])+"}\\)."),b}o!==1&&e.push("By the power rule and the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(o)+" \\cdot \\left("+astToLatex$1.convert(s)+"\\right)^{"+astToLatex$1.convert(["-",o,1])+"} \\cdot "+r+astToLatex$1.convert(s)+"\\).");let v=derivative$2(s,t,e);if(o===1)return v;if(typeof o=="number"){let g=textToAst$2.convert("n * (f^m) * a"),b=substitute(g,{n:o,m:o-1,f:s,a:v});return b=simplify$2(b),e.push("So by the power rule and the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(b)+"\\)."),b}let h=textToAst$2.convert("n * (f^(n-1)) * a"),y=substitute(h,{n:o,f:s,a:v});return y=simplify$2(y),e.push("So by the power rule and the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(y)+"\\)."),y}if(s==="e"&&math$19.define_e){if(typeof o=="string"&&o===t){let g=textToAst$2.convert("e^(f)"),b=substitute(g,{f:o});return b=simplify$2(b),e.push("The derivative of \\(e^"+astToLatex$1.convert(t)+"\\) is itself, that is, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(n)+"\\)."),b}e.push("Using the rule for \\(e^x\\) and the chain rule, we know \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(n)+" \\cdot "+r+astToLatex$1.convert(o)+"\\).");let v=textToAst$2.convert("e^(f)*d"),h=derivative$2(o,t,e),y=substitute(v,{f:o,d:h});return y=simplify$2(y),e.push("So using the rule for \\(e^x\\) and the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(y)+"\\)."),y}if(typeof s=="number"){if(typeof o=="string"&&o===t){let x=textToAst$2.convert("a^(f) * log(a)"),N=substitute(x,{a:s,f:o});return N=simplify$2(N),e.push("The derivative of \\(a^"+astToLatex$1.convert(t)+"\\) is \\(a^{"+astToLatex$1.convert(t)+"} \\, \\log a\\), that is, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(N)+"\\)."),N}let v=textToAst$2.convert("a^(f) * log(a)"),h=substitute(v,{a:s,f:o});e.push("Using the rule for \\(a^x\\) and the chain rule, we know \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(h)+" \\cdot "+r+astToLatex$1.convert(o)+"\\).");let y=textToAst$2.convert("a^(b)*log(a)*d"),g=derivative$2(o,t,e),b=substitute(y,{a:s,b:o,d:g});return b=simplify$2(b),e.push("So using the rule for \\(a^x\\) and the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(b)+"\\)."),b}let u=s,c=o;e.push("Recall the general rule for exponents, namely that \\(\\frac{d}{dx} u(x)^{v(x)} = u(x)^{v(x)} \\cdot \\left( v'(x) \\cdot \\log u(x) + \\frac{v(x) \\cdot u'(x)}{u(x)} \\right)\\).  In this case, \\(u(x) = "+astToLatex$1.convert(u)+"\\) and \\(v(x) = "+astToLatex$1.convert(c)+"\\).");let f=derivative$2(u,t,e),p=derivative$2(c,t,e),d=textToAst$2.convert("(f^g)*(b * log(f) + (g * a)/f)"),m=substitute(d,{a:f,b:p,f:u,g:c});return m=simplify$2(m),e.push("So by the general rule for exponents, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(m)+"\\)."),m}if(i==="apply"&&!(a[0]in derivatives)){let s=a[1];e.push("By the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(substitute(["apply",a[0]+"'","x"],{x:s}))+" \\cdot "+r+astToLatex$1.convert(s)+"\\).");let o=["*",substitute(["apply",a[0]+"'","x"],{x:s}),derivative$2(s,t,e)];return o=simplify$2(o),e.push("So by the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(o)+"\\)."),o}if(i==="apply"&&a[0]in derivatives||i in derivatives){let s=!1;i==="apply"&&(i=a[0],a=a.slice(1),s=!0);let o=a[0];if(typeof o=="number"){let u=0;return e.push("The derivative of a constant is zero so \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(u)+"\\)."),u}else if(typeof o=="string"&&o===t){let u=["*",substitute(derivatives[i],{x:o})];return u=simplify$2(u),e.push("It is the case that \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(u)+"\\)."),u}else if(typeof o=="string"&&o!==t){let u=0;return e.push("Since the derivative of a constant is zero, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(u)+"\\)."),u}else{let u=[i,"u"];s&&(u=["apply"].concat(u)),e.push("Recall \\(\\frac{d}{du}"+astToLatex$1.convert(u)+" = "+astToLatex$1.convert(derivative$2(u,"u",[]))+"\\)."),e.push("By the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(substitute(derivatives[i],{x:o}))+" \\cdot "+r+astToLatex$1.convert(o)+"\\).");let c=["*",substitute(derivatives[i],{x:o}),derivative$2(o,t,e)];return c=simplify$2(c),e.push("So by the chain rule, \\("+r+astToLatex$1.convert(n)+" = "+astToLatex$1.convert(c)+"\\)."),c}}return 0}function lowercaseFirstLetter(l){return l.charAt(0).toLowerCase()+l.slice(1)}function simplify_story(l){for(let t=l.length-1;t>=1;t--)l[t]===l[t-1]&&l.splice(t,1);for(let t=0;t<l.length;t++)for(let e=t+1;e<l.length;e++)l[t]===l[e]&&(l[e]="Again, "+lowercaseFirstLetter(l[e]));return l}function derivative_story(l,t){var e=[];return derivative$2(l,t,e),e=simplify_story(e),e}let derivativeStory=derivative_story;var differentiation=Object.freeze({derivative:derivative$2,derivative_story,derivativeStory});let unicode_operators={"+":function(l){return l.join(" ")},"-":function(l){return"- "+l[0]},"*":function(l){return l.join(" ")},"/":function(l){return l[0]+"/"+l[1]},_:function(l){return l[0]+"_"+l[1]},"^":function(l){return l[0]+"^"+l[1]},prime:function(l){return l[0]+"'"},tuple:function(l){return"( "+l.join(", ")+" )"},array:function(l){return"[ "+l.join(", ")+" ]"},list:function(l){return l.join(", ")},set:function(l){return"{ "+l.join(", ")+" }"},vector:function(l){return"( "+l.join(", ")+" )"},interval:function(l){return"( "+l.join(", ")+" )"},matrix:function(l){return"( "+l.join(", ")+" )"},and:function(l){return l.join(" and ")},or:function(l){return l.join(" or ")},not:function(l){return"not "+l[0]},"=":function(l){return l.join(" = ")},"<":function(l){return l.join(" < ")},">":function(l){return l.join(" > ")},lts:function(l){return l.join(" < ")},gts:function(l){return l.join(" > ")},le:function(l){return l.join(" \u2264 ")},ge:function(l){return l.join(" \u2265 ")},ne:function(l){return l.join(" \u2260 ")},in:function(l){return l[0]+" \u2208 "+l[1]},notin:function(l){return l[0]+" \u2209 "+l[1]},ni:function(l){return l[0]+" \u220B "+l[1]},notni:function(l){return l[0]+" \u220C "+l[1]},subset:function(l){return l[0]+" \u2282 "+l[1]},notsubset:function(l){return l[0]+" \u2284 "+l[1]},superset:function(l){return l[0]+" \u2283 "+l[1]},notsuperset:function(l){return l[0]+" \u2285 "+l[1]},union:function(l){return l.join(" \u222A ")},intersect:function(l){return l.join(" \u2229 ")},derivative_leibniz:function(l){return"d"+l[0]+"/d"+l[1]},partial_derivative_leibniz:function(l){return"\u2202"+l[0]+"/\u2202"+l[1]},"|":function(l){return l[0]+" | "+l[1]},":":function(l){return l[0]+" : "+l[1]}},nonunicode_operators={"+":function(l){return l.join(" ")},"-":function(l){return"- "+l[0]},"*":function(l){return l.join(" ")},"/":function(l){return l[0]+"/"+l[1]},_:function(l){return l[0]+"_"+l[1]},"^":function(l){return l[0]+"^"+l[1]},prime:function(l){return l[0]+"'"},tuple:function(l){return"( "+l.join(", ")+" )"},array:function(l){return"[ "+l.join(", ")+" ]"},list:function(l){return l.join(", ")},set:function(l){return"{ "+l.join(", ")+" }"},vector:function(l){return"( "+l.join(", ")+" )"},interval:function(l){return"( "+l.join(", ")+" )"},matrix:function(l){return"( "+l.join(", ")+" )"},and:function(l){return l.join(" and ")},or:function(l){return l.join(" or ")},not:function(l){return"not "+l[0]},"=":function(l){return l.join(" = ")},"<":function(l){return l.join(" < ")},">":function(l){return l.join(" > ")},lts:function(l){return l.join(" < ")},gts:function(l){return l.join(" > ")},le:function(l){return l.join(" <= ")},ge:function(l){return l.join(" >= ")},ne:function(l){return l.join(" ne ")},in:function(l){return l[0]+" elementof "+l[1]},notin:function(l){return l[0]+" notelementof "+l[1]},ni:function(l){return l[0]+" containselement "+l[1]},notni:function(l){return l[0]+" notcontainselement "+l[1]},subset:function(l){return l[0]+" subset "+l[1]},notsubset:function(l){return l[0]+" notsubset "+l[1]},superset:function(l){return l[0]+" superset "+l[1]},notsuperset:function(l){return l[0]+" notsuperset "+l[1]},union:function(l){return l.join(" union ")},intersect:function(l){return l.join(" intersect ")},derivative_leibniz:function(l){return"d"+l[0]+"/d"+l[1]},partial_derivative_leibniz:function(l){return"\u2202"+l[0]+"/\u2202"+l[1]},"|":function(l){return l[0]+" | "+l[1]},":":function(l){return l[0]+" : "+l[1]}},output_unicodeDefault=!0;class astToText{constructor({output_unicode:t=output_unicodeDefault}={}){this.output_unicode=t,this.operators=unicode_operators,t||(this.operators=nonunicode_operators)}convert(t){return this.statement(t)}statement(t){if(typeof t=="string"||typeof t=="number")return this.single_statement(t);let e=t[0],n=t.slice(1);if(e==="ldots")return"...";if(!(e in this.operators)&&e!=="apply")throw new Error("Badly formed ast: operator "+e+" not recognized.");return e==="and"||e==="or"?this.operators[e](n.map(function(r,i){let a=this.single_statement(r);return a.toString().match(/ /)&&!a.toString().match(/^\(.*\)$/)?"("+a+")":a}.bind(this))):this.single_statement(t)}single_statement(t){if(typeof t=="string"||typeof t=="number")return this.expression(t);let e=t[0],n=t.slice(1);if(e==="not")return this.operators[e](n.map(function(r,i){let a=this.single_statement(r);return a.toString().match(/ /)&&!a.toString().match(/^\(.*\)$/)?"("+a+")":a}.bind(this)));if(e==="="||e==="ne"||e==="<"||e===">"||e==="le"||e==="ge"||e==="in"||e==="notin"||e==="ni"||e==="notni"||e==="subset"||e==="notsubset"||e==="superset"||e==="notsuperset")return this.operators[e](n.map(function(r,i){return this.expression(r)}.bind(this)));if(e==="lts"||e==="gts"){let r=n[0],i=n[1];if(r[0]!=="tuple"||i[0]!=="tuple")throw new Error("Badly formed ast");let a=this.expression(r[1]);for(let s=1;s<r.length-1;s++)i[s]?e==="lts"?a+=" < ":a+=" > ":e==="lts"?this.output_unicode?a+=" \u2264 ":a+=" <= ":this.output_unicode?a+=" \u2265 ":a+=" >= ",a+=this.expression(r[s+1]);return a}return this.expression(t)}expression(t){if(typeof t=="string"||typeof t=="number")return this.term(t);let e=t[0],n=t.slice(1);return e==="+"?this.operators[e](n.map(function(r,i){return i>0?this.termWithPlusIfNotNegated(r):this.term(r)}.bind(this))):e==="union"||e==="intersect"?this.operators[e](n.map(function(r,i){return this.term(r)}.bind(this))):this.term(t)}term(t){if(typeof t=="string"||typeof t=="number")return this.factor(t);let e=t[0],n=t.slice(1);return e==="-"?this.operators[e](n.map(function(r,i){return this.term(r)}.bind(this))):e==="*"?this.operators[e](n.map(function(r,i){let a;return i>0?(a=this.factorWithParenthesesIfNegated(r),a.toString().match(/^[0-9]/)?"* "+a:a):this.factor(r)}.bind(this))):e==="/"?this.operators[e](n.map(function(r,i){return this.factor(r)}.bind(this))):this.factor(t)}symbolConvert(t){let e={alpha:"\u03B1",beta:"\u03B2",Gamma:"\u0393",gamma:"\u03B3",Delta:"\u0394",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",Theta:"\u03F4",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",Lambda:"\u039B",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",Xi:"\u039E",xi:"\u03BE",Pi:"\u03A0",pi:"\u03C0",rho:"\u03C1",Sigma:"\u03A3",sigma:"\u03C3",tau:"\u03C4",Upsilon:"\u03A5",upsilon:"\u03C5",Phi:"\u03A6",phi:"\u03D5",Psi:"\u03A8",psi:"\u03C8",Omega:"\u03A9",omega:"\u03C9"};return this.output_unicode&&t in e?e[t]:t}simple_factor_or_function_or_parens(t){let e=this.factor(t);return e.toString().length===1||typeof t=="string"||t[0]==="apply"||e.toString().match(/^\(.*\)$/)?!0:typeof t=="number"?t>=0&&!t.toString().includes("e"):!1}factor(t){if(typeof t=="string")return this.symbolConvert(t);if(typeof t=="number"){if(t===Infinity)return this.output_unicode?"\u221E":"infinity";if(t===-Infinity)return this.output_unicode?"-\u221E":"-infinity";{let r=t.toString(),i=r.indexOf("e");if(i===-1)return r;let a=r.substring(0,i),s=r.substring(i+1);return s[0]==="+"?a+" * 10^"+s.substring(1):a+" * 10^("+s+")"}}let e=t[0],n=t.slice(1);if(e==="^"){let r=this.factor(n[0]),i=n[0];for(;i[0]==="prime";)i=i[1];this.simple_factor_or_function_or_parens(i)||i[0]==="_"&&typeof i[1]=="string"||(r="("+r.toString()+")");let a=this.factor(n[1]);return this.simple_factor_or_function_or_parens(n[1])||(a="("+a.toString()+")"),r+"^"+a}else{if(e==="_")return this.operators[e](n.map(function(r,i){let a=this.factor(r);return this.simple_factor_or_function_or_parens(r)?a:"("+a.toString()+")"}.bind(this)));if(e==="prime"){let r=n[0],i=1;for(;r[0]==="prime";)i+=1,r=r[1];let a=this.factor(r);this.simple_factor_or_function_or_parens(r)||r[0]==="_"&&typeof r[1]=="string"||(a="("+a.toString()+")");for(let s=0;s<i;s++)a+="'";return a}else{if(e==="-")return this.operators[e](n.map(function(r,i){return this.factor(r)}.bind(this)));if(e==="tuple"||e==="array"||e==="list"||e==="set"||e==="vector"||e==="|"||e===":")return this.operators[e](n.map(function(r,i){return this.statement(r)}.bind(this)));if(e==="interval"){let r=n[0],i=n[1];if(r[0]!=="tuple"||i[0]!=="tuple")throw new Error("Badly formed ast");let a=this.statement(r[1])+", "+this.statement(r[2]);return i[1]?a="[ "+a:a="( "+a,i[2]?a=a+" ]":a=a+" )",a}else if(e==="matrix"){let r=n[0],i=n[1],a="[ ";for(let s=0;s<r[1];s+=1){a=a+"[ ";for(let o=0;o<r[2];o+=1)a=a+this.statement(i[s+1][o+1]),o<r[2]-1&&(a=a+","),a=a+" ";a=a+"]",s<r[1]-1&&(a=a+","),a=a+" "}return a=a+"]",a}else if(e==="derivative_leibniz"||e==="partial_derivative_leibniz"){let r="d";e==="partial_derivative_leibniz"&&(r="\u2202");let i=n[0],a=n[1],s=1,o="";Array.isArray(i)?(o=i[1],s=i[2]):o=i;let u=r;s>1&&(u=u+"^"+s),u=u+this.symbolConvert(o)+"/";let c=1;Array.isArray(a)&&(c=a.length-1);for(let f=1;f<=c;f++){let p=a[f],d=1,m="";Array.isArray(p)?(m=p[1],d=p[2]):m=p,u=u+r+this.symbolConvert(m),d>1&&(u=u+"^"+d)}return u}else if(e==="apply"){if(n[0]==="abs")return"|"+this.statement(n[1])+"|";if(n[0]==="factorial"){let a=this.factor(n[1]);return this.simple_factor_or_function_or_parens(n[1])||n[1][0]==="_"&&typeof n[1][1]=="string"?a+"!":"("+a.toString()+")!"}let r=this.factor(n[0]),i=this.statement(n[1]);return n[1][0]!=="tuple"&&(i="("+i+")"),r+i}else return"("+this.statement(t)+")"}}}factorWithParenthesesIfNegated(t){let e=this.factor(t);return e.toString().match(/^-/)?"("+e.toString()+")":e}termWithPlusIfNotNegated(t){let e=this.term(t);return e.toString().match(/^-/)?e:"+ "+e.toString()}}var astToText$1=new astToText;function subscripts_to_strings(l,t=!1){var e=get_tree(l);if(!Array.isArray(e))return e;let n=e[0],r=e.slice(1);return n==="_"&&(t||r.every(i=>["number","string"].includes(typeof i)))?astToText$1.convert(e):[n].concat(r.map(i=>subscripts_to_strings(i,t)))}function strings_to_subscripts(l){var t=get_tree(l);if(typeof t=="string"){let r=t.match(/^([0-9a-zA-Z]+)_([a-zA-Z]+|[0-9]+)$/);if(r){let i=Number(r[1]);isNaN(i)&&(i=r[1]);let a=Number(r[2]);return isNaN(a)&&(a=r[2]),["_",i,a]}else return t}if(!Array.isArray(t))return t;let e=t[0],n=t.slice(1);return[e].concat(n.map(strings_to_subscripts))}var normalization=Object.freeze({normalize_function_names,normalize_applied_functions,substitute_abs,default_order,constants_to_floats,tuples_to_vectors,to_intervals,subscripts_to_strings,strings_to_subscripts});function generate_random_integer(l,t,e){return l=math$19.ceil(l),t=math$19.floor(t),math$19.floor(e()*(t-l+1))+l}let equals=function({expr:l,other:t,randomBindings:e,expr_context:n,other_context:r,relative_tolerance:i=1e-12,absolute_tolerance:a=0,tolerance_for_zero:s=1e-15,allowed_error_in_numbers:o=0,include_error_in_number_exponents:u=!1,allowed_error_is_absolute:c=!1,rng:f}){if(Array.isArray(l.tree)&&Array.isArray(t.tree)){let p=l.tree[0],d=l.tree.slice(1),m=t.tree[0],v=t.tree.slice(1);if(p==="tuple"||p==="vector"||p==="list"||p==="array"||p==="matrix"||p==="interval"){if(m!==p||v.length!==d.length)return!1;for(let h=0;h<d.length;h++)if(!equals({expr:n.fromAst(d[h]),other:r.fromAst(v[h]),randomBindings:e,expr_context:n,other_context:r,relative_tolerance:i,absolute_tolerance:a,tolerance_for_zero:s,allowed_error_in_numbers:o,include_error_in_number_exponents:u,allowed_error_is_absolute:c,rng:f}))return!1;return!0}if(d.length===2&&["=",">","<","ge","le"].includes(p)){if(v.length!==2||(p===">"?(p="<",d=[d[1],d[0]]):p==="ge"&&(p="le",d=[d[1],d[0]]),m===">"?(m="<",v=[v[1],v[0]]):m==="ge"&&(m="le",v=[v[1],v[0]]),p!==m))return!1;let h=["+",d[0],["-",d[1]]],y=["+",v[0],["-",v[1]]],g=p!=="=";return component_equals({expr:n.fromAst(h),other:r.fromAst(y),randomBindings:e,expr_context:n,other_context:r,allow_proportional:!0,require_positive_proportion:g,relative_tolerance:i,absolute_tolerance:a,tolerance_for_zero:s,allowed_error_in_numbers:o,include_error_in_number_exponents:u,allowed_error_is_absolute:c,rng:f})}}return component_equals({expr:l,other:t,randomBindings:e,expr_context:n,other_context:r,relative_tolerance:i,absolute_tolerance:a,tolerance_for_zero:s,allowed_error_in_numbers:o,include_error_in_number_exponents:u,allowed_error_is_absolute:c,rng:f})},component_equals=function({expr:l,other:t,randomBindings:e,expr_context:n,other_context:r,allow_proportional:i=!1,require_positive_proportion:a=!1,relative_tolerance:s,absolute_tolerance:o,tolerance_for_zero:u,allowed_error_in_numbers:c,include_error_in_number_exponents:f,allowed_error_is_absolute:p,rng:d}){var m=Number.MAX_VALUE*1e-20,v=0,h=10,y=100;l=l.normalize_function_names(),t=t.normalize_function_names(),l=l.subscripts_to_strings(),t=t.subscripts_to_strings();var g=[l.variables(),t.variables()];g=g.reduce(function(W,G){return W.concat(G)}),g=g.reduce(function(W,G){return W.indexOf(G)<0&&W.push(G),W},[]),math$19.define_pi&&(g=g.filter(function(W){return W!=="pi"})),math$19.define_i&&(g=g.filter(function(W){return W!=="i"})),math$19.define_e&&(g=g.filter(function(W){return W!=="e"}));var b=[];for(let W=0;W<g.length;W++)(is_integer_ast(g[W],n.assumptions)||is_integer_ast(g[W],r.assumptions))&&b.push(g[W]);var x=[l.functions(),t.functions()];x=x.reduce(function(W,G){return W.concat(G)}),x=x.reduce(function(W,G){return W.indexOf(G)<0&&W.push(G),W},[]),x=x.filter(function(W){return W.length==1});try{var N=l.f(),C=t.f()}catch(W){return l.equalsViaSyntax(t)}let _,w,A;if(c>0){let W=replace_numbers_with_parameters({expr:l,variables:g,include_exponents:f});_=n.fromAst(W.expr_with_params),w=W.parameters;let G=Object.keys(w);if(G.length>0){let P=_.derivative(G[0]);if(p||(P=P.multiply(w[G[0]])),G.length>1)for(let ne of G.slice(1)){let Y=_.derivative(ne);p||(Y=Y.multiply(w[ne])),P=P.add(Y)}let Q=P.multiply(c);try{A=Q.f()}catch(ne){}}}var $=1,S=[10,1,100,.1,1e3,.01],D=0;let V=0,I=!0,q=0;for(let W=0;W<10*y;W++){try{var K=E(S[D],d)}catch(G){continue}if(K.always_zero===!1&&(I=!1),!K.equal&&!K.out_of_bounds&&!K.always_zero&&K.sufficient_finite_values!==!1&&(q++,q>y))return!1;if(K.equal)if(K.always_zero){if(!I)continue;if(V+=1,V>5&&(D+=1,V=0),D>=S.length)return!0;continue}else return!0}return!1;function E(W,G){var P=e(G,g,W);for(let he=0;he<b.length;he++)P[b[he]]=generate_random_integer(-10,10,G);for(let he=0;he<x.length;he++){var Q=generate_random_integer(-10,10,G),ne=generate_random_integer(-10,10,G),Y=generate_random_integer(-10,10,G);P[x[he]]=function(H){return math$19.add(math$19.multiply(math$19.add(math$19.multiply(Q,H),ne),H),Y)}}var se;A&&(se=Object.assign({},P,w));var pe=N(P),oe=C(P),ve=math$19.abs(pe),O=math$19.abs(oe);if(!(ve<m&&O<m))return{out_of_bounds:!0,always_zero:!1};if(!((ve===0||ve>v)&&(O===0||O>v)))return{out_of_bounds:!0,always_zero:!1};var z=Math.min(ve,O),Z=Math.max(ve,O),J=1;let R=0;if(A){try{R=math$19.abs(A(se))}catch(he){return{equal_at_start:!1,always_zero:!1}}if(!Number.isFinite(R))return{equal_at_start:!1,always_zero:!1}}if(R+=z*s,R=Math.min(R,.1*z),R===0&&(pe===0||oe===0)?R+=u:R+=o,!(Z===0||math$19.abs(math$19.subtract(pe,oe))<R)){if(!i)return{equal_at_start:!1,always_zero:!1};if(ve===0||O===0)return{equal_at_start:!1,always_zero:!1};if(J=math$19.divide(pe,oe),a&&!(J>0))return{equal_at_start:!1,always_zero:!1}}var F=Z===0,X=0;for(let he=0;he<100;he++){var te=e(G,g,$/100,P);for(let H=0;H<b.length;H++)te[b[H]]=generate_random_integer(-10,10,G);for(let H=0;H<x.length;H++){var Q=generate_random_integer(-10,10,G),ne=generate_random_integer(-10,10,G),Y=generate_random_integer(-10,10,G);te[x[H]]=function(Ce){return math$19.add(math$19.multiply(math$19.add(math$19.multiply(Q,Ce),ne),Ce),Y)}}var de;A&&(de=Object.assign({},te,w));try{pe=N(te),oe=math$19.multiply(C(te),J)}catch(H){continue}if(ve=math$19.abs(pe),O=math$19.abs(oe),ve<m&&O<m){z=Math.min(ve,O),Z=Math.max(ve,O),X++;let H=0;if(A){try{H=math$19.abs(A(de))}catch(re){continue}if(!Number.isFinite(H))continue}if(H+=z*s,H=Math.min(H,.1*z),H===0&&(pe===0||oe===0)?H+=u:H+=o,!(Z===0||math$19.abs(math$19.subtract(pe,oe))<H))return{equality_in_middle:!1,always_zero:!1};if(F=F&&Z===0,X>=h)return{equal:!0,always_zero:F}}}return{sufficient_finite_values:!1,always_zero:F}}};function replace_numbers_with_parameters({expr:l,variables:t,include_exponents:e=!1}){let n={},r=0;function i(){r++;let s="par"+r;for(;t.includes(s);)r++,s="par"+r;return s}function a(s){if(typeof s=="number"){if(s===0)return s;{let c=i();return n[c]=s,c}}if(typeof s=="string"){if(s==="pi"){if(math$19.define_pi){let c=i();return n[c]=math$19.PI,c}}else if(s==="e"&&math$19.define_e){let c=i();return n[c]=math$19.e,c}return s}if(!Array.isArray(s))return s;let o=s[0],u=s.slice(1);return o==="^"&&!e?[o,a(u[0]),u[1]]:[o,...u.map(a)]}return l=l.evaluate_numbers({max_digits:Infinity}),{expr_with_params:a(l.tree),parameters:n}}var alea=createCommonjsModule(function(l){(function(t,e,n){function r(o){var u=this,c=s();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(o),u.s0<0&&(u.s0+=1),u.s1-=c(o),u.s1<0&&(u.s1+=1),u.s2-=c(o),u.s2<0&&(u.s2+=1),c=null}function i(o,u){return u.c=o.c,u.s0=o.s0,u.s1=o.s1,u.s2=o.s2,u}function a(o,u){var c=new r(o),f=u&&u.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,f&&(typeof f=="object"&&i(f,c),p.state=function(){return i(c,{})}),p}function s(){var o=4022871197,u=function(c){c=String(c);for(var f=0;f<c.length;f++){o+=c.charCodeAt(f);var p=.02519603282416938*o;o=p>>>0,p-=o,p*=o,o=p>>>0,p-=o,o+=p*4294967296}return(o>>>0)*23283064365386963e-26};return u}e&&e.exports?e.exports=a:n&&n.amd?n(function(){return a}):this.alea=a})(commonjsGlobal,l,!1)}),xor128=createCommonjsModule(function(l){(function(t,e,n){function r(s){var o=this,u="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var f=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^f^f>>>8},s===(s|0)?o.x=s:u+=s;for(var c=0;c<u.length+64;c++)o.x^=u.charCodeAt(c)|0,o.next()}function i(s,o){return o.x=s.x,o.y=s.y,o.z=s.z,o.w=s.w,o}function a(s,o){var u=new r(s),c=o&&o.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,d=(u.next()>>>0)/4294967296,m=(p+d)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}e&&e.exports?e.exports=a:n&&n.amd?n(function(){return a}):this.xor128=a})(commonjsGlobal,l,!1)}),xorwow=createCommonjsModule(function(l){(function(t,e,n){function r(s){var o=this,u="";o.next=function(){var f=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(f^f<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,s===(s|0)?o.x=s:u+=s;for(var c=0;c<u.length+64;c++)o.x^=u.charCodeAt(c)|0,c==u.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function i(s,o){return o.x=s.x,o.y=s.y,o.z=s.z,o.w=s.w,o.v=s.v,o.d=s.d,o}function a(s,o){var u=new r(s),c=o&&o.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,d=(u.next()>>>0)/4294967296,m=(p+d)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}e&&e.exports?e.exports=a:n&&n.amd?n(function(){return a}):this.xorwow=a})(commonjsGlobal,l,!1)}),xorshift7=createCommonjsModule(function(l){(function(t,e,n){function r(s){var o=this;o.next=function(){var c=o.x,f=o.i,p,d;return p=c[f],p^=p>>>7,d=p^p<<24,p=c[f+1&7],d^=p^p>>>10,p=c[f+3&7],d^=p^p>>>3,p=c[f+4&7],d^=p^p<<7,p=c[f+7&7],p=p^p<<13,d^=p^p<<9,c[f]=d,o.i=f+1&7,d};function u(c,f){var p,d,m=[];if(f===(f|0))d=m[0]=f;else for(f=""+f,p=0;p<f.length;++p)m[p&7]=m[p&7]<<15^f.charCodeAt(p)+m[p+1&7]<<13;for(;m.length<8;)m.push(0);for(p=0;p<8&&m[p]===0;++p);for(p==8?d=m[7]=-1:d=m[p],c.x=m,c.i=0,p=256;p>0;--p)c.next()}u(o,s)}function i(s,o){return o.x=s.x.slice(),o.i=s.i,o}function a(s,o){s==null&&(s=+new Date);var u=new r(s),c=o&&o.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,d=(u.next()>>>0)/4294967296,m=(p+d)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(c.x&&i(c,u),f.state=function(){return i(u,{})}),f}e&&e.exports?e.exports=a:n&&n.amd?n(function(){return a}):this.xorshift7=a})(commonjsGlobal,l,!1)}),xor4096=createCommonjsModule(function(l){(function(t,e,n){function r(s){var o=this;o.next=function(){var c=o.w,f=o.X,p=o.i,d,m;return o.w=c=c+1640531527|0,m=f[p+34&127],d=f[p=p+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,m=f[p]=m^d,o.i=p,m+(c^c>>>16)|0};function u(c,f){var p,d,m,v,h,y=[],g=128;for(f===(f|0)?(d=f,f=null):(f=f+"\0",d=0,g=Math.max(g,f.length)),m=0,v=-32;v<g;++v)f&&(d^=f.charCodeAt((v+32)%f.length)),v===0&&(h=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,v>=0&&(h=h+1640531527|0,p=y[v&127]^=d+h,m=p==0?m+1:0);for(m>=128&&(y[(f&&f.length||0)&127]=-1),m=127,v=4*128;v>0;--v)d=y[m+34&127],p=y[m=m+1&127],d^=d<<13,p^=p<<17,d^=d>>>15,p^=p>>>12,y[m]=d^p;c.w=h,c.X=y,c.i=m}u(o,s)}function i(s,o){return o.i=s.i,o.w=s.w,o.X=s.X.slice(),o}function a(s,o){s==null&&(s=+new Date);var u=new r(s),c=o&&o.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,d=(u.next()>>>0)/4294967296,m=(p+d)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(c.X&&i(c,u),f.state=function(){return i(u,{})}),f}e&&e.exports?e.exports=a:n&&n.amd?n(function(){return a}):this.xor4096=a})(commonjsGlobal,l,!1)}),tychei=createCommonjsModule(function(l){(function(t,e,n){function r(s){var o=this,u="";o.next=function(){var f=o.b,p=o.c,d=o.d,m=o.a;return f=f<<25^f>>>7^p,p=p-d|0,d=d<<24^d>>>8^m,m=m-f|0,o.b=f=f<<20^f>>>12^p,o.c=p=p-d|0,o.d=d<<16^p>>>16^m,o.a=m-f|0},o.a=0,o.b=0,o.c=2654435769|0,o.d=1367130551,s===Math.floor(s)?(o.a=s/4294967296|0,o.b=s|0):u+=s;for(var c=0;c<u.length+20;c++)o.b^=u.charCodeAt(c)|0,o.next()}function i(s,o){return o.a=s.a,o.b=s.b,o.c=s.c,o.d=s.d,o}function a(s,o){var u=new r(s),c=o&&o.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,d=(u.next()>>>0)/4294967296,m=(p+d)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}e&&e.exports?e.exports=a:n&&n.amd?n(function(){return a}):this.tychei=a})(commonjsGlobal,l,!1)}),require$$2={},seedrandom$1=createCommonjsModule(function(l){(function(t,e,n){var r=256,i=6,a=52,s="random",o=n.pow(r,i),u=n.pow(2,a),c=u*2,f=r-1,p;function d(x,N,C){var _=[];N=N==!0?{entropy:!0}:N||{};var w=y(h(N.entropy?[x,b(e)]:x??g(),3),_),A=new m(_),$=function(){for(var S=A.g(i),D=o,V=0;S<u;)S=(S+V)*r,D*=r,V=A.g(1);for(;S>=c;)S/=2,D/=2,V>>>=1;return(S+V)/D};return $.int32=function(){return A.g(4)|0},$.quick=function(){return A.g(4)/4294967296},$.double=$,y(b(A.S),e),(N.pass||C||function(S,D,V,I){return I&&(I.S&&v(I,A),S.state=function(){return v(A,{})}),V?(n[s]=S,D):S})($,w,"global"in N?N.global:this==n,N.state)}function m(x){var N,C=x.length,_=this,w=0,A=_.i=_.j=0,$=_.S=[];for(C||(x=[C++]);w<r;)$[w]=w++;for(w=0;w<r;w++)$[w]=$[A=f&A+x[w%C]+(N=$[w])],$[A]=N;(_.g=function(S){for(var D,V=0,I=_.i,q=_.j,K=_.S;S--;)D=K[I=f&I+1],V=V*r+K[f&(K[I]=K[q=f&q+D])+(K[q]=D)];return _.i=I,_.j=q,V})(r)}function v(x,N){return N.i=x.i,N.j=x.j,N.S=x.S.slice(),N}function h(x,N){var C=[],_=typeof x,w;if(N&&_=="object")for(w in x)try{C.push(h(x[w],N-1))}catch(A){}return C.length?C:_=="string"?x:x+"\0"}function y(x,N){for(var C=x+"",_,w=0;w<C.length;)N[f&w]=f&(_^=N[f&w]*19)+C.charCodeAt(w++);return b(N)}function g(){try{var x;return p&&(x=p.randomBytes)?x=x(r):(x=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(x)),b(x)}catch(_){var N=t.navigator,C=N&&N.plugins;return[+new Date,t,C,t.screen,b(e)]}}function b(x){return String.fromCharCode.apply(0,x)}if(y(n.random(),e),l.exports){l.exports=d;try{p=require$$2}catch(x){}}else n["seed"+s]=d})(typeof self!="undefined"?self:commonjsGlobal,[],Math)});seedrandom$1.alea=alea,seedrandom$1.xor128=xor128,seedrandom$1.xorwow=xorwow,seedrandom$1.xorshift7=xorshift7,seedrandom$1.xor4096=xor4096,seedrandom$1.tychei=tychei;var seedrandom$2=seedrandom$1;function randomComplexBindings(l,t,e,n){var r={};return n===void 0?t.forEach(function(i){r[i]=math$19.complex(l()*2*e-e,l()*2*e-e)}):t.forEach(function(i){r[i]=math$19.complex(n[i].re+l()*2*e-e,n[i].im+l()*2*e-e)}),r}let equals$1=function(l,t,{relative_tolerance:e=1e-12,absolute_tolerance:n=0,tolerance_for_zero:r=1e-15,allowed_error_in_numbers:i=0,include_error_in_number_exponents:a=!1,allowed_error_is_absolute:s=!1}={}){let o=seedrandom$2("complex_seed");return!l.isAnalytic({allow_abs:!0,allow_relation:!0})||!t.isAnalytic({allow_abs:!0,allow_relation:!0})?!1:equals({expr:l,other:t,randomBindings:randomComplexBindings,expr_context:l.context,other_context:t.context,relative_tolerance:e,absolute_tolerance:n,tolerance_for_zero:r,allowed_error_in_numbers:i,include_error_in_number_exponents:a,allowed_error_is_absolute:s,rng:o})};function randomRealBindings(l,t,e,n){var r={};return n===void 0?t.forEach(function(i){r[i]=l()*2*e-e}):t.forEach(function(i){r[i]=n[i]+l()*2*e-e}),r}let equals$2=function(l,t,{relative_tolerance:e=1e-12,absolute_tolerance:n=0,tolerance_for_zero:r=1e-15,allowed_error_in_numbers:i=0,include_error_in_number_exponents:a=!1,allowed_error_is_absolute:s=!1}={}){if(!l.isAnalytic()||!t.isAnalytic())return!1;let o=seedrandom("real_seed");return equals({expr:l,other:t,randomBindings:randomRealBindings,expr_context:l.context,other_content:t.context,relative_tolerance:e,absolute_tolerance:n,tolerance_for_zero:r,allowed_error_in_numbers:i,include_error_in_number_exponents:a,allowed_error_is_absolute:s,rng:o})},equals$3=function(l,t,{allowed_error_in_numbers:e=0,include_error_in_number_exponents:n=!1,allowed_error_is_absolute:r=!1}={}){return equal$2(l.tree,t.tree,{allowed_error_in_numbers:e,include_error_in_number_exponents:n,allowed_error_is_absolute:r})},equals$$1=function(l,t,{min_elements_match:e=3,match_partial:n=!1}={}){if(!is_discrete_infinite_set(l))return!1;if(is_discrete_infinite_set(t)){var r=[];let i=l.context.get_assumptions(l);if(i!==void 0&&r.push(i),i=t.context.get_assumptions(t),i!==void 0&&r.push(i),r.length===0?r=void 0:r.length===1?r=r[0]:r=clean_assumptions(["and"].concat(r)),n){let a=contained_in(l.tree,t.tree,r,n);if(a===!1)return 0;let s=contained_in(t.tree,l.tree,r,n);return s===!1?0:a===!0?s===!0?1:s:s===!0?a:Math.min(a,s)}else return contained_in(l.tree,t.tree,r,n)&&contained_in(t.tree,l.tree,r,n)}else{let i=t.tree;if(i[0]!=="list")return!1;let a=i.length-2;if(i[a+1][0]!=="ldots"||a<e)return!1;let s=i.slice(0,a+1),o=sequence_from_discrete_infinite(l,a);return o?(o=["list"].concat(o),equals$5(l.context.from(o),t.context.from(s))):!1}};function is_discrete_infinite_set(l){var t=l.tree;if(!Array.isArray(t)||t[0]!=="discrete_infinite_set")return!1;var e=t.slice(1);for(var n of e)if(!Array.isArray(n)||n[0]!=="tuple"||n.length!==5)return!1;return!0}function contained_in(l,t,e,n){if(l[0]==="discrete_infinite_set")if(n){let p=0;for(let m of l.slice(1)){let v=contained_in(m,t,e,n);v===!0?p++:v!==!1&&(p+=v)}let d=l.length-1;return p===d?!0:p===0?!1:p/d}else return l.slice(1).every(p=>contained_in(p,t,e));var r=l[1],i=l[2],a=l[3],s=l[4];if(!Array.isArray(a)||a[0]!=="-"||a[1]!==Infinity||s!==Infinity)return!1;r=simplify$2(["/",r,i],e,Infinity);var o=t.slice(1),u=[];for(let p=0;p<o.length;p++){let d=o[p][3],m=o[p][4];if(!Array.isArray(d)||d[0]!=="-"||d[1]!==Infinity||m!==Infinity)return!1;let v=simplify$2(["/",o[p][1],i],e,Infinity),h=simplify$2(["/",o[p][2],i],e,Infinity);if(typeof h!="number")return!1;let y=math$19.fraction(h),g=y.n,b=y.d;u.push([g,b,v,h])}for(u.sort();u[0][0]===1;){let d=u[0][2],m=u[0][3],v=simplify$2(expand(["+",d,["-",r]]),e,Infinity);if(Number.isFinite(v)&&Number.isFinite(m)&&(v=math$19.mod(v,m),math$19.min(v,m-v)<1e-10*m))return!0;if(u.splice(0,1),u.length===0)return!1}var c=[...new Set(u.map(p=>p[0]))];let f=0;for(let p of c){let d=u.map(function(v,h){let y=p/v[0];if(Number.isInteger(y))return[v[0],y,h]}).filter(v=>v),m=[];for(let v of d){let h=v[0],y=v[1],g=v[2],b=u[g][2],x=u[g][3];for(let N=0;N<h;N++){let C=simplify$2(expand(["+",b,["-",["+",r,N]]]),e,Infinity);if(Number.isFinite(C)&&Number.isFinite(x)&&(C=math$19.mod(C,x),math$19.min(C,x-C)<1e-10*x)){for(let w=0;w<y;w++)m[N+w*h]=!0;let _=!0;for(let w=0;w<p;w++)if(!m[w]){_=!1;break}if(_)return!0;break}}}if(n){let v=0;for(let h=0;h<p;h++)m[h]&&v++;v/=p,v>f&&(f=v)}}return n&&f>0?f:!1}function sequence_from_discrete_infinite(l,t){var e=l.tree,n=e.slice(1);if(n.length>1)return;let r=n[0][1],i=n[0][2],a=evaluate_numbers(n[0][3]),s=n[0][4];if(!Number.isInteger(a)||s!==Infinity)return;let o=[];for(let u=0;u<t;u++)o.push(evaluate_numbers(["+",["*",i,a+u],r]));return o}let equals$5=function(l,t,{relative_tolerance:e=1e-12,absolute_tolerance:n=0,tolerance_for_zero:r=1e-15,allowed_error_in_numbers:i=0,include_error_in_number_exponents:a=!1,allowed_error_is_absolute:s=!1}={}){if(l.variables().includes("\uFF3F")||t.variables().includes("\uFF3F"))return!1;let o=l.evaluate_numbers({max_digits:Infinity}).normalize_function_names().normalize_applied_functions().simplify(),u=t.evaluate_numbers({max_digits:Infinity}).normalize_function_names().normalize_applied_functions().simplify();return o.equalsViaSyntax(u,{allowed_error_in_numbers:i,include_error_in_number_exponents:a,allowed_error_is_absolute:s})||l.equalsViaComplex(t,{relative_tolerance:e,absolute_tolerance:n,tolerance_for_zero:r,allowed_error_in_numbers:i,include_error_in_number_exponents:a,allowed_error_is_absolute:s})?!0:!!equals$$1(l,t)};var equality=Object.freeze({equals:equals$5,equalsViaComplex:equals$1,equalsViaReal:equals$2,equalsViaSyntax:equals$3,equalsDiscreteInfinite:equals$$1});let equalWithSignErrors=function(l,t,{equalityFunction:e=equals$5,max_sign_errors:n=1}={}){if(e(l,t))return{matched:!0,n_sign_errors:0};for(let r=1;r<=n;r++)if(equalSpecifiedSignErrors(l,t,{equalityFunction:e,n_sign_errors:r}))return{matched:!0,n_sign_errors:r};return{matched:!1}},equalSpecifiedSignErrors=function(l,t,{equalityFunction:e=equals$5,n_sign_errors:n=1}={}){if(n===0)return e(l,t);if(!(Number.isInteger(n)&&n>0))throw Error(`Have not implemented equality check with ${n} sign errors.`);if(n>1){let c=e;e=function(f,p){return equalSpecifiedSignErrors(f,p,{equalityFunction:c,n_sign_errors:n-1})}}var r=l.tree,i=[[r]],a=0,s,o;l.tree=["-",r];var u=e(l,t);if(l.tree=r,u)return!0;for(;s=i[a++];)if(s=s[0],!!Array.isArray(s)){for(o=1;o<s.length;o++)if(i.push([s[o]]),s[o]=["-",s[o]],u=e(l,t),s[o]=s[o][1],u)return!0}return!1};var sign_error=Object.freeze({equalSpecifiedSignErrors,equalWithSignErrors});function add$2(l,t){var e=["+",get_tree(l),get_tree(t)];return clean(e)}function subtract$2(l,t){var e=["+",get_tree(l),["-",get_tree(t)]];return clean(e)}function multiply$2(l,t){var e=["*",get_tree(l),get_tree(t)];return clean(e)}function divide$2(l,t){var e=["/",get_tree(l),get_tree(t)];return clean(e)}function pow$2(l,t){var e=["^",get_tree(l),get_tree(t)];return clean(e)}function mod$2(l,t){var e=["apply","mod",["tuple",get_tree(l),get_tree(t)]];return clean(e)}function copy(l){return get_tree(l)}var arithmetic$1=Object.freeze({add:add$2,subtract:subtract$2,multiply:multiply$2,divide:divide$2,pow:pow$2,mod:mod$2,copy}),analytic_operators=["+","-","*","/","^","tuple","vector","list","array","matrix","interval"],analytic_functions=["exp","log","log10","sqrt","factorial","gamma","erf","acos","acosh","acot","acoth","acsc","acsch","asec","asech","asin","asinh","atan","atanh","cos","cosh","cot","coth","csc","csch","sec","sech","sin","sinh","tan","tanh","arcsin","arccos","arctan","arccsc","arcsec","arccot","cosec"],relation_operators=["=","le","ge","<",">"];function isAnalytic(l,{allow_abs:t=!1,allow_relation:e=!1}={}){var n=normalize_applied_functions(normalize_function_names(l));n=subscripts_to_strings(n);var r=operators$1(n);for(let a=0;a<r.length;a++){let s=r[a];if(analytic_operators.indexOf(s)===-1)if(e){if(relation_operators.indexOf(s)===-1)return!1}else return!1}var i=functions(n);for(let a=0;a<i.length;a++){let s=i[a];if(analytic_functions.indexOf(s)===-1&&(!t||s!=="abs"))return!1}return!0}var analytic=Object.freeze({isAnalytic});function create_discrete_infinite_set({offsets:l,periods:t,min_index:e=["-",Infinity],max_index:n=Infinity}={}){if(l=get_tree(l),t=get_tree(t),e=get_tree(e),n=get_tree(n),l===void 0||t===void 0)return;let r=[];if(l[0]==="list")if(t[0]==="list"){if(l.length!==t.length||l.length===1)return;for(let i=1;i<l.length;i++)r.push(["tuple",l[i],t[i],e,n])}else for(let i=1;i<l.length;i++)r.push(["tuple",l[i],t,e,n]);else r.push(["tuple",l,t,e,n]);return["discrete_infinite_set"].concat(r)}var sets=Object.freeze({create_discrete_infinite_set});function tuple(l){var t=[];t.push("tuple");var e=l.length;for(let n=0;n<e;n++)t.push(l[n]);return t}function matrix$4(l){var t=[];t.push("matrix");var e=l.length,n=l[0].length;for(let i=1;i<e;i++)if(l[i].length!==n)throw new Error("Matrix dimensions mismatch");t.push(tuple([e,n]));let r=[];for(let i=0;i<e;i++)r.push(tuple(l[i].map(function(a){return a.tree})));return t.push(tuple(r)),t}function vector_add(l,t){if(l=get_tree(l),t=get_tree(t),l.length!==t.length||l[0]!=="tuple"&&l[0]!=="vector"||t[0]!=="tuple"&&t[0]!=="vector")throw new Error("Can't add. Those aren't vectors, or the dimensions don't match");var e=["vector"],n=l.length;for(let r=1;r<n;r=r+1)e.push(["+",l[r],t[r]]);return simplify$2(e)}function scalar_mul(l,t){if(t=get_tree(t),t[0]!=="tuple"&&t[0]!=="vector")throw new Error("Can't scalar multiply. Isn't a vector");var e=["vector"],n=t.length;for(let r=1;r<n;r=r+1)e.push(["*",t[r],l]);return simplify$2(e)}function vector_sub(l,t){return vector_add(l,scalar_mul(-1,t))}function dot_prod(l,t){if(l=get_tree(l),t=get_tree(t),l.length!==t.length||l[0]!=="tuple"&&l[0]!=="vector"||t[0]!=="tuple"&&t[0]!=="vector")throw new Error("Can't take dot product. Those aren't vectors, or the dimensions don't match");var e=0,n=0,r=l.length;for(let i=1;i<r;i=i+1)n=["*",l[i],t[i]],e=["+",e,n];return simplify$2(e)}function cross_prod(l,t){if(l=get_tree(l),t=get_tree(t),l[0]!=="tuple"&&l[0]!=="vector"||t[0]!=="tuple"&&t[0]!=="vector")throw new Error("Can't take cross product. Those aren't vectors");if(l.length===3&&t.length===3)return simplify$2(["+",["*",l[1],t[2]],["-",["*",l[2],t[1]]]]);if(l.length===4&&t.length===4){var e=["+",["*",l[2],t[3]],["-",["*",l[3],t[2]]]],n=["+",["*",l[3],t[1]],["-",["*",l[1],t[3]]]],r=["+",["*",l[1],t[2]],["-",["*",l[2],t[1]]]];return simplify$2(["vector",e,n,r])}throw new Error("Can't take cross product. The dimensions aren't both 2 or 3.")}var matrix$5=Object.freeze({matrix:matrix$4,vector_add,scalar_mul,vector_sub,dot_prod,cross_prod});class astToGuppy{constructor(){this.operators={"+":function(t){return t.join("<e>+</e>")},"-":function(t){return"<e>-"+t.join("-")+"</e>"},"*":function(t){return t.join('<f type="*" group="operations" c="yes"><b p="latex">\\cdot</b><b p="text">*</b></f>')},"/":function(t){return astToGuppy.dfrac(t[0],t[1])},"^":function(t){return astToGuppy.power(t[0],t[1])},sin:function(t){return astToGuppy.trig("sin",t[0])},cos:function(t){return astToGuppy.trig("cos",t[0])},tan:function(t){return astToGuppy.trig("tan",t[0])},arcsin:function(t){return astToGuppy.trig("arcsin",t[0])},arccos:function(t){return astToGuppy.trig("arccos",t[0])},arctan:function(t){return astToGuppy.trig("arctan",t[0])},arccsc:function(t){return astToGuppy.trig("arccsc",t[0])},arcsec:function(t){return astToGuppy.trig("arcsec",t[0])},arccot:function(t){return astToGuppy.trig("arccot",t[0])},csc:function(t){return astToGuppy.trig("csc",t[0])},sec:function(t){return astToGuppy.trig("sec",t[0])},cot:function(t){return astToGuppy.trig("cot",t[0])},log:function(t){return astToGuppy.trig("log",t[0])},exp:function(t){return astToGuppy.trig("exp",t[0])},ln:function(t){return astToGuppy.trig("ln",t[0])},sqrt:function(t){return astToGuppy.sqrt(t[0])},abs:function(t){return astToGuppy.abs(t[0])}}}static dfrac(t,e){return'<f type="fraction" group="functions"><b p="latex">\\dfrac{<r ref="1"/>}{<r ref="2"/>}</b><b p="small_latex">\\frac{<r ref="1"/>}{<r ref="2"/>}</b><b p="text">(<r ref="1"/>)/(<r ref="2"/>)</b><c up="1" down="2" name="numerator"><e></e>'+t+'<e></e></c><c up="1" down="2" name="denominator"><e></e>'+e+"<e></e></c></f>"}static trig(t,e){return'<f type="'+t+'" group="functions"><b p="latex">\\'+t+'\\left(<r ref="1"/>\\right)</b><b p="text"> '+t+'(<r ref="1"/>)</b><c delete="1"><e></e>'+e+"<e></e></c></f>"}static sqrt(t){return'<f type="square_root" group="functions"><b p="latex">\\sqrt{<r ref="1"/>}</b><b p="text">sqrt(<r ref="1"/>)</b><c delete="1"><e></e>'+t+"<e></e></c></f>"}static power(t,e){return'<f type="exponential" group="functions"><b p="latex">{<r ref="1"/>}^{<r ref="2"/>}</b><b p="text">(<r ref="1"/>)^(<r ref="2"/>)</b><c up="2" bracket="yes" delete="1" name="base"><e></e>'+t+'<e></e></c><c down="1" delete="1" name="exponent" small="yes"><e></e>'+e+"<e></e></c></f>"}static abs(t){return'<f type="absolute_value" group="functions"><b p="latex">\\left|<r ref="1"/>\\right|</b><b p="text">abs(<r ref="1"/>)</b><c delete="1"><e></e>'+t+"<e></e></c></f>"}static paren(t){return'<f type="bracket" group="functions"><b p="latex">\\left(<r ref="1"/>\\right)</b><b p="text">(<r ref="1"/>)</b><c delete="1" is_bracket="yes"><e></e>'+t+"<e></e></c></f>"}static isFunctionSymbol(t){var e=["sin","cos","tan","csc","sec","cot","arcsin","arccos","arctan","arccsc","arcsec","arccot","log","ln","exp","sqrt","abs","this.factorial"];return e.indexOf(t)!==-1}static isGreekLetterSymbol(t){var e=["pi","theta","theta","Theta","alpha","nu","beta","xi","Xi","gamma","Gamma","delta","Delta","pi","Pi","epsilon","epsilon","rho","rho","zeta","sigma","Sigma","eta","tau","upsilon","Upsilon","iota","phi","phi","Phi","kappa","chi","lambda","Lambda","psi","Psi","omega","Omega"];return e.indexOf(t)!==-1}factorWithParenthesesIfNegated(t){var e=this.factor(t);return e.toString().match(/^<e>-/)?astToGuppy.paren(e.toString()):e}factor(t){if(typeof t=="string")return astToGuppy.isGreekLetterSymbol(t)?'<f type="'+t+'" group="greek" c="yes"><b p="latex">\\'+t+'</b><b p="text"> $'+t+"</b></f>":"<e>"+t+"</e>";if(typeof t=="number")return"<e>"+t+"</e>";var e=t[0],n=t.slice(1);return e==="apply"&&(e=t[1],n=t.slice(2)),e==="abs"?this.operators[e](n.map(function(r,i){return this.expression(r)}.bind(this))):astToGuppy.isFunctionSymbol(e)?e==="this.factorial"&&(n[0].toString().length===1||n[0].toString().match(/^[0-9]*$/))?this.operators[e](n):this.operators[e](n.map(function(r,i){var a=this.factor(r);return a}.bind(this))):e==="^"?this.operators[e](n.map(function(r,i){return this.factor(r)}.bind(this))):e==="~"?this.operators[e](n.map(function(r,i){return this.factor(r)}.bind(this))):astToGuppy.paren(this.expression(t))}term(t){if(typeof t=="string"||typeof t=="number")return this.factor(t);var e=t[0],n=t.slice(1);return e==="*"?this.operators[e](n.map(function(r,i){var a=this.factorWithParenthesesIfNegated(r);return a.toString().match(/^[0-9]/)&&i>0?" * "+a:a}.bind(this))):e==="/"?this.operators[e](n.map(function(r,i){return this.factor(r)}.bind(this))):this.factor(t)}expression(t){if(typeof t=="string"||typeof t=="number")return this.term(t);var e=t[0],n=t.slice(1);return e==="+"||e==="-"?this.operators[e](n.map(function(r,i){return this.factorWithParenthesesIfNegated(r)}.bind(this))):this.term(t)}convert(t){return("<m><e></e>"+this.expression(t)+"<e></e></m>").replace(/<\/e><e>/g,"")}}let glslOperators={"+":function(l){var t=l[0];return l.slice(1).forEach(function(e){t=t+"+"+e}),t},"-":function(l){var t="-"+l[0];return l.slice(1).forEach(function(e){t=t+"-"+e}),t},"~":function(l){var t="vec2(0.0,0.0)";return l.forEach(function(e){t=t+"-"+e}),t},"*":function(l){var t=l[0];return l.slice(1).forEach(function(e){t="cmul("+t+","+e+")"}),t},"/":function(l){var t=l[0];return l.slice(1).forEach(function(e){t="cdiv("+t+","+e+")"}),t},sin:function(l){return"csin("+l[0]+")"},cos:function(l){return"ccos("+l[0]+")"},tan:function(l){return"ctan("+l[0]+")"},sinh:function(l){return"csinh("+l[0]+")"},cosh:function(l){return"ccosh("+l[0]+")"},arcsin:function(l){return"carcsin("+l[0]+")"},arccos:function(l){return"carccos("+l[0]+")"},arctan:function(l){return"carctan("+l[0]+")"},arccsc:function(l){return"carcsin(cdiv(vec2(1.0,0),"+l[0]+"))"},arcsec:function(l){return"carccos(cdiv(vec2(1.0,0),"+l[0]+"))"},arccot:function(l){return"carctan(cdiv(vec2(1.0,0),"+l[0]+"))"},csc:function(l){return"ccsc("+l[0]+")"},sec:function(l){return"csec("+l[0]+")"},cot:function(l){return"ccot("+l[0]+")"},exp:function(l){return"cexp("+l[0]+")"},conj:function(l){return"conjugate("+l[0]+")"},sqrt:function(l){return"cpower("+l[0]+",vec2(0.5,0.0))"},log:function(l){return"clog("+l[0]+")"},ln:function(l){return"clog("+l[0]+")"},"^":function(l){return"cpower("+l[0]+","+l[1]+")"},abs:function(l){return"cabs("+l[0]+")"},apply:function(l){return"vec2(NaN,NaN)"}};class astToGLSL{constructor(){}convert(t){if(typeof t=="boolean")throw Error("no support for boolean");if(typeof t=="string")return t==="e"?"vec2(2.71828182845905,0.0)":t==="pi"?"vec2(3.14159265358979,0.0)":t==="i"?"vec2(0.0,1.0)":String(t);if(typeof t=="number")return"vec2("+String(t)+",0.0)";if("real"in t&&"imaginary"in t)return t;if(!Array.isArray(t))throw Error("Invalid ast");var e=t[0],n=t.slice(1);if(e==="apply"){if(typeof n[0]!="string")throw Error("Non string functions not implemented for conversion to GLSL");var e=n[0],n=n.slice(1);return glslOperators[e](n.map(function(a,s){return this.convert(a)}.bind(this)))}if(e in glslOperators)return glslOperators[e](n.map(function(r,i){return this.convert(r)}.bind(this)));throw Error("Operator "+e+" not implemented for conversion to mathjs")}}var astToLatex$2=new astToLatex,astToText$2=new astToText,astToGuppy$1=new astToGuppy,astToGLSL$1=new astToGLSL;let tex=function(l){return astToLatex$2.convert(l.tree)},toLatex=tex,toString=function(l){return astToText$2.convert(l.tree)},toGLSL=function(l){return astToGLSL$1.convert(l.tree)},toXML=function(l){return astToGuppy$1.convert(l.tree)};var printing=Object.freeze({tex,toLatex,toString,toXML,toGLSL});let integrateNumerically=function(l,t,e,n){for(var r=100,i=0,a={},s=0;s<r;s++){var o=e+(n-e)*(s+.5)/r;a[t]=o,i=i+l.evaluate(a)}return i*(n-e)/r};var integration=Object.freeze({integrateNumerically});function expression_to_polynomial(l){var t=get_tree(l);if(typeof t=="string")return t==="pi"&&math$19.define_pi||t==="i"&&math$19.define_i||t==="e"&&math$19.define_e?t:["polynomial",t,[[1,1]]];if(typeof t=="number")return t;let e=evaluate_to_constant(t);if(e!==null&&Number.isFinite(e))return simplify$2(t);if(!Array.isArray(t)||!operators$1(t).every(u=>["+","-","*","^","/","_","prime"].includes(u)))return!1;var n=t[0],r=t.slice(1);if(n==="+"){let u=r.map(expression_to_polynomial);return u.every(c=>c!==!1)?u.reduce((c,f)=>polynomial_add(c,f)):!1}else if(n==="-"){let u=expression_to_polynomial(r[0]);return u?polynomial_neg(u):!1}else if(n==="*"){let u=r.map(expression_to_polynomial);return u.every(c=>c!==!1)?u.reduce((c,f)=>polynomial_mul(c,f)):!1}else if(n==="^"){let u=r[0],c=expression_to_polynomial(u);if(c===!1)return!1;let f=simplify$2(r[1]);if(typeof f!="number"||f<0||!Number.isInteger(f)){let p=evaluate_to_constant(f);if(p!==null||Number.isFinite(p)){let d=math$19.fraction(p);if(d.d<=100){d.s<0?u=["^",u,["/",-1,d.d]]:u=["^",u,["/",1,d.d]];var i=["polynomial",simplify$2(u),[]];return i[2].push([d.n,1]),i}}return["polynomial",t,[[1,1]]]}return f===0?1:f===1?c:polynomial_pow(c,f)}else if(n==="/"){var a=r[1],s=evaluate_to_constant(a);if(s===null||!Number.isFinite(s))return["polynomial",t,[[1,1]]];var o=expression_to_polynomial(r[0]);return polynomial_mul(o,["/",1,s])}else return["polynomial",t,[[1,1]]]}function polynomials_in_same_leading_variable(l,t){return l[1]!==t[1]&&(compare_function(l[1],t[1])<0?t=["polynomial",l[1],[[0,t]]]:l=["polynomial",t[1],[[0,l]]]),[l,t]}function polynomial_add(l,t){if(l[0]!=="polynomial"){if(t[0]!=="polynomial")return simplify$2(["+",l,t]);l=["polynomial",t[1],[[0,l]]]}else if(t[0]!=="polynomial")t=["polynomial",l[1],[[0,t]]];else{let c=polynomials_in_same_leading_variable(l,t);l=c[0],t=c[1]}let e=["polynomial",l[1],[]],n=l[2],r=t[2],i=e[2],a=n.length,s=r.length,o=0,u=0;for(;o<a||u<s;)if(o===a)r[u][1]&&i.push(r[u]),u=u+1;else if(u===s)n[o][1]&&i.push(n[o]),o=o+1;else if(n[o][0]===r[u][0]){let c=polynomial_add(n[o][1],r[u][1]);c&&i.push([n[o][0],c]),o=o+1,u=u+1}else n[o][0]<r[u][0]?(n[o][1]&&i.push(n[o]),o=o+1):(r[u][1]&&i.push(r[u]),u=u+1);return i.length===0?0:i.length===1&&i[0][0]===0?i[0][1]:e}function polynomial_neg(l){if(l[0]!=="polynomial")return simplify$2(["-",l]);let t=["polynomial",l[1],[]],e=l[2],n=t[2],r=e.length;for(var i=0;i<r;i=i+1)n.push([e[i][0],polynomial_neg(e[i][1])]);return t}function polynomial_sub(l,t){return polynomial_add(l,polynomial_neg(t))}function polynomial_mul(l,t){if(l[0]!=="polynomial"){if(t[0]!=="polynomial")return simplify$2(["*",l,t]);if(l){let c=["polynomial",t[1],[]],f=t[2],p=c[2];for(let d of f)d[1]&&p.push([d[0],polynomial_mul(l,d[1])]);return c}}else if(t&&t[0]!=="polynomial"){let c=["polynomial",l[1],[]],f=l[2],p=c[2];for(let d of f)d[1]&&p.push([d[0],polynomial_mul(d[1],t)]);return c}let e=polynomials_in_same_leading_variable(l,t);l=e[0],t=e[1];let n=l[2],r=t[2],i=["polynomial",l[1],[]],a=i[2],s=n.length,o=r.length,u=[];for(let c of n)for(let f of r){let p=!1,d=c[0]+f[0];for(let m of u)if(d===m){p=!0;break}p||u.push(d)}u.sort(function(c,f){return c-f});for(let c of u){let f=0,p=0;for(;p<s&&n[p][0]<=c;){let d=0;for(;d<o&&r[d][0]<=c;){if(n[p][0]+r[d][0]===c){f=polynomial_add(f,polynomial_mul(n[p][1],r[d][1]));break}d=d+1}p=p+1}f&&a.push([c,f])}return i}function polynomial_pow(l,t){if(isNaN(t)||t<0||!Number.isInteger(t))return;let e=1;for(;t>0;)t&1&&(e=polynomial_mul(e,l)),l=polynomial_mul(l,l),t>>=1;return e}function polynomial_to_expression(l){if(!Array.isArray(l)||l[0]!=="polynomial")return l;let t=l[1],e=l[2],n=[],r=e.length;for(var i=0;i<r;i=i+1)e[i][1]&&(e[i][0]===0?n.push(polynomial_to_expression(e[i][1])):e[i][0]===1?n.push(["*",polynomial_to_expression(e[i][1]),t]):n.push(["*",polynomial_to_expression(e[i][1]),["^",t,e[i][0]]]));return n.length===0?0:(n.length===1?n=n[0]:n.unshift("+"),simplify$2(n))}function initial_term(l){if(!Array.isArray(l)||l[0]!=="polynomial")return l;let t=[];for(;Array.isArray(l)&&l[0]==="polynomial";){let e=l[1],n=l[2],r=n[n.length-1][0];l=n[n.length-1][1],t.push([e,r])}return["monomial",l,t]}function mono_less_than(l,t){if(!Array.isArray(t)||t[0]!=="monomial")return!1;if(!Array.isArray(l)||l[0]!=="monomial")return!0;let e=l[2],n=t[2],r=e.length,i=n.length;var a;r<i?a=r:a=i;for(var s=0;s<a;s++){if(e[s][0]!==n[s][0])return!(compare_function(e[s][0],n[s][0])<0);if(e[s][1]<n[s][1])return!0;if(e[s][1]>n[s][1])return!1}return!(r===i||a===i)}function mono_gcd(l,t){if(!Array.isArray(l)||!Array.isArray(t)||l[0]!=="monomial"||t[0]!=="monomial")return 1;let e=l[2],n=t[2],r=[],i=e.length,a=n.length,s=0,o=0;for(;s<i&&o<a;)e[s][0]===n[o][0]?(e[s][1]<n[o][1]?r.push(e[s]):r.push(n[o]),s=s+1,o=o+1):compare_function(e[s][0],n[o][0])<0?s=s+1:compare_function(n[o][0],e[s][0])<0&&(o=o+1);return r.length===0?1:["monomial",1,r]}function mono_div(l,t){if(!Array.isArray(t)||t[0]!=="monomial")return t===1?l:!Array.isArray(l)||l[0]!=="monomial"?evaluate_numbers(["/",l,t]):[l[0],evaluate_numbers(["/",l[1],t]),l[2]];if(!Array.isArray(l)||l[0]!=="monomial")return;let e=l[2],n=t[2],r=[],i=e.length,a=n.length,s=0,o=0;for(;s<i&&o<a;)if(e[s][0]===n[o][0]){if(e[s][1]<n[o][1])return;{let u=e[s][1]-n[o][1];u!==0&&r.push([e[s][0],u])}s=s+1,o=o+1}else if(compare_function(e[s][0],n[o][0])<0)r.push(e[s]),s=s+1;else if(compare_function(n[o][0],e[s][0])<0)return;if(!(o<a)){for(;s<i;)r.push(e[s]),s=s+1;return r.length===0?t[1]===1?l[1]:evaluate_numbers(["/",l[1],t[1]]):t[1]===1?["monomial",l[1],r]:["monomial",evaluate_numbers(["/",l[1],t[1]]),r]}}function mono_is_div(l,t){if(t===0)return!1;if(!Array.isArray(t)||t[0]!=="monomial")return!0;if(!Array.isArray(l)||l[0]!=="monomial")return!1;let e=l[2],n=t[2],r=[],i=e.length,a=n.length,s=0,o=0;for(;s<i&&o<a;)if(e[s][0]===n[o][0]){if(e[s][1]<n[o][1])return!1;{let u=e[s][1]-n[o][1];u!==0&&r.push([e[s][0],u])}s=s+1,o=o+1}else if(compare_function(e[s][0],n[o][0])<0)r.push(e[s]),s=s+1;else if(compare_function(n[o][0],e[s][0])<0)return!1;return!(o<a)}function mono_to_poly(l){if(!Array.isArray(l)||l[0]!=="monomial")return l;let e=l[2].length-1,n=l[1];for(;e>=0;){var r=[];r.push([l[2][e][1],n]),n=["polynomial",l[2][e][0],r],e=e-1}return n}function max_div_init(l,t){if(l===0)return 0;let e=l,n=[];for(;Array.isArray(e)&&e[0]==="polynomial";){let s=e[1],o=e[2],u=o[o.length-1][0];e=o[o.length-1][1],n.push([s,u])}let r=["monomial",e,n],i=t.length;for(var a=0;a<i;a=a+1)if(mono_is_div(r,t[a]))return[r,a];return max_div_init(polynomial_sub(l,mono_to_poly(r)),t)}function poly_div(l,t){let e=[],n=[],r=[],i=[],a=l;for(var s of t)e.push(initial_term(s));let o=max_div_init(a,e);for(;o!==0;)r=o[1],i=mono_div(o[0],e[r]),n.push([r,i]),a=polynomial_sub(a,polynomial_mul(mono_to_poly(i),t[r])),o=max_div_init(a,e);return[n,a]}function prereduce(l){let t=l.length,e=[];for(var n=0;n<t;n++){if(l[n]!==0&&(!Array.isArray(l[n])||l[n][0]!=="polynomial"))return[1];l[n]!==0&&e.push(l[n])}return e.length===0?[0]:e}function reduce_ith(l,t){let e=[],n=[],r=[],i=t[l],a=t.length;for(var s=0;s<a;s=s+1)s===l?e.push(0):e.push(initial_term(t[s]));let o=max_div_init(i,e);for(;o!==0;)n=o[1],r=mono_div(o[0],e[n]),i=polynomial_sub(i,polynomial_mul(mono_to_poly(r),t[n])),o=max_div_init(i,e);return i}function reduce$1(l){let t=0,e=[],n=prereduce(l),r=n.length;if(r===1)return n;let i=!0;for(;i;)for(i=!1,n=prereduce(n),r=n.length,t=0;t<r;)e=reduce_ith(t,n),underscore.isEqual(e,n[t])||(n[t]=e,i=!0),t=t+1;t=0;let a=[],s=0;for(;t<r;)a=initial_term(n[t]),!Array.isArray(a)||a[0]!=="monomial"?n[t]=1:(s=a[1],s!==1&&(n[t]=polynomial_mul(n[t],["/",1,s]))),t=t+1;return n}function hij(l,t,e){let n=initial_term(e[l]),r=initial_term(e[t]),i=mono_gcd(n,r),a=mono_to_poly(mono_div(n,i)),s=mono_to_poly(mono_div(r,i));return poly_div(polynomial_sub(polynomial_mul(s,e[l]),polynomial_mul(a,e[t])),e)[1]}function build_hij_table(l,t){let e=t.length,n=0,r=1,i=[];for(;r<e;){for(;n<r;)l[[n,r]]=hij(n,r,t),l[[n,r]]!==0&&i.push(l[[n,r]]),n=n+1;n=0,r=r+1}return i.length>0?choice_lowest_degree(i):0}function update_hij_table(l,t,e){let n=t.length;t.push(e);let r=0,i=1,a=[];for(;i<n;){for(;r<i;)l[[r,i]]!==0&&(l[[r,i]]=hij(r,i,t),l[[r,i]]!==0&&a.push(l[[r,i]])),r=r+1;r=0,i=i+1}for(;r<n;)l[[r,n]]=hij(r,n,t),l[[r,n]]!==0&&a.push(l[[r,n]]),r=r+1;return a.length>0?choice_lowest_degree(a):0}function choice_lowest_degree(l){let t=[],e=l.length;for(r=0;r<e;r=r+1)t.push(initial_term(l[r]));let n=0;for(var r=1;r<e;r=r+1){if(t[r]===1)return 1;mono_less_than(t[r],t[n])&&(n=r)}return l[n]}function reduced_grobner(l){let t=reduce$1(l),e={},n=build_hij_table(e,t);for(;n!==0;)n=update_hij_table(e,t,n);return t=reduce$1(t),t}function poly_lcm(l,t){let e=["polynomial","_t",[[1,1]]],n=["polynomial","_t",[[0,1],[1,-1]]],r=reduced_grobner([polynomial_mul(e,l),polynomial_mul(n,t)]),i=r.length;for(var a=0;a<i;a=a+1){if(!Array.isArray(r[a])||r[a][0]!=="polynomial")return 1;if(r[a][1]!=="_t")return r[a]}}function poly_gcd(l,t){let e=poly_lcm(l,t),n=polynomial_mul(l,t),r=poly_div(n,[e]),i=0,a=r[0].length;for(var s=0;s<a;s=s+1)i=polynomial_add(i,mono_to_poly(r[0][s][1]));let o=initial_term(i);if(!Array.isArray(o)||o[0]!=="monomial")i=1;else{let u=o[1];u!==1&&(i=polynomial_mul(i,["/",1,u]))}return i}function poly_by_divisor(l,t){let e=poly_div(l,[t]),n=0,r=e[0].length;for(var i=0;i<r;i=i+1)n=polynomial_add(n,mono_to_poly(e[0][i][1]));return n}function reduce_rational_expression(l,t){let e=stringify_vars(l),n=stringify_vars(t);l=e[0],t=n[0];let r=poly_gcd(l,t),i=initial_term(t)[1],a=polynomial_mul(r,i),s=poly_by_divisor(l,a),o=poly_by_divisor(t,a);return[destringify_vars(destringify_vars(s,e[1]),n[1]),destringify_vars(destringify_vars(o,e[1]),n[1])]}function stringify_vars(l){if(!Array.isArray(l)||l[0]!=="polynomial")return[l,{}];let t={},e="z"+JSON.stringify(l[1]);t[e]=l[1],l[1]=e;let n=l[2],r=[];for(let i of n){r=stringify_vars(i[1]),i[1]=r[0];for(let a in r[1])t[a]=r[1][a]}return[l,t]}function destringify_vars(l,t){if(!Array.isArray(l)||l[0]!=="polynomial")return l;t[l[1]]&&(l[1]=t[l[1]]);let e=l[2];for(let n of e)n[1]=destringify_vars(n[1],t);return l}var textToAst$3=new textToAst;function common_denominator(l,t){l=simplify$2(l,t);var e=[];return e.push([textToAst$3.convert("a/c+b/c"),textToAst$3.convert("(a+b)/c"),{evaluate_numbers:!0,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),e.push([textToAst$3.convert("a/c-b/c"),textToAst$3.convert("(a-b)/c"),{evaluate_numbers:!0,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),e.push([textToAst$3.convert("a+b/c"),textToAst$3.convert("(ac+b)/c"),{evaluate_numbers:!0,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),e.push([textToAst$3.convert("a-b/c"),textToAst$3.convert("(ac-b)/c"),{evaluate_numbers:!0,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),e.push([textToAst$3.convert("a/d+b/c"),textToAst$3.convert("(ac+bd)/(cd)"),{evaluate_numbers:!0,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),e.push([textToAst$3.convert("a/d-b/c"),textToAst$3.convert("(ac-bd)/(cd)"),{evaluate_numbers:!0,allow_extended_match:!0,allow_permutations:!0,max_group:1}]),e.push([textToAst$3.convert("x*(y/z)"),textToAst$3.convert("(x*y)/z"),{allow_extended_match:!0,allow_permutations:!0,max_group:1}]),e.push([textToAst$3.convert("(x/y)/z"),textToAst$3.convert("x/(y*z)"),{allow_extended_match:!0,allow_permutations:!0}]),e.push([textToAst$3.convert("x/(y/z)"),textToAst$3.convert("xz/y"),{allow_extended_match:!0,allow_permutations:!0}]),l=applyAllTransformations(l,e,40),l=expand(l,!0),l}function as_num_denom(l){var t=get_tree(l);return t=common_denominator(t),t[0]==="/"?[t[1],t[2]]:[t,1]}function reduce_rational(l){var t=get_tree(l),e=as_num_denom(t);if(e[1]===1)return t;var n=expression_to_polynomial(e[0]),r=expression_to_polynomial(e[1]),i=reduce_rational_expression(n,r),a=polynomial_to_expression(i[0]),s=polynomial_to_expression(i[1]);return s===1?a:["/",a,s]}let common_demoninator=common_denominator;var rational=Object.freeze({reduce_rational,common_demoninator});function round_numbers_to_precision(l,t=14){var e=get_tree(l);if(t<1)throw Error("For round_numbers_to_precision, digits must be positive");if(!Number.isFinite(t))throw Error("For round_numbers_to_precision, digits must be a number");return t>15?e:(t=Math.round(t),round_numbers_to_precision_sub(e,t))}let round_numbers_to_precision_sub=function(l,t=14){if(typeof l=="number"&&Number.isFinite(l)&&l!==0){let r=math$19.floor(math$19.log10(math$19.abs(l))),i=t-r-1;return i<0?parseFloat(number_7(l,i)+"0".repeat(math$19.abs(i))):parseFloat(number_7(l,i))}if(!Array.isArray(l))return l;let e=l[0],n=l.slice(1);return[e,...n.map(r=>round_numbers_to_precision_sub(r,t))]};function round_numbers_to_decimals(l,t=14){var e=get_tree(l);if(!Number.isFinite(t))throw Error("For round_numbers_to_decimals, ndecimals must be a number");return t=Math.round(t),t=Math.max(-330,Math.min(330,t)),round_numbers_to_decimals_sub(e,t)}let round_numbers_to_decimals_sub=function(l,t=0){if(typeof l=="number")return t<0?parseFloat(number_7(l,t)+"0".repeat(math$19.abs(t))):parseFloat(number_7(l,t));if(!Array.isArray(l))return l;let e=l[0],n=l.slice(1);return[e,...n.map(r=>round_numbers_to_decimals_sub(r,t))]};var round$2=Object.freeze({round_numbers_to_precision,round_numbers_to_decimals});let expression_to_tree=[simplify$3,differentiation,normalization,arithmetic$1,transformation,solve,sets,matrix$5,rational,round$2],expression_to_other=[variables$1,printing,equality,integration,evaluation,analytic,sign_error];function abs$2(l){return["apply","abs",get_tree(l)]}function exp$2(l){return["apply","exp",get_tree(l)]}function log$2(l){return["apply","log",get_tree(l)]}function log10$2(l){return["apply","log10",get_tree(l)]}function sign$4(l){return["apply","sign",get_tree(l)]}function sqrt$2(l){return["apply","sqrt",get_tree(l)]}function conj$2(l){return["apply","conj",get_tree(l)]}function im$2(l){return["apply","im",get_tree(l)]}function re$2(l){return["apply","re",get_tree(l)]}function factorial$2(l){return["apply","factorial",get_tree(l)]}function gamma$2(l){return["apply","gamma",get_tree(l)]}function erf$2(l){return["apply","erf",get_tree(l)]}function acos$2(l){return["apply","acos",get_tree(l)]}function acosh$2(l){return["apply","acosh",get_tree(l)]}function acot$2(l){return["apply","acot",get_tree(l)]}function acoth$2(l){return["apply","acoth",get_tree(l)]}function acsc$2(l){return["apply","acsc",get_tree(l)]}function acsch$2(l){return["apply","acsch",get_tree(l)]}function asec$2(l){return["apply","asec",get_tree(l)]}function asech$2(l){return["apply","asech",get_tree(l)]}function asin$2(l){return["apply","asin",get_tree(l)]}function asinh$2(l){return["apply","asinh",get_tree(l)]}function atan$2(l){return["apply","atan",get_tree(l)]}function atanh$2(l){return["apply","atanh",get_tree(l)]}function cos$2(l){return["apply","cos",get_tree(l)]}function cosh$2(l){return["apply","cosh",get_tree(l)]}function cot$2(l){return["apply","cot",get_tree(l)]}function coth$2(l){return["apply","coth",get_tree(l)]}function csc$2(l){return["apply","csc",get_tree(l)]}function csch$2(l){return["apply","csch",get_tree(l)]}function sec$2(l){return["apply","sec",get_tree(l)]}function sech$2(l){return["apply","sech",get_tree(l)]}function sin$2(l){return["apply","sin",get_tree(l)]}function sinh$2(l){return["apply","sinh",get_tree(l)]}function tan$2(l){return["apply","tan",get_tree(l)]}function tanh$2(l){return["apply","tanh",get_tree(l)]}function atan2$2(l,t){return["apply","atan2",["tuple",get_tree(l),get_tree(t)]]}var standard=Object.freeze({abs:abs$2,exp:exp$2,log:log$2,log10:log10$2,sign:sign$4,sqrt:sqrt$2,conj:conj$2,im:im$2,re:re$2,factorial:factorial$2,gamma:gamma$2,erf:erf$2,acos:acos$2,acosh:acosh$2,acot:acot$2,acoth:acoth$2,acsc:acsc$2,acsch:acsch$2,asec:asec$2,asech:asech$2,asin:asin$2,asinh:asinh$2,atan:atan$2,atanh:atanh$2,cos:cos$2,cosh:cosh$2,cot:cot$2,coth:coth$2,csc:csc$2,csch:csch$2,sec:sec$2,sech:sech$2,sin:sin$2,sinh:sinh$2,tan:tan$2,tanh:tanh$2,atan2:atan2$2});let expression_to_tree$1=[standard],whitespace_rule="\\s|\\\\,|\\\\!|\\\\ |\\\\>|\\\\;|\\\\:|\\\\quad\\b|\\\\qquad\\b",sci_notat_exp_regex$1="(E[+\\-]?[0-9]+\\s*($|(?=\\,|&|\\||\\\\\\||\\)|\\}|\\\\}|\\]|\\\\\\\\|\\\\end)))?",latex_rules=[["[0-9]+(\\.[0-9]*)?"+sci_notat_exp_regex$1,"NUMBER"],["\\.[0-9]+"+sci_notat_exp_regex$1,"NUMBER"],["\\*","*"],["\\/","/"],["-","-"],["\\+","+"],["\\^","^"],["\\(","("],["\\\\left\\s*\\(","("],["\\\\bigl\\s*\\(","("],["\\\\Bigl\\s*\\(","("],["\\\\biggl\\s*\\(","("],["\\\\Biggl\\s*\\(","("],["\\)",")"],["\\\\right\\s*\\)",")"],["\\\\bigr\\s*\\)",")"],["\\\\Bigr\\s*\\)",")"],["\\\\biggr\\s*\\)",")"],["\\\\Biggr\\s*\\)",")"],["\\[","["],["\\\\left\\s*\\[","["],["\\\\bigl\\s*\\[","["],["\\\\Bigl\\s*\\[","["],["\\\\biggl\\s*\\[","["],["\\\\Biggl\\s*\\[","["],["\\]","]"],["\\\\right\\s*\\]","]"],["\\\\bigr\\s*\\]","]"],["\\\\Bigr\\s*\\]","]"],["\\\\biggr\\s*\\]","]"],["\\\\Biggr\\s*\\]","]"],["\\|","|"],["\\\\left\\s*\\|","|L"],["\\\\bigl\\s*\\|","|L"],["\\\\Bigl\\s*\\|","|L"],["\\\\biggl\\s*\\|","|L"],["\\\\Biggl\\s*\\|","|L"],["\\\\right\\s*\\|","|"],["\\\\bigr\\s*\\|","|"],["\\\\Bigr\\s*\\|","|"],["\\\\biggr\\s*\\|","|"],["\\\\Biggr\\s*\\|","|"],["\\\\big\\s*\\|","|"],["\\\\Big\\s*\\|","|"],["\\\\bigg\\s*\\|","|"],["\\\\Bigg\\s*\\|","|"],["{","{"],["}","}"],["\\\\{","LBRACE"],["\\\\left\\s*\\\\{","LBRACE"],["\\\\bigl\\s*\\\\{","LBRACE"],["\\\\Bigl\\s*\\\\{","LBRACE"],["\\\\biggl\\s*\\\\{","LBRACE"],["\\\\Biggl\\s*\\\\{","LBRACE"],["\\\\}","RBRACE"],["\\\\right\\s*\\\\}","RBRACE"],["\\\\bigr\\s*\\\\}","RBRACE"],["\\\\Bigr\\s*\\\\}","RBRACE"],["\\\\biggr\\s*\\\\}","RBRACE"],["\\\\Biggr\\s*\\\\}","RBRACE"],["\\\\cdot(?![a-zA-Z])","*"],["\\\\div(?![a-zA-Z])","/"],["\\\\times(?![a-zA-Z])","*"],["\\\\frac(?![a-zA-Z])","FRAC"],[",",","],[":",":"],["\\\\mid","MID"],["\\\\vartheta(?![a-zA-Z])","LATEXCOMMAND","\\theta"],["\\\\varepsilon(?![a-zA-Z])","LATEXCOMMAND","\\epsilon"],["\\\\varrho(?![a-zA-Z])","LATEXCOMMAND","\\rho"],["\\\\varphi(?![a-zA-Z])","LATEXCOMMAND","\\phi"],["\\\\infty(?![a-zA-Z])","INFINITY"],["\\\\asin(?![a-zA-Z])","LATEXCOMMAND","\\arcsin"],["\\\\acos(?![a-zA-Z])","LATEXCOMMAND","\\arccos"],["\\\\atan(?![a-zA-Z])","LATEXCOMMAND","\\arctan"],["\\\\sqrt(?![a-zA-Z])","SQRT"],["\\\\land(?![a-zA-Z])","AND"],["\\\\wedge(?![a-zA-Z])","AND"],["\\\\lor(?![a-zA-Z])","OR"],["\\\\vee(?![a-zA-Z])","OR"],["\\\\lnot(?![a-zA-Z])","NOT"],["=","="],["\\\\neq(?![a-zA-Z])","NE"],["\\\\ne(?![a-zA-Z])","NE"],["\\\\not\\s*=","NE"],["\\\\leq(?![a-zA-Z])","LE"],["\\\\le(?![a-zA-Z])","LE"],["\\\\geq(?![a-zA-Z])","GE"],["\\\\ge(?![a-zA-Z])","GE"],["<","<"],["\\\\lt(?![a-zA-Z])","<"],[">",">"],["\\\\gt(?![a-zA-Z])",">"],["\\\\in(?![a-zA-Z])","IN"],["\\\\notin(?![a-zA-Z])","NOTIN"],["\\\\not\\s*\\\\in(?![a-zA-Z])","NOTIN"],["\\\\ni(?![a-zA-Z])","NI"],["\\\\not\\s*\\\\ni(?![a-zA-Z])","NOTNI"],["\\\\subset(?![a-zA-Z])","SUBSET"],["\\\\not\\s*\\\\subset(?![a-zA-Z])","NOTSUBSET"],["\\\\supset(?![a-zA-Z])","SUPERSET"],["\\\\not\\s*\\\\supset(?![a-zA-Z])","NOTSUPERSET"],["\\\\cup(?![a-zA-Z])","UNION"],["\\\\cap(?![a-zA-Z])","INTERSECT"],["!","!"],["'","'"],["_","_"],["&","&"],["\\\\ldots","LDOTS"],["\\\\\\\\","LINEBREAK"],["\\\\begin\\s*{\\s*[a-zA-Z0-9]+\\s*}","BEGINENVIRONMENT"],["\\\\end\\s*{\\s*[a-zA-Z0-9]+\\s*}","ENDENVIRONMENT"],["\\\\var\\s*{\\s*[a-zA-Z0-9]+\\s*}","VARMULTICHAR"],["\\\\[a-zA-Z]+(?![a-zA-Z])","LATEXCOMMAND"],["[a-zA-Z]","VAR"]],allowSimplifiedFunctionApplicationDefault$1=!0,allowedLatexSymbolsDefault$1=["alpha","beta","gamma","Gamma","delta","Delta","epsilon","zeta","eta","theta","Theta","iota","kappa","lambda","Lambda","mu","nu","xi","Xi","pi","Pi","rho","sigma","Sigma","tau","Tau","upsilon","Upsilon","phi","Phi","chi","psi","Psi","omega","Omega","partial"],appliedFunctionSymbolsDefault$1=["abs","exp","log","ln","log10","sign","sqrt","erf","acos","acosh","acot","acoth","acsc","acsch","asec","asech","asin","asinh","atan","atanh","cos","cosh","cot","coth","csc","csch","sec","sech","sin","sinh","tan","tanh","arcsin","arccos","arctan","arccsc","arcsec","arccot","cosec","arg"],functionSymbolsDefault$1=["f","g"],parseLeibnizNotationDefault$1=!0;class latexToAst{constructor({allowSimplifiedFunctionApplication:t=allowSimplifiedFunctionApplicationDefault$1,allowedLatexSymbols:e=allowedLatexSymbolsDefault$1,appliedFunctionSymbols:n=appliedFunctionSymbolsDefault$1,functionSymbols:r=functionSymbolsDefault$1,parseLeibnizNotation:i=parseLeibnizNotationDefault$1}={}){this.allowSimplifiedFunctionApplication=t,this.allowedLatexSymbols=e,this.appliedFunctionSymbols=n,this.functionSymbols=r,this.parseLeibnizNotation=i,this.lexer=new lexer(latex_rules,whitespace_rule)}advance(t){if(this.token=this.lexer.advance(t),this.token.token_type==="INVALID")throw new ParseError("Invalid symbol '"+this.token.original_text+"'",this.lexer.location)}return_state(){return{lexer_state:this.lexer.return_state(),token:Object.assign({},this.token)}}set_state(t){this.lexer.set_state(t.lexer_state),this.token=Object.assign({},t.token)}convert(t){this.lexer.set_input(t),this.advance();var e=this.statement_list();if(this.token.token_type!=="EOF")throw new ParseError("Invalid location of '"+this.token.original_text+"'",this.lexer.location);return flatten$18(e)}statement_list(){for(var t=[this.statement()];this.token.token_type===",";)this.advance(),t.push(this.statement());return t.length>1?t=["list"].concat(t):t=t[0],t}statement({inside_absolute_value:t=0}={}){if(this.token.token_type==="LDOTS")return this.advance(),["ldots"];var e;try{e=this.return_state();let n=this.statement_a({inside_absolute_value:t});if(this.token.token_type!==":"&&this.token.token_type!=="MID")return n;let r=this.token.token_type===":"?":":"|";this.advance();let i=this.statement_a();return[r,n,i]}catch(n){try{this.set_state(e);let r=this.statement_a({parse_absolute_value:!1});if(this.token.token_type[0]!=="|")throw n;this.advance();let i=this.statement_a({parse_absolute_value:!1});return["|",r,i]}catch(r){throw n}}}statement_a({inside_absolute_value:t=0,parse_absolute_value:e=!0}={}){for(var n=this.statement_b({inside_absolute_value:t,parse_absolute_value:e});this.token.token_type==="OR";){let r=this.token.token_type.toLowerCase();this.advance();let i=this.statement_b({inside_absolute_value:t,parse_absolute_value:e});n=[r,n,i]}return n}statement_b(t){for(var e=this.relation(t);this.token.token_type==="AND";){let n=this.token.token_type.toLowerCase();this.advance();let r=this.relation(t);e=[n,e,r]}return e}relation(t){if(this.token.token_type==="NOT"||this.token.token_type==="!")return this.advance(),["not",this.relation(t)];for(var e=this.expression(t);this.token.token_type==="="||this.token.token_type==="NE"||this.token.token_type==="<"||this.token.token_type===">"||this.token.token_type==="LE"||this.token.token_type==="GE"||this.token.token_type==="IN"||this.token.token_type==="NOTIN"||this.token.token_type==="NI"||this.token.token_type==="NOTNI"||this.token.token_type==="SUBSET"||this.token.token_type==="NOTSUBSET"||this.token.token_type==="SUPERSET"||this.token.token_type==="NOTSUPERSET";){let n=this.token.token_type.toLowerCase(),r=0;this.token.token_type==="<"||this.token.token_type==="LE"?r=-1:(this.token.token_type===">"||this.token.token_type==="GE")&&(r=1),this.advance();let i=this.expression(t);if(r===-1)if(this.token.token_type==="<"||this.token.token_type==="LE"){let a=["tuple"];n==="<"?a.push(!0):a.push(!1);let s=["tuple",e,i];for(;this.token.token_type==="<"||this.token.token_type==="LE";)this.token.token_type==="<"?a.push(!0):a.push(!1),this.advance(),s.push(this.expression(t));e=["lts",s,a]}else e=[n,e,i];else if(r===1)if(this.token.token_type===">"||this.token.token_type==="GE"){let a=["tuple"];n===">"?a.push(!0):a.push(!1);let s=["tuple",e,i];for(;this.token.token_type===">"||this.token.token_type==="GE";)this.token.token_type===">"?a.push(!0):a.push(!1),this.advance(),s.push(this.expression(t));e=["gts",s,a]}else e=[n,e,i];else if(n==="=")for(e=["=",e,i];this.token.token_type==="=";)this.advance(),e.push(this.expression(t));else e=[n,e,i]}return e}expression(t){this.token.token_type==="+"&&this.advance();let e=!1;this.token.token_type==="-"&&(e=!0,this.advance());var n=this.term(t);for(e&&(n=["-",n]);this.token.token_type==="+"||this.token.token_type==="-"||this.token.token_type==="UNION"||this.token.token_type==="INTERSECT";){let r=this.token.token_type.toLowerCase(),i=!1;this.token.token_type==="-"?(r="+",i=!0,this.advance()):(this.advance(),r==="+"&&this.token.token_type==="-"&&(i=!0,this.advance()));let a=this.term(t);i&&(a=["-",a]),n=[r,n,a]}return n}term(t){var e=this.factor(t),n=!1;do if(n=!1,this.token.token_type==="*")this.advance(),e=["*",e,this.factor(t)],n=!0;else if(this.token.token_type==="/")this.advance(),e=["/",e,this.factor(t)],n=!0;else{let r=Object.assign({},t);r.allow_absolute_value_closing=!0;let i=this.nonMinusFactor(r);i!==!1&&(e=["*",e,i],n=!0)}while(n);return e}factor(t){if(this.token.token_type==="-")return this.advance(),["-",this.factor(t)];var e=this.nonMinusFactor(t);if(e===!1)throw this.token.token_type==="EOF"?new ParseError("Unexpected end of input",this.lexer.location):new ParseError("Invalid location of '"+this.token.original_text+"'",this.lexer.location);return e}nonMinusFactor(t){var e=this.baseFactor(t);if(this.token.token_type==="!"||this.token.token_type==="'"){if(e===!1)throw new ParseError("Invalid location of "+this.token.token_type,this.lexer.location);for(;this.token.token_type==="!"||this.token.token_type==="'";)this.token.token_type==="!"?e=["apply","factorial",e]:e=["prime",e],this.advance()}if(this.token.token_type==="^"){if(e===!1)throw new ParseError("Invalid location of ^",this.lexer.location);this.advance();let n=Object.assign({},t);return delete n.allow_absolute_value_closing,delete n.inside_absolute_value,["^",e,this.factor(n)]}return e}baseFactor({inside_absolute_value:t=0,parse_absolute_value:e=!0,allow_absolute_value_closing:n=!1}={}){var r=!1;if(this.token.token_type==="FRAC"){if(this.advance(),this.token.token_type!=="{")throw new ParseError("Expecting {",this.lexer.location);if(this.advance(),this.parseLeibnizNotation){let s=this.return_state(),o=this.leibniz_notation();if(o)return o;this.set_state(s)}let i=this.statement({parse_absolute_value:e});if(this.token.token_type!=="}")throw new ParseError("Expecting }",this.lexer.location);if(this.advance(),this.token.token_type!=="{")throw new ParseError("Expecting {",this.lexer.location);this.advance();let a=this.statement({parse_absolute_value:e});if(this.token.token_type!=="}")throw new ParseError("Expecting }",this.lexer.location);return this.advance(),["/",i,a]}if(this.token.token_type==="BEGINENVIRONMENT"){let i=/\\begin\s*{\s*([a-zA-Z0-9]+)\s*}/.exec(this.token.token_text)[1];if(["matrix","pmatrix","bmatrix"].includes(i)){let a=0,s=0,o=[],u=[],c=0,f=this.token.token_type;for(this.advance();this.token.token_type!=="ENDENVIRONMENT";)this.token.token_type==="&"?((f==="&"||f==="LINEBREAK")&&(u.push(0),c+=1),f=this.token.token_type,this.advance()):this.token.token_type==="LINEBREAK"?((f==="&"||f==="LINEBREAK")&&(u.push(0),c+=1),o.push(u),c>s&&(s=c),a+=1,c=0,u=[],f=this.token.token_type,this.advance()):(u.push(this.statement({parse_absolute_value:e})),c+=1,f=" ");if(/\\end\s*{\s*([a-zA-Z0-9]+)\s*}/.exec(this.token.token_text)[1]!==i)throw new ParseError("Expecting \\end{"+i+"}",this.lexer.location);f==="&"&&(u.push(0),c+=1),o.push(u),c>s&&(s=c),a+=1,this.advance(),r=["matrix",["tuple",a,s]];let d=["tuple"];for(let m of o){let v=["tuple"].concat(m);for(let h=m.length;h<s;h+=1)v.push(0);d.push(v)}return r.push(d),r}else throw new ParseError("Unrecognized environment "+i,this.lexer.location)}if(this.token.token_type==="NUMBER")r=parseFloat(this.token.token_text),this.advance();else if(this.token.token_type==="INFINITY")r=Infinity,this.advance();else if(this.token.token_type==="SQRT"){this.advance();let i=2;if(this.token.token_type==="["){this.advance();let s=this.statement({parse_absolute_value:e});if(this.token.token_type!=="]")throw new ParseError("Expecting ]",this.lexer.location);this.advance(),i=s}if(this.token.token_type!=="{")throw new ParseError("Expecting {",this.lexer.location);this.advance();let a=this.statement({parse_absolute_value:e});if(this.token.token_type!=="}")throw new ParseError("Expecting }",this.lexer.location);this.advance(),i===2?r=["apply","sqrt",a]:r=["^",a,["/",1,i]]}else if(this.token.token_type==="VAR"||this.token.token_type==="LATEXCOMMAND"||this.token.token_type==="VARMULTICHAR"){if(r=this.token.token_text,this.token.token_type==="LATEXCOMMAND"){if(r=r.slice(1),!(this.appliedFunctionSymbols.includes(r)||this.functionSymbols.includes(r)||this.allowedLatexSymbols.includes(r)))throw new ParseError("Unrecognized latex command "+this.token.original_text,this.lexer.location)}else this.token.token_type==="VARMULTICHAR"&&(r=/\\var\s*\{\s*([a-zA-Z0-9]+)\s*\}/.exec(r)[1]);if(this.appliedFunctionSymbols.includes(r)||this.functionSymbols.includes(r)){let i=!1;if(this.appliedFunctionSymbols.includes(r)&&(i=!0),this.advance(),this.token.token_type==="_"){this.advance();let a=this.baseFactor({parse_absolute_value:e});if(a===!1)throw this.token.token_type==="EOF"?new ParseError("Unexpected end of input",this.lexer.location):new ParseError("Invalid location of '"+this.token.original_text+"'",this.lexer.location);r=["_",r,a]}for(;this.token.token_type==="'";)r=["prime",r],this.advance();if(this.token.token_type==="^"&&(this.advance(),r=["^",r,this.factor({parse_absolute_value:e})]),this.token.token_type==="{"||this.token.token_type==="("){let a;this.token.token_type==="{"?a="}":a=")",this.advance();let s=this.statement_list();if(this.token.token_type!==a)throw new ParseError("Expecting "+a,this.lexer.location);this.advance(),s[0]==="list"&&(s[0]="tuple"),r=["apply",r,s]}else if(i){if(!this.allowSimplifiedFunctionApplication)throw new ParseError("Expecting ( after function",this.lexer.location);r=["apply",r,this.factor({parse_absolute_value:e})]}}else this.advance()}else if(this.token.token_type==="("||this.token.token_type==="["||this.token.token_type==="{"||this.token.token_type==="LBRACE"){let i=this.token.token_type,a,s;this.token.token_type==="("?(a=")",s="]"):this.token.token_type==="["?(a="]",s=")"):this.token.token_type==="{"?(a="}",s=null):(a="RBRACE",s=null),this.advance(),r=this.statement_list();let o=1;if(r[0]==="list"&&(o=r.length-1),this.token.token_type!==a){if(o!==2||s===null)throw new ParseError("Expecting "+a,this.lexer.location);if(this.token.token_type!==s)throw new ParseError("Expecting ) or ]",this.lexer.location);r[0]="tuple",r=["interval",r];let u;i==="("?u=["tuple",!1,!0]:u=["tuple",!0,!1],r.push(u)}else o>=2?i==="("||i==="{"?r[0]="tuple":i==="["?r[0]="array":r[0]="set":i==="LBRACE"&&(r[0]==="|"||r[0]===":"?r=["set",r]:r=["set",r]);this.advance()}else if(this.token.token_type[0]==="|"&&e&&(t===0||!n||this.token.token_type[1]==="L")){if(t+=1,this.advance(),r=this.statement({inside_absolute_value:t}),r=["apply","abs",r],this.token.token_type!=="|")throw new ParseError("Expecting |",this.lexer.location);this.advance()}if(this.token.token_type==="_"){if(r===!1)throw new ParseError("Invalid location of _",this.lexer.location);this.advance();let i=this.baseFactor({parse_absolute_value:e});if(i===!1)throw this.token.token_type==="EOF"?new ParseError("Unexpected end of input",this.lexer.location):new ParseError("Invalid location of '"+this.token.original_text+"'",this.lexer.location);return["_",r,i]}return r}leibniz_notation(){var t=this.token.token_text;let e="",n=1,r="",i=[],a=[];if(this.token.token_type==="LATEXCOMMAND"&&t.slice(1)==="partial")e="\u2202";else if(this.token.token_type==="VAR"&&t==="d")e="d";else return!1;if(this.advance(),this.token.token_type==="^"){this.advance();let o=!1;if(this.token.token_type==="{"&&(o=!0,this.advance()),this.token.token_type!=="NUMBER"||(n=parseFloat(this.token.token_text),!Number.isInteger(n))||o&&(this.advance(),this.token.token_type!=="}"))return!1;this.advance()}if(this.token.token_type==="VAR")r=this.token.token_text;else if(this.token.token_type==="VARMULTICHAR")r=/\\var\s*\{\s*([a-zA-Z0-9]+)\s*\}/.exec(this.token.token_text)[1];else if(this.token.token_type==="LATEXCOMMAND")if(t=this.token.token_text.slice(1),this.allowedLatexSymbols.includes(t))r=t;else return!1;if(this.advance(),this.token.token_type!=="}"||(this.advance(),this.token.token_type!=="{"))return!1;this.advance();let s=0;for(;;){if(!(e==="d"&&this.token.token_type==="VAR"&&this.token.token_text==="d"||e==="\u2202"&&this.token.token_type==="LATEXCOMMAND"&&this.token.token_text.slice(1)==="partial"))return!1;if(this.advance(),this.token.token_type==="VAR")i.push(this.token.token_text);else if(this.token.token_type==="VARMULTICHAR")i.push(/\\var\s*\{\s*([a-zA-Z0-9]+)\s*\}/.exec(this.token.token_text)[1]);else if(this.token.token_type==="LATEXCOMMAND"){let u=this.token.token_text.slice(1);if(this.allowedLatexSymbols.includes(u))i.push(u);else return!1}else return!1;let o=1;if(this.advance(),this.token.token_type==="^"){this.advance();let u=!1;if(this.token.token_type==="{"&&(u=!0,this.advance()),this.token.token_type!=="NUMBER"||(o=parseFloat(this.token.token_text),!Number.isInteger(o))||u&&(this.advance(),this.token.token_type!=="}"))return!1;this.advance()}if(a.push(o),s+=o,s>n)return!1;if(s===n){if(this.token.token_type!=="}")return!1;this.advance();let u="derivative_leibniz";e==="\u2202"&&(u="partial_"+u),t=[u],n===1?t.push(r):t.push(["tuple",r,n]);let c=[];for(let f=0;f<i.length;f+=1)a[f]===1?c.push(i[f]):c.push(["tuple",i[f],a[f]]);return c=["tuple"].concat(c),t.push(c),t}}}}class latexToGuppy{constructor(){this.latexToAst=new latexToAst,this.astToGuppy=new astToGuppy}convert(t){return this.astToGuppy.convert(this.latexToAst.convert(t))}}class latexToMathjs{constructor(){this.latexToAst=new latexToAst,this.astToMathjs=new astToMathjs}convert(t){return this.astToMathjs.convert(this.latexToAst.convert(t))}}class latexToText{constructor(){this.latexToAst=new latexToAst,this.astToText=new astToText}convert(t){return this.astToText.convert(this.latexToAst.convert(t))}}let operators$4={"+,add":function(l){return["+"].concat(l)},"*,multiply":function(l){return["*"].concat(l)},"/,divide":function(l){return["/",l[0],l[1]]},"-,unaryMinus":function(l){return["-",l[0]]},"-,subtract":function(l){return["+",l[0],["-",l[1]]]},"^,pow":function(l){return["^",l[0],l[1]]},"and,and":function(l){return["and"].concat(l)},"or,or":function(l){return["or"].concat(l)},"not,not":function(l){return["not",l[0]]},"==,equal":function(l){return["="].concat(l)},"<,smaller":function(l){return["<",l[0],l[1]]},">,larger":function(l){return[">",l[0],l[1]]},"<=,smallerEq":function(l){return["le",l[0],l[1]]},">=,largerEq":function(l){return["ge",l[0],l[1]]},"!=,unequal":function(l){return["ne",l[0],l[1]]},"!,factorial":function(l){return["apply","factorial",l[0]]}};class mathjsToAst{convert(t){if(t.isConstantNode)return t.value;if(t.isSymbolNode)return t.name;if(t.isOperatorNode){var e=[t.op,t.fn].join(",");if(e in operators$4)return operators$4[e](t.args.map(function(i,a){return this.convert(i)}.bind(this)));throw Error("Unsupported operator: "+t.op+", "+t.fn)}if(t.isFunctionNode){var n=t.args.map(function(i,a){return this.convert(i)}.bind(this));n.length>1?n=["tuple"].concat(n):n=n[0];var r=["apply",t.name];return r.push(n),r}if(t.isArrayNode)return["vector"].concat(t.args.map(function(i,a){return this.convert(i)}.bind(this)));if(t.isParenthesisNode)return this.convert(t.content);throw Error("Unsupported node type: "+t.type)}}class mathjsToGuppy{constructor(){this.mathjsToAst=new mathjsToAst,this.astToGuppy=new astToGuppy}convert(t){return this.astToGuppy.convert(this.mathjsToAst.convert(t))}}class mathjsToLatex{constructor(){this.mathjsToAst=new mathjsToAst,this.astToLatex=new astToLatex}convert(t){return this.astToLatex.convert(this.mathjsToAst.convert(t))}}class mathjsToText{constructor(){this.mathjsToAst=new mathjsToAst,this.astToText=new astToText}convert(t){return this.astToText.convert(this.mathjsToAst.convert(t))}}var s=1e3,m=s*60,h=m*60,d=h*24,y=d*365.25,ms=function(l,t){t=t||{};var e=typeof l;if(e==="string"&&l.length>0)return parse$2(l);if(e==="number"&&isNaN(l)===!1)return t.long?fmtLong(l):fmtShort(l);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(l))};function parse$2(l){if(l=String(l),!(l.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(l);if(!!t){var e=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return e*y;case"days":case"day":case"d":return e*d;case"hours":case"hour":case"hrs":case"hr":case"h":return e*h;case"minutes":case"minute":case"mins":case"min":case"m":return e*m;case"seconds":case"second":case"secs":case"sec":case"s":return e*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function fmtShort(l){return l>=d?Math.round(l/d)+"d":l>=h?Math.round(l/h)+"h":l>=m?Math.round(l/m)+"m":l>=s?Math.round(l/s)+"s":l+"ms"}function fmtLong(l){return plural(l,d,"day")||plural(l,h,"hour")||plural(l,m,"minute")||plural(l,s,"second")||l+" ms"}function plural(l,t,e){if(!(l<t))return l<t*1.5?Math.floor(l/t)+" "+e:Math.ceil(l/t)+" "+e+"s"}var debug=createCommonjsModule(function(l,t){t=l.exports=r.debug=r.default=r,t.coerce=o,t.disable=a,t.enable=i,t.enabled=s,t.humanize=ms,t.names=[],t.skips=[],t.formatters={};var e;function n(u){var c=0,f;for(f in u)c=(c<<5)-c+u.charCodeAt(f),c|=0;return t.colors[Math.abs(c)%t.colors.length]}function r(u){function c(){if(!!c.enabled){var f=c,p=+new Date,d=p-(e||p);f.diff=d,f.prev=e,f.curr=p,e=p;for(var m=new Array(arguments.length),v=0;v<m.length;v++)m[v]=arguments[v];m[0]=t.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");var h=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,function(g,b){if(g==="%%")return g;h++;var x=t.formatters[b];if(typeof x=="function"){var N=m[h];g=x.call(f,N),m.splice(h,1),h--}return g}),t.formatArgs.call(f,m);var y=c.log||t.log||console.log.bind(console);y.apply(f,m)}}return c.namespace=u,c.enabled=t.enabled(u),c.useColors=t.useColors(),c.color=n(u),typeof t.init=="function"&&t.init(c),c}function i(u){t.save(u),t.names=[],t.skips=[];for(var c=(typeof u=="string"?u:"").split(/[\s,]+/),f=c.length,p=0;p<f;p++)!c[p]||(u=c[p].replace(/\*/g,".*?"),u[0]==="-"?t.skips.push(new RegExp("^"+u.substr(1)+"$")):t.names.push(new RegExp("^"+u+"$")))}function a(){t.enable("")}function s(u){var c,f;for(c=0,f=t.skips.length;c<f;c++)if(t.skips[c].test(u))return!1;for(c=0,f=t.names.length;c<f;c++)if(t.names[c].test(u))return!0;return!1}function o(u){return u instanceof Error?u.stack||u.message:u}}),debug_1=debug.coerce,debug_2=debug.disable,debug_3=debug.enable,debug_4=debug.enabled,debug_5=debug.humanize,debug_6=debug.names,debug_7=debug.skips,debug_8=debug.formatters,browser=createCommonjsModule(function(l,t){t=l.exports=debug,t.log=r,t.formatArgs=n,t.save=i,t.load=a,t.useColors=e,t.storage=typeof chrome!="undefined"&&typeof chrome.storage!="undefined"?chrome.storage.local:s(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function e(){return typeof window!="undefined"&&window.process&&window.process.type==="renderer"?!0:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}t.formatters.j=function(o){try{return JSON.stringify(o)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}};function n(o){var u=this.useColors;if(o[0]=(u?"%c":"")+this.namespace+(u?" %c":" ")+o[0]+(u?"%c ":" ")+"+"+t.humanize(this.diff),!!u){var c="color: "+this.color;o.splice(1,0,c,"color: inherit");var f=0,p=0;o[0].replace(/%[a-zA-Z%]/g,function(d){d!=="%%"&&(f++,d==="%c"&&(p=f))}),o.splice(p,0,c)}}function r(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(o){try{o==null?t.storage.removeItem("debug"):t.storage.debug=o}catch(u){}}function a(){var o;try{o=t.storage.debug}catch(u){}return!o&&typeof process!="undefined"&&"env"in process&&(o=process.env.DEBUG),o}t.enable(a());function s(){try{return window.localStorage}catch(o){}}}),browser_1=browser.log,browser_2=browser.formatArgs,browser_3=browser.save,browser_4=browser.load,browser_5=browser.useColors,browser_6=browser.storage,browser_7=browser.colors;function isatty(){return!1}function ReadStream(){throw new Error("tty.ReadStream is not implemented")}function WriteStream(){throw new Error("tty.ReadStream is not implemented")}var tty={isatty,ReadStream,WriteStream};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}var cachedSetTimeout=defaultSetTimout,cachedClearTimeout=defaultClearTimeout;typeof global.setTimeout=="function"&&(cachedSetTimeout=setTimeout),typeof global.clearTimeout=="function"&&(cachedClearTimeout=clearTimeout);function runTimeout(l){if(cachedSetTimeout===setTimeout)return setTimeout(l,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(l,0);try{return cachedSetTimeout(l,0)}catch(t){try{return cachedSetTimeout.call(null,l,0)}catch(e){return cachedSetTimeout.call(this,l,0)}}}function runClearTimeout(l){if(cachedClearTimeout===clearTimeout)return clearTimeout(l);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(l);try{return cachedClearTimeout(l)}catch(t){try{return cachedClearTimeout.call(null,l)}catch(e){return cachedClearTimeout.call(this,l)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var l=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(l)}}function nextTick(l){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];queue.push(new Item(l,t)),queue.length===1&&!draining&&runTimeout(drainQueue)}function Item(l,t){this.fun=l,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};var title="browser",platform="browser",browser$1=!0,env={},argv=[],version$2="",versions={},release={},config$2={};function noop(){}var on=noop,addListener=noop,once=noop,off=noop,removeListener=noop,removeAllListeners=noop,emit=noop;function binding(l){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(l){throw new Error("process.chdir is not supported")}function umask(){return 0}var performance=global.performance||{},performanceNow=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return new Date().getTime()};function hrtime(l){var t=performanceNow.call(performance)*.001,e=Math.floor(t),n=Math.floor(t%1*1e9);return l&&(e=e-l[0],n=n-l[1],n<0&&(e--,n+=1e9)),[e,n]}var startTime=new Date;function uptime(){var l=new Date,t=l-startTime;return t/1e3}var process$1={nextTick,title,browser:browser$1,env,argv,version:version$2,versions,on,addListener,once,off,removeListener,removeAllListeners,emit,binding,cwd,chdir,umask,hrtime,platform,release,config:config$2,uptime},inherits;typeof Object.create=="function"?inherits=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:inherits=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t};var inherits$1=inherits,formatRegExp=/%[sdj%]/g;function format$10(l){if(!isString$6(l)){for(var t=[],e=0;e<arguments.length;e++)t.push(inspect(arguments[e]));return t.join(" ")}for(var e=1,n=arguments,r=n.length,i=String(l).replace(formatRegExp,function(s){if(s==="%%")return"%";if(e>=r)return s;switch(s){case"%s":return String(n[e++]);case"%d":return Number(n[e++]);case"%j":try{return JSON.stringify(n[e++])}catch(o){return"[Circular]"}default:return s}}),a=n[e];e<r;a=n[++e])isNull(a)||!isObject(a)?i+=" "+a:i+=" "+inspect(a);return i}function deprecate(l,t){if(isUndefined(global.process))return function(){return deprecate(l,t).apply(this,arguments)};if(process$1.noDeprecation===!0)return l;var e=!1;function n(){if(!e){if(process$1.throwDeprecation)throw new Error(t);process$1.traceDeprecation?console.trace(t):console.error(t),e=!0}return l.apply(this,arguments)}return n}var debugs={},debugEnviron;function debuglog(l){if(isUndefined(debugEnviron)&&(debugEnviron=process$1.env.NODE_DEBUG||""),l=l.toUpperCase(),!debugs[l])if(new RegExp("\\b"+l+"\\b","i").test(debugEnviron)){var t=0;debugs[l]=function(){var e=format$10.apply(null,arguments);console.error("%s %d: %s",l,t,e)}}else debugs[l]=function(){};return debugs[l]}function inspect(l,t){var e={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(e.depth=arguments[2]),arguments.length>=4&&(e.colors=arguments[3]),isBoolean$1(t)?e.showHidden=t:t&&_extend(e,t),isUndefined(e.showHidden)&&(e.showHidden=!1),isUndefined(e.depth)&&(e.depth=2),isUndefined(e.colors)&&(e.colors=!1),isUndefined(e.customInspect)&&(e.customInspect=!0),e.colors&&(e.stylize=stylizeWithColor),formatValue(e,l,e.depth)}inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(l,t){var e=inspect.styles[t];return e?"["+inspect.colors[e][0]+"m"+l+"["+inspect.colors[e][1]+"m":l}function stylizeNoColor(l,t){return l}function arrayToHash(l){var t={};return l.forEach(function(e,n){t[e]=!0}),t}function formatValue(l,t,e){if(l.customInspect&&t&&isFunction(t.inspect)&&t.inspect!==inspect&&!(t.constructor&&t.constructor.prototype===t)){var n=t.inspect(e,l);return isString$6(n)||(n=formatValue(l,n,e)),n}var r=formatPrimitive(l,t);if(r)return r;var i=Object.keys(t),a=arrayToHash(i);if(l.showHidden&&(i=Object.getOwnPropertyNames(t)),isError(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return formatError(t);if(i.length===0){if(isFunction(t)){var s=t.name?": "+t.name:"";return l.stylize("[Function"+s+"]","special")}if(isRegExp(t))return l.stylize(RegExp.prototype.toString.call(t),"regexp");if(isDate(t))return l.stylize(Date.prototype.toString.call(t),"date");if(isError(t))return formatError(t)}var o="",u=!1,c=["{","}"];if(isArray$5(t)&&(u=!0,c=["[","]"]),isFunction(t)){var f=t.name?": "+t.name:"";o=" [Function"+f+"]"}if(isRegExp(t)&&(o=" "+RegExp.prototype.toString.call(t)),isDate(t)&&(o=" "+Date.prototype.toUTCString.call(t)),isError(t)&&(o=" "+formatError(t)),i.length===0&&(!u||t.length==0))return c[0]+o+c[1];if(e<0)return isRegExp(t)?l.stylize(RegExp.prototype.toString.call(t),"regexp"):l.stylize("[Object]","special");l.seen.push(t);var p;return u?p=formatArray(l,t,e,a,i):p=i.map(function(d){return formatProperty(l,t,e,a,d,u)}),l.seen.pop(),reduceToSingleString(p,o,c)}function formatPrimitive(l,t){if(isUndefined(t))return l.stylize("undefined","undefined");if(isString$6(t)){var e="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return l.stylize(e,"string")}if(isNumber$5(t))return l.stylize(""+t,"number");if(isBoolean$1(t))return l.stylize(""+t,"boolean");if(isNull(t))return l.stylize("null","null")}function formatError(l){return"["+Error.prototype.toString.call(l)+"]"}function formatArray(l,t,e,n,r){for(var i=[],a=0,s=t.length;a<s;++a)hasOwnProperty$5(t,String(a))?i.push(formatProperty(l,t,e,n,String(a),!0)):i.push("");return r.forEach(function(o){o.match(/^\d+$/)||i.push(formatProperty(l,t,e,n,o,!0))}),i}function formatProperty(l,t,e,n,r,i){var a,s,o;if(o=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]},o.get?o.set?s=l.stylize("[Getter/Setter]","special"):s=l.stylize("[Getter]","special"):o.set&&(s=l.stylize("[Setter]","special")),hasOwnProperty$5(n,r)||(a="["+r+"]"),s||(l.seen.indexOf(o.value)<0?(isNull(e)?s=formatValue(l,o.value,null):s=formatValue(l,o.value,e-1),s.indexOf(`
`)>-1&&(i?s=s.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):s=`
`+s.split(`
`).map(function(u){return"   "+u}).join(`
`))):s=l.stylize("[Circular]","special")),isUndefined(a)){if(i&&r.match(/^\d+$/))return s;a=JSON.stringify(""+r),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=l.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=l.stylize(a,"string"))}return a+": "+s}function reduceToSingleString(l,t,e){var n=0,r=l.reduce(function(i,a){return n++,a.indexOf(`
`)>=0&&n++,i+a.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?e[0]+(t===""?"":t+`
 `)+" "+l.join(`,
  `)+" "+e[1]:e[0]+t+" "+l.join(", ")+" "+e[1]}function isArray$5(l){return Array.isArray(l)}function isBoolean$1(l){return typeof l=="boolean"}function isNull(l){return l===null}function isNullOrUndefined(l){return l==null}function isNumber$5(l){return typeof l=="number"}function isString$6(l){return typeof l=="string"}function isSymbol(l){return typeof l=="symbol"}function isUndefined(l){return l===void 0}function isRegExp(l){return isObject(l)&&objectToString(l)==="[object RegExp]"}function isObject(l){return typeof l=="object"&&l!==null}function isDate(l){return isObject(l)&&objectToString(l)==="[object Date]"}function isError(l){return isObject(l)&&(objectToString(l)==="[object Error]"||l instanceof Error)}function isFunction(l){return typeof l=="function"}function isPrimitive(l){return l===null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||typeof l=="symbol"||typeof l=="undefined"}function isBuffer(l){return Buffer.isBuffer(l)}function objectToString(l){return Object.prototype.toString.call(l)}function pad(l){return l<10?"0"+l.toString(10):l.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var l=new Date,t=[pad(l.getHours()),pad(l.getMinutes()),pad(l.getSeconds())].join(":");return[l.getDate(),months[l.getMonth()],t].join(" ")}function log$3(){console.log("%s - %s",timestamp(),format$10.apply(null,arguments))}function _extend(l,t){if(!t||!isObject(t))return l;for(var e=Object.keys(t),n=e.length;n--;)l[e[n]]=t[e[n]];return l}function hasOwnProperty$5(l,t){return Object.prototype.hasOwnProperty.call(l,t)}var util$1={inherits:inherits$1,_extend,log:log$3,isBuffer,isPrimitive,isFunction,isError,isDate,isObject,isRegExp,isUndefined,isSymbol,isString:isString$6,isNumber:isNumber$5,isNullOrUndefined,isNull,isBoolean:isBoolean$1,isArray:isArray$5,inspect,deprecate,format:format$10,debuglog},node$2=createCommonjsModule(function(l,t){t=l.exports=debug,t.init=c,t.log=a,t.formatArgs=i,t.save=s,t.load=o,t.useColors=r,t.colors=[6,2,3,4,5,1],t.inspectOpts=Object.keys(process.env).filter(function(f){return/^debug_/i.test(f)}).reduce(function(f,p){var d=p.substring(6).toLowerCase().replace(/_([a-z])/g,function(v,h){return h.toUpperCase()}),m=process.env[p];return/^(yes|on|true|enabled)$/i.test(m)?m=!0:/^(no|off|false|disabled)$/i.test(m)?m=!1:m==="null"?m=null:m=Number(m),f[d]=m,f},{});var e=parseInt(process.env.DEBUG_FD,10)||2;e!==1&&e!==2&&util$1.deprecate(function(){},"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var n=e===1?process.stdout:e===2?process.stderr:u(e);function r(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):tty.isatty(e)}t.formatters.o=function(f){return this.inspectOpts.colors=this.useColors,util$1.inspect(f,this.inspectOpts).split(`
`).map(function(p){return p.trim()}).join(" ")},t.formatters.O=function(f){return this.inspectOpts.colors=this.useColors,util$1.inspect(f,this.inspectOpts)};function i(f){var p=this.namespace,d=this.useColors;if(d){var m=this.color,v="  [3"+m+";1m"+p+" [0m";f[0]=v+f[0].split(`
`).join(`
`+v),f.push("[3"+m+"m+"+t.humanize(this.diff)+"[0m")}else f[0]=new Date().toUTCString()+" "+p+" "+f[0]}function a(){return n.write(util$1.format.apply(util$1,arguments)+`
`)}function s(f){f==null?delete process.env.DEBUG:process.env.DEBUG=f}function o(){return process.env.DEBUG}function u(f){var p,d=process.binding("tty_wrap");switch(d.guessHandleType(f)){case"TTY":p=new tty.WriteStream(f),p._type="tty",p._handle&&p._handle.unref&&p._handle.unref();break;case"FILE":var m=require$$2;p=new m.SyncWriteStream(f,{autoClose:!1}),p._type="fs";break;case"PIPE":case"TCP":var v=require$$2;p=new v.Socket({fd:f,readable:!1,writable:!0}),p.readable=!1,p.read=null,p._type="pipe",p._handle&&p._handle.unref&&p._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return p.fd=f,p._isStdio=!0,p}function c(f){f.inspectOpts={};for(var p=Object.keys(t.inspectOpts),d=0;d<p.length;d++)f.inspectOpts[p[d]]=t.inspectOpts[p[d]]}t.enable(o())}),node_1=node$2.init,node_2=node$2.log,node_3=node$2.formatArgs,node_4=node$2.save,node_5=node$2.load,node_6=node$2.useColors,node_7=node$2.colors,node_8=node$2.inspectOpts,src=createCommonjsModule(function(l){typeof process!="undefined"&&process.type==="renderer"?l.exports=browser:l.exports=node$2}),debug$1=src("xml-parser"),xmlParser=parse$3;function parse$3(l){return l=l.trim(),l=l.replace(/<!--[\s\S]*?-->/g,""),t();function t(){return{declaration:e(),root:n()}}function e(){var c=s(/^<\?xml\s*/);if(!!c){for(var f={attributes:{}};!(o()||u("?>"));){var p=i();if(!p)return f;f.attributes[p.name]=p.value}return s(/\?>\s*/),f}}function n(){debug$1("tag %j",l);var c=s(/^<([\w-:.]+)\s*/);if(!!c){for(var f={name:c[1],attributes:{},children:[]};!(o()||u(">")||u("?>")||u("/>"));){var p=i();if(!p)return f;f.attributes[p.name]=p.value}if(s(/^\s*\/>\s*/))return f;s(/\??>\s*/),f.content=r();for(var d;d=n();)f.children.push(d);return s(/^<\/[\w-:.]+>\s*/),f}}function r(){debug$1("content %j",l);var c=s(/^([^<]*)/);return c?c[1]:""}function i(){debug$1("attribute %j",l);var c=s(/([\w:-]+)\s*=\s*("[^"]*"|'[^']*'|\w+)\s*/);if(!!c)return{name:c[1],value:a(c[2])}}function a(c){return c.replace(/^['"]|['"]$/g,"")}function s(c){var f=l.match(c);if(!!f)return l=l.slice(f[0].length),f}function o(){return l.length==0}function u(c){return l.indexOf(c)==0}}let entities={"&#913;":"\\Alpha","&Alpha;":"\\Alpha","&#x0391;":"\\Alpha","\\u0391;":"\\Alpha","&#914;":"\\Beta","&Beta;":"\\Beta","&#x0392;":"\\Beta","\\u0392;":"\\Beta","&#915;":"\\Gamma","&Gamma;":"\\Gamma","&#x0393;":"\\Gamma","\\u0393;":"\\Gamma","&#916;":"\\Delta","&Delta;":"\\Delta","&#x0394;":"\\Delta","\\u0394;":"\\Delta","&#917;":"\\Epsilon","&Epsilon;":"\\Epsilon","&#x0395;":"\\Epsilon","\\u0395;":"\\Epsilon","&#918;":"\\Zeta","&Zeta;":"\\Zeta","&#x0396;":"\\Zeta","\\u0396;":"\\Zeta","&#919;":"\\Eta","&Eta;":"\\Eta","&#x0397;":"\\Eta","\\u0397;":"\\Eta","&#920;":"\\Theta","&Theta;":"\\Theta","&#x0398;":"\\Theta","\\u0398;":"\\Theta","&#921;":"\\Iota","&Iota;":"\\Iota","&#x0399;":"\\Iota","\\u0399;":"\\Iota","&#922;":"\\Kappa","&Kappa;":"\\Kappa","&#x039A;":"\\Kappa","\\u039A;":"\\Kappa","&#923;":"\\Lambda","&Lambda;":"\\Lambda","&#x039B;":"\\Lambda","\\u039B;":"\\Lambda","&#924;":"\\Mu","&Mu;":"\\Mu","&#x039C;":"\\Mu","\\u039C;":"\\Mu","&#925;":"\\Nu","&Nu;":"\\Nu","&#x039D;":"\\Nu","\\u039D;":"\\Nu","&#926;":"\\Xi","&Xi;":"\\Xi","&#x039E;":"\\Xi","\\u039E;":"\\Xi","&#927;":"\\Omicron","&Omicron;":"\\Omicron","&#x039F;":"\\Omicron","\\u039F;":"\\Omicron","&#928;":"\\Pi","&Pi;":"\\Pi","&#x03A0;":"\\Pi","\\u03A0;":"\\Pi","&#929;":"\\Rho","&Rho;":"\\Rho","&#x03A1;":"\\Rho","\\u03A1;":"\\Rho","&#931;":"\\Sigma","&Sigma;":"\\Sigma","&#x03A3;":"\\Sigma","\\u03A3;":"\\Sigma","&#932;":"\\Tau","&Tau;":"\\Tau","&#x03A4;":"\\Tau","\\u03A4;":"\\Tau","&#933;":"\\Upsilon","&Upsilon;":"\\Upsilon","&#x03A5;":"\\Upsilon","\\u03A5;":"\\Upsilon","&#934;":"\\Phi","&Phi;":"\\Phi","&#x03A6;":"\\Phi","\\u03A6;":"\\Phi","&#935;":"\\Chi","&Chi;":"\\Chi","&#x03A7;":"\\Chi","\\u03A7;":"\\Chi","&#936;":"\\Psi","&Psi;":"\\Psi","&#x03A8;":"\\Psi","\\u03A8;":"\\Psi","&#937;":"\\Omega","&Omega;":"\\Omega","&#x03A9;":"\\Omega","\\u03A9;":"\\Omega","&#945;":"\\alpha","&alpha;":"\\alpha","&#x03B1;":"\\alpha","\\u03B1;":"\\alpha","&#946;":"\\beta","&beta;":"\\beta","&#x03B2;":"\\beta","\\u03B2;":"\\beta","&#947;":"\\gamma","&gamma;":"\\gamma","&#x03B3;":"\\gamma","\\u03B3;":"\\gamma","&#948;":"\\delta","&delta;":"\\delta","&#x03B4;":"\\delta","\\u03B4;":"\\delta","&#949;":"\\epsilon","&epsilon;":"\\epsilon","&#x03B5;":"\\epsilon","\\u03B5;":"\\epsilon","&#950;":"\\zeta","&zeta;":"\\zeta","&#x03B6;":"\\zeta","\\u03B6;":"\\zeta","&#951;":"\\eta","&eta;":"\\eta","&#x03B7;":"\\eta","\\u03B7;":"\\eta","&#952;":"\\theta","&theta;":"\\theta","&#x03B8;":"\\theta","\\u03B8;":"\\theta","&#953;":"\\iota","&iota;":"\\iota","&#x03B9;":"\\iota","\\u03B9;":"\\iota","&#954;":"\\kappa","&kappa;":"\\kappa","&#x03BA;":"\\kappa","\\u03BA;":"\\kappa","&#955;":"\\lambda","&lambda;":"\\lambda","&#x03BB;":"\\lambda","\\u03BB;":"\\lambda","&#956;":"\\mu","&mu;":"\\mu","&#x03BC;":"\\mu","\\u03BC;":"\\mu","&#957;":"\\nu","&nu;":"\\nu","&#x03BD;":"\\nu","\\u03BD;":"\\nu","&#958;":"\\xi","&xi;":"\\xi","&#x03BE;":"\\xi","\\u03BE;":"\\xi","&#959;":"\\omicron","&omicron;":"\\omicron","&#x03BF;":"\\omicron","\\u03BF;":"\\omicron","&#960;":"\\pi","&pi;":"\\pi","&#x03C0;":"\\pi","\\u03C0;":"\\pi","&#961;":"\\rho","&rho;":"\\rho","&#x03C1;":"\\rho","\\u03C1;":"\\rho","&#962;":"\\sigma",";":"\\sigma","&#x03C2;":"\\sigma","\\u03C2;":"\\sigma","&#963;":"\\sigma","&sigma;":"\\sigma","&#x03C3;":"\\sigma","\\u03C3;":"\\sigma","&#964;":"\\tau","&tau;":"\\tau","&#x03C4;":"\\tau","\\u03C4;":"\\tau","&#965;":"\\upsilon","&upsilon;":"\\upsilon","&#x03C5;":"\\upsilon","\\u03C5;":"\\upsilon","&#966;":"\\phi","&phi;":"\\phi","&#x03C6;":"\\phi","\\u03C6;":"\\phi","&#967;":"\\chi","&chi;":"\\chi","&#x03C7;":"\\chi","\\u03C7;":"\\chi","&#968;":"\\psi","&psi;":"\\psi","&#x03C8;":"\\psi","\\u03C8;":"\\psi","&#969;":"\\omega","&omega;":"\\omega","&#x03C9;":"\\omega","\\u03C9;":"\\omega","&#x2212;":"-","&minus;":"-","&#x221E;":"\\infty","&#8734;":"\\infty","&infin;":"\\infty","&sdot;":"\\cdot","&#x22C5;":"\\cdot","&#8901;":"\\cdot","&times;":"\\times","&#x00D7;":"\\times","&#215;":"\\times"};class mmlToLatex{parse(t){if(t.name==="mi")return entities[t.content]?entities[t.content]:t.content.length>1?"\\"+t.content:t.content;if(t.name==="mn")return t.content;if(t.name==="msup")return this.parse(t.children[0])+"^{"+this.parse(t.children[1])+"}";if(t.name==="mroot")return"\\sqrt["+this.parse(t.children[1])+"]{"+this.parse(t.children[1])+"}";if(t.name==="mfrac")return"\\frac{"+this.parse(t.children[0])+"}{"+this.parse(t.children[1])+"}";if(t.name==="msqrt")return"\\sqrt{"+t.children.map(function(e,n){return this.parse(e)}.bind(this)).join(" ")+"}";if(t.name==="mo")return entities[t.content]?entities[t.content]:t.content==="&#x2061;"?" ":t.content;if(t.name==="mrow"&&t.attributes.class==="MJX-TeXAtom-ORD")return t.children.map(function(e,n){return this.parse(e)}.bind(this)).join(" ");if(t.name==="math"||t.name==="mrow")return"("+t.children.map(function(e,n){return this.parse(e)}.bind(this)).join(" ")+")"}convert(t){var e=this.parse(xmlParser(t).root);return e}}class mmlToAst{constructor(){this.mmlToLatex=new mmlToLatex,this.latexToAst=new latexToAst}convert(t){return this.latexToAst.convert(this.mmlToLatex.convert(t))}}class mmlToGuppy{constructor(){this.mmlToLatex=new mmlToLatex,this.latexToAst=new latexToAst,this.astToGuppy=new astToGuppy}convert(t){return this.astToGuppy.convert(this.latexToAst.convert(this.mmlToLatex.convert(t)))}}class mmlToMathjs{constructor(){this.mmlToLatex=new mmlToLatex,this.latexToAst=new latexToAst,this.astToMathjs=new astToMathjs}convert(t){return this.astToMathjs.convert(this.latexToAst.convert(this.mmlToLatex.convert(t)))}}class mmlToText{constructor(){this.mmlToLatex=new mmlToLatex,this.latexToAst=new latexToAst,this.astToText=new astToText}convert(t){return this.astToText.convert(this.latexToAst.convert(this.mmlToLatex.convert(t)))}}class textToGuppy{constructor(){this.textToAst=new textToAst,this.astToGuppy=new astToGuppy}convert(t){return this.astToGuppy.convert(this.textToAst.convert(t))}}class textToLatex{constructor(){this.textToAst=new textToAst,this.astToLatex=new astToLatex}convert(t){return this.astToLatex.convert(this.textToAst.convert(t))}}class textToMathjs{constructor(){this.textToAst=new textToAst,this.astToMathjs=new astToMathjs}convert(t){return this.astToMathjs.convert(this.textToAst.convert(t))}}var converters=Object.freeze({astToLatexObj:astToLatex,astToTextObj:astToText,astToGuppyObj:astToGuppy,astToMathjsObj:astToMathjs,latexToAstObj:latexToAst,latexToGuppyObj:latexToGuppy,latexToMathjsObj:latexToMathjs,latexToTextObj:latexToText,mathjsToAstObj:mathjsToAst,mathjsToGuppyObj:mathjsToGuppy,mathjsToLatexObj:mathjsToLatex,mathjsToTextObj:mathjsToText,mmlToAstObj:mmlToAst,mmlToGuppyObj:mmlToGuppy,mmlToLatexObj:mmlToLatex,mmlToMathjsObj:mmlToMathjs,mmlToTextObj:mmlToText,textToAstObj:textToAst,textToGuppyObj:textToGuppy,textToLatexObj:textToLatex,textToMathjsObj:textToMathjs,astToGLSL}),textToAst$4=new textToAst,latexToAst$1=new latexToAst,mmlToAst$1=new mmlToAst,utils$2={match,flatten,unflattenLeft,unflattenRight};function Expression(l,t){this.tree=flatten(l),this.context=t,this.toJSON=function(){let e={objectType:"math-expression",tree:this.tree},n={};for(let r in this.context.assumptions)Object.keys(this.context.assumptions[r]).length>0&&(n[r]=this.context.assumptions[r]);return Object.keys(n).length>0&&(e.assumptions=n),e}}function extend$4(l,t){var e=flatten_array(Array.prototype.slice.call(arguments,2));return e.forEach(function(n){if(n)for(var r in n)t?function(){var i=r;l[i]=function(){return this.fromAst(n[i].apply(null,arguments))}}():l[r]=n[r]}),l}function extend_prototype(l,t){var e=flatten_array(Array.prototype.slice.call(arguments,2));return e.forEach(function(n){if(n)for(var r in n)(function(){var i=r;l[i]=function(){var a=[this].concat(Array.prototype.slice.call(arguments));return t?this.context.fromAst(n[i].apply(null,a)):n[i].apply(null,a)}})()}),l}function create_from_multiple(l,t){if(Array.isArray(l)||typeof l=="number")return new Expression(l,Context);if(typeof l=="string")try{return new Expression(textToAst$4.convert(l),Context)}catch(e){try{return new Expression(latexToAst$1.convert(l),Context)}catch(n){try{return new Expression(mmlToAst$1.convert(l),Context)}catch(r){throw l.indexOf("\\")!==-1?n:l.indexOf("</")!==-1?r:e}}}}function parseText(l,t){return new Expression(textToAst$4.convert(l),Context)}function parseLatex(l,t){return new Expression(latexToAst$1.convert(l),Context)}function parseMml(l,t){return new Expression(mmlToAst$1.convert(l),Context)}var Context={assumptions:initialize_assumptions(),parser_parameters:{},from:create_from_multiple,fromText:parseText,parse:parseText,fromLaTeX:parseLatex,fromLatex:parseLatex,fromTeX:parseLatex,fromTex:parseLatex,fromMml:parseMml,parse_tex:parseLatex,converters,utils:utils$2,fromAst:function(l){return new Expression(l,this)},set_to_default:function(){this.assumptions=initialize_assumptions()},get_assumptions:function(l,t){return get_assumptions(this.assumptions,l,t)},add_assumption:function(l,t){return add_assumption(this.assumptions,l,t)},add_generic_assumption:function(l){return add_generic_assumption(this.assumptions,l)},remove_assumption:function(l){return remove_assumption(this.assumptions,l)},remove_generic_assumption:function(l){return remove_generic_assumption(this.assumptions,l)},clear_assumptions:function(){this.assumptions=initialize_assumptions()},math:math$19,reviver:function(l,t){if(t&&t.objectType==="math-expression"&&t.tree!==void 0){let e=Context.fromAst(t.tree);return t.assumptions!==void 0&&(e.assumptions=t.assumptions),e}return t},class:Expression};Context.set_to_default(),extend$4(Context,!0,expression_to_tree,expression_to_tree$1),extend$4(Context,!1,expression_to_other),extend_prototype(Expression.prototype,!0,expression_to_tree),extend_prototype(Expression.prototype,!1,expression_to_other);function flatten_array(l,t){t=t===void 0?[]:t;for(var e=0;e<l.length;e++)Array.isArray(l[e])?flatten_array(l[e],t):t.push(l[e]);return t}return Context})});var Xn=Qt((Li,Wu)=>{(function(l,t){typeof Li=="object"?Wu.exports=Li=t():typeof define=="function"&&define.amd?define([],t):l.CryptoJS=t()})(Li,function(){var l=l||function(t,e){var n;if(typeof window!="undefined"&&window.crypto&&(n=window.crypto),!n&&typeof window!="undefined"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof global!="undefined"&&global.crypto&&(n=global.crypto),!n)try{n=require("crypto")}catch(y){}var r=function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch(y){}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch(y){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function y(){}return function(g){var b;return y.prototype=g,b=new y,y.prototype=null,b}}(),a={},s=a.lib={},o=s.Base=function(){return{extend:function(y){var g=i(this);return y&&g.mixIn(y),(!g.hasOwnProperty("init")||this.init===g.init)&&(g.init=function(){g.$super.init.apply(this,arguments)}),g.init.prototype=g,g.$super=this,g},create:function(){var y=this.extend();return y.init.apply(y,arguments),y},init:function(){},mixIn:function(y){for(var g in y)y.hasOwnProperty(g)&&(this[g]=y[g]);y.hasOwnProperty("toString")&&(this.toString=y.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),u=s.WordArray=o.extend({init:function(y,g){y=this.words=y||[],g!=e?this.sigBytes=g:this.sigBytes=y.length*4},toString:function(y){return(y||f).stringify(this)},concat:function(y){var g=this.words,b=y.words,x=this.sigBytes,N=y.sigBytes;if(this.clamp(),x%4)for(var C=0;C<N;C++){var _=b[C>>>2]>>>24-C%4*8&255;g[x+C>>>2]|=_<<24-(x+C)%4*8}else for(var C=0;C<N;C+=4)g[x+C>>>2]=b[C>>>2];return this.sigBytes+=N,this},clamp:function(){var y=this.words,g=this.sigBytes;y[g>>>2]&=4294967295<<32-g%4*8,y.length=t.ceil(g/4)},clone:function(){var y=o.clone.call(this);return y.words=this.words.slice(0),y},random:function(y){for(var g=[],b=0;b<y;b+=4)g.push(r());return new u.init(g,y)}}),c=a.enc={},f=c.Hex={stringify:function(y){for(var g=y.words,b=y.sigBytes,x=[],N=0;N<b;N++){var C=g[N>>>2]>>>24-N%4*8&255;x.push((C>>>4).toString(16)),x.push((C&15).toString(16))}return x.join("")},parse:function(y){for(var g=y.length,b=[],x=0;x<g;x+=2)b[x>>>3]|=parseInt(y.substr(x,2),16)<<24-x%8*4;return new u.init(b,g/2)}},p=c.Latin1={stringify:function(y){for(var g=y.words,b=y.sigBytes,x=[],N=0;N<b;N++){var C=g[N>>>2]>>>24-N%4*8&255;x.push(String.fromCharCode(C))}return x.join("")},parse:function(y){for(var g=y.length,b=[],x=0;x<g;x++)b[x>>>2]|=(y.charCodeAt(x)&255)<<24-x%4*8;return new u.init(b,g)}},d=c.Utf8={stringify:function(y){try{return decodeURIComponent(escape(p.stringify(y)))}catch(g){throw new Error("Malformed UTF-8 data")}},parse:function(y){return p.parse(unescape(encodeURIComponent(y)))}},m=s.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(y){typeof y=="string"&&(y=d.parse(y)),this._data.concat(y),this._nDataBytes+=y.sigBytes},_process:function(y){var g,b=this._data,x=b.words,N=b.sigBytes,C=this.blockSize,_=C*4,w=N/_;y?w=t.ceil(w):w=t.max((w|0)-this._minBufferSize,0);var A=w*C,$=t.min(A*4,N);if(A){for(var S=0;S<A;S+=C)this._doProcessBlock(x,S);g=x.splice(0,A),b.sigBytes-=$}return new u.init(g,$)},clone:function(){var y=o.clone.call(this);return y._data=this._data.clone(),y},_minBufferSize:0}),v=s.Hasher=m.extend({cfg:o.extend(),init:function(y){this.cfg=this.cfg.extend(y),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(y){return this._append(y),this._process(),this},finalize:function(y){y&&this._append(y);var g=this._doFinalize();return g},blockSize:512/32,_createHelper:function(y){return function(g,b){return new y.init(b).finalize(g)}},_createHmacHelper:function(y){return function(g,b){return new h.HMAC.init(y,b).finalize(g)}}}),h=a.algo={};return a}(Math);return l})});var Zu=Qt((Ri,Gu)=>{(function(l,t){typeof Ri=="object"?Gu.exports=Ri=t(Xn()):typeof define=="function"&&define.amd?define(["./core"],t):t(l.CryptoJS)})(Ri,function(l){return function(){var t=l,e=t.lib,n=e.WordArray,r=e.Hasher,i=t.algo,a=[],s=i.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(o,u){for(var c=this._hash.words,f=c[0],p=c[1],d=c[2],m=c[3],v=c[4],h=0;h<80;h++){if(h<16)a[h]=o[u+h]|0;else{var y=a[h-3]^a[h-8]^a[h-14]^a[h-16];a[h]=y<<1|y>>>31}var g=(f<<5|f>>>27)+v+a[h];h<20?g+=(p&d|~p&m)+1518500249:h<40?g+=(p^d^m)+1859775393:h<60?g+=(p&d|p&m|d&m)-1894007588:g+=(p^d^m)-899497514,v=m,m=d,d=p<<30|p>>>2,p=f,f=g}c[0]=c[0]+f|0,c[1]=c[1]+p|0,c[2]=c[2]+d|0,c[3]=c[3]+m|0,c[4]=c[4]+v|0},_doFinalize:function(){var o=this._data,u=o.words,c=this._nDataBytes*8,f=o.sigBytes*8;return u[f>>>5]|=128<<24-f%32,u[(f+64>>>9<<4)+14]=Math.floor(c/4294967296),u[(f+64>>>9<<4)+15]=c,o.sigBytes=u.length*4,this._process(),this._hash},clone:function(){var o=r.clone.call(this);return o._hash=this._hash.clone(),o}});t.SHA1=r._createHelper(s),t.HmacSHA1=r._createHmacHelper(s)}(),l.SHA1})});var Ju=Qt((ki,Xu)=>{(function(l,t){typeof ki=="object"?Xu.exports=ki=t(Xn()):typeof define=="function"&&define.amd?define(["./core"],t):t(l.CryptoJS)})(ki,function(l){return function(){var t=l,e=t.lib,n=e.WordArray,r=t.enc,i=r.Base64={stringify:function(s){var o=s.words,u=s.sigBytes,c=this._map;s.clamp();for(var f=[],p=0;p<u;p+=3)for(var d=o[p>>>2]>>>24-p%4*8&255,m=o[p+1>>>2]>>>24-(p+1)%4*8&255,v=o[p+2>>>2]>>>24-(p+2)%4*8&255,h=d<<16|m<<8|v,y=0;y<4&&p+y*.75<u;y++)f.push(c.charAt(h>>>6*(3-y)&63));var g=c.charAt(64);if(g)for(;f.length%4;)f.push(g);return f.join("")},parse:function(s){var o=s.length,u=this._map,c=this._reverseMap;if(!c){c=this._reverseMap=[];for(var f=0;f<u.length;f++)c[u.charCodeAt(f)]=f}var p=u.charAt(64);if(p){var d=s.indexOf(p);d!==-1&&(o=d)}return a(s,o,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(s,o,u){for(var c=[],f=0,p=0;p<o;p++)if(p%4){var d=u[s.charCodeAt(p-1)]<<p%4*2,m=u[s.charCodeAt(p)]>>>6-p%4*2,v=d|m;c[f>>>2]|=v<<24-f%4*8,f++}return n.create(c,f)}}(),l.enc.Base64})});var Fv=Qt((sP,kv)=>{"use strict";var D1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";kv.exports=D1});var jv=Qt((oP,Bv)=>{"use strict";var V1=Fv();function zv(){}function qv(){}qv.resetWarningCache=zv;Bv.exports=function(){function l(n,r,i,a,s,o){if(o!==V1){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}l.isRequired=l;function t(){return l}var e={array:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:t,element:l,elementType:l,instanceOf:t,node:l,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:qv,resetWarningCache:zv};return e.PropTypes=e,e}});var Hv=Qt((cP,Uv)=>{Uv.exports=jv()();var lP,uP});var mb=Qt((tk,db)=>{var _r=function(l){l==null&&(l=new Date().getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,l.constructor==Array?this.init_by_array(l,l.length):this.init_seed(l)};_r.prototype.init_seed=function(l){for(this.mt[0]=l>>>0,this.mti=1;this.mti<this.N;this.mti++){var l=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((l&4294901760)>>>16)*1812433253<<16)+(l&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}};_r.prototype.init_by_array=function(l,t){var e,n,r;for(this.init_seed(19650218),e=1,n=0,r=this.N>t?this.N:t;r;r--){var i=this.mt[e-1]^this.mt[e-1]>>>30;this.mt[e]=(this.mt[e]^(((i&4294901760)>>>16)*1664525<<16)+(i&65535)*1664525)+l[n]+n,this.mt[e]>>>=0,e++,n++,e>=this.N&&(this.mt[0]=this.mt[this.N-1],e=1),n>=t&&(n=0)}for(r=this.N-1;r;r--){var i=this.mt[e-1]^this.mt[e-1]>>>30;this.mt[e]=(this.mt[e]^(((i&4294901760)>>>16)*1566083941<<16)+(i&65535)*1566083941)-e,this.mt[e]>>>=0,e++,e>=this.N&&(this.mt[0]=this.mt[this.N-1],e=1)}this.mt[0]=2147483648};_r.prototype.random_int=function(){var l,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var e;for(this.mti==this.N+1&&this.init_seed(5489),e=0;e<this.N-this.M;e++)l=this.mt[e]&this.UPPER_MASK|this.mt[e+1]&this.LOWER_MASK,this.mt[e]=this.mt[e+this.M]^l>>>1^t[l&1];for(;e<this.N-1;e++)l=this.mt[e]&this.UPPER_MASK|this.mt[e+1]&this.LOWER_MASK,this.mt[e]=this.mt[e+(this.M-this.N)]^l>>>1^t[l&1];l=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^l>>>1^t[l&1],this.mti=0}return l=this.mt[this.mti++],l^=l>>>11,l^=l<<7&2636928640,l^=l<<15&4022730752,l^=l>>>18,l>>>0};_r.prototype.random_int31=function(){return this.random_int()>>>1};_r.prototype.random_incl=function(){return this.random_int()*(1/4294967295)};_r.prototype.random=function(){return this.random_int()*(1/4294967296)};_r.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)};_r.prototype.random_long=function(){var l=this.random_int()>>>5,t=this.random_int()>>>6;return(l*67108864+t)*(1/9007199254740992)};db.exports=_r});var Mb=Qt((Da,Ib)=>{(function(l,t){typeof Da=="object"?Ib.exports=Da=t(Xn()):typeof define=="function"&&define.amd?define(["./core"],t):t(l.CryptoJS)})(Da,function(l){return function(t){var e=l,n=e.lib,r=n.WordArray,i=n.Hasher,a=e.algo,s=[],o=[];(function(){function f(v){for(var h=t.sqrt(v),y=2;y<=h;y++)if(!(v%y))return!1;return!0}function p(v){return(v-(v|0))*4294967296|0}for(var d=2,m=0;m<64;)f(d)&&(m<8&&(s[m]=p(t.pow(d,1/2))),o[m]=p(t.pow(d,1/3)),m++),d++})();var u=[],c=a.SHA256=i.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(f,p){for(var d=this._hash.words,m=d[0],v=d[1],h=d[2],y=d[3],g=d[4],b=d[5],x=d[6],N=d[7],C=0;C<64;C++){if(C<16)u[C]=f[p+C]|0;else{var _=u[C-15],w=(_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3,A=u[C-2],$=(A<<15|A>>>17)^(A<<13|A>>>19)^A>>>10;u[C]=w+u[C-7]+$+u[C-16]}var S=g&b^~g&x,D=m&v^m&h^v&h,V=(m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22),I=(g<<26|g>>>6)^(g<<21|g>>>11)^(g<<7|g>>>25),q=N+I+S+o[C]+u[C],K=V+D;N=x,x=b,b=g,g=y+q|0,y=h,h=v,v=m,m=q+K|0}d[0]=d[0]+m|0,d[1]=d[1]+v|0,d[2]=d[2]+h|0,d[3]=d[3]+y|0,d[4]=d[4]+g|0,d[5]=d[5]+b|0,d[6]=d[6]+x|0,d[7]=d[7]+N|0},_doFinalize:function(){var f=this._data,p=f.words,d=this._nDataBytes*8,m=f.sigBytes*8;return p[m>>>5]|=128<<24-m%32,p[(m+64>>>9<<4)+14]=t.floor(d/4294967296),p[(m+64>>>9<<4)+15]=d,f.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var f=i.clone.call(this);return f._hash=this._hash.clone(),f}});e.SHA256=i._createHelper(c),e.HmacSHA256=i._createHmacHelper(c)}(Math),l.SHA256})});var Eb=Qt((Va,Ob)=>{(function(l,t){typeof Va=="object"?Ob.exports=Va=t(Xn()):typeof define=="function"&&define.amd?define(["./core"],t):t(l.CryptoJS)})(Va,function(l){return l.enc.Hex})});var _s={};mt(_s,{AggregateScores:()=>Lf,AllowedErrorInNumbers:()=>nd,AllowedErrorIsAbsolute:()=>ad,Angles:()=>Nf,AnimationInterval:()=>ip,AnimationMode:()=>np,AnimationOn:()=>rp,AssignPartialCredit:()=>Bp,AttractThreshold:()=>Nd,AuthorProp:()=>Ef,BasedOnNumber:()=>vd,Behavior:()=>lf,BetweenLines:()=>Gd,BranchId:()=>fd,CaseSensitive:()=>Dp,Center:()=>Ic,ChildNumber:()=>yc,ChunkSize:()=>tp,ColNum:()=>sf,Columns:()=>ff,ComponentIndex:()=>jd,ComponentTypes:()=>Lp,Condition:()=>Od,ContentId:()=>pd,Credit:()=>Cc,DefaultType:()=>of,Degrees:()=>Kd,Depth:()=>pf,Description:()=>kp,Direction:()=>Tf,Disabled:()=>pc,Displacement:()=>Vc,DisplayDecimals:()=>Gf,DisplayDigits:()=>Wf,DisplaySmallAsZero:()=>yd,DisplayXAxis:()=>yp,DisplayYAxis:()=>gp,Draggable:()=>dc,Dx:()=>Rc,Dy:()=>kc,Dz:()=>Fc,Else:()=>zd,EncodedGeogebraContent:()=>Ed,Endpoints:()=>Ac,Exclude:()=>Yc,ExcludeCombination:()=>Qc,ExcludeCombinations:()=>ef,Expand:()=>Gp,ExpandOnCompare:()=>Zp,ExtrapolateBackward:()=>Df,ExtrapolateForward:()=>Vf,FeedbackCode:()=>od,FeedbackCodes:()=>ud,FeedbackText:()=>ld,Fixed:()=>hc,FixedOrder:()=>qp,FlipFunction:()=>bf,ForceFullCheckWorkButton:()=>Ad,ForceNumeric:()=>lp,ForceSymbolic:()=>up,Format:()=>xc,Formula:()=>gf,From:()=>Xc,FromMathInsight:()=>Pd,Geogebra:()=>Hp,Head:()=>Sc,HeadDraggable:()=>Ld,Height:()=>cf,Hide:()=>fc,InDegrees:()=>Wd,IncludeErrorInNumberExponents:()=>id,IncludeGridlines:()=>Wc,IndependentVariable:()=>Xf,Index:()=>Pf,InitialIndependentVariableValue:()=>Jf,InitialNumber:()=>df,InitialSelectedIndex:()=>ap,InitialText:()=>mf,Inline:()=>zp,Input:()=>cp,IsResponse:()=>Vd,Keyword:()=>Kp,Label:()=>vc,Layer:()=>hp,Level:()=>kf,Location:()=>_f,LowerValue:()=>wp,MatchPartial:()=>Yp,MatchWholeWord:()=>Sp,MaxIndex:()=>Op,MaxIterations:()=>_p,MaximumNumber:()=>gd,MaximumNumberToSelect:()=>bd,MergeMathLists:()=>Cd,MinIndex:()=>Mp,MinNumColumns:()=>nf,MinNumRows:()=>rf,ModifyIndirectly:()=>mc,NDiscretizationPoints:()=>Sd,NPoints:()=>wd,NSignErrorsMatched:()=>sd,NVariants:()=>zf,NumberDecimals:()=>Ep,NumberDigits:()=>Pp,NumberOfSamples:()=>$p,NumberToSelect:()=>Uf,Numeric:()=>sp,Offset:()=>Vp,ParMax:()=>yf,ParMin:()=>vf,Parameter:()=>hf,Period:()=>Ip,Periodic:()=>Dd,PluralForm:()=>hd,PointNumber:()=>wf,Population:()=>Ap,PossibleNumberOfGroups:()=>$d,PossiblePoints:()=>wc,Prefill:()=>bc,PropIndex:()=>Ud,Radians:()=>Hd,Radius:()=>Mc,RenderAsAcuteAngle:()=>vp,RenderAsMath:()=>ep,RenderMode:()=>Qf,Rendered:()=>Bd,Result:()=>qd,RightHandSide:()=>Yf,RowNum:()=>af,SectionWideCheckWork:()=>Id,Seed:()=>jf,SelectForVariants:()=>Bf,SelectIndices:()=>Fd,SelectMultiple:()=>Fp,SelectWeight:()=>Zf,ShowControls:()=>Gc,ShowCorrectness:()=>ed,ShowLabel:()=>xd,ShowNavigation:()=>kd,ShowTicks:()=>Zc,Simplify:()=>If,SimplifyOnCompare:()=>Mf,Size:()=>Wp,Slope:()=>_d,SortResults:()=>Td,Source:()=>Rp,SplineForm:()=>Cf,SplineTension:()=>xf,Step:()=>tf,Symbolic:()=>op,SymbolicEquality:()=>Qp,Tail:()=>Dc,TailDraggable:()=>Rd,Target:()=>dd,TextType:()=>cd,Threshold:()=>Kc,Through:()=>Tc,ThroughSlopes:()=>_c,Title:()=>Rf,To:()=>Jc,Tolerance:()=>Tp,UniqueVariants:()=>qf,Unordered:()=>Xp,UnorderedCompare:()=>Jp,UpperValue:()=>Np,Uri:()=>jp,Value:()=>Af,VariableName:()=>Of,Variant:()=>Ff,Vertices:()=>$c,Weight:()=>Nc,Width:()=>uf,WithReplacement:()=>Hf,X:()=>fp,Xlabel:()=>bp,Xmax:()=>Ec,Xmin:()=>Oc,Xoffset:()=>Bc,Xs:()=>mp,Xscale:()=>$f,Xthreshold:()=>jc,Y:()=>pp,Ylabel:()=>xp,Ymax:()=>Lc,Ymin:()=>Pc,Yoffset:()=>zc,Youtube:()=>Up,Yscale:()=>Sf,Ythreshold:()=>Uc,Z:()=>dp,Zlabel:()=>Cp,Zoffset:()=>qc,Zthreshold:()=>Hc,createIntervals:()=>td,createVectors:()=>rd,delegateCheckWorkToAnswerNumber:()=>Md,includeUndefinedObjects:()=>gc,length:()=>Kf,targetPropertiesToIgnore:()=>md});function rt(l){return l.reduce((t,e)=>Array.isArray(e)?t.concat(rt(e)):t.concat(e),[])}function Ba(l,t){return console.log(`levels: ${t}`),l.reduce((e,n)=>Array.isArray(n)&&t>1?e.concat(Ba(n,t-1)):e.concat(n),[])}var za=class{constructor({properties:t,parentComponentType:e,allComponentClasses:n,standardComponentClasses:r,components:i}){this.logicComponents={},this.parentComponentType=e,this.allComponentClasses=n,this.standardComponentClasses=r,this.components=i,this.setProperties(t)}setParentComponentType(t){this.parentComponentType=t.toLowerCase()}setProperties(t){this.properties=t;let e=Object.keys(t),n=e.length,r=[];for(let i of e){let a="_property_"+i,s;s=new qa({name:a,componentType:i,comparison:"atMost",number:1,allowSpillover:!1,excludeCompositeReplacements:!0,takePropertyChildren:!0,parentComponentType:this.parentComponentType,allComponentClasses:this.allComponentClasses,standardComponentClasses:this.standardComponentClasses,components:this.components}),this.properties[i].name=a,this.logicComponents[a]=s,r.push(s)}if(this.propertyLogic=void 0,n>=1){let i="_properties";this.propertyLogic=new _i({name:i,operator:"and",propositions:r,parentComponentType:this.parentComponentType,allComponentClasses:this.allComponentClasses,standardComponentClasses:this.standardComponentClasses,components:this.components}),this.logicComponents[i]=this.propertyLogic}this.combinePropertyAndBase()}combinePropertyAndBase(){if(this.baseLogic!==void 0)if(this.propertyLogic!==void 0){let t="_propertyAndBase";this.propertyAndBaseLogic=new _i({name:t,operator:"and",propositions:[this.propertyLogic,this.baseLogic],parentComponentType:this.parentComponentType,allComponentClasses:this.allComponentClasses,standardComponentClasses:this.standardComponentClasses,components:this.components}),this.logicComponents[t]=this.propertyAndBaseLogic}else this.propertyAndBaseLogic=this.baseLogic;else this.propertyAndBaseLogic=this.propertyLogic}deleteAllLogic(){for(let t in this.logicComponents)t.substring(0,1)!=="_"&&delete this.logicComponents[t];delete this.baseLogic,this.combinePropertyAndBase()}newLeaf({name:t,componentType:e,getComponentType:n,comparison:r,number:i,requireConsecutive:a,condition:s,allowSpillover:o,excludeComponentTypes:u,excludeCompositeReplacements:c,takePropertyChildren:f,setAsBase:p=!1,...d}){if(t===void 0)throw Error("Error in child logic of "+this.parentComponentType+": child logic leaf must be named");if(t.substring(0,1)==="_")throw Error("Error in child logic of "+this.parentComponentType+": child logic leaf name cannot begin with _");if(t in this.logicComponents)throw Error("Error in child logic of "+this.parentComponentType+": name "+t+" duplicated");if(Object.keys(d).length>0)throw Error("Error in child logic of "+this.parentComponentType+": unexpected arguments to child logic leaf named "+t);let m=new qa({name:t,componentType:e,getComponentType:n,excludeComponentTypes:u,excludeCompositeReplacements:c,takePropertyChildren:f,comparison:r,number:i,requireConsecutive:a,condition:s,allowSpillover:o,parentComponentType:this.parentComponentType,allComponentClasses:this.allComponentClasses,standardComponentClasses:this.standardComponentClasses,components:this.components});return this.logicComponents[t]=m,p&&(this.baseLogic=m,this.combinePropertyAndBase()),m}newOperator({name:t,operator:e,propositions:n,sequenceMatters:r,requireConsecutive:i,allowSpillover:a,setAsBase:s=!1,...o}){if(t===void 0)throw Error("Error in child logic of "+this.parentComponentType+": child logic operator must be named");if(t.substring(0,1)==="_")throw Error("Error in child logic of "+this.parentComponentType+": child logic operator name cannot begin with _");if(t in this.logicComponents)throw Error("Error in child logic of "+this.parentComponentType+": name "+t+" duplicated");if(Object.keys(o).length>0)throw Error("Error in child logic of "+this.parentComponentType+": unexpected arguments to child logic operator named "+t);let u=new _i({name:t,operator:e,propositions:n,sequenceMatters:r,requireConsecutive:i,allowSpillover:a,parentComponentType:this.parentComponentType,allComponentClasses:this.allComponentClasses,standardComponentClasses:this.standardComponentClasses,components:this.components});return this.logicComponents[t]=u,s&&(this.baseLogic=u,this.combinePropertyAndBase()),u}getLogicComponent(t){return this.logicComponents[t]}applyLogic({activeChildren:t,maxAdapterNumber:e=0}){if(this.propertyAndBaseLogic===void 0)return t.length===0?this.logicResult={success:!0,childMatches:[]}:this.logicResult={success:!1,message:t.length+" extra children."},this.logicResult;try{this.logicResult=this.propertyAndBaseLogic.applyLogic({activeChildren:t,maxAdapterNumber:e})}catch(n){return console.warn("error encountered when evaluating child logic"),console.warn(n),this.logicResult={success:!1,message:n.message},this.logicResult}if(this.logicResult.success===!0){let n=rt(this.logicResult.childMatches);n.length!==t.length&&(this.logicResult={success:!1,message:t.length-n.length+" extra children."})}return this.logicResult}checkIfChildInLogic(t,e=!1){return this.propertyAndBaseLogic===void 0?!1:this.propertyAndBaseLogic.checkIfChildInLogic(t,e)}returnMatches(t){if(this.propertyAndBaseLogic===void 0)return;if(this.logicResult.success!==!0)return t in this.logicComponents?[]:void 0;let e=this.propertyAndBaseLogic.indicesFromNames[t];if(e===void 0)return;let n=this.logicResult.childMatches;for(let r of e)if(n=n[r],n===void 0)return[];return n=rt(n),n.sort((r,i)=>r-i),n}},Lu=za,Ai=class{constructor({name:t,parentComponentType:e,allComponentClasses:n,standardComponentClasses:r,components:i}){this.name=t,this.parentComponentType=e.toLowerCase(),this.allComponentClasses=n,this.standardComponentClasses=r,this.components=i}applyLogic(){}checkIfChildInLogic(){}setIndicesFromNames(){this.indicesFromNames={}}},qa=class extends Ai{constructor({name:t,componentType:e,getComponentType:n,excludeComponentTypes:r,excludeCompositeReplacements:i=!1,takePropertyChildren:a=!1,comparison:s="exactly",number:o=1,requireConsecutive:u=!1,condition:c,allowSpillover:f=!0,parentComponentType:p,allComponentClasses:d,standardComponentClasses:m,components:v}){super({name:t,parentComponentType:p,allComponentClasses:d,standardComponentClasses:m,components:v});if(n!==void 0?Object.defineProperty(this,"componentType",{get:()=>n().toLowerCase()}):this.componentType=e.toLowerCase(),this.excludeComponentTypes=r,this.excludeCompositeReplacements=i,this.takePropertyChildren=a,this.comparison=s,this.number=o,this.requireConsecutive=u,this.condition=c,this.allowSpillover=f,!["atLeast","atMost","exactly"].includes(s))throw Error("Error in leaf "+t+" from child logic of "+this.parentComponentType+": comparision must be 'atLeast', 'atMost', or 'exactly'");if(!(Number.isInteger(o)&&o>=0))throw Error("Error in leaf "+t+" from child logic of "+this.parentComponentType+": number must be a non-negative integer");this.maxMatches=Infinity,this.allowSpillover&&(this.comparison==="atMost"||this.comparison==="exactly")&&(this.maxMatches=this.number),this.setIndicesFromNames()}setIndicesFromNames(){this.indicesFromNames={},this.indicesFromNames[this.name]=[]}applyLogic({activeChildren:t,previouslyMatched:e=[],maxAdapterNumber:n}){this.componentClass=this.allComponentClasses[this.componentType];let r=[],i={};if(this.componentClass!==void 0)for(let s=0;s<t.length;s++){if(e.includes(s))continue;let o=t[s],u=!1;if(o instanceof this.componentClass){if(u=!0,this.condition&&!this.condition(o))u=!1;else if(this.excludeComponentTypes){for(let c of this.excludeComponentTypes)if(o instanceof this.allComponentClasses[c]){u=!1;break}}u&&this.excludeCompositeReplacements&&o.replacementOf&&(u=!1),u&&(u=this.takePropertyChildren&&o.doenetAttributes.isPropertyChild||!this.takePropertyChildren&&!o.doenetAttributes.isPropertyChild)}if(u)r.push(s);else if(this.takePropertyChildren&&o.doenetAttributes.isPropertyChild||!this.takePropertyChildren&&!o.doenetAttributes.isPropertyChild){let c=Math.min(n,o.nAdapters);for(let f=0;f<c;f++){let p=o.getAdapter(f),d=this.allComponentClasses[p.componentType.toLowerCase()];if(d!==void 0&&(d===this.componentClass||this.componentClass.isPrototypeOf(d))){if(u=!0,this.condition&&!this.condition(o))u=!1;else if(this.excludeComponentTypes)for(let m of this.excludeComponentTypes){let v=this.allComponentClasses[m];if(d===v||v.isPrototypeOf(d)){u=!1;break}}if(u){r.push(s),i[s]=p;break}}}}if(r.length===this.maxMatches)break}let a=r.length;if(this.comparison==="atLeast"){if(a<this.number)return{success:!1,message:"Need at least "+this.number+" "+this.componentType+" children, but found "+a+"."}}else if(this.comparison==="exactly"){if(a!==this.number)return{success:!1,message:"Need "+this.number+" "+this.componentType+" children, but found "+a+"."}}else if(this.comparison==="atMost"&&a>this.number)return{success:!1,message:"Need at most "+this.number+" "+this.componentType+" children, but found "+a+"."};if(this.requireConsecutive===!0){for(let s=1;s<a;s++)if(r[s]!==r[s-1]+1)return{success:!1,message:this.componentType+" children must be consecutive."}}return{success:!0,childMatches:r,adapterResults:i}}checkIfChildInLogic(t,e){return this.componentClass=this.allComponentClasses[this.componentType],!!(t.constructor===this.componentClass||e&&t instanceof this.componentClass)}},_i=class extends Ai{constructor({name:t,operator:e,propositions:n=[],sequenceMatters:r=!1,requireConsecutive:i=!1,allowSpillover:a=!0,parentComponentType:s,allComponentClasses:o,standardComponentClasses:u,components:c}){super({name:t,parentComponentType:s,allComponentClasses:o,standardComponentClasses:u,components:c});this.operator=e,this.propositions=n,this.sequenceMatters=r,this.requireConsecutive=i,this.allowSpillover=a;for(let f of n){if(!(f instanceof Ai))throw Error("Error in operator "+t+" from child logic of "+this.parentComponentType+": each proposition must be a child logic leaf or operator");if(!["and","or","xor"].includes(e))throw Error("Error in operator "+t+" from child logic of "+this.parentComponentType+": operator must be 'and', 'or', or 'xor'")}this.setIndicesFromNames()}setIndicesFromNames(){this.indicesFromNames={},this.indicesFromNames[this.name]=[];for(let t in this.propositions){let e=this.propositions[t];for(let n in e.indicesFromNames){if(n in this.indicesFromNames)throw Error("Child logic name used multiple times: "+n);let r=e.indicesFromNames[n];this.indicesFromNames[n]=[t,...r]}}}applyLogic({activeChildren:t,previouslyMatched:e=[],maxAdapterNumber:n}){let r=[],i={},a=0,s=[],o=e.slice(0);for(let u of this.propositions){let c=u.applyLogic({activeChildren:t,previouslyMatched:o,maxAdapterNumber:n});if(c.name=u.name,s.push(c),c.success===!0)a++,r.push(c.childMatches),i=Object.assign(i,c.adapterResults),this.operator!=="xor"&&(o=[...o,...rt(c.childMatches)]);else{if(this.operator==="and")return{success:!1,message:c.message};r.push([])}}if(this.operator==="or"){if(a===0){let u="Or criterion not matched. (";for(let c of s)u+=c.message+" ";return u+=")",{success:!1,message:u}}}else if(this.operator==="xor"){if(a===0||!this.allowSpillover&&a>1){let u="Xor criterion not matched. (";if(a===0)for(let c of s)u+=c.message+" ";else u+=a+" criteria matched and spillover not allowed.";return u+=")",{success:!1,message:u}}if(a>1){let u=Infinity,c;for(let f in r){let p=r[f],d=rt(p);if(d.length>0){let m=Math.min(...d);m<u&&(u=m,c=f)}}for(let f in r)f!==c&&(r[f]=[]);c!==void 0&&(i=s[c].adapterResults)}}if(a>1&&this.sequenceMatters===!0){let u=-1;for(let c of r){let f=rt(c);if(f.length>0){if(Math.min(...f)<=u)return{success:!1,message:"Active children were in wrong order."};u=Math.max(...f)}}}if(this.requireConsecutive===!0){let u=rt(r);u.sort((f,p)=>f-p);let c=u.length;for(let f=1;f<c;f++)if(u[f]!==u[f-1]+1)return{success:!1,message:"Active children must be consecutive."}}return{success:!0,childMatches:r,adapterResults:i}}checkIfChildInLogic(t,e){return this.propositions.some(n=>n.checkIfChildInLogic(t,e))}};var Ru={get:function(l,t){if(t==="__isReadOnlyProxy")return!0;let e=l[t];return e!==null&&typeof e=="object"&&e.__isReadOnlyProxy!==!0?new Proxy(e,Ru):e},set:function(l,t,e){throw Error("Property "+t+" is read-only")},deleteProperty:function(l,t){throw Error("Property "+t+" is read-only")}},Be=Ru;function Un(){return{get:function(l,t){let e=l[t];return e!==void 0&&(e.isArray&&(e.public||e.trackChanges)?e=new Proxy(e.value,ku({variable:t,nDimensions:e.nDimensions})):(e=e.value,e!==null&&typeof e=="object"&&e.__isReadOnlyProxy!==!0&&(e=new Proxy(e,Be)))),e},set:function(l,t,e){throw Error("Property "+t+" is read-only")},deleteProperty:function(l,t){throw Error("Property "+t+" is read-only")}}}function ku({variable:l,nDimensions:t,indicesSoFar:e=[]}){return{variable:l,nDimensions:t,indicesSoFar:e,get:function(n,r){let i=n[r];return i!==null&&typeof i=="object"&&t>1&&(i=new Proxy(i,ku({variable:this.variable,nDimensions:this.nDimensions-1,indicesSoFar:[...this.indicesSoFar,r]}))),i},set:function(n,r,i){throw Error("Property "+r+" is read-only")},deleteProperty:function(n,r){throw Error("Property "+r+" is read-only")}}}var $i=De(Ee());function He(l,t,e){if(Object(l)!==l||l instanceof Function||t!==void 0&&l instanceof t)return l;if(l instanceof $i.default.class)return l.copy();if(e===void 0&&(e=new WeakMap),Array.isArray(l))return[...l.map(r=>He(r,t,e))];if(l.constructor===Object&&Object.entries(l).length===0)return{};if(e.has(l))return e.get(l);try{var n=new l.constructor}catch(r){n=Object.create(Object.getPrototypeOf(l))}return l instanceof Map?Array.from(l,([r,i])=>n.set(He(r,t,e),He(i,t,e))):l instanceof Set&&Array.from(l,r=>n.add(He(r,t,e))),e.set(l,n),Object.assign(n,...Object.keys(l).map(r=>({[r]:He(l[r],t,e)})))}function sn(l,t,e){var n,r;function i(a,s){var o;if(Number.isNaN(a)&&Number.isNaN(s)||a===s)return!0;if(e!==void 0&&a instanceof e&&s instanceof e)return a.componentName===s.componentName;if(a instanceof $i.default.class&&s instanceof $i.default.class)return a.equalsViaSyntax(s);if(typeof a=="function"&&typeof s=="function"||a instanceof Date&&s instanceof Date||a instanceof RegExp&&s instanceof RegExp||a instanceof String&&s instanceof String||a instanceof Number&&s instanceof Number)return a.toString()===s.toString();if(!(a instanceof Object&&s instanceof Object)||a.isPrototypeOf(s)||s.isPrototypeOf(a)||a.constructor!==s.constructor||a.prototype!==s.prototype||n.indexOf(a)>-1||r.indexOf(s)>-1)return!1;for(o in s){if(s.hasOwnProperty(o)!==a.hasOwnProperty(o))return!1;if(typeof s[o]!=typeof a[o])return!1}for(o in a){if(s.hasOwnProperty(o)!==a.hasOwnProperty(o))return!1;if(typeof s[o]!=typeof a[o])return!1;switch(typeof a[o]){case"object":case"function":if(n.push(a),r.push(s),!i(a[o],s[o]))return!1;n.pop(),r.pop();break;default:if(a[o]!==s[o])return!1;break}}return!0}return n=[],r=[],i(l,t)}var ja=class{constructor({componentName:t,ancestors:e,serializedComponent:n,definingChildren:r,serializedChildren:i,childLogic:a,stateVariableDefinitions:s,componentInfoObjects:o,coreFunctions:u,flags:c,shadow:f,numerics:p,parentSharedParameters:d,sharedParameters:m}){this.numerics=p,this.parentSharedParameters=d,this.sharedParameters=m,this.componentName=t,this.ancestors=e,this.componentInfoObjects=o,this.coreFunctions=u,this.flags=c,f===!0&&(this.isShadow=!0),this.definingChildren=r,this.definingChildren===void 0&&(this.definingChildren=[]),this.serializedChildren=i,this.childLogic=a,this.state={};for(let v in s)this.state[v]=Object.assign({},s[v]);this.stateValues=new Proxy(this.state,Un()),n.state&&(this.potentialEssentialState=new Proxy(n.state,Be)),this.doenetAttributes={},n.doenetAttributes!==void 0&&Object.assign(this.doenetAttributes,n.doenetAttributes),n.variants!==void 0&&(this.variants=n.variants)}static componentType="_base";static get rendererType(){return this.componentType}get componentType(){return this.constructor.componentType.toLowerCase()}get rendererType(){return this.constructor.rendererType}get allPotentialRendererTypes(){if(!this.rendererType)return[];let t=[this.rendererType];for(let e in this.state){let n=this.state[e];if(n.public){let r=n.componentType;Array.isArray(r)||(r=[r]),n.wrappingComponents&&r.push(...rt(n.wrappingComponents).map(i=>typeof i=="object"?i.componentType:i));for(let i of r){let a=this.componentInfoObjects.allComponentClasses[i];if(a){let s=a.rendererType;s&&!t.includes(s)&&t.push(s)}}}}for(let e in this.allChildren){let n=this.allChildren[e].component;for(let r of n.allPotentialRendererTypes)t.includes(r)||t.push(r)}return t}readOnlyProxyHandler=Be;potentialRendererTypesFromSerializedComponents(t){let e=[];for(let n of t){let i=this.componentInfoObjects.allComponentClasses[n.componentType].rendererType;if(i&&!e.includes(i)&&e.push(i),n.children){let a=this.potentialRendererTypesFromSerializedComponents(n.children);for(let s of a)e.includes(s)||e.push(s)}}return e}get childLogicSatisfied(){return this.childLogic.logicResult.success}static createPropertiesObject({flags:t={}}={}){return{hide:{default:!1},disabled:{default:!!t.readOnly,forRenderer:!0,propagateToDescendants:!0},modifyIndirectly:{default:!0,propagateToProps:!0},fixed:{default:!1},styleNumber:{default:1,propagateToDescendants:!0},isResponse:{default:!1}}}static returnSugarInstructions(){return[]}static returnChildLogic({standardComponentClasses:t,allComponentClasses:e,components:n,allPossibleProperties:r,flags:i}){return new Lu({parentComponentType:this.componentType,properties:this.createPropertiesObject({standardComponentClasses:t,allPossibleProperties:r,flags:i}),allComponentClasses:e,standardComponentClasses:t,components:n})}static returnStateVariableDefinitions(){let t={};return t.childrenToRender={returnDependencies:()=>({}),definition:()=>({newValues:{childrenToRender:[]}})},t.hidden={public:!0,componentType:"boolean",forRenderer:!0,returnDependencies:()=>({hide:{dependencyType:"stateVariable",variableName:"hide",variablesOptional:!0},parentHidden:{dependencyType:"parentStateVariable",variableName:"hidden"},parentOverrideChildHide:{dependencyType:"parentStateVariable",variableName:"overrideChildHide"},sourceCompositeHidden:{dependencyType:"sourceCompositeStateVariable",variableName:"hidden"}}),definition:({dependencyValues:e})=>({newValues:{hidden:e.parentHidden===!0||e.sourceCompositeHidden===!0||e.hide===!0&&!e.parentOverrideChildHide}})},t.isInactiveCompositeReplacement={defaultValue:!1,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{isInactiveCompositeReplacement:{variablesToCheck:["isInactiveCompositeReplacement"]}}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:{variableName:"isInactiveCompositeReplacement",value:e.isInactiveCompositeReplacement}}]}}},t}static returnNormalizedStateVariableDefinitions({propertyNames:t,numerics:e}){let n=this.returnStateVariableDefinitions({propertyNames:t,numerics:e});if(!n)throw Error(`Error in state variable definitions of ${this.componentType}: returnStateVariableDefinitions did not return anything`);let r=function(s){for(let[o,u]of s.entries())typeof u=="object"&&(s[o]=u.variableName)},i=["returnDependencies","definition","inverseDefinition","stateVariablesDeterminingDependencies","isArray","nDimensions","returnArraySizeDependencies","returnArraySize","returnArrayDependenciesByKey","arrayDefinitionByKey","inverseArrayDefinitionByKey","basedOnArrayKeyStateVariables","entireArrayAtOnce","markStale","getPreviousDependencyValuesForMarkStale"],a={};for(let s in n){let o=n[s];if(a[s]=o,o.additionalStateVariablesDefined){for(let[u,c]of o.additionalStateVariablesDefined.entries()){let f={};for(let d of i)d in o&&(f[d]=o[d]);f.additionalStateVariablesDefined=[...o.additionalStateVariablesDefined],f.additionalStateVariablesDefined[u]=s,r(f.additionalStateVariablesDefined);let p=c;typeof c=="object"&&(p=c.variableName,c=Object.assign({},c),delete c.variableName,Object.assign(f,c)),a[p]=f}r(o.additionalStateVariablesDefined)}}return a}static returnStateVariableInfo({onlyPublic:t=!1,standardComponentClasses:e,allPossibleProperties:n}){let r=this.createPropertiesObject({standardComponentClasses:e,allPossibleProperties:n}),i={},a={},s={};for(let u in r){let c=r[u].componentType;if(i[u]={componentType:c||u,public:!0},r[u].entryPrefixes){let f=e[u].attributesForPropertyValue;if(f&&f.isArray){i[u].isArray=!0;for(let p of r[u].entryPrefixes)a[p]={arrayVariableName:u}}else console.warn(`entryPrefixes ignored for property ${u} of ${this.componentType}`)}}let o=this.returnNormalizedStateVariableDefinitions({propertyNames:Object.keys(i)});for(let u in o){let c=o[u];if(c.isAlias){s[u]=c.targetVariableName;continue}if((!t||c.public)&&(i[u]={componentType:c.componentType,public:c.public,containsComponentNamesToCopy:c.containsComponentNamesToCopy},c.isArray&&(i[u].isArray=!0,i[u].nDimensions=c.nDimensions===void 0?1:c.nDimensions,i[u].wrappingComponents=c.returnWrappingComponents?c.returnWrappingComponents():[],c.entryPrefixes)))for(let f of c.entryPrefixes)a[f]={arrayVariableName:u,nDimensions:c.returnEntryDimensions?c.returnEntryDimensions(f):1,wrappingComponents:c.returnWrappingComponents?c.returnWrappingComponents(f):[]}}return{stateVariableDescriptions:i,arrayEntryPrefixes:a,aliases:s}}get parentName(){if(!(this.ancestors===void 0||this.ancestors.length===0))return this.ancestors[0].componentName}getAllChildrenDownstreamComponentNames(t=!1){let e=Object.keys(this.allChildren),n=Object.keys(this.downstreamDependencies);return t!==!0&&(n=n.filter(r=>this.downstreamDependencies[r].inactive!==!0)),[...e,...n]}get allDescendants(){let t=[];for(let e in this.allChildren){let n=this.allChildren[e].component;t=[...t,e,...n.allDescendants]}return t}static useChildrenForReference=!0;static get stateVariablesShadowedForReference(){return[]}returnSerializeInstructions(){return{}}serialize(t={}){let e=!0,n=!0,r=[];if(t.forCopy)e=!1,n=!0;else{let s=this.returnSerializeInstructions();s.skipChildren&&(n=!1),s.stateVariables&&(r=s.stateVariables)}let i={componentType:this.componentType},a=[];if(e||n){for(let s of this.definingChildren)(e&&s.doenetAttributes.isPropertyChild||n&&!s.doenetAttributes.isPropertyChild)&&a.push(s.serialize(t));if(this.serializedChildren!==void 0)for(let s of this.serializedChildren)a.push(this.copySerializedComponent({serializedComponent:s,parameters:t}));a.length>0&&(i.children=a)}if(t.forCopy)i.originalName=this.componentName,i.originalDoenetAttributes=He(this.doenetAttributes),i.doenetAttributes=He(this.doenetAttributes),delete i.doenetAttributes.prescribedName,delete i.doenetAttributes.assignNames;else{console.warn("serializing a component without forCopy set is not yet converted!!!!");let s={};for(let u in this._state)if(this.state[u].essential||r.includes(u)){let c=this.state[u].value;this.state[u].usedDefault||(s[u]=c)}Object.keys(s).length>0&&(i.state=s);let o=Object.assign({},this.doenetAttributes);Object.keys(o).length>0&&(i.doenetAttributes=o)}return i}copySerializedComponent({serializedComponent:t,parameters:e}){let n=[];if(t.children!==void 0)for(let i of t.children)n.push(this.copySerializedComponent({serializedComponent:i,parameters:e}));let r={componentType:t.componentType,originalName:t.componentName,originalNameFromSerializedComponent:!0,children:n,state:{},doenetAttributes:{}};return t.doenetAttributes!==void 0&&(r.originalDoenetAttributes=He(t.doenetAttributes),r.doenetAttributes=He(t.doenetAttributes),delete r.doenetAttributes.prescribedName,delete r.doenetAttributes.assignNames),t.state!==void 0&&Object.assign(r.state,t.state),r}adapters=[];get nAdapters(){return this.adapters.length}getAdapter(t){if(t>=this.adapters.length)return;let e=this.adapters[t],n,r;typeof e=="string"?n=e:(n=e.stateVariable,r=e.componentType);let i=this.state[n];if(i===void 0||!i.public&&!r)throw Error("Invalid adapter "+n+" in "+this.componentType);r===void 0&&(r=i.componentType);let a={};return this.doenetAttributes.isPropertyChild&&(a.isPropertyChild=!0),{componentType:r,doenetAttributes:a,downstreamDependencies:{[this.componentName]:[{dependencyType:"adapter",adapterVariable:n,adapterTargetIdentity:{componentName:this.componentName,componentType:this.componentType}}]}}}},_e=ja;var Ua=class extends _e{static componentType="_inline"},Me=Ua;var Di=De(Ee());var wt=De(Ee());var Ke=De(Ee());var $t=De(Ee());function er({value:l,simplify:t,expand:e=!1,createVectors:n=!1,createIntervals:r=!1}){return n&&(l=l.tuples_to_vectors()),r&&(l=l.to_intervals()),e&&(l=l.expand()),t==="full"?l.simplify():t==="numbers"?l.evaluate_numbers():t==="numberspreserveorder"?l.evaluate_numbers({skip_ordering:!0}):l}function ht(l){if(l!==void 0)return Number.isFinite(l)||l.evaluate_to_constant!==void 0&&(l=l.evaluate_to_constant(),Number.isFinite(l))?l:null}function nt(l){return l==null?$t.default.fromAst("\uFF3F"):l instanceof $t.default.class?l:typeof l=="number"||typeof l=="string"?$t.default.fromAst(l):$t.default.fromAst("\uFF3F")}function Fu(l,t){if(!Number.isInteger(l)||l<1)return[];let e=t.length;if(e===0){if(l===1)return[$t.default.fromAst("x")];if(l===2)return[$t.default.fromAst("x"),$t.default.fromAst("y")];if(l===3)return[$t.default.fromAst("x"),$t.default.fromAst("y"),$t.default.fromAst("z")];{let i=[];for(let a=1;a<=l;a++)i.push($t.default.fromText(`x_${a}`));return i}}if(new Set(t.map(i=>i.toString())).size<e&&console.warn("Duplicate variables specified"),l<=e)return t.slice(0,l);let n=[...t.map(i=>i.toString())],r=[...t];for(let i=e+1;i<=l;i++){let a;i==1?l>3?a=["x_1"]:a=["x"]:i==2?l>3?a=["x_2","y_2"]:a=["y","x_2"]:i==3?l>3?a=["x_3","y_3","z_3"]:a=["z","x_3","z_3"]:a=["x","y","z","u","v","w","X","Y","Z"].map(o=>`${o}_${i}`);let s=!1;for(let o of a)if(!n.includes(o)){r.push($t.default.fromText(o)),n.push(o),s=!0;break}if(!s){let o=a[0];r.push($t.default.fromText(o)),n.push(o),console.warn("Variables added were not unique")}}return r}function Bu({desiredVector:l,currentVector:t,workspace:e,workspaceKey:n}){if(l.tree[0]==="vector"&&t.tree[0]==="vector"){let r;e[n]?r=e[n].slice(0):r=t.tree.slice(0);for(let[i,a]of l.tree.entries())a!==void 0&&(r[i]=a);l=$t.default.fromAst(r),e[n]=r}return l}var zu=["abs","exp","log","ln","log10","sign","sqrt","erf","acos","acosh","acot","acoth","acsc","acsch","asec","asech","asin","asinh","atan","atanh","cos","cosh","cot","coth","csc","csch","sec","sech","sin","sinh","tan","tanh","arcsin","arccos","arctan","arccsc","arcsec","arccot","cosec","arg","min","max","mean","median","floor","ceil","round","sum","prod","var","std","count","mod"],Hb=new Ke.default.converters.textToAstObj({appliedFunctionSymbols:zu}),Kb=new Ke.default.converters.latexToAstObj({appliedFunctionSymbols:zu}),Ha=class extends Me{static componentType="math";static primaryStateVariableForDefinition="unnormalizedValue";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["unnormalizedValue"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.format={default:"text",validValues:["text","latex"]},e.simplify={default:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numberspreserveorder"]},e.expand={default:!1},e.displayDigits={default:10},e.displayDecimals={default:null},e.displaySmallAsZero={default:!1},e.renderMode={default:"inline",forRenderer:!0},e.unordered={default:!1},e.createVectors={default:!1},e.createIntervals={default:!1},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroStrings",componentType:"string",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroMaths",componentType:"math",comparison:"atLeast",number:0});return e.newOperator({name:"stringsAndMaths",operator:"and",propositions:[n,r],requireConsecutive:!0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.valueShadow={defaultValue:Ke.default.fromAst("\uFF3F"),returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{valueShadow:{variablesToCheck:["value","valueShadow"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"valueShadow",value:e.valueShadow}]}}},t.codePre={returnDependencies:()=>({stringChildren:{dependencyType:"child",childLogicName:"atLeastZeroStrings",variableNames:["value"],requireChildLogicInitiallySatisfied:!0}}),definition:Wb},t.expressionWithCodes={returnDependencies:()=>({stringMathChildren:{dependencyType:"child",childLogicName:"stringsAndMaths",variableNames:["value"],requireChildLogicInitiallySatisfied:!0},format:{dependencyType:"stateVariable",variableName:"format"},codePre:{dependencyType:"stateVariable",variableName:"codePre"},createVectors:{dependencyType:"stateVariable",variableName:"createVectors"},createIntervals:{dependencyType:"stateVariable",variableName:"createIntervals"}}),definition:Gb},t.unnormalizedValue={returnDependencies:()=>({mathChildren:{dependencyType:"child",childLogicName:"atLeastZeroMaths",variableNames:["value","canBeModified"],requireChildLogicInitiallySatisfied:!0},stringChildren:{dependencyType:"child",childLogicName:"atLeastZeroStrings",variableNames:["value"],requireChildLogicInitiallySatisfied:!0},expressionWithCodes:{dependencyType:"stateVariable",variableName:"expressionWithCodes"},codePre:{dependencyType:"stateVariable",variableName:"codePre"},valueShadow:{dependencyType:"stateVariable",variableName:"valueShadow"}}),set:nt,defaultValue:Ke.default.fromAst("\uFF3F"),definition:Zb,inverseDefinition:Yb},t.value={public:!0,componentType:this.componentType,returnDependencies:()=>({unnormalizedValue:{dependencyType:"stateVariable",variableName:"unnormalizedValue"},simplify:{dependencyType:"stateVariable",variableName:"simplify"},expand:{dependencyType:"stateVariable",variableName:"expand"},createVectors:{dependencyType:"stateVariable",variableName:"createVectors"},createIntervals:{dependencyType:"stateVariable",variableName:"createIntervals"}}),definition:function({dependencyValues:e}){let n=e.unnormalizedValue,{simplify:r,expand:i,createVectors:a,createIntervals:s}=e;return n=er({value:n,simplify:r,expand:i,createVectors:a,createIntervals:s}),{newValues:{value:n}}},inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"unnormalizedValue",desiredValue:e.value}]}}},t.number={public:!0,componentType:"number",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){let n=e.value.evaluate_to_constant();return n===null&&(n=NaN),{newValues:{number:n}}},inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"value",desiredValue:Ke.default.fromAst(e.number)}]}}},t.isNumber={public:!0,componentType:"boolean",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{newValues:{isNumber:Number.isFinite(e.value.tree)}}}},t.isNumeric={public:!0,componentType:"boolean",returnDependencies:()=>({number:{dependencyType:"stateVariable",variableName:"number"}}),definition:function({dependencyValues:e}){return{newValues:{isNumeric:Number.isFinite(e.number)}}}},t.valueForDisplay={returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displayDecimals:{dependencyType:"stateVariable",variableName:"displayDecimals"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"},simplify:{dependencyType:"stateVariable",variableName:"simplify"},expand:{dependencyType:"stateVariable",variableName:"expand"}}),definition:function({dependencyValues:e,usedDefault:n}){let r;return n.displayDigits&&!n.displayDecimals?r=e.value.round_numbers_to_decimals(e.displayDecimals):(r=e.value.round_numbers_to_precision(e.displayDigits),e.displaySmallAsZero&&(r=r.evaluate_numbers({skip_ordering:!0,set_small_zero:!0}))),{newValues:{valueForDisplay:er({value:r,simplify:e.simplify,expand:e.expand})}}}},t.latex={public:!0,componentType:"text",returnDependencies:()=>({valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"}}),definition:function({dependencyValues:e}){return{newValues:{latex:e.valueForDisplay.toLatex()}}}},t.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){return{newValues:{latexWithInputChildren:[e.latex]}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"}}),definition:function({dependencyValues:e}){return{newValues:{text:e.valueForDisplay.toString()}}}},t.codesAdjacentToStrings={returnDependencies:()=>({stringMathChildren:{dependencyType:"child",childLogicName:"stringsAndMaths"},codePre:{dependencyType:"stateVariable",variableName:"codePre"},format:{dependencyType:"stateVariable",variableName:"format"}}),definition:Xb},t.canBeModified={additionalStateVariablesDefined:["constantChildIndices","codeForExpression","inverseMaps","template","mathChildrenMapped"],returnDependencies:()=>({mathChildrenModifiable:{dependencyType:"child",childLogicName:"atLeastZeroMaths",variableNames:["canBeModified"],requireChildLogicInitiallySatisfied:!0},expressionWithCodes:{dependencyType:"stateVariable",variableName:"expressionWithCodes"},modifyIndirectly:{dependencyType:"stateVariable",variableName:"modifyIndirectly"},fixed:{dependencyType:"stateVariable",variableName:"fixed"},codePre:{dependencyType:"stateVariable",variableName:"codePre"}}),definition:Jb},t.mathChildrenByArrayComponent={returnDependencies:()=>({codePre:{dependencyType:"stateVariable",variableName:"codePre"},mathChildren:{dependencyType:"child",childLogicName:"atLeastZeroMaths"},expressionWithCodes:{dependencyType:"stateVariable",variableName:"expressionWithCodes"}}),definition:function({dependencyValues:e}){if(e.expressionWithCodes===null)return{newValues:{mathChildrenByArrayComponent:null}};let n=e.expressionWithCodes.tree,r=e.mathChildren.length;if(r===0||!Array.isArray(n)||!["tuple","vector"].includes(n[0]))return{newValues:{mathChildrenByArrayComponent:null}};let i={},a=0,s=e.codePre+a;for(let o=1;o<n.length;o++){let u=n[o],c=i[o]=[];if(Array.isArray(u)){let f=rt(u);for(;s in f;)c.push(a),a++,s=e.codePre+a}else u===s&&(c.push(a),a++,s=e.codePre+a);if(a>=r)break}return{newValues:{mathChildrenByArrayComponent:i}}}},t}returnSerializeInstructions(){let t=this.childLogic.returnMatches("atLeastZeroStrings").length===1&&this.childLogic.returnMatches("atLeastZeroMaths").length===0;return t?{skipChildren:t,stateVariables:["unnormalizedValue"]}:{}}adapters=["number","text"]},ke=Ha;function Wb({dependencyValues:l}){let t="math",e=!1;do{e=!1;for(let n of l.stringChildren)if(n.componentType==="string"&&n.stateValues.value.includes(t)===!0){e=!0,t+="m";break}}while(e);return{newValues:{codePre:t}}}function Gb({dependencyValues:l,changes:t}){if(!("stringMathChildren"in t&&t.stringMathChildren.componentIdentitiesChanged||"format"in t||"createIntervals"in t||"createVectors"in t))return{noChanges:["expressionWithCodes"]};if(l.stringMathChildren.length===0)return{newValues:{expressionWithCodes:null}};let e="",n=0,r,i="",a=0;for(let o of l.stringMathChildren){if(a>0&&o.compositeInd!==r){if(a>1){let u=e.trimEnd(),c=!1;if(u.length===0)c=!0;else{let f=u[u.length-1];if(!["{","[","(","|",","].includes(f))c=!0;else if(o.componentType!=="string")c=!0;else{let p=o.stateValues.value.trimStart();if(p.length===0)c=!0;else{let d=p[0];l.format==="latex"&&d==="\\"&&p.length>1&&(d=p[1]),["}","]",")","|",","].includes(d)||(c=!0)}}}c&&(i="("+i+")")}e+=i,i="",a=0}if(o.componentType==="string")e+=" "+o.stateValues.value+" ",i="",a=0;else{let u=l.codePre+n;n++;let c;l.format==="latex"?c="\\var{"+u+"}":c=" "+u+" ",o.compositeInd!==void 0?(o.compositeInd===r&&(i+=","),i+=c,a++):(e+=c,i="",a=0)}r=o.compositeInd}a>0&&(a>1&&(i="("+i+")"),e+=i);let s=null;if(e==="")s=Ke.default.fromAst("\uFF3F");else{if(l.format==="text")try{s=Ke.default.fromAst(Hb.convert(e))}catch(o){s=Ke.default.fromAst("\uFF3F"),console.log("Invalid value for a math of text format: "+e)}else if(l.format==="latex")try{s=Ke.default.fromAst(Kb.convert(e))}catch(o){s=Ke.default.fromAst("\uFF3F"),console.log("Invalid value for a math of latex format: "+e)}l.createVectors&&(s=s.tuples_to_vectors()),l.createIntervals&&(s=s.to_intervals())}return{newValues:{expressionWithCodes:s},makeEssential:["expressionWithCodes"]}}function Zb({dependencyValues:l}={}){if(l.expressionWithCodes===null)return{newValues:{unnormalizedValue:l.valueShadow},makeEssential:["unnormalizedValue"]};let t={};for(let[n,r]of l.mathChildren.entries())t[l.codePre+n]=r.stateValues.value;let e=l.expressionWithCodes;return l.mathChildren.length>0&&(e=e.substitute(t)),{newValues:{unnormalizedValue:e},makeEssential:["unnormalizedValue"]}}function Xb({dependencyValues:l}){let t=[],e;for(let[n,r]of l.stringMathChildren.entries())if(r.componentType==="string"){let i=l.stringMathChildren[n+1];if(i!==void 0&&i.componentType==="string")continue;let a={};if(e!==void 0&&(l.format==="latex"?a.prevCode="\\var{"+l.codePre+e+"}":a.prevCode=l.codePre+e),i!==void 0){let s=0;e!==void 0&&(s=e+1),l.format==="latex"?a.nextCode="\\var{"+l.codePre+s+"}":a.nextCode=l.codePre+s}t.push(a)}else e===void 0?e=0:e++;return{newValues:{codesAdjacentToStrings:t}}}function Jb({dependencyValues:l}){if(!l.modifyIndirectly||l.fixed)return{newValues:{canBeModified:!1,constantChildIndices:null,codeForExpression:null,inverseMaps:null,template:null,mathChildrenMapped:null}};if(l.mathChildrenModifiable.length===0)return{newValues:{canBeModified:!0,constantChildIndices:null,codeForExpression:null,inverseMaps:null,template:null,mathChildrenMapped:null}};let t=[],e=[],n=[],r={};for(let[o,u]of l.mathChildrenModifiable.entries()){let c=l.codePre+o;u.stateValues.canBeModified===!0?(t.push(o),e.push(c)):(n.push(c),r[c]=o)}let i=l.codePre+"expr",a=Ke.default.utils.unflattenLeft(l.expressionWithCodes.tree),s=qu(a,e,i,n);if(s.foundLinear){let o={},u=s.template,c=new Set;for(let f in s.mappings){o[f]=s.mappings[f];let p=o[f].mathChildSub;if(p){let d=t[e.indexOf(p)];o[f].mathChildInd=d,c.add(Number(d))}}return c.has=c.has.bind(c),{newValues:{canBeModified:!0,constantChildIndices:r,codeForExpression:i,inverseMaps:o,template:u,mathChildrenMapped:c}}}return{newValues:{canBeModified:!1,constantChildIndices:null,codeForExpression:null,inverseMaps:null,template:null,mathChildrenMapped:null}}}function qu(l,t,e,n=[],r=[]){let i=Ke.default.variables(l);if(i.every(o=>!t.includes(o))&&i.every(o=>!n.includes(o))){let o={},u="x"+r.join("_");return o[u]={result:Ke.default.fromAst(e).simplify(),components:r},{foundLinear:!0,mappings:o,template:u}}if(!Array.isArray(l))return $r(l,t,e,r);let a=l[0],s=l.slice(1);if(a==="tuple"||a==="vector"||a==="list"){let o={mappings:{},template:[a]},u=0;for(let c=0;c<s.length;c++){let f=[...r,c],p=qu(s[c],t,e,n,f);p.foundLinear?(u++,o.mappings=Object.assign(o.mappings,p.mappings),o.template.push(p.template)):o.template.push("x"+f.join("_"))}return u===0?{foundLinear:!1}:(o.foundLinear=!0,o)}else return $r(l,t,e,r)}function $r(l,t,e,n=[]){if(typeof l=="string"&&t.includes(l)){let a={},s="x"+n.join("_");return a[s]={result:Ke.default.fromAst(e).simplify(),components:n,mathChildSub:l},{foundLinear:!0,mappings:a,template:s}}if(!Array.isArray(l))return{foundLinear:!1};let r=l[0],i=l.slice(1);return r==="-"?(e=["-",e],$r(i[0],t,e,n)):r==="+"?Ke.default.variables(i[0]).every(a=>!t.includes(a))?(e=["+",e,["-",i[0]]],$r(i[1],t,e,n)):Ke.default.variables(i[1]).every(a=>!t.includes(a))?(e=["+",e,["-",i[1]]],$r(i[0],t,e,n)):{foundLinear:!1}:r==="*"?Ke.default.variables(i[0]).every(a=>!t.includes(a))?(e=["/",e,i[0]],$r(i[1],t,e,n)):Ke.default.variables(i[1]).every(a=>!t.includes(a))?(e=["/",e,i[1]],$r(i[0],t,e,n)):{foundLinear:!1}:r==="/"?Ke.default.variables(i[1]).every(a=>!t.includes(a))?(e=["*",e,i[1]],$r(i[0],t,e,n)):{foundLinear:!1}:{foundLinear:!1}}function Yb({desiredStateVariableValues:l,dependencyValues:t,stateValues:e,workspace:n,overrideFixed:r}){if(!e.canBeModified&&!r)return{success:!1};let i=nt(l.unnormalizedValue),a=e.value,s;if((i.tree[0]==="tuple"||i.tree[0]==="vector")&&a&&a.tree[0]===i.tree[0]){let d;n.desiredExpressionAst?d=n.desiredExpressionAst.slice(0):d=a.tree.slice(0);let m=[],v=!1;for(let[h,y]of i.tree.entries())y===void 0?(v=!0,m.push(h)):d[h]=y;i=Ke.default.fromAst(d),n.desiredExpressionAst=d,v&&(s=m)}let o=t.mathChildren,u=t.stringChildren;if(o.length===0){let d=[];for(let v=0;v<u.length;v++)d.push({deferSettingDependency:"stringChildren",inverseDefinition:ju,childIndex:v,variableIndex:0,dependencyValues:{mathChildren:t.mathChildren,stringChildren:t.stringChildren}});let m=i.simplify();return d.push({setStateVariable:"unnormalizedValue",value:m}),u.length===0&&d.push({setDependency:"valueShadow",desiredValue:m}),{success:!0,instructions:d}}let c=Qb({expression:i,stateValues:e});if(!c)return{success:!1};let f=[],p=[];if(s&&e.mathChildrenByArrayComponent)for(let d of s)e.mathChildrenByArrayComponent[d]&&p.push(...e.mathChildrenByArrayComponent[d]);for(let[d,m]of o.entries())if(e.mathChildrenMapped.has(d)&&m.stateValues.canBeModified){if(!p.includes(d)){let v=c[d],h={},y=!1;for(let g in e.constantChildIndices){let b=e.constantChildIndices[g];h[g]=o[b].stateValues.value,y=!0}y&&(v=v.substitute(h)),v=v.simplify(),f.push({setDependency:"mathChildren",desiredValue:v,childIndex:d,variableIndex:0})}delete c[d]}if(u.length>0){let d=e.expressionWithCodes;for(let m in c){let v=e.inverseMaps[m];if(v.mathChildInd!==void 0)continue;let h=v.components;d=d.substitute_component(h,c[m])}f.push({setStateVariable:"expressionWithCodes",value:d});for(let m=0;m<u.length;m++)f.push({deferSettingDependency:"stringChildren",inverseDefinition:ju,childIndex:m,variableIndex:0,dependencyValues:{mathChildren:t.mathChildren,stringChildren:t.stringChildren}})}return{success:!0,instructions:f}}function ju({dependencyValues:l,stateValues:t}){console.log("finishInvertMathForStringChildren");let e=l.mathChildren,n=l.stringChildren;if(e.length===0){let i;t.format==="latex"?i=t.value.toLatex():i=t.value.toString();let a=[{setDependency:"stringChildren",desiredValue:i,childIndex:0,variableIndex:0}];for(let s=1;s<n.length;s++)a.push({setDependency:"stringChildren",desiredValue:"",childIndex:s,variableIndex:0});return{success:!0,instructions:a}}let r=[];if(n.length>0){let i;t.format==="latex"?i=t.expressionWithCodes.toLatex():i=t.expressionWithCodes.toString();for(let[a,s]of t.codesAdjacentToStrings.entries()){let o=i;Object.keys(s).length===0?r.push({setDependency:"stringChildren",desiredValue:"",childIndex:a,variableIndex:0}):(s.prevCode&&(o=o.split(s.prevCode)[1]),s.nextCode&&(o=o.split(s.nextCode)[0]),r.push({setDependency:"stringChildren",desiredValue:o,childIndex:a,variableIndex:0}))}}return{success:!0,instructions:r}}function Qb({expression:l,stateValues:t}){let e=Ke.default.utils.match(l.tree,t.template);if(!e&&(e=Ke.default.utils.match(l.tuples_to_vectors().tree,Ke.default.fromAst(t.template).tuples_to_vectors().tree),!e&&(e=Ke.default.utils.match(l.to_intervals().tree,Ke.default.fromAst(t.template).to_intervals().tree),!e&&(e=Ke.default.utils.match(l.tuples_to_vectors().to_intervals().tree,Ke.default.fromAst(t.template).tuples_to_vectors().to_intervals().tree),!e))))return!1;let n={};for(let r in e){let i={};i[t.codeForExpression]=e[r];let a=t.inverseMaps[r];if(a!==void 0){let s=r;a.mathChildInd!==void 0&&(s=a.mathChildInd),n[s]=a.result.substitute(i),n[s]=er({value:n[s],simplify:t.simplify,expand:t.expand,createvectors:t.createvectors,createintervals:t.createintervals})}}return n}function Pt({object1:l,object2:t,isUnordered:e=!1,partialMatches:n=!1,matchExactLocations:r=!1,symbolicEquality:i=!1,simplify:a="none",expand:s=!1,allowedErrorInNumbers:o=0,includeErrorInNumberExponents:u=!1,allowedErrorIsAbsolute:c=!1,nSignErrorsMatched:f=0}){let p=!1;if(l instanceof wt.default.class){if(p=!0,!(t instanceof wt.default.class))if(typeof t=="number"||typeof t=="string")t=wt.default.fromAst(t);else return{fraction_equal:0}}else if(t instanceof wt.default.class)if(p=!0,typeof l=="number"||typeof l=="string")l=wt.default.fromAst(l);else return{fraction_equal:0};let d=function(x){return x instanceof wt.default.class||(x=wt.default.fromAst(x)),x=x.normalize_function_names().normalize_applied_functions(),a==="none"?o>0&&(x=x.constants_to_floats()):a==="numberspreserveorder"?x=x.evaluate_numbers({max_digits:Infinity,skip_ordering:!0}):a==="number"?x=x.evaluate_numbers({max_digits:Infinity}):x=x.evaluate_numbers({max_digits:Infinity,evaluate_functions:!0}),er({value:x,simplify:a,expand:s})},m;if(p?i?m=function(x,N){let C=d(x),_=d(N);if(f>0){_=JSON.parse(JSON.stringify(_),wt.default.reviver);let w=function($,S){return $=d($),$.equalsViaSyntax(S,{allowed_error_in_numbers:o,include_error_in_number_exponents:u,allowed_error_is_absolute:c})};return{fraction_equal:wt.default.equalSpecifiedSignErrors(_,C,{equalityFunction:w,n_sign_errors:f})?1:0}}else return{fraction_equal:C.equalsViaSyntax(_,{allowed_error_in_numbers:o,include_error_in_number_exponents:u,allowed_error_is_absolute:c})?1:0}}:m=function(x,N){let C=x,_=N;x instanceof wt.default.class||(C=wt.default.fromAst(x)),N instanceof wt.default.class||(_=wt.default.fromAst(N));let w=Array.isArray(x)&&x[0]==="discrete_infinite_set",A=Array.isArray(N)&&N[0]==="discrete_infinite_set";if(w||A){let $=C,S=_;w||($=_,S=C);let D=$.equalsDiscreteInfinite(S,{match_partial:n});return D===!0?{fraction_equal:1}:D===!1?{fraction_equal:0}:{fraction_equal:D}}if(f>0){_=JSON.parse(JSON.stringify(_),wt.default.reviver);let $=function(D,V){return D.equals(V,{allowed_error_in_numbers:o,include_error_in_number_exponents:u,allowed_error_is_absolute:c})};return{fraction_equal:wt.default.equalSpecifiedSignErrors(_,C,{equalityFunction:$,n_sign_errors:f})?1:0}}else return{fraction_equal:C.equals(_,{allowed_error_in_numbers:o,include_error_in_number_exponents:u,allowed_error_is_absolute:c})?1:0}}:m=(x,N)=>({fraction_equal:sn(x,N)?1:0}),p){let x=l.tree[0],N=t.tree[0];if(x==="vector"){if(l=l.tree.slice(1),N==="list"||N==="interval"||N==="matrix"||N==="array"||N==="set")return{fraction_equal:0};N==="tuple"||N==="vector"?t=t.tree.slice(1):t=[t.tree]}else if(N==="vector"){if(t=t.tree.slice(1),x==="list"||x==="interval"||x==="matrix"||x==="array"||x==="set")return{fraction_equal:0};x==="tuple"?l=l.tree.slice(1):l=[l.tree]}else if(x==="interval"){r=!0;let C=l.tree[2],_=C[1],w=C[2];if(l=l.tree[1].slice(1),N==="list"||N==="matrix"||N==="set")return{fraction_equal:0};if(N==="tuple"){let A=t.tree.slice(1);if(A.length===2&&_===!1&&w===!1)t=A;else return{fraction_equal:0}}else if(N==="array"){let A=t.tree.slice(1);if(A.length===2&&_===!0&&w===!0)t=A;else return{fraction_equal:0}}else if(N==="interval"){let A=t.tree[2];if(A[1]!==_||A[2]!==w)return{fraction_equal:0};t=t.tree[1].slice(1)}else return{fraction_equal:0}}else if(N==="interval"){r=!0;let C=t.tree[2],_=C[1],w=C[2];if(t=t.tree[1].slice(1),x==="list"||x==="matrix"||x==="set")return{fraction_equal:0};if(x==="tuple"){let A=l.tree.slice(1);if(A.length===2&&_===!1&&w===!1)l=A;else return{fraction_equal:0}}else if(x==="array"){let A=l.tree.slice(1);if(A.length===2&&_===!0&&w===!0)l=A;else return{fraction_equal:0}}else return{fraction_equal:0}}else if(x==="matrix")if(N==="matrix")l=l.tree.slice(1),t=t.tree.slice(1);else return{fraction_equal:0};else{if(N==="matrix")return{fraction_equal:0};if(x==="set"){let C=[];for(let _ of l.tree.slice(1))C.some(w=>m(w,_).fraction_equal===1)||C.push(_);if(l=C,e=!0,N==="tuple"||N==="array"||N==="list")return{fraction_equal:0};if(N==="set"){C=[];for(let _ of t.tree.slice(1))C.some(w=>m(w,_).fraction_equal===1)||C.push(_);t=C}else t=[t.tree]}else if(N==="set"){let C=[];for(let _ of t.tree.slice(1))C.some(w=>m(w,_).fraction_equal===1)||C.push(_);if(t=C,e=!0,x==="tuple"||x==="array"||x==="list")return{fraction_equal:0};l=[l.tree]}else if(x==="list"){if(l=l.tree.slice(1),N==="tuple"||N==="array")return{fraction_equal:0};N==="list"?t=t.tree.slice(1):t=[t.tree]}else if(N==="list"){if(t=t.tree.slice(1),x==="tuple"||x==="array")return{fraction_equal:0};l=[l.tree]}else if(x==="tuple"){if(l=l.tree.slice(1),N==="array")return{fraction_equal:0};N==="tuple"?t=t.tree.slice(1):t=[t.tree]}else if(N==="tuple"){if(t=t.tree.slice(1),x==="array")return{fraction_equal:0};l=[l.tree]}else if(x==="array")l=l.tree.slice(1),N==="array"?t=t.tree.slice(1):t=[t.tree];else if(N==="array")t=t.tree.slice(1),l=[l.tree];else return m(l.tree,t.tree)}}else if(Array.isArray(l))Array.isArray(t)||(t=[t]);else if(Array.isArray(t))l=[l];else return m(l,t);let v=l.length,h=t.length,y={fraction_equal:0};if(r&&(e=!1),!e){let x=0,N=Math.min(v,h);for(let w=0;w<N;w++)x+=m(l[w],t[w]).fraction_equal;if(v===h&&v===x)return y.fraction_equal=1,y;if(!n)return y;if(r)return y.fraction_equal=x/Math.max(v,h),y;let C=Array.from(Array(v+1),w=>Array(h+1).fill(0));for(let w=0;w<v;w++)for(let A=0;A<h;A++){let $=m(l[w],t[A]);C[w+1][A+1]=Math.max(C[w][A]+$.fraction_equal,C[w+1][A],C[w][A+1])}let _=C[v][h];return y.fraction_equal=_/Math.max(v,h),y}let g=new Set,b=0;for(let x of l){let N=-1,C=0;for(let[_,w]of t.entries()){if(g.has(_))continue;let A=m(x,w);A.fraction_equal>C&&(C=A.fraction_equal,N=_)}N!==-1&&(b+=C,g.add(N))}return v===h&&v===b&&(y.fraction_equal=1),n&&(y.fraction_equal=b/Math.max(v,h)),y}var on=De(Ee());function Fr({logicTree:l,unorderedCompare:t=!1,simplifyOnCompare:e=!1,expandOnCompare:n=!1,dependencyValues:r}){let i=d=>Fr({logicTree:d,unorderedCompare:t,simplifyOnCompare:e,expandOnCompare:n,dependencyValues:r});if(!Array.isArray(l)){if(typeof l=="string"){let d=r.booleanChildrenByCode[l];if(d)return d.stateValues.value?1:0;{let m=r.mathChildrenByCode[l];if(m){let v=m.stateValues.value.simplify().evaluate_to_constant();return Number.isFinite(v)&&v!==0?1:0}else{if(l.toLowerCase()==="true")return 1;if(l.toLowerCase()==="false")return 0}}}else if(typeof l=="number")return l===0?0:1;return console.warn("Invalid format for boolean condition"),0}let a=l[0],s=l.slice(1);if(a==="not")return s.length!==1?(console.warn("Invalid format for boolean condition"),0):i(s[0])===0?1:0;if(a==="and")return r.matchPartial?s.reduce((d,m)=>d+i(m),0)/s.length:s.every(d=>i(d)===1)?1:0;if(a==="or")return r.matchPartial?s.reduce((d,m)=>Math.max(i(m),d),0):s.some(d=>i(d)===1)?1:0;let o=!1,u=!1,c=!1;s.forEach(function(d){typeof d=="string"&&(d in r.mathChildrenByCode||d in r.mathlistChildrenByCode?o=!0:d in r.textChildrenByCode||d in r.textlistChildrenByCode?u=!0:(d in r.booleanChildrenByCode||d in r.booleanlistChildrenByCode)&&(c=!0))}.bind(this));let f=function(d){if(typeof d=="string"){let m=r.mathChildrenByCode[d];return m!==void 0?m.stateValues.value.tree:(m=r.mathlistChildrenByCode[d],m!==void 0?["list",...m.stateValues.maths.map(v=>v.tree)]:d)}return Array.isArray(d)?[d[0],...d.slice(1).map(f)]:d}.bind(this);if(!["=","ne","<",">","le","ge","lts","gts","in","notin"].includes(a)){if(u||c)return console.warn("Invalid format for boolean condition"),0;let m=on.default.fromAst(f(l)).simplify().evaluate_to_constant();return Number.isFinite(m)&&m!==0?1:0}if(c){if(o||u)return console.warn("Invalid format for boolean condition"),0;let d=!1;if(s=s.map(function(m){if(typeof m=="string"){let v=r.booleanChildrenByCode[m];return v!==void 0?v.stateValues.value:(v=r.booleanlistChildrenByCode[m],v!==void 0?v.stateValues.booleans:(m=m.toLowerCase().trim(),m==="true"||m==="t"?!0:m==="false"||m==="f"?!1:(console.warn("Invalid format for boolean condition"),d=!0,0)))}return console.warn("Invalid format for boolean condition"),d=!0,0}.bind(this)),d)return 0;if(a==="="){let m=s[0];if(r.matchPartial){let v=s.slice(1).map(y=>Pt({object1:m,object2:y,isUnordered:t,partialMatches:r.matchPartial}));return v.reduce((y,g)=>y+g.fraction_equal,0)/v.length}else return s.slice(1).every(v=>Pt({object1:m,object2:v,isUnordered:t,partialMatches:r.matchPartial}).fraction_equal===1)?1:0}else return a==="ne"?s.length!==2?(console.warn("Invalid format for boolean condition"),0):Pt({object1:s[0],object2:s[1],isUnordered:t,partialMatches:r.matchPartial}).fraction_equal===0?1:0:(console.warn("Invalid format for boolean condition"),0)}else if(u){if(o)return console.warn("Invalid format for boolean condition"),0;let d=!1,m=function(v,h=!1){if(typeof v=="string"){let y=r.textChildrenByCode[v];return y!==void 0?y.stateValues.value.trim():(y=r.textlistChildrenByCode[v],y!==void 0?y.stateValues.texts.map(g=>g.trim()):v.trim())}return h&&Array.isArray(v)&&v[0]==="*"?v.slice(1).map(m).join(" "):(console.warn("Invalid format for boolean condition"),d=!0,"")}.bind(this);if(s=s.map(v=>m(v,!0)),d)return 0;if(a==="="){let v=s[0];if(r.matchPartial){let h=s.slice(1).map(g=>Pt({object1:v,object2:g,isUnordered:t,partialMatches:r.matchPartial}));return h.reduce((g,b)=>g+b.fraction_equal,0)/h.length}else return s.slice(1).every(h=>Pt({object1:v,object2:h,isUnordered:t,partialMatches:r.matchPartial}).fraction_equal===1)?1:0}else return a==="ne"?s.length!==2?(console.warn("Invalid format for boolean condition"),0):Pt({object1:s[0],object2:s[1],isUnordered:t,partialMatches:r.matchPartial}).fraction_equal===0?1:0:(console.warn("Invalid format for boolean condition"),0)}let p;if((a==="lts"||a==="gts")&&(p=s[1].slice(1),s=s[0].slice(1)),s=s.map(function(d){return on.default.fromAst(f(d))}),a==="="){let d=s[0];if(r.matchPartial){let m=s.slice(1).map(h=>Pt({object1:d,object2:h,isUnordered:t,partialMatches:r.matchPartial,symbolicEquality:r.symbolicEquality,simplify:e,expand:n,allowedErrorInNumbers:r.allowedErrorInNumbers,includeErrorInNumberExponents:r.includeErrorInNumberExponents,allowedErrorIsAbsolute:r.allowedErrorIsAbsolute,nSignErrorsMatched:r.nSignErrorsMatched}));return m.reduce((h,y)=>h+y.fraction_equal,0)/m.length}else return s.slice(1).every(m=>Pt({object1:d,object2:m,isUnordered:t,partialMatches:r.matchPartial,symbolicEquality:r.symbolicEquality,simplify:e,expand:n,allowedErrorInNumbers:r.allowedErrorInNumbers,includeErrorInNumberExponents:r.includeErrorInNumberExponents,allowedErrorIsAbsolute:r.allowedErrorIsAbsolute,nSignErrorsMatched:r.nSignErrorsMatched}).fraction_equal===1)?1:0}if(a==="ne")return Pt({object1:s[0],object2:s[1],isUnordered:t,partialMatches:r.matchPartial,symbolicEquality:r.symbolicEquality,simplify:e,expand:n,allowedErrorInNumbers:r.allowedErrorInNumbers,includeErrorInNumberExponents:r.includeErrorInNumberExponents,allowedErrorIsAbsolute:r.allowedErrorIsAbsolute,nSignErrorsMatched:r.nSignErrorsMatched}).fraction_equal===0?1:0;if(a==="in"||a==="notin"){let d=s[0],v=s[1].tree;if(!(Array.isArray(v)&&v[0]==="set"))return console.warn("Invalid format for boolean condition"),0;if(r.matchPartial){let y=v.slice(1).map(g=>Pt({object1:d,object2:on.default.fromAst(g),isUnordered:t,partialMatches:r.matchPartial,symbolicEquality:r.symbolicEquality,simplify:e,expand:n,allowedErrorInNumbers:r.allowedErrorInNumbers,includeErrorInNumberExponents:r.includeErrorInNumberExponents,allowedErrorIsAbsolute:r.allowedErrorIsAbsolute,nSignErrorsMatched:r.nSignErrorsMatched})).reduce((g,b)=>Math.max(g,b.fraction_equal),0);return a==="in"?y:1-y}else{let h=v.slice(1).some(y=>Pt({object1:d,object2:on.default.fromAst(y),isUnordered:t,partialMatches:r.matchPartial,symbolicEquality:r.symbolicEquality,simplify:e,expand:n,allowedErrorInNumbers:r.allowedErrorInNumbers,includeErrorInNumberExponents:r.includeErrorInNumberExponents,allowedErrorIsAbsolute:r.allowedErrorIsAbsolute,nSignErrorsMatched:r.nSignErrorsMatched}).fraction_equal===1);return a==="in"?h?1:0:h?0:1}}if(s=s.map(d=>d.simplify().evaluate_to_constant()),s.some(d=>d===null||Number.isNaN(d)))return 0;if(a==="<")return s[0]<s[1]?1:0;if(a===">")return s[0]>s[1]?1:0;if(a==="le")return s[0]<=s[1]?1:0;if(a==="ge")return s[0]>=s[1]?1:0;for(let d=0;d<p.length;d++)if(a==="lts"){if(p[d]===!0){if(!(s[d]<s[d+1]))return 0}else if(!(s[d]<=s[d+1]))return 0}else if(p[d]===!0){if(!(s[d]>s[d+1]))return 0}else if(!(s[d]>=s[d+1]))return 0;return 1}function Si({logicTree:l,nonMathCodes:t,foundNonMath:e=!1,init:n=!0}){if(!Array.isArray(l))return typeof l=="string"&&!e&&!n?on.default.fromText(l).tree:l;let r=l[0],i=l.slice(1);return["and","not","or"].includes(r)?[r,...i.map(a=>Si({logicTree:a,nonMathCodes:t,foundNonMath:e,init:n}))]:(i.some(a=>t.includes(a))&&(e=!0),[r,...i.map(a=>Si({logicTree:a,nonMathCodes:t,foundNonMath:e,init:!1}))])}var e1=new Di.default.converters.textToAstObj({splitSymbols:!1}),Ka=class extends Me{static componentType="boolean";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["value"]}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroStrings",componentType:"string",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroMaths",componentType:"math",comparison:"atLeast",number:0}),i=e.newLeaf({name:"atLeastZeroMathLists",componentType:"mathlist",comparison:"atLeast",number:0}),a=e.newLeaf({name:"atLeastZeroTexts",componentType:"text",comparison:"atLeast",number:0}),s=e.newLeaf({name:"atLeastZeroTextlists",componentType:"textlist",comparison:"atLeast",number:0}),o=e.newLeaf({name:"atLeastZeroBooleans",componentType:"boolean",comparison:"atLeast",number:0}),u=e.newLeaf({name:"atLeastZeroBooleanlists",componentType:"booleanlist",comparison:"atLeast",number:0});return e.newOperator({name:"stringsMathsTextsAndBooleans",operator:"and",propositions:[n,r,i,a,s,o,u],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.parsedExpression={additionalStateVariablesDefined:["codePre"],returnDependencies:()=>({stringMathTextBooleanChildren:{dependencyType:"child",childLogicName:"stringsMathsTextsAndBooleans"},stringChildren:{dependencyType:"child",childLogicName:"atLeastZeroStrings",variableNames:["value"]}}),definition:t1},t.mathChildrenByCode={additionalStateVariablesDefined:["mathlistChildrenByCode","textChildrenByCode","textlistChildrenByCode","booleanChildrenByCode","booleanlistChildrenByCode"],returnDependencies:()=>({stringMathTextBooleanChildren:{dependencyType:"child",childLogicName:"stringsMathsTextsAndBooleans",variableNames:["value","texts","maths","booleans"],variablesOptional:!0},codePre:{dependencyType:"stateVariable",variableName:"codePre"}}),definition({dependencyValues:e,componentInfoObjects:n}){let r={},i={},a={},s={},o={},u={},c=0,f=e.codePre;for(let p of e.stringMathTextBooleanChildren)if(p.componentType!=="string"){let d=f+c;n.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"math"})?r[d]=p:n.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"mathlist"})?i[d]=p:n.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"text"})?a[d]=p:n.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"textlist"})?s[d]=p:n.isInheritedComponentType({inheritedComponentType:p.componentType,baseComponentType:"boolean"})?o[d]=p:u[d]=p,c+=1}return{newValues:{mathChildrenByCode:r,mathlistChildrenByCode:i,textChildrenByCode:a,textlistChildrenByCode:s,booleanChildrenByCode:o,booleanlistChildrenByCode:u}}}},t.value={public:!0,componentType:this.componentType,forRenderer:!0,defaultValue:!1,set:Boolean,returnDependencies:()=>({parsedExpression:{dependencyType:"stateVariable",variableName:"parsedExpression"},stringMathTextBooleanChildren:{dependencyType:"child",childLogicName:"stringsMathsTextsAndBooleans",variableNames:["value","texts","maths","unordered"],variablesOptional:!0},mathChildren:{dependencyType:"child",childLogicName:"atLeastZeroMaths",variableNames:["value","expand","simplify"]},booleanChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanChildrenByCode"},booleanlistChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanlistChildrenByCode"},textChildrenByCode:{dependencyType:"stateVariable",variableName:"textChildrenByCode"},textlistChildrenByCode:{dependencyType:"stateVariable",variableName:"textlistChildrenByCode"},mathChildrenByCode:{dependencyType:"stateVariable",variableName:"mathChildrenByCode"},mathlistChildrenByCode:{dependencyType:"stateVariable",variableName:"mathlistChildrenByCode"}}),definition({dependencyValues:e}){if(e.stringMathTextBooleanChildren.length===0)return{useEssentialOrDefaultValue:{value:{variablesToCheck:["value","implicitValue"]}}};if(e.parsedExpression===null)return{newValues:{value:!1}};let n=!1;for(let i of e.stringMathTextBooleanChildren)i.stateValues.unordered&&(n=!0);return{newValues:{value:Fr({logicTree:e.parsedExpression.tree,unorderedCompare:n,dependencyValues:e})===1}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n,componentInfoObjects:r}){if(n.stringMathTextBooleanChildren.length===0)return{success:!0,instructions:[{setStateVariable:"value",value:Boolean(e.value)}]};if(n.stringMathTextBooleanChildren.length===1){let i=n.stringMathTextBooleanChildren[0];if(i.componentType==="string")return{success:!0,instructions:[{setDependency:"stringMathTextBooleanChildren",desiredValue:e.value,childIndex:0,variableIndex:0}]};if(r.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"boolean"}))return{success:!0,instructions:[{setDependency:"stringMathTextBooleanChildren",desiredValue:e.value,childIndex:0,variableIndex:0}]}}return{success:!1}}},t.text={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{newValues:{text:e.value?"true":"false"}}}},t}},Se=Ka;function t1({dependencyValues:l,componentInfoObjects:t}){let e="comp",n=!0;for(;n;){n=!1;for(let u of l.stringChildren)if(u.stateValues.value.includes(e)){n=!0,e+="p";break}}let r="",i=0,a=[],s=0;for(let u of l.stringMathTextBooleanChildren)if(u.componentType==="string")r+=" "+l.stringChildren[s].stateValues.value+" ",s++;else{let c=e+i;r+=" "+c+" ",t.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"math"})||t.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"mathlist"})||a.push(c),i+=1}let o=null;try{o=Di.default.fromAst(e1.convert(r))}catch(u){}return o&&(o=Di.default.fromAst(Si({logicTree:o.tree,nonMathCodes:a}))),{newValues:{codePre:e,parsedExpression:o}}}var Br=De(Ee()),Wa=class extends Me{static componentType="number";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["value"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.displayDigits={default:10},e.displaySmallAsZero={default:!1},e.renderAsMath={default:!1,forRenderer:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions();return t.push({childrenRegex:/..+/,replacementFunction:({matchedChildren:e})=>({success:!0,newChildren:[{componentType:"math",children:e}]})}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneString",componentType:"string",comparison:"atMost",number:1}),r=e.newLeaf({name:"exactlyOneNumber",componentType:"number",number:1});return e.newOperator({name:"stringXorNumberXorSugar",operator:"xor",propositions:[r,n],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:this.componentType,returnDependencies:()=>({numberChild:{dependencyType:"child",childLogicName:"exactlyOneNumber",variableNames:["value","canBeModified"],requireChildLogicInitiallySatisfied:!0},stringChild:{dependencyType:"child",childLogicName:"atMostOneString",variableNames:["value"],requireChildLogicInitiallySatisfied:!0}}),defaultValue:NaN,definition:function({dependencyValues:e}){if(e.numberChild.length===0){if(e.stringChild.length===0)return{useEssentialOrDefaultValue:{value:{variablesToCheck:["value"]}}};let n=Number(e.stringChild[0].stateValues.value);if(Number.isNaN(n))try{n=Br.default.fromText(e.stringChild[0].stateValues.value).evaluate_to_constant(),n===null&&(n=NaN)}catch(r){n=NaN}return{newValues:{value:n}}}else return{newValues:{value:e.numberChild[0].stateValues.value}}},set:function(e){let n=Number(e);if(Number.isNaN(n))try{n=Br.default.fromText(e).evaluate_to_constant(),n===null&&(n=NaN)}catch(r){n=NaN}return n},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n,stateValues:r,overrideFixed:i}){if(!r.canBeModified&&!i)return{success:!1};let a=e.value;a instanceof Br.default.class?(a=a.evaluate_to_constant(),Number.isFinite(a)||(a=NaN)):a=Number(a);let s;return n.numberChild.length===0?n.stringChild.length===0?s=[{setStateVariable:"value",value:a}]:s=[{setDependency:"stringChild",desiredValue:a.toString(),childIndex:0,variableIndex:0}]:s=[{setDependency:"numberChild",desiredValue:a,childIndex:0,variableIndex:0}],{success:!0,instructions:s}}},t.valueForDisplay={forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"},displayDigits:{dependencyType:"stateVariable",variableName:"displayDigits"},displaySmallAsZero:{dependencyType:"stateVariable",variableName:"displaySmallAsZero"}}),definition:function({dependencyValues:e}){let n=Br.default.round_numbers_to_precision(e.value,e.displayDigits).tree;return e.displaySmallAsZero&&Math.abs(n)<1e-14&&(n=0),{newValues:{valueForDisplay:n}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({valueForDisplay:{dependencyType:"stateVariable",variableName:"valueForDisplay"}}),definition:function({dependencyValues:e}){return{newValues:{text:e.valueForDisplay.toString()}}}},t.math={public:!0,componentType:"math",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return Number.isNaN(e.value)?{newValues:{math:Br.default.fromAst("\uFF3F")}}:{newValues:{math:Br.default.fromAst(e.value)}}},inverseDefinition:function({desiredStateVariableValues:e}){let n=e.math.evaluate_to_constant();return n===null&&(n=NaN),{success:!0,instructions:[{setDependency:"value",desiredValue:n}]}}},t.canBeModified={returnDependencies:()=>({numberChildModifiable:{dependencyType:"child",childLogicName:"exactlyOneNumber",variableNames:["canBeModified"],requireChildLogicInitiallySatisfied:!0},modifyIndirectly:{dependencyType:"stateVariable",variableName:"modifyIndirectly"},fixed:{dependencyType:"stateVariable",variableName:"fixed"}}),definition:function({dependencyValues:e}){return!e.modifyIndirectly||e.fixed?{newValues:{canBeModified:!1}}:e.numberChildModifiable.length===1&&!e.numberChildModifiable[0].stateValues.canBeModified?{newValues:{canBeModified:!1}}:{newValues:{canBeModified:!0}}}},t}returnSerializeInstructions(){let t=this.childLogic.returnMatches("atMostOneString"),e=t&&t.length===1;return e?{skipChildren:e,stateVariables:["value"]}:{}}adapters=["math","text"]},Oe=Wa;var Ga=De(Ee()),Za=class extends Oe{static componentType="integer";static rendererType="number";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value.definition=function({dependencyValues:e}){if(e.numberChild.length===0){if(e.stringChild.length===0)return{useEssentialOrDefaultValue:{value:{variablesToCheck:["value"]}}};let n=Number(e.stringChild[0].stateValues.value);if(Number.isNaN(n))try{n=Ga.default.fromText(e.stringChild[0].stateValues.value).evaluate_to_constant(),n===null&&(n=NaN)}catch(r){n=NaN}return{newValues:{value:Math.round(n)}}}else return{newValues:{value:Math.round(e.numberChild[0].stateValues.value)}}},t.value.inverseDefinition=function({desiredStateVariableValues:e,dependencyValues:n,stateValues:r}){if(!r.canBeModified)return{success:!1};let i=e.value;i instanceof Ga.default.class?i=i.evaluate_to_constant():i=Number(i),i=Math.round(i);let a;return n.numberChild.length===0?n.stringChild.length===0?a=[{setStateVariable:"value",value:i}]:a=[{setDependency:"stringChild",desiredValue:i.toString(),childIndex:0,variableIndex:0}]:a=[{setDependency:"numberChild",desiredValue:i,childIndex:0,variableIndex:0}],{success:!0,instructions:a}},t}},vt=Za;var Xa=class extends Me{static componentType="text";static includeBlankStringChildren=!0;static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["value"]}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroStrings",componentType:"string",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroTexts",componentType:"text",comparison:"atLeast",number:0});return e.newOperator({name:"stringsAndTexts",operator:"and",propositions:[n,r],requireConsecutive:!0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:this.componentType,forRenderer:!0,returnDependencies:()=>({stringTextChildren:{dependencyType:"child",childLogicName:"stringsAndTexts",variableNames:["value"],requireChildLogicInitiallySatisfied:!0}}),defaultValue:"",set:String,definition:function({dependencyValues:e}){if(e.stringTextChildren.length===0)return{useEssentialOrDefaultValue:{value:{variablesToCheck:"value"}}};let n="";for(let r of e.stringTextChildren)n+=r.stateValues.value;return{newValues:{value:n}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){let r=n.stringTextChildren.length;return r>1?{success:!1}:r===1?{success:!0,instructions:[{setDependency:"stringTextChildren",desiredValue:e.value,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setStateVariable:"value",value:String(e.value)}]}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:({dependencyValues:e})=>({newValues:{text:e.value}}),inverseDefinition:({desiredStateVariableValues:e})=>({success:!0,instructions:[{setDependency:"value",desiredValue:e.text}]})},t}returnSerializeInstructions(){let t=this.childLogic.returnMatches("atLeastZeroStrings").length===1&&this.childLogic.returnMatches("atLeastZeroTexts").length===0;return t?{skipChildren:t,stateVariables:["value"]}:{}}},Pe=Xa;var Ja=class extends Pe{static componentType="_textfromsinglestringchild";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.deleteAllLogic(),e.newLeaf({name:"atMostOneString",componentType:"string",comparison:"atMost",number:1,excludeCompositeReplacements:!0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:this.componentType,returnDependencies:()=>({stringChild:{dependencyType:"child",childLogicName:"atMostOneString",variableNames:["value"]}}),defaultValue:"",definition:function({dependencyValues:e}){return e.stringChild.length===0?{useEssentialOrDefaultValue:{value:{variablesToCheck:"value"}}}:{newValues:{value:e.stringChild[0].stateValues.value}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){return n.stringChild.length===1?{success:!0,instructions:[{setDependency:"stringChild",desiredValue:e.value,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setStateVariable:"value",value:e.value}]}}},t}},Hn=Ja;var Ya={};mt(Ya,{ComponentListOfListsWithSelectableType:()=>Mi,ComponentListWithSelectableType:()=>Kn,ComponentWithSelectableType:()=>zr});var Qa=De(Ee());function Vi(l){return null}function Sr({childrenToComponentFunction:l,mustStripOffOuterParentheses:t=!1}){return function({matchedChildren:e}){let n=0,r=[],i=[],a=!1,s=e.length;if(t){let u=e[0];if(u.componentType!=="string"||u.state.value.trimLeft()[0]!=="(")return{success:!1}}for(let[u,c]of e.entries()){if(c.componentType!=="string"){i.push(c);continue}let f=c.state.value.trim();if(u===0&&t&&f[0]==="("){let d=e[s-1];if(d.componentType==="string"){let m=d.state.value.trimRight();m[m.length-1]===")"&&(a=!0,f=f.substring(1))}}let p=0;for(let d=0;d<f.length;d++){let m=f[d];if(m==="("&&n++,m===")"){if(n===0){if(a&&u===s-1&&d===f.length-1){f=f.substring(0,f.length-1);break}return{success:!1}}n--}m===","&&n===0&&(d>p&&i.push({componentType:"string",state:{value:f.substring(p,d)}}),r.push(i),i=[],p=d+1)}f.length>p&&i.push({componentType:"string",state:{value:f.substring(p,f.length)}})}if(n!==0)return{success:!1};r.push(i);let o=r.map(l);return{success:!0,newChildren:o}}}function ln({childrenList:l}){let t=0,e=[],n=[];for(let r of l){if(r.componentType!=="string"){n.push(r);continue}let i=r.state.value.trim(),a=0;for(let s=0;s<i.length;s++){let o=i[s];if(o==="("&&t++,o===")"){if(t===0)return{success:!1};t--}if(o===","&&t===0){if(s>a){let u=i.substring(a,s).trim();n.push({componentType:"string",state:{value:u}})}e.push(n),n=[],a=s+1}}if(i.length>a){let s=i.substring(a,i.length).trim();n.push({componentType:"string",state:{value:s}})}}return t!==0?{success:!1}:(e.push(n),{success:!0,pieces:e})}function tr({componentList:l,removeParens:t=!1}){let e=0,n=[],r=[];for(let i of l){if(i.componentType!=="string"){e===0?n.push([i]):r.push(i);continue}let a=i.state.value.trim(),s=0;for(let o=0;o<a.length;o++){let u=a[o];if(u==="(")e===0&&t&&(s=o+1),e++;else if(u===")"){if(e===0)return{success:!1};if(e===1){if(o+1>s){let c=t?o:o+1,f=a.substring(s,c).trim();f.length>0&&r.push({componentType:"string",state:{value:f}})}n.push(r),r=[],s=o+1}e--}else if(e===0&&!u.match(/\s/))return{success:!1}}if(a.length>s){let o=a.substring(s,a.length).trim();r.push({componentType:"string",state:{value:o}})}}return e!==0?{success:!1}:(r.length>0&&n.push(r),{success:!0,pieces:n})}function Ii(l){if(l.length===0)return{foundVector:!1};if(l[0].componentType!=="string")return{foundVector:!1};let t=l[0].state.value;if(t.trim()[0]!=="(")return{foundVector:!1};if(l[l.length-1].componentType!=="string")return{foundVector:!1};let n=l[l.length-1].state.value;if(n.trim().slice(-1)!==")")return{foundVector:!1};let i=[];if(l.length===1){let u=t.trim().slice(1,-1).trim();u.length>0&&i.push({componentType:"string",state:{value:u}})}else{let u=t.trim().slice(1).trim();u.length>0&&i.push({componentType:"string",state:{value:u}}),i.push(...l.slice(1,-1)),u=n.trim().slice(0,-1).trim(),u.length>0&&i.push({componentType:"string",state:{value:u}})}let a=0,s=[],o=[];for(let u of i){if(u.componentType!=="string"){o.push(u);continue}let c=u.state.value.trim(),f=0,p=!1;for(let d=0;d<c.length;d++){let m=c[d];if(m==="("&&a++,m===")"){if(a===0)return{foundVector:!1};a--}if(m===","&&a===0){if(d>f){let v=c.substring(f,d).trim();o.push({componentType:"string",state:{value:v}})}s.push(o),o=[],f=d+1,p=!0}}if(p){if(c.length>f){let d=c.substring(f,c.length).trim();o.push({componentType:"string",state:{value:d}})}}else o.push(u)}return a!==0?{foundVector:!1}:(s.push(o),{foundVector:!0,vectorComponents:s})}var zr=class extends _e{static componentType="_componentwithselectabletype";static rendererType=void 0;static acceptType=!0;static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["value","type"]}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneChild",componentType:"_base",excludeComponentTypes:["_composite"],comparison:"atMost",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.type={returnDependencies:()=>({type:{dependencyType:"doenetAttribute",attributeName:"type"},parentType:{dependencyType:"parentStateVariable",variableName:"type"}}),definition:function({dependencyValues:e,componentName:n}){let r=e.type;return r||(r=e.parentType),r?["number","letters","math","text","boolean"].includes(r)||(console.warn(`Invalid type ${r}, setting type to number`),r="number"):r="number",{newValues:{type:r}}}},t.value={public:!0,returnDependencies:()=>({type:{dependencyType:"stateVariable",variableName:"type"},atMostOneChild:{dependencyType:"child",childLogicName:"atMostOneChild",variableNames:["value"],requireChildLogicInitiallySatisfied:!0}}),definition({dependencyValues:e}){let n;return e.atMostOneChild.length===1?n=es(e.atMostOneChild[0].stateValues.value,e.type):n=null,{newValues:{value:n},setComponentType:{value:e.type}}}},t}},Kn=class extends zr{static componentType="_componentlistwithselectabletype";static acceptType=!0;static returnSugarInstructions(){let t=[];function e({matchedChildren:n,componentProps:r,parentProps:i}){let a=r.type;return a||(a=i.type),a?["number","letters","math","text","boolean"].includes(a)||(console.warn(`Invalid type ${a}, setting type to number`),a="number"):a="number",n=n.reduce(function(s,o){return o.componentType==="string"?[...s,...o.state.value.split(/\s+/).filter(u=>u).map(u=>({componentType:"string",state:{value:u}}))]:[...s,o]},[]),{success:!0,newChildren:n}}return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.deleteAllLogic(),e.newLeaf({name:"anythingForSelectedType",componentType:"_base",excludeComponentTypes:["_composite"],comparison:"atLeast",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return delete t.value,t.nValues={additionalStateVariablesDefined:["childForValue"],returnDependencies:()=>({anythingForSelectedType:{dependencyType:"child",childLogicName:"anythingForSelectedType",variableNames:["nValues"],variablesOptional:!0}}),definition({dependencyValues:e}){let n=0,r=[];for(let[i,a]of e.anythingForSelectedType.entries()){let s=Number.isInteger(a.stateValues.nValues)?a.stateValues.nValues:1;n+=s;for(let o=0;o<s;o++)r.push({child:i,valueIndex:o})}return{newValues:{nValues:n,childForValue:r}}}},t.values={public:!0,isArray:!0,entryPrefixes:["value"],stateVariablesDeterminingDependencies:["childForValue"],returnArraySizeDependencies:()=>({nValues:{dependencyType:"stateVariable",variableName:"nValues"}}),returnArraySize({dependencyValues:e}){return[e.nValues]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={type:{dependencyType:"stateVariable",variableName:"type"}},i={};for(let a of e){let s=n.childForValue[a];i[a]={anythingForSelectedType:{dependencyType:"child",childLogicName:"anythingForSelectedType",variableNames:["value","values"],childIndices:[s.child],variablesOptional:!0},valueIndex:{dependencyType:"value",value:s.valueIndex}}}return{globalDependencies:r,dependenciesByKey:i}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r,componentName:i}){let a={};for(let s of r)if(n[s].anythingForSelectedType&&n[s].anythingForSelectedType.length===1){let o=n[s].anythingForSelectedType[0],u;o.stateValues.values?u=o.stateValues.values[n[s].valueIndex]:u=o.stateValues.value,a[s]=es(u,e.type)}return{newValues:{values:a},setComponentType:{values:e.type}}}},t}},Mi=class extends zr{static componentType="_componentlistoflistswithselectabletype";static componentTypeSingular="_componentlistwithselectabletype";static acceptType=!0;static returnSugarInstructions(){let t=[],e=this,n=function({matchedChildren:r,componentProps:i,parentProps:a}){let s=tr({componentList:r,removeParens:!0});if(s.success!==!0)return{success:!1};let o=i.type;return o||(o=a.type),o?["number","letters","math","text","boolean"].includes(o)||(console.warn(`Invalid type ${o}, setting type to number`),o="number"):o="number",{success:!0,newChildren:s.pieces.map(u=>({componentType:e.componentTypeSingular,props:{type:o},children:u}))}};return t.push({replacementFunction:n}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.deleteAllLogic(),e.newLeaf({name:"atLeastZeroLists",componentType:this.componentTypeSingular,comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return delete t.value,t.nLists={returnDependencies:()=>({listChildren:{dependencyType:"child",childLogicName:"atLeastZeroLists"}}),definition({dependencyValues:e}){return{newValues:{nLists:e.listChildren.length}}}},t.lists={isArray:!0,entryPrefixes:["list"],returnArraySizeDependencies:()=>({nLists:{dependencyType:"stateVariable",variableName:"nLists"}}),returnArraySize({dependencyValues:e}){return[e.nLists]},returnArrayDependenciesByKey({arrayKeys:e}){let n={type:{dependencyType:"stateVariable",variableName:"type"}},r={};for(let i of e)r[i]={listChildren:{dependencyType:"child",childLogicName:"atLeastZeroLists",variableNames:["values","type"],childIndices:[i]}};return{globalDependencies:n,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r)if(n[a].listChildren&&n[a].listChildren.length===1){let s=n[a].listChildren[0];s.stateValues.type===e.type?i[a]=s.stateValues.values:i[a]=s.stateValues.values.map(o=>es(o,e.type))}return{newValues:{lists:i}}}},t}};function es(l,t){if(Array.isArray(l)&&(l=l[0]),t==="number"){if(l instanceof Qa.default.class){let e=l.evaluate_to_constant();return Number.isFinite(e)||(e=NaN),e}return Number(l)}else if(t==="math"){if(typeof l=="string")try{return Qa.default.fromText(l)}catch(e){}return nt(l)}else return t==="boolean"?Boolean(l):String(l)}var ts=class extends _e{static componentType="_componentwithanychildren";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0,setAsBase:!0}),e}},Uu=ts;var rs=class extends _e{static componentType="_pointlistcomponent";static rendererType="container";static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=tr({componentList:n});return r.success!==!0?{success:!1}:{success:!0,newChildren:r.pieces.map(function(i){return i.length>1||i[0].componentType==="string"?{componentType:"point",children:i}:i[0]})}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroPoints",componentType:"point",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nPoints={returnDependencies:()=>({pointChildren:{dependencyType:"child",childLogicName:"atLeastZeroPoints"}}),definition:function({dependencyValues:e}){return{newValues:{nPoints:e.pointChildren.length},checkForActualChange:{nPoints:!0}}}},t.nDimensions={returnDependencies:()=>({pointChildren:{dependencyType:"child",childLogicName:"atLeastZeroPoints",variableNames:["nDimensions"]}}),definition:function({dependencyValues:e}){let n;if(e.pointChildren.length===0)n=2;else{n=1;for(let r of e.pointChildren)Number.isFinite(r.stateValues.nDimensions)&&(n=Math.max(n,r.stateValues.nDimensions))}return{newValues:{nDimensions:n},checkForActualChange:{nDimensions:!0}}}},t.points={isArray:!0,nDimensions:2,entryPrefixes:["pointX","point"],returnWrappingComponents(e){return e==="pointX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="pointX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}},returnArraySizeDependencies:()=>({nPoints:{dependencyType:"stateVariable",variableName:"nPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nPoints,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let[i,a]=r.split(",");n[r]={pointChild:{dependencyType:"child",childLogicName:"atLeastZeroPoints",variableNames:["x"+(Number(a)+1)],childIndices:[i]}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=i.split(",")[1],s=e[i].pointChild[0];s&&(r[i]=s.stateValues["x"+(Number(a)+1)])}return{newValues:{points:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:n}){let r=[];for(let i in e.points)r.push({setDependency:n[i].pointChild,desiredValue:e.points[i],childIndex:0,variableIndex:0});return{success:!0,instructions:r}}},t.childrenToRender={returnDependencies:()=>({pointChildren:{dependencyType:"child",childLogicName:"atLeastZeroPoints"}}),definition:({dependencyValues:e})=>({newValues:{childrenToRender:e.pointChildren.map(n=>n.componentName)}})},t}},un=rs;var ns=class extends _e{static componentType="_vectorlistcomponent";static rendererType="container";static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=tr({componentList:n});return r.success!==!0?{success:!1}:{success:!0,newChildren:r.pieces.map(function(i){return i.length>1||i[0].componentType==="string"?{componentType:"vector",children:i}:i[0]})}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroVectors",componentType:"vector",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nVectors={returnDependencies:()=>({vectorChildren:{dependencyType:"child",childLogicName:"atLeastZeroVectors"}}),definition:({dependencyValues:e})=>({newValues:{nVectors:e.vectorChildren.length},checkForActualChange:{nVectors:!0}})},t.nDimensions={returnDependencies:()=>({vectorChildren:{dependencyType:"child",childLogicName:"atLeastZeroVectors",variableNames:["nDimensions"]}}),definition:function({dependencyValues:e}){let n;if(e.vectorChildren.length===0)n=2;else{n=1;for(let r of e.vectorChildren)Number.isFinite(r.stateValues.nDimensions)&&(n=Math.max(n,r.stateValues.nDimensions))}return{newValues:{nDimensions:n},checkForActualChange:{nDimensions:!0}}}},t.vectors={isArray:!0,nDimensions:2,entryPrefixes:["vectorX","vector"],returnWrappingComponents(e){return e==="vectorX"?[]:[["vector",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="vectorX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}},returnArraySizeDependencies:()=>({nVectors:{dependencyType:"stateVariable",variableName:"nVectors"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nVectors,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let[i,a]=r.split(",");n[r]={vectorChild:{dependencyType:"child",childLogicName:"atLeastZeroVectors",variableNames:["x"+(Number(a)+1)],childIndices:[i]}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=i.split(",")[1],s=e[i].vectorChild[0];s&&(r[i]=s.stateValues["x"+(Number(a)+1)])}return{newValues:{vectors:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:n}){let r=[];for(let i in e.vectors)r.push({setDependency:n[i].vectorChild,desiredValue:e.vectors[i],childIndex:0,variableIndex:0});return{success:!0,instructions:r}}},t.childrenToRender={returnDependencies:()=>({vectorChildren:{dependencyType:"child",childLogicName:"atLeastZeroVectors"}}),definition:({dependencyValues:e})=>({newValues:{childrenToRender:e.vectorChildren.map(n=>n.componentName)}})},t}},Oi=ns;var is=class extends _e{static componentType="_linelistcomponent";static rendererType="container";static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=n.reduce(function(i,a){return a.componentType==="string"?[...i,...a.state.value.split(/\s+/).filter(s=>s).map(s=>({componentType:"line",children:[{componentType:"string",state:{value:s}}]}))]:[...i,a]},[]);return{success:!0,newChildren:r}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroLines",componentType:"line",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nLines={returnDependencies:()=>({lineChildren:{dependencyType:"child",childLogicName:"atLeastZeroLines"}}),definition:function({dependencyValues:e}){return{newValues:{nLines:e.lineChildren.length},checkForActualChange:{nLines:!0}}}},t.lineNames={isArray:!0,entryPrefixes:["lineName"],returnArraySizeDependencies:()=>({nLines:{dependencyType:"stateVariable",variableName:"nLines"}}),returnArraySize({dependencyValues:e}){return[e.nLines]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n[r]={lineChild:{dependencyType:"child",childLogicName:"atLeastZeroLines",childIndices:[r]}};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=e[i].lineChild[0];a&&(r[i]=a.componentName)}return{newValues:{lineNames:r}}}},t.childrenToRender={returnDependencies:()=>({lineChildren:{dependencyType:"child",childLogicName:"atLeastZeroLines"}}),definition:({dependencyValues:e})=>({newValues:{childrenToRender:e.lineChildren.map(n=>n.componentName)}})},t}},Hu=is;var as=class extends _e{static componentType="_anglelistcomponent";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.hide={default:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"AtLeastZeroAngles",componentType:"angle",comparison:"atLeast",number:0}),r=Vi(o=>({componentType:"angle",children:[{componentType:"math",children:o}]})),i=e.newLeaf({name:"AtLeastOneString",componentType:"string",comparison:"atLeast",number:1}),a=e.newLeaf({name:"AtLeastOneMath",componentType:"math",comparison:"atLeast",number:1}),s=e.newOperator({name:"StringsAndMaths",operator:"or",propositions:[i,a],requireConsecutive:!0,isSugar:!0,replacementFunction:r});return e.newOperator({name:"AnglesXorSugar",operator:"xor",propositions:[n,s],setAsBase:!0}),e}updateState(t={}){if(t.init&&(this._state.angles={trackChanges:!0}),super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.angles=!0,this.unresolvedState.nAngles=!0;return}if(this.currentTracker.trackChanges.childrenChanged(this.componentName)){delete this.unresolvedState.angles,delete this.unresolvedState.nAngles;let r=this.childLogic.returnMatches("AtLeastZeroAngles");this.state.nAngles=r.length,this.state.angles=r.map(i=>this.activeChildren[i])}}initializeRenderer(){this.renderer===void 0&&(this.renderer=new this.availableRenderers.container({key:this.componentName}))}updateChildrenWhoRender(){this.childrenWhoRender=this.state.angles.map(t=>t.componentName)}},Ei=as;function cn(){return[{styleNumber:1,lineColor:"blue",lineWidth:4,lineStyle:"solid",markerColor:"blue",markerStyle:"circle",markerSize:3},{styleNumber:2,lineColor:"green",lineWidth:2,lineStyle:"solid",markerColor:"green",markerStyle:"square",markerSize:4},{styleNumber:3,lineColor:"red",lineWidth:3,lineStyle:"solid",markerColor:"red",markerStyle:"triangle",markerSize:5},{styleNumber:4,lineColor:"purple",lineWidth:2,lineStyle:"solid",markerColor:"purple",markerStyle:"diamond",markerSize:4},{styleNumber:5,lineColor:"black",lineWidth:1,lineStyle:"solid",markerColor:"black",markerStyle:"circle",markerSize:2},{styleNumber:6,lineColor:"lightgray",lineWidth:1,lineStyle:"dotted",markerColor:"lightgray",markerStyle:"circle",markerSize:2}]}var ss=class extends _e{static componentType="_graphical";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.label={default:"",forRenderer:!0},e.showLabel={default:!0,forRenderer:!0},e.layer={default:0,forRenderer:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.selectedStyle={forRenderer:!0,willNeverBeEssential:!0,returnDependencies:()=>({styleNumber:{dependencyType:"stateVariable",variableName:"styleNumber"},ancestorWithStyle:{dependencyType:"ancestor",variableNames:["styleDefinitions"]}}),definition:function({dependencyValues:e}){let n=e.ancestorWithStyle.stateValues.styleDefinitions;n||(n=cn());let r;for(let i of n)e.styleNumber===i.styleNumber&&(r===void 0?r=i:r=Object.assign(Object.assign({},i),r));return r===void 0&&(r=n[0]),{newValues:{selectedStyle:r}}}},t}},lt=ss;var pr=De(Ee());var os=class extends lt{static componentType="point";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["xs","nDimensions"]}static primaryStateVariableForDefinition="coordsShadow";static stateVariableForPropertyValue="coords";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.draggable={default:!0,forRenderer:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let a=Sr({childrenToComponentFunction:s=>({componentType:"x",children:s}),mustStripOffOuterParentheses:!0})({matchedChildren:n});return!a.success&&n.length===1?{success:!0,newChildren:[{componentType:"x",doenetAttributes:{isPropertyChild:!0},children:n}]}:(a.success&&(a.newChildren=[{componentType:"xs",doenetAttributes:{isPropertyChild:!0},children:a.newChildren}]),a)};return t.push({childrenRegex:/s+(.*s)?/,replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneX",componentType:"x",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"exactlyOneY",componentType:"y",number:1,takePropertyChildren:!0}),i=e.newLeaf({name:"exactlyOneZ",componentType:"z",number:1,takePropertyChildren:!0}),a=e.newLeaf({name:"exactlyOneXs",componentType:"xs",number:1,takePropertyChildren:!0}),s=e.newOperator({name:"coordinatesViaComponents",operator:"or",propositions:[n,r,i]}),o=e.newLeaf({name:"exactlyOneCoords",componentType:"coords",number:1,takePropertyChildren:!0}),u=e.newLeaf({name:"exactlyOnePoint",componentType:"point",number:1}),c=e.newLeaf({name:"noCoords",componentType:"coords",number:0,allowSpillover:!1}),f=e.newOperator({name:"coordsCombinations",operator:"xor",propositions:[s,a,u,o,c]}),p=e.newLeaf({name:"atMostOneConstraints",componentType:"constraints",comparison:"atMost",number:1});return e.newOperator({name:"pointWithConstraints",operator:"and",propositions:[f,p],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){return{newValues:{styleDescription:e.selectedStyle.markerColor}}}},t.styleDescriptionWithNoun={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let n=e.selectedStyle.markerColor;return e.selectedStyle.markerStyle==="circle"?n+=" point":n+=` ${e.selectedStyle.markerStyle}`,{newValues:{styleDescriptionWithNoun:n}}}},t.coordsShadow={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{coordsShadow:{variablesToCheck:["coords","coordsShadow"]}}}),inverseDefinition:function({desiredStateVariableValues:e,stateValues:n,workspace:r}){let i=Bu({desiredVector:e.coordsShadow,currentVector:n.coordsShadow,workspace:r,workspaceKey:"desiredCoords"});return{success:!0,instructions:[{setStateVariable:"coordsShadow",value:i}]}}},t.nDimensions={public:!0,componentType:"number",returnDependencies:()=>({coordsShadow:{dependencyType:"stateVariable",variableName:"coordsShadow"},coordsChild:{dependencyType:"child",childLogicName:"exactlyOneCoords",variableNames:["value"]},xChild:{dependencyType:"child",childLogicName:"exactlyOneX"},yChild:{dependencyType:"child",childLogicName:"exactlyOneY"},zChild:{dependencyType:"child",childLogicName:"exactlyOneZ"},xsChild:{dependencyType:"child",childLogicName:"exactlyOneXs",variableNames:["nComponents"]},pointChild:{dependencyType:"child",childLogicName:"exactlyOnePoint",variableNames:["nDimensions"]}}),definition:function({dependencyValues:e,changes:n}){let r=!1,i,a;if(e.xsChild.length===1)return{newValues:{nDimensions:e.xsChild[0].stateValues.nComponents}};if(e.pointChild.length===1)return{newValues:{nDimensions:e.pointChild[0].stateValues.nDimensions}};if(e.coordsChild.length===1?(r=!0,i=e.coordsChild[0].stateValues.value):e.coordsShadow&&(r=!0,i=e.coordsShadow),r){let s=i.tree;return Array.isArray(s)&&["tuple","vector"].includes(s[0])?a=s.length-1:a=1,{newValues:{nDimensions:a},checkForActualChange:{nDimensions:!0}}}else e.zChild.length===1?a=3:e.yChild.length===1?a=2:e.xChild.length===1?a=1:a=2;return{newValues:{nDimensions:a},checkForActualChange:{nDimensions:!0}}}},t.arrayVariableForConstraints={returnDependencies:()=>({}),definition:()=>({newValues:{arrayVariableForConstraints:"unconstrainedXs"}})},t.arrayEntryPrefixForConstraints={returnDependencies:()=>({}),definition:()=>({newValues:{arrayEntryPrefixForConstraints:"unconstrainedX"}})},t.nDimensionsForConstraints={isAlias:!0,targetVariableName:"nDimensions"},t.unconstrainedXs={isArray:!0,entryPrefixes:["unconstrainedX"],defaultEntryValue:pr.default.fromAst(0),returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={coordsShadow:{dependencyType:"stateVariable",variableName:"coordsShadow"},coordsChild:{dependencyType:"child",childLogicName:"exactlyOneCoords",variableNames:["value"]}},r={};for(let i of e){let a=Number(i)+1;r[i]={xsChild:{dependencyType:"child",childLogicName:"exactlyOneXs",variableNames:["math"+a]},pointChild:{dependencyType:"child",childLogicName:"exactlyOnePoint",variableNames:["x"+a]}},i==="0"?r[i].componentChild={dependencyType:"child",childLogicName:"exactlyOneX",variableNames:["value"]}:i==="1"?r[i].componentChild={dependencyType:"child",childLogicName:"exactlyOneY",variableNames:["value"]}:i==="2"&&(r[i].componentChild={dependencyType:"child",childLogicName:"exactlyOneZ",variableNames:["value"]})}return{globalDependencies:n,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={},a={},s=!1,o;if(e.coordsChild.length===1?(s=!0,o=e.coordsChild[0].stateValues.value):e.coordsShadow&&(s=!0,o=e.coordsShadow),s){let c=o.tree;if(Array.isArray(c)&&["tuple","vector"].includes(c[0]))for(let f of r){let p=Number(f);(p>=0||p<c.length-1)&&(o.tree[p+1]===void 0?i[f]=pr.default.fromAst("\uFF3F"):i[f]=o.get_component(p).simplify())}else r.includes("0")&&(i[0]=o.simplify())}else for(let c of r){let f=Number(c)+1,p=n[c].xsChild;if(p.length===1)i[c]=p[0].stateValues["math"+f].simplify();else{let d=n[c].pointChild;if(d.length===1)i[c]=d[0].stateValues["x"+f];else{let m=n[c].componentChild;m.length===1?i[c]=m[0].stateValues.value.simplify():a[c]={variablesToCheck:[{variableName:"xs",arrayIndex:c},{variableName:"coords",mathComponentIndex:c}]}}}}let u={};return Object.keys(i).length>0&&(u.newValues={unconstrainedXs:i}),Object.keys(a).length>0&&(u.useEssentialOrDefaultValue={unconstrainedXs:a}),u},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){let s=[],o=!1,u;if(n.coordsChild.length===1?(o=!0,u="coordsChild"):n.coordsShadow!==null&&(o=!0,u="coordsShadow"),o){let c;if(a[0]===1)c=nt(e.unconstrainedXs[0]);else{let p=Array(a[0]+1);p[0]="vector";for(let d in e.unconstrainedXs){let m=e.unconstrainedXs[d];p[Number(d)+1]=m instanceof pr.default.class?m.tree:m}c=pr.default.fromAst(p)}let f={setDependency:u,desiredValue:c};return u==="coordsChild"&&(f.childIndex=0,f.variableIndex=0),s.push(f),{success:!0,instructions:s}}else{for(let c of Object.keys(e.unconstrainedXs).reverse()){if(!r[c])continue;r[c].xsChild.length===1?s.push({setDependency:i[c].xsChild,desiredValue:nt(e.unconstrainedXs[c]),childIndex:0,variableIndex:0}):r[c].pointChild.length===1?s.push({setDependency:i[c].pointChild,desiredValue:nt(e.unconstrainedXs[c]),childIndex:0,variableIndex:0}):r[c].componentChild.length===1?s.push({setDependency:i[c].componentChild,desiredValue:e.unconstrainedXs[c],childIndex:0,variableIndex:0}):s.push({setStateVariable:"unconstrainedXs",value:{[c]:nt(e.unconstrainedXs[c])}})}return{success:!0,instructions:s}}}},t.xs={public:!0,componentType:"math",isArray:!0,entryPrefixes:["x"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let i=Number(r)+1,a={};a.unconstrainedX={dependencyType:"stateVariable",variableName:`unconstrainedX${i}`},a.constraintsChild={dependencyType:"child",childLogicName:"atMostOneConstraints",variableNames:[`constraintResult${i}`]},n[r]=a}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n)if(e[i].constraintsChild.length===1){let a=Number(i)+1;r[i]=nt(e[i].constraintsChild[0].stateValues["constraintResult"+a])}else r[i]=nt(e[i].unconstrainedX);return n.length>0?{newValues:{xs:r}}:{}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:n,dependencyNamesByKey:r,initialChange:i,stateValues:a}){if(i&&!a.draggable)return{success:!1};let s=[];for(let o of Object.keys(e.xs).reverse())!n[o]||(n[o].constraintsChild.length===1?s.push({setDependency:r[o].constraintsChild,desiredValue:e.xs[o],childIndex:0,variableIndex:0}):s.push({setDependency:r[o].unconstrainedX,desiredValue:e.xs[o]}));return{success:!0,instructions:s}}},t.x={isAlias:!0,targetVariableName:"x1"},t.y={isAlias:!0,targetVariableName:"x2"},t.z={isAlias:!0,targetVariableName:"x3"},t.coords={public:!0,componentType:"coords",forRenderer:!0,returnDependencies:()=>({xs:{dependencyType:"stateVariable",variableName:"xs"}}),definition:function({dependencyValues:e}){let n=[];for(let r of e.xs)r?n.push(r.tree):n.push("\uFF3F");return n.length>1?n=["vector",...n]:n.length===1?n=n[0]:n="\uFF3F",{newValues:{coords:pr.default.fromAst(n)}}},inverseDefinition:function({desiredStateVariableValues:e,stateValues:n,initialChange:r}){if(r&&!n.draggable)return{success:!1};let i=[],a={},s=e.coords.tree;if(!(Array.isArray(s)&&["tuple","vector"].includes(s[0])))a[0]=e.coords;else for(let o=0;o<s.length-1;o++){let u=e.coords.get_component(o);u.tree!==void 0&&(a[o]=u)}return i.push({setDependency:"xs",desiredValue:a}),{success:!0,instructions:i}}},t.value={isAlias:!0,targetVariableName:"coords"},t.constraintUsed={public:!0,componentType:"boolean",returnDependencies:()=>({constraintsChild:{dependencyType:"child",childLogicName:"atMostOneConstraints",variableNames:["constraintUsed"]}}),definition:function({dependencyValues:e}){return e.constraintsChild.length===0?{newValues:{constraintUsed:!1}}:{newValues:{constraintUsed:e.constraintsChild[0].stateValues.constraintUsed}}}},t.numericalXs={public:!0,componentType:"number",isArray:!0,entryPrefixes:["numericalX"],forRenderer:!0,returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let i=Number(r)+1;n[r]={x:{dependencyType:"stateVariable",variableName:`x${i}`}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=e[i].x;a?(a=e[i].x.evaluate_to_constant(),Number.isFinite(a)?r[i]=a:r[i]=NaN):r[i]=NaN}return{newValues:{numericalXs:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:n,initialChange:r,stateValues:i}){if(r&&!i.draggable)return{success:!1};let a=[];for(let s in e.numericalXs)!dependencyValuesByKey[s]||a.push({setDependency:n[s].xs,desiredValue:e.numericalXs[s]});return{success:!0,instructions:a}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalXs:{dependencyType:"stateVariable",variableName:"numericalXs"}}),definition:({dependencyValues:e})=>({newValues:{nearestPoint:function(){let n={};for(let r=1;r<=e.nDimensions;r++){let i=e.numericalXs[r-1];if(!Number.isFinite(i))return{};n["x"+r]=i}return n}}})},t}adapters=["coords"];movePoint({x:t,y:e,z:n,transient:r}){let i={};t!==void 0&&(i[0]=pr.default.fromAst(t)),e!==void 0&&(i[1]=pr.default.fromAst(e)),n!==void 0&&(i[2]=pr.default.fromAst(n)),r?this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"xs",value:i}],transient:r}):this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"xs",value:i}],event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{x:t,y:e,z:n}}})}actions={movePoint:this.movePoint.bind(new Proxy(this,this.readOnlyProxyHandler))}},Dr=os;var Ot=De(Ee());var ls=class extends lt{constructor(t){super(t);this.moveVector=this.moveVector.bind(new Proxy(this,this.readOnlyProxyHandler)),this.actions={moveVector:this.moveVector}}static componentType="vector";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["head","tail","displacement","basedOnHead","basedOnTail","basedOnDisplacement","nDimensions"]}static primaryStateVariableForDefinition="displacementShadow";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.draggable={default:!0,forRenderer:!0},e.headDraggable={default:!0,forRenderer:!0},e.tailDraggable={default:!0,forRenderer:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let a=Sr({childrenToComponentFunction:s=>({componentType:"x",children:s}),mustStripOffOuterParentheses:!0})({matchedChildren:n});return!a.success&&n.length===1?{success:!0,newChildren:[{componentType:"x",doenetAttributes:{isPropertyChild:!0},children:n}]}:(a.newChildren=[{componentType:"xs",doenetAttributes:{isPropertyChild:!0},children:a.newChildren}],a)};return t.push({childrenRegex:/s+(.*s)?/,replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneX",componentType:"x",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"exactlyOneY",componentType:"y",number:1,takePropertyChildren:!0}),i=e.newLeaf({name:"exactlyOneZ",componentType:"z",number:1,takePropertyChildren:!0}),a=e.newLeaf({name:"exactlyOneXs",componentType:"xs",number:1,takePropertyChildren:!0}),s=e.newOperator({name:"displacementViaComponents",operator:"or",propositions:[n,r,i]}),o=e.newLeaf({name:"exactlyOneDisplacement",componentType:"vector",number:1,takePropertyChildren:!0}),u=e.newOperator({name:"displacementOptions",operator:"xor",propositions:[o,a,s]}),c=e.newLeaf({name:"exactlyOneHead",componentType:"head",number:1,takePropertyChildren:!0}),f=e.newLeaf({name:"exactlyOneTail",componentType:"tail",number:1,takePropertyChildren:!0}),p=e.newOperator({name:"vectorDefiningPieces",operator:"or",propositions:[u,c,f]}),d=e.newLeaf({name:"atMostOnePoint",componentType:"point",comparison:"atMost",number:1}),m=e.newLeaf({name:"atMostOneVector",componentType:"vector",comparison:"atMost",number:1});return e.newOperator({name:"normalDefinitionXorPoints",operator:"xor",propositions:[p,d,m],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let n="";return e.selectedStyle.lineWidth>=4?n+="thick ":e.selectedStyle.lineWidth<=1&&(n+="thin "),e.selectedStyle.lineStyle==="dashed"?n+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(n+="dotted "),n+=e.selectedStyle.lineColor,{newValues:{styleDescription:n}}}},t.displacementShadow={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{displacementShadow:{variablesToCheck:["displacement","displacementShadow"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"displacementShadow",value:e.displacementShadow}]}}},t.headShadow={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{headShadow:{variablesToCheck:["head","headShadow"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"headShadow",value:e.headShadow}]}}},t.tailShadow={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{tailShadow:{variablesToCheck:["tail","tailShadow"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"tailShadow",value:e.tailShadow}]}}},t.basedOnHead={returnDependencies:()=>({headChild:{dependencyType:"child",childLogicName:"exactlyOneHead"},headShadow:{dependencyType:"stateVariable",variableName:"headShadow"},tailChild:{dependencyType:"child",childLogicName:"exactlyOneTail"},displacementOptions:{dependencyType:"child",childLogicName:"displacementOptions"},pointChild:{dependencyType:"child",childLogicName:"atMostOnePoint"},vectorChild:{dependencyType:"child",childLogicName:"atMostOneVector"}}),definition:function({dependencyValues:e}){return e.tailChild.length===1&&e.displacementOptions.length>0?(e.headChild.length===1&&console.warn("Vector is prescribed by head, tail, and displacement.  Ignoring specified head."),{newValues:{basedOnHead:!1},checkForActualChange:{basedOnHead:!0}}):e.headChild.length===1?{newValues:{basedOnHead:!0},checkForActualChange:{basedOnHead:!0}}:e.pointChild.length===1||e.vectorChild.length===1?{newValues:{basedOnHead:!1},checkForActualChange:{basedOnHead:!0}}:{newValues:{basedOnHead:e.headShadow!==null},checkForActualChange:{basedOnHead:!0}}}},t.basedOnTail={returnDependencies:()=>({tailChild:{dependencyType:"child",childLogicName:"exactlyOneTail"},tailShadow:{dependencyType:"stateVariable",variableName:"tailShadow"}}),definition:function({dependencyValues:e}){return e.tailChild.length===1?{newValues:{basedOnTail:!0},checkForActualChange:{basedOnTail:!0}}:{newValues:{basedOnTail:e.tailShadow!==null},checkForActualChange:{basedOnTail:!0}}}},t.basedOnDisplacement={returnDependencies:()=>({displacementOptions:{dependencyType:"child",childLogicName:"displacementOptions"},displacementShadow:{dependencyType:"stateVariable",variableName:"displacementShadow"},vectorChild:{dependencyType:"child",childLogicName:"atMostOneVector"},pointChild:{dependencyType:"child",childLogicName:"atMostOnePoint"}}),definition:function({dependencyValues:e}){return e.displacementOptions.length>0||e.vectorChild.length===1||e.pointChild.length===1?{newValues:{basedOnDisplacement:!0},checkForActualChange:{basedOnDisplacement:!0}}:{newValues:{basedOnDisplacement:e.displacementShadow!==null},checkForActualChange:{basedOnDisplacement:!0}}}},t.nPointChildren={returnDependencies:()=>({pointChildren:{dependencyType:"child",childLogicName:"atMostOnePoint"}}),definition:function({dependencyValues:e}){return{newValues:{nPointChildren:e.pointChildren.length}}}},t.nVectorChildren={returnDependencies:()=>({vectorChildren:{dependencyType:"child",childLogicName:"atMostOneVector"}}),definition:function({dependencyValues:e}){return{newValues:{nVectorChildren:e.vectorChildren.length}}}},t.nDimensions={public:!0,componentType:"number",returnDependencies:()=>({basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},displacementShadow:{dependencyType:"stateVariable",variableName:"displacementShadow"},displacementChild:{dependencyType:"child",childLogicName:"exactlyOneDisplacement",variableNames:["nDimensions"]},vectorChild:{dependencyType:"child",childLogicName:"atMostOneVector",variableNames:["nDimensions"]},xChild:{dependencyType:"child",childLogicName:"exactlyOneX"},yChild:{dependencyType:"child",childLogicName:"exactlyOneY"},zChild:{dependencyType:"child",childLogicName:"exactlyOneZ"},xsChild:{dependencyType:"child",childLogicName:"exactlyOneXs",variableNames:["nComponents"]},headShadow:{dependencyType:"stateVariable",variableName:"headShadow"},headChild:{dependencyType:"child",childLogicName:"exactlyOneHead",variableNames:["nDimensions"]},tailShadow:{dependencyType:"stateVariable",variableName:"tailShadow"},tailChild:{dependencyType:"child",childLogicName:"exactlyOneTail",variableNames:["nDimensions"]},pointChild:{dependencyType:"child",childLogicName:"atMostOnePoint",variableNames:["nDimensions"]}}),definition:function({dependencyValues:e,changes:n}){let r,i,a;if(e.basedOnDisplacement){if(e.displacementChild.length===1)r=e.displacementChild[0].stateValues.nDimensions;else if(e.vectorChild.length===1)r=e.vectorChild[0].stateValues.nDimensions;else if(e.xsChild.length===1)r=e.xsChild[0].stateValues.nComponents;else if(e.zChild.length===1)r=3;else if(e.yChild.length===1)r=2;else if(e.xChild.length===1)r=1;else if(e.pointChild.length===1)r=e.pointChild[0].stateValues.nDimensions;else if(e.displacementShadow){let o=e.displacementShadow.tree;Array.isArray(o)&&["tuple","vector"].includes(o[0])?r=o.length-1:r=2}}if(e.basedOnHead){if(e.headChild.length===1)i=e.headChild[0].stateValues.nDimensions;else if(headShadow){let o=headShadow.tree;Array.isArray(o)&&["tuple","vector"].includes(o[0])?i=o.length-1:i=2}}if(e.basedOnTail){if(e.tailChild.length===1)a=e.tailChild[0].stateValues.nDimensions;else if(tailShadow){let o=tailShadow.tree;Array.isArray(o)&&["tuple","vector"].includes(o[0])?a=o.length-1:a=2}}let s;if(e.basedOnDisplacement){if(e.basedOnTail){if(r!==a)return console.warn("nDimensions mismatch in vector"),{newValues:{nDimensions:NaN}}}else if(e.basedOnHead&&r!==i)return console.warn("nDimensions mismatch in vector"),{newValues:{nDimensions:NaN}};s=r}else if(e.basedOnTail){if(e.basedOnHead&&a!==i)return console.warn("nDimensions mismatch in vector"),{newValues:{nDimensions:NaN}};s=a}else e.basedOnHead?s=i:s=2;return{newValues:{nDimensions:s},checkForActualChange:{nDimensions:!0}}}},t.displacement={public:!0,componentType:"math",isArray:!0,entryPrefixes:["x"],returnWrappingComponents(e){return e==="x"?[]:[["vector",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},stateVariablesDeterminingDependencies:["basedOnDisplacement","nPointChildren","nVectorChildren"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},displacementShadow:{dependencyType:"stateVariable",variableName:"displacementShadow"}},i={};for(let a of e){let s=Number(a)+1;i[a]={xsChild:{dependencyType:"child",childLogicName:"exactlyOneXs",variableNames:["math"+s]}},n.nPointChildren===1?i[a].displacementChild={dependencyType:"child",childLogicName:"atMostOnePoint",variableNames:["x"+s]}:n.nVectorChildren===1?i[a].displacementChild={dependencyType:"child",childLogicName:"atMostOneVector",variableNames:["x"+s]}:i[a].displacementChild={dependencyType:"child",childLogicName:"exactlyOneDisplacement",variableNames:["x"+s]},a==="0"?i[a].componentChild={dependencyType:"child",childLogicName:"exactlyOneX",variableNames:["value"]}:a==="1"?i[a].componentChild={dependencyType:"child",childLogicName:"exactlyOneY",variableNames:["value"]}:a==="2"&&(i[a].componentChild={dependencyType:"child",childLogicName:"exactlyOneZ",variableNames:["value"]}),n.basedOnDisplacement||(i[a].tailX={dependencyType:"stateVariable",variableName:"tailX"+s},i[a].headX={dependencyType:"stateVariable",variableName:"headX"+s})}return{globalDependencies:r,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=Number(a)+1,o=n[a].displacementChild;if(o&&o.length===1)i[a]=o[0].stateValues["x"+s];else{let u=n[a].xsChild;if(u&&u.length===1)i[a]=u[0].stateValues["math"+s].simplify();else{let c=n[a].componentChild;c&&c.length===1?i[a]=c[0].stateValues.value.simplify():e.displacementShadow!==null?i[a]=e.displacementShadow.get_component(Number(a)):i[a]=n[a].headX.subtract(n[a].tailX).simplify()}}}return{newValues:{displacement:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){let s=[],o=!1;for(let u in e.displacement){let c=r[u].displacementChild;if(c&&c.length===1)s.push({setDependency:i[u].displacementChild,desiredValue:e.displacement[u],childIndex:0,variableIndex:0});else{let f=r[u].xsChild;if(f&&f.length===1)s.push({setDependency:i[u].xsChild,desiredValue:e.displacement[u],childIndex:0,variableIndex:0});else{let p=r[u].componentChild;p&&p.length===1?s.push({setDependency:i[u].componentChild,desiredValue:e.displacement[u],childIndex:0,variableIndex:0}):n.displacementShadow!==null?o=!0:s.push({setDependency:i[u].headX,desiredValue:r[u].tailX.add(e.displacement[u]).simplify()})}}}if(o)if(a[0]>1){let u=["vector"];for(let c in e.displacement)u[Number(c)+1]=e.displacement[c].tree;u.length=a[0]+1,s.push({setDependency:"displacementShadow",desiredValue:Ot.default.fromAst(u)})}else a[0]===1&&"0"in e.displacement&&s.push({setDependency:"displacementShadow",desiredValue:e.displacement[0]});return{success:!0,instructions:s}}},t.x={isAlias:!0,targetVariableName:"x1"},t.y={isAlias:!0,targetVariableName:"x2"},t.z={isAlias:!0,targetVariableName:"x3"},t.head={public:!0,componentType:"math",isArray:!0,entryPrefixes:["headX"],returnWrappingComponents(e){return e==="headX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},stateVariablesDeterminingDependencies:["basedOnHead","basedOnDisplacement"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},basedOnTail:{dependencyType:"stateVariable",variableName:"basedOnTail"},basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},headShadow:{dependencyType:"stateVariable",variableName:"headShadow"}},i={};for(let a of e){let s=Number(a)+1;i[a]={headChild:{dependencyType:"child",childLogicName:"exactlyOneHead",variableNames:["x"+s]}},n.basedOnHead||(i[a].tailX={dependencyType:"stateVariable",variableName:"tailX"+s},n.basedOnDisplacement&&(i[a].x={dependencyType:"stateVariable",variableName:"x"+s}))}return{globalDependencies:r,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={},a={};for(let o of r){let u=Number(o)+1;e.basedOnHead?n[o].headChild.length===1?i[o]=n[o].headChild[0].stateValues["x"+u]:e.headShadow!==null&&(i[o]=e.headShadow.get_component(Number(o))):e.basedOnDisplacement?i[o]=n[o].tailX.add(n[o].x).simplify():e.basedOnTail?a[o]={get defaultValue(){return o==="0"?n[o].tailX.add(Ot.default.fromAst(1)).simplify():n[o].tailX},variablesToCheck:["headX"+u]}:a[o]={get defaultValue(){return Ot.default.fromAst(o==="0"?1:0)},variablesToCheck:["headX"+u]}}let s={};return Object.keys(i).length>0&&(s.newValues={head:i}),Object.keys(a).length>0&&(s.useEssentialOrDefaultValue={head:a}),s},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){let s=[],o=!1;for(let u in e.head)n.basedOnHead?r[u].headChild&&r[u].headChild.length===1?s.push({setDependency:i[u].headChild,desiredValue:e.head[u],childIndex:0,variableIndex:0}):n.headShadow!==null&&(o=!0):n.basedOnDisplacement?s.push({setDependency:i[u].x,desiredValue:e.head[u].subtract(r[u].tailX).simplify()}):s.push({setStateVariable:"head",value:{[u]:e.head[u]}});if(o)if(a[0]>1){let u=["vector"];for(let c in e.head)u[Number(c)+1]=e.head[c].tree;u.length=a[0]+1,s.push({setDependency:"headShadow",desiredValue:Ot.default.fromAst(u)})}else a[0]===1&&"0"in e.head&&s.push({setDependency:"headShadow",desiredValue:e.head[0]});return{success:!0,instructions:s}}},t.tail={public:!0,componentType:"math",isArray:!0,entryPrefixes:["tailX"],returnWrappingComponents(e){return e==="tailX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},stateVariablesDeterminingDependencies:["basedOnHead","basedOnDisplacement"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={basedOnDisplacement:{dependencyType:"stateVariable",variableName:"basedOnDisplacement"},basedOnHead:{dependencyType:"stateVariable",variableName:"basedOnHead"},tailShadow:{dependencyType:"stateVariable",variableName:"tailShadow"}},i={};for(let a of e){let s=Number(a)+1;i[a]={tailChild:{dependencyType:"child",childLogicName:"exactlyOneTail",variableNames:["x"+s]}},n.basedOnTail||(n.basedOnHead&&(i[a].headX={dependencyType:"stateVariable",variableName:"headX"+s}),n.basedOnDisplacement&&(i[a].x={dependencyType:"stateVariable",variableName:"x"+s}))}return{globalDependencies:r,dependenciesByKey:i}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={},a={};for(let o of r){let u=Number(o)+1;n[o].tailChild.length===1?i[o]=n[o].tailChild[0].stateValues["x"+u]:e.tailShadow!==null?i[o]=e.tailShadow.get_component(Number(o)):e.basedOnHead&&e.basedOnDisplacement?i[o]=n[o].headX.subtract(n[o].x).simplify():a[o]={get defaultValue(){return Ot.default.fromAst(0)},variablesToCheck:["tailX"+u]}}let s={};return Object.keys(i).length>0&&(s.newValues={tail:i}),Object.keys(a).length>0&&(s.useEssentialOrDefaultValue={tail:a}),s},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){let s=[],o=!1;for(let u in e.tail)r[u].tailChild&&r[u].tailChild.length===1?s.push({setDependency:i[u].tailChild,desiredValue:e.tail[u],childIndex:0,variableIndex:0}):n.tailShadow!==null?o=!0:n.basedOnHead&&n.basedOnDisplacement?s.push({setDependency:i[u].x,desiredValue:r[u].headX.subtract(e.tail[u]).simplify()}):s.push({setStateVariable:"tail",value:{[u]:e.tail[u]}});if(o)if(a[0]>1){let u=["vector"];for(let c in e.tail)u[Number(c)+1]=e.tail[c].tree;u.length=a[0]+1,s.push({setDependency:"tailShadow",desiredValue:Ot.default.fromAst(u)})}else a[0]===1&&"0"in e.tail&&s.push({setDependency:"tailShadow",desiredValue:e.tail[0]});return{success:!0,instructions:s}}},t.numericalEndpoints={forRenderer:!0,returnDependencies:()=>({head:{dependencyType:"stateVariable",variableName:"head"},tail:{dependencyType:"stateVariable",variableName:"tail"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),definition:function({dependencyValues:e}){let n,r;if(e.nDimensions===1){let i=e.head.evaluate_to_constant();Number.isFinite(i)||(i=NaN),r=e.tail.evaluate_to_constant(),Number.isFinite(r)||(r=NaN)}else{n=[],r=[];for(let i=0;i<e.nDimensions;i++){let a=e.head[i].evaluate_to_constant();Number.isFinite(a)||(a=NaN),n.push(a);let s=e.tail[i].evaluate_to_constant();Number.isFinite(s)||(s=NaN),r.push(s)}}return{newValues:{numericalEndpoints:[r,n]}}}},t.displacementCoords={forRenderer:!0,returnDependencies:()=>({displacement:{dependencyType:"stateVariable",variableName:"displacement"}}),definition({dependencyValues:e}){let n=[];for(let r of e.displacement)r?n.push(r.tree):n.push("\uFF3F");return n.length>1?n=["vector",...n]:n.length===1?n=n[0]:n="\uFF3F",{newValues:{displacementCoords:Ot.default.fromAst(n)}}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalEndpoints:{dependencyType:"stateVariable",variableName:"numericalEndpoints"}}),definition:({dependencyValues:e})=>({newValues:{nearestPoint:function(n){if(e.nDimensions!==2)return{};let r=e.numericalEndpoints[0][0],i=e.numericalEndpoints[0][1],a=e.numericalEndpoints[1][0],s=e.numericalEndpoints[1][1];if(!(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)&&Number.isFinite(s)))return{};let o=a-r,u=s-i,c=o*o+u*u;if(c===0)return{};let f=n.x1.evaluate_to_constant(),p=n.x2.evaluate_to_constant();if(!(Number.isFinite(f)&&Number.isFinite(p)))return{};let d=((f-r)*o+(p-i)*u)/c,m={};return d<=0?m={x1:r,x2:i}:d>=1?m={x1:a,x2:s}:m={x1:r+d*o,x2:i+d*u},n.x3!==void 0&&(m.x3=0),m}}})},t}adapters=[{stateVariable:"displacementCoords",componentType:"coords",stateVariableForNewComponent:"value"}];moveVector({tailcoords:t,headcoords:e,transient:n,sourceInformation:r}){let i=[];if(t!==void 0){if(this.stateValues.basedOnHead&&this.stateValues.basedOnDisplacement){let a;e===void 0?a=t.map((s,o)=>this.stateValues.numericalEndpoints[1][o]-s):a=t.map((s,o)=>e[o]-s),i.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"displacement",value:a.map(s=>Ot.default.fromAst(s)),sourceInformation:r})}else i.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"tail",value:t.map(a=>Ot.default.fromAst(a)),sourceInformation:r});if(e===void 0&&!this.stateValues.basedOnHead&&this.stateValues.basedOnDisplacement){let a=t.map((s,o)=>this.stateValues.numericalEndpoints[1][o]-s);i.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"displacement",value:a.map(s=>Ot.default.fromAst(s)),sourceInformation:r})}}if(e!==void 0){if(this.stateValues.basedOnHead||!this.stateValues.basedOnDisplacement)i.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"head",value:e.map(a=>Ot.default.fromAst(a)),sourceInformation:r});else{t==null&&(t=this.stateValues.numericalEndpoints[0]);let a=t.map((s,o)=>e[o]-s);i.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"displacement",value:a.map(s=>Ot.default.fromAst(s)),sourceInformation:r})}if(t===void 0&&this.stateValues.basedOnHead&&this.stateValues.basedOnDisplacement){let a=e.map((s,o)=>s-this.stateValues.numericalEndpoints[0][o]);i.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"displacement",value:a.map(s=>Ot.default.fromAst(s)),sourceInformation:r})}}n?this.coreFunctions.requestUpdate({updateInstructions:i,transient:n}):this.coreFunctions.requestUpdate({updateInstructions:i,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{head:e,tail:t}}})}},Pi=ls;var us=class extends _e{static componentType="_componentsize";static rendererType="number";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["value","isAbsolute"]}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneString",componentType:"string",comparison:"atMost",number:1}),r=e.newLeaf({name:"atMostOneNumber",componentType:"number",comparison:"atMost",number:1}),i=e.newOperator({name:"numberAndString",operator:"and",propositions:[r,n],requireConsecutive:!0,sequenceMatters:!0}),a=e.newLeaf({name:"atMostOneComponentSize",componentType:"_componentsize",comparison:"atMost",number:1});return e.newOperator({name:"numberAndStringXorComponentSize",operator:"xor",propositions:[i,a],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=this.componentType;return t.value={public:!0,componentType:"number",additionalStateVariablesDefined:["isAbsolute"],returnDependencies:()=>({componentSizeChild:{dependencyType:"child",childLogicName:"atMostOneComponentSize",variableNames:["value","isAbsolute"]},numberChild:{dependencyType:"child",childLogicName:"atMostOneNumber",variableNames:["value"]},stringChild:{dependencyType:"child",childLogicName:"atMostOneString",variableNames:["value"]}}),definition({dependencyValues:n}){if(n.stringChild.length===0)return n.numberChild.length===0?n.componentSizeChild.length===0?{useEssentialOrDefaultValue:{value:{variablesToCheck:"value",defaultValue:100},isAbsolute:{variablesToCheck:"isAbsolute",defaultValue:!1}}}:{newValues:n.componentSizeChild[0].stateValues}:{newValues:{value:n.numberChild[0].stateValues.value,isAbsolute:!0}};{let r,i;if(n.numberChild.length===1)r=n.numberChild[0].stateValues.value,i=n.stringChild[0].stateValues.value.trim();else{let u=n.stringChild[0].stateValues.value.trim().match(/^(-?[\d.]+)\s*(.*)$/);if(u===null)return console.warn(e+" must begin with a number."),{newValues:{value:null,isAbsolute:!0}};r=u[1],i=u[2].trim()}if(r=Number(r),!Number.isFinite(r))return console.warn(e+" must have a number"),{newValues:{value:null,isAbsolute:!0}};if(i==="")return{newValues:{value:r,isAbsolute:!0}};let a=!(i==="%"||i==="em"),s={px:1,pixel:1,pixels:1,"%":1,em:100,in:96,inch:96,inches:96,pt:1.333333333333,mm:3.7795296,millimeter:3.7795296,millimeters:3.7795296,cm:37.795296,centimeter:37.795296,centimeters:37.795296};return s[i]===void 0?(console.warn(i+" is not a defined unit of measure."),{newValues:{value:r,isAbsolute:!0}}):{newValues:{value:s[i]*r,isAbsolute:a}}}},inverseDefinition({desiredStateVariableValues:n,dependencyValues:r}){return r.stringChild.length===0?r.numberChild.length===0?r.componentSizeChild.length===0?{success:!0,instructions:[{setStateVariable:"value",value:n.value}]}:{success:!0,instructions:[{setDependency:"componentSizeChild",desiredValue:n.value,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setDependency:"numberChild",desiredValue:n.value,childIndex:0,variableIndex:0}]}:r.numberChild.length===1?{success:!0,instructions:[{setDependency:"numberChild",desiredValue:n.value,childIndex:0,variableIndex:0},{setDependency:"stringChild",desiredValue:"px",childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setDependency:"stringChild",desiredValue:n.value+"px",childIndex:0,variableIndex:0}]}}},t.valueForDisplay={forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:({dependencyValues:n})=>({newValues:{valueForDisplay:n.value}})},t}},Wn=us;var cs=class extends ke{static componentType="variable";static rendererType="math";static additionalStateVariablesForProperties=["validVariable"];static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.validVariable={returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){let n=e.value.tree,r=!0;return typeof n=="string"?n==="\uFF3F"&&(r=!1):(!Array.isArray(n)||n[0]!=="_"||typeof n[1]!="string"||typeof n[2]!="string"&&typeof n[2]!="number")&&(r=!1),r||console.warn("Invalid value of a "+this.componentType),{newValues:{validVariable:r}}}},t}},Gn=cs;var fs=class extends ke{static componentType="_mathwithvariable";static rendererType="math";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.variable={default:void 0},e}},fn=fs;var ps=class extends Me{static componentType="textlist";static rendererType="aslist";static stateVariableForPropertyValue="texts";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.unordered={default:!1},e.maximumNumber={default:null},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=n.reduce(function(i,a){return a.componentType==="string"?[...i,...a.state.value.split(/\s+/).filter(s=>s).map(s=>({componentType:"text",children:[{componentType:"string",state:{value:s}}]}))]:[...i,a]},[]);return{success:!0,newChildren:r}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroTexts",componentType:"text",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroTextlists",componentType:"textlist",comparison:"atLeast",number:0});return e.newOperator({name:"textAndTextLists",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({newValues:{overrideChildHide:!0}})},t.nComponents={public:!0,componentType:"number",additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies(){return{maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},textAndTextlistChildren:{dependencyType:"child",childLogicName:"textAndTextLists",variableNames:["nComponents"],variablesOptional:!0}}},definition:function({dependencyValues:e}){let n=0,r=[];for(let[a,s]of e.textAndTextlistChildren.entries())if(s.stateValues.nComponents!==void 0){for(let o=0;o<s.stateValues.nComponents;o++)r[n+o]=[a,o];n+=s.stateValues.nComponents}else r[n]=[a,0],n+=1;let i=e.maximumNumber;return i!==null&&n>i&&(n=i,r=r.slice(0,i)),{newValues:{nComponents:n,childIndexByArrayKey:r},checkForActualChange:{nComponents:!0}}}},t.texts={public:!0,componentType:"text",isArray:!0,entryPrefixes:["text"],stateVariablesDeterminingDependencies:["childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={},i={childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"}};for(let a of e){let s=[],o="1";n.childIndexByArrayKey[a]&&(s=[n.childIndexByArrayKey[a][0]],o=n.childIndexByArrayKey[a][1]+1),r[a]={textAndTextlistChildren:{dependencyType:"child",childLogicName:"textAndTextLists",variableNames:["value","text"+o],variablesOptional:!0,childIndices:s}}}return{globalDependencies:i,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].textAndTextlistChildren[0];if(s)if(s.stateValues.value!==void 0)i[a]=s.stateValues.value;else{let o=e.childIndexByArrayKey[a][1]+1;i[a]=s.stateValues["text"+o]}}return{newValues:{texts:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){let s=[];for(let o in e.texts){if(!r[o])continue;let u=r[o].textAndTextlistChildren[0];u&&(u.stateValues.value!==void 0?s.push({setDependency:i[o].textAndTextlistChildren,desiredValue:e.texts[o],childIndex:0,variableIndex:0}):s.push({setDependency:i[o].textAndTextlistChildren,desiredValue:e.texts[o],childIndex:0,variableIndex:1}))}return{success:!0,instructions:s}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"texts"},t.text={public:!0,componentType:"text",returnDependencies:()=>({texts:{dependencyType:"stateVariable",variableName:"texts"}}),definition:({dependencyValues:e})=>({newValues:{text:e.texts.join(", ")}})},t.childrenToRender={returnDependencies:()=>({textAndTextlistChildren:{dependencyType:"child",childLogicName:"textAndTextLists",variableNames:["childrenToRender"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e,componentInfoObjects:n}){let r=[];for(let a of e.textAndTextlistChildren)n.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"textlist"})?r.push(...a.stateValues.childrenToRender):r.push(a.componentName);let i=e.maximumNumber;return i!==null&&r.length>i&&(i=Math.max(0,Math.floor(i)),r=r.slice(0,i)),{newValues:{childrenToRender:r}}}},t}},pn=ps;var YS=De(Ee()),ds=class extends Me{static componentType="numberlist";static rendererType="aslist";static stateVariableForPropertyValue="numbers";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.unordered={default:!1},e.maximumNumber={default:void 0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=n.reduce(function(i,a){return a.componentType==="string"?[...i,...a.state.value.split(/\s+/).filter(s=>s).map(s=>({componentType:"number",children:[{componentType:"string",state:{value:s}}]}))]:[...i,a]},[]);return{success:!0,newChildren:r}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroNumbers",componentType:"number",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroNumberlists",componentType:"numberlist",comparison:"atLeast",number:0});return e.newOperator({name:"numberAndNumberLists",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({newValues:{overrideChildHide:!0}})},t.nComponents={public:!0,componentType:"number",additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies:()=>({maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},numberAndNumberlistChildren:{dependencyType:"child",childLogicName:"numberAndNumberLists",variableNames:["nComponents"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let n=0,r=[];for(let[a,s]of e.numberAndNumberlistChildren.entries())if(s.stateValues.nComponents!==void 0){for(let o=0;o<s.stateValues.nComponents;o++)r[n+o]=[a,o];n+=s.stateValues.nComponents}else r[n]=[a,0],n+=1;let i=e.maximumNumber;return i!==null&&n>i&&(n=i,r=r.slice(0,i)),{newValues:{nComponents:n,childIndexByArrayKey:r},checkForActualChange:{nComponents:!0}}}},t.numbers={public:!0,componentType:"number",isArray:!0,entryPrefixes:["number"],stateVariablesDeterminingDependencies:["childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={},i={childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"}};for(let a of e){let s=[],o="1";n.childIndexByArrayKey[a]&&(s=[n.childIndexByArrayKey[a][0]],o=n.childIndexByArrayKey[a][1]+1),r[a]={numberAndNumberlistChildren:{dependencyType:"child",childLogicName:"numberAndNumberLists",variableNames:["value","number"+o],variablesOptional:!0,childIndices:s}}}return{globalDependencies:i,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].numberAndNumberlistChildren[0];if(s)if(s.stateValues.value!==void 0)i[a]=s.stateValues.value;else{let o=e.childIndexByArrayKey[a][1]+1;i[a]=s.stateValues["number"+o]}}return{newValues:{numbers:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){let s=[];for(let o in e.numbers){if(!r[o])continue;let u=r[o].numberAndNumberlistChildren[0];u&&(u.stateValues.value!==void 0?s.push({setDependency:i[o].numberAndNumberlistChildren,desiredValue:e.numbers[o],childIndex:0,variableIndex:0}):s.push({setDependency:i[o].numberAndNumberlistChildren,desiredValue:e.numbers[o],childIndex:0,variableIndex:1}))}return{success:!0,instructions:s}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"numbers"},t.text={public:!0,componentType:"text",additionalStateVariablesDefined:["texts"],returnDependencies:()=>({numberAndNumberlistChildren:{dependencyType:"child",childLogicName:"numberAndNumberLists",variableNames:["valueForDisplay","text","texts"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e}){let n=[];for(let a of e.numberAndNumberlistChildren)a.stateValues.valueForDisplay!==void 0?n.push(a.stateValues.text):n.push(...a.stateValues.texts);let r=e.maximumNumber;return r!==null&&n.length>r&&(r=Math.max(0,Math.floor(r)),n=n.slice(0,r)),{newValues:{text:n.join(", "),texts:n}}}},t.childrenToRender={returnDependencies:()=>({numberAndNumberlistChildren:{dependencyType:"child",childLogicName:"numberAndNumberLists",variableNames:["childrenToRender"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e,componentInfoObjects:n}){let r=[];for(let a of e.numberAndNumberlistChildren)n.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"numberlist"})?r.push(...a.stateValues.childrenToRender):r.push(a.componentName);let i=e.maximumNumber;return i!==null&&r.length>i&&(i=Math.max(0,Math.floor(i)),r=r.slice(0,i)),{newValues:{childrenToRender:r}}}},t}},dn=ds;var rD=De(Ee()),ms=class extends Me{static componentType="mathlist";static rendererType="aslist";static stateVariableForPropertyValue="maths";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.simplify={propagateToDescendants:!0,default:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numbersepreserveorder","none"]},e.unordered={default:!1},e.maximumNumber={default:null},e.mergeMathLists={default:!1},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=n.reduce(function(i,a){return a.componentType==="string"?[...i,...a.state.value.split(/\s+/).filter(s=>s).map(s=>({componentType:"math",children:[{componentType:"string",state:{value:s}}]}))]:[...i,a]},[]);return{success:!0,newChildren:r}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroMaths",componentType:"math",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroMathlists",componentType:"mathlist",comparison:"atLeast",number:0});return e.newOperator({name:"mathAndMathLists",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({newValues:{overrideChildHide:!0}})},t.nComponents={public:!0,componentType:"number",stateVariablesDeterminingDependencies:["mergeMathLists"],additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies({stateValues:e}){let n={maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},mergeMathLists:{dependencyType:"stateVariable",variableName:"mergeMathLists"}};return e.mergeMathLists?n.mathAndMathlistChildren={dependencyType:"child",childLogicName:"mathAndMathLists",variableNames:["value","nComponents"],variablesOptional:!0}:n.mathAndMathlistChildren={dependencyType:"child",childLogicName:"mathAndMathLists",variableNames:["nComponents"],variablesOptional:!0},n},definition:function({dependencyValues:e}){let n=0,r=[];for(let[a,s]of e.mathAndMathlistChildren.entries())if(s.stateValues.nComponents!==void 0){for(let o=0;o<s.stateValues.nComponents;o++)r[n+o]=[a,o];n+=s.stateValues.nComponents}else if(e.mergeMathLists){let o=s.stateValues.value;if(o&&Array.isArray(o.tree)&&o.tree[0]==="list"){let u=o.tree.length-1;for(let c=0;c<u;c++)r[c+n]=[a,c];n+=u}else r[n]=[a,0],n+=1}else r[n]=[a,0],n+=1;let i=e.maximumNumber;return i!==null&&n>i&&(n=i,r=r.slice(0,i)),{newValues:{nComponents:n,childIndexByArrayKey:r},checkForActualChange:{nComponents:!0}}}},t.maths={public:!0,componentType:"math",isArray:!0,entryPrefixes:["math"],stateVariablesDeterminingDependencies:["mergeMathLists","childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={},i={mergeMathLists:{dependencyType:"stateVariable",variableName:"mergeMathLists"},childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"}};for(let a of e){let s=[],o="1";n.childIndexByArrayKey[a]&&(s=[n.childIndexByArrayKey[a][0]],o=n.childIndexByArrayKey[a][1]+1),r[a]={mathAndMathlistChildren:{dependencyType:"child",childLogicName:"mathAndMathLists",variableNames:["value","math"+o],variablesOptional:!0,childIndices:s}}}return{globalDependencies:i,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].mathAndMathlistChildren[0];if(s)if(s.stateValues.value!==void 0){let o=s.stateValues.value;if(e.mergeMathLists&&Array.isArray(o.tree)&&o.tree[0]==="list"){let u=e.childIndexByArrayKey[a][1];i[a]=o.get_component(u)}else i[a]=o}else{let o=e.childIndexByArrayKey[a][1]+1;i[a]=s.stateValues["math"+o]}}return{newValues:{maths:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){if(n.mergeMathLists)return console.log("Have not implemented inverse definition for math list with mergeMathLists=true"),{success:!1};let s=[];for(let o in e.maths){if(!r[o])continue;let u=r[o].mathAndMathlistChildren[0];u&&(u.stateValues.value!==void 0?s.push({setDependency:i[o].mathAndMathlistChildren,desiredValue:e.maths[o],childIndex:0,variableIndex:0}):s.push({setDependency:i[o].mathAndMathlistChildren,desiredValue:e.maths[o],childIndex:0,variableIndex:1}))}return{success:!0,instructions:s}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"maths"},t.latex={additionalStateVariablesDefined:["latexs"],public:!0,componentType:"text",returnDependencies:()=>({mathAndMathlistChildren:{dependencyType:"child",childLogicName:"mathAndMathLists",variableNames:["valueForDisplay","latex","latexs"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},mergeMathLists:{dependencyType:"stateVariable",variableName:"mergeMathLists"}}),definition:function({dependencyValues:e}){let n=[];for(let a of e.mathAndMathlistChildren)if(a.stateValues.valueForDisplay){let s=a.stateValues.valueForDisplay;if(e.mergeMathLists&&Array.isArray(s.tree)&&s.tree[0]==="list")for(let o=0;o<s.tree.length-1;o++)n.push(s.get_component(o).toLatex());else n.push(a.stateValues.latex)}else n.push(...a.stateValues.latexs);let r=e.maximumNumber;return r!==null&&n.length>r&&(r=Math.max(0,Math.floor(r)),n=n.slice(0,r)),{newValues:{latex:n.join(", "),latexs:n}}}},t.text={public:!0,componentType:"text",additionalStateVariablesDefined:["texts"],returnDependencies:()=>({mathAndMathlistChildren:{dependencyType:"child",childLogicName:"mathAndMathLists",variableNames:["valueForDisplay","text","texts"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},mergeMathLists:{dependencyType:"stateVariable",variableName:"mergeMathLists"}}),definition:function({dependencyValues:e}){let n=[];for(let a of e.mathAndMathlistChildren)if(a.stateValues.valueForDisplay){let s=a.stateValues.valueForDisplay;if(e.mergeMathLists&&Array.isArray(s.tree)&&s.tree[0]==="list")for(let o=0;o<s.tree.length-1;o++)n.push(s.get_component(o).toString());else n.push(a.stateValues.text)}else n.push(...a.stateValues.texts);let r=e.maximumNumber;return r!==null&&n.length>r&&(r=Math.max(0,Math.floor(r)),n=n.slice(0,r)),{newValues:{text:n.join(", "),texts:n}}}},t.childrenToRender={returnDependencies:()=>({mathAndMathlistChildren:{dependencyType:"child",childLogicName:"mathAndMathLists",variableNames:["childrenToRender"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e,componentInfoObjects:n}){let r=[];for(let a of e.mathAndMathlistChildren)n.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"mathlist"})?r.push(...a.stateValues.childrenToRender):r.push(a.componentName);let i=e.maximumNumber;return i!==null&&r.length>i&&(i=Math.max(0,Math.floor(i)),r=r.slice(0,i)),{newValues:{childrenToRender:r}}}},t}},rr=ms;var sD=De(Ee());var hs=class extends Se{static componentType="when";static rendererType=void 0;static stateVariableForPropertyValue="conditionSatisfied";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.matchPartial={default:!1},e.symbolicEquality={default:!1},e.expandOnCompare={default:!1,propagateToDescendants:!0},e.simplifyOnCompare={default:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numbersepreserveorder"],propagateToDescendants:!0},e.unorderedCompare={default:!1,propagateToDescendants:!0},e.allowedErrorInNumbers={default:0},e.includeErrorInNumberExponents={default:!1},e.allowedErrorIsAbsolute={default:!1},e.nSignErrorsMatched={default:0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={additionalStateVariablesDefined:["fractionSatisfied","conditionSatisfied"],returnDependencies:()=>({matchPartial:{dependencyType:"stateVariable",variableName:"matchPartial"},symbolicEquality:{dependencyType:"stateVariable",variableName:"symbolicEquality"},expandOnCompare:{dependencyType:"stateVariable",variableName:"expandOnCompare"},simplifyOnCompare:{dependencyType:"stateVariable",variableName:"simplifyOnCompare"},unorderedCompare:{dependencyType:"stateVariable",variableName:"unorderedCompare"},allowedErrorInNumbers:{dependencyType:"stateVariable",variableName:"allowedErrorInNumbers"},includeErrorInNumberExponents:{dependencyType:"stateVariable",variableName:"includeErrorInNumberExponents"},allowedErrorIsAbsolute:{dependencyType:"stateVariable",variableName:"allowedErrorIsAbsolute"},nSignErrorsMatched:{dependencyType:"stateVariable",variableName:"nSignErrorsMatched"},parsedExpression:{dependencyType:"stateVariable",variableName:"parsedExpression"},stringMathTextBooleanChildren:{dependencyType:"child",childLogicName:"stringsMathsTextsAndBooleans",variableNames:["value","texts","maths","unordered"],variablesOptional:!0},mathChildren:{dependencyType:"child",childLogicName:"atLeastZeroMaths",variableNames:["value","expand","simplify"]},booleanChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanChildrenByCode"},booleanlistChildrenByCode:{dependencyType:"stateVariable",variableName:"booleanlistChildrenByCode"},textChildrenByCode:{dependencyType:"stateVariable",variableName:"textChildrenByCode"},textlistChildrenByCode:{dependencyType:"stateVariable",variableName:"textlistChildrenByCode"},mathChildrenByCode:{dependencyType:"stateVariable",variableName:"mathChildrenByCode"},mathlistChildrenByCode:{dependencyType:"stateVariable",variableName:"mathlistChildrenByCode"}}),definition({dependencyValues:e,usedDefault:n}){if(e.parsedExpression===null)return{newValues:{conditionSatisfied:!1,value:!1,fractionSatisfied:0}};let r=e.unorderedCompare,i=e.simplifyOnCompare,a=e.expandOnCompare,s=n.unorderedCompare,o=n.simplifyOnCompare,u=n.expandOnCompare;for(let p of e.stringMathTextBooleanChildren)s&&p.stateValues.unordered&&(r=!0);for(let p of e.mathChildren)u&&p.stateValues.expand&&(a=!0),o&&(p.stateValues.simplify==="full"?i="full":p.stateValues.simplify==="numbers"?i!=="full"&&(i="numbers"):p.stateValues.simplify==="numberspreserveorder"&&i!=="full"&&i!=="numbers"&&(i="numberspreserveorder"));let c=Fr({logicTree:e.parsedExpression.tree,unorderedCompare:r,simplifyOnCompare:i,expandOnCompare:a,dependencyValues:e}),f=c===1;return{newValues:{fractionSatisfied:c,conditionSatisfied:f,value:f}}}},t}},Ku=hs;var vs=class extends Me{static componentType="_textOrInline";static includeBlankStringChildren=!0;static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroInline",componentType:"_inline",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:this.componentType,returnDependencies:()=>({inlineChildren:{dependencyType:"child",childLogicName:"atLeastZeroInline",variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let n="";for(let r of e.inlineChildren)typeof r.stateValues.text=="string"&&(n+=r.stateValues.text);return{newValues:{value:n}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:({dependencyValues:e})=>({newValues:{text:e.value}})},t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"atLeastZeroInline"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t}},Zn=vs;var i1=De(Ee());var Yu=De(Zu()),Qu=De(Ju()),r1=/\+/g,n1=/\//g;function qr(l,t){let e=Qu.default.stringify((0,Yu.default)(t)).slice(0,10).replace(r1,"_").replace(n1,"-");return"__"+l+"_"+e}function dr(l,t){let e=1,n=l+e;for(;t.includes(n);)e+=1,n=l+e;return t.push(n),n}function mn(l){let t=l.lastIndexOf("/");if(t===-1)throw Error(`Encountered name ${l} that doesn't include a slash`);return l.slice(0,t+1)}function ec(l){l.length===1&&l[0].componentType==="document"&&(l=l[0].children);for(let n=l.length-1;n>=0;n--){let r=l[n];if(["title","meta"].includes(r.componentType)){let i=1,a=l[n+1];a.componentType==="string"&&a.state.value.trim()===""&&(i=2),l.splice(n,i)}}let t,e;for(let[n,r]of l.entries())(r.componentType!=="string"||r.state.value.trim()!=="")&&(t===void 0&&(t=n),e=n);return l=l.slice(t,e+1),l}function tc(l){let e=/<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[\^'">\s]+))?)+\s*|\s*)\/?>/.exec(l);if(e===null)return!1;let n=e[0];n=n.toLowerCase();let r=e.index,i=n.split(" "),a=i[0].substring(1,i[0].length-1);i.length>1&&(a=i[0].substring(1,i[0].length)),a.substring(a.length-1,a.length)==="/"&&(a=a.substring(0,a.length-1));let s=e[1];s=s.trim();let o={},u=/\w+\s*=\s*["]/;for(e="not null";e!==null;)if(e=u.exec(s),e!==null){let f=s.substring(e.index+e[0].length-1,s.length),d=/"[^"\\]*(?:\\.[^"\\]*)*"/.exec(f),m=d[0].substring(1,d[0].length-1),h=e[0].split("=")[0].trim();if(h.substring(0,1)==="_")throw Error("The prop "+h+" is reserved for internal use only.");if(m=m.replace(/\\"/g,'"'),h in o)throw Error("Duplicate property "+h+" in tag "+a);o[h]=m,s=s.substring(0,e.index)+s.substring(e.index+e[0].length+d[0].length,s.length)}let c=/\w+\s*=\s*[']/;for(e="not null";e!==null;)if(e=c.exec(s),e!==null){let f=s.substring(e.index+e[0].length-1,s.length),d=/'[^'\\]*(?:\\.[^'\\]*)*'/.exec(f),m=d[0].substring(1,d[0].length-1),h=e[0].split("=")[0].trim();if(h.substring(0,1)==="_")throw Error("The prop "+h+" is reserved for internal use only.");if(m=m.replace(/\\'/g,"'"),h in o)throw Error("Duplicate property "+h+" in tag "+a);o[h]=m,s=s.substring(0,e.index)+s.substring(e.index+e[0].length+d[0].length,s.length)}if(/\S/.test(s)){let f=s.split(" ");for(let p of f)/\S/.test(p)&&(o[p]=!0)}return{tagString:n,tagType:a,tagIndex:r,tagProps:o}}function Fi({doenetML:l,includeBlankStrings:t=!0,propertyClasses:e={},standardComponentClasses:n,allComponentClasses:r,init:i=!0}){if(l===void 0)return[];if(i){let u=l.search("<!--");for(;u!==-1;){let c=l.search("-->");c===-1?c=l.length:c=c+3,l=l.substring(0,u)+l.substring(c,l.length),u=l.search("<!--")}}let a=[],s="",o="";for(;l.length>0;){let u=tc(l);if(u===!1)return(/\S/.test(l)||t&&l.length>0)&&a.push({componentType:"string",state:{value:l}}),a;if(!(u.tagType in n)||u.tagType==="string")throw Error("Tag "+u.tagType+" is not defined.");if(u.tagString.substring(u.tagString.length-2,u.tagString.length-1)==="/")s=l.substring(0,u.tagIndex),o="",l=l.substring(u.tagIndex+u.tagString.length,l.length);else{let h=1,y=0,g=JSON.parse(JSON.stringify(u)),b=0,x="";for(;h>y;){if(b=Number(b)+Number(g.tagString.length)+Number(g.tagIndex),x=l.substring(b,l.length),g=tc(x),g===!1)throw Error("No matching </"+u.tagType+"> end tag");g.tagType===u.tagType&&h++,g.tagType==="/"+u.tagType&&y++}s=l.substring(0,u.tagIndex);let N=Number(u.tagIndex)+Number(u.tagString.length),C=Number(b)+Number(g.tagIndex);o=l.substring(N,C),l=l.substring(Number(C)+Number(g.tagString.length),l.length)}if(/\S/.test(s))a.push({componentType:"string",state:{value:s}});else if(t&&s.length>0){let h=!0,y=n[u.tagType];for(let g in e){if(e[g])continue;let b=r[g];b!==void 0&&(u.tagType===g||b.isPrototypeOf(y))&&(e[g]=!0,h=!1)}h&&a.push({componentType:"string",state:{value:s}})}let f=[],p=n[u.tagType],d=p.includeBlankStringChildren===!0,m=Object.keys(p.createPropertiesObject({standardComponentClasses:n})).map(h=>h.toLowerCase()),v={};if(m.forEach(h=>v[h]=!1),(/\S/.test(o)||d&&o.length>0)&&(f=Fi({doenetML:o,includeBlankStrings:d,propertyClasses:v,standardComponentClasses:n,allComponentClasses:r,init:!1})),a.push({componentType:u.tagType,children:f,props:u.tagProps}),!/\S/.test(l)){if(t&&l.length>0&&a.push({componentType:"string",state:{value:l}}),i){let h,y;for(let[g,b]of a.entries())(b.componentType!=="string"||b.state.value.trim()!=="")&&(h===void 0&&(h=g),y=g);a=a.slice(h,y+1)}return a}}return a}function ys({serializedComponents:l}){let t={};for(let e of l)if(e.componentType==="ref"){if(e.children!==void 0){let n;for(let r of e.children)if(r.componentType==="contentid"){n=r;break}if(n){let r;if(n.state!==void 0&&(r=n.state.value),n.children!==void 0){for(let i of n.children)if(i.componentType==="string"){r=i.state.value;break}}r!==void 0&&(t[r]===void 0&&(t[r]=[]),t[r].push(e))}}}else if(e.children!==void 0){let n=ys({serializedComponents:e.children});for(let r in n)t[r]===void 0&&(t[r]=[]),t[r].push(...n[r])}return t}function rc(l){if(l.length!==1||l[0].componentType!=="document"){let t=l.splice(0);l.push({componentType:"document",children:t})}}function hn(l,t){for(let e of l){let n=[];if(e.props){for(let r in e.props){let i=r.toLowerCase();if(t[i]!==void 0){let a;e.props[r]===!0?a={componentType:i,doenetAttributes:{isPropertyChild:!0},state:{implicitValue:!0}}:a={componentType:i,doenetAttributes:{isPropertyChild:!0},children:[{componentType:"string",state:{value:e.props[r]}}]},n.push(a),delete e.props[r]}else if(!["name","assignnames","newnamespace","tname","prop","type","alias","indexalias"].includes(i))throw Error("Invalid attribute: "+r)}e.children.unshift(...n)}e.children!==void 0&&hn(e.children,t)}}function nc(l){let t=[];for(let e of l)if(e.preSugarInd!==void 0)t.push(e.preSugarInd);else if(e.doenetAttributes||(e.doenetAttributes={}),e.doenetAttributes.createdFromSugar=!0,e.children){let n=nc(e.children);t.push(...n)}return t}function Jn(l,t){return l.forEach(e=>{e.children&&(e.children=Jn(e.children,t))}),l=a1(l,t),l}function a1(l,t){for(let e=0;e<l.length;e++){let n=l[e];if(n.componentType==="string"){let r=n.state.value,i=ic(r);if(i.success){let a=i.firstIndMatched,s=i.matchLength,o=i.nDollarSigns,u;if(i.additionalAttributes){let d=`<copy tname="${i.targetName}" ${i.additionalAttributes} />`,m=Fi({doenetML:d,standardComponentClasses:t.standardComponentClasses,allComponentClasses:t.allComponentClasses});hn(m,t.standardComponentClasses),ac(m),m=Jn(m,t),u=m}else{let d={tName:i.targetName,createdFromMacro:!0};i.additionalAttributes===void 0&&(d.isPlainMacro=!0),u=[{componentType:"copy",doenetAttributes:d}]}let c=1,f=r.substring(a+s);if(o===2){let d=r.slice(a+s).match(/^\s*\(/);if(!d)continue;let m=s+d[0].length,v=[],h=!1;r.length>a+m&&(h=!0,v.push({componentType:"string",state:{value:r.substring(a+m)}})),v.push(...l.slice(e+1));let y=s1({componentsFromMacro:u,remainingComponents:v,includeFirstInRemaining:h,componentInfoObjects:t});if(!y.success)continue;u=y.componentsFromMacro,c=y.lastComponentIndMatched+1,h||c++,f=""}let p=[];a>0&&p.push({componentType:"string",state:{value:r.substring(0,a)}}),p.push(...u),f.length>0&&p.push({componentType:"string",state:{value:f}}),l.splice(e,c,...p),a>0&&e++}}}return l}function ic(l){let t=/(\$\$?)(([a-zA-Z_]\w*\b)|\(([a-zA-Z0-9_:.\/\-]+)\s*(\)|{))/,e=0,n;for(;;){if(n=l.substring(e).match(t),!n)return{success:!1};if(n.index===0||l[e+n.index-1]!=="$")break;e+=n.index+n[0].length}let r=n.index+e,i=n[0].length,a=n[1].length;if(n[3])return{success:!0,firstIndMatched:r,matchLength:i,targetName:n[3],nDollarSigns:a};let s=n[4];if(n[5]===")")return{success:!0,firstIndMatched:r,matchLength:i,targetName:s,nDollarSigns:a};let o=l.substring(r+i),u=o1(o);if(u.success)return{success:!0,firstIndMatched:r,matchLength:i+u.parenInd+1,targetName:s,nDollarSigns:a,additionalAttributes:o.substring(0,u.braceInd)};{let c=ic(o);return c.success?{success:!0,firstIndMatched:r+i+c.firstIndMatched,matchLength:c.matchLength,targetName:c.targetName,nDollarSigns:c.nDollarSigns,additionalAttributes:c.additionalAttributes}:{success:!1}}}function o1(l){let t=0;for(let e=0;e<l.length;e++){let n=l[e];if(n==="}"){if(t===0){if(l.substring(e+1).trim()[0]===")"){let r=l.substring(e+1).indexOf(")")+e+1;return{success:!0,braceInd:e,parenInd:r}}return{success:!1}}t--}else n==="{"&&t++}return{success:!1}}function ac(l){for(let t of l)t.doenetAttributes||(t.doenetAttributes={}),t.doenetAttributes.createdFromMacro=!0,t.children&&ac(t.children)}function s1({componentsFromMacro:l,remainingComponents:t,includeFirstInRemaining:e,componentInfoObjects:n}){let r=l1(t);if(r.success){let i=r.componentInd;t=t.slice(0,i+1);let a=t[i],s="";r.charInd+1<a.state.value.length&&(s=a.state.value.substring(r.charInd+1)),r.charInd>0?a.state.value=a.state.value.substring(0,r.charInd):t=t.slice(0,i);let c=ln({childrenList:t}).pieces.map(d=>Jn(d,n)).map(d=>({componentType:"math",doenetAttributes:{createdFromMacro:!0},children:d})),p=[{componentType:"evaluate",doenetAttributes:{createdFromMacro:!0},children:[...l,{componentType:"input",doenetAttributes:{createdFromMacro:!0},children:c}]}];return s.length>0&&p.push({componentType:"string",state:{value:s}}),{success:!0,componentsFromMacro:p,lastComponentIndMatched:i}}}function l1(l){let t=0;for(let[e,n]of l.entries())if(n.componentType==="string"){let r=n.state.value;for(let i=0;i<r.length;i++){let a=r[i];if(a==="(")t++;else if(a===")"){if(t===0)return{success:!0,componentInd:e,charInd:i};t--}}}return{success:!1}}function gs(l){for(let t of l)t.componentType==="string"?t.state.value=t.state.value.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&dollar;/g,"$").replace(/&amp;/g,"&"):t.children&&gs(t.children)}function bs({serializedComponents:l,parentParametersFromSugar:t={},parentProps:e={},componentInfoObjects:n,parentUniqueId:r=""}){for(let[i,a]of l.entries())if(a.children){let s=a.componentType.toLowerCase(),o=n.allComponentClasses[s],u=r+"|"+s+i,c={},f={};if(a.props)for(let p in a.props){let d=p.toLowerCase();d==="newnamespace"?a.props[p]===!0||a.props[p].trim().toLowerCase()==="true"?f[d]=!0:f[d]=!1:f[d]=a.props[p]}f=new Proxy(f,Be);for(let[p,d]of o.returnSugarInstructions().entries()){let m=a.children.filter(x=>!(x.doenetAttributes&&x.doenetAttributes.isPropertyChild));if(m.length===0)break;let v=a.children.indexOf(m[0]),h=m.map(x=>x.componentType==="string"?"s":"n").join("");if(d.childrenRegex){let x=h.match(d.childrenRegex);if(!x||x[0].length!==m.length)continue}let y=He(m),g=0;for(let x of y)x.componentType!=="string"&&(x.preSugarInd=g,g++);let b=d.replacementFunction({matchedChildren:y,parentParametersFromSugar:t,parentProps:e,componentProps:f,uniqueId:u+"|sugar"+p,componentInfoObjects:n});if(b.success){let x=b.newChildren,N=nc(x);N.length!==g||!N.every((C,_)=>C===_)?console.error(`Invalid sugar for ${s} as didn't return original components in order`):(a.children.splice(v,m.length,...x),b.parametersForChildrenSugar&&Object.assign(c,b.parametersForChildrenSugar))}}bs({serializedComponents:a.children,parentParametersFromSugar:c,parentProps:f,componentInfoObjects:n,parentUniqueId:u})}}function sc(l){let t=0,e=[];l=l.trim();let n=0;for(let i=0;i<l.length;i++){let a=l[i];if(a==="("){if(t===0){let s=l.substring(n,i).trim();s.length>0&&e.push(s),n=i}t++}else if(a===")"){if(t===0)return{success:!1};if(t===1){let s=l.substring(n+1,i).trim();if(s.length>0){let o=sc(s);o.success===!0?e.push(o.pieces):e.push(s)}n=i+1}t--}else if(t===0&&a.match(/\s/)){let s=l.substring(n,i).trim();s.length>0&&e.push(s),n=i}}if(t!==0)return{success:!1};let r=l.substring(n,l.length).trim();return r.length>0&&e.push(r),{success:!0,pieces:e}}function Vr({serializedComponents:l,namespaceStack:t=[],componentInfoObjects:e,nameSpaceForChildren:n,parentDoenetAttributes:r={},parentName:i,useOriginalNames:a=!1,doenetAttributesByFullTName:s,indOffset:o=0}){t.length===0&&t.push({namespace:"",componentCounts:{},namesUsed:{}});let u=t.length-1,c=t[u];for(let[f,p]of l.entries()){let d=p.componentType.toLowerCase(),m=e.allComponentClasses[d],v=p.doenetAttributes;v===void 0&&(v=p.doenetAttributes={});let h=v.prescribedName,y=v.assignNames,g=v.newNamespace,b=v.tName,x=v.propName,N=v.type,C=v.alias,_=v.indexAlias,w=d==="string"||v.isPropertyChild||v.createdFromSugar||v.createdFromMacro||v.createUniqueName;!g&&a&&p.originalDoenetAttributes&&p.originalDoenetAttributes.newNamespace&&(g=!0);let A=h!==void 0,$=p.props;if($===void 0)$=p.props={};else for(let V in $){let I=V.toLowerCase();if(I==="name")if(h===void 0)h=$[V],delete $[V];else throw Error("Cannot define name twice for a component");else if(I==="assignnames")if(y===void 0){let q=sc($[V]);if(q.success)y=q.pieces;else throw Error("Invalid format for assignnames");delete $[V]}else throw Error("Cannot define assignNames twice for a component");else if(I==="newnamespace")if(g===void 0)$[V]===!0||$[V].trim().toLowerCase()==="true"?g=!0:g=!1,delete $[V];else throw Error("Cannot define newNamespace twice for a component");else if(I==="tname")if(b===void 0)b=$[V],delete $[V];else throw Error("Cannot define tName twice for a component");else if(I==="prop")if(x===void 0)x=$[V],delete $[V];else throw Error("Cannot define prop twice for a component");else if(I==="type")if(N===void 0)N=$[V].toLowerCase(),delete $[V];else throw Error("Cannot define type twice for a component");else if(I==="alias")if(C===void 0)C=$[V],delete $[V];else throw Error("Cannot define alias twice for a component");else if(I==="indexalias")if(_===void 0)_=$[V],delete $[V];else throw Error("Cannot define indexAlias twice for a component")}if(h){if(!A&&!v.createdFromSugar){if(!/[a-zA-Z]/.test(h.substring(0,1)))throw Error("Component name must begin with a letter");if(!/^[a-zA-Z0-9_:.\-]+$/.test(h))throw Error("Component name can contain only letters, numbers, hyphens, underscores, colons and periods")}v.prescribedName=h}else if(w){let V=i+"|createUniqueName|";p.downstreamDependencies?V+=JSON.stringify(p.downstreamDependencies):V+=f+"|"+o,h=qr(d,V)}if(!y&&a&&p.originalDoenetAttributes&&p.originalDoenetAttributes.assignNames&&(y=p.originalDoenetAttributes.assignNames),y){if(!m.assignNamesToReplacements)throw Error("Cannot assign names for component type "+p.componentType);v.assignNames=y;let I=rt(y);for(let q of I){if(!/[a-zA-Z]/.test(q.substring(0,1)))throw Error("All assigned names must begin with a letter");if(!/^[a-zA-Z0-9_-]+$/.test(q))throw Error("Assigned names can contain only letters, numbers, hyphens, and underscores")}if(I.length!==new Set(I).size)throw Error("Duplicate assigned names")}g&&(v.newNamespace=g);let S=c.componentCounts[d];S===void 0&&(S=0),v.isPropertyChild||v.createdFromSugar||v.createdFromMacro||(c.componentCounts[d]=++S);let D="";for(let V=0;V<=u;V++)D+=t[V].namespace+"/";if(!h){if(a&&p.originalName){let V=p.originalName.lastIndexOf("/");h=p.originalName.substring(V+1)}h||(h="_"+d+S)}if(D+=h,p.componentName=D,h){if(h in c.namesUsed)throw Error("Duplicate component name "+D);c.namesUsed[h]=!0}if(!g&&y)for(let V of rt(y)){if(V in c.namesUsed)throw Error(`Duplicate component name (from assignNames of ${D}): ${V}`);c.namesUsed[V]=!0}if(p.doenetAttributes.createUniqueAssignNames&&p.originalName){let V=p.doenetAttributes.assignNames=[],I=D+"|createUniqueName|assignNames|",q="",K;if(g)q=D+"/",K=p.originalName+"/";else{for(let W=0;W<=u;W++)q+=t[W].namespace+"/";let E=p.originalName.lastIndexOf("/");K=p.originalName.slice(0,E+1)}for(let[E,W]of p.doenetAttributes.originalAssignNames.entries()){let G=I+E,P=qr("fromAssignNames",G);V.push(P);let Q={componentName:q+P,originalName:K+W};oc(Q,s)}}if(oc(p,s),b){if(!m.acceptTname)throw Error(`Component type ${d} does not accept a tname property`);v.tName=b,v.fullTName=u1({tName:b,oldFullTName:v.fullTName,namespaceStack:t,acceptDoubleUnderscore:v.createdFromSugar})}if(x){if(!m.acceptProp)throw Error(`Component type ${d} does not accept a prop property`);v.propName=x}if(N){if(!m.acceptType)throw Error(`Component type ${d} does not accept a type property`);v.type=N}else m.acceptType&&m.defaultType&&(v.type=m.defaultType);if(C){if(!m.acceptAlias)throw Error("Cannot specify alias for component type "+p.componentType);if(v.alias=C,!/[a-zA-Z_]/.test(C.substring(0,1)))throw Error("All aliases must begin with a letter or an underscore");if(!/^[a-zA-Z0-9_-]+$/.test(C))throw Error("Aliases can contain only letters, numbers, hyphens, and underscores")}if(_){if(!m.acceptIndexAlias)throw Error("Cannot specify index alias for component type "+p.componentType);if(v.indexAlias=_,!/[a-zA-Z_]/.test(_.substring(0,1)))throw Error("All index aliases must begin with a letter or an underscore");if(!/^[a-zA-Z0-9_-]+$/.test(_))throw Error("Index aliases can contain only letters, numbers, hyphens, and underscores")}if(p.children!==void 0)if(n)t.push({namespace:n,componentCounts:{},namesUsed:{}}),Vr({serializedComponents:p.children,namespaceStack:t,componentInfoObjects:e,parentDoenetAttributes:v,parentName:D,useOriginalNames:a,doenetAttributesByFullTName:s}),t.pop();else if(!g)Vr({serializedComponents:p.children,namespaceStack:t,componentInfoObjects:e,parentDoenetAttributes:v,parentName:D,useOriginalNames:a,doenetAttributesByFullTName:s});else{let V={};y&&rt(y).forEach(q=>V[q]=!0);let I={namespace:h,componentCounts:{},namesUsed:V};t.push(I),Vr({serializedComponents:p.children,namespaceStack:t,componentInfoObjects:e,parentDoenetAttributes:v,parentName:D,useOriginalNames:a,doenetAttributesByFullTName:s}),t.pop()}}return l}function u1({tName:l,oldFullTName:t,namespaceStack:e,acceptDoubleUnderscore:n}){if(!t&&/__/.test(l)&&!n)throw Error("Invalid reference target: "+l);let r=l,i;if(r.substring(0,1)==="/")i=r;else{let a=e.length-1;for(;r.substring(0,3)==="../";)r=r.substring(3),a--;if(a<0)throw Error("Target "+l+" not found");i="";for(let s=0;s<=a;s++)i+=e[s].namespace+"/";i+=r}return i}function Yn({serializedComponents:l,componentTypesCreatingVariants:t,allComponentClasses:e}){let n=[];for(let r of l)if(r.componentType in t&&(r.variants===void 0&&(r.variants={}),r.variants.isVariantComponent=!0,n.push(r)),r.children!==void 0){let a=Yn({serializedComponents:r.children,componentTypesCreatingVariants:t,allComponentClasses:e});if(a.length>0){r.variants===void 0&&(r.variants={});let s,o;for(let[u,c]of a.entries())if(c.componentType==="variantcontrol"){s=u,o=c;break}if(s!==void 0&&(r.variants.isVariantComponent||(r.variants.isVariantComponent=!0,n.push(r)),a.splice(s,1)),r.variants.descendantVariantComponents=a,r.variants.isVariantComponent||n.push(...a),o!==void 0){let u=!1;if(o.state!==void 0&&o.state.uniquevariants!==void 0&&(u=o.state.uniquevariants),o.children!==void 0){for(let c of o.children)if(c.componentType==="uniquevariants"&&(c.state!==void 0&&(c.state.implicitValue!==void 0&&(u=c.state.implicitValue),c.state.value!==void 0&&(u=c.state.value)),c.children!==void 0)){for(let f of c.children)if(f.componentType==="string"){u=f.state.value;break}}}typeof u=="string"&&(u.trim().toLowerCase()==="true"?u=!0:u=!1),u&&(r.variants.uniquevariants=!0,lc({serializedComponent:r,allComponentClasses:e}))}}}return n}function lc({serializedComponent:l,allComponentClasses:t}){let e=1;if(l.children!==void 0){for(let i of l.children)if(i.variants!==void 0&&(i.variants.isVariantComponent||i.variants.descendantVariantComponents!==void 0)){let a=lc({serializedComponent:i,allComponentClasses:t});if(!a.success)return{success:!1};e*=a.numberOfVariants}}let n;l.variants===void 0&&(l.variants={});let r=t[l.componentType];if(r.determineNumberOfUniqueVariants!==void 0){let i=r.determineNumberOfUniqueVariants({serializedComponent:l});if(!i.success)return{success:!1};n=i.numberOfVariants,l.variants.uniqueVariantData=i.uniqueVariantData}return n===void 0&&(n=e),l.variants.numberOfVariants=n,{success:!0,numberOfVariants:n}}function qe({assignNames:l=[],serializedComponents:t,parentName:e,parentCreatesNewNamespace:n,componentInfoObjects:r,indOffset:i=0,originalNamesAreConsistent:a=!1}){let s=t.length;uc(t);let o={},u=null;if(a){if(s>0&&t[0].originalName){let f=t[0].originalName.lastIndexOf("/");u=t[0].originalName.substring(0,f)}if(u!==null)for(let f of t)xs({namespace:u,components:[f],doenetAttributesByFullTName:o})}else for(let f=0;f<s;f++){let p=t[f];if(u=null,s>0&&p.originalName){let d=p.originalName.lastIndexOf("/");u=p.originalName.substring(0,d)}u!==null&&xs({namespace:u,components:[p],doenetAttributesByFullTName:o})}let c=[];for(let f=0;f<s;f++){let p=f+i,d=l[p],m=t[f];if(m.doenetAttributes||(m.doenetAttributes={}),!a&&(u=null,s>0&&m.originalName)){let v=m.originalName.lastIndexOf("/");u=m.originalName.substring(0,v)}if(Array.isArray(d))if(r.allComponentClasses[m.componentType].assignNamesToReplacements){let v=e+"|assignName|"+p.toString();m.doenetAttributes.prescribedName=qr(m.componentType,v);let h=e;if(!n){let y=e.lastIndexOf("/");h=e.substring(0,y)}h+="/"+m.doenetAttributes.prescribedName,m.componentName=h,m.doenetAttributes.assignNames=d,c.push(m);continue}else console.warn(`Cannot assign names recursively to ${m.componentType}`),d=null;if(!d)if(a&&m.originalName)d=m.originalName.slice(u.length+1);else{let v=e+"|assignName|"+p.toString();d=qr(m.componentType,v)}m.doenetAttributes.prescribedName=d,a&&!m.doenetAttributes.assignNames&&m.originalDoenetAttributes&&m.originalDoenetAttributes.assignNames&&(m.doenetAttributes.assignNames=m.originalDoenetAttributes.assignNames),c1({parentName:e,ind:p,component:m,parentCreatesNewNamespace:n,componentInfoObjects:r,doenetAttributesByFullTName:o,originalNamesAreConsistent:a}),c.push(m)}return{serializedComponents:c}}function c1({parentName:l,component:t,ind:e,parentCreatesNewNamespace:n,componentInfoObjects:r,doenetAttributesByFullTName:i,originalNamesAreConsistent:a}){let s=l.split("/");n||s.pop();let o=s.map(c=>({namespace:c,componentCounts:{},namesUsed:{}}));l[0]!=="/"&&o.splice(0,0,{componentCounts:{},namesUsed:{},namespace:""}),t.doenetAttributes||(t.doenetAttributes={});let u;t.doenetAttributes.newNamespace||a?u=!0:(u=!1,t.children&&cc(t.children)),Vr({serializedComponents:[t],namespaceStack:o,componentInfoObjects:r,parentName:l,useOriginalNames:u,doenetAttributesByFullTName:i,indOffset:e})}function xs({namespace:l,components:t,doenetAttributesByFullTName:e}){let n=l.length;for(let r of t){if(r.doenetAttributes&&r.doenetAttributes.tName){let i=r.doenetAttributes.fullTName;i.substring(0,n)!==l&&(r.doenetAttributes.tName=i),e[i]||(e[i]=[]),e[i].push(r.doenetAttributes)}r.children&&xs({namespace:l,components:r.children,doenetAttributesByFullTName:e})}}function oc(l,t){if(l.originalName&&t&&t[l.originalName]&&l.componentName!==l.originalName)for(let e of t[l.originalName])e.tName=l.componentName,e.fullTName=l.componentName}function uc(l){for(let t of l)t.componentName&&(t.originalName=t.componentName,delete t.componentName),t.children&&uc(t.children)}function cc(l){for(let t of l)t.doenetAttributes||(t.doenetAttributes={}),t.doenetAttributes.createUniqueName=!0,t.doenetAttributes.assignNames&&(t.doenetAttributes.createUniqueAssignNames=!0,t.doenetAttributes.originalAssignNames=t.doenetAttributes.assignNames,delete t.doenetAttributes.assignNames),delete t.doenetAttributes.prescribedName,t.children&&cc(t.children)}var Cs=class extends _e{constructor(t){super(t);this.replacementsWorkspace={}}static componentType="_composite";static rendererType=void 0;static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.replacements={returnDependencies:()=>({replacements:{dependencyType:"replacement"}}),definition:({dependencyValues:e})=>({newValues:{replacements:e.replacements}})},t.recursiveReplacements={returnDependencies:()=>({recursiveReplacements:{dependencyType:"replacement",recursive:!0}}),definition:({dependencyValues:e})=>({newValues:{recursiveReplacements:e.recursiveReplacements}})},t.fullRecursiveReplacements={returnDependencies:()=>({recursiveReplacements:{dependencyType:"replacement",recursive:!0,recurseNonStandardComposites:!0}}),definition:({dependencyValues:e})=>({newValues:{fullRecursiveReplacements:e.recursiveReplacements}})},t}static createSerializedReplacements(){return{replacements:[]}}static calculateReplacementChanges(){return[]}get allPotentialRendererTypes(){let t=[];if(this.replacements)for(let e of this.replacements)for(let n of e.allPotentialRendererTypes)t.includes(n)||t.push(n);return t}},Ue=Cs;var Ns=class extends Ue{static componentType="template";static treatAsComponentForRecursiveReplacements=!0;static includeBlankStringChildren=!0;static keepChildrenSerialized({serializedComponent:t,componentInfoObjects:e}){if(t.children===void 0)return[];let n=[];for(let i in this.createPropertiesObject({})){let a=i.toLowerCase();n.push({componentType:a,class:e.allComponentClasses[a]})}let r=[];for(let[i,a]of t.children.entries()){let s=!1;for(let o of n)if(e.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:o.componentType})&&!o.propFound){s=o.propFound=!0;break}s||r.push(i)}return r}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.rendered={default:!1},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.serializedChildren={returnDependencies:()=>({serializedChildren:{dependencyType:"serializedChildren",doNotProxy:!0}}),definition:function({dependencyValues:e}){return{newValues:{serializedChildren:e.serializedChildren}}}},t.newNamespace={returnDependencies:()=>({newNamespace:{dependencyType:"doenetAttribute",attributeName:"newNamespace"}}),definition({dependencyValues:e}){return{newValues:{newNamespace:e.newNamespace}}}},t.readyToExpand={returnDependencies:()=>({}),definition:function(){return{newValues:{readyToExpand:!0}}}},t}static createSerializedReplacements({component:t}){return t.stateValues.rendered?{replacements:He(t.state.serializedChildren.value)}:{replacements:[]}}get allPotentialRendererTypes(){return this.potentialRendererTypesFromSerializedComponents(this.stateValues.serializedChildren)}},Bi=Ns;var ws=class extends Bi{static componentType="option";static includeBlankStringChildren=!1;static assignNamesToReplacements=!0;static originalNamesAreConsistent=!0;static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.selectForVariants={default:[]},e.selectWeight={default:1},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=this;return t.serializedChildren={returnDependencies:()=>({serializedChildren:{dependencyType:"serializedChildren",doNotProxy:!0}}),definition:function({dependencyValues:n}){let r=He(n.serializedChildren).filter(i=>i.componentType!=="string");return r.length!==n.serializedChildren.length&&console.warn(`String child of ${e.componentType} ignored.`),{newValues:{serializedChildren:r}}}},t}static createSerializedReplacements({component:t,componentInfoObjects:e}){if(t.stateValues.rendered){let n=He(t.state.serializedChildren.value);if(t.stateValues.hide)for(let i of n)i.state||(i.state={}),i.state.hide=!0;return{replacements:qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:n,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:e,originalNamesAreConsistent:t.doenetAttributes.newNamespace||!t.doenetAttributes.assignNames}).serializedComponents}}else return{replacements:[]}}},jr=ws;var Ts=class extends _e{static componentType="variants";static rendererType=void 0;static stateVariableForPropertyValue="variants";static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=n.reduce(function(i,a){return a.componentType==="string"?[...i,...a.state.value.split(/\s+/).filter(s=>s).map(s=>({componentType:"variant",state:{value:s}}))]:[...i,a]},[]);return{success:!0,newChildren:r}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroVariants",componentType:"variant",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nVariants={public:!0,componentType:"number",returnDependencies:()=>({variantChildren:{dependencyType:"child",childLogicName:"atLeastZeroVariants"}}),definition:function({dependencyValues:e}){return{newValues:{nVariants:e.variantChildren.length}}}},t.variants={public:!0,componentType:"variant",isArray:!0,entryPrefixes:["variant"],returnArraySizeDependencies:()=>({nVariants:{dependencyType:"stateVariable",variableName:"nVariants"}}),returnArraySize({dependencyValues:e}){return[e.nVariants]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n[r]={variantChild:{dependencyType:"child",childLogicName:"atLeastZeroVariants",variableNames:["value"],childIndices:[r]}};return{dependenciesByKey:n}},arrayDefinitionByKey:function({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n)e[i].variantChild.length===1&&(r[i]=e[i].variantChild[0].stateValues.value.toLowerCase());return{newValues:{variants:r}}}},t}},zi=Ts;var fc=class extends Se{static componentType="hide";static rendererType="boolean"},pc=class extends Se{static componentType="disabled";static rendererType="boolean"},dc=class extends Se{static componentType="draggable";static rendererType="boolean"},mc=class extends Se{static componentType="modifyIndirectly";static rendererType="boolean"},hc=class extends Se{static componentType="fixed";static rendererType="boolean"},vc=class extends Pe{static componentType="label";static rendererType="text"},yc=class extends vt{static componentType="childnumber";static rendererType="number"},gc=class extends Se{static componentType="includeUndefinedObjects";static rendererType="boolean"},bc=class extends Pe{static componentType="prefill";static rendererType="text"},xc=class extends Pe{static componentType="format";static rendererType="text"},Cc=class extends Oe{static componentType="credit";static rendererType="number"},Nc=class extends Oe{static componentType="weight";static rendererType="number"},wc=class extends Oe{static componentType="possiblepoints";static rendererType="number"},Tc=class extends un{static componentType="through"},_c=class extends rr{static componentType="throughSlopes"},Ac=class extends un{static componentType="endpoints"},$c=class extends un{static componentType="vertices"},Sc=class extends Dr{static componentType="head";static rendererType="point"},Dc=class extends Dr{static componentType="tail";static rendererType="point"},Vc=class extends Pi{static componentType="displacement";static rendererType="vector"},Ic=class extends Dr{static componentType="center";static rendererType="point"},Mc=class extends ke{static componentType="radius";static rendererType="math"},Oc=class extends Oe{static componentType="xmin";static rendererType="number"},Ec=class extends Oe{static componentType="xmax";static rendererType="number"},Pc=class extends Oe{static componentType="ymin";static rendererType="number"},Lc=class extends Oe{static componentType="ymax";static rendererType="number"},Rc=class extends Oe{static componentType="dx";static rendererType="number"},kc=class extends Oe{static componentType="dy";static rendererType="number"},Fc=class extends Oe{static componentType="dz";static rendererType="number"},Bc=class extends Oe{static componentType="xoffset";static rendererType="number"},zc=class extends Oe{static componentType="yoffset";static rendererType="number"},qc=class extends Oe{static componentType="zoffset";static rendererType="number"},jc=class extends Oe{static componentType="xthreshold";static rendererType="number"},Uc=class extends Oe{static componentType="ythreshold";static rendererType="number"},Hc=class extends Oe{static componentType="zthreshold";static rendererType="number"},Kc=class extends Oe{static componentType="threshold";static rendererType="number"},Wc=class extends Se{static componentType="includegridlines";static rendererType="boolean"},Gc=class extends Se{static componentType="showcontrols";static rendererType="boolean"},Zc=class extends Se{static componentType="showticks";static rendererType="boolean"},Xc=class extends zr{static componentType="from"},Jc=class extends zr{static componentType="to"},Yc=class extends Kn{static componentType="exclude"},Qc=class extends Kn{static componentType="excludecombination"},ef=class extends Mi{static componentType="excludecombinations";static componentTypeSingular="excludecombination"},tf=class extends ke{static componentType="step";static rendererType="math"},rf=class extends vt{static componentType="minnumrows";static rendererType="number"},nf=class extends vt{static componentType="minnumcolumns";static rendererType="number"},af=class extends Pe{static componentType="rownum";static rendererType="text"},sf=class extends Pe{static componentType="colnum";static rendererType="text"},of=class extends Pe{static componentType="defaulttype";static rendererType="text"},lf=class extends Pe{static componentType="behavior";static rendererType="text"},uf=class extends Wn{static componentType="width"},cf=class extends Wn{static componentType="height"},ff=class extends Pe{static componentType="columns";static rendererType="text"},pf=class extends Oe{static componentType="depth";static rendererType="number"},df=class extends Oe{static rendererType="number";static componentType="initialnumber"},mf=class extends Pe{static componentType="initialtext";static rendererType="text"},hf=class extends Gn{static componentType="parameter";static rendererType="math"},vf=class extends ke{static componentType="parmin";static rendererType="math"},yf=class extends ke{static componentType="parmax";static rendererType="math"},gf=class extends ke{static componentType="formula";static rendererType="math"},bf=class extends Se{static componentType="flipfunction";static rendererType="boolean"},xf=class extends Oe{static componentType="splinetension";static rendererType="number"},Cf=class extends Pe{static componentType="splineform";static rendererType="text"},Nf=class extends Ei{static componentType="angles"},wf=class extends Oe{static componentType="pointnumber";static rendererType="number"},Tf=class extends Pe{static componentType="direction";static rendererType="text"},_f=class extends ke{static componentType="location";static rendererType="math"},Af=class extends ke{static componentType="value";static rendererType="math"},$f=class extends Oe{static componentType="xscale";static rendererType="number"},Sf=class extends Oe{static componentType="yscale";static rendererType="number"},Df=class extends Se{static componentType="extrapolatebackward";static rendererType="boolean"},Vf=class extends Se{static componentType="extrapolateforward";static rendererType="boolean"},If=class extends Pe{static componentType="simplify";static rendererType="text"},Mf=class extends Pe{static componentType="simplifyOnCompare";static rendererType="text"},Of=class extends Pe{static componentType="variablename";static rendererType="text"},Ef=class extends Pe{static componentType="authorprop";static rendererType="text"},Pf=class extends Oe{static componentType="index";static rendererType="number"},Lf=class extends Se{static componentType="aggregatescores";static rendererType="boolean"},Rf=class extends Zn{static componentType="title";static rendererType="textorinline"},kf=class extends Oe{static componentType="level";static rendererType="number"},Ff=class extends Hn{static componentType="variant";static rendererType="text"},Bf=class extends zi{static componentType="selectForVariants"},zf=class extends vt{static componentType="nvariants";static rendererType="number"},qf=class extends Se{static componentType="uniquevariants";static rendererType="boolean"},jf=class extends Hn{static componentType="seed";static rendererType="text"},Uf=class extends vt{static componentType="numbertoselect";static rendererType="number"},Hf=class extends Se{static componentType="withreplacement";static rendererType="boolean"},Kf=class extends vt{static componentType="length";static rendererType="number"},Wf=class extends vt{static componentType="displaydigits";static rendererType="number"},Gf=class extends vt{static componentType="displaydecimals";static rendererType="number"},Zf=class extends Oe{static componentType="selectweight";static rendererType="number"},Xf=class extends Gn{static componentType="independentvariable";static rendererType="math"},Jf=class extends ke{static componentType="initialindependentvariablevalue";static rendererType="math"},Yf=class extends fn{static componentType="righthandside";static rendererType="math"},Qf=class extends Pe{static componentType="rendermode";static rendererType="text"},ep=class extends Se{static componentType="renderasmath";static rendererType="boolean"},tp=class extends Oe{static componentType="chunksize";static rendererType="number"},rp=class extends Se{static componentType="animationon";static rendererType="boolean"},np=class extends Pe{static componentType="animationmode";static rendererType="text"},ip=class extends Oe{static componentType="animationinterval";static rendererType="number"},ap=class extends vt{static componentType="initialselectedindex";static rendererType="number"},sp=class extends Se{static componentType="numeric";static rendererType="boolean"},op=class extends Se{static componentType="symbolic";static rendererType="boolean"},lp=class extends Se{static componentType="forceNumeric";static rendererType="boolean"},up=class extends Se{static componentType="forceSymbolic";static rendererType="boolean"},cp=class extends rr{static componentType="input";static rendererType="aslist"},fp=class extends ke{static componentType="x";static rendererType="math"},pp=class extends ke{static componentType="y";static rendererType="math"},dp=class extends ke{static componentType="z";static rendererType="math"},mp=class extends rr{static componentType="xs";static rendererType="aslist"},hp=class extends vt{static componentType="layer";static rendererType="number"},vp=class extends Se{static componentType="renderasacuteangle";static rendererType="boolean"},yp=class extends Se{static componentType="displayxaxis";static rendererType="boolean"},gp=class extends Se{static componentType="displayyaxis";static rendererType="boolean"},bp=class extends Pe{static componentType="xlabel";static rendererType="text"},xp=class extends Pe{static componentType="ylabel";static rendererType="text"},Cp=class extends Pe{static rendererType="text";static componentType="zlabel"},Np=class extends Oe{static componentType="uppervalue";static rendererType="number"},wp=class extends Oe{static componentType="lowervalue";static rendererType="number"},Tp=class extends Oe{static componentType="tolerance";static rendererType="number"},_p=class extends vt{static componentType="maxiterations";static rendererType="number"},Ap=class extends Se{static componentType="population";static rendererType="boolean"},$p=class extends vt{static componentType="numberofsamples";static rendererType="number"},Sp=class extends Se{static componentType="matchwholeword";static rendererType="boolean"},Dp=class extends Se{static componentType="casesensitive";static rendererType="boolean"},Vp=class extends ke{static componentType="offset";static rendererType="math"},Ip=class extends ke{static componentType="period";static rendererType="math"},Mp=class extends ke{static componentType="minindex";static rendererType="math"},Op=class extends ke{static componentType="maxindex";static rendererType="math"},Ep=class extends vt{static componentType="numberdecimals";static rendererType="number"},Pp=class extends vt{static componentType="numberdigits";static rendererType="number"},Lp=class extends pn{static componentType="componenttypes"},Rp=class extends Pe{static componentType="source";static rendererType="text"},kp=class extends Zn{static componentType="description";static rendererType="textorinline"},Fp=class extends Se{static componentType="selectmultiple";static rendererType="boolean"},Bp=class extends Se{static componentType="assignpartialcredit";static rendererType="boolean"},zp=class extends Se{static componentType="inline";static rendererType="boolean"},qp=class extends Se{static componentType="fixedorder";static rendererType="boolean"},jp=class extends Pe{static componentType="uri";static rendererType="text"},Up=class extends Pe{static componentType="youtube";static rendererType="text"},Hp=class extends Pe{static componentType="geogebra";static rendererType="text"},Kp=class extends Pe{static componentType="keyword";static rendererType="text"},Wp=class extends Oe{static componentType="size";static rendererType="number"},Gp=class extends Se{static componentType="expand";static rendererType="boolean"},Zp=class extends Se{static componentType="expandOnCompare";static rendererType="boolean"},Xp=class extends Se{static componentType="unordered";static rendererType="boolean"},Jp=class extends Se{static componentType="unorderedCompare";static rendererType="boolean"},Yp=class extends Se{static componentType="matchpartial";static rendererType="boolean"},Qp=class extends Se{static componentType="symbolicequality";static rendererType="boolean"},ed=class extends Se{static componentType="showCorrectness";static rendererType="boolean"},td=class extends Se{static componentType="createintervals";static rendererType="boolean"},rd=class extends Se{static componentType="createvectors";static rendererType="boolean"},nd=class extends Oe{static componentType="allowederrorinnumbers";static rendererType="number"},id=class extends Se{static componentType="includeerrorinnumberexponents";static rendererType="boolean"},ad=class extends Se{static componentType="allowederrorisabsolute";static rendererType="boolean"},sd=class extends vt{static componentType="nsignerrorsmatched";static rendererType="number"},od=class extends Pe{static componentType="feedbackcode";static rendererType="text"},ld=class extends Pe{static componentType="feedbacktext";static rendererType="text"},ud=class extends pn{static componentType="feedbackcodes"},cd=class extends Pe{static componentType="texttype";static rendererType="text"},fd=class extends Pe{static componentType="branchid";static rendererType="text"},pd=class extends Pe{static componentType="contentid";static rendererType="text"},dd=class extends Pe{static componentType="target";static rendererType="text"},md=class extends pn{static componentType="targetPropertiesToIgnore"},hd=class extends Pe{static componentType="pluralform";static rendererType="text"},vd=class extends Oe{static componentType="basedonnumber";static rendererType="number"},yd=class extends Se{static componentType="displaysmallaszero";static rendererType="boolean"},gd=class extends Oe{static componentType="maximumnumber";static rendererType="number"},bd=class extends Oe{static componentType="maximumNumberToSelect";static rendererType="number"},xd=class extends Se{static componentType="showlabel";static rendererType="boolean"},Cd=class extends Se{static componentType="mergemathlists";static rendererType="boolean"},Nd=class extends Oe{static componentType="attractthreshold";static rendererType="number"},wd=class extends Oe{static componentType="npoints";static rendererType="number"},Td=class extends Se{static componentType="sortresults";static rendererType="boolean"},_d=class extends ke{static componentType="slope";static rendererType="math"},Ad=class extends Se{static componentType="forcefullcheckworkbutton";static rendererType="boolean"},$d=class extends dn{static componentType="PossibleNumberOfGroups";static rendererType="numberlist"},Sd=class extends Oe{static componentType="ndiscretizationpoints";static rendererType="number"},Dd=class extends Se{static componentType="periodic";static rendererType="boolean"},Vd=class extends Se{static componentType="isResponse";static rendererType="boolean"},Id=class extends Se{static componentType="sectionWideCheckWork";static rendererType="boolean"},Md=class extends Oe{static componentType="delegateCheckWorkToAnswerNumber";static rendererType="number"},Od=class extends Se{static componentType="condition";static rendererType="boolean"},Ed=class extends Pe{static componentType="encodedGeogebraContent";static rendererType="text"},Pd=class extends Pe{static componentType="fromMathInsight";static rendererType="text"},Ld=class extends Se{static componentType="headDraggable";static rendererType="boolean"},Rd=class extends Se{static componentType="tailDraggable";static rendererType="boolean"},kd=class extends Se{static componentType="showNavigation";static rendererType="boolean"},Fd=class extends dn{static componentType="selectIndices";static rendererType="numberlist"},Bd=class extends Se{static componentType="rendered";static rendererType="boolean"},zd=class extends jr{static componentType="else"},qd=class extends jr{static componentType="result"},jd=class extends Oe{static componentType="componentIndex";static rendererType="number"},Ud=class extends dn{static componentType="propIndex";static rendererType="number"},Hd=class extends ke{static componentType="radians";static rendererType="math"},Kd=class extends ke{static componentType="degrees";static rendererType="math"},Wd=class extends Se{static componentType="inDegrees";static rendererType="boolean"},Gd=class extends Hu{static componentType="betweenLines"};var As={};mt(As,{M:()=>vn,Me:()=>Xd,Men:()=>Jd});var Zd=De(Ee()),vn=class extends Me{static componentType="m";static rendererType="math";static primaryStateVariableForDefinition="latex";static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroStrings",componentType:"string",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroTexts",componentType:"text",comparison:"atLeast",number:0}),i=e.newLeaf({name:"atLeastZeroMaths",componentType:"math",comparison:"atLeast",number:0}),a=e.newLeaf({name:"atLeastZeroMathlists",componentType:"mathlist",comparison:"atLeast",number:0}),s=e.newLeaf({name:"atLeastZeroMs",componentType:"m",comparison:"atLeast",number:0}),o=e.newLeaf({name:"atLeastZeroMathinputs",componentType:"mathinput",comparison:"atLeast",number:0});return e.newOperator({name:"stringsTextsAndMaths",operator:"and",propositions:[n,r,i,a,s,o],requireConsecutive:!0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.latex={public:!0,componentType:"text",defaultValue:"",returnDependencies:()=>({stringTextMathChildren:{dependencyType:"child",childLogicName:"stringsTextsAndMaths",variableNames:["latex","text"],variablesOptional:!0}}),definition:function({dependencyValues:e,componentInfoObjects:n}){if(e.stringTextMathChildren.length===0)return{useEssentialOrDefaultValue:{latex:{variablesToCheck:"latex"}}};let r="";for(let i of e.stringTextMathChildren)i.stateValues.latex?r+=i.stateValues.latex:i.stateValues.text&&(r+=i.stateValues.text);return{newValues:{latex:r}}}},t.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({stringTextMathChildren:{dependencyType:"child",childLogicName:"stringsTextsAndMaths",variableNames:["latex","text"],variablesOptional:!0},latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e,componentInfoObjects:n}){if(e.stringTextMathChildren.length===0)return{newValues:{latexWithInputChildren:[e.latex]}};let r=[],i="",a=0;for(let s of e.stringTextMathChildren)n.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"mathinput"})?(i.length>0&&(r.push(i),i=""),r.push(a),a++):s.stateValues.latex?i+=s.stateValues.latex:s.stateValues.text&&(i+=s.stateValues.text);return i.length>0&&r.push(i),{newValues:{latexWithInputChildren:r}}}},t.renderMode={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{renderMode:"inline"}})},t.text={returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){let n;try{n=Zd.default.fromLatex(e.latex)}catch(r){return{newValues:{text:e.latex}}}return{newValues:{text:n.toString()}}}},t.childrenToRender={returnDependencies:()=>({mathinputChildren:{dependencyType:"child",childLogicName:"atLeastZeroMathinputs"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.mathinputChildren.map(n=>n.componentName)}}}},t}},Xd=class extends vn{static componentType="me";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.renderMode.definition=()=>({newValues:{renderMode:"display"}}),t}},Jd=class extends vn{static componentType="men";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.renderMode.definition=()=>({newValues:{renderMode:"numbered"}}),t}};var $s={};mt($s,{Md:()=>Ss,Mdn:()=>Qd,Mrow:()=>em});var Yd=De(Ee()),Ss=class extends Me{static componentType="md";static rendererType="math";static primaryStateVariableForDefinition="latex";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["latex"]}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroMrows",componentType:"mrow",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.latex={public:!0,componentType:"text",defaultValue:"",returnDependencies:()=>({mrowChildren:{dependencyType:"child",childLogicName:"atLeastZeroMrows",variableNames:["latex","hide"]}}),definition:function({dependencyValues:e}){return e.mrowChildren.length>0?{newValues:{latex:e.mrowChildren.filter(r=>!r.stateValues.hide).map(r=>r.stateValues.latex).join("\\\\")}}:{useEssentialOrDefaultValue:{latex:{variablesToCheck:"latex"}}}}},t.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({mrowChildren:{dependencyType:"child",childLogicName:"atLeastZeroMrows",variableNames:["latexWithInputChildren"]},latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){if(e.mrowChildren.length>0){let n=[],r=0,i="";for(let a of e.mrowChildren){for(let s of a.stateValues.latexWithInputChildren)typeof s=="number"?(i.length>0&&(n.push(i),i=""),n.push(r),r++):i+=s;i+="\\\\"}return i.length>0&&n.push(i),{newValues:{latexWithInputChildren:n}}}else return{newValues:{latexWithInputChildren:[e.latex]}}}},t.text={returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:e}){let n;try{n=e.stateValues.latex.split("\\\\").map(r=>Yd.default.fromLatex(r).toString()).join("\\\\")}catch(r){return{newValues:{text:e.stateValues.latex}}}return{newValues:{text:n}}}},t.renderMode={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{renderMode:"align"}})},t.childrenToRender={returnDependencies:()=>({mrowChildren:{dependencyType:"child",childLogicName:"atLeastZeroMrows",variableNames:["childrenToRender"]}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.mrowChildren.reduce((n,r)=>[...n,...r.stateValues.childrenToRender],[])}}}},t}},Qd=class extends Ss{static componentType="mdn";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.renderMode.definition=()=>({newValues:{renderMode:"alignnumbered"}}),t}},em=class extends vn{static componentType="mrow";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.renderMode.definition=()=>({newValues:{renderMode:"display"}}),t}};var Is={};mt(Is,{And:()=>nm,Not:()=>rm,Or:()=>im,Xor:()=>am});var Ds=class extends Se{static componentType="_booleanoperator";static rendererType="boolean";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.deleteAllLogic(),e.newLeaf({name:"atLeastOneBoolean",componentType:"boolean",comparison:"atLeast",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();delete t.parsedExpression,delete t.mathChildrenByCode;let e=this;return t.value={public:!0,componentType:this.componentType,forRenderer:!0,returnDependencies:()=>({booleanChildren:{dependencyType:"child",childLogicName:"atLeastOneBoolean",variableNames:["value"]}}),definition:function({dependencyValues:n}){return{newValues:{value:e.applyBooleanOperator(n.booleanChildren.map(r=>r.stateValues.value))}}}},t}},yn=Ds;function mr({stateVariableDefinitions:l,oldName:t,newName:e}){let n=l[e]=l[t];if(delete l[t],n.additionalStateVariablesDefined){let o=n.additionalStateVariablesDefined.indexOf(t);o!==-1&&(n.additionalStateVariablesDefined[o]=e)}let r=n.definition,i=["newValues","useEssentialOrDefaultValue"],a=["noChanges","makeEssential","alwaysShadow"];n.definition=function(o){let u=r(o);for(let c of i)u[c]&&t in u[c]&&(u[c][e]=u[c][t],delete u[c][t]);for(let c of a)if(u[c]){let f=u[c].indexOf(t);f!==-1&&(u[c][f]=e)}return u};let s=n.inverseDefinition;n.inverseDefinition=function(o){let u=o.desiredStateVariableValues;u[t]=u[e],delete u[e];let c=s(o);if(c.success)for(let f of c.instructions)f.setStateVariable===t&&(f.setStateVariable=e);return c}}var Vs=class extends Se{static componentType="_booleanoperatoroneinput";static rendererType="boolean";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=this;return mr({stateVariableDefinitions:t,oldName:"value",newName:"valuePreOperator"}),t.value={public:!0,componentType:this.componentType,forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"valuePreOperator"}}),definition:function({dependencyValues:n}){return{newValues:{value:e.applyBooleanOperator(n.value)}}}},t}},tm=Vs;var rm=class extends tm{static componentType="not";static applyBooleanOperator(t){return!t}},nm=class extends yn{static componentType="and";static applyBooleanOperator(t){return t.every(e=>e)}},im=class extends yn{static componentType="or";static applyBooleanOperator(t){return t.some(e=>e)}},am=class extends yn{static componentType="xor";static applyBooleanOperator(t){return t.reduce((n,r)=>n+r,0)===1}};var Os={};mt(Os,{IsInteger:()=>sm,IsNumber:()=>om});var Ms=class extends Se{static componentType="_booleanoperatorofmath";static rendererType="boolean";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.deleteAllLogic(),e.newLeaf({name:"atLeastOneMath",componentType:"math",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();delete t.parsedExpression,delete t.mathChildrenByCode;let e=this;return t.value={public:!0,componentType:this.componentType,forRenderer:!0,returnDependencies:()=>({mathChildren:{dependencyType:"child",childLogicName:"atLeastOneMath",variableNames:["value"]}}),definition:function({dependencyValues:n}){return{newValues:{value:e.applyBooleanOperator(n.mathChildren.map(r=>r.stateValues.value))}}}},t}},Qn=Ms;var sm=class extends Qn{static componentType="isinteger";static applyBooleanOperator(t){if(t.length===0)return!1;if(t.length!==1)return console.warn("IsInteger requires exactly one math child"),null;let e=t[0].evaluate_to_constant();if(!Number.isFinite(e))return!1;let n=Math.round(e);return Math.abs(n-e)<=1e-15*Math.abs(e)}},om=class extends Qn{static componentType="isNumber";static applyBooleanOperator(t){if(t.length===0)return!1;if(t.length!==1)return console.warn("IsNumber requires exactly one math child"),null;let e=t[0].evaluate_to_constant();return Number.isFinite(e)}};var Ls={};mt(Ls,{Abs:()=>gm,Ceil:()=>vm,ClampNumber:()=>cm,ConvertSetToList:()=>hm,Count:()=>wm,Floor:()=>ym,Max:()=>_m,Mean:()=>bm,Min:()=>Tm,Mod:()=>Am,Product:()=>um,Round:()=>mm,StandardDeviation:()=>Nm,Sum:()=>lm,Variance:()=>Rs,WrapNumberPeriodic:()=>pm});var Ur=De(Ee()),Es=class extends ke{static componentType="_mathoperator";static rendererType="math";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.forceSymbolic={default:!1},e.forceNumeric={default:!1},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=n.reduce(function(i,a){return a.componentType==="string"?[...i,...a.state.value.split(/\s+/).filter(s=>s).map(s=>({componentType:Number.isFinite(Number(s))?"number":"math",children:[{componentType:"string",state:{value:s}}]}))]:[...i,a]},[]);return{success:!0,newChildren:r}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();let n=e.newLeaf({name:"atLeastZeroMaths",componentType:"math",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroNumbers",componentType:"number",comparison:"atLeast",number:0});return e.newOperator({name:"mathsAndNumbers",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.isNumericOperator={returnDependencies:()=>({forceNumeric:{dependencyType:"stateVariable",variableName:"forceNumeric"},forceSymbolic:{dependencyType:"stateVariable",variableName:"forceSymbolic"},mathChildren:{dependencyType:"child",childLogicName:"atLeastZeroMaths",variableNames:["isNumber"],variablesOptional:!0}}),definition({dependencyValues:e}){let n;return e.forceNumeric?n=!0:e.forceSymbolic?n=!1:e.mathChildren.length===0?n=!0:n=e.mathChildren.every(r=>r.stateValues.isNumber),{newValues:{isNumericOperator:n}}}},delete t.codePre,delete t.expressionWithCodes,delete t.codesAdjacentToStrings,delete t.mathChildrenByArrayComponent,t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:e=>Ur.default.fromAst("\uFF3F")}})},t.numericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericOperator:e=>Ur.default.fromAst("\uFF3F")}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{inverseMathOperator:null}})},t.inverseNumericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{inverseNumericOperator:null}})},t.unnormalizedValue={returnDependencies:()=>({mathNumberChildren:{dependencyType:"child",childLogicName:"mathsAndNumbers",variableNames:["value"]},isNumericOperator:{dependencyType:"stateVariable",variableName:"isNumericOperator"},mathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"},numericOperator:{dependencyType:"stateVariable",variableName:"numericOperator"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"inverseMathOperator"},inverseNumericOperator:{dependencyType:"stateVariable",variableName:"inverseNumericOperator"}}),definition:function({dependencyValues:e,componentInfoObjects:n}){if(e.mathNumberChildren.length===0)return{newValues:{unnormalizedValue:Ur.default.fromAst("\uFF3F")}};if(e.isNumericOperator){let r=[];for(let i of e.mathNumberChildren)if(n.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"number"}))r.push(i.stateValues.value);else{let a=i.stateValues.value.evaluate_to_constant();Number.isFinite(a)||(a=NaN),r.push(a)}return{newValues:{unnormalizedValue:Ur.default.fromAst(e.numericOperator(r))}}}else{let r=[];for(let i of e.mathNumberChildren)n.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:"number"})?r.push(Ur.default.fromAst(i.stateValues.value)):r.push(i.stateValues.value);return{newValues:{unnormalizedValue:e.mathOperator(r)}}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){if(n.mathNumberChildren.length===0)return{success:!1};if(n.isNumericOperator)if(n.inverseNumericOperator){let r=[];for(let a of n.mathNumberChildren)if(componentInfoObjects.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"number"}))r.push(a.stateValues.value);else{let s=a.stateValues.value.evaluate_to_constant();Number.isFinite(s)||(s=NaN),r.push(s)}let i=n.inverseNumericOperator({desiredValue:e.unnormalizedValue.evaluate_to_constant(),inputs:r});return i.success?{success:!0,instructions:[{setDependency:"mathNumberChildren",desiredValue:i.inputValue,childIndex:i.inputNumber,variableIndex:0}]}:{success:!1}}else return{success:!1};else if(n.inverseMathOperator){let r=[];for(let a of n.mathNumberChildren)componentInfoObjects.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"number"})?r.push(Ur.default.fromAst(a.stateValues.value)):r.push(a.stateValues.value);let i=n.inverseMathOperator({desiredValue:e.unnormalizedValue,inputs:r});return i.success?{success:!0,instructions:[{setDependency:"mathNumberChildren",desiredValue:i.inputValue,childIndex:i.inputNumber,variableIndex:0}]}:{success:!1}}else return{success:!1}}},t.canBeModified={returnDependencies:()=>({modifyIndirectly:{dependencyType:"stateVariable",variableName:"modifyIndirectly"},fixed:{dependencyType:"stateVariable",variableName:"fixed"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"},mathNumberChildren:{dependencyType:"child",childLogicName:"mathsAndNumbers"},isNumericOperator:{dependencyType:"stateVariable",variableName:"isNumericOperator"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"},inverseNumericOperator:{dependencyType:"stateVariable",variableName:"inverseNumericOperator"}}),definition:function({dependencyValues:e}){return{newValues:{canBeModified:e.modifyIndirectly&&!e.fixed&&e.mathNumberChildren.length===1&&(e.isNumericOperator?e.inverseNumericOperator:e.inverseMathOperator)}}}},t}},Kt=Es;var Ps=class extends ke{static componentType="_mathoperatoroneinput";static rendererType="math";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:e=>me.fromAst("\uFF3F")}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{inverseMathOperator:null}})},mr({stateVariableDefinitions:t,oldName:"unnormalizedValue",newName:"unnormalizedValuePreOperator"}),t.unnormalizedValue={returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"unnormalizedValuePreOperator"},mathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"inverseMathOperator"}}),definition:function({dependencyValues:e}){return{newValues:{unnormalizedValue:e.mathOperator(e.value)}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n,componentName:r}){if(n.inverseMathOperator){let i=n.inverseMathOperator(e.unnormalizedValue);return{success:!0,instructions:[{setDependency:"value",desiredValue:i}]}}else return{success:!1}}},mr({stateVariableDefinitions:t,oldName:"canBeModified",newName:"canBeModifiedPreOperator"}),t.canBeModified={returnDependencies:()=>({canBeModifiedPreOperator:{dependencyType:"stateVariable",variableName:"canBeModifiedPreOperator"},inverseMathOperator:{dependencyType:"stateVariable",variableName:"mathOperator"}}),definition:function({dependencyValues:e}){let n=e.canBeModifiedPreOperator;return e.inverseMathOperator||(n=!1),{newValues:{canBeModified:n}}}},t}},nr=Ps;var ut=De(Ee()),lm=class extends Kt{static componentType="sum";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericOperator:function(e){return e.reduce((n,r)=>n+r)}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){return e.reduce((n,r)=>n.add(r))}}})},t}},um=class extends Kt{static componentType="product";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericOperator:function(e){return e.reduce((n,r)=>n*r)}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){return e.reduce((n,r)=>n.multiply(r))}}})},t}},cm=class extends nr{static componentType="clampnumber";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.lowerValue={default:0},e.upperValue={default:1},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.isNumericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{isNumericOperator:!0}})},t.mathOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:({dependencyValues:e})=>({newValues:{mathOperator:function(n){return fm({value:n,lowerValue:e.lowerValue,upperValue:e.upperValue})}}})},t.inverseMathOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:({dependencyValues:e})=>({newValues:{inverseMathOperator:function(n){return fm({value:n,lowerValue:e.lowerValue,upperValue:e.upperValue})}}})},t}};function fm({value:l,lowerValue:t,upperValue:e}){let n=l.evaluate_to_constant();return Number.isFinite(n)?ut.default.fromAst(Math.max(t,Math.min(e,n))):ut.default.fromAst(NaN)}var pm=class extends nr{static componentType="wrapnumberperiodic";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.lowerValue={default:0},e.upperValue={default:1},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.isNumericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{isNumericOperator:!0}})},t.mathOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:({dependencyValues:e})=>({newValues:{mathOperator:function(n){return dm({value:n,lowerValue:e.lowerValue,upperValue:e.upperValue})}}})},t.inverseMathOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:({dependencyValues:e})=>({newValues:{inverseMathOperator:function(n){return dm({value:n,lowerValue:e.lowerValue,upperValue:e.upperValue})}}})},t}};function dm({value:l,lowerValue:t,upperValue:e}){let n=l.evaluate_to_constant();return Number.isFinite(n)?t===e?ut.default.fromAst(t):(t>e&&([e,t]=[t,e]),ut.default.fromAst(t+ut.default.math.mod(n-t,e-t))):ut.default.fromAst(NaN)}var mm=class extends nr{static componentType="round";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.numberDecimals={default:0},e.numberDigits={default:null},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({numberDecimals:{dependencyType:"stateVariable",variableName:"numberDecimals"},numberDigits:{dependencyType:"stateVariable",variableName:"numberDigits"}}),definition:({dependencyValues:e})=>({newValues:{mathOperator:function(n){let r=n.evaluate_numbers({max_digits:Infinity,evaluate_functions:!0});return e.numberDigits!==null?r.round_numbers_to_precision(e.numberDigits):r.round_numbers_to_decimals(e.numberDecimals)}}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{inverseMathOperator:e=>e}})},t}},hm=class extends nr{static componentType="convertsettolist";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return delete e.unordered,e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.unordered={returnDependencies:()=>({}),definition:()=>({newValues:{unordered:!0},makeEssential:["unordered"]})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){if(e!==void 0&&Array.isArray(e.tree)&&e.tree[0]==="set"){let n=[];for(let r of e.tree.slice(1))n.some(i=>e.context.equalsViaSyntax(e.context.fromAst(i),e.context.fromAst(r)))||n.push(r);return e.context.fromAst(["list",...n])}return e}}})},t}},vm=class extends nr{static componentType="ceil";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){let n=e.evaluate_to_constant();if(!Number.isFinite(n))return e;let r=Math.round(n);return Math.abs((r-n)/n)<1e-15?ut.default.fromAst(r):ut.default.fromAst(Math.ceil(n))}}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{inverseMathOperator:e=>e}})},t}},ym=class extends nr{static componentType="floor";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){let n=e.evaluate_to_constant();if(!Number.isFinite(n))return e;let r=Math.round(n);return Math.abs((r-n)/n)<1e-15?ut.default.fromAst(r):ut.default.fromAst(Math.floor(n))}}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{inverseMathOperator:e=>e}})},t}},gm=class extends nr{static componentType="abs";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){let n=e.evaluate_to_constant();return Number.isFinite(n)?ut.default.fromAst(Math.abs(n)):ut.default.fromAst(["apply","abs",e.tree])}}})},t.inverseMathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{inverseMathOperator:function(e){let n=e,r=e.evaluate_to_constant();return Number.isFinite(r)&&r<0&&(n=ut.default.fromAst(0)),n}}})},t}},bm=class extends Kt{static componentType="mean";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericOperator:function(e){let n=e.reduce((r,i)=>r+i);return n/=e.length,n}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){return e.reduce((n,r)=>n.add(r)).divide(e.length)}}})},t}},Rs=class extends Kt{static componentType="variance";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.population={default:!1},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({population:{dependencyType:"stateVariable",variableName:"population"}}),definition:({dependencyValues:e})=>({newValues:{numericOperator:function(n){return xm(n,e.population)}}})},t.mathOperator={returnDependencies:()=>({population:{dependencyType:"stateVariable",variableName:"population"}}),definition:({dependencyValues:e})=>({newValues:{mathOperator:function(n){return Cm(n,e.population)}}})},t}};function xm(l,t){let e=0,n=0;for(let i of l)e+=i,n+=i*i;let r=l.length;return n-=e**2/r,t?n/=r:n/=r-1,n}function Cm(l,t){let e=l.length,n=l.reduce((i,a)=>i.add(a)),r=l.slice(1).reduce((i,a)=>i.add(a.pow(2)),l[0].pow(2)).subtract(n.pow(2).divide(e));return t?r=r.divide(e):r=r.divide(e-1),r}var Nm=class extends Rs{static componentType="standarddeviation";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator.definition=({dependencyValues:e})=>({newValues:{numericOperator:function(n){return Math.sqrt(xm(n,e.population))}}}),t.mathOperator.definition=({dependencyValues:e})=>({newValues:{mathOperator:function(n){return ut.default.fromAst(["apply","sqrt",Cm(n,e.population).tree])}}}),t}},wm=class extends Kt{static componentType="count";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.isNumericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{isNumericOperator:!0}})},t.numericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericOperator:function(e){return e.length}}})},t}},Tm=class extends Kt{static componentType="min";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericOperator:function(e){return e.reduce((n,r)=>Math.min(n,r),Infinity)}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){return ut.default.fromAst(["apply","min",["tuple",...e.map(n=>n.tree)]])}}})},t}},_m=class extends Kt{static componentType="max";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericOperator:function(e){return e.reduce((n,r)=>Math.max(n,r),-Infinity)}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){return ut.default.fromAst(["apply","max",["tuple",...e.map(n=>n.tree)]])}}})},t}},Am=class extends Kt{static componentType="mod";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numericOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericOperator:function(e){return e.length!==2?NaN:ut.default.math.mod(e[0],e[1])}}})},t.mathOperator={returnDependencies:()=>({}),definition:()=>({newValues:{mathOperator:function(e){return e.length!==2?ut.default.fromAst("\uFF3F"):ut.default.fromAst(["apply","mod",["tuple",...e.map(n=>n.tree)]])}}})},t}};var Bs={};mt(Bs,{ClampFunction:()=>Sm,Derivative:()=>Vm,WrapFunctionPeriodic:()=>Dm});var gn=De(Ee());var ks=class extends Me{static componentType="function";static rendererType="math";static get stateVariablesShadowedForReference(){return["variable","numericalf","symbolicf","symbolic","isInterpolatedFunction","formula","prescribedPoints","prescribedMinima","prescribedMaxima","prescribedExtrema"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.simplify={default:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numberspreserveorder"]},e.expand={default:!1},e.xscale={default:1,propagateToDescendants:!0},e.yscale={default:1,propagateToDescendants:!0},e.label={default:"",forRenderer:!0},e.showLabel={default:!0,forRenderer:!0},e.layer={default:0,forRenderer:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions();return t.push({childrenRegex:/s/,replacementFunction:({matchedChildren:e})=>({success:!0,newChildren:[{componentType:"formula",doenetAttributes:{isPropertyChild:!0},children:e}]})}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneFormula",componentType:"formula",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"exactlyOneMinima",componentType:"minima",number:1,takePropertyChildren:!0}),i=e.newLeaf({name:"exactlyOneMaxima",componentType:"maxima",number:1,takePropertyChildren:!0}),a=e.newLeaf({name:"exactlyOneExtrema",componentType:"extrema",number:1,takePropertyChildren:!0}),s=e.newLeaf({name:"exactlyOneThrough",componentType:"through",number:1,takePropertyChildren:!0}),o=e.newLeaf({name:"exactlyOneThroughSlopes",componentType:"throughSlopes",number:1,takePropertyChildren:!0}),u=e.newOperator({name:"throughCriteria",operator:"or",propositions:[r,i,a,s,o]}),c=e.newLeaf({name:"atMostOneFunction",componentType:"function",comparison:"atMost",number:1}),f=e.newOperator({name:"functionXorFormula",operator:"xor",propositions:[c,n,u]}),p=e.newLeaf({name:"atMostOneVariable",componentType:"variable",comparison:"atMost",number:1,takePropertyChildren:!0}),d=e.newLeaf({name:"atMostOneSymbolic",componentType:"symbolic",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"formulaWithVariable",operator:"and",propositions:[p,f,d],setAsBase:!0}),e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions();return e.selectedStyle={forRenderer:!0,returnDependencies:()=>({styleNumber:{dependencyType:"stateVariable",variableName:"styleNumber"},ancestorWithStyle:{dependencyType:"ancestor",variableNames:["styleDefinitions"]}}),definition:function({dependencyValues:n}){let r=n.ancestorWithStyle.stateValues.styleDefinitions;r||(r=cn());let i;for(let a of r)n.styleNumber===a.styleNumber&&(i===void 0?i=a:i=Object.assign(Object.assign({},a),i));return i===void 0&&(i=r[0]),{newValues:{selectedStyle:i}}}},e.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:n}){let r="";return n.selectedStyle.lineWidth>=4?r+="thick ":n.selectedStyle.lineWidth<=1&&(r+="thin "),n.selectedStyle.lineStyle==="dashed"?r+="dashed ":n.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=n.selectedStyle.lineColor,{newValues:{styleDescription:r}}}},e.symbolic={public:!0,componentType:"boolean",defaultValue:!1,returnDependencies:()=>({symbolicChild:{dependencyType:"child",childLogicName:"atMostOneSymbolic",variableNames:["value"]},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction",variableNames:["symbolic"]}}),definition({dependencyValues:n}){return n.symbolicChild.length===1?{newValues:{symbolic:n.symbolicChild[0].stateValues.value}}:n.functionChild.length===1?{newValues:{symbolic:n.functionChild[0].stateValues.symbolic}}:{useEssentialOrDefaultValue:{symbolic:{variablesToCheck:["symbolic"]}}}}},e.isInterpolatedFunction={returnDependencies:()=>({throughCriteriaChildren:{dependencyType:"child",childLogicName:"throughCriteria"}}),definition({dependencyValues:n}){return{newValues:{isInterpolatedFunction:n.throughCriteriaChildren.length>0}}}},e.variable={public:!0,componentType:"variable",defaultValue:gn.default.fromAst("x"),returnDependencies:()=>({variableChild:{dependencyType:"child",childLogicName:"atMostOneVariable",variableNames:["value"]},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction",variableNames:["variable"]},parentVariableForChild:{dependencyType:"parentStateVariable",variableName:"variableForChild"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}),definition:function({dependencyValues:n,usedDefault:r}){return n.isInterpolatedFunction?{newValues:{variable:gn.default.fromAst("\uFF3F")}}:n.functionChild.length===1?(n.variableChild.length===1&&console.warn("Variable for function is ignored when it has a function child"),{newValues:{variable:n.functionChild[0].stateValues.variable}}):n.variableChild.length===1?{newValues:{variable:n.variableChild[0].stateValues.value}}:n.parentVariableForChild&&!r.parentVariableForChild?{newValues:{variable:n.parentVariableForChild}}:{useEssentialOrDefaultValue:{variable:{variablesToCheck:["variable"]}}}}},e.formula={public:!0,componentType:"formula",defaultValue:gn.default.fromAst(0),returnDependencies:()=>({formulaChild:{dependencyType:"child",childLogicName:"exactlyOneFormula",variableNames:["value"]},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction",variableNames:["formula"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}),definition:function({dependencyValues:n}){return n.isInterpolatedFunction?{newValues:{formula:gn.default.fromAst("\uFF3F")}}:n.formulaChild.length===1?{newValues:{formula:n.formulaChild[0].stateValues.value}}:n.functionChild.length===1?{newValues:{formula:n.functionChild[0].stateValues.formula}}:{useEssentialOrDefaultValue:{formula:{variablesToCheck:["formula"]}}}}},e.nPrescribedPoints={returnDependencies:()=>({throughChild:{dependencyType:"child",childLogicName:"exactlyOneThrough",variableNames:["nPoints"]}}),definition({dependencyValues:n}){let r=0;return n.throughChild.length===1&&(r=n.throughChild[0].stateValues.nPoints),{newValues:{nPrescribedPoints:r}}}},e.prescribedPoints={isArray:!0,entryPrefixes:["prescribedPoint"],returnArraySizeDependencies:()=>({nPrescribedPoints:{dependencyType:"stateVariable",variableName:"nPrescribedPoints"}}),returnArraySize({dependencyValues:n}){return[n.nPrescribedPoints]},returnArrayDependenciesByKey({arrayKeys:n}){let r={};for(let i of n){let a=Number(i)+1;r[i]={throughChild:{dependencyType:"child",childLogicName:"exactlyOneThrough",variableNames:["point"+a]},throughSlopesChild:{dependencyType:"child",childLogicName:"exactlyOneThroughSlopes",variableNames:["math"+a]}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].throughChild;if(s.length===1){let o=Number(a)+1,u=s[0].stateValues["point"+o],c=null,f=n[a].throughSlopesChild;f.length===1&&(c=f[0].stateValues["math"+o],c===void 0&&(c=null)),i[a]={x:u[0],y:u[1],slope:c}}}return{newValues:{prescribedPoints:i}}}},e.prescribedMinima={returnDependencies:()=>({minimaChild:{dependencyType:"child",childLogicName:"exactlyOneMinima",variableNames:["minima"]}}),definition({dependencyValues:n}){let r=[];return n.minimaChild.length==1&&(r=n.minimaChild[0].stateValues.minima.map(i=>({x:i[0],y:i[1]}))),{newValues:{prescribedMinima:r}}}},e.prescribedMaxima={returnDependencies:()=>({maximaChild:{dependencyType:"child",childLogicName:"exactlyOneMaxima",variableNames:["maxima"]}}),definition({dependencyValues:n}){let r=[];return n.maximaChild.length==1&&(r=n.maximaChild[0].stateValues.maxima.map(i=>({x:i[0],y:i[1]}))),{newValues:{prescribedMaxima:r}}}},e.prescribedExtrema={returnDependencies:()=>({extremaChild:{dependencyType:"child",childLogicName:"exactlyOneExtrema",variableNames:["extrema"]}}),definition({dependencyValues:n}){let r=[];return n.extremaChild.length==1&&(r=n.extremaChild[0].stateValues.extrema.map(i=>({x:i[0],y:i[1]}))),{newValues:{prescribedExtrema:r}}}},e.interpolationPoints={returnDependencies:()=>({xscale:{dependencyType:"stateVariable",variableName:"xscale"},yscale:{dependencyType:"stateVariable",variableName:"yscale"},prescribedPoints:{dependencyType:"stateVariable",variableName:"prescribedPoints"},prescribedMinima:{dependencyType:"stateVariable",variableName:"prescribedMinima"},prescribedMaxima:{dependencyType:"stateVariable",variableName:"prescribedMaxima"},prescribedExtrema:{dependencyType:"stateVariable",variableName:"prescribedExtrema"}}),definition:({dependencyValues:n})=>f1({dependencyValues:n,numerics:t})},e.xs={additionalStateVariablesDefined:["coeffs"],returnDependencies:()=>({interpolationPoints:{dependencyType:"stateVariable",variableName:"interpolationPoints"}}),definition:p1},e.symbolicf={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},interpolationPoints:{dependencyType:"stateVariable",variableName:"interpolationPoints"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}:{formula:{dependencyType:"stateVariable",variableName:"formula"},variable:{dependencyType:"stateVariable",variableName:"variable"},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction",variableNames:["symbolicf"]},simplify:{dependencyType:"stateVariable",variableName:"simplify"},expand:{dependencyType:"stateVariable",variableName:"expand"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}},definition:function({dependencyValues:n}){if(n.isInterpolatedFunction){let r=$m(n);return{newValues:{symbolicf:function(i){gn.default.fromAst(r(i.evaluate_to_constant()))}}}}else return n.functionChild.length===1?{newValues:{symbolicf:n.functionChild[0].stateValues.symbolicf}}:{newValues:{symbolicf:qi(n)}}}},e.numericalf={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},interpolationPoints:{dependencyType:"stateVariable",variableName:"interpolationPoints"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}:{formula:{dependencyType:"stateVariable",variableName:"formula"},variable:{dependencyType:"stateVariable",variableName:"variable"},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction",variableNames:["numericalf"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}},definition:function({dependencyValues:n}){return n.isInterpolatedFunction?{newValues:{numericalf:$m(n)}}:n.functionChild.length===1?{newValues:{numericalf:n.functionChild[0].stateValues.numericalf}}:{newValues:{numericalf:ji(n)}}}},e.f={returnDependencies:()=>({symbolic:{dependencyType:"stateVariable",variableName:"symbolic"},symbolicf:{dependencyType:"stateVariable",variableName:"symbolicf"},numericalf:{dependencyType:"stateVariable",variableName:"numericalf"}}),definition:function({dependencyValues:n}){return n.symbolic?{newValues:{f:n.symbolicf}}:{newValues:{f:n.numericalf}}}},e.latex={public:!0,componentType:"text",returnDependencies:()=>({formula:{dependencyType:"stateVariable",variableName:"formula"}}),definition:function({dependencyValues:n}){return{newValues:{latex:n.formula.toLatex()}}}},e.latexWithInputChildren={forRenderer:!0,returnDependencies:()=>({latex:{dependencyType:"stateVariable",variableName:"latex"}}),definition:function({dependencyValues:n}){return{newValues:{latexWithInputChildren:[n.latex]}}}},e.allMinima={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}:{numericalf:{dependencyType:"stateVariable",variableName:"numericalf"},xscale:{dependencyType:"stateVariable",variableName:"xscale"},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction",variableNames:["allMinima"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}},definition:function({dependencyValues:n,componentName:r}){if(n.isInterpolatedFunction){let i=n.xs,a=n.coeffs,s=t.eps,o=[];if(i===null)return{newValues:{allMinima:o}};let u=!1,c=a[0],f=i[1]-i[0];if(c[3]===0){if(c[2]>0){let p=-c[1]/(2*c[2]);p<=f-s?o.push([p+i[0],((c[3]*p+c[2])*p+c[1])*p+c[0]]):Math.abs(p-f)<s&&(u=!0)}}else{let p=4*c[2]*c[2]-12*c[3]*c[1];if(p>0){let d=Math.sqrt(p),m=(-2*c[2]+d)/(6*c[3]);m<=f-s?o.push([m+i[0],((c[3]*m+c[2])*m+c[1])*m+c[0]]):Math.abs(m-f)<s&&(u=!0)}}for(let p=1;p<i.length-2;p++)if(c=a[p],f=i[p+1]-i[p],c[3]===0)if(c[2]>0){let d=-c[1]/(2*c[2]);Math.abs(d)<s?u&&o.push([d+i[p],((c[3]*d+c[2])*d+c[1])*d+c[0]]):d>=s&&d<=f-s&&o.push([d+i[p],((c[3]*d+c[2])*d+c[1])*d+c[0]]),u=Math.abs(d-f)<s}else u=!1;else{let d=4*c[2]*c[2]-12*c[3]*c[1];if(d>0){let m=Math.sqrt(d),v=(-2*c[2]+m)/(6*c[3]);Math.abs(v)<s?u&&o.push([v+i[p],((c[3]*v+c[2])*v+c[1])*v+c[0]]):v>=s&&v<=f-s&&o.push([v+i[p],((c[3]*v+c[2])*v+c[1])*v+c[0]]),u=Math.abs(v-f)<s}else u=!1}if(c=a[i.length-2],c[3]===0){if(c[2]>0){let p=-c[1]/(2*c[2]);Math.abs(p)<s?u&&o.push([p+i[i.length-2],((c[3]*p+c[2])*p+c[1])*p+c[0]]):p>=s&&o.push([p+i[i.length-2],((c[3]*p+c[2])*p+c[1])*p+c[0]])}}else{let p=4*c[2]*c[2]-12*c[3]*c[1];if(p>0){let d=Math.sqrt(p),m=(-2*c[2]+d)/(6*c[3]);m>=s?o.push([m+i[i.length-2],((c[3]*m+c[2])*m+c[1])*m+c[0]]):Math.abs(m)<s&&u&&o.push([m+i[i.length-2],((c[3]*m+c[2])*m+c[1])*m+c[0]])}}return{newValues:{allMinima:o}}}else{if(n.functionChild&&n.functionChild.length===1)return{newValues:{allMinima:n.functionChild[0].stateValues.allMinima}};let i=n.numericalf,a=-100*n.xscale,s=100*n.xscale,o=1e3,u=(s-a)/o,c=[],f=!1,p=i(a);for(let d=0;d<o;d++){let m=a+d*u,v=a+(d+1)*u,h=p;if(p=i(v),Number.isNaN(h)||Number.isNaN(p))continue;let y=t.fminbr(i,[m,v]);if(y.success!==!0)continue;let g=y.x,b=y.fx;h<b?(f&&Number.isFinite(h)&&c.push([m,h]),f=!1):p<b?f=!0:(f=!1,b<p&&b<h&&b<i(g+y.tol)&&b<i(g-y.tol)&&Number.isFinite(b)&&c.push([g,b]))}return{newValues:{allMinima:c}}}}},e.numberMinima={public:!0,componentType:"number",returnDependencies:()=>({allMinima:{dependencyType:"stateVariable",variableName:"allMinima"}}),definition({dependencyValues:n}){return{newValues:{numberMinima:n.allMinima.length},checkForActualChange:{numberMinima:!0}}}},e.minima={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["minimum","minimumLocations","minimumLocation","minimumValues","minimumValue"],returnWrappingComponents(n){return n==="minimum"||n===void 0?[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]:[]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:r,arraySize:i}){if(["minimum","minimumLocation","minimumValue"].includes(n)){let a=Number(r)-1;return Number.isInteger(a)&&a>=0?!i||a<i[0]?n==="minimum"?[a+",0",a+",1"]:n==="minimumLocation"?[a+",0"]:[a+",1"]:[]:[]}else return n==="minimumLocations"?!i||r!==""?[]:Array.from(Array(i[0]),(a,s)=>s+",0"):n==="minimumValues"?!i||r!==""?[]:Array.from(Array(i[0]),(a,s)=>s+",1"):[]},arrayVarNameFromArrayKey(n){let[r,i]=n.split(",");return i==="0"?"minimumLocation"+(Number(r)+1):"minimumValue"+(Number(r)+1)},returnArraySizeDependencies:()=>({numberMinima:{dependencyType:"stateVariable",variableName:"numberMinima"}}),returnArraySize({dependencyValues:n}){return[n.numberMinima,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allMinima:{dependencyType:"stateVariable",variableName:"allMinima"}}}},arrayDefinitionByKey({globalDependencyValues:n}){let r={};for(let i=0;i<n.__array_size[0];i++)for(let a=0;a<2;a++){let s=`${i},${a}`;r[s]=n.allMinima[i][a]}return{newValues:{minima:r}}}},e.allMaxima={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}:{numericalf:{dependencyType:"stateVariable",variableName:"numericalf"},xscale:{dependencyType:"stateVariable",variableName:"xscale"},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction",variableNames:["allMaxima"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}},definition:function({dependencyValues:n}){if(n.isInterpolatedFunction){let r=n.xs,i=n.coeffs,a=t.eps,s=[];if(r===null)return{newValues:{allMaxima:s}};let o=!1,u=i[0],c=r[1]-r[0];if(u[3]===0){if(u[2]<0){let f=-u[1]/(2*u[2]);f<=c-a?s.push([f+r[0],((u[3]*f+u[2])*f+u[1])*f+u[0]]):Math.abs(f-c)<a&&(o=!0)}}else{let f=4*u[2]*u[2]-12*u[3]*u[1];if(f>0){let p=Math.sqrt(f),d=(-2*u[2]-p)/(6*u[3]);d<=c-a?s.push([d+r[0],((u[3]*d+u[2])*d+u[1])*d+u[0]]):Math.abs(d-c)<a&&(o=!0)}}for(let f=1;f<r.length-2;f++)if(u=i[f],c=r[f+1]-r[f],u[3]===0)if(u[2]<0){let p=-u[1]/(2*u[2]);Math.abs(p)<a?o&&s.push([p+r[f],((u[3]*p+u[2])*p+u[1])*p+u[0]]):p>=a&&p<=c-a&&s.push([p+r[f],((u[3]*p+u[2])*p+u[1])*p+u[0]]),o=Math.abs(p-c)<a}else o=!1;else{let p=4*u[2]*u[2]-12*u[3]*u[1];if(p>0){let d=Math.sqrt(p),m=(-2*u[2]-d)/(6*u[3]);Math.abs(m)<a?o&&s.push([m+r[f],((u[3]*m+u[2])*m+u[1])*m+u[0]]):m>=a&&m<=c-a&&s.push([m+r[f],((u[3]*m+u[2])*m+u[1])*m+u[0]]),o=Math.abs(m-c)<a}else o=!1}if(u=i[r.length-2],u[3]===0){if(u[2]<0){let f=-u[1]/(2*u[2]);Math.abs(f)<a?o&&s.push([f+r[r.length-2],((u[3]*f+u[2])*f+u[1])*f+u[0]]):f>=a&&s.push([f+r[r.length-2],((u[3]*f+u[2])*f+u[1])*f+u[0]])}}else{let f=4*u[2]*u[2]-12*u[3]*u[1];if(f>0){let p=Math.sqrt(f),d=(-2*u[2]-p)/(6*u[3]);d>=a?s.push([d+r[r.length-2],((u[3]*d+u[2])*d+u[1])*d+u[0]]):Math.abs(d)<a&&o&&s.push([d+r[r.length-2],((u[3]*d+u[2])*d+u[1])*d+u[0]])}}return{newValues:{allMaxima:s}}}else{if(n.functionChild&&n.functionChild.length===1)return{newValues:{allMaxima:n.functionChild[0].stateValues.allMaxima}};let r=p=>-n.numericalf(p),i=-100*n.xscale,a=100*n.xscale,s=1e3,o=(a-i)/s,u=[],c=!1,f=r(i);for(let p=0;p<s;p++){let d=i+p*o,m=i+(p+1)*o,v=f;if(f=r(m),Number.isNaN(v)||Number.isNaN(f))continue;let h=t.fminbr(r,[d,m]);if(h.success!==!0)continue;let y=h.x,g=h.fx;v<g?(c&&Number.isFinite(v)&&u.push([d,-v]),c=!1):f<g?c=!0:(c=!1,g<f&&g<v&&g<r(y+h.tol)&&g<r(y-h.tol)&&Number.isFinite(g)&&u.push([y,-g]))}return{newValues:{allMaxima:u}}}}},e.numberMaxima={public:!0,componentType:"number",returnDependencies:()=>({allMaxima:{dependencyType:"stateVariable",variableName:"allMaxima"}}),definition({dependencyValues:n}){return{newValues:{numberMaxima:n.allMaxima.length},checkForActualChange:{numberMaxima:!0}}}},e.maxima={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["maximum","maximumLocations","maximumLocation","maximumValues","maximumValue"],returnWrappingComponents(n){return n==="maximum"||n===void 0?[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]:[]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:r,arraySize:i}){if(["maximum","maximumLocation","maximumValue"].includes(n)){let a=Number(r)-1;return Number.isInteger(a)&&a>=0?!i||a<i[0]?n==="maximum"?[a+",0",a+",1"]:n==="maximumLocation"?[a+",0"]:[a+",1"]:[]:[]}else return n==="maximumLocations"?!i||r!==""?[]:Array.from(Array(i[0]),(a,s)=>s+",0"):n==="maximumValues"?!i||r!==""?[]:Array.from(Array(i[0]),(a,s)=>s+",1"):[]},arrayVarNameFromArrayKey(n){let[r,i]=n.split(",");return i==="0"?"maximumLocation"+(Number(r)+1):"maximumValue"+(Number(r)+1)},returnArraySizeDependencies:()=>({numberMaxima:{dependencyType:"stateVariable",variableName:"numberMaxima"}}),returnArraySize({dependencyValues:n}){return[n.numberMaxima,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allMaxima:{dependencyType:"stateVariable",variableName:"allMaxima"}}}},arrayDefinitionByKey({globalDependencyValues:n}){let r={};for(let i=0;i<n.__array_size[0];i++)for(let a=0;a<2;a++){let s=`${i},${a}`;r[s]=n.allMaxima[i][a]}return{newValues:{maxima:r}}}},e.numberExtrema={public:!0,componentType:"number",returnDependencies:()=>({numberMinima:{dependencyType:"stateVariable",variableName:"numberMinima"},numberMaxima:{dependencyType:"stateVariable",variableName:"numberMaxima"}}),definition:function({dependencyValues:n}){return{newValues:{numberExtrema:n.numberMinima+n.numberMaxima},checkForActualChange:{numberExtrema:!0}}}},e.allExtrema={returnDependencies:()=>({allMinima:{dependencyType:"stateVariable",variableName:"allMinima"},allMaxima:{dependencyType:"stateVariable",variableName:"allMaxima"}}),definition({dependencyValues:n}){return{newValues:{allExtrema:[...n.allMinima,...n.allMaxima].sort((i,a)=>i[0]-a[0])}}}},e.extrema={public:!0,componentType:"number",isArray:!0,nDimensions:2,entryPrefixes:["extremum","extremumLocations","extremumLocation","extremumValues","extremumValue"],returnWrappingComponents(n){return n==="extremum"||n===void 0?[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]:[]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:r,arraySize:i}){if(["extremum","extremumLocation","extremumValue"].includes(n)){let a=Number(r)-1;return Number.isInteger(a)&&a>=0?!i||a<i[0]?n==="extremum"?[a+",0",a+",1"]:n==="extremumLocation"?[a+",0"]:[a+",1"]:[]:[]}else return n==="extremumLocations"?!i||r!==""?[]:Array.from(Array(i[0]),(a,s)=>s+",0"):n==="extremumValues"?!i||r!==""?[]:Array.from(Array(i[0]),(a,s)=>s+",1"):[]},arrayVarNameFromArrayKey(n){let[r,i]=n.split(",");return i==="0"?"extremumLocation"+(Number(r)+1):"extremumValue"+(Number(r)+1)},returnArraySizeDependencies:()=>({numberExtrema:{dependencyType:"stateVariable",variableName:"numberExtrema"}}),returnArraySize({dependencyValues:n}){return[n.numberExtrema,2]},returnArrayDependenciesByKey(){return{globalDependencies:{allExtrema:{dependencyType:"stateVariable",variableName:"allExtrema"}}}},arrayDefinitionByKey({globalDependencyValues:n}){let r={};for(let i=0;i<n.__array_size[0];i++)for(let a=0;a<2;a++){let s=`${i},${a}`;r[s]=n.allExtrema[i][a]}return{newValues:{extrema:r}}}},e.functionChild={returnDependencies:()=>({functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction"}}),definition:function({dependencyValues:n}){return n.functionChild.length===1?{newValues:{functionChild:n.functionChild[0]}}:{newValues:{functionChild:null}}}},e.returnNumericalDerivatives={stateVariablesDeterminingDependencies:["isInterpolatedFunction"],returnDependencies({stateValues:n}){return n.isInterpolatedFunction?{xs:{dependencyType:"stateVariable",variableName:"xs"},coeffs:{dependencyType:"stateVariable",variableName:"coeffs"},interpolationPoints:{dependencyType:"stateVariable",variableName:"interpolationPoints"},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}:{functionChild:{dependencyType:"child",childLogicName:"atMostOneFunction",variableNames:["returnNumericalDerivatives"]},isInterpolatedFunction:{dependencyType:"stateVariable",variableName:"isInterpolatedFunction"}}},definition:function({dependencyValues:n}){return n.isInterpolatedFunction?{newValues:{returnNumericalDerivatives:d1(n)}}:n.functionChild.length===1&&n.functionChild[0].stateValues.returnNumericalDerivatives?{newValues:{returnNumericalDerivatives:n.functionChild[0].stateValues.returnNumericalDerivatives}}:{newValues:{returnNumericalDerivatives:null}}}},e}adapters=[{stateVariable:"numericalf",componentType:"curve"},{stateVariable:"formula",componentType:"math"}]},Ui=ks;function qi(l){let t=l.formula,e=l.variable.tree,n=l.simplify,r=l.expand;return i=>er({value:t.substitute({[e]:i}),simplify:n,expand:r})}function ji(l){let t;try{t=l.formula.f()}catch(n){t=()=>NaN}let e=l.variable.tree;return function(n){try{return t({[e]:n})}catch(r){return NaN}}}function f1({dependencyValues:l,numerics:t}){let e=[],n=[],r={maximum:l.prescribedMaxima,minimum:l.prescribedMinima,extremum:l.prescribedExtrema,point:l.prescribedPoints};for(let N in r)for(let C of r[N]){let _=null,w=null,A=null;if(C.x!==null&&(_=C.x.evaluate_to_constant(),!Number.isFinite(_))){console.warn(`Ignoring non-numerical ${N}`);continue}if(C.y!==null&&(w=C.y.evaluate_to_constant(),!Number.isFinite(w))){console.warn(`Ignoring non-numerical ${N}`);continue}if(C.slope!==null&&C.slope!==void 0&&(A=C.slope.evaluate_to_constant(),Number.isFinite(A)||(console.warn("Ignoring non-numerical slope"),A=null)),_===null){if(w===null){console.warn(`Ignoring empty ${N}`);continue}n.push({type:N,y:w,slope:A})}else e.push({type:N,x:_,y:w,slope:A})}e.sort((N,C)=>N.x-C.x),n.sort((N,C)=>N.y-C.y);let i=-Infinity,a=t.eps;for(let N=0;N<e.length;N++){let C=e[N];if(C.x<=i+a)return console.warn("Two points with locations too close together.  Can't define function"),{newValues:{interpolationPoints:null}};i=C.x}let s=l.xscale,o=l.yscale;i=void 0;let u,c,f=[],p=e[0];for(let N=0;N<e.length;N++){let C=p;p=e[N+1];let _=h({p:C,pNext:p,typePrev:c,xPrev:i,yPrev:u});c=_.type,i=_.x,u=_.y}let d=!1;for(e.length===0&&(d=!0);n.length>0;){let N;c===void 0?N=x({allowedTypes:["maximum","minimum","extremum"],comparison:"atLeast",value:-Infinity}):c==="maximum"?N=x({allowedTypes:["minimum","extremum"],comparison:"atMost",value:u-o}):c==="minimum"?N=x({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:u+o}):c==="point"&&(N=x({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:u+o}),N.success!==!0&&(N=x({allowedTypes:["minimum","extremum"],comparison:"atMost",value:u-o})));let C;N.success===!0?(C=N.point,n.splice(N.ind,1),d?(C.x=0,d=!1):C.x=i+s):(C=n.pop(),d?(C.x=0,d=!1):C.x=i+2*s);let _=h({p:C,typePrev:c,xPrev:i,yPrev:u});c=_.type,i=_.x,u=_.y}if(f.length===0&&f.push({type:"point",x:0,y:0,slope:0}),d=f[0],d.type==="maximum"){let N={type:"point",x:d.x-s,y:d.y-o,slope:2*o/s};f.splice(0,0,N)}else if(d.type==="minimum"){let N={type:"point",x:d.x-s,y:d.y+o,slope:-2*o/s};f.splice(0,0,N)}else if(d.type==="point")if(f.length===1)d.slope===null&&(d.slope=0);else{let N=f[1],C=(N.y-d.y)/(N.x-d.x);if(N.type==="maximum"||N.type==="minimum")d.slope===null&&(d.slope=2*C);else{f.length===2?d.slope===null&&(d.slope=C):(N.slope===null&&(N.slope=v({point:N,prevPoint:d,nextPoint:f[2]})),d.slope===null&&(d.slope=2*(d.y-N.y)/(d.x-N.x)-N.slope));let _={x:d.x-s,y:d.y-s*d.slope,slope:d.slope};f.splice(0,0,_)}}let m=f[f.length-1];if(m.type==="maximum"){let N={type:"point",x:m.x+s,y:m.y-o,slope:-2*o/s};f.push(N)}else if(m.type==="minimum"){let N={type:"point",x:m.x+s,y:m.y+o,slope:2*o/s};f.push(N)}else if(m.type==="point")if(f.length===1){let N={type:"point",x:m.x+s,y:m.y+d.slope*s,slope:d.slope};f.push(N)}else{let N=f[f.length-2],C=(N.y-m.y)/(N.x-m.x);if(N.type==="maximum"||N.type==="minimum")m.slope===null&&(m.slope=2*C);else{f.length===2?m.slope===null&&(m.slope=C):(N.slope===null&&(N.slope=v({point:N,prevPoint:f[f.length-3],nextPoint:m})),m.slope===null&&(m.slope=2*(N.y-m.y)/(N.x-m.x)-N.slope));let _={x:m.x+s,y:m.y+s*m.slope,slope:m.slope};f.push(_)}}for(let N=1;N<f.length-1;N++){let C=f[N];C.slope===null&&(C.slope=v({point:C,prevPoint:f[N-1],nextPoint:f[N+1]}))}return{newValues:{interpolationPoints:f}};function v({point:N,prevPoint:C,nextPoint:_}){let w=N.x-C.x,A=_.x-N.x,$=N.y-C.y,S=_.y-N.y,D=$/w,V=S/A,I=(D*A+V*w)/(w+A);return(Math.sign(D)+Math.sign(V))*Math.min(Math.abs(D),Math.abs(V),.5*Math.abs(I))}function h({p:N,pNext:C,typePrev:_,xPrev:w,yPrev:A}){let $;if(C!==void 0&&($=C.y),N.type==="maximum")return y({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C});if(N.type==="minimum")return g({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C});if(N.type==="extremum"){let S;if(_===void 0){if(C===void 0)return y({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C});S=C.type}if(_==="maximum"||S==="maximum")return N.y!==null&&N.y>A-o?y({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C}):S!==void 0&&N.y!==null&&N.y>C.y-o?y({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C}):g({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C});if(_==="minimum"||S==="minimum")return N.y!==null&&N.y<A+o?g({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C}):S!==void 0&&N.y!==null&&N.y>C.y+o?g({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C}):y({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C});if(_==="point"||S==="point"){let D="maximum";return(N.y===null&&C!==void 0&&C.type===maximum||N.y!==null&&N.y<=A-o||S!==void 0&&N.y!==null&&N.y>=C.y-o)&&(D="minimum"),D==="minimum"?g({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C}):y({x:N.x,y:N.y,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C})}}else if(N.type==="point")return b({x:N.x,y:N.y,slope:N.slope,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:C})}function y({x:N,y:C,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:S}){if(_===void 0)C===null&&($===void 0?C=0:S.type==="maximum"?C=$:C=$+o);else if(_==="maximum"){C===null&&($===void 0?C=A:S.type==="maximum"?C=Math.max(A,$):C=Math.max(A,$+o));let V=Math.min(A,C)-o,I=(N+w)/2,q,K,E=null,W=x({allowedTypes:["minimum","extremum"],comparison:"atMost",value:V});W.success===!0?(K="minimum",q=W.point.y,n.splice(W.ind,1),E=0):(K="point",q=V),f.push({type:K,x:I,y:q,slope:E})}else if(_==="minimum"){if(C===null)$===void 0?C=A+o:S.type==="maximum"?C=Math.max(A+o,$):C=Math.max(A,$)+o;else if(C<A+o){let V=[(2*w+N)/3,(w+2*N)/3],I=[A+o,C-o],q=["atLeast","atMost"],K=[["maximum","extremum"],["minimum","extremum"]];for(let E=0;E<2;E++){let W=V[E],G,P,Q=null,ne=x({allowedTypes:K[E],comparison:q[E],value:I[E]});ne.success===!0?(P=K[E][0],G=ne.point.y,n.splice(ne.ind,1),Q=0):(P="point",G=I[E],Q=null),f.push({type:P,x:W,y:G,slope:Q})}}}else if(_==="point"){if(C===null)$===void 0?C=A+o:S.type==="maximum"?C=Math.max(A+o,$):C=Math.max(A,$)+o;else if(C<A+o){let V=(N+w)/2,I,q,K=null,E=x({allowedTypes:["minimum","extremum"],comparison:"atMost",value:C-o});E.success===!0?(q="minimum",I=E.point.y,n.splice(E.ind,1),K=0):(q="point",I=C-o),f.push({type:q,x:V,y:I,slope:K})}}let D={type:"maximum",x:N,y:C,slope:0};return f.push(D),D}function g({x:N,y:C,typePrev:_,xPrev:w,yPrev:A,yNext:$,pNext:S}){if(_===void 0)C===null&&($===void 0?C=0:S.type==="minimum"?C=$:C=$-o);else if(_==="maximum"){if(C===null)$===void 0?C=A-o:S.type==="minimum"?C=Math.min(A-o,$):C=Math.min(A,$)-o;else if(C>A-o){let V=[(2*w+N)/3,(w+2*N)/3],I=[A-o,C+o],q=["atMost","atLeast"],K=[["minimum","extremum"],["maximum","extremum"]];for(let E=0;E<2;E++){let W=V[E],G,P,Q=null,ne=x({allowedTypes:K[E],comparison:q[E],value:I[E]});ne.success===!0?(P=K[E][0],G=ne.point.y,n.splice(ne.ind,1),Q=0):(P="point",G=I[E],Q=null),f.push({type:P,x:W,y:G,slope:Q})}}}else if(_==="minimum"){C===null&&($===void 0?C=A:S.type==="minimum"?C=Math.min(A,$):C=Math.min(A,$-o));let V=Math.max(A,C)+o,I=(N+w)/2,q,K,E=null,W=x({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:V});W.success===!0?(K="maximum",q=W.point.y,n.splice(W.ind,1),E=0):(K="point",q=V),f.push({type:K,x:I,y:q,slope:E})}else if(_==="point"){if(C===null)$===void 0?C=A-o:S.type==="minimum"?C=Math.min(A-o,$):C=Math.min(A,$)-o;else if(C>A-o){let V=(N+w)/2,I,q,K=null,E=x({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:C+o});E.success===!0?(q="maximum",I=E.point.y,n.splice(E.ind,1),K=0):(q="point",I=C+o),f.push({type:q,x:V,y:I,slope:K})}}let D={type:"minimum",x:N,y:C,slope:0};return f.push(D),D}function b({x:N,y:C,slope:_,typePrev:w,xPrev:A,yPrev:$,yNext:S,pNext:D}){if(w==="maximum"){if(C>$-o){let I=Math.min($,C)-o,q=(N+A)/2,K,E,W=null,G=x({allowedTypes:["minimum","extremum"],comparison:"atMost",value:I});G.success===!0?(E="minimum",K=G.point.y,n.splice(G.ind,1),W=0):(E="point",K=$-o),f.push({type:E,x:q,y:K,slope:W})}}else if(w==="minimum"&&C<$+o){let I=Math.max($,C)+o,q=(N+A)/2,K,E,W=null,G=x({allowedTypes:["maximum","extremum"],comparison:"atLeast",value:I});G.success===!0?(E="maximum",K=G.point.y,n.splice(G.ind,1),W=0):(E="point",K=$+o),f.push({type:E,x:q,y:K,slope:W})}let V={type:"point",x:N,y:C,slope:_};return f.push(V),V}function x({allowedTypes:N,comparison:C,value:_}){let w=[];if(C==="atMost")w=Object.keys(n).reverse();else if(C==="atLeast")w=Object.keys(n);else return{success:!1};for(let A of N)for(let $ of w){let S=n[$];if(S.type===A){if(C==="atMost"){if(S.y<=_)return{success:!0,ind:$,point:S}}else if(S.y>=_)return{success:!0,ind:$,point:S}}}return{success:!1}}}function p1({dependencyValues:l}){let t=function(s,o,u,c,f){return[s,u,(-3*s/f+3*o/f-2*u-c)/f,(2*s/f-2*o/f+u+c)/(f*f)]},e=l.interpolationPoints;if(e===null)return{newValues:{xs:null,coeffs:null}};let n=[],r=[],i,a=e[0];r.push(a.x);for(let s=1;s<e.length;s++){i=a,a=e[s];let o=t(i.y,a.y,i.slope,a.slope,a.x-i.x);Math.abs(o[3])<1e-14*Math.max(Math.abs(o[0]),Math.abs(o[1]),Math.abs(o[2]))&&(o[3]=0,Math.abs(o[2])<1e-14*Math.max(Math.abs(o[0]),Math.abs(o[1]))&&(o[2]=0)),n.push(o),r.push(a.x)}return{newValues:{xs:r,coeffs:n}}}function $m(l){let t=l.xs,e=l.coeffs,n=[];if(l.interpolationPoints&&(n=l.interpolationPoints.map(a=>a.y)),t===null)return a=>NaN;let r=t[0],i=t[t.length-1];return function(a){if(isNaN(a))return NaN;if(a<=r){a-=r;let p=e[0];return((p[3]*a+p[2])*a+p[1])*a+p[0]}if(a>=i){let p=t.length-2;a-=t[p];let d=e[p];return((d[3]*a+d[2])*a+d[1])*a+d[0]}for(var s=0,o,u=t.length-1;s<=u;){o=Math.floor(.5*(s+u));let p=t[o];if(p<a)s=o+1;else if(p>a)u=o-1;else return n[o]}let c=Math.max(0,u);a-=t[c];let f=e[c];return((f[3]*a+f[2])*a+f[1])*a+f[0]}}function d1(l){let t=l.xs,e=l.coeffs,n=t[0],r=t[t.length-1];return function(i=1){return i>3?a=>0:i<1||!Number.isInteger(i)||t==null?a=>NaN:function(a){if(isNaN(a))return NaN;if(a<=n){a-=n;let p=e[0];return i===1?(3*p[3]*a+2*p[2])*a+p[1]:i===2?6*p[3]*a+2*p[2]:6*p[3]}if(a>=r){let p=t.length-2;a-=t[p];let d=e[p];return i===1?(3*d[3]*a+2*d[2])*a+d[1]:i===2?6*d[3]*a+2*d[2]:6*d[3]}for(var s=0,o,u=t.length-1;s<=u;){o=Math.floor(.5*(s+u));let p=t[o];if(p<a)s=o+1;else if(p>a)u=o-1;else return i===1?e[o][1]:i===2?2*e[o][2]:6*e[o][3]}let c=Math.max(0,u);a-=t[c];let f=e[c];return i===1?(3*f[3]*a+2*f[2])*a+f[1]:i===2?6*f[3]*a+2*f[2]:6*f[3]}}}var bn=De(Ee()),Fs=class extends Ui{static componentType="_functionoperator";static returnSugarInstructions(){let t=[];return t.push({childrenRegex:/s/,replacementFunction:({matchedChildren:e})=>({success:!0,newChildren:[{componentType:"math",children:e}]})}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();let n=e.newLeaf({name:"exactlyOneMath",componentType:"math",number:1}),r=e.newLeaf({name:"atMostOneFunctionForOperator",componentType:"function",comparison:"atMost",number:1}),i=e.newOperator({name:"functionXorMath",operator:"xor",propositions:[n,r]}),a=e.newLeaf({name:"atMostOneVariable",componentType:"variable",comparison:"atMost",number:1,takePropertyChildren:!0}),s=e.newLeaf({name:"atMostOneSymbolic",componentType:"symbolic",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"functionAndVariable",operator:"and",propositions:[i,a,s],setAsBase:!0}),e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});e.isInterpolatedFunction={returnDependencies:()=>({}),definition:()=>({newValues:{isInterpolatedFunction:!1}})},delete e.nPrescribedPoints,delete e.prescribedPoints,delete e.prescribedMinima,delete e.prescribedMaxima,delete e.prescribedExtrema,delete e.interpolationPoints,delete e.xs;let n=e.variable.returnDependencies;e.variable.returnDependencies=function(){let i=n();return i.functionChild.childLogicName="atMostOneFunctionForOperator",i};let r=e.symbolic.returnDependencies;return e.symbolic.returnDependencies=function(){let i=r();return i.functionChild.childLogicName="atMostOneFunctionForOperator",i},e.operatorBasedOnFormulaIfAvailable={returnDependencies:()=>({}),definition:()=>({newValues:{operatorBasedOnFormulaIfAvailable:!1}})},e.formula.returnDependencies=()=>({}),e.formula.definition=()=>({newValues:{formula:bn.default.fromAst("\uFF3F")}}),e.operatorComposesWithOriginal={returnDependencies:()=>({}),definition:()=>({newValues:{operatorComposesWithOriginal:!0}})},e.symbolicFunctionOperator={returnDependencies:()=>({}),definition:()=>({newValues:{symbolicFunctionOperator:i=>bn.default.fromAst("\uFF3F")}})},e.numericalFunctionOperator={returnDependencies:()=>({}),definition:()=>({newValues:{numericalFunctionOperator:i=>NaN}})},e.formulaOperator={returnDependencies:()=>({}),definition:()=>({newValues:{formulaOperator:i=>bn.default.fromAst("\uFF3F")}})},e.returnNumericalDerivatives={returnDependencies:()=>({}),definition:()=>({newValues:{returnNumericalDerivatives:null}})},e.formula={public:!0,componentType:"formula",additionalStateVariablesDefined:["operatorBasedOnFormula"],returnDependencies:()=>({operatorBasedOnFormulaIfAvailable:{dependencyType:"stateVariable",variableName:"operatorBasedOnFormulaIfAvailable"},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunctionForOperator",variableNames:["formula"]},mathChild:{dependencyType:"child",childLogicName:"exactlyOneMath",variableNames:["value"]},formulaOperator:{dependencyType:"stateVariable",variableName:"formulaOperator"}}),definition:function({dependencyValues:i}){if(!i.operatorBasedOnFormulaIfAvailable||(i.functionChild.length===0||i.functionChild[0].stateValues.formula.tree==="\uFF3F")&&(i.mathChild.length===0||i.mathChild[0].stateValues.value.tree==="\uFF3F"))return{newValues:{formula:bn.default.fromAst("\uFF3F"),operatorBasedOnFormula:!1}};let a;return i.functionChild.length===0?a=i.mathChild[0].stateValues.value:a=i.functionChild[0].stateValues.formula,{newValues:{formula:i.formulaOperator(a),operatorBasedOnFormula:!0}}}},e.symbolicf={returnDependencies:()=>({operatorBasedOnFormula:{dependencyType:"stateVariable",variableName:"operatorBasedOnFormula"},formula:{dependencyType:"stateVariable",variableName:"formula"},variable:{dependencyType:"stateVariable",variableName:"variable"},simplify:{dependencyType:"stateVariable",variableName:"simplify"},expand:{dependencyType:"stateVariable",variableName:"expand"},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunctionForOperator",variableNames:["symbolicf"]},mathChild:{dependencyType:"child",childLogicName:"exactlyOneMath",variableNames:["value"]},symbolicFunctionOperator:{dependencyType:"stateVariable",variableName:"symbolicFunctionOperator"},operatorComposesWithOriginal:{dependencyType:"stateVariable",variableName:"operatorComposesWithOriginal"}}),definition:function({dependencyValues:i}){if(i.operatorBasedOnFormula)return{newValues:{symbolicf:qi(i)}};if(i.operatorComposesWithOriginal)if(i.functionChild.length===0){if(i.mathChild.length===0)return{newValues:{symbolicf:a=>bn.default.fromAst("\uFF3F")}};{let a=Object.assign({},i);a.formula=i.mathChild[0].stateValues.value;let s=qi(i);return{newValues:{symbolicf:o=>i.symbolicFunctionOperator(s(o))}}}}else{let a=i.functionChild[0].stateValues.symbolicf;return{newValues:{symbolicf:s=>i.symbolicFunctionOperator(a(s))}}}else return{newValues:{symbolicf:function(a){return i.symbolicFunctionOperator(a)}}}}},e.numericalf={returnDependencies:()=>({operatorBasedOnFormula:{dependencyType:"stateVariable",variableName:"operatorBasedOnFormula"},formula:{dependencyType:"stateVariable",variableName:"formula"},variable:{dependencyType:"stateVariable",variableName:"variable"},functionChild:{dependencyType:"child",childLogicName:"atMostOneFunctionForOperator",variableNames:["numericalf"]},mathChild:{dependencyType:"child",childLogicName:"exactlyOneMath",variableNames:["value"]},numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"},operatorComposesWithOriginal:{dependencyType:"stateVariable",variableName:"operatorComposesWithOriginal"}}),definition:function({dependencyValues:i}){if(i.operatorBasedOnFormula)return{newValues:{numericalf:ji(i)}};if(i.operatorComposesWithOriginal)if(i.functionChild.length===0){if(i.mathChild.length===0)return{newValues:{numericalf:a=>NaN}};{let a=Object.assign({},i);a.formula=i.mathChild[0].stateValues.value;let s=ji(i);return{newValues:{numericalf:o=>i.numericalFunctionOperator(s(o))}}}}else{let a=i.functionChild[0].stateValues.numericalf;return{newValues:{numericalf:s=>i.numericalFunctionOperator(a(s))}}}else return{newValues:{numericalf:function(a){return i.numericalFunctionOperator(a)}}}}},e.functionChild={returnDependencies:()=>({}),definition:()=>({newValues:{functionChild:null}})},e.allMinima.returnDependencies=()=>({numericalf:{dependencyType:"stateVariable",variableName:"numericalf"},xscale:{dependencyType:"stateVariable",variableName:"xscale"}}),e.allMaxima.returnDependencies=()=>({numericalf:{dependencyType:"stateVariable",variableName:"numericalf"},xscale:{dependencyType:"stateVariable",variableName:"xscale"}}),e}},xn=Fs;var ei=De(Ee()),Sm=class extends xn{static componentType="clampfunction";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.lowerValue={default:0},e.upperValue={default:1},e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.numericalFunctionOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:function({dependencyValues:n}){return{newValues:{numericalFunctionOperator:function(r){return Number.isFinite(r)?Math.max(n.lowerValue,Math.min(n.upperValue,r)):NaN}}}}},e.symbolicFunctionOperator={returnDependencies:()=>({numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"}}),definition({dependencyValues:n}){return{newValues:{symbolicFunctionOperator:r=>ei.default.fromAst(n.numericalFunctionOperator(r.evaluate_to_constant()))}}}},e}},Dm=class extends xn{static componentType="wrapfunctionperiodic";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.lowerValue={default:0},e.upperValue={default:1},e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.numericalFunctionOperator={returnDependencies:()=>({lowerValue:{dependencyType:"stateVariable",variableName:"lowerValue"},upperValue:{dependencyType:"stateVariable",variableName:"upperValue"}}),definition:function({dependencyValues:n}){return{newValues:{numericalFunctionOperator:function(r){if(!Number.isFinite(r))return NaN;let i=n.lowerValue,a=n.upperValue;return i===a?i:(i>a&&([a,i]=[i,a]),i+ei.default.math.mod(r-i,a-i))}}}}},e.symbolicFunctionOperator={returnDependencies:()=>({numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"}}),definition({dependencyValues:n}){return{newValues:{symbolicFunctionOperator:r=>ei.default.fromAst(n.numericalFunctionOperator(r.evaluate_to_constant()))}}}},e}},Vm=class extends xn{static componentType="derivative";static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.operatorBasedOnFormulaIfAvailable={returnDependencies:()=>({}),definition:()=>({newValues:{operatorBasedOnFormulaIfAvailable:!0}})},e.operatorComposesWithOriginal={returnDependencies:()=>({}),definition:()=>({newValues:{operatorComposesWithOriginal:!1}})},e.formulaOperator={returnDependencies:()=>({variable:{dependencyType:"stateVariable",variableName:"variable"}}),definition({dependencyValues:n}){return{newValues:{formulaOperator:function(r){return r.derivative(n.variable.tree)}}}}},e.numericalFunctionOperator={returnDependencies:()=>({functionChild:{dependencyType:"child",childLogicName:"atMostOneFunctionForOperator",variableNames:["returnNumericalDerivatives"],variablesOptional:!0}}),additionalStateVariablesDefined:["returnNumericalDerivatives"],definition:function({dependencyValues:n}){return n.functionChild.length===0||!n.functionChild[0].stateValues.returnNumericalDerivatives?{newValues:{numericalFunctionOperator:r=>NaN,returnNumericalDerivatives:null}}:{newValues:{numericalFunctionOperator:n.functionChild[0].stateValues.returnNumericalDerivatives(1),returnNumericalDerivatives:(r=1)=>n.functionChild[0].stateValues.returnNumericalDerivatives(r+1)}}}},e.symbolicFunctionOperator={returnDependencies:()=>({numericalFunctionOperator:{dependencyType:"stateVariable",variableName:"numericalFunctionOperator"}}),definition({dependencyValues:n}){return{newValues:{symbolicFunctionOperator:r=>ei.default.fromAst(n.numericalFunctionOperator(r.evaluate_to_constant()))}}}},e}};var zs={};mt(zs,{Extrema:()=>Ki,Extremum:()=>Hi,Maxima:()=>Om,Maximum:()=>Im,Minima:()=>Em,Minimum:()=>Mm});var Hi=class extends _e{static componentType="extremum";static rendererType=void 0;static get stateVariablesShadowedForReference(){return["location","value"]}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let a=Sr({childrenToComponentFunction:s=>({componentType:"x",children:s}),mustStripOffOuterParentheses:!0})({matchedChildren:n});if(!a.success&&n.length===1)return{success:!0,newChildren:[{componentType:"value",doenetAttributes:{isPropertyChild:!0},children:n}]};if(a.success)if(a.newChildren.length===1)a.newChildren[0].componentType="value",a.newChildren[0].doenetAttributes={isPropertyChild:!0};else if(a.newChildren.length===2)a.newChildren[0].componentType="location",a.newChildren[0].doenetAttributes={isPropertyChild:!0},a.newChildren[1].componentType="value",a.newChildren[1].doenetAttributes={isPropertyChild:!0},(a.newChildren[1].children.length===0||a.newChildren[1].children.length===1&&a.newChildren[1].children[0].componentType==="string"&&a.newChildren[1].children[0].state.value.trim()==="")&&a.newChildren.splice(1,1),(a.newChildren[0].children.length===0||a.newChildren[0].children.length===1&&a.newChildren[0].children[0].componentType==="string"&&a.newChildren[0].children[0].state.value.trim()==="")&&a.newChildren.splice(0,1);else return{success:!1};return a};return t.push({childrenRegex:/s+(.*s)?/,replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneLocation",componentType:"location",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"exactlyOneValue",componentType:"value",number:1,takePropertyChildren:!0}),i=e.newOperator({name:"locationOrValue",operator:"or",propositions:[n,r]}),a=e.newLeaf({name:"atMostOnePoint",componentType:"point",comparison:"atMost",number:1});return e.newOperator({name:"locationValueXorPoint",operator:"xor",propositions:[i,a],setAsBase:!0}),e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t}),n=this;return e.value={public:!0,componentType:"math",defaultValue:null,additionalStateVariablesDefined:[{variableName:"location",public:!0,componentType:"math",defaultValue:null}],returnDependencies:()=>({extremumChild:{dependencyType:"child",childLogicName:"atMostOnePoint",variableNames:["nDimensions","xs"]},locationChild:{dependencyType:"child",childLogicName:"exactlyOneLocation",variableNames:["value"]},valueChild:{dependencyType:"child",childLogicName:"exactlyOneValue",variableNames:["value"]}}),definition:function({dependencyValues:r}){let i,a;if(r.extremumChild.length===1){let p=r.extremumChild[0];p.stateValues.nDimensions!==2?(console.log("Cannot determine "+n.componentType+" from a point that isn't 2D"),i=null,a=null):(i=p.stateValues.xs[0],a=p.stateValues.xs[1])}else r.locationChild.length===1&&(i=r.locationChild[0].stateValues.value),r.valueChild.length===1&&(a=r.valueChild[0].stateValues.value);let s={},o={},u=!1,c=!1;i===void 0?(o.location={variablesToCheck:["location"]},c=!0):(s.location=i,u=!0),a===void 0?(o.value={variablesToCheck:["value"]},c=!0):(s.value=a,u=!0);let f={};return u&&(f.newValues=s),c&&(f.useEssentialOrDefaultValue=o),f}},e}},Im=class extends Hi{static componentType="maximum"},Mm=class extends Hi{static componentType="minimum"},Ki=class extends _e{static componentType="extrema";static rendererType="container";static componentTypeSingular="extremum";static get componentTypeCapitalized(){return this.componentType.charAt(0).toUpperCase()+this.componentType.slice(1)}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=this,n=function({matchedChildren:r}){let i=tr({componentList:r});return i.success!==!0?{success:!1}:{success:!0,newChildren:i.pieces.map(function(a){return a.length>1||a[0].componentType==="string"?{componentType:e.componentTypeSingular,children:a}:a[0]})}};return t.push({replacementFunction:n}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroExtrema",componentType:this.componentTypeSingular,comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroPoints",componentType:"point",comparison:"atLeast",number:0});return e.newOperator({name:"extremaAndPoints",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=this;return t["n"+e.componentTypeCapitalized]={additionalStateVariablesDefined:["childIdentities"],returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"extremaAndPoints"}}),definition:function({dependencyValues:n}){return{newValues:{["n"+e.componentTypeCapitalized]:n.children.length,childIdentities:n.children}}}},t[e.componentType]={isArray:!0,nDimensions:2,entryPrefixes:[e.componentTypeSingular,e.componentTypeSingular+"Locations",e.componentTypeSingular+"Location",e.componentTypeSingular+"Values",e.componentTypeSingular+"Value"],stateVariablesDeterminingDependencies:["childIdentities"],getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:r,arraySize:i}){if([e.componentTypeSingular,e.componentTypeSingular+"Location",e.componentTypeSingular+"Value"].includes(n)){let a=Number(r)-1;return Number.isInteger(a)&&a>=0?!i||a<i[0]?n===e.componentTypeSingular?[a+",0",a+",1"]:n===e.componentTypeSingular+"Location"?[a+",0"]:[a+",1"]:[]:[]}else return n===e.componentTypeSingular+"Locations"?!i||r!==""?[]:Array.from(Array(i[0]),(a,s)=>s+",0"):n===e.componentTypeSingular+"Values"?!i||r!==""?[]:Array.from(Array(i[0]),(a,s)=>s+",1"):[]},arrayVarNameFromArrayKey(n){let[r,i]=n.split(",");return i==="0"?e.componentTypeSingular+"Location"+(Number(r)+1):e.componentTypeSingular+"Value"+(Number(r)+1)},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:r,arraySize:i}){if(n==="pointX"){let a=r.split("_").map(s=>Number(s)-1);return a.length===2&&a.every((s,o)=>Number.isInteger(s)&&s>=0)?i?a.every((s,o)=>s<i[o])?[String(a)]:[]:[String(a)]:[]}else{if(!i)return[];let a=Number(r)-1;return Number.isInteger(a)&&a>=0&&a<i[0]?Array.from(Array(i[1]),(s,o)=>a+","+o):[]}},returnArraySizeDependencies:()=>({nChildren:{dependencyType:"stateVariable",variableName:"n"+e.componentTypeCapitalized}}),returnArraySize({dependencyValues:n}){return[n.nChildren,2]},returnArrayDependenciesByKey({arrayKeys:n,stateValues:r}){let i={};for(let a of n){let[s,o]=a.split(","),u;r.childIdentities[s].componentType===e.componentTypeSingular?u=Number(o)===0?"location":"value":u="x"+(Number(o)+1),i[a]={child:{dependencyType:"child",childLogicName:"extremaAndPoints",variableNames:[u],childIndices:[s]}}}return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].child[0];if(s){let o=a.split(",")[1],u=Number(o)===0?"location":"value";u in s.stateValues?i[a]=s.stateValues[u]:i[a]=s.stateValues["x"+(Number(o)+1)]}}return{newValues:{[e.componentType]:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyNamesByKey:r}){let i=[];for(let a in n[e.componentType])i.push({setDependency:r[a].extremumChild,desiredValue:n[e.componentType][a],childIndex:0,variableIndex:0});return{success:!0,instructions:i}}},t.childrenToRender={returnDependencies:()=>({extremumChildren:{dependencyType:"child",childLogicName:"atLeastZeroExtrema"}}),definition:({dependencyValues:n})=>({newValues:{childrenToRender:n.extremumChildren.map(r=>r.componentName)}})},t}},Om=class extends Ki{static componentType="maxima";static componentTypeSingular="maximum"},Em=class extends Ki{static componentType="minima";static componentTypeSingular="minimum"};var qs={};mt(qs,{Pattern:()=>Pm,Replace:()=>Lm});var Pm=class extends _e{static componentType="pattern";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"exactlyOneChild",componentType:"_base",number:1,setAsBase:!0}),e}},Lm=class extends _e{static componentType="replace";static returnChildLogic(t){let e=super.returnChildLogic(t),n=function({activeChildrenMatched:a}){let s=a[0],o=s.state.value.split(",");if(o.length!==2)return{success:!1};let u=o.map(c=>({componentType:"string",state:{value:c.trim()}}));return{success:!0,newChildren:u,toDelete:[s.componentName]}},r=e.newLeaf({name:"exactlyOneString",componentType:"string",number:1,isSugar:!0,replacementFunction:n}),i=e.newLeaf({name:"exactlyTwoChildren",componentType:"_base",number:2});return e.newOperator({name:"SugarXorChildren",operator:"xor",propositions:[r,i],setAsBase:!0}),e}};var Us={};mt(Us,{Alert:()=>km,Em:()=>Rm,Q:()=>Fm,SQ:()=>Bm,Term:()=>zm,c:()=>qm});var js=class extends Me{static componentType="_inlinerenderinlinechildren";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"AtLeastZeroInline",componentType:"_inline",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.childrenToRender={returnDependencies:()=>({inlineChildren:{dependencyType:"child",childLogicName:"AtLeastZeroInline"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.inlineChildren.map(n=>n.componentName)}}}},t}static includeBlankStringChildren=!0},hr=js;var Rm=class extends hr{static componentType="em"},km=class extends hr{static componentType="alert"},Fm=class extends hr{static componentType="q"},Bm=class extends hr{static componentType="sq"},zm=class extends hr{static componentType="term";static rendererType="alert"},qm=class extends hr{static componentType="c"};var Hs={};mt(Hs,{Mdash:()=>Um,NBSP:()=>Hm,Ndash:()=>jm});var jm=class extends Me{static componentType="ndash"},Um=class extends Me{static componentType="mdash"},Hm=class extends Me{static componentType="nbsp"};var Gs={};mt(Gs,{AnswerSet:()=>Qm,Aside:()=>Xm,Example:()=>Ym,Exercise:()=>Jm,Paragraphs:()=>Zm,Problem:()=>Zs,Section:()=>Km,StandinForFutureLayoutTag:()=>eh,Subsection:()=>Wm,Subsubsection:()=>Gm});var Ks=class extends _e{static componentType="_block"},We=Ks;var Wi=De(Ee());function ti({numberOfIndices:l,numberOfOptions:t,maxNumber:e=Infinity,withReplacement:n=!0}){if(l===1){let s=[...Array(t).keys()];return s=[...s.slice(1),0].slice(0,e),s=s.map(o=>[o]),s}let r=ti({numberOfIndices:l-1,numberOfOptions:t,maxNumber:e,withReplacement:n}),i=[],a=0;for(let s of r)for(let o=1;o<=t;o++){let u=[o%t,...s.map(c=>(o+c)%t)];if(!(!n&&new Set(u).size<l)&&(i.push(u),a++,a>=e))return i}return i}function Cn({numberOfOptionsByIndex:l,maxNumber:t=Infinity}){let e=l.length;if(e===0)return[];let n=[];for(let m=0;m<e;m++){let v=[];for(let h=0;h<m;h++)v.push(Wi.default.math.gcd(l[m],l[h]));n.push(v)}let r=n.reduce((m,v)=>[...v,...m],[]).reduce((m,v)=>Math.max(m,v),1);if(r===1){let m=l.reduce((h,y)=>h*y);m=Math.min(m,t);let v=[];for(let h=0;h<m;h++){let y=l.map(g=>h%g);v.push(y)}return v}if(e===2){let m=r,v=Wi.default.math.lcm(...l),h=[],y=0;for(let g=0;g<m;g++)for(let b=0;b<v;b++){let x=[b%l[0],(b+g)%l[1]];if(h.push(x),y++,y>=t)return h}return h}let i=[];for(let m=0;m<e;m++){let v=[];for(let h=0;h<m;h++)n[m][h]>1?v.push(Wi.default.math.lcm(l[m],l[h])):v.push(null);i.push(v)}let a=i.reduce((m,v)=>[...v,...m],[]).filter(m=>m!==null).reduce((m,v)=>Math.min(m,v),Infinity),s;for(let m=0;m<e;m++){for(let v=0;v<m;v++)if(i[m][v]===a){s=[v,m];break}if(s)break}let o=l[s[0]],u=l[s[1]],c=[o,u],f=l;f[s[0]]=o*u,f.splice(s[1],1);let p=Cn({numberOfOptionsByIndex:f,maxNumber:t}),d=Cn({numberOfOptionsByIndex:c,maxNumber:t});for(let m of p){let v=d[m[s[0]]];m.splice(s[0],1,v[0]),m.splice(s[1],0,v[1])}return p}function Nn({variantNumber:l,serializedComponent:t,allComponentClasses:e}){if(t.variants===void 0)return{success:!1};let n=t.variants.descendantVariantComponents;if(n===void 0)return{success:!1};let r=n.map(s=>s.variants.numberOfVariants),i=Cn({numberOfOptionsByIndex:r,maxNumber:l+1})[l],a=[];for(let[s,o]of n.entries()){let c=e[o.componentType].getUniqueVariant({serializedComponent:o,variantNumber:i[s],allComponentClasses:e});if(c.success)a.push(c.desiredVariant);else return{succss:!1}}return{success:!0,desiredVariants:a}}var Ws=class extends We{static componentType="_sectioningcomponent";static setUpVariantIfVariantControlChild=!0;static get stateVariablesShadowedForReference(){return["title"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.aggregateScores={default:!1},e.weight={default:1},e.sectionWideCheckWork={default:!1},e.delegateCheckWorkToAnswerNumber={default:null,forRenderer:!0},e.feedbackDefinitions={propagateToDescendants:!0,mergeArrays:!0},e.styleDefinitions={propagateToDescendants:!0,mergeArrays:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneVariantControl",componentType:"variantcontrol",comparison:"atMost",number:1,allowSpillover:!1}),r=e.newLeaf({name:"atMostOneTitle",componentType:"title",comparison:"atMost",number:1}),i=e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0});return e.newOperator({name:"variantTitleAndAnything",operator:"and",propositions:[n,r,i],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.enumeration={forRenderer:!0,returnDependencies:()=>({countAmongSiblings:{dependencyType:"countAmongSiblingsOfSameType"},sectionAncestor:{dependencyType:"ancestor",componentType:"_sectioningcomponent",variableNames:["enumeration"]}}),definition({dependencyValues:e}){let n=[];return e.sectionAncestor&&n.push(...e.sectionAncestor.stateValues.enumeration),n.push(e.countAmongSiblings),{newValues:{enumeration:n}}}},t.sectionName={returnDependencies:()=>({}),definition:()=>({newValues:{sectionName:"Section"}})},t.titleDefinedByChildren={forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childLogicName:"atMostOneTitle"}}),definition({dependencyValues:e}){return{newValues:{titleDefinedByChildren:e.titleChild.length===1}}}},t.title={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childLogicName:"atMostOneTitle",variableNames:["text"]},sectionName:{dependencyType:"stateVariable",variableName:"sectionName"},enumeration:{dependencyType:"stateVariable",variableName:"enumeration"}}),definition({dependencyValues:e}){return e.titleChild.length===0?{newValues:{title:e.sectionName+" "+e.enumeration.join(".")}}:{newValues:{title:e.titleChild[0].stateValues.text}}}},t.containerTag={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{containerTag:"section"}})},t.level={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{level:1}})},t.viewedSolution={defaultValue:!1,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{viewedSolution:{variablesToCheck:["viewedSolution"]}}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"viewedSolution",value:e.viewedSolution}]}}},t.scoredDescendants={returnDependencies:()=>({scoredDescendants:{dependencyType:"descendant",componentTypes:["_sectioningcomponent","answer"],variableNames:["scoredDescendants","aggregateScores","weight"],recurseToMatchedChildren:!1,variablesOptional:!0}}),definition({dependencyValues:e}){let n=[];for(let r of e.scoredDescendants)r.stateValues.aggregateScores||r.stateValues.scoredDescendants===void 0?n.push(r):n.push(...r.stateValues.scoredDescendants);return{newValues:{scoredDescendants:n}}}},t.answerDescendants={returnDependencies:()=>({answerDescendants:{dependencyType:"descendant",componentTypes:["answer"],recurseToMatchedChildren:!1}}),definition({dependencyValues:e}){return{newValues:{answerDescendants:e.answerDescendants}}}},t.justSubmitted={forRenderer:!0,returnDependencies:()=>({answerDescendants:{dependencyType:"descendant",componentTypes:["answer"],variableNames:["justSubmitted"],recurseToMatchedChildren:!1}}),definition({dependencyValues:e}){return{newValues:{justSubmitted:e.answerDescendants.every(n=>n.stateValues.justSubmitted)}}}},t.showCorrectness={forRenderer:!0,returnDependencies:()=>({showCorrectnessFlag:{dependencyType:"flag",flagName:"showCorrectness"}}),definition({dependencyValues:e}){return{newValues:{showCorrectness:e.showCorrectnessFlag!==!1}}}},t.displayDigitsForCreditAchieved={returnDependencies:()=>({}),definition:()=>({newValues:{displayDigitsForCreditAchieved:3}})},t.creditAchieved={public:!0,componentType:"number",forRenderer:!0,defaultValue:0,stateVariablesPrescribingAdditionalProperties:{displayDigits:"displayDigitsForCreditAchieved"},additionalStateVariablesDefined:[{variableName:"percentCreditAchieved",public:!0,componentType:"number",stateVariablesPrescribingAdditionalProperties:{displayDigits:"displayDigitsForCreditAchieved"}}],stateVariablesDeterminingDependencies:["aggregateScores","scoredDescendants"],returnDependencies({stateValues:e}){let n={aggregateScores:{dependencyType:"stateVariable",variableName:"aggregateScores"}};if(e.aggregateScores){n.scoredDescendants={dependencyType:"stateVariable",variableName:"scoredDescendants"};for(let[r,i]of e.scoredDescendants.entries())n["creditAchieved"+r]={dependencyType:"stateVariable",componentName:i.componentName,variableName:"creditAchieved"}}return n},definition({dependencyValues:e}){if(!e.aggregateScores)return{newValues:{creditAchieved:0,percentCreditAchieved:0}};let n=0,r=0;for(let[s,o]of e.scoredDescendants.entries()){let u=o.stateValues.weight;n+=e["creditAchieved"+s]*u,r+=u}let i=n/r,a=i*100;return{newValues:{creditAchieved:i,percentCreditAchieved:a}}}},t.creditAchievedIfSubmit={defaultValue:0,stateVariablesDeterminingDependencies:["aggregateScores","scoredDescendants"],returnDependencies({stateValues:e}){let n={aggregateScores:{dependencyType:"stateVariable",variableName:"aggregateScores"}};if(e.aggregateScores){n.scoredDescendants={dependencyType:"stateVariable",variableName:"scoredDescendants"};for(let[r,i]of e.scoredDescendants.entries())n["creditAchievedIfSubmit"+r]={dependencyType:"stateVariable",componentName:i.componentName,variableName:"creditAchievedIfSubmit"}}return n},definition({dependencyValues:e}){if(!e.aggregateScores)return{newValues:{creditAchievedIfSubmit:0}};let n=0,r=0;for(let[a,s]of e.scoredDescendants.entries()){let o=s.stateValues.weight;n+=e["creditAchievedIfSubmit"+a]*o,r+=o}return{newValues:{creditAchievedIfSubmit:n/r}}}},t.selectedVariantInfo={additionalStateVariablesDefined:["isVariantComponent"],returnDependencies:({componentInfoObjects:e})=>({variantControlChild:{dependencyType:"child",childLogicName:"atMostOneVariantControl",variableNames:["selectedVariantNumber"]},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(e.componentTypeWithPotentialVariants),variableNames:["isVariantComponent","selectedVariantInfo"],recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfMatchedComposites:!0,definingChildrenFirst:!0}}),definition({dependencyValues:e}){let n,r={};e.variantControlChild.length===1?(n=!0,r.index=e.variantControlChild[0].stateValues.selectedVariantNumber):n=!1;let i=r.subvariants=[];for(let a of e.variantDescendants)a.stateValues.isVariantComponent?i.push(a.stateValues.selectedVariantInfo):a.stateValues.selectedVariantInfo&&i.push(...a.stateValues.selectedVariantInfo.subvariants);return{newValues:{selectedVariantInfo:r,isVariantComponent:n}}}},t.collapsible={componentType:"boolean",forRenderer:!0,returnDependencies:()=>({}),definition(){return{newValues:{collapsible:!1}}}},t.open={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!0,returnDependencies:()=>({}),definition(){return{useEssentialOrDefaultValue:{open:{variablesToCheck:["open"]}}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"open",value:e.open}]}}},t.childrenToRender={returnDependencies:()=>({titleChild:{dependencyType:"child",childLogicName:"atMostOneTitle"},activeChildren:{dependencyType:"child",childLogicName:"anything"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:[...e.titleChild,...e.activeChildren].map(n=>n.componentName)}}}},t.createSubmitAllButton={forRenderer:!0,additionalStateVariablesDefined:["createSubmitAllButtonOnAnswer"],returnDependencies:()=>({sectionWideCheckWork:{dependencyType:"stateVariable",variableName:"sectionWideCheckWork"},delegateCheckWorkToAnswerNumber:{dependencyType:"stateVariable",variableName:"delegateCheckWorkToAnswerNumber"},aggregateScores:{dependencyType:"stateVariable",variableName:"aggregateScores"},answerDescendants:{dependencyType:"stateVariable",variableName:"answerDescendants"}}),definition({dependencyValues:e,componentName:n}){let r=!1,i=null;if(e.sectionWideCheckWork)if(!e.aggregateScores)console.warn(`Cannot create submit all button for ${n} because it doesn't aggegrate scores`);else{let a=null;if(e.delegateCheckWorkToAnswerNumber>0)a=e.answerDescendants[e.delegateCheckWorkToAnswerNumber-1];else if(e.delegateCheckWorkToAnswerNumber<0){let s=e.answerDescendants.length+e.delegateCheckWorkToAnswerNumber;a=e.answerDescendants[s]}a?i=a.componentName:r=!0}return{newValues:{createSubmitAllButton:r,createSubmitAllButtonOnAnswer:i}}}},t.suppressAnswerSubmitButtons={additionalStateVariablesDefined:["answerDelegatedForSubmitAll","componentNameForSubmitAll","justSubmittedForSubmitAll","creditAchievedForSubmitAll"],forRenderer:!0,returnDependencies:()=>({createSubmitAllButton:{dependencyType:"stateVariable",variableName:"createSubmitAllButton"},createSubmitAllButtonOnAnswer:{dependencyType:"stateVariable",variableName:"createSubmitAllButtonOnAnswer"},justSubmitted:{dependencyType:"stateVariable",variableName:"justSubmitted"},creditAchieved:{dependencyType:"stateVariable",variableName:"creditAchieved"},sectionAncestor:{dependencyType:"ancestor",componentType:"_sectioningcomponent",variableNames:["suppressAnswerSubmitButtons","answerDelegatedForSubmitAll","componentNameForSubmitAll","justSubmittedForSubmitAll","creditAchievedForSubmitAll"]}}),definition({dependencyValues:e,componentName:n}){let r=!1,i=null,a=null,s=null,o=null;if(e.createSubmitAllButton||e.createSubmitAllButtonOnAnswer)a=n,r=!0,e.createSubmitAllButtonOnAnswer&&(i=e.createSubmitAllButtonOnAnswer,s=e.justSubmitted,o=e.creditAchieved);else if(e.sectionAncestor){let u=e.sectionAncestor.stateValues;r=u.suppressAnswerSubmitButtons,a=u.componentNameForSubmitAll,i=u.answerDelegatedForSubmitAll,s=u.justSubmittedForSubmitAll,o=u.creditAchievedForSubmitAll}return{newValues:{suppressAnswerSubmitButtons:r,componentNameForSubmitAll:a,answerDelegatedForSubmitAll:i,justSubmittedForSubmitAll:s,creditAchievedForSubmitAll:o}}}},t}actions={submitAllAnswers:this.submitAllAnswers.bind(this),revealSection:this.revealSection.bind(this),closeSection:this.closeSection.bind(this)};submitAllAnswers(){this.coreFunctions.requestRecordEvent({verb:"submitted",object:{componentName:this.componentName,componentType:this.componentType},result:{creditAchieved:this.stateValues.creditAchievedIfSubmit}});for(let t of this.stateValues.answerDescendants)this.coreFunctions.requestAction({componentName:t.componentName,actionName:"submitAnswer"})}revealSection(){this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!0}],event:{verb:"viewed",object:{componentName:this.componentName,componentType:this.componentType}}})}closeSection(){this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!1}],event:{verb:"closed",object:{componentName:this.componentName,componentType:this.componentType}}})}static setUpVariant({serializedComponent:t,sharedParameters:e,definingChildrenSoFar:n,allComponentClasses:r}){let i;for(let s of n)if(s!==void 0&&s.componentType==="variantcontrol"){i=s;break}e.variant=i.state.selectedVariant.value,e.variantNumber=i.state.selectedVariantNumber.value,e.selectRng=i.state.selectRng.value,e.allPossibleVariants=i.state.variants.value,console.log("Variant for "+this.componentType+": "+e.variant);let a=t.variants.desiredVariant;if(a===void 0&&(a={}),a.subvariants===void 0&&t.variants.uniquevariants){let s=this.getUniqueVariant({serializedComponent:t,variantNumber:e.variantNumber,allComponentClasses:r});s.success&&Object.assign(a,s.desiredVariant)}if(a!==void 0&&a.subvariants!==void 0&&t.variants.descendantVariantComponents!==void 0)for(let s in a.subvariants){let o=a.subvariants[s],u=t.variants.descendantVariantComponents[s];if(u===void 0)break;u.variants.desiredVariant=o}}static determineNumberOfUniqueVariants({serializedComponent:t}){if(t.children===void 0)return{success:!0};let e,n;for(let[a,s]of t.children.entries())if(s.componentType==="variantcontrol"||s.createdComponent&&components[s.componentName].componentType==="variantcontrol"){e=a,n=s;break}if(e===void 0)return{success:!0};let r=100;if(n.children!==void 0){for(let a of n.children)if(a.componentType==="nvariants"){let s=!1;if(a.state!==void 0&&a.state.value!==void 0&&(r=Math.round(Number(a.state.value)),s=!0),a.children!==void 0&&a.children.length===1&&a.children[0].componentType==="string"&&(r=Math.round(Number(a.children[0].state.value)),s=!0),!s)return{success:!1};break}}t.variants===void 0&&(t.variants={});let i;if(t.variants.uniquevariants){let a=1,s=[];t.variants.descendantVariantComponents!==void 0&&(s=t.variants.descendantVariantComponents.map(o=>o.variants.numberOfVariants),a=s.reduce((o,u)=>o*u,1),i={numberOfVariantsByDescendant:s}),r=Math.min(a,r)}return{success:!0,numberOfVariants:r,uniqueVariantData:i}}static getUniqueVariant({serializedComponent:t,variantNumber:e,allComponentClasses:n}){if(t.variants===void 0)return{succes:!1};let r=t.variants.numberOfVariants;if(r===void 0)return{success:!1};if(!Number.isInteger(e)||e<0||e>=r)return{success:!1};let i={index:e};if(t.variants.uniquevariants){let a=Nn({variantNumber:e,serializedComponent:t,allComponentClasses:n});a.success?i.subvariants=a.desiredVariants:console.log("Failed to get unique variant for "+t.componentType)}return{success:!0,desiredVariant:i}}static includeBlankStringChildren=!0},kt=Ws;var Km=class extends kt{static componentType="section";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({newValues:{level:1}}),t}},Wm=class extends kt{static componentType="subsection";static rendererType="section";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({newValues:{level:2}}),t}},Gm=class extends kt{static componentType="subsubsection";static rendererType="section";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({newValues:{level:3}}),t}},Zm=class extends kt{static componentType="paragraphs";static rendererType="section";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({newValues:{level:4}}),t}},Xm=class extends kt{static componentType="aside";static rendererType="section";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.collapsible.definition=()=>({newValues:{collapsible:!0}}),t.open.defaultValue=!1,t.level.definition=()=>({newValues:{level:3}}),t.containerTag.definition=()=>({newValues:{containerTag:"aside"}}),t}},Zs=class extends kt{static componentType="problem";static rendererType="section";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.aggregateScores={default:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.sectionName.definition=()=>({newValues:{sectionName:"Problem"}}),t.level.definition=()=>({newValues:{level:3}}),t}},Jm=class extends Zs{static componentType="exercise";static rendererType="section";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.sectionName.definition=()=>({newValues:{sectionName:"Exercise"}}),t}},Ym=class extends kt{static componentType="Example";static rendererType="section";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.sectionName.definition=()=>({newValues:{sectionName:"Example"}}),t.level.definition=()=>({newValues:{level:3}}),t}},Qm=class extends kt{static componentType="answerSet";static rendererType="section";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.aggregateScores={default:!0},e.sectionWideCheckWork={default:!0,forRenderer:!0,ignorePropagationFromAncestors:!0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({newValues:{level:null}}),t.containerTag.definition=()=>({newValues:{containerTag:"none"}}),t}},eh=class extends kt{static componentType="standinForFutureLayoutTag";static rendererType="section";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.level.definition=()=>({newValues:{level:3}}),t.containerTag.definition=()=>({newValues:{containerTag:"aside"}}),t}};var Xs={};mt(Xs,{Li:()=>rh,Ol:()=>Js,Ul:()=>th});var Js=class extends We{static componentType="ol";static rendererType="list";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.label={default:void 0,forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroLis",componentType:"li",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numbered={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{numbered:!0}})},t.childrenToRender={returnDependencies:()=>({liChildren:{dependencyType:"child",childLogicName:"atLeastZeroLis"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.liChildren.map(n=>n.componentName)}}}},t}},th=class extends Js{static componentType="ul";static rendererType="list";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numbered={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{numbered:!1}})},t}},rh=class extends _e{static componentType="li";static rendererType="list";static includeBlankStringChildren=!0;static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroInline",componentType:"_inline",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroBlock",componentType:"_block",comparison:"atLeast",number:0});return e.newOperator({name:"inlineOrBlock",operator:"or",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.item={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{item:!0}})},t.childrenToRender={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"inlineOrBlock"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.children.map(n=>n.componentName)}}}},t}};var to={};mt(to,{CobwebPolyline:()=>ih,HideInitialCondition:()=>sh,InitialCondition:()=>ah,InitialPoint:()=>oh,ODESystem:()=>nh});var ir=De(Ee()),Ys=class extends Me{static componentType="odesystem";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.independentvariable={default:ir.default.fromAst("t")},e.initialindependentvariablevalue={default:ir.default.fromAst(0)},e.displaydigits={default:14},e.rendermode={default:"align"},e.chunksize={default:10},e.tolerance={default:1e-6},e.maxIterations={default:1e3},e.hideInitialCondition={default:!1},e}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();let n=e.newLeaf({name:"atMostOneVariables",componentType:"variables",comparison:"atMost",number:1}),r=e.newLeaf({name:"atLeastZeroRHSs",componentType:"righthandside",comparison:"atLeast",number:0}),i=e.newLeaf({name:"atLeastZeroInitialConditions",componentType:"initialcondition",comparison:"atLeast",number:0});return e.newOperator({name:"ODEsystemLogic",operator:"and",propositions:[n,r,i],setAsBase:!0}),e}updateState(t={}){if(t.init===!0&&(this.makePublicStateVariableArray({variableName:"variables",componentType:"variable"}),this.makePublicStateVariableArrayEntry({entryName:"var",arrayVariableName:"variables"}),this.makePublicStateVariableArray({variableName:"rhss",componentType:"righthandside"}),this.makePublicStateVariableArrayEntry({entryName:"rhs",arrayVariableName:"rhss"}),this.makePublicStateVariableAlias({variableName:"rhs",targetName:"rhs",arrayIndex:"1"}),this.makePublicStateVariableArrayEntry({entryName:"righthandside",arrayVariableName:"rhss"}),this.makePublicStateVariableAlias({variableName:"righthandside",targetName:"rhs",arrayIndex:"1"}),this.makePublicStateVariableAlias({variableName:"righthandsides",targetName:"rhss"}),this.makePublicStateVariableArray({variableName:"initialconditions",componentType:"initialcondition"}),this.makePublicStateVariableArrayEntry({entryName:"initialcondition",arrayVariableName:"initialconditions"}),this.makePublicStateVariableAlias({variableName:"initialcondition",targetName:"initialcondition",arrayIndex:"1"}),this.makePublicStateVariableArray({variableName:"numericalsolutions",componentType:"function",stateVariableForRef:"numericF"}),this.makePublicStateVariableArrayEntry({entryName:"numericalsolution",arrayVariableName:"numericalsolutions"}),this.makePublicStateVariableAlias({variableName:"numericalsolution",targetName:"numericalsolution",arrayIndex:"1"})),super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.variables=!0,this.unresolvedState.rhss=!0,this.unresolvedState.initialconditions=!0,this.unresolvedState.numericalsolutions=!0;return}let e=this.currentTracker.trackChanges,n=e.childrenChanged(this.componentName);if(n){let a=this.childLogic.returnMatches("atMostOneVariables");a.length===1?this.state.variablesChild=this.activeChildren[a[0]]:(delete this.state.variablesChild,this.state.validVariables=[],this._state.variables.essential||(this.state.variables=[]));let s=this.childLogic.returnMatches("atLeastZeroRHSs");this.state.rhsChildren=s.map(u=>this.activeChildren[u]);let o=this.childLogic.returnMatches("atLeastZeroInitialConditions");this.state.initialConditionChildren=o.map(u=>this.activeChildren[u])}let r=e.getVariableChanges({component:this,variable:"variables"})||e.getVariableChanges({component:this,variable:"independentvariable"})||this.state.rhsChildren.some(a=>e.getVariableChanges({component:a,variable:"variable"}))||this.state.initialConditionChildren.some(a=>e.getVariableChanges({component:a,variable:"variable"}));if(this.state.variablesChild){if(this.state.variablesChild.unresolvedState.variables)this.unresolvedState.variables=!0;else if(n||r||e.getVariableChanges({component:this.state.variablesChild,variable:"variables"})){r=!0,this.state.variables=[...this.state.variablesChild.state.variables];for(let a=0;a<this.state.variables.length;a++){let s=this.state.variables[a];this.state.independentvariable.equals(s)&&console.warn("Variables of odesystem must be different than independent variable.");for(let o=0;o<a;o++)this.state.variables[o].equals(s)&&console.warn("Variables of odesystem must be unique.")}}this.state.variablesChild.unresolvedState.validVariables?this.unresolvedState.validVariables=!0:(n||r||e.getVariableChanges({component:this.state.variablesChild,variable:"validVariables"}))&&(r=!0,this.state.validVariables=[...this.state.variablesChild.state.validVariables])}else r&&(this.state.validVariables=[],this._state.variables.essential||(this.state.variables=[]));if(this.state.rhsChildren.some(a=>a.unresolvedState.variable||a.unresolvedState.value)||this.state.initialConditionChildren.some(a=>a.unresolvedState.variable||a.unresolvedState.value)){this.unresolvedState.variables=!0,this.unresolvedState.rhss=!0,this.unresolvedState.initialconditions=!0,this.unresolvedState.numericalsolutions=!0;return}let i=n||r||this.state.rhsChildren.some(a=>e.getVariableChanges({component:a,variable:"value"}))||this.state.initialConditionChildren.some(a=>e.getVariableChanges({component:a,variable:"value"}));if(i){this.state.rhss=[];let a=new Set,s=new Set;for(let[p,d]of this.state.rhsChildren.entries()){let m=d.state.variable,v;if(m!==void 0&&(v=this.state.variables.findIndex(h=>h&&h.equals(m)),v!==-1))if(this.state.rhss[v]===void 0)this.state.rhss[v]=d.state.value,s.add(p);else{let h="Duplicate variable "+m+" in rhs of odesystem.";console.warn(h)}}for(let[p,d]of this.state.rhsChildren.entries()){if(s.has(p))continue;let m=d.state.variable,v;if(m===void 0)v=this.state.rhss.findIndex(h=>!h),v===-1&&(v=this.state.rhss.length),this.state.rhss[v]=d.state.value,m=this.state.variables[v],m===void 0&&(a.add(v),this.state.variables[v]=ir.default.fromAst("\uFF3F\uFF3F"));else if(v=this.state.variables.findIndex(h=>h&&h.equals(m)),v!==-1){let h="Duplicate variable "+m+" in rhs of odesystem.";if(t.init)throw Error(h);h+=" Repeated rhs with same variable are ignored",console.warn(h)}else v=this.state.variables.findIndex(h=>!h),v===-1&&(v=this.state.variables.length),this.state.rhss[v]=d.state.value,this.state.variables[v]=m,d._state.variable.additionalVars&&(this.state.validVariables[v]=d._state.variable.additionalVars.validVariable)}for(let p of a)this.state.variables[p]=void 0;s=new Set,this.state.initialconditions=[];let o=0,u=0;for(let[p,d]of this.state.initialConditionChildren.entries()){let m=d.state.variable,v;if(m===void 0)o++;else if(v=this.state.variables.findIndex(h=>h&&h.equals(m)),v!==-1)if(u++,this.state.initialconditions[v]===void 0)this.state.initialconditions[v]=d.state.value,s.add(p);else{let h="Duplicate variable "+m+" in initial condtion of odesystem.";if(t.init)throw Error(h);h+=" Repeated initial conditions with same variable are ignored",console.warn(h)}}let c=this.state.variables.length-a.size-u,f=Math.max(0,o-c);for(let[p,d]of this.state.initialConditionChildren.entries()){if(s.has(p))continue;let m=d.state.variable,v;if(m===void 0){if(v=this.state.initialconditions.findIndex(h=>!h),v===-1&&(v=this.state.initialconditions.length),m=this.state.variables[v],m===void 0)if(f>0)f--,a.add(v),this.state.variables[v]=ir.default.fromAst("\uFF3F\uFF3F");else for(;v<this.state.variables.length-1&&(v++,m=this.state.variables[v],m===void 0););this.state.initialconditions[v]=d.state.value}else if(v=this.state.variables.findIndex(h=>h&&h.equals(m)),v!==-1){let h="Duplicate variable "+m+" in initial conditions of odesystem.";if(t.init)throw Error(h);h+=" Repeated initial conditions with same variable are ignored",console.warn(h)}else v=this.state.variables.findIndex(h=>!h),v===-1?v=this.state.variables.length:a.delete(v),this.state.initialconditions[v]=d.state.value,this.state.variables[v]=m}if(a.size>0){a=[...a].sort();let p=[];for(let d=0;d<this.state.variables.length;d++){let m;d<3?m=ir.default.fromAst(["x","y","z"][d]):m=ir.default.fromAst(["_","x",d+1]),this.state.variables.findIndex(v=>v&&v.equals(m))===-1&&p.push(m)}p.reverse();for(let d of a)this.state.variables[d]=p.pop()}this.state.nDimensions=this.state.variables.length;for(let p in this.state.variables)this.state.rhss[p]||(this.state.rhss[p]=ir.default.fromAst(0)),this.state.initialconditions[p]||(this.state.initialconditions[p]=ir.default.fromAst(0))}if(i||e.getVariableChanges({component:this,variable:"hideInitialCondition"})||e.getVariableChanges({component:this,variable:"displaydigits"})||e.getVariableChanges({component:this,variable:"independentvariable"})||e.getVariableChanges({component:this,variable:"initialindependentvariablevalue"})||e.getVariableChanges({component:this,variable:"initialconditions"})){let a=[];for(let[s,o]of this.state.rhss.entries()){let u=this.state.variables[s],c="\\frac{\\mathrm{d} "+u.toLatex()+" }{ \\mathrm{d} "+this.state.independentvariable.toLatex()+" } &= "+o.round_numbers_to_precision(this.state.displaydigits).toLatex();a.push(c)}if(!this.state.hideInitialCondition)for(let[s,o]of this.state.initialconditions.entries()){let c=this.state.variables[s].toLatex()+" ( "+this.state.initialindependentvariablevalue+" ) &= "+o.round_numbers_to_precision(this.state.displaydigits).toLatex();a.push(c)}this.state.latex=a.join("\\\\")}(i||e.getVariableChanges({component:this,variable:"chunksize"})||e.getVariableChanges({component:this,variable:"tolerance"})||e.getVariableChanges({component:this,variable:"maxIterations"})||e.getVariableChanges({component:this,variable:"independentvariable"})||e.getVariableChanges({component:this,variable:"initialindependentvariablevalue"})||e.getVariableChanges({component:this,variable:"initialconditions"}))&&(this.state.fnumericRHS=this.returnNumericRHSfunction(),this.state.t0=this.state.initialindependentvariablevalue.evaluate_to_constant(),this.state.x0s=this.state.initialconditions.map(a=>a.evaluate_to_constant()),!Number.isFinite(this.state.t0)||!this.state.x0s.every(a=>Number.isFinite(a))?this.state.nonNumericValues=!0:delete this.state.nonNumericValues,this.state.calculatedNumericSolutions=[],this.state.endingNumericalValues=[],this.state.maxPossibleTime=void 0,this.state.numericalsolutions=this.state.variables.map((a,s)=>this.returnNumericSolution(s)),e.addNewValue(this,"numericalsolutions"))}returnNumericRHSfunction(t){let e=this.state.rhss;if(t!==void 0){let a=e[t];if(a===void 0)return;e=[a]}let n;try{n=e.map(a=>a.subscripts_to_strings().f())}catch(a){return console.warn("Cannot define ODE RHS function.  Error creating mathjs function"),s=>NaN}if(this._state.independentvariable.additionalVars&&!this._state.independentvariable.additionalVars.validVariable)return console.warn("Can't define ODE RHS function with invalid independent variable."),a=>NaN;if(this.state.validVariables.some(a=>a===!1))return console.warn("Can't define ODE RHS function with dependent variables."),a=>NaN;let r=this.state.independentvariable.subscripts_to_strings().tree,i=this.state.variables.map(a=>a.subscripts_to_strings().tree);return i.includes(r)?(console.warn("Can't define ODE RHS function when independent variable is a dependent varaible"),a=>NaN):[...new Set(i)].length!==i.length?(console.warn("Can't define ODE RHS function with duplicate dependent varaible names"),a=>NaN):function(a,s){let o={[r]:a};Array.isArray(s)?s.forEach((u,c)=>o[i[c]]=u):o[i[0]]=s;try{return n.map(u=>u(o))}catch(u){return NaN}}}returnNumericSolution(t){return function(n){if(this.state.nonNumericValues)return NaN;if(!Number.isFinite(n))return NaN;if(n===this.state.t0)return t!==void 0?this.state.x0s[t]:this.state.x0s;let r=this.state.calculatedNumericSolutions.length,i=Math.ceil((n-this.state.t0)/this.state.chunksize)-1;if(i<0)return NaN;if(this.state.maxPossibleTime===void 0&&i>=r)for(let s=r;s<=i;s++){let o=this.state.endingNumericalValues[s-1];o===void 0&&(o=this.state.x0s);let u=this.state.t0+s*this.state.chunksize,c=ir.default.math.dopri(u,u+this.state.chunksize,o,this.state.fnumericRHS,this.state.tolerance,this.state.maxIterations);this.state.endingNumericalValues.push(c.y[c.y.length-1]),this.state.calculatedNumericSolutions.push(c.at.bind(c));let f=c.x[c.x.length-1];if(f<(u+this.state.chunksize)*(1-1e-6)){this.state.maxPossibleTime=f;let p="For chunksize "+this.state.chunksize+" and tolerance "+this.state.tolerance+", odesystem";this.doenetAttributes.componentName!==void 0&&(p+=" ("+this.doenetAttributes.componentName+")"),p+=" hit maxiterations ("+this.state.maxIterations+") at t = "+this.state.maxPossibleTime+". Will not calculate solution beyond that time. Decrease chunksize, increase maxiterations, or increase tolerance to calculate further.",console.warn(p);break}}if(n>this.state.maxPossibleTime)return NaN;let a=this.state.calculatedNumericSolutions[i](n);return t!==void 0&&(a=a[t]),a}.bind(this)}initializeRenderer({}){if(this.renderer!==void 0){this.updateRenderer();return}this.renderer=new this.availableRenderers.math({key:this.componentName,mathLatex:this.state.latex,renderMode:this.state.rendermode})}updateRenderer(){this.renderer.updateMathLatex(this.state.latex)}},nh=Ys;var Gi=De(Ee()),Qs=class extends lt{static componentType="polyline";actions={movePolyline:this.movePolyline.bind(new Proxy(this,this.readOnlyProxyHandler))};static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["vertices","nVertices"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.draggable={default:!0,forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneVertices",componentType:"vertices",comparison:"atMost",number:1,takePropertyChildren:!0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let n="";return e.selectedStyle.lineWidth>=4?n+="thick ":e.selectedStyle.lineWidth<=1&&(n+="thin "),e.selectedStyle.lineStyle==="dashed"?n+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(n+="dotted "),n+=e.selectedStyle.lineColor,{newValues:{styleDescription:n}}}},t.nVertices={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({verticesChild:{dependencyType:"child",childLogicName:"atMostOneVertices",variableNames:["nPoints"]}}),definition:function({dependencyValues:e}){return e.verticesChild.length===1?{newValues:{nVertices:e.verticesChild[0].stateValues.nPoints}}:{newValues:{nVertices:0}}}},t.nDimensions={public:!0,componentType:"number",returnDependencies(){return{verticesChild:{dependencyType:"child",childLogicName:"atMostOneVertices",variableNames:["nDimensions"]}}},definition:function({dependencyValues:e}){return e.verticesChild.length===1?{newValues:{nDimensions:e.verticesChild[0].stateValues.nDimensions},checkForActualChange:{nDimensions:!0}}:{newValues:{nDimensions:2}}}},t.vertices={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["vertexX","vertex"],returnWrappingComponents(e){return e==="vertexX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="vertexX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}},returnArraySizeDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nVertices,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let[i,a]=r.split(","),s=Number(i)+1+"_"+(Number(a)+1);n[r]={verticesChild:{dependencyType:"child",childLogicName:"atMostOneVertices",variableNames:["pointX"+s]}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let[a,s]=i.split(","),o=Number(a)+1+"_"+(Number(s)+1),u=e[i].verticesChild;u.length===1&&u[0].stateValues["pointX"+o]?r[i]=u[0].stateValues["pointX"+o]:r[i]=Gi.default.fromAst("\uFF3F")}return{newValues:{vertices:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:n,dependencyNamesByKey:r,initialChange:i,stateValues:a}){if(i&&!a.draggable)return{success:!1};let s=[];for(let o in e.vertices){let[u,c]=o.split(","),f=Number(u)+1+"_"+(Number(c)+1);if(n[o].verticesChild.length===1&&n[o].verticesChild[0].stateValues["pointX"+f])s.push({setDependency:r[o].verticesChild,desiredValue:e.vertices[o],childIndex:0,variableIndex:0});else return{success:!1}}return{success:!0,instructions:s}}},t.numericalVertices={isArray:!0,entryPrefixes:["numericalVertex"],forRenderer:!0,returnArraySizeDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),returnArraySize({dependencyValues:e}){return[e.nVertices]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n[r]={vertex:{dependencyType:"stateVariable",variableName:"vertex"+(Number(r)+1)}};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=e[i].vertex.map(s=>s.evaluate_to_constant());a.every(s=>Number.isFinite(s))||(a=Array(a.length).fill(NaN)),r[i]=a}return{newValues:{numericalVertices:r}}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},vertices:{dependencyType:"stateVariable",variableName:"vertices"},nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition:({dependencyValues:e})=>({newValues:{nearestPoint:function(n){if(e.nDimensions!==2||e.nVertices===0)return{};let r=Infinity,i={},a=n.x1.evaluate_to_constant(),s=n.x2.evaluate_to_constant(),o,u,c=e.vertices[0][0].evaluate_to_constant(),f=e.vertices[0][1].evaluate_to_constant();for(let p=1;p<e.nVertices;p++){if(o=c,u=f,c=e.vertices[p][0].evaluate_to_constant(),f=e.vertices[p][1].evaluate_to_constant(),!(Number.isFinite(o)&&Number.isFinite(u)&&Number.isFinite(c)&&Number.isFinite(f)))continue;let d=c-o,m=f-u,v=d*d+m*m;if(v===0)continue;let h=((a-o)*d+(s-u)*m)/v,y;h<=0?y={x1:o,x2:u}:h>=1?y={x1:c,x2:f}:y={x1:o+h*d,x2:u+h*m};let g=Math.pow(a-y.x1,2)+Math.pow(s-y.x2,2);g<r&&(r=g,i=y)}return n.x3!==void 0&&Object.keys(i).length>0&&(i.x3=0),i}}})},t}movePolyline(t,e,n){let r={};for(let i in t)r[i+",0"]=Gi.default.fromAst(t[i][0]),r[i+",1"]=Gi.default.fromAst(t[i][1]);e?this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"vertices",value:r,sourceInformation:n}],transient:e}):this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"vertices",value:r,sourceInformation:n}],event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{pointCoordinates:t}}})}},wn=Qs;var vr=De(Ee()),eo=class extends wn{static componentType="cobwebpolyline";static rendererType="cobwebpolyline";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.attractThreshold={default:.5},e.nPoints={default:1,clamp:[0,Infinity],forRenderer:!0},e.variable={default:vr.default.fromAst("x"),forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();let n=e.newLeaf({name:"exactlyOneInitialPoint",componentType:"initialpoint",number:1}),r=e.newLeaf({name:"exactlyOneFunction",componentType:"function",number:1});return e.newOperator({name:"initialPointAndFunction",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nDimensions.returnDependencies=()=>({}),t.nDimensions.definition=()=>({newValues:{nDimensions:2}}),t.initialPoint={isArray:!0,entryPrefixes:["initialPointX"],returnWrappingComponents(e){return e==="initialPointX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},returnArraySizeDependencies:()=>({}),returnArraySize:()=>[2],returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let i=Number(r)+1;n[r]={initialPointChild:{dependencyType:"child",childLogicName:"exactlyOneInitialPoint",variableNames:["x"+i]}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=Number(i)+1;e[i].initialPointChild.length===1?r[i]=e[i].initialPointChild[0].stateValues["x"+a]:r[i]=0}return{newValues:{initialPoint:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:n,dependencyNamesByKey:r}){let i=[];for(let a in e.initialPoint)if(n[a].initialPointChild.length===1&&n[a].initialPointChild[0].stateValues["x"+(Number(a)+1)])i.push({setDependency:r[a].initialPointChild,desiredValue:e.initialPoint[a],childIndex:0,variableIndex:0});else return{success:!1};return{success:!0,instructions:i}}},t.f={forRenderer:!0,returnDependencies:()=>({functionChild:{dependencyType:"child",childLogicName:"exactlyOneFunction",variableNames:["numericalf"]}}),definition({dependencyValues:e}){return e.functionChild.length===1?{newValues:{f:e.functionChild[0].stateValues.numericalf}}:{newValues:{f:null}}}},t.nVertices={isAlias:!0,targetVariableName:"nPoints"},t.nOriginalVertices={providePreviousValuesInDefinition:!0,returnDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition({dependencyValues:e,previousValues:n}){let r=e.nVertices;return n.nOriginalVertices>r&&(r=n.nOriginalVertices),{newValues:{nOriginalVertices:r}}}},t.originalVertices={essential:!0,isArray:!0,nDimensions:2,entryPrefixes:["originalVertexX","originalVertex"],defaultEntryValue:vr.default.fromAst(0),getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="originalVertexX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}},returnArraySizeDependencies:()=>({nOriginalVertices:{dependencyType:"stateVariable",variableName:"nOriginalVertices"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nOriginalVertices-1,e.nDimensions]},returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey({arrayKeys:e}){let n={};for(let r of e){let i=r.split(",").map(a=>Number(a)+1).join("_");n[r]={variablesToCheck:["originalVertex"+i]}}return{useEssentialOrDefaultValue:{originalVertices:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let n=[];for(let r in e.originalVertices)n.push({setStateVariable:"originalVertices",value:{[r]:e.originalVertices[r]}});return{success:!0,instructions:n}}},t.vertices.additionalStateVariablesDefined=[{variableName:"prelimCorrectVertices",entryPrefixes:["prelimCorrectVertexX","prelimCorrectVertex"],getArrayKeysFromVarName:function({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="prelimCorrectVertexX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}}}],t.vertices.basedOnArrayKeyStateVariables=!0,t.vertices.returnArrayDependenciesByKey=function({arrayKeys:e}){let n={f:{dependencyType:"stateVariable",variableName:"f"},attractThreshold:{dependencyType:"stateVariable",variableName:"attractThreshold"}},r={};for(let i of e){let[a,s]=i.split(",");a==="0"?r[i]={initialPoint:{dependencyType:"stateVariable",variableName:"initialPointX"+(Number(s)+1)}}:r[i]={originalVertexX1:{dependencyType:"stateVariable",variableName:"originalVertexX"+a+"_1"},originalVertexX2:{dependencyType:"stateVariable",variableName:"originalVertexX"+a+"_2"},previousVertexX1:{dependencyType:"stateVariable",variableName:"vertexX"+a+"_1"},previousVertexX2:{dependencyType:"stateVariable",variableName:"vertexX"+a+"_2"}}}return{globalDependencies:n,dependenciesByKey:r}},t.vertices.arrayDefinitionByKey=function({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={},a={};for(let s of r){let[o,u]=s.split(",");if(o==="0")i[s]=n[s].initialPoint,a[s]=null;else{let c,f;try{c=[n[s].originalVertexX1.evaluate_to_constant(),n[s].originalVertexX2.evaluate_to_constant()],f=[n[s].previousVertexX1.evaluate_to_constant(),n[s].previousVertexX2.evaluate_to_constant()]}catch(m){i[o+",0"]=vr.default.fromAst(0),i[o+",1"]=vr.default.fromAst(0),a[o+",0"]=!1;continue}let p;if(Number(o)%2==1){let m=e.f(f[0]);p=[f[0],m]}else p=[f[1],f[1]];Math.pow(c[0]-p[0],2)+Math.pow(c[1]-p[1],2)<e.attractThreshold*e.attractThreshold?(i[o+",0"]=vr.default.fromAst(p[0]),i[o+",1"]=vr.default.fromAst(p[1]),a[o+",0"]=!0):(i[o+",0"]=n[s].originalVertexX1,i[o+",1"]=n[s].originalVertexX2,a[o+",0"]=!1),a[o+",1"]=null}}return{newValues:{vertices:i,prelimCorrectVertices:a}}},t.vertices.inverseArrayDefinitionByKey=function({desiredStateVariableValues:e,dependencyNamesByKey:n,initialChange:r,stateValues:i}){if(r&&!i.draggable)return{success:!1};let a=[];for(let s in e.vertices){let[o,u]=s.split(",");o==="0"?a.push({setDependency:n[s].initialPoint,desiredValue:e.vertices[s]}):a.push({setDependency:n[s]["originalVertexX"+(Number(u)+1)],desiredValue:e.vertices[s]})}return{success:!0,instructions:a}},t.correctVertices={isArray:!0,public:!0,componentType:"boolean",entryPrefixes:["correctVertex"],returnArraySizeDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),returnArraySize({dependencyValues:e}){return[e.nVertices-1]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n[r]={prelimCorrectVertex:{dependencyType:"stateVariable",variableName:"prelimCorrectVertexX"+(Number(r)+2)+"_1"}};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n)r[i]=e[i].prelimCorrectVertex;return{newValues:{correctVertices:r}}}},t.fractionCorrectVertices={public:!0,componentType:"number",additionalStateVariablesDefined:[{variableName:"nGradedVertices",public:!0,componentType:"number"},{variableName:"nCorrectVertices",public:!0,componentType:"number"}],returnDependencies:()=>({correctVertices:{dependencyType:"stateVariable",variableName:"correctVertices"}}),definition({dependencyValues:e}){let n=e.correctVertices.length,r,i;return n===0?(r=0,i=0):(i=e.correctVertices.reduce((a,s)=>a+s,0),r=i/n),{newValues:{fractionCorrectVertices:r,nGradedVertices:n,nCorrectVertices:i}}}},t.nIterateValues={public:!0,componentType:"number",returnDependencies:()=>({nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition:({dependencyValues:e})=>({newValues:{nIterateValues:Math.ceil((e.nVertices+1)/2)}})},t.iterateValues={isArray:!0,public:!0,componentType:"number",entryPrefixes:["iterateValue"],returnArraySizeDependencies:()=>({nIterateValues:{dependencyType:"stateVariable",variableName:"nIterateValues"}}),returnArraySize({dependencyValues:e}){return[e.nIterateValues]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)r==="0"?n[r]={iterateValue:{dependencyType:"stateVariable",variableName:"vertexX1_1"}}:n[r]={iterateValue:{dependencyType:"stateVariable",variableName:"vertexX"+2*Number(r)+"_2"}};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n)r[i]=e[i].iterateValue;return{newValues:{iterateValues:r}}}},t.childrenToRender={returnDependencies:()=>({}),definition:()=>({newValues:{childrenToRender:[]}})},t}updateState(t={}){super.updateState(t),t.init&&(this.makePublicStateVariableArray({variableName:"iteratevalues",componentType:"number"}),this.makePublicStateVariableArrayEntry({entryName:"iteratevalue",arrayVariableName:"iteratevalues"}),this.makePublicStateVariableAlias({variableName:"lastvertex",targetName:"vertex",arrayIndex:"-1"}),this.state.draggablePoints=[]);let e=!1;(childrenChanged||trackChanges.getVariableChanges({component:this.state.initialPointChild,variable:"coords"})||trackChanges.getVariableChanges({component:this,variable:"vertices",index:0}))&&(this.state.initialPoint=this.state.initialPointChild.state.coords.copy(),this.state.vertices[0]=this.state.initialPoint,e=!0);let n=this.state.vertices.length;if(this.state.nPoints>n){let i=Math.min(this.state.nPoints,n+this.state.removedVertices.length);i>n&&(this.state.vertices.push(...this.state.removedVertices.slice(0,i-n)),this.state.removedVertices=this.state.removedVertices.slice(i-n),n=i);for(let a=n;a<this.state.nPoints;a++){let s=vr.default.fromAst(["tuple",0,0]);this.state.vertices.push(s)}}else this.state.nPoints<n&&(this.state.removedVertices=[...this.state.vertices.slice(this.state.nPoints),...this.state.removedVertices],this.state.vertices.length=this.state.nPoints,this.state.correctvertices.length=this.state.nPoints-1);this.state.draggablePoints.length!==this.state.nPoints&&(this.state.draggablePoints=new Array(this.state.nPoints).fill(!1),this.state.nPoints>1&&(this.state.draggablePoints[this.state.nPoints-1]=!0));let r=[];e?(r=[...Array(this.state.nPoints).keys()].slice(1),this.state.correctvertices=[]):this.state.nPoints>1&&(r=[this.state.nPoints-1]);for(let i of r){let a;if(i%2==1){let s=this.state.vertices[i-1],o=this.findFiniteNumericalValue(s.get_component(0)),u=this.state.f(o);a=[o,u]}else{let s=this.state.vertices[i-1],o=this.findFiniteNumericalValue(s.get_component(1));a=[o,o]}if(a!==void 0){let s=this.state.vertices[i],o=this.findFiniteNumericalValue(s.get_component(0)),u=this.findFiniteNumericalValue(s.get_component(1));Math.pow(o-a[0],2)+Math.pow(u-a[1],2)<this.state.attractThreshold*this.state.attractThreshold?(this.state.vertices[i]=vr.default.fromAst(["tuple",...a]),this.state.correctvertices[i-1]=!0):this.state.correctvertices[i-1]=!1}}this.state.iteratevalues=this.state.vertices.filter((i,a)=>a%2==1).map(i=>i.get_component(1).evaluate_to_constant())}initializeRenderer({}){if(this.renderer!==void 0){this.updateRenderer();return}if(this.unresolvedState.vertices===void 0){let t={movePolyline:this.movePolyline};this.renderer=new this.availableRenderers.polyline2d({key:this.componentName,actions:t,label:this.state.label,draggable:!1,layer:this.state.layer,visible:!this.state.hide,pointcoords:this.state.vertices.map(e=>[e.get_component(0).evaluate_to_constant(),e.get_component(1).evaluate_to_constant()]),color:this.state.selectedStyle.lineColor,width:this.state.selectedStyle.lineWidth,style:this.state.selectedStyle.lineStyle,pointColor:this.state.selectedStyle.markerColor,pointSize:this.state.selectedStyle.markerSize,pointStyle:this.state.selectedStyle.markerStyle})}}updateRenderer(){this.renderer.updatePolyline({visible:!this.state.hide,pointcoords:this.state.vertices.map(t=>[t.get_component(0).evaluate_to_constant(),t.get_component(1).evaluate_to_constant()])})}calculateDownstreamChanges({stateVariablesToUpdate:t,stateVariableChangesToSave:e,dependenciesToUpdate:n}){let r={},i=new Set([]),a=Array(this.state.nPoints);for(let c in t)if(c==="vertices"){r[c]===void 0&&(r[c]={isArray:!0,changes:{arrayComponents:{}}});for(let f in t[c].changes.arrayComponents)i.add(Number(f)),a[f]=r[c].changes.arrayComponents[f]=t[c].changes.arrayComponents[f]}i.has(0)&&(n[this.state.initialPointChild.componentName]={coords:{changes:a[0]}});let s=this.updateShadowSources({newStateVariables:r,dependenciesToUpdate:n}),o=s.shadowedStateVariables,u=s.isReplacement;for(let c in r)this._state[c].essential===!0&&!o.has(c)&&!u&&(e[c]=r[c]);return!0}},ih=eo;var ah=class extends fn{static componentType="initialcondition";static rendererType="math";""},sh=class extends Se{static componentType="hideinitialcondition";static rendererType="boolean"},oh=class extends Dr{static componentType="initialpoint";static rendererType="point"};var ro={};mt(ro,{FeedbackDefinition:()=>lh,FeedbackDefinitions:()=>uh});var lh=class extends _e{static componentType="feedbackdefinition";static createPropertiesObject(){return{}}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneFeedbackCode",componentType:"feedbackcode",number:1}),r=e.newLeaf({name:"exactlyOneFeedbackText",componentType:"feedbacktext",number:1});return e.newOperator({name:"feedbackMapping",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={returnDependencies:()=>({feedbackCodeChild:{dependencyType:"child",childLogicName:"exactlyOneFeedbackCode",variableNames:["value"]},feedbackTextChild:{dependencyType:"child",childLogicName:"exactlyOneFeedbackText",variableNames:["value"]}}),definition:({dependencyValues:e})=>({newValues:{value:{feedbackCode:e.feedbackCodeChild[0].stateValues.value.toLowerCase(),feedbackText:e.feedbackTextChild[0].stateValues.value}}})},t}},uh=class extends _e{static componentType="feedbackdefinitions";static createPropertiesObject(){return{}}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroFeedbackDefinitions",componentType:"feedbackDefinition",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nDefinitions={returnDependencies:()=>({feedbackDefinitionChildren:{dependencyType:"child",childLogicName:"atLeastZeroFeedbackDefinitions"}}),definition:({dependencyValues:e})=>({newValues:{nDefinitions:e.feedbackDefinitionChildren.length}})},t.value={isArray:!0,entryPrefixes:["feedbackDefinition"],returnArraySizeDependencies:()=>({nDefinitions:{dependencyType:"stateVariable",variableName:"nDefinitions"}}),returnArraySize({dependencyValues:e}){return[e.nDefinitions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n.feedbackDefinitionChild={dependencyType:"child",childLogicName:"atLeastZeroFeedbackDefinitions",variableNames:["value"],childIndices:[r]};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=e[i].feedbackDefinitionChild;a.length===1&&(r[i]=a[0].stateValues.value)}return{newValues:{value:r}}}},t}};var no={};mt(no,{StyleDefinition:()=>ch,StyleDefinitions:()=>fh});var io=["lineColor","lineWidth","lineStyle","markerColor","markerStyle","markerSize"],ch=class extends _e{static componentType="styledefinition";static createPropertiesObject(){return{}}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneStyleNumber",componentType:"stylenumber",number:1}),r=[];for(let i of io)r.push(e.newLeaf({name:`atMostOne${i}`,componentType:i,comparison:"atMost",number:1}));return e.newOperator({name:"styleMapping",operator:"and",propositions:[n,...r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={returnDependencies:function(){let e={styleNumberChild:{dependencyType:"child",childLogicName:"exactlyOneStyleNumber",variableNames:["value"]}};for(let n of io)e[`${n}Child`]={dependencyType:"child",childLogicName:`atMostOne${n}`,variableNames:["value"]};return e},definition:function({dependencyValues:e}){let n={styleNumber:e.styleNumberChild[0].stateValues.value};for(let r of io)e[`${r}Child`].length===1&&(n[r]=e[`${r}Child`][0].stateValues.value);return{newValues:{value:n}}}},t}},fh=class extends _e{static componentType="styledefinitions";static createPropertiesObject(){return{}}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroStyleDefinitions",componentType:"styleDefinition",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nDefinitions={returnDependencies:()=>({styleDefinitionChildren:{dependencyType:"child",childLogicName:"atLeastZeroStyleDefinitions"}}),definition:({dependencyValues:e})=>({newValues:{nDefinitions:e.styleDefinitionChildren.length}})},t.value={isArray:!0,entryPrefixes:["styleDefinition"],returnArraySizeDependencies:()=>({nDefinitions:{dependencyType:"stateVariable",variableName:"nDefinitions"}}),returnArraySize({dependencyValues:e}){return[e.nDefinitions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n.styleDefinitionChild={dependencyType:"child",childLogicName:"atLeastZeroStyleDefinitions",variableNames:["value"],childIndices:[r]};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=e[i].styleDefinitionChild;a.length===1&&(r[i]=a[0].stateValues.value)}return{newValues:{value:r}}}},t}};var ao={};mt(ao,{LineColor:()=>dh,LineStyle:()=>hh,LineWidth:()=>mh,MarkerColor:()=>vh,MarkerSize:()=>yh,MarkerStyle:()=>gh,StyleNumber:()=>ph});var ph=class extends Oe{static componentType="stylenumber";static rendererType="number"},dh=class extends Pe{static componentType="lineColor";static rendererType="text"},mh=class extends Oe{static componentType="lineWidth";static rendererType="number"},hh=class extends Pe{static componentType="lineStyle";static rendererType="text"},vh=class extends Pe{static componentType="markerColor";static rendererType="text"},yh=class extends Oe{static componentType="markerSize";static rendererType="number"},gh=class extends Pe{static componentType="markerStyle";static rendererType="text"};var so=class extends _e{static componentType="document";static rendererType="section";static createsVariants=!0;static alwaysSetUpVariant=!0;static createPropertiesObject(){return{feedbackDefinitions:{get default(){return m1()},propagateToDescendants:!0,mergeArrayWithDefault:!0},styleDefinitions:{get default(){return cn()},propagateToDescendants:!0,mergeArrayWithDefault:!0}}}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneMeta",componentType:"meta",comparison:"atMost",number:1,allowSpillover:!1}),r=e.newLeaf({name:"atMostOneVariantControl",componentType:"variantcontrol",comparison:"atMost",number:1,allowSpillover:!1}),i=e.newLeaf({name:"atMostOneTitle",componentType:"title",comparison:"atMost",number:1}),a=e.newLeaf({name:"atMostOneDescription",componentType:"description",comparison:"atMost",number:1}),s=e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0});return e.newOperator({name:"variantTitleDescriptionMetaAnything",operator:"and",propositions:[r,i,a,n,s],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.titleDefinedByChildren={forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childLogicName:"atMostOneTitle"}}),definition({dependencyValues:e}){return{newValues:{titleDefinedByChildren:e.titleChild.length===1}}}},t.title={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childLogicName:"atMostOneTitle",variableNames:["text"]}}),definition({dependencyValues:e}){return e.titleChild.length===0?{newValues:{title:""}}:{newValues:{title:e.titleChild[0].stateValues.text}}}},t.description={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({descriptionChild:{dependencyType:"child",childLogicName:"atMostOneDescription",variableNames:["text"]}}),definition({dependencyValues:e}){return e.descriptionChild.length===0?{newValues:{description:""}}:{newValues:{description:e.descriptionChild[0].stateValues.text}}}},t.level={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{level:0}})},t.viewedSolution={defaultValue:!1,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{viewedSolution:{variablesToCheck:["viewedSolution"]}}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"viewedSolution",value:e.viewedSolution}]}}},t.scoredDescendants={returnDependencies:()=>({scoredDescendants:{dependencyType:"descendant",componentTypes:["_sectioningcomponent","answer"],variableNames:["scoredDescendants","aggregateScores","weight"],recurseToMatchedChildren:!1,variablesOptional:!0}}),definition({dependencyValues:e}){let n=[];for(let r of e.scoredDescendants)r.stateValues.aggregateScores||r.stateValues.scoredDescendants===void 0?n.push(r):n.push(...r.stateValues.scoredDescendants);return{newValues:{scoredDescendants:n}}}},t.nScoredDescendants={returnDependencies:()=>({scoredDescendants:{dependencyType:"stateVariable",variableName:"scoredDescendants"}}),definition({dependencyValues:e}){return{newValues:{nScoredDescendants:e.scoredDescendants.length}}}},t.itemCreditAchieved={isArray:!0,returnArraySizeDependencies:()=>({nScoredDescendants:{dependencyType:"stateVariable",variableName:"nScoredDescendants"}}),returnArraySize({dependencyValues:e}){return[e.nScoredDescendants]},stateVariablesDeterminingDependencies:["scoredDescendants"],returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={};for(let i of e){let a=n.scoredDescendants[i];a&&(r[i]={creditAchieved:{dependencyType:"stateVariable",componentName:a.componentName,variableName:"creditAchieved"}})}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n)r[i]=e[i].creditAchieved;return{newValues:{itemCreditAchieved:r}}},markStaleByKey({arrayKeys:e,changes:n}){if(n.__array_size||n.__array_keys)return{itemScoreChanged:{itemNumbers:e}};let r=/^__(\d+)_/,i=[];for(let a in n){let s=r.exec(a);s&&i.push(s[1])}return{itemScoreChanged:{itemNumbers:i}}}},t.displayDigitsForCreditAchieved={returnDependencies:()=>({}),definition:()=>({newValues:{displayDigitsForCreditAchieved:3}})},t.creditAchieved={public:!0,componentType:"number",defaultValue:0,stateVariablesPrescribingAdditionalProperties:{displayDigits:"displayDigitsForCreditAchieved"},additionalStateVariablesDefined:[{variableName:"percentCreditAchieved",public:!0,componentType:"number",stateVariablesPrescribingAdditionalProperties:{displayDigits:"displayDigitsForCreditAchieved"}}],returnDependencies:()=>({scoredDescendants:{dependencyType:"stateVariable",variableName:"scoredDescendants"},itemCreditAchieved:{dependencyType:"stateVariable",variableName:"itemCreditAchieved"}}),definition({dependencyValues:e}){let n=0,r=0;for(let[s,o]of e.scoredDescendants.entries()){let u=o.stateValues.weight;n+=e.itemCreditAchieved[s]*u,r+=u}let i=n/r,a=i*100;return{newValues:{creditAchieved:i,percentCreditAchieved:a}}}},t.selectedVariantInfo={returnDependencies:({sharedParameters:e,componentInfoObjects:n})=>({variantNumber:{dependencyType:"value",value:e.variantNumber},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(n.componentTypeWithPotentialVariants),variableNames:["isVariantComponent","selectedVariantInfo"],recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfMatchedComposites:!0,definingChildrenFirst:!0}}),definition({dependencyValues:e}){let n={index:e.variantNumber},r=n.subvariants=[];for(let i of e.variantDescendants)i.stateValues.isVariantComponent?r.push(i.stateValues.selectedVariantInfo):i.stateValues.selectedVariantInfo&&r.push(...i.stateValues.selectedVariantInfo.subvariants);return{newValues:{selectedVariantInfo:n}}}},t.childrenToRender={returnDependencies:()=>({titleChild:{dependencyType:"child",childLogicName:"atMostOneTitle"},activeChildren:{dependencyType:"child",childLogicName:"anything"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:[...e.titleChild,...e.activeChildren].map(n=>n.componentName)}}}},t}submitAllAnswers(){let t=[];for(let e of this.descendantsFound.answer)e.state.allAwardsJustSubmitted||t.push(e);if(this.answersToSubmitCounter=t.length,this.answersToSubmitCounter===0)this.externalFunctions.allAnswersSubmitted();else for(let e of t)e.submitAnswer()}static setUpVariant({serializedComponent:t,sharedParameters:e,definingChildrenSoFar:n,allComponentClasses:r}){let i;for(let s of n)if(s!==void 0&&s.componentType==="variantcontrol"){i=s;break}if(i===void 0){let s=100;t.variants.uniquevariants&&(s=t.variants.numberOfVariants),e.allPossibleVariants=[...Array(s).keys()].map(bh);let o,u=t.variants.desiredVariant;if(u!==void 0){if(u.index!==void 0){let p=Number(u.index);if(Number.isInteger(p))o=p%s,o<0&&(o+=s);else throw Error("Variant number "+u.index+" must be an integer")}else if(u.value!==void 0){if(typeof u.value=="string"){let p=e.allPossibleVariants.indexOf(u.value.toLowerCase());p!==-1&&(o=p)}o===void 0&&(console.log("Variant "+u.value+" is not valid, convert to variant index"),o=Math.abs(e.hashStringToInteger(JSON.stringify(u.value))%s),console.log(o))}}if(o===void 0){let p=e.selectRng.random();o=Math.floor(p*s)}let c=o+1,f=e.hashStringToInteger(c.toString());e.variantNumber=o,e.variant=bh(o),e.selectRng=new e.rngClass(f),t.variants.generatedSelectParameters={selectRng:e.selectRng,variant:e.variant,allPossibleVariants:e.allPossibleVariants}}else e.variant=i.state.selectedVariant.value,e.variantNumber=i.state.selectedVariantNumber.value,e.selectRng=i.state.selectRng.value,e.allPossibleVariants=i.state.variants.value;console.log("Document variant: "+e.variant);let a=t.variants.desiredVariant;if(a===void 0&&(a={}),a.subvariants===void 0&&t.variants.uniquevariants){let s=this.getUniqueVariant({serializedComponent:t,variantNumber:e.variantNumber,allComponentClasses:r});s.success&&Object.assign(a,s.desiredVariant)}if(a.subvariants!==void 0&&t.variants.descendantVariantComponents!==void 0)for(let s in a.subvariants){let o=a.subvariants[s],u=t.variants.descendantVariantComponents[s];if(u===void 0)break;u.variants.desiredVariant=o}}static determineNumberOfUniqueVariants({serializedComponent:t}){if(t.children===void 0)return{success:!0,numberOfVariants:1};let e,n;for(let[o,u]of t.children.entries())if(u.componentType==="variantcontrol"||u.createdComponent&&components[u.componentName].componentType==="variantcontrol"){e=o,n=u;break}let r=100;if(e!==void 0&&n.children!==void 0){for(let o of n.children)if(o.componentType==="nvariants"){let u=!1;if(o.state!==void 0&&o.state.value!==void 0&&(r=Math.round(Number(o.state.value)),u=!0),o.children!==void 0&&o.children.length===1&&o.children[0].componentType==="string"&&(r=Math.round(Number(o.children[0].state.value)),u=!0),!u)return{success:!1};break}}let i,a=1,s=[];return t.variants.descendantVariantComponents!==void 0&&(s=t.variants.descendantVariantComponents.map(o=>o.variants.numberOfVariants),a=s.reduce((o,u)=>o*u,1),i={numberOfVariantsByDescendant:s}),r=Math.min(a,r),{success:!0,numberOfVariants:r,uniqueVariantData:i}}static getUniqueVariant({serializedComponent:t,variantNumber:e,allComponentClasses:n}){if(t.variants===void 0)return{succes:!1};let r=t.variants.numberOfVariants;if(r===void 0)return{success:!1};if(!Number.isInteger(e)||e<0||e>=r)return{success:!1};let i=Nn({variantNumber:e,serializedComponent:t,allComponentClasses:n});return i.success?{success:!0,desiredVariant:{subvariants:i.desiredVariants}}:(console.log("Failed to get unique variant for document."),{success:!1})}static includeBlankStringChildren=!0},xh=so;function bh(l){let t="";for(;;){let e=l%26;if(t=String.fromCharCode(97+e)+t,l<26)break;l=Math.floor(l/26)-1}return t}function m1(){return[{feedbackCode:"numericalerror",feedbackText:"Credit reduced because numbers in your answer weren't quite right.  Did you round too much?"},{feedbackCode:"goodjob",feedbackText:"Good job!"},{feedbackCode:"onesignerror",feedbackText:"Credit reduced because it appears that you made a sign error."},{feedbackCode:"twosignerrors",feedbackText:"Credit reduced because it appears that you made two sign errors."}]}var oo=class extends Me{static componentType="string";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["value"]}static createPropertiesObject(){return{hide:{default:!1}}}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={returnDependencies:()=>({}),defaultValue:"",forRenderer:!0,set:String,definition:()=>({useEssentialOrDefaultValue:{value:{variablesToCheck:"value"}}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"value",value:String(e.value)}]}}},t.text={returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition({dependencyValues:e}){return{newValues:{text:e.value}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"value",desiredValue:e.text}]}}},t}},Ch=oo;var lo=class extends Pe{static componentType="letters";static rendererType="text";updateState(t={}){if(super.updateState(t),!(!this.childLogicSatisfied||this.unresolvedState.value)&&!h1.test(this.state.value))throw Error("Letters can only contain a-z or A-Z: '"+this.state.value+"' is invalid.")}},Nh=lo,h1=/^[a-zA-Z]*$/;var uo=class extends Me{static componentType="randomizedtextlist";static stateVariableForPropertyValue="texts";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.unordered={default:!1},e.maximumNumber={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroTexts",componentType:"text",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroTextlists",componentType:"textlist",comparison:"atLeast",number:0}),i=function({dependencyValues:o}){let u=o.stringChildren[0],c=u.stateValues.value.split(",").map(f=>({componentType:"text",state:{value:f.trim()}}));return{success:!0,newChildren:c,toDelete:[u.componentName]}},a=e.newLeaf({name:"exactlyOneString",componentType:"string",number:1,isSugar:!0,returnSugarDependencies:()=>({stringChildren:{dependencyType:"child",childLogicName:"exactlyOneString",variableNames:["value"]}}),logicToWaitOnSugar:["atLeastZeroTexts"],replacementFunction:i}),s=e.newOperator({name:"textAndTextLists",operator:"and",propositions:[n,r]});return e.newOperator({name:"TextsXorSugar",operator:"xor",propositions:[a,s],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.texts={public:!0,componentType:"text",isArray:!0,entryPrefixes:["text"],returnDependencies:()=>({textAndTextlistChildren:{dependencyType:"child",childLogicName:"textAndTextLists",variableNames:["value","texts"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},childrenToRender:{dependencyType:"stateVariable",variableName:"childrenToRender"}}),definition:function({dependencyValues:e}){let n=[],r=e.textAndTextlistChildren.map(i=>i.componentName);for(let i of e.childrenToRender){let a=r.indexOf(i),s=e.textAndTextlistChildren[a];s.stateValues.texts?n.push(...s.stateValues.texts):n.push(s.stateValues.value)}return{newValues:{texts:n}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({texts:{dependencyType:"stateVariable",variableName:"texts"}}),definition:({dependencyValues:e})=>({newValues:{text:e.texts.join(", ")}})},t.nComponents={public:!0,componentType:"number",returnDependencies:()=>({texts:{dependencyType:"stateVariable",variableName:"texts"}}),definition:function({dependencyValues:e}){return{newValues:{nComponents:e.texts.length}}}},t.childrenToRender={returnDependencies:({sharedParameters:e})=>({textAndTextlistChildren:{dependencyType:"child",childLogicName:"textAndTextLists",variableNames:["childrenToRender"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},selectRng:{dependencyType:"value",value:e.selectRng,doNotProxy:!0}}),definition:function({dependencyValues:e}){let n=[];for(let a of e.textAndTextlistChildren)a.stateValues.childrenToRender?n.push(...a.stateValues.childrenToRender):n.push(a.componentName);let r=e.maximumNumber;r!==null&&n.length>r&&(r=Math.max(0,Math.floor(r)),n=n.slice(0,r)),console.log("randomizing children");for(let a=n.length-1;a>0;a--){let s=e.selectRng.random(),o=Math.floor(s*(a+1));[n[a],n[o]]=[n[o],n[a]]}let i=Math.ceil(e.selectRng.random()*n.length);return console.log(`numChildren: ${i}`),n=n.slice(0,i),{newValues:{childrenToRender:n}}}},t}initializeRenderer(){this.renderer===void 0&&(this.renderer=new this.availableRenderers.aslist({key:this.componentName}))}},wh=uo;var co=class extends We{static componentType="p";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroInline",componentType:"_inline",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"atLeastZeroInline"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({inlineChildren:{dependencyType:"child",childLogicName:"atLeastZeroInline",variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let n="";for(let r of e.inlineChildren)typeof r.stateValues.text=="string"?n+=r.stateValues.text:n+=" ";return{newValues:{text:n}}}},t}static includeBlankStringChildren=!0},Th=co;var fo=class extends Me{static componentType="booleanlist";static rendererType="aslist";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.unordered={default:!1},e.maximumNumber={default:void 0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=n.reduce(function(i,a){return a.componentType==="string"?[...i,...a.state.value.split(/\s+/).filter(s=>s).map(s=>({componentType:"boolean",children:[{componentType:"string",state:{value:s}}]}))]:[...i,a]},[]);return{success:!0,newChildren:r}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroBooleans",componentType:"boolean",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroBooleanlists",componentType:"booleanlist",comparison:"atLeast",number:0});return e.newOperator({name:"booleanAndBooleanLists",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.overrideChildHide={returnDependencies:()=>({}),definition:()=>({newValues:{overrideChildHide:!0}})},t.nComponents={public:!0,componentType:"number",additionalStateVariablesDefined:["childIndexByArrayKey"],returnDependencies(){return{maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"},booleanAndBooleanlistChildren:{dependencyType:"child",childLogicName:"booleanAndBooleanLists",variableNames:["nComponents"],variablesOptional:!0}}},definition:function({dependencyValues:e}){let n=0,r=[];for(let[a,s]of e.booleanAndBooleanlistChildren.entries())if(s.stateValues.nComponents!==void 0){for(let o=0;o<s.stateValues.nComponents;o++)r[n+o]=[a,o];n+=s.stateValues.nComponents}else r[n]=[a,0],n+=1;let i=e.maximumNumber;return i!==null&&n>i&&(n=i,r=r.slice(0,i)),{newValues:{nComponents:n,childIndexByArrayKey:r},checkForActualChange:{nComponents:!0}}}},t.booleans={public:!0,componentType:"boolean",isArray:!0,entryPrefixes:["boolean"],stateVariablesDeterminingDependencies:["childIndexByArrayKey"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:e}){return[e.nComponents]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={},i={childIndexByArrayKey:{dependencyType:"stateVariable",variableName:"childIndexByArrayKey"}};for(let a of e){let s=[],o="1";n.childIndexByArrayKey[a]&&(s=[n.childIndexByArrayKey[a][0]],o=n.childIndexByArrayKey[a][1]+1),r[a]={booleanAndBooleanlistChildren:{dependencyType:"child",childLogicName:"booleanAndBooleanLists",variableNames:["value","boolean"+o],variablesOptional:!0,childIndices:s}}}return{globalDependencies:i,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].booleanAndBooleanlistChildren[0];if(s)if(s.stateValues.value!==void 0)i[a]=s.stateValues.value;else{let o=e.childIndexByArrayKey[a][1]+1;i[a]=s.stateValues["boolean"+o]}}return{newValues:{booleans:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){let s=[];for(let o in e.booleans){if(!r[o])continue;let u=r[o].booleanAndBooleanlistChildren[0];u&&(u.stateValues.value!==void 0?s.push({setDependency:i[o].booleanAndBooleanlistChildren,desiredValue:e.booleans[o],childIndex:0,variableIndex:0}):s.push({setDependency:i[o].booleanAndBooleanlistChildren,desiredValue:e.booleans[o],childIndex:0,variableIndex:1}))}return{success:!0,instructions:s}}},t.nValues={isAlias:!0,targetVariableName:"nComponents"},t.values={isAlias:!0,targetVariableName:"booleans"},t.childrenToRender={returnDependencies:()=>({booleanAndBooleanlistChildren:{dependencyType:"child",childLogicName:"booleanAndBooleanLists",variableNames:["childrenToRender"],variablesOptional:!0},maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}),definition:function({dependencyValues:e,componentInfoObjects:n}){let r=[];for(let a of e.booleanAndBooleanlistChildren)n.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"booleanlist"})?r.push(...a.stateValues.childrenToRender):r.push(a.componentName);let i=e.maximumNumber;return i!==null&&r.length>i&&(i=Math.max(0,Math.floor(i)),r=r.slice(0,i)),{newValues:{childrenToRender:r}}}},t}},_h=fo;function Lt({serializedComponents:l,componentName:t,addShadowDependencies:e=!0,uniqueIdentifiersUsed:n,identifierPrefix:r=""}){return po({serializedComponents:l,componentName:t,addShadowDependencies:e,uniqueIdentifiersUsed:n,identifierPrefix:r}),l}function po({serializedComponents:l,componentName:t,addShadowDependencies:e=!0,uniqueIdentifiersUsed:n=[],identifierPrefix:r=""}){for(let i in l){let a=l[i],s;if(a.originalName){if(s=r+a.originalName+"|shadow",e&&!a.originalNameFromSerializedComponent){let o={[a.originalName]:[{dependencyType:"referenceShadow",compositeName:t}]};if(a.state){let u=Object.keys(a.state);o[a.originalName].downstreamStateVariables=u,o[a.originalName].upstreamStateVariables=u}a.includeAnyDefiningChildren&&(o[a.originalName].includeAnyDefiningChildren=a.includeAnyDefiningChildren),a.includePropertyChildren&&(o[a.originalName].includePropertyChildren=a.includePropertyChildren),a.downstreamDependencies=o}}else s=r+a.componentType+"|shadowUnnamed";a.uniqueIdentifier=dr(s,n),po({serializedComponents:a.children,componentName:t,addShadowDependencies:e,uniqueIdentifiersUsed:n,identifierPrefix:r}),a.replacements&&po({serializedComponents:a.replacements,componentName:t,addShadowDependencies:e,uniqueIdentifiersUsed:n,identifierPrefix:r})}}var mo=class extends Ue{constructor(t){super(t);this.processNewDoenetML=this.processNewDoenetML.bind(this)}static componentType="copy";static assignNamesToReplacements=!0;static acceptTname=!0;static acceptProp=!0;static get stateVariablesShadowedForReference(){return["targetComponent","propName"]}static createPropertiesObject({allPossibleProperties:t}){if(t===void 0)return{};let e={};for(let n of t)e[n]={ignorePropagationFromAncestors:!0,default:null};return delete e.string,delete e.contentid,delete e.math,delete e.number,delete e.text,e.includeUndefinedObjects={default:!1},e.componentIndex={default:null},e.propIndex={default:null},e.targetPropertiesToIgnore={default:["hide"]},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneContentId",componentType:"contentid",number:1,comparison:"atMost",setAsBase:!0}),e}static returnStateVariableDefinitions({propertyNames:t}){let e=super.returnStateVariableDefinitions();return e.tName={returnDependencies:()=>({tName:{dependencyType:"doenetAttribute",attributeName:"tName"}}),definition:({dependencyValues:n})=>({newValues:{tName:n.tName}})},e.targetSourcesName={additionalStateVariablesDefined:["sourcesChildNumber"],stateVariablesDeterminingDependencies:["tName"],returnDependencies:function({stateValues:n,sharedParameters:r}){let i=r.sourceNameMappings;if(!i)return{};let a=i[n.tName];return a?{targetSourcesName:{dependencyType:"value",value:a.name},sourcesChildNumber:{dependencyType:"value",value:a.childNumber}}:{}},definition:function({dependencyValues:n}){let r=n.targetSourcesName,i=n.sourcesChildNumber;return r||(r=null,i=null),{newValues:{targetSourcesName:r,sourcesChildNumber:i},makeEssential:["targetSourcesName","sourcesChildNumber"]}}},e.targetSources={stateVariablesDeterminingDependencies:["targetSourcesName"],returnDependencies({stateValues:n}){return n.targetSourcesName?{targetSourcesComponent:{dependencyType:"componentIdentity",componentName:n.targetSourcesName}}:{}},definition:function({dependencyValues:n}){let r=n.targetSourcesComponent;return r||(r=null),{newValues:{targetSources:r}}}},e.sourceIndex={stateVariablesDeterminingDependencies:["tName"],returnDependencies:function({stateValues:n,sharedParameters:r}){let i=r.sourceIndexMappings;if(!i)return{};let a=i[n.tName];return a===void 0?{}:{sourceIndex:{dependencyType:"value",value:a}}},definition:function({dependencyValues:n}){let r=n.sourceIndex;return r===void 0&&(r=null),{newValues:{sourceIndex:r},makeEssential:["sourceIndex"]}}},e.targetComponent={stateVariablesDeterminingDependencies:["targetSources","sourceIndex"],returnDependencies({stateValues:n}){return n.sourceIndex!==null?{}:n.targetSources!==null?{targetSourcesChildren:{dependencyType:"stateVariable",componentName:n.targetSources.componentName,variableName:"childIdentities"},sourcesChildNumber:{dependencyType:"stateVariable",variableName:"sourcesChildNumber"}}:{targetComponent:{dependencyType:"targetComponent"}}},definition:function({dependencyValues:n}){let r=null;return n.targetSourcesChildren?(r=n.targetSourcesChildren[n.sourcesChildNumber],r||(r=null)):n.targetComponent&&(r=n.targetComponent),{newValues:{targetComponent:r}}}},e.targetInactive={stateVariablesDeterminingDependencies:["targetComponent"],returnDependencies({stateValues:n}){return n.targetComponent?{targetIsInactiveCompositeReplacement:{dependencyType:"stateVariable",componentName:n.targetComponent.componentName,variableName:"isInactiveCompositeReplacement"}}:{}},definition:function({dependencyValues:n}){return{newValues:{targetInactive:Boolean(n.targetIsInactiveCompositeReplacement)}}}},e.contentId={returnDependencies:()=>({contentIdChild:{dependencyType:"child",childLogicName:"atMostOneContentId",variableNames:["value"]},newNamespace:{dependencyType:"doenetAttribute",attributeName:"newNamespace"}}),defaultValue:null,definition:function({dependencyValues:n}){if(n.contentIdChild.length===0)return{useEssentialOrDefaultValue:{contentId:{variablesToCheck:"contentId"}}};if(!newNamespace.value)throw Error("Cannot copy contentId without specifying a new namespace");return{newValues:{contentId:n.contentIdChild[0].stateValues.value}}}},e.serializedStateForContentId={returnDependencies:()=>({}),defaultValue:null,definition:function(){return{useEssentialOrDefaultValue:{serializedStateForContentId:{variablesToCheck:"serializedStateForContentId"}}}}},e.propName={returnDependencies:()=>({propName:{dependencyType:"doenetAttribute",attributeName:"propName"}}),definition:function({dependencyValues:n}){return{newValues:{propName:n.propName}}}},e.isPlainMacro={returnDependencies:()=>({isPlainMacro:{dependencyType:"doenetAttribute",attributeName:"isPlainMacro"}}),definition:function({dependencyValues:n}){return{newValues:{isPlainMacro:n.isPlainMacro}}}},e.preliminaryReplacementSourceIdentities={stateVariablesDeterminingDependencies:["targetComponent","componentIndex"],returnDependencies:function({stateValues:n,componentInfoObjects:r}){let i={};return n.targetComponent!==null&&(r.isCompositeComponent({componentType:n.targetComponent.componentType,includeNonStandard:!1})?i.targets={dependencyType:"replacement",compositeName:n.targetComponent.componentName,recursive:!0,componentIndex:n.componentIndex}:(n.componentIndex===null||n.componentIndex===1)&&(i.targets={dependencyType:"stateVariable",variableName:"targetComponent"})),i},definition({dependencyValues:n}){let r=null;return n.targets&&(r=n.targets,Array.isArray(r)||(r=[r])),{newValues:{preliminaryReplacementSourceIdentities:r}}}},e.replacementSourceIdentities={additionalStateVariablesDefined:["effectivePropNameBySource"],stateVariablesDeterminingDependencies:["preliminaryReplacementSourceIdentities","propName","isPlainMacro"],returnDependencies:function({stateValues:n,componentInfoObjects:r}){let i={preliminaryReplacementSourceIdentities:{dependencyType:"stateVariable",variableName:"preliminaryReplacementSourceIdentities"}};if(n.preliminaryReplacementSourceIdentities!==null)for(let[a,s]of n.preliminaryReplacementSourceIdentities.entries()){let o=n.propName;n.isPlainMacro&&(o=r.allComponentClasses[s.componentType].variableForPlainMacro),o&&(i["propName"+a]={dependencyType:"value",value:o}),i["target"+a]={dependencyType:"componentIdentity",componentName:s.componentName}}return i},definition({dependencyValues:n}){let r=null,i=null;if(n.preliminaryReplacementSourceIdentities!==null){r=[],i=[];for(let a in n.preliminaryReplacementSourceIdentities)n["target"+a]&&r.push(n["target"+a]),n["propName"+a]&&(i[a]=n["propName"+a])}return{newValues:{replacementSourceIdentities:r,effectivePropNameBySource:i}}}},e.replacementSources={stateVariablesDeterminingDependencies:["preliminaryReplacementSourceIdentities","propName","propIndex","isPlainMacro","effectivePropNameBySource"],returnDependencies:function({stateValues:n,componentInfoObjects:r}){let i={preliminaryReplacementSourceIdentities:{dependencyType:"stateVariable",variableName:"preliminaryReplacementSourceIdentities"}};if(!n.propName&&n.propIndex!==null)throw Error("You cannot specify a propIndex without specifying a prop.");if(n.preliminaryReplacementSourceIdentities!==null)for(let[a,s]of n.preliminaryReplacementSourceIdentities.entries()){let o=n.effectivePropNameBySource[a],u;o?u={dependencyType:"stateVariable",componentName:s.componentName,variableName:o,returnAsComponentObject:!0,variablesOptional:!0,propIndex:n.propIndex,caseInsensitiveVariableMatch:!0,publicStateVariablesOnly:!0,useMappedVariableNames:!0}:u={dependencyType:"componentIdentity",componentName:s.componentName},i["target"+a]=u}return i},definition({dependencyValues:n}){let r=null;if(n.preliminaryReplacementSourceIdentities!==null){r=[];for(let i in n.preliminaryReplacementSourceIdentities)n["target"+i]&&r.push(n["target"+i])}return{newValues:{replacementSources:r}}}},e.readyToExpand={stateVariablesDeterminingDependencies:["targetComponent"],returnDependencies({stateValues:n,componentInfoObjects:r}){let i={targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"},needsReplacementsUpdatedWhenStale:{dependencyType:"stateVariable",variableName:"needsReplacementsUpdatedWhenStale"},replacementSources:{dependencyType:"stateVariable",variableName:"replacementSources"}};return n.targetComponent&&r.isCompositeComponent({componentType:n.targetComponent.componentType,includeNonStandard:!1})&&(i.targetReadyToExpand={dependencyType:"stateVariable",componentName:n.targetComponent.componentName,variableName:"readyToExpand"}),i},definition:function({dependencyValues:n}){let r=!0;return n.targetReadyToExpand!==void 0&&(r=n.targetReadyToExpand),{newValues:{readyToExpand:r}}}},e.needsReplacementsUpdatedWhenStale={stateVariablesDeterminingDependencies:["targetComponent","replacementSourceIdentities","effectivePropNameBySource"],returnDependencies:function({stateValues:n,componentInfoObjects:r}){let i={targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"},targetInactive:{dependencyType:"stateVariable",variableName:"targetInactive"},replacementSourceIdentities:{dependencyType:"stateVariable",variableName:"replacementSourceIdentities"}};if(n.effectivePropNameBySource!==null){for(let[a,s]of n.effectivePropNameBySource.entries())if(s){let o=n.replacementSourceIdentities[a];i["sourceArraySize"+a]={dependencyType:"stateVariableArraySize",componentName:o.componentName,variableName:s,variablesOptional:!0,caseInsensitiveVariableMatch:!0},i["sourceComponentType"+a]={dependencyType:"stateVariableComponentType",componentName:o.componentName,variableName:s,variablesOptional:!0,caseInsensitiveVariableMatch:!0}}}return n.targetComponent!==null&&r.isCompositeComponent({componentType:n.targetComponent.componentType,includeNonStandard:!1})&&(i.allReplacementIdentities={dependencyType:"replacement",compositeName:n.targetComponent.componentName,recursive:!0,variableNames:["isInactiveCompositeReplacement"]}),i},markStale(){return{updateReplacements:!0}},definition:()=>({newValues:{needsReplacementsUpdatedWhenStale:!0}})},e}processNewDoenetML({newDoenetMLs:t,message:e,success:n}){if(!n){console.warn(e);return}let r=(void 0)({doenetML:t[0],standardComponentClasses:this.componentInfoObjects.standardComponentClasses,allComponentClasses:this.componentInfoObjects.allComponentClasses});r=ec(r),hn(r,this.componentInfoObjects.standardComponentClasses),Vr({serializedState:r,componentInfoObjects:this.componentInfoObjects}),this.componentNameToPreserializedName(r,this.componentInfoObjects.componentTypesTakingComponentNames),Yn({serializedState:r,componentTypesCreatingVariants:this.componentInfoObjects.componentTypesCreatingVariants,componentInfoObjects:this.componentInfoObjects}),this.coreFunctions.requestUpdate({updateType:"updateValue",updateInstructions:[{componentName:this.componentName,variableUpdates:{serializedContent:{changes:r},serializedContentChanged:{changes:!0}}}],saveSerializedState:!1})}componentNameToPreserializedName(t,e){for(let n of t){let r=n.componentName;if(r!==void 0&&(n.componentName=this.componentName+r),n.componentType in e){let i;for(let a of n.children)if(a.componentType==="string"){a.state.value=this.componentName+a.state.value;break}n.targetComponentName=i}n.children!==void 0&&this.componentNameToPreserializedName(n.children,e)}}static createSerializedReplacements({component:t,components:e,workspace:n,componentInfoObjects:r}){if(n.numReplacementsBySource=[],n.propVariablesCopiedBySource=[],n.sourceNames=[],n.uniqueIdentifiersUsedBySource={},t.stateValues.needsReplacementsUpdatedWhenStale,t.stateValues.sourceIndex!==null){let o=[{componentType:"number",state:{value:t.stateValues.sourceIndex,fixed:!0},downstreamDependencies:{[t.componentName]:[{dependencyType:"nonShadowingReplacement"}]}}];return{replacements:qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:o,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:r}).serializedComponents}}if(!t.stateValues.targetComponent||!t.stateValues.replacementSources)return{replacements:[]};let i=[],a=[],s=0;for(let o in t.stateValues.replacementSources){let u=n.uniqueIdentifiersUsedBySource[o]=[],c=this.createReplacementForSource({component:t,sourceNum:o,components:e,numReplacementsSoFar:s,uniqueIdentifiersUsed:u,componentInfoObjects:r});n.propVariablesCopiedBySource[o]=c.propVariablesCopiedByReplacement;let f=c.serializedReplacements;a[o]=f.length,s+=f.length,i.push(...f)}return n.numReplacementsBySource=a,n.sourceNames=t.stateValues.replacementSources.map(o=>o.componentName),{replacements:i}}static createReplacementForSource({component:t,sourceNum:e,components:n,numReplacementsSoFar:r,uniqueIdentifiersUsed:i,componentInfoObjects:a}){let s=t.stateValues.replacementSources[e],o=n[s.componentName];if(o.stateValues.isInactiveCompositeReplacement)return{serializedReplacements:[]};if(t.stateValues.effectivePropNameBySource[e]){let f=ri({component:t,components:n,replacementSource:s,propName:t.stateValues.effectivePropNameBySource[e],numReplacementsSoFar:r,uniqueIdentifiersUsed:i});return{serializedReplacements:qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:f.serializedReplacements,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,indOffset:r,componentInfoObjects:a}).serializedComponents,propVariablesCopiedByReplacement:f.propVariablesCopiedByReplacement}}let u=[o.serialize({forCopy:!0})];return u=Lt({serializedComponents:u,componentName:t.componentName,uniqueIdentifiersUsed:i}),{serializedReplacements:qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:u,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,indOffset:r,componentInfoObjects:a}).serializedComponents}}static calculateReplacementChanges({component:t,componentChanges:e,components:n,workspace:r,componentInfoObjects:i}){if(t.stateValues.sourceIndex!==null)return[];t.stateValues.needsReplacementsUpdatedWhenStale;let a=[];if(!t.stateValues.targetComponent||!t.stateValues.replacementSources){if(t.replacements.length>0){let p={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToDelete:t.replacements.length};a.push(p)}return r.sourceNames=[],r.numReplacementsBySource=[],r.propVariablesCopiedBySource=[],a}if(t.stateValues.targetInactive){let p=t.replacements.length;if(p>0&&t.replacementsToWithhold!==p){let d={changeType:"changeReplacementsToWithhold",replacementsToWithhold:p};a.push(d)}return a}if(t.replacementsToWithhold>0){let p={changeType:"changeReplacementsToWithhold",replacementsToWithhold:0};a.push(p)}let s=0,o=[],u=[],c=Math.max(t.stateValues.replacementSourceIdentities.length,r.numReplacementsBySource.length),f=!1;for(let p=0;p<c;p++){let d=t.stateValues.replacementSources[p];if(d===void 0){if(r.numReplacementsBySource[p]>0){if(!f){let C=r.numReplacementsBySource.slice(p).reduce((_,w)=>_+w,0);if(C>0){let _={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:s,numberReplacementsToDelete:C};a.push(_)}f=!0,r.numReplacementsBySource.slice(p).forEach((_,w)=>r.numReplacementsBySource[w]=0)}r.uniqueIdentifiersUsedBySource[p]=[]}o[p]=0,u.push([]);continue}let m=r.sourceNames[p],v=m===void 0||d.componentName!==m||f;if(!v)for(let C=0;C<r.numReplacementsBySource[p];C++){let _=t.replacements[s+C];if(_){if(!t.stateValues.effectivePropNameBySource[p]&&_.shadows.componentName!==t.stateValues.replacementSourceIdentities[p].componentName){v=!0;break}}else{v=!0;break}}if(v){let C=0;m!==void 0&&(C=r.numReplacementsBySource[p]);let _=C;f&&(_=0);let w=r.uniqueIdentifiersUsedBySource[p]=[],A=this.recreateReplacements({component:t,sourceNum:p,numReplacementsSoFar:s,numReplacementsToDelete:_,components:n,uniqueIdentifiersUsed:w,componentInfoObjects:i});s+=A.numReplacements,o[p]=A.numReplacements,u[p]=A.propVariablesCopiedByReplacement;let $=A.replacementInstruction;if(!f&&A.numReplacements!==C){let S=r.numReplacementsBySource.slice(p).reduce((D,V)=>D+V,0);$.numberReplacementsToReplace=S,f=!0,r.numReplacementsBySource.slice(p).forEach((D,V)=>r.numReplacementsBySource[V]=0)}a.push($);continue}if(!t.stateValues.effectivePropNameBySource[p]){if(n[d.componentName].stateValues.isInactiveCompositeReplacement){if(r.numReplacementsBySource[p]===0){s+=r.numReplacementsBySource[p],o[p]=r.numReplacementsBySource[p];continue}}else if(r.numReplacementsBySource[p]>0){s+=r.numReplacementsBySource[p],o[p]=r.numReplacementsBySource[p];continue}}let h=r.uniqueIdentifiersUsedBySource[p]=[],y=this.createReplacementForSource({component:t,sourceNum:p,components:n,numReplacementsSoFar:s,uniqueIdentifiersUsed:h,componentInfoObjects:i}),g=y.propVariablesCopiedByReplacement,b=y.serializedReplacements,x=b.length,N=r.numReplacementsBySource[p];if(x!==N){let C=r.numReplacementsBySource.slice(p).reduce((w,A)=>w+A,0),_={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:s,numberReplacementsToReplace:C,serializedReplacements:b,assignNamesOffset:s};a.push(_),f=!0,r.numReplacementsBySource.slice(p).forEach((w,A)=>r.numReplacementsBySource[A]=0)}else for(let C=0;C<x;C++)if(g[C].length!==r.propVariablesCopiedBySource[p][C].length||r.propVariablesCopiedBySource[p][C].some((_,w)=>_!==g[C][w])||t.replacements[s+C].componentType!==b[C].componentType){let _={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:s+C,numberReplacementsToReplace:1,serializedReplacements:[b[C]],assignNamesOffset:s+C};a.push(_)}s+=x,o[p]=x,u[p]=g}return r.numReplacementsBySource=o,r.sourceNames=t.stateValues.replacementSources.map(p=>p.componentName),r.propVariablesCopiedBySource=u,a}static recreateReplacements({component:t,sourceNum:e,numReplacementsSoFar:n,numReplacementsToDelete:r,uniqueIdentifiersUsed:i,components:a,componentInfoObjects:s}){let o=this.createReplacementForSource({component:t,sourceNum:e,numReplacementsSoFar:n,components:a,uniqueIdentifiersUsed:i,componentInfoObjects:s}),u=o.propVariablesCopiedByReplacement,c=o.serializedReplacements,f={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:n,numberReplacementsToReplace:r,serializedReplacements:c,assignNamesOffset:n};return{numReplacements:c.length,propVariablesCopiedByReplacement:u,replacementInstruction:f}}},Ah=mo;function ri({component:l,components:t,replacementSource:e,propName:n,uniqueIdentifiersUsed:r}){let i=[],a=[],s=-1,o=t[e.componentName],u=Object.keys(e.stateValues)[0];if(u===void 0)return console.warn(`Could not find prop ${n} on a component of type ${e.componentType}`),{serializedReplacements:[],propVariablesCopiedByReplacement:[]};let c=o.state[u];if(c.isArray||c.isArrayEntry){let f,p;if(c.isArray?(f=c,p=c.getAllArrayKeys(c.arraySize,!1)):(f=o.state[c.arrayStateVariable],p=c.unflattenedArrayKeys),!f.componentType)return{serializedReplacements:[],propVariablesCopiedByReplacement:[]};let d=c.wrappingComponents,m=d.length,v;if(c.isArray)v=c.arraySize.slice(0,c.arraySize.length-m).reduce((h,y)=>h*y,1);else if(c.arrayKeys.length===0)l.stateValues.includeUndefinedObjects?v=1:v=0;else if(m===0)v=c.arrayKeys.length;else if(m>=c.nDimensions)v=1;else if(m===c.nDimensions-1)v=p.length;else{let h=c.nDimensions-m-1;v=Ba(p,h).length}if(m===0){let h=rt(p);for(let y=0;y<v;y++){s++;let g=a[s]=[],b=f.componentType;Array.isArray(b)&&(c.isArrayEntry?b=b[f.keyToIndex(c.arrayKeys[y])]:b=b[y]),b=b.toLowerCase();let x=h[y];if(x){let N=f.arrayVarNameFromArrayKey(x);g.push(N);{let C=e.componentName+"|shadow|"+N,_=dr(C,r);i.push({componentType:b,downstreamDependencies:{[e.componentName]:[{dependencyType:"referenceShadow",compositeName:l.componentName,propVariable:N}]},uniqueIdentifier:_})}}else{let N=b+"|empty",C=dr(N,r);i.push({componentType:b,uniqueIdentifier:C})}}}else{let h=function(b,x){let N=[],C=[];if(x>1)for(let w of b){let A=h(w,x-1);N.push(...A.pieces),C.push(...A.propVariablesCopiedByPiece)}else for(let w of b){let A=f.arrayVarNameFromArrayKey(w),$=[A];{let S=e.componentName+"|shadow|"+A,D=dr(S,r),V=f.componentType;Array.isArray(V)&&(V=V[f.keyToIndex(w)]),V=V.toLowerCase(),N.push({componentType:V,downstreamDependencies:{[e.componentName]:[{dependencyType:"referenceShadow",compositeName:l.componentName,propVariable:A}]},uniqueIdentifier:D})}C.push($)}let _=d[x-1];if(N.length>0&&_&&_.length>0){for(let w=_.length-1;w>=0;w--){let A=typeof _[w]=="object"?_[w].componentType:_[w],$=A+"|wrapper",S=dr($,r);N=[{componentType:A.toLowerCase(),children:N,uniqueIdentifier:S}],typeof _[w]=="object"&&_[w].doenetAttributes&&(N[0].doenetAttributes=Object.assign({},_[w].doenetAttributes))}C=[rt(C)]}return{pieces:N,propVariablesCopiedByPiece:C}},y=h(p,c.nDimensions),g=y.pieces;a=y.propVariablesCopiedByPiece;for(let b of g)b.downstreamDependencies={[e.componentName]:[{dependencyType:"referenceShadow",compositeName:l.componentName,propVariable:u,ignorePrimaryStateVariable:!0}]};if(s+=g.length,i.push(...g),g.length<v)for(let b=g.length;b<v;b++){s++,a[s]=[];let x,N=d[0],C;N&&N.length>0?typeof N[0]=="object"?(x=N[0].componentType,C=Object.assign({},N[0].doenetAttributes)):x=N[0]:(x=f.componentType,Array.isArray(x)&&(c.isArrayEntry?x=x[f.keyToIndex(c.arrayKeys[b])]:x=x[b]),x=x.toLowerCase());let _=x+"|empty",w=dr(_,r),A={componentType:x,uniqueIdentifier:w};C&&(A.doenetAttributes=C),i.push(A)}else if(g>v)throw Error(`Something went wrong when creating replacements for ${l.componentName} as we ended up with too many replacements`)}}else{if(!c.componentType)return{serializedReplacements:[],propVariablesCopiedByReplacement:[]};s++,(a[s]=[]).push(u);let p=o.componentName+"|shadow|"+u,d=dr(p,r);i.push({componentType:c.componentType.toLowerCase(),downstreamDependencies:{[o.componentName]:[{dependencyType:"referenceShadow",compositeName:l.componentName,propVariable:u}]},uniqueIdentifier:d})}return{serializedReplacements:i,propVariablesCopiedByReplacement:a}}var ho=class extends Ue{static componentType="extract";static assignNamesToReplacements=!0;static acceptProp=!0;static get stateVariablesShadowedForReference(){return["propName"]}static createPropertiesObject({allPossibleProperties:t}){if(t===void 0)return{};let e={};for(let n of t)e[n]={ignorePropagationFromAncestors:!0,default:null};return delete e.string,delete e.contentid,delete e.math,delete e.number,delete e.text,e.includeUndefinedObjects={default:!1},e.componentIndex={default:null},e.propIndex={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",excludeComponentTypes:["_composite"],number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.propName={returnDependencies:()=>({propName:{dependencyType:"doenetAttribute",attributeName:"propName"}}),definition:function({dependencyValues:e}){return{newValues:{propName:e.propName}}}},t.sourceComponents={stateVariablesDeterminingDependencies:["propName","componentIndex","propIndex"],returnDependencies:({stateValues:e})=>({children:{dependencyType:"child",childLogicName:"anything",variableNames:[e.propName],variablesOptional:!0,componentIndex:e.componentIndex,propIndex:e.propIndex,publicCaseInsensitiveVariableMatch:!0,useMappedVariableNames:!0,requireChildLogicInitiallySatisfied:!0}}),definition:({dependencyValues:e})=>({newValues:{sourceComponents:e.children}})},t.readyToExpand={returnDependencies:()=>({replacementClasses:{dependencyType:"stateVariable",variableName:"sourceComponents"},needsReplacementsUpdatedWhenStale:{dependencyType:"stateVariable",variableName:"needsReplacementsUpdatedWhenStale"}}),definition(){return{newValues:{readyToExpand:!0}}}},t.needsReplacementsUpdatedWhenStale={returnDependencies(){return{sourceComponents:{dependencyType:"stateVariable",variableName:"sourceComponents"}}},markStale:()=>({updateReplacements:!0}),definition:()=>({newValues:{needsReplacementsUpdatedWhenStale:!0}})},t}get allPotentialRendererTypes(){let t=[];if(this.replacements)for(let e of this.replacements)for(let n of e.allPotentialRendererTypes)t.includes(n)||t.push(n);return t}static createSerializedReplacements({component:t,components:e,workspace:n,componentInfoObjects:r}){t.stateValues.needsReplacementsUpdatedWhenStale;let i=[],a=[],s=0;n.propVariablesCopiedBySource=[],n.uniqueIdentifiersUsedBySource={};for(let o=0;o<t.stateValues.sourceComponents.length;o++)if(t.stateValues.sourceComponents[o]!==void 0){let u=n.uniqueIdentifiersUsedBySource[o]=[],c=this.createReplacementForSource({component:t,sourceNum:o,components:e,numReplacementsSoFar:s,uniqueIdentifiersUsed:u,componentInfoObjects:r});n.propVariablesCopiedBySource[o]=c.propVariablesCopiedByReplacement;let f=c.serializedReplacements;a[o]=f.length,s+=f.length,i.push(...f)}else a[o]=0;return n.numReplacementsBySource=a,n.sourceNames=t.stateValues.sourceComponents.map(o=>o.componentName),{replacements:i}}static createReplacementForSource({component:t,components:e,sourceNum:n,numReplacementsSoFar:r,uniqueIdentifiersUsed:i,componentInfoObjects:a}){let s=ri({component:t,components:e,replacementSource:t.stateValues.sourceComponents[n],propName:t.stateValues.propName,uniqueIdentifiersUsed:i}),o=s.serializedReplacements,u=s.propVariablesCopiedByReplacement;return o=qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:o,parentName:t.componentName,indOffset:r,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:a}).serializedComponents,{serializedReplacements:o,propVariablesCopiedByReplacement:u}}static calculateReplacementChanges({component:t,components:e,workspace:n,componentInfoObjects:r}){t.stateValues.needsReplacementsUpdatedWhenStale;let i=[],a=0,s=[],o=[],u=Math.max(t.stateValues.sourceComponents.length,n.numReplacementsBySource.length),c=!1;for(let f=0;f<u;f++){let p=t.stateValues.sourceComponents[f];if(p===void 0){if(n.numReplacementsBySource[f]>0){if(!c){let N=n.numReplacementsBySource.slice(f).reduce((C,_)=>C+_,0);if(N>0){let C={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:a,numberReplacementsToDelete:N};i.push(C)}c=!0,n.numReplacementsBySource.slice(f).forEach((C,_)=>n.numReplacementsBySource[_]=0)}n.uniqueIdentifiersUsedBySource[f]=[]}s[f]=0,o.push([]);continue}let d=n.sourceNames[f],m=d===void 0||p.componentName!==d||c;if(!m){for(let N=0;N<n.numReplacementsBySource[f];N++)if(!t.replacements[a+N]){m=!0;break}}if(m){let N=0;d!==void 0&&(N=n.numReplacementsBySource[f]);let C=N;c&&(C=0);let _=n.uniqueIdentifiersUsedBySource[f]=[],w=this.recreateReplacements({component:t,sourceNum:f,numReplacementsSoFar:a,numReplacementsToDelete:C,components:e,uniqueIdentifiersUsed:_,componentInfoObjects:r});a+=w.numReplacements,s[f]=w.numReplacements,o[f]=w.propVariablesCopiedByReplacement;let A=w.replacementInstruction;if(!c&&w.numReplacements!==N){let $=n.numReplacementsBySource.slice(f).reduce((S,D)=>S+D,0);A.numberReplacementsToReplace=$,c=!0,n.numReplacementsBySource.slice(f).forEach((S,D)=>n.numReplacementsBySource[D]=0)}i.push(A);continue}let v=n.uniqueIdentifiersUsedBySource[f]=[],h=this.createReplacementForSource({component:t,sourceNum:f,components:e,numReplacementsSoFar:a,uniqueIdentifiersUsed:v,componentInfoObjects:r}),y=h.propVariablesCopiedByReplacement,g=h.serializedReplacements,b=g.length,x=n.numReplacementsBySource[f];if(b!==x){let N=n.numReplacementsBySource.slice(f).reduce((_,w)=>_+w,0),C={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:a,numberReplacementsToReplace:N,serializedReplacements:g,assignNamesOffset:a};i.push(C),c=!0,n.numReplacementsBySource.slice(f).forEach((_,w)=>n.numReplacementsBySource[w]=0)}else for(let N=0;N<b;N++)if(y[N].length!==n.propVariablesCopiedBySource[f][N].length||n.propVariablesCopiedBySource[f][N].some((C,_)=>C!==y[N][_])){let C={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:a+N,numberReplacementsToReplace:1,serializedReplacements:[g[N]],assignNamesOffset:a+N};i.push(C)}a+=b,s[f]=b,o[f]=y}return n.numReplacementsBySource=s,n.sourceNames=t.stateValues.sourceComponents.map(f=>f.componentName),n.propVariablesCopiedBySource=o,i}static recreateReplacements({component:t,sourceNum:e,numReplacementsSoFar:n,numReplacementsToDelete:r,uniqueIdentifiersUsed:i,components:a,componentInfoObjects:s}){let o=this.createReplacementForSource({component:t,sourceNum:e,numReplacementsSoFar:n,components:a,uniqueIdentifiersUsed:i,componentInfoObjects:s}),u=o.propVariablesCopiedByReplacement,c=o.serializedReplacements,f={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:n,numberReplacementsToReplace:r,serializedReplacements:c,assignNamesOffset:n};return{numReplacements:c.length,propVariablesCopiedByReplacement:u,replacementInstruction:f}}},$h=ho;var vo=class extends Ue{static componentType="collect";static assignNamesToReplacements=!0;static acceptTname=!0;static acceptProp=!0;static get stateVariablesShadowedForReference(){return["targetComponent","propName","componentTypesToCollect"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.maximumNumber={default:null},e.componentIndex={default:null},e.propIndex={default:null},e.targetPropertiesToIgnore={default:["hide"]},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneComponentTypes",componentType:"componentTypes",comparison:"atMost",number:1,takePropertyChildren:!0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.targetComponent={returnDependencies:()=>({targetComponent:{dependencyType:"targetComponent"}}),definition:function({dependencyValues:e}){return{newValues:{targetComponent:e.targetComponent}}}},t.targetInactive={stateVariablesDeterminingDependencies:["targetComponent"],returnDependencies({stateValues:e}){return e.targetComponent?{targetIsInactiveCompositeReplacement:{dependencyType:"stateVariable",componentName:e.targetComponent.componentName,variableName:"isInactiveCompositeReplacement"}}:{}},definition:function({dependencyValues:e}){return{newValues:{targetInactive:Boolean(e.targetIsInactiveCompositeReplacement)}}}},t.targetName={returnDependencies:()=>({targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"}}),definition:function({dependencyValues:e}){return e.targetComponent===null?(console.warn("No copy target"),{newValues:{targetName:""}}):{newValues:{targetName:e.targetComponent.componentName}}}},t.propName={returnDependencies:()=>({propName:{dependencyType:"doenetAttribute",attributeName:"propName"}}),definition:function({dependencyValues:e}){return{newValues:{propName:e.propName}}}},t.componentTypesToCollect={returnDependencies:()=>({componentTypesChild:{dependencyType:"child",childLogicName:"atMostOneComponentTypes",variableNames:["texts"]}}),definition:function({dependencyValues:e}){return e.componentTypesChild.length===1?{newValues:{componentTypesToCollect:e.componentTypesChild[0].stateValues.texts}}:{newValues:{componentTypesToCollect:[]}}}},t.componentClassesToCollect={returnDependencies:()=>({componentTypesToCollect:{dependencyType:"stateVariable",variableName:"componentTypesToCollect"}}),definition:function({dependencyValues:e,componentInfoObjects:n}){let r=[];for(let i of e.componentTypesToCollect){let a=n.allComponentClasses[i];if(a===void 0){let s="Cannot collect component type "+i+". Component type not found.";console.warn(s)}else r.push(a)}return{newValues:{componentClassesToCollect:r}}}},t.collectedComponents={stateVariablesDeterminingDependencies:["componentTypesToCollect","targetName","propName","componentIndex","propIndex"],returnDependencies:function({stateValues:e}){if(!e.targetName)return{};let n={dependencyType:"descendant",ancestorName:e.targetName,componentTypes:e.componentTypesToCollect,useReplacementsForComposites:!0,includeNonActiveChildren:!0,recurseToMatchedChildren:!1,componentIndex:e.componentIndex};return e.propName&&(n.variableNames=[e.propName],n.variablesOptional=!0,n.componentIndex=e.componentIndex,n.propIndex=e.propIndex,n.publicCaseInsensitiveVariableMatch=!0,n.useMappedVariableNames=!0),{descendants:n,maximumNumber:{dependencyType:"stateVariable",variableName:"maximumNumber"}}},definition:function({dependencyValues:e}){let n=e.descendants;if(n||(n=[]),e.maximumNumber!==null&&n.length>e.maximumNumber){let r=Math.max(0,Math.floor(e.maximumNumber));n=n.slice(0,r)}return{newValues:{collectedComponents:n}}}},t.readyToExpand={returnDependencies:()=>({collectedComponents:{dependencyType:"stateVariable",variableName:"collectedComponents"},needsReplacementsUpdatedWhenStale:{dependencyType:"stateVariable",variableName:"needsReplacementsUpdatedWhenStale"}}),definition:()=>({newValues:{readyToExpand:!0}})},t.needsReplacementsUpdatedWhenStale={returnDependencies(){return{collectedComponents:{dependencyType:"stateVariable",variableName:"collectedComponents"}}},markStale(){return{updateReplacements:!0}},definition(){return{newValues:{needsReplacementsUpdatedWhenStale:!0}}}},t}static createSerializedReplacements({component:t,components:e,workspace:n,componentInfoObjects:r}){if(t.stateValues.needsReplacementsUpdatedWhenStale,!t.stateValues.targetComponent)return{replacements:[]};let i=[],a=[],s=0;n.propVariablesCopiedByCollected=[],n.uniqueIdentifiersUsedByCollected={};for(let o=0;o<t.stateValues.collectedComponents.length;o++)if(t.stateValues.collectedComponents[o]){let u=n.uniqueIdentifiersUsedByCollected[o]=[],c=this.createReplacementForCollected({component:t,collectedNum:o,components:e,numReplacementsSoFar:s,uniqueIdentifiersUsed:u,componentInfoObjects:r});n.propVariablesCopiedByCollected[o]=c.propVariablesCopiedByReplacement;let f=c.serializedReplacements;a[o]=f.length,s+=f.length,i.push(...f)}else a[o]=0;return n.numReplacementsByCollected=a,n.collectedNames=t.stateValues.collectedComponents.map(o=>o.componentName),{replacements:i}}static createReplacementForCollected({component:t,components:e,collectedNum:n,numReplacementsSoFar:r,uniqueIdentifiersUsed:i,componentInfoObjects:a}){let s=t.stateValues.collectedComponents[n],o=s.componentName,u=e[o],c=[],f=[];if(!u)return{serializedReplacements:c,propVariablesCopiedByReplacement:f};if(t.stateValues.propName){let d=ri({component:t,components:e,replacementSource:s,propName:t.stateValues.propName,uniqueIdentifiersUsed:i});c=d.serializedReplacements,f=d.propVariablesCopiedByReplacement}else{let d=[u.serialize({forCopy:!0})];c=Lt({serializedComponents:d,componentName:t.componentName,uniqueIdentifiersUsed:i,identifierPrefix:n+"|"})}return c=qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:c,parentName:t.componentName,indOffset:r,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:a}).serializedComponents,{serializedReplacements:c,propVariablesCopiedByReplacement:f}}static calculateReplacementChanges({component:t,componentChanges:e,components:n,workspace:r,componentInfoObjects:i}){t.stateValues.needsReplacementsUpdatedWhenStale;let a=[],s=0,o=[],u=[],c=Math.max(t.stateValues.collectedComponents.length,r.numReplacementsByCollected.length),f=!1;for(let p=0;p<c;p++){let d=t.stateValues.collectedComponents[p];if(d===void 0){if(r.numReplacementsByCollected[p]>0){if(!f){let N=r.numReplacementsByCollected.slice(p).reduce((C,_)=>C+_,0);if(N>0){let C={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:s,numberReplacementsToDelete:N};a.push(C)}f=!0,r.numReplacementsByCollected.slice(p).forEach((C,_)=>r.numReplacementsByCollected[_]=0)}r.uniqueIdentifiersUsedByCollected[p]=[]}o[p]=0,u.push([]);continue}let m=r.collectedNames[p];if(m===void 0||d.componentName!==m||f){let N=0;m!==void 0&&(N=r.numReplacementsByCollected[p]);let C=N;f&&(C=0);let _=r.uniqueIdentifiersUsedByCollected[p]=[],w=this.recreateReplacements({component:t,collectedNum:p,numReplacementsSoFar:s,numReplacementsToDelete:C,components:n,uniqueIdentifiersUsed:_,componentInfoObjects:i});s+=w.numReplacements,o[p]=w.numReplacements,u[p]=w.propVariablesCopiedByReplacement;let A=w.replacementInstruction;if(!f&&w.numReplacements!==N){let $=r.numReplacementsByCollected.slice(p).reduce((S,D)=>S+D,0);A.numberReplacementsToReplace=$,f=!0,r.numReplacementsByCollected.slice(p).forEach((S,D)=>r.numReplacementsByCollected[D]=0)}a.push(A);continue}if(!t.stateValues.propName){s+=r.numReplacementsByCollected[p],o[p]=r.numReplacementsByCollected[p];continue}let v=r.uniqueIdentifiersUsedByCollected[p]=[],h=this.createReplacementForCollected({component:t,collectedNum:p,components:n,numReplacementsSoFar:s,uniqueIdentifiersUsed:v,componentInfoObjects:i}),y=h.propVariablesCopiedByReplacement,g=h.serializedReplacements,b=g.length,x=r.numReplacementsByCollected[p];if(b!==x){let N=r.numReplacementsByCollected.slice(p).reduce((_,w)=>_+w,0),C={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:s,numberReplacementsToReplace:N,serializedReplacements:g,assignNamesOffset:s};a.push(C),f=!0,r.numReplacementsByCollected.slice(p).forEach((_,w)=>r.numReplacementsByCollected[w]=0)}else for(let N=0;N<b;N++)if(y[N].length!==r.propVariablesCopiedByCollected[p][N].length||r.propVariablesCopiedByCollected[p][N].some((C,_)=>C!==y[N][_])){let C={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:s+N,numberReplacementsToReplace:1,serializedReplacements:[g[N]],assignNamesOffset:s+N};a.push(C)}s+=b,o[p]=b,u[p]=y}return r.numReplacementsByCollected=o,r.collectedNames=t.stateValues.collectedComponents.map(p=>p.componentName),r.propVariablesCopiedByCollected=u,a}static recreateReplacements({component:t,collectedNum:e,numReplacementsSoFar:n,numReplacementsToDelete:r,uniqueIdentifiersUsed:i,components:a,componentInfoObjects:s}){let o=this.createReplacementForCollected({component:t,collectedNum:e,components:a,numReplacementsSoFar:n,uniqueIdentifiersUsed:i,componentInfoObjects:s}),u=o.propVariablesCopiedByReplacement,c=o.serializedReplacements,f={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:n,numberReplacementsToReplace:r,serializedReplacements:c,assignNamesOffset:n};return{numReplacements:c.length,propVariablesCopiedByReplacement:u,replacementInstruction:f}}},Sh=vo;var yo=class extends Me{static componentType="ref";static acceptTname=!0;static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.texttype={default:"type-global"},e.uri={default:null,forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroAnything",componentType:"_base",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.targetComponent={returnDependencies:()=>({targetComponent:{dependencyType:"targetComponent"}}),definition:function({dependencyValues:e}){return{newValues:{targetComponent:e.targetComponent}}}},t.targetInactive={stateVariablesDeterminingDependencies:["targetComponent"],returnDependencies({stateValues:e}){return e.targetComponent?{targetIsInactiveCompositeReplacement:{dependencyType:"stateVariable",componentName:e.targetComponent.componentName,variableName:"isInactiveCompositeReplacement"}}:{}},definition:function({dependencyValues:e}){return{newValues:{targetInactive:Boolean(e.targetIsInactiveCompositeReplacement)}}}},t.targetName={forRenderer:!0,returnDependencies:()=>({targetComponent:{dependencyType:"stateVariable",variableName:"targetComponent"},uri:{dependencyType:"stateVariable",variableName:"uri"}}),definition:function({dependencyValues:e}){return e.targetComponent===null?{newValues:{targetName:""}}:e.uri!==null?(console.warn("Haven't implemented ref with uri and tname, ignoring tname."),{newValues:{targetName:""}}):{newValues:{targetName:e.targetComponent.componentName}}}},t.contentId={returnDependencies:()=>({uri:{dependencyType:"stateVariable",variableName:"uri"}}),definition({dependencyValues:e}){if(e.uri!==null){let n=e.uri.match(/^\s*doenet\s*:\s*(\S*)\s*$/i);if(n!==null)return{newValues:{contentId:n[1]}}}return{newValues:{contentId:null}}}},t.linkText={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({inlineChildren:{dependencyType:"child",childLogicName:"atLeastZeroAnything",variableNames:["text"],variablesOptional:!0},uri:{dependencyType:"stateVariable",variableName:"uri"}}),definition:function({dependencyValues:e}){let n="";if(e.inlineChildren.length===0)e.uri!==null&&(n=e.uri);else for(let r of e.inlineChildren)typeof r.stateValues.text=="string"&&(n+=r.stateValues.text);return{newValues:{linkText:n}}}},t.childrenToRender={returnDependencies:()=>({inlineChildren:{dependencyType:"child",childLogicName:"atLeastZeroAnything"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.inlineChildren.map(n=>n.componentName)}}}},t}},Dh=yo;var go=class extends ke{static componentType="coords";static rendererType="math";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.createVectors={default:!0},e}},Vh=go;var je=De(Ee());var bo=class extends lt{static componentType="line";actions={moveLine:this.moveLine.bind(new Proxy(this,this.readOnlyProxyHandler))};static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["points","variables"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.draggable={default:!0,forRenderer:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions();return t.push({childrenRegex:"s",replacementFunction:({matchedChildren:e})=>({success:!0,newChildren:[{componentType:"equation",doenetAttributes:{isPropertyChild:!0},children:e}]})}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneEquation",componentType:"equation",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"atMostOneThrough",componentType:"through",comparison:"atMost",number:1,takePropertyChildren:!0}),i=e.newOperator({name:"equationXorThrough",operator:"xor",propositions:[n,r]}),a=e.newLeaf({name:"atMostOneVariables",componentType:"variables",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"lineLogic",operator:"and",propositions:[i,a],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let n="";return e.selectedStyle.lineWidth>=4?n+="thick ":e.selectedStyle.lineWidth<=1&&(n+="thin "),e.selectedStyle.lineStyle==="dashed"?n+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(n+="dotted "),n+=e.selectedStyle.lineColor,{newValues:{styleDescription:n}}}},t.nDimensions={public:!0,componentType:"number",stateVariablesDeterminingDependencies:["equationChild"],returnDependencies:function({stateValues:e}){return e.equationChild===null?{throughChild:{dependencyType:"child",childLogicName:"atMostOneThrough",variableNames:["nDimensions"]}}:{equationChild:{dependencyType:"child",childLogicName:"exactlyOneEquation"}}},definition:function({dependencyValues:e,changes:n}){return e.equationChild?n.equationChild&&n.equationChild.componentIdentitiesChanged?{newValues:{nDimensions:2},checkForActualChange:{nDimensions:!0}}:{noChanges:["nDimensions"]}:e.throughChild.length===1?{newValues:{nDimensions:e.throughChild[0].stateValues.nDimensions},checkForActualChange:{nDimensions:!0}}:{newValues:{nDimensions:2}}}},t.variables={isArray:!0,public:!0,componentType:"variable",entryPrefixes:["var"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey(){return{globalDependencies:{variablesChild:{dependencyType:"child",childLogicName:"atMostOneVariables",variableNames:["variables"]}}}},arrayDefinitionByKey({globalDependencyValues:e,arraySize:n}){let r=[];return e.variablesChild.length===1&&(r=e.variablesChild[0].stateValues.variables),{newValues:{variables:Fu(n[0],r)}}}},t.equationChild={returnDependencies:()=>({equationChild:{dependencyType:"child",childLogicName:"exactlyOneEquation"}}),definition:function({dependencyValues:e}){return e.equationChild.length===1?{newValues:{equationChild:e.equationChild[0]}}:{newValues:{equationChild:null}}}},t.points={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["pointX","point"],returnWrappingComponents(e){return e==="pointX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="pointX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}},stateVariablesDeterminingDependencies:["equationChild"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[2,e.nDimensions]},returnArrayDependenciesByKey({stateValues:e,arrayKeys:n}){if(e.equationChild===null){let r={};for(let i of n){let[a,s]=i.split(","),o=Number(a)+1+"_"+(Number(s)+1);r[i]={throughChild:{dependencyType:"child",childLogicName:"atMostOneThrough",variableNames:["pointX"+o]}}}return{dependenciesByKey:r}}else return{globalDependencies:{coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"},variables:{dependencyType:"stateVariable",variableName:"variables"},lastPointsFromInverting:{dependencyType:"stateVariable",variableName:"lastPointsFromInverting"}}}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r,arraySize:i,componentName:a}){if("coeff0"in e){let s=g1(e);if(s.success)return{newValues:{points:s.points}};{let o={};for(let u=0;u<i[0];u++)for(let c=0;c<i[1];c++)o[u+","+c]=je.default.fromAst("\uFF3F");return{newValues:{points:o}}}}else{let s={},o={};for(let c of r){let[f,p]=c.split(","),d=Number(f)+1+"_"+(Number(p)+1);n[c].throughChild.length===1&&n[c].throughChild[0].stateValues["pointX"+d]?s[c]=n[c].throughChild[0].stateValues["pointX"+d]:c==="0,0"?o[c]={defaultValue:je.default.fromAst(1)}:o[c]={defaultValue:je.default.fromAst(0)}}let u={};return Object.keys(s).length>0&&(u.newValues={points:s}),Object.keys(o).length>0&&(u.useEssentialOrDefaultValue={points:o}),u}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,initialChange:a,stateValues:s,workspace:o}){if(a&&!s.draggable)return{success:!1};if("coeff0"in n){o.desiredPoints||(o.desiredPoints={}),Object.assign(o.desiredPoints,e.points);let u,c,f,p;if(o.desiredPoints["0,0"]?u=o.desiredPoints["0,0"]:u=s.points[0][0],o.desiredPoints["0,1"]?c=o.desiredPoints["0,1"]:c=s.points[0][1],o.desiredPoints["1,0"]?f=o.desiredPoints["1,0"]:f=s.points[1][0],o.desiredPoints["1,1"]?p=o.desiredPoints["1,1"]:p=s.points[1][1],typeof u.tree=="number"&&typeof c.tree=="number"&&typeof f.tree=="number"&&typeof p.tree=="number"){let h=[u.tree,c.tree],y=[f.tree,p.tree],g=h[1]-y[1],b=y[0]-h[0],x=h[0]*y[1]-h[1]*y[0],N=Math.abs(g*s.coeffvar2-s.coeffvar1*b),C=[];return N<Math.abs(g*s.coeffvar2)*1e-12?(g!==0?x*=s.coeffvar1/g:x*=s.coeffvar2/b,C.push({setDependency:"coeff0",desiredValue:x,additionalDependencyValues:{coeffvar1:s.coeffvar1,coeffvar2:s.coeffvar2}})):C.push({setDependency:"coeff0",desiredValue:x,additionalDependencyValues:{coeffvar1:g,coeffvar2:b}}),C.push({setDependency:"lastPointsFromInverting",desiredValue:[h,y]}),{success:!0,instructions:C}}let d=c.subtract(p).simplify(),m=f.subtract(u).simplify(),v=u.multiply(p).subtract(c.multiply(f)).simplify();return{success:!0,instructions:[{setDependency:"coeff0",desiredValue:v,additionalDependencyValues:{coeffvar1:d,coeffvar2:m}}]}}else{let u=[];for(let c of Object.keys(e.points).reverse()){let[f,p]=c.split(","),d=Number(f)+1+"_"+(Number(p)+1);r[c].throughChild.length===1&&r[c].throughChild[0].stateValues["pointX"+d]?u.push({setDependency:i[c].throughChild,desiredValue:e.points[c],childIndex:0,variableIndex:0}):u.push({setStateVariable:"points",value:{[c]:nt(e.points[c])}})}return{success:!0,instructions:u}}}},t.equation={public:!0,componentType:"equation",forRenderer:!0,stateVariablesDeterminingDependencies:["equationChild"],additionalStateVariablesDefined:[{variableName:"coeff0",public:!0,componentType:"math"},{variableName:"coeffvar1",public:!0,componentType:"math"},{variableName:"coeffvar2",public:!0,componentType:"math"}],returnDependencies:function({stateValues:e}){let n={variables:{dependencyType:"stateVariable",variableName:"variables"}};return e.equationChild===null?(n.points={dependencyType:"stateVariable",variableName:"points"},n.nDimensions={dependencyType:"stateVariable",variableName:"nDimensions"}):n.equationChild={dependencyType:"child",childLogicName:"exactlyOneEquation",variableNames:["value"]},n},definition:function({dependencyValues:e}){let n=e.variables,r=je.default.fromAst("\uFF3F");if(e.equationChild){let v=e.equationChild[0].stateValues.value,h=y1({equation:v,variables:n});if(!h.success)return{newValues:{equation:v,coeff0:r,coeffvar1:r,coeffvar2:r}};let{coeff0:y,coeffvar1:g,coeffvar2:b}=h;return{newValues:{equation:v,coeff0:y,coeffvar1:g,coeffvar2:b}}}let i=e.nDimensions;if(Number.isNaN(i))return console.warn("Line through points of undetermined dimensions"),{newValues:{equation:r,coeff0:r,coeffvar1:r,coeffvar2:r}};if(i<2)return console.warn("Line must be through points of at least two dimensions"),{newValues:{equation:r,coeff0:r,coeffvar1:r,coeffvar2:r}};let a=e.points[0][0],s=e.points[0][1],o=e.points[1][0],u=e.points[1][1],c=[...n.map(v=>v.toString())];for(let v=0;v<i;v++)if(a.variables().indexOf(c[v])!==-1||s.variables().indexOf(c[v])!==-1||o.variables().indexOf(c[v])!==-1||u.variables().indexOf(c[v])!==-1)return console.warn("Points through line depend on variables: "+c.join(", ")),{newValues:{equation:r,coeff0:r,coeffvar1:r,coeffvar2:r}};if(i!==2)return{newValues:{equation:r,coeff0:r,coeffvar1:r,coeffvar2:r}};if(a.equals(o)&&s.equals(u)){let v=je.default.fromAst(0);return{newValues:{equation:r,coeff0:v,coeffvar1:v,coeffvar2:v}}}let f=s.subtract(u).simplify(),p=o.subtract(a).simplify(),d=a.multiply(u).subtract(s.multiply(o)).simplify();return{newValues:{equation:je.default.fromAst(["=",["+",["*","a","x"],["*","b","y"],"c"],0]).substitute({a:f,b:p,c:d,x:n[0],y:n[1]}).simplify(),coeff0:d,coeffvar1:f,coeffvar2:p}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){if(n.points)return console.log("Haven't implemented inverse definition of equation of line based on points"),{success:!1};if(e.equation)return{success:!0,instructions:[{setDependency:"equationChild",desiredValue:e.equation,childIndex:0,variableIndex:0}]};if(!("coeff0"in e&&"coeffvar1"in e&&"coeffvar2"in e))return console.log("Haven't implemented inverting coeffs if not specifying all of them"),{success:!1};let r=je.default.fromAst(["=",0,["+",["*","a","x"],["*","b","y"],"c"]]).substitute({a:e.coeffvar1,b:e.coeffvar2,c:e.coeff0,x:n.variables[0],y:n.variables[1]}).simplify();return{success:!0,instructions:[{setDependency:"equationChild",desiredValue:r,childIndex:0,variableIndex:0}]}}},t.numericalPoints={isArray:!0,entryPrefixes:["numericalPoint"],forRenderer:!0,returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return Number.isNaN(e.nDimensions)?[0]:[2]},returnArrayDependenciesByKey({arrayKeys:e}){let n={nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}},r={};for(let i of e)r[i]={point:{dependencyType:"stateVariable",variableName:"point"+(Number(i)+1)}};return{globalDependencies:n,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r,componentName:i}){if(Number.isNaN(e.nDimensions))return{};let a={};for(let s of r){let o=n[s].point,u=[];for(let c=0;c<e.nDimensions;c++){let f=o[c].evaluate_to_constant();Number.isFinite(f)||(f=NaN),u.push(f)}a[s]=u}return{newValues:{numericalPoints:a}}}},t.numericalCoeff0={additionalStateVariablesDefined:["numericalCoeffvar1","numericalCoeffvar2"],returnDependencies:()=>({coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"}}),definition:function({dependencyValues:e}){let n=e.coeff0.evaluate_to_constant();Number.isFinite(n)||(n=NaN);let r=e.coeffvar1.evaluate_to_constant();Number.isFinite(r)||(r=NaN);let i=e.coeffvar2.evaluate_to_constant();return Number.isFinite(i)||(i=NaN),{newValues:{numericalCoeff0:n,numericalCoeffvar1:r,numericalCoeffvar2:i}}}},t.slope={public:!0,componentType:"math",returnDependencies:()=>({coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"}}),definition:function({dependencyValues:e}){return{newValues:{slope:je.default.fromAst(["-",["/","a","b"]]).substitute({a:e.coeffvar1,b:e.coeffvar2}).simplify()}}}},t.xintercept={public:!0,componentType:"math",returnDependencies:()=>({coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar1:{dependencyType:"stateVariable",variableName:"coeffvar1"}}),definition:({dependencyValues:e})=>({newValues:{xintercept:je.default.fromAst(["-",["/","a","b"]]).substitute({a:e.coeff0,b:e.coeffvar1}).simplify()}})},t.yintercept={public:!0,componentType:"math",returnDependencies:()=>({coeff0:{dependencyType:"stateVariable",variableName:"coeff0"},coeffvar2:{dependencyType:"stateVariable",variableName:"coeffvar2"}}),definition:({dependencyValues:e})=>({newValues:{yintercept:je.default.fromAst(["-",["/","a","b"]]).substitute({a:e.coeff0,b:e.coeffvar2}).simplify()}})},t.lastPointsFromInverting={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{lastPointsFromInverting:{variableToCheck:"lastPointsFromInverting"}}}),inverseDefinition:({desiredStateVariableValues:e})=>({success:!0,instructions:[{setStateVariable:"lastPointsFromInverting",value:e.lastPointsFromInverting}]})},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},numericalCoeff0:{dependencyType:"stateVariable",variableName:"numericalCoeff0"},numericalCoeffvar1:{dependencyType:"stateVariable",variableName:"numericalCoeffvar1"},numericalCoeffvar2:{dependencyType:"stateVariable",variableName:"numericalCoeffvar2"}}),definition:({dependencyValues:e})=>({newValues:{nearestPoint:function(n){if(e.nDimensions!==2)return{};let r=e.numericalCoeffvar1,i=e.numericalCoeffvar2,a=e.numericalCoeff0;if(!(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)))return{};let s=r*r+i*i;if(s===0)return{};let o=n.x1.evaluate_to_constant(),u=n.x2.evaluate_to_constant();if(!(Number.isFinite(o)&&Number.isFinite(u)))return{};let c={};return c.x1=(i*(i*o-r*u)-r*a)/s,c.x2=(r*(-i*o+r*u)-i*a)/s,n.x3!==void 0&&(c.x3=0),c}}})},t}adapters=["equation"];moveLine({point1coords:t,point2coords:e,transient:n}){let r={"0,0":je.default.fromAst(t[0]),"0,1":je.default.fromAst(t[1]),"1,0":je.default.fromAst(e[0]),"1,1":je.default.fromAst(e[1])};n?this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"points",value:r}],transient:n}):this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"points",value:r}],event:{verb:"interacted",object:{componentId:this.componentName},result:{point1:t,point2:e}}})}},Ih=bo;function y1({equation:l,variables:t}){let e=t[0],n=t[1],r=e.toString(),i=n.toString();l=l.expand().simplify();let a=je.default.fromAst(["+",l.tree[2],["-",l.tree[1]]]).expand().simplify(),s=[];Array.isArray(a.tree)&&a.tree[0]==="+"?s=a.tree.slice(1):s=[a.tree];let o=je.default.fromAst(0),u=je.default.fromAst(0),c=je.default.fromAst(0);for(let p of s){let d=f(p);if(!d.success)return{success:!1};o=o.add(d.coeffvar1),u=u.add(d.coeffvar2),c=c.add(d.coeff0)}return o=o.simplify(),u=u.simplify(),c=c.simplify(),{success:!0,coeff0:c,coeffvar1:o,coeffvar2:u};function f(p){let d=0,m=0,v=0;if(typeof p=="string")p===r?d=1:p===i?m=1:v=p;else if(typeof p=="number")v=p;else if(Array.isArray(p)){let h=p[0],y=p.slice(1);if(h==="-"){let g=f(y[0]);if(!g.success)return{success:!1};d=["-",g.coeffvar1.tree],m=["-",g.coeffvar2.tree],v=["-",g.coeff0.tree]}else{if(h==="+")return console.warn("Invalid format for equation of line in variables "+e+" and "+n),{success:!1};if(h==="*"){let g=-1,b=-1;for(let x=0;x<y.length;x++)if(e.equals(je.default.fromAst(y[x]))){g=x;break}else if(n.equals(je.default.fromAst(y[x]))){b=x;break}g!==-1?(y.splice(g,1),y.length===1?d=y[0]:d=["*"].concat(y)):b!==-1?(y.splice(b,1),y.length===1?m=y[0]:m=["*"].concat(y)):v=p}else if(h==="/"){let g=f(y[0]);if(!g.success)return{success:!1};d=["/",g.coeffvar1.tree,y[1]],m=["/",g.coeffvar2.tree,y[1]],v=["/",g.coeff0.tree,y[1]]}else h==="_"?e.equals(je.default.fromAst(p))?d=1:n.equals(je.default.fromAst(p))?m=1:v=p:v=p}}else return console.warn("Invalid format for equation of line in variables "+e+" and "+n),{success:!1};return{success:!0,coeffvar1:je.default.fromAst(d),coeffvar2:je.default.fromAst(m),coeff0:je.default.fromAst(v)}}}function g1({coeff0:l,coeffvar1:t,coeffvar2:e,variables:n,lastPointsFromInverting:r}){let i=n[0],a=n[1],s=i.toString(),o=a.toString();if(t.variables(!0).indexOf(s)!==-1||t.variables(!0).indexOf(o)!==-1||e.variables(!0).indexOf(s)!==-1||e.variables(!0).indexOf(o)!==-1||l.variables(!0).indexOf(s)!==-1||l.variables(!0).indexOf(o)!==-1)return console.warn("Invalid format for equation of line in variables "+s+" and "+o),{success:!1};let u=je.default.fromAst(0);if(t.equals(u)&&e.equals(u))return console.warn("Invalid format for equation of line in variables "+s+" and "+o),{success:!1};let c=t.evaluate_to_constant(),f=e.evaluate_to_constant(),p=l.evaluate_to_constant(),d,m,v,h,y={};if(Number.isFinite(p)&&Number.isFinite(c)&&Number.isFinite(f)){let g=c*c+f*f;if(g===0)return{success:!1};if(r){let b=r[0][0],x=r[0][1];d=(f*(f*b-c*x)-c*p)/g,m=(c*(-f*b+c*x)-f*p)/g,b=r[1][0],x=r[1][1],v=(f*(f*b-c*x)-c*p)/g,h=(c*(-f*b+c*x)-f*p)/g}else d=(2*f-c*p)/g,m=(-2*c-f*p)/g,v=(f-c*p)/g,h=-(c+f*p)/g;y["0,0"]=je.default.fromAst(d),y["0,1"]=je.default.fromAst(m),y["1,0"]=je.default.fromAst(v),y["1,1"]=je.default.fromAst(h)}else{let g=t.pow(2).add(e.pow(2));d=e.multiply(2).subtract(t.multiply(l)).divide(g),m=t.multiply(-2).subtract(e.multiply(l)).divide(g),v=e.subtract(t.multiply(l)).divide(g),h=t.add(e.multiply(l)).multiply(-1).divide(g),y["0,0"]=d,y["0,1"]=m,y["1,0"]=v,y["1,1"]=h}return{success:!0,points:y}}var Hr=De(Ee());var xo=class extends lt{static componentType="linesegment";actions={moveLineSegment:this.moveLineSegment.bind(new Proxy(this,this.readOnlyProxyHandler))};static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["endpoints"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.draggable={default:!0,forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneEndpoints",componentType:"endpoints",comparison:"atMost",number:1,takePropertyChildren:!0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:e}){let n="";return e.selectedStyle.lineWidth>=4?n+="thick ":e.selectedStyle.lineWidth<=1&&(n+="thin "),e.selectedStyle.lineStyle==="dashed"?n+="dashed ":e.selectedStyle.lineStyle==="dotted"&&(n+="dotted "),n+=e.selectedStyle.lineColor,{newValues:{styleDescription:n}}}},t.nDimensions={public:!0,componentType:"number",returnDependencies:()=>({endpointsChild:{dependencyType:"child",childLogicName:"atMostOneEndpoints",variableNames:["nDimensions"]}}),definition:function({dependencyValues:e}){return e.endpointsChild.length===1?{newValues:{nDimensions:e.endpointsChild[0].stateValues.nDimensions},checkForActualChange:{nDimensions:!0}}:{newValues:{nDimensions:2}}}},t.endpoints={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["endpointX","endpoint"],returnWrappingComponents(e){return e==="endpointX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="endpointX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}},returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[2,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let[i,a]=r.split(","),s=Number(i)+1+"_"+(Number(a)+1);n[r]={endpointsChild:{dependencyType:"child",childLogicName:"atMostOneEndpoints",variableNames:["pointX"+s]}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n,arraySize:r}){let i={},a={};for(let o of n){let[u,c]=o.split(","),f=Number(u)+1+"_"+(Number(c)+1);e[o].endpointsChild.length===1&&e[o].endpointsChild[0].stateValues["pointX"+f]?i[o]=e[o].endpointsChild[0].stateValues["pointX"+f]:o==="0,0"?a[o]={defaultValue:Hr.default.fromAst(1)}:a[o]={defaultValue:Hr.default.fromAst(0)}}let s={};return Object.keys(i).length>0&&(s.newValues={endpoints:i}),Object.keys(a).length>0&&(s.useEssentialOrDefaultValue={endpoints:a}),s},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:n,dependencyNamesByKey:r,initialChange:i,stateValues:a}){if(i&&!a.draggable)return{success:!1};let s=[];for(let o in e.endpoints){let[u,c]=o.split(","),f=Number(u)+1+"_"+(Number(c)+1);n[o].endpointsChild.length===1&&n[o].endpointsChild[0].stateValues["pointX"+f]?s.push({setDependency:r[o].endpointsChild,desiredValue:e.endpoints[o],childIndex:0,variableIndex:0}):s.push({setStateVariable:"endpoints",value:{[o]:nt(e.endpoints[o])}})}return{success:!0,instructions:s}}},t.numericalEndpoints={isArray:!0,entryPrefixes:["numericalEndpoint"],forRenderer:!0,returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return Number.isNaN(e.nDimensions)?[0]:[2]},returnArrayDependenciesByKey({arrayKeys:e}){let n={nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}},r={};for(let i of e)r[i]={endpoint:{dependencyType:"stateVariable",variableName:"endpoint"+(Number(i)+1)}};return{globalDependencies:n,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){if(Number.isNaN(e.nDimensions))return{};let i={};for(let a of r){let s=n[a].endpoint,o=[];for(let u=0;u<e.nDimensions;u++){let c=s[u].evaluate_to_constant();Number.isFinite(c)||(c=NaN),o.push(c)}i[a]=o}return{newValues:{numericalEndpoints:i}}}},t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},endpoints:{dependencyType:"stateVariable",variableName:"endpoints"}}),definition:({dependencyValues:e})=>({newValues:{nearestPoint:function(n){if(e.nDimensions!==2)return{};let r=e.endpoints[0][0].evaluate_to_constant(),i=e.endpoints[0][1].evaluate_to_constant(),a=e.endpoints[1][0].evaluate_to_constant(),s=e.endpoints[1][1].evaluate_to_constant();if(!(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)&&Number.isFinite(s)))return{};let o=a-r,u=s-i,c=o*o+u*u;if(c===0)return{};let f=((n.x1-r)*o+(n.x2-i)*u)/c,p={};return f<=0?p={x1:r,x2:i}:f>=1?p={x1:a,x2:s}:p={x1:r+f*o,x2:i+f*u},n.x3!==void 0&&(p.x3=0),p}}})},t}moveLineSegment({point1coords:t,point2coords:e,transient:n}){let r={};t!==void 0&&(r["0,0"]=Hr.default.fromAst(t[0]),r["0,1"]=Hr.default.fromAst(t[1])),e!==void 0&&(r["1,0"]=Hr.default.fromAst(e[0]),r["1,1"]=Hr.default.fromAst(e[1])),n?this.coreFunctions.requestUpdate({updateInstructions:[{componentName:this.componentName,updateType:"updateValue",stateVariable:"endpoints",value:r}],transient:n}):this.coreFunctions.requestUpdate({updateInstructions:[{componentName:this.componentName,updateType:"updateValue",stateVariable:"endpoints",value:r}],event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{point1:t,point2:e}}})}},Mh=xo;var Co=class extends wn{static componentType="polygon";actions={movePolygon:this.movePolygon.bind(new Proxy(this,this.readOnlyProxyHandler))};get movePolygon(){return this.movePolyline}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nearestPoint={returnDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},vertices:{dependencyType:"stateVariable",variableName:"vertices"},nVertices:{dependencyType:"stateVariable",variableName:"nVertices"}}),definition:({dependencyValues:e})=>({newValues:{nearestPoint:function(n){if(e.nDimensions!==2)return{};let r=Infinity,i={},a=n.x1.evaluate_to_constant(),s=n.x2.evaluate_to_constant(),o,u,c=e.vertices[e.nVertices-1][0].evaluate_to_constant(),f=e.vertices[e.nVertices-1][1].evaluate_to_constant();for(let p=0;p<e.nVertices;p++){if(o=c,u=f,c=e.vertices[p][0].evaluate_to_constant(),f=e.vertices[p][1].evaluate_to_constant(),!(Number.isFinite(o)&&Number.isFinite(u)&&Number.isFinite(c)&&Number.isFinite(f)))continue;let d=c-o,m=f-u,v=d*d+m*m;if(v===0)continue;let h=((a-o)*d+(s-u)*m)/v,y;h<=0?y={x1:o,x2:u}:h>=1?y={x1:c,x2:f}:y={x1:o+h*d,x2:u+h*m};let g=Math.pow(a-y.x1,2)+Math.pow(s-y.x2,2);g<r&&(r=g,i=y)}return n.x3!==void 0&&Object.keys(i).length>0&&(i.x3=0),i}}})},t}},Tn=Co;var Kr=De(Ee()),No=class extends Tn{static componentType="triangle";static rendererType="polygon";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.vertices.returnArraySizeDependencies=()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),t.vertices.returnArraySize=function({dependencyValues:e}){return[3,e.nDimensions]},t.vertices.arrayDefinitionByKey=function({dependencyValuesByKey:e,arrayKeys:n}){let r={},i={};for(let a of n){let[s,o]=a.split(","),u=Number(s)+1+"_"+(Number(o)+1),c=e[a].verticesChild;if(c.length===1&&c[0].stateValues["pointX"+u])r[a]=c[0].stateValues["pointX"+u];else{let f;s==="0"?o==="1"?f=Kr.default.fromAst(1):f=Kr.default.fromAst(0):s==="1"?o==="0"?f=Kr.default.fromAst(1):f=Kr.default.fromAst(0):f=Kr.default.fromAst(0),i[a]={variablesToCheck:["vertexX"+u],defaultValue:f}}}return{newValues:{vertices:r},useEssentialOrDefaultValue:{vertices:i}}},t.vertices.inverseArrayDefinitionByKey=function({desiredStateVariableValues:e,dependencyValuesByKey:n,dependencyNamesByKey:r,initialChange:i,stateValues:a}){if(i&&!a.draggable)return{success:!1};let s=[];for(let o in e.vertices){let[u,c]=o.split(","),f=Number(u)+1+"_"+(Number(c)+1);n[o].verticesChild.length===1&&n[o].verticesChild[0].stateValues["pointX"+f]?s.push({setDependency:r[o].verticesChild,desiredValue:e.vertices[o],childIndex:0,variableIndex:0}):s.push({setStateVariable:"vertices",value:{[o]:e.vertices[o].simplify()}})}return{success:!0,instructions:s}},t.vertices.inverseDefinition=function({desiredStateVariableValues:e,dependencyValues:n,stateValues:r,initialChange:i,arrayKeys:a,workspace:s}){if(i&&!r.draggable)return{success:!1};let o;if(a&&(o=Number(a[0])),s.desiredVertices||(s.desiredVertices={}),o===void 0){let u=[],c=0;if(n.verticesChild.length===1){c=Math.min(3,n.verticesChild[0].stateValues.nPoints);let f;if(Array.isArray(e))f=e.vertices.slice(0,c);else{f={};for(let p in e.vertices)Number(p)<c&&(f[p]=e.vertices[p]);Object.keys(f).length===0&&(f=void 0)}f&&u.push({setDependency:"verticesChild",desiredValue:f,childIndex:0,variableIndex:0})}for(let f=c;f<3;f++)if(e.vertices[f]!==void 0){let p=Oh({workspaceVertices:s.desiredVertices[f],currentVertexValue:r.vertices[f],desiredVertex:e.vertices[f]});s.desiredVertices[f]=p.tree,u.push({setStateVariable:"vertices",value:{[f]:p.simplify()}})}return{success:!0,instructions:u}}else{if(o>2)return{success:!1};if(n.verticesChild.length===1){let c=Math.min(3,n.verticesChild[0].stateValues.nPoints);if(o<c)return{success:!0,instructions:[{setDependency:"verticesChild",desiredValue:e.vertices[o],childIndex:0,variableIndex:0}]}}let u=Oh({workspaceVertices:s.desiredVertices[o],currentVertexValue:r.vertices[o],desiredVertex:e.vertices[o]});return s.desiredVertices[o]=u.tree,{success:!0,instructions:[{setStateVariable:"vertices",value:{[o]:u.simplify()}}]}}},t.nVertices={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{nVertices:3}})},t}},Eh=No;function Oh({workspaceVertices:l,currentVertexValue:t,desiredVertex:e}){let n;l?n=l.slice(0):n=t.tree.slice(0);for(let[r,i]of e.tree.entries())i!==void 0&&(n[r]=i);return Kr.default.fromAst(n)}var Rt=De(Ee()),wo=class extends Tn{static componentType="rectangle";static rendererType="polygon";static get stateVariablesShadowedForReference(){return["vertices","nVertices","nVerticesSpecified","haveSpecifiedCenter","specifiedWidth","specifiedHeight","specifiedCenter"]}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneCenter",componentType:"center",comparison:"atMost",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"atMostOneWidth",componentType:"width",comparison:"atMost",number:1,takePropertyChildren:!0}),i=e.newLeaf({name:"atMostOneHeight",componentType:"height",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"rectangleLogic",operator:"and",propositions:[n,r,i,e.baseLogic],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nVerticesSpecified={returnDependencies:()=>({verticesChild:{dependencyType:"child",childLogicName:"atMostOneVertices",variableNames:["nPoints"]}}),definition:function({dependencyValues:e}){return e.verticesChild.length===1?{newValues:{nVerticesSpecified:e.verticesChild[0].stateValues.nPoints}}:{newValues:{nVerticesSpecified:0}}}},t.essentialVertex={isArray:!0,entryPrefixes:["essentialVertexX"],defaultEntryValue:Rt.default.fromAst(0),returnArraySizeDependencies:()=>({nVerticesSpecified:{dependencyType:"stateVariable",variableName:"nVerticesSpecified"}}),returnArraySize({dependencyValues:e}){return[e.nVerticesSpecified===0?2:0]},returnArrayDependenciesByKey(){return{}},arrayDefinitionByKey:function({arrayKeys:e}){let n={};for(let r of e)n[r]={variablesToCheck:["essentialVertexX"+(Number(r)+1)]};return{useEssentialOrDefaultValue:{essentialVertex:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let n=[];for(let r in e.essentialVertex)n.push({setStateVariable:"essentialVertex",value:{[r]:e.essentialVertex[r]}});return{success:!0,instructions:n}}},t.haveSpecifiedCenter={returnDependencies:()=>({centerChild:{dependencyType:"child",childLogicName:"atMostOneCenter"}}),definition:({dependencyValues:e})=>({newValues:{haveSpecifiedCenter:e.centerChild.length===1}})},t.specifiedCenter={isArray:!0,entryPrefixes:["specifiedCenterX"],returnArraySizeDependencies:()=>({haveSpecifiedCenter:{dependencyType:"stateVariable",variableName:"haveSpecifiedCenter"}}),returnArraySize({dependencyValues:e}){return[e.haveSpecifiedCenter?2:0]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let i=Number(r)+1;n[r]={centerChild:{dependencyType:"child",childLogicName:"atMostOneCenter",variableNames:["x"+i]}}}return{dependenciesByKey:n}},arrayDefinitionByKey:function({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=Number(a)+1;n[a].centerChild.length===1&&(i[a]=n[a].centerChild[0].stateValues["x"+s])}return{newValues:{specifiedCenter:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,arraySize:a}){let s=[];for(let o in e.specifiedCenter)r[o].centerChild&&r[o].centerChild.length===1&&s.push({setDependency:i[o].centerChild,desiredValue:e.specifiedCenter[o],childIndex:0,variableIndex:0});return{success:!0,instructions:s}}},t.specifiedWidth={defaultValue:1,returnDependencies(){return{specifiedWidthChild:{dependencyType:"child",childLogicName:"atMostOneWidth",variableNames:["value"]},nVerticesSpecified:{dependencyType:"stateVariable",variableName:"nVerticesSpecified"},centerChild:{dependencyType:"child",childLogicName:"atMostOneCenter"}}},definition({dependencyValues:e}){return e.specifiedWidthChild.length===1?{newValues:{specifiedWidth:e.specifiedWidthChild[0].stateValues.value}}:e.centerChild.length+e.nVerticesSpecified<=1?{useEssentialOrDefaultValue:{specifiedWidth:{variablesToCheck:["specifiedWidth"]}}}:{newValues:{specifiedWidth:null}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){return n.specifiedWidthChild.length===1?{success:!0,instructions:[{setDependency:"specifiedWidthChild",desiredValue:e.specifiedWidth,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setStateVariable:"specifiedWidth",value:e.specifiedWidth}]}}},t.specifiedHeight={defaultValue:1,returnDependencies(){return{specifiedHeightChild:{dependencyType:"child",childLogicName:"atMostOneHeight",variableNames:["value"]},nVerticesSpecified:{dependencyType:"stateVariable",variableName:"nVerticesSpecified"},centerChild:{dependencyType:"child",childLogicName:"atMostOneCenter"}}},definition({dependencyValues:e}){return e.specifiedHeightChild.length===1?{newValues:{specifiedHeight:e.specifiedHeightChild[0].stateValues.value}}:e.centerChild.length+e.nVerticesSpecified<=1?{useEssentialOrDefaultValue:{specifiedHeight:{variablesToCheck:["specifiedHeight"]}}}:{newValues:{specifiedHeight:null}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){return n.specifiedHeightChild.length===1?{success:!0,instructions:[{setDependency:"specifiedHeightChild",desiredValue:e.specifiedHeight,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setStateVariable:"specifiedHeight",value:e.specifiedHeight}]}}},t.center={public:!0,isArray:!0,entryPrefixes:["centerX"],componentType:"math",returnWrappingComponents(e){return e==="centerX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},returnArraySizeDependencies:()=>({}),returnArraySize:()=>[2],returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e){let i=Number(r)+1;n[r]={vertex0:{dependencyType:"stateVariable",variableName:"vertexX1_"+i},vertex2:{dependencyType:"stateVariable",variableName:"vertexX3_"+i}}}return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=e[i].vertex0,s=e[i].vertex2;r[i]=a.add(s).divide(2).simplify()}return{newValues:{center:r}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:n,dependencyNamesByKey:r,stateValues:i}){let a=[];for(let s in e.center){let o=Number(s),u=n[s].vertex0,c=n[s].vertex2,f=e.center[o].subtract(i.center[o]),p=u.add(f).simplify(),d=c.add(f).simplify();a.push({setDependency:r[s].vertex0,desiredValue:p},{setDependency:r[s].vertex2,desiredValue:d})}return{success:!0,instructions:a}}},t.width={public:!0,componentType:"number",returnDependencies({}){return{vertex0:{dependencyType:"stateVariable",variableName:"vertexX1_1"},vertex2:{dependencyType:"stateVariable",variableName:"vertexX3_1"}}},definition({dependencyValues:e}){let n=e.vertex0.evaluate_to_constant(),r=e.vertex2.evaluate_to_constant();return{newValues:{width:Math.abs(n-r)}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n,stateValues:r}){let i=n.vertex0.evaluate_to_constant(),a=n.vertex2.evaluate_to_constant(),s=(a+i)/2,u=(a-i<0?-1:1)*Math.max(0,e.width)/2,c=Rt.default.fromAst(s-u),f=Rt.default.fromAst(s+u);return{success:!0,instructions:[{setDependency:"vertex0",desiredValue:c},{setDependency:"vertex2",desiredValue:f}]}}},t.height={public:!0,componentType:"number",returnDependencies({}){return{vertex0:{dependencyType:"stateVariable",variableName:"vertexX1_2"},vertex2:{dependencyType:"stateVariable",variableName:"vertexX3_2"}}},definition({dependencyValues:e}){let n=e.vertex0.evaluate_to_constant(),r=e.vertex2.evaluate_to_constant();return{newValues:{height:Math.abs(n-r)}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){let r=n.vertex0.evaluate_to_constant(),i=n.vertex2.evaluate_to_constant(),a=(i+r)/2,o=(i-r<0?-1:1)*Math.max(0,e.height)/2,u=Rt.default.fromAst(a-o),c=Rt.default.fromAst(a+o);return{success:!0,instructions:[{setDependency:"vertex0",desiredValue:u},{setDependency:"vertex2",desiredValue:c}]}}},t.vertices={public:!0,componentType:"point",isArray:!0,nDimensions:2,entryPrefixes:["vertexX","vertex"],returnWrappingComponents(e){return e==="vertexX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="vertexX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}},stateVariablesDeterminingDependencies:["nVerticesSpecified","haveSpecifiedCenter"],returnArraySizeDependencies:()=>({}),returnArraySize(){return[4,2]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={},i={nVerticesSpecified:{dependencyType:"stateVariable",variableName:"nVerticesSpecified"}};if(n.nVerticesSpecified===0)if(i.haveSpecifiedCenter={dependencyType:"stateVariable",variableName:"haveSpecifiedCenter"},n.haveSpecifiedCenter)for(let a of e){let[s,o]=a.split(",");r[a]={specifiedCenter:{dependencyType:"stateVariable",variableName:"specifiedCenterX"+(Number(o)+1)}},o==="0"?r[a].specifiedWidth={dependencyType:"stateVariable",variableName:"specifiedWidth"}:r[a].specifiedHeight={dependencyType:"stateVariable",variableName:"specifiedHeight"}}else for(let a of e){let[s,o]=a.split(",");r[a]={essentialVertex:{dependencyType:"stateVariable",variableName:"essentialVertexX"+(Number(o)+1)}},o==="0"?(s==="1"||s==="2")&&(r[a].specifiedWidth={dependencyType:"stateVariable",variableName:"specifiedWidth"}):(s==="2"||s==="3")&&(r[a].specifiedHeight={dependencyType:"stateVariable",variableName:"specifiedHeight"})}else if(n.nVerticesSpecified===1)if(i.haveSpecifiedCenter={dependencyType:"stateVariable",variableName:"haveSpecifiedCenter"},n.haveSpecifiedCenter)for(let a of e){let[s,o]=a.split(","),u="1_"+(Number(o)+1);r[a]={verticesChild:{dependencyType:"child",childLogicName:"atMostOneVertices",variableNames:["pointX"+u]}},(o==="0"&&s==="1"||s==="2"||o==="1"&&s==="2"||s==="3")&&(r[a].specifiedCenter={dependencyType:"stateVariable",variableName:"specifiedCenterX"+(Number(o)+1)})}else for(let a of e){let[s,o]=a.split(","),u="1_"+(Number(o)+1);r[a]={verticesChild:{dependencyType:"child",childLogicName:"atMostOneVertices",variableNames:["pointX"+u]}},o==="0"?(s==="1"||s==="2")&&(r[a].specifiedWidth={dependencyType:"stateVariable",variableName:"specifiedWidth"}):(s==="2"||s==="3")&&(r[a].specifiedHeight={dependencyType:"stateVariable",variableName:"specifiedHeight"})}else for(let a of e){let[s,o]=a.split(","),u="1_"+(Number(o)+1),c="2_"+(Number(o)+1),f;s==="0"?f=u:s==="2"?f=c:s==="1"?o==="0"?f=c:f=u:o==="0"?f=u:f=c,r[a]={verticesChild:{dependencyType:"child",childLogicName:"atMostOneVertices",variableNames:["pointX"+f]}}}return{dependenciesByKey:r,globalDependencies:i}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n,globalDependencyValues:r}){let i={};if(r.nVerticesSpecified===0)if(r.haveSpecifiedCenter)for(let a of n){let[s,o]=a.split(","),u=e[a].specifiedCenter;if(o==="0"){let c=e[a].specifiedWidth;s==="0"||s==="3"?i[a]=u.subtract(c/2):i[a]=u.add(c/2)}else{let c=e[a].specifiedHeight;s==="0"||s==="1"?i[a]=u.subtract(c/2):i[a]=u.add(c/2)}}else for(let a of n){let[s,o]=a.split(","),u=e[a].essentialVertex;if(o==="0")if(s==="0"||s==="3")i[a]=u;else{let c=e[a].specifiedWidth;i[a]=u.add(c)}else if(s==="0"||s==="1")i[a]=u;else{let c=e[a].specifiedHeight;i[a]=u.add(c)}}else if(r.nVerticesSpecified===1)if(r.haveSpecifiedCenter)for(let a of n){let[s,o]=a.split(","),u=e[a].verticesChild,c;if(u.length===1&&Object.keys(u[0].stateValues).length===1?c=Object.values(u[0].stateValues)[0]:c=Rt.default.fromAst("\uFF3F"),o==="0"&&(s==="0"||s==="3")||o==="1"&&(s==="0"||s==="1"))i[a]=c;else{let f=e[a].specifiedCenter;i[a]=c.add(f.subtract(c).multiply(2))}}else for(let a of n){let[s,o]=a.split(","),u=e[a].verticesChild,c;if(u.length===1&&Object.keys(u[0].stateValues).length===1?c=Object.values(u[0].stateValues)[0]:c=Rt.default.fromAst("\uFF3F"),o==="0")if(s==="0"||s==="3")i[a]=c;else{let f=e[a].specifiedWidth;i[a]=c.add(f)}else if(s==="0"||s==="1")i[a]=c;else{let f=e[a].specifiedHeight;i[a]=c.add(f)}}else for(let a of n){let s=e[a].verticesChild;s.length===1&&Object.keys(s[0].stateValues).length===1?i[a]=Object.values(s[0].stateValues)[0]:i[a]=Rt.default.fromAst("\uFF3F")}return{newValues:{vertices:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyValuesByKey:n,globalDependencyValues:r,stateValues:i,workspace:a,initialChange:s,dependencyNamesByKey:o}){if(s&&!i.draggable)return{success:!1};a.v0||(a.v0=[...i.vertices[0]],a.v2=[...i.vertices[2]]);let u,c,f,p,d,m;for(let h in e.vertices){let[y,g]=h.split(","),b=e.vertices[h];y==="0"?a.v0[Number(g)]=b:y==="2"?a.v2[Number(g)]=b:y==="1"?g==="0"?a.v2[Number(g)]=b:a.v0[Number(g)]=b:g==="0"?a.v0[Number(g)]=b:a.v2[Number(g)]=b,g==="0"?(u=h,y==="0"||y==="3"?f=h:d=h):(c=h,y==="0"||y==="1"?p=h:m=h)}let v=[];if(r.nVerticesSpecified===0)if(r.haveSpecifiedCenter){if(u!==void 0){let h=a.v2[0].subtract(a.v0[0]).evaluate_to_constant(),y=a.v2[0].add(a.v0[0]).divide(2).simplify();v.push({setDependency:o[u].specifiedWidth,desiredValue:h},{setDependency:o[u].specifiedCenter,desiredValue:y})}if(c!==void 0){let h=a.v2[1].subtract(a.v0[1]).evaluate_to_constant(),y=a.v2[1].add(a.v0[1]).divide(2).simplify();v.push({setDependency:o[c].specifiedHeight,desiredValue:h},{setDependency:o[c].specifiedCenter,desiredValue:y})}}else{if(f!==void 0){let h=a.v0[0].simplify();v.push({setDependency:o[f].essentialVertex,desiredValue:h})}if(d!==void 0){let h=a.v2[0].subtract(a.v0[0]).evaluate_to_constant();v.push({setDependency:o[d].specifiedWidth,desiredValue:h})}if(p!==void 0){let h=a.v0[1].simplify();v.push({setDependency:o[p].essentialVertex,desiredValue:h})}if(m!==void 0){let h=a.v2[1].subtract(a.v0[1]).evaluate_to_constant();v.push({setDependency:o[m].specifiedHeight,desiredValue:h})}}else if(r.nVerticesSpecified===1)if(r.haveSpecifiedCenter){if(f!==void 0){let h=a.v0[0].simplify();v.push({setDependency:o[f].verticesChild,desiredValue:h,childIndex:0,variableIndex:0})}if(d!==void 0){let h=a.v2[0].add(a.v0[0]).divide(2).simplify();v.push({setDependency:o[d].specifiedCenter,desiredValue:h})}if(p!==void 0){let h=a.v0[1].simplify();v.push({setDependency:o[p].verticesChild,desiredValue:h,childIndex:0,variableIndex:0})}if(m!==void 0){let h=a.v2[1].add(a.v0[1]).divide(2).simplify();v.push({setDependency:o[m].specifiedCenter,desiredValue:h})}}else{if(f!==void 0){let h=a.v0[0].simplify();v.push({setDependency:o[f].verticesChild,desiredValue:h,childIndex:0,variableIndex:0})}if(d!==void 0){let h=a.v2[0].subtract(a.v0[0]).evaluate_to_constant();v.push({setDependency:o[d].specifiedWidth,desiredValue:h})}if(p!==void 0){let h=a.v0[1].simplify();v.push({setDependency:o[p].verticesChild,desiredValue:h,childIndex:0,variableIndex:0})}if(m!==void 0){let h=a.v2[1].subtract(a.v0[1]).evaluate_to_constant();v.push({setDependency:o[m].specifiedHeight,desiredValue:h})}}else f!==void 0&&v.push({setDependency:o[f].verticesChild,desiredValue:a.v0[0],childIndex:0,variableIndex:0}),d!==void 0&&v.push({setDependency:o[d].verticesChild,desiredValue:a.v2[0],childIndex:0,variableIndex:0}),p!==void 0&&v.push({setDependency:o[p].verticesChild,desiredValue:a.v0[1],childIndex:0,variableIndex:0}),m!==void 0&&v.push({setDependency:o[m].verticesChild,desiredValue:a.v2[1],childIndex:0,variableIndex:0});return{success:!0,instructions:v}}},t.nVertices={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{nVertices:4}})},t}movePolygon(t){let e=[],n={};for(let r in t)n[r+",0"]=Rt.default.fromAst(t[r][0]),n[r+",1"]=Rt.default.fromAst(t[r][1]);if(e.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"vertices",value:n}),Object.keys(t).length===1){let r=Number(Object.keys(t)[0]),i=Rt.default.fromAst(t[r][0]),a=Rt.default.fromAst(t[r][1]),s=(r+2)%4,o=this.stateValues.vertices[s][0],u=this.stateValues.vertices[s][1];if(this.stateValues.nVerticesSpecified<2)if(this.stateValues.haveSpecifiedCenter){let c,f;r===0?(c=i.add(o).divide(2),f=a.add(u).divide(2)):r===1?f=a.add(u).divide(2):r===3&&(c=i.add(o).divide(2)),c!==void 0&&e.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"specifiedCenter",value:{0:c.simplify()}}),f!==void 0&&e.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"specifiedCenter",value:{1:f.simplify()}})}else{let c,f;r===0?(c=o.subtract(i),f=u.subtract(a)):r===1?f=u.subtract(a):r===3&&(c=o.subtract(i)),c!==void 0&&e.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"specifiedWidth",value:c.simplify()}),f!==void 0&&e.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"specifiedHeight",value:f.simplify()})}}this.coreFunctions.requestUpdate({updateInstructions:e})}},Ph=wo;var yt=De(Ee()),To=class extends lt{static componentType="curve";static rendererType="curve";actions={moveControlVector:this.moveControlVector.bind(new Proxy(this,this.readOnlyProxyHandler)),moveThroughPoint:this.moveThroughPoint.bind(new Proxy(this,this.readOnlyProxyHandler)),changeVectorControlDirection:this.changeVectorControlDirection.bind(new Proxy(this,this.readOnlyProxyHandler))};static primaryStateVariableForDefinition="fShadow";static get stateVariablesShadowedForReference(){return["variableForChild","parmin","parmax","curveType","nThroughPoints","nDimensions","throughPoints"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.draggable={default:!0,forRenderer:!0},e.label.propagateToDescendants=!0,e.showLabel.propagateToDescendants=!0,e.layer.propagateToDescendants=!0,e.flipFunction={default:!1,forRenderer:!0},e.nDiscretizationPoints={default:500},e.periodic={default:!1},e.splineTension={default:.8,clamp:[0,1]},e.extrapolateBackward={default:!1,forRenderer:!0},e.extrapolateForward={default:!1,forRenderer:!0},e.splineForm={default:"centripetal",toLowerCase:!0,validValues:["centripetal","uniform"]},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let a=Sr({childrenToComponentFunction:s=>({componentType:"function",children:s}),mustStripOffOuterParentheses:!0})({matchedChildren:n});return a.success?a:{success:!0,newChildren:[{componentType:"function",children:n}]}};return t.push({childrenRegex:/s/,replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroFunctions",componentType:"function",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atMostOneThrough",componentType:"through",comparison:"atMost",number:1,takePropertyChildren:!0}),i=e.newLeaf({name:"atMostOneBezierControls",componentType:"beziercontrols",comparison:"atMost",number:1}),a=e.newOperator({name:"throughAndControls",operator:"and",propositions:[r,i]}),s=e.newOperator({name:"functionsXorThrough",operator:"xor",propositions:[n,a]}),o=e.newLeaf({name:"atMostOneVariable",componentType:"variable",comparison:"atMost",number:1,takePropertyChildren:!0}),u=e.newLeaf({name:"atMostOneParMin",componentType:"parmin",comparison:"atMost",number:1,takePropertyChildren:!0}),c=e.newLeaf({name:"atMostOneParMax",componentType:"parmax",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"curveLogic",operator:"and",propositions:[s,o,u,c],setAsBase:!0}),e}static returnStateVariableDefinitions({numerics:t}){let e=super.returnStateVariableDefinitions({numerics:t});return e.styleDescription={public:!0,componentType:"text",returnDependencies:()=>({selectedStyle:{dependencyType:"stateVariable",variableName:"selectedStyle"}}),definition:function({dependencyValues:n}){let r="";return n.selectedStyle.lineWidth>=4?r+="thick ":n.selectedStyle.lineWidth<=1&&(r+="thin "),n.selectedStyle.lineStyle==="dashed"?r+="dashed ":n.selectedStyle.lineStyle==="dotted"&&(r+="dotted "),r+=n.selectedStyle.lineColor,{newValues:{styleDescription:r}}}},e.variableForChild={defaultValue:yt.default.fromAst("x"),returnDependencies:()=>({variableChild:{dependencyType:"child",childLogicName:"atMostOneVariable",variableNames:["value"]}}),definition({dependencyValues:n}){return n.variableChild.length===1?{newValues:{variableForChild:n.variableChild[0].stateValues.value}}:{useEssentialOrDefaultValue:{variableForChild:{variablesToCheck:["variable","variableForChild"]}}}}},e.curveType={forRenderer:!0,returnDependencies:()=>({functionChildren:{dependencyType:"child",childLogicName:"atLeastZeroFunctions"},throughChild:{dependencyType:"child",childLogicName:"atMostOneThrough"}}),definition({dependencyValues:n}){let r="function";return n.throughChild.length===1?r="bezier":n.functionChildren.length>1&&(r="parameterization"),{newValues:{curveType:r}}}},e.fShadow={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{fShadow:{variablesToCheck:["fShadow"]}}})},e.parmax={public:!0,componentType:"number",forRenderer:!0,defaultValue:10,returnDependencies:()=>({curveType:{dependencyType:"stateVariable",variableName:"curveType"},parMaxChild:{dependencyType:"child",childLogicName:"atMostOneParMax",variableNames:["value"]},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},extrapolateForward:{dependencyType:"stateVariable",variableName:"extrapolateForward"}}),definition:function({dependencyValues:n}){let r;if(n.curveType==="bezier")r=n.nThroughPoints-1,n.extrapolateForward&&(r*=2);else if(n.parMaxChild.length===1)r=n.parMaxChild[0].stateValues.value.evaluate_to_constant(),Number.isFinite(r)||(r=NaN);else return{useEssentialOrDefaultValue:{parmax:{variablesToCheck:["parmax"]}}};return{newValues:{parmax:r}}}},e.parmin={forRenderer:!0,public:!0,componentType:"number",defaultValue:-10,returnDependencies:()=>({curveType:{dependencyType:"stateVariable",variableName:"curveType"},parMinChild:{dependencyType:"child",childLogicName:"atMostOneParMin",variableNames:["value"]},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},extrapolateBackward:{dependencyType:"stateVariable",variableName:"extrapolateBackward"}}),definition:function({dependencyValues:n}){let r;if(n.curveType==="bezier")r=0,n.extrapolateBackward&&(r=-(n.nThroughPoints-1));else if(n.parMinChild.length===1)r=n.parMinChild[0].stateValues.value.evaluate_to_constant(),Number.isFinite(r)||(r=NaN);else return{useEssentialOrDefaultValue:{parmin:{variablesToCheck:["parmin"]}}};return{newValues:{parmin:r}}}},e.nThroughPoints={returnDependencies:()=>({throughChild:{dependencyType:"child",childLogicName:"atMostOneThrough",variableNames:["nPoints"]}}),definition({dependencyValues:n}){let r=0;return n.throughChild.length===1&&(r=n.throughChild[0].stateValues.nPoints),{newValues:{nThroughPoints:r}}}},e.nDimensions={public:!0,componentType:"number",returnDependencies(){return{throughChild:{dependencyType:"child",childLogicName:"atMostOneThrough",variableNames:["nDimensions"]}}},definition:function({dependencyValues:n}){return n.throughChild.length===1?{newValues:{nDimensions:n.throughChild[0].stateValues.nDimensions},checkForActualChange:{nDimensions:!0}}:{newValues:{nDimensions:2}}}},e.throughPoints={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["throughPointX","throughPoint"],returnWrappingComponents(n){return n==="throughPointX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:r,arraySize:i}){if(n==="throughPointX"){let a=r.split("_").map(s=>Number(s)-1);return a.length===2&&a.every((s,o)=>Number.isInteger(s)&&s>=0)?i?a.every((s,o)=>s<i[o])?[String(a)]:[]:[String(a)]:[]}else{if(!i)return[];let a=Number(r)-1;return Number.isInteger(a)&&a>=0&&a<i[0]?Array.from(Array(i[1]),(s,o)=>a+","+o):[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints,n.nDimensions]},returnArrayDependenciesByKey({arrayKeys:n}){let r={};for(let i of n){let[a,s]=i.split(","),o=Number(a)+1+"_"+(Number(s)+1);r[i]={throughChild:{dependencyType:"child",childLogicName:"atMostOneThrough",variableNames:["pointX"+o]}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let[s,o]=a.split(","),u=Number(s)+1+"_"+(Number(o)+1),c=n[a].throughChild;c.length===1&&c[0].stateValues["pointX"+u]?i[a]=c[0].stateValues["pointX"+u]:i[a]=yt.default.fromAst(0)}return{newValues:{throughPoints:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,initialChange:a,stateValues:s}){if(a&&!s.draggable)return{success:!1};let o=[];for(let u in n.throughPoints){let[c,f]=u.split(","),p=Number(c)+1+"_"+(Number(f)+1);if(r[u].throughChild.length===1&&r[u].throughChild[0].stateValues["pointX"+p])o.push({setDependency:i[u].throughChild,desiredValue:n.throughPoints[u],childIndex:0,variableIndex:0});else return{success:!1}}return{success:!0,instructions:o}}},e.numericalThroughPoints={isArray:!0,entryPrefixes:["numericalThroughPoint"],forRenderer:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints]},returnArrayDependenciesByKey({arrayKeys:n}){let r={};for(let i of n)r[i]={throughPoint:{dependencyType:"stateVariable",variableName:"throughPoint"+(Number(i)+1)}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].throughPoint.map(o=>o.evaluate_to_constant());s.every(o=>Number.isFinite(o))||(s=Array(s.length).fill(NaN)),i[a]=s}return{newValues:{numericalThroughPoints:i}}}},e.haveBezierControls={forRenderer:!0,returnDependencies:()=>({controlChild:{dependencyType:"child",childLogicName:"atMostOneBezierControls"}}),definition({dependencyValues:n}){return{newValues:{haveBezierControls:n.controlChild.length===1}}}},e.vectorControlDirections={public:!0,componentType:"text",isArray:!0,entryPrefixes:["vectorControlDirection"],forRenderer:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints]},returnArrayDependenciesByKey({arrayKeys:n}){let r={};for(let a of n)r[a]={controlChild:{dependencyType:"child",childLogicName:"atMostOneBezierControls",variableNames:["direction"+(Number(a)+1)]}};return{dependenciesByKey:r,globalDependencies:{haveBezierControls:{dependencyType:"stateVariable",variableName:"haveBezierControls"}}}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].controlChild;s&&s.length===1?i[a]=s[0].stateValues["direction"+(Number(a)+1)]:i[a]="none"}return{newValues:{vectorControlDirections:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyNamesByKey:r,dependencyValuesByKey:i,globalDependencyValues:a}){if(!a.haveBezierControls)return{success:!1};let s=[],o={};for(let u in n.vectorControlDirections){let c=i[u].controlChild;c&&c.length===1?s.push({setDependency:r[u].controlChild,desiredValue:n.vectorControlDirections[u],childIndex:0,variableIndex:0}):o[u]=n.vectorControlDirections[u]}return Object.keys(o).length>0&&s.push({setStateVariable:"vectorControlDirections",value:o}),{success:!0,instructions:s}}},e.controlVectors={isArray:!0,public:!0,componentType:"math",entryPrefixes:["controlVectorX","controlVector"],nDimensions:3,stateVariablesDeterminingDependencies:["vectorControlDirections","nThroughPoints"],returnWrappingComponents(n){return n==="controlVectorX"?[]:[["vector",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:r,arraySize:i}){if(n==="controlVectorX"){let a=r.split("_").map(s=>Number(s)-1);return a.length===3&&a.every((s,o)=>Number.isInteger(s)&&s>=0)?i?a.every((s,o)=>s<i[o])?[String(a)]:[]:[String(a)]:[]}else{if(!i)return[];let a=r.split("_").map(s=>Number(s)-1);return a.length===2&&a.every((s,o)=>Number.isInteger(s)&&s>=0&&s<i[o])?Array.from(Array(i[2]),(s,o)=>String(a)+","+o):[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints,2,n.nDimensions]},returnArrayDependenciesByKey({arrayKeys:n,stateValues:r}){let i={haveBezierControls:{dependencyType:"stateVariable",variableName:"haveBezierControls"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"},splineTension:{dependencyType:"stateVariable",variableName:"splineTension"},splineForm:{dependencyType:"stateVariable",variableName:"splineForm"}},a={};for(let s of n){let o=s.split(",").map(m=>Number(m)),u=o.map(m=>m+1),c=u.join("_");a[s]={direction:{dependencyType:"stateVariable",variableName:"vectorControlDirection"+u[0]},controlChild:{dependencyType:"child",childLogicName:"atMostOneBezierControls",variableNames:["control"+c]}};let f=o[0],p=r.vectorControlDirections[f],d=[];p==="none"?d=[f-1,f,f+1]:p==="previous"?d=[f,f+1]:p==="next"&&(d=[f-1,f]);for(let m of d)m>=0&&m<r.nThroughPoints&&(a[s]["throughPoint"+(m+1)]={dependencyType:"stateVariable",variableName:"throughPoint"+(m+1)})}return{globalDependencies:i,dependenciesByKey:a}},arrayDefinitionByKey({globalDependencyValues:n,dependencyValuesByKey:r,arrayKeys:i}){let a={};for(let s of i){if(n.nDimensions!==2){a[s]=yt.default.fromAst(NaN);continue}if(s in a)continue;let o=s.split(",").map(m=>Number(m)),c=o.map(m=>m+1).join("_"),f=o[0],p=o[1],d=r[s].direction;if(d||(d="none"),d==="none"){let m=r[s]["throughPoint"+(f+1)],v,h;f>0&&(v=r[s]["throughPoint"+f]),f<n.nThroughPoints&&(h=r[s]["throughPoint"+(f+2)]);let{coordsNumeric:y,numericEntries:g}=Lh({tau:n.splineTension,eps:t.eps,splineForm:n.splineForm,point1:v,point2:m,point3:h});for(let b=0;b<2;b++){let x=f+","+p+","+b,N=f+","+(1-p)+","+b;p===0?(a[x]=y[b],a[N]=yt.default.fromAst(-y[b].tree)):(a[x]=yt.default.fromAst(-y[b].tree),a[N]=y[b])}}else{let m=!1,v=r[s].controlChild;if(v.length===1){let h=v[0].stateValues["control"+c];h&&(m=!0,a[s]=h)}if(!m){let h=r[s]["throughPoint"+f],y=r[s]["throughPoint"+(f+1)],g=r[s]["throughPoint"+(f+2)],{coordsNumeric:b,numericEntries:x}=Lh({tau:n.splineTension,eps:t.eps,splineForm:n.splineForm,point1:h||g,point2:y,point3:void 0});for(let N=0;N<2;N++){let C=f+","+p+","+N;a[C]=b[N]}}}}return{newValues:{controlVectors:a}}},inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyNamesByKey:r,dependencyValuesByKey:i,globalDependencyValues:a}){if(!a.haveBezierControls||a.nDimensions!==2)return{success:!1};let s=[];for(let o in n.controlVectors){let f=o.split(",").map(d=>Number(d)).map(d=>d+1).join("_"),p=i[o].controlChild;p.length===1&&p[0].stateValues["control"+f]&&s.push({setDependency:r[o].controlChild,desiredValue:n.controlVectors[o],childIndex:0,variableIndex:0})}return{success:!0,instructions:s}}},e.numericalControlVectors={isArray:!0,entryPrefixes:["numericalControlVector"],forRenderer:!0,nDimensions:2,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints,2]},returnArrayDependenciesByKey({arrayKeys:n}){let r={};for(let i of n){let o=i.split(",").map(u=>Number(u)).map(u=>u+1).join("_");r[i]={controlVector:{dependencyType:"stateVariable",variableName:"controlVector"+o}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].controlVector.map(o=>o.tree);i[a]=s}return{newValues:{numericalControlVectors:i}}}},e.controlPoints={isArray:!0,public:!0,componentType:"math",entryPrefixes:["controlPointX","controlPoint"],nDimensions:3,returnWrappingComponents(n){return n==="controlPointX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:n,varEnding:r,arraySize:i}){if(n==="controlPointX"){let a=r.split("_").map(s=>Number(s)-1);return a.length===3&&a.every((s,o)=>Number.isInteger(s)&&s>=0)?i?a.every((s,o)=>s<i[o])?[String(a)]:[]:[String(a)]:[]}else{if(!i)return[];let a=r.split("_").map(s=>Number(s)-1);return a.length===2&&a.every((s,o)=>Number.isInteger(s)&&s>=0&&s<i[o])?Array.from(Array(i[2]),(s,o)=>String(a)+","+o):[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints,2,n.nDimensions]},returnArrayDependenciesByKey({arrayKeys:n}){let r={haveBezierControls:{dependencyType:"stateVariable",variableName:"haveBezierControls"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}},i={};for(let a of n){let o=a.split(",").map(c=>Number(c)).map(c=>c+1),u=o.join("_");i[a]={throughPointX:{dependencyType:"stateVariable",variableName:"throughPointX"+o[0]+"_"+o[2]},controlVectorX:{dependencyType:"stateVariable",variableName:"controlVectorX"+u}}}return{globalDependencies:r,dependenciesByKey:i}},arrayDefinitionByKey({globalDependencyValues:n,dependencyValuesByKey:r,arrayKeys:i}){let a={};for(let s of i)if(n.nDimensions!==2)a[s]=yt.default.fromAst(NaN);else{let o=r[s].controlVectorX;if(o){let u=r[s].throughPointX.evaluate_to_constant();Number.isFinite(u)||(u=NaN),a[s]=yt.default.fromAst(u+o.tree)}else a[s]=null}return{newValues:{controlPoints:a}}},inverseArrayDefinitionByKey({desiredStateVariableValues:n,dependencyNamesByKey:r,dependencyValuesByKey:i,globalDependencyValues:a}){if(!a.haveBezierControls||a.nDimensions!==2)return{success:!1};let s=[];for(let o in n.controlPoints)if(i[o].controlVectorX){let c=i[o].throughPointX,f=n.controlPoints[o];f.tree&&(f=f.tree);let p=yt.default.fromAst(["+",f,["-",c.tree]]);s.push({setDependency:r[o].controlVectorX,desiredValue:p})}return{success:!0,instructions:s}}},e.numericalControlPoints={isArray:!0,entryPrefixes:["numericalControlPoint"],forRenderer:!0,nDimensions:2,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints,2]},returnArrayDependenciesByKey({arrayKeys:n}){let r={};for(let i of n){let o=i.split(",").map(u=>Number(u)).map(u=>u+1).join("_");r[i]={controlPoint:{dependencyType:"stateVariable",variableName:"controlPoint"+o}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].controlPoint.map(o=>o.tree);i[a]=s}return{newValues:{numericalControlPoints:i}}}},e.splineCoeffs={isArray:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:n}){return[n.nThroughPoints-1]},returnArrayDependenciesByKey({arrayKeys:n}){let r={};for(let i of n){let a=Number(i)+1,s=a+1;r[i]={previousPoint:{dependencyType:"stateVariable",variableName:"numericalThroughPoint"+a},nextPoint:{dependencyType:"stateVariable",variableName:"numericalThroughPoint"+s},previousVector:{dependencyType:"stateVariable",variableName:"numericalControlVector"+a+"_2"},nextVector:{dependencyType:"stateVariable",variableName:"numericalControlVector"+s+"_1"}}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r){let s=n[a].previousPoint,o=n[a].nextPoint,u=n[a].previousVector,c=n[a].nextVector,f=[];for(let p=0;p<2;p++)f.push(C1(s[p],o[p],3*u[p],-3*c[p]));i[a]=f}return{newValues:{splineCoeffs:i}}}},e.extrapolateBackwardCoeffs={returnDependencies:()=>({extrapolateBackward:{dependencyType:"stateVariable",variableName:"extrapolateBackward"},throughPoint1:{dependencyType:"stateVariable",variableName:"numericalThroughPoint1"},throughPoint2:{dependencyType:"stateVariable",variableName:"numericalThroughPoint2"},controlVector:{dependencyType:"stateVariable",variableName:"numericalControlVector1_1"}}),definition({dependencyValues:n}){if(!n.extrapolateBackward)return{newValues:{extrapolateBackwardCoeffs:null}};let r=n.throughPoint1,i=n.throughPoint2,a=n.controlVector;if(!(r&&i&&a))return{newValues:{extrapolateBackwardCoeffs:null}};let s=[];s[0]=[r[0],-3*a[0]*4,0];let o=(i[0]-r[0]-3*a[0])*-16;return o!==0&&a[0]/o>0&&(s[0][2]=o),s[1]=[r[1],-3*a[1]*4,0],o=(i[1]-r[1]-3*a[1])*-16,o!==0&&a[1]/o>0&&(s[1][2]=o),{newValues:{extrapolateBackwardCoeffs:s}}}},e.extrapolateForwardCoeffs={stateVariablesDeterminingDependencies:["nThroughPoints"],returnDependencies({stateValues:n}){let r={extrapolateForward:{dependencyType:"stateVariable",variableName:"extrapolateForward"}};return n.nThroughPoints>=2&&(r.throughPoint1={dependencyType:"stateVariable",variableName:"numericalThroughPoint"+(n.nThroughPoints-1)},r.throughPoint2={dependencyType:"stateVariable",variableName:"numericalThroughPoint"+n.nThroughPoints},r.controlVector={dependencyType:"stateVariable",variableName:"numericalControlVector"+n.nThroughPoints+"_2"}),r},definition({dependencyValues:n}){if(!n.extrapolateForward)return{newValues:{extrapolateForwardCoeffs:null}};let r=n.throughPoint1,i=n.throughPoint2,a=n.controlVector;if(!(r&&i&&a))return{newValues:{extrapolateForwardCoeffs:null}};let s=[];s[0]=[i[0],3*a[0]*4,0];let o=(r[0]-i[0]-3*a[0])*-16;return o!==0&&a[0]/o>0&&(s[0][2]=o),s[1]=[i[1],3*a[1]*4,0],o=(r[1]-i[1]-3*a[1])*-16,o!==0&&a[1]/o>0&&(s[1][2]=o),{newValues:{extrapolateForwardCoeffs:s}}}},e.fs={forRenderer:!0,isArray:!0,entryPrefixes:["f"],defaultEntryValue:()=>0,returnArraySizeDependencies:()=>({functionChildren:{dependencyType:"child",childLogicName:"atLeastZeroFunctions"},curveType:{dependencyType:"stateVariable",variableName:"curveType"}}),returnArraySize({dependencyValues:n}){return n.curveType==="bezier"?[2]:[Math.max(1,n.functionChildren.length)]},returnArrayDependenciesByKey({arrayKeys:n}){let r={curveType:{dependencyType:"stateVariable",variableName:"curveType"},numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},splineCoeffs:{dependencyType:"stateVariable",variableName:"splineCoeffs"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},extrapolateBackward:{dependencyType:"stateVariable",variableName:"extrapolateBackward"},extrapolateBackwardCoeffs:{dependencyType:"stateVariable",variableName:"extrapolateBackwardCoeffs"},extrapolateForward:{dependencyType:"stateVariable",variableName:"extrapolateForward"},extrapolateForwardCoeffs:{dependencyType:"stateVariable",variableName:"extrapolateForwardCoeffs"}},i={};for(let a of n)i[a]={functionChild:{dependencyType:"child",childLogicName:"atLeastZeroFunctions",variableNames:["numericalf"],childIndices:[a]}},Number(a)===0&&(i[a].fShadow={dependencyType:"stateVariable",variableName:"fShadow"});return{globalDependencies:r,dependenciesByKey:i}},arrayDefinitionByKey({globalDependencyValues:n,dependencyValuesByKey:r,arrayKeys:i}){if(n.curveType==="bezier")return{newValues:{fs:N1({globalDependencyValues:n,arrayKeys:i})}};let a={},s={};for(let o of i){let u=r[o].functionChild;u.length===1?a[o]=u[0].stateValues.numericalf:Number(o)===0&&r[o].fShadow?a[o]=r[o].fShadow:s[o]={variablesToCheck:[{variableName:"fs",arrayIndex:o}]}}return{newValues:{fs:a},useEssentialOrDefaultValue:{fs:s}}}},e.f={isAlias:!0,targetVariableName:"f1"},e.nearestPoint={returnDependencies:()=>({curveType:{dependencyType:"stateVariable",variableName:"curveType"},fs:{dependencyType:"stateVariable",variableName:"fs"},flipFunction:{dependencyType:"stateVariable",variableName:"flipFunction"},nDiscretizationPoints:{dependencyType:"stateVariable",variableName:"nDiscretizationPoints"},parmin:{dependencyType:"stateVariable",variableName:"parmin"},parmax:{dependencyType:"stateVariable",variableName:"parmax"},periodic:{dependencyType:"stateVariable",variableName:"periodic"}}),definition({dependencyValues:n}){let r=null;return n.curveType==="function"?r=b1({dependencyValues:n,numerics:t}):["parameterization","bezier"].includes(n.curveType)&&(r=x1({dependencyValues:n,numerics:t})),{newValues:{nearestPoint:r}}}},e}moveControlVector({controlVector:t,controlVectorInds:e,transient:n}){let r={[e+",0"]:yt.default.fromAst(t[0]),[e+",1"]:yt.default.fromAst(t[1])};n?this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"controlVectors",value:r,sourceInformation:{controlVectorMoved:e}}],transient:n}):this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"controlVectors",value:r,sourceInformation:{controlVectorMoved:e}}],event:{verb:"interacted",object:{componentId:this.componentName},result:{["controlVector"+e.join("_")]:t}}})}moveThroughPoint({throughPoint:t,throughPointInd:e,transient:n}){let r={[e+",0"]:yt.default.fromAst(t[0]),[e+",1"]:yt.default.fromAst(t[1])};n?this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"throughPoints",value:r,sourceInformation:{throughPointMoved:e}}],transient:n}):this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"throughPoints",value:r,sourceInformation:{throughPointMoved:e}}],event:{verb:"interacted",object:{componentId:this.componentName},result:{["throughPoint"+e]:t}}})}changeVectorControlDirection({direction:t,throughPointInd:e}){this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"vectorControlDirection",value:{[e]:t}}]})}},_n=To;function b1({dependencyValues:l,numerics:t}){let e=l.flipFunction,n=l.fs[0],r=l.nDiscretizationPoints;return function(i){let a,s;e?(s=i.x2.evaluate_to_constant(),a=n(s)):(a=i.x1.evaluate_to_constant(),s=n(a));let o=i.x1.evaluate_to_constant(),u=i.x2.evaluate_to_constant();if(!(Number.isFinite(o)&&Number.isFinite(u)))return Number.isFinite(a)&&Number.isFinite(s)?(b={x1:a,x2:x2Asx1AsFunction},i.x3!==void 0&&(b.x3=0),b):{};let c=function(C){let _=-10*Math.log(1/C-1),w=o,A=u;return e?(w-=n(_),A-=_):(w-=_,A-=n(_)),w*w+A*A},f=0,p=1,d=r,m=(p-f)/d,v=f,h=c(f),y=f,g=f+m;for(let C=1;C<=d;C++){let _=f+C*m,w=c(_);(w<h||Number.isNaN(h))&&(v=_,h=w,y=_-m,C===d?g=_:g=_+m)}let b=t.fminbr(c,[y,g]);v=b.x;let x=-10*Math.log(1/v-1),N=n(x);if(e&&([x,N]=[N,x]),Number.isFinite(a)&&Number.isFinite(s)){let C=Math.pow(a-o,2)+Math.pow(s-u,2),_=Math.pow(x-o,2)+Math.pow(N-u,2);if(C<100*_)return b={x1:a,x2:s},i.x3!==void 0&&(b.x3=0),b}return b={x1:x,x2:N},i.x3!==void 0&&(b.x3=0),b}}function x1({dependencyValues:l,numerics:t}){let e=l.fs,n=l.parmin,r=l.parmax,i=l.nDiscretizationPoints,a=l.periodic;return function(s){if(l.fs.length!==2)return{};let o=s.x1.evaluate_to_constant(),u=s.x2.evaluate_to_constant();if(!(Number.isFinite(o)&&Number.isFinite(u)))return{};let c=function(C){let _=o-e[0](C),w=u-e[1](C);return _*_+w*w},f=n,p=r,d=i,m=(p-f)/d,v=f,h=c(f),y=f,g=f+m;for(let C=1;C<=d;C++){let _=f+C*m,w=c(_);(w<h||Number.isNaN(h))&&(v=_,h=w,y=_-m,C===d?g=_:g=_+m)}a&&(Math.abs(v-f)<t.eps?y=f-m:Math.abs(v-p)<t.eps&&(g=p+m));let b=t.fminbr(c,[y,g]);v=b.x;let x=e[0](v),N=e[1](v);return b={x1:x,x2:N},s.x3!==void 0&&(b.x3=0),b}}function Lh({tau:l,eps:t,point1:e,point2:n,point3:r,splineForm:i}){let a=function(d,m){let v=d[0]-m[0],h=d[1]-m[1];return Math.sqrt(v*v+h*h)},s,o,u;if(n)o=n.map(d=>d.evaluate_to_constant());else return{coordsNumeric:[yt.default.fromAst(NaN),yt.default.fromAst(NaN)],numericEntries:!1};if(r)u=r.map(d=>d.evaluate_to_constant()),e?s=e.map(d=>d.evaluate_to_constant()):s=[2*o[0]-u[0],2*o[1]-u[1]];else if(e)s=e.map(d=>d.evaluate_to_constant()),u=[2*o[0]-s[0],2*o[1]-s[1]];else return{coordsNumeric:[yt.default.fromAst(NaN),yt.default.fromAst(NaN)],numericEntries:!1};let c=[];if(i==="centripetal"){let d=a(s,o),m=a(o,u);d=Math.sqrt(d),m=Math.sqrt(m),m<t&&(m=1),d<t&&(d=m);for(let v=0;v<2;v++){let h=(o[v]-s[v])/d-(u[v]-s[v])/(m+d)+(u[v]-o[v])/m;h*=l*Math.sqrt(d*m),c.push(-h/3)}}else for(let d=0;d<2;d++)c.push(-l*(u[d]-s[d])/3);let f=c.map(d=>yt.default.fromAst(d)),p=Number.isFinite(c[0])&&Number.isFinite(c[1]);return{coordsNumeric:f,numericEntries:p}}function C1(l,t,e,n){return[l,e,-3*l+3*t-2*e-n,2*l-2*t+e+n]}function N1({globalDependencyValues:l,arrayKeys:t}){if(l.nThroughPoints<1){let a={};for(let s of t)a[s]=()=>NaN;return a}let e=l.nThroughPoints-1,n={},r=l.extrapolateBackward,i=l.extrapolateForward;for(let a of t){let s=l.numericalThroughPoints[0][a],o=l.numericalThroughPoints[e][a],u=l.splineCoeffs.map(p=>p[a]),c;r&&(c=l.extrapolateBackwardCoeffs[a]);let f;i&&(f=l.extrapolateForwardCoeffs[a]),n[a]=function(p){if(isNaN(p))return NaN;if(p<0)return r?(c[2]*p+c[1])*p+c[0]:s;if(p>=e)return i?(p-=e,(f[2]*p+f[1])*p+f[0]):o;let d=Math.floor(p);p-=d;let m=u[d];return((m[3]*p+m[2])*p+m[1])*p+m[0]}}return n}var Ye=De(Ee()),_o=class extends _n{static componentType="circle";static rendererType="circle";actions={moveCircle:this.moveCircle.bind(new Proxy(this,this.readOnlyProxyHandler))};static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["throughPoints","nThroughPoints","prescribedCenter","prescribedRadius","havePrescribedCenter","havePrescribedRadius"]}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();let n=e.newLeaf({name:"exactlyOneThrough",componentType:"through",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"atMostOneCenter",componentType:"center",comparison:"atMost",number:1,takePropertyChildren:!0}),i=e.newLeaf({name:"exactlyOneRadius",componentType:"radius",number:1,takePropertyChildren:!0});return e.newOperator({name:"radiusCenterOrThrough",operator:"or",propositions:[i,n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(t){let e=lt.returnStateVariableDefinitions(t),n=super.returnStateVariableDefinitions(t);return e.styleDescription=n.styleDescription,e.curveType={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{curveType:"circle"}})},e.parmax={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{parmax:NaN}})},e.parmin={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{parmin:NaN}})},e.fs={forRenderer:!0,isArray:!0,entryPrefixes:["f"],defaultEntryValue:()=>0,returnArraySizeDependencies:()=>({}),returnArraySize:()=>[0],returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey:()=>({newValues:{fs:{}}})},e.nThroughPoints={returnDependencies:()=>({throughChild:{dependencyType:"child",childLogicName:"exactlyOneThrough",variableNames:["nPoints"]}}),definition:function({dependencyValues:r}){return r.throughChild.length===1?{newValues:{nThroughPoints:r.throughChild[0].stateValues.nPoints}}:{newValues:{nThroughPoints:0}}}},e.throughPoints={public:!0,componentType:"math",isArray:!0,nDimensions:2,entryPrefixes:["throughPointX","throughPoint"],returnWrappingComponents(r){return r==="throughPointX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:i,arraySize:a}){if(r==="throughPointX"){let s=i.split("_").map(o=>Number(o)-1);return s.length===2&&s.every((o,u)=>Number.isInteger(o)&&o>=0)?a?s.every((o,u)=>o<a[u])?[String(s)]:[]:[String(s)]:[]}else{if(!a)return[];let s=Number(i)-1;return Number.isInteger(s)&&s>=0&&s<a[0]?Array.from(Array(a[1]),(o,u)=>s+","+u):[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints,2]},returnArrayDependenciesByKey({arrayKeys:r}){let i={};for(let a of r){let[s,o]=a.split(","),u=Number(s)+1+"_"+(Number(o)+1);i[a]={throughChild:{dependencyType:"child",childLogicName:"exactlyOneThrough",variableNames:["pointX"+u]}}}return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:i}){let a={};for(let s of i){let[o,u]=s.split(","),c=Number(o)+1+"_"+(Number(u)+1),f=r[s].throughChild;f.length===1&&f[0].stateValues["pointX"+c]?a[s]=f[0].stateValues["pointX"+c]:a[s]=Ye.default.fromAst("\uFF3F")}return{newValues:{throughPoints:a}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyValuesByKey:i,dependencyNamesByKey:a,initialChange:s,stateValues:o}){if(s&&!o.draggable)return{success:!1};let u=[];for(let c in r.throughPoints){let[f,p]=c.split(","),d=Number(f)+1+"_"+(Number(p)+1);if(i[c].throughChild.length===1&&i[c].throughChild[0].stateValues["pointX"+d])u.push({setDependency:a[c].throughChild,desiredValue:r.throughPoints[c],childIndex:0,variableIndex:0});else return{success:!1}}return{success:!0,instructions:u}}},e.radiusShadow={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{radiusShadow:{variablesToCheck:["radius","radiusShadow"]}}}),inverseDefinition:function({desiredStateVariableValues:r}){return{success:!0,instructions:[{setStateVariable:"radiusShadow",value:r.radiusShadow}]}}},e.centerShadow={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{centerShadow:{variablesToCheck:["center","centerShadow"]}}}),inverseDefinition:function({desiredStateVariableValues:r}){return{success:!0,instructions:[{setStateVariable:"centerShadow",value:r.centerShadow}]}}},e.havePrescribedCenter={returnDependencies:()=>({centerChild:{dependencyType:"child",childLogicName:"atMostOneCenter"},centerShadow:{dependencyType:"stateVariable",variableName:"centerShadow"}}),definition:({dependencyValues:r})=>({newValues:{havePrescribedCenter:r.centerChild.length===1||r.centerShadow!==null},checkForActualChange:{havePrescribedCenter:!0}})},e.prescribedCenter={isArray:!0,entryPrefixes:["prescribedCenterX"],returnArraySizeDependencies:()=>({havePrescribedCenter:{dependencyType:"stateVariable",variableName:"havePrescribedCenter"}}),returnArraySize({dependencyValues:r}){return[r.havePrescribedCenter?2:0]},returnArrayDependenciesByKey({arrayKeys:r}){let i={centerShadow:{dependencyType:"stateVariable",variableName:"centerShadow"}},a={};for(let s of r){let o=Number(s)+1;a[s]={centerChild:{dependencyType:"child",childLogicName:"atMostOneCenter",variableNames:["x"+o]}}}return{globalDependencies:i,dependenciesByKey:a}},arrayDefinitionByKey:function({globalDependencyValues:r,dependencyValuesByKey:i,arrayKeys:a}){let s={};for(let o of a){let u=Number(o)+1;i[o].centerChild.length===1?s[o]=i[o].centerChild[0].stateValues["x"+u]:r.centerShadow!==null&&(s[o]=r.centerShadow.get_component(Number(o)))}return{newValues:{prescribedCenter:s}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,globalDependencyValues:i,dependencyValuesByKey:a,dependencyNamesByKey:s,arraySize:o}){let u=[],c=!1;for(let f of Object.keys(r.prescribedCenter).reverse())a[f].centerChild&&a[f].centerChild.length===1?u.push({setDependency:s[f].centerChild,desiredValue:r.prescribedCenter[f],childIndex:0,variableIndex:0}):i.centerShadow!==null&&(c=!0);if(c)if(o[0]>1){let f=["vector"];for(let p in r.prescribedCenter)f[Number(p)+1]=r.prescribedCenter[p].tree;f.length=o[0]+1,u.push({setDependency:"centerShadow",desiredValue:Ye.default.fromAst(f)})}else o[0]===1&&"0"in r.prescribedCenter&&u.push({setDependency:"centerShadow",desiredValue:r.prescribedCenter[0]});return{success:!0,instructions:u}}},e.prescribedRadius={defaultValue:null,returnDependencies:()=>({radiusChild:{dependencyType:"child",childLogicName:"exactlyOneRadius",variableNames:["value"]},radiusShadow:{dependencyType:"stateVariable",variableName:"radiusShadow"}}),definition:function({dependencyValues:r}){return r.radiusChild.length===1?{newValues:{prescribedRadius:r.radiusChild[0].stateValues.value}}:{newValues:{prescribedRadius:r.radiusShadow}}},inverseDefinition:function({desiredStateVariableValues:r,dependencyValues:i}){return i.radiusChild.length===1?{success:!0,instructions:[{setDependency:"radiusChild",desiredValue:r.prescribedRadius,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setDependency:"radiusShadow",desiredValue:r.prescribedRadius}]}}},e.havePrescribedRadius={returnDependencies:()=>({radiusChild:{dependencyType:"child",childLogicName:"exactlyOneRadius"},radiusShadow:{dependencyType:"stateVariable",variableName:"radiusShadow"}}),definition:({dependencyValues:r})=>({newValues:{havePrescribedRadius:r.radiusChild.length===1||r.radiusShadow!==null},checkForActualChange:{havePrescribedRadius:!0}})},e.numericalPrescribedRadius={returnDependencies:()=>({prescribedRadius:{dependencyType:"stateVariable",variableName:"prescribedRadius"}}),additionalStateVariablesDefined:["haveNonNumericalPrescribedRadius"],definition:function({dependencyValues:r}){let i=!1,a;return r.prescribedRadius===null?a=null:(a=r.prescribedRadius.evaluate_to_constant(),Number.isFinite(a)||(a=NaN,i=!0)),{newValues:{haveNonNumericalPrescribedRadius:i,numericalPrescribedRadius:a},checkForActualChange:{haveNonNumericalEntriesNumericalRadius:!0}}},inverseDefinition:function({desiredStateVariableValues:r,dependencyValues:i,stateValues:a}){return a.haveNonNumericalPrescribedRadius?{success:!1}:r.numericalPrescribedRadius!==void 0?i.prescribedRadius===null?{success:!1}:{success:!0,instructions:[{setDependency:"prescribedRadius",desiredValue:Ye.default.fromAst(r.numericalPrescribedRadius)}]}:{success:!1}}},e.numericalPrescribedCenter={isArray:!0,entryPrefixes:["numericalPrescribedCenterX"],returnArraySizeDependencies:()=>({havePrescribedCenter:{dependencyType:"stateVariable",variableName:"havePrescribedCenter"}}),returnArraySize({dependencyValues:r}){return[r.havePrescribedCenter?2:0]},returnArrayDependenciesByKey({arrayKeys:r}){let i={};for(let a of r){let s=Number(a)+1;i[a]={prescribedCenterX:{dependencyType:"stateVariable",variableName:"prescribedCenterX"+s}}}return{dependenciesByKey:i}},arrayDefinitionByKey:function({dependencyValuesByKey:r,arrayKeys:i}){let a={};for(let s of i)a[s]=r[s].prescribedCenterX.evaluate_to_constant(),Number.isFinite(a[s])||(a[s]=NaN);return{newValues:{numericalPrescribedCenter:a}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyNamesByKey:i}){let a=[];for(let s in r.numericalPrescribedCenter)a.push({setDependency:i[s].prescribedCenterX,desiredValue:Ye.default.fromAst(r.numericalPrescribedCenter[s])});return{success:!0,instructions:a}}},e.haveNonNumericalPrescribedCenter={returnDependencies:()=>({numericalPrescribedCenter:{dependencyType:"stateVariable",variableName:"numericalPrescribedCenter"}}),definition({dependencyValues:r}){return{newValues:{haveNonNumericalPrescribedCenter:r.numericalPrescribedCenter.some(a=>!Number.isFinite(a))},checkForActualChange:{haveNonNumericalPrescribedCenter:!0}}}},e.numericalThroughPoints={returnDependencies:()=>({throughPoints:{dependencyType:"stateVariable",variableName:"throughPoints"}}),additionalStateVariablesDefined:["haveNonNumericalThroughPoints"],definition:function({dependencyValues:r}){let i=!1,a=[];for(let s of r.throughPoints){let o=[];for(let u=0;u<2;u++){let c;try{c=s[u].evaluate_to_constant()}catch(f){console.warn("Invalid point of circle"),i=!0,o=[];break}if(Number.isFinite(c))o.push(c);else{i=!0,o=[];break}}if(o.length>0)a.push(o);else{a=[];break}}return{newValues:{haveNonNumericalThroughPoints:i,numericalThroughPoints:a},checkForActualChange:{haveNonNumericalThroughPoints:!0}}},inverseDefinition:function({desiredStateVariableValues:r,dependencyValues:i,stateValues:a}){if(a.haveNonNumericalThroughPoints)return{success:!1};if(r.numericalThroughPoints!==void 0){let s={};for(let[o,u]of r.numericalThroughPoints.entries())s[o+",0"]=Ye.default.fromAst(u[0]),s[o+",1"]=Ye.default.fromAst(u[1]);return{success:!0,instructions:[{setDependency:"throughPoints",desiredValue:s}]}}return{success:!1}}},e.haveNumericalEntries={returnDependencies:()=>({haveNonNumericalPrescribedCenter:{dependencyType:"stateVariable",variableName:"haveNonNumericalPrescribedCenter"},haveNonNumericalPrescribedRadius:{dependencyType:"stateVariable",variableName:"haveNonNumericalPrescribedRadius"},haveNonNumericalThroughPoints:{dependencyType:"stateVariable",variableName:"haveNonNumericalThroughPoints"}}),definition:({dependencyValues:r})=>({newValues:{haveNumericalEntries:!(r.haveNonNumericalPrescribedCenter||r.haveNonNumericalPrescribedRadius||r.haveNonNumericalThroughPoints)}})},e.numericalRadiusCalculatedWithCenter={additionalStateVariablesDefined:["numericalCenterCalculatedWithRadius"],returnDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},haveNumericalEntries:{dependencyType:"stateVariable",variableName:"haveNonNumericalThroughPoints"}}),definition:function({dependencyValues:r}){if(r.haveNonNumericalThroughPoints){let i="Haven't implemented circle through "+r.nThroughPoints+" points";return i+=" in case where don't have numerical values.",console.warn(i),{newValues:{numericalRadiusCalculatedWithCenter:null,numericalCenterCalculatedWithRadius:null}}}if(r.nThroughPoints===2){let{numericalCenter:i,numericalRadius:a}=Ao({point1:r.numericalThroughPoints[0],point2:r.numericalThroughPoints[1]});return{newValues:{numericalCenterCalculatedWithRadius:i,numericalRadiusCalculatedWithCenter:a}}}else if(r.nThroughPoints===3){let i=r.numericalThroughPoints[0][0],a=r.numericalThroughPoints[1][0],s=r.numericalThroughPoints[2][0],o=r.numericalThroughPoints[0][1],u=r.numericalThroughPoints[1][1],c=r.numericalThroughPoints[2][1],f,p;if(i===a&&o===u)if(i===s&&o===c)f=[i,o],p=0;else{let d=Ao({point1:[i,o],point2:[s,c]});f=d.numericalCenter,p=d.numericalRadius}else if(i===s&&o===c||a===s&&u===c){let d=Ao({point1:[i,o],point2:[a,u]});f=d.numericalCenter,p=d.numericalRadius}else{let d=i*i+o*o,m=a*a+u*u,v=s*s+c*c,h=i*(u-c)-o*(a-s)+a*c-s*u,y=d*(c-u)+m*(o-c)+v*(u-o),g=d*(a-s)+m*(s-i)+v*(i-a),b=d*(s*u-a*c)+m*(i*c-s*o)+v*(a*o-i*u);h!==0?(f=[-y/(2*h),-g/(2*h)],p=Math.sqrt((y*y+g*g-4*h*b)/(4*h*h))):(f=[NaN,NaN],p=NaN)}return{newValues:{numericalCenterCalculatedWithRadius:f,numericalRadiusCalculatedWithCenter:p}}}else return r.nThroughPoints>3?(console.warn("Can't calculate circle through more than 3 points"),{newValues:{numericalRadiusCalculatedWithCenter:null,numericalCenterCalculatedWithRadius:null}}):{newValues:{numericalRadiusCalculatedWithCenter:null,numericalCenterCalculatedWithRadius:null}}}},e.numericalRadius={forRenderer:!0,stateVariablesDeterminingDependencies:["nThroughPoints","havePrescribedCenter","havePrescribedRadius"],defaultValue:1,returnDependencies:function({stateValues:r}){let i={haveNonNumericalPrescribedRadius:{dependencyType:"stateVariable",variableName:"haveNonNumericalPrescribedRadius"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}};return r.havePrescribedRadius?(i.numericalPrescribedRadius={dependencyType:"stateVariable",variableName:"numericalPrescribedRadius"},r.havePrescribedCenter&&r.nThroughPoints>0&&(i.haveCenterRadiusPoints={dependencyType:"value",value:!0})):r.havePrescribedCenter?r.nThroughPoints===1&&(i.haveNonNumericalPrescribedCenter={dependencyType:"stateVariable",variableName:"haveNonNumericalPrescribedCenter"},i.numericalPrescribedCenter={dependencyType:"stateVariable",variableName:"numericalPrescribedCenter"},i.haveNonNumericalThroughPoints={dependencyType:"stateVariable",variableName:"haveNonNumericalThroughPoints"},i.numericalThroughPoints={dependencyType:"stateVariable",variableName:"numericalThroughPoints"}):r.nThroughPoints>1&&(i.numericalRadiusCalculatedWithCenter={dependencyType:"stateVariable",variableName:"numericalRadiusCalculatedWithCenter"},i.numericalThroughPoints={dependencyType:"stateVariable",variableName:"numericalThroughPoints"}),i},definition:function({dependencyValues:r}){if(r.haveNonNumericalPrescribedRadius||r.haveNonNumericalPrescribedCenter||r.haveNonNumericalThroughPoints)return{newValues:{numericalRadius:NaN}};if(r.numericalPrescribedRadius!==void 0)return r.haveCenterRadiusPoints?(console.warn("Can't calculate circle with specified radius and center and through points"),{newValues:{numericalRadius:NaN}}):{newValues:{numericalRadius:Math.max(0,r.numericalPrescribedRadius)}};if(r.numericalPrescribedCenter!==void 0){if(r.nThroughPoints===0)return{useEssentialOrDefaultValue:{numericalRadius:{variablesToCheck:"numericalRadius"}}};if(r.nThroughPoints===1){let i=r.numericalThroughPoints[0];return i===void 0?{newValues:{numericalRadius:NaN}}:{newValues:{numericalRadius:Math.sqrt(Math.pow(i[0]-r.numericalPrescribedCenter[0],2)+Math.pow(i[1]-r.numericalPrescribedCenter[1],2))}}}else return console.warn("Can't calculate circle with specified center through more than 1 point"),{newValues:{numericalRadius:NaN}}}return r.nThroughPoints<2?{useEssentialOrDefaultValue:{numericalRadius:{variablesToCheck:"numericalRadius"}}}:{newValues:{numericalRadius:r.numericalRadiusCalculatedWithCenter}}},inverseDefinition:function({desiredStateVariableValues:r,dependencyValues:i,stateValues:a}){if(i.numericalPrescribedRadius!==void 0)return{success:!0,instructions:[{setDependency:"numericalPrescribedRadius",desiredValue:Math.max(0,r.numericalRadius)}]};if(i.numericalPrescribedCenter!==void 0){if(i.nThroughPoints===0)return{success:!0,instructions:[{setStateVariable:"numericalRadius",value:Math.max(0,r.numericalRadius)}]};if(i.nThroughPoints===1){let s=Math.max(0,r.numericalRadius),o=a.throughAngles[0];if(!Number.isFinite(o))return{success:!1};let u=[a.numericalCenter[0]+s*Math.cos(o),a.numericalCenter[1]+s*Math.sin(o)];return{success:!0,instructions:[{setDependency:"numericalThroughPoints",desiredValue:[u]}]}}else return{success:!1}}if(i.nThroughPoints<2)return{success:!0,instructions:[{setStateVariable:"numericalRadius",value:Math.max(0,r.numericalRadius)}]};{let s=[],o=Math.max(0,r.numericalRadius);for(let u=0;u<i.nThroughPoints;u++){let c=a.throughAngles[u];if(!Number.isFinite(c))return{success:!1};let f=[a.numericalCenter[0]+o*Math.cos(c),a.numericalCenter[1]+o*Math.sin(c)];s.push(f)}return{success:!0,instructions:[{setDependency:"numericalThroughPoints",desiredValue:s}]}}}},e.numericalCenter={forRenderer:!0,isArray:!0,entryPrefixes:["numericalCenterX"],defaultEntryValue:0,stateVariablesDeterminingDependencies:["nThroughPoints","havePrescribedCenter","havePrescribedRadius"],returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey({arrayKeys:r,stateValues:i}){let a={},s={};if(i.havePrescribedCenter){for(let o of r){let u=Number(o)+1;s[o]={numericalPrescribedCenterX:{dependencyType:"stateVariable",variableName:"numericalPrescribedCenterX"+u}}}i.havePrescribedRadius&&i.nThroughPoints>0&&(a.haveCenterRadiusPoints={dependencyType:"value",value:!0})}else a.nThroughPoints={dependencyType:"stateVariable",variableName:"nThroughPoints"},a.numericalThroughPoints={dependencyType:"stateVariable",variableName:"numericalThroughPoints"},a.haveNonNumericalThroughPoints={dependencyType:"stateVariable",variableName:"haveNonNumericalThroughPoints"},i.havePrescribedRadius?a.numericalRadius={dependencyType:"stateVariable",variableName:"numericalRadius"}:i.nThroughPoints==1?a.numericalRadius={dependencyType:"stateVariable",variableName:"numericalRadius"}:i.nThroughPoints>1&&(a.numericalCenterCalculatedWithRadius={dependencyType:"stateVariable",variableName:"numericalCenterCalculatedWithRadius"});return{globalDependencies:a,dependenciesByKey:s}},arrayDefinitionByKey:function({globalDependencyValues:r,dependencyValuesByKey:i,arrayKeys:a}){let s={};for(let o of a)if(i[o].numericalPrescribedCenterX!==void 0){if(r.haveCenterRadiusPoints)return console.warn("Can't calculate circle with specified radius and center and through points"),{newValues:{numericalCenter:[NaN,NaN]}};s[o]=i[o].numericalPrescribedCenterX}if(Object.keys(s).length>0)return{newValues:{numericalCenter:s}};if(r.haveNonNumericalPrescribedRadius||r.haveNonNumericalThroughPoints)return{newValues:{numericalCenter:[NaN,NaN]}};if(r.numericalRadius!==void 0)if(r.nThroughPoints===0){let o={};for(let u of a)o[u]={variablesToCheck:"numericalCenterX"+u};return{useEssentialOrDefaultValue:{numericalCenter:o}}}else{if(r.nThroughPoints===1)return r.numericalThroughPoints.length<1?{newValues:{numericalCenter:[NaN,NaN]}}:{newValues:{numericalCenter:[r.numericalThroughPoints[0][0],r.numericalThroughPoints[0][1]-r.numericalRadius]}};if(r.nThroughPoints===2){if(r.numericalThroughPoints.length<2)return{newValues:{numericalCenter:[NaN,NaN]}};let o=r.numericalRadius,u=r.numericalThroughPoints[0][0],c=r.numericalThroughPoints[1][0],f=r.numericalThroughPoints[0][1],p=r.numericalThroughPoints[1][1],d=Math.pow(u-c,2)+Math.pow(f-p,2),m=o*o;if(o<0||4*m<d)return console.warn("Can't find circle through given radius and two points"),{newValues:{numericalCenter:[NaN,NaN]}};if(d===0)return{newValues:{numericalCenter:[u,f-o]}};let v=.5*(d*(u+c)+(p-f)*Math.sqrt((4*m-d)*d))/d,h=.5*(d*(f+p)+(u-c)*Math.sqrt((4*m-d)*d))/d;return{newValues:{numericalCenter:[v,h]}}}else return console.warn("Can't create circle through more than two points with given radius"),{newValues:{numericalCenter:[NaN,NaN]}}}if(r.nThroughPoints===0){let o={};for(let u of a)o[u]={variablesToCheck:"numericalCenterX"+u};return{useEssentialOrDefaultValue:{numericalCenter:o}}}else return r.numericalCenterCalculatedWithRadius===void 0?{newValues:{numericalCenter:[NaN,NaN]}}:{newValues:{numericalCenter:r.numericalCenterCalculatedWithRadius}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,globalDependencyValues:i,dependencyValuesByKey:a,dependencyNamesByKey:s,stateValues:o,workspace:u}){let c=[];for(let f in r.numericalCenter)a[f].numericalPrescribedCenterX!==void 0&&c.push({setDependency:s[f].numericalPrescribedCenterX,desiredValue:r.numericalCenter[f]});if(c.length>0)return{success:!0,instructions:c};if(i.nThroughPoints===0){for(let f in r.numericalCenter)c.push({setStateVariable:"numericalCenter",value:{[f]:r.numericalCenter[f]}});return{success:!0,instructions:c}}else{u.desiredCenter||(u.desiredCenter={});for(let p=0;p<2;p++)r.numericalCenter[p]!==void 0?u.desiredCenter[p]=r.numericalCenter[p]:u.desiredCenter[p]===void 0&&(u.desiredCenter[p]=o.numericalCenter[p]);let f=[];for(let p=0;p<i.nThroughPoints;p++){let d=o.throughAngles[p];if(!Number.isFinite(d))return{success:!1};let m=[u.desiredCenter[0]+o.numericalRadius*Math.cos(d),u.desiredCenter[1]+o.numericalRadius*Math.sin(d)];f.push(m)}return{success:!0,instructions:[{setDependency:"numericalThroughPoints",desiredValue:f}]}}}},e.throughAngles={defaultValue:[],returnDependencies:()=>({haveNumericalEntries:{dependencyType:"stateVariable",variableName:"haveNumericalEntries"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"},numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},numericalRadius:{dependencyType:"stateVariable",variableName:"numericalRadius"},numericalCenter:{dependencyType:"stateVariable",variableName:"numericalCenter"}}),definition:function({dependencyValues:r}){if(!(r.haveNumericalEntries&&r.nThroughPoints>0&&r.numericalRadius>0&&r.numericalCenter.every(a=>Number.isFinite(a))))return{useEssentialOrDefaultValue:{throughAngles:{variablesToCheck:["throughAngles"]}}};let i=[];for(let a of r.numericalThroughPoints)i.push(Math.atan2(a[1]-r.numericalCenter[1],a[0]-r.numericalCenter[0]));return{newValues:{throughAngles:i},makeEssential:["throughAngles"]}}},e.radius={public:!0,componentType:"math",stateVariablesDeterminingDependencies:["nThroughPoints","havePrescribedCenter","havePrescribedRadius"],defaultValue:Ye.default.fromAst(1),returnDependencies:function({stateValues:r}){let i={numericalRadius:{dependencyType:"stateVariable",variableName:"numericalRadius"},nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}};return r.havePrescribedRadius?(i.prescribedRadius={dependencyType:"stateVariable",variableName:"prescribedRadius"},r.havePrescribedCenter&&r.nThroughPoints>0&&(i.haveCenterRadiusPoints={dependencyType:"value",value:!0})):r.havePrescribedCenter&&r.nThroughPoints===1&&(i.prescribedCenter={dependencyType:"stateVariable",variableName:"prescribedCenter"},i.throughPoints={dependencyType:"stateVariable",variableName:"throughPoints"}),i},definition:function({dependencyValues:r}){if(Number.isFinite(r.numericalRadius))return{newValues:{radius:Ye.default.fromAst(r.numericalRadius)},makeEssential:["radius"]};if(r.prescribedRadius!==void 0)return r.haveCenterRadiusPoints?(console.warn("Can't calculate circle with specified radius and center and through points"),{newValues:{radius:Ye.default.fromAst("\uFF3F")}}):{newValues:{radius:r.prescribedRadius}};if(r.prescribedCenter!==void 0){if(r.nThroughPoints===0)return{useEssentialOrDefaultValue:{radius:{variablesToCheck:"radius"}}};if(r.nThroughPoints===1)try{let i=r.throughPoints[0],a=i[0],s=i[1],o=r.prescribedCenter[0],u=r.prescribedCenter[1];return{newValues:{radius:a.subtract(o).pow(2).add(s.subtract(u).pow(2)).pow(.5).simplify()}}}catch(i){return console.warn("Invalid center or through points of circle"),{newValues:{radius:Ye.default.fromAst("\uFF3F")}}}else return console.warn("Can't calculate circle with specified center through more than 1 point"),{newValues:{radius:Ye.default.fromAst("\uFF3F")}}}return r.nThroughPoints<2?{useEssentialOrDefaultValue:{radius:{variablesToCheck:"radius"}}}:(console.warn(`Have not implemented circle through ${r.nThroughPoints} points when non-numerical values`),{newValues:{radius:Ye.default.fromAst("\uFF3F")}})},inverseDefinition:function({desiredStateVariableValues:r,dependencyValues:i,stateValues:a}){let s=r.radius.evaluate_to_constant();if(Number.isFinite(s)&&Number.isFinite(i.numericalRadius))return{success:!0,instructions:[{setDependency:"numericalRadius",desiredValue:s}]};if(i.prescribedRadius!==void 0)return{success:!0,instructions:[{setDependency:"prescribedRadius",desiredValue:r.radius}]};if(i.nThroughPoints===0){let o=[{setStateVariable:"radius",value:r.radius}];return Number.isFinite(s)&&o.push({setDependency:"numericalRadius",desiredValue:s}),{success:!0,instructions:o}}else return console.warn("Can't change radius of circle with non-numerical values through points"),{success:!1}}},e.diameter={public:!0,componentType:"math",returnDependencies:()=>({radius:{dependencyType:"stateVariable",variableName:"radius"}}),definition({dependencyValues:r}){return{newValues:{diameter:r.radius.multiply(2).simplify()}}},inverseDefinition:function({desiredStateVariableValues:r,dependencyValues:i,stateValues:a}){return{success:!0,instructions:[{setDependency:"radius",desiredValue:r.diameter.divide(2).simplify()}]}}},e.center={forRenderer:!0,public:!0,componentType:"math",isArray:!0,entryPrefixes:["centerX"],defaultEntryValue:Ye.default.fromAst(0),returnWrappingComponents(r){return r==="centerX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},stateVariablesDeterminingDependencies:["nThroughPoints","havePrescribedCenter","havePrescribedRadius"],returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey({arrayKeys:r,stateValues:i}){console.log("array dependencies by key for circle center"),console.log(r),console.log(i);let a={},s={};if(i.havePrescribedCenter){a.havePrescribedCenter={dependencyType:"value",value:!0};for(let o of r){let u=Number(o)+1;s[o]={numericalCenterX:{dependencyType:"stateVariable",variableName:"numericalCenterX"+u},prescribedCenterX:{dependencyType:"stateVariable",variableName:"prescribedCenterX"+u}}}i.havePrescribedRadius&&i.nThroughPoints>0&&(a.haveCenterRadiusPoints={dependencyType:"value",value:!0})}else a.numericalCenter={dependencyType:"stateVariable",variableName:"numericalCenter"},a.nThroughPoints={dependencyType:"stateVariable",variableName:"nThroughPoints"},a.throughPoints={dependencyType:"stateVariable",variableName:"throughPoints"},i.havePrescribedRadius?a.radius={dependencyType:"stateVariable",variableName:"prescribedRadius"}:i.nThroughPoints==1&&(a.radius={dependencyType:"stateVariable",variableName:"radius"});return console.log({dependenciesByKey:s,globalDependencies:a}),{dependenciesByKey:s,globalDependencies:a}},arrayDefinitionByKey:function({globalDependencyValues:r,dependencyValuesByKey:i,arrayKeys:a}){if(r.havePrescribedCenter){if(r.haveCenterRadiusPoints)return console.warn("Can't calculate circle with specified radius and center and through points"),{newValues:{center:[Ye.default.fromAst("\uFF3F"),Ye.default.fromAst("\uFF3F")]}};let s={};for(let o of a)Number.isFinite(i[o].numericalCenterX)?s[o]=Ye.default.fromAst(i[o].numericalCenterX):s[o]=i[o].prescribedCenterX;return{newValues:{center:s}}}if(r.numericalCenter.every(s=>Number.isFinite(s)))return{newValues:{center:r.numericalCenter.map(s=>Ye.default.fromAst(s))},makeEssential:["center"]};if(r.radius!==void 0)if(r.nThroughPoints===0){let s={};for(let o of a)s[o]={variablesToCheck:"centerX"+o};return{useEssentialOrDefaultValue:{center:s}}}else if(r.nThroughPoints===1){let s;try{s=[r.throughPoints[0][0],r.throughPoints[0][1].subtract(r.radius).simplify()]}catch(o){s=[Ye.default.fromAst("\uFF3F"),Ye.default.fromAst("\uFF3F")]}return{newValues:{center:s}}}else return console.warn("Can't create circle through more than one point with given radius when don't have numerical values"),{newValues:{center:[Ye.default.fromAst("\uFF3F"),Ye.default.fromAst("\uFF3F")]}};if(r.nThroughPoints===0){let s={};for(let o of a)s[o]={variablesToCheck:"centerX"+o};return{useEssentialOrDefaultValue:{center:s}}}else return console.warn("Can't create circle through more than one point when don't have numerical values"),{newValues:{center:[Ye.default.fromAst("\uFF3F"),Ye.default.fromAst("\uFF3F")]}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,globalDependencyValues:i,stateValues:a,dependencyNamesByKey:s,workspace:o}){if(i.havePrescribedCenter){let f=[];for(let p in r.center)f.push({setDependency:s[p].prescribedCenterX,desiredValue:r.center[p],arrayKey:p});return{success:!0,instructions:f}}o.desiredCenter||(o.desiredCenter={});for(let f=0;f<2;f++)r.center[f]!==void 0?o.desiredCenter[f]=r.center[f]:o.desiredCenter[f]===void 0&&(o.desiredCenter[f]=a.center[f]);let u=[],c=!0;for(let f=0;f<2;f++){let p=o.desiredCenter[f].evaluate_to_constant();if(!Number.isFinite(p)){c=!1;break}u.push(p)}if(c&&i.numericalCenter.every(f=>Number.isFinite(f)))return{success:!0,instructions:[{setDependency:"numericalCenter",desiredValue:u}]};if(i.nThroughPoints===0){let f=[{setStateVariable:"center",value:o.desiredCenter}];return c&&f.push({setDependency:"numericalCenter",desiredValue:u}),{success:!0,instructions:f}}else return console.warn("Haven't implemented changing center of circle through points with non numerical values"),{success:!1}}},e.childrenToRender={returnDependencies:()=>({}),definition:()=>({newValues:{childrenToRender:[]}})},e.nearestPoint={returnDependencies:()=>({numericalCenter:{dependencyType:"stateVariable",variableName:"numericalCenter"},numericalRadius:{dependencyType:"stateVariable",variableName:"numericalRadius"}}),definition:({dependencyValues:r})=>({newValues:{nearestPoint:function(i){let a=i.x1.evaluate_to_constant(),s=i.x2.evaluate_to_constant();if(!(Number.isFinite(a)&&Number.isFinite(s)))return{};if(!(Number.isFinite(r.numericalCenter[0])&&Number.isFinite(r.numericalCenter[1])&&Number.isFinite(r.numericalRadius)))return{};let o=Math.atan2(s-r.numericalCenter[1],a-r.numericalCenter[0]),u={x1:r.numericalCenter[0]+r.numericalRadius*Math.cos(o),x2:r.numericalCenter[1]+r.numericalRadius*Math.sin(o)};return i.x3!==void 0&&(u.x3=0),u}}})},e}moveCircle({center:t,transient:e}){let n=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"numericalCenter",value:t}];if(this.stateValues.nThroughPoints===1&&this.stateValues.numericalPrescribedCenter!==null&&this.stateValues.numericalPrescribedRadius===null){let r=this.stateValues.throughAngles[0],i=[t[0]+this.stateValues.numericalRadius*Math.cos(r),t[1]+this.stateValues.numericalRadius*Math.sin(r)];n.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"numericalThroughPoints",value:[i]})}e?this.coreFunctions.requestUpdate({updateInstructions:n,transient:e}):this.coreFunctions.requestUpdate({updateInstructions:n,event:{verb:"interacted",object:{componentName:this.componentName,componentType:this.componentType},result:{center:t}}})}},Rh=_o;function Ao({point1:l,point2:t}){let e=(l[0]+t[0])/2,n=(l[1]+t[1])/2,r=[e,n],i=Math.sqrt(Math.pow(e-l[0],2)+Math.pow(n-l[1],2));return{numericalCenter:r,numericalRadius:i}}var Wt=De(Ee()),$o=class extends _n{static componentType="parabola";static rendererType="curve";static get stateVariablesShadowedForReference(){return["nThroughPoints","throughPoints"]}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();let n=e.newLeaf({name:"atMostOneThrough",componentType:"through",comparison:"atMost",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"atMostOneVariables",componentType:"variables",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"parabolaLogic",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(t){let e=lt.returnStateVariableDefinitions(t),n=super.returnStateVariableDefinitions(t);return e.styleDescription=n.styleDescription,e.curveType={forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{curveType:"function"}})},e.parmax={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{parmax:NaN}})},e.parmin={public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({newValues:{parmin:NaN}})},e.aShadow={defaultValue:1,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{aShadow:{variablesToCheck:["aShadow","a"]}}}),inverseDefinition:function({desiredStateVariableValues:r}){return{success:!0,instructions:[{setStateVariable:"aShadow",value:r.aShadow}]}}},e.nThroughPoints={returnDependencies:()=>({throughChild:{dependencyType:"child",childLogicName:"atMostOneThrough",variableNames:["nPoints"]}}),definition:function({dependencyValues:r}){return r.throughChild.length===0?{newValues:{nThroughPoints:0}}:{newValues:{nThroughPoints:r.throughChild[0].stateValues.nPoints}}}},e.throughPoints={public:!0,componentType:"point",isArray:!0,nDimensions:2,entryPrefixes:["throughPointX","throughPoint"],returnWrappingComponents(r){return r==="throughPointX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},getArrayKeysFromVarName({arrayEntryPrefix:r,varEnding:i,arraySize:a}){if(r==="throughPointX"){let s=i.split("_").map(o=>Number(o)-1);return s.length===2&&s.every((o,u)=>Number.isInteger(o)&&o>=0)?a?s.every((o,u)=>o<a[u])?[String(s)]:[]:[String(s)]:[]}else{if(!a)return[];let s=Number(i)-1;return Number.isInteger(s)&&s>=0&&s<a[0]?Array.from(Array(a[1]),(o,u)=>s+","+u):[]}},returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints,2]},returnArrayDependenciesByKey({arrayKeys:r}){let i={};for(let a of r){let[s,o]=a.split(","),u=Number(s)+1+"_"+(Number(o)+1);i[a]={throughChild:{dependencyType:"child",childLogicName:"atMostOneThrough",variableNames:["pointX"+u]}}}return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:i}){let a={};for(let s of i){let[o,u]=s.split(","),c=Number(o)+1+"_"+(Number(u)+1),f=r[s].throughChild;if(f.length===1&&f[0].stateValues["pointX"+c]){let p=f[0].stateValues["pointX"+c].evaluate_to_constant();Number.isFinite(p)?a[s]=Wt.default.fromAst(p):a[s]=Wt.default.fromAst("\uFF3F")}else a[s]=Wt.default.fromAst("\uFF3F")}return{newValues:{throughPoints:a}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyValuesByKey:i,dependencyNamesByKey:a,initialChange:s,stateValues:o}){if(s&&!o.draggable)return{success:!1};let u=[];for(let c in r.throughPoints){let[f,p]=c.split(","),d=Number(f)+1+"_"+(Number(p)+1);if(i[c].throughChild.length===1&&i[c].throughChild[0].stateValues["pointX"+d])u.push({setDependency:a[c].throughChild,desiredValue:r.throughPoints[c],childIndex:0,variableIndex:0});else return{success:!1}}return{success:!0,instructions:u}}},e.numericalThroughPoints={isArray:!0,forRenderer:!0,returnArraySizeDependencies:()=>({nThroughPoints:{dependencyType:"stateVariable",variableName:"nThroughPoints"}}),returnArraySize({dependencyValues:r}){return[r.nThroughPoints]},returnArrayDependenciesByKey({arrayKeys:r}){let i={};for(let a of r)i[a]={throughPoint:{dependencyType:"stateVariable",variableName:"throughPoint"+(Number(a)+1)}};return{dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:r,arrayKeys:i}){let a={};for(let s of i){let o=r[s].throughPoint.map(u=>u.tree);o.every(u=>Number.isFinite(u))||(o=Array(o.length).fill(NaN)),a[s]=o}return{newValues:{numericalThroughPoints:a}}},inverseArrayDefinitionByKey({desiredStateVariableValues:r,dependencyValuesByKey:i,dependencyNamesByKey:a}){let s=[];for(let o in r.numericalThroughPoints)if(i[o].throughPoint)s.push({setDependency:a[o].throughPoint,desiredValue:r.numericalThroughPoints[o].map(u=>Wt.default.fromAst(u))});else return{success:!1};return{success:!0,instructions:s}}},e.pointsAreNumerical={returnDependencies:()=>({numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"}}),definition:({dependencyValues:r})=>({newValues:{pointsAreNumerical:r.numericalThroughPoints.every(i=>Number.isFinite(i[0]))},checkForActualChange:{pointsAreNumerical:!0}})},e.a={public:!0,componentType:"number",additionalStateVariablesDefined:[{variableName:"b",public:!0,componentType:"number"},{variableName:"c",public:!0,componentType:"number"},"realValued"],returnDependencies:()=>({numericalThroughPoints:{dependencyType:"stateVariable",variableName:"numericalThroughPoints"},pointsAreNumerical:{dependencyType:"stateVariable",variableName:"pointsAreNumerical"},aShadow:{dependencyType:"stateVariable",variableName:"aShadow"}}),definition:function({dependencyValues:r}){if(!r.pointsAreNumerical)return{newValues:{a:NaN,b:NaN,c:NaN,realValued:!1}};let i,a,s,o=!0;if(r.numericalThroughPoints.length===0)return{useEssentialOrDefaultValue:{b:{variablesToCheck:["b"],defaultValue:0},c:{variablesToCheck:["c"],defaultValue:0}},newValues:{a:r.aShadow,realValued:!0}};if(r.numericalThroughPoints.length===1){let u=r.numericalThroughPoints[0],c=u[0],f=u[1];return i=r.aShadow,a=-2*i*c,s=i*c*c+f,{newValues:{a:i,b:a,c:s,realValued:!0}}}else if(r.numericalThroughPoints.length===2){i=r.aShadow;let u=r.numericalThroughPoints[0],c=u[0],f=u[1],p=c*c,d=r.numericalThroughPoints[1],m=d[0],v=d[1],h=m*m;return c===m?f==v?(a=-2*i*c,s=i*p+f):(o=!1,i=NaN,a=NaN,s=NaN):(a=(f-v-i*(p-h))/(c-m),s=f-i*p-a*c),{newValues:{a:i,b:a,c:s,realValued:o}}}else if(r.numericalThroughPoints.length===3){let u=r.numericalThroughPoints[0],c=u[0],f=u[1],p=c*c,d=r.numericalThroughPoints[1],m=d[0],v=d[1],h=m*m,y=r.numericalThroughPoints[2],g=y[0],b=y[1],x=g*g,N=p-x,C=h-x,_=c-g,w=m-g,A=f-b,$=v-b,S=N*w-C*_;if(S===0){let D=!1,V,I,q;c===m?f===v?c===g?f==b?V=1:D=!0:(V=2,I=g,q=b):D=!0:c===g?f===b?(V=2,I=m,q=v):D=!0:m===g&&v===b?(V=2,I=m,q=v):D=!0,D?(o=!1,i=NaN,a=NaN,s=NaN):V===1?(i=r.aShadow,a=-2*i*c,s=i*c*c+f):(i=r.aShadow,a=(f-q-i*(p-I*I))/(c-I),s=f-i*p-a*c)}else i=(A*w-$*_)/S,a=($*N-A*C)/S,s=f-a*c-i*p;return{newValues:{a:i,b:a,c:s,realValued:o}}}else return console.warn("Haven't implemented parabola through more than 3 points"),{newValues:{a:NaN,b:NaN,c:NaN,realValued:!1}}},inverseDefinition:function({desiredStateVariableValues:r,dependencyValues:i,stateValues:a,workspace:s}){if(!i.pointsAreNumerical)return{success:!1};let o={},u=function(f){if(Number.isFinite(f))return{success:!0,value:f};if(f instanceof Wt.default.class){let p=f.evaluate_to_constant();if(Number.isFinite(p))return{success:!0,value:p}}return{success:!1}};if(r.a!==void 0){let f=u(r.a);if(f.success)o.a=f.value;else return{success:!1}}if(r.b!==void 0){let f=u(r.b);if(f.success)o.b=f.value;else return{success:!1}}if(r.c!==void 0){let f=u(r.c);if(f.success)o.c=f.value;else return{success:!1}}Object.assign(s,o);let c=function(f){return s[f]!==void 0?s[f]:a[f]};if(i.numericalThroughPoints.length===0){let f=[];return o.a!==void 0&&f.push({setDependency:"aShadow",desiredValue:o.a}),o.b!==void 0&&f.push({setStateVariable:"b",value:o.b}),o.c!==void 0&&f.push({setStateVariable:"c",value:o.c}),{success:!0,instructions:f}}else if(i.numericalThroughPoints.length===1){let f=c("a"),p=c("b"),d=c("c"),m=-p/(2*f),v=d-p*p/(4*f),h=[{setDependency:"numericalThroughPoints",desiredValue:[[m,v]]}];return o.a!==void 0&&h.push({setDependency:"aShadow",desiredValue:o.a}),{success:!0,instructions:h}}else if(i.numericalThroughPoints.length===2){let f=c("a"),p=c("b"),d=c("c"),v=i.numericalThroughPoints[0][0],y=i.numericalThroughPoints[1][0];if(v===y){v=-p/(2*f);let g=d-p*p/(4*f),b=[{setDependency:"numericalThroughPoints",desiredValue:[[v,g],[v,g]]}];return o.a!==void 0&&b.push({setDependency:"aShadow",desiredValue:o.a}),{success:!0,instructions:b}}else{let g=f*v*v+p*v+d,b=f*y*y+p*y+d,x=[{setDependency:"numericalThroughPoints",desiredValue:[[v,g],[y,b]]}];return o.a!==void 0&&x.push({setDependency:"aShadow",desiredValue:o.a}),{success:!0,instructions:x}}}else if(i.numericalThroughPoints.length===3){let f=c("a"),p=c("b"),d=c("c"),v=i.numericalThroughPoints[0][0],y=i.numericalThroughPoints[1][0],b=i.numericalThroughPoints[2][0],x=3,N;if(v===y?v===b?x=1:(x=2,N=3):v===b?(x=2,N=2):y===b&&(x=2,N=1),x===3){let C=f*v*v+p*v+d,_=f*y*y+p*y+d,w=f*b*b+p*b+d,A=[{setDependency:"numericalThroughPoints",desiredValue:[[v,C],[y,_],[b,w]]}];return o.a!==void 0&&A.push({setDependency:"aShadow",desiredValue:o.a}),{success:!0,instructions:A}}else if(x===2)if(N===1){let C=v,_=y,w=f*C*C+p*C+d,A=f*_*_+p*_+d,$=[{setDependency:"numericalThroughPoints",desiredValue:[[C,w],[_,A],[_,A]]}];return o.a!==void 0&&$.push({setDependency:"aShadow",desiredValue:o.a}),{success:!0,instructions:$}}else if(N===2){let C=v,_=y,w=f*C*C+p*C+d,A=f*_*_+p*_+d,$=[{setDependency:"numericalThroughPoints",desiredValue:[[C,w],[_,A],[C,w]]}];return o.a!==void 0&&$.push({setDependency:"aShadow",desiredValue:o.a}),{success:!0,instructions:$}}else{let C=v,_=b,w=f*C*C+p*C+d,A=f*_*_+p*_+d,$=[{setDependency:"numericalThroughPoints",desiredValue:[[C,w],[C,w],[_,A]]}];return o.a!==void 0&&$.push({setDependency:"aShadow",desiredValue:o.a}),{success:!0,instructions:$}}else{v=-p/(2*f);let C=d-p*p/(4*f),_=[{setDependency:"numericalThroughPoints",desiredValue:[[v,C],[v,C],[v,C]]}];return o.a!==void 0&&_.push({setDependency:"aShadow",desiredValue:o.a}),{success:!0,instructions:_}}}else return{success:!1}}},e.vertex={public:!0,componentType:"math",isArray:!0,entryPrefixes:["vertexX"],returnWrappingComponents(r){return r==="vertexX"?[]:[["point",{componentType:"xs",doenetAttributes:{isPropertyChild:!0}}]]},returnArraySizeDependencies:()=>({}),returnArraySize(){return[2]},returnArrayDependenciesByKey(){return{globalDependencies:{a:{dependencyType:"stateVariable",variableName:"a"},b:{dependencyType:"stateVariable",variableName:"b"},c:{dependencyType:"stateVariable",variableName:"c"},realValued:{dependencyType:"stateVariable",variableName:"realValued"}}}},arrayDefinitionByKey:function({globalDependencyValues:r}){let i={};return r.realValued&&r.a!==0?(i[0]=Wt.default.fromAst(-r.b/(2*r.a)),i[1]=Wt.default.fromAst(r.c-r.b**2/(4*r.a))):(i[0]=Wt.default.fromAst("\uFF3F"),i[1]=Wt.default.fromAst("\uFF3F")),{newValues:{vertex:i}}},inverseArrayDefinitionByKey:function({desiredStateVariableValues:r,globalDependencyValues:i,workspace:a,stateValues:s}){let o;if("0"in r.vertex?o=r.vertex[0].evaluate_to_constant():a.x!==void 0?o=a.x:o=s.vertex[0].tree,Number.isFinite(o))a.x=o;else return{success:!1};let u;if("1"in r.vertex?u=r.vertex[1].evaluate_to_constant():a.y!==void 0?u=a.y:u=s.vertex[1].tree,Number.isFinite(u))a.y=u;else return{success:!1};let c=i.a,f=-2*c*o,p=u+c*o*o;return{success:!0,instructions:[{setDependency:"b",desiredValue:f,additionalDependencyValues:{c:p}}]}}},e.equation={public:!0,componentType:"equation",additionalProperties:{simplify:"numberspreserveorder",displaysmallaszero:!0},returnDependencies:()=>({a:{dependencyType:"stateVariable",variableName:"a"},b:{dependencyType:"stateVariable",variableName:"b"},c:{dependencyType:"stateVariable",variableName:"c"}}),definition:function({dependencyValues:r}){let i=["=","y",["+",["*",r.a,["^","x",2]],["*",r.b,"x"],r.c]];return{newValues:{equation:Wt.default.fromAst(i).evaluate_numbers({skip_ordering:!0})}}}},e.fs={forRenderer:!0,isArray:!0,entryPrefixes:["f"],defaultEntryValue:()=>0,returnArraySizeDependencies:()=>({}),returnArraySize:()=>[1],returnArrayDependenciesByKey(){return{globalDependencies:{a:{dependencyType:"stateVariable",variableName:"a"},b:{dependencyType:"stateVariable",variableName:"b"},c:{dependencyType:"stateVariable",variableName:"c"}}}},arrayDefinitionByKey({globalDependencyValues:r}){return{newValues:{fs:[function(a){return r.a*a*a+r.b*a+r.c}]}}}},e.nearestPoint={returnDependencies:()=>({f:{dependencyType:"stateVariable",variableName:"f"}}),definition:({dependencyValues:r})=>({newValues:{nearestPoint:function(i){let a=i.x1.evaluate_to_constant(),s=r.f(a),o={x1:a,x2:s};return i.x3!==void 0&&(o.x3=0),o}}})},e.childrenToRender={returnDependencies:()=>({}),definition:()=>({newValues:{childrenToRender:[]}})},e}},kh=$o;var Gt=De(Ee()),So=class extends _e{static componentType="beziercontrols";static rendererType="container";static get stateVariablesShadowedForReference(){return["controls"]}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=tr({componentList:n});return r.success!==!0?{success:!1}:{success:!0,newChildren:r.pieces.map(function(i){return i.length>1||i[0].componentType==="string"?{componentType:"controlvectors",children:[{componentType:"vector",children:i}]}:i[0]})}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.deleteAllLogic(),e.newLeaf({name:"atLeastZeroControlvectors",componentType:"controlvectors",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nControls={returnDependencies:()=>({nParentPoints:{dependencyType:"parentStateVariable",variableName:"nThroughPoints"}}),definition({dependencyValues:e}){let n=e.nParentPoints;return Number.isInteger(n)&&n>=0||(n=0),{newValues:{nControls:n}}}},t.pointIndMap={returnDependencies:()=>({controlChildren:{dependencyType:"child",childLogicName:"atLeastZeroControlvectors",variableNames:["pointNumber"]}}),definition:function({dependencyValues:e}){let n=[],r=-1;for(let[i,a]of e.controlChildren.entries()){let s=a.stateValues.pointNumber;Number.isFinite(s)?r=Math.round(s)-1:r+=1,n[r]=i}return{newValues:{pointIndMap:n}}}},t.directions={isArray:!0,entryPrefixes:["direction"],defaultEntryValue:"none",stateVariablesDeterminingDependencies:["pointIndMap"],returnArraySizeDependencies:()=>({nControls:{dependencyType:"stateVariable",variableName:"nControls"}}),returnArraySize({dependencyValues:e}){return[e.nControls]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={};for(let i of e){let a=n.pointIndMap[i];a!==void 0&&(r[i]={controlChild:{dependencyType:"child",childLogicName:"atLeastZeroControlvectors",variableNames:["direction"],childIndices:[a]}})}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={},i={};for(let a of n){let s=e[a].controlChild;s&&s.length===1?r[a]=s[0].stateValues.direction:i[a]={variablesToCheck:[{variableName:"directions",arrayIndex:a}]}}return{newValues:{directions:r},useEssentialOrDefaultValue:{directions:i}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:n,dependencyValuesByKey:r}){let i=[],a={};for(let s in e.directions){let o=r[s].controlChild;o&&o.length===1?i.push({setDependency:n[s].controlChild,desiredValue:e.directions[s],childIndex:0,variableIndex:0}):a[s]=e.directions[s]}return Object.keys(a).length>0&&i.push({setStateVariable:"directions",value:a}),{success:!0,instructions:i}}},t.nDimensions={returnDependencies(){return{nParentDimensions:{dependencyType:"parentStateVariable",variableName:"nDimensions"}}},definition:function({dependencyValues:e}){let n=e.nParentDimensions;return Number.isInteger(n)&&n>=0||(n=0),{newValues:{nDimensions:n},checkForActualChange:{nDimensions:!0}}}},t.essentialSymmetricControls={isArray:!0,entryPrefixes:["essentialSymmetricControl"],nDimensions:2,defaultEntryValue:Gt.default.fromAst(1),returnArraySizeDependencies:()=>({nControls:{dependencyType:"stateVariable",variableName:"nControls"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nControls,e.nDimensions]},returnArrayDependenciesByKey:()=>({}),arrayDefinitionByKey({arrayKeys:e}){let n={};for(let r of e){let i=r.split(",").map(a=>Number(a));n[r]={variablesToCheck:[{variableName:"essentialSymmetricControls",arrayIndex:i}]}}return{useEssentialOrDefaultValue:{essentialSymmetricControls:n}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e}){let n=[],r={};for(let i in e.essentialSymmetricControls)r[i]=e.essentialSymmetricControls[i];return Object.keys(r).length>0&&n.push({setStateVariable:"essentialSymmetricControls",value:r}),{success:!0,instructions:n}}},t.controls={isArray:!0,entryPrefixes:["control"],nDimensions:3,defaultEntryValue:Gt.default.fromAst(1),stateVariablesDeterminingDependencies:["pointIndMap","directions"],returnArraySizeDependencies:()=>({nControls:{dependencyType:"stateVariable",variableName:"nControls"},nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nControls,2,e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={};for(let i of e){let a=i.split(",").map(u=>Number(u)),s=a.map(u=>u+1);r[i]={direction:{dependencyType:"stateVariable",variableName:"direction"+s[0]}};let o=n.directions[a[0]];if(console.log(`direction: ${o}`),o&&o!=="none"&&(a[1]===0||a[1]===1)){let u=n.pointIndMap[a[0]];u!==void 0&&(o==="symmetric"||o==="previous"&&a[1]===0||o==="next"&&a[1]===1?r[i].controlChild={dependencyType:"child",childLogicName:"atLeastZeroControlvectors",variableNames:["vectorX1_"+s[2]],childIndices:[u]}:o==="both"&&(r[i].controlChild={dependencyType:"child",childLogicName:"atLeastZeroControlvectors",variableNames:["vectorX"+s[1]+"_"+s[2]],childIndices:[u]})),o==="symmetric"&&(r[i].essentialSymmetricControl={dependencyType:"stateVariable",variableName:"essentialSymmetricControl"+s[0]+"_"+s[2]})}}return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n,componentName:r}){console.log(`definition of controls for beziercontrols of ${r}`),console.log(JSON.parse(JSON.stringify(e))),console.log(JSON.parse(JSON.stringify(n)));let i={},a={};for(let s of n){let o=s.split(",").map(f=>Number(f)),u=o.map(f=>f+1),c=e[s].direction;if(!c)a[s]={variablesToCheck:[{variableName:"controls",arrayIndex:o}]};else if(o[1]===0)if(c==="none"||c==="next")a[s]={variablesToCheck:[{variableName:"controls",arrayIndex:o}]};else{let f=e[s].controlChild,p=!0;if(f&&f.length===1){let d=f[0].stateValues["vectorX1_"+u[2]];d&&(p=!1,d=d.evaluate_to_constant(),Number.isFinite(d)||(d=NaN),i[s]=Gt.default.fromAst(d))}p&&(c==="symmetric"?i[s]=e[s].essentialSymmetricControl:a[s]={variablesToCheck:[{variableName:"controls",arrayIndex:o}]})}else if(o[1]===1)if(c==="none"||c==="previous")a[s]={variablesToCheck:[{variableName:"controls",arrayIndex:o}]};else{let f=e[s].controlChild,p=!0;if(f&&f.length===1)if(c==="both"){let d=f[0].stateValues["vectorX2_"+u[2]];d&&(p=!1,d=d.evaluate_to_constant(),Number.isFinite(d)||(d=NaN),i[s]=Gt.default.fromAst(d))}else{let d=f[0].stateValues["vectorX1_"+u[2]];d&&(p=!1,d=d.evaluate_to_constant(),Number.isFinite(d)||(d=NaN),c==="symmetric"?i[s]=Gt.default.fromAst(-d):i[s]=Gt.default.fromAst(d))}p&&(c==="symmetric"?e[s].essentialSymmetricControl&&(i[s]=Gt.default.fromAst(-e[s].essentialSymmetricControl.tree)):a[s]={variablesToCheck:[{variableName:"controls",arrayIndex:o}]})}}return{newValues:{controls:i},useEssentialOrDefaultValue:{controls:a}}},inverseArrayDefinitionByKey({desiredStateVariableValues:e,dependencyNamesByKey:n,dependencyValuesByKey:r}){let i=[],a={};for(let s in e.controls){let o=s.split(",").map(f=>Number(f)),u=o.map(f=>f+1),c=r[s].direction;if(c){if(o[1]===0){if(!(c==="none"||c==="next")){let f=r[s].controlChild,p=!0;if(f&&f.length===1&&f[0].stateValues["vectorX1_"+u[2]]&&(p=!1,i.push({setDependency:n[s].controlChild,desiredValue:e.controls[s],childIndex:0,variableIndex:0})),p){let d=e.controls[s].evaluate_to_constant();Number.isFinite(d)||(d=NaN),d=Gt.default.fromAst(d),c==="symmetric"?i.push({setDependency:n[s].essentialSymmetricControl,desiredValue:d}):a[s]=d}}}else if(o[1]===1&&!(c==="none"||c==="previous")){let f=r[s].controlChild,p=!0;f&&f.length===1&&(c==="both"?f[0].stateValues["vectorX2_"+u[2]]&&(p=!1):f[0].stateValues["vectorX1_"+u[2]]&&(p=!1));let d;c==="symmetric"?d=Gt.default.fromAst(["-",e.controls[s].tree]):d=e.controls[s],p?(d=d.evaluate_to_constant(),Number.isFinite(d)||(d=NaN),d=Gt.default.fromAst(d),c==="symmetric"?i.push({setDependency:n[s].essentialSymmetricControl,desiredValue:d}):a[s]=d):i.push({setDependency:n[s].controlChild,desiredValue:d,childIndex:0,variableIndex:0})}}}return Object.keys(a).length>0&&i.push({setStateVariable:"controls",value:a}),{success:!0,instructions:i}}},t}},Fh=So;var Do=class extends Oi{static componentType="controlvectors";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.direction={default:"symmetric",toLowerCase:!0,validValues:["symmetric","previous","next","both","none"]},e.pointNumber={default:null},e}},Bh=Do;var tt=De(Ee());var Vo=class extends lt{static componentType="angle";static get stateVariablesShadowedForReference(){return["nPointsSpecified","points","radians","degrees","numericalPoints"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.draggable={default:!0,forRenderer:!0},e.radius={default:tt.default.fromAst(1)},e.renderAsAcuteAngle={default:!1,forRenderer:!0},e.inDegrees={default:!1,forRenderer:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions();return t.push({childrenRegex:"s",replacementFunction:({matchedChildren:e})=>({success:!0,newChildren:[{componentType:"radians",children:e,doenetAttributes:{isPropertyChild:!0}}]})}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneRadians",componentType:"radians",comparison:"atMost",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"exactlyOneDegrees",componentType:"degrees",comparison:"atMost",number:1,takePropertyChildren:!0}),i=e.newLeaf({name:"exactlyOneThrough",componentType:"through",number:1,takePropertyChildren:!0}),a=e.newLeaf({name:"exactlyOneBetweenLines",componentType:"betweenLines",number:1,takePropertyChildren:!0});return e.newOperator({name:"throughLogic",operator:"xor",propositions:[i,a,r,n],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.lineNames={returnDependencies:()=>({betweenLinesChild:{dependencyType:"child",childLogicName:"exactlyOneBetweenLines",variableNames:["lineNames"]}}),definition({dependencyValues:e}){let n=[];return e.betweenLinesChild.length===1&&(n=e.betweenLinesChild[0].stateValues.lineNames),{newValues:{lineNames:n}}}},t.betweenLinesName={returnDependencies:()=>({betweenLinesChild:{dependencyType:"child",childLogicName:"exactlyOneBetweenLines"}}),definition({dependencyValues:e}){let n=null;return e.betweenLinesChild.length===1&&(n=e.betweenLinesChild[0].componentName),{newValues:{betweenLinesName:n}}}},t.nPointsSpecified={returnDependencies:()=>({throughChild:{dependencyType:"child",childLogicName:"exactlyOneThrough",variableNames:["nPoints"]}}),definition({dependencyValues:e}){return e.throughChild.length===1?{newValues:{nPointsSpecified:e.throughChild[0].stateValues.nPoints}}:{newValues:{nPointsSpecified:0}}}},t.points={isArray:!0,nDimensions:2,entryPrefixes:["pointX","point"],stateVariablesDeterminingDependencies:["nPointsSpecified","betweenLinesName"],returnArraySizeDependencies:()=>({radiansChild:{dependencyType:"child",childLogicName:"atMostOneRadians"},degreesChild:{dependencyType:"child",childLogicName:"exactlyOneDegrees"}}),returnArraySize({dependencyValues:e}){return e.radiansChild.length===1||e.degreesChild.length===1?[0,0]:[3,2]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="pointX"){let i=n.split("_").map(a=>Number(a)-1);return i.length===2&&i.every((a,s)=>Number.isInteger(a)&&a>=0)?r?i.every((a,s)=>a<r[s])?[String(i)]:[]:[String(i)]:[]}else{if(!r)return[];let i=Number(n)-1;return Number.isInteger(i)&&i>=0&&i<r[0]?Array.from(Array(r[1]),(a,s)=>i+","+s):[]}},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={nPointsSpecified:{dependencyType:"value",value:n.nPointsSpecified}};n.betweenLinesName!==null&&(r.lineChildren={dependencyType:"child",parentName:n.betweenLinesName,childLogicName:"atLeastZeroLines",variableNames:["points","nDimensions","coeff0","coeffvar1","coeffvar2"]});let i={};for(let a of e){let[s,o]=a.split(",");if(s==="0"||n.nPointsSpecified>2){let u=Number(s)+1+"_"+(Number(o)+1);i[a]={throughChild:{dependencyType:"child",childLogicName:"exactlyOneThrough",variableNames:["pointX"+u]}}}else if(s==="2"&&n.nPointsSpecified===2){let u="2_"+(Number(o)+1);i[a]={throughChild:{dependencyType:"child",childLogicName:"exactlyOneThrough",variableNames:["pointX"+u]}}}}return{globalDependencies:r,dependenciesByKey:i}},arrayDefinitionByKey({dependencyValuesByKey:e,globalDependencyValues:n,arrayKeys:r}){if(n.lineChildren)if(n.lineChildren.length!==2)console.warn(`Cannot define an angle between ${n.lineChildren.length} line(s)`);else{let u=n.lineChildren[0],c=n.lineChildren[1],f=w1(u,c);if(f===void 0){let b={};for(let x=0;x<3;x++)for(let N=0;N<2;N++)b[x+","+N]=tt.default.fromAst("\uFF3F");return{newValues:{points:b}}}let p=f,d=u.stateValues.points[0][0].evaluate_to_constant(),m=u.stateValues.points[0][1].evaluate_to_constant(),v=u.stateValues.points[1][0].evaluate_to_constant(),h=u.stateValues.points[1][1].evaluate_to_constant(),y=[tt.default.fromAst(p[0].tree+v-d),tt.default.fromAst(p[1].tree+h-m)];d=c.stateValues.points[0][0].evaluate_to_constant(),m=c.stateValues.points[0][1].evaluate_to_constant(),v=c.stateValues.points[1][0].evaluate_to_constant(),h=c.stateValues.points[1][1].evaluate_to_constant();let g=[tt.default.fromAst(p[0].tree+v-d),tt.default.fromAst(p[1].tree+h-m)];return{newValues:{points:{"0,0":y[0],"0,1":y[1],"1,0":p[0],"1,1":p[1],"2,0":g[0],"2,1":g[1]}}}}let i=n.nPointsSpecified,a={},s={};for(let u of r){let[c,f]=u.split(",");if(c==="0"||i>2){let p=Number(c)+1+"_"+(Number(f)+1),d;e[u].throughChild.length===1&&(d=e[u].throughChild[0].stateValues["pointX"+p]),d===void 0?c==="0"&&f==="1"||c==="2"&&f==="0"?s[u]={defaultValue:tt.default.fromAst(1)}:s[u]={defaultValue:tt.default.fromAst(0)}:a[u]=d}else if(c==="2"&&i===2){let p="2_"+(Number(f)+1),d;e[u].throughChild.length===1&&(d=e[u].throughChild[0].stateValues["pointX"+p]),d===void 0?f==="0"?s[u]={defaultValue:tt.default.fromAst(1)}:s[u]={defaultValue:tt.default.fromAst(0)}:a[u]=d}else c==="2"&&f==="0"?s[u]={defaultValue:tt.default.fromAst(1)}:s[u]={defaultValue:tt.default.fromAst(0)}}let o={};return Object.keys(a).length>0&&(o.newValues={points:a}),Object.keys(s).length>0&&(o.useEssentialOrDefaultValue={points:s}),o}},t.radians={public:!0,componentType:"math",forRenderer:!0,returnDependencies:()=>({radiansChild:{dependencyType:"child",childLogicName:"atMostOneRadians",variableNames:["value"]},degreesChild:{dependencyType:"child",childLogicName:"exactlyOneDegrees",variableNames:["value"]},points:{dependencyType:"stateVariable",variableName:"points"}}),definition({dependencyValues:e}){if(e.radiansChild.length===1)return{newValues:{radians:e.radiansChild[0].stateValues.value.simplify()}};if(e.degreesChild.length===1)return{newValues:{radians:e.degreesChild[0].stateValues.value.multiply(tt.default.fromAst(["/","pi",180])).simplify()}};let n=[],r=!1;for(let a=0;a<3;a++)n.push([e.points[a][0].evaluate_to_constant(),e.points[a][1].evaluate_to_constant()]),(n[a][0]===null||n[a][1]===null)&&(r=!0);let i;return r?{newValues:{radians:tt.default.fromAst("\uFF3F")}}:(i=Math.atan2(n[2][1]-n[1][1],n[2][0]-n[1][0])-Math.atan2(n[0][1]-n[1][1],n[0][0]-n[1][0]),i<0&&(i+=2*Math.PI),{newValues:{radians:tt.default.fromAst(i)}})}},t.value={isAlias:!0,targetVariableName:"radians"},t.angle={isAlias:!0,targetVariableName:"radians"},t.degrees={public:!0,componentType:"math",forRenderer:!0,returnDependencies:()=>({radians:{dependencyType:"stateVariable",variableName:"radians"}}),definition({dependencyValues:e}){let n;return e.radians.tree==="\uFF3F"||Number.isNaN(e.radians.tree)?n=e.radians:n=e.radians.multiply(tt.default.fromAst(["/",180,"pi"])).simplify(),{newValues:{degrees:n}}}},t.numericalPoints={isArray:!0,entryPrefixes:["numericalPoint"],forRenderer:!0,returnArraySizeDependencies:()=>({radiansChild:{dependencyType:"child",childLogicName:"atMostOneRadians"},degreesChild:{dependencyType:"child",childLogicName:"exactlyOneDegrees"}}),returnArraySize({dependencyValues:e}){return e.radiansChild.length===1||e.degreesChild.length===1?[0]:[3]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n[r]={point:{dependencyType:"stateVariable",variableName:"point"+(Number(r)+1)}};return{dependenciesByKey:n}},arrayDefinitionByKey({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n){let a=e[i].point,s=[];for(let o=0;o<2;o++){let u=a[o].evaluate_to_constant();Number.isFinite(u)||(u=NaN),s.push(u)}r[i]=s}return{newValues:{numericalPoints:r}}}},t.numericalRadius={forRenderer:!0,returnDependencies:()=>({radius:{dependencyType:"stateVariable",variableName:"radius"}}),definition({dependencyValues:e}){let n=e.radius.evaluate_to_constant();return Number.isFinite(n)||(n=NaN),{newValues:{numericalRadius:n}}}},t}adapters=["radians"]},zh=Vo;function w1(l,t){if(l.stateValues.nDimensions!==2||t.stateValues.nDimensions!==2){console.log("Calculating angle between two lines implemented only in 2D");return}let e=l.stateValues.coeffvar1.evaluate_to_constant(),n=l.stateValues.coeffvar2.evaluate_to_constant(),r=l.stateValues.coeff0.evaluate_to_constant(),i=t.stateValues.coeffvar1.evaluate_to_constant(),a=t.stateValues.coeffvar2.evaluate_to_constant(),s=t.stateValues.coeff0.evaluate_to_constant();if(!(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)&&Number.isFinite(s))){console.log("Calculating angle between two lines implemented only for constant coefficients");return}let o=e*a-i*n;if(Math.abs(o)<1e-14)if(Math.abs(s*e-r*i)>1e-14){console.log("Cannot calculate angle between two parallel lines");return}else return e===0&&n===0&&r===0||i===0&&a===0&&s===0?void 0:n!==0?[tt.default.fromAst(0),tt.default.fromAst(-r/n)]:[tt.default.fromAst(-r/e),tt.default.fromAst(0)];let u=(s*n-r*a)/o,c=(r*i-s*e)/o;return[tt.default.fromAst(u),tt.default.fromAst(c)]}var Io=class extends ke{static componentType="equation";static rendererType="math";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions(),e=t.value.definition;return t.value.definition=function({dependencyValues:n}){let r=e({dependencyValues:n}).newValues.value,i=r.tree;return(!Array.isArray(i)||i[0]!=="="||i.length!==3)&&console.warn("Invalid format for equation"),{newValues:{value:r}}},t}},qh=Io;var Mo=class extends Me{constructor(t){super(t);Object.defineProperty(this.actions,"submitAllAnswers",{get:function(){return this.stateValues.submitAllAnswersAtAncestor!==null?()=>this.coreFunctions.requestAction({componentName:this.stateValues.submitAllAnswersAtAncestor,actionName:"submitAllAnswers"}):()=>null}.bind(this)})}static componentType="answer";static acceptType=!0;static get stateVariablesShadowedForReference(){return["showCorrectness"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.weight={default:1},e.inline={default:!1,propagateToDescendants:!0},e.symbolicEquality={default:!1,propagateToDescendants:!0},e.fixedOrder={default:!1,propagateToDescendants:!0},e.size={default:10,propagateToDescendants:!0},e.forceFullCheckworkButton={default:!1},e.expandOnCompare={default:!1,propagateToDescendants:!0},e.simplifyOnCompare={default:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numbersepreserveorder"],propagateToDescendants:!0},e.unorderedCompare={default:!1,propagateToDescendants:!0},e.allowedErrorInNumbers={default:0,propagateToDescendants:!0},e.includeErrorInNumberExponents={default:!1,propagateToDescendants:!0},e.allowedErrorIsAbsolute={default:!1,propagateToDescendants:!0},e.nSignErrorsMatched={default:0,propagateToDescendants:!0},e.feedbackDefinitions={propagateToDescendants:!0,mergeArrays:!0},e.prefill={propagateToDescendants:!0,default:""},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:r,componentProps:i}){let a;return i.type?a=i.type:a="math",["math","text"].includes(a)||(console.warn(`Invalid type ${a}`),a="math"),{success:!0,newChildren:[{componentType:"award",children:[{componentType:a,children:r}]}]}};t.push({childrenRegex:"s",replacementFunction:e});function n({matchedChildren:r,componentProps:i,componentInfoObjects:a}){let s=!1;for(let c of r){if(a.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"_input"}))return{success:!1};if(a.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"considerAsResponses"}))return{success:!1};(a.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"_composite"})||a.isInheritedComponentType({inheritedComponentType:c.componentType,baseComponentType:"award"})&&c.children&&!c.children.some(f=>a.isInheritedComponentType({inheritedComponentType:f.componentType,baseComponentType:"when"})))&&(s=!0)}if(!s)return{success:!1};let u=[{componentType:i.type==="text"?"textinput":"mathinput"},...r];return{success:!0,newChildren:u}}return t.push({replacementFunction:n}),t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroAwards",componentType:"award",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastZeroInputs",componentType:"_input",comparison:"atLeast",number:0}),i=e.newLeaf({name:"atLeastZeroConsiderAsResponses",componentType:"considerAsResponses",comparison:"atLeast",number:0}),a=e.newLeaf({name:"atMostOneShowCorrectness",componentType:"showCorrectness",comparison:"atMost",number:1,takePropertyChildren:!0}),s=e.newOperator({name:"awardsInputResponses",operator:"and",propositions:[n,r,i]});return e.newOperator({name:"answerChildLogic",operator:"and",propositions:[s,a],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.haveAwardThatRequiresInput={returnDependencies:()=>({awardChildren:{dependencyType:"child",childLogicName:"atLeastZeroAwards",variableNames:["requireInputInAnswer"]}}),definition({dependencyValues:e}){return{newValues:{haveAwardThatRequiresInput:e.awardChildren.some(n=>n.stateValues.requireInputInAnswer)}}}},t.allInputChildren={returnDependencies:()=>({allInputChildren:{dependencyType:"child",childLogicName:"atLeastZeroInputs"}}),definition({dependencyValues:e}){return{newValues:{allInputChildren:e.allInputChildren}}}},t.inputChild={stateVariablesDeterminingDependencies:["allInputChildren"],additionalStateVariablesDefined:["inputChildIndex"],forRenderer:!0,returnDependencies({stateValues:e}){let n={allInputChildren:{dependencyType:"stateVariable",variableName:"allInputChildren"},haveAwardThatRequiresInput:{dependencyType:"stateVariable",variableName:"haveAwardThatRequiresInput"}};for(let[r,i]of e.allInputChildren.entries())n[`child${r}FromSugar`]={dependencyType:"doenetAttribute",componentName:i.componentName,attributeName:"createdFromSugar"};return n},definition({dependencyValues:e}){let n=null,r=null;for(let[i,a]of e.allInputChildren.entries())if(e[`child${i}FromSugar`])e.haveAwardThatRequiresInput&&!n&&(n=a,r=i);else{n=a,r=i;break}return{newValues:{inputChild:n,inputChildIndex:r}}}},t.inputChildWithValues={stateVariablesDeterminingDependencies:["inputChildIndex"],forRenderer:!0,returnDependencies:({stateValues:e})=>({inputChild:{dependencyType:"child",childLogicName:"atLeastZeroInputs",variableNames:["valueToRecordOnSubmit","valueRecordedAtSubmit","value","immediateValue"],childIndices:[e.inputChildIndex],variablesOptional:!0}}),definition:function({dependencyValues:e}){return e.inputChild.length===1?{newValues:{inputChildWithValues:e.inputChild[0]}}:{newValues:{inputChildWithValues:null}}}},t.awardInputResponseChildren={returnDependencies:()=>({awardInputResponseChildren:{dependencyType:"child",childLogicName:"awardsInputResponses"}}),definition:({dependencyValues:e})=>({newValues:{awardInputResponseChildren:e.awardInputResponseChildren}})},t.nResponses={stateVariablesDeterminingDependencies:["awardInputResponseChildren"],returnDependencies({stateValues:e,componentInfoObjects:n}){let r={childTypes:{dependencyType:"value",value:e.awardInputResponseChildren.map(i=>i.componentType)}};for(let[i,a]of e.awardInputResponseChildren.entries())n.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"award"})?r["child"+i]={dependencyType:"descendant",ancestorName:a.componentName,componentTypes:["_base"],variableNames:["isResponse","nValues"],variablesOptional:!0,requireChildLogicInitiallySatisfied:!0,recurseToMatchedChildren:!0,includePropertyChildren:!0,includeNonActiveChildren:!0,skipOverAdapters:!0}:n.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"_input"})?r["childNValues"+i]={dependencyType:"stateVariable",componentName:a.componentName,variableName:"nValues",variablesOptional:!0}:r["child"+i]={dependencyType:"stateVariable",componentName:a.componentName,variableName:"childrenWithNValues"};return r},definition({dependencyValues:e,componentInfoObjects:n}){let r=0;for(let[i,a]of e.childTypes.entries())if(n.isInheritedComponentType({inheritedComponentType:a,baseComponentType:"award"}))for(let s of e["child"+i])!s.stateValues.isResponse||n.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"_composite"})||(s.stateValues.nValues===void 0?r+=1:r+=s.stateValues.nValues);else if(n.isInheritedComponentType({inheritedComponentType:a,baseComponentType:"_input"})){let s=e["childNValues"+i];s===void 0?r+=1:r+=s}else for(let s of e["child"+i])s.stateValues.nValues===void 0?r+=1:r+=s.stateValues.nValues;return{newValues:{nResponses:r}}}},t.currentResponses={public:!0,isArray:!0,entryPrefixes:["currentResponse"],hasVariableComponentType:!0,defaultEntryValue:"\uFF3F",stateVariablesDeterminingDependencies:["awardInputResponseChildren"],returnArraySizeDependencies:()=>({nResponses:{dependencyType:"stateVariable",variableName:"nResponses"}}),returnArraySize({dependencyValues:e}){return[e.nResponses]},returnArrayDependenciesByKey({stateValues:e,componentInfoObjects:n}){let r={childTypes:{dependencyType:"value",value:e.awardInputResponseChildren.map(i=>i.componentType)}};for(let[i,a]of e.awardInputResponseChildren.entries())n.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"award"})?r["child"+i]={dependencyType:"descendant",ancestorName:a.componentName,componentTypes:["_base"],variableNames:["isResponse","value","values","componentType"],variablesOptional:!0,requireChildLogicInitiallySatisfied:!0,recurseToMatchedChildren:!0,includePropertyChildren:!0,includeNonActiveChildren:!0,skipOverAdapters:!0}:n.isInheritedComponentType({inheritedComponentType:a.componentType,baseComponentType:"_input"})?(r["childValue"+i]={dependencyType:"stateVariable",componentName:a.componentName,variableName:"value",variablesOptional:!0},r["childValues"+i]={dependencyType:"stateVariable",componentName:a.componentName,variableName:"values",variablesOptional:!0},r["childComponentType"+i]={dependencyType:"stateVariable",componentName:a.componentName,variableName:"componentType",variablesOptional:!0}):r["child"+i]={dependencyType:"stateVariable",componentName:a.componentName,variableName:"childrenAsResponses"};return{globalDependencies:r}},arrayDefinitionByKey({globalDependencyValues:e,componentInfoObjects:n}){let r=[],i=[],a=[];for(let[s,o]of e.childTypes.entries())if(n.isInheritedComponentType({inheritedComponentType:o,baseComponentType:"award"}))for(let u of e["child"+s])!u.stateValues.isResponse||n.isInheritedComponentType({inheritedComponentType:u.componentType,baseComponentType:"_composite"})||a.push(u);else if(n.isInheritedComponentType({inheritedComponentType:o,baseComponentType:"_input"})){let u={componentType:o,stateValues:{value:e["childValue"+s],values:e["childValues"+s],componentType:e["childComponentType"+s]}};a.push(u)}else a.push(...e["child"+s]);for(let s of a){let o=s.stateValues.componentType;o||(o=s.componentType),Array.isArray(s.stateValues.values)?(r.push(...s.stateValues.values),i.push(...Array(s.stateValues.values.length).fill(o))):(r.push(s.stateValues.value),i.push(o))}return{newValues:{currentResponses:r},setComponentType:{currentResponses:i}}}},t.currentResponse={isAlias:!0,targetVariableName:"currentResponse1"},t.nSubmittedResponses={public:!0,componentType:"number",returnDependencies:()=>({nResponses:{dependencyType:"stateVariable",variableName:"nResponses"}}),definition:({dependencyValues:e})=>({useEssentialOrDefaultValue:{nSubmittedResponses:{variablesToCheck:["nSubmittedResponses"],defaultValue:0}}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"nSubmittedResponses",value:e.nSubmittedResponses}]}}},t.submittedResponsesComponentType={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{submittedResponsesComponentType:{variablesToCheck:["submittedResponsesComponentType"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return e.submittedResponsesComponentType?{success:!0,instructions:[{setStateVariable:"submittedResponsesComponentType",value:[...e.submittedResponsesComponentType]}]}:{success:!0,instructions:[{setStateVariable:"submittedResponsesComponentType",value:[]}]}}},t.submittedResponses={public:!0,isArray:!0,entryPrefixes:["submittedResponse"],defaultEntryValue:"\uFF3F",essential:!0,componentType:"math",hasVariableComponentType:!0,returnArraySizeDependencies:()=>({nSubmittedResponses:{dependencyType:"stateVariable",variableName:"nSubmittedResponses"}}),returnArraySize({dependencyValues:e}){return[e.nSubmittedResponses]},returnArrayDependenciesByKey(){return{globalDependencies:{submittedResponsesComponentType:{dependencyType:"stateVariable",variableName:"submittedResponsesComponentType"},nSubmittedResponses:{dependencyType:"stateVariable",variableName:"nSubmittedResponses"}}}},arrayDefinitionByKey({globalDependencyValues:e}){let n=[];e.submittedResponsesComponentType&&n.push(...e.submittedResponsesComponentType.slice(0,e.nSubmittedResponses));let r={};for(let i=0;i<e.nSubmittedResponses;i++)r[i]={variablesToCheck:[{variableName:"submittedResponses",arrayIndex:i}]},n[i]||(n[i]="math");return{useEssentialOrDefaultValue:{submittedResponses:r},setComponentType:{submittedResponses:n}}},inverseArrayDefinitionByKey:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"nSubmittedResponses",desiredValue:e.submittedResponses.length},{setStateVariable:"submittedResponses",value:[...e.submittedResponses]}]}}},t.submittedResponse={isAlias:!0,targetVariableName:"submittedResponse1"},t.delegateCheckWork={additionalStateVariablesDefined:["delegateCheckWorkToInput","delegateCheckWorkToAncestor",{variableName:"submitAllAnswersAtAncestor",forRenderer:!0}],forRenderer:!0,returnDependencies:()=>({inputChild:{dependencyType:"stateVariable",variableName:"inputChild"},forceFullCheckworkButton:{dependencyType:"stateVariable",variableName:"forceFullCheckworkButton"},sectionAncestor:{dependencyType:"ancestor",componentType:"_sectioningcomponent",variableNames:["suppressAnswerSubmitButtons","componentNameForSubmitAll","answerDelegatedForSubmitAll","justSubmittedForSubmitAll","creditAchievedForSubmitAll"]}}),definition:function({dependencyValues:e,componentName:n}){let r=!1,i=!1,a=!1,s=null;if(e.sectionAncestor){let o=e.sectionAncestor.stateValues;o.suppressAnswerSubmitButtons&&(o.answerDelegatedForSubmitAll===n?s=o.componentNameForSubmitAll:r=a=!0)}return!r&&e.inputChild&&!e.forceFullCheckworkButton&&(i=a=!0),{newValues:{delegateCheckWork:a,delegateCheckWorkToAncestor:r,delegateCheckWorkToInput:i,submitAllAnswersAtAncestor:s}}}},t.creditAchievedIfSubmit={additionalStateVariablesDefined:["awardUsedIfSubmit","awardChildren","inputUsedIfSubmit"],stateVariablesDeterminingDependencies:["inputChildIndex"],returnDependencies:({stateValues:e})=>({awardChildren:{dependencyType:"child",childLogicName:"atLeastZeroAwards",variableNames:["credit","creditAchieved","fractionSatisfied"]},inputChild:{dependencyType:"child",childLogicName:"atLeastZeroInputs",variableNames:["creditAchievedIfSubmit"],childIndices:[e.inputChildIndex],variablesOptional:!0}}),definition:function({dependencyValues:e}){let n=0,r=null,i=null;if(e.awardChildren.length===0){if(e.inputChild.length===1){let a=e.inputChild[0].stateValues.creditAchievedIfSubmit;a>=0&&(n=a,i=e.inputChild[0].componentName)}}else for(let a of e.awardChildren)if(Math.max(0,Math.min(1,a.stateValues.credit))>n||r===null){let o=a.stateValues.creditAchieved;a.stateValues.fractionSatisfied>0&&(o>n||r===null)&&(n=o,r=a.componentName)}return{newValues:{creditAchievedIfSubmit:n,awardUsedIfSubmit:r,awardChildren:e.awardChildren,inputUsedIfSubmit:i}}}},t.creditAchieved={defaultValue:0,public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{creditAchieved:{variablesToCheck:["creditAchieved"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"creditAchieved",value:e.creditAchieved}]}}},t.responseHasBeenSubmitted={public:!0,componentType:"boolean",defaultValue:!1,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{responseHasBeenSubmitted:{variablesToCheck:["responseHasBeenSubmitted"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"responseHasBeenSubmitted",value:e.responseHasBeenSubmitted}]}}},t.creditAchievedDependencies={returnDependencies:()=>({currentCreditAchievedDependencies:{dependencyType:"recursiveDependencyValues",variableName:"creditAchievedIfSubmit",changedValuesOnly:!0}}),definition({dependencyValues:e}){return{newValues:{creditAchievedDependencies:e.currentCreditAchievedDependencies}}}},t.creditAchievedDependenciesAtSubmit={defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{creditAchievedDependenciesAtSubmit:{variablesToCheck:["creditAchievedDependenciesAtSubmit"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"creditAchievedDependenciesAtSubmit",value:e.creditAchievedDependenciesAtSubmit}]}}},t.justSubmitted={forRenderer:!0,returnDependencies:()=>({currentCreditAchievedDependencies:{dependencyType:"stateVariable",variableName:"creditAchievedDependencies"},creditAchievedDependenciesAtSubmit:{dependencyType:"stateVariable",variableName:"creditAchievedDependenciesAtSubmit"}}),definition:function({dependencyValues:e}){return{newValues:{justSubmitted:sn(e.currentCreditAchievedDependencies,e.creditAchievedDependenciesAtSubmit)}}}},t.creditAchievedForSubmitButton={additionalStateVariablesDefined:[{variableName:"justSubmittedForSubmitButton",forRenderer:!0}],forRenderer:!0,returnDependencies:()=>({creditAchieved:{dependencyType:"stateVariable",variableName:"creditAchieved"},justSubmitted:{dependencyType:"stateVariable",variableName:"justSubmitted"},submitAllAnswersAtAncestor:{dependencyType:"stateVariable",variableName:"submitAllAnswersAtAncestor"},sectionAncestor:{dependencyType:"ancestor",componentType:"_sectioningcomponent",variableNames:["justSubmittedForSubmitAll","creditAchievedForSubmitAll"]}}),definition({dependencyValues:e}){if(e.submitAllAnswersAtAncestor){let n=e.sectionAncestor.stateValues;return{newValues:{creditAchievedForSubmitButton:n.creditAchievedForSubmitAll,justSubmittedForSubmitButton:n.justSubmittedForSubmitAll}}}else return{newValues:{creditAchievedForSubmitButton:e.creditAchieved,justSubmittedForSubmitButton:e.justSubmitted}}}},t.feedbacks={public:!0,componentType:"feedback",isArray:!0,entireArrayAtOnce:!0,entryPrefixes:["feedback"],returnDependencies:()=>({awardChildren:{dependencyType:"child",childLogicName:"atLeastZeroAwards",variableNames:["feedbacks"]},feedbackComponents:{dependencyType:"descendant",componentTypes:["_input"],variableNames:["feedbacks"],variablesOptional:!0}}),entireArrayDefinition:function({dependencyValues:e}){let n=[];for(let r of e.awardChildren)n.push(...r.stateValues.feedbacks);for(let r of e.feedbackComponents)Array.isArray(r.stateValues.feedbacks)&&n.push(...r.stateValues.feedbacks);return{newValues:{feedbacks:n}}}},t.showCorrectness={forRenderer:!0,returnDependencies:()=>({showCorrectnessFlag:{dependencyType:"flag",flagName:"showCorrectness"},showCorrectnessChild:{dependencyType:"child",childLogicName:"atMostOneShowCorrectness",variableNames:["value"]}}),definition({dependencyValues:e}){let n;return e.showCorrectnessChild.length===1?n=e.showCorrectnessChild[0].stateValues.value:n=e.showCorrectnessFlag!==!1,{newValues:{showCorrectness:n}}}},t.childrenToRender={returnDependencies:()=>({inputChild:{dependencyType:"stateVariable",variableName:"inputChild"}}),definition:function({dependencyValues:e}){let n=[];return e.inputChild&&n.push(e.inputChild.componentName),{newValues:{childrenToRender:n}}}},t}actions={submitAnswer:this.submitAnswer.bind(new Proxy(this,this.readOnlyProxyHandler))};submitAnswer(){let t=this.stateValues.creditAchievedIfSubmit,e=this.stateValues.awardUsedIfSubmit,n=this.stateValues.inputUsedIfSubmit,r=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"creditAchieved",value:t},{updateType:"updateValue",componentName:this.componentName,stateVariable:"responseHasBeenSubmitted",value:!0}];this.stateValues.inputChildWithValues&&n===this.stateValues.inputChildWithValues.componentName&&"valueToRecordOnSubmit"in this.stateValues.inputChildWithValues.stateValues&&"valueRecordedAtSubmit"in this.stateValues.inputChildWithValues.stateValues&&r.push({updateType:"updateValue",componentName:this.stateValues.inputChildWithValues.componentName,stateVariable:"valueRecordedAtSubmit",value:this.stateValues.inputChildWithValues.stateValues.valueToRecordOnSubmit}),r.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"submittedResponses",value:this.stateValues.currentResponses}),r.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"submittedResponsesComponentType",value:this.state.currentResponses.componentType}),r.push({updateType:"updateValue",componentName:this.componentName,stateVariable:"creditAchievedDependenciesAtSubmit",value:this.stateValues.creditAchievedDependencies});for(let a of this.stateValues.awardChildren){let s=a.componentName===e;r.push({updateType:"updateValue",componentName:a.componentName,stateVariable:"awarded",value:s})}let i=[];for(let a of this.stateValues.currentResponses)a.toString?i.push(a.toString()):i.push(a);this.coreFunctions.requestUpdate({updateInstructions:r,event:{verb:"submitted",object:{componentName:this.componentName,componentType:this.componentType},result:{response:this.stateValues.currentResponses,responseText:i,creditAchieved:t}}})}},jh=Mo;var Uh=De(Ee());var Oo=class extends _e{static componentType="award";static rendererType=void 0;static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.credit={default:1},e.matchPartial={default:!1,propagateToDescendants:!0},e.symbolicEquality={default:!1,propagateToDescendants:!0},e.expandOnCompare={default:!1,propagateToDescendants:!0},e.simplifyOnCompare={default:"none",toLowerCase:!0,valueTransformations:{"":"full",true:"full"},validValues:["none","full","numbers","numbersepreserveorder"],propagateToDescendants:!0},e.unorderedCompare={default:!1,propagateToDescendants:!0},e.allowedErrorInNumbers={default:0,propagateToDescendants:!0},e.includeErrorInNumberExponents={default:!1,propagateToDescendants:!0},e.allowedErrorIsAbsolute={default:!1,propagateToDescendants:!0},e.nSignErrorsMatched={default:0,propagateToDescendants:!0},e.feedbackCodes={default:[]},e.feedbackText={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneWhen",componentType:"when",number:1}),r=e.newLeaf({name:"exactlyOneMath",componentType:"math",number:1}),i=e.newLeaf({name:"exactlyOneText",componentType:"text",number:1});return e.newOperator({name:"whenXorStringXorMathXorText",operator:"xor",propositions:[n,r,i],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.parsedExpression={additionalStateVariablesDefined:["requireInputInAnswer"],returnDependencies:()=>({mathChild:{dependencyType:"child",childLogicName:"exactlyOneMath"},textChild:{dependencyType:"child",childLogicName:"exactlyOneText"}}),definition:function({dependencyValues:e}){let n=null,r=!1;return(e.mathChild.length===1||e.textChild.length===1)&&(r=!0,n=Uh.default.fromAst(["=","comp1","comp2"])),{newValues:{parsedExpression:n,requireInputInAnswer:r}}}},t.creditAchieved={additionalStateVariablesDefined:["fractionSatisfied"],returnDependencies:()=>({credit:{dependencyType:"stateVariable",variableName:"credit"},whenChild:{dependencyType:"child",childLogicName:"exactlyOneWhen",variableNames:["fractionSatisfied"]},mathChild:{dependencyType:"child",childLogicName:"exactlyOneMath",variableNames:["value","unordered","expand","simplify"]},textChild:{dependencyType:"child",childLogicName:"exactlyOneText",variableNames:["value"]},answerInput:{dependencyType:"parentStateVariable",variableName:"inputChildWithValues"},parsedExpression:{dependencyType:"stateVariable",variableName:"parsedExpression"},matchPartial:{dependencyType:"stateVariable",variableName:"matchPartial"},symbolicEquality:{dependencyType:"stateVariable",variableName:"symbolicEquality"},expandOnCompare:{dependencyType:"stateVariable",variableName:"expandOnCompare"},simplifyOnCompare:{dependencyType:"stateVariable",variableName:"simplifyOnCompare"},unorderedCompare:{dependencyType:"stateVariable",variableName:"unorderedCompare"},allowedErrorInNumbers:{dependencyType:"stateVariable",variableName:"allowedErrorInNumbers"},includeErrorInNumberExponents:{dependencyType:"stateVariable",variableName:"includeErrorInNumberExponents"},allowedErrorIsAbsolute:{dependencyType:"stateVariable",variableName:"allowedErrorIsAbsolute"},nSignErrorsMatched:{dependencyType:"stateVariable",variableName:"nSignErrorsMatched"}}),definition:function({dependencyValues:e,usedDefault:n}){let r;if(e.whenChild.length===1)r=e.whenChild[0].stateValues.fractionSatisfied;else{if(!e.answerInput||!e.parsedExpression)return{newValues:{creditAchieved:0,fractionSatisfied:0}};r=T1({dependencyValues:e,usedDefault:n})}let i=0;return Number.isFinite(e.credit)&&(i=Math.max(0,Math.min(1,e.credit))*Math.max(0,Math.min(1,r))),{newValues:{fractionSatisfied:r,creditAchieved:i}}}},t.awarded={public:!0,componentType:"boolean",defaultValue:!1,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{awarded:{variablesToCheck:"awarded"}}}),inverseDefinition:function({desiredStateVariableValues:e,initialChange:n}){return n?{success:!0,instructions:[{setStateVariable:"awarded",value:e.awarded}]}:{success:!1}}},t.feedbacks={public:!0,componentType:"feedback",isArray:!0,entireArrayAtOnce:!0,entryPrefixes:["feedback"],returnDependencies:()=>({feedbackText:{dependencyType:"stateVariable",variableName:"feedbackText"},feedbackCodes:{dependencyType:"stateVariable",variableName:"feedbackCodes"},feedbackDefinitions:{dependencyType:"parentStateVariable",variableName:"feedbackDefinitions"},awarded:{dependencyType:"stateVariable",variableName:"awarded"}}),entireArrayDefinition:function({dependencyValues:e}){if(!e.awarded)return{newValues:{feedbacks:[]}};let n=[];for(let r of e.feedbackCodes){let i=r.toLowerCase();for(let a of e.feedbackDefinitions)if(i===a.feedbackCode){n.push(a.feedbackText);break}}return e.feedbackText!==null&&n.push(e.feedbackText),{newValues:{feedbacks:n}}}},t.feedback={isAlias:!0,targetVariableName:"feedback1"},t}adapters=["awarded"];static standardizedFeedback={numericalerror:"Credit reduced because numbers in your answer weren't quite right.  Did you round too much?",goodjob:"Good job!",onesignerror:"Credit reduced because it appears that you made a sign error.",twosignerrors:"Credit reduced because it appears that you made two sign errors."}},Hh=Oo;function T1({dependencyValues:l,usedDefault:t}){let e={mathChildrenByCode:{},mathlistChildrenByCode:{},textChildrenByCode:{},textlistChildrenByCode:{},booleanChildrenByCode:{},booleanlistChildrenByCode:{}};Object.assign(e,l);let n=l.unorderedCompare,r=l.simplifyOnCompare,i=l.expandOnCompare,a=t.unorderedCompare,s=t.simplifyOnCompare,o=t.expandOnCompare;if(l.textChild.length===1)e.textChildrenByCode.comp2=l.textChild[0];else if(l.mathChild.length===1){let f=l.mathChild[0];e.mathChildrenByCode.comp2=f,a&&f.stateValues.unordered&&(n=!0),o&&f.stateValues.expand&&(i=!0),s&&(f.stateValues.simplify==="full"?r="full":f.stateValues.simplify==="numbers"?r!=="full"&&(r="numbers"):f.stateValues.simplify==="numberspreserveorder"&&r!=="full"&&r!=="numbers"&&(r="numberspreserveorder"))}let u=l.answerInput.stateValues.immediateValue;u===void 0&&(u=l.answerInput.stateValues.value);let c={stateValues:{value:u}};return l.answerInput.componentType==="textinput"?e.textChildrenByCode.comp1=c:e.mathChildrenByCode.comp1=c,Fr({logicTree:l.parsedExpression.tree,unorderedCompare:n,simplifyOnCompare:r,expandOnCompare:i,dependencyValues:e})}var Eo=class extends Me{static componentType="_input";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.collaborateGroups={default:void 0},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nValues={returnDependencies:()=>({}),definition:()=>({newValues:{nValues:1}})},t.answerAncestor={returnDependencies:()=>({answerAncestor:{dependencyType:"ancestor",componentType:"answer",variableNames:["delegateCheckWorkToInput","justSubmittedForSubmitButton","creditAchievedForSubmitButton","submitAllAnswersAtAncestor","showCorrectness"]}}),definition:function({dependencyValues:e}){return{newValues:{answerAncestor:e.answerAncestor}}}},t.includeCheckWork={forRenderer:!0,returnDependencies:()=>({answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition:function({dependencyValues:e}){let n=!1;return e.answerAncestor&&(n=e.answerAncestor.stateValues.delegateCheckWorkToInput),{newValues:{includeCheckWork:n}}}},t.creditAchievedForSubmitButton={defaultValue:0,public:!0,componentType:"number",forRenderer:!0,returnDependencies:()=>({answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition:function({dependencyValues:e}){let n=0;return e.answerAncestor&&(n=e.answerAncestor.stateValues.creditAchievedForSubmitButton),{newValues:{creditAchievedForSubmitButton:n}}}},t.valueHasBeenValidated={forRenderer:!0,returnDependencies:()=>({answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition:function({dependencyValues:e}){let n=!1;return e.answerAncestor&&e.answerAncestor.stateValues.justSubmittedForSubmitButton&&(n=!0),{newValues:{valueHasBeenValidated:n}}}},t.showCorrectness={forRenderer:!0,returnDependencies:()=>({showCorrectnessFlag:{dependencyType:"flag",flagName:"showCorrectness"},answerAncestor:{dependencyType:"stateVariable",variableName:"answerAncestor"}}),definition({dependencyValues:e}){let n;return e.answerAncestor?n=e.answerAncestor.stateValues.showCorrectness:n=e.showCorrectnessFlag!==!1,{newValues:{showCorrectness:n}}}},t}},ar=Eo;var An=De(Ee());var Po=class extends ar{constructor(t){super(t);this.actions={updateImmediateValue:this.updateImmediateValue.bind(new Proxy(this,this.readOnlyProxyHandler)),updateValue:this.updateValue.bind(new Proxy(this,this.readOnlyProxyHandler))},Object.defineProperty(this.actions,"submitAnswer",{get:function(){return this.stateValues.answerAncestor!==null?this.stateValues.answerAncestor.stateValues.submitAllAnswersAtAncestor!==null?()=>this.coreFunctions.requestAction({componentName:this.stateValues.answerAncestor.stateValues.submitAllAnswersAtAncestor,actionName:"submitAllAnswers"}):()=>this.coreFunctions.requestAction({componentName:this.stateValues.answerAncestor.componentName,actionName:"submitAnswer"}):()=>null}.bind(this)})}static componentType="mathinput";static variableForPlainMacro="value";static get stateVariablesShadowedForReference(){return["value"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.prefill={default:""},e.format={default:"text"},e.size={default:10,forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneBindValueTo",componentType:"bindValueTo",comparison:"atMost",number:1,setAsBase:!0,takePropertyChildren:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:"math",forRenderer:!0,returnDependencies:()=>({bindValueToChild:{dependencyType:"child",childLogicName:"atMostOneBindValueTo",variableNames:["value","valueForDisplay"],requireChildLogicInitiallySatisfied:!0},prefill:{dependencyType:"stateVariable",variableName:"prefill"},format:{dependencyType:"stateVariable",variableName:"format"}}),definition:function({dependencyValues:e}){return e.bindValueToChild.length===0?{useEssentialOrDefaultValue:{value:{variablesToCheck:"value",get defaultValue(){return _1({inputString:e.prefill,format:e.format})}}}}:{newValues:{value:nt(e.bindValueToChild[0].stateValues.valueForDisplay)}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){return n.bindValueToChild.length===1?{success:!0,instructions:[{setDependency:"bindValueToChild",desiredValue:e.value,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setStateVariable:"value",value:e.value}]}}},t.immediateValue={public:!0,componentType:"math",forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e,changes:n}){return n.value?{newValues:{immediateValue:e.value},makeEssential:["immediateValue"]}:{useEssentialOrDefaultValue:{immediateValue:{variablesToCheck:"immediateValue",defaultValue:e.value}}}},inverseDefinition:function({desiredStateVariableValues:e,initialChange:n,shadowedVariable:r}){let i=[{setStateVariable:"immediateValue",value:e.immediateValue}];return n||r||i.push({setDependency:"value",desiredValue:e.immediateValue}),{success:!0,instructions:i}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{newValues:{text:e.value.toString()}}}},t.componentType={returnDependencies:()=>({}),definition:()=>({newValues:{componentType:"math"}})},t}updateImmediateValue({mathExpression:t}){this.stateValues.disabled||this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",value:t}],transient:!0})}updateValue(){if(!this.stateValues.disabled){let t=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:this.stateValues.immediateValue},{updateType:"executeUpdate"},{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",valueOfStateVariable:"value"}],e={verb:"answered",object:{componentName:this.componentName,componentType:this.componentType},result:{response:this.stateValues.immediateValue,responseText:this.stateValues.immediateValue.toString()}};this.stateValues.answerAncestor&&(e.context={answerAncestor:this.stateValues.answerAncestor.componentName}),this.coreFunctions.requestUpdate({updateInstructions:t,event:e})}}},Kh=Po;function _1({inputString:l,format:t}){if(!l)return An.default.fromAst("\uFF3F");let e;if(t==="latex")try{e=An.default.fromLatex(l)}catch(n){console.warn(`Invalid latex for mathinput: ${l}`),e=An.default.fromAst("\uFF3F")}else if(t==="text")try{e=An.default.fromText(l)}catch(n){console.warn(`Invalid text for mathinput: ${l}`),e=An.default.fromAst("\uFF3F")}return e}var Lo=class extends ar{constructor(t){super(t);this.actions={updateImmediateValue:this.updateImmediateValue.bind(new Proxy(this,this.readOnlyProxyHandler)),updateValue:this.updateValue.bind(new Proxy(this,this.readOnlyProxyHandler))},Object.defineProperty(this.actions,"submitAnswer",{get:function(){return this.stateValues.answerAncestor!==null?this.stateValues.answerAncestor.stateValues.submitAllAnswersAtAncestor!==null?()=>this.coreFunctions.requestAction({componentName:this.stateValues.answerAncestor.stateValues.submitAllAnswersAtAncestor,actionName:"submitAllAnswers"}):()=>this.coreFunctions.requestAction({componentName:this.stateValues.answerAncestor.componentName,actionName:"submitAnswer"}):()=>null}.bind(this)})}static componentType="textinput";static variableForPlainMacro="value";static get stateVariablesShadowedForReference(){return["value"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.prefill={default:""},e.size={default:10,forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneBindValueTo",componentType:"bindValueTo",comparison:"atMost",number:1,takePropertyChildren:!0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({bindValueToChild:{dependencyType:"child",childLogicName:"atMostOneBindValueTo",variableNames:["text"],requireChildLogicInitiallySatisfied:!0},prefill:{dependencyType:"stateVariable",variableName:"prefill"}}),definition:function({dependencyValues:e}){return e.bindValueToChild.length===0?{useEssentialOrDefaultValue:{value:{variablesToCheck:"value",defaultValue:e.prefill}}}:{newValues:{value:e.bindValueToChild[0].stateValues.text}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){return n.bindValueToChild.length===1?{success:!0,instructions:[{setDependency:"bindValueToChild",desiredValue:e.value,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setStateVariable:"value",value:e.value}]}}},t.immediateValue={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e,changes:n}){return n.value?{newValues:{immediateValue:e.value},makeEssential:["immediateValue"]}:{useEssentialOrDefaultValue:{immediateValue:{variablesToCheck:"immediateValue",defaultValue:e.value}}}},inverseDefinition:function({desiredStateVariableValues:e,initialChange:n,shadowedVariable:r}){let i=[{setStateVariable:"immediateValue",value:e.immediateValue}];return n||r||i.push({setDependency:"value",desiredValue:e.immediateValue}),{success:!0,instructions:i}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{newValues:{text:e.value}}}},t.componentType={returnDependencies:()=>({}),definition:()=>({newValues:{componentType:"text"}})},t}updateImmediateValue({text:t}){this.stateValues.disabled||this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",value:t}]})}updateValue(){if(!this.stateValues.disabled){let t=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:this.stateValues.immediateValue},{updateType:"executeUpdate"},{updateType:"updateValue",componentName:this.componentName,stateVariable:"immediateValue",valueOfStateVariable:"value"}],e={verb:"answered",object:{componentName:this.componentName,componentType:this.componentType},result:{response:this.stateValues.immediateValue,responseText:this.stateValues.immediateValue}};this.stateValues.answerAncestor&&(e.context={answerAncestor:this.stateValues.answerAncestor.componentName}),this.coreFunctions.requestUpdate({updateInstructions:t,event:e})}}},Wh=Lo;var Ro=class extends ar{constructor(t){super(t);this.updateBoolean=this.updateBoolean.bind(new Proxy(this,this.readOnlyProxyHandler)),this.actions={updateBoolean:this.updateBoolean},Object.defineProperty(this.actions,"submitAnswer",{get:function(){return this.stateValues.answerAncestor!==null?this.stateValues.answerAncestor.stateValues.submitAllAnswersAtAncestor!==null?()=>this.coreFunctions.requestAction({componentName:this.stateValues.answerAncestor.stateValues.submitAllAnswersAtAncestor,actionName:"submitAllAnswers"}):()=>this.coreFunctions.requestAction({componentName:this.stateValues.answerAncestor.componentName,actionName:"submitAnswer"}):()=>null}.bind(this)})}static componentType="booleaninput";static variableForPlainMacro="value";static get stateVariablesShadowedForReference(){return["value"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.prefill={default:"false"},e.label={default:"",forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneBindValueTo",componentType:"bindValueTo",comparison:"atMost",number:1,setAsBase:!0,takePropertyChildren:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={public:!0,componentType:"boolean",forRenderer:!0,returnDependencies:()=>({bindValueToChild:{dependencyType:"child",childLogicName:"atMostOneBindValueTo",variableNames:["value"],requireChildLogicInitiallySatisfied:!0},prefill:{dependencyType:"stateVariable",variableName:"prefill"}}),definition:function({dependencyValues:e}){return e.bindValueToChild.length===0?{useEssentialOrDefaultValue:{value:{variablesToCheck:"value",get defaultValue(){return e.prefill.trim().toLowerCase()==="true"}}}}:{newValues:{value:e.bindValueToChild[0].stateValues.value}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){return n.bindValueToChild.length===1?{success:!0,instructions:[{setDependency:"bindValueToChild",desiredValue:e.value,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setStateVariable:"value",value:e.value}]}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({value:{dependencyType:"stateVariable",variableName:"value"}}),definition:function({dependencyValues:e}){return{newValues:{text:e.value?"true":"false"}}}},t.componentType={returnDependencies:()=>({}),definition:()=>({newValues:{componentType:"boolean"}})},t.submittedValue={defaultValue:null,public:!0,componentType:"boolean",returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{submittedValue:{variablesToCheck:["submittedValue"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"submittedValue",value:e.submittedValue}]}}},t}updateBoolean({boolean:t}){let e=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:t}],n={verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:t,responseText:t.toString()}};this.stateValues.answerAncestor&&(n.context={answerAncestor:this.stateValues.answerAncestor.componentName}),this.coreFunctions.requestUpdate({updateInstructions:e,event:n})}},Gh=Ro;var ko=class extends ar{constructor(t){super(t);this.actions={updateSelectedIndices:this.updateSelectedIndices.bind(new Proxy(this,this.readOnlyProxyHandler))},Object.defineProperty(this.actions,"submitAnswer",{get:function(){return this.stateValues.answerAncestor!==null?this.stateValues.answerAncestor.stateValues.submitAllAnswersAtAncestor!==null?()=>this.coreFunctions.requestAction({componentName:this.stateValues.answerAncestor.stateValues.submitAllAnswersAtAncestor,actionName:"submitAllAnswers"}):()=>this.coreFunctions.requestAction({componentName:this.stateValues.answerAncestor.componentName,actionName:"submitAnswer"}):()=>null}.bind(this)})}static componentType="choiceinput";static variableForPlainMacro="values";static createsVariants=!0;static get stateVariablesShadowedForReference(){return["choiceOrder","allSelectedIndices","indexMatchedByBoundValue"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.selectMultiple={default:!1},e.assignPartialCredit={default:!1},e.inline={default:!1,forRenderer:!0},e.fixedOrder={default:!1},e.feedbackDefinitions={propagateToDescendants:!0,mergeArrays:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroChoices",componentType:"choice",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atMostOneBindValueTo",componentType:"bindValueTo",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"choicesAndBind",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.numberChoices={public:!0,componentType:"number",returnDependencies:()=>({choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices"}}),definition({dependencyValues:e}){return{newValues:{numberChoices:e.choiceChildren.length}}}},t.choiceOrder={returnDependencies:({sharedParameters:e})=>({choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices",variableNames:["text"]},fixedOrder:{dependencyType:"stateVariable",variableName:"fixedOrder"},selectRng:{dependencyType:"value",value:e.selectRng,doNotProxy:!0},variants:{dependencyType:"variants"}}),definition:function({dependencyValues:e}){let n=e.choiceChildren.length,r;if(e.fixedOrder)r=[...Array(n).keys()];else{if(e.variants&&e.variants.desiredVariant!==void 0){let i=e.variants.desiredVariant.indices;if(i!==void 0)if(i.length!==n)console.warn("Ignoring indices specified for choiceinput as number of indices doesn't match number of choice children.");else{if(i=i.map(Number),!i.every(Number.isInteger))throw Error("All indices specified for choiceinput must be integers");if(!i.every(a=>a>=0&&a<n))console.warn("Ignoring indices specified for choiceinput as some indices out of range.");else return{newValues:{choiceOrder:i}}}}r=[...Array(n).keys()];for(let i=n-1;i>0;i--){let a=e.selectRng.random(),s=Math.floor(a*(i+1));[r[i],r[s]]=[r[s],r[i]]}}return{newValues:{choiceOrder:r}}}},t.selectedVariantInfo={additionalStateVariablesDefined:["isVariantComponent"],returnDependencies:({componentInfoObjects:e})=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},fixedOrder:{dependencyType:"stateVariable",variableName:"fixedOrder"},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(e.componentTypeWithPotentialVariants),variableNames:["isVariantComponent","selectedVariantInfo"],useReplacementsForComposites:!0,recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfMatchedComposites:!0,definingChildrenFirst:!0}}),definition({dependencyValues:e}){if(e.fixedOrder)return{newValues:{isVariantComponent:!1,selectedVariantInfo:null}};let n={indices:e.choiceOrder},r=n.subvariants=[];for(let i of e.variantDescendants)i.stateValues.isVariantComponent?r.push(i.stateValues.selectedVariantInfo):i.stateValues.selectedVariantInfo&&r.push(...i.stateValues.selectedVariantInfo.subvariants);return{newValues:{selectedVariantInfo:n,isVariantComponent:!0}}}},t.choiceChildrenOrdered={additionalStateVariablesDefined:[{variableName:"numberChoices",public:!0,componentType:"number"}],returnDependencies:()=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices"}}),definition:function({dependencyValues:e}){let n=e.choiceChildren.length;return{newValues:{choiceChildrenOrdered:e.choiceOrder.map(i=>e.choiceChildren[i]),numberChoices:n}}}},t.choiceTexts={public:!0,componentType:"text",isArray:!0,entryPrefixes:["choiceText"],forRenderer:!0,returnArraySizeDependencies:()=>({numberChoices:{dependencyType:"stateVariable",variableName:"numberChoices"}}),returnArraySize({dependencyValues:e}){return[e.numberChoices]},returnArrayDependenciesByKey(){return{globalDependencies:{choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices",variableNames:["text"]}}}},arrayDefinitionByKey({globalDependencyValues:e}){return{newValues:{choiceTexts:e.choiceOrder.map(r=>e.choiceChildren[r]).map(r=>r.stateValues.text)}}}},t.componentType={returnDependencies:()=>({}),definition:()=>({newValues:{componentType:"text"}})},t.indexMatchedByBoundValue={returnDependencies:()=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices",variableNames:["text"]},bindValueToChild:{dependencyType:"child",childLogicName:"atMostOneBindValueTo",variableNames:["text"],requireChildLogicInitiallySatisfied:!0}}),definition({dependencyValues:e}){let n=e.choiceOrder.map(r=>e.choiceChildren[r]);if(e.bindValueToChild.length===1){let r=n.map(a=>a.stateValues.text.toLowerCase().trim()),i=e.bindValueToChild[0];if(i.stateValues.text){let a=r.indexOf(i.stateValues.text.toLowerCase().trim());if(a!==-1)return{newValues:{indexMatchedByBoundValue:a+1}}}}return{newValues:{indexMatchedByBoundValue:null}}}},t.allSelectedIndices={defaultValue:[],returnDependencies(){return{choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices",variableNames:["text"]},indexMatchedByBoundValue:{dependencyType:"stateVariable",variableName:"indexMatchedByBoundValue"},bindValueToChild:{dependencyType:"child",childLogicName:"atMostOneBindValueTo",variableNames:["text"]}}},definition({dependencyValues:e}){if(e.bindValueToChild.length===1){let n;return e.indexMatchedByBoundValue!==null?n=[e.indexMatchedByBoundValue]:n=[],{newValues:{allSelectedIndices:n}}}else return{useEssentialOrDefaultValue:{allSelectedIndices:{variablesToCheck:["allSelectedIndices"]}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){if(n.bindValueToChild.length===0)return{success:!0,instructions:[{setStateVariable:"allSelectedIndices",value:e.allSelectedIndices}]};{let r="";if(e.allSelectedIndices.length>0){let i=e.allSelectedIndices[0]-1,s=n.choiceOrder.map(o=>n.choiceChildren[o])[i];s&&(r=s.stateValues.text)}return{success:!0,instructions:[{setDependency:"bindValueToChild",desiredValue:r,childIndex:0,variableIndex:0}]}}}},t.nSelectedIndices={returnDependencies:()=>({allSelectedIndices:{dependencyType:"stateVariable",variableName:"allSelectedIndices"}}),definition({dependencyValues:e}){return{newValues:{nSelectedIndices:e.allSelectedIndices.length}}}},t.selectedIndices={public:!0,componentType:"number",isArray:!0,entryPrefixes:["selectedIndex"],forRenderer:!0,defaultEntryValue:0,returnArraySizeDependencies:()=>({nSelectedIndices:{dependencyType:"stateVariable",variableName:"nSelectedIndices"}}),returnArraySize({dependencyValues:e}){return[e.nSelectedIndices]},returnArrayDependenciesByKey(){return{globalDependencies:{allSelectedIndices:{dependencyType:"stateVariable",variableName:"allSelectedIndices"}}}},arrayDefinitionByKey({globalDependencyValues:e}){let n={};for(let r in e.allSelectedIndices)n[r]=e.allSelectedIndices[r];return{newValues:{selectedIndices:n}}}},t.selectedIndex={isAlias:!0,targetVariableName:"selectedIndex1"},t.selectedValues={public:!0,componentType:"text",isArray:!0,entryPrefixes:["selectedValue"],returnArraySizeDependencies:()=>({nSelectedIndices:{dependencyType:"stateVariable",variableName:"nSelectedIndices"}}),returnArraySize({dependencyValues:e}){return[e.nSelectedIndices]},returnArrayDependenciesByKey(){return{globalDependencies:{selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"},choiceTexts:{dependencyType:"stateVariable",variableName:"choiceTexts"}}}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:n}){let r={};for(let i in n)r[i]=e.choiceTexts[e.selectedIndices[i]-1];return{newValues:{selectedValues:r}}}},t.selectedValue={isAlias:!0,targetVariableName:"selectedValue1"},t.values={isAlias:!0,targetVariableName:"selectedValues"},t.nValues={isAlias:!0,targetVariableName:"nSelectedIndices"},t.childIndicesSelected={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"},choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"}}),definition({dependencyValues:e}){return{newValues:{childIndicesSelected:e.selectedIndices.map(r=>e.choiceOrder[r-1])}}}},t.creditAchievedIfSubmit={returnDependencies:()=>({choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices",variableNames:["selected","credit"]},selectMultiple:{dependencyType:"stateVariable",variableName:"selectMultiple"},assignPartialCredit:{dependencyType:"stateVariable",variableName:"assignPartialCredit"}}),definition:function({dependencyValues:e}){let n=0;if(e.selectMultiple){let r=0,i=0,a=0;for(let s of e.choiceChildren)s.stateValues.selected?s.stateValues.credit===1?r++:i++:s.stateValues.credit===1&&a++;if(e.assignPartialCredit){let s=r+i+a;s===0?n=1:n=r/s}else i+a===0&&(n=1)}else for(let r of e.choiceChildren)if(r.stateValues.selected){n=r.stateValues.credit;break}return{newValues:{creditAchievedIfSubmit:n}}}},t.valueToRecordOnSubmit={isAlias:!0,targetVariableName:"selectedIndices"},t.submittedIndices={returnDependencies:()=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices",variableNames:["submitted"]}}),definition({dependencyValues:e}){let n=[],r=e.choiceOrder.map(i=>e.choiceChildren[i]);for(let[i,a]of r.entries())a.stateValues.submitted&&n.push(i+1);return{newValues:{submittedIndices:n}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){let r=[];for(let[i,a]of n.choiceOrder.entries())r.push({setDependency:"choiceChildren",desiredValue:e.submittedIndices.includes(i+1),variableIndex:0,childIndex:a});return{success:!0,instructions:r}}},t.valueRecordedAtSubmit={isAlias:!0,targetVariableName:"submittedIndices"},t.feedbacks={public:!0,componentType:"feedbacktext",isArray:!0,entryPrefixes:["feedback"],entireArrayAtOnce:!0,returnDependencies:()=>({choiceOrder:{dependencyType:"stateVariable",variableName:"choiceOrder"},choiceChildren:{dependencyType:"child",childLogicName:"atLeastZeroChoices",variableNames:["feedbacks"]}}),entireArrayDefinition({dependencyValues:e}){let n=e.choiceOrder.map(i=>e.choiceChildren[i]),r=[];for(let i of n)r.push(...i.stateValues.feedbacks);return{newValues:{feedbacks:r}}}},t.childrenToRender={returnDependencies:()=>({choiceChildrenOrdered:{dependencyType:"stateVariable",variableName:"choiceChildrenOrdered"},inline:{dependencyType:"stateVariable",variableName:"inline"}}),definition:function({dependencyValues:e}){return e.inline?{newValues:{childrenToRender:[]}}:{newValues:{childrenToRender:e.choiceChildrenOrdered.map(n=>n.componentName)}}}},t}updateSelectedIndices({selectedIndices:t}){this.stateValues.disabled||this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"allSelectedIndices",value:t}],event:{verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:t,responseText:t.map(e=>this.stateValues.choiceTexts[e-1])}}})}},Zh=ko;var Fo=class extends Me{static componentType="choice";static rendererType="container";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.credit={default:0},e.feedbackCodes={default:[]},e.feedbackText={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroChildren",componentType:"_base",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.text={public:!0,componentType:this.componentType,returnDependencies:()=>({inlineChildren:{dependencyType:"child",childLogicName:"atLeastZeroChildren",variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let n="";for(let r of e.inlineChildren)typeof r.stateValues.text=="string"&&(n+=r.stateValues.text);return{newValues:{text:n}}}},t.selected={defaultValue:!1,public:!0,componentType:"boolean",returnDependencies:()=>({countAmongSiblings:{dependencyType:"countAmongSiblingsOfSameType"},childIndicesSelected:{dependencyType:"parentStateVariable",variableName:"childIndicesSelected"}}),definition({dependencyValues:e}){return{newValues:{selected:e.childIndicesSelected.includes(e.countAmongSiblings-1)}}},inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"selected",value:e.selected}]}}},t.submitted={defaultValue:!1,public:!0,componentType:"boolean",returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{submitted:{variablesToCheck:["submitted"]}}}),inverseDefinition:function({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"submitted",value:e.submitted}]}}},t.feedbacks={public:!0,componentType:"feedbacktext",isArray:!0,entireArrayAtOnce:!0,entryPrefixes:["feedback"],returnDependencies:()=>({feedbackText:{dependencyType:"stateVariable",variableName:"feedbackText"},feedbackCodes:{dependencyType:"stateVariable",variableName:"feedbackCodes"},feedbackDefinitions:{dependencyType:"parentStateVariable",variableName:"feedbackDefinitions"},submitted:{dependencyType:"stateVariable",variableName:"submitted"}}),entireArrayDefinition({dependencyValues:e}){if(!e.submitted)return{newValues:{feedbacks:[]}};let n=[];for(let r of e.feedbackCodes){let i=r.toLowerCase();for(let a of e.feedbackDefinitions)if(i===a.feedbackCode){n.push(a.feedbackText);break}}return e.feedbackText!==null&&n.push(e.feedbackText),{newValues:{feedbacks:n}}}},t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"atLeastZeroChildren"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t}static includeBlankStringChildren=!0;adapters=["submitted"]},Xh=Fo;var Bo=class extends We{static componentType="graph";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.xmin={default:-10,forRenderer:!0},e.xmax={default:10,forRenderer:!0},e.ymin={default:-10,forRenderer:!0},e.ymax={default:10,forRenderer:!0},e.width={default:300},e.height={default:300},e.displayXAxis={default:!0,forRenderer:!0},e.displayYAxis={default:!0,forRenderer:!0},e.xlabel={default:"",forRenderer:!0},e.ylabel={default:"",forRenderer:!0},e.showNavigation={default:!0,forRenderer:!0},e}static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){return n[0].state.value.includes(",")?{success:!1}:{success:!0,newChildren:[{componentType:"curve",children:n}]}};return t.push({childrenRegex:"s",replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroGraphical",componentType:"_graphical",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.graphicalDescendants={forRenderer:!0,returnDependencies:()=>({graphicalDescendants:{dependencyType:"descendant",componentTypes:["_graphical"]}}),definition:function({dependencyValues:e}){return{newValues:{graphicalDescendants:e.graphicalDescendants}}}},t.numericalWidth={forRenderer:!0,returnDependencies:()=>({width:{dependencyType:"stateVariable",variableName:"width"}}),definition:({dependencyValues:e})=>({newValues:{numericalWidth:parseInt(e.width)}})},t.numericalHeight={forRenderer:!0,returnDependencies:()=>({height:{dependencyType:"stateVariable",variableName:"height"}}),definition:({dependencyValues:e})=>({newValues:{numericalHeight:parseInt(e.height)}})},t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"atLeastZeroGraphical"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t}},Jh=Bo;var gO=De(Ee()),zo=class extends rr{static componentType="variables";static additionalStateVariablesForProperties=["validVariables"];static stateVariableForPropertyValue="variables";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();t.variables={public:!0,componentType:"variable",isArray:!0,entryPrefixes:["var"],returnArraySizeDependencies:()=>({nComponents:{dependencyType:"stateVariable",variableName:"nComponents"}}),returnArraySize({dependencyValues:n}){return[n.nComponents]},returnArrayDependenciesByKey({arrayKeys:n}){let r={};for(let i of n)r[i]={math:{dependencyType:"stateVariable",variableName:"math"+(Number(i)+1)}};return{dependenciesByKey:r}},arrayDefinitionByKey({dependencyValuesByKey:n,arrayKeys:r}){let i={};for(let a of r)i[a]=n[a].math;return{newValues:{variables:i}}}};let e=this.componentType;return t.validVariables={returnDependencies:()=>({variables:{dependencyType:"stateVariable",variableName:"variables"}}),definition:function({dependencyValues:n}){let r=[];for(let i of n.variables){let a=i.tree,s=!0;typeof a=="string"?a==="\uFF3F"&&(s=!1):(!Array.isArray(a)||a[0]!=="_"||typeof a[1]!="string"||typeof a[2]!="string"&&typeof a[2]!="number")&&(s=!1),s||(console.warn("Invalid value for "+e),s=!1),r.push(s)}return{newValues:{validVariables:r}}}},t}},Yh=zo;var pt=De(Ee());var qo=class extends Ue{static componentType="sequence";static acceptType=!0;static assignNamesToReplacements=!0;static get stateVariablesShadowedForReference(){return["specifiedFrom","specifiedTo","specifiedLength","specifiedStep","specifiedExclude"]}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneFrom",componentType:"from",comparison:"atMost",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"atMostOneTo",componentType:"to",comparison:"atMost",number:1,takePropertyChildren:!0}),i=e.newLeaf({name:"atMostOneStep",componentType:"step",comparison:"atMost",number:1,takePropertyChildren:!0}),a=e.newLeaf({name:"atMostOnelength",componentType:"length",comparison:"atMost",number:1,takePropertyChildren:!0}),s=e.newLeaf({name:"atMostOneExclude",componentType:"exclude",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"sequenceLogic",operator:"and",propositions:[n,r,i,a,s],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();t.type={returnDependencies:()=>({type:{dependencyType:"doenetAttribute",attributeName:"type"}}),definition:function({dependencyValues:n}){return n.type?{newValues:{type:n.type}}:{newValues:{type:"number"}}}},t.specifiedFrom={returnDependencies:()=>({fromChild:{dependencyType:"child",childLogicName:"atMostOneFrom",variableNames:["value"],requireChildLogicInitiallySatisfied:!0}}),defaultValue:null,definition:function({dependencyValues:n}){return n.fromChild.length===0?{useEssentialOrDefaultValue:{specifiedFrom:{variablesToCheck:["from","specifiedFrom"]}}}:n.fromChild[0].stateValues.value===null?{newValues:{specifiedFrom:NaN}}:{newValues:{specifiedFrom:n.fromChild[0].stateValues.value}}}},t.specifiedTo={returnDependencies:()=>({toChild:{dependencyType:"child",childLogicName:"atMostOneTo",variableNames:["value"],requireChildLogicInitiallySatisfied:!0}}),defaultValue:null,definition:function({dependencyValues:n}){return n.toChild.length===0?{useEssentialOrDefaultValue:{specifiedTo:{variablesToCheck:["to","specifiedTo"]}}}:n.toChild[0].stateValues.value===null?{newValues:{specifiedTo:NaN}}:{newValues:{specifiedTo:n.toChild[0].stateValues.value}}}},t.specifiedLength={returnDependencies:()=>({lengthChild:{dependencyType:"child",childLogicName:"atMostOnelength",variableNames:["value"],requireChildLogicInitiallySatisfied:!0}}),defaultValue:null,definition:function({dependencyValues:n}){return n.lengthChild.length===0?{useEssentialOrDefaultValue:{specifiedLength:{variablesToCheck:["length","specifiedLength"]}}}:n.lengthChild[0].stateValues.value===null?{newValues:{specifiedLength:NaN}}:{newValues:{specifiedLength:n.lengthChild[0].stateValues.value}}}},t.specifiedStep={returnDependencies:()=>({stepChild:{dependencyType:"child",childLogicName:"atMostOneStep",variableNames:["value"],requireChildLogicInitiallySatisfied:!0},type:{dependencyType:"stateVariable",variableName:"type"}}),defaultValue:null,definition:function({dependencyValues:n}){if(n.stepChild.length===0)return{useEssentialOrDefaultValue:{specifiedStep:{variablesToCheck:["step","specifiedStep"]}}};let r=n.stepChild[0].stateValues.value;return r===null?{newValues:{specifiedStep:NaN}}:{newValues:{specifiedStep:r}}}},t.specifiedExclude={returnDependencies:()=>({excludeChildren:{dependencyType:"child",childLogicName:"atMostOneExclude",variableNames:["values"],requireChildLogicInitiallySatisfied:!0}}),defaultValue:[],definition:function({dependencyValues:n}){return n.excludeChildren.length===0?{useEssentialOrDefaultValue:{specifiedExclude:{variablesToCheck:["exclude"]}}}:{newValues:{specifiedExclude:n.excludeChildren[0].stateValues.values}}}},t.lowercase={returnDependencies:()=>({specifiedTo:{dependencyType:"stateVariable",variableName:"specifiedTo"},specifiedFrom:{dependencyType:"stateVariable",variableName:"specifiedFrom"}}),definition:function({dependencyValues:n}){let r=/^[A-Z]*$/,i=!0;return n.specifiedFrom!==null?r.test(n.specifiedFrom)&&(i=!1):n.specifiedTo!==null&&r.test(n.specifiedTo)&&(i=!1),{newValues:{lowercase:i}}}},t.validSequence={returnDependencies:()=>({specifiedLength:{dependencyType:"stateVariable",variableName:"specifiedLength"},specifiedStep:{dependencyType:"stateVariable",variableName:"specifiedStep"},specifiedFrom:{dependencyType:"stateVariable",variableName:"specifiedFrom"},specifiedTo:{dependencyType:"stateVariable",variableName:"specifiedTo"},type:{dependencyType:"stateVariable",variableName:"type"},lowercase:{dependencyType:"stateVariable",variableName:"lowercase"}}),definition:function({dependencyValues:n}){let r=!0;if(n.specifiedLength!==null&&(!Number.isInteger(n.specifiedLength)||n.specifiedLength<0)&&(console.warn("Invalid length of sequence.  Must be a non-negative integer."),r=!1),n.specifiedStep!==null&&n.type!=="math"){let i=ht(n.specifiedStep);Number.isFinite(i)||(console.warn("Invalid step of sequence.  Must be a number for sequence of type "+n.type+"."),r=!1)}if(n.specifiedFrom!==null)if(n.type==="number"){let i=ht(n.specifiedFrom);Number.isFinite(i)||(console.warn("Invalid from of number sequence.  Must be a number"),r=!1)}else Number.isNaN(n.specifiedFrom)&&(console.warn("Invalid from of sequence"),r=!1);if(n.specifiedTo!==null)if(n.type==="number"){let i=ht(n.specifiedTo);Number.isFinite(i)||(console.warn("Invalid from of number sequence.  Must be a number"),r=!1)}else Number.isNaN(n.specifiedTo)&&(console.warn("Invalid to of sequence"),r=!1);return{newValues:{validSequence:r}}}};let e=this;return t.from={additionalStateVariablesDefined:["step","length","exclude"],returnDependencies:()=>({specifiedFrom:{dependencyType:"stateVariable",variableName:"specifiedFrom"},specifiedTo:{dependencyType:"stateVariable",variableName:"specifiedTo"},specifiedLength:{dependencyType:"stateVariable",variableName:"specifiedLength"},specifiedStep:{dependencyType:"stateVariable",variableName:"specifiedStep"},type:{dependencyType:"stateVariable",variableName:"type"},specifiedExclude:{dependencyType:"stateVariable",variableName:"specifiedExclude"},validSequence:{dependencyType:"stateVariable",variableName:"validSequence"}}),definition:function({dependencyValues:n}){let r=n.specifiedFrom,i=n.specifiedTo,a=n.specifiedStep,s=n.specifiedLength,o=[...n.specifiedExclude],u=n.type;if(n.type==="math")i!==null&&(i instanceof pt.default.class||(i=pt.default.fromAst(i))),r!==null&&(r instanceof pt.default.class||(r=pt.default.fromAst(r))),a!==null&&(a instanceof pt.default.class||(a=pt.default.fromAst(a)));else if(a!==null&&a instanceof pt.default.class&&(a=a.evaluate_to_constant()),n.type==="letters"){r!==null&&typeof r=="string"&&(r=Ir(r)),i!==null&&typeof i=="string"&&(i=Ir(i));for(let[c,f]of o.entries())typeof f=="string"&&(o[c]=Ir(f))}else if(n.type==="number"){i!==null&&(i instanceof pt.default.class?i=i.evaluate_to_constant():i=Number(i)),r!==null&&(r instanceof pt.default.class?r=r.evaluate_to_constant():r=Number(r));for(let[c,f]of o.entries())f instanceof pt.default.class?o[c]=f.evaluate_to_constant():o[c]=Number(f)}if(n.validSequence){let c=e.calculateSequenceParameters({from:r,to:i,step:a,length:s,type:u});return c.exclude=o,{newValues:c}}return(!Number.isInteger(s)||s<0)&&(s=0),{newValues:{from:r,step:a,length:s,exclude:o}}}},t.readyToExpand={returnDependencies:()=>({from:{dependencyType:"stateVariable",variableName:"from"},length:{dependencyType:"stateVariable",variableName:"length"},step:{dependencyType:"stateVariable",variableName:"step"},type:{dependencyType:"stateVariable",variableName:"type"},exclude:{dependencyType:"stateVariable",variableName:"exclude"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{newValues:{readyToExpand:!0}}}},t}static calculateSequenceParameters({from:t,to:e,step:n,length:r,type:i}){if(t===null)e===null?(i==="math"?t=pt.default.fromAst(1):t=1,n===null&&(i==="math"?n=pt.default.fromAst(1):n=1),r===null&&(r=10)):(n===null&&(i==="math"?n=pt.default.fromAst(1):n=1),r===null&&(i==="math"?r=Math.floor(e.subtract(1).divide(n).evaluate_to_constant()+1):r=Math.floor((e-1)/n+1)),i==="math"?t=e.subtract(n.multiply(r-1)).simplify():(t=e-n*(r-1),i==="letters"&&t<1&&(r=Math.floor((e-1)/n+1),t=e-n*(r-1))));else if(e===null)n===null&&(i==="math"?n=pt.default.fromAst(1):n=1),r===null&&(r=10);else if(n===null)r===null?i==="math"?(n=pt.default.fromAst(1),r=Math.floor(e.subtract(t).add(1).evaluate_to_constant())):(n=1,r=Math.floor(e-t+1)):i==="math"?n=e.subtract(t).divide(r-1):(n=(e-t)/(r-1),i==="letters"&&(n=Math.floor(n)));else if(r===null)i==="math"?r=Math.floor(e.subtract(t).divide(n).add(1).evaluate_to_constant()):r=Math.floor((e-t)/n+1);else throw Error("Can't define from, to, step, and length for sequence");return(!Number.isInteger(r)||r<0)&&(console.warn("Invalid length of sequence.  Must be a non-negative integer."),r=0),{from:t,step:n,length:r}}static createSerializedReplacements({component:t,workspace:e,componentInfoObjects:n}){if(t.stateValues.readyToExpand,!t.stateValues.validSequence)return e.lastReplacementParameters={from:null,length:null,step:null,type:null,exclude:null},{replacements:[]};e.lastReplacementParameters={from:t.stateValues.from,length:t.stateValues.length,step:t.stateValues.step,type:t.stateValues.type,exclude:t.stateValues.exclude};let r=[],i=t.stateValues.length;for(let s=0;s<i;s++){let o=t.stateValues.from;if(s>0&&(t.stateValues.type==="math"?o=o.add(t.stateValues.step.multiply(pt.default.fromAst(s))).expand().simplify():o+=t.stateValues.step*s),t.stateValues.type==="math"){if(t.stateValues.exclude.some(c=>c&&c.equals(o)))continue}else if(t.stateValues.exclude.includes(o))continue;t.stateValues.type==="letters"&&(o=Wr(o,t.stateValues.lowercase));let u={componentType:t.stateValues.type,state:{value:o,fixed:!0},downstreamDependencies:{[t.componentName]:[{dependencyType:"nonShadowingReplacement"}]}};r.push(u)}return{replacements:qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:r,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:n}).serializedComponents}}static calculateReplacementChanges({component:t,workspace:e,componentInfoObjects:n}){t.stateValues.readyToExpand;let r=e.lastReplacementParameters,i=[];if(!t.stateValues.validSequence){if(t.replacements.length>0){let a=t.replacements.length,s={changeType:"changeReplacementsToWithhold",replacementsToWithhold:a};i.push(s)}return r.length=0,i}if(r.type!==t.stateValues.type||r.exclude.length>0||t.stateValues.exclude.length>0){let a=this.createSerializedReplacements({component:t,workspace:e,componentInfoObjects:n}).replacements,s={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:a,replacementsToWithhold:0};i.push(s)}else{let a=!1;t.stateValues.type==="math"?t.stateValues.from.equals(r.from)&&t.stateValues.step.equals(r.step)||(a=!0):(t.stateValues.from!==r.from||t.stateValues.step!==r.step)&&(a=!0);let s=r.length,o=0,u=0,c=s,f;if(t.stateValues.length<s){f=t.replacements.length-t.stateValues.length;let p={changeType:"changeReplacementsToWithhold",replacementsToWithhold:f};i.push(p)}else if(t.stateValues.length>s&&(o=t.stateValues.length-s,t.replacementsToWithhold>0))if(t.replacementsToWithhold>=o){f=t.replacementsToWithhold-o,u+=o,s+=o,o=0;let p={changeType:"changeReplacementsToWithhold",replacementsToWithhold:f};i.push(p)}else o-=t.replacementsToWithhold,u+=t.replacementsToWithhold,s+=t.replacementsToWithhold,f=0;if(a===!0&&(u=s,c=0),u>0)for(let p=c;p<c+u;p++){let d=t.stateValues.from;p>0&&(t.stateValues.type==="math"?d=d.add(t.stateValues.step.multiply(pt.default.fromAst(p))).expand().simplify():d+=t.stateValues.step*p),t.stateValues.type==="letters"&&(d=Wr(d,t.stateValues.lowercase));let m={changeType:"updateStateVariables",component:t.replacements[p],stateChanges:{value:d}};i.push(m)}if(o>0){let p=[];for(let v=s;v<t.stateValues.length;v++){let h=t.stateValues.from;v>0&&(t.stateValues.type==="math"?h=h.add(t.stateValues.step.multiply(pt.default.fromAst(v))).expand().simplify():h+=t.stateValues.step*v),t.stateValues.type==="letters"&&(h=Wr(h,t.stateValues.lowercase));let y={componentType:t.stateValues.type,state:{value:h,fixed:!0},downstreamDependencies:{[t.componentName]:[{dependencyType:"nonShadowingReplacement"}]}};p.push(y)}let d=qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:p,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:n,indOffset:s}),m={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:s,serializedReplacements:d.serializedComponents,replacementsToWithhold:0,assignNamesOffset:s};i.push(m)}}return r.type=t.stateValues.type,r.from=t.stateValues.from,r.length=t.stateValues.length,r.step=t.stateValues.step,r.exclude=t.stateValues.exclude,i}get allPotentialRendererTypes(){return[this.componentInfoObjects.allComponentClasses[this.stateValues.type].rendererType]}},$n=qo;function Ir(l){l=l.toUpperCase();let t=0,e=l.length,n=e;for(;(n-=1)>-1;){let r=l.charCodeAt(n)-64;if(r<1||r>26){console.warn("Cannot convert "+l+" to a number");return}t+=r*Math.pow(26,e-1-n)}return t}function Wr(l,t){l--;let e=65;t&&(e=97);let n="";for(;;){let r=l%26;if(n=String.fromCharCode(e+r)+n,l<26)break;l=Math.floor(l/26)-1}return n}var jo=class extends Ue{static componentType="map";static assignNamesToReplacements=!0;static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.behavior={default:"combination",trim:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneTemplate",componentType:"template",number:1}),r=e.newLeaf({name:"atLeastOneSources",componentType:"sources",comparison:"atLeast",number:1});return e.newOperator({name:"templateSources",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nSources={additionalStateVariablesDefined:["sourcesNames","sourceAliases","sourceIndexAliases"],returnDependencies:()=>({sourcesChildren:{dependencyType:"child",childLogicName:"atLeastOneSources",variableNames:["alias","indexAlias"]}}),definition:function({dependencyValues:e}){return{newValues:{nSources:e.sourcesChildren.length,sourcesNames:e.sourcesChildren.map(n=>n.componentName),sourceAliases:e.sourcesChildren.map(n=>n.stateValues.alias),sourceIndexAliases:e.sourcesChildren.map(n=>n.stateValues.indexAlias)}}}},t.nIterates={additionalStateVariablesDefined:["minNIterates","sourcesChildNames"],returnDependencies:()=>({sourcesChildren:{dependencyType:"child",childLogicName:"atLeastOneSources",variableNames:["numberOfChildren","childComponentNames"]}}),definition:function({dependencyValues:e}){let n=e.sourcesChildren.map(a=>a.stateValues.numberOfChildren),r=Math.min(...n),i=e.sourcesChildren.map(a=>[...a.stateValues.childComponentNames]);return{newValues:{nIterates:n,minNIterates:r,sourcesChildNames:i}}}},t.template={returnDependencies:()=>({templateChild:{dependencyType:"child",childLogicName:"exactlyOneTemplate",variableNames:["serializedChildren","newNamespace"]}}),definition:function({dependencyValues:e}){let n=e.templateChild[0];if(!n)return{newValues:{template:null}};let r=n.stateValues.serializedChildren,i={componentType:"template",state:{rendered:!0},children:r,originalName:n.componentName};return n.stateValues.newNamespace&&(i.doenetAttributes={newNamespace:!0}),{newValues:{template:i}}}},t.validBehavior={returnDependencies:()=>({behavior:{dependencyType:"stateVariable",variableName:"behavior"},nIterates:{dependencyType:"stateVariable",variableName:"nIterates"}}),definition:function({dependencyValues:e}){let n=!0;return e.behavior==="parallel"?e.nIterates.slice(1).some(r=>r!=e.nIterates[0])&&console.warn("Warning: map with parallel behavior and different numbers of iterates in sources activeChildren. Extra iterates will be ignored."):e.behavior!=="combination"&&(console.warn("Invalid map behavior: "+e.behavior),n=!1),{newValues:{validBehavior:n}}}},t.readyToExpand={returnDependencies:()=>({validBehavior:{dependencyType:"stateVariable",variableName:"validBehavior"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{newValues:{readyToExpand:!0}}}},t}static createSerializedReplacements({component:t,workspace:e,componentInfoObjects:n}){if(t.stateValues.readyToExpand,!t.stateValues.validBehavior)return e.lastReplacementParameters={sourcesNames:[],sourcesChildNames:[],behavior:void 0,nIterates:void 0,minNIterates:void 0},{replacements:[]};e.lastReplacementParameters={sourcesNames:t.stateValues.sourcesNames,sourcesChildNames:t.stateValues.sourcesChildNames,behavior:t.stateValues.behavior,nIterates:t.stateValues.nIterates,minNIterates:t.stateValues.minNIterates,replacementsToWithhold:0,withheldSubstitutionChildNames:[]};let r=[];if(t.stateValues.behavior==="parallel")for(let i=0;i<t.stateValues.minNIterates;i++)r.push(...this.parallelReplacement({component:t,iter:i,componentInfoObjects:n}));else r=this.recurseThroughCombinations({component:t,sourcesNumber:0,iterateNumber:-1,componentInfoObjects:n}).replacements;return{replacements:r}}static parallelReplacement({component:t,iter:e,componentInfoObjects:n}){let r=[He(t.stateValues.template)];return r[0].downstreamDependencies={[t.componentName]:[{dependencyType:"nonShadowingReplacement"}]},r=qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:r,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:n,indOffset:e,addEmpties:!1}).serializedComponents,Qh(r[0],t,Array(t.stateValues.nSources).fill(e)),r}static recurseThroughCombinations({component:t,sourcesNumber:e,childnumberArray:n=[],iterateNumber:r,componentInfoObjects:i}){let a=[],s=[...n,0];for(let o=0;o<t.stateValues.nIterates[e];o++)if(s[e]=o,e>=t.stateValues.nSources-1){r++;let u=[He(t.stateValues.template)];u[0].downstreamDependencies={[t.componentName]:[{dependencyType:"nonShadowingReplacement"}]};let f=qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:u,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:i,indOffset:r,addEmpties:!1}).serializedComponents[0];Qh(f,t,s),a.push(f)}else{let u=this.recurseThroughCombinations({component:t,sourcesNumber:e+1,childnumberArray:s,iterateNumber:r,componentInfoObjects:i});a.push(...u.replacements),r=u.iterateNumber}return{replacements:a,iterateNumber:r}}static calculateReplacementChanges({component:t,components:e,workspace:n,componentInfoObjects:r}){t.stateValues.readyToExpand;let i=[];if(!t.stateValues.validBehavior){if(n.lastReplacementParameters={sourcesNames:[],sourcesChildNames:[],behavior:void 0,nIterates:void 0,minNIterates:void 0,replacementsToWithhold:0,withheldSubstitutionChildNames:[]},t.replacements.length>0){let v={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToDelete:t.replacements.length,replacementsToWithhold:0};i.push(v)}return i}let a=n.lastReplacementParameters,s=!1,o=!0;if(t.stateValues.nSources!==a.sourcesNames.length)o=!1;else for(let v=0;v<t.stateValues.nSources;v++)if(t.stateValues.sourcesNames[v]!==a.sourcesNames[v]){o=!1;break}if(!o||a.behavior!==t.stateValues.behavior)s=!0;else{let v=!0;if(a.nIterates===void 0)s=!0;else for(let h=0;h<t.stateValues.nSources;h++){let y=t.stateValues.nIterates[h],g=a.nIterates[h];y!==g&&(v=!1);let b=Math.min(y,g);for(let x=0;x<b;x++)if(t.stateValues.sourcesChildNames[h][x]!=a.sourcesChildNames[h][x]){s=!0,v=!1;break}if(s)break}if(v)return[];t.stateValues.behavior==="combination"&&t.stateValues.nSources>1&&(s=!0)}if(s){let v=this.createSerializedReplacements({component:t,workspace:n,componentInfoObjects:r}).replacements,h={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:v,replacementsToWithhold:0};return i.push(h),n.lastReplacementParameters={sourcesNames:t.stateValues.sourcesNames,sourcesChildNames:t.stateValues.sourcesChildNames,behavior:t.stateValues.behavior,nIterates:t.stateValues.nIterates,minNIterates:t.stateValues.minNIterates,replacementsToWithhold:0,withheldSubstitutionChildNames:[]},i}let u=t.stateValues.minNIterates,c=a.minNIterates,f=0,p=t.replacementsToWithhold;p||(p=0);let d=a.withheldSubstitutionChildNames,m=!1;if(u<c){for(let v=0;v<t.stateValues.nSources;v++)for(let h=u;h<c;h++)e[a.sourcesChildNames[v][h]]===void 0&&(m=!0);if(!m)for(let v of a.withheldSubstitutionChildNames)for(let h of v)e[h]===void 0&&(m=!0)}if(m){let v=Math.min(u,c),h=t.replacements.length-v,y={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:v,numberReplacementsToDelete:h,replacementsToWithhold:0};i.push(y),d=[],p=0}if(u<c){if(!m){f=t.replacements.length-u;let v={changeType:"changeReplacementsToWithhold",replacementsToWithhold:f};i.push(v);for(let h=0;h<t.stateValues.nSources;h++){let y=a.withheldSubstitutionChildNames[h];y?y=[...y]:y=[],y=new Set([...a.sourcesChildNames[h].slice(u),...y]),d[h]=y}}}else if(u>c){let v=u-c;if(p>0){let h=p;if(h>=v){f=p-v,v=0;let y={changeType:"changeReplacementsToWithhold",replacementsToWithhold:f};i.push(y)}else v-=h,c+=h,f=0}if(v>0){let h=[];for(let b=c;b<u;b++)h.push(...this.parallelReplacement({component:t,iter:b,componentInfoObjects:r}));let y=0;t.doenetAttributes.assignNames&&(y=t.doenetAttributes.assignNames.length);let g={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:c,serializedReplacements:h,replacementsToWithhold:0,assignNamesOffset:c};i.push(g)}}return n.lastReplacementParameters={sourcesNames:t.stateValues.sourcesNames,sourcesChildNames:t.stateValues.sourcesChildNames,behavior:t.stateValues.behavior,nIterates:t.stateValues.nIterates,minNIterates:u,replacementsToWithhold:f,withheldSubstitutionChildNames:d},i}static determineNumberOfUniqueVariants({serializedComponent:t}){return{success:!1}}get allPotentialRendererTypes(){let t=[];for(let e in this.allChildren){let n=this.allChildren[e].component;for(let r of n.allPotentialRendererTypes)t.includes(r)||t.push(r)}if(this.replacements)for(let e of this.replacements)for(let n of e.allPotentialRendererTypes)t.includes(n)||t.push(n);return t}},ev=jo;function Qh(l,t,e){let n=l.doenetAttributes.addToSharedParameters=[];for(let[r,i]of t.stateValues.sourceAliases.entries())if(i){let a=t.stateValues.sourcesNames[r];n.push({parameterName:"sourceNameMappings",key:i,value:{name:a,childNumber:e[r]}})}for(let[r,i]of t.stateValues.sourceIndexAliases.entries())i&&n.push({parameterName:"sourceIndexMappings",key:i,value:e[r]+1})}var Uo=class extends _e{static componentType="sources";static rendererType="container";static acceptAlias=!0;static acceptIndexAlias=!0;static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroChildren",componentType:"_base",excludeComponentTypes:["_composite"],comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.alias={returnDependencies:()=>({alias:{dependencyType:"doenetAttribute",attributeName:"alias"}}),definition({dependencyValues:e}){return{newValues:{alias:e.alias}}}},t.indexAlias={returnDependencies:()=>({indexAlias:{dependencyType:"doenetAttribute",attributeName:"indexAlias"}}),definition({dependencyValues:e}){return{newValues:{indexAlias:e.indexAlias}}}},t.numberOfChildren={additionalStateVariablesDefined:["childComponentNames","childIdentities"],returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"atLeastZeroChildren",requireChildLogicInitiallySatisfied:!0}}),definition:function({dependencyValues:e}){let n=e.children.length,r=e.children.map(i=>i.componentName);return{newValues:{numberOfChildren:n,childComponentNames:r,childIdentities:e.children}}}},t.childrenToRender={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"atLeastZeroChildren"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.children.map(n=>n.componentName)}}}},t}},tv=Uo;var Ho=class extends _e{constructor(t){super(t);this.changeValue=this.changeValue.bind(this),this.actions={changeValue:this.changeValue}}static componentType="slider";static variableForPlainMacro="value";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.width={default:300,forRenderer:!0},e.height={default:50,forRenderer:!0},e.initialNumber={default:void 0},e.initialText={default:void 0},e.label={default:void 0,forRenderer:!0},e.showControls={default:!1,forRenderer:!0},e.showTicks={default:!0,forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroNumbers",componentType:"number",comparison:"atLeast",number:0}),r=e.newLeaf({name:"atLeastOneTexts",componentType:"text",comparison:"atLeast",number:1}),i=e.newOperator({name:"numbersXorTextsXorSequence",operator:"xor",propositions:[r,n]}),a=e.newLeaf({name:"atMostOneMarkers",componentType:"markers",comparison:"atMost",number:1});return e.newOperator({name:"SliderLogic",operator:"and",propositions:[i,a],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.sliderType={forRenderer:!0,returnDependencies:()=>({textChildren:{dependencyType:"child",childLogicName:"atLeastOneTexts"},numberChildren:{dependencyType:"child",childLogicName:"atLeastZeroNumbers"}}),definition:function({dependencyValues:e}){let n;return e.textChildren.length>0?n="text":n="number",{newValues:{sliderType:n}}}},t.items={forRenderer:!0,public:!0,isArray:!0,entryPrefixes:["item"],entireArrayAtOnce:!0,returnDependencies:()=>({textChildren:{dependencyType:"child",childLogicName:"atLeastOneTexts",variableNames:["value"]},numberChildren:{dependencyType:"child",childLogicName:"atLeastZeroNumbers",variableNames:["value"]},sliderType:{dependencyType:"stateVariable",variableName:"sliderType"}}),entireArrayDefinition:function({dependencyValues:e}){let n;return e.sliderType==="text"?n=e.textChildren.map(r=>r.stateValues.value):e.numberChildren.length>0?(n=e.numberChildren.map(r=>r.stateValues.value),n.sort((r,i)=>r-i)):n=[...Array(11).keys()],{newValues:{items:n},setComponentType:{items:e.sliderType}}}},t.valueToIndex={forRenderer:!0,returnDependencies:()=>({items:{dependencyType:"stateVariable",variableName:"items"}}),definition:function({dependencyValues:e}){let n={};for(let[r,i]of e.items.entries())n[i]=r;return{newValues:{valueToIndex:n}}}},t.preliminaryValue={returnDependencies:()=>({sliderType:{dependencyType:"stateVariable",variableName:"sliderType"},initialNumber:{dependencyType:"stateVariable",variableName:"initialNumber"},initialText:{dependencyType:"stateVariable",variableName:"initialText"}}),definition({dependencyValues:e}){return{useEssentialOrDefaultValue:{preliminaryValue:{variablesToCheck:"value",get defaultValue(){return e.sliderType==="text"?e.initialText:e.initialNumber}}}}}},t.index={forRenderer:!0,returnDependencies:()=>({sliderType:{dependencyType:"stateVariable",variableName:"sliderType"},valueToIndex:{dependencyType:"stateVariable",variableName:"valueToIndex"},items:{dependencyType:"stateVariable",variableName:"items"},preliminaryValue:{dependencyType:"stateVariable",variableName:"preliminaryValue"}}),definition:function({dependencyValues:e}){let n=rv(e),r=0;return n!==void 0&&(r=e.valueToIndex[n]),{newValues:{index:r}}}},t.value={forRenderer:!0,public:!0,essential:!0,returnDependencies:()=>({sliderType:{dependencyType:"stateVariable",variableName:"sliderType"},items:{dependencyType:"stateVariable",variableName:"items"},index:{dependencyType:"stateVariable",variableName:"index"}}),definition:function({dependencyValues:e}){return{newValues:{value:e.items[e.index]},setComponentType:{value:e.sliderType}}},inverseDefinition:A1},t.markers={forRenderer:!0,returnDependencies:()=>({markersChild:{dependencyType:"child",childLogicName:"atMostOneMarkers",variableNames:["markerType","markers"]},sliderType:{dependencyType:"stateVariable",variableName:"sliderType"},items:{dependencyType:"stateVariable",variableName:"items"}}),definition:function({dependencyValues:e}){let n=[];if(e.markersChild.length===1){let r=e.markersChild[0].stateValues.markerType;r==="empty"?n=[...e.items]:r!==e.sliderType?(console.warn("Markers type doesn't match slider type."),n=[]):n=e.markersChild[0].stateValues.markers}return{newValues:{markers:n}}}},t}changeValue({value:t,transient:e}){this.stateValues.disabled||(e?this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:t}],transient:e}):this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"value",value:t}],event:{verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:t,responseText:t.toString()}}}))}},nv=Ho;function rv({preliminaryValue:l,valueToIndex:t,sliderType:e,items:n}){let r=l;if(t[r]!==void 0)return r;if(e==="text")return;let a=function(o=0,u=n.length-1){if(u<=o+1)return r>n[o]?u:o;let c=Math.round((u+o)/2);return r>n[c]?a(c,u):a(o,c)},s=a();if(s===0)r=n[0];else{let o=n[s-1],u=n[s],c=Math.abs(r-o),f=Math.abs(r-u);c<f?r=o:r=u}return r}function A1({desiredStateVariableValues:l,stateValues:t}){let e=rv({preliminaryValue:l.value,valueToIndex:t.valueToIndex,sliderType:t.sliderType,items:t.items});return e===void 0?{success:!1}:{success:!0,instructions:[{setStateVariable:"value",value:e},{setStateVariable:"preliminaryValue",value:e}]}}var Ko=class extends _e{static componentType="markers";static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastOneNumbers",componentType:"number",comparison:"atLeast",number:1}),r=e.newLeaf({name:"atLeastOneTexts",componentType:"text",comparison:"atLeast",number:1}),i=e.newLeaf({name:"noTexts",componentType:"text",comparison:"exactly",number:0,allowSpillover:!1}),a=e.newLeaf({name:"noNumbers",componentType:"number",comparison:"exactly",number:0,allowSpillover:!1}),s=e.newOperator({name:"noTextAndNoNumbers",operator:"and",propositions:[a,i]});return e.newOperator({name:"MarkerLogic",operator:"xor",propositions:[n,r,s],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.markerType={public:!0,componentType:"text",returnDependencies:()=>({textChildren:{dependencyType:"child",childLogicName:"atLeastOneTexts"},numberChildren:{dependencyType:"child",childLogicName:"atLeastOneNumbers"}}),definition:function({dependencyValues:e}){let n;return e.textChildren.length>0?n="text":e.numberChildren.length>0?n="number":n="empty",{newValues:{markerType:n}}}},t.markers={public:!0,isArray:!0,entryPrefixes:["item"],returnDependencies:()=>({markerType:{dependencyType:"stateVariable",variableName:"markerType"},textChildren:{dependencyType:"child",childLogicName:"atLeastOneTexts",variableNames:["value"]},numberChildren:{dependencyType:"child",childLogicName:"atLeastOneNumbers",variableNames:["value"]}}),definition:function({dependencyValues:e}){let n=[],r=e.markerType;return e.markerType==="text"?n=e.textChildren.map(i=>i.stateValues.value):e.markerType==="number"?(n=e.numberChildren.map(i=>i.stateValues.value),n.sort((i,a)=>i-a)):r="text",{newValues:{markers:n},setComponentType:{markers:r}}}},t}},iv=Ko;function Mr({variables:l,applyComponentConstraint:t}){let e={},n=!1;for(let r in l){let i=t({[r]:l[r]});i.constrained&&(n=!0,e[r]=i.variables[r])}return n?{constrained:n,variables:e}:{}}var Wo=class extends _e{static componentType="constraints";static rendererType=void 0;static createPropertiesObject(){return{}}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroConstraints",componentType:"_constraint",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({constraintChildren:{dependencyType:"child",childLogicName:"atLeastZeroConstraints",variableNames:["independentComponentConstraints"]}}),definition:({dependencyValues:e})=>({newValues:{independentComponentConstraints:e.constraintChildren.every(n=>n.stateValues.independentComponentConstraints)}})},t.arrayEntryPrefixForConstraints={returnDependencies:()=>({arrayEntryPrefixForConstraints:{dependencyType:"parentStateVariable",variableName:"arrayEntryPrefixForConstraints"}}),definition:({dependencyValues:e})=>({newValues:{arrayEntryPrefixForConstraints:e.arrayEntryPrefixForConstraints}})},t.arrayVariableForConstraints={returnDependencies:()=>({arrayVariableForConstraints:{dependencyType:"parentStateVariable",variableName:"arrayVariableForConstraints"}}),definition:({dependencyValues:e})=>({newValues:{arrayVariableForConstraints:e.arrayVariableForConstraints}})},t.nDimensions={returnDependencies:()=>({nDimensions:{dependencyType:"parentStateVariable",variableName:"nDimensionsForConstraints"}}),definition({dependencyValues:e}){return{newValues:{nDimensions:e.nDimensions}}}},t.constraintResults={additionalStateVariablesDefined:[{variableName:"constraintUsedByComponent",isArray:!0,entryPrefixes:["constraintUsedByComponent"]}],isArray:!0,entryPrefixes:["constraintResult"],stateVariablesDeterminingDependencies:["independentComponentConstraints","arrayEntryPrefixForConstraints","arrayVariableForConstraints"],returnArraySizeDependencies:()=>({nDimensions:{dependencyType:"stateVariable",variableName:"nDimensions"}}),returnArraySize({dependencyValues:e}){return[e.nDimensions]},returnArrayDependenciesByKey({arrayKeys:e,stateValues:n}){let r={constraintChildren:{dependencyType:"child",childLogicName:"atLeastZeroConstraints",variableNames:["applyConstraint","applyComponentConstraint"],variablesOptional:!0},independentComponentConstraints:{dependencyType:"stateVariable",variableName:"independentComponentConstraints"}},i=n.arrayEntryPrefixForConstraints,a={};if(n.independentComponentConstraints)for(let s of e)a[s]={x:{dependencyType:"parentStateVariable",variableName:i+(Number(s)+1)}};else{let s=n.arrayVariableForConstraints?n.arrayVariableForConstraints:"__null";r.xs={dependencyType:"parentStateVariable",variableName:s}}return{globalDependencies:r,dependenciesByKey:a}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){if(e.independentComponentConstraints){let i={},a={};for(let s of r){let o=Number(s)+1,u={["x"+o]:n[s].x},c=!1;for(let f of e.constraintChildren){let p=f.stateValues.applyComponentConstraint(u);p.constrained&&(u["x"+o]=p.variables["x"+o],c=!0)}i[s]=u["x"+o],a[s]=c}return{newValues:{constraintResults:i,constraintUsedByComponent:a}}}else{let i={},a=!1;for(let u in e.xs)i[`x${Number(u)+1}`]=e.xs[u];for(let u of e.constraintChildren){let c;u.stateValues.applyConstraint?c=u.stateValues.applyConstraint(i):c=Mr({variables:i,applyComponentConstraint:u.stateValues.applyComponentConstraint}),c.constrained&&(Object.assign(i,c.variables),a=!0)}let s={},o={};for(let u in e.xs)s[u]=i[`x${Number(u)+1}`],o[u]=a;return{newValues:{constraintResults:s,constraintUsedByComponent:o}}}},inverseArrayDefinitionByKey:function({desiredStateVariableValues:e,globalDependencyValues:n,dependencyValuesByKey:r,dependencyNamesByKey:i,stateValues:a,workspace:s}){if(n.independentComponentConstraints){let o=[];for(let u in e.constraintResults){let c=Number(u)+1,f={["x"+c]:nt(e.constraintResults[u])};for(let p of n.constraintChildren){let d=p.stateValues.applyComponentConstraint(f);d.constrained&&(f["x"+c]=d.variables["x"+c])}o.push({setDependency:i[u].x,desiredValue:f["x"+c]})}return{success:!0,instructions:o}}else{let o={};s.desiredConstraintResults||(s.desiredConstraintResults={}),Object.assign(s.desiredConstraintResults,e.constraintResults);for(let c in a.constraintResults){let f=Number(c)+1;c in s.desiredConstraintResults?o["x"+f]=nt(s.desiredConstraintResults[c]):o["x"+f]=nt(a.constraintResults[c])}for(let c of n.constraintChildren){let f;c.stateValues.applyConstraint?f=c.stateValues.applyConstraint(o):f=Mr({variables:o,applyComponentConstraint:c.stateValues.applyComponentConstraint}),f.constrained&&Object.assign(o,f.variables)}let u={};for(let c in s.desiredConstraintResults)u[c]=o[`x${Number(c)+1}`];return{success:!0,instructions:[{setDependency:"xs",desiredValue:u}]}}}},t.constraintUsed={public:!0,componentType:"boolean",returnDependencies:()=>({constraintUsedByComponent:{dependencyType:"stateVariable",variableName:"constraintUsedByComponent"}}),definition:function({dependencyValues:e}){return{newValues:{constraintUsed:Object.values(e.constraintUsedByComponent).some(r=>r)}}}},t}},av=Wo;var Go=class extends _e{static componentType="_constraint";static rendererType=void 0;static createPropertiesObject(){return{}}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({}),definition:()=>({newValues:{independentComponentConstraints:!1}})},t}},gt=Go;var Zo=class extends gt{static componentType="constraintogrid";static createPropertiesObject(){return{dx:{default:1},dy:{default:1},dz:{default:1},xoffset:{default:0},yoffset:{default:0},zoffset:{default:0}}}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneString",componentType:"string",comparison:"atMost",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({}),definition:()=>({newValues:{independentComponentConstraints:!0}})},t.applyComponentConstraint={returnDependencies:()=>({dx:{dependencyType:"stateVariable",variableName:"dx"},dy:{dependencyType:"stateVariable",variableName:"dy"},dz:{dependencyType:"stateVariable",variableName:"dz"},xoffset:{dependencyType:"stateVariable",variableName:"xoffset"},yoffset:{dependencyType:"stateVariable",variableName:"yoffset"},zoffset:{dependencyType:"stateVariable",variableName:"zoffset"}}),definition:({dependencyValues:e})=>({newValues:{applyComponentConstraint:function(n){if("x1"in n){let r=ht(n.x1);if(!Number.isFinite(r))return{};let i=e.dx,a=e.xoffset,s=Math.round((n.x1-a)/i)*i+a;return Number.isFinite(s)?{constrained:!0,variables:{x1:s}}:{}}if("x2"in n){let r=ht(n.x2);if(!Number.isFinite(r))return{};let i=e.dy,a=e.yoffset,s=Math.round((n.x2-a)/i)*i+a;return Number.isFinite(s)?{constrained:!0,variables:{x2:s}}:{}}if("x3"in n){let r=ht(n.x3);if(!Number.isFinite(r))return{};let i=e.dz,a=e.zoffset,s=Math.round((n.x3-a)/i)*i+a;return Number.isFinite(s)?{constrained:!0,variables:{x3:s}}:{}}return{}}}})},t}},sv=Zo;var Xo=class extends gt{static componentType="attracttogrid";static createPropertiesObject(){return{dx:{default:1},dy:{default:1},dz:{default:1},xoffset:{default:0},yoffset:{default:0},zoffset:{default:0},xthreshold:{default:.2},ythreshold:{default:.2},zthreshold:{default:.2},includeGridlines:{default:!1}}}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneString",componentType:"string",comparison:"atMost",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.independentComponentConstraints={returnDependencies:()=>({includeGridlines:{dependencyType:"stateVariable",variableName:"includeGridlines"}}),definition:({dependencyValues:e})=>({newValues:{independentComponentConstraints:e.includeGridlines}})},t.applyComponentConstraint={returnDependencies:()=>({dx:{dependencyType:"stateVariable",variableName:"dx"},dy:{dependencyType:"stateVariable",variableName:"dy"},dz:{dependencyType:"stateVariable",variableName:"dz"},xoffset:{dependencyType:"stateVariable",variableName:"xoffset"},yoffset:{dependencyType:"stateVariable",variableName:"yoffset"},zoffset:{dependencyType:"stateVariable",variableName:"zoffset"},xthreshold:{dependencyType:"stateVariable",variableName:"xthreshold"},ythreshold:{dependencyType:"stateVariable",variableName:"ythreshold"},zthreshold:{dependencyType:"stateVariable",variableName:"zthreshold"}}),definition:({dependencyValues:e})=>({newValues:{applyComponentConstraint:function(n){if("x1"in n){let r=ht(n.x1);if(!Number.isFinite(r))return{};let i=e.dx,a=e.xoffset,s=Math.round((n.x1-a)/i)*i+a;return Number.isFinite(s)&&Math.abs(n.x1-s)<e.xthreshold?{constrained:!0,variables:{x1:s}}:{}}if("x2"in n){let r=ht(n.x2);if(!Number.isFinite(r))return{};let i=e.dy,a=e.yoffset,s=Math.round((n.x2-a)/i)*i+a;return Number.isFinite(s)&&Math.abs(n.x2-s)<e.ythreshold?{constrained:!0,variables:{x2:s}}:{}}if("x3"in n){let r=ht(n.x3);if(!Number.isFinite(r))return{};let i=e.dz,a=e.zoffset,s=Math.round((n.x3-a)/i)*i+a;return Number.isFinite(s)&&Math.abs(n.x3-s)<e.zthreshold?{constrained:!0,variables:{x3:s}}:{}}return{}}}})},t.applyConstraint={returnDependencies:()=>({dx:{dependencyType:"stateVariable",variableName:"dx"},dy:{dependencyType:"stateVariable",variableName:"dy"},dz:{dependencyType:"stateVariable",variableName:"dz"},xoffset:{dependencyType:"stateVariable",variableName:"xoffset"},yoffset:{dependencyType:"stateVariable",variableName:"yoffset"},zoffset:{dependencyType:"stateVariable",variableName:"zoffset"},xthreshold:{dependencyType:"stateVariable",variableName:"xthreshold"},ythreshold:{dependencyType:"stateVariable",variableName:"ythreshold"},zthreshold:{dependencyType:"stateVariable",variableName:"zthreshold"},includeGridlines:{dependencyType:"stateVariable",variableName:"includeGridlines"},applyComponentConstraint:{dependencyType:"stateVariable",variableName:"applyComponentConstraint"}}),definition:({dependencyValues:e})=>({newValues:{applyConstraint:function(n){let r={},i=!1;for(let a in n){let s=e.applyComponentConstraint({[a]:n[a]});s.constrained&&(i=!0,r[a]=s.variables[a])}if(!i)return{};if(!e.includeGridlines){if(n.x1!==void 0&&r.x1===void 0)return{};if(n.x2!==void 0&&r.x2===void 0)return{};if(n.x3!==void 0&&r.x3===void 0)return{}}return{constrained:i,variables:r}}}})},t}},ov=Xo;var Jo=class extends gt{static componentType="constrainto";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastOneGraphical",componentType:"_graphical",comparison:"atLeast",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nearestPointFunctions={returnDependencies:()=>({graphicalChildren:{dependencyType:"child",childLogicName:"atLeastOneGraphical",variableNames:["nearestPoint"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let n=[];for(let r of e.graphicalChildren){if(!r.stateValues.nearestPoint){console.warn(`cannot attract to ${r.componentName} as it doesn't have a nearestPoint state variable`);continue}n.push(r.stateValues.nearestPoint)}return{newValues:{nearestPointFunctions:n}}}},t.applyConstraint={returnDependencies:()=>({nearestPointFunctions:{dependencyType:"stateVariable",variableName:"nearestPointFunctions"}}),definition:({dependencyValues:e})=>({newValues:{applyConstraint:function(n){let r=Infinity,i={},a=!1;for(let s of e.nearestPointFunctions){let o=s(n);if(o===void 0)continue;let u={},c=0;if(n.x1!==void 0){if(o.x1===void 0)continue;u.x1=o.x1,c+=Math.pow(n.x1-o.x1,2)}if(n.x2!==void 0){if(o.x2===void 0)continue;u.x2=o.x2,c+=Math.pow(n.x2-o.x2,2)}if(n.x3!==void 0){if(o.x3===void 0)continue;u.x3=o.x3,c+=Math.pow(n.x3-o.x3,2)}c<r&&(i=u,r=c,a=!0)}return a?{constrained:a,variables:i}:{}}}})},t}},lv=Jo;var Yo=class extends gt{static componentType="attractto";static createPropertiesObject(){return{threshold:{default:.5}}}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastOneGraphical",componentType:"_graphical",comparison:"atLeast",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nearestPointFunctions={returnDependencies:()=>({graphicalChildren:{dependencyType:"child",childLogicName:"atLeastOneGraphical",variableNames:["nearestPoint"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let n=[];for(let r of e.graphicalChildren){if(!r.stateValues.nearestPoint){console.warn(`cannot attract to ${r.componentName} as it doesn't have a nearestPoint state variable`);continue}n.push(r.stateValues.nearestPoint)}return{newValues:{nearestPointFunctions:n}}}},t.applyConstraint={returnDependencies:()=>({nearestPointFunctions:{dependencyType:"stateVariable",variableName:"nearestPointFunctions"},threshold:{dependencyType:"stateVariable",variableName:"threshold"}}),definition:({dependencyValues:e})=>({newValues:{applyConstraint:function(n){let r=Infinity,i={};for(let a of e.nearestPointFunctions){let s=a(n);if(s===void 0)continue;let o={},u=0;if(n.x1!==void 0){if(s.x1===void 0)continue;o.x1=s.x1,u+=Math.pow(n.x1-s.x1,2)}if(n.x2!==void 0){if(s.x2===void 0)continue;o.x2=s.x2,u+=Math.pow(n.x2-s.x2,2)}if(n.x3!==void 0){if(s.x3===void 0)continue;o.x3=s.x3,u+=Math.pow(n.x3-s.x3,2)}u<r&&(i=o,r=u)}return r>e.threshold*e.threshold?{}:{constrained:!0,variables:i}}}})},t}},uv=Yo;var Qo=class extends gt{static componentType="constraintunion";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastOneConstraint",componentType:"_constraint",comparison:"atLeast",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.applyConstraint={returnDependencies:()=>({constraintChildren:{dependencyType:"child",childLogicName:"atLeastOneConstraint",variableNames:["applyConstraint","applyComponentConstraint"],variablesOptional:!0}}),definition:({dependencyValues:e})=>({newValues:{applyConstraint:function(n){let r;if(e.constraintChildren.length===1){let o=e.constraintChildren[0];return o.stateValues.applyConstraint?r=o.stateValues.applyConstraint(n):r=Mr({variables:n,applyComponentConstraint:o.stateValues.applyComponentConstraint}),r}let i=Infinity,a={},s;for(let[o,u]of e.constraintChildren.entries()){if(u.stateValues.applyConstraint?r=u.stateValues.applyConstraint(n):r=Mr({variables:n,applyComponentConstraint:u.stateValues.applyComponentConstraint}),!r.constrained)continue;let c=0;for(let f in r.variables){let p=ht(n[f]),d=ht(r.variables[f]);if(!Number.isFinite(p)||!Number.isFinite(d)){c=Infinity;break}c+=Math.pow(p-d,2)}c<i&&(a=r,s=o+1,i=c)}return s===void 0?{}:(a.constraintIndices===void 0?a.constraintIndices=[s]:a.constraintIndices=[s,...a.constraintIndices],a)}}})},t}},cv=Qo;var el=class extends gt{static componentType="constrainttoattractor";static createPropertiesObject(){return{threshold:{default:.5}}}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"exactlyOneConstraint",componentType:"_constraint",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.applyConstraint={returnDependencies:()=>({constraintChild:{dependencyType:"child",childLogicName:"exactlyOneConstraint",variableNames:["applyConstraint","applyComponentConstraint"],variablesOptional:!0},independentComponentConstraints:{dependencyType:"stateVariable",variableName:"independentComponentConstraints"},threshold:{dependencyType:"stateVariable",variableName:"threshold"}}),definition:({dependencyValues:e})=>({newValues:{applyConstraint:function(n){let r,i=e.constraintChild[0];i.stateValues.applyConstraint?r=i.stateValues.applyConstraint(n):r=Mr({variables:n,applyComponentConstraint:i.stateValues.applyComponentConstraint});let a=0;for(let s in r.variables){let o=ht(n[s]),u=ht(r.variables[s]);if(!Number.isFinite(o)||!Number.isFinite(u))return{};a+=Math.pow(o-u,2)}return a>e.threshold*e.threshold?{}:r}}})},t}},fv=el;var pv=De(Ee()),tl=class extends Ue{static componentType="intersection";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroLines",componentType:"line",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.lineChildren={returnDependencies:()=>({lineChildren:{dependencyType:"child",childLogicName:"atLeastZeroLines",variableNames:["numericalCoeff0","numericalCoeffvar1","numericalCoeffvar2","nDimensions"]}}),definition:({dependencyValues:e})=>({newValues:{lineChildren:e.lineChildren}})},t.readyToExpand={returnDependencies:()=>({lineChildren:{dependencyType:"stateVariable",variableName:"lineChildren"}}),markStale:()=>({updateReplacements:!0}),definition:function(){return{newValues:{readyToExpand:!0}}}},t}static createSerializedReplacements({component:t,components:e}){t.stateValues.readyToExpand;let n=t.stateValues.lineChildren.length;if(n===0)return{replacements:[]};if(n===1){let h=t.stateValues.lineChildren[0].componentName,y=e[h].serialize({forCopy:!0});return y.state||(y.state={}),y.state.draggable=!1,y.state.fixed=!0,{replacements:Lt({serializedComponents:[y],componentName:t.componentName})}}if(n>2)return console.warn("Haven't implemented intersection for more than two objects"),{replacements:[]};let r=t.stateValues.lineChildren[0],i=t.stateValues.lineChildren[1];if(r.stateValues.nDimensions!==2||i.stateValues.nDimensions!==2)return console.log("Intersection of lines implemented only in 2D"),{replacements:[]};let a=r.stateValues.numericalCoeffvar1,s=r.stateValues.numericalCoeffvar2,o=r.stateValues.numericalCoeff0,u=i.stateValues.numericalCoeffvar1,c=i.stateValues.numericalCoeffvar2,f=i.stateValues.numericalCoeff0;if(!(Number.isFinite(a)&&Number.isFinite(s)&&Number.isFinite(o)&&Number.isFinite(u)&&Number.isFinite(c)&&Number.isFinite(f)))return console.log("Intersection of lines implemented only for constant coefficients"),{replacements:[]};let p=a*c-u*s;if(Math.abs(p)<1e-14){if(Math.abs(f*a-o*u)>1e-14)return{replacements:[]};if(a===0&&s===0&&o===0||u===0&&c===0&&f===0)return{replacements:[]};{let h=t.stateValues.lineChildren[0].componentName,y=e[h].serialize({forCopy:!0});return y.state||(y.state={}),y.state.draggable=!1,y.state.fixed=!0,{replacements:Lt({serializedComponents:[y],componentName:t.componentName})}}}let d=(f*s-o*c)/p,m=(o*u-f*a)/p,v=pv.default.fromAst(["vector",d,m]);return{replacements:[{componentType:"point",state:{coords:v,draggable:!1,fixed:!0},downstreamDependencies:{[t.componentName]:[{dependencyType:"nonShadowingReplacement"}]}}]}}static calculateReplacementChanges({component:t,components:e}){t.stateValues.readyToExpand;let n=[],r=this.createSerializedReplacements({component:t,components:e}).replacements,i=r.length,a=!0;if(i===t.replacements.length){a=!1;for(let o=0;o<i;o++){if(r[o].componentType!==t.replacements[o].componentType){a=!0;break}if(r[o].state===void 0){console.warn("No state by which to update intersection component, so recreating"),a=!0;break}let u={changeType:"updateStateVariables",component:t.replacements[o],stateChanges:r[o].state};n.push(u)}}return a===!1?n:[{changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:r}]}},dv=tl;var rl=class extends Me{constructor(t){super(t);this.updateValue=this.updateValue.bind(new Proxy(this,this.readOnlyProxyHandler)),this.actions={updateValue:this.updateValue}}static componentType="updatevalue";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.label={default:"update value",forRenderer:!0},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneMathTarget",componentType:"mathtarget",number:1}),r=e.newLeaf({name:"exactlyOneNewMathValue",componentType:"newmathvalue",number:1});return e.newOperator({name:"updateValueLogic",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.targetedMathName={returnDependencies:()=>({mathTarget:{dependencyType:"child",childLogicName:"exactlyOneMathTarget",variableNames:["mathChildName"]}}),definition:function({dependencyValues:e}){return{newValues:{targetedMathName:e.mathTarget[0].stateValues.mathChildName}}}},t.newMathValue={returnDependencies:()=>({newMathValueChild:{dependencyType:"child",childLogicName:"exactlyOneNewMathValue",variableNames:["value"]}}),definition:function({dependencyValues:e}){return{newValues:{newMathValue:e.newMathValueChild[0].stateValues.value}}}},t}updateValue({}){this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.stateValues.targetedMathName,stateVariable:"value",value:this.stateValues.newMathValue}],event:{verb:"selected",object:{componentName:this.componentName,componentType:this.componentType},result:{response:this.stateValues.newMathValue,responseText:this.stateValues.newMathValue.toString()}}})}},mv=rl;var nl=class extends _e{static componentType="mathtarget";static rendererType=void 0;static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"exactlyOneMath",componentType:"math",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.mathChildName={returnDependencies:()=>({mathChild:{dependencyType:"child",childLogicName:"exactlyOneMath"}}),definition:function({dependencyValues:e}){return{newValues:{mathChildName:e.mathChild[0].componentName}}}},t}},hv=nl;var il=class extends ke{static componentType="newmathvalue";static rendererType="math"},vv=il;var al=class extends Me{static componentType="panel";static rendererType="container";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.columns={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.breakpoints={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"anything",variableNames:["width"]},columns:{dependencyType:"stateVariable",variableName:"columns"}}),definition:function({dependencyValues:e}){let n=[],r=e.children.map(i=>i.stateValues.width);if(e.columns!==null){let i;if(e.columns.indexOf(",")!==-1)i=e.columns.split(",").map(Number);else if(e.columns.indexOf("-")!==-1){let[u,c]=e.columns.split("-");i=[];for(let f=Number(u);f<=c;f++)i.push(f)}else i=[Number(e.columns)];let a={},s={};for(let u of i){let c=[],f=0;for(let p=0;p<u;p++){let d=-1;for(let m=p;m<r.length;m=m+u)r[m]>d&&(d=r[m]);c.push(d),f=f+Number(d)}a[u]=c,s[u]=f}let o=-1;for(let u of i){let c=Number.POSITIVE_INFINITY,f=-1;for(let p of i)s[p]<=c&&p>o&&(c=s[p],f=p);c<Number.POSITIVE_INFINITY&&(n.push({breakpoint:c,possibleColumnNumbers:f,arrayOfWidths:a[f]}),o=f)}}return{newValues:{breakpoints:n}}}},t.childrenToRender={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"anything"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.children.map(n=>n.componentName)}}}},t}},yv=al;var sl=class extends gt{static componentType="constraintoangles";static returnChildLogic(t){let e=super.returnChildLogic(t),n=function({activeChildrenMatched:f}){let p=[];for(let d of f)p.push({createdComponent:!0,componentName:d.componentName});return{success:!0,newChildren:[{componentType:"angles",children:p}]}},r=e.newLeaf({name:"AtLeastOneAngle",componentType:"angle",comparison:"atLeast",number:1,isSugar:!0,replacementFunction:n}),i=e.newLeaf({name:"AtLeastOneString",componentType:"string",comparison:"atLeast",number:1}),a=e.newLeaf({name:"AtLeastOneMath",componentType:"math",comparison:"atLeast",number:1}),s=e.newOperator({name:"StringsAndMaths",operator:"or",propositions:[i,a],requireConsecutive:!0,isSugar:!0,replacementFunction:n}),o=e.newLeaf({name:"AtMostOneAngles",componentType:"angles",comparison:"atMost",number:1}),u=e.newOperator({name:"Angles",operator:"xor",propositions:[r,s,o],setAsBase:!0}),c=e.newLeaf({name:"AtMostOnePoint",componentType:"point",comparison:"atMost",number:1});return e.newOperator({name:"AnglesAndPoint",operator:"and",propositions:[u,c],setAsBase:!0}),e}updateState(t={}){if(super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.angles=!0,this.unresolvedState.offset=!0;return}let e=this.currentTracker.trackChanges,n=e.childrenChanged(this.componentName);if(n){let r=this.childLogic.returnMatches("AtMostOneAngles");r.length===1?this.state.anglesChild=this.activeChildren[r[0]]:(delete this.state.anglesChild,this.state.angles=[],delete this.unresolvedState.angles);let i=this.childLogic.returnMatches("AtMostOnePoint");i.length===1?this.state.pointChild=this.activeChildren[i[0]]:(delete this.state.pointChild,this.state.offset=[0,0,0],delete this.unresolvedState.offset)}if(this.state.anglesChild){if(this.state.anglesChild.unresolvedState.angles){this.unresolvedState.angles=!0;return}(n||e.getVariableChanges({component:this.state.anglesChild,variable:"angles"}))&&(delete this.unresolvedState.angles,this.state.angles=this.state.anglesChild.state.angles)}if(this.state.pointChild){if(this.state.pointChild.unresolvedState.xs){this.unresolvedState.offset=!0;return}if(n||e.getVariableChanges({component:this.state.pointChild,variable:"xs"})){delete this.unresolvedState.offset,this.state.offset=[];for(let r=0;r<this.state.pointChild.state.ndimensions;r++){let i=this.state.pointChild.state.xs[r].evaluate_to_constant();if(!Number.isFinite(i)){this.state.offset=NaN;break}this.state.offset.push(i)}}}}applyTheConstraint({x1:t,x2:e,x3:n,offset:r}){if(this.unresolvedState.angles||this.unresolvedState.offset)return{};if(t===void 0||e===void 0||n!==void 0)return{};if(t=this.findFiniteNumericalValue(t),e=this.findFiniteNumericalValue(e),!Number.isFinite(t)||!Number.isFinite(e))return{};if(r===void 0&&(r=this.state.offset),Number.isNaN(r))return{};let i=t-r[0],a=e-r[1],s=Math.atan2(a,i),o=Infinity,u,c;for(let[v,h]of this.state.angles.entries()){let y=h.state.angle.evaluate_to_constant();if(!Number.isFinite(y))continue;let g=Math.abs((y-s+Math.PI)%(2*Math.PI)-Math.PI);g<o&&(u=y,c=v,o=g)}if(u===void 0)return{};let f=Math.sqrt(i*i+a*a),p=r[0]+f*Math.cos(u),d=r[1]+f*Math.sin(u);return{variables:{x1:p,x2:d},constraintIndices:[c+1],constrained:!0}}},gv=sl;var ol=class extends gt{static componentType="attracttoangles";static createPropertiesObject(){return{threshold:{default:.3}}}static returnChildLogic(t){let e=super.returnChildLogic(t),n=function({activeChildrenMatched:f}){let p=[];for(let d of f)p.push({createdComponent:!0,componentName:d.componentName});return{success:!0,newChildren:[{componentType:"angles",children:p}]}},r=e.newLeaf({name:"AtLeastOneAngle",componentType:"angle",comparison:"atLeast",number:1,isSugar:!0,replacementFunction:n}),i=e.newLeaf({name:"AtLeastOneString",componentType:"string",comparison:"atLeast",number:1}),a=e.newLeaf({name:"AtLeastOneMath",componentType:"math",comparison:"atLeast",number:1}),s=e.newOperator({name:"StringsAndMaths",operator:"or",propositions:[i,a],requireConsecutive:!0,isSugar:!0,replacementFunction:n}),o=e.newLeaf({name:"AtMostOneAngles",componentType:"angles",comparison:"atMost",number:1}),u=e.newOperator({name:"Angles",operator:"xor",propositions:[r,s,o],setAsBase:!0}),c=e.newLeaf({name:"AtMostOnePoint",componentType:"point",comparison:"atMost",number:1});return e.newOperator({name:"AnglesAndPoint",operator:"and",propositions:[u,c],setAsBase:!0}),e}updateState(t={}){if(super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.angles=!0,this.unresolvedState.offset=!0;return}let e=this.currentTracker.trackChanges,n=e.childrenChanged(this.componentName);if(n){let r=this.childLogic.returnMatches("AtMostOneAngles");r.length===1?this.state.anglesChild=this.activeChildren[r[0]]:(delete this.state.anglesChild,this.state.angles=[],delete this.unresolvedState.angles);let i=this.childLogic.returnMatches("AtMostOnePoint");i.length===1?this.state.pointChild=this.activeChildren[i[0]]:(delete this.state.pointChild,this.state.offset=[0,0,0],delete this.unresolvedState.offset)}if(this.state.anglesChild){if(this.state.anglesChild.unresolvedState.angles){this.unresolvedState.angles=!0;return}(n||e.getVariableChanges({component:this.state.anglesChild,variable:"angles"}))&&(delete this.unresolvedState.angles,this.state.angles=this.state.anglesChild.state.angles)}if(this.state.pointChild){if(this.state.pointChild.unresolvedState.xs){this.unresolvedState.offset=!0;return}if(n||e.getVariableChanges({component:this.state.pointChild,variable:"xs"})){delete this.unresolvedState.offset,this.state.offset=[];for(let r=0;r<this.state.pointChild.state.ndimensions;r++){let i=this.state.pointChild.state.xs[r].evaluate_to_constant();if(!Number.isFinite(i)){this.state.offset=NaN;break}this.state.offset.push(i)}}}}applyTheConstraint({x1:t,x2:e,x3:n,offset:r}){if(this.unresolvedState.angles||this.unresolvedState.offset)return{};if(t===void 0||e===void 0||n!==void 0)return{};if(t=this.findFiniteNumericalValue(t),e=this.findFiniteNumericalValue(e),!Number.isFinite(t)||!Number.isFinite(e))return{};if(r===void 0&&(r=this.state.offset),Number.isNaN(r))return{};let i=t-r[0],a=e-r[1],s=Math.atan2(a,i),o=Infinity,u,c;for(let[h,y]of this.state.angles.entries()){let g=y.state.angle.evaluate_to_constant();if(!Number.isFinite(g))continue;let b=Math.abs((g-s+Math.PI)%(2*Math.PI)-Math.PI);b<o&&(u=g,c=h,o=b)}if(u===void 0)return{};let f=Math.sqrt(i*i+a*a),p=r[0]+f*Math.cos(u),d=r[1]+f*Math.sin(u);return Math.sqrt(Math.pow(p-t,2)+Math.pow(d-e,2))>=this.state.threshold?{}:{variables:{x1:p,x2:d},constraintIndices:[c+1],constrained:!0}}},bv=ol;var ll=class extends Ue{static componentType="conditionalcontent";static createPropertiesObject(){let t=super.createPropertiesObject();return delete t.hide,t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneCondition",componentType:"condition",comparison:"atMost",number:1,allowSpillover:!1}),r=e.newLeaf({name:"atLeastZeroAnything",componentType:"_base",comparison:"atLeast",number:0});return e.newOperator({name:"ifAndRest",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.hide={returnDependencies:()=>({conditionChild:{dependencyType:"child",childLogicName:"atMostOneCondition",variableNames:["value"]}}),definition:function({dependencyValues:e}){let n;return e.conditionChild.length===0?n=!0:n=!e.conditionChild[0].stateValues.value,{newValues:{hide:n}}}},t.readyToExpand={returnDependencies:()=>({hide:{dependencyType:"stateVariable",variableName:"hide"},anyChildren:{dependencyType:"child",childLogicName:"atLeastZeroAnything"},needsReplacementsUpdatedWhenStale:{dependencyType:"stateVariable",variableName:"needsReplacementsUpdatedWhenStale"}}),definition(){return{newValues:{readyToExpand:!0}}}},t.conditionName={returnDependencies:()=>({conditionChild:{dependencyType:"child",childLogicName:"atMostOneCondition"}}),definition:function({dependencyValues:e}){let n;return e.conditionChild.length===1&&(n=e.conditionChild[0].componentName),{newValues:{conditionName:n}}}},t.needsReplacementsUpdatedWhenStale={returnDependencies:()=>({hide:{dependencyType:"stateVariable",variableName:"hide"}}),markStale:()=>({updateReplacements:!0}),definition:()=>({newValues:{needsReplacementsUpdatedWhenStale:!0}})},t}static createSerializedReplacements({component:t,workspace:e}){if(t.stateValues.needsReplacementsUpdatedWhenStale,e.previouslyHidden=t.stateValues.hide,t.stateValues.hide)return{replacements:[]};let n=t.activeChildren.filter(r=>r.componentName!==t.stateValues.conditionName).map(r=>r.serialize({forCopy:!0}));return e.uniqueIdentifiersUsed||(e.uniqueIdentifiersUsed=[]),{replacements:Lt({serializedComponents:n,componentName:t.componentName,uniqueIdentifiersUsed:e.uniqueIdentifiersUsed})}}static calculateReplacementChanges({component:t,componentChanges:e,components:n,workspace:r}){if(t.stateValues.needsReplacementsUpdatedWhenStale,t.stateValues.hide){if(r.previouslyHidden)return[];{r.previouslyHidden=!0;let u=t.replacements.length;return[{changeType:"changeReplacementsToWithhold",replacementsToWithhold:u}]}}if(!r.previouslyHidden)return[];r.previouslyHidden=!1;let i=t.activeChildren.filter(u=>u.componentName!==t.stateValues.conditionName);if(t.replacements.length===i.length)return[{changeType:"changeReplacementsToWithhold",replacementsToWithhold:0}];let a=i.map(u=>u.serialize({forCopy:!0}));r.uniqueIdentifiersUsed||(r.uniqueIdentifiersUsed=[]);let s=Lt({serializedComponents:a,componentName:t.componentName,uniqueIdentifiersUsed:r.uniqueIdentifiersUsed});return[{changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,replacementsToWithhold:0,serializedReplacements:s}]}get allPotentialRendererTypes(){let t=[];for(let e in this.allChildren){let n=this.allChildren[e].component;for(let r of n.allPotentialRendererTypes)t.includes(r)||t.push(r)}return t}},xv=ll;var ul=class extends Me{static componentType="aslist";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroInline",componentType:"_inline",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"atLeastZeroInline",variableNames:["hidden"]}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.filter(n=>!n.stateValues.hidden).map(n=>n.componentName)}}}},t.text={public:!0,componentType:"text",returnDependencies:()=>({inlineChildren:{dependencyType:"child",childLogicName:"atLeastZeroInline",variableNames:["text"],variablesOptional:!0}}),definition:function({dependencyValues:e}){let n=[];for(let i of e.inlineChildren)typeof i.stateValues.text=="string"?n.push(i.stateValues.text):n.push("");return{newValues:{text:n.join(", ")}}}},t}},Cv=ul;var Nv=De(Ee());function st(l){if(l!==null&&l!==""){if(Number.isFinite(Number(l)))return Number(l)-1;if(typeof l=="string")return $1(l)}}function $1(l){l=l.toUpperCase();let t=0,e=l.length,n=e;for(;(n-=1)>-1;){let r=l.charCodeAt(n)-64;if(r<1||r>26){console.warn("Cannot convert "+l+" to a number");return}t+=r*Math.pow(26,e-1-n)}return t--,t}var cl=class extends _e{static componentType="table";static rendererType="table";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.width={default:"400px"},e.minNumRows={default:1},e.minNumColumns={default:1},e.height={forRenderer:!0,dependentStateVariables:[{dependencyName:"numRows",variableName:"numRows"}],definitionForPropertyValue({dependencyValues:n,propertyChild:r}){if(r.length===0){let i;return Number.isFinite(n.numRows)&&n.numRows>=0?i=50+n.numRows*20:i=130,{newValues:{height:i}}}return{newValues:{height:r[0].stateValues.value}}}},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"zeroOrMoreCells",componentType:"cell",comparison:"atLeast",number:0}),r=e.newLeaf({name:"zeroOrMoreRows",componentType:"row",comparison:"atLeast",number:0}),i=e.newLeaf({name:"zeroOrMoreColumns",componentType:"column",comparison:"atLeast",number:0}),a=e.newLeaf({name:"zeroOrMoreCellblocks",componentType:"cellblock",comparison:"atLeast",number:0});return e.newOperator({name:"cellsRowsColumnsBlocks",operator:"and",propositions:[n,r,i,a],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.cellNameToRowCol={additionalStateVariablesDefined:["cellNamesByRowCol"],returnDependencies:()=>({cellRelatedChildren:{dependencyType:"child",childLogicName:"cellsRowsColumnsBlocks",variableNames:["rowNum","colNum","prescribedCellsWithColNum","prescribedCellsWithRowNum","prescribedCellsRowsColumnsBlocks"],variablesOptional:!0}}),definition({dependencyValues:e,componentInfoObjects:n}){let r=wv({cellRelatedChildren:e.cellRelatedChildren,componentInfoObjects:n});return{newValues:{cellNameToRowCol:r.cellNameToRowCol,cellNamesByRowCol:r.cellNamesByRowCol}}}},t.numRows={public:!0,componentType:"number",returnDependencies:()=>({minNumRows:{dependencyType:"stateVariable",variableName:"minNumRows"},cellNamesByRowCol:{dependencyType:"stateVariable",variableName:"cellNamesByRowCol"}}),definition({dependencyValues:e}){let n=e.minNumRows;return Number.isFinite(n)||(n=4),n=Math.max(n,e.cellNamesByRowCol.length),{newValues:{numRows:n}}}},t.numColumns={public:!0,componentType:"number",returnDependencies:()=>({minNumColumns:{dependencyType:"stateVariable",variableName:"minNumColumns"},cellNamesByRowCol:{dependencyType:"stateVariable",variableName:"cellNamesByRowCol"}}),definition({dependencyValues:e}){let n=e.minNumColumns;Number.isFinite(n)||(n=4);for(let r of e.cellNamesByRowCol)r&&(n=Math.max(n,r.length));return{newValues:{numColumns:n}}}},t.cells={public:!0,componentType:"cell",isArray:!0,entryPrefixes:["cell","row","column","range"],nDimensions:2,returnArraySizeDependencies:()=>({numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),returnArraySize({dependencyValues:e}){return[e.numRows,e.numColumns]},returnEntryDimensions:e=>e==="range"?2:1,containsComponentNamesToCopy:!0,targetPropertiesToIgnoreOnCopy:["rowNum","colNum"],returnWrappingComponents(e){return e==="cell"?[]:e==="row"?[["row"]]:e===" col"?[["column"]]:[["row"],["cellblock"]]},getArrayKeysFromVarName({arrayEntryPrefix:e,varEnding:n,arraySize:r}){if(e==="cell"){let i,a,s=/^([a-zA-Z]+)([1-9]\d*)$/,o=n.match(s);if(o)a=o[1],i=o[2];else{let f=/^\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\)$/;if(o=n.match(f),o)i=o[1],a=o[2];else return[]}let u=st(i),c=st(a);return u>=0&&u<r[0]&&c>=0&&c<r[1]?[String(u)+","+String(c)]:[]}else if(e==="row"){let i=st(n);if(!(i>=0&&i<r[0]))return[];let a=[],s=String(i)+",";for(let o=0;o<r[1];o++)a.push(s+o);return a}else if(e==="column"){let i=st(n);if(!(i>=0&&i<r[1]))return[];let a=[],s=","+String(i);for(let o=0;o<r[1];o++)a.push(o+s);return a}else{let i,a,s,o,u=/^([a-zA-Z]+)([1-9]\d*)([a-zA-Z]+)([1-9]\d*)$/,c=n.match(u);if(c)a=st(c[1]),i=st(c[2]),o=st(c[3]),s=st(c[4]);else{let h=/^\(\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\),\(([a-zA-Z]+|\d+),([a-zA-Z]+|\d+)\)\)$/;if(c=n.match(h),c)i=st(c[1]),a=st(c[2]),s=st(c[3]),o=st(c[4]);else return[]}if(!(i>=0&&s>=0&&a>=0&&o>=0))return[];let f=Math.min(Math.min(i,s),r[0]-1),p=Math.min(Math.max(i,s),r[0]-1),d=Math.min(Math.min(a,o),r[1]-1),m=Math.min(Math.max(a,o),r[1]-1),v=[];for(let h=f;h<=p;h++){let y=[],g=String(h)+",";for(let b=d;b<=m;b++)y.push(g+b);v.push(y)}return v}},arrayVarNameFromArrayKey(e){return"cell("+e.split(",").map(n=>Number(n)+1).join(",")+")"},returnArrayDependenciesByKey(){return{globalDependencies:{cellNamesByRowCol:{dependencyType:"stateVariable",variableName:"cellNamesByRowCol"}}}},arrayDefinitionByKey({globalDependencyValues:e,arrayKeys:n}){let r={},i=e.cellNamesByRowCol;for(let a of n){let[s,o]=a.split(",");i[s]&&i[s][o]?r[a]=i[s][o]:r[a]=null}return{newValues:{cells:r}}}},t.childrenToRender={additionalStateVariablesDefined:[{variableName:"renderedChildNumberByRowCol",forRenderer:!0}],returnDependencies:()=>({cellNamesByRowCol:{dependencyType:"stateVariable",variableName:"cellNamesByRowCol"},numRows:{dependencyType:"stateVariable",variableName:"numRows"},numColumns:{dependencyType:"stateVariable",variableName:"numColumns"}}),definition:function({dependencyValues:e}){let n=[],r=[],i=0;for(let a=0;a<e.numRows;a++){let s=e.cellNamesByRowCol[a],o=[];if(s){for(let u of s)u?(n.push(u),o.push(i),i+=1):o.push(null);o.push(...Array(e.numColumns-s.length).fill(null))}else o=Array(e.numColumns).fill(null);r.push(o)}return{newValues:{childrenToRender:n,renderedChildNumberByRowCol:r}}}},t}addCell({cell:t,rowNum:e,colNum:n}){if(Array.isArray(this.state.cells[e])||(this.state.cells[e]=[]),Array.isArray(this.state.cellComponents[e])||(this.state.cellComponents[e]=[]),e<0)throw Error("RowNum position has to be 1 or greater");if(n<0)throw Error("ColNum position has to be 1 or greater");if(t.unresolvedState.text?this.unresolvedState.cells==null?this.unresolvedState.cells={isArray:!0,arrayComponents:{[[e,n]]:!0}}:this.unresolvedState.cells.arrayComponents[[e,n]]=!0:this.state.cells[e][n]=t.state.text,this.state.cellComponents[e][n]===void 0)this.state.cellComponents[e][n]=t;else throw Error(`Cell row ${e+1} column ${n+1} is already defined above.`);return this.state.cellNameToRowCol[t.componentName]={row:e,col:n},{rowNum:e,colNum:n}}getCellPoints(t,e){if(this.unresolvedState.points)return;if(this.state.pointsFoundInCells!==void 0)return this.state.pointsFoundInCells[e];this.currentTracker.trackChanges.logPotentialChange({component:this,variable:"points",oldValue:this.state.pointsFoundInCells}),this.state.pointsFoundInCells=[],this._state.pointsFoundInCells.indices=[];let n=this.state.numRows,r=this.state.numColumns;for(let i=0;i<r;i++)for(let a=0;a<n;a++){let s=this.state.cells[a][i];if(!s)continue;let o;try{o=Nv.default.fromText(s)}catch(u){continue}Array.isArray(o.tree)&&o.tree[0]==="tuple"&&(this.state.pointsFoundInCells.push(o),this._state.pointsFoundInCells.indices.push([a,i]))}return console.log("logging points change"),this.state.pointsFoundInCells[e]}},Zi=cl;function wv({cellRelatedChildren:l,rowOffset:t=0,colOffset:e=0,cellNameToRowCol:n={},cellNamesByRowCol:r=[],componentInfoObjects:i}){var a=t,s=e,o=e,u=t,c=e,f=t,p=e;for(let d of l)if(i.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"cell"})){let m=d,v=st(m.stateValues.rowNum),h=st(m.stateValues.colNum);v===void 0?(v=a,h===void 0?h=o:h=h+e):(v=v+t,h===void 0?h=s:h=h+e),fl({cell:m,rowIndex:v,colIndex:h,cellNameToRowCol:n,cellNamesByRowCol:r}),f=Math.max(v,f),p=Math.max(h,p),a=v,s=h,o=h+1}else if(i.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"row"})){let m=d,v=st(m.stateValues.rowNum);v===void 0?v=u:v=v+t;let h=m.stateValues.prescribedCellsWithColNum,y=e;for(let g of h){let b=st(g.stateValues.colNum);b===void 0?b=y:b=b+e,fl({cell:g,rowIndex:v,colIndex:b,cellNameToRowCol:n,cellNamesByRowCol:r}),y=b+1,f=Math.max(v,f),p=Math.max(b,p)}u=v+1,a=v+1,s=e,o=s}else if(i.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"column"})){let m=d,v=st(m.stateValues.colNum);v===void 0?v=c:v=v+e;let h=m.stateValues.prescribedCellsWithRowNum,y=t;for(let g of h){let b=st(g.stateValues.rowNum);b===void 0?b=y:b=b+t,fl({cell:g,rowIndex:b,colIndex:v,cellNameToRowCol:n,cellNamesByRowCol:r}),y=b+1,f=Math.max(b,f),p=Math.max(v,p)}c=v+1,a=t,s=v+1,o=s}else if(i.isInheritedComponentType({inheritedComponentType:d.componentType,baseComponentType:"cellblock"})){let m=d,v=st(m.stateValues.rowNum),h=st(m.stateValues.colNum);v===void 0?(v=a,h===void 0?h=o:h=h+e):(v=v+t,h===void 0?h=s:h=h+e);let y=wv({cellRelatedChildren:m.stateValues.prescribedCellsRowsColumnsBlocks,rowOffset:v,colOffset:h,cellNameToRowCol:n,cellNamesByRowCol:r,componentInfoObjects:i});f=Math.max(y.maxRowIndex,f),p=Math.max(y.maxColIndex,p),a=v,s=h,o=y.maxColIndex+1}return{maxRowIndex:f,maxColIndex:p,cellNameToRowCol:n,cellNamesByRowCol:r}}function fl({cell:l,rowIndex:t,colIndex:e,cellNameToRowCol:n,cellNamesByRowCol:r}){if(n[l.componentName]=[t,e],r[t]===void 0&&(r[t]=[]),r[t][e]!==void 0){console.warn(`Cell is overwriting previous cell at rowNum=${t+1}, colNum=${e+1}`);let i=r[t][e];n[i]=null}r[t][e]=l.componentName}var pl=class extends Zi{constructor(t){super(t);this.onChange=this.onChange.bind(this)}static componentType="spreadsheet";static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["cells"]}onChange(t,e){if(e!=="loadData"){let n={};for(let r of t){let[i,a,s,o]=r;this.state.cells[i][a]=s,n[[i,a]]=o}this.coreFunctions.requestUpdate({updateType:"updateValue",updateInstructions:[{componentName:this.componentName,variableUpdates:{cells:{isArray:!0,changes:{arrayComponents:n}}}}]})}}initializeRenderer({}){if(this.renderer!==void 0){this.updateRenderer();return}let t={onChange:this.onChange};this.renderer=new this.availableRenderers.spreadsheet({key:this.componentName,actions:t,cells:this.state.cells,width:this.state.width,height:this.state.height})}updateRenderer(){this.renderer.updateSpreadsheet({cells:this.state.cells,width:this.state.width,height:this.state.height})}},Tv=pl;var Xi=De(Ee()),dl=class extends _e{static componentType="cell";static rendererType="container";static primaryStateVariableForDefinition="placeholder";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.rowNum={default:null},e.colNum={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneMath",componentType:"math",number:1}),r=e.newLeaf({name:"nothingElse",componentType:"_base",number:0,allowSpillover:!1}),i=e.newOperator({name:"oneMathAndNothingElse",operator:"and",propositions:[n,r],requireConsecutive:!0}),a=e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0});return e.newOperator({name:"mathXorAnything",operator:"xor",propositions:[i,a],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.onlyMathChild={returnDependencies:()=>({mathChild:{dependencyType:"child",childLogicName:"oneMathAndNothingElse"}}),definition:({dependencyValues:e})=>({newValues:{onlyMathChild:e.mathChild.length===1}})},t.text={public:!0,componentType:"text",defaultValue:"",returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"mathXorAnything",variableNames:["text"],variablesOptional:!0}}),definition({dependencyValues:e}){if(e.children.length===0)return{useEssentialOrDefaultValue:{text:{variablesToCheck:["text"]}}};let n="";for(let r of e.children)r.stateValues.text&&(n+=r.stateValues.text);return{newValues:{text:n}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){return n.children.length===0?{success:!0,instructions:[{setStateVariable:"text",value:e.text}]}:n.children.length===1?n.children[0].stateValues.text===void 0?{success:!1}:{success:!0,instructions:[{setDependency:"children",desiredValue:e.text,childIndex:0,variableIndex:0}]}:{success:!1}}},t.math={public:!0,componentType:"math",stateVariablesDeterminingDependencies:["onlyMathChild"],returnDependencies({stateValues:e}){return e.onlyMathChild?{mathChild:{dependencyType:"child",childLogicName:"oneMathAndNothingElse",variableNames:["value"]}}:{text:{dependencyType:"stateVariable",variableName:"text"}}},definition({dependencyValues:e}){if(e.mathChild)return{newValues:{math:e.mathChild[0].stateValues.value}};{let n;try{n=Xi.default.fromText(e.text)}catch(r){n=Xi.default.fromAst("\uFF3F")}return{newValues:{math:n}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){return n.mathChild?{success:!0,instructions:[{setDependency:"mathChild",desiredValue:e.math,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setDependency:"text",desiredValue:e.math.toString()}]}}},t.number={public:!0,componentType:"number",returnDependencies:()=>({math:{dependencyType:"stateVariable",variableName:"math"}}),definition({dependencyValues:e}){let n=e.math.evaluate_to_constant();return Number.isFinite(n)||(n=NaN),{newValues:{number:n}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setDependency:"math",desiredValue:Xi.default.fromAst(e.number)}]}}},t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"mathXorAnything"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t.placeholder={returnDependencies:()=>({}),definition:()=>({newValues:{placeholder:null}})},t}adapters=["text","math","number"]},_v=dl;var ml=class extends _e{static componentType="row";static rendererType="container";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.rowNum={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroCells",componentType:"cell",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.prescribedCellsWithColNum={returnDependencies:()=>({cellChildren:{dependencyType:"child",childLogicName:"atLeastZeroCells",variableNames:["colNum"]}}),definition({dependencyValues:e}){return{newValues:{prescribedCellsWithColNum:e.cellChildren}}}},t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"atLeastZeroCells"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t}},Av=ml;var hl=class extends _e{static componentType="column";static rendererType="container";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.colNum={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroCells",componentType:"cell",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.prescribedCellsWithRowNum={returnDependencies:()=>({cellChildren:{dependencyType:"child",childLogicName:"atLeastZeroCells",variableNames:["rowNum"]}}),definition({dependencyValues:e}){return{newValues:{prescribedCellsWithRowNum:e.cellChildren}}}},t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"atLeastZeroCells"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t}},$v=hl;var vl=class extends _e{static componentType="cellblock";static rendererType="container";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.rowNum={default:null},e.colNum={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"zeroOrMoreCells",componentType:"cell",comparison:"atLeast",number:0}),r=e.newLeaf({name:"zeroOrMoreRows",componentType:"row",comparison:"atLeast",number:0}),i=e.newLeaf({name:"zeroOrMoreColumns",componentType:"column",comparison:"atLeast",number:0}),a=e.newLeaf({name:"zeroOrMoreCellblocks",componentType:"cellblock",comparison:"atLeast",number:0});return e.newOperator({name:"cellsRowsColumnsBlocks",operator:"and",propositions:[n,r,i,a],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.prescribedCellsRowsColumnsBlocks={returnDependencies:()=>({cellRelatedChildren:{dependencyType:"child",childLogicName:"cellsRowsColumnsBlocks",variableNames:["rowNum","colNum","prescribedCellsWithColNum","prescribedCellsWithRowNum","prescribedCellsRowsColumnsBlocks"],variablesOptional:!0}}),definition({dependencyValues:e}){return{newValues:{prescribedCellsRowsColumnsBlocks:e.cellRelatedChildren}}}},t}},Sv=vl;var yl=class extends Me{static componentType="seeds";static rendererType=void 0;static returnSugarInstructions(){let t=super.returnSugarInstructions(),e=function({matchedChildren:n}){let r=n.reduce(function(i,a){return a.componentType==="string"?[...i,...a.state.value.split(/\s+/).filter(s=>s).map(s=>({componentType:"seed",state:{value:s}}))]:[...i,a]},[]);return{success:!0,newChildren:r}};return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroSeeds",componentType:"seed",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nSeeds={public:!0,componentType:"number",returnDependencies:()=>({seedChildren:{dependencyType:"child",childLogicName:"atLeastZeroSeeds"}}),definition:function({dependencyValues:e}){return{newValues:{nSeeds:e.seedChildren.length}}}},t.seeds={public:!0,componentType:"seed",isArray:!0,entryPrefixes:["seed"],returnArraySizeDependencies:()=>({nSeeds:{dependencyType:"stateVariable",variableName:"nSeeds"}}),returnArraySize({dependencyValues:e}){return[e.nSeeds]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n[r]={seedChild:{dependencyType:"child",childLogicName:"atLeastZeroSeeds",variableNames:["value"],childIndices:[r]}};return{dependenciesByKey:n}},arrayDefinitionByKey:function({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n)e[i].seedChild.length===1&&(r[i]=e[i].seedChild[0].stateValues.value);return{newValues:{seeds:r}}}},t}},Dv=yl;var gl=class extends _e{static componentType="variantcontrol";static rendererType=void 0;static createsVariants=!0;static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.nVariants={default:100},e.uniqueVariants={default:!1},delete e.variants,e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneSeeds",componentType:"seeds",comparison:"atMost",number:1,takePropertyChildren:!0}),r=e.newLeaf({name:"atMostOneVariants",componentType:"variants",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"seedsAndVariants",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nVariantsSpecified={returnDependencies:({sharedParameters:e})=>({uniqueVariants:{dependencyType:"stateVariable",variableName:"uniqueVariants"},numberOfVariantsFromSharedParameters:{dependencyType:"value",value:e.numberOfVariantsFromSharedParameters},nVariants:{dependencyType:"stateVariable",variableName:"nVariants"}}),definition:function({dependencyValues:e}){let n=e.nVariants;return n<1&&(n=1),e.uniqueVariants&&(e.numberOfVariantsFromSharedParameters!==void 0?n=e.numberOfVariantsFromSharedParameters:console.log("Restricting to unique variants was not successful")),{newValues:{nVariantsSpecified:n}}}},t.nSeeds={public:!0,componentType:"number",returnDependencies:()=>({seedsChild:{dependencyType:"child",childLogicName:"atMostOneSeeds",variableNames:["nSeeds"]}}),definition:function({dependencyValues:e}){return e.seedsChild.length===1?{newValues:{nSeeds:e.seedsChild[0].stateValues.nSeeds}}:{newValues:{nSeeds:0}}}},t.seeds={public:!0,componentType:"seed",isArray:!0,entryPrefixes:["seed"],returnArraySizeDependencies:()=>({nSeeds:{dependencyType:"stateVariable",variableName:"nSeeds"}}),returnArraySize({dependencyValues:e}){return[e.nSeeds]},returnArrayDependenciesByKey({arrayKeys:e}){let n={};for(let r of e)n[r]={seedsChild:{dependencyType:"child",childLogicName:"atMostOneSeeds",variableNames:["seed"+(Number(r)+1)]}};return{dependenciesByKey:n}},arrayDefinitionByKey:function({dependencyValuesByKey:e,arrayKeys:n}){let r={};for(let i of n)e[i].seedsChild.length===1&&(r[i]=e[i].seedsChild[0].stateValues["seed"+(Number(i)+1)]);return{newValues:{seeds:r}}}},t.originalVariants={returnDependencies:()=>({variantsChild:{dependencyType:"child",childLogicName:"atMostOneVariants",variableNames:["variants"]}}),definition:function({dependencyValues:e}){let n=[];return e.variantsChild.length===1&&(n=e.variantsChild[0].stateValues.variants),{newValues:{originalVariants:n}}}},t.variants={public:!0,componentType:"variant",isArray:!0,entryPrefixes:["variant"],returnArraySizeDependencies:()=>({nVariantsSpecified:{dependencyType:"stateVariable",variableName:"nVariantsSpecified"}}),returnArraySize({dependencyValues:e}){return[e.nVariantsSpecified]},returnArrayDependenciesByKey({arrayKeys:e}){return{globalDependencies:{originalVariants:{dependencyType:"stateVariable",variableName:"originalVariants"},nVariantsSpecified:{dependencyType:"stateVariable",variableName:"nVariantsSpecified"}}}},arrayDefinitionByKey:function({globalDependencyValues:e,arrayKeys:n}){let r=[...e.originalVariants],i=r.length,a=i-1,s;for(;i<e.nVariantsSpecified;){for(i++,a++,s=Vv(a);e.originalVariants.includes(s);)a++,s=Vv(a);r.push(s)}return{newValues:{variants:r}}}},t.selectedVariantNumber={public:!0,componentType:"number",immutable:!0,returnDependencies:({sharedParameters:e})=>({variantsObject:{dependencyType:"variants"},originalVariants:{dependencyType:"stateVariable",variableName:"originalVariants"},variants:{dependencyType:"stateVariable",variableName:"variants"},nVariantsSpecified:{dependencyType:"stateVariable",variableName:"nVariantsSpecified"},hashStringToInteger:{dependencyType:"value",value:e.hashStringToInteger},selectRng:{dependencyType:"value",value:e.selectRng,doNotProxy:!0}}),definition:function({dependencyValues:e}){if(e.variantsObject!==void 0){if(e.variantsObject.desiredVariantNumber!==void 0){let i=Number(e.variantsObject.desiredVariantNumber);if(Number.isInteger(i)){let a=i%e.nVariantsSpecified;return a<0&&(a+=e.nVariantsSpecified),{makeEssential:["selectedVariantNumber"],newValues:{selectedVariantNumber:a}}}else throw Error("Variant number "+e.variantsObject.desiredVariantNumber+" must be an integer")}if(e.variantsObject.desiredVariant!==void 0){if(typeof e.variantsObject.desiredVariant=="string"){let a=e.originalVariants.map(u=>u.toLowerCase()),o=[...a,...e.variants.slice(a.length)].indexOf(e.variantsObject.desiredVariant.toLowerCase());if(o!==-1)return{makeEssential:["selectedVariantNumber"],newValues:{selectedVariantNumber:o}}}console.log("Variant "+e.variantsObject.desiredVariant+" is not valid, convert to variant index");let i=Math.abs(e.hashStringToInteger(JSON.stringify(e.variantsObject.desiredVariant))%e.nVariantsSpecified);return{makeEssential:["selectedVariantNumber"],newValues:{selectedVariantNumber:i}}}}let n=e.selectRng.random(),r=Math.floor(n*e.nVariantsSpecified);return{makeEssential:["selectedVariantNumber"],newValues:{selectedVariantNumber:r}}}},t.selectedVariant={public:!0,componentType:"text",returnDependencies:()=>({variants:{dependencyType:"stateVariable",variableName:"variants"},selectedVariantNumber:{dependencyType:"stateVariable",variableName:"selectedVariantNumber"}}),definition:function({dependencyValues:e}){return{newValues:{selectedVariant:e.variants[e.selectedVariantNumber]}}}},t.selectedSeed={returnDependencies:()=>({selectedVariantNumber:{dependencyType:"stateVariable",variableName:"selectedVariantNumber"},seeds:{dependencyType:"stateVariable",variableName:"seeds"}}),definition:function({dependencyValues:e}){if(e.selectedVariantNumber<e.seeds.length)return{newValues:{selectedSeed:e.seeds[e.selectedVariantNumber]}};let n=e.seeds.length-1,r=n+1,i;for(;n<e.selectedVariantNumber;)for(n++,r++,i=r.toString();e.seeds.includes(i);)r++,i=r.toString();return{newValues:{selectedSeed:i}}}},t.convertedSeed={returnDependencies:({sharedParameters:e})=>({selectedSeed:{dependencyType:"stateVariable",variableName:"selectedSeed"},hashStringToInteger:{dependencyType:"value",value:e.hashStringToInteger}}),definition:({dependencyValues:e})=>({newValues:{convertedSeed:e.hashStringToInteger(e.selectedSeed)}})},t.selectRng={returnDependencies:({sharedParameters:e})=>({convertedSeed:{dependencyType:"stateVariable",variableName:"convertedSeed"},rngClass:{dependencyType:"value",value:e.rngClass,doNotProxy:!0}}),definition:({dependencyValues:e})=>({newValues:{selectRng:new e.rngClass(e.convertedSeed)}})},t}},Iv=gl;function Vv(l){let t="";for(;;){let e=l%26;if(t=String.fromCharCode(97+e)+t,l<26)break;l=Math.floor(l/26)-1}return t}var Sn=De(Ee());var bl=class extends $n{static componentType="selectfromsequence";static assignNamesToReplacements=!0;static createsVariants=!0;static get stateVariablesShadowedForReference(){return[...super.stateVariablesShadowedForReference,"excludedCombinations"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.numberToSelect={default:1},e.withReplacement={default:!1},e.sortResults={default:!1},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.baseLogic,r=e.newLeaf({name:"atMostOneExcludeCombinations",componentType:"excludecombinations",comparison:"atMost",number:1,takePropertyChildren:!0});return e.newOperator({name:"selectFromSequenceLogic",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();t.excludedCombinations={returnDependencies:()=>({excludeCombinationsChild:{dependencyType:"child",childLogicName:"atMostOneExcludeCombinations",variableNames:["lists"]}}),definition:function({dependencyValues:n}){return n.excludeCombinationsChild.length===1?{newValues:{excludedCombinations:n.excludeCombinationsChild[0].stateValues.lists}}:{newValues:{excludedCombinations:[]}}}},t.variants={returnDependencies:()=>({variants:{dependencyType:"variants"}}),definition:function({dependencyValues:n}){return{newValues:{variants:n.variants}}}},t.selectedValues={immutable:!0,additionalStateVariablesDefined:["selectedIndices"],returnDependencies:({sharedParameters:n})=>({numberToSelect:{dependencyType:"stateVariable",variableName:"numberToSelect"},withReplacement:{dependencyType:"stateVariable",variableName:"withReplacement"},length:{dependencyType:"stateVariable",variableName:"length"},from:{dependencyType:"stateVariable",variableName:"from"},step:{dependencyType:"stateVariable",variableName:"step"},exclude:{dependencyType:"stateVariable",variableName:"exclude"},excludedCombinations:{dependencyType:"stateVariable",variableName:"excludedCombinations"},type:{dependencyType:"stateVariable",variableName:"type"},lowercase:{dependencyType:"stateVariable",variableName:"lowercase"},sortResults:{dependencyType:"stateVariable",variableName:"sortResults"},variants:{dependencyType:"stateVariable",variableName:"variants"},selectRng:{dependencyType:"value",value:n.selectRng,doNotProxy:!0}}),definition:S1},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({newValues:{isVariantComponent:!0}})},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({newValues:{isVariantComponent:!0}})},t.selectedVariantInfo={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),definition({dependencyValues:n}){return{newValues:{selectedVariantInfo:{indices:n.selectedIndices}}}}};let e=t.readyToExpand.returnDependencies;return t.readyToExpand.returnDependencies=function(){let n=e();return n.selectedValues={dependencyType:"stateVariable",variableName:"selectedValues"},n},t}static createSerializedReplacements({component:t,componentInfoObjects:e}){let n=[];for(let i of t.stateValues.selectedValues){let a={value:i};t.stateValues.hide&&(a.hide=!0),n.push({componentType:t.stateValues.type,state:a})}return{replacements:qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:n,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:e}).serializedComponents}}static calculateReplacementChanges(){return[]}static determineNumberOfUniqueVariants({serializedComponent:t}){let e=1,n=!1;if(t.state!==void 0&&(t.state.numberToSelect!==void 0&&(e=t.state.numberToSelect),t.state.withReplacement!==void 0&&(n=t.state.withReplacement),t.state.type!==void 0&&(sequenceType=t.state.type)),t.children===void 0)return{succes:!1};let r,i={},a=[];for(let f of t.children){let p=f.componentType;if(p==="numberToSelect"){let d=!1;if(f.state!==void 0&&f.state.value!==void 0&&(e=Math.round(Number(f.state.value)),d=!0),f.children!==void 0){for(let m of f.children)if(m.componentType==="string"){e=Math.round(Number(m.state.value)),d=!0;break}}if(!d)return{success:!1}}else if(p==="withReplacement"){let d=!1;if(f.state!==void 0&&(f.state.implicitValue!==void 0&&(n=f.state.implicitValue,d=!0),f.state.value!==void 0&&(n=f.state.value,d=!0)),f.children!==void 0){for(let m of f.children)if(m.componentType==="string"){d=!0,m.state.value.trim().toLowerCase()==="true"?n=!0:n=!1;break}}if(!d)return{success:!1}}else if(["type","to","from","step","length"].includes(p)){let d=!1;if(f.state!==void 0&&f.state.value!==void 0&&(i[p]=f.state.value,d=!0),f.children!==void 0){for(let m of f.children)if(m.componentType==="string"){i[p]=m.state.value,d=!0;break}}if(!d)return{success:!1}}else if(p==="exclude"){let d=!1;if(f.children!==void 0){for(let m of f.children)if(m.componentType==="string"){d=!0;let v=m.state.value.split(",").map(h=>h.trim());a.push(...v);break}}if(!d)return{success:!1}}else p==="string"&&(r=f)}if(r!==void 0){if(i.to!==void 0||i.from!==void 0)return{success:!1};let f=r.state.value.split(",");if(f.length===1)i.to=f[0].trim();else if(f.length===2)i.from=f[0].trim(),i.to=f[1].trim();else return{success:!1}}for(let f of["to","from","step"])if(i[f]!==void 0){if(i.type==="math"){if(typeof i[f]=="string")i[f]=Sn.default.fromText(i[f]);else if(i[f].tree===void 0)return{success:!1}}else if(i.type==="letters"&&f!=="step"){if(i[f]=Ir(i[f]),i[f]===void 0)return{success:!1}}else if(i[f]=Number(i[f]),!Number.isFinite(i[f]))return{success:!1}}if(i.length!==void 0&&(typeof i.length=="string"&&(i.length=Number(i.length)),!Number.isInteger(i.length)||i.length<0))return{success:!1};for(let[f,p]of a.entries()){if(i.type==="math"){if(typeof p=="string")p=Sn.default.fromText(p);else if(p.tree===void 0)return{success:!1}}else if(i.type==="letters"&&par!=="step"){if(p=Ir(p),p===void 0)return{success:!1}}else if(p=Number(p),!Number.isFinite(p))return{success:!1};a[f]=p}this.calculateSequenceParameters(i);let s=i.length,o=[];if(a.length>0&&i.type!==math){a.sort(),a=a.filter((f,p,d)=>f!=d[p-1]);for(let f of a){if(f<i.from)continue;let p=(f-i.from)/i.step;if(p>i.length-1+1e-10)break;Math.abs(p-Math.round(p))<1e-10&&(s--,o.push(p))}}if(s<=0)return{success:!1};let u={excludeIndices:o,nOptions:s,numberToSelect:e,withReplacement:n};if(n||e===1){let f=Math.pow(s,e);return{success:!0,numberOfVariants:f,uniqueVariantData:u}}let c=s;for(let f=s-1;f>s-e;f--)c*=f;return{success:!0,numberOfVariants:c,uniqueVariantData:u}}static getUniqueVariant({serializedComponent:t,variantNumber:e}){if(t.variants===void 0)return{succes:!1};let n=t.variants.numberOfVariants;if(n===void 0)return{success:!1};if(!Number.isInteger(e)||e<0||e>=n)return{success:!1};let r=t.variants.uniqueVariantData,i=r.excludeIndices,a=r.nOptions,s=r.numberToSelect,o=r.withReplacement,u=function(p){let d=p;for(let m of i)d===m&&d++;return d};if(s===1)return{success:!0,desiredVariant:{indices:[u(e)]}};let f=ti({numberOfIndices:s,numberOfOptions:a,maxNumber:e+1,withReplacement:o})[e].map(u);return{success:!0,desiredVariant:{indices:f}}}},Or=bl;function S1({dependencyValues:l}){if(l.numberToSelect<1)return{makeEssential:["selectedValues","selectedIndices"],newValues:{selectedValues:[],selectedIndices:[]}};let t=1;if(l.withReplacement||(t=l.numberToSelect),t>l.length)throw Error("Cannot select "+t+" values from a sequence of length "+l.length);if(l.variants&&l.variants.desiredVariant!==void 0){let i=l.variants.desiredVariant.indices;if(i!==void 0){if(i.length!==l.numberToSelect)throw Error("Number of indices specified for select must match number to select");if(i=i.map(Number),!i.every(Number.isInteger))throw Error("All indices specified for select must be integers");let a=l.length;i=i.map(u=>(u%a+a)%a);let s=!0,o=[];for(let u of i){let c=l.from;if(u>0&&(l.type==="math"?c=c.add(l.step.multiply(Sn.default.fromAst(u))).expand().simplify():c+=l.step*u),l.type==="letters"&&(c=Wr(c,l.lowercase)),l.type==="math"){if(l.exclude.some(p=>p.equals(c)))throw Error("Specified index of selectfromsequence that was excluded")}else if(l.exclude.includes(c))throw Error("Specified index of selectfromsequence that was excluded");let f=!1;l.type==="math"?l.excludedCombinations.some(p=>[p,u].equals(c))&&(f=!0):l.excludedCombinations.some(p=>p[u]===c)&&(f=!0),f||(s=!1),o.push(c)}if(s)throw Error("Specified indices of selectfromsequence that was an excluded combination");return{makeEssential:["selectedValues","selectedIndices"],newValues:{selectedValues:o,selectedIndices:i}}}}let e=l.excludedCombinations.length,n,r;if(e===0){let i=Mv({stateValues:l,numberUniqueRequired:t,numberToSelect:l.numberToSelect,withReplacement:l.withReplacement,rng:l.selectRng});n=i.selectedValues,r=i.selectedIndices}else{let i=l.length-l.exclude.length;if(l.withReplacement)i=Math.pow(i,l.numberToSelect);else{let s=i;for(let o=1;o<l.numberToSelect;o++)i*=s-o}if(e>.7*i)throw Error("Excluded over 70% of combinations in selectFromSequence");let a=!1;for(let s=0;s<200;s++){let o=Mv({stateValues:l,numberUniqueRequired:t,numberToSelect:l.numberToSelect,withReplacement:l.withReplacement,rng:l.selectRng});if(n=o.selectedValues,r=o.selectedIndices,l.type==="math"){if(l.excludedCombinations.some(u=>u.every((c,f)=>c.equals(n[f]))))continue}else if(l.excludedCombinations.some(u=>u.every((c,f)=>c===n[f])))continue;a=!0;break}if(!a)throw Error("By extremely unlikely fluke, couldn't select combination of random values")}if(l.sortResults){let i=[];for(let[a,s]of n.entries())i.push({value:s,index:r[a]});l.type==="number"?i.sort((a,s)=>a.value-s.value):l.type==="letters"&&i.sort((a,s)=>Ir(a.value)-Ir(s.value)),n=i.map(a=>a.value),r=i.map(a=>a.index)}return{makeEssential:["selectedValues","selectedIndices"],newValues:{selectedValues:n,selectedIndices:r}}}function Mv({stateValues:l,numberUniqueRequired:t=1,numberToSelect:e=1,withReplacement:n=!1,rng:r}){let i=[],a=[];if(l.exclude.length+t<.5*l.length){for(let c=0;c<e;c++){let f=!1,p,d;for(let m=0;m<100;m++){let v=r.random();if(d=Math.floor(v*l.length),!(!n&&a.includes(d))){if(p=l.from,d>0&&(l.type==="math"?p=p.add(l.step.multiply(Sn.default.fromAst(d))).expand().simplify():p+=l.step*d),l.type==="math"){if(l.exclude.some(h=>h.equals(p)))continue}else if(l.exclude.includes(p))continue;f=!0;break}}if(!f)throw Error("By extremely unlikely fluke, couldn't select random value");l.type==="letters"&&(p=Wr(p,l.lowercase)),i.push(p),a.push(d)}return{selectedValues:i,selectedIndices:a}}let s=[];for(let c=0;c<l.length;c++){let f=l.from;if(c>0&&(l.type==="math"?f=f.add(l.step.multiply(Sn.default.fromAst(c))).expand().simplify():f+=l.step*c),l.type==="math"){if(l.exclude.some(p=>p.equals(f)))continue}else if(l.exclude.includes(f))continue;l.type==="letters"&&(f=Wr(f,l.lowercase)),s.push(f)}let o=s.length;if(t>o)throw Error("Cannot select "+t+" unique values from sequence of length "+o);if(t===1){for(let c=0;c<e;c++){let f=r.random(),p=Math.floor(f*o);a.push(p),i.push(s[p])}return{selectedValues:i,selectedIndices:a}}let u=[...Array(s.length).keys()];for(let c=s.length-1;c>0;c--){let f=r.random(),p=Math.floor(f*(c+1));[s[c],s[p]]=[s[p],s[c]],[u[c],u[p]]=[u[p],u[c]]}return i=s.slice(0,e),a=u.slice(0,e),{selectedValues:i,selectedIndices:a}}var Ov=De(Ee()),xl=class extends Ue{static componentType="select";static assignNamesToReplacements=!0;static createsVariants=!0;static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["selectedIndices"]}static acceptType=!0;static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.numberToSelect={default:1},e.withReplacement={default:!1},e}static returnSugarInstructions(){let t=super.returnSugarInstructions();function e({matchedChildren:n,componentProps:r}){let i;r.type?i=r.type:i="math",["math","text","number"].includes(i)||(console.warn(`Invalid type ${i}`),i="math");let a=n.reduce(function(s,o){return o.componentType==="string"?[...s,...o.state.value.split(/\s+/).filter(u=>u).map(u=>i==="math"?Ov.default.fromText(u):i==="number"?Number(u):u).map(u=>({componentType:"option",children:[{componentType:i,state:{value:u}}]}))]:[...s,o]},[]);return{success:!0,newChildren:a}}return t.push({replacementFunction:e}),t}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastZeroOptions",componentType:"option",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.variants={returnDependencies:()=>({variants:{dependencyType:"variants"}}),definition:function({dependencyValues:e}){return{newValues:{variants:e.variants}}}},t.currentVariantName={returnDependencies:({sharedParameters:e})=>({variant:{dependencyType:"value",value:e.variant}}),definition:({dependencyValues:e})=>({newValues:{currentVariantName:e.variant}})},t.allPossibleVariants={returnDependencies:({sharedParameters:e})=>({allPossibleVariants:{dependencyType:"value",value:e.allPossibleVariants}}),definition:({dependencyValues:e})=>({newValues:{allPossibleVariants:e.allPossibleVariants}})},t.nOptions={additionalStateVariablesDefined:["optionChildren"],returnDependencies:()=>({optionChildren:{dependencyType:"child",childLogicName:"atLeastZeroOptions",variableNames:["selectForVariants","selectWeight"]}}),definition({dependencyValues:e}){return{newValues:{optionChildren:e.optionChildren,nOptions:e.optionChildren.length}}}},t.availableVariants={returnDependencies:()=>({optionChildren:{dependencyType:"stateVariable",variableName:"optionChildren"},numberToSelect:{dependencyType:"stateVariable",variableName:"numberToSelect"},allPossibleVariants:{dependencyType:"stateVariable",variableName:"allPossibleVariants"}}),definition:function({dependencyValues:e}){let n={};for(let[r,i]of e.optionChildren.entries())for(let a of i.stateValues.selectForVariants){let s=a.toLowerCase();n[s]===void 0&&(n[s]=[]),n[s].push(r)}for(let r in n)if(n[r].length!==e.numberToSelect)throw Error("Invalid variant for select.  Variant "+r+" appears in "+n[r].length+" options but number to select is "+numberToSelect);if(Object.keys(n).length>0){for(let r of e.allPossibleVariants)if(!(r in n))throw Error("Some variants are specified for select but no options are specified for possible variant: "+r);for(let r in n)if(!e.allPossibleVariants.includes(r))throw Error("Variant "+r+" that is specified for select is not a possible variant.")}return{newValues:{availableVariants:n}}}},t.selectedIndices={returnDependencies:({sharedParameters:e})=>({numberToSelect:{dependencyType:"stateVariable",variableName:"numberToSelect"},withReplacement:{dependencyType:"stateVariable",variableName:"withReplacement"},optionChildren:{dependencyType:"stateVariable",variableName:"optionChildren"},nOptions:{dependencyType:"stateVariable",variableName:"nOptions"},currentVariantName:{dependencyType:"stateVariable",variableName:"currentVariantName"},variants:{dependencyType:"stateVariable",variableName:"variants"},availableVariants:{dependencyType:"stateVariable",variableName:"availableVariants"},selectRng:{dependencyType:"value",value:e.selectRng,doNotProxy:!0}}),definition:function({dependencyValues:e}){if(e.numberToSelect<1||e.nOptions===0)return{makeEssential:["selectedIndices"],newValues:{selectedIndices:[]},makeImmutable:["selectedIndices"]};if(Number.isNaN(e.numberToSelect))return{newValues:{selectedIndices:null}};if(e.variants&&e.variants.desiredVariant!==void 0){let c=e.variants.desiredVariant.indices;if(c!==void 0){if(c.length!==e.numberToSelect)throw Error("Number of indices specified for select must match number to select");if(c=c.map(Number),!c.every(Number.isInteger))throw Error("All indices specified for select must be integers");let f=e.nOptions;return c=c.map(p=>(p%f+f)%f),{makeEssential:["selectedIndices"],newValues:{selectedIndices:c},makeImmutable:["selectedIndices"]}}}let n=e.availableVariants[e.currentVariantName];if(n!==void 0){if(e.numberToSelect>1){n=[...n];for(let c=e.numberToSelect-1;c>0;c--){let f=e.selectRng.random(),p=Math.floor(f*(c+1));[n[c],n[p]]=[n[p],n[c]]}}return{makeEssential:["selectedIndices"],newValues:{selectedIndices:n},makeImmutable:["selectedIndices"]}}let r=[],i=1;if(e.withReplacement||(i=e.numberToSelect),i>e.nOptions)throw Error("Cannot select "+i+" components from only "+e.nOptions);let a=e.optionChildren.map(c=>c.stateValues.selectWeight),s=a.reduce((c,f)=>c+f);a=a.map(c=>c/s);let o=a.reduce((c,f,p)=>[...c,f+(c[p-1]||0)],[]),u=[...Array(o.length).keys()];for(let c=0;c<e.numberToSelect;c++){let f=e.selectRng.random(),p=-1,d=o.length-1;for(;p<d-1;){let v=Math.floor((p+d)/2);o[v]>f?d=v:p=v}let m=u[d];r.push(m),!e.withReplacement&&c<e.numberToSelect-1&&(a.splice(d,1),u.splice(d,1),s=a.reduce((v,h)=>v+h),a=a.map(v=>v/s),o=a.reduce((v,h,y)=>[...v,h+(v[y-1]||0)],[]))}return{makeEssential:["selectedIndices"],newValues:{selectedIndices:r},makeImmutable:["selectedIndices"]}}},t.isVariantComponent={returnDependencies:()=>({}),definition:()=>({newValues:{isVariantComponent:!0}})},t.selectedVariantInfo={returnDependencies:({componentInfoObjects:e})=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"},variantDescendants:{dependencyType:"descendant",componentTypes:Object.keys(e.componentTypeWithPotentialVariants),variableNames:["isVariantComponent","selectedVariantInfo"],useReplacementsForComposites:!0,recurseToMatchedChildren:!1,variablesOptional:!0,includeNonActiveChildren:!0,ignoreReplacementsOfMatchedComposites:!0,definingChildrenFirst:!0}}),definition({dependencyValues:e}){let n={indices:e.selectedIndices},r=n.subvariants=[];for(let i of e.variantDescendants)i.stateValues.isVariantComponent?r.push(i.stateValues.selectedVariantInfo):i.stateValues.selectedVariantInfo&&r.push(...i.stateValues.selectedVariantInfo.subvariants);return{newValues:{selectedVariantInfo:n}}}},t.readyToExpand={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),definition:function({dependencyValues:e}){return{newValues:{readyToExpand:e.selectedIndices!==null}}}},t}static createSerializedReplacements({component:t,components:e,componentInfoObjects:n}){let r=[];for(let a of t.stateValues.selectedIndices){let s=t.stateValues.optionChildren[a].componentName,o=e[s],u=He(o.state.serializedChildren.value),c={componentType:"option",state:{rendered:!0},doenetAttributes:Object.assign({},o.doenetAttributes),children:u,originalName:s};o.variants&&(c.variants=He(o.variants)),t.stateValues.hide&&(c.state||(c.state={}),c.state.hide=!0),r.push(c)}if(t.variants&&t.variants.desiredVariant!==void 0){let a=t.variants.desiredVariant;if(a!==void 0&&a.subvariants!==void 0&&t.variants.descendantVariantComponents!==void 0){let s=[];for(let o of r)o.variants!==void 0&&(o.variants.isVariantComponent?s.push(o):o.variants.descendantVariantComponents&&s.push(...o.variants.descendantVariantComponents));for(let o in a.subvariants){let u=a.subvariants[o],c=s[o];if(c===void 0)break;c.variants.desiredVariant=u}}}return{replacements:qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:r,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:n}).serializedComponents}}static calculateReplacementChanges(){return[]}static determineNumberOfUniqueVariants({serializedComponent:t}){let e=1,n=!1,r=[],i=[];if(t.state!==void 0&&(t.state.numberToSelect!==void 0&&(e=t.state.numberToSelect),t.state.withReplacement!==void 0&&(n=t.state.withReplacement)),t.children===void 0)return{succes:!1};let a;for(let p of t.children){let d=p.componentType;if(d==="numberToSelect"){let m=!1;if(p.state!==void 0&&p.state.value!==void 0&&(e=Math.round(Number(p.state.value)),m=!0),p.children!==void 0){for(let v of p.children)if(v.componentType==="string"){e=Math.round(Number(v.state.value)),m=!0;break}}if(!m)return{success:!1}}else if(d==="withReplacement"){let m=!1;if(p.state!==void 0&&(p.state.implicitValue!==void 0&&(n=p.state.implicitValue,m=!0),p.state.value!==void 0&&(n=p.state.value,m=!0)),p.children!==void 0){for(let v of p.children)if(v.componentType==="string"){m=!0,v.state.value.trim().toLowerCase()==="true"?n=!0:n=!1;break}}if(!m)return{success:!1}}else{if(d==="selectWeight")return{succes:!1};if(d!=="hide"&&d!=="modifyIndirectly"){d==="string"&&(a=p);let m=1;p.variants!==void 0&&p.variants.numberOfVariants!==void 0&&(m=p.variants.numberOfVariants),r.push(m),i.push(p)}}}if(r.length===0)return{success:!1};if(a!==void 0&&r.length===1){let p=a.state.value.split(/s+/).length;r=Array(p).fill(1)}let s={numberOfVariantsByChild:r,numberToSelect:e,withReplacement:n,childrenToSelect:i};if(n||e===1){let p=r.reduce((m,v)=>m+v),d=Math.pow(p,e);return{success:!0,numberOfVariants:d,uniqueVariantData:s}}let o=r.length;if(e>o)return{success:!1};let u=r[0];if(r.slice(1).every(p=>p===u)){let p=o;for(let m=o-1;m>o-e;m--)p*=m;let d=p*Math.pow(u,e);return{success:!0,numberOfVariants:d,uniqueVariantData:s}}let f=Ev(r,e);return{success:!0,numberOfVariants:f,uniqueVariantData:s}}static getUniqueVariant({serializedComponent:t,variantNumber:e,allComponentClasses:n}){if(t.variants===void 0)return{succes:!1};let r=t.variants.numberOfVariants;if(r===void 0)return{success:!1};if(!Number.isInteger(e)||e<0||e>=r)return{success:!1};let i=t.variants.uniqueVariantData,a=i.numberOfVariantsByChild,s=i.numberToSelect,o=i.withReplacement,u=a.length,c=i.childrenToSelect,f=ti({numberOfIndices:s,numberOfOptions:u,maxNumber:e+1,withReplacement:o}),p=f.length,d=f.map(A=>({combination:A,numberOfPossibilities:A.reduce(($,S)=>$*a[S],1)})),m=[...Array(p).keys()],v=0,h=m.length,y,g,b=e;for(;h>0;){let $=m.map(S=>d[S]).reduce((S,D)=>Math.min(S,D.numberOfPossibilities),Infinity)-v;if(b<$*h){y=m[b%h],g=v+Math.floor(b/h);break}else v+=$,b-=$*h,m=m.filter(S=>d[S].numberOfPossibilities>v),h=m.length}let x=f[y],N=Cn({numberOfOptionsByIndex:x.map(A=>a[A]),maxNumber:g+1})[g],C=[],_=!1;for(let[A,$]of x.entries())if(a[$]>1){let S=c[$];if(S.variants.isVariantComponent){let V=n[S.componentType].getUniqueVariant({serializedComponent:S,variantNumber:N[A],allComponentClasses:n});if(!V.success)return{success:!1};C.push(V.desiredVariant)}else{let D=Nn({variantNumber:N[A],serializedComponent:S,allComponentClasses:n});if(!D.success)return{success:!1};C.push(...D.desiredVariants)}_=!0}else C.push({});let w={indices:x};return _&&(w.subvariants=C),{success:!0,desiredVariant:w}}},Pv=xl,Ev=function(l,t){if(t===0)return 0;if(t===1)return l.reduce((n,r)=>n+r);let e=0;for(let n in l){let r=l[n],i=[...l];i.splice(n,1),e+=r*Ev(i,t-1)}return e};var Cl=class extends jr{static componentType="group";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.rendered.default=!0,e}},Lv=Cl;var Nl=De(Ee()),wl=class extends $n{static componentType="animatefromsequence";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.animationOn={default:!1},e.animationMode={default:"increase"},e.animationInterval={default:1e3},e.initialSelectedIndex={default:0},e}updateState(t={}){if(super.updateState(t),t.init&&(this.makePublicStateVariable({variableName:"selectedIndex",componentType:"number"}),this.makePublicStateVariable({variableName:"value",componentType:this.state.type}),this.makePublicStateVariable({variableName:"currentAnimationDirection",componentType:"text"}),this.advanceAnimation=this.advanceAnimation.bind(this)),!(!this.childLogicSatisfied||Object.keys(this.unresolvedState).length>0)){if(this.currentTracker.trackChanges.checkIfVariableChanged(this)){this.state.possibleValues=[];for(let e=0;e<this.state.count;e++){let n=this.state.from;if(e>0&&(this.state.type==="math"?n=n.add(this.state.step.multiply(Nl.default.fromAst(e))).expand().simplify():n+=this.state.step*e),this.state.type==="math"){if(this.state.exclude.some(r=>r.equals(n)))continue}else if(this.state.exclude.includes(n))continue;this.state.type==="letters"&&(n=this.constructor.numberToLetters(n,this.state.lowercase)),this.state.possibleValues.push(n)}this.state.numberValues=this.state.possibleValues.length}this.state.selectedIndex===void 0?(this.state.selectedIndex=Math.min(this.state.numberValues-1,Math.max(0,this.state.initialselectedindex)),this._state.selectedIndex.essential=!0):this.state.selectedIndex=Nl.default.math.mod(this.state.selectedIndex,this.state.numberValues),this.state.value=this.state.possibleValues[this.state.selectedIndex],this.state.animationMode=this.state.animationMode.toLowerCase(),this.state.animationMode==="oscillate"?this.state.currentAnimationDirection===void 0&&(this.state.currentAnimationDirection="increase"):this.state.animationMode.substring(0,8)=="decrease"?(this.state.currentAnimationDirection="decrease",this.state.animationMode!=="decrease once"&&(this.state.animationMode="decrease")):(this.state.currentAnimationDirection="increase",this.state.animationMode!=="increase once"&&(this.state.animationMode="increase")),this._state.currentAnimationDirection.essential=!0,this.state.animationOn?this.state.animationPreviouslyOn||(this.state.currentAnimationDirection==="increase"?this.state.selectedIndex===this.state.numberValues-1&&(this.state.animationMode==="increase once"?(this.state.selectedIndex=0,this.state.value=this.state.possibleValues[this.state.selectedIndex]):this.state.animationMode==="oscillate"&&(this.state.currentAnimationDirection="decrease")):this.state.currentAnimationDirection==="decrease"&&this.state.selectedIndex===0&&(this.state.animationMode==="decrease once"?(this.state.selectedIndex=this.state.numberValues-1,this.state.value=this.state.possibleValues[this.state.selectedIndex]):this.state.animationMode==="oscillate"&&(this.state.currentAnimationDirection="inccrease")),this.state.animationID=this.coreFunctions.requestAnimationFrame(this.advanceAnimation,this.state.animationInterval),this.state.animationPreviouslyOn=!0):(this.state.animationPreviouslyOn&&this.coreFunctions.cancelAnimationFrame(this.state.animationID),this.state.animationPreviouslyOn=!1)}}advanceAnimation(){let t,e=!0,n;this.state.currentAnimationDirection==="decrease"?(t=this.state.selectedIndex-1,t<=0&&(this.state.animationMode==="decrease once"?e=!1:this.state.animationMode==="oscillate"&&(n="increase"))):(t=this.state.selectedIndex+1,t>=this.state.numberValues-1&&(this.state.animationMode==="increase once"?e=!1:this.state.animationMode==="oscillate"&&(n="decrease")));let r={selectedIndex:{changes:t}};e||(r.animationOn={changes:!1}),n!==void 0&&(r.currentAnimationDirection={changes:n}),this.coreFunctions.requestUpdate({updateType:"updateValue",updateInstructions:[{componentName:this.componentName,variableUpdates:r}]}),e&&(this.state.animationID=this.coreFunctions.requestAnimationFrame(this.advanceAnimation,this.state.animationInterval))}static createSerializedReplacements(t){let e=[];return t.state.value!==void 0&&e.push({componentType:t.state.type,state:{value:t.state.value,hide:t.state.hide}}),e}static calculateReplacementChanges({component:t}){let e=[];if(t.state.value===void 0){if(t.replacements[0]!==void 0){let r={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToDelete:t.replacements.length};e.push(r)}return e}if(t.replacements[0]===void 0||t.state.type!==t.replacements[0].componentType){let r={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:t.constructor.createSerializedReplacements(t)};return e.push(r),e}let n={changeType:"updateStateVariables",component:t.replacements[0],stateChanges:{value:t.state.value}};return e.push(n),e}allowDownstreamUpdates(t){return t.initialChange||this.state.modifyIndirectly}get variablesUpdatableDownstream(){return["value","selectedIndex","animationOn","currentAnimationDirection"]}calculateDownstreamChanges({stateVariablesToUpdate:t,stateVariableChangesToSave:e,dependenciesToUpdate:n}){let r={};if("selectedIndex"in t&&(r.selectedIndex=t.selectedIndex),"animationOn"in t&&(r.animationOn=t.animationOn),"currentAnimationDirection"in t&&(r.currentAnimationDirection=t.currentAnimationDirection),"value"in t)if(this.state.type==="number"){let o=t.value.changes;if(typeof o!="number"&&(o=o.evaluate_to_constant()),typeof o!="number")return!1;let u=this.state.step,c=-1,f=this.state.possibleValues.length-1;for(;c<f-1;){let d=Math.floor((c+f)/2);u*(this.state.possibleValues[d]-o)>0?f=d:c=d}let p=f;c!==-1&&Math.abs(o-this.state.possibleValues[c])<Math.abs(o-this.state.possibleValues[f])&&(p=c),r.selectedIndex={changes:p}}else{let o=t.value,u=this.state.possibleValues.indexOf(o);if(u===-1)return!1;r.selectedIndex={changes:u}}this.updatePropertySources({newStateVariables:r,dependenciesToUpdate:n});let i=this.updateShadowSources({newStateVariables:r,dependenciesToUpdate:n}),a=i.shadowedStateVariables,s=i.isReplacement;for(let o in r)this._state[o].essential===!0&&!a.has(o)&&!s&&(e[o]=r[o]);return!0}},Rv=wl;var Ji=De(Ee()),dP=De(Hv()),Tl=class extends ke{static componentType="evaluate";static rendererType="math";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.forceSymbolic={default:!1},e.forceNumeric={default:!1},e}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();let n=e.newLeaf({name:"atLeastZeroFunctions",componentType:"function",comparison:"atLeast",number:0,requireConsecutive:!0}),r=e.newLeaf({name:"atMostOneInput",componentType:"input",comparison:"atMost",number:1});return e.newOperator({name:"FunctionsAndMaths",operator:"or",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return delete t.codePre,delete t.expressionWithCodes,delete t.codesAdjacentToStrings,delete t.mathChildrenByArrayComponent,t.canBeModified={returnDependencies:()=>({}),definition:()=>({newValues:{canBeModified:!1}})},t.nResults={returnDependencies:()=>({functionChildren:{dependencyType:"child",childLogicName:"atLeastZeroFunctions"},inputChild:{dependencyType:"child",childLogicName:"atMostOneInput",variableNames:["nComponents"]}}),definition:function({dependencyValues:e}){let n;return e.functionChildren.length>0&&e.inputChild.length===1&&e.inputChild[0].stateValues.nComponents>0?n=e.functionChildren.length:n=0,{newValues:{nResults:n}}}},t.evaluatedResults={isArray:!0,entryPrefixes:["evaluatedResult"],public:!0,componentType:"math",returnArraySizeDependencies:()=>({nResults:{dependencyType:"stateVariable",variableName:"nResults"}}),returnArraySize({dependencyValues:e}){return[e.nResults]},returnArrayDependenciesByKey({arrayKeys:e}){let n={inputChild:{dependencyType:"child",childLogicName:"atMostOneInput",variableNames:["nComponents","maths"]},forceSymbolic:{dependencyType:"stateVariable",variableName:"forceSymbolic"},forceNumeric:{dependencyType:"stateVariable",variableName:"forceNumeric"}},r={};for(let i of e)r[i]={functionChild:{dependencyType:"child",childLogicName:"atLeastZeroFunctions",variableNames:["symbolicf","numericalf","symbolic"],childIndices:[i]}};return{globalDependencies:n,dependenciesByKey:r}},arrayDefinitionByKey({globalDependencyValues:e,dependencyValuesByKey:n,arrayKeys:r}){let i={};if(e.inputChild.length===1&&e.inputChild[0].stateValues.nComponents>0){let a=e.inputChild[0].stateValues.maths[0],s=!1,o;for(let u of r){let c=n[u].functionChild[0];c&&(!e.forceNumeric&&(c.stateValues.symbolic||e.forceSymbolic)?i[u]=c.stateValues.symbolicf(a):(s||(s=!0,o=a.evaluate_to_constant(),o===null&&(o=NaN)),i[u]=Ji.default.fromAst(c.stateValues.numericalf(o))))}}return{newValues:{evaluatedResults:i}}}},t.evaluatedResult={isAlias:!0,targetVariableName:"evaluatedResult1"},t.unnormalizedValue={public:!0,componentType:this.componentType,returnDependencies:()=>({evaluatedResults:{dependencyType:"stateVariable",variableName:"evaluatedResults"}}),definition:function({dependencyValues:e}){return e.evaluatedResults.length===1?{newValues:{unnormalizedValue:e.evaluatedResults[0]}}:e.evaluatedResults.length>1?{newValues:{unnormalizedValue:Ji.default.fromAst(["tuple",...e.evaluatedResults.map(n=>n.tree)])}}:{newValues:{unnormalizedValue:Ji.default.fromAst("\uFF3F")}}}},t}},Kv=Tl;var _l=De(Ee()),Al=class extends Oe{static componentType="randomnumber";static previewSerializedComponent({sharedParameters:t}){t.typeForSelectableType="number",t.defaultToPrescribedParameters=!0}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.type={default:"discrete"},e.mean={default:null},e.standarddeviation={default:null},e.variance={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();function n({activeChildrenMatched:p,sharedParameters:d}){let m=p[0],v=m.state.value.split(",");if(v.length===1){let h={componentType:"to",children:[{componentType:"number",children:[{createdComponent:!0,componentName:m.componentName}]}]};return{success:!0,newChildren:[h]}}else if(v.length===2){let h={componentType:"from",children:[{componentType:"number",children:[{componentType:"string",state:{value:v[0].trim()}}]}]},y={componentType:"to",children:[{componentType:"number",children:[{componentType:"string",state:{value:v[1].trim()}}]}]};return{success:!0,newChildren:[h,y],toDelete:[m.componentName]}}else return{success:!1}}let r=e.newLeaf({name:"exactlyOneString",componentType:"string",number:1,isSugar:!0,replacementFunction:n}),i=e.newLeaf({name:"atMostOneFrom",componentType:"from",comparison:"atMost",number:1}),a=e.newLeaf({name:"atMostOneTo",componentType:"to",comparison:"atMost",number:1}),s=e.newOperator({name:"toFrom",operator:"and",propositions:[i,a]}),o=e.newOperator({name:"sugarXorToFrom",operator:"xor",propositions:[r,s]}),u=e.newLeaf({name:"atMostOneStep",componentType:"step",comparison:"atMost",number:1}),c=e.newLeaf({name:"atMostOneCount",componentType:"count",comparison:"atMost",number:1}),f=e.newLeaf({name:"atLeastZeroExcludes",componentType:"exclude",comparison:"atLeast",number:0});return e.newOperator({name:"sequenceLogic",operator:"and",propositions:[o,u,c,f],setAsBase:!0}),e}updateState(t={}){if(t.init&&(this.state.rng=new this.sharedParameters.rngClass,this._state.from===void 0&&(this._state.from={trackChanges:!0}),this._state.to===void 0&&(this._state.to={trackChanges:!0}),this._state.step===void 0&&(this._state.step={trackChanges:!0}),this._state.count===void 0&&(this._state.count={trackChanges:!0}),this._state.exclude===void 0&&(this._state.exclude={trackChanges:!0,value:[]})),super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.number=!0,this.unresolvedState.value=!0,this.unresolvedState.latex=!0,this.unresolvedState.text=!0;return}if(delete this.unresolvedState.number,delete this.unresolvedState.value,delete this.unresolvedState.latex,delete this.unresolvedState.text,this.constructor.getRandomNumberParametersFromChildren(this),Object.keys(this.unresolvedState).length>0){this.unresolvedState.number=!0,this.unresolvedState.value=!0,this.unresolvedState.latex=!0,this.unresolvedState.text=!0;return}if(this._state.value.essential)this._state.number.essential||(this.state.number=this.state.value.evaluate_to_constant());else if(!this._state.number.essential)if(this.state.type==="gaussian")if(this.state.mean===null&&(this.state.mean=0),this.state.variance===null?(this.state.standarddeviation===null&&(this.state.standarddeviation=1),this.state.variance=this.state.standarddeviation**2):this.state.standarddeviation===null?this.state.standarddeviation=Math.sqrt(this.state.variance):this.state.variance=this.state.standarddeviation**2,!(this.state.standarddeviation>0)||!Number.isFinite(this.state.mean)){let n="Invalid mean ("+this.state.mean+") or standard deviation ("+this.state.standarddeviation+") for a gaussian random variable.";console.warn(n),this.state.number=NaN}else{let n=0,r=0;for(;n===0;)n=this.state.rng.random();for(;r===0;)r=this.state.rng.random();let i=Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*r);this.state.number=this.state.mean+this.state.standarddeviation*i}else this.state.type==="uniform"?(this.state.from===void 0&&(this.state.from=0),this.state.to===void 0&&(this.state.to=1),this.state.number=this.state.from+this.state.rng.random()*(this.state.to-this.state.from)):this.state.validParameters?(this.state.basedOnFrom||(this.state.from=void 0),this.state.basedOnTo||(this.state.to=void 0),this.state.basedOnStep||(this.state.step=void 0),this.state.basedOnCount||(this.state.count=void 0),!this.state.excludeChildren&&!this._state.exclude.essential&&(this.state.exclude=[]),Or.calculateSequenceParameters(this.state),this.state.number=Or.selectValues({stateObj:this.state,rng:this.state.rng})[0]):this.state.number=NaN;Number.isFinite(this.state.number)?this.state.value=_l.default.fromAst(this.state.number):this.state.value=_l.default.fromAst("\uFF3F");let e=this.state.value.round_numbers_to_precision(this.state.displaydigits);this.state.latex=e.toLatex(),this.state.text=e.toString()}static getRandomNumberParametersFromChildren(t){if(t.state.validParameters=!0,t.state.parameterChanged=!1,t.state.type==="gaussian")return;let e=t.currentTracker.trackChanges;e.getVariableChanges({component:t,variable:"type"})&&(["uniform","discrete"].includes(t.state.type)||(console.warn("Unrecognized type ("+t.state.type+") for random number, setting to discrete."),t.state.type="discrete"));let n=e.childrenChanged(t.componentName);if(n){let r=t.childLogic.returnMatches("atMostOneFrom");r.length===1?(t.state.fromChild=t.activeChildren[r[0]],t.state.basedOnFrom=!0):(delete t.state.fromChild,t._state.from.essential&&(t.state.basedOnFrom=!0));let i=t.childLogic.returnMatches("atMostOneTo");i.length===1?(t.state.toChild=t.activeChildren[i[0]],t.state.basedOnTo=!0):(delete t.state.toChild,t._state.to.essential&&(t.state.basedOnTo=!0))}if(t.state.fromChild?t.state.fromChild.unresolvedState.value?t.unresolvedState.from=!0:(n||e.getVariableChanges({component:t.state.fromChild,variable:"value"}))&&(t.state.from=t.state.fromChild.state.value,t.state.parameterChanged=!0):t._state.from.essential&&e.getVariableChanges({component:t,variable:"from"})&&(t.state.parameterChanged=!0),t.state.toChild?t.state.toChild.unresolvedState.value?t.unresolvedState.to=!0:(n||e.getVariableChanges({component:t.state.toChild,variable:"value"}))&&(t.state.to=t.state.toChild.state.value,t.state.parameterChanged=!0):t._state.to.essential&&e.getVariableChanges({component:t,variable:"to"})&&(t.state.parameterChanged=!0),t.state.type!=="uniform"){if(n){let r=t.childLogic.returnMatches("atMostOneStep");r.length===1?(t.state.stepChild=t.activeChildren[r[0]],t.state.basedOnStep=!0):(delete t.state.stepChild,t._state.step.essential&&(t.basedOnStep=!0));let i=t.childLogic.returnMatches("atMostOneCount");i.length===1?(t.state.countChild=t.activeChildren[i[0]],t.state.basedOnCount=!0):(delete t.state.countChild,t._state.count.essential&&(t.state.basedOnCount=!0));let a=t.childLogic.returnMatches("atLeastZeroExcludes");a.length>0?t.state.excludeChildren=a.map(s=>t.activeChildren[s]):delete t.state.excludeChildren}t.state.stepChild?t.state.stepChild.unresolvedState.value?(t.unresolvedState.step=!0,t.state.step=void 0):(n||e.getVariableChanges({component:t.state.stepChild,variable:"value"}))&&(t.state.step=t.state.stepChild.state.value,t.state.parameterChanged=!0):t._state.step.essential&&e.getVariableChanges({component:t,variable:"step"})&&(t.state.parameterChanged=!0),t.state.countChild?t.state.countChild.unresolvedState.value?(t.unresolvedState.count=!0,t.state.count=void 0):(n||e.getVariableChanges({component:t.state.countChild,variable:"number"}))&&(t.state.count=t.state.countChild.state.number,t.state.parameterChanged=!0):t._state.count.essential&&e.getVariableChanges({component:t,variable:"count"})&&(t.state.parameterChanged=!0),t.state.excludeChildren?t.state.excludeChildren.some(r=>r.unresolvedState.value)?t.unresolvedState.exclude=!0:(n||t.state.excludeChildren.some(r=>e.getVariableChanges({component:r,variable:"values"})))&&(t.state.exclude=t.state.excludeChildren.reduce((r,i)=>[...r,...i.state.values],[]),t.state.parameterChanged=!0):t._state.exclude.essential&&e.getVariableChanges({component:t,variable:"exclude"})&&(t.state.parameterChanged=!0),t.state.count!==void 0&&(!Number.isInteger(t.state.count)||t.state.count<0)&&(console.log("Invalid count for discrete uniform random number.  Must be a non-negative integer."),t.state.validParameters=!1),t.state.step!==void 0&&(Number.isFinite(t.state.step)||(t.state.step.evaluate_to_constant&&(t.state.step=t.state.step.evaluate_to_constant()),Number.isFinite(t.state.step)||(console.log("Invalid step for discrete uniform random number.  Must be a number."),t.state.validParameters=!1)))}}},Dn=Al;var $l=class extends Ue{static componentType="generaterandomnumbers";static assignNamesToReplacements=!0;static previewSerializedComponent=Dn.previewSerializedComponent;static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.numberOfSamples={default:1},e.withreplacement={default:!1},e}static returnChildLogic=Dn.returnChildLogic;updateState(t={}){if(t.init&&(this.state.seed!==void 0?this.state.rng=new this.sharedParameters.rngClass(this.state.seed):this.state.rng=new this.sharedParameters.rngClass,this._state.from===void 0&&(this._state.from={trackChanges:!0}),this._state.to===void 0&&(this._state.to={trackChanges:!0}),this._state.step===void 0&&(this._state.step={trackChanges:!0}),this._state.count===void 0&&(this._state.count={trackChanges:!0}),this._state.exclude===void 0&&(this._state.exclude={trackChanges:!0,value:[]}),this.replacementsToWithhold=0),super.updateState(t),!this.childLogicSatisfied){this.state.randomResults=[];return}if(Dn.getRandomNumberParametersFromChildren(this),Object.keys(this.unresolvedState).length>0){this.state.randomResults=[];return}if(this.state.randomResults=[],this.state.type==="gaussian")if(this.state.mean===null&&(this.state.mean=0),this.state.variance===null?(this.state.standarddeviation===null&&(this.state.standarddeviation=1),this.state.variance=this.state.standarddeviation**2):this.state.standarddeviation===null&&(this.state.standarddeviation=Math.sqrt(this.state.variance)),!(this.state.standarddeviation>0)||!Number.isFinite(this.state.mean)){let n="Invalid mean ("+this.state.mean+") or standard deviation ("+this.state.standarddeviation+") for a gaussian random variable.";console.warn(n)}else for(let n=0;n<this.state.numberOfSamples;n++){let r=0,i=0;for(;r===0;)r=this.state.rng.random();for(;i===0;)i=this.state.rng.random();let a=Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*i);this.state.randomResults.push(this.state.mean+this.state.standarddeviation*a)}else if(this.state.type==="uniform"){this.state.from===void 0&&(this.state.from=0),this.state.to===void 0&&(this.state.to=1);let n=this.state.to-this.state.from;for(let r=0;r<this.state.numberOfSamples;r++)this.state.randomResults.push(this.state.from+this.state.rng.random()*n)}else if(this.state.validParameters){this.state.basedOnFrom||(this.state.from=void 0),this.state.basedOnTo||(this.state.to=void 0),this.state.basedOnStep||(this.state.step=void 0),this.state.basedOnCount||(this.state.count=void 0),!this.state.excludeChildren&&!this._state.exclude.essential&&(this.state.exclude=[]),Or.calculateSequenceParameters(this.state);let n=1;this.state.withreplacement||(n=this.state.numberOfSamples),n>this.state.count?console.warn("Cannot randomly sample "+n+" values from a sequence of length "+this.state.count):this.state.randomResults=Or.selectValues({stateObj:this.state,numberUniqueRequired:n,numberToSelect:this.state.numberOfSamples,withReplacement:this.state.withreplacement,rng:this.state.rng})}let e=this.doenetAttributes.componentName;e!==void 0&&(this.doenetAttributes.newNamespace===!0?this.state.randomNumberNamespace=e+"/":this.state.randomNumberNamespace=e.substring(0,e.lastIndexOf("/")+1))}static createSerializedReplacements({component:t}){let e=[],n=t.doenetAttributes.assignNames;for(let[r,i]of t.state.randomResults.entries()){let a;n!==void 0&&r<n.length?a=n[r]:a="_"+t.componentName+"_"+r,t.state.randomNumberNamespace!==void 0&&(a=t.state.randomNumberNamespace+a),e.push({componentType:"number",doenetAttributes:{componentName:a},state:{value:i}})}return{replacements:e}}static calculateReplacementChanges({component:t}){let e=[],n=0;t.doenetAttributes.assignNames!==void 0&&(n=t.doenetAttributes.assignNames.length);let r=t.replacements.length-t.replacementsToWithhold;if(r>t.state.randomResults.length){let a=t.replacementsToWithhold;if(t.replacementsToWithhold===0){let s=Math.max(t.state.randomResults.length,n),o=Math.max(0,t.replacements.length-s);if(a=Math.max(0,n-t.state.randomResults.length),o>0){let u={changeType:"delete",changeTopLevelReplacements:!0,firstReplacementInd:s,numberReplacementsToDelete:o};e.push(u)}}else a=t.replacements.length-t.state.randomResults.length;if(a!==t.replacementsToWithhold){let s={changeType:"changeReplacementsToWithhold",replacementsToWithhold:a};e.push(s)}}else if(r<t.state.randomResults.length){let a=[],s=t.doenetAttributes.assignNames,o=Math.max(0,t.replacements.length-t.state.randomResults.length);if(o!==t.replacementsToWithhold){let c={changeType:"changeReplacementsToWithhold",replacementsToWithhold:o};e.push(c)}for(let c=t.replacements.length;c<t.state.randomResults.length;c++){let f;s!==void 0&&c<s.length?f=s[c]:f="_"+t.componentName+"_"+c,t.state.randomNumberNamespace!==void 0&&(f=t.state.randomNumberNamespace+f),a.push({componentType:"number",doenetAttributes:{componentName:f},state:{value:t.state.randomResults[c]}})}let u={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:t.replacements.length,numberReplacementsToReplace:0,serializedReplacements:a};e.push(u)}let i=Math.min(t.replacements.length,t.state.randomResults.length);for(let a=0;a<i;a++){let s={changeType:"updateStateVariables",component:t.replacements[a],stateChanges:{value:t.state.randomResults[a]}};e.push(s)}return e}},Wv=$l;var ni=De(Ee());var Sl=class extends Ue{static componentType="substitute";static defaultType="number";static previewSerializedComponent({serializedComponent:t,sharedParameters:e,components:n}){if(t.children===void 0)return;let r;for(let[s,o]of t.children.entries())if(o.componentType==="type"||o.createdComponent&&n[o.componentName].componentType==="type"){r=s;break}let i;for(let[s,o]of t.children.entries())if(o.componentType==="simplify"||o.createdComponent&&n[o.componentName].componentType==="simplify"){i=s;break}let a=[];return r!==void 0&&a.push({createChildren:[r]}),i!==void 0&&a.push({createChildren:[i]}),a.push({callMethod:"setUpTypeSimplify"}),a}static setUpTypeSimplify({sharedParameters:t,definingChildrenSoFar:e,serializedComponent:n}){let r;for(let a of e)if(a!==void 0&&a.componentType==="type"){r=a;break}if(r!==void 0){if(!["math","text"].includes(r.state.value))throw Error("Substitute type must be text or math");t.defaultType=r.state.value}let i;for(let a of e)if(a!==void 0&&a.componentType==="simplify"){i=a;break}i!==void 0&&(t.simplify=i.state.value)}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.type={default:void 0},e.format={default:"text"},e.simplify={default:"full"},e.displaydigits={default:10},e.rendermode={default:"inline"},e.matchwholeword={default:!1},e.casesensitive={default:!1},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=function({activeChildrenMatched:o,sharedParameters:u}){let c=ln({childrenList:o});if(!c.success)return{success:!1};let f=c.toDelete,p="math";u.defaultType==="text"&&(p="text");let d={componentType:p};p==="math"&&u.simplify!==void 0&&(d.state={simplify:u.simplify});let m=Object.assign({},d);m.children=c.pieces[0];let v=[{componentType:"pattern",children:[m]}],h=c.pieces.slice(1);for(let y of h){let g=Ii(y);if(!g.foundVector)return{sucess:!1};f.push(...g.toDelete);let b=[],x=Object.assign({},d);x.children=g.vectorComponents[0],b.push(x),x=Object.assign({},d),x.children=g.vectorComponents[1],b.push(x),v.push({componentType:"replace",children:b})}return{success:!0,newChildren:v,toDelete:f}},r=e.newLeaf({name:"exactlyOneString",componentType:"string",number:1,isSugar:!0,replacementFunction:n}),i=e.newLeaf({name:"exactlyOnePattern",componentType:"pattern",number:1}),a=e.newLeaf({name:"atLeastZeroReplaces",componentType:"replace",comparison:"atLeast",number:0}),s=e.newOperator({name:"substitutionChildren",operator:"and",propositions:[i,a]});return e.newOperator({name:"sugarXorSubstitutionChildren",operator:"xor",propositions:[r,s],setAsBase:!0}),e}updateState(t={}){if(super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.originalValue=!0,this.unresolvedState.value=!0;return}let e=this.currentTracker.trackChanges,n=e.childrenChanged(this.componentName);if(n){let a=this.childLogic.returnMatches("exactlyOnePattern");this.state.patternParent=this.activeChildren[a[0]]}if(!this.state.patternParent.childLogicSatisfied){this.unresolvedState.originalValue=!0,this.unresolvedState.value=!0;return}let r=!1,i=e.getVariableChanges({component:this,variable:"type"});if(n||i||e.childrenChanged(this.state.patternParent))if(r=!0,this.state.patternChild=this.state.patternParent.activeChildren[0],this.state.patternChild instanceof this.componentInfoObjects.allComponentClasses.math)this.state.type="math",this.state.patternClass="math";else if(this.state.patternChild instanceof this.componentInfoObjects.allComponentClasses.text)this.state.type="text",this.state.patternClass="text";else if(this.state.patternChild instanceof this.componentInfoObjects.allComponentClasses.string)this.state.patternClass="string";else{console.warn("Substitute must have a math, text or string pattern."),this.unresolvedState.value=!0,this.state.patternClass="invalid";return}if(this.state.patternClass==="invalid"){console.warn("Substitute must have a math, text or string pattern.");return}if(this.state.patternChild.unresolvedState.value){this.unresolvedState.originalValue=!0,this.unresolvedState.value=!0;return}if(this.state.patternClass==="string"?(n||e.getVariableChanges({component:this.state.patternChild,variable:"value"})||e.getVariableChanges({component:this,variable:"type"}))&&(r=!0,this.state.type==="text"?this.state.originalValue=this.state.patternChild.state.value:(this.state.type="math",this.state.originalValue=this.parseMathString(this.state.patternChild.state.value)),delete this.unresolvedState.originalValue):(n||e.getVariableChanges({component:this.state.patternChild,variable:"value"}))&&(r=!0,this.state.originalValue=this.state.patternChild.state.value,delete this.unresolvedState.originalValue),n){let a=this.childLogic.returnMatches("atLeastZeroReplaces");this.state.replaceChildren=a.map(s=>this.activeChildren[s])}if(this.state.replaceChildren.some(a=>!a.childLogicSatisfied||a.activeChildren.some(s=>s.unresolvedState.value))){this.unresolvedState.value=!0;return}if(n||i||this.state.replaceChildren.some(a=>e.childrenChanged(a)||a.activeChildren.some(s=>e.getVariableChanges({component:s,variable:"value"})))){r=!0,this.state.replaces=[];for(let a of this.state.replaceChildren){let s=[];for(let o of a.activeChildren)if(this.state.type==="math")if(o instanceof this.componentInfoObjects.allComponentClasses.math)s.push(o.state.value);else if(o instanceof this.componentInfoObjects.allComponentClasses.string)s.push(this.parseMathString(o.state.value));else{console.warn("Substitute of math type must have math or string replaces"),this.unresolvedState.value=!0;return}else if(this.state.type==="text")if(o instanceof this.componentInfoObjects.allComponentClasses.text||o instanceof this.componentInfoObjects.allComponentClasses.string)s.push(o.state.value);else{console.warn("Substitute of text type must have text or string replaces"),this.unresolvedState.value=!0;return}this.state.replaces.push(s)}}if(e.getVariableChanges({component:this,variable:"simplify"})&&(r=!0),!!r)if(delete this.unresolvedState.value,this.state.numSubstitutions=this.state.replaces.length,this.state.type==="text"){let a=function(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};this.state.value=this.state.originalValue;for(let s=0;s<this.state.numSubstitutions;s++){let o,u="g";this.state.casesensitive||(u="gi"),this.state.matchwholeword?o=new RegExp("\\b"+a(this.state.replaces[s][0])+"\\b",u):o=new RegExp(a(this.state.replaces[s][0]),u);let c=this.state.replaces[s][1];this.state.value=this.state.value.replace(o,c)}}else{this.state.value=this.state.originalValue.subscripts_to_strings();for(let a=0;a<this.state.numSubstitutions;a++)this.state.value=this.state.value.substitute({[this.state.replaces[a][0].subscripts_to_strings().tree]:this.state.replaces[a][1].subscripts_to_strings()});this.state.value=this.state.value.strings_to_subscripts(),this.state.value=er({value:this.state.value,simplify:this.state.simplify})}}parseMathString(t){if(this.state.format==="text")try{return ni.default.fromText(t)}catch(e){return console.log("Invalid value for a math of text format: "+t),ni.default.fromAst("\uFF3F")}else if(this.state.format==="latex")try{return ni.default.fromLatex(t)}catch(e){return console.log("Invalid value for a math of latex format: "+t),ni.default.fromAst("\uFF3F")}else throw Error("Unrecongized math format")}static createSerializedReplacements({component:t}){if(Object.keys(t.unresolvedState).length>0)return{replacements:[]};let e={componentType:t.state.type,state:{value:t.state.value}};if(t.state.type==="math")for(let n of["simplify","displaydigits","rendermode"])t._state[n].usedDefault||(e.state[n]=t.state.item);return{replacements:[e]}}static calculateReplacementChanges({component:t}){let e=[];if(t.state.type!==t.replacements[0].componentType){let n=this.createSerializedReplacements({component:t}).replacements,r={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:1,serializedReplacements:n};e.push(r)}else{let n={value:t.state.value};if(t.state.type==="math")for(let i of["simplify","displaydigits","rendermode"])t._state[i].usedDefault||(n[i]=t.state.item);let r={changeType:"updateStateVariables",component:t.replacements[0],stateChanges:n};e.push(r)}return e}},Gv=Sl;var Dl=class extends rr{static componentType="offsets";updateState(t={}){if(t.init===!0&&(this.makePublicStateVariableArray({variableName:"offsets",componentType:"offset"}),this.makePublicStateVariableArrayEntry({entryName:"offset",arrayVariableName:"offsets"})),super.updateState(t),this.unresolvedState.maths){this.unresolvedState.offsets=!0;return}if(this.currentTracker.trackChanges.getVariableChanges({component:this,variable:"maths"})){this.state.offsets=[];for(let e=1;e<=this.state.ncomponents;e++){let n=this.state.maths[e-1];this.state.offsets.push(n)}}}},Zv=Dl;var ct=De(Ee());var Vl=class extends ke{static componentType="discreteinfiniteset";static previewSerializedComponent({serializedComponent:t,sharedParameters:e,components:n}){if(t.children===void 0)return;let r;for(let[a,s]of t.children.entries())if(s.componentType==="simplify"||s.createdComponent&&n[s.componentName].componentType==="simplify"){r=a;break}let i=[];return r!==void 0&&i.push({createChildren:[r]}),i.push({callMethod:"setUpSimplify"}),i}static setUpSimplify({sharedParameters:t,definingChildrenSoFar:e,serializedComponent:n}){let r;for(let i of e)if(i!==void 0&&i.componentType==="simplify"){r=i;break}r!==void 0&&(t.simplifyChild=r)}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.minindex={default:ct.default.fromAst(["-",Infinity])},e.maxindex={default:ct.default.fromAst(Infinity)},e}static returnChildLogic(t){let e=super.returnChildLogic(t);e.deleteAllLogic();let n=function({activeChildrenMatched:o,sharedParameters:u}){let c=ln({childrenList:o});if(!c.success||c.pieces.length!==2)return{success:!1};let f=c.toDelete,p=[],d=[],m=Ii(c.pieces[0]);if(m.foundVector)for(let h of m.vectorComponents){let y={componentType:"offset",children:h};u.simplifyChild!==void 0&&y.children.push({componentType:"ref",children:[{componentType:"reftarget",state:{targetName:u.simplifyChild.componentName}}]}),d.push(y)}else d=c.pieces[0];p.push({componentType:"offsets",children:d});let v=result.pieces[1];return u.simplifyChild!==void 0&&(v.push({componentType:"ref",children:[{componentType:"reftarget",state:{targetName:u.simplifyChild.componentName}}]}),p.push({componentType:"period",children:v})),{success:!0,newChildren:p,toDelete:f}},r=e.newLeaf({name:"exactlyOneString",componentType:"string",number:1,isSugar:!0,replacementFunction:n}),i=e.newLeaf({name:"atMostOneOffsets",componentType:"offsets",comparison:"atMost",number:1}),a=e.newLeaf({name:"atMostOnePeriod",componentType:"period",comparison:"atMost",number:1}),s=e.newOperator({name:"offsetsAndPeriod",operator:"and",propositions:[i,a]});return e.newOperator({name:"SugarXorOffsetsPeriod",operator:"xor",propositions:[r,s],setAsBase:!0}),e}updateState(t={}){if(t.init&&(this.makePublicStateVariable({variableName:"offsets",componentType:"offsets"}),this.makePublicStateVariable({variableName:"period",componentType:"period"}),this.makePublicStateVariable({variableName:"redundantoffsets",componentType:"boolean"})),super.updateState(t),!this.childLogicSatisfied){this.unresolvedState.offsets=!0,this.unresolvedState.period=!0,this.unresolvedState.redundantoffsets=!0;return}let e=!1,n=!1,r=this.currentTracker.trackChanges,i=r.childrenChanged(this.componentName);if(i){e=!0;let s=this.childLogic.returnMatches("atMostOneOffsets");s.length===1?this.state.offsetsChild=this.activeChildren[s[0]]:(delete this.state.offsetsChild,this._state.value.essential?r.getVariableChanges({component:this,variable:"value"})&&(e=!0):(n=!0,this.state.offsets=[],this.state.nOffsets=0,this.state.value=ct.default.fromAst("\uFF3F")));let o=this.childLogic.returnMatches("atMostOnePeriod");o.length===1?this.state.periodChild=this.activeChildren[o[0]]:(delete this.state.periodChild,this._state.value.essential?r.getVariableChanges({component:this,variable:"value"})&&(e=!0):(n=!0,this.state.period=ct.default.fromAst("\uFF3F"),this.state.value=ct.default.fromAst("\uFF3F")))}if(n){delete this.unresolvedState.value,delete this.unresolvedState.latex,delete this.unresolvedState.text,delete this.unresolvedState.offsets,delete this.unresolvedState.period,delete this.unresolvedState.redundantoffsets;return}if(this.state.offsetsChild){if(this.state.offsetsChild.unresolvedState.maths){this.unresolvedState.value=!0,this.unresolvedState.latex=!0,this.unresolvedState.text=!0,this.unresolvedState.offsets=!0,this.unresolvedState.period=!0,this.unresolvedState.redundantoffsets=!0;return}(i||r.getVariableChanges({component:this.state.offsetsChild,variable:"maths"}))&&(e=!0,this.state.offsets=this.state.offsetsChild.state.maths,this.state.nOffsets=this.state.offsetsChild.state.ncomponents)}if(this.state.periodChild){if(this.state.periodChild.unresolvedState.value){this.unresolvedState.value=!0,this.unresolvedState.latex=!0,this.unresolvedState.text=!0,this.unresolvedState.offsets=!0,this.unresolvedState.period=!0,this.unresolvedState.redundantoffsets=!0;return}(i||r.getVariableChanges({component:this.state.periodChild,variable:"value"}))&&(e=!0,this.state.period=this.state.periodChild.state.value)}if(!e&&(!this._state.value.essential||!r.getVariableChanges({component:this,variable:"value"})))return;if(delete this.unresolvedState.value,delete this.unresolvedState.latex,delete this.unresolvedState.text,delete this.unresolvedState.offsets,delete this.unresolvedState.period,delete this.unresolvedState.redundantoffsets,this._state.value.essential)if(Array.isArray(this.state.value.tree)&&this.state.value.tree[0]==="discrete_infinite_set"){let s=this.state.value.tree[1];this.state.offsets=[ct.default.fromAst(s[1])],this.state.period=ct.default.fromAst(s[2]),this.state.minindex=ct.default.fromAst(s[3]),this.state.maxindex=ct.default.fromAst(s[4]);for(let o=2;o<this.state.value.tree.length;o++)s=this.state.value.tree[o],this.state.offsets.push(ct.default.fromAst(s[1])),this.state.period.equals(ct.default.fromAst(s[2]))||console.warn("Have not implemented discrete infinite set with different periods."),this.state.minindex.equals(ct.default.fromAst(s[3]))||console.warn("Have not implemented discrete infinite set with different minindices."),this.state.maxindex.equals(ct.default.fromAst(s[4]))||console.warn("Have not implemented discrete infinite set with different maxindices.");this.state.nOffsets=this.state.value.tree.length-1}else this.state.value=ct.default.fromAst("\uFF3F"),this.state.period=ct.default.fromAst("uFF3F"),this.state.offsets=[];else if(this.state.nOffsets===0||this.state.period.tree==="\uFF3F")this.state.value=ct.default.fromAst("\uFF3F");else if(this.state.nOffsets===1)this.state.value=ct.default.create_discrete_infinite_set({offsets:this.state.offsets[0],periods:this.state.period,min_index:this.state.minindex,max_index:this.state.maxindex});else{let s=ct.default.fromAst(["list",...this.state.offsets.map(o=>o.tree)]);this.state.value=ct.default.create_discrete_infinite_set({offsets:s,periods:this.state.period,min_index:this.state.minindex,max_index:this.state.maxindex})}this.state.redundantoffsets=!1;let a=this.state.period.evaluate_to_constant();if(a!==null)for(let s=0;s<this.state.nOffsets;s++){for(let o=0;o<s;o++){let u=this.state.offsets[s].subtract(this.state.offsets[o]).evaluate_to_constant();if(u!==null&&Math.abs(u%a)<1e-10*a){this.state.redundantoffsets=!0;break}}if(this.state.redundantoffsets)break}this.state.latex=""}},Xv=Vl;var Il=class extends We{static componentType="image";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.width={default:null,forRenderer:!0},e.height={default:null,forRenderer:!0},e.description={default:null,forRenderer:!0},e.source={required:!0,forRenderer:!0},e}},Jv=Il;var Ml=class extends We{static componentType="video";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.width={default:500,forRenderer:!0},e.height={default:500,forRenderer:!0},e.youtube={default:null,forRenderer:!0},e.source={default:null,forRenderer:!0},e}actions={recordVideoStarted:this.recordVideoStarted.bind(this),recordVideoWatched:this.recordVideoWatched.bind(this),recordVideoPaused:this.recordVideoPaused.bind(this),recordVideoSkipped:this.recordVideoSkipped.bind(this),recordVideoCompleted:this.recordVideoCompleted.bind(this)};recordVideoStarted({beginTime:t,duration:e,rate:n}){this.coreFunctions.requestRecordEvent({verb:"played",object:{componentName:this.componentName,componentType:this.componentType,duration:e},context:{startingPoint:t,rate:n}})}recordVideoWatched({beginTime:t,endTime:e,duration:n,rates:r}){this.coreFunctions.requestRecordEvent({verb:"watched",object:{componentName:this.componentName,componentType:this.componentType,duration:n},context:{startingPoint:t,endingPoint:e,rates:r}})}recordVideoPaused({endTime:t,duration:e}){this.coreFunctions.requestRecordEvent({verb:"paused",object:{componentName:this.componentName,componentType:this.componentType,duration:e},context:{endingPoint:t}})}recordVideoSkipped({beginTime:t,endTime:e,duration:n}){this.coreFunctions.requestRecordEvent({verb:"skipped",object:{componentName:this.componentName,componentType:this.componentType,duration:n},context:{startingPoint:t,endingPoint:e}})}recordVideoCompleted({duration:t}){this.coreFunctions.requestRecordEvent({verb:"completed",object:{componentName:this.componentName,componentType:this.componentType,duration:t}})}},Yv=Ml;var Ol=class extends We{static componentType="embed";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.width={default:500,forRenderer:!0},e.height={default:500,forRenderer:!0},e.geogebra={default:null,forRenderer:!0},e.fromMathInsight={default:null,forRenderer:!0},e.encodedGeogebraContent={default:null,forRenderer:!0},e}},Qv=Ol;var El=class extends _e{static componentType="meta";static createPropertiesObject(){return{keywords:{isArray:!0,singularName:"keyword"}}}},ey=El;var Pl=class extends We{static componentType="hint";static includeBlankStringChildren=!0;static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneTitle",componentType:"title",comparison:"atMost",number:1}),r=e.newLeaf({name:"atLeastZeroInline",componentType:"_inline",comparison:"atLeast",number:0}),i=e.newLeaf({name:"atLeastZeroBlock",componentType:"_block",comparison:"atLeast",number:0}),a=e.newOperator({name:"inlineOrBlock",operator:"or",propositions:[r,i]});return e.newOperator({name:"titleAndContent",operator:"and",propositions:[n,a],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.showHints={forRenderer:!0,returnDependencies:()=>({hide:{dependencyType:"stateVariable",variableName:"hide"},showHintsFlag:{dependencyType:"flag",flagName:"showHints"}}),definition({dependencyValues:e}){return{newValues:{showHints:e.showHintsFlag&&!e.hide}}}},t.open={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,returnDependencies:()=>({}),definition(){return{useEssentialOrDefaultValue:{open:{variablesToCheck:["open"]}}}},inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"open",value:e.open}]}}},t.titleDefinedByChildren={forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childLogicName:"atMostOneTitle"}}),definition({dependencyValues:e}){return{newValues:{titleDefinedByChildren:e.titleChild.length===1}}}},t.title={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({titleChild:{dependencyType:"child",childLogicName:"atMostOneTitle",variableNames:["text"]}}),definition({dependencyValues:e}){return e.titleChild.length===0?{newValues:{title:"Hint"}}:{newValues:{title:e.titleChild[0].stateValues.text}}}},t.childrenToRender={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"titleAndContent"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.children.map(n=>n.componentName)}}}},t}revealHint(){this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!0}],event:{verb:"viewed",object:{componentName:this.componentName,componentType:this.componentType}}})}closeHint(){this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!1}],event:{verb:"closed",object:{componentName:this.componentName,componentType:this.componentType}}})}actions={revealHint:this.revealHint.bind(this),closeHint:this.closeHint.bind(this)}},ty=Pl;var Ll=class extends We{constructor(t){super(t);this.revealSolution=this.revealSolution.bind(this),this.revealSolutionCallBack=this.revealSolutionCallBack.bind(this)}static componentType="solution";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return delete e.hide,e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneHide",componentType:"hide",comparison:"atMost",number:1}),r=e.newLeaf({name:"atLeastZeroInline",componentType:"_inline",comparison:"atLeast",number:0}),i=e.newLeaf({name:"atLeastZeroBlock",componentType:"_block",comparison:"atLeast",number:0});return e.newOperator({name:"inlineOrBlock",operator:"or",propositions:[n,r,i],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.hide={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,returnDependencies:()=>({hideChild:{dependencyType:"child",childLogicName:"atMostOneHide",variableNames:["value"]},displayMode:{dependencyType:"flag",flagName:"solutionDisplayMode"}}),definition({dependencyValues:e}){return e.displayMode==="none"?{newValues:{hide:!0}}:e.hideChild.length===1?{newValues:{hide:e.hideChild[0].stateValues.value}}:{useEssentialOrDefaultValue:{hide:{variablesToCheck:["hide"]}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){return n.displayMode==="none"?{success:!1}:n.hideChild.length===1?{success:!0,instructions:[{setDependency:"hideChild",desiredValue:e.hide,childIndex:0,variableIndex:0}]}:{success:!0,instructions:[{setSetVariable:"hide",value:e.hide}]}}},t.open={public:!0,componentType:"boolean",forRenderer:!0,defaultValue:!1,returnDependencies:()=>({displayMode:{dependencyType:"flag",flagName:"solutionDisplayMode"}}),definition({dependencyValues:e}){return e.displayMode==="displayed"?{newValues:{open:!0}}:e.displayMode==="none"?{newValues:{open:!1}}:{useEssentialOrDefaultValue:{open:{variablesToCheck:["open"]}}}},inverseDefinition({desiredStateVariableValues:e,dependencyValues:n}){return n.displayMode==="displayed"||n.displayMode==="none"?{success:!1}:{success:!0,instructions:[{setStateVariable:"open",value:e.open}]}}},t.canBeClosed={forRenderer:!0,returnDependencies:()=>({displayMode:{dependencyType:"flag",flagName:"solutionDisplayMode"}}),definition({dependencyValues:e}){return e.displayMode==="button"?{newValues:{canBeClosed:!0}}:{newValues:{canBeClosed:!1}}}},t.message={public:!0,componentType:"text",forRenderer:!0,defaultValue:"",returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{message:{variablesToCheck:["message"]}}}),inverseDefinition({desiredStateVariableValues:e}){return{success:!0,instructions:[{setStateVariable:"message",value:e.message}]}}},t.childrenToRender={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"inlineOrBlock"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.children.map(n=>n.componentName)}}}},t}revealSolutionCallBack({allowView:t,message:e,scoredComponent:n}){let r=[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:t},{updateType:"updateValue",componentName:this.componentName,stateVariable:"message",value:e}],i;t&&(r.push({updateType:"updateValue",componentName:n,stateVariable:"viewedSolution",value:!0}),i={verb:"viewed",object:{componentName:this.componentName,componentType:this.componentType}}),this.coreFunctions.requestUpdate({updateInstructions:r,event:i})}revealSolution(){let{scoredItemNumber:t,scoredComponent:e}=this.coreFunctions.calculateScoredItemNumberOfContainer(this.componentName);this.coreFunctions.recordSolutionView({itemNumber:t,scoredComponent:e,callBack:this.revealSolutionCallBack})}closeSolution(){this.coreFunctions.requestUpdate({updateInstructions:[{updateType:"updateValue",componentName:this.componentName,stateVariable:"open",value:!1}],event:{verb:"closed",object:{componentName:this.componentName,componentType:this.componentType}}})}actions={revealSolution:this.revealSolution.bind(this),closeSolution:this.closeSolution.bind(this)};static includeBlankStringChildren=!0},ry=Ll;var Rl=class extends Pe{static componentType="intcomma";static rendererType="text";static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.originalValue=t.value,mr({stateVariableDefinitions:t,oldName:"value",newName:"originalValue"}),t.value={public:!0,componentType:this.componentType,forRenderer:!0,returnDependencies:()=>({originalValue:{dependencyType:"stateVariable",variableName:"originalValue"}}),definition:function({dependencyValues:e}){let n=e.originalValue,r=/^(-?\d+)(\d{3})/,i=n.match(r);for(;i!==null;)n=n.replace(r,"$1,$2"),i=n.match(r);return{newValues:{value:n}}}},t}},ny=Rl;function Er(l){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Er=function(t){return typeof t}:Er=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(l)}function St(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function iy(l,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(l,n.key,n)}}function Zt(l,t,e){return t&&iy(l.prototype,t),e&&iy(l,e),l}function sr(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),t&&kl(l,t)}function Yi(l){return Yi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Yi(l)}function kl(l,t){return kl=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},kl(l,t)}function I1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(l){return!1}}function M1(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function O1(l,t){return t&&(typeof t=="object"||typeof t=="function")?t:M1(l)}function or(l){var t=I1();return function(){var n=Yi(l),r;if(t){var i=Yi(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return O1(this,r)}}var ay="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");function E1(l){l=l||"_";for(var t=l+"-",e=0;e<7;e++)t+=ay[Math.floor(Math.random()*ay.length)];return t}var sy=E1,oy={"!":"\xA1","?":"\xBF\u0241",'"':'\u201C\u201D"\u275D\u275E',"'":"\u2018\u201B\u275B\u275C","-":"\u2014\u2013",a:"\xAA\xC0\xC1\xC2\xC3\xC4\xC5\xE0\xE1\xE2\xE3\xE4\xE5\u0100\u0101\u0102\u0103\u0104\u0105\u01CD\u01CE\u01DE\u01DF\u01E0\u01E1\u01FA\u01FB\u0200\u0201\u0202\u0203\u0226\u0227\u023A\u0386\u0391\u0394\u039B\u03AC\u03B1\u03BB\u0410\u0430\u0434\u0466\u0467\u04D0\u04D1\u04D2\u04D3\u019B\u0245\xE6",b:"\xDF\xFE\u0180\u0181\u0182\u0183\u0184\u0185\u0243\u0392\u03B2\u03D0\u03E6\u0411\u0412\u042A\u042C\u0432\u044A\u044C\u0462\u0463\u048C\u048D",c:"\xA2\xA9\xC7\xE7\u0106\u0107\u0108\u0109\u010A\u010B\u010C\u010D\u0186\u0187\u0188\u023B\u023C\u037B\u037C\u037D\u03F2\u03F9\u03FD\u03FE\u0421\u0441\u0454\u0480\u0481\u04AA\u04AB",d:"\xD0\u010E\u010F\u0110\u0111\u0189\u018A\u0221\u018B\u018C\u01F7",e:"\xC8\xC9\xCA\xCB\xE8\xE9\xEA\xEB\u0112\u0113\u0114\u0115\u0116\u0117\u0118\u0119\u011A\u011B\u018E\u018F\u0190\u01DD\u0204\u0205\u0206\u0207\u0228\u0229\u0246\u0247\u0388\u0395\u039E\u03A3\u03AD\u03B5\u03BE\u03F1\u03F5\u03F6\u0400\u0401\u0415\u042D\u0435\u0450\u0451\u04BC\u04BD\u04BE\u04BF\u04D6\u04D7\u04D8\u04D9\u04DA\u04DB\u04EC\u04ED",f:"\u0191\u0192\u03DC\u03DD\u04FA\u04FB\u0492\u0493\u017F",g:"\u011C\u011D\u011E\u011F\u0120\u0121\u0122\u0123\u0193\u01E4\u01E5\u01E6\u01E7\u01F4\u01F5",h:"\u0124\u0125\u0126\u0127\u0195\u01F6\u021E\u021F\u0389\u0397\u0402\u040A\u040B\u041D\u043D\u0452\u045B\u04A2\u04A3\u04A4\u04A5\u04BA\u04BB\u04C9\u04CA",I:"\xCC\xCD\xCE\xCF",i:"\xEC\xED\xEE\xEF\u0128\u0129\u012A\u012B\u012C\u012D\u012E\u012F\u0130\u0131\u0196\u0197\u0208\u0209\u020A\u020B\u038A\u0390\u03AA\u03AF\u03B9\u03CA\u0406\u0407\u0456\u0457",j:"\u0134\u0135\u01F0\u0237\u0248\u0249\u03F3\u0408\u0458",k:"\u0136\u0137\u0138\u0198\u0199\u01E8\u01E9\u039A\u03BA\u040C\u0416\u041A\u0436\u043A\u045C\u049A\u049B\u049C\u049D\u049E\u049F\u04A0\u04A1",l:"\u0139\u013A\u013B\u013C\u013D\u013E\u013F\u0140\u0141\u0142\u019A\u01AA\u01C0\u01CF\u01D0\u0234\u023D\u0399\u04C0\u04CF",m:"\u039C\u03FA\u03FB\u041C\u043C\u04CD\u04CE",n:"\xD1\xF1\u0143\u0144\u0145\u0146\u0147\u0148\u0149\u014A\u014B\u019D\u019E\u01F8\u01F9\u0220\u0235\u039D\u03A0\u03AE\u03B7\u03DE\u040D\u0418\u0419\u041B\u041F\u0438\u0439\u043B\u043F\u045D\u048A\u048B\u04C5\u04C6\u04E2\u04E3\u04E4\u04E5\u03C0",o:"\xD2\xD3\xD4\xD5\xD6\xD8\xF0\xF2\xF3\xF4\xF5\xF6\xF8\u014C\u014D\u014E\u014F\u0150\u0151\u019F\u01A0\u01A1\u01D1\u01D2\u01EA\u01EB\u01EC\u01ED\u01FE\u01FF\u020C\u020D\u020E\u020F\u022A\u022B\u022C\u022D\u022E\u022F\u0230\u0231\u038C\u0398\u039F\u03B8\u03BF\u03C3\u03CC\u03D5\u03D8\u03D9\u03EC\u03ED\u03F4\u041E\u0424\u043E\u0472\u0473\u04E6\u04E7\u04E8\u04E9\u04EA\u04EB",p:"\u01A4\u01BF\u03A1\u03C1\u03F7\u03F8\u03FC\u0420\u0440\u048E\u048F\xDE",q:"\u024A\u024B",r:"\u0154\u0155\u0156\u0157\u0158\u0159\u01A6\u0210\u0211\u0212\u0213\u024C\u024D\u0403\u0413\u042F\u0433\u044F\u0453\u0490\u0491",s:"\u015A\u015B\u015C\u015D\u015E\u015F\u0160\u0161\u01A7\u01A8\u0218\u0219\u023F\u0405\u0455",t:"\u0162\u0163\u0164\u0165\u0166\u0167\u01AB\u01AC\u01AD\u01AE\u021A\u021B\u0236\u023E\u0393\u03A4\u03C4\u03EE\u0422\u0442",u:"\xB5\xD9\xDA\xDB\xDC\xF9\xFA\xFB\xFC\u0168\u0169\u016A\u016B\u016C\u016D\u016E\u016F\u0170\u0171\u0172\u0173\u01AF\u01B0\u01B1\u01B2\u01D3\u01D4\u01D5\u01D6\u01D7\u01D8\u01D9\u01DA\u01DB\u01DC\u0214\u0215\u0216\u0217\u0244\u03B0\u03BC\u03C5\u03CB\u03CD",v:"\u03BD\u0474\u0475\u0476\u0477",w:"\u0174\u0175\u019C\u03C9\u03CE\u03D6\u03E2\u03E3\u0428\u0429\u0448\u0449\u0461\u047F",x:"\xD7\u03A7\u03C7\u03D7\u03F0\u0425\u0445\u04B2\u04B3\u04FC\u04FD\u04FE\u04FF",y:"\xDD\xFD\xFF\u0176\u0177\u0178\u01B3\u01B4\u0232\u0233\u024E\u024F\u038E\u03A5\u03AB\u03B3\u03C8\u03D2\u03D3\u03D4\u040E\u0423\u0443\u0447\u045E\u0470\u0471\u04AE\u04AF\u04B0\u04B1\u04EE\u04EF\u04F0\u04F1\u04F2\u04F3",z:"\u0179\u017A\u017B\u017C\u017D\u017E\u01A9\u01B5\u01B6\u0224\u0225\u0240\u0396\u03B6"},Fl={};Object.keys(oy).forEach(function(l){oy[l].split("").forEach(function(t){Fl[t]=l})});var P1=function(t){var e=t.split("");return e.forEach(function(n,r){Fl[n]&&(e[r]=Fl[n])}),e.join("")},Bl=P1,L1=/([A-Z]\.)+[A-Z]?,?$/,R1=/^[A-Z]\.,?$/,k1=/[A-Z]{2,}('s|,)?$/,F1=/([a-z]\.)+[a-z]\.?$/,B1=function(t){return L1.test(t)===!0||F1.test(t)===!0||R1.test(t)===!0||k1.test(t)===!0},ly=B1,z1=/[a-z\u00C0-\u00FF] ?\/ ?[a-z\u00C0-\u00FF]/,q1=function(t){t=t||"",t=t.toLowerCase(),t=t.trim();var e=t;return t=Bl(t),z1.test(t)===!0&&(t=t.replace(/\/.*/,"")),t=t.replace(/^[#@]/,""),t=t.replace(/[,;.!?]+$/,""),t=t.replace(/[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]+/g,"'"),t=t.replace(/[\u0022\u00AB\u00BB\u201C\u201D\u201E\u201F\u2033\u2034\u2036\u2037\u2E42\u301D\u301E\u301F\uFF02]+/g,'"'),t=t.replace(/\u2026/g,"..."),t=t.replace(/\u2013/g,"-"),t=t.replace(/([aeiou][ktrp])in$/,"$1ing"),/^(re|un)-?[^aeiou]./.test(t)===!0&&(t=t.replace("-","")),ly(t)&&(t=t.replace(/\./g,"")),/^[:;]/.test(t)===!1&&(t=t.replace(/\.{3,}$/g,""),t=t.replace(/[",\.!:;\?\)]+$/g,""),t=t.replace(/^['"\(]+/g,"")),t=t.replace(/[\u200B-\u200D\uFEFF]/g,""),t=t.trim(),t===""&&(t=e),t=t.replace(/([0-9]),([0-9])/g,"$1$2"),t},j1=q1,U1=function(t){return t=t.replace(/[']s$/,""),t=t.replace(/s[']$/,"s"),t},H1=U1,K1=/^[ \n\t\.\[\](){}:,!\-?;\/&*^%+=~\|\u0022\uFF02\u0027\u201C\u201F\u201B\u201E\u2E42\u201A\u2035\u2036\u2037\u301D\u0060\u301F]+/,W1=/[ \n\t\.'\[\](){}:,!\-?;\/&*@^#+=~\|\u0022\uFF02\u201D\u00B4\u301E]+$/,uy=/\//,zl=/[']/,G1=/^[a-z]\.([a-z]\.)+/i,Z1=/^[-+\.][0-9]/,X1=/^'[0-9]{2}/,J1=function(t){var e=t,n="",r="";t=t.replace(K1,function(s){return n=s,(n==="-"||n==="+"||n===".")&&Z1.test(t)||n==="'"&&X1.test(t)?(n="",s):""}),t=t.replace(W1,function(s){return r=s,zl.test(s)&&/[sn][']$/.test(e)&&zl.test(n)===!1?(r=r.replace(zl,""),"'"):G1.test(t)===!0?(r=r.replace(/\./,""),"."):""}),t===""&&(e=e.replace(/ *$/,function(s){return r=s||"",""}),t=e,n="",r=r);var i=j1(t),a={text:t,clean:i,reduced:H1(i),pre:n,post:r};return uy.test(t)&&t.split(uy).forEach(function(s){a.alias=a.alias||{},a.alias[s.trim()]=!0}),a},cy=J1;function Ft(l){var t={exports:{}};return l(t,t.exports),t.exports}var Y1=Ft(function(l,t){var e=/^[A-Z][a-z'\u00C0-\u00FF]/,n=/^[A-Z]+s?$/;t.toUpperCase=function(){return this.text=this.text.toUpperCase(),this},t.toLowerCase=function(){return this.text=this.text.toLowerCase(),this},t.toTitleCase=function(){return this.text=this.text.replace(/^ *[a-z\u00C0-\u00FF]/,function(r){return r.toUpperCase()}),this},t.isUpperCase=function(){return n.test(this.text)},t.isTitleCase=function(){return e.test(this.text)},t.titleCase=t.isTitleCase}),Q1=Ft(function(l,t){var e=/(\u0022|\uFF02|\u0027|\u201C|\u2018|\u201F|\u201B|\u201E|\u2E42|\u201A|\u00AB|\u2039|\u2035|\u2036|\u2037|\u301D|\u0060|\u301F)/,n=/(\u0022|\uFF02|\u0027|\u201D|\u2019|\u201D|\u2019|\u201D|\u201D|\u2019|\u00BB|\u203A|\u2032|\u2033|\u2034|\u301E|\u00B4|\u301E)/;t.hasPost=function(r){return this.post.indexOf(r)!==-1},t.hasPre=function(r){return this.pre.indexOf(r)!==-1},t.hasQuote=function(){return e.test(this.pre)||n.test(this.post)},t.hasQuotation=t.hasQuote,t.hasComma=function(){return this.hasPost(",")},t.hasPeriod=function(){return this.hasPost(".")===!0&&this.hasPost("...")===!1},t.hasExclamation=function(){return this.hasPost("!")},t.hasQuestionMark=function(){return this.hasPost("?")||this.hasPost("\xBF")},t.hasEllipses=function(){return this.hasPost("..")||this.hasPost("\u2026")||this.hasPre("..")||this.hasPre("\u2026")},t.hasSemicolon=function(){return this.hasPost(";")},t.hasSlash=function(){return/\//.test(this.text)},t.hasHyphen=function(){var r=/^(-||)$/;return r.test(this.post)||r.test(this.pre)},t.hasDash=function(){var r=/ (-||) /;return r.test(this.post)||r.test(this.pre)},t.hasContraction=function(){return Boolean(this.implicit)},t.addPunctuation=function(r){return(r===","||r===";")&&(this.post=this.post.replace(r,"")),this.post=r+this.post,this}}),e0=function(t,e){var n=t.length,r=e.length;if(n===0)return r;if(r===0)return n;var i=(r>n?r:n)+1;if(Math.abs(n-r)>(i||100))return i||100;for(var a=[],s=0;s<i;s++)a[s]=[s],a[s].length=i;for(var o=0;o<i;o++)a[0][o]=o;for(var u,c,f,p,d,m,v=1;v<=n;++v)for(c=t[v-1],u=1;u<=r;++u){if(v===u&&a[v][u]>4)return n;f=e[u-1],p=c===f?0:1,d=a[v-1][u]+1,(m=a[v][u-1]+1)<d&&(d=m),(m=a[v-1][u-1]+p)<d&&(d=m);var h=v>1&&u>1&&c===e[u-2]&&t[v-2]===f&&(m=a[v-2][u-2]+p)<d;h?a[v][u]=m:a[v][u]=d}return a[n][r]},t0=function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3;if(t===e)return 1;if(t.length<n||e.length<n)return 0;var r=e0(t,e),i=Math.max(t.length,e.length),a=i===0?0:r/i,s=1-a;return s},fy=t0,Qi=function(){},r0=function(t,e,n,r){if(e.id===t.id||e.anything===!0)return!0;if(e.start===!0&&n!==0||e.end===!0&&n!==r-1)return!1;if(e.word!==void 0){if(t.implicit!==null&&t.implicit===e.word||t.alias!==void 0&&t.alias.hasOwnProperty(e.word)||e.soft===!0&&e.word===t.root)return!0;if(e.fuzzy!==void 0){var i=fy(e.word,t.reduced);if(i>e.fuzzy||e.soft===!0&&(i=fy(e.word,t.root),i>e.fuzzy))return!0}return e.word===t.clean||e.word===t.text||e.word===t.reduced}return e.tag!==void 0?t.tags[e.tag]===!0:e.method!==void 0?typeof t[e.method]=="function"&&t[e.method]()===!0:e.regex!==void 0?e.regex.test(t.clean):e.fastOr!==void 0?t.implicit&&e.fastOr.hasOwnProperty(t.implicit)===!0?!0:e.fastOr.hasOwnProperty(t.reduced)||e.fastOr.hasOwnProperty(t.text):e.choices!==void 0?e.operator==="and"?e.choices.every(function(a){return Qi(t,a,n,r)}):e.choices.some(function(a){return Qi(t,a,n,r)}):!1};Qi=function(t,e,n,r){var i=r0(t,e,n,r);return e.negative===!0?!i:i};var n0=Qi,i0={},a0=function(t,e,n){return n0(this,t,e,n)},s0=function(){return ly(this.text)},o0=function(){return this.text===""&&Boolean(this.implicit)},l0=function(){return Object.keys(this.tags).some(function(t){return i0[t]!==!0})},u0=function(t){var e=t.transforms,n=this.implicit||this.clean;if(this.tags.Plural&&(n=e.toSingular(n,t)),this.tags.Verb&&!this.tags.Negative&&!this.tags.Infinitive){var r=null;this.tags.PastTense?r="PastTense":this.tags.Gerund?r="Gerund":this.tags.PresentTense?r="PresentTense":this.tags.Participle?r="Participle":this.tags.Actor&&(r="Actor"),n=e.toInfinitive(n,t,r)}this.root=n},c0={doesMatch:a0,isAcronym:s0,isImplicit:o0,isKnown:l0,setRoot:u0},f0=/[\s-]/,p0=/^[A-Z-]+$/,d0=function(t,e,n){t=t||{};var r=this.text,i=this.pre,a=this.post;return t.reduced===!0&&(r=this.reduced||""),t.root===!0&&(r=this.root||""),t.implicit===!0&&this.implicit&&(r=this.implicit||""),t.normal===!0&&(r=this.clean||this.text||""),t.root===!0&&(r=this.root||this.reduced||""),t.unicode===!0&&(r=Bl(r)),t.titlecase===!0&&(this.tags.ProperNoun&&!this.titleCase()||(this.tags.Acronym?r=r.toUpperCase():p0.test(r)&&!this.tags.Acronym&&(r=r.toLowerCase()))),t.lowercase===!0&&(r=r.toLowerCase()),t.acronyms===!0&&this.tags.Acronym&&(r=r.replace(/\./g,"")),(t.whitespace===!0||t.root===!0)&&(i="",a=" ",(f0.test(this.post)===!1||t.last)&&!this.implicit&&(a="")),t.punctuation===!0&&!t.root&&(this.hasPost(".")===!0?a="."+a:this.hasPost("?")===!0?a="?"+a:this.hasPost("!")===!0?a="!"+a:this.hasPost(",")===!0?a=","+a:this.hasEllipses()===!0&&(a="..."+a)),e!==!0&&(i=""),n!==!0&&(a=""),t.abbreviations===!0&&this.tags.Abbreviation&&(a=a.replace(/^\./,"")),i+r+a},m0={textOut:d0},h0={Auxiliary:1,Possessive:1},v0=function(t,e){var n=Object.keys(t.tags),r=e.tags;return n=n.sort(function(i,a){return h0[a]||!r[a]?-1:r[a]?r[i]?r[i].lineage.length>r[a].lineage.length?1:r[i].isA.length>r[a].isA.length?-1:0:0:1}),n},y0=v0,g0={text:!0,tags:!0,implicit:!0,whitespace:!0,clean:!1,id:!1,index:!1,offset:!1,bestTag:!1},b0=function(t,e){t=t||{},t=Object.assign({},g0,t);var n={};return t.text&&(n.text=this.text),t.normal&&(n.normal=this.clean),t.tags&&(n.tags=Object.keys(this.tags)),t.clean&&(n.clean=this.clean),(t.id||t.offset)&&(n.id=this.id),t.implicit&&this.implicit!==null&&(n.implicit=this.implicit),t.whitespace&&(n.pre=this.pre,n.post=this.post),t.bestTag&&(n.bestTag=y0(this,e)[0]),n},x0={json:b0},C0=Object.assign({},Y1,Q1,c0,m0,x0);function py(){return typeof window!="undefined"&&window.document}var Vn=function(t,e){for(t=t.toString();t.length<e;)t+=" ";return t},N0=function(t,e,n){if(py()){console.log("%c"+Vn(t.clean,3)+"  + "+e+" ","color: #6accb2;");return}var r="[33m"+Vn(t.clean,15)+"[0m + [32m"+e+"[0m ";n&&(r=Vn(r,35)+" "+n+""),console.log(r)},w0=function(t,e,n){if(py()){console.log("%c"+Vn(t.clean,3)+"  - "+e+" ","color: #AB5850;");return}var r="[33m"+Vn(t.clean,3)+" [31m - #"+e+"[0m ";n&&(r=Vn(r,35)+" "+n),console.log(r)},T0=function(t){return Object.prototype.toString.call(t)==="[object Array]"},_0=function(t){return t.charAt(0).toUpperCase()+t.substr(1)},ii={logTag:N0,logUntag:w0,isArray:T0,titleCase:_0},dy=function(t,e,n,r){var i=r.tags;if(!(e===""||e==="."||e==="-")&&(e[0]==="#"&&(e=e.replace(/^#/,"")),e=ii.titleCase(e),t.tags[e]!==!0)){var a=r.isVerbose();a===!0&&ii.logTag(t,e,n),t.tags[e]=!0,i.hasOwnProperty(e)===!0&&(i[e].isA.forEach(function(s){t.tags[s]=!0,a===!0&&ii.logTag(t,"\u2192 "+s)}),t.unTag(i[e].notA,"\u2190",r))}},A0=function(t,e,n,r){if(typeof e!="string")for(var i=0;i<e.length;i++)dy(t,e[i],n,r);else dy(t,e,n,r)},my=A0,$0=/^[a-z]/,S0=function(t){return t.charAt(0).toUpperCase()+t.substr(1)},hy=function(t,e,n,r){var i=r.isVerbose();if(e==="*")return t.tags={},t;e=e.replace(/^#/,""),$0.test(e)===!0&&(e=S0(e)),t.tags[e]===!0&&(delete t.tags[e],i===!0&&ii.logUntag(t,e,n));var a=r.tags;if(a[e])for(var s=a[e].lineage,o=0;o<s.length;o++)t.tags[s[o]]===!0&&(delete t.tags[s[o]],i===!0&&ii.logUntag(t," - "+s[o]));return t},D0=function(t,e,n,r){if(typeof e!="string"&&e){for(var i=0;i<e.length;i++)hy(t,e[i],n,r);return}hy(t,e,n,r)},V0=D0,I0=function l(t,e,n){var r=n.tags;if(e[0]==="#"&&(e=e.replace(/^#/,"")),r[e]===void 0)return!0;for(var i=r[e].notA||[],a=0;a<i.length;a++)if(t.tags[i[a]]===!0)return!1;return r[e].isA!==void 0?l(t,r[e].isA,n):!0},vy=I0,M0=function(t,e,n){return my(this,t,e,n),this},O0=function(t,e,n){return vy(this,t,n)&&my(this,t,e,n),this},E0=function(t,e,n){return V0(this,t,e,n),this},P0=function(t,e){return vy(this,t,e)},L0={tag:M0,tagSafe:O0,unTag:E0,canBe:P0},ai=function(){function l(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";St(this,l),t=String(t);var e=cy(t);this.text=e.text||"",this.clean=e.clean,this.reduced=e.reduced,this.root=null,this.implicit=null,this.pre=e.pre||"",this.post=e.post||"",this.tags={},this.prev=null,this.next=null,this.id=sy(e.clean),this.isA="Term",e.alias&&(this.alias=e.alias)}return Zt(l,[{key:"set",value:function(e){var n=cy(e);return this.text=n.text,this.clean=n.clean,this}}]),l}();ai.prototype.clone=function(){var l=new ai(this.text);return l.pre=this.pre,l.post=this.post,l.clean=this.clean,l.reduced=this.reduced,l.root=this.root,l.implicit=this.implicit,l.tags=Object.assign({},this.tags),l};Object.assign(ai.prototype,C0);Object.assign(ai.prototype,L0);var ql=ai,R0=function(t){if(this.length===0)return[];if(this.cache.terms)return t!==void 0?this.cache.terms[t]:this.cache.terms;for(var e=[this.pool.get(this.start)],n=0;n<this.length-1;n+=1){var r=e[e.length-1].next;if(r===null){console.error("Compromise error: Linked list broken in phrase '"+this.start+"'");break}var i=this.pool.get(r);if(e.push(i),t!==void 0&&t===n)return e[t]}return t===void 0&&(this.cache.terms=e),t!==void 0?e[t]:e},k0=function(t){var e=this;if(t){var n=this.buildFrom(this.start,this.length);return n.cache=this.cache,n}var r=this.terms(),i=r.map(function(a){return a.clone()});return i.forEach(function(a,s){e.pool.add(a),i[s+1]&&(a.next=i[s+1].id),i[s-1]&&(a.prev=i[s-1].id)}),this.buildFrom(i[0].id,i.length)},F0=function(){var t=this.terms();return t[t.length-1]},B0=function(t){if(this.length===0||!t)return!1;if(this.start===t)return!0;if(this.cache.terms){for(var e=this.cache.terms,n=0;n<e.length;n++)if(e[n].id===t)return!0;return!1}for(var r=this.start,i=0;i<this.length-1;i+=1){var a=this.pool.get(r);if(a===void 0)return console.error("Compromise error: Linked list broken. Missing term '".concat(r,"' in phrase '").concat(this.start,`'
`)),!1;if(a.next===t)return!0;r=a.next}return!1},z0=function(){return this.terms().filter(function(t){return t.text!==""}).length},q0=function(){for(var t=this.terms(0);t.prev;)t=this.pool.get(t.prev);for(var e=t.id,n=1;t.next;)t=this.pool.get(t.next),n+=1;return this.buildFrom(e,n)},j0={terms:R0,clone:k0,lastTerm:F0,hasId:B0,wordCount:z0,fullSentence:q0},U0=function(t){return t.replace(/ +$/,"")},H0=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;typeof t=="string"&&(t==="normal"?t={whitespace:!0,unicode:!0,lowercase:!0,punctuation:!0,acronyms:!0,abbreviations:!0,implicit:!0,normal:!0}:t==="clean"?t={titlecase:!1,lowercase:!0,punctuation:!0,whitespace:!0,unicode:!0,implicit:!0,normal:!0}:t==="reduced"?t={punctuation:!1,titlecase:!1,lowercase:!0,whitespace:!0,unicode:!0,implicit:!0,reduced:!0}:t==="implicit"?t={punctuation:!0,implicit:!0,whitespace:!0,trim:!0}:t==="root"?t={titlecase:!1,lowercase:!0,punctuation:!0,whitespace:!0,unicode:!0,implicit:!0,root:!0}:t={});var r=this.terms(),i=!1;r[0]&&r[0].prev===null&&r[r.length-1].next===null&&(i=!0);var a=r.reduce(function(s,o,u){if(u===0&&o.text===""&&o.implicit!==null&&!t.implicit)return s;t.last=n&&u===r.length-1;var c=!0,f=!0;i===!1&&(u===0&&e&&(c=!1),u===r.length-1&&n&&(f=!1));var p=o.textOut(t,c,f);return s+p},"");return i===!0&&n&&(a=U0(a)),t.trim===!0&&(a=a.trim()),a},K0={text:H0},W0=function(){var t=this.terms();if(t.length>0){t[0].pre=t[0].pre.replace(/^\s+/,"");var e=t[t.length-1];e.post=e.post.replace(/\s+$/,"")}return this},G0={trim:W0},Z0=/[.?!]\s*$/,X0=function(t,e){if(Z0.test(e)){var n=t.match(/\s*$/);return e+n}return t},J0=function(t,e){e[0].pre=t[0].pre;var n=t[t.length-1],r=e[e.length-1];r.post=X0(n.post,r.post),n.post="",n.post===""&&(n.post+=" ")},Y0=function(t,e,n){var r=t[t.length-1],i=e[e.length-1],a=r.next;if(r.next=e[0].id,i.next=a,a){var s=n.get(a);s.prev=i.id}var o=t[0].id;if(o){var u=e[0];u.prev=o}},Q0=function(t){return t.filter(function(e,n){return t.indexOf(e)===n})},ex=function(t,e,n){var r=t.terms(),i=e.terms();J0(r,i),Y0(r,i,t.pool);var a=[t],s=t.start,o=[n];return o=o.concat(n.parents()),o.forEach(function(u){var c=u.list.filter(function(f){return f.hasId(s)});a=a.concat(c)}),a=Q0(a),a.forEach(function(u){u.length+=e.length}),t.cache={},t},yy=ex,tx=/ /,rx=function(t){var e=t[t.length-1];tx.test(e.post)===!1&&(e.post+=" ")},nx=function(t,e,n){var r=n[n.length-1];r.next=t.start;var i=t.pool,a=i.get(t.start);if(a.prev){var s=i.get(a.prev);s.next=e.start}n[0].prev=t.terms(0).prev,t.terms(0).prev=r.id},ix=function(t){return t.filter(function(e,n){return t.indexOf(e)===n})},ax=function(t,e,n){var r=t.start,i=e.terms();rx(i),nx(t,e,i);var a=[t],s=[n];return s=s.concat(n.parents()),s.forEach(function(o){var u=o.list.filter(function(c){return c.hasId(r)||c.hasId(e.start)});a=a.concat(u)}),a=ix(a),a.forEach(function(o){o.length+=e.length,o.start===r&&(o.start=e.start),o.cache={}}),t},sx=ax,ox=function(t,e,n,r){var i=t.parents();i.push(t),i.forEach(function(a){var s=a.list.find(function(o){return o.hasId(e)});!s||(s.length-=n,s.start===e&&(s.start=r.id),s.cache={})}),t.list=t.list.filter(function(a){return!(!a.start||!a.length)})},lx=function(t,e){var n=e.pool(),r=t.terms(),i=n.get(r[0].prev)||{},a=n.get(r[r.length-1].next)||{};r[0].implicit&&i.implicit&&(i.set(i.implicit),i.post+=" "),ox(e,t.start,t.length,a),i&&(i.next=a.id),a&&(a.prev=i.id)},gy=lx,ux=function(t,e){return yy(this,t,e),this},cx=function(t,e){return sx(this,t,e),this},fx=function(t){return gy(this,t),this},px=function(t,e){var n=this.length;yy(this,t,e);var r=this.buildFrom(this.start,this.length);r.length=n,gy(r,e)},dx=function(t){var e=this.terms(),n={before:null,match:null,after:null},r=e.findIndex(function(o){return o.id===t.start});if(r===-1)return n;var i=e.slice(0,r);i.length>0&&(n.before=this.buildFrom(i[0].id,i.length));var a=e.slice(r,r+t.length);a.length>0&&(n.match=this.buildFrom(a[0].id,a.length));var s=e.slice(r+t.length,e.length);return s.length>0&&(n.after=this.buildFrom(s[0].id,s.length,this.pool)),n},mx={append:ux,prepend:cx,delete:fx,replace:px,splitOn:dx},hx=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n={};return t.text&&(n.text=this.text()),t.normal&&(n.normal=this.text("normal")),t.clean&&(n.clean=this.text("clean")),t.reduced&&(n.reduced=this.text("reduced")),t.implicit&&(n.implicit=this.text("implicit")),t.root&&(n.root=this.text("root")),t.trim&&(n.text&&(n.text=n.text.trim()),n.normal&&(n.normal=n.normal.trim()),n.reduced&&(n.reduced=n.reduced.trim())),t.terms&&(t.terms===!0&&(t.terms={}),n.terms=this.terms().map(function(r){return r.json(t.terms,e)})),n},vx={json:hx},yx=function(t){t||(t=".*");var e=this.pool,n=[],r=function o(u){var c=e.get(u);!c||(n.push(c),c.prev&&o(c.next))},i=this.terms(),a=i[i.length-1];if(r(a.next),n.length===0)return[];var s=this.buildFrom(n[0].id,n.length);return s.match(t)},gx=function(t){t||(t=".*");var e=this.pool,n=[],r=function s(o){var u=e.get(o);!u||(n.push(u),u.prev&&s(u.prev))},i=e.get(this.start);if(r(i.prev),n.length===0)return[];var a=this.buildFrom(n[n.length-1].id,n.length);return a.match(t)},bx={lookAhead:yx,lookBehind:gx},xx=Object.assign({},j0,K0,G0,mx,vx,bx),Cx=function(t,e){if(e.length===0)return!0;for(var n=0;n<e.length;n+=1){var r=e[n];if(r.optional!==!0&&r.negative!==!0&&r.start===!0&&n>0||r.anything===!0&&r.negative===!0)return!0}return!1},Nx=Cx,yr=Ft(function(l,t){t.getGreedy=function(e,n){for(var r=Object.assign({},e.regs[e.r],{start:!1,end:!1}),i=e.t;e.t<e.terms.length;e.t+=1){if(n&&e.terms[e.t].doesMatch(n,e.start_i+e.t,e.phrase_length))return e.t;var a=e.t-i+1;if(r.max!==void 0&&a===r.max)return e.t;if(e.terms[e.t].doesMatch(r,e.start_i+e.t,e.phrase_length)===!1)return r.min!==void 0&&a<r.min?null:e.t}return e.t},t.greedyTo=function(e,n){var r=e.t;if(!n)return e.terms.length;for(;r<e.terms.length;r+=1)if(e.terms[r].doesMatch(n,e.start_i+r,e.phrase_length)===!0)return r;return null},t.isEndGreedy=function(e,n){if(e.end===!0&&e.greedy===!0&&n.start_i+n.t<n.phrase_length-1){var r=Object.assign({},e,{end:!1});if(n.terms[n.t].doesMatch(r,n.start_i+n.t,n.phrase_length)===!0)return!0}return!1},t.doOrBlock=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e.regs[e.r],i=!1,a=0;a<r.choices.length;a+=1){var s=r.choices[a];if(i=s.every(function(o,u){var c=0,f=e.t+u+n+c;if(e.terms[f]===void 0)return!1;var p=e.terms[f].doesMatch(o,f+e.start_i,e.phrase_length);if(p===!0&&o.greedy===!0)for(var d=1;d<e.terms.length;d+=1){var m=e.terms[f+d];if(m){var v=m.doesMatch(o,e.start_i+d,e.phrase_length);if(v===!0)c+=1;else break}}return n+=c,p}),i){n+=s.length;break}}return i&&r.greedy===!0?t.doOrBlock(e,n):n},t.doAndBlock=function(e){var n=0,r=e.regs[e.r],i=r.choices.every(function(a){var s=a.every(function(o,u){var c=e.t+u;return e.terms[c]===void 0?!1:e.terms[c].doesMatch(o,c,e.phrase_length)});return s===!0&&a.length>n&&(n=a.length),s});return i===!0?n:!1},t.getGroup=function(e,n,r){if(e.groups[e.groupId])return e.groups[e.groupId];var i=e.terms[n].id;return e.groups[e.groupId]={group:String(r),start:i,length:0},e.groups[e.groupId]}}),wx=function(t,e,n,r){for(var i={t:0,terms:t,r:0,regs:e,groups:{},start_i:n,phrase_length:r,hasGroup:!1,groupId:null,previousGroup:null};i.r<e.length;i.r+=1){var a=e[i.r];if(i.hasGroup=typeof a.named=="string"||typeof a.named=="number",i.hasGroup===!0){var s=e[i.r-1];s&&s.named===a.named&&i.previousGroup?i.groupId=i.previousGroup:(i.groupId=sy(a.named),i.previousGroup=i.groupId)}if(!i.terms[i.t]){var o=e.slice(i.r).some(function(_){return!_.optional});if(o===!1)break;return null}if(a.anything===!0&&a.greedy===!0){var u=yr.greedyTo(i,e[i.r+1]);if(a.min!==void 0&&u-i.t<a.min)return null;if(a.max!==void 0&&u-i.t>a.max){i.t=i.t+a.max;continue}if(u===null)return null;if(i.hasGroup===!0){var c=yr.getGroup(i,i.t,a.named);c.length=u-i.t}i.t=u;continue}if(a.choices!==void 0&&a.operator==="or"){var f=yr.doOrBlock(i);if(f){if(a.negative===!0)return null;if(i.hasGroup===!0){var p=yr.getGroup(i,i.t,a.named);p.length+=f}i.t+=f;continue}else if(!a.optional)return null}if(a.choices!==void 0&&a.operator==="and"){var d=yr.doAndBlock(i);if(d){if(a.negative===!0)return null;if(i.hasGroup===!0){var m=yr.getGroup(i,i.t,a.named);m.length+=d}i.t+=d;continue}else if(!a.optional)return null}var v=i.terms[i.t],h=v.doesMatch(a,i.start_i+i.t,i.phrase_length);if(a.anything===!0||h===!0||yr.isEndGreedy(a,i)){var y=i.t;if(a.optional&&e[i.r+1]&&a.negative)continue;if(a.optional&&e[i.r+1]){var g=v.doesMatch(e[i.r+1],i.start_i+i.t,i.phrase_length);if(a.negative||g){var b=i.terms[i.t+1];(!b||!b.doesMatch(e[i.r+1],i.start_i+i.t,i.phrase_length))&&(i.r+=1)}}if(i.t+=1,a.end===!0&&i.t!==i.terms.length&&a.greedy!==!0||a.greedy===!0&&(i.t=yr.getGreedy(i,e[i.r+1]),i.t===null||a.min&&a.min>i.t||a.end===!0&&i.start_i+i.t!==r))return null;if(i.hasGroup===!0){var x=yr.getGroup(i,y,a.named);i.t>1&&a.greedy?x.length+=i.t-y:x.length++}continue}if(a.negative){var N=Object.assign({},a);N.negative=!1;var C=i.terms[i.t].doesMatch(N,i.start_i+i.t,i.phrase_length);if(C===!0)return null}if(a.optional!==!0){if(i.terms[i.t].isImplicit()&&e[i.r-1]&&i.terms[i.t+1]){if(i.terms[i.t-1]&&i.terms[i.t-1].implicit===e[i.r-1].word)return null;if(i.terms[i.t+1].doesMatch(a,i.start_i+i.t,i.phrase_length)){i.t+=2;continue}}return null}}return{match:i.terms.slice(0,i.t),groups:i.groups}},by=wx,Tx=function(t,e,n){if(!n||n.length===0)return n;var r=e.some(function(a){return a.end});if(r){var i=t[t.length-1];n=n.filter(function(a){var s=a.match;return s.indexOf(i)!==-1})}return n},ea=Tx,_x=/(?:^|\s)([\!\[\^]*(?:<[^<]*>)?\/.*?[^\\\/]\/[\?\]\+\*\$~]*)(?:\s|$)/,Ax=/([\!\[\^]*(?:<[^<]*>)?\([^\)]+[^\\\)]\)[\?\]\+\*\$~]*)(?:\s|$)/,$x=/ /g,Sx=function(t){return/^[\!\[\^]*(<[^<]*>)?\(/.test(t)&&/\)[\?\]\+\*\$~]*$/.test(t)},xy=function(t){return/^[\!\[\^]*(<[^<]*>)?\//.test(t)&&/\/[\?\]\+\*\$~]*$/.test(t)},Cy=function(t){return t=t.map(function(e){return e.trim()}),t=t.filter(function(e){return e}),t},Dx=function(t){var e=t.split(_x),n=[];e.forEach(function(i){if(xy(i)){n.push(i);return}n=n.concat(i.split(Ax))}),n=Cy(n);var r=[];return n.forEach(function(i){Sx(i)||xy(i)?r.push(i):r=r.concat(i.split($x))}),r=Cy(r),r},Vx=Dx,Ny=/\{([0-9]+,?[0-9]*)\}/,wy=/&&/,Ix=new RegExp(/^<\s*?(\S+)\s*?>/),Mx=function(t){return t.charAt(0).toUpperCase()+t.substr(1)},gr=function(t){return t[t.length-1]},lr=function(t){return t[0]},In=function(t){return t.substr(1)},Mn=function(t){return t.substr(0,t.length-1)},Ty=function(t){return t=In(t),t=Mn(t),t},Ox=function l(t){for(var e={},n=0;n<2;n+=1){if(gr(t)==="$"&&(e.end=!0,t=Mn(t)),lr(t)==="^"&&(e.start=!0,t=In(t)),(lr(t)==="["||gr(t)==="]")&&(e.named=!0,lr(t)==="["?e.groupType=gr(t)==="]"?"single":"start":e.groupType="end",t=t.replace(/^\[/,""),t=t.replace(/\]$/,""),lr(t)==="<")){var r=Ix.exec(t);r.length>=2&&(e.named=r[1],t=t.replace(r[0],""))}if(gr(t)==="+"&&(e.greedy=!0,t=Mn(t)),t!=="*"&&gr(t)==="*"&&t!=="\\*"&&(e.greedy=!0,t=Mn(t)),gr(t)==="?"&&(e.optional=!0,t=Mn(t)),lr(t)==="!"&&(e.negative=!0,t=In(t)),lr(t)==="("&&gr(t)===")"){wy.test(t)?(e.choices=t.split(wy),e.operator="and"):(e.choices=t.split("|"),e.operator="or"),e.choices[0]=In(e.choices[0]);var i=e.choices.length-1;e.choices[i]=Mn(e.choices[i]),e.choices=e.choices.map(function(a){return a.trim()}),e.choices=e.choices.filter(function(a){return a}),e.choices=e.choices.map(function(a){return a.split(/ /g).map(l)}),t=""}if(lr(t)==="/"&&gr(t)==="/")return t=Ty(t),e.regex=new RegExp(t),e;if(lr(t)==="~"&&gr(t)==="~")return t=Ty(t),e.soft=!0,e.word=t,e}return Ny.test(t)===!0&&(t=t.replace(Ny,function(a,s){var o=s.split(/,/g);return o.length===1?(e.min=Number(o[0]),e.max=Number(o[0])):(e.min=Number(o[0]),e.max=Number(o[1]||999)),e.greedy=!0,e.optional=!0,""})),lr(t)==="#"?(e.tag=In(t),e.tag=Mx(e.tag),e):lr(t)==="@"?(e.method=In(t),e):t==="."?(e.anything=!0,e):t==="*"?(e.anything=!0,e.greedy=!0,e.optional=!0,e):(t&&(t=t.replace("\\*","*"),t=t.replace("\\.","."),e.word=t.toLowerCase()),e)},Ex=Ox,Px=function(t){for(var e=!1,n=-1,r,i=0;i<t.length;i++){var a=t[i];if(a.groupType==="single"&&a.named===!0){n+=1,a.named=n;continue}a.groupType==="start"&&(e=!0,typeof a.named=="string"||typeof a.named=="number"?r=a.named:(n+=1,r=n)),e&&(a.named=r),a.groupType==="end"&&(e=!1)}return t},Lx=function(t){return t.map(function(e){if(e.choices!==void 0){var n=e.choices.every(function(i){if(i.length!==1)return!1;var a=i[0];return a.word!==void 0&&a.negative!==!0&&a.optional!==!0&&a.method!==!0});if(n===!0){var r={};e.choices.forEach(function(i){r[i[0].word]=!0}),e.fastOr=r,delete e.choices}}return e})},Rx=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.filter(function(r){return r.groupType}).length;return n>0&&(t=Px(t)),e.fuzzy||(t=Lx(t)),t},kx=Rx,Fx=function(t){return Object.prototype.toString.call(t)==="[object Array]"},Bx=function(t){var e=t.map(function(n){return[{word:n}]});return[{choices:e,operator:"or"}]},zx=function(t){if(!t||!t.list||!t.list[0])return[];var e=[];return t.list.forEach(function(n){var r=[];n.terms().forEach(function(i){r.push(i.id)}),e.push(r)}),[{idBlocks:e}]},qx=function(t,e){return e.fuzzy===!0&&(e.fuzzy=.85),typeof e.fuzzy=="number"&&(t=t.map(function(n){return e.fuzzy>0&&n.word&&(n.fuzzy=e.fuzzy),n.choices&&n.choices.forEach(function(r){r.forEach(function(i){i.fuzzy=e.fuzzy})}),n})),t},jx=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||t==="")return[];if(Er(t)==="object"){if(Fx(t)){if(t.length===0||!t[0])return[];if(Er(t[0])==="object")return t;if(typeof t[0]=="string")return Bx(t)}return t&&t.isA==="Doc"?zx(t):[]}typeof t=="number"&&(t=String(t));var n=Vx(t);return n=n.map(function(r){return Ex(r)}),n=kx(n,e),n=qx(n,e),n},Tt=jx,Ux=function(t,e){for(var n=[],r=e[0].idBlocks,i=function(o){r.forEach(function(u){if(u.length===0){a=o;return}var c=u.every(function(f,p){return a=o,t[o+p].id===f});c&&(n.push({match:t.slice(o,o+u.length)}),o+=u.length-1)}),a=o},a=0;a<t.length;a+=1)i(a);return n},Hx=Ux,Kx=function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof e=="string"&&(e=Tt(e)),Nx(t,e)===!0)return[];var r=e.filter(function(f){return f.optional!==!0&&f.negative!==!0}).length,i=t.terms(),a=[];if(e[0].idBlocks){var s=Hx(i,e);if(s&&s.length>0)return ea(i,e,s)}if(e[0].start===!0){var o=by(i,e,0,i.length);return o&&o.match&&o.match.length>0&&(o.match=o.match.filter(function(f){return f}),a.push(o)),ea(i,e,a)}for(var u=0;u<i.length&&!(u+r>i.length);u+=1){var c=by(i.slice(u),e,u,i.length);if(c&&c.match&&c.match.length>0&&(u+=c.match.length-1,c.match=c.match.filter(function(f){return f}),a.push(c),n===!0))return ea(i,e,a)}return ea(i,e,a)},jl=Kx,Wx=function(t,e){var n={},r=jl(t,e);r.forEach(function(o){var u=o.match;u.forEach(function(c){n[c.id]=!0})});var i=t.terms(),a=[],s=[];return i.forEach(function(o){if(n[o.id]===!0){s.length>0&&(a.push(s),s=[]);return}s.push(o)}),s.length>0&&a.push(s),a},Gx=Wx,Zx=function(t){var e=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=jl(this,t,n);return r=r.map(function(i){var a=i.match,s=i.groups,o=e.buildFrom(a[0].id,a.length,s);return o.cache.terms=a,o}),r},Xx=function(t){var e=jl(this,t,!0);return e.length>0},Jx=function(t){var e=this,n=Gx(this,t);return n=n.map(function(r){return e.buildFrom(r[0].id,r.length)}),n},Yx=function(t,e){for(var n=this,r=[],i=this.terms(),a=!1,s=0;s<i.length;s+=1){var o=i[s].canBe(t,e);o===!0&&(a===!0?r[r.length-1].push(i[s]):r.push([i[s]]),a=o)}return r=r.filter(function(u){return u.length>0}).map(function(u){return n.buildFrom(u[0].id,u.length)}),r},Qx={match:Zx,has:Xx,not:Jx,canBe:Yx},Gr=function l(t,e,n){St(this,l),this.start=t,this.length=e,this.isA="Phrase",Object.defineProperty(this,"pool",{enumerable:!1,writable:!0,value:n}),Object.defineProperty(this,"cache",{enumerable:!1,writable:!0,value:{}}),Object.defineProperty(this,"groups",{enumerable:!1,writable:!0,value:{}})};Gr.prototype.buildFrom=function(l,t,e){var n=new Gr(l,t,this.pool);return e&&Object.keys(e).length>0?n.groups=e:n.groups=this.groups,n};Object.assign(Gr.prototype,Qx);Object.assign(Gr.prototype,xx);var _y={term:"terms"};Object.keys(_y).forEach(function(l){return Gr.prototype[l]=Gr.prototype[_y[l]]});var Ul=Gr,Hl=function(){function l(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};St(this,l),Object.defineProperty(this,"words",{enumerable:!1,value:t})}return Zt(l,[{key:"add",value:function(e){return this.words[e.id]=e,this}},{key:"get",value:function(e){return this.words[e]}},{key:"remove",value:function(e){delete this.words[e]}},{key:"merge",value:function(e){return Object.assign(this.words,e.words),this}},{key:"stats",value:function(){return{words:Object.keys(this.words).length}}}]),l}();Hl.prototype.clone=function(){var l=this,t=Object.keys(this.words),e=t.reduce(function(n,r){var i=l.words[r].clone();return n[i.id]=i,n},{});return new Hl(e)};var Kl=Hl,eC=function(t){t.forEach(function(e,n){n>0&&(e.prev=t[n-1].id),t[n+1]&&(e.next=t[n+1].id)})},Ay=eC,tC=/(\S.+?[.!?\u203D\u2E18\u203C\u2047-\u2049])(?=\s+|$)/g,$y=/\S/,rC=/[ .][A-Z]\.? *$/i,nC=/(?:\u2026|\.{2,}) *$/,iC=/((?:\r?\n|\r)+)/,aC=/[a-z0-9\u00C0-\u00FF\u00a9\u00ae\u2000-\u3300\ud000-\udfff]/i,Sy=/^\s+/,sC=function(t){for(var e=[],n=t.split(iC),r=0;r<n.length;r++)for(var i=n[r].split(tC),a=0;a<i.length;a++)e.push(i[a]);return e},oC=function(t,e){if(rC.test(t)===!0||nC.test(t)===!0||aC.test(t)===!1)return!1;var n=t.replace(/[.!?\u203D\u2E18\u203C\u2047-\u2049] *$/,""),r=n.split(" "),i=r[r.length-1].toLowerCase();return!e.hasOwnProperty(i)},lC=function(t,e){var n=e.cache.abbreviations;t=t||"",t=String(t);var r=[],i=[];if(!t||typeof t!="string"||$y.test(t)===!1)return r;t=t.replace("\xA0"," ");for(var a=sC(t),s=0;s<a.length;s++){var o=a[s];if(!(o===void 0||o==="")){if($y.test(o)===!1){if(i[i.length-1]){i[i.length-1]+=o;continue}else if(a[s+1]){a[s+1]=o+a[s+1];continue}}i.push(o)}}for(var u=0;u<i.length;u++){var c=i[u];i[u+1]&&oC(c,n)===!1?i[u+1]=c+(i[u+1]||""):c&&c.length>0&&(r.push(c),i[u]="")}if(r.length===0)return[t];for(var f=1;f<r.length;f+=1){var p=r[f].match(Sy);p!==null&&(r[f-1]+=p[0],r[f]=r[f].replace(Sy,""))}return r},uC=lC,cC=/\S/,fC=/^[!?.]+$/,pC=/(\S+)/,dC=/[a-z] ?\/ ?[a-z]*$/,Wl=[".","?","!",":",";","-","\u2013","\u2014","--","...","(",")","[","]",'"',"'","`"];Wl=Wl.reduce(function(l,t){return l[t]=!0,l},{});var mC=function(t){if(/^(re|un)-?[^aeiou]./.test(t)===!0)return!1;var e=/^([a-z\u00C0-\u00FF`"'/]+)(-||)([a-z0-9\u00C0-\u00FF].*)/i;if(e.test(t)===!0)return!0;var n=/^([0-9]{1,4})(-||)([a-z\u00C0-\u00FF`"'/-]+$)/i;return n.test(t)===!0},hC=function(t){for(var e=1;e<t.length-1;e++)dC.test(t[e])&&(t[e-1]+=t[e]+t[e+1],t[e]=null,t[e+1]=null);return t},vC=function(t){var e=[],n=t.split(/[-]/),r="-",i=t.match(/[-]/);i&&i[0]&&(r=i);for(var a=0;a<n.length;a++)a===n.length-1?e.push(n[a]):e.push(n[a]+r);return e},yC=function(t){return Object.prototype.toString.call(t)==="[object Array]"},gC=function(t){var e=[],n=[];if(t=t||"",typeof t=="number"&&(t=String(t)),yC(t))return t;for(var r=t.split(pC),i=0;i<r.length;i++){if(mC(r[i])===!0){n=n.concat(vC(r[i]));continue}n.push(r[i])}for(var a="",s=0;s<n.length;s++){var o=n[s];cC.test(o)===!0&&Wl.hasOwnProperty(o)===!1&&fC.test(o)===!1?(e.length>0?(e[e.length-1]+=a,e.push(o)):e.push(a+o),a=""):a+=o}return a&&(e.length===0&&(e[0]=""),e[e.length-1]+=a),e=hC(e),e=e.filter(function(u){return u}),e},bC=gC,xC=function(t){return Object.prototype.toString.call(t)==="[object Array]"},CC=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=null;typeof t!="string"&&(typeof t=="number"?t=String(t):xC(t)&&(r=t)),r=r||uC(t,e),r=r.map(function(a){return bC(a)}),n=n||new Kl;var i=r.map(function(a){a=a.map(function(o){var u=new ql(o);return n.add(u),u}),Ay(a);var s=new Ul(a[0].id,a.length,n);return s.cache.terms=a,s});return i},br=CC,NC=function(t,e){var n=new Kl,r=t.map(function(i,a){var s=i.terms.map(function(o,u){var c=new ql(o.text);return c.pre=o.pre!==void 0?o.pre:"",o.post===void 0&&(o.post=" ",u>=i.terms.length-1&&(o.post=". ",a>=i.terms.length-1&&(o.post="."))),c.post=o.post!==void 0?o.post:" ",o.tags&&o.tags.forEach(function(f){return c.tag(f,"",e)}),n.add(c),c});return Ay(s),new Ul(s[0].id,s.length,n)});return r},wC=NC,TC="13.10.6",ta=["Person","Place","Organization"],_C={Noun:{notA:["Verb","Adjective","Adverb"]},Singular:{isA:"Noun",notA:"Plural"},ProperNoun:{isA:"Noun"},Person:{isA:["ProperNoun","Singular"],notA:["Place","Organization","Date"]},FirstName:{isA:"Person"},MaleName:{isA:"FirstName",notA:["FemaleName","LastName"]},FemaleName:{isA:"FirstName",notA:["MaleName","LastName"]},LastName:{isA:"Person",notA:["FirstName"]},NickName:{isA:"Person",notA:["FirstName","LastName"]},Honorific:{isA:"Noun",notA:["FirstName","LastName","Value"]},Place:{isA:"Singular",notA:["Person","Organization"]},Country:{isA:["Place","ProperNoun"],notA:["City"]},City:{isA:["Place","ProperNoun"],notA:["Country"]},Region:{isA:["Place","ProperNoun"]},Address:{isA:"Place"},Organization:{isA:["Singular","ProperNoun"],notA:["Person","Place"]},SportsTeam:{isA:"Organization"},School:{isA:"Organization"},Company:{isA:"Organization"},Plural:{isA:"Noun",notA:["Singular"]},Uncountable:{isA:"Noun"},Pronoun:{isA:"Noun",notA:ta},Actor:{isA:"Noun",notA:ta},Activity:{isA:"Noun",notA:["Person","Place"]},Unit:{isA:"Noun",notA:ta},Demonym:{isA:["Noun","ProperNoun"],notA:ta},Possessive:{isA:"Noun"}},AC={Verb:{notA:["Noun","Adjective","Adverb","Value"]},PresentTense:{isA:"Verb",notA:["PastTense","FutureTense"]},Infinitive:{isA:"PresentTense",notA:["PastTense","Gerund"]},Imperative:{isA:"Infinitive"},Gerund:{isA:"PresentTense",notA:["PastTense","Copula","FutureTense"]},PastTense:{isA:"Verb",notA:["FutureTense"]},FutureTense:{isA:"Verb"},Copula:{isA:"Verb"},Modal:{isA:"Verb",notA:["Infinitive"]},PerfectTense:{isA:"Verb",notA:"Gerund"},Pluperfect:{isA:"Verb"},Participle:{isA:"PastTense"},PhrasalVerb:{isA:"Verb"},Particle:{isA:"PhrasalVerb"},Auxiliary:{notA:["Noun","Adjective","Value"]}},$C={Value:{notA:["Verb","Adjective","Adverb"]},Ordinal:{isA:"Value",notA:["Cardinal"]},Cardinal:{isA:"Value",notA:["Ordinal"]},Fraction:{isA:"Value",notA:["Noun"]},RomanNumeral:{isA:"Cardinal",notA:["Ordinal","TextValue"]},TextValue:{isA:"Value",notA:["NumericValue"]},NumericValue:{isA:"Value",notA:["TextValue"]},Money:{isA:"Cardinal"},Percent:{isA:"Value"}},Gl=["Noun","Verb","Adjective","Adverb","Value","QuestionWord"],SC={Adjective:{notA:["Noun","Verb","Adverb","Value"]},Comparable:{isA:["Adjective"]},Comparative:{isA:["Adjective"]},Superlative:{isA:["Adjective"],notA:["Comparative"]},NumberRange:{isA:["Contraction"]},Adverb:{notA:["Noun","Verb","Adjective","Value"]},Date:{notA:["Verb","Adverb","Preposition","Adjective"]},Month:{isA:["Date","Singular"],notA:["Year","WeekDay","Time"]},WeekDay:{isA:["Date","Noun"]},Timezone:{isA:["Date","Noun"],notA:["Adjective","ProperNoun"]},Time:{isA:["Date"],notA:["AtMention"]},Determiner:{notA:Gl},Conjunction:{notA:Gl},Preposition:{notA:Gl},QuestionWord:{notA:["Determiner"]},Currency:{isA:["Noun"]},Expression:{notA:["Noun","Adjective","Verb","Adverb"]},Abbreviation:{},Url:{notA:["HashTag","PhoneNumber","Verb","Adjective","Value","AtMention","Email"]},PhoneNumber:{notA:["HashTag","Verb","Adjective","Value","AtMention","Email"]},HashTag:{},AtMention:{isA:["Noun"],notA:["HashTag","Verb","Adjective","Value","Email"]},Emoji:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Emoticon:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Email:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Acronym:{notA:["Plural","RomanNumeral"]},Negative:{notA:["Noun","Adjective","Value"]},Condition:{notA:["Verb","Adjective","Noun","Value"]}},ra={Noun:"blue",Verb:"green",Negative:"green",Date:"red",Value:"red",Adjective:"magenta",Preposition:"cyan",Conjunction:"cyan",Determiner:"cyan",Adverb:"cyan"},DC=function(t){return Object.keys(t).forEach(function(e){if(t[e].color){t[e].color=t[e].color;return}if(ra[e]){t[e].color=ra[e];return}t[e].isA.some(function(n){return ra[n]?(t[e].color=ra[n],!0):!1})}),t},VC=DC,IC=function(t){return t.filter(function(e,n,r){return r.indexOf(e)===n})},MC=function(t){return Object.keys(t).forEach(function(e){for(var n=t[e],r=n.isA.length,i=0;i<r;i++){var a=n.isA[i];t[a]&&(n.isA=n.isA.concat(t[a].isA))}n.isA=IC(n.isA)}),t},OC=MC,EC=function(t){return t.filter(function(e,n,r){return r.indexOf(e)===n})},PC=function(t){var e=Object.keys(t);return e.forEach(function(n){var r=t[n];r.notA=r.notA||[],r.isA.forEach(function(s){if(t[s]&&t[s].notA){var o=typeof t[s].notA=="string"?[t[s].isA]:t[s].notA||[];r.notA=r.notA.concat(o)}});for(var i=0;i<e.length;i++){var a=e[i];t[a].notA.indexOf(n)!==-1&&r.notA.push(a)}r.notA=EC(r.notA)}),t},LC=PC,RC=function(t){var e=Object.keys(t);return e.forEach(function(n){var r=t[n];r.lineage=[];for(var i=0;i<e.length;i++)t[e[i]].isA.indexOf(n)!==-1&&r.lineage.push(e[i])}),t},kC=RC,FC=function(t){return Object.keys(t).forEach(function(e){var n=t[e];n.isA=n.isA||[],typeof n.isA=="string"&&(n.isA=[n.isA]),n.notA=n.notA||[],typeof n.notA=="string"&&(n.notA=[n.notA])}),t},BC=function(t){return t=FC(t),t=OC(t),t=LC(t),t=VC(t),t=kC(t),t},Dy=BC,na=function(t,e){Object.keys(t).forEach(function(n){e[n]=t[n]})},zC=function(){var t={};return na(_C,t),na(AC,t),na($C,t),na(SC,t),t=Dy(t),t},qC=zC(),Vy={Comparative:"true\xA6better",Superlative:"true\xA6earlier",PresentTense:"true\xA6is,sounds",Value:"true\xA6a few",Noun:"true\xA6a5b4c2f1here,ie,lit,m0no doubt,pd,tce;a,d;t,y;a,ca,o0;l,rp;a,l;d,l,rc",Copula:"true\xA6a1is,w0;as,ere;m,re",PastTense:"true\xA6be3came,d2had,lied,meant,sa2taken,w0;as,e0;nt,re;id;en,gan",Condition:"true\xA6if,lest,unless",Preposition:"true\xA6'o,-,aLbIcHdGexcept,fFiDmidQnotwithstandiRoBpSqua,sAt6u3vi2w0;/o,hereNith0;!in,oR;a,s-a-vis;n1p0;!on;like,til;h0ill,owards;an,r0;ough0u;!oJ;ans,ince,o that;',f0n2ut;!f;f,n0;!to;or,rom;espite,own,u3;hez,irca;ar1e0oAy;sides,tween;ri6;',bo7cross,ft6lo5m3propos,round,s1t0;!op;! long 0;as;id0ong0;!st;ng;er;ut",Gerund:"true\xA6accord0be0develop0go0result0stain0;ing",Negative:"true\xA6n0;ever,o0;!n,t",QuestionWord:"true\xA6how3wh0;at,e1ich,o0y;!m,se;n,re; come,'s",Plural:"true\xA6records",Conjunction:"true\xA6&,aFbBcuz,how9in caEno8o7p5supposing,t2v1wh0yet;eth9ile;ers4s;h0o;eref9o0;!uC;l0rovided that;us;r,therwi6; matt1r;!ev0;er;e0ut;cau1f0;ore;se;lthou1nd,s 0;far as,if;gh",Abbreviation:"true\xA6a0Jb0Gc0Ad08e05f02g01h00iYjWkanVlTmNnKoJpFque,rDs8t6u5v2w0;is0r,y0B;!c;a,b,e1i0ol,s,t;tro,vo;r,t;niv,safa,t;ce,e0;l,mp,nn,x;ask,e2fc,gt,i1q,r,s,t,u0;pt,rg;r,tu;c,nJp0;!t;b,d,e0;pGs,v;a,d,ennNhd,l,p,r1s0vt;!eud;ef,o0;b,f,n;ct,kla,nt;e0ov;b0e;!r;a4d,essrs,i1lle,me,r7s0t;!tr;n1s0;c,ter;!n;!j,r,sc;at,it,lb,ng,t0;!d;!s;an,d,r,u0;l,n;a,da,e,n0;c,f;on,wy;a,en,ov;e1ig,l0m,r,t,y;!a;b,m;a,g,ng,s1tc,x0;!p;p,q,t;ak,e0ist,r;c,f,pt,t;a3ca,l,m2o0pl,res,yn;!l0m1nn,rp;!o;dr;!l0pt;!if;a,c,l1r0;ig,os;!dg,vd;d4l3p2r1ss0tty,ug,ve;n,t;c,iz;prox,r,t;!ta;!j,m,v",Pronoun:"true\xA6'em,elle,h4i3me,ourselves,she5th1us,we,you0;!rself;e0ou;m,y;!l,t;e0im;!'s",Singular:"true\xA60:15;1:12;2:18;a15b0Sc0Jd0Ce09f04gZhViUjel0kitty,lSmOnNoMpHquestionGrEs9t6u4w3;ay,om02;nc0Zs 3;doll0Kst0M; rex,a4h3ic,ragedy,v show;ere,i2;l0x return;i6ky,omeoMt3uper bowl,yst14;ep4ri2u3;de0Xff;faSmoS;st1ze;al0i2o3;om,se;! mark;a6i1la5r4u3;dPrpoH;eroga00ie0Gobl0U;te,y1;rt,te0N;bjWceJthers,verview;othi2umb1;a5ee08o3;del,m3nopo0rni2th1;!my;n,yf0;i3unch;ne;ci2nsect;ead start,o3uman right;l0me4u3;se;! run;adf0entlem6irl02laci1od,rand4u3;l0y; slam,fa3mo3;th1;an;a6ella,ly,ol0r4un3;di2;ee market,iWo3;nti1sP;mi0th1;conomy,gg,ner7ven4x3;ampTecu9;i2t;ad8e5inn1o3ragonf0ude;cumentGg3i0l0or;gy;ath,t3;ec3;tive;!dy;a9eili2h7i5o3redit card;ttage,u3;ri1sin;ty,vil w3;ar;andeli1ocol3;ate;n3rF;ary;aCel0lesJo8r5u3;n3tterf0;ti2;eakfa4o3;!th1;st;dy,tt5y3;!fri3;end;le;nki2r3;ri1;er;d5l0noma0u3;nt;ly; homin5verti3;si2;ng;em",FemaleName:"true\xA60:J3;1:J7;2:IG;3:IF;4:IX;5:IK;6:JO;7:H0;8:JG;9:JK;A:HN;B:HY;C:IT;D:IP;E:JD;F:HC;G:I0;aGRbFLcDPdCYeBOfB4gADh9Ti9Gj8Gk7Gl60m49n3No3Jp37qu36r2Ds16t0Eu0Cv02wVxiTyOzH;aLeIineb,oHsof2;e3Uf2la,ra;h3iKlIna,ynH;ab,ep;da,ma;da,h3iHra;nab;aKeJi0Fol5BuIvH;etAonDO;i0na;le0sen2;el,gm3Jn,rGJs8W;aoHme0nyi;m62yAE;aMendDYhiDFiH;dele8lJnH;if48niHo0;e,f47;a,helmi0lHma;a,ow;ka0nB;aNeKiHusa5;cIktoriBMlAole7viH;anC3enJ0;kF9tor2;da,lA9nus,rHs0;a,nHoniH4;a,iFQ;leHnesH4;nIHrH;i1y;g8rHxH5;su5te;aYeUhRiNoLrIuHy3;i,la;acIZiHu0L;c2na,sH;hBPta;nHr0H;iBNya;aJffaEOnHs6;a,gtiH;ng;!nFQra;aIeHomasi0;a,l9Po8Ares1;l2ndolwethu;g9Go88rIssH;!a,ie;eHi,ri9;sa,za;bPlNmLnJrIs6tHwa0;ia0um;a63yn;iHya;a,ka,s6;arB6e3iHmEDra;!ka;a,iH;a,t6;at6it6;a0Fcarlet3We0BhXiTkye,neza0oRtNuIyH;bIBlvi1;e,ha,mayIEni7sIzH;an3MetAie,y;anHi9;!a,e,nH;aDe;aJeH;fHl5GphH;an4;cHZr5;b2fiA8m0OnHphi1;d3ia,ja,ya;er3lJmon1nIobh8PtH;a,i;dy;lEPv2;aMeIirHo0risF7y5;a,lDK;ba,e0i5lJrH;iHrDOyl;!d8Hfa;ia,lDX;hd,iMki3nJrIu0w0yH;la,ma,na;i,le8on,ron;aIda,ia,nHon;a,on;!ya;k6mH;!aa;lJrItaye81vH;da,inj;e0ife;en1i0ma;anA5bNd3Nh1RiBkMlLmJndIrHs6vannaD;aDi0;ra,y;aHi3;nt6ra;lDKma,ome;ee0in8Ru3;in1ri0;a05e00hYiVoIuH;by,thDH;bScRghQl2KnPsJwIxH;anAXie,y;an,e0;aIeHie,lE; merBLann9ll1marDBt7;!lHnn1;iHyn;e,nH;a,d9K;da,i,na;ayy8D;hel62io;bDKer7yn;a,cIkHmas,n9Fta,ya;ki,o;helGki;ea,iannGDoH;da,n1K;an0bJem9Agi0iInHta,y0;a88ee;han83na;a,eH;cEAkaD;bi0chIe,i0mo0nHquEKvCy0;di,ia;aEIelHiB;!e,le;een4ia0;aNeMhKipaluk,oJrHute66;iHudenCQ;scil3LyamvaB;lly,rt2;ilome0oebe,ylH;is,lis;arl,ggy,nelope,r5t3;ige,m0TnKo5rvaDGtIulH;a,etAin1;ricHsy,tBY;a,e,ia;do3i06;ctav2dIfCZis6lHphCZumC3yunbileg;a,ga,iv2;eHvAC;l2tA;aWeUiMoIurHy5;!ay,ul;a,eJor,rIuH;f,r;aDeCma;ll1mi;aNcLhariBOkKlaJna,sHta,vi;anHha;ur;!y;a,iDTki;hoGk9VolH;a,eDJ;!mh;hir,lHna,risFsreC;!a,lBT;asuLdKh2i6CnJomi9rgEPtHzanin zah3;aHhal4;li1s6;cy,etA;a,e8iEV;nngu30;a09ckenz4e01iMoJrignayani,uriDDyH;a,rH;a,lNna,tG;bi0i3llBInH;a,iH;ca,ka,qD3;a,cTkaSlNmi,nLrItzi,yH;ar;aIiam,lH;anEO;!l,nB;dy,eHh,n4;nhGrva;aKdJiCPlH;iHy;cent,e;red;!gros;!e5;ae5hH;ae5el3Z;ag5EgNi,lKrH;edi79iIjem,on,yH;em,l;em,sF;an4iHliF;nHsCE;a,da;!an,han;b0DcASd0Be,g09ha,i08ja,l06n04rLsoum60tKuIv82x9IyHz4;a,bell,ra,soB9;de,rH;a,eC;h8Fild1t4;a,cYgUiKjor4l7Sn4s6tJwa,yH;!aHbe6Wja8lAE;m,nBH;a,ha,in1;!aJbCBeIja,lEna,sHt64;!a,ol,sa;!l1H;! Jh,mInH;!a,e,n1;!awit,i;aliAHcJeduarBfernIjHlui5Y;o6Ful2;anB;ecil2la3;arJeIie,oHr44ueriA;!t;!ry;et42i37;el4Ui76y;dHon,ue5;akran7y;ak,en,iHk,lo3O;a,ka,nB;a,re,s4te;daHg4;!l3A;alEd4elHge,isDBon0;ei8in1yn;el,le;a0Ne0CiYoQuLyH;d2la,nH;!a,dIeBGnHsCL;!a,eBF;a,sCJ;aCWcJel0PiFlIna,pHz;e,i7;a,u,wa;iHy;a0Se,ja,l2JnB;is,l1SrJttIuHvel4;el5is1;e,ie;aKeIi9na,rH;a86i9;lHn1t7;ei;!in1;aSbb9CdRepa,lMnJsIv2zH;!a,be5LetAz4;a,etA;!a,dH;a,sHy;ay,ey,i,y;a,iJja,lHy;iHy;aA0e;!aH;!n5F;ia,ya;!nH;!a,ne;aPda,e0iNjYla,nMoKsJtHx4y5;iHt4;c2t2;e2LlCG;la,nHra;a,ie,o3;a,or1;a,gh,laH;!ni;!h,nH;a,d3e,n5P;cOdon97iNkes6mi9Ana,rMtJurIvHxmi,y5;ern1in2;a,e54ie,yn;as6iIoH;nya,ya;fa,s6;a,isF;a,la;ey,ie,y;a04eZhXiOlAKoNrJyH;lHra;a,ee,ie;istHy6D;a,en,iIyH;!na;!e,n59;nul,ri,urtnB0;aOerNlAZmJrHzzy;a,stH;en,in;!berlImernH;aq;eHi,y;e,y;a,stC;!na,ra;aHei3ongordzol;dij1w5;el7QiKjsi,lJnIrH;a,i,ri;d3na,za;ey,i,lBDs4y;ra,s6;bi7cAJdiat7IeB2iRlQmPnyakuma19rNss6KtKvi7yH;!e,lH;a,eH;e,i8L;a6DeIhHi4NlEri0y;ar6Ber6Bie,leCrB2y;!lyn8Gri0;a,en,iHl5Soli0yn;!ma,n3VsF;a5il1;ei8Ei,l4;a,tl6L;a07eYiVoNuH;anLdKliHst63;a8HeHsF;!n8tH;!a,te;e5Ji3Jy;a,i7;!anNcelEd6RelGhan7RlLni,sIva0yH;a,ce;eHie;fHlEph5U;a,in1;eHie;en,n1;!a,e,n41;lHng;!i1ClH;!i1B;anMle0nJrIsH;i8Csi8C;i,ri;!a,elGif2CnH;a,etAiHy;!e,f2A;a,e8EiInH;a,e8DiH;e,n1;cMd1mi,nIque4Xsmin3Ovie3y8zH;min9;a9eIiH;ce,e,n1s;!lHsFt0F;e,le;inIk4lEquelH;in1yn;da,ta;lRmPnOo0rNsIvaHzaro;!a0lu,na;aJiIlaHob84;!n9N;do3;!belHdo3;!a,e,l39;a77en1i0ma;a,di3es,gr6Yji;a8elBogH;en1;a,e8iHo0se;a0na;aSeOiJoHusFyacin2B;da,ll4rten23snH;a,i9Q;lImaH;ri;aIdHlaI;a,egard;ry;ath1CiJlInriet7rmi8sH;sa,t1B;en2Sga,mi;di;bi2Dil8IlNnMrJsItHwa,yl8Iz7H;i5St4;n5Yti;iHmo51ri52;etH;!te;aDnaD;a,ey,l4;a03eXiSlQoOrKunJwH;enHyne1Q;!dolE;ay,el;acIetHiselB;a,chC;e,ieH;!la;ld1AogooH;sh;adys,enHor2yn2H;a,da,na;aKgi,lIna,ov89selHta;a,e,le;da,liH;an;!n0;mLnJorgIrH;ald3Pi,m3Ctru8B;etAi4W;a,eHna;s26vieve;ma;bIil,le,mHrnet,yG;al5Ni5;i5FrielH;a,l1;aVeSiRloOoz2rH;anJeIiH;da,eB;da,ja;!cH;esIiHoi0O;n1s61;!ca;!rH;a,encH;e,ia;en,o0;lIn0rnH;!anB;ec2ic2;jr,n7rKtHy9;emIiHma,ouma7;ha,ma,n;eh;ah,iBrah,za0;cr4Nd0Ne0Mi0Lk7l04mWn4YrTsNtMuLvH;aJelIiH;!e,ta;in0Gyn;!ngel2S;geni1la,ni45;h5Sta;mLperanKtH;eIhHrel5;er;l30r9;za;a,eralB;iHma,nest2Jyn;cHka,n;a,ka;a,eMiJmH;aHie,y;!li8;lHn1;ee,iHy;a,e,ja;lHrald;da,y;aWeUiNlMma,no3oKsJvH;a,iH;na,ra;a,ie;iHuiH;se;a,en,ie,y;a0c2da,f,nMsJzaH;!betHve7;e,h;aHe,ka;!beH;th;!a,or;anor,nH;!a;!in1na;leCs6;vi;eIiHna,wi0;e,th;l,n;aYeMh2iLjeneKoHul30;lor5Tminiq4In3FrHtt4;a,eCis,la,othHthy;ea,y;ba;an0AnaDon8x4ya;anQbPde,eOiMja,lJmetr2nHsir5K;a,iH;ce,se;a,iIla,orHphi8;es,is;a,l6D;dHrdH;re;!d5Cna;!b2HoraDra;a,d3nH;!a,e;hl2i0l0HmNnLphn1rIvi1XyH;le,na;a,by,cIia,lH;a,en1;ey,ie;a,etAiH;!ca,el1Cka,z;arHia;is;a0Se0Oh05i03lVoKrIynH;di,th2;istHy05;al,i0;lPnMrIurH;tn1E;aJd2NiHn2Nri8;!nH;a,e,n1;!l1X;cepci59n4sH;tanHuelo;ce,za;eHleC;en,tA;aJeoIotH;il51;!pat3;ir9rJudH;etAiH;a,ne;a,e,iH;ce,sZ;a3er3ndH;i,y;aReNloe,rH;isJyH;stH;al;sy,tH;a1Ren,iHy;!an1e,n1;deJlseIrH;!i9yl;a,y;li8;nMrH;isKlImH;ai8;a,eHotA;n1tA;!sa;d3elGtH;al,elG;cIlH;esAi44;el2ilH;e,ia,y;itlZlYmilXndWrOsMtHy5;aKeJhHri0;erHleCrEy;in1;ri0;li0ri0;a33sH;a32ie;a,iNlLmeJolIrH;ie,ol;!e,in1yn;lHn;!a,la;a,eHie,o7y;ne,y;na,sF;a0Hi0H;a,e,l1;is7l4;in,yn;a0Ie02iZlXoUrH;andSeQiJoIyH;an0nn;nwEok9;an3DdgLg0XtH;n2XtH;!aInH;ey,i,y;ny;etH;!t9;an0e,nH;da,na;i9y;bbi9glarIlo05nH;i7n4;ka;ancHossom,ythe;a,he;an17lja0nHsm3I;i7tH;ou;aUcky,linTni7rPssOtJulaDvH;!erlH;ey,y;hJsy,tH;e,iHy9;e,na;!anH;ie,y;!ie;nHt6yl;adIiH;ce;etAi8;ay,da;!triH;ce,z;rbJyaH;rmH;aa;a3ie,o3ra;a2Sb2Md23g1Zi1Qj5l16m0Xn09oi,r04sUtTuPvOwa,yIzH;ra,u0;aKes6gJlIseH;!l;in;un;!nH;a,na;a,i2Ir2J;drJgus1RrIsteH;ja;el2;a,ey,i,y;aahua,he0;hIi2Gja,mi7s2DtrH;id;aMlIraqHt21;at;eIi9yH;!n;e,iHy;gh;!nH;ti;iJleIo6pi7;ta;en,n1tA;aHelG;!n1J;a00dje5eYgUiSjQnJohito,toHya;inetAnH;el5ia;!aKeIiHmJ;e,ka;!mHtA;ar4;!belIliFmU;sa;!le;a,eliH;ca;ka,sHta;a,sa;elHie;a,iH;a,ca,n1qH;ue;!tA;te;! JbImHstasiNya;ar2;el;cla3jul2pau5;aLberKeliJiHy;e,l2naH;!ta;a,ja;!ly;hGiIl2nB;da;a,ra;le;aWba,ePiMlKma,thJyH;a,c2sH;a,on,sa;ea;iHys0N;e,s0M;a,cIn1sHza;a,e,ha,on,sa;e,ia,ja;c2is6jaKksaKna,sJxH;aHia;!nd3;ia,saH;nd3;ra;ia;i0nIyH;ah,na;a,is,naDoud;la;c6da,leCmNnLsH;haDlH;inHyY;g,n;!h;a,o,slH;ey;ee;en;at6g4nIusH;ti0;es;ie;aWdiTelMrH;eJiH;anMenH;a,e,ne;an0;na;!aLeKiIyH;nn;a,n1;a,e;!ne;!iH;de;e,lEsH;on;yn;!lH;i8yn;ne;aKbIiHrL;!gaK;ey,i9y;!e;gaH;il;dKliyJradhIs6;ha;ya;ah;a,ya",Actor:"true\xA6aJbGcFdCengineIfAgardenIh9instructPjournalLlawyIm8nurse,opeOp5r3s1t0;echnCherapK;ailNcientJecretary,oldiGu0;pervKrgeon;e0oofE;ceptionGsearC;hotographClumbColi1r0sychologF;actitionBogrammB;cem6t5;echanic,inist9us4;airdress8ousekeep8;arm7ire0;fight6m2;eputy,iet0;ici0;an;arpent2lerk;ricklay1ut0;ch0;er;ccoun6d2ge7r0ssis6ttenda7;chitect,t0;ist;minist1v0;is1;rat0;or;ta0;nt",Honorific:"true\xA6a01bYcQdPeOfiJgIhon,jr,king,lHmCoffic00p7queen,r3s0taoiseach,vice6;e1fc,gt,ir,r,u0;ltRpt,rg;cond liInBrgeaJ;abbi,e0;ar1p9s,v0;!erend; admirX;astOhd,r0vt;esideDi1of0;!essM;me mini4nce0;!ss;a3essrs,i2lle,me,r1s0;!tr;!s;stK;gistrate,j,r6yF;i3lb,t;en,ov;eld mar3rst l0;ady,i0;eutena0;nt;shG;sq,xcellency;et,oct6r,utchess;apt6hance4mdr,o0pl;lonel,m2ngress0unci3;m0wom0;an;dr,mand5;ll0;or;!ain;ldg,rig0;!adi0;er;d0sst,tty,yatullah;j,m0v;!ir0;al",SportsTeam:"true\xA60:1A;1:1H;2:1G;a1Eb16c0Td0Kfc dallas,g0Ihouston 0Hindiana0Gjacksonville jagua0k0El0Bm01newToQpJqueens parkIreal salt lake,sAt5utah jazz,vancouver whitecaps,w3yW;ashington 3est ham0Rh10;natio1Oredski2wizar0W;ampa bay 6e5o3;ronto 3ttenham hotspur;blue ja0Mrapto0;nnessee tita2xasC;buccanee0ra0K;a7eattle 5heffield0Kporting kansas0Wt3;. louis 3oke0V;c1Frams;marine0s3;eah15ounG;cramento Rn 3;antonio spu0diego 3francisco gJjose earthquak1;char08paA; ran07;a8h5ittsburgh 4ortland t3;imbe0rail blaze0;pirat1steele0;il3oenix su2;adelphia 3li1;eagl1philNunE;dr1;akland 3klahoma city thunder,rlando magic;athle0Mrai3;de0; 3castle01;england 7orleans 6york 3;city fc,g4je0FknXme0Fred bul0Yy3;anke1;ian0D;pelica2sain0C;patrio0Brevolut3;ion;anchester Be9i3ontreal impact;ami 7lwaukee b6nnesota 3;t4u0Fvi3;kings;imberwolv1wi2;rewe0uc0K;dolphi2heat,marli2;mphis grizz3ts;li1;cXu08;a4eicesterVos angeles 3;clippe0dodDla9; galaxy,ke0;ansas city 3nE;chiefs,roya0E; pace0polis colU;astr06dynamo,rockeTtexa2;olden state warrio0reen bay pac3;ke0;.c.Aallas 7e3i05od5;nver 5troit 3;lio2pisto2ti3;ge0;broncZnuggeM;cowbo4maver3;ic00;ys; uQ;arCelKh8incinnati 6leveland 5ol3;orado r3umbus crew sc;api5ocki1;brow2cavalie0india2;bengaWre3;ds;arlotte horAicago 3;b4cubs,fire,wh3;iteB;ea0ulR;diff3olina panthe0; c3;ity;altimore 9lackburn rove0oston 5rooklyn 3uffalo bilN;ne3;ts;cel4red3; sox;tics;rs;oriol1rave2;rizona Ast8tlanta 3;brav1falco2h4u3;nited;aw9;ns;es;on villa,r3;os;c5di3;amondbac3;ks;ardi3;na3;ls",Uncountable:"true\xA60:1I;1:16;2:1X;a1Rb1Jc1Ad17e10f0Ug0Nh0Ii0Ej0Dknowled1Ql08mYnews,oXpTrOsDt8vi7w3;a5ea0Bi4oo3;d,l;ldlife,ne;rmth,t0;neg17ol0Ctae;e6h5oothpaste,r3una;affTou3;ble,sers,t;ermod1Mund0;a,nnis;aBcene0Aeri1hAil9kittl1now,o8p6t4u3;g10nshi0Q;ati1Le3;am,el;ace1Ee3;ci1ed;ap,cc0;k,v0;eep,ingl1;d0Dfe18l3nd,tish;m11t;a6e4ic3;e,ke0M;c3laxa0Isearch;ogni0Hrea0H;bi1in;aPe5hys2last9o3ress04;l3rk,w0;it2yA;a12trZ;bstetr2il,xygen;aAe8ilk,o5u3;mps,s3;ic;n3o0I;ey,o3;gamy;a3chan2;sl1t;chine3il,themat2; learn0Bry;aught0e5i4ogi0Su3;ck,g0I;ce,ghtn08ngui0QteratN;a3isM;th0;ewelAusti0L;ce,mp3nformaUtself;a3ortan0J;ti3;en0H;a6isto5o3;ck3mework,n3spitali0B;ey;ry;ir,libut,ppiD;ene6o4r3um,ymna0D;aCound;l3ssip;d,f; 3t2;editQpo3;ol;i7lour,o4urnit3;ure;od,rgive3uri0wl;ne3;ss;c9sh;conom2duca8lectr7n5quip6th2very3;body,o3thH;ne;joy3tertain3;ment;iciPon2;tiI;ar4iabet1raugh4;es;ts;aAelcius,h6iv2l5o3urrency;al,ld w3nfusiDttD;ar;ass2oth5;aos,e3;e4w3;ing;se;r7sh;a7eef,i4lood,owls,read,utt0;er;lliar4s3;on;ds;g3ss;ga3;ge;c8dvi7ero5ir4mnes3rt,thlet2;ty;craft;b2d3naut2;ynam2;ce;id,ou3;st2;ics",Infinitive:"true\xA60:6S;1:76;2:5C;3:74;4:73;5:67;6:6F;7:6Y;8:6Q;9:72;A:70;B:5X;C:6X;D:6L;E:77;F:5B;a6Kb66c57d4De3Xf3Jg3Dh37i2Uj2Sk2Ql2Hm26n23o1Yp1Jr0Rs06tYuTvOwHyG;awn,ield;aJe1Zhist6iIoGre6D;nd0rG;k,ry;pe,sh,th0;lk,nHrGsh,tDve;n,raE;d0t;aJiHoG;te,w;eGsC;!w;l6Jry;nHpGr4se;gra4Pli41;dGi9lo5Zpub3Q;erGo;mi5Cw1I;aMeLhKig5SoJrHuGwi7;ne,rn;aGe0Mi5Uu7y;de,in,nsf0p,v5J;r2ZuD;ank,reatB;nd,st;lk,rg1Qs9;aZcWeVhTi4Dkip,lSmRnee3Lo52pQtJuGwitD;bmCck,ff0gge7ppHrGspe5;ge,pri1rou4Zvi3;ly,o36;aLeKoJrHuG;dy,mb6;aFeGi3;ngthBss,tD;p,re;m,p;in,ke,r0Qy;la58oil,rink6;e1Zi6o3J;am,ip;a2iv0oG;ck,rtBut;arDem,le5n1r3tt6;aHo2rG;atDew;le,re;il,ve;a05eIisk,oHuG;in,le,sh;am,ll;a01cZdu8fYgXje5lUmTnt,pQquPsKtJvGwa5V;eGiew,o36;al,l,rG;se,t;aFi2u44;eJi7oItG;!o2rG;i5uc20;l3rt;mb6nt,r3;e7i2;air,eHlGo43r0K;a8y;at;aFemb0i3Zo3;aHeGi3y;a1nt;te,x;a5Dr0J;act1Yer,le5u1;a13ei3k5PoGyc6;gni2Cnci6rd;ch,li2Bs5N;i1nG;ge,k;aTerSiRlOoMrIuG;b21ll,mp,rGsh;cha1s4Q;ai1eIiEoG;cGdu8greAhibCmi1te7vi2W;eAlaim;di5pa2ss,veE;iEp,rtr46sGur;e,t;aHead,uG;g,n4;n,y;ck,le;fo34mCsi7;ck,iErt4Mss,u1;bJccur,ff0pera9utweIverGwe;co47lap,ta22u1wG;helm;igh;ser3taF;eHotG;e,i8;ed,gle5;aMeLiIoHuG;ltip3Grd0;nit13ve;nHrr12sreprG;eseE;d,g6us;asu2lt,n0Nr4;intaFna4rHtG;ch,t0;ch,kGry;et;aMeLiJoGu1C;aHck,oGve;k,sB;d,n;ft,g35ke,mCnk,st2YveG;!n;a2Fc0Et;b0Nck,uG;gh,nD;iGno34;ck,ll,ss;am,oFuG;d4mp;gno2mQnGss3H;cOdica9flu0MhNsKtIvG;eGol3;nt,st;erGrodu8;a5fe2;i7tG;aGru5;ll;abCibC;lu1Fr1D;agi24pG;lemeEo22ro3;aKeIi2oHuG;nt,rry;n02pe,st;aGlp;d,t;nd6ppBrm,te;aKloAove1PrIuG;arGeAi15;ant39d;aGip,ow,umb6;b,sp;in,th0ze;aReaQiOlMoJrHuncG;ti3J;acGeshB;tu2;cus,lHrG;ce,eca7m,s30;d,l24;a1ZoG;at,od,w;gu2lGni1Xt,x;e,l;r,tu2;il,stBvG;or;a15cho,le5mSnPstNvalua9xG;a0AcLerKi7pGte19;a18eHi2laFoGreA;rt,se;ct,riG;en8;ci1t;el,han4;abGima9;li1J;ab6couXdHfor8ga4han8j03riDsu2t0vG;isi2Vy;!u2;body,er4pG;hasiGow0;ze;a07eUiLoKrHuG;mp;aHeAiG;ft;g,in;d4ubt;ff0p,re5sHvG;iZor8;aKcHliGmiApl1Btingui14;ke;oGuA;uGv0;ra4;gr1YppG;ear,ro3;cOeNfLliv0ma0Fny,pKsHterG;mi0G;cribe,er3iHtrG;oy;gn,re;a0Be0Ai5osC;eGi0By;at,ct;m,pB;iIlHrG;ea1;a2i06;de;ma4n8rGte;e,kB;a0Ae09h06i9l04oJrG;aHeGoAu0Hy;a9dC;ck,ve;llZmSnHok,py,uGv0;gh,nt;cePdu5fMsKtIvG;eGin8;rt,y;aFin0VrG;a7ibu9ol;iGtitu9;d0st;iHoGroE;rm;gu2rm;rn;biLfoKmaJpG;a2laF;in;re;nd;rt;ne;ap1e5;aGip,o1;im,w;aHeG;at,ck,w;llen4n4r4se;a1nt0;ll,ncIrGt0u1;eGry;!en;el;aSePloOoMrIuG;lGry;ly;igHuG;sh;htB;en;a7mb,o7rrGth0un8;ow;ck;ar,lHnefCtrG;ay;ie3ong;ng,se;band0Jc0Bd06ffo05gr04id,l01mu1nYppTrQsKttGvoid,waC;acIeHra5;ct;m0Fnd;h,k;k,sG;eIiHocia9uG;me;gn,st;mb6rt;le;chHgGri3;ue;!i3;eaJlIroG;aDve;ch;aud,y;l,r;noun8sw0tG;icipa9;ce;lHt0;er;e4ow;ee;rd;aRdIju7mCoR;it;st;!reA;ss;cJhie3knowled4tiva9;te;ge;ve;eIouEu1;se;nt;pt;on",Unit:"true\xA60:19;a14b12c0Od0Ne0Lf0Gg0Ch09in0Hjoule0k02l00mNnMoLpIqHsqCt7volts,w6y4z3\xB02\xB51;g,s;c,f,n;b,e2;a0Nb,d0Dears old,o1;tt0H;att0b;able4b3d,e2on1sp;!ne0;a2r0D;!l,sp;spo04; ft,uare 1;c0Id0Hf3i0Fkilo0Jm1ya0E;e0Mil1;e0li0H;eet0o0D;t,uart0;ascals,e2i1ou0Pt;c0Mnt0;rcent,t02;hms,uYz;an0JewtT;/s,b,e9g,i3l,m2p1\xB2,\xB3;h,s;!\xB2;!/h,cro5l1;e1li08;! pFs1\xB2;! 1;anEpD;g06s0B;gQter1;! 2s1;! 1;per second;b,i00m,u1x;men0x0;b,elvin0g,ilo2m1nR;!/h,ph,\xB2;byZgXmeter1;! p2s1;! p1;er1; hour;e1g,r0z;ct1rtz0;aXogQ;al2b,igAra1;in0m0;!l1;on0;a4emtPl2t1;\xB2,\xB3; oz,uid ou1;nce0;hrenheit0rad0;b,x1;abyH;eciCg,l,mA;arat0eAg,m9oulomb0u1;bic 1p0;c5d4fo3i2meAya1;rd0;nch0;ot0;eci2;enti1;me4;!\xB2,\xB3;lsius0nti1;g2li1me1;ter0;ram0;bl,y1;te0;c4tt1;os1;eco1;nd0;re0;!s",Organization:"true\xA60:46;a3Ab2Qc2Ad21e1Xf1Tg1Lh1Gi1Dj19k17l13m0Sn0Go0Dp07qu06rZsStFuBv8w3y1;amaha,m0Xou1w0X;gov,tu2S;a3e1orld trade organizati41;lls fargo,st1;fie22inghou16;l1rner br3D;-m11gree31l street journ25m11;an halNeriz3Wisa,o1;dafo2Gl1;kswagLvo;bs,kip,n2ps,s1;a tod2Rps;es35i1;lev2Xted natio2Uv; mobi2Kaco bePd bMeAgi frida9h3im horto2Tmz,o1witt2W;shiba,y1;ota,s r Y;e 1in lizzy;b3carpen33daily ma2Xguess w2holli0rolling st1Ms1w2;mashing pumpki2Ouprem0;ho;ea1lack eyed pe3Fyrds;ch bo1tl0;ys;l2s1;co,la m12;efoni07us;a6e4ieme2Gnp,o2pice gir5ta1ubaru;rbucks,to2N;ny,undgard1;en;a2Rx pisto1;ls;few25insbu26msu1X;.e.m.,adiohead,b6e3oyal 1yan2X;b1dutch she4;ank;/max,aders dige1Ed 1vl32;bu1c1Uhot chili peppe2Klobst28;ll;c,s;ant2Vizno2F;an5bs,e3fiz24hilip morrBi2r1;emier27octer & gamb1Rudenti14;nk floyd,zza hut;psi28tro1uge08;br2Qchina,n2Q; 2ason1Xda2G;ld navy,pec,range juli2xf1;am;us;a9b8e5fl,h4i3o1sa,wa;kia,tre dame,vart1;is;ke,ntendo,ss0K;l,s;c,st1Etflix,w1; 1sweek;kids on the block,york08;a,c;nd1Us2t1;ional aca2Fo,we0Q;a,cYd0O;aAcdonald9e5i3lb,o1tv,yspace;b1Nnsanto,ody blu0t1;ley crue,or0O;crosoft,t1;as,subisO;dica3rcedes2talli1;ca;!-benz;id,re;'s,s;c's milk,tt13z1Y;'ore09a3e1g,ittle caesa1Ktd;novo,x1;is,mark; pres5-z-boy,bour party;atv,fc,kk,m1od1K;art;iffy lu0Lo3pmorgan1sa;! cha1;se;hnson & johns1Sy d1R;bm,hop,n1tv;c,g,te1;l,rpol; & m,asbro,ewlett-packaTi3o1sbc,yundai;me dep1n1J;ot;tac1zbollah;hi;eneral 6hq,l5mb,o2reen d0Iu1;cci,ns n ros0;ldman sachs,o1;dye1g0B;ar;axo smith kliZencore;electr0Im1;oto0V;a3bi,da,edex,i1leetwood mac,oGrito-l0A;at,nancial1restoV; tim0;cebook,nnie mae;b06sa,u3xxon1; m1m1;ob0H;!rosceptics;aiml0Ae5isney,o3u1;nkin donuts,po0Wran dur1;an;j,w j1;on0;a,f leppa3ll,p2r spiegZstiny's chi1;ld;eche mode,t;rd;aEbc,hBi9nn,o3r1;aigsli5eedence clearwater reviv1ossra05;al;!ca c5l4m1o0Ast05;ca2p1;aq;st;dplMgate;ola;a,sco1tigroup;! systems;ev2i1;ck fil-a,na daily;r0Hy;dbury,pital o1rl's jr;ne;aGbc,eCfAl6mw,ni,o2p,r1;exiteeWos;ei3mbardiJston 1;glo1pizza;be;ng;ack & deckFo2ue c1;roX;ckbuster video,omingda1;le; g1g1;oodriN;cht3e ge0n & jer2rkshire hathaw1;ay;ryH;el;nana republ3s1xt5y5;f,kin robbi1;ns;ic;bXcSdidRerosmith,ig,lLmFnheuser-busEol,ppleAr7s3t&t,v2y1;er;is,on;hland2s1;n,ociated F; o1;il;by4g2m1;co;os; compu2bee1;'s;te1;rs;ch;c,d,erican3t1;!r1;ak; ex1;pre1;ss; 4catel2t1;air;!-luce1;nt;jazeera,qae1;da;as;/dc,a3er,t1;ivisi1;on;demy of scienc0;es;ba,c",Demonym:"true\xA60:16;1:13;a0Wb0Nc0Cd0Ae09f07g04h02iYjVkTlPmLnIomHpDqatari,rBs7t5u4v3wel0Rz2;am0Fimbabwe0;enezuel0ietnam0H;g9krai1;aiwThai,rinida0Iu2;ni0Qrkmen;a4cot0Ke3ingapoOlovak,oma0Tpa05udRw2y0X;edi0Kiss;negal0Br08;mo0uU;o6us0Lw2;and0;a3eru0Hhilipp0Po2;li0Ertugu06;kist3lesti1na2raguay0;ma1;ani;amiZi2orweP;caragu0geri2;an,en;a3ex0Mo2;ngo0Erocc0;cedo1la2;gasy,y08;a4eb9i2;b2thua1;e0Dy0;o,t02;azakh,eny0o2uwaiti;re0;a2orda1;ma0Bp2;anN;celandic,nd4r2sraeli,ta02vo06;a2iT;ni0qi;i0oneV;aiDin2ondur0unN;di;amDe2hanai0reek,uatemal0;or2rm0;gi0;i2ren7;lipino,n4;cuadoVgyp6ngliJsto1thiopi0urope0;a2ominXut4;niH;a9h6o4roa3ub0ze2;ch;ti0;lom2ngol5;bi0;a6i2;le0n2;ese;lifor1m2na3;bo2eroo1;di0;angladeshi,el8o6r3ul2;gaG;aziBi2;ti2;sh;li2s1;vi0;aru2gi0;si0;fAl7merBngol0r5si0us2;sie,tr2;a2i0;li0;gent2me1;ine;ba1ge2;ri0;ni0;gh0r2;ic0;an",Possessive:"true\xA6anyAh5its,m3noCo1sometBthe0yo1;ir1mselves;ur0;!s;i8y0;!se4;er1i0;mse2s;!s0;!e0;lf;o1t0;hing;ne",Currency:"true\xA6$,aud,bScQdLeurKfJgbp,hkd,iIjpy,kGlEp8r7s3usd,x2y1z0\xA2,\xA3,\xA5,\u0434\u0435\u043D,\u043B\u0432,\u0440\u0443\u0431,\u0E3F,\u20A1,\u20A8,\u20AC,\u20AD,\uFDFC;lotyS\u0142;en,uanR;af,of;h0t5;e0il5;k0q0;elM;iel,oubleLp,upeeL;e2ound st0;er0;lingI;n0soH;ceGn0;ies,y;e0i8;i,mpi7;n,r0wanzaCyatC;!onaBw;ls,nr;ori7ranc9;!o8;en3i2kk,o0;b0ll2;ra5;me4n0rham4;ar3;ad,e0ny;nt1;aht,itcoin0;!s",City:"true\xA60:73;1:61;2:6G;3:5U;4:5R;a68b54c4Id4Ae46f3Yg3Jh38i2Zj2Uk2Dl22m1Kn19o16p0Uq0Sr0Ls01tPuOvLwDxiBy9z5;a7h5i4Muri4O;a5e5ongsh0;ng3J;greb,nzib5G;ang2e5okoha3Uunfu;katerin3Jrev0;a5n0O;m5Hn;arsBeAi6roclBu5;h0xi,zh5P;c7n5;d5nipeg,terth4;hoek,s1K;hi5Zkl3C;l63xford;aw;a6ern2i5ladivost5Molgogr6K;en3lni6R;lenc6Dncouv2Yr3ughn;lan bat1Drumqi,trecht;aDbilisi,eCheBi9o8r7u5;l21n63r5;in,ku;ipoli,ondh62;kyo,m34ron1QulouS;an5jua3l2Zmisoa6Era3;j4Xshui; hag65ssaloni2L;gucigal28hr0l av1W;briz,i6llinn,mpe5Ang5rtu,shk2X;i2Msh0;an,chu1n0p2Iyu0;aEeDh8kopje,owe1It7u5ydney;ra5zh51;ba0Jt;aten is59ockholm,rasbou6Auttga31;an8e6i5;jiazhua1llo1m60y0;f54n5;ya1zh4L;gh3Ot4U;att4Ao1Yv49;cramen18int DlBn5o paulo,ppo3Wrajevo; 7aa,t5;a 5ia3Io domin3I;a3fe,m1O;antonCdie3Gfrancisco,j5ped3Ssalv8;o5u0;se;em,v5z2B;ad0I;lou59peters29;aAe9i7o5;me,sar5t5A;io;ga,o5yadh;! de janei3I;cife,ykjavik;b4Uip4lei2Mnc2Swalpindi;ingdao,u5;ez2i0Q;aEeDhCiBo8r7u6yong5;ya1;eb5Aya1;ag54etor53;rt5zn0; 5la4Fo;au prin0Nelizabe29sa05;ls3Srae5Ctts2B;iladelph4Ynom pe1Doenix;r26tah tik3I;ler00naji,r4Pt5;na,r36;ak47des0Lm1Rr6s5ttawa;a3Ylo;an,d07;a8ew6i5ovosibir1Oyc;ng2Hs; 5cast39;del27orlea46taip16york;g8iro4Xn5pl2Zshv36v0;ch6ji1t5;es,o1;a1o1;a6o5p4;ya;no,sa0Y;aFeCi9o6u5;mb2Cni28sc40;gadishu,nt6s5;c17ul;evideo,re31;ami,l6n18s5;kolc,sissauga;an,waukee;cca,d5lbour2Pmph41;an,ell5i3;in,\xEDn;cau,drAkass2Tl9n8r5shh4A;aca6ib5rakesh,se2N;or;i1Ty;a4EchEdal12i47;mo;id;aCeiAi8o6u5vRy2;anLckn0Rdhia3;n5s angel28;d2g bea1O;brev2De3Kma5nz,sb2verpo2A;!ss29;c5pzig;est0C; p6g5ho2Yn0Gusan27;os;az,la35;aHharFiClaipeBo9rak0Hu7y5;iv,o5;to;ala lump4n5;mi1sh0;be,hi0Llka2Zpavog4si5wlo2;ce;da;ev,n5rkuk;gSsha5;sa;k5toum;iv;bIdu3llakuric0Tmpa3Gn6ohsiu1ra5un1Lwaguc0T;c0Sj;d5o,p4;ah1Vy;a7e6i5ohannesZ;l1Xn0;dd37rusalem;ip4k5;ar2J;bad0mph1QnBrkutYs8ta01z5\u0307zm7;m6tapala5;pa;ir;fah0l6tanb5;ul;am2Zi2I;che2d5;ianap2Lo21;aBe8o5yder2W; chi mi6ms,nolulu,u5;st2;nh;f6lsin5rakli2;ki;ei;ifa,lifax,m7n5rb1Dva3;gAnov5oi;er;bu2Wilt2;aFdanEenDhCiPlasgBo9raz,u5;a5jr21;dal6ng5yaquil;zh1H;aja2Lupe;ld coa18then5;bu2P;ow;ent;e0Toa;sk;lw7n5za;dhi5gt1C;nag0S;ay;aisal26es,o8r6ukuya5;ma;ankfu5esno;rt;rt5sh0; wor6ale5;za;th;d5indhov0Nl paso;in5mont2;bur5;gh;aAe8ha0Visp4o7resd0Ju5;b5esseldorf,rb0shanbe;ai,l0G;ha,nggu0rtmu11;hradRl5troit;hi;donghHe5k08li0masc1Xr es sala1HugavpiY;gu,je2;aKebu,hAo5raio03uriti1P;lo7n6penhag0Ar5;do1Nk;akLst0V;gVm5;bo;aBen8i6ongqi1ristchur5;ch;ang m7ca5ttago1;go;g6n5;ai;du,zho1;n5ttogr12;digarh,g5;ch8sha,zh06;i9lga8mayenJn6pe town,r5;acCdiff;ber18c5;un;ry;ro;aUeMhJirmingh0ToIr9u5;chareRdapeRenos air7r5s0tu0;g5sa;as;es;a9is6usse5;ls;ba6t5;ol;ne;sil0Mtisla7zzav5;il5;le;va;goZst2;op6ubaneshw5;ar;al;iBl9ng8r5;g6l5n;in;en;aluru,hazi;fa5grade,o horizonte;st;ji1rut;ghd0BkGnAot9r7s6yan n4;ur;el,r07;celo3ranquil09;na;ou;du1g6ja lu5;ka;alo6k5;ok;re;ng;ers5u;field;a04b01cc00ddis abaZgartaYhmedWizawl,lQmNnHqaZrEsBt7uck5;la5;nd;he7l5;an5;ta;ns;h5unci2;dod,gab5;at;li5;ngt2;on;a6chora5kaNtwerp;ge;h7p5;ol5;is;eim;aravati,m0s5;terd5;am; 8buquerq7e5giers,maty;ppo,xandr5;ia;ue;basrah al qadim5mawsil al jadid5;ah;ab5;ad;la;ba;ra;idj0u dha5;bi;an;lbo6rh5;us;rg",Country:"true\xA60:39;1:2M;a2Xb2Ec22d1Ye1Sf1Mg1Ch1Ai14j12k0Zl0Um0Gn05om3DpZqat1KrXsKtCu6v4wal3yemTz2;a25imbabwe;es,lis and futu2Y;a2enezue32ietnam;nuatu,tican city;.5gTkraiZnited 3ruXs2zbeE;a,sr;arab emirat0Kkingdom,states2;! of am2Y;k.,s.2; 28a.;a7haBimor-les0Bo6rinidad4u2;nis0rk2valu;ey,me2Ys and caic1U; and 2-2;toba1K;go,kel0Znga;iw2Wji2nz2S;ki2U;aCcotl1eBi8lov7o5pa2Cri lanka,u4w2yr0;az2ed9itzerl1;il1;d2Rriname;lomon1Wmal0uth 2;afr2JkLsud2P;ak0en0;erra leoEn2;gapo1Xt maart2;en;negKrb0ychellY;int 2moa,n marino,udi arab0;hele25luc0mart20;epublic of ir0Dom2Duss0w2;an26;a3eHhilippinTitcairn1Lo2uerto riM;l1rtugE;ki2Cl3nama,pua new0Ura2;gu6;au,esti2;ne;aAe8i6or2;folk1Hth3w2;ay; k2ern mariana1C;or0N;caragua,ger2ue;!ia;p2ther19w zeal1;al;mib0u2;ru;a6exi5icro0Ao2yanm05;ldova,n2roc4zamb9;a3gol0t2;enegro,serrat;co;c9dagasc00l6r4urit3yot2;te;an0i15;shall0Wtin2;ique;a3div2i,ta;es;wi,ys0;ao,ed01;a5e4i2uxembourg;b2echtenste11thu1F;er0ya;ban0Hsotho;os,tv0;azakh1Ee3iriba03o2uwait,yrgyz1E;rWsovo;eling0Jnya;a2erF;ma15p1B;c6nd5r3s2taly,vory coast;le of m19rael;a2el1;n,q;ia,oI;el1;aiSon2ungary;dur0Mg kong;aAermany,ha0Pibralt9re7u2;a5ern4inea2ya0O;!-biss2;au;sey;deloupe,m,tema0P;e2na0M;ce,nl1;ar;bTmb0;a6i5r2;ance,ench 2;guia0Dpoly2;nes0;ji,nl1;lklandTroeT;ast tim6cu5gypt,l salv5ngl1quatorial3ritr4st2thiop0;on0; guin2;ea;ad2;or;enmark,jibou4ominica3r con2;go;!n B;ti;aAentral african 9h7o4roat0u3yprQzech2; 8ia;ba,racao;c3lo2morPngo-brazzaville,okFsta r03te d'ivoiK;mb0;osD;i2ristmasF;le,na;republic;m2naTpe verde,yman9;bod0ero2;on;aFeChut00o8r4u2;lgar0r2;kina faso,ma,undi;azil,itish 2unei;virgin2; is2;lands;liv0nai4snia and herzegoviGtswaGuvet2; isl1;and;re;l2n7rmuF;ar2gium,ize;us;h3ngladesh,rbad2;os;am3ra2;in;as;fghaFlCmAn5r3ustr2zerbaijH;al0ia;genti2men0uba;na;dorra,g4t2;arct6igua and barbu2;da;o2uil2;la;er2;ica;b2ger0;an0;ia;ni2;st2;an",Region:"true\xA60:2M;1:2S;2:2J;a2Pb2Cc1Yd1Tes1Sf1Qg1Kh1Gi1Bj17k12l0Zm0On07o05pZqWrTsKtFuCv9w5y3zacatec2T;akut0o0Du3;cat2k07;a4est 3isconsin,yomi1L;bengal,vi6;rwick2Ashington3;! dc;er4i3;rgin0;acruz,mont;dmurt0t3;ah,tar3; 2Ka0W;a5e4laxca1Qripu1Wu3;scaDva;langa1nnessee,x2E;bas0Um3smNtar24;aulip2Cil nadu;a8i6o4taf10u3ylh1E;ffYrr03s19;me1Bno1Puth 3;cVdU;ber0c3kkim,naloa;hu2ily;n4skatchew2xo3;ny; luis potosi,ta catari1;a3hode9;j3ngp06;asth2shahi;ingh24u3;e3intana roo;bec,en5reta0Q;ara7e5rince edward3unjab; i3;sl0A;i,nnsylv3rnambu0A;an0;!na;axa0Xdisha,h3klaho1Zntar3reg6ss0Ax0F;io;aIeDo5u3;evo le3nav0V;on;r3tt16va scot0;f8mandy,th3; 3ampton15;c5d4yo3;rk13;ako1M;aroli1;olk;bras1Lva0Bw3; 4foundland3;! and labrador;brunswick,hamp0Wjers3mexiRyork state;ey;galOyarit;a9eghala0Mi5o3;nta1r3;dov0elos;ch5dlanCn4ss3zor11;issippi,ouri;as geraOneso18;ig2oac2;dhy12harasht0Gine,ni4r3ssachusetts;anhao,i el,ylF;p3toba;ur;anca0Ie3incoln0IouisH;e3iR;ds;a5e4h3omi;aka06ul1;ntucky,ra01;bardino,lmyk0ns0Qr3;achay,el0nata0X;alis5har3iangxi;kh3;and;co;daho,llino6n3owa;d4gush3;et0;ia1;is;a5ert4i3un2;dalFm0D;fordZ;mpYrya1waii;ansu,eorg0lou7oa,u3;an4erre3izhou,jarat;ro;ajuato,gdo3;ng;cesterS;lori3uji2;da;sex;ageTe6o4uran3;go;rs3;et;lawaLrbyK;aEeaDh8o3rimea ,umbr0;ahui6l5nnectic4rsi3ventry;ca;ut;i02orado;la;e4hattisgarh,i3uvash0;apQhuahua;chn4rke3;ss0;ya;ra;lFm3;bridge6peche;a8ihar,r7u3;ck3ryat0;ingham3;shi3;re;emen,itish columb0;h0ja cal7lk6s3v6;hkorto3que;st2;an;ar0;iforn0;ia;dygea,guascalientes,lAndhr8r4ss3;am;izo1kans4un3;achal 6;as;na;a 3;pradesh;a5ber4t3;ai;ta;ba4s3;ka;ma",Place:"true\xA6a0Eb0Bc04d03e02f00gVhUiRjfk,kOlMmJneGoFpBque,rd,s9t6u5v4w1y0;akutOyz;ake isFis1y0;!o;!c;a,ostok,t;laanbaatar,p02safa,t;ahiti,e1he 0;bronx,hamptons;nn,x;a0fo,oho,t,under7yd;khalNsk;a2e1h0itcairn;l,x;k,nnN;!cif04;kla,nt,rd;b1w eng0;land;!r;a1co,i0t,uc;dNnn;gadZlibu,nhattZ;a0gw,hr;s,x;an1osrae,rasnoyar0ul;sk;!s;a1cn,da,nd0st;ianRochina;!x;arlem,kg,nd,oHwy;a3re0;at 0enwich;brita0lakH;in;!y village;co,l0ra;!a;urope,vergladC;ak,en,fw,ist,own4xb;al5dg,gk,h2l1o0rA;lo,nn;!t;a1ina0uuk;town;morro,tham;!if;cn,e1kk,l0rooklyn;vd;l air,verly hills;frica,lta,m7n3r2sia,tl1ve,zor0;es;!ant2;ct1iz;adyr,tarct0;ic0; oce0;an;ericas,s",MaleName:"true\xA60:E5;1:D6;2:DO;3:AY;4:D2;5:CG;6:B6;7:CW;8:C8;9:DK;A:DL;B:A6;C:C2;aCObBLcAJd9He8Nf85g7Ih6Ui6Ej5Ek52l4Dm35n2To2Np2Fqu2Dr1Ls11t0Eu0Dv07wTxSyIzD;aDor0;cDh9Tkaria,n5W;hEkD;!aCM;ar5WeCL;aLoFuD;sDu2KvBY;if,uf;nFsEusD;ouf,sD;ef;aDg;s,tD;an,h0;hli,nBMssX;avi3ho4;aMeKiFoDyaC2;jcie8Clfgang,odrow,utD;!er;lDnst1;bFey,frD1lD;aBDiD;am,e,s;e9Fur;i,nde6sD;!l8t1;de,lErrAyD;l1ne;lDt3;aAAy;aGiDladimir,ojte7Z;cEha0kt69nceDrgAJva0;!nt;e3Vt67;lentDnA5;in4Y;ghBVlyss5Cnax,sm0;aXeShOiMoHrFuEyD;!l3ro7s1;n9r5C;avAWeDist0oy,um0;ntAOv5Zy;bGdFmDny;!as,mDoharu;aCTie,y;!d;iBy;mDt5;!my,othy;adFeoEia8GomD;!as;!do8P;!de5;dGrD;en9LrD;an9KeDy;ll,n9J;!dy;dgh,ha,iDnn3req,tsu4T;cB5ka;aTcotRePhLiJoHpenc3tDur1Vylve9Kzym1;anFeDua8D;f0phBTvDwa8C;e62ie;!islaw,l8;lom1nBFuD;leyma7ta;dDlBm1yabonga;!dhart7Bn8;aFeD;lDrm0;d1t1;h7Une,qu10un,wn,y7;aDbasti0k2Al4Rrg4Oth,ymoAU;m5n;!tD;!ie,y;lEmDnti2Eq5Bul;!ke5MmCu4;ik,vato7X;aYeUheAAiQoHuEyD;an,ou;b7NdEf5pe7SssD;!elBZ;ol3Fy;an,bKcJdIel,geHh0landBQmGnFry,sEyD;!ce;coe,s;!aAHnC;an,eo;l47r;e5Og3n8olfo,ri7A;co,ky;bCeB7;cDl8;ar6Pc6OhEkDo;!ey,ie,y;a99ie;gEid,ubAx,yDza;an1InY;gA8iD;naA4s;ch70fa4lHmGndFpha4sEul,wi2HyD;an,mo82;h7Vm5;alBDol2Uy;iATon;f,ph;ent2inD;cy,t1;aIeGhilFier72ol,rD;aka16eD;m,st1;!ip,lip;dALrcy,tD;ar,e3Gr1X;b4Kdra7Ft4ZulD;!o17;ctav3Fi3liv3mAFndrej,rHsEtDum9wA;is,to;aEc9k9m0vD;al5Z;ma;i,l53vL;aLeJiFoDu3A;aDel,j5l0ma0r3K;h,m;cEg4i49kD;!au,h7Uola;holBkDolB;!olB;al,d,il,ls1vD;il8Y;hom,thD;anDy;!a4i4;aZeWiMoHuEyD;l2Jr1;hamEr6XstaD;fa,p5C;ed,mH;di0We,hamFis2FntEsDussa;es,he;e,y;ad,ed,mD;ad,ed;cIgu4hai,kGlFnEtchD;!e6;a8Aik;house,o0Bt1;ae5YeA4olD;aj;ah,hDk8;aEeD;al,l;el,l;hElv2rD;le,ri6v2;di,met;ay0ck,hTjd,ks2DlRmadWnQrKs1tFuricExD;!imilian9Nwe6;e,io;eGhEiBtDus,yB;!eo,hew,ia;eDis;us,w;j,o;cHio,kGlFqu7Dsha6tDv2;iDy;!m,n;in,on;!el,oPus;!el9IoOus;iGu4;achDcolm,ik;ai,y;amEdi,eDmoud;sh;adDm5T;ou;aXeQiOlo3EoKuEyD;le,nd1;cGiFkDth3uk;aDe;!s;gi,s,z;as,iaD;no;g0nn7SrenFuDv8Jwe6;!iD;e,s;!zo;am,oD;n4r;a8Cevi,la5JnIoGst3thaFvD;eDi;nte;bo;!nD;!a6Sel;!ny;mFnErDur5Hwr5H;ry,s;ce,d1;ar,o5A;aLeGhaled,iDrist5Iu4Vy6X;er0p,rD;by,k,ollD;os;en0iGnDrmit,v44;!dEnDt5Z;e1Ay;a6ri59;r,th;cp3j5m66na73rEsp9them,uD;ri;im,l;a02eUiSoGuD;an,lDst2;en,iD;an,en,o,us;aNeLhnKkubBnIrGsD;eEhDi8Bue;!ua;!ph;dDge;an,i,on;!aDny;h,s,th5I;!ath5Hie,nC;!l,sDy;ph;o,qu2;an,mD;!mC;d,ffIrFsD;sDus;!e;a6BemEmai7oDry;me,ni0Y;i7Ty;!e60rD;ey,y;cKdAkImHrFsEvi3yD;!dAs1;on,p3;ed,od,rDv56;e5Nod;al,es4Xis1;a,e,oDub;b,v;k,ob,quD;es;aWbQchiPgNkeMlija,nuLonut,rJsFtDv0;ai,suD;ki;aEha0i7DmaDsac;el,il;ac,iaD;h,s;a,vinDw2;!g;k,nngu5S;!r;nacDor;io;ka;ai,rahD;im;aPeJoIuDyd9;be2KgGmber4WsD;eyEsD;a2e2;in,n;h,o;m3ra3Gsse2wa4B;aHctGitGnrErD;be2Dm0;iDy;!q11;or;th;bMlLmza,nKo,rFsEyD;a4JdA;an,s0;lGo50rFuDv8;hi4Gki,tD;a,o;is1y;an,ey;k,s;!im;ib;aVeRiPlenOoLrHuD;ilEsD;!tavo;herme,lerD;mo;aFegDov3;!g,orD;io,y;dy,h5Wnt;nzaErD;an,d1;lo;!n;lbe5Ano,oD;rg3Hvan5A;ne,oFrD;aDry;ld,rd5H;ffr8rge;brElArDv2;la28r3Sth,y;e3EielD;!i5;aTePiNlLorr0NrD;anFedDitz;!dCeDri2B;ri2A;cFkD;!ie,lD;in,yn;esLisD;!co,z36;etch3oD;yd;d4lDnn,onn;ip;deriFliEng,rnD;an06;pe,x;co;bi0di,hd;ar04dZfrYit0lSmKnHo2rFsteb0th0uge7vDymAzra;an,eD;ns,re36;gi,i0DnDrol,v2w2;est4Pie;oEriqDzo;ue;ch;aJerIiEmD;aIe2Z;lErD;!h0;!iD;o,s;s1y;nu4;be0Cd1iGliFmEt1viDwood;n,s;er,o;ot1Ys;!as,j4NsD;ha;a2en;!dCg9mGoEuEwD;a2Din;arD;do;o0Wu0W;l,nD;est;a01eRiOoHrGuFwEylD;an,l0;ay7ight;a7dl8nc0st2;ag0ew;minGnEri0ugDvydBy2D;!lB;!a2MnDov0;e6ie,y;go,iDykB;cDk;!k;armuEeDll1on,rk;go;id;anKj0lbeJmetri5nHon,rGsFvEwDxt3;ay7ey;en,in;hawn,mo0B;ek,ri0I;is,nDv3;is,y;rt;!dD;re;an,lNmLnKrGvD;e,iD;! lucDd;as,ca;en,iFne6rDyl;eDin,yl;l3Bn;n,o,us;!e,i4ny;iDon;an,en,on;e,lB;as;a09e07hYiar0lNoIrGuEyrD;il,us;rtD;!is;aDistob0U;ig;dy,lGnErD;ey,neli5y;or,rD;ad;by,e,in,l2t1;aIeFiDyK;fDnt;fo0Ft1;meEt5velaD;nd;nt;rFuEyD;!t1;de;enD;ce;aIeGrisEuD;ck;!tD;i0oph3;st3;er;d,rDs;b4leD;s,y;cDdric,s9;il;lGmer1rD;ey,lEro6y;ll;!os,t1;eb,v2;a07eZiVlaUoRrEuDyr1;ddy,rtK;aLeGiFuEyD;an,ce,on;ce,no;an,ce;nEtD;!t;dEtD;!on;an,on;dEndD;en,on;!foDl8y;rd;bErDyd;is;!by;i7ke;bFlEshD;al;al,lC;ek;nHrDshoi;at,nEtD;!r1C;aDie;rd14;!edict,iEjam2nC;ie,y;to;kaMlazs,nHrD;n8rDt;eDy;tt;ey;dDeE;ar,iD;le;ar17b0Vd0Rf0Pgust2hm0Mi0Jja0Il04m00nSputsiRrIsaHuFveEyDziz;a0kh0;ry;gust5st2;us;hi;aKchJiIjun,maHnFon,tDy0;hDu09;ur;av,oD;ld;an,nd0H;!el,ki;ie;ta;aq;as,dIgel0CtD;hoGoD;i7nD;!i09y;ne;ny;er,reDy;!as,i,s,w;iFmaDos;nu4r;el;ne,r,t;an,bePdAeJfHi,lGonFphXt1vD;aNin;on;so,zo;an,en;onTrD;edU;c,jaGksandFssaGxD;!andD;er,ru;ar,er;ndD;ro;rtN;ni;dAm9;ar;en;ad,eD;d,t;in;onD;so;aEi,olfDri0vik;!o;mDn;!a;dHeGraEuD;!bakr,lfazl;hDm;am;!l;allIelFoulaye,ulD;!lDrF;ah,o;! rD;ahm0;an;ah;av,on",LastName:"true\xA60:9F;1:9V;2:9H;3:9X;4:9N;5:8J;6:9K;7:A0;8:9E;9:88;A:6E;B:77;C:6J;a9Ub8Lc7Kd6Xe6Rf6Dg5Vh58i54j4Pk45l3Nm2Rn2Eo26p1Nquispe,r17s0Ft05vVwOxNyGzD;aytsADhD;aDou,u;ng,o;aGeun7ZiDoshiA9un;!lD;diDmaz;rim,z;maDng;da,guc97mo6UsDzaB;aBhiA7;iao,u;aHeGiEoDright,u;jc8Sng;lDmm0nkl0sniewsB;liA1s3;b0iss,lt0;a5Rgn0lDng,tanabe;k0sh;aHeGiEoDukA;lk5roby5;dAllalDnogr2Zr0Zss0val37;ba,obos;lasEsel7N;lGn dFrg8EsEzD;qu7;ily9Oqu7silj9O;en b35ijk,yk;enzue95verde;aLeix1JhHi4j6ka3IoGrFsui,uD;om4ZrD;c4n0un1;an,embl8TynisB;dor95lst31m2rr9th;at5Mi7LoD;mErD;are6Ylaci64;ps3s0Y;hirAkah8Dnaka;a00chWeThPiNmKoItFuEvDzabo;en8Aobod34;ar7bot2lliv4zuB;aEein0oD;i67j3Lyan8V;l6rm0;kol5lovy5re6Psa,to,uD;ng,sa;iDy5Z;rn5tD;!h;l5YmDngh,rbu;mo6Do6J;aFeDimizu;hu,vchD;en7Cuk;la,r17;gu8mDoh,pulve8Trra4R;jDyD;on5;evi6Filtz,miDneid0roed0ulz,warz;dEtD;!z;!t;ar42h6ito,lFnDr2saBto,v2;ch7d0AtDz;a4Pe,os;as,ihAm3Zo0Q;aOeNiKoGuEyD;a66oo,u;bio,iz,sD;so,u;bEc7Bdrigue57g03j73mDosevelt,ssi,ta7Nux,w3Z;a4Be0O;ertsDins3;!on;bei0LcEes,vDzzo;as,e8;ci,hards3;ag4es,it0ut0y9;dFmEnDsmu7Zv5F;tan1;ir7os;ic,u;aSeLhJiGoErDut6;asad,if5Zochazk1W;lishc24pDrti62u55we66;e2Tov48;cEe09nD;as,to;as60hl0;aDillips;k,m,n5K;de3AetIna,rGtD;ersErovDtersC;!a,ic;en,on;eDic,ry,ss3;i8ra,tz,z;ers;h71k,rk0tEvD;ic,l3T;el,t2O;bJconnor,g2ClGnei5PrEzD;demir,turk;ella3MtDwe5N;ega,iz;iDof6GsC;vDyn1F;ei8;aPri1;aLeJguy1iFoDune44ym4;rodahl,vDwak;ak3Uik5otn56;eEkolDlsCx3;ic,ov6X;ls1miD;!n1;ils3mD;co42ec;gy,kaEray4varD;ro;jiDmu8shiD;ma;aXcVeQiPoIuD;lGnFrDssoli5T;atDpUr68;i,ov2;oz,te4B;d0l0;h4lIo0HrEsDza0Z;er,s;aFeEiDoz5r3Ete4B;!n6F;au,i8no,t4M;!l9;i2Rl0;crac5Ohhail5kke3Qll0;hmeGij0j2ElFndErci0ssiDyer19;!er;e3Bo2Z;n0Io;dAti;cartDlaughl6;hy;dMe6Dgnu5Ei0jer34kLmJnci59rFtEyD;er,r;ei,ic,su1N;iEkAqu9roqu6tinD;ez,s;a54c,nD;!o;a52mD;ad5;e5Oin1;rig4Ns1;aSeMiIoGuEyD;!nch;k2nDo;d,gu;mbarDpe2Rvr2;di;!nDu,yana1R;coln,dD;bDholm;erg;bed5TfeGhtFitn0kaEn6rDw2G;oy;!j;in1on1;bvDvD;re;iDmmy,rsCu,voie;ne,t11;aTennedy,h4iSlQnez46oJrGuEvar4woD;k,n;cerDmar58znets5;a,o2G;aDem0i2Zyeziu;sni3PvD;ch3U;bay4Frh0Jsk0TvaFwalDzl5;czDsB;yk;cFlD;!cDen3Q;huk;!ev2ic,s;e6uiveD;rt;eff0l2mu8nnun1;hn,lloe,minsBrEstra31to,ur,yDzl5;a,s0;j0GlsC;aMenLha2Pim0QoEuD;ng,r2;e2JhFnErge2Ju2NvD;anA;es,ss3;anEnsD;en,on,t3;nesDsC;en,s1;ki26s1;cGkob3RnsDrv06;en,sD;enDon;!s;ks3obs1;brahimAglesi3Ake4Ll0CnoZoneFshikEto,vanoD;u,v4A;awa;scu;aPeIitchcock,jaltal6oFrist46uD;!aDb0gh9ynh;m4ng;a23dz2fEjga2Sk,rDx3B;ak0Yvat;er,fm3B;iGmingw3NnErD;nand7re8;dDriks1;ers3;kkiEnD;on1;la,n1;dz2g1lvoLmJnsCqIrr0SsFuEyD;as36es;g1ng;anEhiD;mo0Q;i,ov08;ue;alaD;in1;rs1;aMeorgLheorghe,iJjonIoGrEuDw3;o,staf2Utierr7zm4;ayDg2iffitUub0;li1G;lub3Rme0JnD;calv9zale0I;aj,i;l,mDordaL;en7;iev3B;gnJlGmaFnd2No,rDs2Nuthi0;cDza;ia;ge;eaElD;agh0i,o;no;e,on;ab0erMiIjeldsted,lor9oGrFuD;cDent9ji3F;hs;an1Wiedm4;ntaDrt6st0urni0;na;lipEsD;ch0;ovD;!ic;hatAnandeVrD;arDei8;a,i;ov2;dHinste6riksCsDva0D;cob2ZpDtra2X;inoDosiM;za;en,s3;er,is3wards;aUeMiKjurhuJoHrisco0YuEvorakD;!oQ;arte,boEmitru,rDt2U;and,ic;is;g4he0Hmingu7n2Ord19tD;to;us;aDmitr29ssanayake;s,z; GbnaFlEmirDrvis1Lvi,w4;!ov2;gado,ic;th;bo0groot,jo03lEsilDvri9;va;a cruz,e3uD;ca;hl,mcevsBnErw6t2EviD;d5es,s;ieDku1S;ls1;ki;a05e00hNiobMlarkLoFrD;ivDuz;elli;h1lGntFop0rDs26x;byn,reD;a,ia;i,rer0O;em4liD;ns;!e;anu;aLeIiu,oGriDuJwe;stD;eDiaD;ns1;i,ng,uFwDy;!dhury;!n,onEuD;ng;!g;kEnDtterjee,v7;!d,g;ma,raboD;rty;bGl09ng2rD;eghetEnD;a,y;ti;an,ota0M;cer9lder3mpbeIrFstDvadi08;iDro;llo;doEt0uDvalho;so;so,zo;ll;es;a09eXhUiSlNoGrFyD;rne,tyD;qi;ank5iem,ooks,yant;gdan5nFruya,su,uchEyHziD;c,n5;ard;darDik;enD;ko;ov;aEondD;al;nEzD;ev2;co;ancRshwD;as;a01oDuiy4;umDwmD;ik;ckNethov1gu,ktLnJrD;gGisFnD;ascoDds1;ni;ha;er,mD;ann;gtDit7nett;ss3;asD;hi;er,ham;b2ch,ez,hMiley,kk0nHrDu0;bEnDua;es,i0;ieDosa;ri;dDik;a8yopadhyD;ay;ra;er;k,ng;ic;cosZdYguilXkhtXlSnJrGsl4yD;aEd6;in;la;aEsl4;an;ujo,ya;dFgelD;ovD;!a;ersGov,reD;aDjL;ss1;en;en,on,s3;on;eksejGiyGmeiFvD;ar7es;ez;da;ev;ar;ams;ta",WeekDay:"true\xA6fri2mon2s1t0wednesd3;hurs1ues1;aturd1und1;!d0;ay0;!s",Month:"true\xA6aBdec9feb7j2mar,nov9oct1sep0;!t8;!o8;an3u0;l1n0;!e;!y;!u1;!ru0;ary;!em0;ber;pr1ug0;!ust;!il",Date:"true\xA6ago,t2week0yesterd4; e0e0;nd;mr2o0;d0morrow;ay;!w",FirstName:"true\xA6aKblair,cGdevFgabrieEhinaDjBk8l7m3nelly,quinn,re2sh0;ay,e0iloh;a,lby;g6ne;a1el0ina,org5;!okuh9;naia,r0;ion,lo;ashawn,uca;asCe1ir0rE;an;lsAnyat2rry;am0ess6ie,ude;ie,m5;ta;le;an,on;as2h0;arl0eyenne;ie;ey,sidy;lex2ndr1ubr0;ey;a,ea;is",Person:"true\xA6ashton kutchTbScNdLeJgastOhHinez,jFkEleDmCnettKoBp9r4s3t2v0;a0irgin maH;lentino rossi,n go3;aylor,heresa may,iger woods,yra banks;addam hussain,carlett johanssKlobodan milosevic,uC;ay romano,e3o1ush limbau0;gh;d stewart,nald0;inho,o;ese witherspoFilly;a0ipJ;lmIris hiltD;prah winfrFra;essiaen,itt romnEubarek;bron james,e;anye west,iefer sutherland,obe bryant;aime,effers8k rowli0;ng;alle ber0itlBulk hogan;ry;ff0meril lagasse,zekiel;ie;a0enzel washingt2ick wolf;lt1nte;ar1lint0;on;dinal wols1son0;! palm2;ey;arack obama,rock;er",Verb:"true\xA6awak9born,cannot,fr8g7h5k3le2m1s0wors9;e8h3;ake sure,sg;ngth6ss6;eep tabs,n0;own;as0e2;!t2;iv1onna;ight0;en",PhrasalVerb:"true\xA60:7E;1:72;2:7Q;3:7G;4:6V;5:7T;6:7I;7:6O;8:71;9:6P;A:5T;B:7C;C:7J;D:6Q;E:7L;F:7D;G:7S;H:46;a7Yb6Jc5Sd5Oe5Mf4Lg43h3Miron0j3Ik3Dl2Xm2Ln2Jo2Hp1ZquietDr1Ms0FtVuTvacuum 1wLyammerBzI;eroAip JonI;e0k0;by,up;aOeLhKiJorIrit5H;d 1k35;mp0n2Xpe0r7s7;eel Fip G;aJiIn2L;gh 0Crd0;n Fr 3S;it 60k7lk6rm 6Bsh 7Lt6Ov53;rgeBsI;e 9herA;aXeVhTiPoNrKuIype 68;ckArn I;d2in,o3Vup;aJiIot0y 2L;ckleDp G;ckDde 02;neDp Is4Q;d2o71up;ck KdJe Igh69me0p o0Kre0;aw3ba4d2in,up;e 60y 1;by,oC;ink Irow 6B;ba4ov8up;aIe 4Vll52;m 1r 01;ckBke Jlk I;ov8u53;aIba4d2in,o3Fup;ba4ft8p58w3;a0Nc0Me0Gh0Ci09l05m04n03o02pXquare WtOuMwI;earKiI;ngJtch I;aw3ba4o75; by;ck Iit 1m 1ss0;in,up;aNe10iMoKrIucH;aigh1ZiI;ke 6En3C;p Irm22;by,in,oC;nHr 1tc3V;cHmp0nd Ir6Xve6y 1;ba4d2up;d2oCup;arHeLiKlJrIurB;ingBuc7;a3Hit 47;l16n 1;e5Qll0;be4Prt0;ap 4Row F;ash 5Doke0;eep JiIow 9;c3Yp 1;in,oI;ff,v8;gn 4WngJt Iz7;d2o5up; al52le0;aKoIu4S;ot Iut0w 6B;aw3ba4f3IoC;cHdeAk56ve6;e Mll0nd LtI; Itl4G;d2in,o5upI;!on;aw3ba4d2in,o2Aup;o5to;al4Zout0rap4Z;il6v7;aTeQiPoLuI;b 4Sle0n Istl7;aIba4d2in5Ho3Tt3Bu3R;c29w3;ll Kot JuI;g2Vnd6;a29f32o5;arEin,o5;ng 51p6;aIel6inAnt0;c5Bd I;o33u0L;cHt0;aVeUiTlRoPrMsyc2JuI;ll Kt I;aIba4d2in,o1Rt3Fup;p3Kw3;ap3Jd2in,o5t3Dup;attleBess JiLoI;p 1;ah1Ron;iIp 5Fr3XurDwer 5F;nt0;ay4BuI;gAmp 9;ck Gg0leBn 9p48;el 4JncilA;c41ir 2Rn0ss KtJy I;ba4oC; d2c27;aw3ba4o1C;pIw3W;e3Vt F;arrowDerd0oI;d6teD;aQeNiMoKuI;ddl7lI;l 3I;cHp 1uth6ve I;al3Md2in,o5up;ss0x 1;asur7lJss I;a1Jup;t 9;ke Jn 9rIs1Sx0;k 9ry6;do,o47up;aVeTiOoIuck0;aMc3Gg LoIse0;k Ise3E;aft8ba4d2forw2Jin45ov8uI;nd8p;in,o0Q;d 9;e LghtKnJsIv1Y;ten G;e 1k 1; 1e36;arEd2;av1Mt 36velI; o3T;c7p 1sh ItchBugh6y20;in3To5;eJick6nock I;d2o3P;eIyA;l 2Pp I;aw3ba4d2fXin,o0Bto,up;aKoJuI;ic7mpA;ke30tD;c39zz 1;aUePiMoJuI;nkerDrry 1s0Z;lIneArse2W;d Ie 1;ba4d2fast,o05up;de Jt I;ba4on,up;aw3o5;aIlp0;d Kl 2Ar It 1;fIof;rom;in,oXu1H;cHm 1nJve Iz25;it,to;d Ig 2EkerK;d2in,o5;aWeQive Oloss 22oKrJunI; f0Q;in3Gow 2A; Iof 0Y;aJb1Dit,oIrEt0Su18;ff,n,v8;bo5ft8hOw3;aw3ba4d2in,oIup,w3;ff,n,ut;a1Dek0t I;aJb17d2oIrEup;ff,n,ut,v8;cJhIl1WrEt,w3;ead;ross;d aJnI;g 1;bo5;a0Ce05iWlSoOrKuI;cHel 1;k 1;eJighten IownBy 1;aw3oC;eIshe1N; 1z7;lKol I;aIwi1G;bo5rE;d 9low 1;aJeIip0;sh0;g 9ke0mIrI;e G;gPlNnLrJsIzzle0;h G;e Im 1;aw3ba4up;d0isI;h 1;e Il 19;aw3fN;ht ba4ure0;eNnJsI;s 1;cKd I;fIoC;or;e F;dWl 1;cMll Irm0t0W;ap05bKd2in,oJtI;hrough;ff,ut,v8;a4ehi20;e J;at0dge0nd Iy7;oCup;oKrI;ess 9op I;aw3bUin,o1D; 0Eubl7;aYhVlean 9oIross Fut 10;me LoJuntI; o1T;k 1l I;d2oC;aObNforLin,oKtJuI;nd8;ogeth8;ut,v8;th,wI;ard;a4y;pIrEw3;art;eIipA;ck FeI;r 1;lOncel0rLsKtch JveA; in;o1Cup;h Ft6;ry JvI;e 01;aw3o18;l ImD;aIba4d2o16up;rEw3;a0Ne0El07oYrNuI;bblKcklZil05lk 9ndlZrn 0Bst JtIy Gzz6;t F;in,o5up;e I;ov8;anReaPiIush6;ghMng I;aJba4d2forIin,o5up;th;bo5lIrEw3;ong;teI;n 1;k I;d2in,o5up;ch0;arPgDil 9n7oLssKttlJunce Ix F;aw3ba4;e 9; arE;k Ft 1;e 1;d2up; d2;d 1;aNeed0oIurt0;cKw I;aw3ba4d2o5up;ck;k I;in,oP;ck0nk0st6; oOaLef 1nd I;d2ov8up;er;up;r0t I;d2in,oIup;ff,ut;ff,nI;to;ck Oil0nKrgJsI;h F;ainBe F;g FkB; on;in,o5; o5;aw3d2o5up;ay;cRdNsk Kuction6; oC;ff;arEo5;ouI;nd;d I;d2oIup;ff,n;own;t G;o5up;ut",Modal:"true\xA6c5lets,m4ought3sh1w0;ill,o5;a0o4;ll,nt;! to,a;ay,ight,ust;an,o0;uld",Adjective:"true\xA60:7P;1:84;2:83;3:8A;4:7W;5:5S;6:4N;7:4O;8:58;9:6I;A:81;a6Wb6Gc63d5Je54f4Hg49h3Wi39j37k36l2Vm2Ln2Bo1Wp1Dquack,r12s0Ft07uMvJwByear5;arp0eFholeEiDoB;man5oBu6P;d6Rzy;despr7Ls5S;!sa7;eClBste2A;co1Nl o4W;!k5;aCiBola4M;b89ce versa,ol5H;ca3gabo6Gnilla;ltUnHpCrb5Msu4tterB;!mo7G; Eb1SpDsBti1M;ca7etBide dKtairs;!ti2;er,i3U;f36to da1;aLbeco75convin29deIeHfair,ivers4knGprecedVrEsCwB;iel3Nritt6A;i1XuB;pervis0spec3Y;eBu5;cognHgul6Tl6T;own;ndi2v64xpect0;cid0rB;!grou5ZsB;iz0tood;b7pp0Dssu6UuthorB;iz0;i26ra;aGeEhDi6AoCrB;i1oubl0us3M;geth8p,rp6Vuc67;ough4Wril33;en60l32mpBrr2X;o6Ati2;boo,lBn;ent0;aWcVeThSiQmug,nobbi3LoOpNqueami3LtFuBymb6H;bDi gener5DpBrpri6D;erBre0N;! dup8b,i2C;du0seq52;anda77eGiFrBunni2y3F;aightCiB;ki2p0; fBfB;or5K;ll,r5S;aBreotyp0;dfa6Cmi2;a55ec2Gir1Hlend6Cot on; call0le,mb8phist1XrBu0Vvi48;d6Ary;gnifica3nB;ce51g7;am2Re8ocki2ut;cBda1em5lfi32ni1Wpa6Jre6;o1Er42;at5Gient28reec5G;cr0me;aJeEiCoB;bu60tt51uQy4;ghtBv4;!-2Bf9;ar,bel,condi1du6Dfres5AlEpublic42sCtard0vB;ea26;is4CoB;lu1na3;aQe1Cuc4A;b5TciBllyi2;al,st;aOeLicayu6lac5Ropuli5QrCuB;bl5Jmp0n51;eGiDoB;!b07fu5RmiBp8;ne3si2;mCor,sBva1;ti6;a53e;ci5MmB;a0EiB;er,um;ac20rBti1;feAma2XpleBv38;xi2;rBst;allelDtB;-tiBi4;me;!ed;bLffJkIld fashion0nHpGrg1Eth8utFvB;al,erB;!all,niCt,wB;eiBrouB;ght;do0Ter,g2Qsi4B;en,posi1; boa5Og2Oli6;!ay; gua5MbBli6;eat;eDsB;cBer0Eole1;e6u3O;d2Xse;aJeIiHoBua4X;nFrCtB;ab7;thB;!eB;rn;chala3descri58stop;ght5;arby,cessa44ighbor5xt;k0usia1A;aIeGiDoBultip7;bi7derBl0Vnth5ot,st;a1n;nBx0;dblo0RiaBor;tu37;ande3Qdi4NnaBre;ci2;cBgenta,in,j01keshift,le,mmoth,ny,sculi6;ab33ho;aKeFiCoBu15;uti14vi2;mCteraB;l,te;it0;ftEgBth4;al,eCitiB;ma1;nda3K;!-0C;ngu3Zst,tt8;ap1Xind5no0A;agg0uB;niMstifi0veni7;de4gno4Klleg4mQnEpso 20rB;a1rB;eleBita0J;va3; KaJbr0corIdGfluenQiQnFsEtCviB;go0Fti2;aAen3SoxB;ic3B;a6i2Vul0D;a1er,oce3;iCoB;or;reA;deq3Qppr33;fBsitu,vitro;ro3;mFpB;arDerfeAoBrop8;li1rtB;a3ed;ti4;eBi0S;d2Vn3C;aIeFiDoBumdr3I;ne36ok0rrBs08ur5;if2Z;ghfalut1QspB;an2X;aClB;liYpf9;li2;lEnDrB;d04roB;wi2;dy;f,low0;ainf9ener2Oiga24lHoGraDuB;ilBng ho;ty;cCtB;ef9is;ef9;ne,od;ea2Iob4;aTeNinMlKoFrB;a1VeDoz1MustB;raB;ti2;e2Gq10tf9;oDrB; keeps,eBm8tuna1;g03ign;liB;sh;aBue3;g31tte1P;al,i1;dFmCrB;ti7;a7ini6;ne;le; up;bl0i3l27r Cux,voB;ri1uri1;oBreac1E;ff;aLfficie3lKmHnFreAthere4veExB;aAcess,pe1QtraCuB;be2Nl0E;!va1E;n,ryday; BcouraEti0O;rou1sui1;erCiB;ne3;gi2;abo23dMe17i1;g8sB;t,ygB;oi2;er;aReJiDoBrea14ue;mina3ne,ubB;le,tf9;dact1Bfficu1OsCvB;er1K;creDeas0gruntl0hone1FordCtB;a3ressM;er5;et; HadpGfFgene1PliDrang0spe1PtCvoB;ut;ail0ermin0;be1Mca1ghB;tf9;ia3;an;facto;i5magBngeroUs0G;ed,i2;ly;ertaMhief,ivil,oDrB;aBowd0u0G;mp0vZz0;loImGnCrrBve0P;eAu1I;cre1fu0LgrDsCtB;empo0Dra0E;ta3;ue3;mer08pleB;te,x;ni4ss4;in;aNeIizarHlFoCrB;and new,isk,okN;gCna fiUttom,urgeoB;is;us;ank,indB;!i2;re;autif9hiDloCnBst,yoD;eUt;v0w;nd;ul;ckCnkru0WrrB;en;!wards; priori,b0Mc0Jd09fra08g04h03lYmWntiquVppSrMsIttracti06utheHvEwB;aCkB;wa0T;ke,re;ant garCerB;age;de;ntU;leep,piDsuDtonB;isB;hi2;ri2;ab,bitEroDtiB;fiB;ci4;ga3;raB;ry;are3etiNrB;oprB;ia1;at0;aJuB;si2;arEcohCeBiIl,oof;rt;olB;ic;mi2;ead;ainDgressiConiB;zi2;ve;st;id; IeGuFvB;aCerB;se;nc0;ed;lt;pt,qB;ua1;hoc,infinitB;um;cuCtu4u1;al;ra1;erLlKoIruHsCuB;nda3;e3oCtraA;ct;lu1rbi2;ng;te;pt;aBve;rd;aze,e;ra3;nt",Comparable:"true\xA60:41;1:4I;2:45;3:2Y;4:4B;5:3X;a4Ob44c3Od3De35f2Rg2Fh24i1Vj1Uk1Rl1Jm1Dn17o15p0Vqu0Tr0KsTtMuIvFw7y6za13;ell27ou4;aBe9hi1Yi7r6;o4y;ck0Ode,l6n1ry,se;d,y;a6i4Mt;k,ry;n1Tr6sK;m,y;a7e6ulgar;nge5rda2xi4;g9in,st;g0n6pco3Mse5;like0t6;i1r6;ue;aAen9hi8i7ough,r6;anqu2Oen1ue;dy,g3Sme0ny,r09;ck,n,rs2P;d40se;ll,me,rt,s6wd45;te5;aVcarUeThRiQkin0FlMmKoHpGqua1FtAu7w6;eet,ift;b7dd13per0Gr6;e,re2H;sta2Ft3;aAe9iff,r7u6;pXr1;a6ict,o4;ig3Fn0U;a1ep,rn;le,rk;e22i3Fright0;ci28ft,l7o6re,ur;n,thi4;emn,id;a6el0ooth;ll,rt;e8i6ow,y;ck,g35m6;!y;ek,nd3D;ck,l0mp3;a6iTort,rill,y;dy,ll0Xrp;cu0Rve0Rxy;ce,ed,y;d,fe,int0l1Vv14;aBe9i8o6ude;mantic,o1Isy,u6;gh,nd;ch,pe,tzy;a6d,mo0H;dy,l;gg7ndom,p6re,w;id;ed;ai2i6;ck,et;aEhoDi1QlCoBr8u6;ny,r6;e,p3;egna2ic7o6;fouYud;ey,k0;li04or,te1B;ain,easa2;ny;in5le;dd,f6i0ld,ranQ;fi10;aAe8i7o6;b3isy,rm15sy;ce,mb3;a6w;r,t;ive,rr01;aAe8ild,o7u6;nda19te;ist,o1;a6ek,llX;n,s0ty;d,tuQ;aBeAi9o6ucky;f0Un7o1Du6ve0w17y0T;d,sy;e0g;g1Tke0tt3ve0;an,wd;me,r6te;ge;e7i6;nd;en;ol0ui1P;cy,ll,n6;sBt6;e6ima8;llege2r6;es7media6;te;ti4;ecu6ta2;re;aEeBiAo8u6;ge,m6ng1R;b3id;ll6me0t;ow;gh,l0;a6f04sita2;dy,v6;en0y;nd1Hppy,r6te5;d,sh;aGenFhDiClBoofy,r6;a9e8is0o6ue1E;o6ss;vy;at,en,y;nd,y;ad,ib,ooI;a2d1;a6o6;st0;t3uiY;u1y;aIeeb3iDlat,oAr8u6;ll,n6r14;!ny;aHe6iend0;e,sh;a7r6ul;get5mG;my;erce8n6rm;an6e;ciC;! ;le;ir,ke,n0Fr,st,t,ulA;aAerie,mp9sse7v6xtre0Q;il;nti6;al;ty;r7s6;tern,y;ly,th0;aFeCi9r7u6;ll,mb;u6y;nk;r7vi6;ne;e,ty;a6ep,nD;d6f,r;!ly;mp,pp03rk;aHhDlAo8r7u6;dd0r0te;isp,uel;ar6ld,mmon,ol,st0ward0zy;se;e6ou1;a6vW;n,r;ar8e6il0;ap,e6;sy;mi4;gey,lm8r6;e5i4;ful;!i4;aNiLlIoEr8u6;r0sy;ly;aAi7o6;ad,wn;ef,g7llia2;nt;ht;sh,ve;ld,r7un6;cy;ed,i4;ng;a7o6ue;nd,o1;ck,nd;g,tt6;er;d,ld,w1;dy;bsu9ng8we6;so6;me;ry;rd",TextOrdinal:"true\xA6bGeDf9hundredHmGnin7qu6s4t0zeroH;enGh1rFwe0;lfFn9;ir0ousandE;d,t4;e0ixt9;cond,ptAvent8xtA;adr9int9;et0th;e6ie8;i2o0;r0urt3;tie5;ft1rst;ight0lev1;e0h,ie2;en1;illion0;th",Cardinal:"true\xA6bHeEf8hundred,mHnineAone,qu6s4t0zero;en,h2rGw0;e0o;lve,n8;irt9ousandEree;e0ix5;pt1ven4xt1;adr0int0;illion;i3o0;r1ur0;!t2;ty;ft0ve;e2y;ight0lev1;!e0y;en;illion0;!s",Expression:"true\xA6a02b01dXeVfuck,gShLlImHnGoDpBshAtsk,u7voi04w3y0;a1eLu0;ck,p;!a,hoo,y;h1ow,t0;af,f;e0oa;e,w;gh,h0;! 0h,m;huh,oh;eesh,hh,it;ff,hew,l0sst;ease,z;h1o0w,y;h,o,ps;!h;ah,ope;eh,mm;m1ol0;!s;ao,fao;a4e2i,mm,oly1urr0;ah;! mo6;e,ll0y;!o;ha0i;!ha;ah,ee,o0rr;l0odbye;ly;e0h,t cetera,ww;k,p;'oh,a0uh;m0ng;mit,n0;!it;ah,oo,ye; 1h0rgh;!em;la",Adverb:"true\xA6a08by 06d02eYfShQinPjustOkinda,mMnJoEpCquite,r9s5t2up1very,well,ye0;p,s; to,wards5;h1iny bit,o0wiO;o,t6ward;en,us;everal,o0uch;!me1rt0; of;hYtimes,w09;a1e0;alT;ndomSthN;ar excellDer0oint blank; Nhaps;f3n0;ce0ly;! 0;ag02moW; courIten;ewKo0; longEt 0;onIwithstanding;aybe,eanwhiAore0;!ovB;! aboU;deed,steV;en0;ce;or2u0;lArther0;!moJ; 0ev3;examp0good,suH;le;n1v0;er; mas0ough;se;e0irect1; 1finite0;ly;ju8trop;far,n0;ow; DbroCd nauseam,gBl6ny3part,s2t 0w4;be6l0mo6wor6;arge,ea5; soon,ide;mo1w0;ay;re;l 1mo0one,ready,so,ways;st;b1t0;hat;ut;ain;ad;lot,posteriori",Determiner:"true\xA6aAboth,d8e5few,l3mu7neiCown,plenty,some,th2various,wh0;at0ich0;evB;at,e3is,ose;a,e0;!ast,s;a1i6l0very;!se;ch;e0u;!s;!n0;!o0y;th0;er"},Zl="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",Iy=Zl.split("").reduce(function(l,t,e){return l[t]=e,l},{}),jC=function(t){if(Zl[t]!==void 0)return Zl[t];for(var e=1,n=36,r="";t>=n;t-=n,e++,n*=36);for(;e--;){var i=t%36;r=String.fromCharCode((i<10?48:55)+i)+r,t=(t-i)/36}return r},UC=function(t){if(Iy[t]!==void 0)return Iy[t];for(var e=0,n=1,r=36,i=1;n<t.length;e+=r,n++,r*=36);for(var a=t.length-1;a>=0;a--,i*=36){var s=t.charCodeAt(a)-48;s>10&&(s-=7),e+=s*i}return e},Xl={toAlphaCode:jC,fromAlphaCode:UC},HC=function(t){for(var e=new RegExp("([0-9A-Z]+):([0-9A-Z]+)"),n=0;n<t.nodes.length;n++){var r=e.exec(t.nodes[n]);if(!r){t.symCount=n;break}t.syms[Xl.fromAlphaCode(r[1])]=Xl.fromAlphaCode(r[2])}t.nodes=t.nodes.slice(t.symCount,t.nodes.length)},KC=function(t,e,n){var r=Xl.fromAlphaCode(e);return r<t.symCount?t.syms[r]:n+r+1-t.symCount},WC=function(t){var e=[],n=function r(i,a){var s=t.nodes[i];s[0]==="!"&&(e.push(a),s=s.slice(1));for(var o=s.split(/([A-Z0-9,]+)/g),u=0;u<o.length;u+=2){var c=o[u],f=o[u+1];if(!!c){var p=a+c;if(f===","||f===void 0){e.push(p);continue}var d=KC(t,f,i);r(d,p)}}};return n(0,""),e},GC=function(t){var e={nodes:t.split(";"),syms:[],symCount:0};return t.match(":")&&HC(e),WC(e)},ZC=GC,XC=function(t){var e=t.split("|").reduce(function(r,i){var a=i.split("\xA6");return r[a[0]]=a[1],r},{}),n={};return Object.keys(e).forEach(function(r){var i=ZC(e[r]);r==="true"&&(r=!0);for(var a=0;a<i.length;a++){var s=i[a];n.hasOwnProperty(s)===!0?Array.isArray(n[s])===!1?n[s]=[n[s],r]:n[s].push(r):n[s]=r}}),n},JC=XC,YC={"20th century fox":"Organization","7 eleven":"Organization","motel 6":"Organization",g8:"Organization",vh1:"Organization",q1:"Date",q2:"Date",q3:"Date",q4:"Date",her:["Possessive","Pronoun"],his:["Possessive","Pronoun"],their:["Possessive","Pronoun"],themselves:["Possessive","Pronoun"],your:["Possessive","Pronoun"],our:["Possessive","Pronoun"],my:["Possessive","Pronoun"],its:["Possessive","Pronoun"]},My={Unit:function(t,e){t[e]=["Abbreviation","Unit"]},Cardinal:function(t,e){t[e]=["TextValue","Cardinal"]},TextOrdinal:function(t,e){t[e]=["Ordinal","TextValue"],t[e+"s"]=["TextValue","Fraction"]},Singular:function(t,e,n){t[e]="Singular";var r=n.transforms.toPlural(e,n);t[r]=t[r]||"Plural"},Infinitive:function(t,e,n){t[e]="Infinitive";for(var r=n.transforms.conjugate(e,n),i=Object.keys(r),a=0;a<i.length;a++){var s=r[i[a]];t[s]=t[s]||i[a]}},Comparable:function(t,e,n){t[e]="Comparable";for(var r=n.transforms.adjectives(e),i=Object.keys(r),a=0;a<i.length;a++){var s=r[i[a]];t[s]=t[s]||i[a]}},PhrasalVerb:function(t,e,n){t[e]=["PhrasalVerb","Infinitive"];for(var r=e.split(" "),i=n.transforms.conjugate(r[0],n),a=Object.keys(i),s=0;s<a.length;s++){var o=i[a[s]]+" "+r[1];t[o]=t[o]||["PhrasalVerb",a[s]],n.hasCompound[i[a[s]]]=!0}},Demonym:function(t,e,n){t[e]="Demonym";var r=n.transforms.toPlural(e,n);t[r]=t[r]||["Demonym","Plural"]}},Oy=function(t,e,n){Object.keys(t).forEach(function(r){var i=t[r];(i==="Abbreviation"||i==="Unit")&&(n.cache.abbreviations[r]=!0);var a=r.split(" ");if(a.length>1&&(n.hasCompound[a[0]]=!0),My[i]!==void 0){My[i](e,r,n);return}if(e[r]===void 0){e[r]=i;return}typeof e[r]=="string"&&(e[r]=[e[r]]),typeof i=="string"?e[r].push(i):e[r]=e[r].concat(i)})},QC=function(t){var e=Object.assign({},YC);return Object.keys(Vy).forEach(function(n){var r=JC(Vy[n]);Object.keys(r).forEach(function(i){r[i]=n}),Oy(r,e,t)}),e},Ey={buildOut:QC,addWords:Oy},eN=function(t){for(var e=t.irregulars.nouns,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];t.words[i]="Singular",t.words[e[i]]="Plural"}for(var a=t.irregulars.verbs,s=Object.keys(a),o=function(f){var p=s[f];t.words[p]=t.words[p]||"Infinitive";var d=t.transforms.conjugate(p,t);d=Object.assign(d,a[p]),Object.keys(d).forEach(function(m){t.words[d[m]]=t.words[d[m]]||m,t.words[d[m]]==="Participle"&&(t.words[d[m]]=m)})},u=0;u<s.length;u++)o(u)},tN=eN,rN={addendum:"addenda",alga:"algae",alumna:"alumnae",alumnus:"alumni",analysis:"analyses",antenna:"antennae",appendix:"appendices",avocado:"avocados",axis:"axes",bacillus:"bacilli",barracks:"barracks",beau:"beaux",bus:"buses",cactus:"cacti",chateau:"chateaux",child:"children",circus:"circuses",clothes:"clothes",corpus:"corpora",criterion:"criteria",curriculum:"curricula",database:"databases",deer:"deer",diagnosis:"diagnoses",echo:"echoes",embargo:"embargoes",epoch:"epochs",foot:"feet",formula:"formulae",fungus:"fungi",genus:"genera",goose:"geese",halo:"halos",hippopotamus:"hippopotami",index:"indices",larva:"larvae",leaf:"leaves",libretto:"libretti",loaf:"loaves",man:"men",matrix:"matrices",memorandum:"memoranda",modulus:"moduli",mosquito:"mosquitoes",mouse:"mice",nebula:"nebulae",nucleus:"nuclei",octopus:"octopi",opus:"opera",ovum:"ova",ox:"oxen",parenthesis:"parentheses",person:"people",phenomenon:"phenomena",prognosis:"prognoses",quiz:"quizzes",radius:"radii",referendum:"referenda",rodeo:"rodeos",sex:"sexes",shoe:"shoes",sombrero:"sombreros",stimulus:"stimuli",stomach:"stomachs",syllabus:"syllabi",synopsis:"synopses",tableau:"tableaux",thesis:"theses",thief:"thieves",tooth:"teeth",tornado:"tornados",tuxedo:"tuxedos",vertebra:"vertebrae"},nN={g:"Gerund",prt:"Participle",perf:"PerfectTense",pst:"PastTense",fut:"FuturePerfect",pres:"PresentTense",pluperf:"Pluperfect",a:"Actor"},si={act:{a:"_or"},ache:{pst:"ached",g:"aching"},age:{g:"ageing",pst:"aged",pres:"ages"},aim:{a:"_er",g:"_ing",pst:"_ed"},arise:{prt:"_n",pst:"arose"},babysit:{a:"_ter",pst:"babysat"},ban:{a:"",g:"_ning",pst:"_ned"},be:{a:"",g:"am",prt:"been",pst:"was",pres:"is"},beat:{a:"_er",g:"_ing",prt:"_en"},become:{prt:"_"},begin:{g:"_ning",prt:"begun",pst:"began"},being:{g:"are",pst:"were",pres:"are"},bend:{prt:"bent"},bet:{a:"_ter",prt:"_"},bind:{pst:"bound"},bite:{g:"biting",prt:"bitten",pst:"bit"},bleed:{pst:"bled",prt:"bled"},blow:{prt:"_n",pst:"blew"},boil:{a:"_er"},brake:{prt:"broken"},break:{pst:"broke"},breed:{pst:"bred"},bring:{pst:"brought",prt:"brought"},broadcast:{pst:"_"},budget:{pst:"_ed"},build:{pst:"built",prt:"built"},burn:{prt:"_ed"},burst:{prt:"_"},buy:{pst:"bought",prt:"bought"},can:{a:"",fut:"_",g:"",pst:"could",perf:"could",pluperf:"could",pres:"_"},catch:{pst:"caught"},choose:{g:"choosing",prt:"chosen",pst:"chose"},cling:{prt:"clung"},come:{prt:"_",pst:"came",g:"coming"},compete:{a:"competitor",g:"competing",pst:"_d"},cost:{pst:"_"},creep:{prt:"crept"},cut:{prt:"_"},deal:{pst:"_t",prt:"_t"},develop:{a:"_er",g:"_ing",pst:"_ed"},die:{g:"dying",pst:"_d"},dig:{g:"_ging",pst:"dug",prt:"dug"},dive:{prt:"_d"},do:{pst:"did",pres:"_es"},draw:{prt:"_n",pst:"drew"},dream:{prt:"_t"},drink:{prt:"drunk",pst:"drank"},drive:{g:"driving",prt:"_n",pst:"drove"},drop:{g:"_ping",pst:"_ped"},eat:{a:"_er",g:"_ing",prt:"_en",pst:"ate"},edit:{pst:"_ed",g:"_ing"},egg:{pst:"_ed"},fall:{prt:"_en",pst:"fell"},feed:{prt:"fed",pst:"fed"},feel:{a:"_er",pst:"felt"},fight:{pst:"fought",prt:"fought"},find:{pst:"found"},flee:{g:"_ing",prt:"fled"},fling:{prt:"flung"},fly:{prt:"flown",pst:"flew"},forbid:{pst:"forbade"},forget:{g:"_ing",prt:"forgotten",pst:"forgot"},forgive:{g:"forgiving",prt:"_n",pst:"forgave"},free:{a:"",g:"_ing"},freeze:{g:"freezing",prt:"frozen",pst:"froze"},get:{pst:"got",prt:"gotten"},give:{g:"giving",prt:"_n",pst:"gave"},go:{prt:"_ne",pst:"went",pres:"goes"},grow:{prt:"_n"},guide:{pst:"_d"},hang:{pst:"hung",prt:"hung"},have:{g:"having",pst:"had",prt:"had",pres:"has"},hear:{pst:"_d",prt:"_d"},hide:{prt:"hidden",pst:"hid"},hit:{prt:"_"},hold:{pst:"held",prt:"held"},hurt:{pst:"_",prt:"_"},ice:{g:"icing",pst:"_d"},imply:{pst:"implied",pres:"implies"},is:{a:"",g:"being",pst:"was",pres:"_"},keep:{prt:"kept"},kneel:{prt:"knelt"},know:{prt:"_n"},lay:{pst:"laid",prt:"laid"},lead:{pst:"led",prt:"led"},leap:{prt:"_t"},leave:{pst:"left",prt:"left"},lend:{prt:"lent"},lie:{g:"lying",pst:"lay"},light:{pst:"lit",prt:"lit"},log:{g:"_ging",pst:"_ged"},loose:{prt:"lost"},lose:{g:"losing",pst:"lost"},make:{pst:"made",prt:"made"},mean:{pst:"_t",prt:"_t"},meet:{a:"_er",g:"_ing",pst:"met",prt:"met"},miss:{pres:"_"},name:{g:"naming"},patrol:{g:"_ling",pst:"_led"},pay:{pst:"paid",prt:"paid"},prove:{prt:"_n"},puke:{g:"puking"},put:{prt:"_"},quit:{prt:"_"},read:{pst:"_",prt:"_"},ride:{prt:"ridden"},reside:{pst:"_d"},ring:{pst:"rang",prt:"rung"},rise:{fut:"will have _n",g:"rising",prt:"_n",pst:"rose",pluperf:"had _n"},rub:{g:"_bing",pst:"_bed"},run:{g:"_ning",prt:"_",pst:"ran"},say:{pst:"said",prt:"said",pres:"_s"},seat:{pst:"sat",prt:"sat"},see:{g:"_ing",prt:"_n",pst:"saw"},seek:{prt:"sought"},sell:{pst:"sold",prt:"sold"},send:{prt:"sent"},set:{prt:"_"},sew:{prt:"_n"},shake:{prt:"_n"},shave:{prt:"_d"},shed:{g:"_ding",pst:"_",pres:"_s"},shine:{pst:"shone",prt:"shone"},shoot:{pst:"shot",prt:"shot"},show:{pst:"_ed"},shut:{prt:"_"},sing:{prt:"sung",pst:"sang"},sink:{pst:"sank",pluperf:"had sunk"},sit:{pst:"sat"},ski:{pst:"_ied"},slay:{prt:"slain"},sleep:{prt:"slept"},slide:{pst:"slid",prt:"slid"},smash:{pres:"_es"},sneak:{prt:"snuck"},speak:{fut:"will have spoken",prt:"spoken",pst:"spoke",perf:"have spoken",pluperf:"had spoken"},speed:{prt:"sped"},spend:{prt:"spent"},spill:{prt:"_ed",pst:"spilt"},spin:{g:"_ning",pst:"spun",prt:"spun"},spit:{prt:"spat"},split:{prt:"_"},spread:{pst:"_"},spring:{prt:"sprung"},stand:{pst:"stood"},steal:{a:"_er",pst:"stole"},stick:{pst:"stuck"},sting:{pst:"stung"},stink:{pst:"stunk",prt:"stunk"},stream:{a:"_er"},strew:{prt:"_n"},strike:{g:"striking",pst:"struck"},suit:{a:"_er",g:"_ing",pst:"_ed"},sware:{prt:"sworn"},swear:{pst:"swore"},sweep:{prt:"swept"},swim:{g:"_ming",pst:"swam"},swing:{pst:"swung"},take:{fut:"will have _n",pst:"took",perf:"have _n",pluperf:"had _n"},teach:{pst:"taught",pres:"_es"},tear:{pst:"tore"},tell:{pst:"told"},think:{pst:"thought"},thrive:{prt:"_d"},tie:{g:"tying",pst:"_d"},undergo:{prt:"_ne"},understand:{pst:"understood"},upset:{prt:"_"},wait:{a:"_er",g:"_ing",pst:"_ed"},wake:{pst:"woke"},wear:{pst:"wore"},weave:{prt:"woven"},wed:{pst:"wed"},weep:{prt:"wept"},win:{g:"_ning",pst:"won"},wind:{prt:"wound"},withdraw:{pst:"withdrew"},wring:{prt:"wrung"},write:{g:"writing",prt:"written",pst:"wrote"}},Py=Object.keys(si),iN=function(t){var e=Py[t],n={};Object.keys(si[e]).forEach(function(r){var i=si[e][r];i=i.replace("_",e);var a=nN[r];n[a]=i}),si[e]=n};for(var Jl=0;Jl<Py.length;Jl++)iN(Jl);var aN=si,sN={b:[{reg:/([^aeiou][aeiou])b$/i,repl:{pr:"$1bs",pa:"$1bbed",gr:"$1bbing"}}],d:[{reg:/(end)$/i,repl:{pr:"$1s",pa:"ent",gr:"$1ing",ar:"$1er"}},{reg:/(eed)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing",ar:"$1er"}},{reg:/(ed)$/i,repl:{pr:"$1s",pa:"$1ded",ar:"$1der",gr:"$1ding"}},{reg:/([^aeiou][ou])d$/i,repl:{pr:"$1ds",pa:"$1dded",gr:"$1dding"}}],e:[{reg:/(eave)$/i,repl:{pr:"$1s",pa:"$1d",gr:"eaving",ar:"$1r"}},{reg:/(ide)$/i,repl:{pr:"$1s",pa:"ode",gr:"iding",ar:"ider"}},{reg:/(t|sh?)(ake)$/i,repl:{pr:"$1$2s",pa:"$1ook",gr:"$1aking",ar:"$1$2r"}},{reg:/w(ake)$/i,repl:{pr:"w$1s",pa:"woke",gr:"waking",ar:"w$1r"}},{reg:/m(ake)$/i,repl:{pr:"m$1s",pa:"made",gr:"making",ar:"m$1r"}},{reg:/(a[tg]|i[zn]|ur|nc|gl|is)e$/i,repl:{pr:"$1es",pa:"$1ed",gr:"$1ing"}},{reg:/([bd]l)e$/i,repl:{pr:"$1es",pa:"$1ed",gr:"$1ing"}},{reg:/(om)e$/i,repl:{pr:"$1es",pa:"ame",gr:"$1ing"}}],g:[{reg:/([^aeiou][ou])g$/i,repl:{pr:"$1gs",pa:"$1gged",gr:"$1gging"}}],h:[{reg:/(..)([cs]h)$/i,repl:{pr:"$1$2es",pa:"$1$2ed",gr:"$1$2ing"}}],k:[{reg:/(ink)$/i,repl:{pr:"$1s",pa:"unk",gr:"$1ing",ar:"$1er"}}],m:[{reg:/([^aeiou][aeiou])m$/i,repl:{pr:"$1ms",pa:"$1mmed",gr:"$1mming"}}],n:[{reg:/(en)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}}],p:[{reg:/(e)(ep)$/i,repl:{pr:"$1$2s",pa:"$1pt",gr:"$1$2ing",ar:"$1$2er"}},{reg:/([^aeiou][aeiou])p$/i,repl:{pr:"$1ps",pa:"$1pped",gr:"$1pping"}},{reg:/([aeiu])p$/i,repl:{pr:"$1ps",pa:"$1p",gr:"$1pping"}}],r:[{reg:/([td]er)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}},{reg:/(er)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}}],s:[{reg:/(ish|tch|ess)$/i,repl:{pr:"$1es",pa:"$1ed",gr:"$1ing"}}],t:[{reg:/(ion|end|e[nc]t)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}},{reg:/(.eat)$/i,repl:{pr:"$1s",pa:"$1ed",gr:"$1ing"}},{reg:/([aeiu])t$/i,repl:{pr:"$1ts",pa:"$1t",gr:"$1tting"}},{reg:/([^aeiou][aeiou])t$/i,repl:{pr:"$1ts",pa:"$1tted",gr:"$1tting"}}],w:[{reg:/(.llow)$/i,repl:{pr:"$1s",pa:"$1ed"}},{reg:/(..)(ow)$/i,repl:{pr:"$1$2s",pa:"$1ew",gr:"$1$2ing",prt:"$1$2n"}}],y:[{reg:/(i|f|rr)y$/i,repl:{pr:"$1ies",pa:"$1ied",gr:"$1ying"}}],z:[{reg:/([aeiou]zz)$/i,repl:{pr:"$1es",pa:"$1ed",gr:"$1ing"}}]},ia=sN,oN={pr:"PresentTense",pa:"PastTense",gr:"Gerund",prt:"Participle",ar:"Actor"},lN=function(t,e){for(var n={},r=Object.keys(e.repl),i=0;i<r.length;i+=1){var a=r[i];n[oN[a]]=t.replace(e.reg,e.repl[a])}return n},uN=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=t[t.length-1];if(ia.hasOwnProperty(e)===!0)for(var n=0;n<ia[e].length;n+=1){var r=ia[e][n].reg;if(r.test(t)===!0)return lN(t,ia[e][n])}return{}},cN=uN,Ly=/[bcdfghjklmnpqrstvwxz]y$/,fN={Gerund:function(t){return t.charAt(t.length-1)==="e"?t.replace(/e$/,"ing"):t+"ing"},PresentTense:function(t){return t.charAt(t.length-1)==="s"?t+"es":Ly.test(t)===!0?t.slice(0,-1)+"ies":t+"s"},PastTense:function(t){return t.charAt(t.length-1)==="e"?t+"d":t.substr(-2)==="ed"?t:Ly.test(t)===!0?t.slice(0,-1)+"ied":t+"ed"}},Yl=fN,pN=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n={};return e&&e.irregulars&&e.irregulars.verbs.hasOwnProperty(t)===!0&&(n=Object.assign({},e.irregulars.verbs[t])),n=Object.assign({},cN(t),n),n.Gerund===void 0&&(n.Gerund=Yl.Gerund(t)),n.PastTense===void 0&&(n.PastTense=Yl.PastTense(t)),n.PresentTense===void 0&&(n.PresentTense=Yl.PresentTense(t)),n},dN=pN,Ry=[/ght$/,/nge$/,/ough$/,/ain$/,/uel$/,/[au]ll$/,/ow$/,/oud$/,/...p$/],ky=[/ary$/],Fy={nice:"nicest",late:"latest",hard:"hardest",inner:"innermost",outer:"outermost",far:"furthest",worse:"worst",bad:"worst",good:"best",big:"biggest",large:"largest"},aa=[{reg:/y$/i,repl:"iest"},{reg:/([aeiou])t$/i,repl:"$1ttest"},{reg:/([aeou])de$/i,repl:"$1dest"},{reg:/nge$/i,repl:"ngest"},{reg:/([aeiou])te$/i,repl:"$1test"}],mN=function(t){if(Fy.hasOwnProperty(t))return Fy[t];for(var e=0;e<aa.length;e++)if(aa[e].reg.test(t))return t.replace(aa[e].reg,aa[e].repl);for(var n=0;n<ky.length;n++)if(ky[n].test(t)===!0)return null;for(var r=0;r<Ry.length;r++)if(Ry[r].test(t)===!0)return t.charAt(t.length-1)==="e"?t+"st":t+"est";return t+"est"},hN=mN,By=[/ght$/,/nge$/,/ough$/,/ain$/,/uel$/,/[au]ll$/,/ow$/,/old$/,/oud$/,/e[ae]p$/],zy=[/ary$/,/ous$/],qy={grey:"greyer",gray:"grayer",green:"greener",yellow:"yellower",red:"redder",good:"better",well:"better",bad:"worse",sad:"sadder",big:"bigger"},sa=[{reg:/y$/i,repl:"ier"},{reg:/([aeiou])t$/i,repl:"$1tter"},{reg:/([aeou])de$/i,repl:"$1der"},{reg:/nge$/i,repl:"nger"}],vN=function(t){if(qy.hasOwnProperty(t))return qy[t];for(var e=0;e<sa.length;e++)if(sa[e].reg.test(t)===!0)return t.replace(sa[e].reg,sa[e].repl);for(var n=0;n<zy.length;n++)if(zy[n].test(t)===!0)return null;for(var r=0;r<By.length;r++)if(By[r].test(t)===!0)return t+"er";return/e$/.test(t)===!0?t+"r":t+"er"},yN=vN,jy={toSuperlative:hN,toComparative:yN},gN=function(t){var e={},n=jy.toSuperlative(t);n&&(e.Superlative=n);var r=jy.toComparative(t);return r&&(e.Comparative=r),e},bN=gN,xN={a:[[/(antenn|formul|nebul|vertebr|vit)a$/i,"$1ae"],[/([ti])a$/i,"$1a"]],e:[[/(kn|l|w)ife$/i,"$1ives"],[/(hive)$/i,"$1s"],[/([m|l])ouse$/i,"$1ice"],[/([m|l])ice$/i,"$1ice"]],f:[[/^(dwar|handkerchie|hoo|scar|whar)f$/i,"$1ves"],[/^((?:ca|e|ha|(?:our|them|your)?se|she|wo)l|lea|loa|shea|thie)f$/i,"$1ves"]],i:[[/(octop|vir)i$/i,"$1i"]],m:[[/([ti])um$/i,"$1a"]],n:[[/^(oxen)$/i,"$1"]],o:[[/(al|ad|at|er|et|ed|ad)o$/i,"$1oes"]],s:[[/(ax|test)is$/i,"$1es"],[/(alias|status)$/i,"$1es"],[/sis$/i,"ses"],[/(bu)s$/i,"$1ses"],[/(sis)$/i,"ses"],[/^(?!talis|.*hu)(.*)man$/i,"$1men"],[/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,"$1i"]],x:[[/(matr|vert|ind|cort)(ix|ex)$/i,"$1ices"],[/^(ox)$/i,"$1en"]],y:[[/([^aeiouy]|qu)y$/i,"$1ies"]],z:[[/(quiz)$/i,"$1zes"]]},oa=xN,CN=/(x|ch|sh|s|z)$/,NN=function(t){var e=t[t.length-1];if(oa.hasOwnProperty(e)===!0)for(var n=0;n<oa[e].length;n+=1){var r=oa[e][n][0];if(r.test(t)===!0)return t.replace(r,oa[e][n][1])}return null},wN=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=e.irregulars.nouns;if(n.hasOwnProperty(t))return n[t];var r=NN(t);return r!==null?r:CN.test(t)?t+"es":t+"s"},TN=wN,la=[[/([^v])ies$/i,"$1y"],[/ises$/i,"isis"],[/(kn|[^o]l|w)ives$/i,"$1ife"],[/^((?:ca|e|ha|(?:our|them|your)?se|she|wo)l|lea|loa|shea|thie)ves$/i,"$1f"],[/^(dwar|handkerchie|hoo|scar|whar)ves$/i,"$1f"],[/(antenn|formul|nebul|vertebr|vit)ae$/i,"$1a"],[/(octop|vir|radi|nucle|fung|cact|stimul)(i)$/i,"$1us"],[/(buffal|tomat|tornad)(oes)$/i,"$1o"],[/(eas)es$/i,"$1e"],[/(..[aeiou]s)es$/i,"$1"],[/(vert|ind|cort)(ices)$/i,"$1ex"],[/(matr|append)(ices)$/i,"$1ix"],[/(x|ch|ss|sh|z|o)es$/i,"$1"],[/men$/i,"man"],[/(n)ews$/i,"$1ews"],[/([ti])a$/i,"$1um"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/(s)eries$/i,"$1eries"],[/(m)ovies$/i,"$1ovie"],[/([m|l])ice$/i,"$1ouse"],[/(cris|ax|test)es$/i,"$1is"],[/(alias|status)es$/i,"$1"],[/(ss)$/i,"$1"],[/(ics)$/i,"$1"],[/s$/i,""]],_N=function(t){return Object.keys(t).reduce(function(e,n){return e[t[n]]=n,e},{})},AN=function(t,e){var n=e.irregulars.nouns,r=_N(n);if(r.hasOwnProperty(t))return r[t];for(var i=0;i<la.length;i++)if(la[i][0].test(t)===!0)return t=t.replace(la[i][0],la[i][1]),t;return t},$N=AN,SN={Participle:[{reg:/own$/i,to:"ow"},{reg:/(.)un([g|k])$/i,to:"$1in$2"}],Actor:[{reg:/(er)er$/i,to:"$1"}],PresentTense:[{reg:/(..)(ies)$/i,to:"$1y"},{reg:/(tch|sh)es$/i,to:"$1"},{reg:/(ss|zz)es$/i,to:"$1"},{reg:/([tzlshicgrvdnkmu])es$/i,to:"$1e"},{reg:/(n[dtk]|c[kt]|[eo]n|i[nl]|er|a[ytrl])s$/i,to:"$1"},{reg:/(ow)s$/i,to:"$1"},{reg:/(op)s$/i,to:"$1"},{reg:/([eirs])ts$/i,to:"$1t"},{reg:/(ll)s$/i,to:"$1"},{reg:/(el)s$/i,to:"$1"},{reg:/(ip)es$/i,to:"$1e"},{reg:/ss$/i,to:"ss"},{reg:/s$/i,to:""}],Gerund:[{reg:/(..)(p|d|t|g){2}ing$/i,to:"$1$2"},{reg:/(ll|ss|zz)ing$/i,to:"$1"},{reg:/([^aeiou])ying$/i,to:"$1y"},{reg:/([^ae]i.)ing$/i,to:"$1e"},{reg:/(ea[dklnrtv])ing$/i,to:"$1"},{reg:/(ch|sh)ing$/i,to:"$1"},{reg:/(z)ing$/i,to:"$1e"},{reg:/(a[gdkvtc])ing$/i,to:"$1e"},{reg:/(u[rtcbn])ing$/i,to:"$1e"},{reg:/([^o]o[bdknprv])ing$/i,to:"$1e"},{reg:/([tbckg]l)ing$/i,to:"$1e"},{reg:/(c|s)ing$/i,to:"$1e"},{reg:/(..)ing$/i,to:"$1"}],PastTense:[{reg:/(ued)$/i,to:"ue"},{reg:/a([^aeiouy])ed$/i,to:"a$1e"},{reg:/([aeiou]zz)ed$/i,to:"$1"},{reg:/(e|i)lled$/i,to:"$1ll"},{reg:/(.)(sh|ch)ed$/i,to:"$1$2"},{reg:/(tl|gl)ed$/i,to:"$1e"},{reg:/(um?pt?)ed$/i,to:"$1"},{reg:/(ss)ed$/i,to:"$1"},{reg:/pped$/i,to:"p"},{reg:/tted$/i,to:"t"},{reg:/(..)gged$/i,to:"$1g"},{reg:/(..)lked$/i,to:"$1lk"},{reg:/([^aeiouy][aeiou])ked$/i,to:"$1ke"},{reg:/(.[aeiou])led$/i,to:"$1l"},{reg:/(..)(h|ion|n[dt]|ai.|[cs]t|pp|all|ss|tt|int|ail|ld|en|oo.|er|k|pp|w|ou.|rt|ght|rm)ed$/i,to:"$1$2"},{reg:/(.ut)ed$/i,to:"$1e"},{reg:/(.pt)ed$/i,to:"$1"},{reg:/(us)ed$/i,to:"$1e"},{reg:/(dd)ed$/i,to:"$1"},{reg:/(..[^aeiouy])ed$/i,to:"$1e"},{reg:/(..)ied$/i,to:"$1y"},{reg:/(.o)ed$/i,to:"$1o"},{reg:/(..i)ed$/i,to:"$1"},{reg:/(.a[^aeiou])ed$/i,to:"$1"},{reg:/([aeiou][^aeiou])ed$/i,to:"$1e"},{reg:/([rl])ew$/i,to:"$1ow"},{reg:/([pl])t$/i,to:"$1t"}]},Ql=SN,ua={Gerund:["ing"],Actor:["erer"],Infinitive:["ate","ize","tion","rify","then","ress","ify","age","nce","ect","ise","ine","ish","ace","ash","ure","tch","end","ack","and","ute","ade","ock","ite","ase","ose","use","ive","int","nge","lay","est","ain","ant","ent","eed","er","le","own","unk","ung","en"],PastTense:["ed","lt","nt","pt","ew","ld"],PresentTense:["rks","cks","nks","ngs","mps","tes","zes","ers","les","acks","ends","ands","ocks","lays","eads","lls","els","ils","ows","nds","ays","ams","ars","ops","ffs","als","urs","lds","ews","ips","es","ts","ns"]};ua=Object.keys(ua).reduce(function(l,t){return ua[t].forEach(function(e){return l[e]=t}),l},{});var ca=ua,DN=function(t){var e=t.substr(t.length-3);if(ca.hasOwnProperty(e)===!0)return ca[e];var n=t.substr(t.length-2);if(ca.hasOwnProperty(n)===!0)return ca[n];var r=t.substr(t.length-1);return r==="s"?"PresentTense":null},VN=function(t,e,n){if(!t)return"";if(e.words.hasOwnProperty(t)===!0){for(var r=e.irregulars.verbs,i=Object.keys(r),a=0;a<i.length;a++)for(var s=Object.keys(r[i[a]]),o=0;o<s.length;o++)if(t===r[i[a]][s[o]])return i[a]}if(n=n||DN(t),n&&Ql[n])for(var u=0;u<Ql[n].length;u++){var c=Ql[n][u];if(c.reg.test(t)===!0)return t.replace(c.reg,c.to)}return t},IN=VN,MN={nouns:rN,verbs:aN},ON={conjugate:dN,adjectives:bN,toPlural:TN,toSingular:$N,toInfinitive:IN},Uy=!1,eu=function(){function l(){St(this,l),Object.defineProperty(this,"words",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(this,"hasCompound",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(this,"irregulars",{enumerable:!1,value:MN,writable:!0}),Object.defineProperty(this,"tags",{enumerable:!1,value:Object.assign({},qC),writable:!0}),Object.defineProperty(this,"transforms",{enumerable:!1,value:ON,writable:!0}),Object.defineProperty(this,"taggers",{enumerable:!1,value:[],writable:!0}),Object.defineProperty(this,"cache",{enumerable:!1,value:{abbreviations:{}}}),this.words=Ey.buildOut(this),tN(this)}return Zt(l,[{key:"verbose",value:function(e){return Uy=e,this}},{key:"isVerbose",value:function(){return Uy}},{key:"addWords",value:function(e){var n={};Object.keys(e).forEach(function(r){var i=e[r];r=r.toLowerCase().trim(),n[r]=i}),Ey.addWords(n,this.words,this)}},{key:"addConjugations",value:function(e){return Object.assign(this.irregulars.verbs,e),this}},{key:"addPlurals",value:function(e){return Object.assign(this.irregulars.nouns,e),this}},{key:"addTags",value:function(e){return e=Object.assign({},e),this.tags=Object.assign(this.tags,e),this.tags=Dy(this.tags),this}},{key:"postProcess",value:function(e){return this.taggers.push(e),this}},{key:"stats",value:function(){return{words:Object.keys(this.words).length,plurals:Object.keys(this.irregulars.nouns).length,conjugations:Object.keys(this.irregulars.verbs).length,compounds:Object.keys(this.hasCompound).length,postProcessors:this.taggers.length}}}]),l}(),Hy=function(t){return JSON.parse(JSON.stringify(t))};eu.prototype.clone=function(){var l=new eu;return l.words=Object.assign({},this.words),l.hasCompound=Object.assign({},this.hasCompound),l.irregulars=Hy(this.irregulars),l.tags=Hy(this.tags),l.transforms=this.transforms,l.taggers=this.taggers,l};var EN=eu,PN=Ft(function(l,t){t.all=function(){return this.parents()[0]||this},t.parent=function(){return this.from?this.from:this},t.parents=function(e){var n=[],r=function i(a){a.from&&(n.push(a.from),i(a.from))};return r(this),n=n.reverse(),typeof e=="number"?n[e]:n},t.clone=function(e){var n=this.list.map(function(i){return i.clone(e)}),r=this.buildFrom(n);return r},t.wordCount=function(){return this.list.reduce(function(e,n){return e+=n.wordCount(),e},0)},t.wordcount=t.wordCount}),LN=Ft(function(l,t){t.first=function(r){return r===void 0?this.get(0):this.slice(0,r)},t.last=function(r){if(r===void 0)return this.get(this.list.length-1);var i=this.list.length;return this.slice(i-r,i)},t.slice=function(r,i){var a=this.list.slice(r,i);return this.buildFrom(a)},t.eq=function(r){var i=this.list[r];return i===void 0?this.buildFrom([]):this.buildFrom([i])},t.get=t.eq,t.firstTerms=function(){return this.match("^.")},t.firstTerm=t.firstTerms,t.lastTerms=function(){return this.match(".$")},t.lastTerm=t.lastTerms,t.termList=function(r){for(var i=[],a=0;a<this.list.length;a++)for(var s=this.list[a].terms(),o=0;o<s.length;o++)if(i.push(s[o]),r!==void 0&&i[r]!==void 0)return i[r];return i};var e=function(i){for(var a={},s={},o=function(m){for(var v=i.list[m],h=Object.keys(v.groups).map(function(C){return v.groups[C]}),y=0;y<h.length;y++){var g=h[y],b=g.group,x=g.start,N=g.length;s[b]||(s[b]=[]),s[b].push(v.buildFrom(x,N))}},u=0;u<i.list.length;u++)o(u);for(var c=Object.keys(s),f=0;f<c.length;f++){var p=c[f];a[p]=i.buildFrom(s[p])}return a},n=function(i,a){for(var s=[],o=function(f){var p=i.list[f],d=Object.keys(p.groups);d=d.filter(function(m){return p.groups[m].group===a}),d.forEach(function(m){s.push(p.buildFrom(p.groups[m].start,p.groups[m].length))})},u=0;u<i.list.length;u++)o(u);return i.buildFrom(s)};t.groups=function(r){return r===void 0?e(this):(typeof r=="number"&&(r=String(r)),n(this,r)||this.buildFrom([]))},t.group=t.groups,t.sentences=function(r){var i=[];return this.list.forEach(function(a){i.push(a.fullSentence())}),typeof r=="number"?this.buildFrom([i[r]]):this.buildFrom(i)},t.sentence=t.sentences}),RN=function(t){var e=[],n=[];return t.forEach(function(r){r.optional===!0||r.negative===!0||(r.tag!==void 0&&e.push(r.tag),r.word!==void 0&&n.push(r.word))}),{tags:e,words:n}},kN=function(t,e){if(t._cache&&t._cache.set===!0){for(var n=RN(e),r=n.words,i=n.tags,a=0;a<r.length;a++)if(t._cache.words[r[a]]===void 0)return!1;for(var s=0;s<i.length;s++)if(t._cache.tags[i[s]]===void 0)return!1}return!0},oi=kN,FN=Ft(function(l,t){t.match=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(typeof n=="string"||typeof n=="number"||n===null)&&(n={group:n});var r=Tt(e,n);if(r.length===0)return this.buildFrom([]);if(oi(this,r)===!1)return this.buildFrom([]);var i=this.list.reduce(function(a,s){return a.concat(s.match(r))},[]);return n.group!==void 0&&n.group!==null&&n.group!==""?this.buildFrom(i).groups(n.group):this.buildFrom(i)},t.not=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tt(e,n);if(r.length===0||oi(this,r)===!1)return this;var i=this.list.reduce(function(a,s){return a.concat(s.not(r))},[]);return this.buildFrom(i)},t.matchOne=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tt(e,n);if(oi(this,r)===!1)return this.buildFrom([]);for(var i=0;i<this.list.length;i++){var a=this.list[i].match(r,!0);return this.buildFrom(a)}return this.buildFrom([])},t.if=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tt(e,n);if(oi(this,r)===!1)return this.buildFrom([]);var i=this.list.filter(function(a){return a.has(r)===!0});return this.buildFrom(i)},t.ifNo=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tt(e,n),i=this.list.filter(function(a){return a.has(r)===!1});return this.buildFrom(i)},t.has=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tt(e,n);return oi(this,r)===!1?!1:this.list.some(function(i){return i.has(r)===!0})},t.lookAhead=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e||(e=".*");var r=Tt(e,n),i=[];return this.list.forEach(function(a){i=i.concat(a.lookAhead(r))}),i=i.filter(function(a){return a}),this.buildFrom(i)},t.lookAfter=t.lookAhead,t.lookBehind=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e||(e=".*");var r=Tt(e,n),i=[];return this.list.forEach(function(a){i=i.concat(a.lookBehind(r))}),i=i.filter(function(a){return a}),this.buildFrom(i)},t.lookBefore=t.lookBehind,t.before=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tt(e,n),i=this.if(r).list,a=i.map(function(s){var o=s.terms().map(function(f){return f.id}),u=s.match(r)[0],c=o.indexOf(u.start);return c===0||c===-1?null:s.buildFrom(s.start,c)});return a=a.filter(function(s){return s!==null}),this.buildFrom(a)},t.after=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tt(e,n),i=this.if(r).list,a=i.map(function(s){var o=s.terms(),u=o.map(function(m){return m.id}),c=s.match(r)[0],f=u.indexOf(c.start);if(f===-1||!o[f+c.length])return null;var p=o[f+c.length].id,d=s.length-f-c.length;return s.buildFrom(p,d)});return a=a.filter(function(s){return s!==null}),this.buildFrom(a)},t.hasAfter=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.filter(function(r){return r.lookAfter(e,n).found})},t.hasBefore=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.filter(function(r){return r.lookBefore(e,n).found})}}),BN=function(t,e,n,r){var i=[];typeof t=="string"&&(i=t.split(" ")),e.list.forEach(function(a){var s=a.terms();n===!0&&(s=s.filter(function(o){return o.canBe(t,e.world)})),s.forEach(function(o,u){i.length>1?i[u]&&i[u]!=="."&&o.tag(i[u],r,e.world):o.tag(t,r,e.world)})})},Ky=BN,zN=function(t,e){return t?(Ky(t,this,!1,e),this):this},qN=function(t,e){return t?(Ky(t,this,!0,e),this):this},jN=function(t,e){var n=this;return this.list.forEach(function(r){r.terms().forEach(function(i){return i.unTag(t,e,n.world)})}),this},UN=function(t){if(!t)return this;var e=this.world,n=this.list.reduce(function(r,i){return r.concat(i.canBe(t,e))},[]);return this.buildFrom(n)},HN={tag:zN,tagSafe:qN,unTag:jN,canBe:UN},KN=function(t){var e=this;if(!t)return this;var n=this.list.map(function(r,i){var a=e.buildFrom([r]);a.from=null;var s=t(a,i);return s&&s.list&&s.list[0]?s.list[0]:s});return n=n.filter(function(r){return r}),n.length===0?this.buildFrom(n):Er(n[0])!=="object"||n[0].isA!=="Phrase"?n:this.buildFrom(n)},WN=function(t,e){var n=this;return t?(this.list.forEach(function(r,i){var a=n.buildFrom([r]);e===!0&&(a.from=null),t(a,i)}),this):this},GN=function(t){var e=this;if(!t)return this;var n=this.list.filter(function(r,i){var a=e.buildFrom([r]);return a.from=null,t(a,i)});return this.buildFrom(n)},ZN=function(t){var e=this;if(!t)return this;var n=this.list.find(function(r,i){var a=e.buildFrom([r]);return a.from=null,t(a,i)});if(n)return this.buildFrom([n])},XN=function(t){var e=this;return t?this.list.some(function(n,r){var i=e.buildFrom([n]);return i.from=null,t(i,r)}):this},JN=function(t){if(!this.found)return this;var e=Math.floor(Math.random()*this.list.length);if(t===void 0){var n=[this.list[e]];return this.buildFrom(n)}return e+t>this.length&&(e=this.length-t,e=e<0?0:e),this.slice(e,e+t)},YN={map:KN,forEach:WN,filter:GN,find:ZN,some:XN,random:JN},QN=function(t){return t.split(/[ -]/g)},ew=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n={};return t.forEach(function(r,i){var a=!0;e[i]!==void 0&&(a=e[i]),r=(r||"").toLowerCase(),r=r.replace(/[,;.!?]+$/,"");var s=QN(r).map(function(o){return o.trim()});n[s[0]]=n[s[0]]||{},s.length===1?n[s[0]].value=a:(n[s[0]].more=n[s[0]].more||[],n[s[0]].more.push({rest:s.slice(1),value:a}))}),n},tw=function(t,e,n){for(var r=ew(t,e),i=[],a=function(u){for(var c=n.list[u],f=c.terms(),p=f.map(function(v){return v.reduced}),d=function(h){r[p[h]]!==void 0&&(r[p[h]].more!==void 0&&r[p[h]].more.forEach(function(y){if(p[h+y.rest.length]!==void 0){var g=y.rest.every(function(b,x){return b===p[h+x+1]});g===!0&&i.push({id:c.terms()[h].id,value:y.value,length:y.rest.length+1})}}),r[p[h]].value!==void 0&&i.push({id:c.terms()[h].id,value:r[p[h]].value,length:1}))},m=0;m<p.length;m++)d(m)},s=0;s<n.list.length;s++)a(s);return i},rw=tw,nw=Ft(function(l,t){var e=function(r){return r&&Object.prototype.toString.call(r)==="[object Object]"};t.lookup=function(n){var r=this,i=[],a=e(n);a===!0&&(n=Object.keys(n).map(function(c){return i.push(n[c]),c})),typeof n=="string"&&(n=[n]),this._cache.set!==!0&&this.cache();var s=rw(n,i,this),o=this.list[0];if(a===!0){var u={};return s.forEach(function(c){u[c.value]=u[c.value]||[],u[c.value].push(o.buildFrom(c.id,c.length))}),Object.keys(u).forEach(function(c){u[c]=r.buildFrom(u[c])}),u}return s=s.map(function(c){return o.buildFrom(c.id,c.length)}),this.buildFrom(s)},t.lookUp=t.lookup}),iw=function(t){var e=this;t=t||{};var n={},r={};return this._cache.words=n,this._cache.tags=r,this._cache.set=!0,this.list.forEach(function(i,a){i.cache=i.cache||{};var s=i.terms();s.forEach(function(o){n[o.reduced]&&!n.hasOwnProperty(o.reduced)||(n[o.reduced]=n[o.reduced]||[],n[o.reduced].push(a),Object.keys(o.tags).forEach(function(u){r[u]=r[u]||[],r[u].push(a)}),t.root&&(o.setRoot(e.world),n[o.root]=[a]))})}),this},aw=function(){return this._cache={},this.list.forEach(function(t){t.cache={}}),this.parents().forEach(function(t){t._cache={},t.list.forEach(function(e){e.cache={}})}),this},sw={cache:iw,uncache:aw},ow=function(t){return t.charAt(0).toUpperCase()+t.substr(1)},lw=function(t){var e=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t?(n===!0&&(n={keepTags:!0}),n===!1&&(n={keepTags:!1}),n=n||{},this.uncache(),this.list.forEach(function(r){var i=t;typeof t=="function"&&(i=t(r));var a;if(i&&Er(i)==="object"&&i.isA==="Doc")a=i.list,e.pool().merge(i.pool());else if(typeof i=="string"){n.keepCase!==!1&&r.terms(0).isTitleCase()&&(i=ow(i)),a=br(i,e.world,e.pool());var s=e.buildFrom(a);s.tagger(),a=s.list}else return;if(n.keepTags===!0){var o=r.json({terms:{tags:!0}}).terms;a[0].terms().forEach(function(u,c){o[c]&&u.tagSafe(o[c].tags,"keptTag",e.world)})}r.replace(a[0],e)}),this):this.delete()},uw=function(t,e,n){return e===void 0?this.replaceWith(t,n):(this.match(t).replaceWith(e,n),this)},cw={replaceWith:lw,replace:uw},fw=Ft(function(l,t){var e=function(i){return i&&Object.prototype.toString.call(i)==="[object Object]"},n=function(i,a){var s=br(i,a.world)[0],o=a.buildFrom([s]);return o.tagger(),a.list=o.list,a};t.append=function(){var r=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i?this.found?(this.uncache(),this.list.forEach(function(a){var s;e(i)&&i.isA==="Doc"?s=i.list[0].clone():typeof i=="string"&&(s=br(i,r.world,r.pool())[0]);var o=r.buildFrom([s]);o.tagger(),a.append(s,r)}),this):n(i,this):this},t.insertAfter=t.append,t.insertAt=t.append,t.prepend=function(r){var i=this;return r?this.found?(this.uncache(),this.list.forEach(function(a){var s;e(r)&&r.isA==="Doc"?s=r.list[0].clone():typeof r=="string"&&(s=br(r,i.world,i.pool())[0]);var o=i.buildFrom([s]);o.tagger(),a.prepend(s,i)}),this):n(r,this):this},t.insertBefore=t.prepend,t.concat=function(){this.uncache();for(var r=this.list.slice(0),i=0;i<arguments.length;i++){var a=arguments[i];if(typeof a=="string"){var s=br(a,this.world);r=r.concat(s)}else a.isA==="Doc"?r=r.concat(a.list):a.isA==="Phrase"&&r.push(a)}return this.buildFrom(r)},t.delete=function(r){var i=this;this.uncache();var a=this;return r&&(a=this.match(r)),a.list.forEach(function(s){return s.delete(i)}),this},t.remove=t.delete}),pw={clean:!0,reduced:!0,root:!0},dw=function(t){var e=this;t=t||{};var n=!1;this.parents().length===0&&(n=!0),(t==="root"||Er(t)==="object"&&t.root)&&this.list.forEach(function(i){i.terms().forEach(function(a){a.root===null&&a.setRoot(e.world)})});var r=this.list.reduce(function(i,a,s){var o=!n&&s===0,u=!n&&s===e.list.length-1;return i+a.text(t,o,u)},"");return(pw[t]===!0||t.reduced===!0||t.clean===!0||t.root===!0)&&(r=r.trim()),r},mw={text:dw},hw=function(t){var e=0,n=0,r={};return t.termList().forEach(function(i){r[i.id]={index:n,start:e+i.pre.length,length:i.text.length},e+=i.pre.length+i.text.length+i.post.length,n+=1}),r},vw=function(t,e,n){var r=hw(t.all());(n.terms.index||n.index)&&e.forEach(function(i){i.terms.forEach(function(a){a.index=r[a.id].index}),i.index=i.terms[0].index}),(n.terms.offset||n.offset)&&e.forEach(function(i){i.terms.forEach(function(a){a.offset=r[a.id]||{}}),i.offset={index:i.terms[0].offset.index,start:i.terms[0].offset.start-i.text.indexOf(i.terms[0].text),length:i.text.length}})},yw=vw,gw=Ft(function(l,t){var e={text:!0,terms:!0,trim:!0},n=function(i){return i=Object.assign({},e,i),i.unique&&(i.reduced=!0),i.offset&&(i.text=!0,(!i.terms||i.terms===!0)&&(i.terms={}),i.terms.offset=!0),(i.index||i.terms.index)&&(i.terms=i.terms===!0?{}:i.terms,i.terms.id=!0),i};t.json=function(){var r=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof i=="number"&&this.list[i])return this.list[i].json(e);i=n(i),i.root===!0&&this.list.forEach(function(u){u.terms().forEach(function(c){c.root===null&&c.setRoot(r.world)})});var a=this.list.map(function(u){return u.json(i,r.world)});if((i.terms.offset||i.offset||i.terms.index||i.index)&&yw(this,a,i),i.frequency||i.freq||i.count){var s={};this.list.forEach(function(u){var c=u.text("reduced");s[c]=s[c]||0,s[c]+=1}),this.list.forEach(function(u,c){a[c].count=s[u.text("reduced")]})}if(i.unique){var o={};a=a.filter(function(u){return o[u.reduced]===!0?!1:(o[u.reduced]=!0,!0)})}return a},t.data=t.json}),Wy=Ft(function(l){var t="[0m",e=function(c,f){for(c=c.toString();c.length<f;)c+=" ";return c};function n(){return typeof window!="undefined"&&window.document}var r={green:"#7f9c6c",red:"#914045",blue:"#6699cc",magenta:"#6D5685",cyan:"#2D85A8",yellow:"#e6d7b3",black:"#303b50"},i=function(c){var f=c.world.tags;c.list.forEach(function(p){console.log(`
%c"`+p.text()+'"',"color: #e6d7b3;");var d=p.terms();d.forEach(function(m){var v=Object.keys(m.tags),h=m.text||"-";m.implicit&&(h="["+m.implicit+"]");var y="'"+h+"'";y=e(y,8);var g=v.find(function(x){return f[x]&&f[x].color}),b="steelblue";f[g]&&(b=f[g].color,b=r[b]),console.log("   ".concat(y,"  -  %c").concat(v.join(", ")),"color: ".concat(b||"steelblue",";"))})})},a={green:function(c){return"[32m"+c+t},red:function(c){return"[31m"+c+t},blue:function(c){return"[34m"+c+t},magenta:function(c){return"[35m"+c+t},cyan:function(c){return"[36m"+c+t},yellow:function(c){return"[33m"+c+t},black:function(c){return"[30m"+c+t}},s=function(c,f){return c=c.map(function(p){if(!f.tags.hasOwnProperty(p))return p;var d=f.tags[p].color||"blue";return a[d](p)}),c.join(", ")},o=function(c){return n()?(i(c),c):(console.log(a.blue("=====")),c.list.forEach(function(f){console.log(a.blue("  -----"));var p=f.terms();p.forEach(function(d){var m=Object.keys(d.tags),v=d.text||"-";d.implicit&&(v="["+d.implicit+"]"),v=a.yellow(v);var h="'"+v+"'";h=e(h,18);var y=a.blue("  \uFF5C ")+h+"  - "+s(m,c.world);console.log(y)})}),console.log(""),c)};l.exports=o}),bw=function(t){var e=t.json({text:!1,terms:!1,reduced:!0}),n={};e.forEach(function(i){n[i.reduced]||(i.count=0,n[i.reduced]=i),n[i.reduced].count+=1});var r=Object.keys(n).map(function(i){return n[i]});return r.sort(function(i,a){return i.count>a.count?-1:i.count<a.count?1:0}),r},xw=bw,Cw=function(){return Wy(this),this},Nw=function(t){if(t==="text")return this.text();if(t==="normal")return this.text("normal");if(t==="json")return this.json();if(t==="offset"||t==="offsets")return this.json({offset:!0});if(t==="array")return this.json({terms:!1}).map(function(n){return n.text}).filter(function(n){return n});if(t==="freq"||t==="frequency")return xw(this);if(t==="terms"){var e=[];return this.json({text:!1,terms:{text:!0}}).forEach(function(n){var r=n.terms.map(function(i){return i.text});r=r.filter(function(i){return i}),e=e.concat(r)}),e}return t==="tags"?this.list.map(function(n){return n.terms().reduce(function(r,i){return r[i.clean||i.implicit]=Object.keys(i.tags),r},{})}):t==="debug"?(Wy(this),this):this.text()},ww={debug:Cw,out:Nw},li={alpha:function(t,e){var n=t.text("clean"),r=e.text("clean");return n<r?-1:n>r?1:0},length:function(t,e){var n=t.text().trim().length,r=e.text().trim().length;return n<r?1:n>r?-1:0},wordCount:function(t,e){var n=t.wordCount(),r=e.wordCount();return n<r?1:n>r?-1:0}},Tw=function(t){var e={},n={case:!0,punctuation:!1,whitespace:!0,unicode:!0};return t.list.forEach(function(r){var i=r.text(n);e[i]=e[i]||0,e[i]+=1}),t.list.sort(function(r,i){var a=e[r.text(n)],s=e[i.text(n)];return a<s?1:a>s?-1:0}),t},_w=function(t){var e={};return t.json({terms:{offset:!0}}).forEach(function(n){e[n.terms[0].id]=n.terms[0].offset.start}),t.list=t.list.sort(function(n,r){return e[n.start]>e[r.start]?1:e[n.start]<e[r.start]?-1:0}),t};li.alphabetical=li.alpha;li.wordcount=li.wordCount;var Aw={index:!0,sequence:!0,seq:!0,sequential:!0,chron:!0,chronological:!0},$w=function(t){return t=t||"alpha",t==="freq"||t==="frequency"||t==="topk"?Tw(this):Aw.hasOwnProperty(t)?_w(this):(t=li[t]||t,typeof t=="function"?(this.list=this.list.sort(t),this):this)},Sw=function(){var t=[].concat(this.list);return t=t.reverse(),this.buildFrom(t)},Dw=function(){var t=[].concat(this.list),e={};return t=t.filter(function(n){var r=n.text("reduced").trim()||n.text("implicit").trim();return e.hasOwnProperty(r)===!0?!1:(e[r]=!0,!0)}),this.buildFrom(t)},Vw={sort:$w,reverse:Sw,unique:Dw},Gy=/[\[\]{}:,\-;\/*\^%=~|]/g,Zy=/['"]+/g,Iw={whitespace:function(t){var e=t.list.map(function(n){return n.terms()});e.forEach(function(n,r){n.forEach(function(i,a){if(i.hasDash()===!0){i.post=" - ";return}i.pre=i.pre.replace(/\s/g,""),i.post=i.post.replace(/\s/g,""),!(n.length-1===a&&!e[r+1])&&(i.implicit&&Boolean(i.text)===!0||i.hasHyphen()!==!0&&(i.post+=" "))})})},punctuation:function(t){t.forEach(function(e){e.hasHyphen()===!0&&(e.post=" "),e.pre=e.pre.replace(Gy,""),e.post=e.post.replace(Gy,""),e.post=e.post.replace(/\.\.\./,""),/!/.test(e.post)===!0&&(e.post=e.post.replace(/!/g,""),e.post="!"+e.post),/\?/.test(e.post)===!0&&(e.post=e.post.replace(/[\?!]*/,""),e.post="?"+e.post)})},unicode:function(t){t.forEach(function(e){e.isImplicit()!==!0&&(e.text=Bl(e.text))})},quotations:function(t){t.forEach(function(e){e.post=e.post.replace(Zy,""),e.pre=e.pre.replace(Zy,"")})},adverbs:function(t){t.match("#Adverb").not("(not|nary|seldom|never|barely|almost|basically|so)").remove()},abbreviations:function(t){t.list.forEach(function(e){var n=e.terms();n.forEach(function(r,i){r.tags.Abbreviation===!0&&n[i+1]&&(r.post=r.post.replace(/^\./,""))})})}},On=Iw,Mw={whitespace:!0,unicode:!0,punctuation:!0,emoji:!0,acronyms:!0,abbreviations:!0,case:!1,contractions:!1,parentheses:!1,quotations:!1,adverbs:!1,possessives:!1,verbs:!1,nouns:!1,honorifics:!1},tu={light:{},medium:{case:!0,contractions:!0,parentheses:!0,quotations:!0,adverbs:!0}};tu.heavy=Object.assign({},tu.medium,{possessives:!0,verbs:!0,nouns:!0,honorifics:!0});var Ow=function(t){t=t||{},typeof t=="string"&&(t=tu[t]||{}),t=Object.assign({},Mw,t),this.uncache();var e=this.termList();return t.case&&this.toLowerCase(),t.whitespace&&On.whitespace(this),t.unicode&&On.unicode(e),t.punctuation&&On.punctuation(e),t.emoji&&this.remove("(#Emoji|#Emoticon)"),t.acronyms&&this.acronyms().strip(),t.abbreviations&&On.abbreviations(this),(t.contraction||t.contractions)&&this.contractions().expand(),t.parentheses&&this.parentheses().unwrap(),(t.quotations||t.quotes)&&On.quotations(e),t.adverbs&&On.adverbs(this),(t.possessive||t.possessives)&&this.possessives().strip(),t.verbs&&this.verbs().toInfinitive(),(t.nouns||t.plurals)&&this.nouns().toSingular(),t.honorifics&&this.remove("#Honorific"),this},Ew={normalize:Ow},Pw=Ft(function(l,t){t.splitOn=function(e){if(!e){var n=this.parent();return n.splitOn(this)}var r=Tt(e),i=[];return this.list.forEach(function(a){var s=a.match(r);if(s.length===0){i.push(a);return}var o=a;s.forEach(function(u){var c=o.splitOn(u);c.before&&i.push(c.before),c.match&&i.push(c.match),o=c.after}),o&&i.push(o)}),this.buildFrom(i)},t.splitAfter=function(e){if(!e){var n=this.parent();return n.splitAfter(this)}var r=Tt(e),i=[];return this.list.forEach(function(a){var s=a.match(r);if(s.length===0){i.push(a);return}var o=a;s.forEach(function(u){var c=o.splitOn(u);c.before&&c.match?(c.before.length+=c.match.length,i.push(c.before)):c.match&&i.push(c.match),o=c.after}),o&&i.push(o)}),this.buildFrom(i)},t.split=t.splitAfter,t.splitBefore=function(e){if(!e){var n=this.parent();return n.splitBefore(this)}var r=Tt(e),i=[];return this.list.forEach(function(a){var s=a.match(r);if(s.length===0){i.push(a);return}var o=a;s.forEach(function(u){var c=o.splitOn(u);c.before&&i.push(c.before),c.match&&c.after&&(c.match.length+=c.after.length),o=c.match}),o&&i.push(o)}),this.buildFrom(i)},t.segment=function(e,n){e=e||{},n=n||{text:!0};var r=this,i=Object.keys(e);return i.forEach(function(a){r=r.splitOn(a)}),r.list.forEach(function(a){for(var s=0;s<i.length;s+=1)if(a.has(i[s])){a.segment=e[i[s]];return}}),r.list.map(function(a){var s=a.json(n);return s.segment=a.segment||null,s})}}),ru=function(t,e){var n=t.world;return t.list.forEach(function(r){r.terms().forEach(function(i){return i[e](n)})}),t},Lw=function(){return ru(this,"toLowerCase")},Rw=function(){return ru(this,"toUpperCase")},kw=function(){return ru(this,"toTitleCase")},Fw=function(){return this.list.forEach(function(t){var e=t.terms();e.forEach(function(n,r){r!==0&&n.toTitleCase(),r!==e.length-1&&(n.post="")})}),this},Bw={toLowerCase:Lw,toUpperCase:Rw,toTitleCase:kw,toCamelCase:Fw},zw=Ft(function(l,t){t.pre=function(e,n){return e===void 0?this.list[0].terms(0).pre:(this.list.forEach(function(r){var i=r.terms(0);n===!0?i.pre+=e:i.pre=e}),this)},t.post=function(e,n){return e===void 0?this.list.map(function(r){var i=r.terms(),a=i[i.length-1];return a.post}):(this.list.forEach(function(r){var i=r.terms(),a=i[i.length-1];n===!0?a.post+=e:a.post=e}),this)},t.trim=function(){return this.list=this.list.map(function(e){return e.trim()}),this},t.hyphenate=function(){return this.list.forEach(function(e){var n=e.terms();n.forEach(function(r,i){i!==0&&(r.pre=""),n[i+1]&&(r.post="-")})}),this},t.dehyphenate=function(){var e=/(-||)/;return this.list.forEach(function(n){var r=n.terms();r.forEach(function(i){e.test(i.post)&&(i.post=" ")})}),this},t.deHyphenate=t.dehyphenate,t.toQuotations=function(e,n){return e=e||'"',n=n||'"',this.list.forEach(function(r){var i=r.terms();i[0].pre=e+i[0].pre;var a=i[i.length-1];a.post=n+a.post}),this},t.toQuotation=t.toQuotations,t.toParentheses=function(e,n){return e=e||"(",n=n||")",this.list.forEach(function(r){var i=r.terms();i[0].pre=e+i[0].pre;var a=i[i.length-1];a.post=n+a.post}),this}}),qw=function(t){this.uncache();for(var e=this.list[0],n=e.length,r={},i=1;i<this.list.length;i++){var a=this.list[i];r[a.start]=!0;var s=e.lastTerm();t&&(s.post+=t),s.next=a.start,a.terms(0).prev=s.id,e.length+=a.length,e.cache={}}var o=e.length-n;return this.parents().forEach(function(u){u.list.forEach(function(c){for(var f=c.terms(),p=0;p<f.length;p++)if(f[p].id===e.start){c.length+=o;break}c.cache={}}),u.list=u.list.filter(function(c){return r[c.start]!==!0})}),this.buildFrom([e])},jw={join:qw},Uw=/[,\)"';:\-\.]/,xr=function(t,e){if(!!t.found){for(var n=t.termList(),r=0;r<n.length-1;r++){var i=n[r];if(Uw.test(i.post))return}n.forEach(function(o){o.implicit=o.clean}),n[0].text+=e,n.slice(1).forEach(function(o){o.text=""});for(var a=0;a<n.length-1;a++){var s=n[a];s.post=s.post.replace(/ /,"")}}},Hw=function(){var t=this.not("@hasContraction"),e=t.match("(we|they|you) are");return xr(e,"'re"),e=t.match("(he|she|they|it|we|you) will"),xr(e,"'ll"),e=t.match("(he|she|they|it|we) is"),xr(e,"'s"),e=t.match("#Person is"),xr(e,"'s"),e=t.match("#Person would"),xr(e,"'d"),e=t.match("(is|was|had|would|should|could|do|does|have|has|can) not"),xr(e,"n't"),e=t.match("(i|we|they) have"),xr(e,"'ve"),e=t.match("(would|should|could) have"),xr(e,"'ve"),e=t.match("i am"),xr(e,"'m"),e=t.match("going to"),this},Kw={contract:Hw},Ww=Object.assign({},PN,LN,FN,HN,YN,nw,sw,cw,fw,mw,gw,ww,Vw,Ew,Pw,Bw,zw,jw,Kw),bt={},Gw=[["terms","."],["hyphenated","@hasHyphen ."],["adjectives","#Adjective"],["hashTags","#HashTag"],["emails","#Email"],["emoji","#Emoji"],["emoticons","#Emoticon"],["atMentions","#AtMention"],["urls","#Url"],["adverbs","#Adverb"],["pronouns","#Pronoun"],["conjunctions","#Conjunction"],["prepositions","#Preposition"]];Gw.forEach(function(l){bt[l[0]]=function(t){var e=this.match(l[1]);return typeof t=="number"&&(e=e.get(t)),e}});bt.emojis=bt.emoji;bt.atmentions=bt.atMentions;bt.words=bt.terms;bt.phoneNumbers=function(l){var t=this.splitAfter("@hasComma");return t=t.match("#PhoneNumber+"),typeof l=="number"&&(t=t.get(l)),t};bt.money=function(l){var t=this.match("#Money #Currency?");return typeof l=="number"&&(t=t.get(l)),t};bt.places=function(l){var t=this.match("(#City && @hasComma) (#Region|#Country)"),e=this.not(t).splitAfter("@hasComma");return e=e.concat(t),e.sort("index"),e=e.match("#Place+"),typeof l=="number"&&(e=e.get(l)),e};bt.organizations=function(l){var t=this.clauses();return t=t.match("#Organization+"),typeof l=="number"&&(t=t.get(l)),t};bt.entities=function(l){var t=this.clauses(),e=t.people();e=e.concat(t.places()),e=e.concat(t.organizations());var n=["someone","man","woman","mother","brother","sister","father"];return e=e.not(n),e.sort("sequence"),typeof l=="number"&&(e=e.get(l)),e};bt.things=bt.entities;bt.topics=bt.entities;var nu=bt,Xy=/^(under|over)-?/,Zw=function(t,e,n){var r=n.words,i=t[e].reduced+" "+t[e+1].reduced;return r[i]!==void 0&&r.hasOwnProperty(i)===!0?(t[e].tag(r[i],"lexicon-two",n),t[e+1].tag(r[i],"lexicon-two",n),1):e+2<t.length&&(i+=" "+t[e+2].reduced,r[i]!==void 0&&r.hasOwnProperty(i)===!0)?(t[e].tag(r[i],"lexicon-three",n),t[e+1].tag(r[i],"lexicon-three",n),t[e+2].tag(r[i],"lexicon-three",n),2):e+3<t.length&&(i+=" "+t[e+3].reduced,r[i]!==void 0&&r.hasOwnProperty(i)===!0)?(t[e].tag(r[i],"lexicon-four",n),t[e+1].tag(r[i],"lexicon-four",n),t[e+2].tag(r[i],"lexicon-four",n),t[e+3].tag(r[i],"lexicon-four",n),3):0},Xw=function(t,e){for(var n=e.words,r=e.hasCompound,i=0;i<t.length;i+=1){var a=t[i].clean;if(r[a]===!0&&i+1<t.length){var s=Zw(t,i,e);if(s>0){i+=s;continue}}if(n[a]!==void 0&&n.hasOwnProperty(a)===!0){t[i].tag(n[a],"lexicon",e);continue}if(a!==t[i].reduced&&n.hasOwnProperty(t[i].reduced)===!0){t[i].tag(n[t[i].reduced],"lexicon",e);continue}if(Xy.test(a)===!0){var o=a.replace(Xy,"");n.hasOwnProperty(o)===!0&&t[i].tag(n[o],"noprefix-lexicon",e)}}return t},iu=Xw,au=/[\'`]$/,Jw=/^(m|k|cm|km|m)\/(s|h|hr)$/,Yw=function(t,e,n){var r=t[e];if(au.test(r.text)&&!au.test(r.pre)&&!au.test(r.post)&&r.clean.length>2){var i=r.clean[r.clean.length-2];if(i==="s"){r.tag(["Possessive","Noun"],"end-tick",n);return}i==="n"&&r.tag(["Gerund"],"chillin",n)}Jw.test(r.text)&&r.tag("Unit","per-sec",n)},Qw=Yw,su=[[/^[\w\.]+@[\w\.]+\.[a-z]{2,3}$/,"Email"],[/^#[a-z0-9_\u00C0-\u00FF]{2,}$/,"HashTag"],[/^@1?[0-9](am|pm)$/i,"Time"],[/^@1?[0-9]:[0-9]{2}(am|pm)?$/i,"Time"],[/^@\w{2,}$/,"AtMention"],[/^(https?:\/\/|www\.)\w+\.[a-z]{2,3}/,"Url"],[/^[\w./]+\.(com|net|gov|org|ly|edu|info|biz|ru|jp|de|in|uk|br)/,"Url"],[/^'[0-9]{2}$/,"Year"],[/^[012]?[0-9](:[0-5][0-9])(:[0-5][0-9])$/,"Time"],[/^[012]?[0-9](:[0-5][0-9])?(:[0-5][0-9])? ?(am|pm)$/i,"Time"],[/^[012]?[0-9](:[0-5][0-9])(:[0-5][0-9])? ?(am|pm)?$/i,"Time"],[/^[PMCE]ST$/,"Time"],[/^utc ?[+-]?[0-9]+?$/,"Time"],[/^[a-z0-9]*? o\'?clock$/,"Time"],[/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}/i,"Date"],[/^[0-9]{1,4}-[0-9]{1,2}-[0-9]{1,4}$/,"Date"],[/^[0-9]{1,4}\/[0-9]{1,2}\/[0-9]{1,4}$/,"Date"],[/^[0-9]{1,4}-[a-z]{2,9}-[0-9]{1,4}$/i,"Date"],[/^gmt[+-][0-9][0-9]?$/i,"Timezone"],[/^utc[+-][0-9][0-9]?$/i,"Timezone"],[/^ma?c\'.*/,"LastName"],[/^o\'[drlkn].*/,"LastName"],[/^ma?cd[aeiou]/,"LastName"],[/^(lol)+[sz]$/,"Expression"],[/^woo+a*?h?$/,"Expression"],[/^(un|de|re)\\-[a-z\u00C0-\u00FF]{2}/,"Verb"],[/^[0-9]{1,4}\.[0-9]{1,2}\.[0-9]{1,4}$/,"Date"],[/^[0-9]{3}-[0-9]{4}$/,"PhoneNumber"],[/^(\+?[0-9][ -])?[0-9]{3}[ -]?[0-9]{3}-[0-9]{4}$/,"PhoneNumber"],[/^[-+]?[\$\xA2-\xA5\u058F\u060B\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u20A0-\u20BD\uA838\uFDFC\uFE69\uFF04\uFFE0\uFFE1\uFFE5\uFFE6][-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?(k|m|b|bn)?\+?$/,["Money","Value"]],[/^[-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?[\$\xA2-\xA5\u058F\u060B\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u20A0-\u20BD\uA838\uFDFC\uFE69\uFF04\uFFE0\uFFE1\uFFE5\uFFE6]\+?$/,["Money","Value"]],[/^[-+]?[\$]?[0-9]([0-9,.])+?(usd|eur|jpy|gbp|cad|aud|chf|cny|hkd|nzd|kr|rub)$/i,["Money","Value"]],[/^[-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?\+?$/,["Cardinal","NumericValue"]],[/^[-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?(st|nd|rd|r?th)$/,["Ordinal","NumericValue"]],[/^\.[0-9]+\+?$/,["Cardinal","NumericValue"]],[/^[-+]?[0-9]+(,[0-9]{3})*(\.[0-9]+)?%\+?$/,["Percent","Cardinal","NumericValue"]],[/^\.[0-9]+%$/,["Percent","Cardinal","NumericValue"]],[/^[0-9]{1,4}\/[0-9]{1,4}(st|nd|rd|th)?s?$/,["Fraction","NumericValue"]],[/^[0-9.]{1,3}[a-z]{0,2}[-][0-9]{1,3}[a-z]{0,2}$/,["Value","NumberRange"]],[/^[0-9][0-9]?(:[0-9][0-9])?(am|pm)?[-][0-9][0-9]?(:[0-9][0-9])?(am|pm)?$/,["Time","NumberRange"]],[/^[0-9.]+([a-z]{1,4})$/,"Value"]],eT=/^[IVXLCDM]{2,}$/,tT=/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,rT=function(t,e){for(var n=t.text,r=0;r<su.length;r+=1)if(su[r][0].test(n)===!0){t.tagSafe(su[r][1],"prefix #"+r,e);break}t.text.length>=2&&eT.test(n)&&tT.test(n)&&t.tag("RomanNumeral","xvii",e)},nT=rT,it="Adjective",fa="Infinitive",pa="PresentTense",Cr="Singular",Dt="PastTense",Jy="Adverb",Nr="Expression",Yy="Actor",Qy="Verb",eg="Noun",da="LastName",tg={a:[[/.[aeiou]na$/,eg],[/.[oau][wvl]ska$/,da],[/.[^aeiou]ica$/,Cr],[/^([hyj]a)+$/,Nr]],c:[[/.[^aeiou]ic$/,it]],d:[[/[aeiou](pp|ll|ss|ff|gg|tt|rr|bb|nn|mm)ed$/,Dt],[/.[aeo]{2}[bdgmnprvz]ed$/,Dt],[/.[aeiou][sg]hed$/,Dt],[/.[aeiou]red$/,Dt],[/.[aeiou]r?ried$/,Dt],[/.[bcdgtr]led$/,Dt],[/.[aoui]f?led$/,Dt],[/.[iao]sed$/,Dt],[/[aeiou]n?[cs]ed$/,Dt],[/[aeiou][rl]?[mnf]ed$/,Dt],[/[aeiou][ns]?c?ked$/,Dt],[/[aeiou][nl]?ged$/,Dt],[/.[tdbwxz]ed$/,Dt],[/[^aeiou][aeiou][tvx]ed$/,Dt],[/.[cdlmnprstv]ied$/,Dt],[/[^aeiou]ard$/,Cr],[/[aeiou][^aeiou]id$/,it],[/.[vrl]id$/,it]],e:[[/.[lnr]ize$/,fa],[/.[^aeiou]ise$/,fa],[/.[aeiou]te$/,fa],[/.[^aeiou][ai]ble$/,it],[/.[^aeiou]eable$/,it],[/.[ts]ive$/,it]],h:[[/.[^aeiouf]ish$/,it],[/.v[iy]ch$/,da],[/^ug?h+$/,Nr],[/^uh[ -]?oh$/,Nr]],i:[[/.[oau][wvl]ski$/,da]],k:[[/^(k){2}$/,Nr]],l:[[/.[gl]ial$/,it],[/.[^aeiou]ful$/,it],[/.[nrtumcd]al$/,it],[/.[^aeiou][ei]al$/,it]],m:[[/.[^aeiou]ium$/,Cr],[/[^aeiou]ism$/,Cr],[/^h*u*m+$/,Nr],[/^\d+ ?[ap]m$/,"Date"]],n:[[/.[lsrnpb]ian$/,it],[/[^aeiou]ician$/,Yy],[/[aeiou][ktrp]in$/,"Gerund"]],o:[[/^no+$/,Nr],[/^(yo)+$/,Nr],[/^woo+[pt]?$/,Nr]],r:[[/.[bdfklmst]ler$/,"Noun"],[/[aeiou][pns]er$/,Cr],[/[^i]fer$/,fa],[/.[^aeiou][ao]pher$/,Yy],[/.[lk]er$/,"Noun"],[/.ier$/,"Comparative"]],t:[[/.[di]est$/,"Superlative"],[/.[icldtgrv]ent$/,it],[/[aeiou].*ist$/,it],[/^[a-z]et$/,Qy]],s:[[/.[^aeiou]ises$/,pa],[/.[rln]ates$/,pa],[/.[^z]ens$/,Qy],[/.[lstrn]us$/,Cr],[/.[aeiou]sks$/,pa],[/.[aeiou]kes$/,pa],[/[aeiou][^aeiou]is$/,Cr],[/[a-z]\'s$/,eg],[/^yes+$/,Nr]],v:[[/.[^aeiou][ai][kln]ov$/,da]],y:[[/.[cts]hy$/,it],[/.[st]ty$/,it],[/.[gk]y$/,it],[/.[tnl]ary$/,it],[/.[oe]ry$/,Cr],[/[rdntkbhs]ly$/,Jy],[/...lly$/,Jy],[/[bszmp]{2}y$/,it],[/.(gg|bb|zz)ly$/,it],[/.[ai]my$/,it],[/[ea]{2}zy$/,it],[/.[^aeiou]ity$/,Cr]]},_t="Adjective",ui="Infinitive",Zr="PresentTense",En="Singular",Et="PastTense",Xr="Adverb",wr="Plural",rg="Actor",ma="Verb",ha="Noun",Xt="LastName",ng="Modal",iT="Place",ig=[null,null,{ea:En,ia:ha,ic:_t,ly:Xr,"'n":ma,"'t":ma},{oed:Et,ued:Et,xed:Et," so":Xr,"'ll":ng,"'re":"Copula",azy:_t,eer:ha,end:ma,ped:Et,ffy:_t,ify:ui,ing:"Gerund",ize:ui,lar:_t,mum:_t,nes:Zr,nny:_t,oid:_t,ous:_t,que:_t,rol:En,sis:En,zes:Zr},{amed:Et,aped:Et,ched:Et,lked:Et,nded:Et,cted:Et,dged:Et,akis:Xt,cede:ui,chuk:Xt,czyk:Xt,ects:Zr,ends:ma,enko:Xt,ette:En,fies:Zr,fore:Xr,gate:ui,gone:_t,ices:wr,ints:wr,ines:wr,ions:wr,less:Xr,llen:_t,made:_t,nsen:Xt,oses:Zr,ould:ng,some:_t,sson:Xt,tage:ui,teen:"Value",tion:En,tive:_t,tors:ha,vice:En},{tized:Et,urned:Et,eased:Et,ances:wr,bound:_t,ettes:wr,fully:Xr,ishes:Zr,ities:wr,marek:Xt,nssen:Xt,ology:ha,ports:wr,rough:_t,tches:Zr,tieth:"Ordinal",tures:wr,wards:Xr,where:Xr},{auskas:Xt,keeper:rg,logist:rg,teenth:"Value"},{opoulos:Xt,borough:iT,sdottir:Xt}],aT=function(t,e){var n=t.clean,r=n[n.length-1];if(tg.hasOwnProperty(r)===!0){for(var i=tg[r],a=0;a<i.length;a+=1)if(i[a][0].test(n)===!0){t.tagSafe(i[a][1],"endReg ".concat(r," #").concat(a),e);break}}},sT=function(t,e){var n=t.clean.length,r=7;n<=r&&(r=n-1);for(var i=r;i>1;i-=1){var a=t.clean.substr(n-i,n);if(ig[a.length].hasOwnProperty(a)===!0){var s=ig[a.length][a];t.tagSafe(s,"suffix -"+a,e);break}}},oT=function(t,e){sT(t,e),aT(t,e)},lT=oT,uT={":(":!0,":)":!0,":P":!0,":p":!0,":O":!0,":3":!0,":|":!0,":/":!0,":\\":!0,":$":!0,":*":!0,":@":!0,":-(":!0,":-)":!0,":-P":!0,":-p":!0,":-O":!0,":-3":!0,":-|":!0,":-/":!0,":-\\":!0,":-$":!0,":-*":!0,":-@":!0,":^(":!0,":^)":!0,":^P":!0,":^p":!0,":^O":!0,":^3":!0,":^|":!0,":^/":!0,":^\\":!0,":^$":!0,":^*":!0,":^@":!0,"):":!0,"(:":!0,"$:":!0,"*:":!0,")-:":!0,"(-:":!0,"$-:":!0,"*-:":!0,")^:":!0,"(^:":!0,"$^:":!0,"*^:":!0,"<3":!0,"</3":!0,"<\\3":!0},cT=/^(\u00a9|\u00ae|[\u2319-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/,fT=function(t){return t.charAt(0)===":"?!(t.match(/:.?$/)===null||t.match(" ")||t.length>35):!1},pT=function(t){return t=t.replace(/^[:;]/,":"),uT.hasOwnProperty(t)},dT=function(t,e){var n=t.pre+t.text+t.post;n=n.trim(),n=n.replace(/[.!?,]$/,""),fT(n)===!0&&(t.tag("Emoji","comma-emoji",e),t.text=n,t.pre=t.pre.replace(":",""),t.post=t.post.replace(":","")),t.text.match(cT)&&(t.tag("Emoji","unicode-emoji",e),t.text=n),pT(n)===!0&&(t.tag("Emoticon","emoticon-emoji",e),t.text=n)},mT=dT,ci={lexicon:iu,punctuation:Qw,regex:nT,suffix:lT,emoji:mT},hT=function(t,e){var n=t.world;ci.lexicon(e,n);for(var r=0;r<e.length;r+=1){var i=e[r];ci.punctuation(e,r,n),ci.regex(i,n),ci.suffix(i,n),ci.emoji(i,n)}return t},vT=hT,yT={i:"Verb",first:"Noun",it:"Verb",there:"Verb",not:"Verb",because:"Noun",if:"Noun",but:"Noun",who:"Verb",this:"Noun",his:"Noun",when:"Noun",you:"Verb",very:"Adjective",old:"Noun",never:"Verb",before:"Noun"},gT={there:"Verb",me:"Verb",man:"Adjective",only:"Verb",him:"Verb",were:"Noun",took:"Noun",himself:"Verb",went:"Noun",who:"Noun",jr:"Person"},bT={Adjective:"Noun",Possessive:"Noun",Determiner:"Noun",Adverb:"Verb",Pronoun:"Verb",Value:"Noun",Ordinal:"Noun",Modal:"Verb",Superlative:"Noun",Demonym:"Noun",Honorific:"Person"},xT={Copula:"Noun",PastTense:"Noun",Conjunction:"Noun",Modal:"Noun",Pluperfect:"Noun",PerfectTense:"Verb"},Pr={beforeThisWord:gT,afterThisWord:yT,beforeThisPos:xT,afterThisPos:bT},CT=Object.keys(Pr.afterThisPos),NT=Object.keys(Pr.beforeThisPos),wT=function(t,e){for(var n=function(s){var o=t[s];if(o.isKnown()===!0)return"continue";var u=t[s-1];if(u){if(Pr.afterThisWord.hasOwnProperty(u.clean)===!0){var c=Pr.afterThisWord[u.clean];return o.tag(c,"after-"+u.clean,e),"continue"}var f=CT.find(function(y){return u.tags[y]});if(f!==void 0){var p=Pr.afterThisPos[f];return o.tag(p,"after-"+f,e),"continue"}}var d=t[s+1];if(d){if(Pr.beforeThisWord.hasOwnProperty(d.clean)===!0){var m=Pr.beforeThisWord[d.clean];return o.tag(m,"before-"+d.clean,e),"continue"}var v=NT.find(function(y){return d.tags[y]});if(v!==void 0){var h=Pr.beforeThisPos[v];return o.tag(h,"before-"+v,e),"continue"}}},r=0;r<t.length;r+=1)var i=n(r)},TT=wT,_T=/^[A-Z][a-z'\u00C0-\u00FF]/,AT=/[0-9]/,$T=function(t){var e=t.world;t.list.forEach(function(n){for(var r=n.terms(),i=1;i<r.length;i++){var a=r[i];_T.test(a.text)===!0&&AT.test(a.text)===!1&&a.tags.Date===void 0&&a.tag("ProperNoun","titlecase-noun",e)}})},ST=$T,DT=/^(re|un)-?[a-z\u00C0-\u00FF]/,VT=/^(re|un)-?/,IT=function(t,e){var n=e.words;t.forEach(function(r){if(r.isKnown()!==!0&&DT.test(r.clean)===!0){var i=r.clean.replace(VT,"");i&&i.length>3&&n[i]!==void 0&&n.hasOwnProperty(i)===!0&&r.tag(n[i],"stem-"+i,e)}})},MT=IT,OT=[/(^v)ies$/i,/ises$/i,/ives$/i,/(antenn|formul|nebul|vertebr|vit)ae$/i,/(octop|vir|radi|nucle|fung|cact|stimul)i$/i,/(buffal|tomat|tornad)oes$/i,/(analy|ba|diagno|parenthe|progno|synop|the)ses$/i,/(vert|ind|cort)ices$/i,/(matr|append)ices$/i,/(x|ch|ss|sh|s|z|o)es$/i,/is$/i,/men$/i,/news$/i,/.tia$/i,/(^f)ves$/i,/(lr)ves$/i,/(^aeiouy|qu)ies$/i,/(m|l)ice$/i,/(cris|ax|test)es$/i,/(alias|status)es$/i,/ics$/i],ET=[/(ax|test)is$/i,/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,/(octop|vir)i$/i,/(rl)f$/i,/(alias|status)$/i,/(bu)s$/i,/(al|ad|at|er|et|ed|ad)o$/i,/(ti)um$/i,/(ti)a$/i,/sis$/i,/(?:(^f)fe|(lr)f)$/i,/hive$/i,/s[aeiou]+ns$/i,/(^aeiouy|qu)y$/i,/(x|ch|ss|sh|z)$/i,/(matr|vert|ind|cort)(ix|ex)$/i,/(m|l)ouse$/i,/(m|l)ice$/i,/(antenn|formul|nebul|vertebr|vit)a$/i,/.sis$/i,/^(?!talis|.*hu)(.*)man$/i],ag={isSingular:ET,isPlural:OT},PT=["Uncountable","Pronoun","Place","Value","Person","Month","WeekDay","Holiday"],LT=[/ss$/,/sis$/,/[^aeiou][uo]s$/,/'s$/],RT=[/i$/,/ae$/],kT=function(t,e){if(t.tags.Noun&&!t.tags.Acronym){var n=t.clean;if(t.tags.Singular||t.tags.Plural)return;if(n.length<=3){t.tag("Singular","short-singular",e);return}if(PT.find(function(r){return t.tags[r]}))return;if(ag.isPlural.find(function(r){return r.test(n)})){t.tag("Plural","plural-rules",e);return}if(ag.isSingular.find(function(r){return r.test(n)})){t.tag("Singular","singular-rules",e);return}if(/s$/.test(n)===!0){if(LT.find(function(r){return r.test(n)}))return;t.tag("Plural","plural-fallback",e);return}if(RT.find(function(r){return r.test(n)}))return;t.tag("Singular","singular-fallback",e)}},FT=kT,BT=["academy","administration","agence","agences","agencies","agency","airlines","airways","army","assoc","associates","association","assurance","authority","autorite","aviation","bank","banque","board","boys","brands","brewery","brotherhood","brothers","building society","bureau","cafe","caisse","capital","care","cathedral","center","central bank","centre","chemicals","choir","chronicle","church","circus","clinic","clinique","club","co","coalition","coffee","collective","college","commission","committee","communications","community","company","comprehensive","computers","confederation","conference","conseil","consulting","containers","corporation","corps","corp","council","crew","daily news","data","departement","department","department store","departments","design","development","directorate","division","drilling","education","eglise","electric","electricity","energy","ensemble","enterprise","enterprises","entertainment","estate","etat","evening news","faculty","federation","financial","fm","foundation","fund","gas","gazette","girls","government","group","guild","health authority","herald","holdings","hospital","hotel","hotels","inc","industries","institut","institute","institute of technology","institutes","insurance","international","interstate","investment","investments","investors","journal","laboratory","labs","liberation army","limited","local authority","local health authority","machines","magazine","management","marine","marketing","markets","media","memorial","mercantile exchange","ministere","ministry","military","mobile","motor","motors","musee","museum","news","news service","observatory","office","oil","optical","orchestra","organization","partners","partnership","people's party","petrol","petroleum","pharmacare","pharmaceutical","pharmaceuticals","pizza","plc","police","polytechnic","post","power","press","productions","quartet","radio","regional authority","regional health authority","reserve","resources","restaurant","restaurants","savings","school","securities","service","services","social club","societe","society","sons","standard","state police","state university","stock exchange","subcommittee","syndicat","systems","telecommunications","telegraph","television","times","tribunal","tv","union","university","utilities","workers"],sg=BT.reduce(function(l,t){return l[t]="Noun",l},{}),og=function(t){return!t.tags.Noun||t.tags.Pronoun||t.tags.Comma||t.tags.Possessive?!1:!!(t.tags.Organization||t.tags.Acronym||t.tags.Place||t.titleCase())},zT=function(t,e){for(var n=0;n<t.length;n+=1){var r=t[n];if(sg[r.clean]!==void 0&&sg.hasOwnProperty(r.clean)===!0){var i=t[n-1];if(i!==void 0&&og(i)===!0){i.tagSafe("Organization","org-word-1",e),r.tagSafe("Organization","org-word-2",e);continue}var a=t[n+1];if(a!==void 0&&a.clean==="of"&&t[n+2]&&og(t[n+2])){r.tagSafe("Organization","org-of-word-1",e),a.tagSafe("Organization","org-of-word-2",e),t[n+2].tagSafe("Organization","org-of-word-3",e);continue}}}},qT=zT,jT=/^[A-Z]('s|,)?$/,UT=/([A-Z]\.){2}[A-Z]?/i,HT={I:!0,A:!0},KT=function(t,e){var n=t.reduced;return t.tags.Acronym?!0:e.words[n]||n.length>5?!1:t.isAcronym()},WT=function(t,e){t.forEach(function(n){n.tags.RomanNumeral!==!0&&(UT.test(n.text)===!0&&n.tag("Acronym","period-acronym",e),n.isUpperCase()&&KT(n,e)?(n.tag("Acronym","acronym-step",e),n.tag("Noun","acronym-infer",e)):!HT.hasOwnProperty(n.text)&&jT.test(n.text)&&(n.tag("Acronym","one-letter-acronym",e),n.tag("Noun","one-letter-infer",e)),n.tags.Organization&&n.text.length<=3&&n.tag("Acronym","acronym-org",e),n.tags.Organization&&n.isUpperCase()&&n.text.length<=6&&n.tag("Acronym","acronym-org-case",e))})},GT=WT,Pn={neighbours:TT,case:ST,stem:MT,plural:FT,organizations:qT,acronyms:GT},ZT=function(t,e){var n=t.world;return Pn.neighbours(e,n),Pn.case(t),Pn.stem(e,n),e.forEach(function(r){r.isKnown()===!1&&r.tag("Noun","noun-fallback",t.world)}),Pn.organizations(e,n),Pn.acronyms(e,n),e.forEach(function(r){Pn.plural(r,t.world)}),t},XT=ZT,lg=/n't$/,ug={"won't":["will","not"],wont:["will","not"],"can't":["can","not"],cant:["can","not"],cannot:["can","not"],"shan't":["should","not"],dont:["do","not"],dun:["do","not"]},JT=function(t,e){var n=e.terms(),r=n.indexOf(t),i=n.slice(0,r),a=i.find(function(s){return s.tags.Noun});return a&&a.tags.Plural?["are","not"]:["is","not"]},YT=function(t,e){if(ug.hasOwnProperty(t.clean)===!0)return ug[t.clean];if(t.clean==="ain't"||t.clean==="aint")return JT(t,e);if(lg.test(t.clean)===!0){var n=t.clean.replace(lg,"");return[n,"not"]}return null},QT=YT,e_=/([a-z\u00C0-\u00FF]+)[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]([a-z]{1,2})$/i,cg={ll:"will",ve:"have",re:"are",m:"am","n't":"not"},t_=function(t){var e=t.text.match(e_);return e===null?null:cg.hasOwnProperty(e[2])?[e[1],cg[e[2]]]:null},r_=t_,fg={wanna:["want","to"],gonna:["going","to"],im:["i","am"],alot:["a","lot"],ive:["i","have"],imma:["I","will"],"where'd":["where","did"],whered:["where","did"],"when'd":["when","did"],whend:["when","did"],howd:["how","did"],whatd:["what","did"],dunno:["do","not","know"],brb:["be","right","back"],gtg:["got","to","go"],irl:["in","real","life"],tbh:["to","be","honest"],imo:["in","my","opinion"],til:["today","i","learned"],rn:["right","now"],twas:["it","was"],"@":["at"]},n_=function(t){return fg.hasOwnProperty(t.clean)?fg[t.clean]:null},i_=n_,a_=/([a-z\u00C0-\u00FF]+)[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]s$/i,s_={that:!0,there:!0},o_={here:!0,there:!0,everywhere:!0},l_=function(t,e){if(t.tags.Possessive)return!0;if(t.tags.Pronoun||t.tags.QuestionWord||s_.hasOwnProperty(t.reduced))return!1;var n=e.get(t.next);if(!n)return!0;if(n.tags.Verb)return!!(n.tags.Infinitive||n.tags.PresentTense);if(n.tags.Noun)return o_.hasOwnProperty(n.reduced)!==!0;var r=e.get(n.next);return r&&r.tags.Noun&&!r.tags.Pronoun?!0:(n.tags.Adjective||n.tags.Adverb||n.tags.Verb,!1)},u_=function(t,e){var n=e.terms(),r=n.indexOf(t),i=n.slice(r+1,r+3);return i.find(function(a){return a.tags.PastTense})},c_=function(t,e,n){var r=t.text.match(a_);if(r!==null){if(l_(t,e.pool)===!0)return t.tag("#Possessive","isPossessive",n),null;if(r!==null)return u_(t,e)?[r[1],"has"]:[r[1],"is"]}return null},f_=c_,p_=/[a-z\u00C0-\u00FF]'d$/,d_={how:!0,what:!0},m_=function(t,e){if(p_.test(t.clean)){for(var n=t.clean.replace(/'d$/,""),r=e.terms(),i=r.indexOf(t),a=r.slice(i+1,i+4),s=0;s<a.length;s++){var o=a[s];if(o.tags.Verb)return o.tags.PastTense?[n,"had"]:d_[n]===!0?[n,"did"]:[n,"would"]}return[n,"would"]}return null},h_=m_,v_=/^([0-9.]{1,3}[a-z]{0,2})[-]([0-9]{1,3}[a-z]{0,2})$/i,y_=/^([0-9][0-9]?(:[0-9][0-9])?(am|pm)?)[-]([0-9][0-9]?(:[0-9][0-9])?(am|pm)?)$/i,g_=function(t){if(t.tags.PhoneNumber===!0)return null;var e=t.text.match(v_);return e!==null?[e[1],"to",e[2]]:(e=t.text.match(y_),e!==null?[e[1],"to",e[4]]:null)},b_=g_,x_=/^(l|c|d|j|m|n|qu|s|t)[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]([a-z\u00C0-\u00FF]+)$/i,pg={l:"le",c:"ce",d:"de",j:"je",m:"me",n:"ne",qu:"que",s:"se",t:"tu"},C_=function(t){var e=t.text.match(x_);if(e===null||pg.hasOwnProperty(e[1])===!1)return null;var n=[pg[e[1]],e[2]];return n[0]&&n[1]?n:null},N_=C_,w_=/^[0-9]+$/,T_=/^[0-9]+(st|nd|rd|th)$/,__=/^[0-9:]+(am|pm)?$/,A_=function(t,e){var n=br(t.join(" "),e.world,e.pool())[0],r=n.terms();iu(r,e.world);var i=r[0];return T_.test(i.text)?(r[0].tag("Ordinal","ord-range",e.world),r[2].tag("Ordinal","ord-range",e.world)):w_.test(i.text)?(r[0].tag("Cardinal","num-range",e.world),r[2].tag("Cardinal","num-range",e.world)):__.test(i.text)&&(r[0].tag("Time","time-range",e.world),r[1].tag("Date","time-range",e.world),r[2].tag("Time","time-range",e.world)),r.forEach(function(a){a.implicit=a.text,a.text="",a.clean="",a.pre="",a.post="",Object.keys(a.tags).length===0&&(a.tags.Noun=!0)}),n},$_=function(t){var e=t.world;return t.list.forEach(function(n){for(var r=n.terms(),i=0;i<r.length;i+=1){var a=r[i],s=QT(a,n);if(s=s||r_(a),s=s||i_(a),s=s||f_(a,n,e),s=s||h_(a,n),s=s||b_(a),s=s||N_(a),s!==null){var o=A_(s,t);n.has("#NumberRange")===!0&&t.buildFrom([o]).tag("NumberRange");var u=o.terms(0);u.text=a.text;var c=n.buildFrom(a.id,1,t.pool());c.replace(o,t,!0)}}}),t},S_=$_,D_=function(t,e){var n=t._cache.words[e]||[];return n=n.map(function(r){return t.list[r]}),t.buildFrom(n)},Ln=function(t,e){var n=t._cache.tags[e]||[];return n=n.map(function(r){return t.list[r]}),t.buildFrom(n)},V_=function(t){var e=Ln(t,"Infinitive");return e.found&&(e=e.ifNo("@hasQuestionMark"),e=e.ifNo("(i|we|they)"),e.match("[#Infinitive] (#Determiner|#Possessive) #Noun",0).tag("Imperative","shut-the"),e.match("^[#Infinitive] #Adverb?$",0).tag("Imperative","go-fast"),e.match("[(do && #Infinitive)] not? #Verb",0).tag("Imperative","do-not"),e.match("[#Infinitive] (it|some)",0).tag("Imperative","do-it")),e=D_(t,"like"),e.match("#Adverb like").notIf("(really|generally|typically|usually|sometimes|often|just) [like]").tag("Adverb","adverb-like"),e=Ln(t,"Adjective"),e.match("#Determiner #Adjective$").notIf("(#Comparative|#Superlative)").terms(1).tag("Noun","the-adj-1"),e=Ln(t,"FirstName"),e.match("#FirstName (#Noun|@titleCase)").ifNo("^#Possessive").ifNo("(#Pronoun|#Plural)").ifNo("@hasComma .").lastTerm().tag("#LastName","firstname-noun"),e=Ln(t,"Value"),e=e.match("#Value #PresentTense").ifNo("#Copula"),e.found&&(e.has("(one|1)")===!0?e.terms(1).tag("Singular","one-presentTense"):e.terms(1).tag("Plural","value-presentTense")),t.match("^(well|so|okay)").tag("Expression","well-"),t.match("#Value [of a second]",0).unTag("Value","of-a-second"),t.match("#Value [seconds]",0).unTag("Value","30-seconds").tag(["Unit","Plural"]),e=Ln(t,"Gerund"),e.match("(be|been) (#Adverb|not)+? #Gerund").not("#Verb$").tag("Auxiliary","be-walking"),t.match("(try|use|attempt|build|make) #Verb").ifNo("(@hasComma|#Negative|#PhrasalVerb|#Copula|will|be)").lastTerm().tag("#Noun","do-verb"),e=Ln(t,"Possessive"),e=e.match("#Possessive [#Infinitive]",0),e.lookBehind("(let|made|make|force|ask)").found||e.tag("Noun","her-match"),t},I_=V_,M_=function(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return Object.keys(e)},ou=M_,O_=[{match:"too much",tag:"Adverb Adjective",reason:"bit-4"},{match:"u r",tag:"Pronoun Copula",reason:"u r"},{match:"#Copula (pretty|dead|full|well|sure) (#Adjective|#Noun)",tag:"#Copula #Adverb #Adjective",reason:"sometimes-adverb"},{match:"(#Pronoun|#Person) (had|#Adverb)? [better] #PresentTense",group:0,tag:"Modal",reason:"i-better"},{match:"[#Gerund] #Adverb? not? #Copula",group:0,tag:"Activity",reason:"gerund-copula"},{match:"[#Gerund] #Modal",group:0,tag:"Activity",reason:"gerund-modal"},{match:"holy (shit|fuck|hell)",tag:"Expression",reason:"swears-expression"},{match:"#Noun #Actor",tag:"Actor",reason:"thing-doer"},{match:"#Conjunction [u]",group:0,tag:"Pronoun",reason:"u-pronoun-2"},{match:"[u] #Verb",group:0,tag:"Pronoun",reason:"u-pronoun-1"},{match:"#Noun [(who|whom)]",group:0,tag:"Determiner",reason:"captain-who"},{match:"a bit much",tag:"Determiner Adverb Adjective",reason:"bit-3"},{match:"#Verb #Adverb? #Noun [(that|which)]",group:0,tag:"Preposition",reason:"that-prep"},{match:"@hasComma [which] (#Pronoun|#Verb)",group:0,tag:"Preposition",reason:"which-copula"},{match:"#Copula just [like]",group:0,tag:"Preposition",reason:"like-preposition"},{match:"#Noun [like] #Noun",group:0,tag:"Preposition",reason:"noun-like"},{match:"[had] #Noun+ #PastTense",group:0,tag:"Condition",reason:"had-he"},{match:"[were] #Noun+ to #Infinitive",group:0,tag:"Condition",reason:"were-he"},{match:"^how",tag:"QuestionWord",reason:"how-question"},{match:"[how] (#Determiner|#Copula|#Modal|#PastTense)",group:0,tag:"QuestionWord",reason:"how-is"},{match:"^which",tag:"QuestionWord",reason:"which-question"},{match:"[so] #Noun",group:0,tag:"Conjunction",reason:"so-conj"},{match:"[(who|what|where|why|how|when)] #Noun #Copula #Adverb? (#Verb|#Adjective)",group:0,tag:"Conjunction",reason:"how-he-is-x"}],E_=O_,Jr={adverbAdjective:["dark","bright","flat","light","soft","pale","dead","dim","faux","little","wee","sheer","most","near","good","extra","all"],personDate:["april","june","may","jan","august","eve"],personMonth:["january","april","may","june","jan","sep"],personAdjective:["misty","rusty","dusty","rich","randy","young"],personVerb:["pat","wade","ollie","will","rob","buck","bob","mark","jack"],personPlace:["darwin","hamilton","paris","alexandria","houston","kobe","santiago","salvador","sydney","victoria"],personNoun:["art","baker","berg","bill","brown","charity","chin","christian","cliff","daisy","dawn","dick","dolly","faith","franco","gene","green","hall","hill","holly","hope","jean","jewel","joy","kelvin","king","kitty","lane","lily","melody","mercedes","miles","olive","penny","ray","reed","robin","rod","rose","sky","summer","trinity","van","viola","violet","wang","white"]},ur="(".concat(Jr.personDate.join("|"),")"),P_=[{match:"#Holiday (day|eve)",tag:"Holiday",reason:"holiday-day"},{match:"[sun] the #Ordinal",tag:"WeekDay",reason:"sun-the-5th"},{match:"[sun] #Date",group:0,tag:"WeekDay",reason:"sun-feb"},{match:"#Date (on|this|next|last|during)? [sun]",group:0,tag:"WeekDay",reason:"1pm-sun"},{match:"(in|by|before|during|on|until|after|of|within|all) [sat]",group:0,tag:"WeekDay",reason:"sat"},{match:"(in|by|before|during|on|until|after|of|within|all) [wed]",group:0,tag:"WeekDay",reason:"wed"},{match:"(in|by|before|during|on|until|after|of|within|all) [march]",group:0,tag:"Month",reason:"march"},{match:"[sat] #Date",group:0,tag:"WeekDay",reason:"sat-feb"},{match:"#Preposition [(march|may)]",group:0,tag:"Month",reason:"in-month"},{match:"this [(march|may)]",group:0,tag:"Month",reason:"this-month"},{match:"next [(march|may)]",group:0,tag:"Month",reason:"this-month"},{match:"last [(march|may)]",group:0,tag:"Month",reason:"this-month"},{match:"[(march|may)] the? #Value",group:0,tag:"Month",reason:"march-5th"},{match:"#Value of? [(march|may)]",group:0,tag:"Month",reason:"5th-of-march"},{match:"[(march|may)] .? #Date",group:0,tag:"Month",reason:"march-and-feb"},{match:"#Date .? [(march|may)]",group:0,tag:"Month",reason:"feb-and-march"},{match:"#Adverb [(march|may)]",group:0,tag:"Verb",reason:"quickly-march"},{match:"[(march|may)] #Adverb",group:0,tag:"Verb",reason:"march-quickly"},{match:"#Value of #Month",tag:"Date",reason:"value-of-month"},{match:"#Cardinal #Month",tag:"Date",reason:"cardinal-month"},{match:"#Month #Value to #Value",tag:"Date",reason:"value-to-value"},{match:"#Month the #Value",tag:"Date",reason:"month-the-value"},{match:"(#WeekDay|#Month) #Value",tag:"Date",reason:"date-value"},{match:"#Value (#WeekDay|#Month)",tag:"Date",reason:"value-date"},{match:"(#TextValue && #Date) #TextValue",tag:"Date",reason:"textvalue-date"},{match:"in [".concat(ur,"]"),group:0,tag:"Date",reason:"in-june"},{match:"during [".concat(ur,"]"),group:0,tag:"Date",reason:"in-june"},{match:"on [".concat(ur,"]"),group:0,tag:"Date",reason:"in-june"},{match:"by [".concat(ur,"]"),group:0,tag:"Date",reason:"by-june"},{match:"after [".concat(ur,"]"),group:0,tag:"Date",reason:"after-june"},{match:"#Date [".concat(ur,"]"),group:0,tag:"Date",reason:"in-june"},{match:"".concat(ur," #Value"),tag:"Date",reason:"june-5th"},{match:"".concat(ur," #Date"),tag:"Date",reason:"june-5th"},{match:"".concat(ur," #ProperNoun"),tag:"Person",reason:"june-smith",safe:!0},{match:"".concat(ur," #Acronym? (#ProperNoun && !#Month)"),tag:"Person",reason:"june-smith-jr"},{match:"#Cardinal [second]",tag:"Unit",reason:"one-second"},{match:"#Month #NumberRange",tag:"Date",reason:"aug 20-21"},{match:"(#Place|#Demonmym|#Time) (standard|daylight|central|mountain)? time",tag:"Timezone",reason:"std-time"},{match:"(eastern|mountain|pacific|central|atlantic) (standard|daylight|summer)? time",tag:"Timezone",reason:"eastern-time"},{match:"#Time [(eastern|mountain|pacific|central|est|pst|gmt)]",group:0,tag:"Timezone",reason:"5pm-central"},{match:"(central|western|eastern) european time",tag:"Timezone",reason:"cet"}],L_=P_,lu="(".concat(Jr.personAdjective.join("|"),")"),R_=[{match:"[all] #Determiner? #Noun",group:0,tag:"Adjective",reason:"all-noun"},{match:"#Adverb [".concat(lu,"]"),group:0,tag:"Adjective",reason:"really-rich"},{match:"".concat(lu," #Person"),tag:"Person",reason:"randy-smith"},{match:"".concat(lu," #Acronym? #ProperNoun"),tag:"Person",reason:"rusty-smith"},{match:"#Copula [(just|alone)]$",group:0,tag:"Adjective",reason:"not-adverb"},{match:"#Singular is #Adverb? [#PastTense$]",group:0,tag:"Adjective",reason:"is-filled"},{match:"[#PastTense] #Singular is",group:0,tag:"Adjective",reason:"smoked-poutine"},{match:"[#PastTense] #Plural are",group:0,tag:"Adjective",reason:"baked-onions"},{match:"well [#PastTense]",group:0,tag:"Adjective",reason:"well-made"},{match:"#Copula [fucked up?]",tag:"Adjective",reason:"swears-adjective"},{match:"#Singular (seems|appears) #Adverb? [#PastTense$]",group:0,tag:"Adjective",reason:"seems-filled"},{match:"(a|an) [#Gerund]",group:0,tag:"Adjective",reason:"a|an"},{match:"as [#Gerund] as",group:0,tag:"Adjective",reason:"as-gerund-as"},{match:"more [#Gerund] than",group:0,tag:"Adjective",reason:"more-gerund-than"},{match:"(so|very|extremely) [#Gerund]",group:0,tag:"Adjective",reason:"so-gerund"},{match:"(it|he|she|everything|something) #Adverb? was #Adverb? [#Gerund]",group:0,tag:"Adjective",reason:"it-was-gerund"},{match:"(found|found) it #Adverb? [#Gerund]",group:0,tag:"Adjective",reason:"found-it-gerund"},{match:"a (little|bit|wee) bit? [#Gerund]",group:0,tag:"Adjective",reason:"a-bit-gerund"},{match:"#Copula #Adjective? [(out|in|through)]$",group:0,tag:"Adjective",reason:"still-out"},{match:"^[#Adjective] (the|your) #Noun",group:0,tag:"Infinitive",reason:"shut-the"}],k_=R_,F_=[{match:"there (are|were) #Adjective? [#PresentTense]",group:0,tag:"Plural",reason:"there-are"},{match:"#Determiner [sun]",group:0,tag:"Singular",reason:"the-sun"},{match:"#Verb (a|an) [#Value]",group:0,tag:"Singular",reason:"did-a-value"},{match:"the [(can|will|may)]",group:0,tag:"Singular",reason:"the can"},{match:"#FirstName #Acronym? (#Possessive && #LastName)",tag:"Possessive",reason:"name-poss"},{match:"#Organization+ #Possessive",tag:"Possessive",reason:"org-possessive"},{match:"#Place+ #Possessive",tag:"Possessive",reason:"place-possessive"},{match:"(#Verb && !#Modal) (all|every|each|most|some|no) [#PresentTense]",group:0,tag:"Noun",reason:"all-presentTense"},{match:"#Determiner [#Adjective] #Copula",group:0,tag:"Noun",reason:"the-adj-is"},{match:"#Adjective [#Adjective] #Copula",group:0,tag:"Noun",reason:"adj-adj-is"},{match:"(had|have|#PastTense) #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"adj-presentTense"},{match:"^#Adjective [#PresentTense]",group:0,tag:"Noun",reason:"start adj-presentTense"},{match:"#Value #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"one-big-reason"},{match:"#PastTense #Adjective+ [#PresentTense]",group:0,tag:"Noun",reason:"won-wide-support"},{match:"(many|few|several|couple) [#PresentTense]",group:0,tag:"Noun",reason:"many-poses"},{match:"#Adverb #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"very-big-dream"},{match:"#Adjective [#Infinitive] #Noun",group:0,tag:"Noun",reason:"good-wait-staff"},{match:"#Adjective #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"adorable-little-store"},{match:"#Preposition #Adjective [#PresentTense]",group:0,tag:"Noun",reason:"of-basic-training"},{match:"#Adjective [#Gerund]",group:0,tag:"Noun",reason:"early-warning"},{match:"#Gerund #Adverb? #Comparative [#PresentTense]",group:0,tag:"Noun",reason:"higher-costs"},{match:"#Infinitive (this|that|the) [#Infinitive]",group:0,tag:"Noun",reason:"do-this-dance"},{match:"(his|her|its) [#Adjective]",group:0,tag:"Noun",reason:"his-fine"},{match:"some [#Verb] #Plural",group:0,tag:"Noun",reason:"determiner6"},{match:"more #Noun",tag:"Noun",reason:"more-noun"},{match:"(#Noun && @hasComma) #Noun (and|or) [#PresentTense]",group:0,tag:"Noun",reason:"noun-list"},{match:"(right|rights) of .",tag:"Noun",reason:"right-of"},{match:"a [bit]",group:0,tag:"Noun",reason:"bit-2"},{match:"#Possessive #Ordinal [#PastTense]",group:0,tag:"Noun",reason:"first-thought"},{match:"#Gerund #Determiner [#Infinitive]",group:0,tag:"Noun",reason:"running-a-show"},{match:"#Determiner #Adverb [#Infinitive]",group:0,tag:"Noun",reason:"the-reason"},{match:"(the|this|those|these) #Adjective [#Verb]",group:0,tag:"Noun",reason:"the-adj-verb"},{match:"(the|this|those|these) #Adverb #Adjective [#Verb]",group:0,tag:"Noun",reason:"determiner4"},{match:"#Determiner [#Adjective] (#Copula|#PastTense|#Auxiliary)",group:0,tag:"Noun",reason:"the-adj-2"},{match:"(the|this|a|an) [#Infinitive] #Adverb? #Verb",group:0,tag:"Noun",reason:"determiner5"},{match:"#Determiner [#Infinitive] #Noun",group:0,tag:"Noun",reason:"determiner7"},{match:"#Determiner #Adjective #Adjective? [#Infinitive]",group:0,tag:"Noun",reason:"a-nice-inf"},{match:"the [#Verb] #Preposition .",group:0,tag:"Noun",reason:"determiner1"},{match:"#Determiner [#Verb] of",group:0,tag:"Noun",reason:"the-verb-of"},{match:"#Adjective #Noun+ [#Infinitive] #Copula",group:0,tag:"Noun",reason:"career-move"},{match:"#Determiner #Noun of [#Verb]",group:0,tag:"Noun",reason:"noun-of-noun"},{match:"#Determiner [(western|eastern|northern|southern|central)] #Noun",group:0,tag:"Noun",reason:"western-line"},{match:"#Possessive [#Gerund]",group:0,tag:"Noun",reason:"her-polling"},{match:"(his|her|its) [#PresentTense]",group:0,tag:"Noun",reason:"its-polling"},{match:"(#Determiner|#Value) [(linear|binary|mobile|lexical|technical|computer|scientific|formal)] #Noun",group:0,tag:"Noun",reason:"technical-noun"},{match:"(the|those|these|a|an) [#Participle] #Noun",group:0,tag:"Adjective",reason:"blown-motor"},{match:"(the|those|these|a|an) #Adjective? [#Infinitive]",group:0,tag:"Noun",reason:"det-inf"},{match:"(the|those|these|a|an) #Adjective? [#PresentTense]",group:0,tag:"Noun",reason:"det-pres"},{match:"(the|those|these|a|an) #Adjective? [#PastTense]",group:0,tag:"Noun",reason:"det-past"},{match:"(this|that) [#Gerund]",group:0,tag:"Noun",reason:"this-gerund"},{match:"at some [#Infinitive]",group:0,tag:"Noun",reason:"at-some-inf"},{match:"(#Noun && @hasHyphen) #Verb",tag:"Noun",reason:"hyphen-verb"},{match:"is no [#Verb]",group:0,tag:"Noun",reason:"is-no-verb"},{match:"[#Verb] than",group:0,tag:"Noun",reason:"correction"},{match:"(go|goes|went) to [#Infinitive]",group:0,tag:"Noun",reason:"goes-to-verb"},{match:"(a|an) #Noun [#Infinitive] (#Preposition|#Noun)",group:0,tag:"Noun",reason:"a-noun-inf"},{match:"(a|an) #Noun [#Infinitive]$",group:0,tag:"Noun",reason:"a-noun-inf2"},{match:"do [so]",group:0,tag:"Noun",reason:"so-noun"},{match:"#Copula [#Infinitive] #Noun",group:0,tag:"Noun",reason:"is-pres-noun"},{match:"#Determiner #Adverb? [close]",group:0,tag:"Adjective",reason:"a-close"},{match:"#Determiner [(shit|damn|hell)]",group:0,tag:"Noun",reason:"swears-noun"},{match:"(the|these) [#Singular] (were|are)",group:0,tag:"Plural",reason:"singular-were"},{match:"#Gerund #Adjective? for [#Infinitive]",group:0,tag:"Noun",reason:"running-for"},{match:"#Gerund #Adjective to [#Infinitive]",group:0,tag:"Noun",reason:"running-to"},{match:"(many|any|some|several) [#PresentTense] for",group:0,tag:"Noun",reason:"any-verbs-for"},{match:"(have|had) [#Adjective] #Preposition .",group:0,tag:"Noun",reason:"have-fun"},{match:"co #Noun",tag:"Actor",reason:"co-noun"}],B_="(".concat(Jr.adverbAdjective.join("|"),")"),z_=[{match:"[still] #Adjective",group:0,tag:"Adverb",reason:"still-advb"},{match:"[still] #Verb",group:0,tag:"Adverb",reason:"still-verb"},{match:"[so] #Adjective",group:0,tag:"Adverb",reason:"so-adv"},{match:"[way] #Comparative",group:0,tag:"Adverb",reason:"way-adj"},{match:"[way] #Adverb #Adjective",group:0,tag:"Adverb",reason:"way-too-adj"},{match:"[all] #Verb",group:0,tag:"Adverb",reason:"all-verb"},{match:"(#Verb && !#Modal) [like]",group:0,tag:"Adverb",reason:"verb-like"},{match:"(barely|hardly) even",tag:"Adverb",reason:"barely-even"},{match:"[even] #Verb",group:0,tag:"Adverb",reason:"even-walk"},{match:"even left",tag:"#Adverb #Verb",reason:"even-left"},{match:"(#PresentTense && !#Copula) [(hard|quick|long|bright|slow|fast|backwards|forwards)]",group:0,tag:"Adverb",reason:"lazy-ly"},{match:"[much] #Adjective",group:0,tag:"Adverb",reason:"bit-1"},{match:"#Copula [#Adverb]$",group:0,tag:"Adjective",reason:"is-well"},{match:"a [(little|bit|wee) bit?] #Adjective",group:0,tag:"Adverb",reason:"a-bit-cold"},{match:"[".concat(B_,"] #Adjective"),group:0,tag:"Adverb",reason:"dark-green"},{match:"#Adverb [#Adverb]$",group:0,tag:"Adjective",reason:"kinda-sparkly"},{match:"#Adverb [#Adverb] (and|or|then)",group:0,tag:"Adjective",reason:"kinda-sparkly-and"}],q_=[{match:"1 #Value #PhoneNumber",tag:"PhoneNumber",reason:"1-800-Value"},{match:"#NumericValue #PhoneNumber",tag:"PhoneNumber",reason:"(800) PhoneNumber"},{match:"#Demonym #Currency",tag:"Currency",reason:"demonym-currency"},{match:"[second] #Noun",group:0,tag:"Ordinal",reason:"second-noun"},{match:"#Value+ [#Currency]",group:0,tag:"Unit",reason:"5-yan"},{match:"#Value [(foot|feet)]",group:0,tag:"Unit",reason:"foot-unit"},{match:"(minus|negative) #Value",tag:"Value",reason:"minus-value"},{match:"#Value [#Abbreviation]",group:0,tag:"Unit",reason:"value-abbr"},{match:"#Value [k]",group:0,tag:"Unit",reason:"value-k"},{match:"#Unit an hour",tag:"Unit",reason:"unit-an-hour"},{match:"#Value (point|decimal) #Value",tag:"Value",reason:"value-point-value"},{match:"(#Value|a) [(buck|bucks|grand)]",group:0,tag:"Currency",reason:"value-bucks"},{match:"#Determiner [(half|quarter)] #Ordinal",group:0,tag:"Value",reason:"half-ordinal"},{match:"a #Value",tag:"Value",reason:"a-value"},{match:"[#Value+] #Currency",group:0,tag:"Money",reason:"15 usd"},{match:"(hundred|thousand|million|billion|trillion|quadrillion)+ and #Value",tag:"Value",reason:"magnitude-and-value"},{match:"!once [(a|an)] (#Duration|hundred|thousand|million|billion|trillion)",group:0,tag:"Value",reason:"a-is-one"}],va="(".concat(Jr.personVerb.join("|"),")"),j_=[{match:"[#Adjective] #Possessive #Noun",group:0,tag:"Verb",reason:"gerund-his-noun"},{match:"[#Adjective] (us|you)",group:0,tag:"Gerund",reason:"loving-you"},{match:"(slowly|quickly) [#Adjective]",group:0,tag:"Gerund",reason:"slowly-adj"},{match:"(#Modal|i|they|we|do) not? [like]",group:0,tag:"PresentTense",reason:"modal-like"},{match:"do (simply|just|really|not)+ [(#Adjective|like)]",group:0,tag:"Verb",reason:"do-simply-like"},{match:"does (#Adverb|not)? [#Adjective]",group:0,tag:"PresentTense",reason:"does-mean"},{match:"i (#Adverb|do)? not? [mean]",group:0,tag:"PresentTense",reason:"i-mean"},{match:"#Noun #Adverb? [left]",group:0,tag:"PastTense",reason:"left-verb"},{match:"(this|that) [#Plural]",group:0,tag:"PresentTense",reason:"this-verbs"},{match:"[#Copula (#Adverb|not)+?] (#Gerund|#PastTense)",group:0,tag:"Auxiliary",reason:"copula-walking"},{match:"[(has|had) (#Adverb|not)+?] #PastTense",group:0,tag:"Auxiliary",reason:"had-walked"},{match:"[#Adverb+? (#Modal|did)+ (#Adverb|not)+?] #Verb",group:0,tag:"Auxiliary",reason:"modal-verb"},{match:"[#Modal (#Adverb|not)+? have (#Adverb|not)+? had (#Adverb|not)+?] #Verb",group:0,tag:"Auxiliary",reason:"would-have"},{match:"[(has|had) (#Adverb|not)+?] #PastTense",group:0,tag:"Auxiliary",reason:"had-walked"},{match:"[(do|does|will|have|had)] (not|#Adverb)? #Verb",group:0,tag:"Auxiliary",reason:"have-had"},{match:"[about to] #Adverb? #Verb",group:0,tag:["Auxiliary","Verb"],reason:"about-to"},{match:"#Modal (#Adverb|not)+? be (#Adverb|not)+? #Verb",group:0,tag:"Auxiliary",reason:"would-be"},{match:"(were|was) being [#PresentTense]",group:0,tag:"PastTense",reason:"was-being"},{match:"[#Modal (#Adverb|not)+? have (#Adverb|not)+? had (#Adverb|not)+?] #Verb",group:0,tag:"Auxiliary",reason:"would-have"},{match:"(#Modal|had|has) (#Adverb|not)+? been (#Adverb|not)+? #Verb",group:0,tag:"Auxiliary",reason:"had-been"},{match:"[(be|being|been)] #Participle",group:0,tag:"Auxiliary",reason:"being-foo"},{match:"(#Verb && @hasHyphen) up",tag:"PhrasalVerb",reason:"foo-up"},{match:"(#Verb && @hasHyphen) off",tag:"PhrasalVerb",reason:"foo-off"},{match:"(#Verb && @hasHyphen) over",tag:"PhrasalVerb",reason:"foo-over"},{match:"(#Verb && @hasHyphen) out",tag:"PhrasalVerb",reason:"foo-out"},{match:"#PhrasalVerb [#PhrasalVerb]",group:0,tag:"Particle",reason:"phrasal-particle"},{match:"#Verb (him|her|it|us|himself|herself|itself|everything|something) [(up|down)]",group:0,tag:"Adverb",reason:"phrasal-pronoun-advb"},{match:"[will #Adverb? not? #Adverb? be] #Gerund",group:0,tag:"Copula",reason:"will-be-copula"},{match:"will #Adverb? not? #Adverb? [be] #Adjective",group:0,tag:"Copula",reason:"be-copula"},{match:"[march] (up|down|back|to|toward)",group:0,tag:"Infinitive",reason:"march-to"},{match:"#Modal [march]",group:0,tag:"Infinitive",reason:"must-march"},{match:"(let|make|made) (him|her|it|#Person|#Place|#Organization)+ [#Singular] (a|an|the|it)",group:0,tag:"Infinitive",reason:"let-him-glue"},{match:"will [#Adjective]",group:0,tag:"Verb",reason:"will-adj"},{match:"#Pronoun [#Adjective] #Determiner #Adjective? #Noun",group:0,tag:"Verb",reason:"he-adj-the"},{match:"#Copula [#Adjective to] #Verb",group:0,tag:"Verb",reason:"adj-to"},{match:"[open] #Determiner",group:0,tag:"Infinitive",reason:"open-the"},{match:"[#PresentTense] (are|were|was) #Adjective",group:0,tag:"Plural",reason:"compromises-are-possible"},{match:"#Modal [".concat(va,"]"),group:0,tag:"Verb",reason:"would-mark"},{match:"#Adverb [".concat(va,"]"),group:0,tag:"Verb",reason:"really-mark"},{match:"(to|#Modal) [mark]",group:0,tag:"PresentTense",reason:"to-mark"},{match:"".concat(va," #Person"),tag:"Person",reason:"rob-smith"},{match:"".concat(va," #Acronym #ProperNoun"),tag:"Person",reason:"rob-a-smith"},{match:"[shit] (#Determiner|#Possessive|them)",group:0,tag:"Verb",reason:"swear1-verb"},{match:"[damn] (#Determiner|#Possessive|them)",group:0,tag:"Verb",reason:"swear2-verb"},{match:"[fuck] (#Determiner|#Possessive|them)",group:0,tag:"Verb",reason:"swear3-verb"}],U_=j_,H_=[{match:"(west|north|south|east|western|northern|southern|eastern)+ #Place",tag:"Region",reason:"west-norfolk"},{match:"#City [(al|ak|az|ar|ca|ct|dc|fl|ga|id|il|nv|nh|nj|ny|oh|pa|sc|tn|tx|ut|vt|pr)]",group:0,tag:"Region",reason:"us-state"},{match:"portland [or]",group:0,tag:"Region",reason:"portland-or"},{match:"#ProperNoun+ (district|region|province|county|prefecture|municipality|territory|burough|reservation)",tag:"Region",reason:"foo-district"},{match:"(district|region|province|municipality|territory|burough|state) of #ProperNoun",tag:"Region",reason:"district-of-Foo"},{match:"in [#ProperNoun] #Place",group:0,tag:"Place",reason:"propernoun-place"},{match:"#Value #Noun (st|street|rd|road|crescent|cr|way|tr|terrace|avenue|ave)",tag:"Address",reason:"address-st"}],K_=H_,W_=[{match:"#Noun (&|n) #Noun",tag:"Organization",reason:"Noun-&-Noun"},{match:"#Organization of the? #ProperNoun",tag:"Organization",reason:"org-of-place",safe:!0},{match:"#Organization #Country",tag:"Organization",reason:"org-country"},{match:"#ProperNoun #Organization",tag:"Organization",reason:"titlecase-org"},{match:"#ProperNoun (ltd|co|inc|dept|assn|bros)",tag:"Organization",reason:"org-abbrv"},{match:"the [#Acronym]",group:0,tag:"Organization",reason:"the-acronym",safe:!0},{match:"(world|global|international|national|#Demonym) #Organization",tag:"Organization",reason:"global-org"},{match:"#Noun+ (public|private) school",tag:"School",reason:"noun-public-school"}],dg="(".concat(Jr.personNoun.join("|"),")"),Vt="(".concat(Jr.personMonth.join("|"),")"),G_="(".concat(Jr.personPlace.join("|"),")"),Z_=[{match:"[(1st|2nd|first|second)] #Honorific",group:0,tag:"Honorific",reason:"ordinal-honorific"},{match:"[(private|general|major|corporal|lord|lady|secretary|premier)] #Honorific? #Person",group:0,tag:"Honorific",reason:"ambg-honorifics"},{match:"#Copula [(#Noun|#PresentTense)] #LastName",group:0,tag:"FirstName",reason:"copula-noun-lastname"},{match:"(lady|queen|sister) #ProperNoun",tag:"FemaleName",reason:"lady-titlecase",safe:!0},{match:"(king|pope|father) #ProperNoun",tag:"MaleName",reason:"pope-titlecase",safe:!0},{match:"[(will|may|april|june|said|rob|wade|ray|rusty|drew|miles|jack|chuck|randy|jan|pat|cliff|bill)] #LastName",group:0,tag:"FirstName",reason:"maybe-lastname"},{match:"#FirstName [#Determiner #Noun] #LastName",group:0,tag:"NickName",reason:"first-noun-last"},{match:"#Possessive [#FirstName]",group:0,tag:"Person",reason:"possessive-name"},{match:"#ProperNoun (b|c|d|e|f|g|h|j|k|l|m|n|o|p|q|r|s|t|u|v|w|x|y|z) #ProperNoun",tag:"Person",reason:"titlecase-acronym-titlecase",safe:!0},{match:"#Acronym #LastName",tag:"Person",reason:"acronym-latname",safe:!0},{match:"#Person (jr|sr|md)",tag:"Person",reason:"person-honorific"},{match:"#Person #Person the? #RomanNumeral",tag:"Person",reason:"roman-numeral"},{match:"#FirstName [/^[^aiurck]$/]",group:0,tag:["Acronym","Person"],reason:"john-e"},{match:"#Honorific #Person",tag:"Person",reason:"honorific-person"},{match:"#Honorific #Acronym",tag:"Person",reason:"Honorific-TitleCase"},{match:"#Noun van der? #Noun",tag:"Person",reason:"van der noun",safe:!0},{match:"(king|queen|prince|saint|lady) of #Noun",tag:"Person",reason:"king-of-noun",safe:!0},{match:"(prince|lady) #Place",tag:"Person",reason:"lady-place"},{match:"(king|queen|prince|saint) #ProperNoun",tag:"Person",reason:"saint-foo"},{match:"[#ProperNoun] #Person",group:0,tag:"Person",reason:"proper-person",safe:!0},{match:"al (#Person|#ProperNoun)",tag:"Person",reason:"al-borlen",safe:!0},{match:"#FirstName de #Noun",tag:"Person",reason:"bill-de-noun"},{match:"#FirstName (bin|al) #Noun",tag:"Person",reason:"bill-al-noun"},{match:"#FirstName #Acronym #ProperNoun",tag:"Person",reason:"bill-acronym-title"},{match:"#FirstName #FirstName #ProperNoun",tag:"Person",reason:"bill-firstname-title"},{match:"#Honorific #FirstName? #ProperNoun",tag:"Person",reason:"dr-john-Title"},{match:"#FirstName the #Adjective",tag:"Person",reason:"name-the-great"},{match:"#FirstName (green|white|brown|hall|young|king|hill|cook|gray|price)",tag:"Person",reason:"bill-green"},{match:"".concat(dg," #Person"),tag:"Person",reason:"ray-smith",safe:!0},{match:"".concat(dg," #Acronym? #ProperNoun"),tag:"Person",reason:"ray-a-smith",safe:!0},{match:"#Infinitive #Determiner? #Adjective? #Noun? (to|for) [".concat(Vt,"]"),group:0,tag:"Person",reason:"ambig-person"},{match:"#Infinitive [".concat(Vt,"]"),group:0,tag:"Person",reason:"infinitive-person"},{match:"[".concat(Vt,"] #Modal"),group:0,tag:"Person",reason:"ambig-modal"},{match:"[may] be",group:0,tag:"Verb",reason:"may-be"},{match:"#Modal [".concat(Vt,"]"),group:0,tag:"Person",reason:"modal-ambig"},{match:"#Copula [".concat(Vt,"]"),group:0,tag:"Person",reason:"is-may"},{match:"[".concat(Vt,"] #Copula"),group:0,tag:"Person",reason:"may-is"},{match:"that [".concat(Vt,"]"),group:0,tag:"Person",reason:"that-month"},{match:"with [".concat(Vt,"]"),group:0,tag:"Person",reason:"with-month"},{match:"for [".concat(Vt,"]"),group:0,tag:"Person",reason:"for-month"},{match:"this [".concat(Vt,"]"),group:0,tag:"Month",reason:"this-may"},{match:"next [".concat(Vt,"]"),group:0,tag:"Month",reason:"next-may"},{match:"last [".concat(Vt,"]"),group:0,tag:"Month",reason:"last-may"},{match:"#Date [".concat(Vt,"]"),group:0,tag:"Month",reason:"date-may"},{match:"[".concat(Vt,"] the? #Value"),group:0,tag:"Month",reason:"may-5th"},{match:"#Value of [".concat(Vt,"]"),group:0,tag:"Month",reason:"5th-of-may"},{match:"#ProperNoun (van|al|bin) #ProperNoun",tag:"Person",reason:"title-van-title",safe:!0},{match:"#ProperNoun (de|du) la? #ProperNoun",tag:"Person",reason:"title-de-title",safe:!0},{match:"#Singular #Acronym #LastName",tag:"#Person",reason:"title-acro-noun",safe:!0},{match:"#FirstName (#Noun && #ProperNoun) #ProperNoun?",tag:"Person",reason:"firstname-titlecase"},{match:"#FirstName #Acronym #Noun",tag:"Person",reason:"n-acro-noun",safe:!0},{match:"#FirstName [(de|di|du|van|von) #Person]",group:0,tag:"LastName",reason:"de-firstname"},{match:"[".concat(G_,"] (#ProperNoun && !#Place)"),group:0,tag:"FirstName",reason:"place-firstname"}],X_=Z_,ot=[];ot=ot.concat(E_);ot=ot.concat(L_);ot=ot.concat(k_);ot=ot.concat(F_);ot=ot.concat(z_);ot=ot.concat(q_);ot=ot.concat(U_);ot=ot.concat(K_);ot=ot.concat(W_);ot=ot.concat(X_);var J_=function(t){var e=[],n=[];return t.forEach(function(r){r.optional===!0||r.negative===!0||(r.tag!==void 0&&e.push(r.tag),r.word!==void 0&&n.push(r.word))}),{tags:ou(e),words:ou(n)}},Y_=function(t){var e=[],n=t.reg.filter(function(i){return i.fastOr!==void 0});if(n.length===1){var r=t.reg.findIndex(function(i){return i.fastOr!==void 0});Object.keys(t.reg[r].fastOr).forEach(function(i){var a=Object.assign({},t);a.reg=a.reg.slice(0),a.reg[r]=Object.assign({},a.reg[r]),a.reg[r].word=i,delete a.reg[r].operator,delete a.reg[r].fastOr,e.push(a)})}return e},fi=[];ot.forEach(function(l){l.reg=Tt(l.match);var t=Y_(l);t.length>0?fi=fi.concat(t):fi.push(l)});fi.forEach(function(l){return l.required=J_(l.reg),l});var Q_=fi,eA=function(t){if(t.length===0)return[];var e={};t.forEach(function(r){r=ou(r);for(var i=0;i<r.length;i++)e[r[i]]=e[r[i]]||0,e[r[i]]+=1});var n=Object.keys(e);return n=n.filter(function(r){return e[r]===t.length}),n=n.map(function(r){return Number(r)}),n},tA=function(t){Q_.forEach(function(e){var n=[];e.required.words.forEach(function(o){n.push(t._cache.words[o]||[])}),e.required.tags.forEach(function(o){n.push(t._cache.tags[o]||[])});var r=eA(n);if(r.length!==0){var i=r.map(function(o){return t.list[o]}),a=t.buildFrom(i),s=a.match(e.reg,e.group);s.found&&(e.safe===!0?s.tagSafe(e.tag,e.reason):s.tag(e.tag,e.reason))}})},rA=tA,nA=function(t){return rA(t),I_(t),t},iA=nA,aA=function(t){var e=t.termList();return t=vT(t,e),t=XT(t,e),t=S_(t),t.cache(),t=iA(t),t.uncache(),t.world.taggers.forEach(function(n){n(t)}),t},sA=aA,oA=function(t){var e=function(n){sr(i,n);var r=or(i);function i(){return St(this,i),r.apply(this,arguments)}return Zt(i,[{key:"stripPeriods",value:function(){return this.termList().forEach(function(s){s.tags.Abbreviation===!0&&s.next&&(s.post=s.post.replace(/^\./,""));var o=s.text.replace(/\./,"");s.set(o)}),this}},{key:"addPeriods",value:function(){return this.termList().forEach(function(s){s.post=s.post.replace(/^\./,""),s.post="."+s.post}),this}}]),i}(t);return e.prototype.unwrap=e.prototype.stripPeriods,t.prototype.abbreviations=function(n){var r=this.match("#Abbreviation");return typeof n=="number"&&(r=r.get(n)),new e(r.list,this,this.world)},t},lA=oA,uA=/\./,cA=function(t){var e=function(n){sr(i,n);var r=or(i);function i(){return St(this,i),r.apply(this,arguments)}return Zt(i,[{key:"stripPeriods",value:function(){return this.termList().forEach(function(s){var o=s.text.replace(/\./g,"");s.set(o)}),this}},{key:"addPeriods",value:function(){return this.termList().forEach(function(s){var o=s.text.replace(/\./g,"");o=o.split("").join("."),uA.test(s.post)===!1&&(o+="."),s.set(o)}),this}}]),i}(t);return e.prototype.unwrap=e.prototype.stripPeriods,e.prototype.strip=e.prototype.stripPeriods,t.prototype.acronyms=function(n){var r=this.match("#Acronym");return typeof n=="number"&&(r=r.get(n)),new e(r.list,this,this.world)},t},fA=cA,pA=function(t){return t.prototype.clauses=function(e){var n=this.if("@hasComma").notIf("@hasComma @hasComma").notIf("@hasComma . .? (and|or) .").notIf("(#City && @hasComma) #Country").notIf("(#WeekDay && @hasComma) #Date").notIf("(#Date && @hasComma) #Year").notIf("@hasComma (too|also)$").match("@hasComma"),r=this.splitAfter(n),i=r.quotations();r=r.splitOn(i);var a=r.parentheses();r=r.splitOn(a);var s=r.if("#Copula #Adjective #Conjunction (#Pronoun|#Determiner) #Verb").match("#Conjunction");r=r.splitBefore(s);var o=r.if("if .{2,9} then .").match("then");r=r.splitBefore(o),r=r.splitBefore("as well as ."),r=r.splitBefore("such as ."),r=r.splitBefore("in addition to ."),r=r.splitAfter("@hasSemicolon"),r=r.splitAfter("@hasDash");var u=r.filter(function(f){return f.wordCount()>5&&f.match("#Verb+").length>=2});if(u.found){var c=u.splitAfter("#Noun .* #Verb .* #Noun+");r=r.splitOn(c.eq(0))}return typeof e=="number"&&(r=r.get(e)),new t(r.list,this,this.world)},t},dA=pA,mA=function(t){var e=function(n){sr(i,n);var r=or(i);function i(a,s,o){var u;return St(this,i),u=r.call(this,a,s,o),u.contracted=null,u}return Zt(i,[{key:"expand",value:function(){return this.list.forEach(function(s){var o=s.terms(),u=o[0].isTitleCase();o.forEach(function(c,f){c.set(c.implicit||c.text),c.implicit=void 0,f<o.length-1&&c.post===""&&(c.post+=" ")}),u&&o[0].toTitleCase()}),this}}]),i}(t);return t.prototype.contractions=function(n){var r=this.match("@hasContraction+");return typeof n=="number"&&(r=r.get(n)),new e(r.list,this,this.world)},t.prototype.expanded=t.prototype.isExpanded,t.prototype.contracted=t.prototype.isContracted,t},hA=mA,vA=function(t){var e=function(i){var a=i.splitAfter("@hasComma").splitOn("(and|or) not?").not("(and|or) not?"),s=i.match("[.] (and|or)",0);return{things:a,conjunction:i.match("(and|or) not?"),beforeLast:s,hasOxford:s.has("@hasComma")}},n=function(r){sr(a,r);var i=or(a);function a(){return St(this,a),i.apply(this,arguments)}return Zt(a,[{key:"conjunctions",value:function(){return this.match("(and|or)")}},{key:"parts",value:function(){return this.splitAfter("@hasComma").splitOn("(and|or) not?")}},{key:"items",value:function(){return e(this).things}},{key:"add",value:function(o){return this.forEach(function(u){var c=e(u).beforeLast;c.append(o),c.termList(0).addPunctuation(",")}),this}},{key:"remove",value:function(o){return this.items().if(o).remove()}},{key:"hasOxfordComma",value:function(){return this.filter(function(o){return e(o).hasOxford})}},{key:"addOxfordComma",value:function(){var o=this.items(),u=o.eq(o.length-2);return u.found&&u.has("@hasComma")===!1&&u.post(", "),this}},{key:"removeOxfordComma",value:function(){var o=this.items(),u=o.eq(o.length-2);return u.found&&u.has("@hasComma")===!0&&u.post(" "),this}}]),a}(t);return n.prototype.things=n.prototype.items,t.prototype.lists=function(r){var i=this.if("@hasComma+ .? (and|or) not? ."),a=i.match("(#Noun|#Adjective|#Determiner|#Article)+ #Conjunction not? (#Article|#Determiner)? #Adjective? #Noun+").if("#Noun"),s=i.match("(#Adjective|#Adverb)+ #Conjunction not? #Adverb? #Adjective+"),o=i.match("(#Verb|#Adverb)+ #Conjunction not? #Adverb? #Verb+"),u=a.concat(s);return u=u.concat(o),u=u.if("@hasComma"),typeof r=="number"&&(u=i.get(r)),new n(u.list,this,this.world)},t},yA=vA,gA="(#Pronoun|#Place|#Value|#Person|#Uncountable|#Month|#WeekDay|#Holiday|#Possessive)",bA=function(t){return t.has("#Plural")===!0?!0:t.has(gA)!==!0},uu=bA,mg={hour:"an",heir:"an",heirloom:"an",honest:"an",honour:"an",honor:"an",uber:"an"},xA={a:!0,e:!0,f:!0,h:!0,i:!0,l:!0,m:!0,n:!0,o:!0,r:!0,s:!0,x:!0},hg=[/^onc?e/i,/^u[bcfhjkqrstn][aeiou]/i,/^eul/i],CA=function(t){if(t.has("#Person")||t.has("#Place"))return"";if(t.has("#Plural"))return"the";var e=t.text("normal").trim();if(mg.hasOwnProperty(e))return mg[e];var n=e.substr(0,1);if(t.has("^@isAcronym")&&xA.hasOwnProperty(n))return"an";for(var r=0;r<hg.length;r++)if(hg[r].test(e))return"a";return/^[aeiou]/i.test(e)?"an":"a"},vg=CA,NA=[/(antenn|formul|nebul|vertebr|vit)ae$/i,/(octop|vir|radi|nucle|fung|cact|stimul)i$/i,/men$/i,/.tia$/i,/(m|l)ice$/i],wA=[/(ax|test)is$/i,/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,/(octop|vir)i$/i,/(rl)f$/i,/(alias|status)$/i,/(bu)s$/i,/(al|ad|at|er|et|ed|ad)o$/i,/(ti)um$/i,/(ti)a$/i,/sis$/i,/(?:(^f)fe|(lr)f)$/i,/hive$/i,/(^aeiouy|qu)y$/i,/(x|ch|ss|sh|z)$/i,/(matr|vert|ind|cort)(ix|ex)$/i,/(m|l)ouse$/i,/(m|l)ice$/i,/(antenn|formul|nebul|vertebr|vit)a$/i,/.sis$/i,/^(?!talis|.*hu)(.*)man$/i],yg={isSingular:wA,isPlural:NA},TA=/s$/,_A=function(t){return yg.isSingular.find(function(e){return e.test(t)})?!1:TA.test(t)===!0||yg.isPlural.find(function(e){return e.test(t)})?!0:null},gg=_A,bg={he:"his",she:"hers",they:"theirs",we:"ours",i:"mine",you:"yours",her:"hers",their:"theirs",our:"ours",my:"mine",your:"yours"},AA=function(t){var e=t.text("text").trim();if(bg.hasOwnProperty(e)){t.replaceWith(bg[e],!0),t.tag("Possessive","toPossessive");return}if(/s$/.test(e)){e+="'",t.replaceWith(e,!0),t.tag("Possessive","toPossessive");return}e+="'s",t.replaceWith(e,!0),t.tag("Possessive","toPossessive")},$A=AA,SA=function(t){var e={main:t};if(t.has("#Noun (of|by|for) .")){var n=t.splitAfter("[#Noun+]",0);e.main=n.eq(0),e.post=n.eq(1)}return e},xg=SA,DA={json:function(t){var e=null;typeof t=="number"&&(e=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};var n=[];return this.forEach(function(r){var i=r.json(t)[0];i.article=vg(r),n.push(i)}),e!==null?n[e]:n},adjectives:function(){var t=this.lookAhead("^(that|who|which)? (was|is|will)? be? #Adverb? #Adjective+");return t=t.concat(this.lookBehind("#Adjective+ #Adverb?$")),t=t.match("#Adjective"),t.sort("index")},isPlural:function(){return this.if("#Plural")},hasPlural:function(){return this.filter(function(t){return uu(t)})},toPlural:function(t){var e=this,n=this.world.transforms.toPlural;return this.forEach(function(r){if(!(r.has("#Plural")||uu(r)===!1)){var i=xg(r).main,a=i.text("reduced");if(!(!i.has("#Singular")&&gg(a)===!0)&&(a=n(a,e.world),i.replace(a).tag("#Plural"),t)){var s=i.lookBefore("(an|a) #Adjective?$").not("#Adjective");s.found===!0&&s.remove()}}}),this},toSingular:function(t){var e=this,n=this.world.transforms.toSingular;return this.forEach(function(r){if(!(r.has("^#Singular+$")||uu(r)===!1)){var i=xg(r).main,a=i.text("reduced");if(!(!i.has("#Plural")&&gg(a)!==!0)&&(a=n(a,e.world),i.replace(a).tag("#Singular"),t)){var s=r,o=r.lookBefore("#Adjective");o.found&&(s=o);var u=vg(s);s.insertBefore(u)}}}),this},toPossessive:function(){return this.forEach(function(t){$A(t)}),this}},VA=DA,IA=function(t){var e=function(n){sr(i,n);var r=or(i);function i(){return St(this,i),r.apply(this,arguments)}return i}(t);return Object.assign(e.prototype,VA),t.prototype.nouns=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.match("(#City && @hasComma) (#Region|#Country)"),a=this.not(i).splitAfter("@hasComma");a=a.concat(i);var s=a.quotations();return s.found&&(a=a.splitOn(s.eq(0))),a=a.match("#Noun+ (of|by)? the? #Noun+?"),r.keep_anaphora!==!0&&(a=a.not("#Pronoun"),a=a.not("(there|these)"),a=a.not("(#Month|#WeekDay)"),a=a.not("(my|our|your|their|her|his)")),a=a.not("(of|for|by|the)$"),typeof n=="number"&&(a=a.get(n)),new e(a.list,this,this.world)},t},MA=IA,Cg=/\(/,Ng=/\)/,OA=function(t){var e=function(n){sr(i,n);var r=or(i);function i(){return St(this,i),r.apply(this,arguments)}return Zt(i,[{key:"unwrap",value:function(){return this.list.forEach(function(s){var o=s.terms(0);o.pre=o.pre.replace(Cg,"");var u=s.lastTerm();u.post=u.post.replace(Ng,"")}),this}}]),i}(t);return t.prototype.parentheses=function(n){var r=[];return this.list.forEach(function(i){for(var a=i.terms(),s=0;s<a.length;s+=1){var o=a[s];if(Cg.test(o.pre)){for(var u=s;u<a.length;u+=1)if(Ng.test(a[u].post)){var c=u-s+1;r.push(i.buildFrom(o.id,c)),s=u;break}}}}),typeof n=="number"?(r[n]?r=[r[n]]:r=[],new e(r,this,this.world)):new e(r,this,this.world)},t},EA=OA,PA=function(t){var e=function(n){sr(i,n);var r=or(i);function i(a,s,o){var u;return St(this,i),u=r.call(this,a,s,o),u.contracted=null,u}return Zt(i,[{key:"strip",value:function(){return this.list.forEach(function(s){var o=s.terms();o.forEach(function(u){var c=u.text.replace(/'s$/,"");u.set(c||u.text)})}),this}}]),i}(t);return t.prototype.possessives=function(n){var r=this.match("#Noun+? #Possessive");return typeof n=="number"&&(r=r.get(n)),new e(r.list,this,this.world)},t},LA=PA,wg={'"':'"',"\uFF02":"\uFF02","'":"'","\u201C":"\u201D","\u2018":"\u2019","\u201F":"\u201D","\u201B":"\u2019","\u201E":"\u201D","\u2E42":"\u201D","\u201A":"\u2019","\xAB":"\xBB","\u2039":"\u203A","\u2035":"\u2032","\u2036":"\u2033","\u2037":"\u2034","\u301D":"\u301E","`":"\xB4","\u301F":"\u301E"},Tg=RegExp("("+Object.keys(wg).join("|")+")"),RA=function(t){var e=function(n){sr(i,n);var r=or(i);function i(){return St(this,i),r.apply(this,arguments)}return Zt(i,[{key:"unwrap",value:function(){return this}}]),i}(t);return t.prototype.quotations=function(n){var r=[];return this.list.forEach(function(i){for(var a=i.terms(),s=0;s<a.length;s+=1){var o=a[s];if(Tg.test(o.pre)){for(var u=(o.pre.match(Tg)||[])[0],c=wg[u],f=s;f<a.length;f+=1)if(a[f].post.indexOf(c)!==-1){var p=f-s+1;r.push(i.buildFrom(o.id,p)),s=f;break}}}}),typeof n=="number"?(r[n]?r=[r[n]]:r=[],new e(r,this,this.world)):new e(r,this,this.world)},t.prototype.quotes=t.prototype.quotations,t},kA=RA,FA=function(t,e){var n=t.verb,r=n.text("reduced");if(n.has("#Infinitive"))return r;var i=null;return n.has("#PastTense")?i="PastTense":n.has("#Gerund")?i="Gerund":n.has("#PresentTense")?i="PresentTense":n.has("#Participle")?i="Participle":n.has("#Actor")&&(i="Actor"),e.transforms.toInfinitive(r,e,i)},pi=FA,BA=function(t){var e=t.lookBehind("#Noun+").last();return e},zA=function(t){var e=t.verb;if(e.has("(are|were|does)")||t.auxiliary.has("(are|were|does)"))return!0;if(e.has("(is|am|do|was)")||t.auxiliary.has("(is|am|do|was)"))return!1;var n=BA(e);return n.has("(we|they|you)")||n.has("#Plural")?!0:n.has("#Singular")?!1:null},di=zA,qA=function(t,e){var n=t.verb;if(!t.negative.found){if(t.auxiliary.found){t.auxiliary.eq(0).append("not"),t.auxiliary.has("#Modal have not")&&t.auxiliary.replace("have not","not have");return}if(n.has("(#Copula|will|has|had|do)")){n.append("not");return}if(n.has("#PastTense")){var r=pi(t,e);n.replaceWith(r,!0),n.prepend("did not");return}if(n.has("#PresentTense")){var i=pi(t,e);n.replaceWith(i,!0),di(t)?n.prepend("do not"):n.prepend("does not");return}if(n.has("#Gerund")){var a=pi(t,e);n.replaceWith(a,!0),n.prepend("not");return}if(di(t)){n.prepend("does not");return}n.prepend("do not")}},jA=qA,UA=function(t){var e=t.lookBehind(),n=e.nouns(null,{keep_anaphora:!0}).last();return n.found||(n=e.match("(that|this|each)").last(),n=n.tag("#Noun").nouns()),n},_g=UA,HA=function(t){var e={adverb:t.match("#Adverb+"),negative:t.match("#Negative"),auxiliary:t.match("#Auxiliary+").not("(#Negative|#Adverb)"),particle:t.match("#Particle"),verb:t.match("#Verb+").not("(#Adverb|#Negative|#Auxiliary|#Particle)"),original:t,subject:_g(t)};if(!e.verb.found)return Object.keys(e).forEach(function(r){e[r]=e[r].not(".")}),e.verb=t,e;if(e.adverb&&e.adverb.found){var n=e.adverb.text("reduced")+"$";t.has(n)&&(e.adverbAfter=!0)}return e},Bt=HA,KA=function(t){var e=!1,n=di(t),r=t.negative.found;t.verb.lookBehind("(i|we) (#Adverb|#Verb)?$").found&&(e=!0);var i={PastTense:"was",PresentTense:"is",FutureTense:"will be",Infinitive:"is",Gerund:"being",Actor:"",PerfectTense:"been",Pluperfect:"been"};return e===!0&&(i.PresentTense="am",i.Infinitive="am"),n&&(i.PastTense="were",i.PresentTense="are",i.Infinitive="are"),r&&(i.PastTense+=" not",i.PresentTense+=" not",i.FutureTense="will not be",i.Infinitive+=" not",i.PerfectTense="not "+i.PerfectTense,i.Pluperfect="not "+i.Pluperfect,i.Gerund="not "+i.Gerund),i},WA=KA,GA=function(t){var e=t.verb.text(),n={PastTense:e+" have",PresentTense:e,FutureTense:e,Infinitive:e};return n},ZA=GA,XA=function(t,e){var n=t.verb;if(n.has("#Copula")||n.out("normal")==="be"&&t.auxiliary.has("will"))return WA(t);if(t.auxiliary.has("are")&&n.has("#Gerund")){var r=t.original.clone(),i=r.clone().replace("are","were"),a=r.clone().replace("are","will be"),s=pi(t,e),o={PastTense:i.text(),PresentTense:r.text(),FutureTense:a.text(),Infinitive:s};return o}if(n.has("#Modal"))return ZA(t);var u=t.verb.termList(0).hasHyphen(),c=pi(t,e);if(!c)return{};var f=e.transforms.conjugate(c,e);if(f.Infinitive=c,t.particle.found){var p=t.particle.text(),d=u===!0?"-":" ";Object.keys(f).forEach(function(v){return f[v]+=d+p})}var m=t.negative.found;return m&&(f.PastTense="did not "+f.Infinitive,f.PresentTense="does not "+f.Infinitive,f.Gerund="not "+f.Gerund),f.FutureTense||(m?f.FutureTense="will not "+f.Infinitive:f.FutureTense="will "+f.Infinitive),m&&(f.Infinitive="not "+f.Infinitive),f},Lr=XA,JA=function(t){return!!(t.auxiliary.has("(could|should|would|may|can|must)")||t.auxiliary.has("am .+? being")||t.auxiliary.has("had .+? been"))},YA=function(t,e){if(!(t.auxiliary.has("(have|had)")&&t.verb.has("#Participle"))){var n=Lr(t,e),r=n.Participle||n.PastTense;r&&t.verb.replaceWith(r,!1),t.auxiliary.has("am .+? being")&&(t.auxiliary.remove("am"),t.auxiliary.replace("being","have been")),t.auxiliary.has("have")||t.auxiliary.append("have"),t.verb.tag("Participle","toParticiple"),t.auxiliary.replace("can","could"),t.auxiliary.replace("be have","have been"),t.auxiliary.replace("not have","have not"),t.auxiliary.tag("Auxiliary")}},Ag={useParticiple:JA,toParticiple:YA},$g=Ag.toParticiple,Sg=Ag.useParticiple,cu=function(t){return t.auxiliary.remove("(will|are|am|being)"),t.auxiliary.remove("(did|does)"),t.auxiliary.remove("(had|has|have)"),t.particle.remove(),t.negative.remove(),t},QA={json:function(t){var e=this,n=null;typeof t=="number"&&(n=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};var r=[];return this.forEach(function(i){var a=i.json(t)[0],s=Bt(i);a.parts={},Object.keys(s).forEach(function(o){s[o]&&s[o].isA==="Doc"?a.parts[o]=s[o].text("normal"):a.parts[o]=s[o]}),a.isNegative=i.has("#Negative"),a.conjugations=Lr(s,e.world),r.push(a)}),n!==null?r[n]:r},adverbs:function(){var t=[];this.forEach(function(n){var r=Bt(n).adverb;r.found&&(t=t.concat(r.list))});var e=this.lookBehind("#Adverb+$");return e.found&&(t=e.list.concat(t)),e=this.lookAhead("^#Adverb+"),e.found&&(t=t.concat(e.list)),this.buildFrom(t)},isPlural:function(){var t=this,e=[];return this.forEach(function(n){var r=Bt(n);di(r,t.world)===!0&&e.push(n.list[0])}),this.buildFrom(e)},isSingular:function(){var t=this,e=[];return this.forEach(function(n){var r=Bt(n);di(r,t.world)===!1&&e.push(n.list[0])}),this.buildFrom(e)},conjugate:function(){var t=this,e=[];return this.forEach(function(n){var r=Bt(n),i=Lr(r,t.world);e.push(i)}),e},toPastTense:function(){var t=this;return this.forEach(function(e){var n=Bt(e);if(Sg(n)){$g(n,t.world);return}if(!e.has("#Imperative")&&!(e.has("be")&&e.lookBehind("to$").found)){if(n.verb.has("#Gerund")&&n.auxiliary.has("(is|will|was)")){e.replace("is","was");return}var r=Lr(n,t.world).PastTense;r&&(n=cu(n),n.verb.replaceWith(r,!1))}}),this},toPresentTense:function(){var t=this;return this.forEach(function(e){var n=Bt(e),r=Lr(n,t.world),i=r.PresentTense;if(e.lookBehind("(i|we) (#Adverb|#Verb)?$").found&&(i=r.Infinitive),i){if(n.auxiliary.has("(have|had) been")){n.auxiliary.replace("(have|had) been","am being"),r.Particle&&(i=r.Particle||r.PastTense);return}n.verb.replaceWith(i,!1),n.verb.tag("PresentTense"),n=cu(n),n.auxiliary.remove("#Modal")}}),this},toFutureTense:function(){var t=this;return this.forEach(function(e){var n=Bt(e);if(!Sg(n)){var r=Lr(n,t.world).FutureTense;r&&(n=cu(n),n.auxiliary.remove("#Modal"),n.verb.replaceWith(r,!1),n.verb.tag("FutureTense"))}}),this},toInfinitive:function(){var t=this;return this.forEach(function(e){var n=Bt(e),r=Lr(n,t.world).Infinitive;r&&(e.replaceWith(r,!1),e.tag("Infinitive"))}),this},toGerund:function(){var t=this;return this.forEach(function(e){var n=Bt(e),r=Lr(n,t.world).Gerund;r&&(e.replaceWith(r,!1),e.tag("Gerund"))}),this},toParticiple:function(){var t=this;return this.forEach(function(e){var n=Bt(e),r=!n.auxiliary.found;$g(n,t.world),r&&(n.verb.prepend(n.auxiliary.text()),n.auxiliary.remove())}),this},isNegative:function(){return this.if("#Negative")},isPositive:function(){return this.ifNo("#Negative")},isImperative:function(){return this.if("#Imperative")},toNegative:function(){var t=this;return this.list.forEach(function(e){var n=t.buildFrom([e]),r=Bt(n);jA(r,n.world)}),this},toPositive:function(){var t=this.match("do not #Verb");return t.found&&t.remove("do not"),this.remove("#Negative")},subject:function(){var t=[];return this.forEach(function(e){var n=_g(e);n.list[0]&&t.push(n.list[0])}),this.buildFrom(t)}},e2=function(t){var e=function(n){sr(i,n);var r=or(i);function i(){return St(this,i),r.apply(this,arguments)}return i}(t);return Object.assign(e.prototype,QA),e.prototype.negate=e.prototype.toNegative,t.prototype.verbs=function(n){var r=this.match("(#Adverb|#Auxiliary|#Verb|#Negative|#Particle)+");r=r.not("^#Adverb+"),r=r.not("#Adverb+$");var i=r.match("(#Adverb && @hasComma) #Adverb"),a=r.not(i).splitAfter("@hasComma"),s=a.match("#PastTense #Gerund");s.has("(been|am|#Auxiliary) #Gerund")||(a=a.splitBefore(s.match("#Gerund"))),a=a.concat(i),a.sort("index"),a=a.if("#Verb"),a.has("(is|was)$")&&(a=a.splitBefore("(is|was)$")),a.has("#PresentTense #Adverb #PresentTense")&&(a=a.splitBefore("#Adverb #PresentTense")),typeof n=="number"&&(a=a.get(n));var o=new e(a.list,this,this.world);return o},t},t2=e2,r2=function(t){var e=function(n){sr(i,n);var r=or(i);function i(){return St(this,i),r.apply(this,arguments)}return i}(t);return t.prototype.people=function(n){var r=this.splitAfter("@hasComma");return r=r.match("#Person+"),typeof n=="number"&&(r=r.get(n)),new e(r.list,this,this.world)},t},n2=r2,i2=[lA,fA,dA,hA,yA,MA,EA,LA,kA,t2,n2],a2=function(t){return Object.keys(nu).forEach(function(e){return t.prototype[e]=nu[e]}),i2.forEach(function(e){return e(t)}),t},s2=a2,Dg={misc:Ww,selections:nu},Tr=function(){function l(t,e,n){var r=this;St(this,l),this.list=t,Object.defineProperty(this,"from",{enumerable:!1,value:e,writable:!0}),n===void 0&&e!==void 0&&(n=e.world),Object.defineProperty(this,"world",{enumerable:!1,value:n,writable:!0}),Object.defineProperty(this,"_cache",{enumerable:!1,writable:!0,value:{}}),Object.defineProperty(this,"found",{get:function(){return r.list.length>0}}),Object.defineProperty(this,"length",{get:function(){return r.list.length}}),Object.defineProperty(this,"isA",{get:function(){return"Doc"}})}return Zt(l,[{key:"tagger",value:function(){return sA(this)}},{key:"pool",value:function(){return this.list.length>0?this.list[0].pool:this.all().list[0].pool}}]),l}();Tr.prototype.buildFrom=function(l){l=l.map(function(e){return e.clone(!0)});var t=new Tr(l,this,this.world);return t};Tr.prototype.fromText=function(l){var t=br(l,this.world,this.pool());return this.buildFrom(t)};Object.assign(Tr.prototype,Dg.misc);Object.assign(Tr.prototype,Dg.selections);s2(Tr);var Vg={untag:"unTag",and:"match",notIf:"ifNo",only:"if",onlyIf:"if"};Object.keys(Vg).forEach(function(l){return Tr.prototype[l]=Tr.prototype[Vg[l]]});var ya=Tr,o2=function(t){var e=t.termList();return iu(e,t.world),t.world.taggers.forEach(function(n){n(t)}),t},l2=o2;function Ig(l){var t=l,e=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0;i&&t.addWords(i);var a=br(r,t),s=new ya(a,null,t);return s.tagger(),s};return e.tokenize=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,i=t;r&&(i=i.clone(),i.words={},i.addWords(r));var a=br(n,i),s=new ya(a,null,i);return(r||s.world.taggers.length>0)&&l2(s),s},e.extend=function(n){return n(ya,t,this,Ul,ql,Kl),this},e.fromJSON=function(n){var r=wC(n,t);return new ya(r,null,t)},e.clone=function(){return Ig(t.clone())},e.verbose=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return t.verbose(n),this},e.world=function(){return t},e.parseMatch=function(n,r){return Tt(n,r)},e.version=TC,e.import=e.load,e.plugin=e.extend,e}var u2=Ig(new EN),ga=u2;function ba(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function xa(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),t&&fu(l,t)}function Ca(l){return Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ca(l)}function fu(l,t){return fu=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},fu(l,t)}function c2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(l){return!1}}function f2(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function p2(l,t){return t&&(typeof t=="object"||typeof t=="function")?t:f2(l)}function Na(l){var t=c2();return function(){var n=Ca(l),r;if(t){var i=Ca(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p2(this,r)}}var d2=function(t,e){var n=t.match("#Value+? #Money+ #Currency+ (and #Money+ #Currency+)+?");return t.match("#Money").forEach(function(r){r.lookAfter("#Currency").found||(n=n.concat(r))}),typeof e=="number"&&(n=n.get(e)),n},m2=d2,h2="one|two|three|four|five|six|seven|eight|nine",Rr="twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety|fourty",v2="eleven|twelve|thirteen|fourteen|fifteen|sixteen|seventeen|eighteen|nineteen",y2=function(t,e){var n=t.match("#Value+");if(n.has("#NumericValue #NumericValue")&&(n.has("#Value @hasComma #Value")?n.splitAfter("@hasComma"):n.has("#NumericValue #Fraction")?n.splitAfter("#NumericValue #Fraction"):n=n.splitAfter("#NumericValue")),n.has("#Value #Value #Value")&&!n.has("#Multiple")&&n.has("("+Rr+") #Cardinal #Cardinal")&&(n=n.splitAfter("("+Rr+") #Cardinal")),n.has("#Value #Value")){n.has("#NumericValue #NumericValue")&&(n=n.splitOn("#Year")),n.has("("+Rr+") ("+v2+")")&&(n=n.splitAfter("("+Rr+")"));var r=n.match("#Cardinal #Cardinal");if(r.found&&!n.has("(point|decimal|#Fraction)")&&!r.has("#Cardinal (#Multiple|point|decimal)")){var i=n.has("(".concat(h2,") (").concat(Rr,")")),a=r.has("("+Rr+") #Cardinal"),s=r.has("#Multiple #Value");!i&&!a&&!s&&r.terms().forEach(function(o){n=n.splitOn(o)})}n.match("#Ordinal #Ordinal").match("#TextValue").found&&!n.has("#Multiple")&&(n.has("("+Rr+") #Ordinal")||(n=n.splitAfter("#Ordinal"))),n.has("#Ordinal #Cardinal")&&(n=n.splitBefore("#Cardinal+")),n.has("#TextValue #NumericValue")&&!n.has("("+Rr+"|#Multiple)")&&(n=n.splitBefore("#NumericValue+"))}return n.has("#NumberRange")&&(n=n.splitAfter("#NumberRange")),typeof e=="number"&&(n=n.get(e)),n},g2=y2,b2=function(t,e){var n=t.match("#Fraction+");return n=n.filter(function(r){return!r.lookBehind("#Value and$").found}),typeof e=="number"&&(n=n.eq(e)),n},x2=b2,C2=function(t,e){var n=t.match("#Percent+");return n=n.concat(t.match("[#Cardinal] percent",0)),typeof e=="number"&&(n=n.eq(e)),n},N2=C2,w2=function(t){for(var e=[{reg:/^(minus|negative)[\s\-]/i,mult:-1},{reg:/^(a\s)?half[\s\-](of\s)?/i,mult:.5}],n=0;n<e.length;n++)if(e[n].reg.test(t)===!0)return{amount:e[n].mult,str:t.replace(e[n].reg,"")};return{amount:1,str:t}},T2=w2,ft={ones:{zeroth:0,first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9,zero:0,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9},teens:{tenth:10,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19},tens:{twentieth:20,thirtieth:30,fortieth:40,fourtieth:40,fiftieth:50,sixtieth:60,seventieth:70,eightieth:80,ninetieth:90,twenty:20,thirty:30,forty:40,fourty:40,fifty:50,sixty:60,seventy:70,eighty:80,ninety:90},multiples:{hundredth:100,thousandth:1e3,millionth:1e6,billionth:1e9,trillionth:1e12,quadrillionth:1e15,quintillionth:1e18,sextillionth:1e21,septillionth:1e24,hundred:100,thousand:1e3,million:1e6,billion:1e9,trillion:1e12,quadrillion:1e15,quintillion:1e18,sextillion:1e21,septillion:1e24,grand:1e3}},_2=function(t,e){if(ft.ones.hasOwnProperty(t)){if(e.ones||e.teens)return!1}else if(ft.teens.hasOwnProperty(t)){if(e.ones||e.teens||e.tens)return!1}else if(ft.tens.hasOwnProperty(t)&&(e.ones||e.teens||e.tens))return!1;return!0},A2=_2,$2=function(t){for(var e="0.",n=0;n<t.length;n++){var r=t[n];if(ft.ones.hasOwnProperty(r)===!0)e+=ft.ones[r];else if(ft.teens.hasOwnProperty(r)===!0)e+=ft.teens[r];else if(ft.tens.hasOwnProperty(r)===!0)e+=ft.tens[r];else if(/^[0-9]$/.test(r)===!0)e+=r;else return 0}return parseFloat(e)},S2=$2,D2=function(t){return t=t.replace(/1st$/,"1"),t=t.replace(/2nd$/,"2"),t=t.replace(/3rd$/,"3"),t=t.replace(/([4567890])r?th$/,"$1"),t=t.replace(/^[$]/,""),t=t.replace(/[%$]$/,""),t=t.replace(/,/g,""),t=t.replace(/([0-9])([a-z\u00C0-\u00FF]{1,2})$/,"$1"),t},V2=D2,I2=/^([0-9,\. ]+)\/([0-9,\. ]+)$/,Mg={"a few":3,"a couple":2,"a dozen":12,"two dozen":24,zero:0},wa=function(t){return Object.keys(t).reduce(function(e,n){return e+=t[n],e},0)},M2=function(t){if(Mg.hasOwnProperty(t)===!0)return Mg[t];if(t==="a"||t==="an")return 1;var e=T2(t);t=e.str;for(var n=null,r={},i=0,a=!1,s=t.split(/[ -]/),o=0;o<s.length;o++){var u=s[o];if(u=V2(u),!(!u||u==="and")){if(u==="-"||u==="negative"){a=!0;continue}if(u.charAt(0)==="-"&&(a=!0,u=u.substr(1)),u==="point")return i+=wa(r),i+=S2(s.slice(o+1,s.length)),i*=e.amount,i;var c=u.match(I2);if(c){var f=parseFloat(c[1].replace(/[, ]/g,"")),p=parseFloat(c[2].replace(/[, ]/g,""));p&&(i+=f/p||0);continue}if(ft.tens.hasOwnProperty(u)&&r.ones&&Object.keys(r).length===1&&(i=r.ones*100,r={}),A2(u,r)===!1)return null;if(/^[0-9\.]+$/.test(u))r.ones=parseFloat(u);else if(ft.ones.hasOwnProperty(u)===!0)r.ones=ft.ones[u];else if(ft.teens.hasOwnProperty(u)===!0)r.teens=ft.teens[u];else if(ft.tens.hasOwnProperty(u)===!0)r.tens=ft.tens[u];else if(ft.multiples.hasOwnProperty(u)===!0){var d=ft.multiples[u];if(d===n)return null;if(d===100&&s[o+1]!==void 0){var m=s[o+1];ft.multiples[m]&&(d*=ft.multiples[m],o+=1)}n===null||d<n?(i+=(wa(r)||1)*d,n=d,r={}):(i+=wa(r),n=d,i=(i||1)*d,r={})}}}return i+=wa(r),i*=e.amount,i*=a?-1:1,i===0&&Object.keys(r).length===0?null:i},Ta=M2,Og=/s$/,mi=function(t){var e=t.text("reduced");return Ta(e)},_a={half:2,halve:2,quarter:4},O2=function(t){var e=t.text("reduced"),n=e.match(/^([-+]?[0-9]+)\/([-+]?[0-9]+)(st|nd|rd|th)?s?$/);return n&&n[1]&&n[0]?{numerator:Number(n[1]),denominator:Number(n[2])}:null},E2=function(t){var e=t.match("[<num>#Value+] out of every? [<den>#Value+]");if(e.found!==!0)return null;var n=e.groups(),r=n.num,i=n.den;return r=mi(r),i=mi(i),typeof r=="number"&&typeof i=="number"?{numerator:r,denominator:i}:null},P2=function(t){var e=t.match("[<num>(#Cardinal|a)+] [<dem>#Fraction+]");if(e.found!==!0)return null;var n=e.groups(),r=n.num,i=n.dem;r.has("a")?r=1:r=mi(r);var a=i.text("reduced");return Og.test(a)&&(a=a.replace(Og,""),i.replaceWith(a)),_a.hasOwnProperty(a)?i=_a[a]:i=mi(i),typeof r=="number"&&typeof i=="number"?{numerator:r,denominator:i}:null},L2=function(t){var e=t.match("^#Ordinal$");if(e.found!==!0)return null;if(t.lookAhead("^of .")){var n=mi(e);return{numerator:1,denominator:n}}return null},R2=function(t){var e=t.text("reduced");return _a.hasOwnProperty(e)?{numerator:1,denominator:_a[e]}:null},k2=function(t){var e=Math.round(t*1e3)/1e3;return e===0&&t!==0?t:e},F2=function(t){t=t.clone();var e=R2(t)||O2(t)||E2(t)||P2(t)||L2(t)||null;return e!==null&&e.numerator&&e.denominator&&(e.decimal=e.numerator/e.denominator,e.decimal=k2(e.decimal)),e},Yr=F2,B2=function(t,e,n){t=t.replace(/,/g,"");var r=t.split(/^([^0-9]*)([0-9.,]*)([^0-9]*)$/);if(r&&r[2]&&e.terms().length<2){var i=parseFloat(r[2]||t);typeof i!="number"&&(i=null);var a=r[3]||"";return(a==="st"||a==="nd"||a==="rd"||a==="th")&&(a=""),(a==="m"||a==="M")&&(i*=1e6,a=""),(a==="k"||a==="k")&&(i*=1e3,a=""),i=n?1/i:i,{prefix:r[1]||"",num:i,suffix:a}}return null},z2=function(t){var e=t.text("reduced"),n=/[0-9],[0-9]/.test(t.text("text")),r=B2(e,t);if(r!==null)return r.hasComma=n,r;var i=t.match("#Fraction #Fraction+$");i=i.found===!1?t.match("^#Fraction$"):i;var a=null;i.found&&(a=Yr(i),t=t.not(i),t=t.not("and$"),e=t.text("reduced"));var s=0;return e&&(s=Ta(e)||0),a&&a.decimal&&(s+=a.decimal),{hasComma:n,prefix:"",num:s,suffix:""}},xt=z2,q2=function(t,e,n){if(t!==!1){var r=e.lookAhead("^(#Unit|#Noun)");r.has("(#Address|#Money|#Percent)")||e.has("#Ordinal")||(n.num===1?r.nouns().toSingular():r.has("#Singular")&&r.nouns().toPlural())}},pu=q2,j2=function(t){if(t<1e6)return String(t);var e;return typeof t=="number"?e=t.toFixed(0):e=t,e.indexOf("e+")===-1?e:e.replace(".","").split("e+").reduce(function(n,r){return n+Array(r-n.length+2).join(0)})},Aa=j2,$a=[["ninety",90],["eighty",80],["seventy",70],["sixty",60],["fifty",50],["forty",40],["thirty",30],["twenty",20]],Eg=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],U2=[[1e24,"septillion"],[1e20,"hundred sextillion"],[1e21,"sextillion"],[1e20,"hundred quintillion"],[1e18,"quintillion"],[1e17,"hundred quadrillion"],[1e15,"quadrillion"],[1e14,"hundred trillion"],[1e12,"trillion"],[1e11,"hundred billion"],[1e9,"billion"],[1e8,"hundred million"],[1e6,"million"],[1e5,"hundred thousand"],[1e3,"thousand"],[100,"hundred"],[1,"one"]],H2=function(t){var e=t,n=[];return U2.forEach(function(r){if(t>=r[0]){var i=Math.floor(e/r[0]);e-=i*r[0],i&&n.push({unit:r[1],count:i})}}),n},K2=function(t){var e=[];if(t>100)return e;for(var n=0;n<$a.length;n++)t>=$a[n][1]&&(t-=$a[n][1],e.push($a[n][0]));return Eg[t]&&e.push(Eg[t]),e},W2=function(t){var e=["zero","one","two","three","four","five","six","seven","eight","nine"],n=[],r=Aa(t),i=r.match(/\.([0-9]+)/);if(!i||!i[0])return n;n.push("point");for(var a=i[0].split(""),s=0;s<a.length;s++)n.push(e[a[s]]);return n},G2=function(t){if(t===0||t==="0")return"zero";t>1e21&&(t=Aa(t));var e=[];t<0&&(e.push("minus"),t=Math.abs(t));for(var n=H2(t),r=0;r<n.length;r++){var i=n[r].unit;i==="one"&&(i="",e.length>1&&e.push("and")),e=e.concat(K2(n[r].count)),e.push(i)}return e=e.concat(W2(t)),e=e.filter(function(a){return a}),e.length===0&&(e[0]=""),e.join(" ")},hi=G2,Z2=function(t){if(!t&&t!==0)return null;var e=t%100;if(e>10&&e<20)return String(t)+"th";var n={0:"th",1:"st",2:"nd",3:"rd"},r=Aa(t),i=r.slice(r.length-1,r.length);return n[i]?r+=n[i]:r+="th",r},X2=Z2,Pg={one:"first",two:"second",three:"third",five:"fifth",eight:"eighth",nine:"ninth",twelve:"twelfth",twenty:"twentieth",thirty:"thirtieth",forty:"fortieth",fourty:"fourtieth",fifty:"fiftieth",sixty:"sixtieth",seventy:"seventieth",eighty:"eightieth",ninety:"ninetieth"},J2=function(t){var e=hi(t).split(" "),n=e[e.length-1];return Pg.hasOwnProperty(n)?e[e.length-1]=Pg[n]:e[e.length-1]=n.replace(/y$/,"i")+"th",e.join(" ")},Lg=J2,Y2={"\xA2":"cents",$:"dollars","\xA3":"pounds","\xA5":"yen","\u20AC":"euros","\u20A1":"col\xF3n","\u0E3F":"baht","\u20AD":"kip","\u20A9":"won","\u20B9":"rupees","\u20BD":"ruble","\u20BA":"liras"},Q2={"%":"percent",s:"seconds",cm:"centimetres",km:"kilometres"},Rg={prefixes:Y2,suffixes:Q2},kg=Rg.prefixes,Fg=Rg.suffixes,e$={usd:!0,eur:!0,jpy:!0,gbp:!0,cad:!0,aud:!0,chf:!0,cny:!0,hkd:!0,nzd:!0,kr:!0,rub:!0},Bg=function(t){return kg.hasOwnProperty(t.prefix)&&(t.suffix+=kg[t.prefix],t.prefix=""),Fg.hasOwnProperty(t.suffix)&&(t.suffix=Fg[t.suffix]),e$.hasOwnProperty(t.suffix)&&(t.suffix=t.suffix.toUpperCase()),t.suffix&&(t.suffix=" "+t.suffix),t},t$=function(t,e,n){var r=String(t.num);return e?(t=Bg(t),n?(r=Lg(r),"".concat(t.prefix||"").concat(r).concat(t.suffix||"")):(r=hi(r),"".concat(t.prefix||"").concat(r).concat(t.suffix||""))):n?(r=X2(r),t=Bg(t),"".concat(t.prefix||"").concat(r).concat(t.suffix||"")):(t.hasComma===!0&&(r=t.num.toLocaleString()),r=Aa(r),"".concat(t.prefix||"").concat(r).concat(t.suffix||""))},zt=t$,Jt={json:function(t){var e=null;typeof t=="number"&&(e=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};var n=[];return this.forEach(function(r){var i=r.json(t)[0],a=xt(r);i.prefix=a.prefix,i.number=a.num,i.suffix=a.suffix,i.cardinal=zt(a,!1,!1),i.ordinal=zt(a,!1,!0),i.textCardinal=zt(a,!0,!1),i.textOrdinal=zt(a,!0,!0),n.push(i)}),e!==null?n[e]:n},units:function(){var t=this.lookAhead("(#Unit|#Noun)+");return t=t.splitAfter("@hasComma").first(),t=t.not("#Pronoun"),t.first()},isOrdinal:function(){return this.if("#Ordinal")},isCardinal:function(){return this.if("#Cardinal")},toNumber:function(){return this.forEach(function(t){var e=xt(t);if(e.num!==null){var n=zt(e,!1,t.has("#Ordinal"));t.replaceWith(n,!0),t.tag("NumericValue")}}),this},toLocaleString:function(){return this.forEach(function(t){var e=xt(t);if(e.num!==null){e.num=e.num.toLocaleString();var n=zt(e,!1,t.has("#Ordinal"));t.replaceWith(n,!0)}}),this},toText:function(){return this.forEach(function(t){var e=xt(t);if(e.num!==null){var n=zt(e,!0,t.has("#Ordinal"));t.replaceWith(n,!0),t.tag("TextValue")}}),this},toCardinal:function(t){var e=this.if("#Ordinal");return e.forEach(function(n){var r=xt(n);if(r.num!==null){var i=zt(r,n.has("#TextValue"),!1);if(n.has("#NumberRange")){var a=n.termList()[0];a.text&&a.post===""&&(a.post=" ")}n.replaceWith(i,!0),n.tag("Cardinal"),pu(t,n,r)}}),this},toOrdinal:function(){var t=this,e=this.if("#Cardinal");return e.forEach(function(n){var r=xt(n);if(r.num!==null){var i=zt(r,n.has("#TextValue"),!0);if(n.has("#NumberRange")){var a=n.termList()[0];a.text&&a.post===""&&(a.post=" ")}n.replaceWith(i,!0),n.tag("Ordinal");var s=t.lookAhead("^#Plural");s.found&&s.nouns().toSingular()}}),this},isEqual:function(t){return this.filter(function(e){var n=xt(e).num;return n===t})},greaterThan:function(t){return this.filter(function(e){var n=xt(e).num;return n>t})},lessThan:function(t){return this.filter(function(e){var n=xt(e).num;return n<t})},between:function(t,e){return this.filter(function(n){var r=xt(n).num;return r>t&&r<e})},set:function(t,e){return t===void 0?this:(typeof t=="string"&&(t=Ta(t)),this.forEach(function(n){var r=xt(n);if(r.num=t,r.num!==null){var i=zt(r,n.has("#TextValue"),n.has("#Ordinal"));n=n.not("#Currency"),n.replaceWith(i,!0),pu(e,n,r)}}),this)},add:function(t,e){return t?(typeof t=="string"&&(t=Ta(t)),this.forEach(function(n){var r=xt(n);if(r.num!==null){r.num+=t;var i=zt(r,n.has("#TextValue"),n.has("#Ordinal"));n=n.not("#Currency"),n.replaceWith(i,!0),pu(e,n,r)}}),this):this},subtract:function(t,e){return this.add(t*-1,e)},increment:function(t){return this.add(1,t),this},decrement:function(t){return this.add(-1,t),this},romanNumerals:function(t){var e=this.match("#RomanNumeral").numbers();return typeof t=="number"&&(e=e.get(t)),e},normalize:function(){var t={"%":!0};return this.forEach(function(e){var n=xt(e);if(n.num!==null&&n.suffix&&t[n.suffix]!==!0){var r=n.prefix||"";e=e.replaceWith(r+n.num+" "+n.suffix);return}}),this},get:function(t){var e=[];return this.forEach(function(n){e.push(xt(n).num)}),t!==void 0?e[t]||null:e||null}};Jt.toNice=Jt.toLocaleString;Jt.isBetween=Jt.between;Jt.minus=Jt.subtract;Jt.plus=Jt.add;Jt.equals=Jt.isEqual;var r$=Jt,du=function(t){var e=xt(t).num;return typeof e=="number"?e/100:null},n$={get:function(t){var e=[];return this.forEach(function(n){var r=du(n);r!==null&&e.push(r)}),t!==void 0?e[t]||null:e||null},json:function(t){var e=null;typeof t=="number"&&(e=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};var n=[];return this.forEach(function(r){var i=r.json(t)[0],a=du(r);if(i.number=a,a!==null){var s=a*100;i.textNumber="".concat(s," percent"),i.cardinal="".concat(s,"%")}n.push(i)}),e!==null?n[e]||{}:n},toFraction:function(){var t=this;return this.forEach(function(e){var n=du(e);if(n!==null){n*=100,n=Math.round(n*100)/100;var r="".concat(n,"/100");t.replace(e,r)}}),this}},vi=[{dem:"american",name:"dollar",iso:"usd",sub:"cent",sym:["$","US$","U$"]},{name:"euro",iso:"eur",sub:"cent",sym:["\u20AC"]},{dem:"british",name:"pound",iso:"gbp",sub:"penny",alias:{sterling:!0},sym:["\xA3"]},{name:"renminbi",iso:"cny",plural:"yu\xE1n",alias:{yuan:!0},sym:["\u5143"]},{dem:"japanese",name:"yen",iso:"jpy",sub:"sen",sym:["\xA5","\u5186","\u5713"]},{dem:"swedish",name:"krona",iso:"sek",sub:"\xF6re",alias:{ore:!0,kronor:!0},sym:["kr"]},{dem:"estonian",name:"kroon",iso:"eek",sub:"sent",sym:["kr"]},{dem:"norwegian",name:"krone",iso:"nok",sub:"\xF8re",sym:["kr"]},{dem:"icelandic",name:"kr\xF3na",iso:"isk",sym:["kr"]},{dem:"danish",name:"krone",iso:"dkk",sub:"\xF8re",sym:["kr."]},{dem:"zambian",name:"kwacha",iso:"zmw",sub:"ngwee",sym:["K"]},{dem:"malawian",name:"kwacha",iso:"mwk",sub:"tambala",sym:["K"]},{dem:"greek",name:"drachma",iso:"grd",sub:"lept\u03BFn",sym:["\u0394\u03C1\u03C7.","\u0394\u03C1.","\u20AF"]},{dem:"eastern caribbean",name:"dollar",iso:"xcd",sub:"cent",sym:["$"]},{dem:"finnish",name:"markka",iso:"fim",sub:"penni",sym:["mk"]},{dem:"polish",name:"z\u0142oty",iso:"pln",sub:"grosz",sym:["z\u0142"]},{dem:"slovenian",name:"tolar",iso:"sit",sub:"stotin",sym:[]},{dem:"australian",name:"dollar",iso:"aud",sub:"cent",sym:["$","A$","AU$"]},{dem:"deutsche",name:"mark",iso:"dem",sub:"pfennig",sym:["DM"]},{dem:"thai",name:"baht",iso:"thb",sub:"satang",sym:["\u0E3F"]},{dem:"canadian",name:"dollar",iso:"cad",sub:"cent",sym:["$","Can$","C$","CA$","CAD"]},{dem:"mexican",name:"peso",iso:"mxn",sub:"centavo",sym:["$","Mex$"]},{dem:"spanish",name:"peseta",iso:"esp",sub:"c\xE9ntimo",sym:["Pta"]},{dem:"new zealand",name:"dollar",iso:"nzd",sub:"cent",sym:["$","NZ$"]},{dem:"chilean",name:"peso",iso:"clp",sub:"centavo",sym:["Cifr\xE3o","$"]},{dem:"nigerian",name:"naira",iso:"ngn",sub:"kobo",sym:["\u20A6"]},{dem:"austrian",name:"schilling",iso:"ats",sub:"groschen",sym:["S","\xF6S"]},{dem:"guatemalan",name:"quetzal",iso:"gtq",sub:"centavo",sym:["Q"]},{dem:"philippine",name:"peso",iso:"php",sub:"sentimo",sym:["\u20B1"]},{dem:"hungarian",name:"forint",iso:"huf",sym:["Ft"]},{dem:"russian",name:"ruble",iso:"rub",sub:"kopeyka",sym:["\u20BD","\u0440\u0443\u0431","\u0440."]},{dem:"kuwaiti",name:"dinar",iso:"kwd",sub:"fils",sym:["\u062F.\u0643","KD"]},{dem:"israeli",name:"new shekel",iso:"ils",sub:"agora",sym:["\u20AA"]},{dem:"latvian",name:"lats",iso:"lvl",sub:"sant\u012Bms",sym:["Ls"]},{dem:"kazakhstani",name:"tenge",iso:"kzt",sub:"t\u0131yn",sym:["\u20B8"]},{dem:"iraqi",name:"dinar",iso:"iqd",sub:"fils",sym:["\u062F.\u0639"]},{dem:"bahamian",name:"dollar",iso:"bsd",sub:"cent",sym:["$","B$"]},{dem:"seychellois",name:"rupee",iso:"scr",sub:"cent",sym:["SCR","SR"]},{dem:"albanian",name:"lek",iso:"all",sub:"qindark\xEB",sym:["L"]},{dem:"bulgarian",name:"lev",iso:"bgn",sub:"stotinka",sym:["\u043B\u0432."]},{dem:"irish",name:"pound",iso:"iep",sym:["\xA3","IR\xA3"]},{name:"cfp franc",iso:"xpf",sym:["f"]},{dem:"south african",name:"rand",iso:"zar",sub:"cent",sym:["R"]},{dem:"south korean",name:"won",iso:"krw",sub:"jeon",plural:"won",sym:["\u20A9"]},{dem:"north korean",name:"won",iso:"kpw",sub:"chon",plural:"won",sym:["\u20A9"]},{dem:"portuguese",name:"escudo",iso:"pte",sub:"centavo",sym:[]},{dem:"ghanaian",name:"cedi",iso:"ghs",sub:"pesewa",sym:["GH\u20B5"]},{dem:"hong kong",name:"dollar",iso:"hkd",sub:"\u6BEB",sym:["$"]},{dem:"new taiwan",name:"dollar",iso:"twd",sub:"dime",sym:["NT$"]},{dem:"east german",name:"mark",iso:"ddm",sub:"pfennig",sym:["M"]},{dem:"namibian",name:"dollar",iso:"nad",sub:"cent",sym:["$"]},{dem:"malaysian",name:"ringgit",iso:"myr",sub:"sen",sym:["RM"]},{dem:"swiss",name:"franc",iso:"chf",sym:["Rp."]},{dem:"panamanian",name:"balboa",iso:"pab",sub:"cent\xE9simo",sym:["B/."]},{dem:"indonesian",name:"rupiah",iso:"idr",sub:"sen",sym:["Rp"]},{dem:"brunei",name:"dollar",iso:"bnd",sub:"sen",sym:["$","B$"]},{dem:"venezuelan",name:"bol\xEDvar",iso:"vef",sub:"c\xE9ntimo",sym:["Bs.F","Bs."]},{dem:"macedonian",name:"denar",iso:"mkd",sub:"deni",sym:["den"]},{dem:"mauritanian",name:"ouguiya",iso:"mru",sub:"khoums",sym:["UM"]},{dem:"argentine",name:"peso",iso:"ars",sub:"centavo",sym:["$"]},{dem:"libyan",name:"dinar",iso:"lyd",sub:"dirham",sym:["LD","\u0644.\u062F"]},{dem:"jordanian",name:"dinar",iso:"jod",sub:"dirham",sym:["\u062F.\u0623"]},{dem:"french",name:"franc",iso:"frf",sub:"centime",sym:["F","Fr","FF","\u20A3"]},{dem:"syrian",name:"pound",iso:"syp",sub:"piastre",sym:["LS","\xA3S"]},{dem:"belize",name:"dollar",iso:"bzd",sub:"cent",sym:["$"]},{dem:"saudi",name:"riyal",iso:"sar",sub:"halalah",sym:["SAR","\u0631.\u0633"," \uFDFC"]},{dem:"surinamese",name:"dollar",iso:"srd",sub:"cent",sym:["$"]},{dem:"singapore",name:"dollar",iso:"sgd",sub:"cent",sym:["S$","$"]},{dem:"nepalese",name:"rupee",iso:"npr",sub:"paisa",sym:["\u0930\u0941 \u20A8","Re"]},{dem:"nicaraguan",name:"c\xF3rdoba",iso:"nio",sub:"centavo",sym:["C$"]},{dem:"bangladeshi",name:"taka",iso:"bdt",sub:"poysha",sym:["\u09F3"]},{dem:"indian",name:"rupee",iso:"inr",sub:"paisa",sym:["\u20B9"]},{dem:"maldivian",name:"rufiyaa",iso:"mvr",sub:"laari",sym:["Rf","MRf","MVR",".\u0783 "]},{dem:"sri lankan",name:"rupee",iso:"lkr",sub:"cents",sym:["Rs","\u0DBB\u0DD4","\u0BB0\u0BC2"]},{dem:"bhutanese",name:"ngultrum",iso:"btn",sub:"chhertum",sym:["Nu."]},{dem:"turkish",name:"lira",iso:"try",sub:"kuru\u015F",sym:["YTL"]},{dem:"serbian",name:"dinar",iso:"rsd",sub:"para",sym:["din","\u0434\u0438\u043D"]},{dem:"bosnia and herzegovina",name:"convertible mark",iso:"bam",sub:"fening",sym:["KM"]},{dem:"botswana",name:"pula",iso:"bwp",sub:"thebe",sym:["p"]},{dem:"swazi",name:"lilangeni",iso:"szl",sub:"cent",sym:["L","E"]},{dem:"lithuanian",name:"litas",iso:"ltl",sub:"centas",sym:["Lt","ct"]},{dem:"mauritian",name:"rupee",iso:"mur",sub:"cent",sym:["\u20A8"]},{dem:"pakistani",name:"rupee",iso:"pkr",sub:"paisa",sym:["\u20A8"]},{dem:"maltese",name:"lira",iso:"mtl",sub:"cent",sym:["\u20A4","Lm"]},{dem:"cypriot",name:"pound",iso:"cyp",sub:"cent",sym:["\xA3"]},{dem:"moldovan",name:"leu",iso:"mdl",sym:["l"]},{dem:"croatian",name:"kuna",iso:"hrk",sub:"lipa",sym:["kn"]},{dem:"afghan",name:"afghani",iso:"afn",sub:"pul",sym:["\u060B","Af","Afs"]},{dem:"ecuadorian",name:"sucre",iso:"ecs",sub:"centavo",sym:["S/."]},{dem:"sierra leonean",name:"leone",iso:"sll",sub:"cent",sym:["Le"]}],kr={},zg={};vi.forEach(function(l){l.sym.forEach(function(t){kr[t]=kr[t]||l.iso}),kr[l.iso]=kr[l.iso]||l.iso,l.sub&&(zg[l.sub]=!0)});var qg="(".concat(Object.keys(zg).join("|"),")"),i$=function(t){var e=t.match("#Currency+");e.nouns().toSingular();var n=e.text("reduced");return vi.find(function(r){return n==="".concat(r.dem," ").concat(r.name)||n===r.iso||n===r.sub||n===r.name||r.alias&&r.alias[n]===!0?r:!1})},a$=function(t){return t.suffix&&kr.hasOwnProperty(t.suffix)?vi.find(function(e){return e.iso===kr[t.suffix]}):t.prefix&&kr.hasOwnProperty(t.prefix)?vi.find(function(e){return e.iso===kr[t.prefix]}):null},s$=function(t){var e=0,n=t.match("and #Money+ ".concat(qg));if(n.found){t=t.not(n);var r=xt(n.match("#Value+"));r&&r.num&&(e=r.num/100)}var i=xt(t),a=i.num||0;a+=e;var s=a$(i)||i$(t)||{},o="";return s&&s.sym&&(o=s.sym[0],a&&t.has("".concat(qg))&&(a=a/100)),{num:a,iso:s.iso,demonym:s.dem,currency:s.name,plural:s.plural,symbol:o}},mu=s$,jg=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return t.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},o$={get:function(t){var e=[];return this.forEach(function(n){e.push(mu(n))}),t!==void 0?e[t]||null:e||null},currency:function(t){var e=[];return this.forEach(function(n){var r=mu(n);r&&e.push(r)}),typeof t=="number"?e[t]||null:e||null},json:function(t){var e=null;typeof t=="number"&&(e=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};var n=[];return this.forEach(function(r){var i=r.json(t)[0],a=mu(r);if(i.number=a.num,a.iso&&(i.iso=a.iso.toUpperCase(),i.symbol=a.symbol,i.currency=jg(a.demonym)+" "+jg(a.currency)),i.textFmt=zt(a,!0,!1),a.currency){var s=a.currency;a.num!==1&&(s=a.plural||s+"s"),i.textFmt+=" "+s}n.push(i)}),e!==null?n[e]||{}:n}},l$=o$,u$=function(t){if(!t.numerator||!t.denominator)return"";var e=hi(t.numerator),n=Lg(t.denominator);return t.denominator===2&&(n="half"),e&&n?(t.numerator!==1&&(n+="s"),"".concat(e," ").concat(n)):""},c$=function(t){if(!t.numerator||!t.denominator)return"";var e=hi(t.numerator),n=hi(t.denominator);return"".concat(e," out of ").concat(n)},f$=function(t){return t.decimal},yi={toText:u$,textCardinal:c$,toDecimal:f$},hu={get:function(t){var e=[];return this.forEach(function(n){e.push(Yr(n))}),t!==void 0?e[t]||null:e||null},toDecimal:function(){return this.forEach(function(t){var e=Yr(t);if(e){var n=yi.toDecimal(e);t.replaceWith(String(n),!0),t.tag("NumericValue"),t.unTag("Fraction")}}),this},json:function(t){var e=null;typeof t=="number"&&(e=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};var n=[];return this.forEach(function(r){var i=r.json(t)[0],a=Yr(r)||{},s=yi.toDecimal(a);i.numerator=a.numerator,i.denominator=a.denominator,i.number=s,i.textOrdinal=yi.toText(a),i.textCardinal=yi.textCardinal(a),n.push(i)}),e!==null?n[e]||{}:n},normalize:function(){var t=this;return this.forEach(function(e){var n=Yr(e);if(n&&typeof n.numerator=="number"&&typeof n.denominator=="number"){var r="".concat(n.numerator,"/").concat(n.denominator);t.replace(e,r)}}),this},toText:function(t){var e=[];return this.forEach(function(n){var r=Yr(n)||{},i=yi.toText(r);n.replaceWith(i,!0),n.tag("Fraction")}),t!==void 0?e[t]:e},toPercentage:function(){var t=this;return this.forEach(function(e){var n=Yr(e);if(n.decimal||n.decimal===0){var r=n.decimal*100;r=Math.round(r*100)/100,t.replace(e,"".concat(r,"%"))}}),this}};hu.toNumber=hu.toDecimal;var p$=hu,d$="(hundred|thousand|million|billion|trillion|quadrillion|quintillion|sextillion|septillion)",Ug="fraction-tagger",m$=function(t){return t.match(d$).tag("#Multiple",Ug),t.match("[(half|quarter)] of? (a|an)",0).tag("Fraction","millionth"),t.match("#Adverb [half]",0).tag("Fraction","nearly-half"),t.match("[half] the",0).tag("Fraction","half-the"),t.match("#Value (halves|halfs|quarters)").tag("Fraction","two-halves"),t.match("a #Ordinal").tag("Fraction","a-quarter"),t.match("(#Fraction && /s$/)").lookBefore("#Cardinal+$").tag("Fraction"),t.match("[#Cardinal+ #Ordinal] of .",0).tag("Fraction","ordinal-of"),t.match("[(#NumericValue && #Ordinal)] of .",0).tag("Fraction","num-ordinal-of"),t.match("(a|one) #Cardinal?+ #Ordinal").tag("Fraction","a-ordinal"),t.match("#Cardinal+ out? of every? #Cardinal").tag("Fraction",Ug),t},h$=m$,v$=function(t){var e="money-tagger";t.match("#Money and #Money #Currency?").tag("Money","money-and-money"),t.match("#Money").not("#TextValue").match("/\\.[0-9]{3}$/").unTag("#Money","three-decimal money"),t.ifNo("#Value").match("#Currency #Verb").unTag("Currency","no-currency"),t.match("#Value #Currency [and] #Value (cents|ore|centavos|sens)",0).tag("Money",e);var n=t.match("[<num>#Value] [<currency>(mark|rand|won|rub|ore)]");return n.group("num").tag("Money",e),n.group("currency").tag("Currency",e),t},y$=v$,Hg="number-tag",g$=function(t){t=y$(t),t.match("the [/[0-9]+s$/]").tag("#Plural",Hg),t.match("half a? #Value").tag("Value","half-a-value"),t.match("#Value [and a (half|quarter)]",0).tag(["TextValue","#Fraction"],"value-and-a-half"),t=h$(t),t.match("#Cardinal and #Fraction #Fraction").tag("Value",Hg)},b$=g$,x$={Fraction:{isA:["Value"]},Multiple:{isA:"Value"}},Kg={mark:!0,sucre:!0,leone:!0,afghani:!0,rand:!0,try:!0,mop:!0,won:!0,all:!0,rub:!0,eek:!0,sit:!0,bam:!0,npr:!0,leu:!0},Qr={kronor:"Currency"};vi.forEach(function(l){l.iso&&!Kg[l.iso]&&(Qr[l.iso]=["Acronym","Currency"]);var t=l.name;if(t&&!Kg[t]&&(Qr[t]="Currency",Qr[t+"s"]="Currency"),l.dem){var e=l.dem;Qr["".concat(e," ").concat(t)]="Currency",Qr["".concat(e," ").concat(t,"s")]="Currency"}l.sub&&(Qr[l.sub]="Currency")});var C$=Qr,N$=function(t,e){e.addWords(C$),e.addTags(x$),e.postProcess(b$);var n=function(o){xa(c,o);var u=Na(c);function c(){return ba(this,c),u.apply(this,arguments)}return c}(t);Object.assign(n.prototype,r$);var r=function(o){xa(c,o);var u=Na(c);function c(){return ba(this,c),u.apply(this,arguments)}return c}(n);Object.assign(r.prototype,l$);var i=function(o){xa(c,o);var u=Na(c);function c(){return ba(this,c),u.apply(this,arguments)}return c}(n);Object.assign(i.prototype,p$);var a=function(o){xa(c,o);var u=Na(c);function c(){return ba(this,c),u.apply(this,arguments)}return c}(n);Object.assign(a.prototype,n$);var s={numbers:function(u){var c=g2(this,u);return new n(c.list,this,this.world)},percentages:function(u){var c=N2(this,u);return new a(c.list,this,this.world)},fractions:function(u){var c=x2(this,u);return new i(c.list,this,this.world)},money:function(u){var c=m2(this,u);return new r(c.list,this,this.world)}};return s.values=s.numbers,s.percents=s.percentages,Object.assign(t.prototype,s),t},w$=N$,Wg=w$;ga.extend(Wg);var vu=class extends Pe{static componentType="pluralize";static rendererType="text";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.pluralForm={default:null},e.basedOnNumber={default:null},e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return mr({stateVariableDefinitions:t,oldName:"value",newName:"valuePrePluralize"}),t.value={public:!0,componentType:"text",forRenderer:!0,returnDependencies:()=>({valuePrePluralize:{dependencyType:"stateVariable",variableName:"valuePrePluralize"},pluralForm:{dependencyType:"stateVariable",variableName:"pluralForm"},basedOnNumber:{dependencyType:"stateVariable",variableName:"basedOnNumber"}}),definition:function({dependencyValues:e}){let n=ga(e.valuePrePluralize),r=n.values().toNumber().all().terms().json();if(r.length===0)return{newValues:{value:e.valuePrePluralize}};let i;if(e.basedOnNumber!==null&&(i=Gg(e.basedOnNumber)),r.length===1)return i===void 0&&(i=!0),i?e.pluralForm!==null?{newValues:{value:e.pluralForm}}:{newValues:{value:n.nouns().toPlural().all().out("text")}}:{newValues:{value:e.valuePrePluralize}};if(i===void 0){let s=[],o=[],u=n.nouns().json();for(let[p,d]of r.entries()){let m=u[s.length];d.terms[0].tags.includes("Value")&&o.push(p),m!==void 0&&m.text===d.text&&s.push(p)}i=[];let c=n.values().numbers().json(),f=-1;for(let p of s){for(;Number(o[f+1])<Number(p);)f++;c[f]&&Gg(Number(c[f].normal))?i.push(!0):i.push(!1)}}if(i===!1)return{newValues:{value:e.valuePrePluralize}};let a=ga(e.valuePrePluralize);if(e.pluralForm!==null)for(let[s,o]of n.nouns().data().entries())(i===!0||i[s]===!0)&&a.replace(o.text,e.pluralForm);else{let s=n.nouns().json().length;for(let o=0;o<s;o++)(i===!0||i[o]===!0)&&a.nouns(o).toPlural().all()}return{newValues:{value:a.out("text")}}}},t}},Zg=vu;function Gg(l){return l!==1}var yu=class extends We{static componentType="feedback";static primaryStateVariableForDefinition="feedbackText";static createPropertiesObject(){let t=super.createPropertiesObject();return delete t.hide,t}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atMostOneCondition",componentType:"condition",comparison:"atMost",number:1,allowSpillover:!1}),r=e.newLeaf({name:"atLeastZeroAnything",componentType:"_base",comparison:"atLeast",number:0});return e.newOperator({name:"ifAndRest",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.hide={forRenderer:!0,returnDependencies:()=>({conditionChild:{dependencyType:"child",childLogicName:"atMostOneCondition",variableNames:["value"]}}),definition:function({dependencyValues:e}){let n;return e.conditionChild.length===0?n=!1:n=!e.conditionChild[0].stateValues.value,{newValues:{hide:n}}}},t.feedbackText={forRenderer:!0,defaultValue:null,returnDependencies:()=>({}),definition:()=>({useEssentialOrDefaultValue:{feedbackText:{variablesToCheck:["feedbackText"]}}})},t.childrenToRender={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"atLeastZeroAnything"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.children.map(n=>n.componentName)}}}},t}},Xg=yu;var gu=class extends We{static componentType="container";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"anything"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t}initializeRenderer(){this.renderer===void 0&&(this.renderer=new this.availableRenderers.container({key:this.componentName}))}},Jg=gu;var bu=class extends _e{static componentType="collaborategroups";static stateVariableForPropertyValue="collaborateGroups";static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastZeroPoints",componentType:"point",comparison:"atLeast",number:0}),r=Vi(a=>({componentType:"point",children:[{componentType:"coords",children:a}]})),i=e.newLeaf({name:"exactlyOneString",componentType:"string",number:1,isSugar:!0,logicToWaitOnSugar:["atLeastZeroPoints"],replacementFunction:r});return e.newOperator({name:"pointsXorSugar",operator:"xor",propositions:[i,n],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.collaborateGroups={returnDependencies:()=>({pointChildren:{dependencyType:"child",childLogicName:"atLeastZeroPoints",variableNames:["xs","coords","nDimensions"]}}),definition:function({dependencyValues:e}){let n={};for(let i of e.pointChildren)if(i.stateValues.nDimensions!==2)console.warn(`invalid collaborate group: ${i.stateValues.coords.toString()}`);else{let a=i.stateValues.xs[0].evaluate_to_constant(),s=i.stateValues.xs[1].evaluate_to_constant();Number.isInteger(a)&&a>0&&Number.isInteger(s)&&s>0?(n[a]===void 0&&(n[a]=[]),n[a].push(s)):console.warn(`invalid collaborate group: ${i.stateValues.coords.toString()}`)}return{newValues:{collaborateGroups:{groups:n,matchGroup:function({groupNumber:i,numberOfGroups:a}={}){if(a>1){let s=n[a];return s===void 0?!1:s.includes(i)}else return!0}}}}}},t}},Yg=bu;var xu=class extends _e{static componentType="collaborateGroupSetup";static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOnePossibleNumberOfGroups",componentType:"possibleNumberOfGroups",comparison:"atMost",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.possibleNumberOfGroups={returnDependencies:()=>({pngChild:{dependencyType:"child",childLogicName:"atMostOnePossibleNumberOfGroups",variableNames:["numbers"]}}),definition:function({dependencyValues:e}){return e.pngChild.length===0?{newValues:{possibleNumberOfGroups:[1]}}:{newValues:{possibleNumberOfGroups:e.pngChild[0].stateValues.numbers}}}},t}},Qg=xu;var Cu=class extends We{static componentType="div";static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.width={default:300},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.childrenToRender={returnDependencies:()=>({activeChildren:{dependencyType:"child",childLogicName:"anything"}}),definition:function({dependencyValues:e}){return{newValues:{childrenToRender:e.activeChildren.map(n=>n.componentName)}}}},t}initializeRenderer(){this.renderer===void 0?this.renderer=new this.availableRenderers.div({key:this.componentName,width:this.stateValues.width}):this.updateRenderer()}updateRenderer(){this.renderer.updateDiv({width:this.stateValues.width})}},eb=Cu;var Nu=class extends We{static componentType="considerAsResponses";static rendererType=void 0;static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.childrenWithNValues={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"anything",variableNames:["nValues"],variablesOptional:!0}}),definition:({dependencyValues:e})=>({newValues:{childrenWithNValues:e.children}})},t.childrenAsResponses={returnDependencies:()=>({children:{dependencyType:"child",childLogicName:"anything",variableNames:["value","values","componentType"],variablesOptional:!0}}),definition:({dependencyValues:e})=>({newValues:{childrenAsResponses:e.children}})},t}},tb=Nu;var wu=class extends Ue{static componentType="selectByIndex";static assignNamesToReplacements=!0;static useChildrenForReference=!1;static get stateVariablesShadowedForReference(){return["selectedIndices"]}static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.selectIndices={default:[]},e}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atLeastOneOption",componentType:"option",comparison:"atLeast",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nOptions={additionalStateVariablesDefined:["optionChildren"],returnDependencies:()=>({optionChildren:{dependencyType:"child",childLogicName:"atLeastOneOption"}}),definition({dependencyValues:e}){return{newValues:{optionChildren:e.optionChildren,nOptions:e.optionChildren.length}}}},t.selectedIndices={returnDependencies:()=>({nOptions:{dependencyType:"stateVariable",variableName:"nOptions"},selectIndices:{dependencyType:"stateVariable",variableName:"selectIndices"}}),definition:function({dependencyValues:e}){return e.nOptions===0?{newValues:{selectedIndices:[]}}:{newValues:{selectedIndices:e.selectIndices.filter(i=>Number.isInteger(i)&&i>=1&&i<=e.nOptions).map(i=>i-1)}}}},t.readyToExpand={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),definition(){return{newValues:{readyToExpand:!0}}}},t.needsReplacementsUpdatedWhenStale={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),markStale:()=>({updateReplacements:!0}),definition:()=>({newValues:{needsReplacementsUpdatedWhenStale:!0}})},t}static createSerializedReplacements({component:t,components:e,workspace:n,componentInfoObjects:r}){let i=this.getReplacements(t,e,r);return t.stateValues.needsReplacementsUpdatedWhenStale,n.previousSelectedIndices=[...t.stateValues.selectedIndices],{replacements:i}}static getReplacements(t,e,n){let r=[];for(let a of t.stateValues.selectedIndices){let s=t.stateValues.optionChildren[a].componentName,o=He(e[s].state.serializedChildren.value),u={componentType:"option",state:{rendered:!0},doenetAttributes:Object.assign({},e[s].doenetAttributes),children:o,originalName:s};t.stateValues.hide&&(u.state||(u.state={}),u.state.hide=!0),r.push(u)}return qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:r,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:n}).serializedComponents}static calculateReplacementChanges({component:t,componentChanges:e,components:n,workspace:r,componentInfoObjects:i}){if(t.stateValues.needsReplacementsUpdatedWhenStale,r.previousSelectedIndices.length===t.stateValues.selectedIndices.length&&t.stateValues.selectedIndices.every((u,c)=>u===r.previousSelectedIndices[c]))return[];let a=[],s=this.getReplacements(t,n,i),o={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:s,replacementsToWithhold:0};return a.push(o),r.previousSelectedIndices=[...t.stateValues.selectedIndices],a}},rb=wu;var Tu=class extends _e{static componentType="case";static rendererType=void 0;static createPropertiesObject(t){return{}}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"exactlyOneCondition",componentType:"condition",number:1}),r=e.newLeaf({name:"exactlyOneResult",componentType:"result",number:1});return e.newOperator({name:"conditionAndResult",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.serializedChildren={additionalStateVariablesDefined:["resultChild"],returnDependencies:()=>({resultChild:{dependencyType:"child",childLogicName:"exactlyOneResult",variableNames:["serializedChildren"],doNotProxy:!0}}),definition:function({dependencyValues:e}){let n,r;return e.resultChild.length===0?(n=null,r=null):(n=e.resultChild[0].stateValues.serializedChildren,r=Object.assign({},e.resultChild[0]),delete r.stateValues),{newValues:{serializedChildren:n,resultChild:r}}}},t.conditionSatisfied={public:!0,componentType:"boolean",returnDependencies:()=>({conditionChild:{dependencyType:"child",childLogicName:"exactlyOneCondition",variableNames:["value"]}}),definition:function({dependencyValues:e}){let n;return e.conditionChild.length===0?n=!1:n=e.conditionChild[0].stateValues.value,{newValues:{conditionSatisfied:n}}}},t}},nb=Tu;var _u=class extends Ue{static componentType="selectByCondition";static assignNamesToReplacements=!0;static createPropertiesObject(t){let e=super.createPropertiesObject(t);return e.maximumNumberToSelect={default:null},e}static returnChildLogic(t){let e=super.returnChildLogic(t),n=e.newLeaf({name:"atLeastOneCase",componentType:"case",comparison:"atLeast",number:1}),r=e.newLeaf({name:"atMostOneElse",componentType:"else",comparison:"atMost",number:1});return e.newOperator({name:"casesAndElse",operator:"and",propositions:[n,r],setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.nCases={additionalStateVariablesDefined:["caseChildren"],returnDependencies:()=>({caseChildren:{dependencyType:"child",childLogicName:"atLeastOneCase"}}),definition({dependencyValues:e}){return{newValues:{caseChildren:e.caseChildren,nCases:e.caseChildren.length}}}},t.elseChild={returnDependencies:()=>({elseChild:{dependencyType:"child",childLogicName:"atMostOneElse"}}),definition({dependencyValues:e}){let n=null;return e.elseChild.length===1&&(n=e.elseChild[0]),{newValues:{elseChild:n}}}},t.selectedIndices={returnDependencies:()=>({caseChildren:{dependencyType:"child",childLogicName:"atLeastOneCase",variableNames:["conditionSatisfied"]},elseChild:{dependencyType:"stateVariable",variableName:"elseChild"},maximumNumberToSelect:{dependencyType:"stateVariable",variableName:"maximumNumberToSelect"}}),definition({dependencyValues:e}){let n=[];for(let[r,i]of e.caseChildren.entries())i.stateValues.conditionSatisfied&&n.push(r);if(n.length===0&&e.elseChild&&n.push(e.caseChildren.length),e.maximumNumberToSelect!==null&&n.length>e.maximumNumberToSelect){let r=Math.max(0,Math.floor(e.maximumNumberToSelect));n=n.slice(0,r)}return{newValues:{selectedIndices:n}}}},t.readyToExpand={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),definition(){return{newValues:{readyToExpand:!0}}}},t.needsReplacementsUpdatedWhenStale={returnDependencies:()=>({selectedIndices:{dependencyType:"stateVariable",variableName:"selectedIndices"}}),markStale:()=>({updateReplacements:!0}),definition:()=>({newValues:{needsReplacementsUpdatedWhenStale:!0}})},t}static createSerializedReplacements({component:t,components:e,workspace:n,componentInfoObjects:r}){let i=this.getReplacements(t,e,r);return t.stateValues.needsReplacementsUpdatedWhenStale,n.previousSelectedIndices=[...t.stateValues.selectedIndices],{replacements:i}}static getReplacements(t,e,n){let r=[];for(let a of t.stateValues.selectedIndices){let s,o={};a<t.stateValues.nCases?(s=t.stateValues.caseChildren[a].componentName,o.componentType="result",o.componentName=e[s].stateValues.resultChild.componentName):(s=o.componentName=t.stateValues.elseChild.componentName,o.componentType="else");let u=He(e[s].state.serializedChildren.value),c={componentType:o.componentType,state:{rendered:!0},doenetAttributes:Object.assign({},e[o.componentName].doenetAttributes),children:u,originalName:o.componentName};t.stateValues.hide&&(c.state||(c.state={}),c.state.hide=!0),r.push(c)}return qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:r,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:n}).serializedComponents}static calculateReplacementChanges({component:t,componentChanges:e,components:n,workspace:r,componentInfoObjects:i}){if(t.stateValues.needsReplacementsUpdatedWhenStale,r.previousSelectedIndices.length===t.stateValues.selectedIndices.length&&r.previousSelectedIndices.every((u,c)=>u===t.stateValues.selectedIndices[c]))return[];let a=[],s=this.getReplacements(t,n,i),o={changeType:"add",changeTopLevelReplacements:!0,firstReplacementInd:0,numberReplacementsToReplace:t.replacements.length,serializedReplacements:s,replacementsToWithhold:0};return a.push(o),r.previousSelectedIndices=[...t.stateValues.selectedIndices],console.log(`replacementChanges for if ${t.componentName}`),console.log(a),a}},ib=_u;var Au=class extends Ue{static componentType="empty";static assignNamesToReplacements=!0;static createPropertiesObject(){return{}}static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"anything",componentType:"_base",comparison:"atLeast",number:0,setAsBase:!0}),e}static createSerializedReplacements({component:t,componentInfoObjects:e}){let n=t.doenetAttributes.assignNames;return n===void 0?{replacements:[]}:{replacements:qe({assignNames:n,serializedComponents:[],parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:e}).serializedComponents}}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.readyToExpand={returnDependencies:()=>({}),definition:()=>({newValues:{readyToExpand:!0}})},t}},ab=Au;var $u=class extends _e{static componentType="bindValueTo";static rendererType=void 0;static returnChildLogic(t){let e=super.returnChildLogic(t);return e.newLeaf({name:"atMostOneChild",componentType:"_base",comparison:"atMost",number:1,setAsBase:!0}),e}static returnStateVariableDefinitions(){let t=super.returnStateVariableDefinitions();return t.value={returnDependencies:()=>({child:{dependencyType:"child",childLogicName:"atMostOneChild",variableNames:["value"],variablesOptional:!0,requireChildLogicInitiallySatisfied:!0}}),definition:function({dependencyValues:e}){if(e.child.length===1){let n=e.child[0];if(n.stateValues.value!==void 0)return{newValues:{value:n.stateValues.value}}}return{newValues:{value:null}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){let r=!1;return n.child.length===1&&n.child[0].stateValues.value!==void 0&&(r=!0),r?{success:!0,instructions:[{setDependency:"child",desiredValue:e.value,childIndex:0,variableIndex:0}]}:{success:!1}}},t.valueForDisplay={returnDependencies:()=>({child:{dependencyType:"child",childLogicName:"atMostOneChild",variableNames:["valueForDisplay"],variablesOptional:!0,requireChildLogicInitiallySatisfied:!0}}),definition:function({dependencyValues:e}){if(e.child.length===1){let n=e.child[0];if(n.stateValues.valueForDisplay!==void 0)return{newValues:{valueForDisplay:n.stateValues.valueForDisplay}}}return{newValues:{valueForDisplay:null}}}},t.text={returnDependencies:()=>({child:{dependencyType:"child",childLogicName:"atMostOneChild",variableNames:["text"],variablesOptional:!0,requireChildLogicInitiallySatisfied:!0}}),definition:function({dependencyValues:e}){if(e.child.length===1){let n=e.child[0];if(typeof n.stateValues.text=="string")return{newValues:{text:n.stateValues.text}}}return{newValues:{text:""}}},inverseDefinition:function({desiredStateVariableValues:e,dependencyValues:n}){let r=!1;return n.child.length===1&&typeof n.child[0].stateValues.text=="string"&&(r=!0),r?{success:!0,instructions:[{setDependency:"child",desiredValue:e.text,childIndex:0,variableIndex:0}]}:{success:!1}}},t}},sb=$u;var Sa=[...Object.values(_s),...Object.values(As),...Object.values($s),...Object.values(Is),...Object.values(Os),...Object.values(Ls),...Object.values(Bs),...Object.values(zs),...Object.values(qs),...Object.values(Us),...Object.values(Hs),...Object.values(Gs),...Object.values(Xs),...Object.values(to),...Object.values(ro),...Object.values(no),...Object.values(ao),xh,Ch,Pe,Nh,pn,wh,Th,Se,_h,ke,rr,dn,Ah,$h,Sh,Dh,Dr,Vh,Ih,Mh,wn,Tn,Eh,Ph,Rh,kh,_n,Fh,Bh,Pi,zh,qh,jh,Hh,Ku,Kh,Wh,Gh,Zh,Xh,Oe,vt,Jh,Yh,Gn,Ui,Bi,jr,$n,nv,Tv,_v,Av,$v,Sv,Zi,iv,yv,ev,tv,av,sv,ov,lv,uv,cv,fv,dv,mv,hv,vv,gv,bv,xv,Cv,Dv,zi,Iv,Or,Pv,Lv,Rv,Kv,Dn,Wv,Gv,Zv,Xv,Jv,Yv,Qv,ey,ty,ry,ny,Zg,Xg,Jg,Yg,Qg,eb,tb,rb,nb,ib,ab,sb],T$=[...Sa,...Object.values(Ya),_e,Me,We,lt,gt,ar,Ue,Uu,un,Oi,Ei,yn,Qn,Kt,nr,xn,Wn,kt,Hn,fn,hr,Zn];function ob(){let l={};for(let t of Sa){let e=t.componentType;if(e===void 0)throw Error("Cannot create component as componentType is undefined for class "+t);if(e=e.toLowerCase(),e in l)throw Error("component type "+e+" defined in two classes");if(!/[a-z]/.test(e.substring(0,1)))throw Error("Invalid component type "+e+". Component types must begin with a letter.");l[e]=t}return l}function lb(){let l={};for(let t of T$){let e=t.componentType;if(e===void 0)throw Error("Cannot create component as componentType is undefined for class "+t);if(e=e.toLowerCase(),e in l)throw Error("component type "+e+" defined in two classes");l[e]=t}return l}function ub(){let l={};for(let t of Sa)if(t.createsVariants){let e=t.componentType;if(e===void 0)throw Error("Cannot create component as componentType is undefined for class "+t);if(e=e.toLowerCase(),e in l)throw Error("component type "+e+" defined in two classes");l[e]=t}return l}function cb(){let l={};for(let t of Sa)if(t.createsVariants||t.setUpVariantIfVariantControlChild||t.alwaysSetUpVariant){let e=t.componentType;if(e===void 0)throw Error("Cannot create component as componentType is undefined for class "+t);if(e=e.toLowerCase(),e in l)throw Error("component type "+e+" defined in two classes");l[e]=t}return l}var Su=class{constructor(t){this.stack=[{}],t!==void 0&&Object.assign(this.parameters,t)}get parameters(){return this.stack[this.stack.length-1]}push(t,e=!0){let n={};e?(Object.assign(n,this.parameters),t!==void 0&&Object.assign(n,t)):n=t,this.stack.push(n)}pop(){let t=this.stack.pop();return this.stack.length===0&&(this.stack=[{}]),t}},fb=Su;var Du=class{constructor({maxIterationsRoot:t=80,maxIterationsMinimize:e=500,eps:n=1e-6}={}){this.maxIterationsRoot=t,this.maxIterationsMinimize=e,this.eps=n}fzero(t,e,n){var r,i,a,s,o,u,c,f,p,d,m,v,h,y,g,b,x,N,C,_,w=this.eps,A=this.maxIterationsRoot,$=0,S=0;if(Array.isArray(e)){if(e.length<2)throw new Error("fzero: length of array x0 has to be at least two.");r=e[0],s=t.call(n,r),S+=1,i=e[1],o=t.call(n,i),S+=1}else{for(r=e,s=t.call(n,r),S+=1,r===0?c=1:c=r,f=[.9*c,1.1*c,c-1,c+1,.5*c,1.5*c,-c,2*c,-10*c,10*c],d=f.length,p=0;p<d&&(i=f[p],o=t.call(n,i),S+=1,!(s*o<=0));p++);i<r&&(m=r,r=i,i=m,v=s,s=o,o=v)}if(s*o>0)return Array.isArray(e)?this.fminbr(t,[r,i],n).x:this.Newton(t,r,n);for(a=r,u=s;$<A;){if(h=i-r,Math.abs(u)<Math.abs(o)&&(r=i,i=a,a=r,s=o,o=u,u=s),x=2*w*Math.abs(i)+w*.5,_=(a-i)*.5,Math.abs(_)<=x&&Math.abs(o)<=w)return i;Math.abs(h)>=x&&Math.abs(s)>Math.abs(o)&&(g=a-i,r===a?(y=o/s,N=g*y,C=1-y):(C=s/u,y=o/u,b=o/s,N=b*(g*C*(C-y)-(i-r)*(y-1)),C=(C-1)*(y-1)*(b-1)),N>0?C=-C:N=-N,N<.75*g*C-Math.abs(x*C)*.5&&N<Math.abs(h*C*.5)&&(_=N/C)),Math.abs(_)<x&&(_>0?_=x:_=-x),r=i,s=o,i+=_,o=t.call(n,i),S+=1,(o>0&&u>0||o<0&&u<0)&&(a=r,u=s),$++}return i}fminbr(t,e,n){var r,i,a,s,o,u,c,f,p,d,m,v,h,y,g,b,x=(3-Math.sqrt(5))*.5,N=this.eps,C=this.eps,_=this.maxIterationsMinimize,w=0,A=0;if(!Array.isArray(e)||e.length<2)throw new Error("Numerics.fminbr: length of array x0 has to be at least two.");if(r=e[0],i=e[1],s=r+x*(i-r),c=t.call(n,s),Number.isNaN(c))return{success:!1};for(A+=1,a=s,o=s,u=c,f=c;w<_;){if(p=i-r,d=(r+i)*.5,m=C*Math.abs(a)+N/3,Math.abs(a-d)+p*.5<=2*m)return{success:!0,x:a,fx:u,tol:m};if(v=x*(a<d?i-a:r-a),Math.abs(a-o)>=m&&(g=(a-o)*(u-c),y=(a-s)*(u-f),h=(a-s)*y-(a-o)*g,y=2*(y-g),y>0?h=-h:y=-y,Math.abs(h)<Math.abs(v*y)&&h>y*(r-a+2*m)&&h<y*(i-a-2*m)&&(v=h/y)),Math.abs(v)<m&&(v>0?v=m:v=-m),g=a+v,b=t.call(n,g),Number.isNaN(b))return{success:!1};A+=1,b<=u?(g<a?i=a:r=a,s=o,o=a,a=g,c=f,f=u,u=b):(g<a?r=g:i=g,b<=f||o===a?(s=o,o=g,c=f,f=b):(b<=c||s===a||s===o)&&(s=g,c=b)),w+=1}return{success:!1,x:a,fx:u}}Newton(t,e,n){var r,i=0,a=this.eps,s=t.apply(n,[e]),o=1;for(Array.isArray(e)&&(e=e[0]);i<50&&Math.abs(s)>a;)r=this.D(t,n)(e),o+=2,Math.abs(r)>a?e-=s/r:e+=Math.random()*.2-1,s=t.apply(n,[e]),o+=1,i+=1;return e}D(t,e){return e!=null?function(n){var r=1e-5,i=r*2;return(t(n+r)-t(n-r))/i}:function(n){var r=1e-5,i=r*2;return(t.apply(e,[n+r])-t.apply(e,[n-r]))/i}}},pb=Du;var Eu=De(mb()),Pb=De(Ee());function Vu({ancestor:l,descendantClasses:t,recurseToMatchedChildren:e=!0,useReplacementsForComposites:n=!1,compositeClass:r,includeNonActiveChildren:i=!1,includePropertyChildren:a=!1,skipOverAdapters:s=!1,ignoreReplacementsOfMatchedComposites:o=!1,definingChildrenFirst:u=!1,namesToIgnore:c=[],init:f=!0}){let p=[];if(n&&l instanceof r)f&&p.push(...Iu({composite:l,compositeClass:r,includeComposites:i}));else{if(i&&u)for(let v of l.definingChildren)(a||!v.doenetAttributes.isPropertyChild)&&p.push(v);if(l.activeChildren)for(let v of l.activeChildren)(a||!v.doenetAttributes.isPropertyChild)&&(p.map(h=>h.componentName).includes(v.componentName)||p.push(v));if(i){if(!u)for(let v of l.definingChildren)(a||!v.doenetAttributes.isPropertyChild)&&(p.map(h=>h.componentName).includes(v.componentName)||p.push(v));if(l.allChildren)for(let v in l.allChildren){let h=l.allChildren[v];if(h.definingChildrenIndex===void 0&&h.activeChildrenIndex===void 0){let y=h.component;(a||!y.doenetAttributes.isPropertyChild)&&p.push(y)}}}}if(o)for(let v of p)t.some(y=>v instanceof y)&&v instanceof r&&(c=[...c,...Iu({composite:v,compositeClass:r,includeComposites:!0}).map(y=>y.componentName)]);if(s){for(let[v,h]of p.entries())if(h.adaptedFrom&&!c.includes(h.componentName)){c=[...c,h.componentName];let y=p.map(g=>g.componentName).indexOf(h.adaptedFrom.componentName);y===-1?p.splice(v,1,h.adaptedFrom):u&&l.definingChildren.map(g=>g.componentName).includes(h.adaptedFrom.componentName)||(p.splice(v,1,h.adaptedFrom),p.splice(y,1,h))}}c.length>0&&(p=p.filter(v=>!c.includes(v.componentName)));let d=[],m=[];for(let v of p){let h=t.some(y=>v instanceof y);if(h&&d.push({componentName:v.componentName,componentType:v.componentType}),!h||e){let y=Vu({ancestor:v,descendantClasses:t,recurseToMatchedChildren:e,useReplacementsForComposites:n,compositeClass:r,includeNonActiveChildren:i,includePropertyChildren:a,skipOverAdapters:s,ignoreReplacementsOfMatchedComposites:o,definingChildrenFirst:u,init:!1});d.push(...y)}}return o&&(d=d.filter(v=>!m.includes(v))),d}function Iu({composite:l,compositeClass:t,includeComposites:e=!1}){let n=[];if(l.replacements){let r;if(l.replacementsToWithhold){let i=l.replacements.length-l.replacementsToWithhold;r=l.replacements.slice(0,i)}else r=l.replacements;for(let i of r)i instanceof t?(e&&n.push(i),n.push(...Iu({composite:i,compositeClass:t,includeComposites:e}))):n.push(i)}return n}function Ar(l,t){if(l.ancestors===void 0||l.ancestors.length===0)return[];let e=[l.ancestors[0].componentName],n=t[l.ancestors[0].componentName];if(n&&e.push(...Ar(n,t)),l.replacementOf){e.push(l.replacementOf.componentName);let r=Ar(l.replacementOf,t);for(let i of r)e.includes(i)||e.push(i)}return e}var dt=[],Mu=class{constructor({_components:t,componentInfoObjects:e,core:n}){this.setUpStateVariableDependenciesSub=this.setUpStateVariableDependenciesSub.bind(this),this.upstreamDependencies={},this.downstreamDependencies={},this.switchDependencies={},this.circularCheckPassed={},this.dependencyTypes={},dt.forEach(r=>this.dependencyTypes[r.dependencyType]=r),this.core=n,this._components=t,this.componentInfoObjects=e,this.updateTriggers={descendantDependenciesByAncestor:{},ancestorDependenciesByPotentialAncestor:{},replacementDependenciesByComposite:{},childDependenciesByParent:{},parentDependenciesByParent:{},dependenciesMissingComponentBySpecifiedName:{}}}setUpComponentDependencies({component:t,updatesNeeded:e,compositesBeingExpanded:n}){this.downstreamDependencies[t.componentName]&&this.deleteAllDownstreamDependencies({component:t,updatesNeeded:e}),this.downstreamDependencies[t.componentName]={},this.upstreamDependencies[t.componentName]||(this.upstreamDependencies[t.componentName]={});let r=[],i=[];for(let a in t.state)t.state[a].isArrayEntry||t.state[a].isAlias||i.includes(a)||(r.push(a),t.state[a].additionalStateVariablesDefined&&i.push(...t.state[a].additionalStateVariablesDefined));for(let a of r){let s=[a];t.state[a].additionalStateVariablesDefined&&s.push(...t.state[a].additionalStateVariablesDefined),this.setUpStateVariableDependencies({component:t,stateVariable:a,allStateVariablesAffected:s,updatesNeeded:e,compositesBeingExpanded:n})}}setUpStateVariableDependencies({component:t,stateVariable:e,allStateVariablesAffected:n,updatesNeeded:r,compositesBeingExpanded:i}){let a=t.state[e],s;if(a.stateVariablesDeterminingDependencies||a.determineIfShadowData){let o=this.createDetermineDependenciesStateVariable({stateVariable:e,component:t,allStateVariablesAffected:n,updatesNeeded:r,compositesBeingExpanded:i});s={[o]:{dependencyType:"stateVariable",componentName:t.componentName,variableName:o,__isDetermineDependencyStateVariable:!0}}}else s=a.returnDependencies({componentInfoObjects:this.componentInfoObjects,sharedParameters:t.sharedParameters});this.setUpStateVariableDependenciesSub({dependencies:s,component:t,stateVariable:e,allStateVariablesAffected:n,updatesNeeded:r,compositesBeingExpanded:i})}deleteAllDownstreamDependencies({component:t,stateVariables:e="__all__",updatesNeeded:n}){let r=t.componentName,i;e==="__all__"?i=Object.keys(this.downstreamDependencies[r]):i=e;for(let a of i){let s=this.downstreamDependencies[r][a];for(let o in s)s[o].delete(n);delete this.downstreamDependencies[r][a]}Object.keys(this.downstreamDependencies[r]).length===0&&!this.components[r]&&delete this.downstreamDependencies[r]}deleteAllUpstreamDependencies({component:t,stateVariables:e="__all__",completelyDelete:n=!1,updatesNeeded:r}){let i=t.componentName,a;e==="__all__"?a=Object.keys(this.upstreamDependencies[i]):a=e;for(let s of a){if(this.upstreamDependencies[i][s])for(let o of[...this.upstreamDependencies[i][s]])n?o.delete(r):o.removeDownstreamComponent({indexToRemove:o.downstreamComponentNames.indexOf(i),updatesNeeded:r});delete this.upstreamDependencies[i][s]}Object.keys(this.upstreamDependencies[i]).length===0&&!this._components[i]&&delete this.upstreamDependencies[i]}setUpStateVariableDependenciesSub({dependencies:t,component:e,stateVariable:n,allStateVariablesAffected:r,updatesNeeded:i,compositesBeingExpanded:a}){for(let s in t){let o=t[s];if(!(o.dependencyType in this.dependencyTypes))throw Error(`Unrecognized dependency type ${o.dependencyType} for ${s} of ${n} of ${e.componentName}`);new this.dependencyTypes[o.dependencyType]({component:e,stateVariable:n,allStateVariablesAffected:r,dependencyName:s,dependencyDefinition:o,dependencyHandler:this,updatesNeeded:i,compositesBeingExpanded:a}).checkForCircular()}}createDetermineDependenciesStateVariable({stateVariable:t,component:e,allStateVariablesAffected:n,updatesNeeded:r,compositesBeingExpanded:i}){let a=e.state[t].stateVariablesDeterminingDependencies;a||(a=[]);let s=e.state[t].determineIfShadowData,o=[];if(s){for(let m of n)o.push({component:s.targetComponent,stateVariable:m});s.arraySizeStateVariableToResolve&&o.push({component:e,stateVariable:s.arraySizeStateVariableToResolve})}let u=`__determine_dependencies_${t}`,c=this;for(let m of n)e.state[m].determineDependenciesStateVariable=u;let f=[...n],p=this.core;e.state[u]={actionOnResolved:!0,willNeverBeEssential:!0,dependenciesForStateVariables:n,returnDependencies:function(){let m={};for(let v of a)m[v]={dependencyType:"stateVariable",componentName:e.componentName,variableName:v};for(let v of o)m["_"+v.component.componentName+"_"+v.stateVariable]={dependencyType:"stateVariable",componentName:v.component.componentName,variableName:v.stateVariable};return m},resolvedAction({dependencyValues:m,updatesNeeded:v}){let h=e.state[u];c.deleteAllUpstreamDependencies({component:e,stateVariables:[u],completelyDelete:!0,updatesNeeded:v});let y=h.dependenciesForStateVariables[0],g=e.state[y];if(s){let x=[];f=[];for(let N of n){let C=s.targetComponent.state[N];C.value,C.essential||C.alwaysShadow||C.isShadow||C.isArray&&C.getAllArrayKeys(C.arraySize).length>0&&C.getAllArrayKeys(C.arraySize).some(_=>C.essentialByArrayKey[_])?x.push(N):f.push(N)}x.length>0&&p.modifyStateDefsToBeShadows({stateVariablesToShadow:x,stateVariableDefinitions:e.state,foundReadyToExpand:s.foundReadyToExpand,targetComponent:s.targetComponent})}let b;return g.isArray&&!g.entireArrayAtOnce?b=g.returnDependencies({stateValues:m,componentInfoObjects:p.componentInfoObjects,sharedParameters:e.sharedParameters,arraySize:g.arraySize}):g.isArrayEntry&&!g.entireArrayAtOnce?b=g.returnDependencies({stateValues:m,componentInfoObjects:p.componentInfoObjects,sharedParameters:e.sharedParameters,arraySize:g.arraySize,arrayKeys:g.arrayKeys}):b=g.returnDependencies({stateValues:m,componentInfoObjects:p.componentInfoObjects,sharedParameters:e.sharedParameters}),c.setUpStateVariableDependenciesSub({dependencies:b,component:e,stateVariable:y,allStateVariablesAffected:h.dependenciesForStateVariables,updatesNeeded:v,compositesBeingExpanded:i}),{}},markStale:function(){return f.length>0&&a.length>0?{updateDependencies:e.state[u].dependenciesForStateVariables}:{}},definition(){return{newValues:{[u]:!0}}}},this.core.initializeStateVariable({component:e,stateVariable:u});let d=e.state[u].returnDependencies();return this.setUpStateVariableDependenciesSub({dependencies:d,component:e,stateVariable:u,allStateVariablesAffected:[u],updatesNeeded:r,compositesBeingExpanded:i}),u}updateChildAndDescendantDependencies(t,e,n){if(!t.childLogicSatisfied)return;let r=t.componentName;if(this.upstreamDependencies[r].__activeChildren&&(this.markUpstreamDependentsStale({component:t,varName:"__activeChildren",updatesNeeded:e}),this.recordActualChangeInUpstreamDependencies({component:t,varName:"__activeChildren",updatesNeeded:e})),r in this.downstreamDependencies&&this.updateChildDependencies(t,e,n),t.ancestors){this.updateParentDependencies(t,e,n),this.updateAncestorDependencies(t,e,n),e.parentsToUpdateDescendants.add(t.componentName);for(let i of Ar(t,this.components))e.parentsToUpdateDescendants.add(i)}}updateChildDependencies(t,e,n){if(this.updateTriggers.childDependenciesByParent[t.componentName])for(let r of this.updateTriggers.childDependenciesByParent[t.componentName])r.recalculateDownstreamComponents(e,n)}updateDescendantDependencies(t,e,n){if(this.updateTriggers.descendantDependenciesByAncestor[t.componentName])for(let r of this.updateTriggers.descendantDependenciesByAncestor[t.componentName])r.recalculateDownstreamComponents(e,n)}updateParentDependencies(t,e,n){if(this.updateTriggers.parentDependenciesByParent[t.componentName])for(let r of this.updateTriggers.parentDependenciesByParent[t.componentName])r.recalculateDownstreamComponents(e,n)}updateAncestorDependencies(t,e,n){if(this.updateTriggers.ancestorDependenciesByPotentialAncestor[t.componentName])for(let r of this.updateTriggers.ancestorDependenciesByPotentialAncestor[t.componentName])r.recalculateDownstreamComponents(e,n)}updateReplacementDependencies(t,e,n){if(this.updateTriggers.replacementDependenciesByComposite[t.componentName])for(let r of this.updateTriggers.replacementDependenciesByComposite[t.componentName])r.recalculateDownstreamComponents(e,n)}checkForCircularDependency({componentName:t,varName:e,previouslyVisited:n=[]}){let r=t+":"+e;if(n.includes(r)){console.log("found circular",r,n);let i=/^(.*):/,a=n.map(u=>u.match(i)[1]),s=a.filter(u=>u.slice(0,2)!=="__").reduce((u,c)=>u.includes(c)?u:[...u,c],[]);s.length===0&&(s=[a[0]]);let o;throw s.length===1?o=s[0]:s.length===2?o=s.join(" and "):(s[s.length-2]=s.slice(s.length-2).join(", and "),s.pop(),o=s.join(", ")),Error(`Circular dependency involving ${o}`)}else n=[...n,r];if(!this.circularCheckPassed[r]&&(this.circularCheckPassed[r]=!0,t in this.downstreamDependencies)){let i=this.downstreamDependencies[t][e];for(let a in i){let s=i[a],o=s.downstreamComponentNames;if(!o)continue;let u=s.mappedDownstreamVariableNamesByComponent;if(!!u)for(let[c,f]of o.entries()){let p=u[c];for(let d of p)this.checkForCircularDependency({componentName:f,varName:d,previouslyVisited:n})}}}}resetCircularCheckPassed(t,e){let n=t+":"+e;if(this.circularCheckPassed[n]){delete this.circularCheckPassed[n];let r=this.upstreamDependencies[t][e];if(r)for(let i of r)for(let a of i.upstreamVariableNames)a!=="__childLogic"&&a!=="__identity"&&this.resetCircularCheckPassed(i.upstreamComponentName,a)}}updateDependencies(t,e,n){if(t.parentsToUpdateDescendants.size>0){for(let i of t.parentsToUpdateDescendants)this._components[i]&&this.updateDescendantDependencies(this._components[i],t,e);t.parentsToUpdateDescendants=new Set}let r=[];if(t.componentsToUpdateDependencies.length>0){console.log("updating dependencies"),console.log(t.componentsToUpdateDependencies);let i=[],a=[],s=[];for(let u of t.componentsToUpdateDependencies){let c=this._components[u.componentName];if(!c)continue;let f=[],p=[];for(let d of u.stateVariables)if(!p.includes(d)){f.push(d),c.state[d].additionalStateVariablesDefined&&p.push(...c.state[d].additionalStateVariablesDefined);let m=c.state[d].determineDependenciesStateVariable;i.push(c.state[m])}for(let d of f){let m=[d];c.state[d].additionalStateVariablesDefined&&m.push(...c.state[d].additionalStateVariablesDefined);let v=c.state[d],h;try{h=this.getStateVariableDependencyValues({component:c,stateVariable:v.determineDependenciesStateVariable})}catch(x){console.log(`Couldn't update dependencies of ${v.determineDependenciesStateVariable} of ${c.componentName}`),a.push({componentName:c.componentName,stateVariables:[d]});continue}if(Object.keys(h.changes).length===0&&v._previousValue!==void 0)continue;let y={stateValues:h.dependencyValues,componentInfoObjects:this.componentInfoObjects,sharedParameters:c.sharedParameters},g=v.returnDependencies(y),b=this.replaceDependenciesIfChanged({component:c,stateVariable:d,newDependencies:g,allStateVariablesAffected:m,updatesNeeded:t,compositesBeingExpanded:e});s.push(...b.newlyCreatedDependencies),(b.changedDependency||y.changedDependency)&&r.push({componentName:c.componentName,stateVariable:d,allStateVariablesAffected:m})}}for(let u of s)u.checkForCircular();console.log("dependencyChanges"),console.log(r),t.componentsToUpdateDependencies=a;let o=Object.keys(t.unresolvedDependencies).length>0;for(let u of r){let c=this._components[u.componentName];for(let p of u.allStateVariablesAffected)c.state[p].isResolved=!1;let f=this.core.resolveStateVariables({component:c,stateVariables:u.allStateVariablesAffected,updatesNeeded:t,compositesBeingExpanded:e});this.core.addUnresolvedDependencies({varsUnresolved:f.varsUnresolved,component:c,updatesNeeded:t});for(let p of u.allStateVariablesAffected)c.state[p].isResolved||(o=!0,this.resetUpstreamDependentsUnresolved({component:c,varName:p,updatesNeeded:t}))}o&&this.core.resolveAllDependencies(t,e);for(let u of i)u.value;for(let u of r){for(let c of u.allStateVariablesAffected)this.checkForCircularDependency({componentName:u.componentName,varName:c}),this._components[u.componentName].state[c].forceRecalculation=!0;this.core.markStateVariableAndUpstreamDependentsStale({component:this._components[u.componentName],varName:u.stateVariable,updatesNeeded:t}),this.recordActualChangeInUpstreamDependencies({component:this._components[u.componentName],varName:u.stateVariable})}}for(Object.keys(t.unresolvedDependencies).length>0&&this.core.resolveAllDependencies(t,e);t.compositesToUpdateReplacements.length>0;)this.core.replacementChangesFromCompositesToUpdate({updatesNeeded:t,compositesBeingExpanded:e}),Object.keys(t.unresolvedDependencies).length>0&&this.core.resolveAllDependencies(t,e);if(t.componentsToUpdateDependencies.length>0&&r.length>0||t.parentsToUpdateDescendants.size>0){let i=t.componentsToUpdateDependencies.length+t.parentsToUpdateDescendants.size;(!n||i<n)&&(console.log("since found more components to update dependencies, will try to recurse"),console.log(t.componentsToUpdateDependencies),console.log(t.parentsToUpdateDescendants),this.updateDependencies(t,e,i))}}replaceDependenciesIfChanged({component:t,stateVariable:e,newDependencies:n,allStateVariablesAffected:r,updatesNeeded:i,compositesBeingExpanded:a}){let s=this.downstreamDependencies[t.componentName][e],o=!1,u=[];for(let c in s)c in n||(o=!0,s[c].delete(i));for(let c in n)if(c in s){let f=n[c],p=s[c];if(!sn(f,p.definition)){o=!0,s[c].delete(i);let d=n[c],m=new this.dependencyTypes[d.dependencyType]({component:t,stateVariable:e,allStateVariablesAffected:r,dependencyName:c,dependencyDefinition:d,dependencyHandler:this,updatesNeeded:i,compositesBeingExpanded:a});u.push(m)}}else{o=!0;let f=n[c],p=new this.dependencyTypes[f.dependencyType]({component:t,stateVariable:e,allStateVariablesAffected:r,dependencyName:c,dependencyDefinition:f,dependencyHandler:this,updatesNeeded:i,compositesBeingExpanded:a});u.push(p)}return{changedDependency:o,newlyCreatedDependencies:u}}checkForDependenciesOnNewComponent({componentName:t,updatesNeeded:e,compositesBeingExpanded:n}){let r=[];if(this.updateTriggers.dependenciesMissingComponentBySpecifiedName[t]){for(let i of this.updateTriggers.dependenciesMissingComponentBySpecifiedName[t]){let a=this._components[i.upstreamComponentName];if(!a)continue;let s=!0;for(let o of i.upstreamVariableNames)if(!(o in a.state)){s=!1;break}if(!!s){i.recalculateDownstreamComponents(e,n);for(let o of i.upstreamVariableNames)r.push({componentName:i.upstreamComponentName,varName:o})}}delete this.updateTriggers.dependenciesMissingComponentBySpecifiedName[t]}return r}getStateVariableDependencyValues({component:t,stateVariable:e}){let n={},r={},i={},a=this.downstreamDependencies[t.componentName][e];for(let s in a){let{value:o,changes:u,usedDefault:c}=a[s].getValue();n[s]=o,Object.keys(u).length>0&&(r[s]=u),c&&(i[s]=!0)}return{dependencyValues:n,changes:r,usedDefault:i}}recordActualChangeInUpstreamDependencies({component:t,varName:e,changes:n}){let r=t.componentName,i=this.upstreamDependencies[r][e];if(i){for(let a of i)if(a.valuesChanged){let s=a.downstreamComponentNames.indexOf(r),o=a.valuesChanged[s][e];if(!o&&t.stateVarAliases)for(let u in t.stateVarAliases)t.stateVarAliases[u]===e&&u in upValuesChangedSub&&(o=upValuesChangedSub[u]);if(!o){if(!t.state[e].isArrayEntry)throw Error(`Something is wrong, as a variable ${e} of ${t.componentName} actually changed, but wasn't marked with a potential change`);o=upValuesChangedSub[e]={changed:{}}}t.state[e]&&t.state[e].isArray?(o.changed===void 0?o.changed={arrayKeysChanged:{}}:o.changed===!0&&(o.changed={allArrayKeysChanged:!0,arraySizeChanged:!0,arrayKeysChanged:{}}),n&&(n.allArrayKeysChanged&&(o.changed.allArrayKeysChanged=!0),n.arraySizeChanged&&(o.changed.arraySizeChanged=!0),Object.assign(o.changed.arrayKeysChanged,n.arrayKeysChanged))):o.changed=!0}}}get components(){return new Proxy(this._components,Be)}set components(t){return null}},It=class{constructor({component:t,stateVariable:e,allStateVariablesAffected:n,dependencyName:r,dependencyDefinition:i,dependencyHandler:a,updatesNeeded:s,compositesBeingExpanded:o}){this.dependencyName=r,this.dependencyHandler=a,this.upstreamComponentName=t.componentName,this.upstreamVariableNames=n,this.definition=Object.assign({},i),this.representativeStateVariable=e,i.doNotProxy&&(this.doNotProxy=!0),i.variablesOptional&&(this.variablesOptional=!0),i.requireChildLogicInitiallySatisfied&&(this.requireChildLogicInitiallySatisfied=!0),i.__isDetermineDependencyStateVariable&&(this.__isDetermineDependencyStateVariable=!0),i.publicStateVariablesOnly&&(this.publicStateVariablesOnly=!0),i.caseInsensitiveVariableMatch&&(this.caseInsensitiveVariableMatch=!0),i.useMappedVariableNames&&(this.useMappedVariableNames=!0),Number.isInteger(i.propIndex)&&(this.propIndex=i.propIndex),this.returnSingleVariableValue=!1,this.returnSingleComponent=!1,this.originalDownstreamVariableNames=[],this.setUpParameters();let u=this.determineDownstreamComponents();this.initialize({downstreamComponentNames:u.downstreamComponentNames,downstreamComponentTypes:u.downstreamComponentTypes,updatesNeeded:s,compositesBeingExpanded:o})}static dependencyType="_base";downstreamVariableNameIfNoVariables="__identity";static get rendererType(){return this.componentType}get dependencyType(){return this.constructor.dependencyType}setUpParameters(){}determineDownstreamComponents(){return{downstreamComponentNames:[],downstreamComponentTypes:[]}}initialize({downstreamComponentNames:t,downstreamComponentTypes:e,updatesNeeded:n,compositesBeingExpanded:r}){this.componentIdentitiesChanged=!0;let i=this.dependencyHandler.downstreamDependencies[this.upstreamComponentName];i||(i=this.dependencyHandler.downstreamDependencies[this.upstreamComponentName]={});for(let a of this.upstreamVariableNames)i[a]||(i[a]={}),i[a][this.dependencyName]=this;this.originalDownstreamVariableNames.length===0?(delete this.mappedDownstreamVariableNamesByComponent,delete this.upValuesChanged):(this.mappedDownstreamVariableNamesByComponent=[],this.valuesChanged=[]),this.downstreamComponentNames=[],this.downstreamComponentTypes=[];for(let[a,s]of t.entries())this.addDownstreamComponent({downstreamComponentName:s,downstreamComponentType:e[a],index:a,updatesNeeded:n,compositesBeingExpanded:r})}addDownstreamComponent({downstreamComponentName:t,downstreamComponentType:e,index:n,updatesNeeded:r,compositesBeingExpanded:i}){this.componentIdentitiesChanged=!0,this.downstreamComponentNames.splice(n,0,t),this.downstreamComponentTypes.splice(n,0,e);let a=this.dependencyHandler._components[t],s=this.originalDownstreamVariableNames;this.caseInsensitiveVariableMatch&&(s=this.dependencyHandler.core.findCaseInsensitiveMatches({stateVariables:s,componentClass:a.constructor})),this.publicStateVariablesOnly&&(s=this.dependencyHandler.core.matchPublicStateVariables({stateVariables:s,componentClass:a.constructor}));let o=this.dependencyHandler.core.substituteAliases({stateVariables:s,componentClass:a.constructor});this.constructor.convertToArraySize&&(o=o.map(function(f){let p=a.state[f];if(p)return p.arraySizeStateVariable?p.arraySizeStateVariable:`__${f}_is_not_an_array`;let d=Object.keys(a.arrayEntryPrefixes).sort((m,v)=>v.length-m.length);for(let m of d)if(f.substring(0,m.length)===m){let v=a.arrayEntryPrefixes[m];return a.state[v].arraySizeStateVariable}return`__${f}_is_not_an_array`})),this.propIndex!==void 0&&console.warn("Need to implement propIndex!");let u=o;if(this.originalDownstreamVariableNames.length>0){this.mappedDownstreamVariableNamesByComponent.splice(n,0,o);let f={};for(let p of o)f[p]={changed:!0};this.valuesChanged.splice(n,0,f),this.variablesOptional&&(u=u.filter(p=>p in a.state||this.dependencyHandler.core.checkIfArrayEntry({stateVariable:p,component:a})));for(let p of u){if(!a.state[p]){let d=this.dependencyHandler.core.createFromArrayEntry({component:a,stateVariable:p,updatesNeeded:r,compositesBeingExpanded:i});Object.keys(d.varsUnresolved).length>0&&this.dependencyHandler.core.addUnresolvedDependencies({varsUnresolved:d.varsUnresolved,component:a,updatesNeeded:r})}if(!a.state[p].isResolved){let d=this.dependencyHandler._components[this.upstreamComponentName],m={};for(let v of this.upstreamVariableNames)m[v]=[{componentName:t,stateVariable:p}];this.dependencyHandler.core.addUnresolvedDependencies({varsUnresolved:m,component:d,updatesNeeded:r});for(let v of this.upstreamVariableNames)d.state[v].isResolved&&(this.dependencyHandler.core.recordActualChangeInStateVariable({componentName:this.upstreamComponentName,varName:v,updatesNeeded:r}),d.state[v].isResolved=!1,this.dependencyHandler.core.resetUpstreamDependentsUnresolved({component:d,varName:v,updatesNeeded:r}))}}}u.length===0&&(u=[this.downstreamVariableNameIfNoVariables]);let c=this.dependencyHandler.upstreamDependencies[t];c||(c=this.dependencyHandler.upstreamDependencies[t]={});for(let f of u)if(c[f]===void 0&&(c[f]=[]),c[f].push(this),f!==this.downstreamVariableNameIfNoVariables)for(let p of this.upstreamVariableNames)this.dependencyHandler.resetCircularCheckPassed(this.upstreamComponentName,p);for(let f of this.upstreamVariableNames)this.dependencyHandler._components[this.upstreamComponentName].state[f].isResolved&&this.dependencyHandler.core.recordActualChangeInStateVariable({componentName:this.upstreamComponentName,varName:f,updatesNeeded:r})}removeDownstreamComponent({indexToRemove:t,updatesNeeded:e,recordChange:n=!0}){n&&(this.componentIdentitiesChanged=!0);let r=this.downstreamComponentNames[t];this.downstreamComponentNames.splice(t,1),this.downstreamComponentTypes.splice(t,1);let i;this.mappedDownstreamVariableNamesByComponent?(i=this.mappedDownstreamVariableNamesByComponent[t],this.mappedDownstreamVariableNamesByComponent.splice(t,1),this.valuesChanged.splice(t,1),this.variablesOptional&&i.push(this.downstreamVariableNameIfNoVariables)):i=[this.downstreamVariableNameIfNoVariables];for(let a of i){let s=this.dependencyHandler.upstreamDependencies[r][a];if(s){let o=s.indexOf(this);o!==-1&&(s.length===1?delete this.dependencyHandler.upstreamDependencies[r][a]:s.splice(o,1))}if(a!==this.downstreamVariableNameIfNoVariables)for(let o of this.upstreamVariableNames)this.dependencyHandler.resetCircularCheckPassed(this.upstreamComponentName,o)}if(n)for(let a of this.upstreamVariableNames)this.dependencyHandler._components[this.upstreamComponentName].state[a].isResolved&&this.dependencyHandler.core.recordActualChangeInStateVariable({componentName:this.upstreamComponentName,varName:a,updatesNeeded:e})}swapDownstreamComponents(t,e,n){this.componentIdentitiesChanged=!0,[this.downstreamComponentNames[t],this.downstreamComponentNames[e]]=[this.downstreamComponentNames[e],this.downstreamComponentNames[t]],[this.downstreamComponentTypes[t],this.downstreamComponentTypes[e]]=[this.downstreamComponentTypes[e],this.downstreamComponentTypes[t]],this.originalDownstreamVariableNames&&([this.mappedDownstreamVariableNamesByComponent[t],this.mappedDownstreamVariableNamesByComponent[e]]=[this.mappedDownstreamVariableNamesByComponent[e],this.mappedDownstreamVariableNamesByComponent[t]]);for(let r of this.upstreamVariableNames)this.dependencyHandler._components[this.upstreamComponentName].state[r].isResolved&&this.dependencyHandler.core.recordActualChangeInStateVariable({componentName:this.upstreamComponentName,varName:r,updatesNeeded:n})}delete(t){let e=[];if(!this.mappedDownstreamVariableNamesByComponent)e=Array(this.downstreamComponentNames.length).fill([this.downstreamVariableNameIfNoVariables]);else if(e=this.mappedDownstreamVariableNamesByComponent,this.variablesOptional){let r=[];for(let[i,a]of this.downstreamComponentNames.entries()){let s=[];for(let o of e[i])this.dependencyHandler.components[a].state[o]&&s.push(o);s.length>0?r.push(s):r.push([this.downstreamVariableNameIfNoVariables])}e=r}for(let[r,i]of this.downstreamComponentNames.entries())for(let a of e[r]){let s=this.dependencyHandler.upstreamDependencies[i][a];if(s){let o=s.indexOf(this);o!==-1&&(s.length===1?delete this.dependencyHandler.upstreamDependencies[i][a]:s.splice(o,1))}if(a!==this.downstreamVariableNameIfNoVariables)for(let o of this.upstreamVariableNames)this.dependencyHandler.resetCircularCheckPassed(this.upstreamComponentName,o)}for(let r of this.upstreamVariableNames)this.dependencyHandler._components[this.upstreamComponentName].state[r].isResolved&&this.dependencyHandler.core.recordActualChangeInStateVariable({componentName:this.upstreamComponentName,varName:r,updatesNeeded:t});this.deleteFromUpdateTriggers();let n=this.dependencyHandler.downstreamDependencies[this.upstreamComponentName];for(let r of this.upstreamVariableNames)delete n[r][this.dependencyName]}deleteFromUpdateTriggers(){}getValue({verbose:t=!1,skipProxy:e=!1}={}){let n=[],r={},i=!1;this.componentIdentitiesChanged&&(r.componentIdentitiesChanged=!0,this.componentIdentitiesChanged=!1);for(let[a,s]of this.downstreamComponentNames.entries()){let o=this.dependencyHandler.components[s],u={componentName:o.componentName,componentType:o.componentType};if(this.originalDownstreamVariableNames.length>0){u.stateValues={};for(let[c,f]of this.originalDownstreamVariableNames.entries()){let p=this.mappedDownstreamVariableNamesByComponent[a][c],d=this.useMappedVariableNames?p:f;(!this.variablesOptional||p in o.state)&&(o.state[p].deferred||(u.stateValues[d]=o.stateValues[p],this.valuesChanged[a][p].changed&&(r.valuesChanged||(r.valuesChanged={}),r.valuesChanged[a]||(r.valuesChanged[a]={}),r.valuesChanged[a][d]=this.valuesChanged[a][p]),this.valuesChanged[a][p]={}))}}n.push(u)}if(!t)if(this.returnSingleVariableValue)if(n.length===1){n=n[0];let a=Object.keys(n.stateValues);r.valuesChanged&&r.valuesChanged[0]&&r.valuesChanged[0][0]&&(r.valuesChanged=r.valuesChanged[0][0]),a.length===1?(n=n.stateValues[a[0]],i=this.dependencyHandler.components[this.downstreamComponentNames[0]].state[this.mappedDownstreamVariableNamesByComponent[0][0]].usedDefault):n=null}else n=null;else this.returnSingleComponent&&(n.length===1?(n=n[0],r.valuesChanged&&r.valuesChanged[0]&&(r.valuesChanged=r.valuesChanged[0])):n=null);return!this.doNotProxy&&!e&&n!==null&&typeof n=="object"&&(n=new Proxy(n,Be)),{value:n,changes:r,usedDefault:i}}checkForCircular(){for(let t of this.upstreamVariableNames)this.dependencyHandler.resetCircularCheckPassed(this.upstreamComponentName,t);for(let t of this.upstreamVariableNames)this.dependencyHandler.checkForCircularDependency({componentName:this.upstreamComponentName,varName:t})}recalculateDownstreamComponents(t,e){let n=this.determineDownstreamComponents(),r=n.downstreamComponentNames;if(r.length!==this.downstreamComponentNames.length||this.downstreamComponentNames.some((a,s)=>a!=r[s])){this.componentIdentitiesChanged=!0;let a=0;for(let[s,o]of[...this.downstreamComponentNames].entries())r.includes(o)||(this.removeDownstreamComponent({indexToRemove:s-a,updatesNeeded:t}),a++);for(let[s,o]of r.entries()){let u=this.downstreamComponentNames.indexOf(o);u!==-1?u!==s&&this.swapDownstreamComponents(u,s,t):this.addDownstreamComponent({downstreamComponentName:o,downstreamComponentType:n.downstreamComponentTypes[s],index:s,createVariables:!0,updatesNeeded:t,compositesBeingExpanded:e})}}}},gi=class extends It{static dependencyType="stateVariable";setUpParameters(){if(this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName,this.definition.variableName===void 0)throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableName is not defined`);this.originalDownstreamVariableNames=[this.definition.variableName],this.definition.returnAsComponentObject?this.returnSingleComponent=!0:this.returnSingleVariableValue=!0}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),e.includes(this)||e.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}return delete this.unresolvedSpecifiedComponent,{downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};dt.push(gi);var hb=class extends gi{static dependencyType="stateVariableComponentType";getValue({verbose:t=!1}={}){let e=[],n={};if(this.staticValue)e=[this.staticValue];else if(this.componentIdentitiesChanged&&(n.componentIdentitiesChanged=!0,this.componentIdentitiesChanged=!1),this.downstreamComponentNames.length===1){let r=this.downstreamComponentNames[0],i=this.dependencyHandler.components[r],a={componentName:i.componentName,componentType:i.componentType};a.stateValues={};let s=this.originalDownstreamVariableNames[0],o=this.mappedDownstreamVariableNamesByComponent[0][0],u=this.useMappedVariableNames?o:s;if((!this.variablesOptional||o in i.state)&&!i.state[o].deferred){let c=i.state[o];if(c.value,a.stateValues[u]=c.componentType,c.isArray&&c.wrappingComponents&&c.wrappingComponents.length>0){let p=c.wrappingComponents[c.wrappingComponents.length-1][0];typeof p=="object"&&(p=p.componentType),a.stateValues[u]=p}this.valuesChanged[0][o].changed&&(n.valuesChanged||(n.valuesChanged={}),n.valuesChanged[0]||(n.valuesChanged[0]={}),n.valuesChanged[0][u]=this.valuesChanged[0][o]),this.valuesChanged[0][o]={};let f=c.hasVariableComponentType;!f&&c.isArrayEntry&&(f=i.state[c.arrayStateVariable].hasVariableComponentType),f||(this.staticValue=a,this.removeDownstreamComponent({indexToRemove:0,recordChange:!1}))}e=[a]}if(!t)if(this.returnSingleVariableValue)if(e.length===1){e=e[0];let r=Object.keys(e.stateValues);n.valuesChanged&&n.valuesChanged[0]&&n.valuesChanged[0][0]&&(n.valuesChanged=n.valuesChanged[0][0]),r.length===1?e=e.stateValues[r[0]]:e=null}else e=null;else this.returnSingleComponent&&(e.length===1?(e=e[0],n.valuesChanged&&n.valuesChanged[0]&&(n.valuesChanged=n.valuesChanged[0])):e=null);return!this.doNotProxy&&e!==null&&typeof e=="object"&&(e=new Proxy(e,Be)),{value:e,changes:n,usedDefault:!1}}};dt.push(hb);var vb=class extends gi{static dependencyType="stateVariableArraySize";static convertToArraySize=!0};dt.push(vb);var yb=class extends It{static dependencyType="recursiveDependencyValues";setUpParameters(){if(this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName,this.definition.variableName===void 0)throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableName is not defined`);this.originalDownstreamVariableNames=[this.definition.variableName],this.changedValuesOnly=this.definition.changedValuesOnly,this.returnSingleVariableValue=!1}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),e.includes(this)||e.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}return delete this.unresolvedSpecifiedComponent,{downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}getValue(){let t=this.mappedDownstreamVariableNamesByComponent[0][0];this.dependencyHandler._components[this.componentName].stateValues[t];let e=this.getStateVariableRecursiveDependencyValues({componentName:this.componentName,stateVariable:t,changedValuesOnly:this.changedValuesOnly}),n={};return this.valuesChanged[0][t]&&(n={valuesChanged:this.valuesChanged[0][t]}),this.valuesChanged[0][t]={},{value:e,changes:n}}getStateVariableRecursiveDependencyValues({componentName:t,stateVariable:e,changedValuesOnly:n}){let r=this.dependencyHandler._components[t],i=this.dependencyHandler.downstreamDependencies[r.componentName][e],a=r.state[e].recursiveDependencyValues={};for(let s in i){let o=i[s],u=o.getValue({verbose:!0}).value;for(let[c,f]of o.downstreamComponentNames.entries()){let p=a[f];p===void 0&&(p=a[f]={});let d=this.dependencyHandler.core.changedStateVariables[f],m=[];if(o.originalDownstreamVariableNames.length>0&&(m=o.mappedDownstreamVariableNamesByComponent[c],o.variablesOptional)){let v=m;m=[];for(let h of v)(h in this.dependencyHandler._components[f].state||this.dependencyHandler.core.checkIfArrayEntry({stateVariable:h,component:this.dependencyHandler._components[f]}))&&m.push(h)}for(let v of m)if(!(v in p)){if(!n||d){let y=u[c].stateValues[v];if(!n)p[v]=y;else{let g=this.dependencyHandler._components[f].state[v];if(g)if(g.isArray||g.isArrayEntry){let b,x;g.isArray?(x=v,b=g.getAllArrayKeys(g.arraySize)):(x=g.arrayStateVariable,b=g.arrayKeys),d[x]&&b.some(N=>d[x].has(N))&&(p[v]=y)}else d[v]&&(p[v]=y)}}let h=this.getStateVariableRecursiveDependencyValues({componentName:f,stateVariable:v,changedValuesOnly:n});for(let y in h){let g=a[y];g===void 0&&(g=a[y]={}),Object.assign(g,h[y])}}Object.keys(p).length===0&&delete a[f]}}return a}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};dt.push(yb);var gb=class extends It{static dependencyType="componentIdentity";setUpParameters(){this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName,this.returnSingleComponent=!0}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),e.includes(this)||e.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}return delete this.unresolvedSpecifiedComponent,{downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};dt.push(gb);var bb=class extends It{static dependencyType="child";setUpParameters(){if(this.definition.parentName?(this.parentName=this.definition.parentName,this.specifiedComponentName=this.parentName):this.parentName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.childLogicName=this.definition.childLogicName,this.definition.childIndices!==void 0&&(this.childIndices=this.definition.childIndices.map(t=>Number(t)))}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.parentName];if(!t){if(this.specifiedComponentName){let a=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];a||(a=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),a.includes(this)||a.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}delete this.unresolvedSpecifiedComponent;let e=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName];e||(e=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName]=[]),e.includes(this)||e.push(this);let n=t.childLogic.returnMatches(this.definition.childLogicName);if(n===void 0)throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: childLogicName ${this.definition.childLogicName} does not exist.`);this.childIndices&&(n=n.filter((a,s)=>this.childIndices.includes(s)));let r=n.map(a=>t.activeChildren[a]),i=r.map(a=>a.componentName);this.compositeIndices=[];for(let[a,s]of t.definingChildren.entries())if(this.dependencyHandler.componentInfoObjects.isInheritedComponentType({inheritedComponentType:s.componentType,baseComponentType:"_composite"})&&s.isExpanded){let o=s.stateValues.fullRecursiveReplacements.map(u=>this.dependencyHandler.components[u.componentName]).map(u=>u.adapterUsed?u.adapterUsed:u).map(u=>u.componentName);for(let[u,c]of i.entries())o.includes(c)&&(this.compositeIndices[u]=a)}return{downstreamComponentNames:i,downstreamComponentTypes:r.map(a=>a.componentType)}}getValue({verbose:t}={}){let e=super.getValue({verbose:t,skipProxy:!0});for(let[n,r]of this.compositeIndices.entries())r!==void 0&&(e.value[n].compositeInd=r);return this.doNotProxy||(e.value=new Proxy(e.value,Be)),e}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(e){let n=e.indexOf(this);n!==-1&&e.splice(n,1)}}}};dt.push(bb);var xb=class extends It{static dependencyType="descendant";setUpParameters(){if(this.definition.ancestorName?(this.ancestorName=this.definition.ancestorName,this.specifiedComponentName=this.ancestorName):this.ancestorName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.componentTypes=this.definition.componentTypes.map(t=>t.toLowerCase()),this.recurseToMatchedChildren=this.definition.recurseToMatchedChildren,this.useReplacementsForComposites=this.definition.useReplacementsForComposites,this.includeNonActiveChildren=this.definition.includeNonActiveChildren,this.includePropertyChildren=this.definition.includePropertyChildren,this.skipOverAdapters=this.definition.skipOverAdapters,this.ignoreReplacementsOfMatchedComposites=this.definition.ignoreReplacementsOfMatchedComposites,this.definingChildrenFirst=this.definition.definingChildrenFirst}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.ancestorName];if(!t){if(this.specifiedComponentName){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),r.includes(this)||r.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}delete this.unresolvedSpecifiedComponent;let e=this.dependencyHandler.updateTriggers.descendantDependenciesByAncestor[this.ancestorName];e||(e=this.dependencyHandler.updateTriggers.descendantDependenciesByAncestor[this.ancestorName]=[]),e.includes(this)||e.push(this);let n=Vu({ancestor:t,descendantClasses:this.componentTypes.map(r=>this.dependencyHandler.componentInfoObjects.allComponentClasses[r]),recurseToMatchedChildren:this.recurseToMatchedChildren,useReplacementsForComposites:this.useReplacementsForComposites,includeNonActiveChildren:this.includeNonActiveChildren,includePropertyChildren:this.includePropertyChildren,skipOverAdapters:this.skipOverAdapters,ignoreReplacementsOfMatchedComposites:this.ignoreReplacementsOfMatchedComposites,definingChildrenFirst:this.definingChildrenFirst,compositeClass:this.dependencyHandler.componentInfoObjects.allComponentClasses._composite});return{downstreamComponentNames:n.map(r=>r.componentName),downstreamComponentTypes:n.map(r=>r.componentType)}}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.descendantDependenciesByAncestor[this.ancestorName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(e){let n=e.indexOf(this);n!==-1&&e.splice(n,1)}}}};dt.push(xb);var Cb=class extends It{static dependencyType="parentStateVariable";setUpParameters(){if(this.definition.childName?(this.childName=this.definition.childName,this.specifiedComponentName=this.childName):this.childName=this.upstreamComponentName,this.definition.variableName)this.originalDownstreamVariableNames=[this.definition.variableName];else throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: must have a variableName`);this.returnSingleVariableValue=!0,this.variablesOptional=!0}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.childName];if(!t){if(this.specifiedComponentName){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),r.includes(this)||r.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}if(delete this.unresolvedSpecifiedComponent,!t.parentName)return{downstreamComponentNames:[],downstreamComponentTypes:[]};this.parentName=t.parentName;let e=this.dependencyHandler._components[this.parentName];if(!e){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];return r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName]=[]),r.includes(this)||r.push(this),this.unresolvedSpecifiedComponent=this.parentName,{downstreamComponentNames:[],downstreamComponentTypes:[]}}let n=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName];return n||(n=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName]=[]),n.includes(this)||n.push(this),{downstreamComponentNames:[this.parentName],downstreamComponentTypes:[e.componentType]}}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.parentDependenciesByParent[this.parentName];if(t){let n=t.indexOf(this);n!==-1&&t.splice(n,1)}if(this.specifiedComponentName){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(n){let r=n.indexOf(this);r!==-1&&n.splice(r,1)}}let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];if(e){let n=e.indexOf(this);n!==-1&&e.splice(n,1)}}};dt.push(Cb);var Nb=class extends It{static dependencyType="ancestor";setUpParameters(){if(this.definition.descendantName?(this.descendantName=this.definition.descendantName,this.specifiedComponentName=this.descendantName):this.descendantName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.returnSingleComponent=!0}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.descendantName];if(!t){if(this.specifiedComponentName){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),n.includes(this)||n.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}delete this.unresolvedSpecifiedComponent,this.definition.componentType&&(this.componentType=this.definition.componentType.toLowerCase());let e=this.findMatchingAncestor(t);if(e.missingComponentName){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[e.missingComponentName];return n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[e.missingComponentName]=[]),n.includes(this)||n.push(this),this.unresolvedSpecifiedComponent=e.missingComponentName,{downstreamComponentNames:[],downstreamComponentTypes:[]}}for(let n of e.ancestorsExamined){let r=this.dependencyHandler.updateTriggers.ancestorDependenciesByPotentialAncestor[n];r||(r=this.dependencyHandler.updateTriggers.ancestorDependenciesByPotentialAncestor[n]=[]),r.includes(this)||r.push(this)}return this.ancestorResults=e,e.ancestorFound?{downstreamComponentNames:[e.ancestorFound.componentName],downstreamComponentTypes:[e.ancestorFound.componentType]}:{downstreamComponentNames:[],downstreamComponentTypes:[]}}findMatchingAncestor(t){let e=[];if(this.componentType){for(let r of t.ancestors){let i=this.dependencyHandler._components[r.componentName];if(!i)return{missingComponentName:r.componentName};if(e.push(r.componentName),this.dependencyHandler.componentInfoObjects.isInheritedComponentType({inheritedComponentType:i.componentType,baseComponentType:this.componentType}))return{ancestorsExamined:e,ancestorFound:r}}return{ancestorsExamined:e}}if(this.originalDownstreamVariableNames.length===0)return console.warn(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: must specify componentType or variableNames to find ancestor`),{ancestorsExamined:e};let n=this.originalDownstreamVariableNames;for(let r of t.ancestors){let i=this.dependencyHandler._components[r.componentName];if(!i)return{missingComponentName:r.componentName};e.push(r.componentName);let a=!0;for(let s of n)if(!(s in i.state||this.dependencyHandler.core.checkIfArrayEntry({stateVariable:s,component:i}))){a=!1;break}if(a)return{ancestorsExamined:e,ancestorFound:r}}return{ancestorsExamined:e}}deleteFromUpdateTriggers(){for(let t of this.ancestorResults.ancestorsExamined){let e=this.dependencyHandler.updateTriggers.ancestorDependenciesByPotentialAncestor[t];if(e){let n=e.indexOf(this);n!==-1&&e.splice(n,1)}}if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}if(this.ancestorResults&&this.ancestorResults.missingComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.ancestorResults.missingComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};dt.push(Nb);var wb=class extends It{static dependencyType="replacement";setUpParameters(){if(this.definition.compositeName?(this.compositeName=this.definition.compositeName,this.specifiedComponentName=this.compositeName):this.compositeName=this.upstreamComponentName,this.definition.variableNames){if(!Array.isArray(this.definition.variableNames))throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: variableNames must be an array`);this.originalDownstreamVariableNames=this.definition.variableNames}else this.originalDownstreamVariableNames=[];this.recursive=this.definition.recursive,this.recurseNonStandardComposites=this.definition.recurseNonStandardComposites,Number.isInteger(this.definition.componentIndex)&&(this.componentIndex=this.definition.componentIndex),this.expandReplacements=!0}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.compositeName];if(!t){if(this.specifiedComponentName){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),n.includes(this)||n.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}delete this.unresolvedSpecifiedComponent,this.compositesFound=[this.compositeName];let e=t.replacements;if(!e)e=[];else if(this.recursive){let n=this.dependencyHandler.core.recursivelyReplaceCompositesWithReplacements({replacements:e,recurseNonStandardComposites:this.recurseNonStandardComposites});e=n.newReplacements,this.compositesFound.push(...n.compositesFound)}for(let n of this.compositesFound){let r=this.dependencyHandler.updateTriggers.replacementDependenciesByComposite[n];r||(r=this.dependencyHandler.updateTriggers.replacementDependenciesByComposite[n]=[]),r.includes(this)||r.push(this)}if(this.componentIndex!==void 0){let n=e[this.componentIndex-1];n?e=[n]:e=[]}return{downstreamComponentNames:e.map(n=>n.componentName),downstreamComponentTypes:e.map(n=>n.componentType)}}deleteFromUpdateTriggers(){for(let t of this.compositesFound){let e=this.dependencyHandler.updateTriggers.replacementDependenciesByComposite[t];if(e){let n=e.indexOf(this);n!==-1&&e.splice(n,1)}}if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};dt.push(wb);var Tb=class extends It{static dependencyType="sourceCompositeStateVariable";setUpParameters(){if(this.definition.replacementName?(this.replacementName=this.definition.replacementName,this.specifiedComponentName=this.replacementName):this.replacementName=this.upstreamComponentName,this.definition.variableName)this.originalDownstreamVariableNames=[this.definition.variableName];else throw Error(`Invalid state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}: must have a variableName`);this.returnSingleVariableValue=!0,this.variablesOptional=!0}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.replacementName];if(!t){if(this.specifiedComponentName){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];n||(n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),n.includes(this)||n.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}if(delete this.unresolvedSpecifiedComponent,!t.replacementOf)return{downstreamComponentNames:[],downstreamComponentTypes:[]};let e=t.replacementOf;return{downstreamComponentNames:[e.componentName],downstreamComponentTypes:[e.componentType]}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};dt.push(Tb);var _b=class extends It{static dependencyType="countAmongSiblingsOfSameType";setUpParameters(){this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){if(this.specifiedComponentName){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),r.includes(this)||r.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}if(delete this.unresolvedSpecifiedComponent,!t.parentName)return console.warn(`component ${this.componentName} does not have a parent for state variable ${this.representativeStateVariable} of ${this.upstreamComponentName}, dependency ${this.dependencyName}.`),{downstreamComponentNames:[],downstreamComponentTypes:[]};this.parentName=t.parentName;let e=this.dependencyHandler._components[this.parentName];if(!e){let r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];return r||(r=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName]=[]),r.includes(this)||r.push(this),this.unresolvedSpecifiedComponent=this.parentNam,{downstreamComponentNames:[],downstreamComponentTypes:[]}}let n=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName];return n||(n=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName]=[]),n.includes(this)||n.push(this),{downstreamComponentNames:e.activeChildren.map(r=>r.componentName),downstreamComponentTypes:e.activeChildren.map(r=>r.componentType)}}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.childDependenciesByParent[this.parentName];if(t){let n=t.indexOf(this);n!==-1&&t.splice(n,1)}if(this.specifiedComponentName){let n=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(n){let r=n.indexOf(this);r!==-1&&n.splice(r,1)}}let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.parentName];if(e){let n=e.indexOf(this);n!==-1&&e.splice(n,1)}}getValue(){let t=this.dependencyHandler.components[this.upstreamComponentName].componentType;return{value:this.dependencyHandler.components[this.parentName].activeChildren.filter(r=>r.componentType===t).map(r=>r.componentName).indexOf(this.upstreamComponentName)+1,changes:{}}}};dt.push(_b);var Ab=class extends It{static dependencyType="targetComponent";setUpParameters(){let t=this.dependencyHandler._components[this.upstreamComponentName];this.tName=t.doenetAttributes.tName,this.tName&&(this.targetComponentName=this.specifiedComponentName=t.doenetAttributes.fullTName),this.returnSingleComponent=!0}determineDownstreamComponents(){if(!this.tName)return{downstreamComponentNames:[],downstreamComponentTypes:[]};let t=this.dependencyHandler._components[this.targetComponentName];if(!t){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];return e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),e.includes(this)||e.push(this),this.unresolvedSpecifiedComponent=this.targetComponentName,{downstreamComponentNames:[],downstreamComponentTypes:[]}}return delete this.unresolvedSpecifiedComponent,{downstreamComponentNames:[this.targetComponentName],downstreamComponentTypes:[t.componentType]}}deleteFromUpdateTriggers(){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}};dt.push(Ab);var Ou=class extends It{static dependencyType="value";setUpParameters(){this.value=this.definition.value}getValue(){return{value:this.value,changes:{}}}};dt.push(Ou);var $b=class extends Ou{static dependencyType="flag";setUpParameters(){this.flagName=this.definition.flagName,this.value=this.dependencyHandler.core.flags[this.flagName]}};dt.push($b);var Sb=class extends gi{static dependencyType="doenetAttribute";setUpParameters(){this.attributeName=this.definition.attributeName,this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName}getValue(){let t=null,e={};return this.componentIdentitiesChanged&&(e.componentIdentitiesChanged=!0,this.componentIdentitiesChanged=!1),this.downstreamComponentNames.length===1&&(t=this.dependencyHandler.components[this.downstreamComponentNames[0]].doenetAttributes[this.attributeName]),!this.doNotProxy&&t!==null&&typeof t=="object"&&(t=new Proxy(t,Be)),{value:t,changes:e}}};dt.push(Sb);var Db=class extends It{static dependencyType="serializedChildren";setUpParameters(){this.definition.parentName?(this.parentName=this.definition.parentName,this.specifiedComponentName=this.parentName):this.parentName=this.upstreamComponentName}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.parentName];if(!t){if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),e.includes(this)||e.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}return delete this.unresolvedSpecifiedComponent,{downstreamComponentNames:[this.parentName],downstreamComponentTypes:[t.componentType]}}getValue(){return{value:this.dependencyHandler._components[this.parentName].serializedChildren,changes:{}}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};dt.push(Db);var Vb=class extends It{static dependencyType="variants";setUpParameters(){this.definition.componentName?(this.componentName=this.definition.componentName,this.specifiedComponentName=this.componentName):this.componentName=this.upstreamComponentName}determineDownstreamComponents(){let t=this.dependencyHandler._components[this.componentName];if(!t){if(this.specifiedComponentName){let e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];e||(e=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName]=[]),e.includes(this)||e.push(this),this.unresolvedSpecifiedComponent=this.specifiedComponentName}return{downstreamComponentNames:[],downstreamComponentTypes:[]}}return delete this.unresolvedSpecifiedComponent,{downstreamComponentNames:[this.componentName],downstreamComponentTypes:[t.componentType]}}getValue(){return{value:this.dependencyHandler._components[this.componentName].variants,changes:{}}}deleteFromUpdateTriggers(){if(this.specifiedComponentName){let t=this.dependencyHandler.updateTriggers.dependenciesMissingComponentBySpecifiedName[this.specifiedComponentName];if(t){let e=t.indexOf(this);e!==-1&&t.splice(e,1)}}}};dt.push(Vb);var Lb=De(Mb()),Rb=De(Eb());var Pu=class{constructor({doenetML:t,doenetState:e,parameters:n,requestedVariant:r,externalFunctions:i,flags:a={},coreReadyCallback:s,coreUpdatedCallback:o}){this.numerics=new pb,this.flags=new Proxy(a,Be),this.switches={ignoreRequireChildLogicInitiallySatisfied:!1,ignoreUnresolvedSpecifiedComponents:!1},this.externalFunctions=i,i===void 0&&(this.externalFunctions={}),this.requestUpdate=this.requestUpdate.bind(this),this.requestAction=this.requestAction.bind(this),this.requestRecordEvent=this.requestRecordEvent.bind(this),this.requestAnimationFrame=this.requestAnimationFrame.bind(this),this._requestAnimationFrame=this._requestAnimationFrame.bind(this),this.cancelAnimationFrame=this.cancelAnimationFrame.bind(this),this.calculateScoredItemNumberOfContainer=this.calculateScoredItemNumberOfContainer.bind(this),this.expandDoenetMLsToFullSerializedState=this.expandDoenetMLsToFullSerializedState.bind(this),this.finishCoreConstruction=this.finishCoreConstruction.bind(this),this.getStateVariableValue=this.getStateVariableValue.bind(this),this.submitResponseCallBack=this.submitResponseCallBack.bind(this),this.coreUpdatedCallback=o,this.coreReadyCallback=function(){s(),this.requestRecordEvent({verb:"experienced",object:{componentName:this.document.componentName,componentType:"document"}})}.bind(this),this._standardComponentClasses=ob(),this._allComponentClasses=lb(),this._componentTypesCreatingVariants=ub(),this._componentTypeWithPotentialVariants=cb(),this._allPossibleProperties=this.createAllPossibleProperties(),this.stateVariableInfo={};for(let c in this.allComponentClasses)Object.defineProperty(this.stateVariableInfo,c,{get:function(){let f=this.allComponentClasses[c].returnStateVariableInfo({standardComponentClasses:this.standardComponentClasses,allComponentClasses:this.allComponentClasses});return delete this.stateVariableInfo[c],this.stateVariableInfo[c]=f}.bind(this),configurable:!0});this.publicStateVariableInfo={};for(let c in this.allComponentClasses)Object.defineProperty(this.publicStateVariableInfo,c,{get:function(){let f=this.allComponentClasses[c].returnStateVariableInfo({onlyPublic:!0,standardComponentClasses:this.standardComponentClasses,allComponentClasses:this.allComponentClasses});return delete this.publicStateVariableInfo[c],this.publicStateVariableInfo[c]=f}.bind(this),configurable:!0});this.componentInfoObjects={standardComponentClasses:this.standardComponentClasses,allComponentClasses:this.allComponentClasses,componentTypesCreatingVariants:this.componentTypesCreatingVariants,componentTypeWithPotentialVariants:this.componentTypeWithPotentialVariants,allPossibleProperties:this.allPossibleProperties,isInheritedComponentType:this.isInheritedComponentType,isCompositeComponent:this.isCompositeComponent,stateVariableInfo:this.stateVariableInfo,publicStateVariableInfo:this.publicStateVariableInfo},this.coreFunctions={requestUpdate:this.requestUpdate,requestAction:this.requestAction,requestRecordEvent:this.requestRecordEvent,requestAnimationFrame:this.requestAnimationFrame,cancelAnimationFrame:this.cancelAnimationFrame,calculateScoredItemNumberOfContainer:this.calculateScoredItemNumberOfContainer,recordSolutionView:this.externalFunctions.recordSolutionView},this.animationIDs={},this.lastAnimationID=0,this.requestedVariant=r,this.parameterStack=new fb(n),this.setUpRng();let u;if(e){u=e;let c;u[0].doenetAttributes&&(c=u[0].doenetAttributes.contentId),c===void 0&&(c=""),console.log(`contentId from doenetState: ${c}`),this.finishCoreConstruction({contentIds:[c],fullSerializedStates:[u],finishSerializedStateProcessing:!1})}else{let c=Rb.default.stringify((0,Lb.default)(JSON.stringify(t)));this.expandDoenetMLsToFullSerializedState({contentIds:[c],doenetMLs:[t],callBack:this.finishCoreConstruction})}}finishCoreConstruction({contentIds:t,fullSerializedStates:e,finishSerializedStateProcessing:n=!0,calledAsynchronously:r=!1}){this.contentId=t[0];let i=e[0];rc(i),n?Vr({serializedComponents:i,componentInfoObjects:this.componentInfoObjects}):i[0].doenetAttributes===void 0&&(i[0].doenetAttributes={}),console.log("serialized components at the beginning"),console.log(He(i)),this.documentName=i[0].componentName,i[0].doenetAttributes.contentId=this.contentId,this._components={},this.renderedComponentInstructions={},this.componentsWithChangedChildrenToRender=new Set([]),this._renderComponents=[],this._renderComponentsByName={},this._graphRenderComponents=[],this.dependencies=new Mu({_components:this._components,componentInfoObjects:this.componentInfoObjects,core:this}),this.unsatisfiedChildLogic={},this.setUpVariants(i),window.state={components:this._components,renderedComponentInstructions:this.renderedComponentInstructions,renderedComponentTypes:this.renderedComponentTypes,dependencies:this.dependencies,core:this,componentInfoObjects:this.componentInfoObjects},this.changedStateVariables={},this.addComponents({serializedComponents:i,initialAdd:!0}),this.rendererTypesInDocument=this.document.allPotentialRendererTypes,this.document.stateValues.itemCreditAchieved,console.log("** components at the end of the core constructor **"),console.log(this._components),r?this.coreReadyCallback():setTimeout(()=>this.coreReadyCallback(),0)}setUpVariants(t){let e=Yn({serializedComponents:t,componentTypesCreatingVariants:this.componentTypesCreatingVariants,allComponentClasses:this.allComponentClasses});this.requestedVariant!==void 0&&(this.parameterStack.parameters.variant=this.requestedVariant),e[0].variants.desiredVariant=this.parameterStack.parameters.variant}setUpRng(){this.parameterStack.parameters.hashStringToInteger=function(t){var e=0,n,r;if(t.length===0)return e;for(n=0;n<t.length;n++)r=t.charCodeAt(n),e=(e<<5)-e+r,e|=0;return e},this.parameterStack.parameters.seed===void 0&&(this.parameterStack.parameters.seed=this.parameterStack.parameters.hashStringToInteger(Date.now().toString())),this.parameterStack.parameters.selectRng=new Eu.default(this.parameterStack.parameters.seed),this.parameterStack.parameters.rngClass=Eu.default}expandDoenetMLsToFullSerializedState({contentIds:t,doenetMLs:e,callBack:n}){let r=[],i={};for(let s of e){let o=Fi({doenetML:s,standardComponentClasses:this.standardComponentClasses,allComponentClasses:this.allComponentClasses});hn(o,this.standardComponentClasses),o=Jn(o,this.componentInfoObjects),gs(o),bs({serializedComponents:o,componentInfoObjects:this.componentInfoObjects}),r.push(o);let u=ys({serializedComponents:o});for(let c in u)i[c]===void 0&&(i[c]=[]),i[c].push(...u[c])}let a=Object.keys(i);if(a.length>0){let s=function({fullSerializedStates:u}){for(let[c,f]of a.entries()){let p=u[c];for(let d of i[f])d.state===void 0&&(d.state={}),d.state.serializedStateForContentId=p}n({contentIds:t,fullSerializedStates:r,calledAsynchronously:!0})}.bind(this),o=function({newDoenetMLs:u,newContentIds:c,success:f,message:p}){f||console.warn(p),this.expandDoenetMLsToFullSerializedState({doenetMLs:u,contentIds:c,callBack:s})}.bind(this);this.externalFunctions.contentIdsToDoenetMLs({contentIds:a,callBack:o})}else n({contentIds:t,fullSerializedStates:r,calledAsynchronously:!1})}addComponents({serializedComponents:t,parent:e,indexOfDefiningChildren:n,initialAdd:r=!1}){Array.isArray(t)||(t=[t]);let i,a=[];e&&(i=e.componentName,a=[{componentName:i,componentClass:e.constructor},...e.ancestors]);let s=this.createIsolatedComponents({serializedComponents:t,ancestors:a});if(s.success!==!0)throw Error(s.message);let o=s.components,u={},c={};if(o.forEach(f=>c[f.componentName]=f),r===!0){if(o.length!==1)throw Error("Initial components need to be an array of just one component.");this.document=o[0],this.initializeRenderedComponentInstruction(this.document)}else{if(e===void 0)throw Error("Must specify parent when adding components.");if(n===void 0&&(n=e.definingChildren.length),e.isShadow===!0)throw Error("Cannot add components to a shadow component "+e.componentName);let f=this.addChildren({parent:e,indexOfDefiningChildren:n,newChildren:o});if(!f.success)throw Error("Couldn't satisfy child logic result.  Need informative error message");Object.assign(c,f.addedComponents),Object.assign(u,f.deletedComponents),this.updateRendererInstructions({componentNames:this.componentAndRenderedDescendants(e)})}return this.finishUpdate({addedComponents:c,deletedComponents:u,init:r}),o}updateRendererInstructions({componentNames:t,sourceOfUpdate:e,recreatedComponents:n={}}){let r=[],i=[],a=[];for(let s of t){let o=this._components[s];o&&(o.stateValues.childrenToRender,s in this.renderedComponentInstructions&&r.push(s))}for(let s of this.componentsWithChangedChildrenToRender)if(s in this.renderedComponentInstructions){let o=[],u=this._components[s];u&&(o=u.stateValues.childrenToRender);let c=this.renderedComponentInstructions[s].children,f=c.map(v=>v.componentName),p=[],d=[];for(let[v,h]of f.entries())o.includes(h)&&!n[h]?p.push(h):d.push({childName:h,ind:v});for(let{childName:v,ind:h}of d.reverse()){let y=this.deleteFromRenderedComponentInstructions({componentName:v,recurseToChildren:!0});c.splice(h,1),a.push({instructionType:"deleteRenderers",parentName:s,firstIndexInParent:h,numberChildrenDeleted:1,deletedComponentNames:y}),i.push(...y)}let m=o.filter(v=>p.includes(v));for(let v=0;v<m.length;v++)if(p[v]!==m[v]){let h=p.indexOf(m[v]);[c[v],c[h]]=[c[h],c[v]],[p[v],p[h]]=[p[h],p[v]],a.push({instructionType:"swapChildRenderers",parentName:s,index1:v,index2:h})}for(let[v,h]of o.entries())if(!f.includes(h)||n[h]){let y=this._components[h];if(y&&y.rendererType){let g=this.initializeRenderedComponentInstruction(y);c.splice(v,0,g),a.push({instructionType:"addRenderer",componentName:y.componentName,parentName:s,indexForParent:v})}}}if(this.componentsWithChangedChildrenToRender=new Set([]),r=r.filter(s=>!i.includes(s)),r.length>0){let s={instructionType:"updateStateVariable",renderersToUpdate:r,sourceOfUpdate:e};a.push(s)}this.coreUpdatedCallback(a)}initializeRenderedComponentInstruction(t){if(t.rendererType===void 0)return;let e=t.componentName,n=[];if(t.stateValues.childrenToRender)for(let i of t.stateValues.childrenToRender){let a=this._components[i];!a||!a.rendererType||n.push(this.initializeRenderedComponentInstruction(a))}this.componentsWithChangedChildrenToRender.delete(e);let r={};for(let i in t.state)t.state[i].forRenderer&&(r[i]=t.state[i]);return this.renderedComponentInstructions[e]={componentName:e,componentType:t.componentType,rendererType:t.rendererType,stateValues:new Proxy(r,Un()),children:n,actions:t.actions},this.renderedComponentInstructions[e]}deleteFromRenderedComponentInstructions({componentName:t,recurseToChildren:e=!0}){let n=[t];if(e){let r=this.renderedComponentInstructions[t];if(r)for(let i of r.children){let a=this.deleteFromRenderedComponentInstructions({componentName:i.componentName,recurseToChildren:e});n.push(...a)}}return delete this.renderedComponentInstructions[t],n}componentAndRenderedDescendants(t){if(t===void 0)return[];let e=[t.componentName];if(t.state.childrenToRender.isResolved&&t.stateValues.childrenToRender)for(let n of t.stateValues.childrenToRender)e.push(...this.componentAndRenderedDescendants(this._components[n]));return e}createIsolatedComponents({serializedComponents:t,ancestors:e,applyAdapters:n=!0,shadow:r=!1,compositesBeingExpanded:i=[]}){let a={componentsTouched:[],compositesToExpand:new Set([]),compositesToUpdateReplacements:[],componentsToUpdateDependencies:[],unresolvedDependencies:{},unresolvedByDependent:{},deletedStateVariables:{},deletedComponents:{},recreatedComponents:{},itemScoreChanges:new Set,parentsToUpdateDescendants:new Set},s=Object.assign({},this.unsatisfiedChildLogic),o="/";if(e.length>0){let f=e[0].componentName,p=this.components[f];p.doenetAttributes.newNamespace?o=p.componentName+"/":o=mn(p.componentName)}let c=this.createIsolatedComponentsSub({serializedComponents:t,ancestors:e,applyAdapters:n,shadow:r,updatesNeeded:a,compositesBeingExpanded:i,namespaceForUnamed:o}).components;if(Object.keys(a.unresolvedDependencies).length>0&&(a.unresolvedMessage="",this.resolveAllDependencies(a,i)),this.dependencies.updateDependencies(a,i),Object.keys(a.unresolvedDependencies).length>0)return console.log("have some unresolved"),console.log(a.unresolvedDependencies),console.log(a.unresolvedByDependent),{success:!1,message:a.unresolvedMessage,updatesNeeded:a};if(Object.keys(this.unsatisfiedChildLogic).length>0){let f="",p=!1;for(let d in this.unsatisfiedChildLogic)f+=`Invalid children for ${d}: ${this.unsatisfiedChildLogic[d].message} `,d in s||(p=!0);if(p)return{success:!1,message:f,updatesNeeded:a}}return{success:!0,components:c,componentsTouched:[...new Set(a.componentsTouched)]}}createIsolatedComponentsSub({serializedComponents:t,ancestors:e,applyAdapters:n=!0,shadow:r=!1,updatesNeeded:i,compositesBeingExpanded:a,createNameContext:s="",namespaceForUnamed:o="/",componentsReplacementOf:u}){let c=[],f="";for(let[d,m]of t.entries()){if(m.createdComponent===!0){let b=this._components[m.componentName];c.push(b),this.setAncestors(b,e);continue}let v;try{v=this.standardComponentClasses[m.componentType]}catch(b){throw this.standardComponentClasses[m.componentType]===void 0?Error("Cannot create component of type "+m.componentType):b}if(v===void 0)throw Error("Cannot create component of type "+m.componentType);m.doenetAttributes||(m.doenetAttributes={});let h=m.componentName;if(h===void 0){let x=e[0].componentName+"|"+s+"|";m.uniqueIdentifier?x+=m.uniqueIdentifier:x+=d,h=qr(m.componentType,x),h=o+h}let g=this.createChildrenThenComponent({serializedComponent:m,componentName:h,ancestors:e,componentClass:v,applyAdapters:n,shadow:r,updatesNeeded:i,compositesBeingExpanded:a,namespaceForUnamed:o,componentsReplacementOf:u}).newComponent;c.push(g)}return{components:c}}createChildrenThenComponent({serializedComponent:t,componentName:e,ancestors:n,componentClass:r,applyAdapters:i=!0,shadow:a=!1,updatesNeeded:s,compositesBeingExpanded:o,namespaceForUnamed:u="/",componentsReplacementOf:c}){let f=t.children,p=[],d=[],m=[{componentName:e,componentClass:r},...n],v=this.parameterStack.parameters;this.parameterStack.push();let h=this.parameterStack.parameters,y=this.propagateAncestorProps({componentClass:r,componentName:e,sharedParameters:h});if(r.modifySharedParameters&&r.modifySharedParameters({sharedParameters:h,serializedComponent:t}),t.doenetAttributes.pushSharedParameters)for(let A of t.doenetAttributes.pushSharedParameters){let $=A.parameterName;$ in h?h[$]=[...h[$]]:h[$]=[],h[$].push(A.value)}if(t.doenetAttributes.addToSharedParameters)for(let A of t.doenetAttributes.addToSharedParameters){let $=A.parameterName;$ in h?h[$]=Object.assign({},h[$]):h[$]={},h[$][A.key]=A.value}if(f!==void 0){let A=!1,$,S;if(r.alwaysSetUpVariant||r.setUpVariantIfVariantControlChild){for(let[D,V]of f.entries())if(V.componentType==="variantcontrol"||V.createdComponent&&components[V.componentName].componentType==="variantcontrol"){$=D,S=V;break}($!==void 0||r.alwaysSetUpVariant)&&(A=!0)}if(A){if($!==void 0){let q=t.variants.desiredVariant;q!==void 0&&(q.index!==void 0?S.variants.desiredVariantNumber=q.index:q.value!==void 0&&(S.variants.desiredVariant=q.value)),t.variants.uniquevariants&&(h.numberOfVariants=t.variants.numberOfVariants);let K=this.createIsolatedComponentsSub({serializedComponents:[S],ancestors:m,applyAdapters:i,shadow:a,updatesNeeded:s,compositesBeingExpanded:o,createNameContext:"variantControl",namespaceForUnamed:u});p[$]=K.components[0]}r.setUpVariant({serializedComponent:t,sharedParameters:h,definingChildrenSoFar:p,allComponentClasses:this.allComponentClasses});let D=[...f.keys()].filter(q=>q!==$),V=f.filter((q,K)=>K!==$),I=this.createIsolatedComponentsSub({serializedComponents:V,ancestors:m,applyAdapters:i,shadow:a,updatesNeeded:s,compositesBeingExpanded:o,namespaceForUnamed:u});for(let[q,K]of D.entries())p[K]=I.components[q]}else if(r.keepChildrenSerialized){let D=new Set([]),V=r.keepChildrenSerialized({serializedComponent:t,componentInfoObjects:this.componentInfoObjects});for(let K of V){if(D.has(Number(K)))throw Error("Invalid instructions to keep children serialized from "+r.componentType+": child repeated");D.add(Number(K)),d.push(f[K])}let I=[],q=[];for(let[K,E]of f.entries())D.has(K)||(I.push(E),q.push(K));if(I.length>0){let K=this.createIsolatedComponentsSub({serializedComponents:I,ancestors:m,applyAdapters:i,shadow:a,updatesNeeded:s,compositesBeingExpanded:o,namespaceForUnamed:u});for(let[E,W]of q.entries())p[W]=K.components[E]}}else p=this.createIsolatedComponentsSub({serializedComponents:f,ancestors:m,applyAdapters:i,shadow:a,updatesNeeded:s,compositesBeingExpanded:o,namespaceForUnamed:u}).components}let g=r.returnChildLogic({standardComponentClasses:this.standardComponentClasses,allComponentClasses:this.allComponentClasses,components:this.components,allPossibleProperties:this.allPossibleProperties,sharedParameters:h,flags:this.flags});if(g===void 0||typeof g.applyLogic!="function")throw Error("Invalid component class "+r.componentType+": returnChildLogic must return a childLogic object");let b={};t.downstreamDependencies&&Object.assign(b,t.downstreamDependencies);for(let A in y){let $=y[A],S=$.componentName;b[S]===void 0&&(b[S]=[]),b[S].push({dependencyType:"ancestorProp",property:A,ancestorIdentity:$})}let x=this.createStateVariableDefinitions({childLogic:g,componentClass:r,prescribedDependencies:b,componentName:e});s.deletedComponents[e]&&(s.recreatedComponents[e]=!0),delete s.deletedComponents[e],delete s.deletedStateVariables[e];let N=new r({componentName:e,ancestors:n,definingChildren:p,childLogic:g,stateVariableDefinitions:x,serializedChildren:d,serializedComponent:t,componentInfoObjects:this.componentInfoObjects,coreFunctions:this.coreFunctions,flags:this.flags,shadow:a,numerics:this.numerics,sharedParameters:h,parentSharedParameters:v});this.registerComponent(N),c&&(N.replacementOf=c);for(let A in b){let $=b[A];for(let S of $)if(S.dependencyType==="referenceShadow"){let D={componentName:A};Object.assign(D,S),delete D.dependencyType,N.shadows=new Proxy(D,Be);let V=this._components[A];V.shadowedBy||(V.shadowedBy=[]),V.shadowedBy.push(N);break}}this.deriveChildResultsFromDefiningChildren(N,s,o),this.initializeComponentStateVariables(N),this.dependencies.setUpComponentDependencies({component:N,core:this,updatesNeeded:s,compositesBeingExpanded:o});let{varsUnresolved:C}=this.resolveStateVariables({component:N,updatesNeeded:s,compositesBeingExpanded:o});this.addUnresolvedDependencies({varsUnresolved:C,component:N,updatesNeeded:s});let _=this.dependencies.checkForDependenciesOnNewComponent({componentName:e,updatesNeeded:s,compositesBeingExpanded:o});for(let A of _)this.recordActualChangeInStateVariable({componentName:A.componentName,varName:A.varName,updatesNeeded:s});return this.parameterStack.pop(),{newComponent:N}}addUnresolvedDependencies({varsUnresolved:t,component:e,updatesNeeded:n}){if(Object.keys(t).length>0){n.unresolvedDependencies[e.componentName]||(n.unresolvedDependencies[e.componentName]={}),Object.assign(n.unresolvedDependencies[e.componentName],t);for(let r in t)for(let i of t[r]){n.unresolvedByDependent[i.componentName]||(n.unresolvedByDependent[i.componentName]={}),n.unresolvedByDependent[i.componentName][i.stateVariable]||(n.unresolvedByDependent[i.componentName][i.stateVariable]=[]);let a=!1;for(let s of n.unresolvedByDependent[i.componentName][i.stateVariable])if(s.componentName===e.componentName&&s.stateVariable===r){a=!0;break}a||n.unresolvedByDependent[i.componentName][i.stateVariable].push({componentName:e.componentName,stateVariable:r})}}}propagateAncestorProps({componentClass:t,componentName:e,sharedParameters:n}){let r=t.createPropertiesObject({standardComponentClasses:this.standardComponentClasses,allPossibleProperties:this.allPossibleProperties}),i={};for(let o in r)r[o].propagateToDescendants&&(i[o]={componentName:e,componentType:t.componentType});let a={},s={};for(let o in n.propertiesToPropagate)o in r&&(s[o]=!0,r[o].ignorePropagationFromAncestors||(a[o]=n.propertiesToPropagate[o]));if(Object.keys(i).length>0||Object.keys(s).length>0){if(n.propertiesToPropagate){n.propertiesToPropagate=Object.assign({},n.propertiesToPropagate);for(let o in s)delete n.propertiesToPropagate[o]}else n.propertiesToPropagate={};Object.assign(n.propertiesToPropagate,i)}return a}deriveChildResultsFromDefiningChildren(t,e,n){t.activeChildren&&this.evaluatedDeferredChildStateVariables(t),t.activeChildren=t.definingChildren.slice(),t.allChildren={};for(let a=0;a<t.activeChildren.length;a++){let s=t.activeChildren[a];t.allChildren[s.componentName]={activeChildrenIndex:a,definingChildrenIndex:a,component:s}}let r=this.replaceCompositeChildren(t,e,n);t.constructor.includeBlankStringChildren||(t.activeChildren=t.activeChildren.filter(a=>a.componentType!=="string"||/\S/.test(a.stateValues.value)));let i=this.matchChildrenToChildLogic({component:t,applyAdapters:!0,updatesNeeded:e});return i.success?delete this.unsatisfiedChildLogic[t.componentName]:this.unsatisfiedChildLogic[t.componentName]={message:t.childLogic.logicResult.message},i}matchChildrenToChildLogic({component:t,applyAdapters:e=!0,updatesNeeded:n}){let r=0;if(e===!0)for(let s of t.activeChildren){let o=s.nAdapters;o>r&&(r=o)}let i=0,a=!1;for(;i<=r;i++)if(t.childLogic.applyLogic({activeChildren:t.activeChildren,maxAdapterNumber:i}).success){a=!0,this.substituteAdapters(t,n);break}return{success:a}}expandCompositeComponent({component:t,updatesNeeded:e,compositesBeingExpanded:n}){if(!("readyToExpand"in t.state))throw Error(`Could not evaluate state variable readyToExpand of composite ${t.componentName}`);if(!t.state.readyToExpand.isResolved||!t.state.readyToExpand.value)return e.compositesToExpand.add(t.componentName),{success:!1};if(e.compositesToExpand.delete(t.componentName),n.push(t.componentName),t.shadows){if(n.includes(t.shadows.componentName)){let f=this._components[t.shadows.componentName];for(;f.shadows;)f=this._components[f.shadows.componentName];throw Error(`Circular reference involving ${f.componentName}`)}let a=this._components[t.shadows.componentName];if(!a.isExpanded&&!this.expandCompositeComponent({component:a,updatesNeeded:e,compositesBeingExpanded:n}).success){let p=n.indexOf(t.componentName);if(p===-1)throw Error(`Something is wrong as we lost track that we were expanding ${t.componentName}`);return n.splice(p,1),{sucess:!1,readyToExpand:!0}}let s=a.replacements.map(f=>f.serialize({forCopy:!0})),o=t.replacementsWorkspace.uniqueIdentifiersUsed=[],u=t.shadows.compositeName;if(s=Lt({serializedComponents:s,componentName:u,uniqueIdentifiersUsed:o}),t.constructor.assignNamesToReplacements){let f=t.constructor.originalNamesAreConsistent&&t.doenetAttributes.newNamespace;s=qe({assignNames:t.doenetAttributes.assignNames,serializedComponents:s,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:f}).serializedComponents}else{let f=t.doenetAttributes.newNamespace;s=qe({serializedComponents:s,parentName:t.componentName,parentCreatesNewNamespace:t.doenetAttributes.newNamespace,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:f}).serializedComponents}this.createAndSetReplacements({component:t,serializedReplacements:s,updatesNeeded:e,compositesBeingExpanded:n}),e.parentsToUpdateDescendants.add(t.componentName);for(let f of Ar(t,this.components))e.parentsToUpdateDescendants.add(f);let c=n.indexOf(t.componentName);if(c===-1)throw Error(`Something is wrong as we lost track that we were expanding ${t.componentName}`);return n.splice(c,1),{success:!0}}let r=t.constructor.createSerializedReplacements({component:this.components[t.componentName],components:this.components,workspace:t.replacementsWorkspace,componentInfoObjects:this.componentInfoObjects});if(r.replacements){let a=r.replacements;this.createAndSetReplacements({component:t,serializedReplacements:a,updatesNeeded:e,compositesBeingExpanded:n})}else throw Error(`Invalid createSerializedReplacements of ${t.componentName}`);e.parentsToUpdateDescendants.add(t.componentName);for(let a of Ar(t,this.components))e.parentsToUpdateDescendants.add(a);let i=n.indexOf(t.componentName);if(i===-1)throw Error(`Something is wrong as we lost track that we were expanding ${t.componentName}`);return n.splice(i,1),{success:!0}}createAndSetReplacements({component:t,serializedReplacements:e,updatesNeeded:n,compositesBeingExpanded:r}){this.parameterStack.push(t.sharedParameters,!1);let i;t.doenetAttributes.newNamespace?i=t.componentName+"/":i=mn(t.componentName);let a=this.createIsolatedComponentsSub({serializedComponents:e,ancestors:t.ancestors,shadow:!0,updatesNeeded:n,compositesBeingExpanded:r,createNameContext:t.componentName+"|replacements",namespaceForUnamed:i,componentsReplacementOf:t});this.parameterStack.pop(),t.replacements=a.components,this.dependencies.updateReplacementDependencies(t,n,r),t.isExpanded=!0;let s=[];for(let u of["replacements","recursiveReplacements","fullRecursiveReplacements"])s.push(u),t.state["__determine_dependencies_"+u]&&s.push("__determine_dependencies_"+u);let o=this.resolveStateVariables({component:t,stateVariables:s,updatesNeeded:n,compositesBeingExpanded:r});if(Object.keys(o.varsUnresolved).length>0)throw console.log(o),Error("Couldn't resolve replacement variables after expanding!")}replaceCompositeChildren(t,e,n){let r=!1;for(let i=0;i<t.activeChildren.length;i++){let a=t.activeChildren[i];if(a instanceof this._allComponentClasses._composite){if(t.childLogic.checkIfChildInLogic(a))continue;if(!a.isExpanded){let u=this.expandCompositeComponent({component:a,updatesNeeded:e,compositesBeingExpanded:n});if(!u.success){if(u.readyToExpand)throw Error(`expand result of ${a.componentName} was not a success even though ready to expand.`);r=!0;continue}}this.markWithheldReplacementInactive(a,e);let s=a.replacements;a.replacementsToWithhold>0&&(s=s.slice(0,-a.replacementsToWithhold)),t.activeChildren.splice(i,1,...s);let o=t.allChildren[a.componentName];delete o.activeChildrenIndex;for(let u=0;u<s.length;u++){let c=s[u];t.allChildren[c.componentName]={activeChildrenIndex:i+u,component:c}}if(s.length!==1){let u=s.length-1;for(let c=i+s.length;c<t.activeChildren.length;c++){let f=t.activeChildren[c];t.allChildren[f.componentName].activeChildrenIndex+=u}}i--}}return{compositeChildNotReadyToExpand:r}}markWithheldReplacementInactive(t,e){let n=t.replacements.length;t.stateValues.isInactiveCompositeReplacement?n=0:t.replacementsToWithhold>0&&(n-=t.replacementsToWithhold);for(let r of t.replacements.slice(0,n))this.changeInactiveComponentAndDescendants(r,!1,e);for(let r of t.replacements.slice(n))this.changeInactiveComponentAndDescendants(r,!0,e)}changeInactiveComponentAndDescendants(t,e,n){if(t.stateValues.isInactiveCompositeReplacement!==e){t.state.isInactiveCompositeReplacement.value=e,this.markUpstreamDependentsStale({component:t,varName:"isInactiveCompositeReplacement",updatesNeeded:n}),this.dependencies.recordActualChangeInUpstreamDependencies({component:t,varName:"isInactiveCompositeReplacement"});for(let r in t.allChildren)this.changeInactiveComponentAndDescendants(this._components[r],e,n);t.replacements&&this.markWithheldReplacementInactive(t,n)}}substituteAdapters(t,e){if(t.childLogicSatisfied){let n=t.childLogic.logicResult.adapterResults;for(let r in n){let i=t.activeChildren[r],a=n[r],s=i.adapterUsed;if(s===void 0||s.componentType!==a.componentType){let o;t.doenetAttributes.newNamespace?o=t.componentName+"/":o=mn(t.componentName),s=this.createIsolatedComponentsSub({serializedComponents:[a],shadow:!0,ancestors:i.ancestors,updatesNeeded:e,createNameContext:i.componentName+"|adapter",namespaceForUnamed:o}).components[0],i.adapterUsed=s,s.adaptedFrom=i}t.activeChildren.splice(r,1,s),delete t.allChildren[i.componentName].activeChildrenIndex,t.allChildren[s.componentName]={activeChildrenIndex:Number(r),component:s}}}}findShadowedChildInSerializedComponents({serializedComponents:t,shadowedComponentName:e}){for(let n of t){if(n.originalName===e)return n;if(n.children){let r=this.findShadowedChildInSerializedComponents({serializedComponents:n.children,shadowedComponentName:e});if(r)return r}}}createStateVariableDefinitions({childLogic:t,componentClass:e,prescribedDependencies:n,componentName:r}){let i,a={};if(n)for(let c in n){let f=n[c];for(let p of f)p.dependencyType==="referenceShadow"?i={linkSource:"referenceShadow",targetName:c,compositeName:p.compositeName,propVariable:p.propVariable,arrayStateVariable:p.arrayStateVariable,arrayKey:p.arrayKey,ignorePrimaryStateVariable:p.ignorePrimaryStateVariable}:p.dependencyType==="adapter"?i={linkSource:"adapter",adapterTargetIdentity:p.adapterTargetIdentity,adapterVariable:p.adapterVariable}:p.dependencyType==="ancestorProp"?a[p.property]=p.ancestorIdentity:p.dependencyType==="nonShadowingReplacement"&&(i={linkSource:"nonShadowingReplacement",compositeName:c})}let s={};i||this.createPropertyStateVariableDefinitions({childLogic:t,ancestorProps:a,stateVariableDefinitions:s});let o=e.returnNormalizedStateVariableDefinitions({propertyNames:Object.keys(s),numerics:this.numerics});Object.assign(s,o),i&&(i.linkSource==="adapter"?this.createAdapterStateVariableDefinitions({redefineDependencies:i,childLogic:t,stateVariableDefinitions:s,componentClass:e}):this.createReferenceShadowStateVariableDefinitions({redefineDependencies:i,childLogic:t,stateVariableDefinitions:s,componentClass:e,ancestorProps:a}));let u=s.childrenToRender;if(u){let c=u.definition,f=this;u.definition=function(p){return f.componentsWithChangedChildrenToRender.add(r),c(p)}}return s}createPropertyStateVariableDefinitions({childLogic:t,ancestorProps:e,stateVariableDefinitions:n}){for(let r in t.properties){let i=t.properties[r],a="_property_"+r,s=i.componentType?i.componentType:r,o=i.default;o===void 0&&(o=null);let u=this.allComponentClasses[r.toLowerCase()];if(!u)throw Error(`Component type ${r} does not exist so cannot create property.`);let c=u.stateVariableForPropertyValue;c===void 0&&(c="value");let f=[];i.dependentStateVariables&&f.push(...i.dependentStateVariables);let p=!1;u.attributesForPropertyValue&&(p=u.attributesForPropertyValue.isArray);let d,m,v;if(r in e){d={[a]:{dependencyType:"child",childLogicName:a,variableNames:[c]},ancestorProp:{dependencyType:"stateVariable",componentName:e[r].componentName,variableName:r}};for(let y of f)d[y.dependencyName]={dependencyType:"stateVariable",variableName:y.variableName};m=function({dependencyValues:y,usedDefault:g,arrayKeys:b,freshnessInfo:x}){let N=y[a];if(N.length===0)return g.ancestorProp?p?{useEssentialOrDefaultValue:{[r]:{__entire_array:{variablesToCheck:r,defaultValue:y.ancestorProp}}}}:{useEssentialOrDefaultValue:{[r]:{variablesToCheck:r,defaultValue:y.ancestorProp}}}:{newValues:{[r]:y.ancestorProp}};if(i.definitionForPropertyValue)return i.definitionForPropertyValue({dependencyValues:y,propertyChild:N,propertySpecification:new Proxy(i,Be),arrayKeys:b,freshnessInfo:x});if(u.definitionForPropertyValue)return u.definitionForPropertyValue({dependencyValues:y,propertyChild:N,propertySpecification:new Proxy(i,Be),arrayKeys:b,freshnessInfo:x});let C=Ia({value:N[0].stateValues[c],propertySpecification:i,property:r});if(i.mergeArrays&&Array.isArray(y.ancestorProp)&&Array.isArray(C)){let _=[...C,...y.ancestorProp];return{newValues:{[r]:_}}}else return{newValues:{[r]:C}}},v=function({desiredStateVariableValues:y,dependencyValues:g,usedDefault:b}){return g[a].length===0?b.ancestorProp?{success:!0,instructions:[{setStateVariable:r,value:y[r]}]}:{success:!0,instructions:[{setDependency:"ancestorProp",desiredValue:y[r]}]}:i.definitionForPropertyValue?i.inverseDefinitionForPropertyValue?i.inverseDefinitionForPropertyValue({desiredStateVariableValues:y,dependencyValues:g,propertySpecification:new Proxy(i,Be)}):{success:!1}:u.definitionForPropertyValue?u.inverseDefinitionForPropertyValue?u.inverseDefinitionForPropertyValue({desiredStateVariableValues:y,dependencyValues:g,propertySpecification:new Proxy(i,Be)}):{success:!1}:i.mergeArrays?{success:!1}:{success:!0,instructions:[{setDependency:a,desiredValue:y[r],childIndex:0,variableIndex:0}]}}}else{d={[a]:{dependencyType:"child",childLogicName:a,variableNames:[c]}};for(let g of f)d[g.dependencyName]={dependencyType:"stateVariable",variableName:g.variableName};let y=!((u.definitionForPropertyValue||i.definitionForPropertyValue)&&!("default"in i));m=function({dependencyValues:g,arrayKeys:b,freshnessInfo:x}){let N=g[a];if(N.length===0&&y)return p?{useEssentialOrDefaultValue:{[r]:{__entire_array:{variablesToCheck:r}}}}:{useEssentialOrDefaultValue:{[r]:{variablesToCheck:r}}};if(i.definitionForPropertyValue)return i.definitionForPropertyValue({dependencyValues:g,propertyChild:N,propertySpecification:new Proxy(i,Be),arrayKeys:b,freshnessInfo:x});if(u.definitionForPropertyValue)return u.definitionForPropertyValue({dependencyValues:g,propertyChild:N,propertySpecification:new Proxy(i,Be),arrayKeys:b,freshnessInfo:x});let C=Ia({value:N[0].stateValues[c],propertySpecification:i,property:r});if(i.mergeArrayWithDefault&&Array.isArray(C)){let _=i.default;if(Array.isArray(_)){let w=[...C,..._];return{newValues:{[r]:w}}}}return{newValues:{[r]:C}}},v=function({desiredStateVariableValues:g,dependencyValues:b}){return b[a].length===0?{success:!0,instructions:[{setStateVariable:r,value:g[r]}]}:i.definitionForPropertyValue?i.inverseDefinitionForPropertyValue?i.inverseDefinitionForPropertyValue({desiredStateVariableValues:g,dependencyValues:b,propertySpecification:new Proxy(i,Be)}):{success:!1}:u.definitionForPropertyValue?u.inverseDefinitionForPropertyValue?u.inverseDefinitionForPropertyValue({desiredStateVariableValues:g,dependencyValues:b,propertySpecification:new Proxy(i,Be)}):{success:!1}:i.mergeArrays?{success:!1}:{success:!0,instructions:[{setDependency:a,desiredValue:g[r],childIndex:0,variableIndex:0}]}}}n[r]={public:!0,componentType:s,isProperty:!0,defaultValue:o,returnDependencies:()=>d,definition:m,inverseDefinition:v},u.markStaleForPropertyValue&&(n[r].markStale=u.markStaleForPropertyValue);for(let y in u.attributesForPropertyValue)n[r][y]=u.attributesForPropertyValue[y];let h=["forRenderer","entryPrefixes","requireChildLogicInitiallySatisfied","useDefaultForShadows","propagateToProps"];for(let y of h)y in i&&(n[r][y]=i[y])}}createAdapterStateVariableDefinitions({redefineDependencies:t,childLogic:e,stateVariableDefinitions:n,componentClass:r}){let i=this._components[t.adapterTargetIdentity.componentName];for(let o in e.properties){let u=e.properties[o],c=u.componentType?u.componentType:o,f=u.default,p={};o in i.state&&(p.adapterTargetVariable={dependencyType:"stateVariable",componentName:t.adapterTargetIdentity.componentName,variableName:o}),n[o]={public:!0,componentType:c,isProperty:!0,defaultValue:f,returnDependencies:()=>p,definition:function({dependencyValues:d}){return d.adapterTargetVariable===void 0?{useEssentialOrDefaultValue:{[o]:{variablesToCheck:o}}}:{newValues:{[o]:d.adapterTargetVariable}}},inverseDefinition:function({desiredStateVariableValues:d,dependencyValues:m}){return m.adapterTargetVariable===void 0?{success:!0,instructions:[{setStateVariable:o,value:d[o]}]}:{success:!0,instructions:[{setDependency:"adapterTargetVariable",desiredValue:d[o]}]}}};for(let d of["forRenderer","entryPrefixes"])d in u&&(n[o][d]=u[d])}let a="value";r.primaryStateVariableForDefinition&&(a=r.primaryStateVariableForDefinition);let s=n[a];s.returnDependencies=()=>({adapterTargetVariable:{dependencyType:"stateVariable",componentName:t.adapterTargetIdentity.componentName,variableName:t.adapterVariable}}),s.set?s.definition=function({dependencyValues:o}){return{newValues:{[a]:s.set(o.adapterTargetVariable)}}}:s.definition=function({dependencyValues:o}){return{newValues:{[a]:o.adapterTargetVariable}}},s.inverseDefinition=function({desiredStateVariableValues:o}){return{success:!0,instructions:[{setDependency:"adapterTargetVariable",desiredValue:o[a]}]}}}createReferenceShadowStateVariableDefinitions({redefineDependencies:t,childLogic:e,stateVariableDefinitions:n,componentClass:r,ancestorProps:i}){let a=this._components[t.compositeName],s=this._components[t.targetName],o=t.linkSource==="nonShadowingReplacement",u={};if(t.propVariable){let d=s.state[t.propVariable];d&&d.stateVariablesPrescribingAdditionalProperties&&(u=d.stateVariablesPrescribingAdditionalProperties)}for(let d in e.properties){let m=e.properties[d],v=m.componentType?m.componentType:d,h=m.default,y={};d in a.state&&(y.compositeComponentVariable={dependencyType:"stateVariable",componentName:a.componentName,variableName:d}),!o&&(!t.propVariable||m.propagateToProps)&&d in s.state&&(y.targetVariable={dependencyType:"stateVariable",componentName:s.componentName,variableName:d},"targetPropertiesToIgnore"in a.state&&(y.targetPropertiesToIgnore={dependencyType:"stateVariable",componentName:a.componentName,variableName:"targetPropertiesToIgnore"})),u[d]&&(y.targetVariable={dependencyType:"stateVariable",componentName:s.componentName,variableName:u[d]}),d in i&&(y.ancestorProp={dependencyType:"stateVariable",componentName:i[d].componentName,variableName:d}),n[d]={public:!0,componentType:v,isProperty:!0,defaultValue:h,returnDependencies:()=>y,definition:function({dependencyValues:g,usedDefault:b}){if(g.compositeComponentVariable!==void 0&&(!b.compositeComponentVariable||a.state[d].useDefaultForShadows)){let x=Ia({value:g.compositeComponentVariable,propertySpecification:m,property:d});return{newValues:{[d]:x}}}else{if(g.targetVariable!==void 0&&!(g.targetPropertiesToIgnore&&g.targetPropertiesToIgnore.map(x=>x.toLowerCase()).includes(d.toLowerCase()))&&(!b.targetVariable||s.state[d].useDefaultForShadows))return{newValues:{[d]:g.targetVariable}};if(g.ancestorProp!==void 0){let x=Ia({value:g.ancestorProp,propertySpecification:m,property:d});return b.ancestorProp?{useEssentialOrDefaultValue:{[d]:{variablesToCheck:d,defaultValue:x}}}:{newValues:{[d]:x}}}else return{useEssentialOrDefaultValue:{[d]:{variablesToCheck:d}}}}},inverseDefinition:function({desiredStateVariableValues:g,dependencyValues:b,usedDefault:x}){if(b.compositeComponentVariable!==void 0&&!x.compositeComponentVariable)return{success:!0,instructions:[{setDependency:"compositeComponentVariable",desiredValue:g[d]}]};if(b.targetVariable!==void 0&&!(b.targetPropertiesToIgnore&&b.targetPropertiesToIgnore.map(N=>N.toLowerCase()).includes(d.toLowerCase()))&&!x.targetVariable)return{success:!0,instructions:[{setDependency:"targetVariable",desiredValue:g[d]}]};if(b.ancestorProp!==void 0)if("ancestorProp"in x){let N=[{setStateVariable:d,value:g[d]}];return b.targetVariable!==void 0&&!(b.targetPropertiesToIgnore&&b.targetPropertiesToIgnore.map(C=>C.toLowerCase()).includes(d.toLowerCase()))&&N.push({setDependency:"targetVariable",desiredValue:g[d]}),{success:!0,instructions:N}}else return{success:!0,instructions:[{setDependency:"ancestorProp",desiredValue:g[d]}]};else{let N=[{setStateVariable:d,value:g[d]}];return b.targetVariable!==void 0&&!(b.targetPropertiesToIgnore&&b.targetPropertiesToIgnore.map(C=>C.toLowerCase()).includes(d.toLowerCase()))&&N.push({setDependency:"targetVariable",desiredValue:g[d]}),{success:!0,instructions:N}}}};for(let g of["forRenderer","entryPrefixes"])g in m&&(n[d][g]=m[g])}if(o)return;if(t.propVariable){if(!t.ignorePrimaryStateVariable){let d="value";r.primaryStateVariableForDefinition&&(d=r.primaryStateVariableForDefinition);let m=n[d];if(!m)throw Error(`Cannot have a public state variable with componentType ${r.componentType} as the class doesn't have a primary state variable for definition`);m.returnDependencies=()=>({targetVariable:{dependencyType:"stateVariable",componentName:s.componentName,variableName:t.propVariable}}),m.set?m.definition=function({dependencyValues:v}){return{newValues:{[d]:m.set(v.targetVariable)},alwaysShadow:[d]}}:m.definition=function({dependencyValues:v}){return{newValues:{[d]:v.targetVariable},alwaysShadow:[d]}},m.inverseDefinition=function({desiredStateVariableValues:v}){return{success:!0,instructions:[{setDependency:"targetVariable",desiredValue:v[d]}]}}}return}let c=!1;if("readyToExpand"in n){c=!0;let d=n.readyToExpand,m=d.returnDependencies.bind(d),v=d.definition;d.returnDependencies=function(h){let y=m(h);return y.targetReadyToExpand={dependencyType:"stateVariable",componentName:s.componentName,variableName:"readyToExpand"},y},d.definition=function(h){let y=v(h);return y.newValues&&y.newValues.readyToExpand&&(h.dependencyValues.targetReadyToExpand||(y.newValues.readyToExpand=!1)),y}}let f=[...s.constructor.stateVariablesShadowedForReference];f||(f=[]);let p=[];for(let d in s.state){let m=s.state[d];if(!(m.isProperty||d in f)&&(m.isResolved&&!m.willNeverBeEssential&&m.value,!m.neverShadow)){if(m.essential||m.alwaysShadow||m.isShadow||m.isArray&&m.isResolved&&s.state[m.arraySizeStateVariable].isResolved&&m.getAllArrayKeys(m.arraySize).length>0&&m.getAllArrayKeys(m.arraySize).some(v=>m.essentialByArrayKey[v]))f.includes(d)||f.push(d);else if((!m.isResolved||m.isArray&&!s.state[m.arraySizeStateVariable].isResolved)&&!p.includes(d)){let v=n[d];if(!v)continue;let h=[d];v.additionalStateVariablesDefined&&h.push(...v.additionalStateVariablesDefined);let y={targetComponent:s,foundReadyToExpand:c};m.isArray&&!m.entireArrayAtOnce&&!s.state[m.arraySizeStateVariable].isResolved&&(y.arraySizeStateVariableToResolve=m.arraySizeStateVariable);for(let g of h)n[g].determineIfShadowData=y;p.push(...h)}}}this.modifyStateDefsToBeShadows({stateVariablesToShadow:f,stateVariableDefinitions:n,foundReadyToExpand:c,targetComponent:s})}modifyStateDefsToBeShadows({stateVariablesToShadow:t,stateVariableDefinitions:e,foundReadyToExpand:n,targetComponent:r}){let i={};for(let a of t){let s=e[a];if(s===void 0)if(a.slice(0,8)==="__array_")s=e[a]={};else continue;if(s.isShadow=!0,s.additionalStateVariablesDefined)for(let u of s.additionalStateVariablesDefined)t.includes(u)||(i[u]||(i[u]=[]),i[u].push(a));delete s.additionalStateVariablesDefined,n||delete s.stateVariablesDeterminingDependencies;let o=s.public&&s.componentType===void 0;if(s.isArray)s.returnArrayDependenciesByKey=function({arrayKeys:u}){let c={};for(let p of u)c[p]={targetVariable:{dependencyType:"stateVariable",componentName:r.componentName,variableName:this.arrayVarNameFromArrayKey(p)}};let f={};return o&&(f.targetVariableComponentType={dependencyType:"stateVariableComponentType",componentName:r.componentName,variableName:a}),{globalDependencies:f,dependenciesByKey:c}},s.arrayDefinitionByKey=function({globalDependencyValues:u,dependencyValuesByKey:c,arrayKeys:f}){let p={};for(let m of f)"targetVariable"in c[m]?p[m]=c[m].targetVariable:p[m]=s.defaultEntryValue;let d={newValues:{[a]:p},alwaysShadow:[a]};return"targetVariableComponentType"in u&&(d.setComponentType={[a]:u.targetVariableComponentType}),d},s.inverseArrayDefinitionByKey=function({desiredStateVariableValues:u,dependencyValuesByKey:c,dependencyNamesByKey:f,arraySize:p}){let d=[];for(let m in u[a])!c[m]||d.push({setDependency:f[m].targetVariable,desiredValue:u[a][m],shadowedVariable:!0});return{success:!0,instructions:d}};else{let u={};n&&(u=s.returnDependencies.bind(s)),s.returnDependencies=function(c){let f=Object.assign({},u);return f.targetVariable={dependencyType:"stateVariable",componentName:r.componentName,variableName:a},o&&(f.targetVariableComponentType={dependencyType:"stateVariableComponentType",componentName:r.componentName,variableName:a}),f},s.definition=function({dependencyValues:c}){let f={alwaysShadow:[a]};return"targetVariableComponentType"in c&&(f.setComponentType={[a]:c.targetVariableComponentType}),f.newValues={[a]:c.targetVariable},f},s.inverseDefinition=function({desiredStateVariableValues:c,dependencyValues:f}){return{success:!0,instructions:[{setDependency:"targetVariable",desiredValue:c[a],shadowedVariable:!0}]}}}}for(let a in i)this.modifyStateDefToDeleteVariableReferences({varNamesToDelete:i[a],stateDef:e[a]})}modifyStateDefToDeleteVariableReferences({varNamesToDelete:t,stateDef:e}){for(let r of t){let i=e.additionalStateVariablesDefined.indexOf(r);e.additionalStateVariablesDefined.splice(i,1)}let n=e.definition;e.definition=function(r){let i=n(r);for(let a in i)if(Array.isArray(i[a]))for(let s of t){let o=i[a].indexOf(s);o!==-1&&i[a].splice(o,1)}else for(let s of t)delete i[a][s];return i}}initializeComponentStateVariables(t){for(let e in t.state)t.state[e].isAlias?(t.stateVarAliases||(t.stateVarAliases={}),t.stateVarAliases[e]=t.state[e].targetVariableName,delete t.state[e]):this.initializeStateVariable({component:t,stateVariable:e})}initializeStateVariable({component:t,stateVariable:e,arrayStateVariable:n,arrayEntryPrefix:r,updatesNeeded:i}){let a=this.getStateVariableValue;t.state[e]||(t.state[e]={});let s=t.state[e];s.isResolved=!1,Object.defineProperty(s,"value",{get:()=>a({component:t,stateVariable:e}),configurable:!0}),r!==void 0?this.initializeArrayEntryStateVariable({stateVarObj:s,arrayStateVariable:n,arrayEntryPrefix:r,component:t,stateVariable:e,updatesNeeded:i}):s.isArray&&this.initializeArrayStateVariable({stateVarObj:s,component:t,stateVariable:e})}initializeArrayEntryStateVariable({stateVarObj:t,arrayStateVariable:e,arrayEntryPrefix:n,component:r,stateVariable:i,updatesNeeded:a}){t.isArrayEntry=!0,t.neverShadow=!0,t.arrayStateVariable=e;let s=r.state[e];if(t.definition=s.definition,t.inverseDefinition=s.inverseDefinition,t.markStale=s.markStale,t.freshnessInfo=s.freshnessInfo,t.getPreviousDependencyValuesForMarkStale=s.getPreviousDependencyValuesForMarkStale,t.nDimensions=s.returnEntryDimensions(n),t.wrappingComponents=s.returnWrappingComponents(n),t.entryPrefix=n,t.varEnding=i.slice(n.length),s.additionalStateVariablesDefined){t.additionalStateVariablesDefined=[];let o=s.entryPrefixes.indexOf(n);for(let u of s.additionalStateVariablesDefined){let c=r.state[u];if(c.isArray){let p=c.entryPrefixes[o]+t.varEnding;t.additionalStateVariablesDefined.push(p)}else t.additionalStateVariablesDefined.push(u)}}if(s.getEntryValues?t.getValueFromArrayValues=function(){return s.getEntryValues({varName:i})}:t.getValueFromArrayValues=function(){if(t.arrayKeys.length===0)return;let o=[];for(let u of t.arrayKeys)o.push(s.getArrayValue({arrayKey:u}));return o.length===1?o[0]:o},t.arraySizeStateVariable=s.arraySizeStateVariable,t._arrayKeys=[],t._unflattenedArrayKeys=[],Object.defineProperty(t,"arrayKeys",{get:function(){return s.arraySize,t._arrayKeys}}),Object.defineProperty(t,"unflattenedArrayKeys",{get:function(){return s.arraySize,t._unflattenedArrayKeys}}),r.state[t.arraySizeStateVariable].isResolved){let o=r.stateValues[t.arraySizeStateVariable],u=s.getArrayKeysFromVarName({arrayEntryPrefix:t.entryPrefix,varEnding:t.varEnding,arraySize:o,nDimensions:s.nDimensions});t._unflattenedArrayKeys=u,t._arrayKeys=rt(u);let c=s.varNamesIncludingArrayKeys;for(let f of t._arrayKeys)c[f]||(c[f]=[]),c[f].push(i)}if(s.arrayEntryNames.push(i),Object.defineProperty(t,"arraySize",{get:()=>s.arraySize}),Object.defineProperty(t,"arrayEntrySize",{get:function(){let o=t.unflattenedArrayKeys,u=[],c=[o];for(let f=0;f<t.nDimensions;f++)c=c[0],u.push(c.length);return u.reverse(),u}}),s.stateVariablesDeterminingDependencies){t.stateVariablesDeterminingDependencies||(t.stateVariablesDeterminingDependencies=[]);for(let o of s.stateVariablesDeterminingDependencies)t.stateVariablesDeterminingDependencies.includes(o)||t.stateVariablesDeterminingDependencies.push(o)}if(s.entireArrayAtOnce)t.entireArrayAtOnce=!0,t.returnDependencies=s.returnDependencies.bind(s);else{let o=s.returnDependencies.bind(s);t.returnDependencies=function(u){u.arraySize=t.arraySize,u.arrayKeys=t.arrayKeys;let c=o(u),f=Object.keys(s.dependencyNames.namesByKey).length;return t.numberNamesInPreviousReturnDep!==f&&(u.changedDependency=!0),t.numberNamesInPreviousReturnDep=f,c}}}initializeArrayStateVariable({stateVarObj:t,component:e,stateVariable:n}){t.arrayValues=[],t.nDimensions===void 0&&(t.nDimensions=1),t.nDimensions>1?(t.keyToIndex=i=>i.split(",").map(a=>Number(a)),t.setArrayValue=function({value:i,arrayKey:a,arraySize:s}){let o=t.keyToIndex(a),u=o.length;if(!u>t.nDimensions)return console.warn("Cannot set array value.  Number of dimensions is too large."),{nFailures:1};let c=t.arrayValues,f=s;for(let d of o.slice(0,o.length-1))if(d>=0&&d<f[0])c[d]||(c[d]=[]),c=c[d],f=f.slice(1);else return console.warn("ignore setting array value out of bounds"),{nFailures:1};let p=0;if(u<t.nDimensions){let d=function(v,h,y){if(!Array.isArray(v))return console.warn("ignoring array values with insufficient dimensions"),{nFailures:1};let g=0,b=y[0];if(v.length>b&&(console.warn("ignoring array values of out bounds"),g+=v.length-b,v=v.slice(0,b)),y.length===1)for(let[x,N]of v.entries())h[x]=N;else for(let[x,N]of v.entries())h[x]||(h=[]),g+=d(N,h[x],y[x]).nFailures;return{nFailures:g}};p+=d(i,c,f).nFailures}else c[o[o.length-1]]=i;return{nFailures:p}},t.getArrayValue=function({arrayKey:i,arrayValues:a=t.arrayValues}){let s=t.keyToIndex(i),o=a;for(let u of s.slice(0,s.length-1))if(o=o[u],!o)return;return o[s[s.length-1]]},t.getArrayKeysFromVarName||(t.getArrayKeysFromVarName=function({arrayEntryPrefix:i,varEnding:a,arraySize:s,nDimensions:o}){let u=a.split("_").map(c=>Number(c)-1);return u.length===o&&u.every((c,f)=>Number.isInteger(c)&&c>=0)?s?u.every((c,f)=>c<s[f])?[String(u)]:[]:[String(u)]:[]}),t.getAllArrayKeys=function(i,a=!0){function s(o){if(o.length===1)return Array.from(Array(o[0]),(u,c)=>String(c));{let u=o[0],c=s(o.slice(1)),f=[];for(let p=0;p<u;p++)a?f.push(...c.map(d=>p+","+d)):f.push(c.map(d=>p+","+d));return f}}return!i||i.length===0?[]:s(i)},t.arrayVarNameFromArrayKey||(t.arrayVarNameFromArrayKey=function(i){return r[0]+i.split(",").map(a=>Number(a)+1).join("_")}),t.adjustArrayToNewArraySize=function(){function i(a,s){if(a.length=s[0],s.length>1){let o=s.slice(1);for(let[u,c]of a.entries())c||(c=a[u]=[]),i(c,o)}}i(t.arrayValues,t.arraySize);for(let a of Object.keys(t.essentialByArrayKey))t.keyToIndex(a).some((o,u)=>o>=t.arraySize[u])&&delete t.essentialByArrayKey[a]}):(t.keyToIndex=i=>Number(i),t.setArrayValue=function({value:i,arrayKey:a,arraySize:s}){let o=t.keyToIndex(a);return o>=0&&o<s[0]?(t.arrayValues[o]=i,{nFailures:0}):(console.warn(`Ignoring setting array values out of bounds: ${a} of ${n}`),{nFailures:1})},t.getArrayValue=function({arrayKey:i,arrayValues:a=t.arrayValues}){return a[i]},t.getArrayKeysFromVarName||(t.getArrayKeysFromVarName=function({arrayEntryPrefix:i,varEnding:a,arraySize:s}){let o=Number(a)-1;return Number.isInteger(o)&&o>=0?s?o<s[0]?[String(o)]:[]:[String(o)]:[]}),t.getAllArrayKeys=function(i){return!i||i.length===0?[]:Array.from(Array(i[0]),(a,s)=>String(s))},t.arrayVarNameFromArrayKey||(t.arrayVarNameFromArrayKey=function(i){return r[0]+String(Number(i)+1)}),t.adjustArrayToNewArraySize=function(){t.arrayValues.length=t.arraySize[0];for(let i of Object.keys(t.essentialByArrayKey))t.keyToIndex(i)>=t.arraySize[0]&&delete t.essentialByArrayKey[i]}),t.indexToKey=i=>String(i);let r=t.entryPrefixes;r||(r=[n]),e.arrayEntryPrefixes||(e.arrayEntryPrefixes={});for(let i of r)e.arrayEntryPrefixes[i]=n;if(t.returnEntryDimensions||(t.returnEntryDimensions=()=>1),t.returnWrappingComponents||(t.returnWrappingComponents=i=>[]),t.wrappingComponents=t.returnWrappingComponents(),t.essentialByArrayKey={},t.arrayEntryNames=[],t.varNamesIncludingArrayKeys={},t.entireArrayAtOnce){let i=function(a,s){if(a===void 0)return Array(s).fill(0);let o=[a.length];return s>1&&o.push(...i(a[0],s-1)),o};t.getCurrentFreshness=function({freshnessInfo:a}){return{fresh:{[n]:a.arrayFresh}}},t.markStale=function({freshnessInfo:a}){return a.arrayFresh=!1,t.arraySizeStale=!0,{fresh:{[n]:!1}}},t.freshenOnNoChanges=function({freshnessInfo:a}){a.arrayFresh=!0},t.definition=function(a){if(a.freshnessInfo.arrayFresh)return{noChanges:[t.arraySizeStateVariable]};a.freshnessInfo.arrayFresh=!0;let s=t.entireArrayDefinition(a);if(s.newValues){let o=s.newValues[n],u=i(o,t.nDimensions);s.newValues[t.arraySizeStateVariable]=u}else if(s.useEssentialOrDefaultValue&&!t._previousValue){let o=s.defaultValue;o===void 0&&(o=t.defaultValue);let u=i(o,t.nDimensions);s.newValues={[t.arraySizeStateVariable]:u}}if(s.checkForActualChange||(s.checkForActualChange={}),s.checkForActualChange[t.arraySizeStateVariable]=!0,s.arraySizeChanged=[n],t.additionalStateVariablesDefined)for(let o of t.additionalStateVariablesDefined)e.state[o].isArray&&s.arraySizeChanged.push(o);return s}}else{let i=function(a,s){let o={};for(let f of t.dependencyNames.global)o[f]=a[f];let u={},c={};for(let f of s)if(u[f]={},f in t.dependencyNames.namesByKey){c[f]=!0;for(let p in t.dependencyNames.namesByKey[f]){let d=t.dependencyNames.namesByKey[f][p];d in a?u[f][p]=a[d]:c[f]=!1}}return{globalDependencyValues:o,dependencyValuesByKey:u,foundAllDependencyValuesForKey:c}};t.returnDependencies=function(a){a.arraySize=t.arraySize;for(let o in a.stateValues)o.slice(0,8)==="__array_"&&delete a.stateValues[o];a.arrayKeys===void 0&&(a.arrayKeys=t.getAllArrayKeys(a.arraySize));let s={};if(t.basedOnArrayKeyStateVariables&&a.arrayKeys.length>1)for(let o of a.arrayKeys)s[o]={dependencyType:"stateVariable",variableName:t.arrayVarNameFromArrayKey(o)};else{let o=t.returnArrayDependenciesByKey(a);if(!t.dependencyNames&&(t.dependencyNames={namesByKey:{},keysByName:{},global:[]},t.additionalStateVariablesDefined))for(let u of t.additionalStateVariablesDefined)e.state[u].dependencyNames=t.dependencyNames;o.globalDependencies&&(t.dependencyNames.global=Object.keys(o.globalDependencies),Object.assign(s,o.globalDependencies)),o.dependenciesByKey||(o.dependenciesByKey={});for(let u of a.arrayKeys){u in t.dependencyNames.namesByKey||(a.changedDependency=!0),t.dependencyNames.namesByKey[u]={};for(let c in o.dependenciesByKey[u]){let f="__"+u+"_"+c;s[f]=o.dependenciesByKey[u][c],t.dependencyNames.namesByKey[u][c]=f,t.dependencyNames.keysByName[f]||(t.dependencyNames.keysByName[f]=[]),t.dependencyNames.keysByName[f].push(u)}}t.dependencyNames.global.push("__array_size")}return s.__array_size={dependencyType:"stateVariable",variableName:t.arraySizeStateVariable},s},t.getCurrentFreshness=function({freshnessInfo:a,arrayKeys:s,arraySize:o}){s===void 0&&(s=t.getAllArrayKeys(o));let u=a.freshByKey,c=a.freshArraySize?1:0;for(let f of s)u[f]&&(c+=1);return c>0?c===s.length+1?{fresh:{[n]:!0}}:{partiallyFresh:{[n]:c}}:{fresh:{[n]:!1}}},t.markStale=function({freshnessInfo:a,changes:s,arrayKeys:o,arraySize:u}){let c={};o===void 0&&(o=t.getAllArrayKeys(u)),t.markStaleByKey&&(c=t.markStaleByKey({arrayKeys:o,changes:s}));let f=a.freshByKey;if(s.__array_size)return a.freshArraySize=!1,a.freshByKey={},c.fresh={[n]:!1},c;if(Object.keys(f).length===0)return a.freshByKey={},a.freshArraySize?(c.partiallyFresh={[n]:1},c):(c.fresh={[n]:!1},c);for(let d in s){if(t.dependencyNames.global.includes(d))return a.freshByKey={},a.freshArraySize?(c.partiallyFresh={[n]:1},c):(c.fresh={[n]:!1},c);if(t.basedOnArrayKeyStateVariables&&o.length>1)delete f[d];else for(let m of t.dependencyNames.keysByName[d])delete f[m]}let p=a.freshArraySize?1:0;for(let d of o)f[d]&&(p+=1);return p>0?p===o.length+1?(c.fresh={[n]:!0},c):(c.partiallyFresh={[n]:p},c):(c.fresh={[n]:!1},c)},t.freshenOnNoChanges=function({arrayKeys:a,freshnessInfo:s,arraySize:o}){let u=s.freshByKey;a===void 0&&(a=t.getAllArrayKeys(o));for(let c of a)u[c]=!0},t.definition=function(a){if(a.arrayKeys===void 0&&(a.arrayKeys=t.getAllArrayKeys(a.arraySize)),t.basedOnArrayKeyStateVariables&&a.arrayKeys.length>1)return{};{let s=i(a.dependencyValues,a.arrayKeys),o=s.globalDependencyValues,u=s.dependencyValuesByKey,c=s.foundAllDependencyValuesForKey;delete a.dependencyValues,a.globalDependencyValues=o,a.dependencyValuesByKey=u;let f=[],p=a.freshnessInfo.freshByKey;for(let m of a.arrayKeys)!p[m]&&c[m]&&(p[m]=!0,f.push(m));let d;if(f.length===0)d={};else{if(a.arrayKeys=f,!t.arrayDefinitionByKey)throw Error(`For ${n} of ${e.componentType}, arrayDefinitionByKey must be a function`);if(d=t.arrayDefinitionByKey(a),d.newValues&&d.newValues[n])for(let m in d.newValues[n])p[m]=!0;if(d.useEssentialOrDefaultValue&&d.useEssentialOrDefaultValue[n])for(let m in d.useEssentialOrDefaultValue[n])p[m]=!0}if(!a.freshnessInfo.freshArraySize){if(a.changes.__array_size&&(d.arraySizeChanged=[n],t.additionalStateVariablesDefined))for(let m of t.additionalStateVariablesDefined)e.state[m].isArray&&d.arraySizeChanged.push(m);a.freshnessInfo.freshArraySize=!0}return d}},t.inverseDefinition=function(a){if(!t.inverseArrayDefinitionByKey)return{success:!1};if(a.arrayKeys===void 0&&(a.arrayKeys=t.getAllArrayKeys(a.arraySize)),t.basedOnArrayKeyStateVariables&&a.arrayKeys.length>1){let s=[];for(let o in a.desiredStateVariableValues[n])o in a.dependencyValues&&s.push({setDependency:o,desiredValue:a.desiredStateVariableValues[n][o],treatAsInitialChange:a.initialChange});return{success:!0,instructions:s}}else{let s=i(a.dependencyValues,a.arrayKeys),o=s.globalDependencyValues,u=s.dependencyValuesByKey;return delete a.dependencyValues,a.globalDependencyValues=o,a.dependencyValuesByKey=u,a.dependencyNamesByKey=t.dependencyNames.namesByKey,t.inverseArrayDefinitionByKey(a)}}}if(this.createArraySizeStateVariable({stateVarObj:t,component:e,stateVariable:n}),t.arraySizeStale=!0,t.previousArraySize=[],Object.defineProperty(t,"arraySize",{get:function(){return e.state[t.arraySizeStateVariable].isResolved?(t.arraySizeStale&&t.recalculateArraySizeDependentQuantities(),e.stateValues[t.arraySizeStateVariable]):[]}}),t.recalculateArraySizeDependentQuantities=function(){let i=e.stateValues[t.arraySizeStateVariable];if(t.previousArraySize.length!==i.length||t.previousArraySize.some((a,s)=>a!=i[s])){t.previousArraySize=[...i];let a=t.varNamesIncludingArrayKeys={};for(let s of t.arrayEntryNames){let o=e.state[s],u=t.getArrayKeysFromVarName({arrayEntryPrefix:o.entryPrefix,varEnding:o.varEnding,arraySize:i,nDimensions:t.nDimensions});o._unflattenedArrayKeys=u,o._arrayKeys=rt(u);for(let c of o._arrayKeys)a[c]||(a[c]=[]),a[c].push(s)}}t.arraySizeStale=!1},!t.freshnessInfo&&(t.entireArrayAtOnce?t.freshnessInfo={arrayFresh:!1}:t.freshnessInfo={freshByKey:{}},t.additionalStateVariablesDefined))for(let i of t.additionalStateVariablesDefined)e.state[i]||(e.state[i]={}),e.state[i].freshnessInfo=t.freshnessInfo}createArraySizeStateVariable({stateVarObj:t,component:e,stateVariable:n}){let r=`__array_size_${n}`;t.arraySizeStateVariable=r;let i,a;if(t.entireArrayAtOnce?t.additionalStateVariablesDefined?(a=[...t.additionalStateVariablesDefined],t.additionalStateVariablesDefined.push(r)):t.additionalStateVariablesDefined=[r]:t.stateVariablesDeterminingDependencies?(i=[...t.stateVariablesDeterminingDependencies],t.stateVariablesDeterminingDependencies.push(r)):t.stateVariablesDeterminingDependencies=[r],t.entireArrayAtOnce)e.state[r]={returnDependencies:t.returnDependencies.bind(t),getCurrentFreshness:t.getCurrentFreshness.bind(t),markStale:t.markStale.bind(t),freshenOnNoChanges:t.freshenOnNoChanges.bind(t),definition:t.definition.bind(t)},t.inverseDefinition&&(e.state[r].inverseDefinition=t.inverseDefinition.bind(t)),t.stateVariablesDeterminingDependencies&&(e.state[r].stateVariablesDeterminingDependencies=t.stateVariablesDeterminingDependencies),a?e.state[r].additionalStateVariablesDefined=a:e.state[r].additionalStateVariablesDefined=[],e.state[r].additionalStateVariablesDefined.push(n);else{if(t.isShadow){let s=e.state[r];s.markStale=function(){return t.arraySizeStale=!0,{}};return}e.state[r]={alwaysShadow:!0,returnDependencies:t.returnArraySizeDependencies,definition({dependencyValues:s}){let o=t.returnArraySize({dependencyValues:s});for(let[u,c]of o.entries())Number.isInteger(c)&&c>=0||(o[u]=0);return{newValues:{[r]:o}}},markStale(){return t.arraySizeStale=!0,{}}},i&&(e.state[r].stateVariablesDeterminingDependencies=i)}this.initializeStateVariable({component:e,stateVariable:r})}recursivelyReplaceCompositesWithReplacements({replacements:t,recurseNonStandardComposites:e=!1}){let n=[],r=[];for(let i of t)if(this.isCompositeComponent({componentType:i.componentType,includeNonStandard:e})){if(n.push(i.componentName),i.replacements){let a=this.recursivelyReplaceCompositesWithReplacements({replacements:i.replacements,recurseNonStandardComposites:e});n.push(...a.compositesFound),r.push(...a.newReplacements)}}else r.push(i);return{compositesFound:n,newReplacements:r}}getStateVariableValue({component:t,stateVariable:e}){let n=t.state[e];if(!(n&&n.isResolved))throw Error(`Can't get value of ${e} of ${t.componentName} as it doesn't exist or is not resolved.`);let r=this.getStateVariableDefinitionArguments({component:t,stateVariable:e});r.componentInfoObjects=this.componentInfoObjects,r.freshnessInfo=n.freshnessInfo;let i=n.additionalStateVariablesDefined;t instanceof this.allComponentClasses._composite&&(r.replacementsWorkspace=new Proxy(t.replacementsWorkspace,Be));let a;if(Object.keys(r.changes).length===0&&n._previousValue!==void 0&&!n.forceRecalculation){let u=[e];i&&u.push(...i),a={noChanges:u},n.freshenOnNoChanges&&n.freshenOnNoChanges(r)}else delete n.forceRecalculation,a=n.definition(r);let s={[e]:!1},o={};if(i)for(let u of i)s[u]=!1;for(let u in a.newValues){if(!(u in t.state))throw Error(`Definition of state variable ${e} of ${t.componentName} returned value of ${u}, which isn't a state variable.`);let c;if(u in s)s[u]=!0,o[u]=!0;else{if(t.state[u].isArray&&t.state[u].arrayEntryNames){for(let f of t.state[u].arrayEntryNames)if(f in s){c=f,s[f]=!0,o[f]=!0;break}}if(!c)throw Error(`Attempting to set value of stateVariable ${u} in definition of ${e} of ${t.componentName}, but it's not listed as an additional state variable defined.`)}if(!t.state[u].isResolved&&(!c||!t.state[c].isResolved))throw Error(`Attempting to set value of stateVariable ${u} of ${t.componentName} while it is still unresolved!`);if(t.state[u].isArray)if(t.state[u].entireArrayAtOnce)t.state[u].arrayValues=a.newValues[u],o[u]={arrayKeysChanged:{},allArrayKeysChanged:!0};else{o[u]={arrayKeysChanged:{}};let f={};a.checkForActualChange&&a.checkForActualChange[u]&&(f=a.checkForActualChange[u]);let p=t.state[u].arraySize;for(let d in a.newValues[u])if(f[d]){let m=t.state[u].getArrayValue({arrayKey:d}),v=a.newValues[u][d];m!==v&&(t.state[u].setArrayValue({value:a.newValues[u][d],arrayKey:d,arraySize:p}),o[u].arrayKeysChanged[d]=!0)}else t.state[u].setArrayValue({value:a.newValues[u][d],arrayKey:d,arraySize:p}),o[u].arrayKeysChanged[d]=!0}else if(delete t.state[u].value,t.state[u].value=a.newValues[u],delete t.state[u].usedDefault,a.checkForActualChange&&a.checkForActualChange[u]){let f=t.state[u].value,p=t.state[u]._previousValue;(f===p||Array.isArray(f)&&Array.isArray(p)&&f.length===p.length&&f.every((d,m)=>d===p[m]))&&delete o[u]}}for(let u in a.useEssentialOrDefaultValue){if(!(u in t.state))throw Error(`Definition of state variable ${e} of ${t.componentName} requested essential or default value of ${u}, which isn't a state variable.`);let c;if(u in s)s[u]=!0;else{if(t.state[u].isArray&&t.state[u].arrayEntryNames){for(let m of t.state[u].arrayEntryNames)if(m in s){c=m,s[m]=!0;break}}if(!c)throw Error(`Attempting to set value of stateVariable ${u} in definition of ${e} of ${t.componentName}, but it's not listed as an additional state variable defined.`)}if(!t.state[u].isResolved&&(!c||!t.state[c].isResolved))throw Error(`Attempting to set value of stateVariable ${u} of ${t.componentName} while it is still unresolved!`);let{haveEssentialValue:f,valueUnchanged:p,byArrayEntries:d}=this.setValueToEssential({component:t,varName:u,useEssentialInfo:a.useEssentialOrDefaultValue[u]});if(d){let m=t.state[u].arraySize;for(let v in a.useEssentialOrDefaultValue[u])f[v]||("defaultValue"in a.useEssentialOrDefaultValue[u][v]?(t.state[u].setArrayValue({value:a.useEssentialOrDefaultValue[u][v].defaultValue,arrayKey:v,arraySize:m}),t.state[u].essentialByArrayKey[v]=!0):"defaultEntryValue"in t.state[u]&&(t.state[u].setArrayValue({value:t.state[u].defaultEntryValue,arrayKey:v,arraySize:m}),t.state[u].essentialByArrayKey[v]=!0)),p[v]||(o[u]===void 0&&(o[u]={arrayKeysChanged:{}}),o[u].arrayKeysChanged[v]=!0)}else if(p||(o[u]=!0),!f)if("defaultValue"in a.useEssentialOrDefaultValue[u])delete t.state[u].value,t.state[u].value=a.useEssentialOrDefaultValue[u].defaultValue,t.state[u].usedDefault=!0,t.state[u].essential=!0;else if("defaultValue"in t.state[u])delete t.state[u].value,t.state[u].value=t.state[u].defaultValue,t.state[u].usedDefault=!0,t.state[u].essential=!0;else throw Error(`Neither value nor default value specified; state variable: ${u}, component: ${t.componentName}.`)}if(a.noChanges)for(let u of a.noChanges){if(!t.state[u].isResolved)throw Error(`Claiming state variable is unchanged when it isn't yet resolved: ${u} of ${t.componentName}`);if(!(u in s)){let c;if(t.state[u].isArray&&t.state[u].arrayEntryNames){for(let f of t.state[u].arrayEntryNames)if(f in s){c=f;break}}if(!c)throw Error(`Claiming stateVariable ${u} is unchanged in definition of ${e} of ${t.componentName}, but it's not listed as an additional state variable defined.`)}s[u]=!0,(Object.getOwnPropertyDescriptor(t.state[u],"value").get||t.state[u].immutable)&&(delete t.state[u].value,t.state[u].value=t.state[u]._previousValue)}if(a.makeEssential)for(let u of a.makeEssential){if(!(u in t.state))throw Error(`Definition of state variable ${e} of ${t.componentName} tried to make ${u} essential, which isn't a state variable.`);if(!t.state[u].isResolved)throw Error(`Attempting to make stateVariable ${u} of ${t.componentName} essential while it is still unresolved!`);if(!(u in s)){let c;if(t.state[u].isArray&&t.state[u].arrayEntryNames){for(let f of t.state[u].arrayEntryNames)if(f in s){c=f;break}}if(!c)throw Error(`Attempting to make stateVariable ${u} in definition of ${e} of ${t.componentName} essential, but it's not listed as an additional state variable defined.`)}t.state[u].essential=!0}if(a.makeImmutable)for(let u of a.makeImmutable){if(!(u in t.state))throw Error(`Definition of state variable ${e} of ${t.componentName} tried to make ${u} immutable, which isn't a state variable.`);if(!t.state[u].isResolved)throw Error(`Attempting to make stateVariable ${u} of ${t.componentName} immutable while it is still unresolved!`);if(!(u in s)){let c;if(t.state[u].isArray&&t.state[u].arrayEntryNames){for(let f of t.state[u].arrayEntryNames)if(f in s){c=f;break}}if(!c)throw Error(`Attempting to make stateVariable ${u} in definition of ${e} of ${t.componentName} immutable, but it's not listed as an additional state variable defined.`)}t.state[u].immutable=!0}if(a.alwaysShadow)for(let u of a.alwaysShadow){if(!(u in t.state))throw Error(`Definition of state variable ${e} of ${t.componentName} set alwaysShadow for ${u}, which isn't a state variable.`);if(!(u in s)){let c=!1;if(t.state[u].isArray&&t.state[u].arrayEntryNames){for(let f of t.state[u].arrayEntryNames)if(f in s){c=!0;break}}if(!c)throw Error(`Definition of state variable ${e} of ${t.componentName} set alwaysShadow for ${u}, but didn't set its value.`)}t.state[u].alwaysShadow=!0}if(a.setComponentType)for(let u in a.setComponentType){let c=!1,f=t.state[u].componentType,p=a.setComponentType[u];if(Array.isArray(f)?Array.isArray(p)?(f.length!==p.length||f.some((d,m)=>d!=p[m]))&&(c=!0):c=!0:Array.isArray(p)?c=!0:c=f!==p,c&&(o[u]=!0),t.state[u].componentType=a.setComponentType[u],t.state[u].isArray&&t.state[u].arrayEntryNames){let d=a.setComponentType[u],m=Array.isArray(d);for(let v of t.state[u].arrayEntryNames)if(m){let h=t.state[v].arrayKeys,y=[];for(let g of h){let b=t.state[u].keyToIndex(g);y.push(d[b])}t.state[v].componentType=y}else t.state[v].componentType=d}}if(a.arraySizeChanged)for(let u of a.arraySizeChanged)t.state[u].entireArrayAtOnce?o[t.state[u].arraySizeStateVariable]&&(o[u]===void 0?o[u]={arrayKeysChanged:{}}:o[u]===!0&&(o[u]={allArrayKeysChanged:!0,arrayKeysChanged:{}}),o[u].arraySizeChanged=!0):(t.state[u].adjustArrayToNewArraySize(),o[u]===void 0?o[u]={arrayKeysChanged:{}}:o[u]===!0&&(o[u]={allArrayKeysChanged:!0,arrayKeysChanged:{}}),o[u].arraySizeChanged=!0);for(let u in s){if(!(s[u]||t.state[u].isArrayEntry||t.state[u].isArray))throw Error(`definition of ${e} of ${t.componentName} didn't return value of ${u}`);if(t.state[u].isArray)delete t.state[u].value,t.state[u].value=t.state[u].arrayValues;else if(t.state[u].isArrayEntry){if(delete t.state[u].value,t.state[u].entireArrayAtOnce){let c=t.state[u].arraySizeStateVariable;o[c]&&(this.dependencies.recordActualChangeInUpstreamDependencies({component:t,varName:c,changes:o[c]}),delete o[c])}t.state[u].value=t.state[u].getValueFromArrayValues()}}for(let u in o)if(this.dependencies.recordActualChangeInUpstreamDependencies({component:t,varName:u,changes:o[u]}),t.state[u].isArray){let c=[];if(o[u]===!0||o[u].allArrayKeysChanged||o.arraySizeChanged)t.state[u].arrayEntryNames&&(c=t.state[u].arrayEntryNames);else{let f=t.state[u].varNamesIncludingArrayKeys;for(let p in o[u].arrayKeysChanged){let d=f[p];d&&c.push(...d)}}for(let f of c)this.dependencies.recordActualChangeInUpstreamDependencies({component:t,varName:f})}return n.value}setValueToEssential({component:t,varName:e,useEssentialInfo:n}){let r=!1,i=!1,a=!1;if(t.state[e].isArray)if("__entire_array"in n)n=n.__entire_array;else{a=!0,i={},r={};for(let s in n)r[s]=!1}if(t.state[e].essential&&!a)return t.state[e].isArray||(delete t.state[e].value,t.state[e].value=t.state[e]._previousValue),{haveEssentialValue:!0,valueUnchanged:!0,byArrayEntries:a};if(t.potentialEssentialState)if(a){let s=t.state[e].arraySize;for(let o in n)if(t.state[e].essentialByArrayKey[o]||t.state[e].essential)r[o]=!0,i[o]=!0;else{let u=n[o].variablesToCheck;Array.isArray(u)||(u=[u]);let{foundEssential:c,value:f}=this.findPotentialEssentialValue({variablesToCheck:u,potentialEssentialState:t.potentialEssentialState});c&&(t.state[e].setArrayValue({value:f,arrayKey:o,arraySize:s}),t.state[e].essentialByArrayKey[o]=!0,r[o]=!0)}}else{let s=n.variablesToCheck;Array.isArray(s)||(s=[s]);let{foundEssential:o,value:u}=this.findPotentialEssentialValue({variablesToCheck:s,potentialEssentialState:t.potentialEssentialState});o&&(t.state[e].isArray?t.state[e].arrayValues=u:(delete t.state[e].value,t.state[e].value=u),t.state[e].essential=!0,r=!0)}else if(a)for(let s in n)(t.state[e].essentialByArrayKey[s]||t.state[e].essential)&&(r[s]=!0,i[s]=!0);return{haveEssentialValue:r,valueUnchanged:i,byArrayEntries:a}}findPotentialEssentialValue({variablesToCheck:t,potentialEssentialState:e}){for(let n of t){let r,i,a;if(typeof n=="string"?r=n:(r=n.variableName,i=n.mathComponentIndex,a=n.arrayIndex),e[r]!==void 0){let s=e[r];if(a!==void 0)if(Array.isArray(a))for(let o of a)s=s[o];else s=s[a];else i!==void 0&&s instanceof Pb.default.class&&(s=s.get_component(i));return{foundEssential:!0,value:s}}}return{foundEssential:!1}}getStateVariableDefinitionArguments({component:t,stateVariable:e}){let n=this.dependencies.getStateVariableDependencyValues({component:t,stateVariable:e});n.componentName=t.componentName;let r=t.state[e];if(r.isArrayEntry&&!r.entireArrayAtOnce?(n.arrayKeys=r.arrayKeys,n.arraySize=r.arraySize):r.isArray&&!r.entireArrayAtOnce&&(n.arraySize=r.arraySize),r.providePreviousValuesInDefinition){let i=[e];r.additionalStateVariablesDefined&&i.push(...r.additionalStateVariablesDefined);let a={};for(let s of i)a[s]=t.state[s]._previousValue;n.previousValues=a}return n}recordActualChangeInStateVariable({componentName:t,varName:e,includeAdditionalStateVariables:n=!0,updatesNeeded:r}){let i=this._components[t];this.markStateVariableAndUpstreamDependentsStale({component:i,varName:e,updatesNeeded:r});let a=[e];n&&i.state[e].additionalStateVariablesDefined&&a.push(...i.state[e].additionalStateVariablesDefined);for(let s of a)i.state[s].forceRecalculation=!0,this.dependencies.recordActualChangeInUpstreamDependencies({component:i,varName:s})}resolveStateVariables({component:t,stateVariables:e,updatesNeeded:n,compositesBeingExpanded:r}){let i=t.componentName,a={},s=Infinity,o=[];e||(e=Object.keys(t.state));for(let u of e)t.state[u].isResolved||o.push(u);for(;o.length>0&&o.length<s;){let u=[];for(let c of o){if(n.deletedStateVariables[i]&&n.deletedStateVariables[i].includes(c))continue;let f=this.dependencies.downstreamDependencies[i][c],p=!0,d=[],m=!0;for(let v in f){let h=f[v];if(h.unresolvedSpecifiedComponent&&!this.switches.ignoreUnresolvedSpecifiedComponents&&(p=!1,h.unresolvedSpecifiedComponent!==i&&(m=!1),d.push({componentName:h.unresolvedSpecifiedComponent,stateVariable:"__specified_component_identity"})),h.requireChildLogicInitiallySatisfied&&!t.childLogicSatisfied&&!this.switches.ignoreRequireChildLogicInitiallySatisfied&&(p=!1,d.push({componentName:i,stateVariable:"__childLogic"})),h.expandReplacements){let b=this._components[h.compositeName];b.isExpanded||this.expandCompositeComponent({component:b,updatesNeeded:n,compositesBeingExpanded:r}).success||(p=!1,d.push({componentName:h.compositeName,stateVariable:"__replacements"}))}let y=h.downstreamComponentNames;y||(h.downstreamComponentName?y=[h.downstreamComponentName]:y=[]);let g=h.mappedDownstreamVariableNamesByComponent;g||h.mappedDownstreamVariableName&&(g=[[h.mappedDownstreamVariableName]]);for(let[b,x]of y.entries()){let N=this._components[x];if(!N)p=!1,x!==i&&(m=!1),d.push({componentName:x,stateVariable:"__identity"});else if(g){let C=g[b];for(let _ of C){let w=!1;if(!N.state[_]){if((h.variablesOptional||h.variableOptional)&&!this.checkIfArrayEntry({stateVariable:_,component:N}))continue;let A=this.createFromArrayEntry({stateVariable:_,component:N,updatesNeeded:n,compositesBeingExpanded:r});Object.keys(A.varsUnresolved).length>0&&(this.addUnresolvedDependencies({varsUnresolved:A.varsUnresolved,component:N,updatesNeeded:n}),N.componentName===i&&Object.assign(a,A.varsUnresolved))}N.state[_]&&N.state[_].isResolved&&(w=!0),w||(p=!1,x!==i&&(m=!1),d.push({componentName:x,stateVariable:_}))}}else if(h.downstreamAttribute)throw Error(`Unrecognized downstream attribute ${h.downstreamAttribute} for state variable ${c} of ${i}`)}}if(t.state[c].isResolved=p,p){if(delete a[c],t.state[c].actionOnResolved){let v=this.getStateVariableDefinitionArguments({component:t,stateVariable:c});v.updatesNeeded=n;let h=t.state[c].resolvedAction(v);h&&h.varsUnresolved&&Object.assign(a,h.varsUnresolved),c in t.state&&t.stateValues[c]}}else{let v=[...new Set(d.map(h=>h.componentName+"|"+h.stateVariable))];a[c]=v.map(function(h){let y=h.split("|");return{componentName:y[0],stateVariable:y[1]}}),m&&u.push(c)}}s=o.length,o=u}return{varsUnresolved:a}}findCaseInsensitiveMatches({stateVariables:t,componentClass:e}){let n=this.componentInfoObjects.stateVariableInfo[e.componentType.toLowerCase()],r=[];for(let i of t){let a=!1,s=i.toLowerCase();for(let f in n.stateVariableDescriptions)if(s===f.toLowerCase()){a=!0,r.push(f);break}if(a)continue;let o=!1,u=s;s.substring(0,13)==="__array_size_"&&(o=!0,u=s.substring(13));for(let f in n.aliases)if(u===f.toLowerCase()){o&&(f="__array_size_"+f),r.push(f),a=!0;break}if(a)continue;let c=Object.keys(n.arrayEntryPrefixes).sort((f,p)=>p.length-f.length);for(let f of c)if(s.substring(0,f.length)===f.toLowerCase()){let p=f+s.substring(f.length);a=!0,r.push(p);break}a||r.push(i)}return r}matchPublicStateVariables({stateVariables:t,componentClass:e}){let n=this.componentInfoObjects.publicStateVariableInfo[e.componentType.toLowerCase()],r=[];for(let i of t){if(i in n.stateVariableDescriptions){r.push(i);continue}let a=i;if(a in n.aliases&&(a=n.aliases[a],a in n.stateVariableDescriptions)){r.push(a);continue}let s=!1,o=Object.keys(n.arrayEntryPrefixes).sort((u,c)=>c.length-u.length);for(let u of o)if(a.substring(0,u.length)===u){s=!0;break}s?r.push(i):r.push("__not_public_"+i)}return r}substituteAliases({stateVariables:t,componentClass:e}){let n=[],r=this.componentInfoObjects.stateVariableInfo[e.componentType.toLowerCase()];for(let i of t){let a=!1;i.substring(0,13)==="__array_size_"&&(a=!0,i=i.substring(13)),i=i in r.aliases?r.aliases[i]:i,a&&(i="__array_size_"+i),n.push(i)}return n}checkIfArrayEntry({stateVariable:t,component:e}){for(let n in e.arrayEntryPrefixes)if(t.substring(0,n.length)===n)return!0;return!1}createFromArrayEntry({stateVariable:t,component:e,updatesNeeded:n,compositesBeingExpanded:r,initializeOnly:i=!1}){let a={},s=!1;if(!e.arrayEntryPrefixes)throw Error(`Unknown state variable ${t} of ${e.componentName}`);let o=Object.keys(e.arrayEntryPrefixes).sort((u,c)=>c.length-u.length);for(let u of o)if(t.substring(0,u.length)===u){let c=e.arrayEntryPrefixes[u];if(this.initializeStateVariable({component:e,stateVariable:t,arrayStateVariable:c,arrayEntryPrefix:u,updatesNeeded:n}),i)return{varsUnresolved:a};let f=[t];if(e.state[t].additionalStateVariablesDefined){f.push(...e.state[t].additionalStateVariablesDefined);for(let m of e.state[t].additionalStateVariablesDefined)e.state[m]||this.createFromArrayEntry({stateVariable:m,component:e,updatesNeeded:n,compositesBeingExpanded:r,initializeOnly:!0})}this.dependencies.setUpStateVariableDependencies({component:e,stateVariable:t,allStateVariablesAffected:f,core:this,updatesNeeded:n,compositesBeingExpanded:r});let p=[];for(let m of f)this.dependencies.checkForCircularDependency({componentName:e.componentName,varName:m}),p.push(m),e.state[m].determineDependenciesStateVariable&&p.push(e.state[m].determineDependenciesStateVariable);let d=this.resolveStateVariables({component:e,stateVariables:p,updatesNeeded:n,compositesBeingExpanded:r});Object.assign(a,d.varsUnresolved),s=!0;break}if(!s)throw Error(`Unknown state variable ${t} of ${e.componentName}`);return{varsUnresolved:a}}resolveAllDependencies(t,e){console.log("resolving all dependencies");let n=[],r=!0,i=!1;for(;r&&Object.keys(t.unresolvedDependencies).length>0||i;){r=!1,i=!1;for(let a in t.unresolvedByDependent){let s=t.deletedComponents[a],o=!1;if(!(a in this.components)&&!s){if(this.switches.ignoreUnresolvedSpecifiedComponents){let u=Object.keys(t.unresolvedByDependent[a]);u.length===1&&u[0]==="__specified_component_identity"&&(o=!0)}if(!o){n.push(a);continue}}for(let u in t.unresolvedByDependent[a]){if(s=t.deletedComponents[a],u==="__replacements"&&!s&&!this.components[a].isExpanded||u==="__childLogic"&&!s&&!this.components[a].childLogicSatisfied&&!this.switches.ignoreRequireChildLogicInitiallySatisfied)continue;let c=t.deletedStateVariables[a]&&t.deletedStateVariables[a].includes(u);if(u!=="__identity"&&u!=="__specified_component_identity"&&u!=="__replacements"&&u!=="__childLogic"&&!s&&!(u in this.components[a].state)&&!c){if(t.recreatedComponents[a])continue;throw Error(`Reference to invalid state variable ${u} of ${a}`)}if(!(a in t.unresolvedDependencies)||s||c||o||!(u in t.unresolvedDependencies[a])){for(let f of t.unresolvedByDependent[a][u]){let p=this._components[f.componentName];if(t.unresolvedDependencies[f.componentName]===void 0||t.unresolvedDependencies[f.componentName][f.stateVariable]===void 0)continue;if(t.deletedStateVariables[f.componentName]&&t.deletedStateVariables[f.componentName].includes(f.stateVariable)){delete t.unresolvedDependencies[f.componentName][f.stateVariable],Object.keys(t.unresolvedDependencies[f.componentName]).length===0&&delete t.unresolvedDependencies[f.componentName];continue}let d=this.resolveStateVariables({component:p,stateVariables:[f.stateVariable],updatesNeeded:t,compositesBeingExpanded:e});if(t.compositesToUpdateReplacements.length>0&&this.replacementChangesFromCompositesToUpdate({updatesNeeded:t,compositesBeingExpanded:e}),Object.keys(d.varsUnresolved).length>0){let m=Object.assign({},d.varsUnresolved);if(delete m[f.stateVariable],Object.keys(m).length>0){this.addUnresolvedDependencies({varsUnresolved:m,component:p,updatesNeeded:t});for(let v in m)delete d.varsUnresolved[v]}}Object.keys(d.varsUnresolved).length===0?(r=!0,delete t.unresolvedDependencies[f.componentName][f.stateVariable],Object.keys(t.unresolvedDependencies[f.componentName]).length===0&&delete t.unresolvedDependencies[f.componentName],f.stateVariable==="readyToExpand"&&p instanceof this._allComponentClasses._composite&&(this.processNewDefiningChildren({parent:this._components[p.parentName],updatesNeeded:t,compositesBeingExpanded:e}),t.compositesToUpdateReplacements.length>0&&this.replacementChangesFromCompositesToUpdate({updatesNeeded:t,compositesBeingExpanded:e}))):this.recalculateUnresolvedForDep({dep:f,componentName:a,varName:u,updatesNeeded:t,varsUnresolved:d.varsUnresolved}),delete d.varsUnresolved[f.stateVariable]}(!(a in t.unresolvedDependencies)||s||c||o||!(u in t.unresolvedDependencies[a]))&&(delete t.unresolvedByDependent[a][u],Object.keys(t.unresolvedByDependent[a]).length===0&&delete t.unresolvedByDependent[a])}}}for(let a of t.compositesToExpand){let s=this._components[a];if(!s)continue;let o=t.compositesToExpand.size;this.processNewDefiningChildren({parent:this._components[s.parentName],updatesNeeded:t,compositesBeingExpanded:e}),t.compositesToExpand.size<o&&(r=!0,t.compositesToUpdateReplacements.length>0&&this.replacementChangesFromCompositesToUpdate({updatesNeeded:t,compositesBeingExpanded:e}))}r&&Object.keys(t.unresolvedDependencies).length>0||(this.switches.ignoreUnresolvedSpecifiedComponents||(this.switches.ignoreUnresolvedSpecifiedComponents=!0,i=!0),this.switches.ignoreRequireChildLogicInitiallySatisfied||(this.switches.ignoreRequireChildLogicInitiallySatisfied=!0,i=!0))}for(let a in this.dependencies.updateTriggers.dependenciesMissingComponentBySpecifiedName)for(let s of this.dependencies.updateTriggers.dependenciesMissingComponentBySpecifiedName[a])s.dependencyType==="targetComponent"?console.error(`Reference to invalid target name ${s.tName} by component ${s.upstreamComponentName}`):console.error(`Dependency ${s.dependencyName} of state variable ${s.representativeStateVariable} of component ${s.upstreamComponentName} references unknown component ${a}`);Object.keys(t.unresolvedDependencies).length>0&&this.createUnresolvedMessage(n,t),this.switches.ignoreUnresolvedSpecifiedComponents=!1,this.switches.ignoreRequireChildLogicInitiallySatisfied=!1}createUnresolvedMessage(t,e){let n="",r="",i="";if(t.length>0){t=new Set(t);for(let a of t)a in this.components||(i+=`Reference to invalid component name ${a}. `)}if(i)e.unresolvedMessage=i;else{for(let a in e.unresolvedDependencies){let s=this.components[a];if(!s.childLogicSatisfied)n+=`Invalid children for ${a}: ${s.childLogic.logicResult.message} `;else for(let o in e.unresolvedDependencies[a])r+=`Could not resolve state variable ${o} of ${a}. `}n?e.unresolvedMessage=n:e.unresolvedMessage=r}}recalculateUnresolvedForDep({dep:t,componentName:e,varName:n,varsUnresolved:r,updatesNeeded:i}){for(let a of i.unresolvedDependencies[t.componentName][t.stateVariable]){let s=a.componentName,o=a.stateVariable;if(s!==e||o!==n){let u;for(let[c,f]of i.unresolvedByDependent[s][o].entries())if(f.componentName===t.componentName&&f.stateVariable===t.stateVariable){u=c;break}if(u===void 0)throw Error("Something went wrong with unresolved dependencies....");i.unresolvedByDependent[s][o].splice(u,1)}}i.unresolvedDependencies[t.componentName][t.stateVariable]=r[t.stateVariable];for(let a of r[t.stateVariable]){let s=a.componentName,o=a.stateVariable;if(s===e&&o===n)throw Error(`State variable ${o} of ${s} reported as unresolved after already being resolved.`);i.unresolvedByDependent[s]===void 0&&(i.unresolvedByDependent[s]={}),i.unresolvedByDependent[s][o]===void 0&&(i.unresolvedByDependent[s][o]=[]),i.unresolvedByDependent[s][o].push({componentName:t.componentName,stateVariable:t.stateVariable})}}resetUpstreamDependentsUnresolved({component:t,varName:e,updatesNeeded:n}){let r=this.dependencies.upstreamDependencies[t.componentName][e];if(r)for(let i of r){n.componentsTouched.push(i.upstreamComponentName);let a=this._components[i.upstreamComponentName],s={};for(let o of i.upstreamVariableNames)s[o]=[{componentName:t.componentName,stateVariable:e}];this.addUnresolvedDependencies({varsUnresolved:s,component:a,updatesNeeded:n});for(let o of i.upstreamVariableNames){let u=a.state[o];u.isResolved&&(u.isResolved=!1,this.resetUpstreamDependentsUnresolved({component:a,varName:o,updatesNeeded:n}))}}}markStateVariableAndUpstreamDependentsStale({component:t,varName:e,updatesNeeded:n}){n.componentsTouched.push(t.componentName);let r={[e]:t.state[e]};t.state[e].additionalStateVariablesDefined&&t.state[e].additionalStateVariablesDefined.forEach(p=>r[p]=t.state[p]);let i=this.lookUpCurrentFreshness({component:t,varName:e,allStateVariablesAffectedObj:r}),a=[],s=[],o=0;for(let p in r){let d=r[p];Object.getOwnPropertyDescriptor(d,"value").get||d.immutable?i&&(i.fresh&&i.fresh[p]?s.push(p):i.partiallyFresh&&i.partiallyFresh[p]&&(o+=i.partiallyFresh[p])):a.push(p)}s.push(...a);let u=s.length>0||o>0,c={};for(let p in r)c[p]=!0;let f=!1;if(u){let p=this.processMarkStale({component:t,varName:e,allStateVariablesAffectedObj:r});if(p.fresh)for(let m in p.fresh)p.fresh[m]&&delete c[m];let d=0;for(let m in r){if(s.includes(m)&&!(p.fresh&&p.fresh[m])){f=!0;break}p.partiallyFresh&&p.partiallyFresh[m]&&(d+=p.partiallyFresh[m])}if(d<o&&(f=!0),p.updateReplacements&&n.compositesToUpdateReplacements.push(t.componentName),p.updateDependencies&&n.componentsToUpdateDependencies.push({componentName:t.componentName,stateVariables:p.updateDependencies}),p.itemScoreChanged)for(let m of p.itemScoreChanged.itemNumbers)n.itemScoreChanges.add(m)}for(let p in c){let d=r[p];if(delete d.recursiveDependencyValues,a.includes(p)){d._previousValue=d.value,delete d.value;let m=this.getStateVariableValue;Object.defineProperty(d,"value",{get:()=>m({component:t,stateVariable:p}),configurable:!0})}}if(f)for(let p in c)this.markUpstreamDependentsStale({component:t,varName:p,updatesNeeded:n})}lookUpCurrentFreshness({component:t,varName:e,allStateVariablesAffectedObj:n}){let r=t.state[e];if(!r.getCurrentFreshness)return;let i=r.freshnessInfo,a,s;if(r.isArrayEntry&&(a=new Proxy(r._arrayKeys,Be)),r.isArrayEntry||r.isArray){let u=t.state[r.arraySizeStateVariable];s=u._previousValue,!(Object.getOwnPropertyDescriptor(u,"value").get||u.immutable)&&(s=u.value),Array.isArray(s)?s=new Proxy(s,Be):s=[]}let o=r.getCurrentFreshness({freshnessInfo:i,arrayKeys:a,arraySize:s});if(o.partiallyFresh){for(let u in n)if(n[u].isArrayEntry){let c=n[u].arrayStateVariable;o.partiallyFresh[u]=o.partiallyFresh[c],delete o.partiallyFresh[c]}}if(o.fresh){for(let u in n)if(n[u].isArrayEntry){let c=n[u].arrayStateVariable;c in o.fresh&&(o.fresh[u]=o.fresh[c],delete o.fresh[c])}}return o}processMarkStale({component:t,varName:e,allStateVariablesAffectedObj:n}){let r=t.state[e];if(!r.markStale){let f={};return Object.keys(n).forEach(p=>f[p]=!1),{fresh:f}}let i={},a=this.dependencies.downstreamDependencies[t.componentName][e];for(let f in a){let p=a[f],d={},m=!1;p.componentIdentityChanged&&(d.componentIdentityChanged=!0,m=!0),p.componentIdentitiesChanged&&(d.componentIdentitiesChanged=!0,m=!0),p.valuesChanged&&(d.valuesChanged=p.valuesChanged,m=!0),m&&(i[f]=d)}let s=r.freshnessInfo,o,u;if(r.isArrayEntry&&!r.entireArrayAtOnce&&(o=new Proxy(r._arrayKeys,Be)),(r.isArrayEntry||r.isArray)&&!r.entireArrayAtOnce){let f=t.state[r.arraySizeStateVariable];u=f._previousValue,!(Object.getOwnPropertyDescriptor(f,"value").get||f.immutable)&&(u=f.value),Array.isArray(u)?u=new Proxy(u,Be):u=[]}let c=r.markStale({freshnessInfo:s,changes:i,arrayKeys:o,arraySize:u});if(c.partiallyFresh){for(let f in n)if(n[f].isArrayEntry){let p=n[f].arrayStateVariable;c.partiallyFresh[f]=c.partiallyFresh[p],delete c.partiallyFresh[p]}}if(c.fresh){for(let f in n)if(n[f].isArrayEntry){let p=n[f].arrayStateVariable;p in c.fresh&&(c.fresh[f]=c.fresh[p],delete c.fresh[p])}}return c}markUpstreamDependentsStale({component:t,varName:e,updatesNeeded:n}){let r=t.componentName,i=this.getStateVariableValue,a=this.dependencies.upstreamDependencies[r][e],s;if(t.state[e]&&(s=t.state[e].freshnessInfo),a)for(let o of a){let u=!1;if(o.downstreamComponentNames){let c=o.downstreamComponentNames.indexOf(r);if(c===-1)continue;if(o.originalDownstreamVariableNames.length>0){let f=o.mappedDownstreamVariableNamesByComponent[c].indexOf(e);if(f===-1)throw Error(`something went wrong as ${e} not a downstreamVariable of ${o.dependencyName}`);let p=o.originalDownstreamVariableNames[f];o.valuesChanged||(o.valuesChanged=[]),o.valuesChanged[c]||(o.valuesChanged[c]={}),o.valuesChanged[c][e]||(o.valuesChanged[c][e]={}),o.valuesChanged[c][e].potentialChange=!0,s&&(o.valuesChanged[c][e].freshnessInfo=new Proxy(s,Be)),u=!0}else e===o.downstreamVariableNameIfNoVariables&&(o.valuesChanged||(o.valuesChanged={[o.downstreamVariableNameIfNoVariables]:{}}),o.componentIdentityChanged=!0,o.valuesChanged[o.downstreamVariableNameIfNoVariables].potentialChange=!0,u=!0)}if(u){n.componentsTouched.push(o.upstreamComponentName);let c=o.upstreamVariableNames[0],f=this._components[o.upstreamComponentName],p={};o.upstreamVariableNames.forEach(x=>p[x]=f.state[x]);let d=this.lookUpCurrentFreshness({component:f,varName:c,allStateVariablesAffectedObj:p}),m=[],v=[],h=0;for(let x in p){let N=p[x];Object.getOwnPropertyDescriptor(N,"value").get||N.immutable?d&&(d.fresh&&d.fresh[x]?v.push(x):d.partiallyFresh&&d.partiallyFresh[x]&&(h+=d.partiallyFresh[x])):m.push(x)}v.push(...m);let y=v.length>0||h>0,g={};for(let x in p)g[x]=!0;let b=!1;if(y){let x=this.processMarkStale({component:f,varName:c,allStateVariablesAffectedObj:p});if(x.fresh)for(let C in x.fresh)x.fresh[C]&&delete g[C];let N=0;for(let C in p){if(v.includes(C)&&!(x.fresh&&x.fresh[C])){b=!0;break}x.partiallyFresh&&x.partiallyFresh[C]&&(N+=x.partiallyFresh[C])}if(N<h&&(b=!0),x.updateReplacements&&n.compositesToUpdateReplacements.push(o.upstreamComponentName),x.updateDependencies&&n.componentsToUpdateDependencies.push({componentName:o.upstreamComponentName,stateVariables:x.updateDependencies}),x.itemScoreChanged)for(let C of x.itemScoreChanged.itemNumbers)n.itemScoreChanges.add(C)}for(let x in g){let N=p[x];delete N.recursiveDependencyValues,m.includes(x)&&(N._previousValue=N.value,delete N.value,Object.defineProperty(N,"value",{get:()=>i({component:f,stateVariable:x}),configurable:!0}))}if(b)for(let x in g)this.markUpstreamDependentsStale({component:f,varName:x,updatesNeeded:n})}}}evaluatedDeferredChildStateVariables(t){for(let e of t.activeChildren)if(e.componentType==="string"){for(let n in e.state)if(e.state[n].deferred){let r=e.state[n].value}}}registerComponent(t){if(t.componentName in this._components)throw Error(`Duplicate componentName: ${t.componentName}`);this._components[t.componentName]=t}deregisterComponent(t,e=!0){if(e===!0)for(let n in t.allChildren)this.deregisterComponent(t.allChildren[n].component);delete this._components[t.componentName]}setAncestors(t,e=[]){t.ancestors=e;let n=[{componentName:t.componentName,componentClass:t.constructor},...t.ancestors];for(let r in t.allChildren){let i=this._components[r];this.setAncestors(i,n)}}addChildren({parent:t,indexOfDefiningChildren:e,newChildren:n,updatesNeeded:r,compositesBeingExpanded:i}){this.spliceChildren(t,e,n);let a=this.processNewDefiningChildren({parent:t,updatesNeeded:r,compositesBeingExpanded:i}),s={},o={};return n.forEach(u=>s[u.componentName]=u),a.success?{success:!0,deletedComponents:o,addedComponents:s}:a}processNewDefiningChildren({parent:t,updatesNeeded:e,compositesBeingExpanded:n}){this.parameterStack.push(t.sharedParameters,!1);let r=this.deriveChildResultsFromDefiningChildren(t,e,n);this.parameterStack.pop();let i=[{componentName:t.componentName,componentClass:t.constructor},...t.ancestors];for(let a in t.allChildren){let s=this._components[a];this.setAncestors(s,i)}return this.dependencies.updateChildAndDescendantDependencies(t,e,n),r}spliceChildren(t,e,n){let r=t.definingChildren.length;if(!Number.isInteger(e)||e>r||e<0)throw Error("Can't add children at index "+e+". Invalid index.");t.definingChildren.splice(e,0,...n)}finishUpdate({deletedComponents:t,addedComponents:e,init:n=!1}={}){}deleteComponents({components:t,deleteUpstreamDependencies:e=!0,cancelIfUpstreamDeleteFailure:n=!0,updatesNeeded:r,compositesBeingExpanded:i}){Array.isArray(t)||(t=[t]);let a={};this.determineComponentsToDelete({components:t,deleteUpstreamDependencies:e,componentsToDelete:a});let s={};for(let p in a){let d=a[p],m=this.components[d.parentName];if(m===void 0||m.componentName in a)continue;let v=s[d.parentName];v===void 0&&(v={parent:this._components[d.parentName],definingChildrenNames:new Set},s[d.parentName]=v),v.definingChildrenNames.add(p)}let o=!0,u={},c={};for(let p in a){let d=this._components[p];if(d.replacementOf){let m=d.replacementOf;for(let[v,h]of m.replacements.entries())if(h.componentName===p){let y=c[m.componentName];y===void 0&&(y=c[m.componentName]=[]),y.push({ind:v,replacement:m.replacements[v]}),m.replacements.splice(v,1),this.dependencies.updateReplacementDependencies(m,r,i);break}}}for(let p in s){let d=s[p],m=d.parent;u[p]=m.definingChildren,m.definingChildren=m.definingChildren.slice();let v=!1;for(let h=m.definingChildren.length-1;h>=0;h--){let y=m.definingChildren[h];d.definingChildrenNames.has(y.componentName)&&(m.definingChildren.splice(h,1),v=!0)}v&&(this.processNewDefiningChildren({parent:m,updatesNeeded:r,compositesBeingExpanded:i}).success||(console.log("***** can't delete because couldn't derive child results"),o=!1))}if(o===!1&&e===!0&&n!==!0&&console.log("**** Need to determine whether or not can delete components and leave upstream in place"),o===!1){console.log("Failed to delete components");for(let p in c){let d=c[p],m=this._components[p];for(;d.length>0;){let v=d.pop();m.replacements.splice(v.ind,0,v.replacement),this.dependencies.updateReplacementDependencies(m,r,i)}}for(let p in s){let m=s[p].parent;m.definingChildren=u[p],this.processNewDefiningChildren({parent:m,updatesNeeded:r,compositesBeingExpanded:i})}return{success:!1}}let f=[];for(let p in s){let m=s[p].parent;f.push(m),this.processNewDefiningChildren({parent:m,updatesNeeded:r,compositesBeingExpanded:i})}for(let p in c)if(!(p in a)){r.parentsToUpdateDescendants.add(p);for(let d of Ar(this._components[p],this.components))r.parentsToUpdateDescendants.add(d)}for(let p in a){let d=this._components[p];if(d.shadows){let m=this._components[d.shadows.componentName];m.shadowedBy.length===1?delete m.shadowedBy:m.shadowedBy.splice(m.shadowedBy.indexOf(d),1)}this.dependencies.deleteAllDownstreamDependencies({component:d,updatesNeeded:r});for(let m in this.dependencies.upstreamDependencies[d.componentName]){let v=this.dependencies.upstreamDependencies[d.componentName][m];for(let h of v)if(h.specifiedComponentName&&h.specifiedComponentName in a){let y=this.dependencies.updateTriggers.dependenciesMissingComponentBySpecifiedName[h.specifiedComponentName];y||(y=this.dependencies.updateTriggers.dependenciesMissingComponentBySpecifiedName[h.specifiedComponentName]=[]),y.includes(h)||y.push(h)}}this.dependencies.deleteAllUpstreamDependencies({component:d,updatesNeeded:r}),r.deletedStateVariables[d.componentName]||(r.deletedStateVariables[d.componentName]=[]),r.deletedStateVariables[d.componentName].push(...Object.keys(d.state)),r.deletedComponents[d.componentName]=!0,delete this.unsatisfiedChildLogic[d.componentName]}for(let p in a){let d=this._components[p];this.deregisterComponent(d,!1)}return r.componentsTouched=[...new Set(r.componentsTouched)].filter(p=>!(p in a)),r.compositesToUpdateReplacements=[...new Set(r.compositesToUpdateReplacements)].filter(p=>!(p in a)),r.componentsToUpdateDependencies=r.componentsToUpdateDependencies.filter(p=>!(p.componentName in a)),{success:!0,deletedComponents:a,parentsOfDeleted:f}}determineComponentsToDelete({components:t,deleteUpstreamDependencies:e,componentsToDelete:n}){for(let r of t){if(r.componentName in n)continue;n[r.componentName]=this._components[r.componentName];let i=Object.values(r.allChildren).map(a=>a.component);r.adaptedFrom!==void 0&&i.push(r.adaptedFrom),e===!0&&(r.shadowedBy&&i.push(...r.shadowedBy),r.adapterUsed&&i.push(r.adapterUsed),r.replacements&&i.push(...r.replacements)),this.determineComponentsToDelete({components:i,deleteUpstreamDependencies:e,componentsToDelete:n})}}updateCompositeReplacements({component:t,componentChanges:e,sourceOfUpdate:n,updatesNeeded:r,compositesBeingExpanded:i}){let a={},s={},o=new Set;if(t.shadows)return{success:!0,deletedComponents:a,addedComponents:s,parentsOfDeleted:o};let u=this.components[t.componentName];t.replacements||(t.replacements=[]);let c=t.constructor.calculateReplacementChanges({component:u,componentChanges:e,components:this.components,workspace:t.replacementsWorkspace,componentInfoObjects:this.componentInfoObjects}),f=[];for(let d of c)if(d.changeType==="add"){d.replacementsToWithhold!==void 0&&this.adjustReplacementsToWithhold({component:t,change:d,componentChanges:e,updatesNeeded:r,compositesBeingExpanded:i});let m=this._components[t.componentName];this.parameterStack.push(m.sharedParameters,!1);let v,h={[t.componentName]:bi(t)},y=d.numberReplacementsToReplace,g=d.firstReplacementInd;if(y>0&&d.changeTopLevelReplacements&&this.deleteReplacementsFromShadowsThenComposite({change:d,composite:t,componentChanges:e,sourceOfUpdate:n,parentsOfDeleted:o,deletedComponents:a,addedComponents:s,updatesNeeded:r,compositesBeingExpanded:i}),d.serializedReplacements){let x=d.serializedReplacements,N;t.doenetAttributes.newNamespace?N=t.componentName+"/":N=mn(t.componentName),v=this.createIsolatedComponentsSub({serializedComponents:x,ancestors:t.ancestors,updatesNeeded:r,compositesBeingExpanded:i,createNameContext:t.componentName+"|replacements",namespaceForUnamed:N,componentsReplacementOf:t}).components}else throw Error("Invalid replacement change.");this.parameterStack.pop();let b={[t.componentName]:{newComponents:v,parent:d.parent}};if(m.shadowedBy){let x=this.createShadowedReplacements({replacementsToShadow:v,componentToShadow:m,parentToShadow:d.parent,updatesNeeded:r,compositesBeingExpanded:i,currentShadowedBy:h,assignNamesOffset:d.assignNamesOffset,componentChanges:e,sourceOfUpdate:n,parentsOfDeleted:o,deletedComponents:a,addedComponents:s});Object.assign(b,x)}for(let x in b){f.push(x);let N=this._components[x];if(!N)continue;let C=b[x].newComponents;if(!N.isExpanded){this.expandCompositeComponent({component:N,updatesNeeded:r,compositesBeingExpanded:i});let _={changeType:"addedReplacements",composite:N,newReplacements:N.replacements,topLevel:!0,firstIndex:0,numberDeleted:0};e.push(_);continue}for(let _ of C)s[_.componentName]=_;if(d.changeTopLevelReplacements===!0){let _=this._components[N.parentName];N.replacements.splice(g,0,...C),this.dependencies.updateReplacementDependencies(N,r,i);let w={changeType:"addedReplacements",composite:N,newReplacements:C,topLevel:!0,firstIndex:g,numberDeleted:y};e.push(w),this.processNewDefiningChildren({parent:_,updatesNeeded:r,compositesBeingExpanded:i}),r.componentsTouched.push(...this.componentAndRenderedDescendants(_))}else{let _=this._components[b[x].parent.componentName];this.spliceChildren(_,d.indexOfDefiningChildren,C),this.processNewDefiningChildren({parent:_,updatesNeeded:r,compositesBeingExpanded:i}),C.forEach(A=>s[A.componentName]=A),r.componentsTouched.push(...this.componentAndRenderedDescendants(_));let w={changeType:"addedReplacements",composite:N,newReplacements:C};e.push(w)}}}else if(d.changeType==="delete"){d.replacementsToWithhold!==void 0&&this.adjustReplacementsToWithhold({component:t,change:d,componentChanges:e,updatesNeeded:r,compositesBeingExpanded:i});let m=this.deleteReplacementsFromShadowsThenComposite({change:d,composite:t,componentsToDelete:d.components,componentChanges:e,sourceOfUpdate:n,parentsOfDeleted:o,deletedComponents:a,addedComponents:s,updatesNeeded:r,compositesBeingExpanded:i});f.push(...m)}else{if(d.changeType==="moveDependency")throw Error("moveDependency not implemented");if(d.changeType==="addDependency")throw Error("addDependency not implemented");if(d.changeType==="updateStateVariables"){r.componentsTouched.push(d.component.componentName);let m={},v={};for(let h in d.stateChanges){let y={componentName:d.component.componentName,stateVariable:h,value:d.stateChanges[h],overrideFixed:!0};this.requestComponentChanges({instruction:y,initialChange:!1,workspace:m,updatesNeeded:r,newStateVariableValues:v})}this.processNewStateVariableValues(v,r)}else if(d.changeType==="changeReplacementsToWithhold"){if(d.replacementsToWithhold!==void 0){let m=this.adjustReplacementsToWithhold({component:t,change:d,componentChanges:e,updatesNeeded:r,compositesBeingExpanded:i});f.push(...m)}this.processChildChangesAndRecurseToShadows({component:t,updatesNeeded:r,compositesBeingExpanded:i})}}for(let d of f){let m=this._components[d];r.parentsToUpdateDescendants.add(m.componentName);for(let v of Ar(m,this.components))r.parentsToUpdateDescendants.add(v)}return{success:!0,deletedComponents:a,addedComponents:s,parentsOfDeleted:o}}deleteReplacementsFromShadowsThenComposite({change:t,composite:e,componentsToDelete:n,componentChanges:r,sourceOfUpdate:i,parentsOfDeleted:a,deletedComponents:s,addedComponents:o,updatesNeeded:u,compositesBeingExpanded:c}){let f=[];if(!e.isExpanded)return f;if(e.shadowedBy)for(let p of e.shadowedBy){let d;if(n){d=[];for(let v of n){let h;if(v.shadowedBy){for(let y of v.shadowedBy)if(y.shadows.compositeName===p.shadows.compositeName){h=y;break}}h?d.push(h):console.error(`could not find shadowing component of ${v.componentName}`)}}let m=this.deleteReplacementsFromShadowsThenComposite({change:t,composite:p,componentsToDelete:d,componentChanges:r,sourceOfUpdate:i,parentsOfDeleted:a,deletedComponents:s,addedComponents:o,updatesNeeded:u,compositesBeingExpanded:c});f.push(...m)}if(t.changeTopLevelReplacements){let p=t.firstReplacementInd,d=t.numberReplacementsToDelete;t.changeType==="add"&&(d=t.numberReplacementsToReplace);let m=e.replacements.splice(p,d);this.dependencies.updateReplacementDependencies(e,u,c);let v=this.deleteComponents({components:m,componentChanges:r,sourceOfUpdate:i,updatesNeeded:u});if(v.success===!1)throw Error("Couldn't delete components on composite update");for(let b of v.parentsOfDeleted)a.add(b.componentName),u.componentsTouched.push(...this.componentAndRenderedDescendants(b));let h={};for(let b in v.deletedComponents){let N=v.deletedComponents[b].parentName;h[N]===void 0&&(h[N]=[]),h[N].push(b)}let y={changeType:"deletedReplacements",composite:e,topLevel:!0,firstIndex:p,numberDeleted:d,deletedNamesByParent:h,deletedComponents:v.deletedComponents};r.push(y),Object.assign(s,v.deletedComponents);let g=this._components[e.parentName];u.componentsTouched.push(...this.componentAndRenderedDescendants(g))}else{let p=n.length,d=this.deleteComponents({components:n,deleteUpstreamDependencies:!1,componentChanges:r,sourceOfUpdate:i,updatesNeeded:u,compositesBeingExpanded:c});if(d.success===!1)throw Error("Couldn't delete components prescribed by composite");for(let h of d.parentsOfDeleted)a.add(h.componentName),u.componentsTouched.push(...this.componentAndRenderedDescendants(h));let m={};for(let h in d.deletedComponents){let g=d.deletedComponents[h].parentName;m[g]===void 0&&(m[g]=[]),m[g].push(h)}let v={changeType:"deletedReplacements",composite:e,numberDeleted:p,deletedNamesByParent:m,deletedComponents:d.deletedComponents};r.push(v),Object.assign(s,d.deletedComponents),Object.assign(o,d.addedComponents)}return f}processChildChangesAndRecurseToShadows({component:t,updatesNeeded:e,compositesBeingExpanded:n}){let r=this._components[t.parentName];if(this.processNewDefiningChildren({parent:r,updatesNeeded:e,compositesBeingExpanded:n}),e.componentsTouched.push(...this.componentAndRenderedDescendants(r)),t.shadowedBy)for(let i of t.shadowedBy)this.processChildChangesAndRecurseToShadows({component:i,updatesNeeded:e,compositesBeingExpanded:n})}createShadowedReplacements({replacementsToShadow:t,componentToShadow:e,parentToShadow:n,updatesNeeded:r,compositesBeingExpanded:i,currentShadowedBy:a,assignNamesOffset:s,componentChanges:o,sourceOfUpdate:u,parentsOfDeleted:c,deletedComponents:f,addedComponents:p}){let d=bi(e);if(!a[e.componentName]||!d.every(h=>a[e.componentName].includes(h)))throw Error(`circular reference involving ${e.componentName}`);i.push(e.componentName);let m={};for(let h of e.shadowedBy){if(i.includes(h.componentName))throw Error(`circular dependence involving ${h.componentName}`);if(h.shadowedBy&&(a[h.componentName]=bi(h)),h.isExpanded){let y=t.map(_=>_.serialize({forCopy:!0}));if(y=Lt({serializedComponents:y,componentName:h.shadows.compositeName}),h.constructor.assignNamesToReplacements){let _=h.constructor.originalNamesAreConsistent&&h.doenetAttributes.newNamespace;y=qe({assignNames:h.doenetAttributes.assignNames,indOffset:s,serializedComponents:y,parentName:h.componentName,parentCreatesNewNamespace:h.doenetAttributes.newNamespace,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:_}).serializedComponents}else{let _=h.doenetAttributes.newNamespace;y=qe({indOffset:s,serializedComponents:y,parentName:h.componentName,parentCreatesNewNamespace:h.doenetAttributes.newNamespace,componentInfoObjects:this.componentInfoObjects,originalNamesAreConsistent:_}).serializedComponents}let g,b=this._components[h.componentName];this.parameterStack.push(b.sharedParameters,!1);let x;h.doenetAttributes.newNamespace?x=h.componentName+"/":x=mn(h.componentName);let N=this.createIsolatedComponentsSub({serializedComponents:y,ancestors:h.ancestors,updatesNeeded:r,compositesBeingExpanded:i,createNameContext:h.componentName+"|replacements",namespaceForUnamed:x,componentsReplacementOf:h});this.parameterStack.pop(),g=N.components;let C;if(n){if(n.shadowedBy){for(let _ of n.shadowedBy)if(_.shadows.compositeName===h.shadows.compositeName){C=_;break}}C||console.error(`could not find shadowing parent of ${n.componentName}`)}if(m[h.componentName]={newComponents:g,parent:C},h.shadowedBy){let _=this.createShadowedReplacements({replacementsToShadow:g,componentToShadow:h,parentToShadow:C,updatesNeeded:r,compositesBeingExpanded:i,currentShadowedBy:a,assignNamesOffset:s,componentChanges:o,sourceOfUpdate:u,parentsOfDeleted:c,deletedComponents:f,addedComponents:p});Object.assign(m,_)}}}let v=i.indexOf(e.componentName);if(v===-1)throw Error(`Something is wrong as we lost track that we were expanding ${component.componentName}`);return i.splice(v,1),m}adjustReplacementsToWithhold({component:t,change:e,componentChanges:n,updatesNeeded:r,compositesBeingExpanded:i}){let a=[],s=e.replacementsToWithhold,o;if(t.replacementsToWithhold!==void 0?o=s-t.replacementsToWithhold:o=s,o<0){a.push(t.componentName);let u=t.replacements.length-s,c=t.replacements.length-s+o,f=t.replacements.slice(c,u),p={changeType:"addedReplacements",composite:t,topLevel:!0,newReplacements:f,firstIndex:c,numberDeleted:0};n.push(p)}else if(o>0){a.push(t.componentName);let u=t.replacements.length-s,c=u+o,f=t.replacements.slice(u,c),p={};for(let m of f){let v=m.parentName;p[v]===void 0&&(p[v]=[]),p[v].push(m.componentName)}let d={changeType:"deletedReplacements",composite:t,topLevel:!0,firstIndex:u,numberDeleted:o,deletedNamesByParent:p,deletedComponents:f};n.push(d)}if(t.replacementsToWithhold=s,this.dependencies.updateReplacementDependencies(t,r,i),t.shadowedBy)for(let u of t.shadowedBy){let c=this.adjustReplacementsToWithhold({component:u,change:e,componentChanges:n,updatesNeeded:r,compositesBeingExpanded:i});a.push(...c)}return a}get standardComponentClasses(){return new Proxy(this._standardComponentClasses,Be)}set standardComponentClasses(t){return null}get allComponentClasses(){return new Proxy(this._allComponentClasses,Be)}set allComponentClasses(t){return null}isInheritedComponentType({inheritedComponentType:t,baseComponentType:e}){return t=t.toLowerCase(),e=e.toLowerCase(),t===e?!0:this.allComponentClasses[e].isPrototypeOf(this.allComponentClasses[t])}isCompositeComponent({componentType:t,includeNonStandard:e=!0}){let n=this.allComponentClasses[t];return n?this.isInheritedComponentType({inheritedComponentType:t,baseComponentType:"_composite"})&&(e||!n.treatAsComponentForRecursiveReplacements):!1}get componentTypesCreatingVariants(){return new Proxy(this._componentTypesCreatingVariants,Be)}set componentTypesCreatingVariants(t){return null}get componentTypeWithPotentialVariants(){return new Proxy(this._componentTypeWithPotentialVariants,Be)}set componentTypeWithPotentialVariants(t){return null}get allPossibleProperties(){return new Proxy(this._allPossibleProperties,Be)}set allPossibleProperties(t){return null}createAllPossibleProperties(){let t=new Set([]);for(let e in this.allComponentClasses){let r=this.allComponentClasses[e].createPropertiesObject({standardComponentClasses:this.standardComponentClasses});for(let i in r)i.toLowerCase()in this.standardComponentClasses&&t.add(i)}return[...t]}get components(){return new Proxy(this._components,Be)}set components(t){return null}requestAction({componentName:t,actionName:e,args:n}){let r=this.components[t];if(r&&r.actions){let i=r.actions[e];if(i)return i(n)}console.warn(`Cannot run action ${e} on component ${t}`)}requestUpdate({updateInstructions:t,transient:e=!1,event:n}){if(this.flags.readOnly){let u={};for(let c of t){let f=u[c.componentName];f||(f=u[c.componentName]={}),c.sourceInformation&&Object.assign(f,c.sourceInformation)}return this.updateRendererInstructions({componentNames:t.map(c=>c.componentName),sourceOfUpdate:{sourceInformation:u}}),this.finishUpdate(),{success:!1}}let r={componentsTouched:[],compositesToExpand:new Set([]),compositesToUpdateReplacements:[],componentsToUpdateDependencies:[],unresolvedDependencies:{},unresolvedByDependent:{},deletedStateVariables:{},deletedComponents:{},recreatedComponents:{},itemScoreChanges:new Set,parentsToUpdateDescendants:new Set},i={},a={},s={};for(let u of t){if(u.componentName){let c=a[u.componentName];c||(c=a[u.componentName]={}),u.sourceInformation&&Object.assign(c,u.sourceInformation)}u.updateType==="updateValue"?this.requestComponentChanges({instruction:u,workspace:s,updatesNeeded:r,newStateVariableValues:i}):u.updateType==="addComponents"?console.log("add component"):u.updateType==="deleteComponents"?console.log("delete component"):u.updateType==="executeUpdate"&&this.executeUpdateStateVariables({newStateVariableValues:i,updatesNeeded:r,preliminary:!0})}this.externalFunctions.localStateChanged&&this.externalFunctions.localStateChanged({newStateVariableValues:i,contentId:this.contentId,sourceOfUpdate:{sourceInformation:a},transient:e});let o=Infinity;for(;o>0;){let u=this.executeUpdateStateVariables({newStateVariableValues:i,updatesNeeded:r,sourceOfUpdate:{sourceInformation:a,local:!0}});if(!(u.nFailures&&u.nFailures<o))break;o=u.nFailures}if(r.itemScoreChanges.size>0){n&&(n.context||(n.context={}),n.context.itemCreditAchieved||(n.context.itemCreditAchieved={}),n.context.documentCreditAchieved=this.document.stateValues.creditAchieved);for(let u of r.itemScoreChanges)this.externalFunctions.submitResponse&&this.externalFunctions.submitResponse({itemNumber:u,itemCreditAchieved:this.document.stateValues.itemCreditAchieved[u],callBack:this.submitResponseCallBack}),n&&(n.context.itemCreditAchieved[Number(u)+1]=this.document.stateValues.itemCreditAchieved[u])}return this.document.stateValues.itemCreditAchieved,n&&this.requestRecordEvent(n),{success:!0}}requestRecordEvent(t){this.externalFunctions.recordEvent&&(t.timestamp=new Date().toISOString().slice(0,19).replace("T"," "),t.result||(t.result={}),t.context||(t.context={}),this.externalFunctions.recordEvent(t))}executeUpdateStateVariables({newStateVariableValues:t,updatesNeeded:e,sourceOfUpdate:n,preliminary:r=!1}){let i={},a=[];for(let u in t){let c=this._components[u];if(c){let f=this.changedStateVariables[u];f||(f=this.changedStateVariables[u]={});for(let p in t[u]){let d=c.state[p];if(d)if(d.isArray){f[p]||(f[p]=new Set);for(let m in t[u][p])m!=="mergeObject"&&f[p].add(m)}else f[p]=!0}}}e===void 0&&(e={componentsTouched:Object.keys(t),compositesToExpand:new Set([]),compositesToUpdateReplacements:[],componentsToUpdateDependencies:[],unresolvedDependencies:{},unresolvedByDependent:{},deletedStateVariables:{},deletedComponents:{},recreatedComponents:{},itemScoreChanges:new Set,parentsToUpdateDescendants:new Set});let s=Object.assign({},this.unsatisfiedChildLogic),o=this.processNewStateVariableValues(t,e);if(Object.assign(i,o),this.replacementChangesFromCompositesToUpdate({updatesNeeded:e,compositesBeingExpanded:a}),Object.keys(e.unresolvedDependencies).length>0&&(e.unresolvedMessage="",this.resolveAllDependencies(e,a)),this.dependencies.updateDependencies(e,a),Object.keys(e.unresolvedDependencies).length>0)throw console.log("have some unresolved"),console.log(e.unresolvedDependencies),console.log(e.unresolvedByDependent),Error("Have unresolved dependencies after executing update state variables.  How should we handle this?");if(Object.keys(this.unsatisfiedChildLogic).length>0){let u="",c=!1;for(let f in this.unsatisfiedChildLogic)u+=`Invalid children for ${f}: ${this.unsatisfiedChildLogic[f].message} `,f in s||(c=!0);c&&(console.error("Have unresolved child logic after execute update state variables"),console.error(u))}if(r)return i;if(e.componentsTouched=[...new Set(e.componentsTouched)],this.updateRendererInstructions({componentNames:e.componentsTouched,sourceOfUpdate:n,recreatedComponents:e.recreatedComponents}),this.finishUpdate(),Object.keys(this.unsatisfiedChildLogic).length>0){let u="";for(let c in this.unsatisfiedChildLogic)u+=`Invalid children for ${c}: ${this.unsatisfiedChildLogic[c].message} `;console.warn(u)}return console.log("**** Components after updateValue"),console.log(this._components),i}replacementChangesFromCompositesToUpdate({updatesNeeded:t,compositesBeingExpanded:e}){let n=[...new Set(t.compositesToUpdateReplacements)];t.compositesToUpdateReplacements=[];let r=[],i=0,a=[];for(;n.length>0;){for(let s of n){let o=this._components[s];if(o instanceof this.allComponentClasses._composite&&o.isExpanded)if(o.state.readyToExpand.isResolved){let u=this.updateCompositeReplacements({component:o,componentChanges:a,updatesNeeded:t,compositesBeingExpanded:e});for(let c in u.addedComponents){this.changedStateVariables[c]={};for(let f in this._components[c].state){let p=this._components[c].state[f];p.isArray?this.changedStateVariables[c][f]=new Set(p.getAllArrayKeys(p.arraySize)):p.isArrayEntry||(this.changedStateVariables[c][f]=!0)}}}else r.push(s)}if(n=[...new Set(t.compositesToUpdateReplacements)],t.compositesToUpdateReplacements=[],i++,i>100)throw Error("Seem to have an infinite loop while calculating replacement changes")}return t.compositesToUpdateReplacements=r,{componentChanges:a}}processNewStateVariableValues(t,e){let n=0,r=this.getStateVariableValue;for(let i in t){let a=this._components[i];if(a===void 0){console.warn(`can't update state variables of component ${i}, as it doesn't exist.`),n+=1;continue}let s=t[i];for(let o in s){let u=a.state[o];if(u===void 0){console.warn(`can't update state variable ${o} of component ${i}, as it doesn't exist.`),n+=1;continue}if(u.value,u._previousValue=u.value,u.isArray){let c=[];if(Array.isArray(s[o]))throw Error(`do we still want to support setting entire array in inverse direction? ${o}, ${i}`);for(let f in s[o]){if(f==="mergeObject")continue;if(!(u.essential||u.essentialByArrayKey[f])){console.warn(`can't update arrayKey ${f}  of state variable ${o} of component ${i}, as it is not an essential state variable.`),n+=1;continue}n+=u.setArrayValue({value:s[o][f],arrayKey:f,arraySize:u.arraySize}).nFailures;let d=u.varNamesIncludingArrayKeys[f];d&&c.push(...d)}for(let f of c){let p=a.state[f];Object.getOwnPropertyDescriptor(p,"value").get||p.immutable||(p._previousValue=p.value,delete p.value,Object.defineProperty(p,"value",{get:()=>r({component:a,stateVariable:f}),configurable:!0})),this.markUpstreamDependentsStale({component:a,varName:f,updatesNeeded:e}),this.dependencies.recordActualChangeInUpstreamDependencies({component:a,varName:f})}}else{if(!u.essential){console.warn(`can't update state variable ${o} of component ${i}, as it is not an essential state variable.`),n+=1;continue}u.set?u.value=u.set(s[o]):u.value=s[o],delete u.usedDefault}this.markUpstreamDependentsStale({component:a,varName:o,updatesNeeded:e}),this.dependencies.recordActualChangeInUpstreamDependencies({component:a,varName:o})}}return{nFailures:n}}requestComponentChanges({instruction:t,initialChange:e=!0,workspace:n,updatesNeeded:r,newStateVariableValues:i}){let a=this._components[t.componentName],s=this.substituteAliases({stateVariables:[t.stateVariable],componentClass:a.constructor})[0];n[t.componentName]===void 0&&(n[t.componentName]={});let o=n[t.componentName],u=this.getStateVariableDefinitionArguments({component:a,stateVariable:s});u.componentInfoObjects=this.componentInfoObjects,u.initialChange=e,u.stateValues=a.stateValues,u.overrideFixed=t.overrideFixed,u.shadowedVariable=t.shadowedVariable;let c=a.state[s],f=s;if(c.isArrayEntry){let h=c.arrayStateVariable;f=h,c.entireArrayAtOnce&&(u.arrayKeys=c.arrayKeys);let y={};if(u.arrayKeys.length===1){if("value"in t)y[u.arrayKeys[0]]=t.value;else if("valueOfStateVariable"in t){let g=this.substituteAliases({stateVariables:[t.valueOfStateVariable],componentClass:a.constructor})[0],b=a.state[g];if(b)y[u.arrayKeys[0]]=b.value;else throw Error(`Invalid instruction to change ${t.stateVariable} of ${t.componentName}, value of state variable ${t.valueOfStateVariable} not found.`)}}else for(let[g,b]of u.arrayKeys.entries())y[b]=t.value[g];u.desiredStateVariableValues={[h]:y}}else if("value"in t)u.desiredStateVariableValues={[s]:t.value};else if("valueOfStateVariable"in t){let h=this.substituteAliases({stateVariables:[t.valueOfStateVariable],componentClass:a.constructor})[0],y=a.state[h];if(y)u.desiredStateVariableValues={[s]:y.value};else throw Error(`Invalid instruction to change ${t.stateVariable} of ${t.componentName}, value of state variable ${t.valueOfStateVariable} not found.`)}let p=o[f];if(p===void 0&&(p=o[f]={}),c.additionalStateVariablesDefined)for(let h of c.additionalStateVariablesDefined){let y=h;a.state[h].isArray&&(y=c.arrayStateVariable);let b=o[y];b&&(Object.assign(p,b),o[y]=p)}if(u.workspace=p,t.additionalStateVariableValues)for(let h in t.additionalStateVariableValues){if(!c.additionalStateVariablesDefined.includes(h)){console.warn(`Can't invert ${h} at the same time as ${s}, as not an additional state variable defined`);continue}u.desiredStateVariableValues[h]=t.additionalStateVariableValues[h]}if(r.componentsTouched.push(a.componentName),!c.inverseDefinition){console.warn(`Cannot change state variable ${s} of ${a.componentName} as it doesn't have an inverse definition`);return}if(a.stateValues.fixed&&!t.overrideFixed){console.log(`Changing ${s} of ${a.componentName} did not succeed because fixed is true.`);return}if(!(e||a.stateValues.modifyIndirectly!==!1)){console.log(`Changing ${s} of ${a.componentName} did not succeed because modifyIndirectly is false.`);return}let d=c.inverseDefinition(u);if(!d.success){console.log(`Changing ${s} of ${a.componentName} did not succeed.`);return}let m=[],v;for(let h of d.instructions){let y=!1;if(h.setDependency){let g=h.setDependency,b=this.dependencies.downstreamDependencies[a.componentName][s][g];if(["stateVariable","parentStateVariable"].includes(b.dependencyType)&&b.downstreamComponentNames.length===1){let x=b.downstreamComponentNames[0],N=b.mappedDownstreamVariableNamesByComponent[0][0],C=this._components[x].state[N];if(C.isArrayEntry||C.isArray){let _=C.isArrayEntry?C.arrayStateVariable:N;if(v&&!(v.componentName===x&&v.stateVariable===_&&v.shadowedVariable===h.shadowedVariable&&v.treatAsInitialChange===h.treatAsInitialChange)&&(m.push(v),v=void 0),!h.additionalDependencyValues)if(y=!0,v||(v={combinedArray:!0,componentName:x,stateVariable:_,shadowedVariable:h.shadowedVariable,treatAsInitialChange:h.treatAsInitialChange,desiredValue:{}}),C.isArrayEntry){let w=C.arrayKeys;if(w.length===1)v.desiredValue[w[0]]=h.desiredValue;else for(let[A,$]of w.entries())v.desiredValue[$]=h.desiredValue[A]}else Object.assign(v.desiredValue,h.desiredValue)}}}y||(v&&(m.push(v),v=void 0),m.push(h))}v&&(m.push(v),v=void 0);for(let h of m)if(h.setStateVariable){if(!("value"in h))throw Error(`Invalid inverse definition of ${s} of ${a.componentName}: setStateVariable must specify a value`);i[a.componentName]||(i[a.componentName]={}),a.state[h.setStateVariable].isArray?(i[a.componentName][h.setStateVariable]||(i[a.componentName][h.setStateVariable]={mergeObject:!0}),Object.assign(i[a.componentName][h.setStateVariable],h.value)):i[a.componentName][h.setStateVariable]=h.value}else if(h.setDependency){let y=h.setDependency,g=this.dependencies.downstreamDependencies[a.componentName][s][y];if(g.dependencyType==="child"){let b=g.downstreamComponentNames[h.childIndex];if(!b)throw Error(`Invalid inverse definition of ${s} of ${a.componentName}: ${y} child of index ${h.childIndex} does not exist.`);let x=g.mappedDownstreamVariableNamesByComponent[h.childIndex][h.variableIndex];if(!x)throw Error(`Invalid inverse definition of ${s} of ${a.componentName}: ${y} variable of index ${h.variableIndex} does not exist.`);let N={componentName:b,stateVariable:x,value:h.desiredValue,overrideFixed:t.overrideFixed,arrayKey:h.arrayKey};this.requestComponentChanges({instruction:N,initialChange:h.treatAsInitialChange===!0,workspace:n,updatesNeeded:r,newStateVariableValues:i})}else if(["stateVariable","parentStateVariable"].includes(g.dependencyType)&&g.downstreamComponentNames.length===1){let b=g.downstreamComponentNames[0],x=g.mappedDownstreamVariableNamesByComponent[0][0],N={componentName:b,stateVariable:x,value:h.desiredValue,overrideFixed:t.overrideFixed,shadowedVariable:h.shadowedVariable};if(h.additionalDependencyValues){let C=this.components[b].state[x];for(let _ in h.additionalDependencyValues){let w=this.dependencies.downstreamDependencies[a.componentName][s][_];if(!(["stateVariable","parentStateVariable"].includes(w.dependencyType)&&w.downstreamComponentNames.length===1)){console.warn(`Can't simultaneously set additional dependency value ${_} if it isn't a state variable`);continue}let A=w.mappedDownstreamVariableNamesByComponent[0][0];if(w.downstreamComponentNames[0]!==b||!C.additionalStateVariablesDefined.includes(A)){console.warn(`Can't simultaneously set additional dependency value ${_} if it doesn't correspond to additional state variable defined of ${y}'s state variable`);continue}N.additionalStateVariableValues||(N.additionalStateVariableValues={}),N.additionalStateVariableValues[A]=h.additionalDependencyValues[_]}}this.requestComponentChanges({instruction:N,initialChange:h.treatAsInitialChange===!0,workspace:n,updatesNeeded:r,newStateVariableValues:i})}else throw Error(`unimplemented dependency type ${g.dependencyType} in requestComponentChanges`)}else if(h.combinedArray){let y={componentName:h.componentName,stateVariable:h.stateVariable,value:h.desiredValue,overrideFixed:t.overrideFixed,shadowedVariable:h.shadowedVariable};this.requestComponentChanges({instruction:y,initialChange:h.treatAsInitialChange===!0,workspace:n,updatesNeeded:r,newStateVariableValues:i})}else if(h.deferSettingDependency){let y=h.deferSettingDependency,g=this.dependencies.downstreamDependencies[a.componentName][s][y];if(g.dependencyType==="child"){let b=g.downstreamComponentNames[h.childIndex];if(!b)throw Error(`Invalid for deferSettingDependency in inverse definition of ${s} of ${a.componentName}: ${y} child of index ${h.childIndex} does not exist.`);let x=g.mappedDownstreamVariableNamesByComponent[h.childIndex][h.variableIndex];if(!x)throw Error(`Invalid for deferSettingDependency in inverse definition of ${s} of ${a.componentName}: ${y} variable of index ${h.variableIndex} does not exist..`);let N=this._components[b];if(N.componentType!=="string")throw Error("deferStateVariableDependency is implemented just when dependency is a string.");Object.getOwnPropertyDescriptor(N.state[x],"value").get||(N.state[x]._previousValue=N.state[x].value),delete N.state[x].value;let C=()=>this.getDeferredStateVariable({component:N,stateVariable:x,upstreamComponent:a,upstreamStateVariable:s,dependencyValues:h.dependencyValues,inverseDefinition:h.inverseDefinition});Object.defineProperty(N.state[x],"value",{get:C,configurable:!0}),N.state[x].deferred=!0}else throw Error(`unimplemented dependency type ${g.dependencyType} in requestComponentChanges`)}else throw console.log(h),Error(`Unrecognized instruction in inverse definition of ${s} of ${a.componentName}`)}submitResponseCallBack(t){console.log("submit response callback"),console.log(t)}getDeferredStateVariable({component:t,stateVariable:e,upstreamComponent:n,upstreamStateVariable:r,dependencyValues:i,inverseDefinition:a}){console.log("get deffered state variable"),console.log(t.componentName,n.componentName),console.log(r);let s=a({dependencyValues:i,stateValues:n.stateValues});if(!s.success){console.warn(`Inverse definition for deferring state variable failed. component: ${t.componentName}, stateVariable: ${e}, upstreamComponent: ${n.componentName}, upstreamStateVariable: ${r}`);return}for(let o of s.instructions)if(o.setDependency){let u=o.setDependency,c=this.dependencies.downstreamDependencies[n.componentName][r][u];if(c.dependencyType==="child"){let f=c.downstreamComponentNames[o.childIndex];if(!f)throw Error(`Invalid inverse definition of ${e} of ${t.componentName}: ${u} child of index ${o.childIndex} does not exist.`);let p=c.mappedDownstreamVariableNamesByComponent[o.childIndex][o.variableIndex];if(!p)throw Error(`Invalid inverse definition of ${e} of ${t.componentName}: ${u} variable of index ${o.variableIndex} does not exist..`);let d=this._components[f];delete d.state[p].value,delete d.state[p].deferred,d.state[p].value=o.desiredValue}else throw Error(`unimplemented dependency type ${c.dependencyType} in deferred inverse definition`)}else throw Error(`Unrecognized instruction deferred inverse definition of ${e} of ${t.componentName}`);if(Object.getOwnPropertyDescriptor(t.state[e],"value").get)throw Error(`deferred inverse definition of ${e} of ${t.componentName} didn't return value of variable`);return t.state[e].value}calculateScoredItemNumberOfContainer(t){let n=[...this._components[t].ancestors.slice(0,-1).reverse().map(a=>a.componentName),t],r,i;for(let[a,s]of this.document.stateValues.scoredDescendants.entries()){for(let o of n)if(s.componentName===o){r=o,i=a+1;break}if(r!==void 0)break}return r===void 0&&(r=this.document.componentName,i=this.document.stateValues.scoredDescendants.length),{scoredItemNumber:i,scoredComponent:r}}get doenetState(){return this._renderComponents}set doenetState(t){return null}get scoredItemWeights(){return this.document.stateValues.scoredDescendants.map(t=>t.stateValues.weight)}requestAnimationFrame(t,e){if(!this.preventMoreAnimations){let n=++this.lastAnimationID;if(e){let r=window.setTimeout(i=>this._requestAnimationFrame(t,n),e);return this.animationIDs[n]={timeoutID:r},n}else return this.animationIDs[n]={},this._requestAnimationFrame(t,n)}}_requestAnimationFrame(t,e){let n=window.requestAnimationFrame(t),r=this.animationIDs[e];return delete r.timeoutID,r.animationFrameID=n,e}cancelAnimationFrame(t){let e=this.animationIDs[t],n=e.timeoutID;n!==void 0&&window.clearTimeout(n);let r=e.animationFrameID;r!==void 0&&window.cancelAnimationFrame(r),delete this.animationIDs[t]}componentWillUnmount(){this.preventMoreAnimations=!0;for(let t in this.animationIDs)this.coreFunctions.cancelAnimationFrame(t);this.animationIDs={}}},_$=Pu;function Ia({value:l,propertySpecification:t,property:e}){if(t.valueTransformations&&l in t.valueTransformations&&(l=t.valueTransformations[l]),t.toLowerCase&&(l=l.toLowerCase()),t.trim&&(l=l.trim()),t.validValues){if(!t.validValues.includes(l)){let n=t.validValues[0];console.warn(`Invalid value ${l} for property ${e}, using value ${n}`),l=n}}else t.clamp&&(l<t.clamp[0]?l=t.clamp[0]:l>t.clamp[1]?l=t.clamp[1]:Number.isFinite(l)||(l=e.default));return l}function bi(l){let t=[];if(l.shadowedBy)for(let e of l.shadowedBy){t.push(e.componentName);let n=bi(e);t.push(...n)}if(l.replacementOf){let e=bi(l.replacementOf);t.push(...e)}return t}export{_$ as default};
/**
 * @license Complex.js v2.0.10 11/02/2016
 *
 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
/**
 * @license Fraction.js v4.0.8 09/09/2015
 * http://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2015, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
//!!Only call if d evenly divides f!!
//!!This function should only be called if bottom has coefficient 1 and divides the top (e.g., bottom was computed using mono_gcd)!!
